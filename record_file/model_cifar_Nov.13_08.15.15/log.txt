current path: saved_models/model_cifar_Nov.13_08.15.15
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 201
create model done
Poisoned following participants: [17, 33, 77, 11]
We use following environment for graphs:  cifar
----------------------------------Start one training epoch------------------------------------------
Server Epoch:201 choose agents : [17, 33, 77, 11, 37, 53, 39, 57, 63, 48]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   1,  Average loss: 0.0159, Accuracy: 447/526 (84.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   2,  Average loss: 0.0178, Accuracy: 402/526 (76.4259%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   3,  Average loss: 0.0111, Accuracy: 435/526 (82.6996%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   4,  Average loss: 0.0071, Accuracy: 478/526 (90.8745%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   5,  Average loss: 0.0037, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   6,  Average loss: 0.0024, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 39.68995440245239. Distance: 13.590553346305994
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.2023, Accuracy: 4144/10000 (41.4400%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.4110, Accuracy: 7857/9000 (87.3000%)
Scaling by  100
Scaled Norm after poisoning: 1358.5499162710216, distance: 1359.055232505287
Total norm for 4 adversaries is: 1358.5499162710216. distance: 1359.055232505287
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   1,  Average loss: 0.0159, Accuracy: 433/527 (82.1632%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   2,  Average loss: 0.0166, Accuracy: 432/527 (81.9734%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   3,  Average loss: 0.0098, Accuracy: 456/527 (86.5275%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   4,  Average loss: 0.0059, Accuracy: 487/527 (92.4099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   5,  Average loss: 0.0038, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   6,  Average loss: 0.0033, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 38.99116768226572. Distance: 11.514069947794104
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.1893, Accuracy: 4174/10000 (41.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.2517, Accuracy: 8193/9000 (91.0333%)
Scaling by  100
Scaled Norm after poisoning: 1150.6865885200887, distance: 1151.4068568494804
Total norm for 4 adversaries is: 1150.6865885200887. distance: 1151.4068568494804
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   1,  Average loss: 0.0098, Accuracy: 428/496 (86.2903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   2,  Average loss: 0.0062, Accuracy: 457/496 (92.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   3,  Average loss: 0.0035, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   4,  Average loss: 0.0020, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.66304237236004.
Norm before scaling: 37.931241117769595. Distance: 6.73416625936279
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.1738, Accuracy: 6273/10000 (62.7300%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.1742, Accuracy: 8610/9000 (95.6667%)
Scaling by  100
Scaled Norm after poisoning: 672.6076122078905, distance: 673.4166847131128
Total norm for 4 adversaries is: 672.6076122078905. distance: 673.4166847131128
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   1,  Average loss: 0.0076, Accuracy: 485/546 (88.8278%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 501/546 (91.7582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   3,  Average loss: 0.0028, Accuracy: 520/546 (95.2381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   4,  Average loss: 0.0019, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 37.97004884609711. Distance: 7.087844070613852
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.4285, Accuracy: 5827/10000 (58.2700%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.2085, Accuracy: 8520/9000 (94.6667%)
Scaling by  100
Scaled Norm after poisoning: 707.8786751626299, distance: 708.784434789591
Total norm for 4 adversaries is: 707.8786751626299. distance: 708.784434789591
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   1,  Average loss: 0.0111, Accuracy: 583/725 (80.4138%)
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   2,  Average loss: 0.0180, Accuracy: 500/725 (68.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 25.8104, Accuracy: 1692/10000 (16.9200%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   1,  Average loss: 0.0049, Accuracy: 558/625 (89.2800%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   2,  Average loss: 0.0042, Accuracy: 573/625 (91.6800%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.5920, Accuracy: 4275/10000 (42.7500%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   1,  Average loss: 0.0074, Accuracy: 186/217 (85.7143%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   2,  Average loss: 0.0012, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.1558, Accuracy: 3159/10000 (31.5900%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   1,  Average loss: 0.0074, Accuracy: 245/290 (84.4828%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   2,  Average loss: 0.0019, Accuracy: 280/290 (96.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.6954, Accuracy: 3040/10000 (30.4000%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 704/752 (93.6170%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   2,  Average loss: 0.0029, Accuracy: 710/752 (94.4149%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.8209, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   1,  Average loss: 0.0059, Accuracy: 332/378 (87.8307%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   2,  Average loss: 0.0019, Accuracy: 363/378 (96.0317%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 3.8683, Accuracy: 3156/10000 (31.5600%)
time spent on training: 274.32448530197144
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4122392758756395  data num: [526, 527, 496, 546, 725, 625, 217, 290, 752, 378]
[foolsgold agg] considering poison per batch poison_fraction: 0.03220619342778434
[foolsgold agg] wv: [1.         0.         0.         0.         0.38622832 0.
 1.         0.         0.66587676 0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 201: Average loss: 0.7355, Accuracy: 7599/10000 (75.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 201: Average loss: 6.5885, Accuracy: 202/9000 (2.2444%)
Done in 327.95100593566895 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:202 choose agents : [17, 33, 77, 11, 63, 50, 39, 72, 88, 71]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   1,  Average loss: 0.0167, Accuracy: 447/526 (84.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   2,  Average loss: 0.0187, Accuracy: 417/526 (79.2776%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   3,  Average loss: 0.0099, Accuracy: 438/526 (83.2700%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   4,  Average loss: 0.0056, Accuracy: 490/526 (93.1559%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   5,  Average loss: 0.0042, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   6,  Average loss: 0.0026, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Global model norm: 37.66176048892298.
Norm before scaling: 38.89185853306898. Distance: 11.424343525997458
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.6916, Accuracy: 4863/10000 (48.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.2523, Accuracy: 8171/9000 (90.7889%)
Scaling by  100
Scaled Norm after poisoning: 1141.463972274202, distance: 1142.434407307483
Total norm for 4 adversaries is: 1141.463972274202. distance: 1142.434407307483
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   1,  Average loss: 0.0154, Accuracy: 438/527 (83.1120%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   2,  Average loss: 0.0116, Accuracy: 457/527 (86.7173%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   3,  Average loss: 0.0067, Accuracy: 476/527 (90.3226%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   4,  Average loss: 0.0040, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   5,  Average loss: 0.0044, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   6,  Average loss: 0.0027, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.66176048892298.
Norm before scaling: 38.624633392273125. Distance: 10.265554767525163
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.8371, Accuracy: 4762/10000 (47.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.1692, Accuracy: 8432/9000 (93.6889%)
Scaling by  100
Scaled Norm after poisoning: 1025.6909256691315, distance: 1026.5554661098445
Total norm for 4 adversaries is: 1025.6909256691315. distance: 1026.5554661098445
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   1,  Average loss: 0.0099, Accuracy: 428/496 (86.2903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   2,  Average loss: 0.0072, Accuracy: 445/496 (89.7177%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   3,  Average loss: 0.0043, Accuracy: 467/496 (94.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   4,  Average loss: 0.0019, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   6,  Average loss: 0.0012, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.66176048892298.
Norm before scaling: 38.004701022435206. Distance: 7.126472187201809
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.1951, Accuracy: 6089/10000 (60.8900%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.1918, Accuracy: 8514/9000 (94.6000%)
Scaling by  100
Scaled Norm after poisoning: 711.8993740339993, distance: 712.6471777815443
Total norm for 4 adversaries is: 711.8993740339993. distance: 712.6471777815443
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   1,  Average loss: 0.0085, Accuracy: 481/546 (88.0952%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 492/546 (90.1099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   3,  Average loss: 0.0028, Accuracy: 525/546 (96.1538%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   4,  Average loss: 0.0017, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.66176048892298.
Norm before scaling: 37.96566988535498. Distance: 7.079825695931054
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.2776, Accuracy: 5982/10000 (59.8200%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.1010, Accuracy: 8731/9000 (97.0111%)
Scaling by  100
Scaled Norm after poisoning: 707.0670274097074, distance: 707.9826092496905
Total norm for 4 adversaries is: 707.0670274097074. distance: 707.9826092496905
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 202, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 694/752 (92.2872%)
___Train Local_ResNet_18,  epoch 202, local model 63, internal_epoch   2,  Average loss: 0.0034, Accuracy: 697/752 (92.6862%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.9344, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   1,  Average loss: 0.0027, Accuracy: 385/401 (96.0100%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   2,  Average loss: 0.0017, Accuracy: 393/401 (98.0050%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.5814, Accuracy: 4572/10000 (45.7200%)
___Train Local_ResNet_18,  epoch 202, local model 39, internal_epoch   1,  Average loss: 0.0066, Accuracy: 188/217 (86.6359%)
___Train Local_ResNet_18,  epoch 202, local model 39, internal_epoch   2,  Average loss: 0.0016, Accuracy: 214/217 (98.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 3.6625, Accuracy: 3549/10000 (35.4900%)
___Train Local_ResNet_18,  epoch 202, local model 72, internal_epoch   1,  Average loss: 0.0107, Accuracy: 497/618 (80.4207%)
___Train Local_ResNet_18,  epoch 202, local model 72, internal_epoch   2,  Average loss: 0.0077, Accuracy: 540/618 (87.3786%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 7.4128, Accuracy: 3261/10000 (32.6100%)
___Train Local_ResNet_18,  epoch 202, local model 88, internal_epoch   1,  Average loss: 0.0080, Accuracy: 374/447 (83.6689%)
___Train Local_ResNet_18,  epoch 202, local model 88, internal_epoch   2,  Average loss: 0.0041, Accuracy: 407/447 (91.0515%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 5.5378, Accuracy: 2450/10000 (24.5000%)
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 1042/1166 (89.3654%)
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   2,  Average loss: 0.0150, Accuracy: 852/1166 (73.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 11.3583, Accuracy: 1300/10000 (13.0000%)
time spent on training: 274.34891963005066
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.36780196629213485  data num: [526, 527, 496, 546, 752, 401, 217, 618, 447, 1166]
[foolsgold agg] considering poison per batch poison_fraction: 0.028734528616573034
[foolsgold agg] wv: [0.71969981 0.         0.         0.         1.         0.92445344
 1.         0.92445344 1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 202: Average loss: 0.7324, Accuracy: 7603/10000 (76.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 202: Average loss: 6.5826, Accuracy: 204/9000 (2.2667%)
Done in 329.570476770401 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:203 choose agents : [17, 33, 77, 11, 92, 23, 26, 50, 14, 76]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   1,  Average loss: 0.0144, Accuracy: 450/526 (85.5513%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   2,  Average loss: 0.0184, Accuracy: 431/526 (81.9392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   3,  Average loss: 0.0106, Accuracy: 443/526 (84.2205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   4,  Average loss: 0.0080, Accuracy: 465/526 (88.4030%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   5,  Average loss: 0.0042, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   6,  Average loss: 0.0025, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Global model norm: 37.66136019526927.
Norm before scaling: 38.959862032730236. Distance: 11.544022926693764
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.0371, Accuracy: 4356/10000 (43.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.3937, Accuracy: 7881/9000 (87.5667%)
Scaling by  100
Scaled Norm after poisoning: 1153.5537482059517, distance: 1154.4023886842924
Total norm for 4 adversaries is: 1153.5537482059517. distance: 1154.4023886842924
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   1,  Average loss: 0.0153, Accuracy: 434/527 (82.3529%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   2,  Average loss: 0.0127, Accuracy: 444/527 (84.2505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   3,  Average loss: 0.0084, Accuracy: 464/527 (88.0455%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   4,  Average loss: 0.0044, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   5,  Average loss: 0.0029, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   6,  Average loss: 0.0025, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Global model norm: 37.66136019526927.
Norm before scaling: 38.699264290689364. Distance: 10.481615957059725
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.0726, Accuracy: 4583/10000 (45.8300%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.2767, Accuracy: 8322/9000 (92.4667%)
Scaling by  100
Scaled Norm after poisoning: 1047.377797167765, distance: 1048.161604906419
Total norm for 4 adversaries is: 1047.377797167765. distance: 1048.161604906419
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   1,  Average loss: 0.0097, Accuracy: 428/496 (86.2903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   2,  Average loss: 0.0083, Accuracy: 444/496 (89.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   3,  Average loss: 0.0044, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   4,  Average loss: 0.0031, Accuracy: 477/496 (96.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   5,  Average loss: 0.0014, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   6,  Average loss: 0.0015, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Global model norm: 37.66136019526927.
Norm before scaling: 37.953142689888836. Distance: 7.000825015904933
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.1546, Accuracy: 6132/10000 (61.3200%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.1190, Accuracy: 8715/9000 (96.8333%)
Scaling by  100
Scaled Norm after poisoning: 699.1702448259651, distance: 700.0824058637669
Total norm for 4 adversaries is: 699.1702448259651. distance: 700.0824058637669
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   1,  Average loss: 0.0096, Accuracy: 484/546 (88.6447%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 498/546 (91.2088%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   3,  Average loss: 0.0027, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   4,  Average loss: 0.0013, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   5,  Average loss: 0.0023, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   6,  Average loss: 0.0017, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Global model norm: 37.66136019526927.
Norm before scaling: 37.885898545418584. Distance: 6.883437648964905
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.4748, Accuracy: 5458/10000 (54.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.0491, Accuracy: 8852/9000 (98.3556%)
Scaling by  100
Scaled Norm after poisoning: 687.1635085625545, distance: 688.3438003643238
Total norm for 4 adversaries is: 687.1635085625545. distance: 688.3438003643238
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 203, local model 92, internal_epoch   1,  Average loss: 0.0066, Accuracy: 698/796 (87.6884%)
___Train Local_ResNet_18,  epoch 203, local model 92, internal_epoch   2,  Average loss: 0.0067, Accuracy: 695/796 (87.3116%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 4.3226, Accuracy: 3128/10000 (31.2800%)
___Train Local_ResNet_18,  epoch 203, local model 23, internal_epoch   1,  Average loss: 0.0051, Accuracy: 220/248 (88.7097%)
___Train Local_ResNet_18,  epoch 203, local model 23, internal_epoch   2,  Average loss: 0.0008, Accuracy: 247/248 (99.5968%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 3.4683, Accuracy: 3571/10000 (35.7100%)
___Train Local_ResNet_18,  epoch 203, local model 26, internal_epoch   1,  Average loss: 0.0053, Accuracy: 422/468 (90.1709%)
___Train Local_ResNet_18,  epoch 203, local model 26, internal_epoch   2,  Average loss: 0.0063, Accuracy: 415/468 (88.6752%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 3.2088, Accuracy: 4138/10000 (41.3800%)
___Train Local_ResNet_18,  epoch 203, local model 50, internal_epoch   1,  Average loss: 0.0029, Accuracy: 384/401 (95.7606%)
___Train Local_ResNet_18,  epoch 203, local model 50, internal_epoch   2,  Average loss: 0.0016, Accuracy: 391/401 (97.5062%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.6729, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 203, local model 14, internal_epoch   1,  Average loss: 0.0077, Accuracy: 266/318 (83.6478%)
___Train Local_ResNet_18,  epoch 203, local model 14, internal_epoch   2,  Average loss: 0.0025, Accuracy: 300/318 (94.3396%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 11.0455, Accuracy: 1842/10000 (18.4200%)
___Train Local_ResNet_18,  epoch 203, local model 76, internal_epoch   1,  Average loss: 0.0350, Accuracy: 57/65 (87.6923%)
___Train Local_ResNet_18,  epoch 203, local model 76, internal_epoch   2,  Average loss: 0.0402, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.1829, Accuracy: 6507/10000 (65.0700%)
time spent on training: 278.71150302886963
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.47711227510817583  data num: [526, 527, 496, 546, 796, 248, 468, 401, 318, 65]
[foolsgold agg] considering poison per batch poison_fraction: 0.03727439649282624
[foolsgold agg] wv: [1.         0.         0.         0.         1.         1.
 0.05685646 1.         0.05685646 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 203: Average loss: 0.7295, Accuracy: 7609/10000 (76.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 203: Average loss: 6.5437, Accuracy: 211/9000 (2.3444%)
Done in 333.11289262771606 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:204 choose agents : [17, 33, 77, 11, 49, 86, 26, 58, 6, 94]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   1,  Average loss: 0.0133, Accuracy: 458/526 (87.0722%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   2,  Average loss: 0.0157, Accuracy: 428/526 (81.3688%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   3,  Average loss: 0.0107, Accuracy: 445/526 (84.6008%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   4,  Average loss: 0.0059, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   5,  Average loss: 0.0031, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   6,  Average loss: 0.0028, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 37.66008149594541.
Norm before scaling: 38.99983097920105. Distance: 11.576929604703729
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.8996, Accuracy: 4382/10000 (43.8200%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.1746, Accuracy: 8466/9000 (94.0667%)
Scaling by  100
Scaled Norm after poisoning: 1156.9525703329416, distance: 1157.6929644771967
Total norm for 4 adversaries is: 1156.9525703329416. distance: 1157.6929644771967
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   1,  Average loss: 0.0147, Accuracy: 436/527 (82.7324%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   2,  Average loss: 0.0128, Accuracy: 439/527 (83.3017%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   3,  Average loss: 0.0088, Accuracy: 476/527 (90.3226%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   4,  Average loss: 0.0056, Accuracy: 492/527 (93.3586%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   5,  Average loss: 0.0058, Accuracy: 492/527 (93.3586%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   6,  Average loss: 0.0037, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Global model norm: 37.66008149594541.
Norm before scaling: 38.84025684464268. Distance: 10.923663122580493
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.6614, Accuracy: 4945/10000 (49.4500%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.5631, Accuracy: 7592/9000 (84.3556%)
Scaling by  100
Scaled Norm after poisoning: 1091.685966750512, distance: 1092.366296166263
Total norm for 4 adversaries is: 1091.685966750512. distance: 1092.366296166263
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   1,  Average loss: 0.0102, Accuracy: 426/496 (85.8871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   2,  Average loss: 0.0075, Accuracy: 445/496 (89.7177%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   3,  Average loss: 0.0037, Accuracy: 468/496 (94.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   4,  Average loss: 0.0019, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.66008149594541.
Norm before scaling: 37.99266382978183. Distance: 7.0811303097473814
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.1266, Accuracy: 6311/10000 (63.1100%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.1739, Accuracy: 8612/9000 (95.6889%)
Scaling by  100
Scaled Norm after poisoning: 707.3501608114611, distance: 708.1130956633975
Total norm for 4 adversaries is: 707.3501608114611. distance: 708.1130956633975
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   1,  Average loss: 0.0085, Accuracy: 484/546 (88.6447%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 501/546 (91.7582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   3,  Average loss: 0.0040, Accuracy: 517/546 (94.6886%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   4,  Average loss: 0.0017, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.66008149594541.
Norm before scaling: 37.993852620049765. Distance: 7.253619112854976
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.3736, Accuracy: 5751/10000 (57.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.1180, Accuracy: 8696/9000 (96.6222%)
Scaling by  100
Scaled Norm after poisoning: 724.4528107475325, distance: 725.3619786010293
Total norm for 4 adversaries is: 724.4528107475325. distance: 725.3619786010293
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 204, local model 49, internal_epoch   1,  Average loss: 0.0033, Accuracy: 401/426 (94.1315%)
___Train Local_ResNet_18,  epoch 204, local model 49, internal_epoch   2,  Average loss: 0.0015, Accuracy: 411/426 (96.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.8357, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 204, local model 86, internal_epoch   1,  Average loss: 0.0046, Accuracy: 191/212 (90.0943%)
___Train Local_ResNet_18,  epoch 204, local model 86, internal_epoch   2,  Average loss: 0.0011, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.6876, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 204, local model 26, internal_epoch   1,  Average loss: 0.0052, Accuracy: 424/468 (90.5983%)
___Train Local_ResNet_18,  epoch 204, local model 26, internal_epoch   2,  Average loss: 0.0083, Accuracy: 419/468 (89.5299%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 3.6382, Accuracy: 4129/10000 (41.2900%)
___Train Local_ResNet_18,  epoch 204, local model 58, internal_epoch   1,  Average loss: 0.0100, Accuracy: 187/234 (79.9145%)
___Train Local_ResNet_18,  epoch 204, local model 58, internal_epoch   2,  Average loss: 0.0030, Accuracy: 226/234 (96.5812%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 8.6841, Accuracy: 1496/10000 (14.9600%)
___Train Local_ResNet_18,  epoch 204, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 462/520 (88.8462%)
___Train Local_ResNet_18,  epoch 204, local model 6, internal_epoch   2,  Average loss: 0.0060, Accuracy: 463/520 (89.0385%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 3.4502, Accuracy: 3593/10000 (35.9300%)
___Train Local_ResNet_18,  epoch 204, local model 94, internal_epoch   1,  Average loss: 0.0099, Accuracy: 162/203 (79.8030%)
___Train Local_ResNet_18,  epoch 204, local model 94, internal_epoch   2,  Average loss: 0.0040, Accuracy: 196/203 (96.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 8.1172, Accuracy: 1519/10000 (15.1900%)
time spent on training: 274.52268505096436
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.5038480038480039  data num: [526, 527, 496, 546, 426, 212, 468, 234, 520, 203]
[foolsgold agg] considering poison per batch poison_fraction: 0.0393631253006253
[foolsgold agg] wv: [0.76698145 0.         0.10101727 0.         1.         1.
 0.66124457 0.19071918 0.19071918 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 204: Average loss: 0.7267, Accuracy: 7619/10000 (76.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 204: Average loss: 6.5146, Accuracy: 215/9000 (2.3889%)
Done in 329.11413764953613 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:205 choose agents : [17, 33, 77, 11, 61, 71, 8, 69, 89, 64]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   1,  Average loss: 0.0146, Accuracy: 454/526 (86.3118%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   2,  Average loss: 0.0188, Accuracy: 422/526 (80.2281%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   3,  Average loss: 0.0110, Accuracy: 452/526 (85.9316%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   4,  Average loss: 0.0055, Accuracy: 487/526 (92.5856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   5,  Average loss: 0.0044, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   6,  Average loss: 0.0031, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Global model norm: 37.658721716078766.
Norm before scaling: 38.87681805937666. Distance: 11.378414773328764
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.8475, Accuracy: 4679/10000 (46.7900%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.4176, Accuracy: 7515/9000 (83.5000%)
Scaling by  100
Scaled Norm after poisoning: 1136.8719145092819, distance: 1137.8417069170914
Total norm for 4 adversaries is: 1136.8719145092819. distance: 1137.8417069170914
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   1,  Average loss: 0.0129, Accuracy: 446/527 (84.6300%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   2,  Average loss: 0.0136, Accuracy: 438/527 (83.1120%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   3,  Average loss: 0.0090, Accuracy: 465/527 (88.2353%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   4,  Average loss: 0.0051, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   5,  Average loss: 0.0032, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   6,  Average loss: 0.0040, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Global model norm: 37.658721716078766.
Norm before scaling: 38.6532215113194. Distance: 10.347394871533675
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.7618, Accuracy: 4762/10000 (47.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.2248, Accuracy: 8300/9000 (92.2222%)
Scaling by  100
Scaled Norm after poisoning: 1033.9179126023496, distance: 1034.739580764165
Total norm for 4 adversaries is: 1033.9179126023496. distance: 1034.739580764165
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   1,  Average loss: 0.0107, Accuracy: 426/496 (85.8871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   2,  Average loss: 0.0074, Accuracy: 449/496 (90.5242%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   3,  Average loss: 0.0045, Accuracy: 466/496 (93.9516%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   4,  Average loss: 0.0016, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   5,  Average loss: 0.0010, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.658721716078766.
Norm before scaling: 37.95028325353366. Distance: 6.83688274714743
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.1549, Accuracy: 6293/10000 (62.9300%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.1278, Accuracy: 8650/9000 (96.1111%)
Scaling by  100
Scaled Norm after poisoning: 682.918713135026, distance: 683.6882284711359
Total norm for 4 adversaries is: 682.918713135026. distance: 683.6882284711359
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   1,  Average loss: 0.0096, Accuracy: 484/546 (88.6447%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 504/546 (92.3077%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   3,  Average loss: 0.0030, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   4,  Average loss: 0.0017, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.658721716078766.
Norm before scaling: 37.879334658103815. Distance: 6.751822896578213
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.3096, Accuracy: 5969/10000 (59.6900%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.1171, Accuracy: 8695/9000 (96.6111%)
Scaling by  100
Scaled Norm after poisoning: 674.0897566348268, distance: 675.1822670583107
Total norm for 4 adversaries is: 674.0897566348268. distance: 675.1822670583107
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 205, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 540/590 (91.5254%)
___Train Local_ResNet_18,  epoch 205, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 538/590 (91.1864%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 4.1357, Accuracy: 3190/10000 (31.9000%)
___Train Local_ResNet_18,  epoch 205, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 1036/1166 (88.8508%)
___Train Local_ResNet_18,  epoch 205, local model 71, internal_epoch   2,  Average loss: 0.0096, Accuracy: 949/1166 (81.3894%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 4.9075, Accuracy: 2658/10000 (26.5800%)
___Train Local_ResNet_18,  epoch 205, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 486/534 (91.0112%)
___Train Local_ResNet_18,  epoch 205, local model 8, internal_epoch   2,  Average loss: 0.0077, Accuracy: 477/534 (89.3258%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 4.1155, Accuracy: 3691/10000 (36.9100%)
___Train Local_ResNet_18,  epoch 205, local model 69, internal_epoch   1,  Average loss: 0.0073, Accuracy: 185/216 (85.6481%)
___Train Local_ResNet_18,  epoch 205, local model 69, internal_epoch   2,  Average loss: 0.0016, Accuracy: 213/216 (98.6111%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 9.5021, Accuracy: 1113/10000 (11.1300%)
___Train Local_ResNet_18,  epoch 205, local model 89, internal_epoch   1,  Average loss: 0.0074, Accuracy: 354/413 (85.7143%)
___Train Local_ResNet_18,  epoch 205, local model 89, internal_epoch   2,  Average loss: 0.0043, Accuracy: 386/413 (93.4625%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 5.1786, Accuracy: 2740/10000 (27.4000%)
___Train Local_ResNet_18,  epoch 205, local model 64, internal_epoch   1,  Average loss: 0.0053, Accuracy: 613/686 (89.3586%)
___Train Local_ResNet_18,  epoch 205, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 621/686 (90.5248%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 3.5104, Accuracy: 3702/10000 (37.0200%)
time spent on training: 285.4062225818634
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3675438596491228  data num: [526, 527, 496, 546, 590, 1166, 534, 216, 413, 686]
[foolsgold agg] considering poison per batch poison_fraction: 0.028714364035087717
[foolsgold agg] wv: [1.         0.         0.47869451 0.         1.         0.67179277
 1.         1.         1.         0.67179277]
___Test Target_ResNet_18 poisoned: False, epoch: 205: Average loss: 0.7209, Accuracy: 7635/10000 (76.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 205: Average loss: 6.4654, Accuracy: 230/9000 (2.5556%)
Done in 340.05541586875916 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:206 choose agents : [17, 33, 77, 11, 38, 64, 29, 23, 83, 43]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   1,  Average loss: 0.0139, Accuracy: 452/526 (85.9316%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   2,  Average loss: 0.0156, Accuracy: 428/526 (81.3688%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   3,  Average loss: 0.0090, Accuracy: 450/526 (85.5513%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   4,  Average loss: 0.0063, Accuracy: 476/526 (90.4943%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   5,  Average loss: 0.0047, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   6,  Average loss: 0.0039, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Global model norm: 37.65823873119848.
Norm before scaling: 38.64586088414337. Distance: 10.39774926112693
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 1.7055, Accuracy: 5033/10000 (50.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.5573, Accuracy: 7395/9000 (82.1667%)
Scaling by  100
Scaled Norm after poisoning: 1038.8814898726419, distance: 1039.7749756557907
Total norm for 4 adversaries is: 1038.8814898726419. distance: 1039.7749756557907
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   1,  Average loss: 0.0175, Accuracy: 433/527 (82.1632%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   2,  Average loss: 0.0130, Accuracy: 436/527 (82.7324%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   3,  Average loss: 0.0095, Accuracy: 451/527 (85.5787%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   4,  Average loss: 0.0038, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   5,  Average loss: 0.0043, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   6,  Average loss: 0.0031, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Global model norm: 37.65823873119848.
Norm before scaling: 38.73656363572648. Distance: 10.81176296654825
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.0527, Accuracy: 4484/10000 (44.8400%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.1515, Accuracy: 8517/9000 (94.6333%)
Scaling by  100
Scaled Norm after poisoning: 1080.2354488721428, distance: 1081.1763269698426
Total norm for 4 adversaries is: 1080.2354488721428. distance: 1081.1763269698426
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   1,  Average loss: 0.0077, Accuracy: 435/496 (87.7016%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   2,  Average loss: 0.0060, Accuracy: 457/496 (92.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   3,  Average loss: 0.0038, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   4,  Average loss: 0.0019, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   6,  Average loss: 0.0010, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.65823873119848.
Norm before scaling: 37.91075818204511. Distance: 6.490708973487845
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 1.0267, Accuracy: 6683/10000 (66.8300%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.1680, Accuracy: 8671/9000 (96.3444%)
Scaling by  100
Scaled Norm after poisoning: 648.3876155510684, distance: 649.0709225500708
Total norm for 4 adversaries is: 648.3876155510684. distance: 649.0709225500708
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   1,  Average loss: 0.0084, Accuracy: 477/546 (87.3626%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   2,  Average loss: 0.0057, Accuracy: 506/546 (92.6740%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   3,  Average loss: 0.0030, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   4,  Average loss: 0.0009, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   6,  Average loss: 0.0013, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.65823873119848.
Norm before scaling: 37.89580827949511. Distance: 6.797052350416089
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 1.3813, Accuracy: 6017/10000 (60.1700%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.2488, Accuracy: 8391/9000 (93.2333%)
Scaling by  100
Scaled Norm after poisoning: 678.6695164069181, distance: 679.7051980454468
Total norm for 4 adversaries is: 678.6695164069181. distance: 679.7051980454468
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 206, local model 38, internal_epoch   1,  Average loss: 0.0043, Accuracy: 691/756 (91.4021%)
___Train Local_ResNet_18,  epoch 206, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 694/756 (91.7989%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 5.1277, Accuracy: 2402/10000 (24.0200%)
___Train Local_ResNet_18,  epoch 206, local model 64, internal_epoch   1,  Average loss: 0.0049, Accuracy: 615/686 (89.6501%)
___Train Local_ResNet_18,  epoch 206, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 632/686 (92.1283%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 4.8081, Accuracy: 3538/10000 (35.3800%)
___Train Local_ResNet_18,  epoch 206, local model 29, internal_epoch   1,  Average loss: 0.0075, Accuracy: 730/848 (86.0849%)
___Train Local_ResNet_18,  epoch 206, local model 29, internal_epoch   2,  Average loss: 0.0044, Accuracy: 775/848 (91.3915%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 10.6649, Accuracy: 1632/10000 (16.3200%)
___Train Local_ResNet_18,  epoch 206, local model 23, internal_epoch   1,  Average loss: 0.0049, Accuracy: 218/248 (87.9032%)
___Train Local_ResNet_18,  epoch 206, local model 23, internal_epoch   2,  Average loss: 0.0008, Accuracy: 245/248 (98.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.6796, Accuracy: 4064/10000 (40.6400%)
___Train Local_ResNet_18,  epoch 206, local model 83, internal_epoch   1,  Average loss: 0.0029, Accuracy: 342/366 (93.4426%)
___Train Local_ResNet_18,  epoch 206, local model 83, internal_epoch   2,  Average loss: 0.0006, Accuracy: 366/366 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.4761, Accuracy: 5088/10000 (50.8800%)
___Train Local_ResNet_18,  epoch 206, local model 43, internal_epoch   1,  Average loss: 0.0071, Accuracy: 299/345 (86.6667%)
___Train Local_ResNet_18,  epoch 206, local model 43, internal_epoch   2,  Average loss: 0.0036, Accuracy: 325/345 (94.2029%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 6.6797, Accuracy: 2687/10000 (26.8700%)
time spent on training: 279.59126925468445
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.39202844311377244  data num: [526, 527, 496, 546, 756, 686, 848, 248, 366, 345]
[foolsgold agg] considering poison per batch poison_fraction: 0.03062722211826347
[foolsgold agg] wv: [0.84916242 0.         0.39077789 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 206: Average loss: 0.7163, Accuracy: 7648/10000 (76.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 206: Average loss: 6.4183, Accuracy: 236/9000 (2.6222%)
Done in 336.6128134727478 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:207 choose agents : [17, 33, 77, 11, 56, 45, 1, 50, 16, 12]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   1,  Average loss: 0.0155, Accuracy: 454/526 (86.3118%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   2,  Average loss: 0.0159, Accuracy: 439/526 (83.4601%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   3,  Average loss: 0.0095, Accuracy: 461/526 (87.6426%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   4,  Average loss: 0.0070, Accuracy: 484/526 (92.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   5,  Average loss: 0.0036, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   6,  Average loss: 0.0042, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Global model norm: 37.657687667057935.
Norm before scaling: 38.68231235413028. Distance: 10.586812406188566
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 1.8535, Accuracy: 4265/10000 (42.6500%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.0192, Accuracy: 8969/9000 (99.6556%)
Scaling by  100
Scaled Norm after poisoning: 1057.7515658225234, distance: 1058.6813732185904
Total norm for 4 adversaries is: 1057.7515658225234. distance: 1058.6813732185904
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   1,  Average loss: 0.0159, Accuracy: 439/527 (83.3017%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   2,  Average loss: 0.0165, Accuracy: 420/527 (79.6964%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   3,  Average loss: 0.0090, Accuracy: 457/527 (86.7173%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   4,  Average loss: 0.0046, Accuracy: 490/527 (92.9791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   5,  Average loss: 0.0034, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   6,  Average loss: 0.0033, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Global model norm: 37.657687667057935.
Norm before scaling: 38.69094384661852. Distance: 10.582377673477785
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 1.9798, Accuracy: 4678/10000 (46.7800%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.3663, Accuracy: 7783/9000 (86.4778%)
Scaling by  100
Scaled Norm after poisoning: 1057.343605456618, distance: 1058.2379222084228
Total norm for 4 adversaries is: 1057.343605456618. distance: 1058.2379222084228
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   1,  Average loss: 0.0090, Accuracy: 436/496 (87.9032%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   2,  Average loss: 0.0062, Accuracy: 446/496 (89.9194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   3,  Average loss: 0.0041, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   4,  Average loss: 0.0025, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   5,  Average loss: 0.0013, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.657687667057935.
Norm before scaling: 37.94595187463183. Distance: 6.726096036290613
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 1.0866, Accuracy: 6439/10000 (64.3900%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.2788, Accuracy: 8377/9000 (93.0778%)
Scaling by  100
Scaled Norm after poisoning: 671.9204519509732, distance: 672.6095635656692
Total norm for 4 adversaries is: 671.9204519509732. distance: 672.6095635656692
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   1,  Average loss: 0.0093, Accuracy: 479/546 (87.7289%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 500/546 (91.5751%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   3,  Average loss: 0.0031, Accuracy: 521/546 (95.4212%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   4,  Average loss: 0.0015, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   5,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.657687667057935.
Norm before scaling: 37.96875803755059. Distance: 7.24491625161533
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 1.4627, Accuracy: 5774/10000 (57.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.1500, Accuracy: 8621/9000 (95.7889%)
Scaling by  100
Scaled Norm after poisoning: 723.4706066938726, distance: 724.4915458443943
Total norm for 4 adversaries is: 723.4706066938726. distance: 724.4915458443943
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 207, local model 56, internal_epoch   1,  Average loss: 0.0029, Accuracy: 707/743 (95.1548%)
___Train Local_ResNet_18,  epoch 207, local model 56, internal_epoch   2,  Average loss: 0.0036, Accuracy: 693/743 (93.2705%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.6086, Accuracy: 4609/10000 (46.0900%)
___Train Local_ResNet_18,  epoch 207, local model 45, internal_epoch   1,  Average loss: 0.0080, Accuracy: 464/529 (87.7127%)
___Train Local_ResNet_18,  epoch 207, local model 45, internal_epoch   2,  Average loss: 0.0129, Accuracy: 430/529 (81.2854%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 21.5634, Accuracy: 1655/10000 (16.5500%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   1,  Average loss: 0.0046, Accuracy: 585/641 (91.2637%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   2,  Average loss: 0.0082, Accuracy: 600/641 (93.6037%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 4.8352, Accuracy: 2579/10000 (25.7900%)
___Train Local_ResNet_18,  epoch 207, local model 50, internal_epoch   1,  Average loss: 0.0029, Accuracy: 377/401 (94.0150%)
___Train Local_ResNet_18,  epoch 207, local model 50, internal_epoch   2,  Average loss: 0.0021, Accuracy: 389/401 (97.0075%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.9978, Accuracy: 4041/10000 (40.4100%)
___Train Local_ResNet_18,  epoch 207, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 706/773 (91.3325%)
___Train Local_ResNet_18,  epoch 207, local model 16, internal_epoch   2,  Average loss: 0.0220, Accuracy: 499/773 (64.5537%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 186.1076, Accuracy: 1007/10000 (10.0700%)
___Train Local_ResNet_18,  epoch 207, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 871/977 (89.1505%)
___Train Local_ResNet_18,  epoch 207, local model 12, internal_epoch   2,  Average loss: 0.0093, Accuracy: 802/977 (82.0880%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 9.1499, Accuracy: 2523/10000 (25.2300%)
time spent on training: 308.0029094219208
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.34015262217892517  data num: [526, 527, 496, 546, 743, 529, 641, 401, 773, 977]
[foolsgold agg] considering poison per batch poison_fraction: 0.026574423607728527
[foolsgold agg] wv: [0.5141867  0.         0.10277531 0.         0.         0.90240188
 1.         0.         0.90240188 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 207: Average loss: 0.7125, Accuracy: 7653/10000 (76.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 207: Average loss: 6.4204, Accuracy: 237/9000 (2.6333%)
Done in 364.0855474472046 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:208 choose agents : [17, 33, 77, 11, 44, 86, 20, 50, 49, 43]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   1,  Average loss: 0.0150, Accuracy: 457/526 (86.8821%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   2,  Average loss: 0.0153, Accuracy: 435/526 (82.6996%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   3,  Average loss: 0.0095, Accuracy: 457/526 (86.8821%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   4,  Average loss: 0.0057, Accuracy: 495/526 (94.1065%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   5,  Average loss: 0.0041, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   6,  Average loss: 0.0025, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 37.657170631899575.
Norm before scaling: 38.7289540881964. Distance: 10.728710295714718
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.6596, Accuracy: 5022/10000 (50.2200%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.4387, Accuracy: 7741/9000 (86.0111%)
Scaling by  100
Scaled Norm after poisoning: 1071.9825674888561, distance: 1072.8708566272085
Total norm for 4 adversaries is: 1071.9825674888561. distance: 1072.8708566272085
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   1,  Average loss: 0.0154, Accuracy: 434/527 (82.3529%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   2,  Average loss: 0.0130, Accuracy: 427/527 (81.0247%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   3,  Average loss: 0.0069, Accuracy: 470/527 (89.1841%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   4,  Average loss: 0.0036, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   5,  Average loss: 0.0030, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   6,  Average loss: 0.0036, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Global model norm: 37.657170631899575.
Norm before scaling: 39.24605156543219. Distance: 12.10366485833649
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.0248, Accuracy: 4437/10000 (44.3700%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.2264, Accuracy: 8383/9000 (93.1444%)
Scaling by  100
Scaled Norm after poisoning: 1209.948036074277, distance: 1210.3664217913515
Total norm for 4 adversaries is: 1209.948036074277. distance: 1210.3664217913515
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   1,  Average loss: 0.0079, Accuracy: 444/496 (89.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   2,  Average loss: 0.0060, Accuracy: 456/496 (91.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   3,  Average loss: 0.0035, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   4,  Average loss: 0.0015, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.657170631899575.
Norm before scaling: 37.8145983405384. Distance: 6.032439910045565
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.0776, Accuracy: 6475/10000 (64.7500%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.1220, Accuracy: 8731/9000 (97.0111%)
Scaling by  100
Scaled Norm after poisoning: 602.3872819872611, distance: 603.243964951163
Total norm for 4 adversaries is: 602.3872819872611. distance: 603.243964951163
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   1,  Average loss: 0.0073, Accuracy: 488/546 (89.3773%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 498/546 (91.2088%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   3,  Average loss: 0.0034, Accuracy: 518/546 (94.8718%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   4,  Average loss: 0.0019, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.657170631899575.
Norm before scaling: 38.016933482927215. Distance: 7.197541760306599
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.3493, Accuracy: 6089/10000 (60.8900%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.3482, Accuracy: 8297/9000 (92.1889%)
Scaling by  100
Scaled Norm after poisoning: 719.0313145127965, distance: 719.7541463930582
Total norm for 4 adversaries is: 719.0313145127965. distance: 719.7541463930582
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 208, local model 44, internal_epoch   1,  Average loss: 0.0044, Accuracy: 393/436 (90.1376%)
___Train Local_ResNet_18,  epoch 208, local model 44, internal_epoch   2,  Average loss: 0.0025, Accuracy: 415/436 (95.1835%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.5348, Accuracy: 4707/10000 (47.0700%)
___Train Local_ResNet_18,  epoch 208, local model 86, internal_epoch   1,  Average loss: 0.0044, Accuracy: 190/212 (89.6226%)
___Train Local_ResNet_18,  epoch 208, local model 86, internal_epoch   2,  Average loss: 0.0012, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.4674, Accuracy: 6112/10000 (61.1200%)
___Train Local_ResNet_18,  epoch 208, local model 20, internal_epoch   1,  Average loss: 0.0080, Accuracy: 298/362 (82.3204%)
___Train Local_ResNet_18,  epoch 208, local model 20, internal_epoch   2,  Average loss: 0.0029, Accuracy: 342/362 (94.4751%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 6.9745, Accuracy: 3002/10000 (30.0200%)
___Train Local_ResNet_18,  epoch 208, local model 50, internal_epoch   1,  Average loss: 0.0031, Accuracy: 381/401 (95.0125%)
___Train Local_ResNet_18,  epoch 208, local model 50, internal_epoch   2,  Average loss: 0.0022, Accuracy: 389/401 (97.0075%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.9506, Accuracy: 4034/10000 (40.3400%)
___Train Local_ResNet_18,  epoch 208, local model 49, internal_epoch   1,  Average loss: 0.0030, Accuracy: 398/426 (93.4272%)
___Train Local_ResNet_18,  epoch 208, local model 49, internal_epoch   2,  Average loss: 0.0016, Accuracy: 413/426 (96.9484%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.8323, Accuracy: 4346/10000 (43.4600%)
___Train Local_ResNet_18,  epoch 208, local model 43, internal_epoch   1,  Average loss: 0.0073, Accuracy: 303/345 (87.8261%)
___Train Local_ResNet_18,  epoch 208, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 328/345 (95.0725%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 7.7647, Accuracy: 2575/10000 (25.7500%)
time spent on training: 306.17264914512634
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4898293196165537  data num: [526, 527, 496, 546, 436, 212, 362, 401, 426, 345]
[foolsgold agg] considering poison per batch poison_fraction: 0.03826791559504326
[foolsgold agg] wv: [0.54801843 0.         0.14329524 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 208: Average loss: 0.7116, Accuracy: 7650/10000 (76.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 208: Average loss: 6.4136, Accuracy: 239/9000 (2.6556%)
Done in 360.60262632369995 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:209 choose agents : [17, 33, 77, 11, 28, 51, 4, 97, 85, 59]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   1,  Average loss: 0.0155, Accuracy: 453/526 (86.1217%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   2,  Average loss: 0.0162, Accuracy: 439/526 (83.4601%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   3,  Average loss: 0.0105, Accuracy: 461/526 (87.6426%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   4,  Average loss: 0.0052, Accuracy: 487/526 (92.5856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   5,  Average loss: 0.0040, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   6,  Average loss: 0.0034, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Global model norm: 37.65596635007277.
Norm before scaling: 38.686081670790365. Distance: 10.690791465357545
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.7441, Accuracy: 4439/10000 (44.3900%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.0861, Accuracy: 8724/9000 (96.9333%)
Scaling by  100
Scaled Norm after poisoning: 1068.074377091783, distance: 1069.0792182995608
Total norm for 4 adversaries is: 1068.074377091783. distance: 1069.0792182995608
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   1,  Average loss: 0.0131, Accuracy: 440/527 (83.4915%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   2,  Average loss: 0.0114, Accuracy: 452/527 (85.7685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   3,  Average loss: 0.0067, Accuracy: 476/527 (90.3226%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   4,  Average loss: 0.0052, Accuracy: 500/527 (94.8767%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   5,  Average loss: 0.0033, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   6,  Average loss: 0.0024, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.65596635007277.
Norm before scaling: 38.47734215580645. Distance: 9.685450183211147
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.6108, Accuracy: 5130/10000 (51.3000%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.1415, Accuracy: 8554/9000 (95.0444%)
Scaling by  100
Scaled Norm after poisoning: 967.6620665294264, distance: 968.54504283487
Total norm for 4 adversaries is: 967.6620665294264. distance: 968.54504283487
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   1,  Average loss: 0.0088, Accuracy: 441/496 (88.9113%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   2,  Average loss: 0.0075, Accuracy: 448/496 (90.3226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   3,  Average loss: 0.0039, Accuracy: 466/496 (93.9516%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   4,  Average loss: 0.0014, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   6,  Average loss: 0.0010, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.65596635007277.
Norm before scaling: 37.9198550270625. Distance: 6.584853982544757
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.1361, Accuracy: 6349/10000 (63.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.1138, Accuracy: 8720/9000 (96.8889%)
Scaling by  100
Scaled Norm after poisoning: 657.7835890321376, distance: 658.4854307423969
Total norm for 4 adversaries is: 657.7835890321376. distance: 658.4854307423969
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   1,  Average loss: 0.0080, Accuracy: 492/546 (90.1099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 506/546 (92.6740%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   3,  Average loss: 0.0028, Accuracy: 528/546 (96.7033%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   4,  Average loss: 0.0009, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.65596635007277.
Norm before scaling: 37.900612407960345. Distance: 6.801273159442684
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.4037, Accuracy: 5981/10000 (59.8100%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.2281, Accuracy: 8425/9000 (93.6111%)
Scaling by  100
Scaled Norm after poisoning: 679.1272662395465, distance: 680.1273318283863
Total norm for 4 adversaries is: 679.1272662395465. distance: 680.1273318283863
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 209, local model 28, internal_epoch   1,  Average loss: 0.0023, Accuracy: 410/423 (96.9267%)
___Train Local_ResNet_18,  epoch 209, local model 28, internal_epoch   2,  Average loss: 0.0014, Accuracy: 411/423 (97.1631%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.5887, Accuracy: 5989/10000 (59.8900%)
___Train Local_ResNet_18,  epoch 209, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 433/479 (90.3967%)
___Train Local_ResNet_18,  epoch 209, local model 51, internal_epoch   2,  Average loss: 0.0024, Accuracy: 461/479 (96.2422%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 3.4716, Accuracy: 3549/10000 (35.4900%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   1,  Average loss: 0.0061, Accuracy: 494/557 (88.6894%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 519/557 (93.1777%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 3.3796, Accuracy: 4032/10000 (40.3200%)
___Train Local_ResNet_18,  epoch 209, local model 97, internal_epoch   1,  Average loss: 0.0030, Accuracy: 395/418 (94.4976%)
___Train Local_ResNet_18,  epoch 209, local model 97, internal_epoch   2,  Average loss: 0.0014, Accuracy: 409/418 (97.8469%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 2.0016, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 209, local model 85, internal_epoch   1,  Average loss: 0.0078, Accuracy: 307/364 (84.3407%)
___Train Local_ResNet_18,  epoch 209, local model 85, internal_epoch   2,  Average loss: 0.0038, Accuracy: 342/364 (93.9560%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 5.6465, Accuracy: 2360/10000 (23.6000%)
___Train Local_ResNet_18,  epoch 209, local model 59, internal_epoch   1,  Average loss: 0.0105, Accuracy: 587/642 (91.4330%)
___Train Local_ResNet_18,  epoch 209, local model 59, internal_epoch   2,  Average loss: 0.0169, Accuracy: 477/642 (74.2991%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 38.9841, Accuracy: 1347/10000 (13.4700%)
time spent on training: 274.5357668399811
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4208517476898353  data num: [526, 527, 496, 546, 423, 479, 557, 418, 364, 642]
[foolsgold agg] considering poison per batch poison_fraction: 0.032879042788268385
[foolsgold agg] wv: [0.4139507  0.         0.09456978 0.         0.07662873 1.
 1.         1.         0.07662873 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 209: Average loss: 0.7101, Accuracy: 7662/10000 (76.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 209: Average loss: 6.4056, Accuracy: 240/9000 (2.6667%)
Done in 329.1322965621948 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:210 choose agents : [17, 33, 77, 11, 51, 13, 57, 76, 80, 85]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   1,  Average loss: 0.0134, Accuracy: 461/526 (87.6426%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   2,  Average loss: 0.0156, Accuracy: 436/526 (82.8897%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   3,  Average loss: 0.0094, Accuracy: 451/526 (85.7414%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   4,  Average loss: 0.0065, Accuracy: 487/526 (92.5856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   5,  Average loss: 0.0029, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   6,  Average loss: 0.0037, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Global model norm: 37.65478148070142.
Norm before scaling: 38.58066738028015. Distance: 10.264228435492683
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.7582, Accuracy: 4778/10000 (47.7800%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.1449, Accuracy: 8595/9000 (95.5000%)
Scaling by  100
Scaled Norm after poisoning: 1025.4194873318918, distance: 1026.4229147870774
Total norm for 4 adversaries is: 1025.4194873318918. distance: 1026.4229147870774
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   1,  Average loss: 0.0132, Accuracy: 445/527 (84.4402%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   2,  Average loss: 0.0118, Accuracy: 446/527 (84.6300%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   3,  Average loss: 0.0072, Accuracy: 480/527 (91.0816%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   4,  Average loss: 0.0043, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   5,  Average loss: 0.0031, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   6,  Average loss: 0.0022, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Global model norm: 37.65478148070142.
Norm before scaling: 38.63963302406449. Distance: 10.165404152779931
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.6449, Accuracy: 5008/10000 (50.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.7326, Accuracy: 7035/9000 (78.1667%)
Scaling by  100
Scaled Norm after poisoning: 1015.8507518331618, distance: 1016.5404259054334
Total norm for 4 adversaries is: 1015.8507518331618. distance: 1016.5404259054334
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   1,  Average loss: 0.0103, Accuracy: 433/496 (87.2984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   2,  Average loss: 0.0071, Accuracy: 444/496 (89.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   3,  Average loss: 0.0041, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   4,  Average loss: 0.0018, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   5,  Average loss: 0.0010, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.65478148070142.
Norm before scaling: 37.96848154483285. Distance: 6.880331573037134
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.0951, Accuracy: 6342/10000 (63.4200%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.1586, Accuracy: 8662/9000 (96.2444%)
Scaling by  100
Scaled Norm after poisoning: 687.3469829714829, distance: 688.0330660658686
Total norm for 4 adversaries is: 687.3469829714829. distance: 688.0330660658686
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 487/546 (89.1941%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   2,  Average loss: 0.0057, Accuracy: 508/546 (93.0403%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   3,  Average loss: 0.0019, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.65478148070142.
Norm before scaling: 37.89275283973754. Distance: 6.788826783612938
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.2848, Accuracy: 6035/10000 (60.3500%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.1876, Accuracy: 8576/9000 (95.2889%)
Scaling by  100
Scaled Norm after poisoning: 677.8558797782904, distance: 678.882698814751
Total norm for 4 adversaries is: 677.8558797782904. distance: 678.882698814751
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 210, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 436/479 (91.0230%)
___Train Local_ResNet_18,  epoch 210, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 458/479 (95.6159%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 6.5664, Accuracy: 2835/10000 (28.3500%)
___Train Local_ResNet_18,  epoch 210, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 573/620 (92.4194%)
___Train Local_ResNet_18,  epoch 210, local model 13, internal_epoch   2,  Average loss: 0.0030, Accuracy: 578/620 (93.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 2.2874, Accuracy: 4764/10000 (47.6400%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   1,  Average loss: 0.0068, Accuracy: 247/290 (85.1724%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   2,  Average loss: 0.0018, Accuracy: 280/290 (96.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 4.1757, Accuracy: 3866/10000 (38.6600%)
___Train Local_ResNet_18,  epoch 210, local model 76, internal_epoch   1,  Average loss: 0.0374, Accuracy: 59/65 (90.7692%)
___Train Local_ResNet_18,  epoch 210, local model 76, internal_epoch   2,  Average loss: 0.0425, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 2.4502, Accuracy: 4194/10000 (41.9400%)
___Train Local_ResNet_18,  epoch 210, local model 80, internal_epoch   1,  Average loss: 0.0066, Accuracy: 311/363 (85.6749%)
___Train Local_ResNet_18,  epoch 210, local model 80, internal_epoch   2,  Average loss: 0.0015, Accuracy: 352/363 (96.9697%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 4.7719, Accuracy: 3299/10000 (32.9900%)
___Train Local_ResNet_18,  epoch 210, local model 85, internal_epoch   1,  Average loss: 0.0079, Accuracy: 309/364 (84.8901%)
___Train Local_ResNet_18,  epoch 210, local model 85, internal_epoch   2,  Average loss: 0.0035, Accuracy: 340/364 (93.4066%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 3.7055, Accuracy: 3064/10000 (30.6400%)
time spent on training: 275.5510964393616
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4899438727782975  data num: [526, 527, 496, 546, 479, 620, 290, 65, 363, 364]
[foolsgold agg] considering poison per batch poison_fraction: 0.038276865060804494
[foolsgold agg] wv: [0.52874004 0.         0.         0.         1.         0.
 0.         0.71852656 0.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 210: Average loss: 0.7085, Accuracy: 7666/10000 (76.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 210: Average loss: 6.3789, Accuracy: 248/9000 (2.7556%)
Done in 330.8634443283081 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:211 choose agents : [17, 33, 77, 11, 90, 24, 63, 1, 52, 31]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   1,  Average loss: 0.0148, Accuracy: 459/526 (87.2624%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   2,  Average loss: 0.0162, Accuracy: 433/526 (82.3194%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   3,  Average loss: 0.0081, Accuracy: 460/526 (87.4525%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   4,  Average loss: 0.0039, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   5,  Average loss: 0.0023, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   6,  Average loss: 0.0024, Accuracy: 508/526 (96.5779%), train_poison_data_count: 45
Global model norm: 37.653149185090584.
Norm before scaling: 38.74024417262606. Distance: 10.816428115949368
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.7754, Accuracy: 4755/10000 (47.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.1798, Accuracy: 8405/9000 (93.3889%)
Scaling by  100
Scaled Norm after poisoning: 1080.7284580318963, distance: 1081.6426743615473
Total norm for 4 adversaries is: 1080.7284580318963. distance: 1081.6426743615473
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   1,  Average loss: 0.0164, Accuracy: 444/527 (84.2505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   2,  Average loss: 0.0122, Accuracy: 454/527 (86.1480%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   3,  Average loss: 0.0089, Accuracy: 460/527 (87.2865%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   4,  Average loss: 0.0061, Accuracy: 485/527 (92.0304%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   5,  Average loss: 0.0032, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   6,  Average loss: 0.0023, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Global model norm: 37.653149185090584.
Norm before scaling: 38.587480513033626. Distance: 10.185591630115
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.7225, Accuracy: 5081/10000 (50.8100%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.4302, Accuracy: 7751/9000 (86.1222%)
Scaling by  100
Scaled Norm after poisoning: 1017.6587406886456, distance: 1018.5591845837923
Total norm for 4 adversaries is: 1017.6587406886456. distance: 1018.5591845837923
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   1,  Average loss: 0.0095, Accuracy: 431/496 (86.8952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   2,  Average loss: 0.0065, Accuracy: 447/496 (90.1210%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   3,  Average loss: 0.0038, Accuracy: 472/496 (95.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   4,  Average loss: 0.0029, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   6,  Average loss: 0.0011, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Global model norm: 37.653149185090584.
Norm before scaling: 37.92444367073003. Distance: 6.749611454836476
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.1444, Accuracy: 6297/10000 (62.9700%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.1303, Accuracy: 8655/9000 (96.1667%)
Scaling by  100
Scaled Norm after poisoning: 674.1550730358706, distance: 674.9611099907905
Total norm for 4 adversaries is: 674.1550730358706. distance: 674.9611099907905
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 487/546 (89.1941%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   2,  Average loss: 0.0056, Accuracy: 504/546 (92.3077%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   3,  Average loss: 0.0025, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   4,  Average loss: 0.0017, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   6,  Average loss: 0.0011, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.653149185090584.
Norm before scaling: 37.91890375154258. Distance: 6.782480154658755
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.2324, Accuracy: 6284/10000 (62.8400%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.2585, Accuracy: 8435/9000 (93.7222%)
Scaling by  100
Scaled Norm after poisoning: 677.3818854604838, distance: 678.2479957581887
Total norm for 4 adversaries is: 677.3818854604838. distance: 678.2479957581887
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 211, local model 90, internal_epoch   1,  Average loss: 0.0144, Accuracy: 515/578 (89.1003%)
___Train Local_ResNet_18,  epoch 211, local model 90, internal_epoch   2,  Average loss: 0.0191, Accuracy: 377/578 (65.2249%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 524.7768, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 24, internal_epoch   1,  Average loss: 0.0041, Accuracy: 291/320 (90.9375%)
___Train Local_ResNet_18,  epoch 211, local model 24, internal_epoch   2,  Average loss: 0.0008, Accuracy: 315/320 (98.4375%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.8977, Accuracy: 3996/10000 (39.9600%)
___Train Local_ResNet_18,  epoch 211, local model 63, internal_epoch   1,  Average loss: 0.0026, Accuracy: 712/752 (94.6809%)
___Train Local_ResNet_18,  epoch 211, local model 63, internal_epoch   2,  Average loss: 0.0023, Accuracy: 716/752 (95.2128%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.3157, Accuracy: 6289/10000 (62.8900%)
___Train Local_ResNet_18,  epoch 211, local model 1, internal_epoch   1,  Average loss: 0.0090, Accuracy: 593/641 (92.5117%)
___Train Local_ResNet_18,  epoch 211, local model 1, internal_epoch   2,  Average loss: 0.0111, Accuracy: 560/641 (87.3635%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 5.6317, Accuracy: 3539/10000 (35.3900%)
___Train Local_ResNet_18,  epoch 211, local model 52, internal_epoch   1,  Average loss: 0.0078, Accuracy: 181/214 (84.5794%)
___Train Local_ResNet_18,  epoch 211, local model 52, internal_epoch   2,  Average loss: 0.0020, Accuracy: 210/214 (98.1308%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 3.8499, Accuracy: 3651/10000 (36.5100%)
___Train Local_ResNet_18,  epoch 211, local model 31, internal_epoch   1,  Average loss: 0.0041, Accuracy: 658/706 (93.2011%)
___Train Local_ResNet_18,  epoch 211, local model 31, internal_epoch   2,  Average loss: 0.0098, Accuracy: 583/706 (82.5779%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 3.4714, Accuracy: 3878/10000 (38.7800%)
time spent on training: 273.49889731407166
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3948360346777233  data num: [526, 527, 496, 546, 578, 320, 752, 641, 214, 706]
[foolsgold agg] considering poison per batch poison_fraction: 0.030846565209197135
[foolsgold agg] wv: [0.44228328 0.         0.14821041 0.         1.         0.
 0.         0.         0.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 211: Average loss: 0.7080, Accuracy: 7673/10000 (76.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 211: Average loss: 6.3794, Accuracy: 245/9000 (2.7222%)
Done in 327.8749186992645 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:212 choose agents : [17, 33, 77, 11, 59, 67, 71, 66, 76, 96]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   1,  Average loss: 0.0137, Accuracy: 454/526 (86.3118%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   2,  Average loss: 0.0165, Accuracy: 428/526 (81.3688%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   3,  Average loss: 0.0103, Accuracy: 468/526 (88.9734%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   4,  Average loss: 0.0063, Accuracy: 486/526 (92.3954%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   5,  Average loss: 0.0057, Accuracy: 490/526 (93.1559%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   6,  Average loss: 0.0043, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Global model norm: 37.65184913339665.
Norm before scaling: 38.890151036686014. Distance: 11.346488348892908
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1.8159, Accuracy: 4332/10000 (43.3200%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.2127, Accuracy: 8310/9000 (92.3333%)
Scaling by  100
Scaled Norm after poisoning: 1133.7768188669231, distance: 1134.6488994398223
Total norm for 4 adversaries is: 1133.7768188669231. distance: 1134.6488994398223
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   1,  Average loss: 0.0145, Accuracy: 440/527 (83.4915%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   2,  Average loss: 0.0139, Accuracy: 435/527 (82.5427%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   3,  Average loss: 0.0093, Accuracy: 468/527 (88.8046%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   4,  Average loss: 0.0049, Accuracy: 497/527 (94.3074%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   5,  Average loss: 0.0044, Accuracy: 497/527 (94.3074%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   6,  Average loss: 0.0027, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Global model norm: 37.65184913339665.
Norm before scaling: 38.84884224716758. Distance: 10.971596546817278
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1.8387, Accuracy: 4707/10000 (47.0700%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.2471, Accuracy: 8258/9000 (91.7556%)
Scaling by  100
Scaled Norm after poisoning: 1096.4926470341695, distance: 1097.1595143824802
Total norm for 4 adversaries is: 1096.4926470341695. distance: 1097.1595143824802
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   1,  Average loss: 0.0113, Accuracy: 429/496 (86.4919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   2,  Average loss: 0.0083, Accuracy: 435/496 (87.7016%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   3,  Average loss: 0.0053, Accuracy: 462/496 (93.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   4,  Average loss: 0.0023, Accuracy: 479/496 (96.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   5,  Average loss: 0.0013, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   6,  Average loss: 0.0011, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.65184913339665.
Norm before scaling: 37.93660386863771. Distance: 6.873115419965816
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1.1093, Accuracy: 6279/10000 (62.7900%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.1254, Accuracy: 8664/9000 (96.2667%)
Scaling by  100
Scaled Norm after poisoning: 686.4716399823084, distance: 687.3114741512759
Total norm for 4 adversaries is: 686.4716399823084. distance: 687.3114741512759
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   1,  Average loss: 0.0090, Accuracy: 487/546 (89.1941%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 511/546 (93.5897%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   3,  Average loss: 0.0025, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   4,  Average loss: 0.0015, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.65184913339665.
Norm before scaling: 37.84117585175902. Distance: 6.568461008729012
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1.2729, Accuracy: 6162/10000 (61.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.1666, Accuracy: 8602/9000 (95.5778%)
Scaling by  100
Scaled Norm after poisoning: 655.728054341127, distance: 656.8460626356833
Total norm for 4 adversaries is: 655.728054341127. distance: 656.8460626356833
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 212, local model 59, internal_epoch   1,  Average loss: 0.0093, Accuracy: 585/642 (91.1215%)
___Train Local_ResNet_18,  epoch 212, local model 59, internal_epoch   2,  Average loss: 0.0164, Accuracy: 464/642 (72.2741%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1208.5660, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 771/842 (91.5677%)
___Train Local_ResNet_18,  epoch 212, local model 67, internal_epoch   2,  Average loss: 0.0117, Accuracy: 677/842 (80.4038%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 10.5717, Accuracy: 2419/10000 (24.1900%)
___Train Local_ResNet_18,  epoch 212, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 1051/1166 (90.1372%)
___Train Local_ResNet_18,  epoch 212, local model 71, internal_epoch   2,  Average loss: 0.0131, Accuracy: 859/1166 (73.6707%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 38.0612, Accuracy: 1233/10000 (12.3300%)
___Train Local_ResNet_18,  epoch 212, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 511/555 (92.0721%)
___Train Local_ResNet_18,  epoch 212, local model 66, internal_epoch   2,  Average loss: 0.0016, Accuracy: 535/555 (96.3964%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 3.9277, Accuracy: 3524/10000 (35.2400%)
___Train Local_ResNet_18,  epoch 212, local model 76, internal_epoch   1,  Average loss: 0.0267, Accuracy: 60/65 (92.3077%)
___Train Local_ResNet_18,  epoch 212, local model 76, internal_epoch   2,  Average loss: 0.0566, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 0.8800, Accuracy: 7231/10000 (72.3100%)
___Train Local_ResNet_18,  epoch 212, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 628/708 (88.7006%)
___Train Local_ResNet_18,  epoch 212, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 631/708 (89.1243%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 3.2894, Accuracy: 3529/10000 (35.2900%)
time spent on training: 275.07137989997864
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3449695372962292  data num: [526, 527, 496, 546, 642, 842, 1166, 555, 65, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.026950745101267905
[foolsgold agg] wv: [0.50625089 0.         0.11362098 0.         0.25293453 0.19441768
 0.19441768 1.         0.25293453 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 212: Average loss: 0.7055, Accuracy: 7667/10000 (76.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 212: Average loss: 6.3691, Accuracy: 246/9000 (2.7333%)
Done in 329.70113492012024 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:213 choose agents : [17, 33, 77, 11, 80, 81, 22, 72, 64, 45]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   1,  Average loss: 0.0133, Accuracy: 461/526 (87.6426%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   2,  Average loss: 0.0160, Accuracy: 433/526 (82.3194%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   3,  Average loss: 0.0077, Accuracy: 461/526 (87.6426%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   4,  Average loss: 0.0057, Accuracy: 494/526 (93.9163%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   5,  Average loss: 0.0028, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   6,  Average loss: 0.0037, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Global model norm: 37.65083272755232.
Norm before scaling: 38.54435414335185. Distance: 10.027702488591643
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.6714, Accuracy: 4972/10000 (49.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.6564, Accuracy: 7246/9000 (80.5111%)
Scaling by  100
Scaled Norm after poisoning: 1001.8575559928667, distance: 1002.7701630982046
Total norm for 4 adversaries is: 1001.8575559928667. distance: 1002.7701630982046
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   1,  Average loss: 0.0144, Accuracy: 440/527 (83.4915%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   2,  Average loss: 0.0156, Accuracy: 432/527 (81.9734%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   3,  Average loss: 0.0084, Accuracy: 456/527 (86.5275%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   4,  Average loss: 0.0049, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   5,  Average loss: 0.0035, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   6,  Average loss: 0.0032, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Global model norm: 37.65083272755232.
Norm before scaling: 38.645459728371556. Distance: 10.415226544330496
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 2.0026, Accuracy: 4680/10000 (46.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.3385, Accuracy: 8024/9000 (89.1556%)
Scaling by  100
Scaled Norm after poisoning: 1040.6382056219154, distance: 1041.522683382364
Total norm for 4 adversaries is: 1040.6382056219154. distance: 1041.522683382364
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   1,  Average loss: 0.0073, Accuracy: 435/496 (87.7016%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   2,  Average loss: 0.0060, Accuracy: 457/496 (92.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   3,  Average loss: 0.0039, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   4,  Average loss: 0.0020, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   5,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.65083272755232.
Norm before scaling: 37.88294864251676. Distance: 6.296451223042261
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.0214, Accuracy: 6628/10000 (66.2800%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.1689, Accuracy: 8666/9000 (96.2889%)
Scaling by  100
Scaled Norm after poisoning: 629.0145566678087, distance: 629.6451877843584
Total norm for 4 adversaries is: 629.0145566678087. distance: 629.6451877843584
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   1,  Average loss: 0.0083, Accuracy: 482/546 (88.2784%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 502/546 (91.9414%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   3,  Average loss: 0.0037, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   4,  Average loss: 0.0020, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   5,  Average loss: 0.0011, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.65083272755232.
Norm before scaling: 37.923336395409294. Distance: 6.989456956368061
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.4841, Accuracy: 5550/10000 (55.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.2901, Accuracy: 8253/9000 (91.7000%)
Scaling by  100
Scaled Norm after poisoning: 697.9375419763577, distance: 698.9456792197802
Total norm for 4 adversaries is: 697.9375419763577. distance: 698.9456792197802
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 213, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 322/363 (88.7052%)
___Train Local_ResNet_18,  epoch 213, local model 80, internal_epoch   2,  Average loss: 0.0016, Accuracy: 356/363 (98.0716%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 3.1528, Accuracy: 4255/10000 (42.5500%)
___Train Local_ResNet_18,  epoch 213, local model 81, internal_epoch   1,  Average loss: 0.0071, Accuracy: 913/1034 (88.2979%)
___Train Local_ResNet_18,  epoch 213, local model 81, internal_epoch   2,  Average loss: 0.0144, Accuracy: 769/1034 (74.3714%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 24.2633, Accuracy: 1885/10000 (18.8500%)
___Train Local_ResNet_18,  epoch 213, local model 22, internal_epoch   1,  Average loss: 0.0075, Accuracy: 426/494 (86.2348%)
___Train Local_ResNet_18,  epoch 213, local model 22, internal_epoch   2,  Average loss: 0.0031, Accuracy: 463/494 (93.7247%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 2.7307, Accuracy: 4068/10000 (40.6800%)
___Train Local_ResNet_18,  epoch 213, local model 72, internal_epoch   1,  Average loss: 0.0092, Accuracy: 515/618 (83.3333%)
___Train Local_ResNet_18,  epoch 213, local model 72, internal_epoch   2,  Average loss: 0.0073, Accuracy: 540/618 (87.3786%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 4.4836, Accuracy: 3320/10000 (33.2000%)
___Train Local_ResNet_18,  epoch 213, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 621/686 (90.5248%)
___Train Local_ResNet_18,  epoch 213, local model 64, internal_epoch   2,  Average loss: 0.0045, Accuracy: 624/686 (90.9621%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 3.3945, Accuracy: 4294/10000 (42.9400%)
___Train Local_ResNet_18,  epoch 213, local model 45, internal_epoch   1,  Average loss: 0.0063, Accuracy: 465/529 (87.9017%)
___Train Local_ResNet_18,  epoch 213, local model 45, internal_epoch   2,  Average loss: 0.0085, Accuracy: 460/529 (86.9565%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 10.1431, Accuracy: 1679/10000 (16.7900%)
time spent on training: 281.77454710006714
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3600274961333563  data num: [526, 527, 496, 546, 363, 1034, 494, 618, 686, 529]
[foolsgold agg] considering poison per batch poison_fraction: 0.02812714813541846
[foolsgold agg] wv: [0.57076776 0.         0.18116945 0.         1.         1.
 0.65199331 1.         1.         0.65199331]
___Test Target_ResNet_18 poisoned: False, epoch: 213: Average loss: 0.7038, Accuracy: 7677/10000 (76.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 213: Average loss: 6.3474, Accuracy: 248/9000 (2.7556%)
Done in 336.48863911628723 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:214 choose agents : [17, 33, 77, 11, 80, 54, 44, 35, 68, 25]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   1,  Average loss: 0.0142, Accuracy: 462/526 (87.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   2,  Average loss: 0.0132, Accuracy: 451/526 (85.7414%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   3,  Average loss: 0.0085, Accuracy: 456/526 (86.6920%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   4,  Average loss: 0.0034, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   5,  Average loss: 0.0029, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   6,  Average loss: 0.0024, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Global model norm: 37.65046960302255.
Norm before scaling: 38.451680565109896. Distance: 9.685905866822035
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.7369, Accuracy: 5029/10000 (50.2900%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.4128, Accuracy: 7852/9000 (87.2444%)
Scaling by  100
Scaled Norm after poisoning: 967.6265744077102, distance: 968.5906320525716
Total norm for 4 adversaries is: 967.6265744077102. distance: 968.5906320525716
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   1,  Average loss: 0.0150, Accuracy: 438/527 (83.1120%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   2,  Average loss: 0.0137, Accuracy: 445/527 (84.4402%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   3,  Average loss: 0.0074, Accuracy: 466/527 (88.4250%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   4,  Average loss: 0.0048, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   5,  Average loss: 0.0026, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   6,  Average loss: 0.0019, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Global model norm: 37.65046960302255.
Norm before scaling: 38.805372483636205. Distance: 10.887915647786784
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.7939, Accuracy: 4916/10000 (49.1600%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.2438, Accuracy: 8313/9000 (92.3667%)
Scaling by  100
Scaled Norm after poisoning: 1088.053422401676, distance: 1088.791589331953
Total norm for 4 adversaries is: 1088.053422401676. distance: 1088.791589331953
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   1,  Average loss: 0.0088, Accuracy: 432/496 (87.0968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   2,  Average loss: 0.0063, Accuracy: 447/496 (90.1210%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   3,  Average loss: 0.0037, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   4,  Average loss: 0.0016, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   6,  Average loss: 0.0010, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.65046960302255.
Norm before scaling: 37.925402854032086. Distance: 6.591101236442451
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.1308, Accuracy: 6265/10000 (62.6500%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.1191, Accuracy: 8718/9000 (96.8667%)
Scaling by  100
Scaled Norm after poisoning: 658.4658305485563, distance: 659.110077111555
Total norm for 4 adversaries is: 658.4658305485563. distance: 659.110077111555
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   1,  Average loss: 0.0084, Accuracy: 491/546 (89.9267%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 506/546 (92.6740%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   3,  Average loss: 0.0024, Accuracy: 528/546 (96.7033%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   4,  Average loss: 0.0008, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.65046960302255.
Norm before scaling: 37.82584184817884. Distance: 6.473059946108793
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.2070, Accuracy: 6321/10000 (63.2100%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.2110, Accuracy: 8575/9000 (95.2778%)
Scaling by  100
Scaled Norm after poisoning: 646.1858285354144, distance: 647.305955480096
Total norm for 4 adversaries is: 646.1858285354144. distance: 647.305955480096
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 214, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 318/363 (87.6033%)
___Train Local_ResNet_18,  epoch 214, local model 80, internal_epoch   2,  Average loss: 0.0013, Accuracy: 356/363 (98.0716%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 3.7451, Accuracy: 3559/10000 (35.5900%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   1,  Average loss: 0.0037, Accuracy: 406/440 (92.2727%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   2,  Average loss: 0.0008, Accuracy: 433/440 (98.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 2.9757, Accuracy: 4600/10000 (46.0000%)
___Train Local_ResNet_18,  epoch 214, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 393/436 (90.1376%)
___Train Local_ResNet_18,  epoch 214, local model 44, internal_epoch   2,  Average loss: 0.0023, Accuracy: 413/436 (94.7248%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 2.7821, Accuracy: 4145/10000 (41.4500%)
___Train Local_ResNet_18,  epoch 214, local model 35, internal_epoch   1,  Average loss: 0.0075, Accuracy: 366/419 (87.3508%)
___Train Local_ResNet_18,  epoch 214, local model 35, internal_epoch   2,  Average loss: 0.0037, Accuracy: 391/419 (93.3174%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 4.8997, Accuracy: 2892/10000 (28.9200%)
___Train Local_ResNet_18,  epoch 214, local model 68, internal_epoch   1,  Average loss: 0.0031, Accuracy: 396/416 (95.1923%)
___Train Local_ResNet_18,  epoch 214, local model 68, internal_epoch   2,  Average loss: 0.0009, Accuracy: 408/416 (98.0769%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.4343, Accuracy: 5985/10000 (59.8500%)
___Train Local_ResNet_18,  epoch 214, local model 25, internal_epoch   1,  Average loss: 0.0035, Accuracy: 508/545 (93.2110%)
___Train Local_ResNet_18,  epoch 214, local model 25, internal_epoch   2,  Average loss: 0.0031, Accuracy: 519/545 (95.2294%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 3.9232, Accuracy: 3777/10000 (37.7700%)
time spent on training: 274.1323838233948
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4444208739923632  data num: [526, 527, 496, 546, 363, 440, 436, 419, 416, 545]
[foolsgold agg] considering poison per batch poison_fraction: 0.03472038078065337
[foolsgold agg] wv: [0.67422044 0.         0.24399393 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 214: Average loss: 0.7006, Accuracy: 7683/10000 (76.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 214: Average loss: 6.3060, Accuracy: 254/9000 (2.8222%)
Done in 329.91053652763367 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:215 choose agents : [17, 33, 77, 11, 4, 79, 43, 63, 35, 49]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   1,  Average loss: 0.0145, Accuracy: 459/526 (87.2624%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   2,  Average loss: 0.0160, Accuracy: 436/526 (82.8897%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   3,  Average loss: 0.0103, Accuracy: 439/526 (83.4601%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   4,  Average loss: 0.0056, Accuracy: 494/526 (93.9163%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   5,  Average loss: 0.0037, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   6,  Average loss: 0.0021, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Global model norm: 37.64930077216325.
Norm before scaling: 38.52458377046402. Distance: 10.130217914854617
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.6553, Accuracy: 4918/10000 (49.1800%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.6432, Accuracy: 7213/9000 (80.1444%)
Scaling by  100
Scaled Norm after poisoning: 1011.9465462661553, distance: 1013.0217791340915
Total norm for 4 adversaries is: 1011.9465462661553. distance: 1013.0217791340915
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   1,  Average loss: 0.0179, Accuracy: 431/527 (81.7837%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   2,  Average loss: 0.0171, Accuracy: 416/527 (78.9374%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   3,  Average loss: 0.0095, Accuracy: 458/527 (86.9070%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   4,  Average loss: 0.0048, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   5,  Average loss: 0.0034, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   6,  Average loss: 0.0027, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Global model norm: 37.64930077216325.
Norm before scaling: 38.79498869004781. Distance: 11.09187236531143
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.9673, Accuracy: 4452/10000 (44.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.3697, Accuracy: 7899/9000 (87.7667%)
Scaling by  100
Scaled Norm after poisoning: 1108.2279210523438, distance: 1109.1872024144527
Total norm for 4 adversaries is: 1108.2279210523438. distance: 1109.1872024144527
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   1,  Average loss: 0.0090, Accuracy: 435/496 (87.7016%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   2,  Average loss: 0.0069, Accuracy: 445/496 (89.7177%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   3,  Average loss: 0.0042, Accuracy: 468/496 (94.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   4,  Average loss: 0.0028, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   5,  Average loss: 0.0013, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   6,  Average loss: 0.0011, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Global model norm: 37.64930077216325.
Norm before scaling: 37.88286164025479. Distance: 6.525760661836761
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.1351, Accuracy: 6298/10000 (62.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.1216, Accuracy: 8682/9000 (96.4667%)
Scaling by  100
Scaled Norm after poisoning: 651.750431530352, distance: 652.5760492080598
Total norm for 4 adversaries is: 651.750431530352. distance: 652.5760492080598
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   1,  Average loss: 0.0061, Accuracy: 498/546 (91.2088%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 509/546 (93.2234%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   3,  Average loss: 0.0031, Accuracy: 522/546 (95.6044%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   4,  Average loss: 0.0020, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Global model norm: 37.64930077216325.
Norm before scaling: 37.8088130950477. Distance: 6.237952866865722
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.2895, Accuracy: 6222/10000 (62.2200%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.2722, Accuracy: 8501/9000 (94.4556%)
Scaling by  100
Scaled Norm after poisoning: 622.7763944627317, distance: 623.7952388404387
Total norm for 4 adversaries is: 622.7763944627317. distance: 623.7952388404387
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 215, local model 4, internal_epoch   1,  Average loss: 0.0050, Accuracy: 500/557 (89.7666%)
___Train Local_ResNet_18,  epoch 215, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 514/557 (92.2801%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 5.4590, Accuracy: 3236/10000 (32.3600%)
___Train Local_ResNet_18,  epoch 215, local model 79, internal_epoch   1,  Average loss: 0.0094, Accuracy: 127/154 (82.4675%)
___Train Local_ResNet_18,  epoch 215, local model 79, internal_epoch   2,  Average loss: 0.0016, Accuracy: 153/154 (99.3506%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.7964, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 215, local model 43, internal_epoch   1,  Average loss: 0.0079, Accuracy: 291/345 (84.3478%)
___Train Local_ResNet_18,  epoch 215, local model 43, internal_epoch   2,  Average loss: 0.0025, Accuracy: 328/345 (95.0725%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 5.1899, Accuracy: 3170/10000 (31.7000%)
___Train Local_ResNet_18,  epoch 215, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 706/752 (93.8830%)
___Train Local_ResNet_18,  epoch 215, local model 63, internal_epoch   2,  Average loss: 0.0019, Accuracy: 722/752 (96.0106%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.4257, Accuracy: 6113/10000 (61.1300%)
___Train Local_ResNet_18,  epoch 215, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 370/419 (88.3055%)
___Train Local_ResNet_18,  epoch 215, local model 35, internal_epoch   2,  Average loss: 0.0024, Accuracy: 395/419 (94.2721%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 4.7621, Accuracy: 2771/10000 (27.7100%)
___Train Local_ResNet_18,  epoch 215, local model 49, internal_epoch   1,  Average loss: 0.0033, Accuracy: 401/426 (94.1315%)
___Train Local_ResNet_18,  epoch 215, local model 49, internal_epoch   2,  Average loss: 0.0018, Accuracy: 412/426 (96.7136%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 2.2816, Accuracy: 5024/10000 (50.2400%)
time spent on training: 277.2189612388611
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4412384161752317  data num: [526, 527, 496, 546, 557, 154, 345, 752, 419, 426]
[foolsgold agg] considering poison per batch poison_fraction: 0.034471751263689974
[foolsgold agg] wv: [1.         0.10681163 0.65440947 0.10681163 1.         0.
 0.         0.00500002 0.83525776 0.83525776]
___Test Target_ResNet_18 poisoned: False, epoch: 215: Average loss: 0.6982, Accuracy: 7694/10000 (76.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 215: Average loss: 6.2450, Accuracy: 263/9000 (2.9222%)
Done in 330.955237865448 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:216 choose agents : [17, 33, 77, 11, 8, 12, 18, 94, 57, 83]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   1,  Average loss: 0.0147, Accuracy: 457/526 (86.8821%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   2,  Average loss: 0.0160, Accuracy: 445/526 (84.6008%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   3,  Average loss: 0.0074, Accuracy: 476/526 (90.4943%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   4,  Average loss: 0.0056, Accuracy: 489/526 (92.9658%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   5,  Average loss: 0.0031, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   6,  Average loss: 0.0028, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Global model norm: 37.64791142115323.
Norm before scaling: 38.453402769720036. Distance: 9.698614229927749
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.7609, Accuracy: 4743/10000 (47.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.5158, Accuracy: 7538/9000 (83.7556%)
Scaling by  100
Scaled Norm after poisoning: 968.9025041251571, distance: 969.8613302941818
Total norm for 4 adversaries is: 968.9025041251571. distance: 969.8613302941818
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   1,  Average loss: 0.0141, Accuracy: 436/527 (82.7324%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   2,  Average loss: 0.0149, Accuracy: 449/527 (85.1992%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   3,  Average loss: 0.0076, Accuracy: 473/527 (89.7533%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   4,  Average loss: 0.0052, Accuracy: 492/527 (93.3586%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   5,  Average loss: 0.0043, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   6,  Average loss: 0.0036, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Global model norm: 37.64791142115323.
Norm before scaling: 38.70693644181799. Distance: 10.557727344909658
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.8792, Accuracy: 4726/10000 (47.2600%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.3060, Accuracy: 7986/9000 (88.7333%)
Scaling by  100
Scaled Norm after poisoning: 1054.9943127808795, distance: 1055.7726436122505
Total norm for 4 adversaries is: 1054.9943127808795. distance: 1055.7726436122505
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   1,  Average loss: 0.0101, Accuracy: 430/496 (86.6935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 449/496 (90.5242%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   3,  Average loss: 0.0031, Accuracy: 473/496 (95.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   4,  Average loss: 0.0017, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.64791142115323.
Norm before scaling: 37.86570862467039. Distance: 6.395028460262578
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.1037, Accuracy: 6395/10000 (63.9500%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.1258, Accuracy: 8673/9000 (96.3667%)
Scaling by  100
Scaled Norm after poisoning: 638.6988727091978, distance: 639.5027365070457
Total norm for 4 adversaries is: 638.6988727091978. distance: 639.5027365070457
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   1,  Average loss: 0.0081, Accuracy: 482/546 (88.2784%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   2,  Average loss: 0.0059, Accuracy: 508/546 (93.0403%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   3,  Average loss: 0.0023, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   4,  Average loss: 0.0018, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.64791142115323.
Norm before scaling: 37.88100876686512. Distance: 6.703093415299276
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.2796, Accuracy: 6045/10000 (60.4500%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.1453, Accuracy: 8688/9000 (96.5333%)
Scaling by  100
Scaled Norm after poisoning: 669.3274843079432, distance: 670.3092802952978
Total norm for 4 adversaries is: 669.3274843079432. distance: 670.3092802952978
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 216, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 485/534 (90.8240%)
___Train Local_ResNet_18,  epoch 216, local model 8, internal_epoch   2,  Average loss: 0.0067, Accuracy: 475/534 (88.9513%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 3.9779, Accuracy: 2863/10000 (28.6300%)
___Train Local_ResNet_18,  epoch 216, local model 12, internal_epoch   1,  Average loss: 0.0062, Accuracy: 857/977 (87.7175%)
___Train Local_ResNet_18,  epoch 216, local model 12, internal_epoch   2,  Average loss: 0.0087, Accuracy: 802/977 (82.0880%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 7.5437, Accuracy: 2659/10000 (26.5900%)
___Train Local_ResNet_18,  epoch 216, local model 18, internal_epoch   1,  Average loss: 0.0030, Accuracy: 366/386 (94.8187%)
___Train Local_ResNet_18,  epoch 216, local model 18, internal_epoch   2,  Average loss: 0.0011, Accuracy: 381/386 (98.7047%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.7363, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 216, local model 94, internal_epoch   1,  Average loss: 0.0076, Accuracy: 169/203 (83.2512%)
___Train Local_ResNet_18,  epoch 216, local model 94, internal_epoch   2,  Average loss: 0.0009, Accuracy: 200/203 (98.5222%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 3.7172, Accuracy: 3075/10000 (30.7500%)
___Train Local_ResNet_18,  epoch 216, local model 57, internal_epoch   1,  Average loss: 0.0062, Accuracy: 251/290 (86.5517%)
___Train Local_ResNet_18,  epoch 216, local model 57, internal_epoch   2,  Average loss: 0.0014, Accuracy: 285/290 (98.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 4.2299, Accuracy: 3811/10000 (38.1100%)
___Train Local_ResNet_18,  epoch 216, local model 83, internal_epoch   1,  Average loss: 0.0029, Accuracy: 341/366 (93.1694%)
___Train Local_ResNet_18,  epoch 216, local model 83, internal_epoch   2,  Average loss: 0.0006, Accuracy: 364/366 (99.4536%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 2.3993, Accuracy: 4719/10000 (47.1900%)
time spent on training: 273.9844481945038
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4318697175840033  data num: [526, 527, 496, 546, 534, 977, 386, 203, 290, 366]
[foolsgold agg] considering poison per batch poison_fraction: 0.033739821686250254
[foolsgold agg] wv: [0.53485223 0.         0.         0.         1.         0.26136511
 1.         0.26136511 0.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 216: Average loss: 0.6957, Accuracy: 7697/10000 (76.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 216: Average loss: 6.2263, Accuracy: 267/9000 (2.9667%)
Done in 328.06272411346436 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:217 choose agents : [17, 33, 77, 11, 37, 22, 38, 65, 29, 18]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   1,  Average loss: 0.0145, Accuracy: 459/526 (87.2624%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   2,  Average loss: 0.0146, Accuracy: 458/526 (87.0722%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   3,  Average loss: 0.0079, Accuracy: 467/526 (88.7833%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   4,  Average loss: 0.0049, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   5,  Average loss: 0.0039, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   6,  Average loss: 0.0023, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Global model norm: 37.646669554100335.
Norm before scaling: 38.62827561201525. Distance: 10.435431178296042
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.6577, Accuracy: 4869/10000 (48.6900%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.3394, Accuracy: 7928/9000 (88.0889%)
Scaling by  100
Scaled Norm after poisoning: 1042.5914827965937, distance: 1043.5430034263084
Total norm for 4 adversaries is: 1042.5914827965937. distance: 1043.5430034263084
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   1,  Average loss: 0.0129, Accuracy: 443/527 (84.0607%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   2,  Average loss: 0.0123, Accuracy: 446/527 (84.6300%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   3,  Average loss: 0.0052, Accuracy: 480/527 (91.0816%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   4,  Average loss: 0.0040, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   5,  Average loss: 0.0023, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   6,  Average loss: 0.0018, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Global model norm: 37.646669554100335.
Norm before scaling: 38.49469671012732. Distance: 9.71949573857149
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.6970, Accuracy: 5015/10000 (50.1500%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.2229, Accuracy: 8323/9000 (92.4778%)
Scaling by  100
Scaled Norm after poisoning: 971.1402447638549, distance: 971.9495550181604
Total norm for 4 adversaries is: 971.1402447638549. distance: 971.9495550181604
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   1,  Average loss: 0.0090, Accuracy: 431/496 (86.8952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   2,  Average loss: 0.0070, Accuracy: 446/496 (89.9194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   3,  Average loss: 0.0035, Accuracy: 465/496 (93.7500%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   4,  Average loss: 0.0012, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.646669554100335.
Norm before scaling: 37.925930716373. Distance: 6.605291742065806
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.1012, Accuracy: 6403/10000 (64.0300%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.1538, Accuracy: 8690/9000 (96.5556%)
Scaling by  100
Scaled Norm after poisoning: 659.8966301626339, distance: 660.529167599736
Total norm for 4 adversaries is: 659.8966301626339. distance: 660.529167599736
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   1,  Average loss: 0.0088, Accuracy: 488/546 (89.3773%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   2,  Average loss: 0.0060, Accuracy: 508/546 (93.0403%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   3,  Average loss: 0.0045, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   4,  Average loss: 0.0023, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   6,  Average loss: 0.0014, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Global model norm: 37.646669554100335.
Norm before scaling: 37.88720667570387. Distance: 6.919225043414618
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.2989, Accuracy: 5977/10000 (59.7700%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.2174, Accuracy: 8409/9000 (93.4333%)
Scaling by  100
Scaled Norm after poisoning: 690.7991522504932, distance: 691.9225706320036
Total norm for 4 adversaries is: 690.7991522504932. distance: 691.9225706320036
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 217, local model 37, internal_epoch   1,  Average loss: 0.0084, Accuracy: 622/725 (85.7931%)
___Train Local_ResNet_18,  epoch 217, local model 37, internal_epoch   2,  Average loss: 0.0146, Accuracy: 526/725 (72.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 81.9172, Accuracy: 1216/10000 (12.1600%)
___Train Local_ResNet_18,  epoch 217, local model 22, internal_epoch   1,  Average loss: 0.0061, Accuracy: 429/494 (86.8421%)
___Train Local_ResNet_18,  epoch 217, local model 22, internal_epoch   2,  Average loss: 0.0033, Accuracy: 458/494 (92.7126%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 3.3397, Accuracy: 3509/10000 (35.0900%)
___Train Local_ResNet_18,  epoch 217, local model 38, internal_epoch   1,  Average loss: 0.0025, Accuracy: 721/756 (95.3704%)
___Train Local_ResNet_18,  epoch 217, local model 38, internal_epoch   2,  Average loss: 0.0035, Accuracy: 701/756 (92.7249%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 3.1564, Accuracy: 4239/10000 (42.3900%)
___Train Local_ResNet_18,  epoch 217, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 291/314 (92.6752%)
___Train Local_ResNet_18,  epoch 217, local model 65, internal_epoch   2,  Average loss: 0.0006, Accuracy: 313/314 (99.6815%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 2.5498, Accuracy: 4065/10000 (40.6500%)
___Train Local_ResNet_18,  epoch 217, local model 29, internal_epoch   1,  Average loss: 0.0062, Accuracy: 763/848 (89.9764%)
___Train Local_ResNet_18,  epoch 217, local model 29, internal_epoch   2,  Average loss: 0.0061, Accuracy: 753/848 (88.7972%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 11.3846, Accuracy: 1345/10000 (13.4500%)
___Train Local_ResNet_18,  epoch 217, local model 18, internal_epoch   1,  Average loss: 0.0081, Accuracy: 358/386 (92.7461%)
___Train Local_ResNet_18,  epoch 217, local model 18, internal_epoch   2,  Average loss: 0.0217, Accuracy: 259/386 (67.0984%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 211.5903, Accuracy: 1021/10000 (10.2100%)
time spent on training: 279.74399971961975
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.37290850836596656  data num: [526, 527, 496, 546, 725, 494, 756, 314, 848, 386]
[foolsgold agg] considering poison per batch poison_fraction: 0.029133477216091136
[foolsgold agg] wv: [0.14599222 0.         0.05235022 0.         0.09979442 0.
 1.         0.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 217: Average loss: 0.6945, Accuracy: 7696/10000 (76.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 217: Average loss: 6.2362, Accuracy: 268/9000 (2.9778%)
Done in 333.5516390800476 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:218 choose agents : [17, 33, 77, 11, 53, 15, 7, 29, 86, 60]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   1,  Average loss: 0.0128, Accuracy: 470/526 (89.3536%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   2,  Average loss: 0.0158, Accuracy: 438/526 (83.2700%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   3,  Average loss: 0.0099, Accuracy: 450/526 (85.5513%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   4,  Average loss: 0.0060, Accuracy: 484/526 (92.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   5,  Average loss: 0.0051, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   6,  Average loss: 0.0040, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Global model norm: 37.64577460623071.
Norm before scaling: 38.6781939281926. Distance: 10.494240043789722
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 2.1319, Accuracy: 4054/10000 (40.5400%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.5010, Accuracy: 7641/9000 (84.9000%)
Scaling by  100
Scaled Norm after poisoning: 1048.606158192865, distance: 1049.4240086828584
Total norm for 4 adversaries is: 1048.606158192865. distance: 1049.4240086828584
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   1,  Average loss: 0.0151, Accuracy: 432/527 (81.9734%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   2,  Average loss: 0.0123, Accuracy: 439/527 (83.3017%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   3,  Average loss: 0.0069, Accuracy: 476/527 (90.3226%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   4,  Average loss: 0.0045, Accuracy: 497/527 (94.3074%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   5,  Average loss: 0.0048, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   6,  Average loss: 0.0037, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Global model norm: 37.64577460623071.
Norm before scaling: 38.62932792045362. Distance: 10.22894133548172
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.9066, Accuracy: 4543/10000 (45.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.2247, Accuracy: 8297/9000 (92.1889%)
Scaling by  100
Scaled Norm after poisoning: 1022.1391783901055, distance: 1022.8941782999842
Total norm for 4 adversaries is: 1022.1391783901055. distance: 1022.8941782999842
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   1,  Average loss: 0.0103, Accuracy: 440/496 (88.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   2,  Average loss: 0.0070, Accuracy: 446/496 (89.9194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   3,  Average loss: 0.0046, Accuracy: 467/496 (94.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   4,  Average loss: 0.0022, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.64577460623071.
Norm before scaling: 37.85280490092098. Distance: 6.35090692006074
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.0678, Accuracy: 6461/10000 (64.6100%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.1491, Accuracy: 8618/9000 (95.7556%)
Scaling by  100
Scaled Norm after poisoning: 634.2610365614461, distance: 635.0906923424402
Total norm for 4 adversaries is: 634.2610365614461. distance: 635.0906923424402
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   1,  Average loss: 0.0097, Accuracy: 483/546 (88.4615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 506/546 (92.6740%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   3,  Average loss: 0.0032, Accuracy: 517/546 (94.6886%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   4,  Average loss: 0.0014, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   5,  Average loss: 0.0015, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.64577460623071.
Norm before scaling: 37.91325999176443. Distance: 6.9355482500526655
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.3983, Accuracy: 5838/10000 (58.3800%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.1787, Accuracy: 8622/9000 (95.8000%)
Scaling by  100
Scaled Norm after poisoning: 692.5650917061876, distance: 693.5547923560185
Total norm for 4 adversaries is: 692.5650917061876. distance: 693.5547923560185
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 218, local model 53, internal_epoch   1,  Average loss: 0.0043, Accuracy: 568/625 (90.8800%)
___Train Local_ResNet_18,  epoch 218, local model 53, internal_epoch   2,  Average loss: 0.0032, Accuracy: 586/625 (93.7600%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 2.6808, Accuracy: 4392/10000 (43.9200%)
___Train Local_ResNet_18,  epoch 218, local model 15, internal_epoch   1,  Average loss: 0.0112, Accuracy: 286/341 (83.8710%)
___Train Local_ResNet_18,  epoch 218, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 318/341 (93.2551%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 3.7824, Accuracy: 3355/10000 (33.5500%)
___Train Local_ResNet_18,  epoch 218, local model 7, internal_epoch   1,  Average loss: 0.0030, Accuracy: 333/352 (94.6023%)
___Train Local_ResNet_18,  epoch 218, local model 7, internal_epoch   2,  Average loss: 0.0005, Accuracy: 351/352 (99.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 3.2954, Accuracy: 3718/10000 (37.1800%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 770/848 (90.8019%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   2,  Average loss: 0.0052, Accuracy: 766/848 (90.3302%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 6.6040, Accuracy: 2466/10000 (24.6600%)
___Train Local_ResNet_18,  epoch 218, local model 86, internal_epoch   1,  Average loss: 0.0051, Accuracy: 191/212 (90.0943%)
___Train Local_ResNet_18,  epoch 218, local model 86, internal_epoch   2,  Average loss: 0.0013, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.5936, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 218, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 260/284 (91.5493%)
___Train Local_ResNet_18,  epoch 218, local model 60, internal_epoch   2,  Average loss: 0.0007, Accuracy: 281/284 (98.9437%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 3.0874, Accuracy: 4146/10000 (41.4600%)
time spent on training: 271.7297887802124
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4404036157241959  data num: [526, 527, 496, 546, 625, 341, 352, 848, 212, 284]
[foolsgold agg] considering poison per batch poison_fraction: 0.0344065324784528
[foolsgold agg] wv: [0.52483949 0.         0.0412213  0.         1.         1.
 1.         0.41288739 1.         0.41288739]
___Test Target_ResNet_18 poisoned: False, epoch: 218: Average loss: 0.6932, Accuracy: 7700/10000 (77.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 218: Average loss: 6.2183, Accuracy: 272/9000 (3.0222%)
Done in 328.8332290649414 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:219 choose agents : [17, 33, 77, 11, 81, 8, 28, 1, 93, 53]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   1,  Average loss: 0.0142, Accuracy: 462/526 (87.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   2,  Average loss: 0.0148, Accuracy: 441/526 (83.8403%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   3,  Average loss: 0.0076, Accuracy: 474/526 (90.1141%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   4,  Average loss: 0.0042, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   5,  Average loss: 0.0049, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   6,  Average loss: 0.0039, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Global model norm: 37.644594280130384.
Norm before scaling: 38.420369022946346. Distance: 9.741968612842749
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.0061, Accuracy: 4770/10000 (47.7000%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.3568, Accuracy: 8009/9000 (88.9889%)
Scaling by  100
Scaled Norm after poisoning: 973.0812209163221, distance: 974.1969128466791
Total norm for 4 adversaries is: 973.0812209163221. distance: 974.1969128466791
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   1,  Average loss: 0.0161, Accuracy: 435/527 (82.5427%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   2,  Average loss: 0.0151, Accuracy: 431/527 (81.7837%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   3,  Average loss: 0.0095, Accuracy: 447/527 (84.8197%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   4,  Average loss: 0.0048, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   5,  Average loss: 0.0027, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   6,  Average loss: 0.0021, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Global model norm: 37.644594280130384.
Norm before scaling: 38.81303624076017. Distance: 10.99641290611433
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.8592, Accuracy: 4643/10000 (46.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.2610, Accuracy: 8223/9000 (91.3667%)
Scaling by  100
Scaled Norm after poisoning: 1098.8491707236258, distance: 1099.6412483169227
Total norm for 4 adversaries is: 1098.8491707236258. distance: 1099.6412483169227
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   1,  Average loss: 0.0100, Accuracy: 427/496 (86.0887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   2,  Average loss: 0.0075, Accuracy: 439/496 (88.5081%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   3,  Average loss: 0.0049, Accuracy: 459/496 (92.5403%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   4,  Average loss: 0.0020, Accuracy: 479/496 (96.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.644594280130384.
Norm before scaling: 37.93164821785942. Distance: 6.690645993096006
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.0886, Accuracy: 6444/10000 (64.4400%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.1428, Accuracy: 8664/9000 (96.2667%)
Scaling by  100
Scaled Norm after poisoning: 668.3991836844207, distance: 669.0645988990899
Total norm for 4 adversaries is: 668.3991836844207. distance: 669.0645988990899
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 488/546 (89.3773%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   2,  Average loss: 0.0048, Accuracy: 508/546 (93.0403%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   3,  Average loss: 0.0031, Accuracy: 527/546 (96.5201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   5,  Average loss: 0.0011, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 37.644594280130384.
Norm before scaling: 37.803548462640215. Distance: 6.232008712018134
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.2873, Accuracy: 6055/10000 (60.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.1957, Accuracy: 8635/9000 (95.9444%)
Scaling by  100
Scaled Norm after poisoning: 622.1832025215724, distance: 623.200885549756
Total norm for 4 adversaries is: 622.1832025215724. distance: 623.200885549756
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 219, local model 81, internal_epoch   1,  Average loss: 0.0069, Accuracy: 909/1034 (87.9110%)
___Train Local_ResNet_18,  epoch 219, local model 81, internal_epoch   2,  Average loss: 0.0135, Accuracy: 769/1034 (74.3714%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 12.4385, Accuracy: 1550/10000 (15.5000%)
___Train Local_ResNet_18,  epoch 219, local model 8, internal_epoch   1,  Average loss: 0.0050, Accuracy: 489/534 (91.5730%)
___Train Local_ResNet_18,  epoch 219, local model 8, internal_epoch   2,  Average loss: 0.0036, Accuracy: 497/534 (93.0712%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.4244, Accuracy: 4187/10000 (41.8700%)
___Train Local_ResNet_18,  epoch 219, local model 28, internal_epoch   1,  Average loss: 0.0022, Accuracy: 405/423 (95.7447%)
___Train Local_ResNet_18,  epoch 219, local model 28, internal_epoch   2,  Average loss: 0.0009, Accuracy: 419/423 (99.0544%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.7872, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 219, local model 1, internal_epoch   1,  Average loss: 0.0070, Accuracy: 586/641 (91.4197%)
___Train Local_ResNet_18,  epoch 219, local model 1, internal_epoch   2,  Average loss: 0.0151, Accuracy: 539/641 (84.0874%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 3.0524, Accuracy: 4389/10000 (43.8900%)
___Train Local_ResNet_18,  epoch 219, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 535/584 (91.6096%)
___Train Local_ResNet_18,  epoch 219, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 537/584 (91.9521%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 3.9448, Accuracy: 3623/10000 (36.2300%)
___Train Local_ResNet_18,  epoch 219, local model 53, internal_epoch   1,  Average loss: 0.0044, Accuracy: 577/625 (92.3200%)
___Train Local_ResNet_18,  epoch 219, local model 53, internal_epoch   2,  Average loss: 0.0027, Accuracy: 590/625 (94.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.5390, Accuracy: 4380/10000 (43.8000%)
time spent on training: 282.70417881011963
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.35293126684636117  data num: [526, 527, 496, 546, 1034, 534, 423, 641, 584, 625]
[foolsgold agg] considering poison per batch poison_fraction: 0.027572755222371965
[foolsgold agg] wv: [0.55352616 0.         0.09922647 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 219: Average loss: 0.6897, Accuracy: 7707/10000 (77.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 219: Average loss: 6.1946, Accuracy: 275/9000 (3.0556%)
Done in 336.7384572029114 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:220 choose agents : [17, 33, 77, 11, 12, 50, 10, 18, 39, 62]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   1,  Average loss: 0.0146, Accuracy: 467/526 (88.7833%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   2,  Average loss: 0.0136, Accuracy: 451/526 (85.7414%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   3,  Average loss: 0.0083, Accuracy: 467/526 (88.7833%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   4,  Average loss: 0.0046, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   5,  Average loss: 0.0026, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   6,  Average loss: 0.0045, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Global model norm: 37.64434621238377.
Norm before scaling: 38.44818036321339. Distance: 9.729532522201975
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.6492, Accuracy: 4773/10000 (47.7300%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.1154, Accuracy: 8628/9000 (95.8667%)
Scaling by  100
Scaled Norm after poisoning: 971.9596506542852, distance: 972.9533647611277
Total norm for 4 adversaries is: 971.9596506542852. distance: 972.9533647611277
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   1,  Average loss: 0.0130, Accuracy: 443/527 (84.0607%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   2,  Average loss: 0.0122, Accuracy: 444/527 (84.2505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   3,  Average loss: 0.0080, Accuracy: 473/527 (89.7533%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   4,  Average loss: 0.0051, Accuracy: 495/527 (93.9279%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   5,  Average loss: 0.0036, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   6,  Average loss: 0.0025, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.64434621238377.
Norm before scaling: 38.553697270718246. Distance: 9.97159318229849
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.8344, Accuracy: 4862/10000 (48.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.5222, Accuracy: 7586/9000 (84.2889%)
Scaling by  100
Scaled Norm after poisoning: 996.3582124416901, distance: 997.1593089872852
Total norm for 4 adversaries is: 996.3582124416901. distance: 997.1593089872852
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   1,  Average loss: 0.0088, Accuracy: 442/496 (89.1129%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   2,  Average loss: 0.0070, Accuracy: 449/496 (90.5242%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   3,  Average loss: 0.0041, Accuracy: 468/496 (94.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   4,  Average loss: 0.0023, Accuracy: 479/496 (96.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   5,  Average loss: 0.0007, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.64434621238377.
Norm before scaling: 37.82740860536015. Distance: 6.146683594245247
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.0655, Accuracy: 6549/10000 (65.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.1802, Accuracy: 8624/9000 (95.8222%)
Scaling by  100
Scaled Norm after poisoning: 613.871016582474, distance: 614.6683811210725
Total norm for 4 adversaries is: 613.871016582474. distance: 614.6683811210725
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   1,  Average loss: 0.0093, Accuracy: 476/546 (87.1795%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 515/546 (94.3223%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   3,  Average loss: 0.0026, Accuracy: 526/546 (96.3370%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   4,  Average loss: 0.0014, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.64434621238377.
Norm before scaling: 37.8862449143609. Distance: 6.805536753656621
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.5015, Accuracy: 5642/10000 (56.4200%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.1538, Accuracy: 8659/9000 (96.2111%)
Scaling by  100
Scaled Norm after poisoning: 679.5335716504374, distance: 680.5536349179248
Total norm for 4 adversaries is: 679.5335716504374. distance: 680.5536349179248
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 220, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 885/977 (90.5834%)
___Train Local_ResNet_18,  epoch 220, local model 12, internal_epoch   2,  Average loss: 0.0090, Accuracy: 809/977 (82.8045%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 8.1689, Accuracy: 2287/10000 (22.8700%)
___Train Local_ResNet_18,  epoch 220, local model 50, internal_epoch   1,  Average loss: 0.0025, Accuracy: 385/401 (96.0100%)
___Train Local_ResNet_18,  epoch 220, local model 50, internal_epoch   2,  Average loss: 0.0015, Accuracy: 390/401 (97.2569%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 2.5772, Accuracy: 4705/10000 (47.0500%)
___Train Local_ResNet_18,  epoch 220, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 683/752 (90.8245%)
___Train Local_ResNet_18,  epoch 220, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 706/752 (93.8830%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 5.8073, Accuracy: 2980/10000 (29.8000%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 363/386 (94.0415%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   2,  Average loss: 0.0021, Accuracy: 375/386 (97.1503%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.7787, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 220, local model 39, internal_epoch   1,  Average loss: 0.0069, Accuracy: 185/217 (85.2535%)
___Train Local_ResNet_18,  epoch 220, local model 39, internal_epoch   2,  Average loss: 0.0011, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 3.6489, Accuracy: 3515/10000 (35.1500%)
___Train Local_ResNet_18,  epoch 220, local model 62, internal_epoch   1,  Average loss: 0.0020, Accuracy: 348/358 (97.2067%)
___Train Local_ResNet_18,  epoch 220, local model 62, internal_epoch   2,  Average loss: 0.0004, Accuracy: 357/358 (99.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.3300, Accuracy: 6307/10000 (63.0700%)
time spent on training: 272.14877700805664
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.40397223293482454  data num: [526, 527, 496, 546, 977, 401, 752, 386, 217, 358]
[foolsgold agg] considering poison per batch poison_fraction: 0.03156033069803317
[foolsgold agg] wv: [0.82337712 0.         0.29097269 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 220: Average loss: 0.6860, Accuracy: 7716/10000 (77.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 220: Average loss: 6.1425, Accuracy: 290/9000 (3.2222%)
Done in 327.14396572113037 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:221 choose agents : [17, 33, 77, 11, 65, 87, 12, 74, 4, 7]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   1,  Average loss: 0.0157, Accuracy: 461/526 (87.6426%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   2,  Average loss: 0.0124, Accuracy: 443/526 (84.2205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   3,  Average loss: 0.0082, Accuracy: 457/526 (86.8821%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   4,  Average loss: 0.0045, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   5,  Average loss: 0.0048, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   6,  Average loss: 0.0048, Accuracy: 494/526 (93.9163%), train_poison_data_count: 45
Global model norm: 37.64355660024203.
Norm before scaling: 38.73037084739265. Distance: 10.63462806241379
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.8007, Accuracy: 5021/10000 (50.2100%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.6343, Accuracy: 7333/9000 (81.4778%)
Scaling by  100
Scaled Norm after poisoning: 1062.7139784532808, distance: 1063.4628578375457
Total norm for 4 adversaries is: 1062.7139784532808. distance: 1063.4628578375457
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   1,  Average loss: 0.0156, Accuracy: 440/527 (83.4915%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   2,  Average loss: 0.0134, Accuracy: 440/527 (83.4915%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   3,  Average loss: 0.0094, Accuracy: 457/527 (86.7173%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   4,  Average loss: 0.0042, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   5,  Average loss: 0.0024, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   6,  Average loss: 0.0019, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 37.64355660024203.
Norm before scaling: 38.80549359314751. Distance: 10.938800145939796
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.8935, Accuracy: 4738/10000 (47.3800%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.4624, Accuracy: 7666/9000 (85.1778%)
Scaling by  100
Scaled Norm after poisoning: 1093.1182461197873, distance: 1093.8799637071702
Total norm for 4 adversaries is: 1093.1182461197873. distance: 1093.8799637071702
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   1,  Average loss: 0.0089, Accuracy: 440/496 (88.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 459/496 (92.5403%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   3,  Average loss: 0.0035, Accuracy: 477/496 (96.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   4,  Average loss: 0.0025, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   5,  Average loss: 0.0013, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.64355660024203.
Norm before scaling: 37.83318616751618. Distance: 6.268370523880844
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.1128, Accuracy: 6292/10000 (62.9200%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.1433, Accuracy: 8664/9000 (96.2667%)
Scaling by  100
Scaled Norm after poisoning: 625.9741907618876, distance: 626.8370751239911
Total norm for 4 adversaries is: 625.9741907618876. distance: 626.8370751239911
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   1,  Average loss: 0.0083, Accuracy: 486/546 (89.0110%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 505/546 (92.4908%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   3,  Average loss: 0.0038, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   4,  Average loss: 0.0013, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.64355660024203.
Norm before scaling: 37.83995000533497. Distance: 6.556254584908133
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.4118, Accuracy: 6013/10000 (60.1300%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.2480, Accuracy: 8432/9000 (93.6889%)
Scaling by  100
Scaled Norm after poisoning: 654.5577228174762, distance: 655.625464728148
Total norm for 4 adversaries is: 654.5577228174762. distance: 655.625464728148
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 221, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 276/314 (87.8981%)
___Train Local_ResNet_18,  epoch 221, local model 65, internal_epoch   2,  Average loss: 0.0014, Accuracy: 306/314 (97.4522%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 2.8260, Accuracy: 3852/10000 (38.5200%)
___Train Local_ResNet_18,  epoch 221, local model 87, internal_epoch   1,  Average loss: 0.0093, Accuracy: 328/397 (82.6196%)
___Train Local_ResNet_18,  epoch 221, local model 87, internal_epoch   2,  Average loss: 0.0072, Accuracy: 356/397 (89.6725%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 3.5443, Accuracy: 3525/10000 (35.2500%)
___Train Local_ResNet_18,  epoch 221, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 876/977 (89.6622%)
___Train Local_ResNet_18,  epoch 221, local model 12, internal_epoch   2,  Average loss: 0.0112, Accuracy: 791/977 (80.9621%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 8.4303, Accuracy: 2572/10000 (25.7200%)
___Train Local_ResNet_18,  epoch 221, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 421/469 (89.7655%)
___Train Local_ResNet_18,  epoch 221, local model 74, internal_epoch   2,  Average loss: 0.0036, Accuracy: 434/469 (92.5373%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 2.7931, Accuracy: 4009/10000 (40.0900%)
___Train Local_ResNet_18,  epoch 221, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 487/557 (87.4327%)
___Train Local_ResNet_18,  epoch 221, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 513/557 (92.1005%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 4.2017, Accuracy: 4091/10000 (40.9100%)
___Train Local_ResNet_18,  epoch 221, local model 7, internal_epoch   1,  Average loss: 0.0028, Accuracy: 334/352 (94.8864%)
___Train Local_ResNet_18,  epoch 221, local model 7, internal_epoch   2,  Average loss: 0.0008, Accuracy: 348/352 (98.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 2.1749, Accuracy: 4987/10000 (49.8700%)
time spent on training: 278.3097071647644
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4059290835109475  data num: [526, 527, 496, 546, 314, 397, 977, 469, 557, 352]
[foolsgold agg] considering poison per batch poison_fraction: 0.03171320964929277
[foolsgold agg] wv: [0.77641531 0.         0.22848807 0.         1.         0.95656672
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 221: Average loss: 0.6834, Accuracy: 7730/10000 (77.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 221: Average loss: 6.1160, Accuracy: 300/9000 (3.3333%)
Done in 333.2144105434418 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:222 choose agents : [17, 33, 77, 11, 35, 30, 72, 51, 63, 46]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   1,  Average loss: 0.0148, Accuracy: 461/526 (87.6426%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   2,  Average loss: 0.0147, Accuracy: 448/526 (85.1711%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   3,  Average loss: 0.0086, Accuracy: 453/526 (86.1217%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   4,  Average loss: 0.0050, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   5,  Average loss: 0.0031, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   6,  Average loss: 0.0026, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Global model norm: 37.64314314169232.
Norm before scaling: 38.6139749637356. Distance: 10.315815710450272
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.6954, Accuracy: 4951/10000 (49.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.7879, Accuracy: 6995/9000 (77.7222%)
Scaling by  100
Scaled Norm after poisoning: 1030.6984282514454, distance: 1031.581613349133
Total norm for 4 adversaries is: 1030.6984282514454. distance: 1031.581613349133
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   1,  Average loss: 0.0133, Accuracy: 450/527 (85.3890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   2,  Average loss: 0.0125, Accuracy: 442/527 (83.8710%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   3,  Average loss: 0.0072, Accuracy: 487/527 (92.4099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   4,  Average loss: 0.0047, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   5,  Average loss: 0.0042, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   6,  Average loss: 0.0026, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Global model norm: 37.64314314169232.
Norm before scaling: 38.564964277522186. Distance: 10.055356350981045
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.7054, Accuracy: 4921/10000 (49.2100%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.1386, Accuracy: 8586/9000 (95.4000%)
Scaling by  100
Scaled Norm after poisoning: 1004.7053672594767, distance: 1005.5355848999079
Total norm for 4 adversaries is: 1004.7053672594767. distance: 1005.5355848999079
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   1,  Average loss: 0.0103, Accuracy: 433/496 (87.2984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   2,  Average loss: 0.0081, Accuracy: 437/496 (88.1048%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   3,  Average loss: 0.0039, Accuracy: 467/496 (94.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   4,  Average loss: 0.0022, Accuracy: 478/496 (96.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   5,  Average loss: 0.0014, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   6,  Average loss: 0.0012, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Global model norm: 37.64314314169232.
Norm before scaling: 37.910412037068554. Distance: 6.651614872173136
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.0815, Accuracy: 6406/10000 (64.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.0906, Accuracy: 8766/9000 (97.4000%)
Scaling by  100
Scaled Norm after poisoning: 664.4182605859054, distance: 665.1614465676736
Total norm for 4 adversaries is: 664.4182605859054. distance: 665.1614465676736
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   1,  Average loss: 0.0085, Accuracy: 479/546 (87.7289%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 505/546 (92.4908%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   3,  Average loss: 0.0040, Accuracy: 521/546 (95.4212%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   4,  Average loss: 0.0022, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 37.64314314169232.
Norm before scaling: 37.99625739690522. Distance: 7.368200497445536
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.2823, Accuracy: 6004/10000 (60.0400%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.1297, Accuracy: 8714/9000 (96.8222%)
Scaling by  100
Scaled Norm after poisoning: 735.9094288701566, distance: 736.8199831030644
Total norm for 4 adversaries is: 735.9094288701566. distance: 736.8199831030644
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 222, local model 35, internal_epoch   1,  Average loss: 0.0077, Accuracy: 364/419 (86.8735%)
___Train Local_ResNet_18,  epoch 222, local model 35, internal_epoch   2,  Average loss: 0.0027, Accuracy: 396/419 (94.5107%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 3.2231, Accuracy: 3998/10000 (39.9800%)
___Train Local_ResNet_18,  epoch 222, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 299/337 (88.7240%)
___Train Local_ResNet_18,  epoch 222, local model 30, internal_epoch   2,  Average loss: 0.0051, Accuracy: 311/337 (92.2849%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 5.0069, Accuracy: 2773/10000 (27.7300%)
___Train Local_ResNet_18,  epoch 222, local model 72, internal_epoch   1,  Average loss: 0.0080, Accuracy: 524/618 (84.7896%)
___Train Local_ResNet_18,  epoch 222, local model 72, internal_epoch   2,  Average loss: 0.0060, Accuracy: 544/618 (88.0259%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 6.3455, Accuracy: 3168/10000 (31.6800%)
___Train Local_ResNet_18,  epoch 222, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 441/479 (92.0668%)
___Train Local_ResNet_18,  epoch 222, local model 51, internal_epoch   2,  Average loss: 0.0022, Accuracy: 458/479 (95.6159%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 7.6516, Accuracy: 2314/10000 (23.1400%)
___Train Local_ResNet_18,  epoch 222, local model 63, internal_epoch   1,  Average loss: 0.0025, Accuracy: 714/752 (94.9468%)
___Train Local_ResNet_18,  epoch 222, local model 63, internal_epoch   2,  Average loss: 0.0017, Accuracy: 725/752 (96.4096%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.4120, Accuracy: 6044/10000 (60.4400%)
___Train Local_ResNet_18,  epoch 222, local model 46, internal_epoch   1,  Average loss: 0.0015, Accuracy: 588/601 (97.8369%)
___Train Local_ResNet_18,  epoch 222, local model 46, internal_epoch   2,  Average loss: 0.0009, Accuracy: 592/601 (98.5025%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.8947, Accuracy: 5394/10000 (53.9400%)
time spent on training: 277.4698677062988
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.39520845123561593  data num: [526, 527, 496, 546, 419, 337, 618, 479, 752, 601]
[foolsgold agg] considering poison per batch poison_fraction: 0.030875660252782496
[foolsgold agg] wv: [0.75704982 0.         0.18045548 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 222: Average loss: 0.6806, Accuracy: 7742/10000 (77.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 222: Average loss: 6.0661, Accuracy: 313/9000 (3.4778%)
Done in 329.6304099559784 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:223 choose agents : [17, 33, 77, 11, 54, 95, 26, 2, 82, 45]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   1,  Average loss: 0.0139, Accuracy: 462/526 (87.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   2,  Average loss: 0.0137, Accuracy: 443/526 (84.2205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   3,  Average loss: 0.0097, Accuracy: 457/526 (86.8821%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   4,  Average loss: 0.0059, Accuracy: 492/526 (93.5361%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   5,  Average loss: 0.0028, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   6,  Average loss: 0.0024, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Global model norm: 37.642505920211065.
Norm before scaling: 38.97046501588976. Distance: 11.398173778220599
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.9241, Accuracy: 4594/10000 (45.9400%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.1392, Accuracy: 8546/9000 (94.9556%)
Scaling by  100
Scaled Norm after poisoning: 1139.2026817033043, distance: 1139.8174195896463
Total norm for 4 adversaries is: 1139.2026817033043. distance: 1139.8174195896463
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   1,  Average loss: 0.0164, Accuracy: 443/527 (84.0607%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   2,  Average loss: 0.0126, Accuracy: 442/527 (83.8710%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   3,  Average loss: 0.0076, Accuracy: 470/527 (89.1841%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   4,  Average loss: 0.0039, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   5,  Average loss: 0.0034, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   6,  Average loss: 0.0018, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 37.642505920211065.
Norm before scaling: 38.85135591514552. Distance: 10.951984688992662
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.8499, Accuracy: 4847/10000 (48.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.3756, Accuracy: 8065/9000 (89.6111%)
Scaling by  100
Scaled Norm after poisoning: 1094.5909053157714, distance: 1095.1984979902045
Total norm for 4 adversaries is: 1094.5909053157714. distance: 1095.1984979902045
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   1,  Average loss: 0.0083, Accuracy: 437/496 (88.1048%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   2,  Average loss: 0.0062, Accuracy: 453/496 (91.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   3,  Average loss: 0.0042, Accuracy: 474/496 (95.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   4,  Average loss: 0.0016, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   6,  Average loss: 0.0010, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.642505920211065.
Norm before scaling: 37.87344971559067. Distance: 6.412109969920777
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.0734, Accuracy: 6393/10000 (63.9300%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.1448, Accuracy: 8654/9000 (96.1556%)
Scaling by  100
Scaled Norm after poisoning: 640.4694079345243, distance: 641.2110611959216
Total norm for 4 adversaries is: 640.4694079345243. distance: 641.2110611959216
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 492/546 (90.1099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   2,  Average loss: 0.0057, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   3,  Average loss: 0.0028, Accuracy: 521/546 (95.4212%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   4,  Average loss: 0.0012, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   5,  Average loss: 0.0022, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.642505920211065.
Norm before scaling: 37.90621779677115. Distance: 6.7037879598219625
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.5678, Accuracy: 5878/10000 (58.7800%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.3970, Accuracy: 8282/9000 (92.0222%)
Scaling by  100
Scaled Norm after poisoning: 669.5692645275767, distance: 670.3788108226572
Total norm for 4 adversaries is: 669.5692645275767. distance: 670.3788108226572
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 223, local model 54, internal_epoch   1,  Average loss: 0.0035, Accuracy: 406/440 (92.2727%)
___Train Local_ResNet_18,  epoch 223, local model 54, internal_epoch   2,  Average loss: 0.0011, Accuracy: 429/440 (97.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 2.7971, Accuracy: 4440/10000 (44.4000%)
___Train Local_ResNet_18,  epoch 223, local model 95, internal_epoch   1,  Average loss: 0.0087, Accuracy: 464/569 (81.5466%)
___Train Local_ResNet_18,  epoch 223, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 506/569 (88.9279%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 9.1694, Accuracy: 2113/10000 (21.1300%)
___Train Local_ResNet_18,  epoch 223, local model 26, internal_epoch   1,  Average loss: 0.0038, Accuracy: 432/468 (92.3077%)
___Train Local_ResNet_18,  epoch 223, local model 26, internal_epoch   2,  Average loss: 0.0043, Accuracy: 436/468 (93.1624%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 2.1240, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch 223, local model 2, internal_epoch   1,  Average loss: 0.0080, Accuracy: 397/461 (86.1171%)
___Train Local_ResNet_18,  epoch 223, local model 2, internal_epoch   2,  Average loss: 0.0109, Accuracy: 384/461 (83.2972%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 11.7294, Accuracy: 1688/10000 (16.8800%)
___Train Local_ResNet_18,  epoch 223, local model 82, internal_epoch   1,  Average loss: 0.0024, Accuracy: 581/601 (96.6722%)
___Train Local_ResNet_18,  epoch 223, local model 82, internal_epoch   2,  Average loss: 0.0043, Accuracy: 556/601 (92.5125%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 3.5030, Accuracy: 3979/10000 (39.7900%)
___Train Local_ResNet_18,  epoch 223, local model 45, internal_epoch   1,  Average loss: 0.0071, Accuracy: 462/529 (87.3346%)
___Train Local_ResNet_18,  epoch 223, local model 45, internal_epoch   2,  Average loss: 0.0054, Accuracy: 476/529 (89.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 4.5607, Accuracy: 3047/10000 (30.4700%)
time spent on training: 274.6194849014282
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4057718380786364  data num: [526, 527, 496, 546, 440, 569, 468, 461, 601, 529]
[foolsgold agg] considering poison per batch poison_fraction: 0.03170092484989347
[foolsgold agg] wv: [0.53229156 0.         0.         0.         1.         1.
 0.52118724 0.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 223: Average loss: 0.6800, Accuracy: 7742/10000 (77.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 223: Average loss: 6.0421, Accuracy: 319/9000 (3.5444%)
Done in 329.508403301239 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:224 choose agents : [17, 33, 77, 11, 0, 34, 62, 66, 95, 10]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   1,  Average loss: 0.0142, Accuracy: 457/526 (86.8821%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   2,  Average loss: 0.0158, Accuracy: 429/526 (81.5589%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   3,  Average loss: 0.0098, Accuracy: 440/526 (83.6502%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   4,  Average loss: 0.0061, Accuracy: 490/526 (93.1559%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   5,  Average loss: 0.0033, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   6,  Average loss: 0.0030, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Global model norm: 37.64161087334899.
Norm before scaling: 39.4322484989087. Distance: 12.885278247201823
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.9524, Accuracy: 4259/10000 (42.5900%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.0450, Accuracy: 8878/9000 (98.6444%)
Scaling by  100
Scaled Norm after poisoning: 1287.9902949944926, distance: 1288.5278421516548
Total norm for 4 adversaries is: 1287.9902949944926. distance: 1288.5278421516548
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   1,  Average loss: 0.0146, Accuracy: 434/527 (82.3529%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   2,  Average loss: 0.0138, Accuracy: 441/527 (83.6812%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   3,  Average loss: 0.0067, Accuracy: 474/527 (89.9431%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   4,  Average loss: 0.0040, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   5,  Average loss: 0.0024, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   6,  Average loss: 0.0016, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Global model norm: 37.64161087334899.
Norm before scaling: 38.38278626220353. Distance: 9.464611596925891
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.6992, Accuracy: 5042/10000 (50.4200%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.5381, Accuracy: 7577/9000 (84.1889%)
Scaling by  100
Scaled Norm after poisoning: 945.4536940009278, distance: 946.4613040161759
Total norm for 4 adversaries is: 945.4536940009278. distance: 946.4613040161759
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   1,  Average loss: 0.0094, Accuracy: 438/496 (88.3065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   2,  Average loss: 0.0061, Accuracy: 454/496 (91.5323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   3,  Average loss: 0.0038, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   4,  Average loss: 0.0020, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.64161087334899.
Norm before scaling: 37.824136251910964. Distance: 6.263486121349195
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.0788, Accuracy: 6450/10000 (64.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.1482, Accuracy: 8660/9000 (96.2222%)
Scaling by  100
Scaled Norm after poisoning: 625.4468152848809, distance: 626.3484703022751
Total norm for 4 adversaries is: 625.4468152848809. distance: 626.3484703022751
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   1,  Average loss: 0.0075, Accuracy: 493/546 (90.2930%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 509/546 (93.2234%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   3,  Average loss: 0.0029, Accuracy: 522/546 (95.6044%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   4,  Average loss: 0.0012, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.64161087334899.
Norm before scaling: 37.79415554499631. Distance: 6.299697129977231
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.2897, Accuracy: 5983/10000 (59.8300%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.1409, Accuracy: 8723/9000 (96.9222%)
Scaling by  100
Scaled Norm after poisoning: 628.8567503811977, distance: 629.9697165340569
Total norm for 4 adversaries is: 628.8567503811977. distance: 629.9697165340569
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 224, local model 0, internal_epoch   1,  Average loss: 0.0072, Accuracy: 313/367 (85.2861%)
___Train Local_ResNet_18,  epoch 224, local model 0, internal_epoch   2,  Average loss: 0.0027, Accuracy: 347/367 (94.5504%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 5.3904, Accuracy: 2516/10000 (25.1600%)
___Train Local_ResNet_18,  epoch 224, local model 34, internal_epoch   1,  Average loss: 0.0057, Accuracy: 309/349 (88.5387%)
___Train Local_ResNet_18,  epoch 224, local model 34, internal_epoch   2,  Average loss: 0.0031, Accuracy: 329/349 (94.2693%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 3.5294, Accuracy: 3523/10000 (35.2300%)
___Train Local_ResNet_18,  epoch 224, local model 62, internal_epoch   1,  Average loss: 0.0019, Accuracy: 345/358 (96.3687%)
___Train Local_ResNet_18,  epoch 224, local model 62, internal_epoch   2,  Average loss: 0.0006, Accuracy: 357/358 (99.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.1671, Accuracy: 6605/10000 (66.0500%)
___Train Local_ResNet_18,  epoch 224, local model 66, internal_epoch   1,  Average loss: 0.0031, Accuracy: 525/555 (94.5946%)
___Train Local_ResNet_18,  epoch 224, local model 66, internal_epoch   2,  Average loss: 0.0007, Accuracy: 548/555 (98.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 3.3200, Accuracy: 4137/10000 (41.3700%)
___Train Local_ResNet_18,  epoch 224, local model 95, internal_epoch   1,  Average loss: 0.0100, Accuracy: 472/569 (82.9525%)
___Train Local_ResNet_18,  epoch 224, local model 95, internal_epoch   2,  Average loss: 0.0067, Accuracy: 504/569 (88.5764%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 6.8962, Accuracy: 2108/10000 (21.0800%)
___Train Local_ResNet_18,  epoch 224, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 701/752 (93.2181%)
___Train Local_ResNet_18,  epoch 224, local model 10, internal_epoch   2,  Average loss: 0.0032, Accuracy: 704/752 (93.6170%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 5.1132, Accuracy: 2922/10000 (29.2200%)
time spent on training: 279.1262125968933
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41526263627353815  data num: [526, 527, 496, 546, 367, 349, 358, 555, 569, 752]
[foolsgold agg] considering poison per batch poison_fraction: 0.03244239345887017
[foolsgold agg] wv: [0.66060274 0.         0.06663344 0.         0.40063365 1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 224: Average loss: 0.6793, Accuracy: 7747/10000 (77.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 224: Average loss: 5.9976, Accuracy: 330/9000 (3.6667%)
Done in 335.3640818595886 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:225 choose agents : [17, 33, 77, 11, 12, 38, 41, 4, 68, 55]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   1,  Average loss: 0.0138, Accuracy: 467/526 (88.7833%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   2,  Average loss: 0.0130, Accuracy: 460/526 (87.4525%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   3,  Average loss: 0.0089, Accuracy: 455/526 (86.5019%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   4,  Average loss: 0.0059, Accuracy: 488/526 (92.7757%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   5,  Average loss: 0.0043, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   6,  Average loss: 0.0040, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Global model norm: 37.64058121884129.
Norm before scaling: 38.53365133433698. Distance: 9.980731711310753
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.7600, Accuracy: 4580/10000 (45.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.5163, Accuracy: 7420/9000 (82.4444%)
Scaling by  100
Scaled Norm after poisoning: 997.2000802246257, distance: 998.0731436122304
Total norm for 4 adversaries is: 997.2000802246257. distance: 998.0731436122304
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   1,  Average loss: 0.0128, Accuracy: 438/527 (83.1120%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   2,  Average loss: 0.0136, Accuracy: 448/527 (85.0095%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   3,  Average loss: 0.0065, Accuracy: 471/527 (89.3738%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   4,  Average loss: 0.0047, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   5,  Average loss: 0.0027, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   6,  Average loss: 0.0030, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.64058121884129.
Norm before scaling: 38.72356078870137. Distance: 10.556065873866004
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.7877, Accuracy: 4847/10000 (48.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.3030, Accuracy: 8139/9000 (90.4333%)
Scaling by  100
Scaled Norm after poisoning: 1054.9166436264052, distance: 1055.6064607608273
Total norm for 4 adversaries is: 1054.9166436264052. distance: 1055.6064607608273
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   1,  Average loss: 0.0097, Accuracy: 436/496 (87.9032%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   2,  Average loss: 0.0059, Accuracy: 454/496 (91.5323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   3,  Average loss: 0.0033, Accuracy: 472/496 (95.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   4,  Average loss: 0.0020, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   5,  Average loss: 0.0015, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   6,  Average loss: 0.0016, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Global model norm: 37.64058121884129.
Norm before scaling: 37.85623761763047. Distance: 6.412900570856331
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.0470, Accuracy: 6542/10000 (65.4200%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.1639, Accuracy: 8604/9000 (95.6000%)
Scaling by  100
Scaled Norm after poisoning: 640.4570633539769, distance: 641.2900084984951
Total norm for 4 adversaries is: 640.4570633539769. distance: 641.2900084984951
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   1,  Average loss: 0.0084, Accuracy: 496/546 (90.8425%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   3,  Average loss: 0.0021, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   4,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   5,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.64058121884129.
Norm before scaling: 37.85368850453595. Distance: 6.541892985257891
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.3760, Accuracy: 5974/10000 (59.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.1892, Accuracy: 8551/9000 (95.0111%)
Scaling by  100
Scaled Norm after poisoning: 653.2301948777322, distance: 654.1892883562066
Total norm for 4 adversaries is: 653.2301948777322. distance: 654.1892883562066
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 225, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 882/977 (90.2764%)
___Train Local_ResNet_18,  epoch 225, local model 12, internal_epoch   2,  Average loss: 0.0089, Accuracy: 820/977 (83.9304%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 12.2779, Accuracy: 1839/10000 (18.3900%)
___Train Local_ResNet_18,  epoch 225, local model 38, internal_epoch   1,  Average loss: 0.0029, Accuracy: 717/756 (94.8413%)
___Train Local_ResNet_18,  epoch 225, local model 38, internal_epoch   2,  Average loss: 0.0027, Accuracy: 717/756 (94.8413%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 2.1322, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 225, local model 41, internal_epoch   1,  Average loss: 0.0081, Accuracy: 438/513 (85.3801%)
___Train Local_ResNet_18,  epoch 225, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 478/513 (93.1774%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 11.6877, Accuracy: 1649/10000 (16.4900%)
___Train Local_ResNet_18,  epoch 225, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 476/557 (85.4578%)
___Train Local_ResNet_18,  epoch 225, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 512/557 (91.9210%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 3.9553, Accuracy: 3570/10000 (35.7000%)
___Train Local_ResNet_18,  epoch 225, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 397/416 (95.4327%)
___Train Local_ResNet_18,  epoch 225, local model 68, internal_epoch   2,  Average loss: 0.0014, Accuracy: 405/416 (97.3558%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.5561, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch 225, local model 55, internal_epoch   1,  Average loss: 0.0050, Accuracy: 274/299 (91.6388%)
___Train Local_ResNet_18,  epoch 225, local model 55, internal_epoch   2,  Average loss: 0.0011, Accuracy: 292/299 (97.6589%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 7.7794, Accuracy: 2219/10000 (22.1900%)
time spent on training: 276.8058776855469
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3732406912524497  data num: [526, 527, 496, 546, 977, 756, 513, 557, 416, 299]
[foolsgold agg] considering poison per batch poison_fraction: 0.029159429004097633
[foolsgold agg] wv: [0.50084615 0.         0.         0.         0.         0.48998615
 0.         0.48998615 1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 225: Average loss: 0.6785, Accuracy: 7751/10000 (77.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 225: Average loss: 5.9817, Accuracy: 331/9000 (3.6778%)
Done in 332.17837476730347 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:226 choose agents : [17, 33, 77, 11, 30, 39, 10, 64, 23, 60]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   1,  Average loss: 0.0130, Accuracy: 468/526 (88.9734%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   2,  Average loss: 0.0132, Accuracy: 431/526 (81.9392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   3,  Average loss: 0.0096, Accuracy: 458/526 (87.0722%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   4,  Average loss: 0.0044, Accuracy: 487/526 (92.5856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   5,  Average loss: 0.0042, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   6,  Average loss: 0.0021, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Global model norm: 37.639149384733045.
Norm before scaling: 38.57186088521576. Distance: 10.008602257089898
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.7490, Accuracy: 4900/10000 (49.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.5395, Accuracy: 7471/9000 (83.0111%)
Scaling by  100
Scaled Norm after poisoning: 1000.1143997063535, distance: 1000.8601925344019
Total norm for 4 adversaries is: 1000.1143997063535. distance: 1000.8601925344019
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   1,  Average loss: 0.0136, Accuracy: 443/527 (84.0607%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   2,  Average loss: 0.0103, Accuracy: 458/527 (86.9070%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   3,  Average loss: 0.0062, Accuracy: 481/527 (91.2713%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   4,  Average loss: 0.0045, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   5,  Average loss: 0.0040, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   6,  Average loss: 0.0038, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Global model norm: 37.639149384733045.
Norm before scaling: 38.38801756509608. Distance: 9.347240395706999
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.9194, Accuracy: 4470/10000 (44.7000%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.2921, Accuracy: 8193/9000 (91.0333%)
Scaling by  100
Scaled Norm after poisoning: 933.8534079286749, distance: 934.7240568745409
Total norm for 4 adversaries is: 933.8534079286749. distance: 934.7240568745409
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   1,  Average loss: 0.0095, Accuracy: 437/496 (88.1048%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   2,  Average loss: 0.0059, Accuracy: 455/496 (91.7339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   3,  Average loss: 0.0031, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   4,  Average loss: 0.0016, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.639149384733045.
Norm before scaling: 37.85526862016287. Distance: 6.319763838786015
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.0539, Accuracy: 6507/10000 (65.0700%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.2035, Accuracy: 8559/9000 (95.1000%)
Scaling by  100
Scaled Norm after poisoning: 631.2278213925619, distance: 631.9763642732219
Total norm for 4 adversaries is: 631.2278213925619. distance: 631.9763642732219
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   1,  Average loss: 0.0090, Accuracy: 485/546 (88.8278%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   2,  Average loss: 0.0060, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   3,  Average loss: 0.0048, Accuracy: 518/546 (94.8718%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   4,  Average loss: 0.0022, Accuracy: 528/546 (96.7033%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   6,  Average loss: 0.0013, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Global model norm: 37.639149384733045.
Norm before scaling: 37.862159088201935. Distance: 6.828114664519495
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.2301, Accuracy: 6155/10000 (61.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.1539, Accuracy: 8592/9000 (95.4667%)
Scaling by  100
Scaled Norm after poisoning: 681.6667074164617, distance: 682.8114445071934
Total norm for 4 adversaries is: 681.6667074164617. distance: 682.8114445071934
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 226, local model 30, internal_epoch   1,  Average loss: 0.0051, Accuracy: 300/337 (89.0208%)
___Train Local_ResNet_18,  epoch 226, local model 30, internal_epoch   2,  Average loss: 0.0024, Accuracy: 323/337 (95.8457%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 4.2286, Accuracy: 3012/10000 (30.1200%)
___Train Local_ResNet_18,  epoch 226, local model 39, internal_epoch   1,  Average loss: 0.0068, Accuracy: 181/217 (83.4101%)
___Train Local_ResNet_18,  epoch 226, local model 39, internal_epoch   2,  Average loss: 0.0016, Accuracy: 209/217 (96.3134%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 4.5699, Accuracy: 2891/10000 (28.9100%)
___Train Local_ResNet_18,  epoch 226, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 683/752 (90.8245%)
___Train Local_ResNet_18,  epoch 226, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 704/752 (93.6170%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 4.1036, Accuracy: 3726/10000 (37.2600%)
___Train Local_ResNet_18,  epoch 226, local model 64, internal_epoch   1,  Average loss: 0.0051, Accuracy: 609/686 (88.7755%)
___Train Local_ResNet_18,  epoch 226, local model 64, internal_epoch   2,  Average loss: 0.0039, Accuracy: 627/686 (91.3994%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 3.8198, Accuracy: 3956/10000 (39.5600%)
___Train Local_ResNet_18,  epoch 226, local model 23, internal_epoch   1,  Average loss: 0.0040, Accuracy: 221/248 (89.1129%)
___Train Local_ResNet_18,  epoch 226, local model 23, internal_epoch   2,  Average loss: 0.0008, Accuracy: 244/248 (98.3871%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 2.1985, Accuracy: 4556/10000 (45.5600%)
___Train Local_ResNet_18,  epoch 226, local model 60, internal_epoch   1,  Average loss: 0.0051, Accuracy: 257/284 (90.4930%)
___Train Local_ResNet_18,  epoch 226, local model 60, internal_epoch   2,  Average loss: 0.0010, Accuracy: 279/284 (98.2394%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 2.6778, Accuracy: 4374/10000 (43.7400%)
time spent on training: 271.6001398563385
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4535613769214116  data num: [526, 527, 496, 546, 337, 217, 752, 686, 248, 284]
[foolsgold agg] considering poison per batch poison_fraction: 0.03543448257198528
[foolsgold agg] wv: [0.48916479 0.         0.         0.         1.         0.
 1.         1.         0.16193564 0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 226: Average loss: 0.6769, Accuracy: 7748/10000 (77.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 226: Average loss: 5.9528, Accuracy: 338/9000 (3.7556%)
Done in 327.26224851608276 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:227 choose agents : [17, 33, 77, 11, 23, 34, 52, 92, 57, 74]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   1,  Average loss: 0.0153, Accuracy: 462/526 (87.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   2,  Average loss: 0.0160, Accuracy: 439/526 (83.4601%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   3,  Average loss: 0.0080, Accuracy: 460/526 (87.4525%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   4,  Average loss: 0.0052, Accuracy: 492/526 (93.5361%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   5,  Average loss: 0.0045, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   6,  Average loss: 0.0042, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Global model norm: 37.63810020330546.
Norm before scaling: 38.72591237224115. Distance: 10.704865563308847
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.9956, Accuracy: 3970/10000 (39.7000%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.0336, Accuracy: 8945/9000 (99.3889%)
Scaling by  100
Scaled Norm after poisoning: 1069.675359630201, distance: 1070.4864548419098
Total norm for 4 adversaries is: 1069.675359630201. distance: 1070.4864548419098
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   1,  Average loss: 0.0171, Accuracy: 439/527 (83.3017%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   2,  Average loss: 0.0121, Accuracy: 451/527 (85.5787%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   3,  Average loss: 0.0057, Accuracy: 482/527 (91.4611%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   4,  Average loss: 0.0035, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   5,  Average loss: 0.0041, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   6,  Average loss: 0.0027, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Global model norm: 37.63810020330546.
Norm before scaling: 38.61183944734843. Distance: 10.262108698457878
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.8492, Accuracy: 4633/10000 (46.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.8547, Accuracy: 6848/9000 (76.0889%)
Scaling by  100
Scaled Norm after poisoning: 1025.3872439229972, distance: 1026.2108092395051
Total norm for 4 adversaries is: 1025.3872439229972. distance: 1026.2108092395051
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   1,  Average loss: 0.0085, Accuracy: 443/496 (89.3145%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   2,  Average loss: 0.0065, Accuracy: 449/496 (90.5242%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   3,  Average loss: 0.0036, Accuracy: 470/496 (94.7581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   4,  Average loss: 0.0020, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   5,  Average loss: 0.0015, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   6,  Average loss: 0.0010, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.63810020330546.
Norm before scaling: 37.828431561128724. Distance: 6.19252904103584
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.1059, Accuracy: 6183/10000 (61.8300%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.0629, Accuracy: 8836/9000 (98.1778%)
Scaling by  100
Scaled Norm after poisoning: 618.4597298935478, distance: 619.252926920818
Total norm for 4 adversaries is: 618.4597298935478. distance: 619.252926920818
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 486/546 (89.0110%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   3,  Average loss: 0.0030, Accuracy: 526/546 (96.3370%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   4,  Average loss: 0.0008, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.63810020330546.
Norm before scaling: 37.86050832754775. Distance: 6.652376149088014
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.3152, Accuracy: 6060/10000 (60.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.0739, Accuracy: 8823/9000 (98.0333%)
Scaling by  100
Scaled Norm after poisoning: 664.2375798613024, distance: 665.2377159707648
Total norm for 4 adversaries is: 664.2375798613024. distance: 665.2377159707648
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 227, local model 23, internal_epoch   1,  Average loss: 0.0041, Accuracy: 224/248 (90.3226%)
___Train Local_ResNet_18,  epoch 227, local model 23, internal_epoch   2,  Average loss: 0.0009, Accuracy: 245/248 (98.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 2.3236, Accuracy: 4427/10000 (44.2700%)
___Train Local_ResNet_18,  epoch 227, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 310/349 (88.8252%)
___Train Local_ResNet_18,  epoch 227, local model 34, internal_epoch   2,  Average loss: 0.0017, Accuracy: 339/349 (97.1347%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 4.4789, Accuracy: 3521/10000 (35.2100%)
___Train Local_ResNet_18,  epoch 227, local model 52, internal_epoch   1,  Average loss: 0.0080, Accuracy: 184/214 (85.9813%)
___Train Local_ResNet_18,  epoch 227, local model 52, internal_epoch   2,  Average loss: 0.0019, Accuracy: 208/214 (97.1963%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 3.6792, Accuracy: 3608/10000 (36.0800%)
___Train Local_ResNet_18,  epoch 227, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 700/796 (87.9397%)
___Train Local_ResNet_18,  epoch 227, local model 92, internal_epoch   2,  Average loss: 0.0087, Accuracy: 652/796 (81.9095%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 8.6693, Accuracy: 2067/10000 (20.6700%)
___Train Local_ResNet_18,  epoch 227, local model 57, internal_epoch   1,  Average loss: 0.0056, Accuracy: 254/290 (87.5862%)
___Train Local_ResNet_18,  epoch 227, local model 57, internal_epoch   2,  Average loss: 0.0008, Accuracy: 287/290 (98.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 3.5658, Accuracy: 4234/10000 (42.3400%)
___Train Local_ResNet_18,  epoch 227, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 424/469 (90.4051%)
___Train Local_ResNet_18,  epoch 227, local model 74, internal_epoch   2,  Average loss: 0.0025, Accuracy: 450/469 (95.9488%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 3.8759, Accuracy: 3653/10000 (36.5300%)
time spent on training: 281.7097246646881
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4696256444743331  data num: [526, 527, 496, 546, 248, 349, 214, 796, 290, 469]
[foolsgold agg] considering poison per batch poison_fraction: 0.036689503474557274
[foolsgold agg] wv: [0.77824118 0.         0.         0.         1.         1.
 1.         1.         0.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 227: Average loss: 0.6762, Accuracy: 7756/10000 (77.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 227: Average loss: 5.9191, Accuracy: 348/9000 (3.8667%)
Done in 336.1395094394684 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:228 choose agents : [17, 33, 77, 11, 67, 16, 64, 30, 35, 81]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   1,  Average loss: 0.0131, Accuracy: 466/526 (88.5932%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   2,  Average loss: 0.0140, Accuracy: 437/526 (83.0798%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   3,  Average loss: 0.0081, Accuracy: 464/526 (88.2129%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   4,  Average loss: 0.0073, Accuracy: 484/526 (92.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   5,  Average loss: 0.0036, Accuracy: 493/526 (93.7262%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   6,  Average loss: 0.0033, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Global model norm: 37.63710288627268.
Norm before scaling: 38.728686174623846. Distance: 10.554114991874911
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.8954, Accuracy: 4530/10000 (45.3000%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.1912, Accuracy: 8353/9000 (92.8111%)
Scaling by  100
Scaled Norm after poisoning: 1054.7545923104578, distance: 1055.4115311100215
Total norm for 4 adversaries is: 1054.7545923104578. distance: 1055.4115311100215
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   1,  Average loss: 0.0142, Accuracy: 439/527 (83.3017%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   2,  Average loss: 0.0110, Accuracy: 448/527 (85.0095%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   3,  Average loss: 0.0078, Accuracy: 473/527 (89.7533%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   4,  Average loss: 0.0041, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   5,  Average loss: 0.0029, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   6,  Average loss: 0.0033, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Global model norm: 37.63710288627268.
Norm before scaling: 38.62947802217401. Distance: 10.31544073541785
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.9447, Accuracy: 4533/10000 (45.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.2007, Accuracy: 8429/9000 (93.6556%)
Scaling by  100
Scaled Norm after poisoning: 1030.7412381388453, distance: 1031.5442307530977
Total norm for 4 adversaries is: 1030.7412381388453. distance: 1031.5442307530977
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   1,  Average loss: 0.0099, Accuracy: 438/496 (88.3065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   2,  Average loss: 0.0067, Accuracy: 450/496 (90.7258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   3,  Average loss: 0.0033, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   4,  Average loss: 0.0019, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.63710288627268.
Norm before scaling: 37.83891123070271. Distance: 6.27191500876704
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.1242, Accuracy: 6247/10000 (62.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.1019, Accuracy: 8745/9000 (97.1667%)
Scaling by  100
Scaled Norm after poisoning: 626.3985851676231, distance: 627.1915576600182
Total norm for 4 adversaries is: 626.3985851676231. distance: 627.1915576600182
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 495/546 (90.6593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   2,  Average loss: 0.0049, Accuracy: 505/546 (92.4908%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   3,  Average loss: 0.0019, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   5,  Average loss: 0.0011, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.63710288627268.
Norm before scaling: 37.83432511921632. Distance: 6.429910278168952
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.3388, Accuracy: 5944/10000 (59.4400%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.1497, Accuracy: 8703/9000 (96.7000%)
Scaling by  100
Scaled Norm after poisoning: 642.0342913349722, distance: 642.9910574805842
Total norm for 4 adversaries is: 642.0342913349722. distance: 642.9910574805842
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 228, local model 67, internal_epoch   1,  Average loss: 0.0046, Accuracy: 778/842 (92.3990%)
___Train Local_ResNet_18,  epoch 228, local model 67, internal_epoch   2,  Average loss: 0.0176, Accuracy: 580/842 (68.8836%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 17.2532, Accuracy: 1338/10000 (13.3800%)
___Train Local_ResNet_18,  epoch 228, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 706/773 (91.3325%)
___Train Local_ResNet_18,  epoch 228, local model 16, internal_epoch   2,  Average loss: 0.0193, Accuracy: 577/773 (74.6442%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 109.9915, Accuracy: 1111/10000 (11.1100%)
___Train Local_ResNet_18,  epoch 228, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 623/686 (90.8163%)
___Train Local_ResNet_18,  epoch 228, local model 64, internal_epoch   2,  Average loss: 0.0037, Accuracy: 632/686 (92.1283%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 2.6409, Accuracy: 4686/10000 (46.8600%)
___Train Local_ResNet_18,  epoch 228, local model 30, internal_epoch   1,  Average loss: 0.0049, Accuracy: 305/337 (90.5045%)
___Train Local_ResNet_18,  epoch 228, local model 30, internal_epoch   2,  Average loss: 0.0025, Accuracy: 318/337 (94.3620%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 3.6939, Accuracy: 3560/10000 (35.6000%)
___Train Local_ResNet_18,  epoch 228, local model 35, internal_epoch   1,  Average loss: 0.0064, Accuracy: 370/419 (88.3055%)
___Train Local_ResNet_18,  epoch 228, local model 35, internal_epoch   2,  Average loss: 0.0024, Accuracy: 400/419 (95.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 4.2230, Accuracy: 3110/10000 (31.1000%)
___Train Local_ResNet_18,  epoch 228, local model 81, internal_epoch   1,  Average loss: 0.0074, Accuracy: 898/1034 (86.8472%)
___Train Local_ResNet_18,  epoch 228, local model 81, internal_epoch   2,  Average loss: 0.0064, Accuracy: 897/1034 (86.7505%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 9.8911, Accuracy: 2535/10000 (25.3500%)
time spent on training: 274.7274911403656
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.338667959909473  data num: [526, 527, 496, 546, 842, 773, 686, 337, 419, 1034]
[foolsgold agg] considering poison per batch poison_fraction: 0.02645843436792758
[foolsgold agg] wv: [0.67222651 0.         0.1064436  0.         0.45025727 0.45025727
 0.1033771  1.         0.1033771  1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 228: Average loss: 0.6747, Accuracy: 7757/10000 (77.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 228: Average loss: 5.8896, Accuracy: 366/9000 (4.0667%)
Done in 329.804123878479 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:229 choose agents : [17, 33, 77, 11, 62, 68, 2, 74, 39, 1]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   1,  Average loss: 0.0135, Accuracy: 465/526 (88.4030%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   2,  Average loss: 0.0123, Accuracy: 445/526 (84.6008%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   3,  Average loss: 0.0082, Accuracy: 468/526 (88.9734%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   4,  Average loss: 0.0041, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   5,  Average loss: 0.0035, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   6,  Average loss: 0.0029, Accuracy: 508/526 (96.5779%), train_poison_data_count: 45
Global model norm: 37.636337447796045.
Norm before scaling: 38.63587497340959. Distance: 10.247427268587955
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.5712, Accuracy: 5027/10000 (50.2700%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.2992, Accuracy: 8092/9000 (89.9111%)
Scaling by  100
Scaled Norm after poisoning: 1024.029662656312, distance: 1024.7426506201448
Total norm for 4 adversaries is: 1024.029662656312. distance: 1024.7426506201448
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   1,  Average loss: 0.0145, Accuracy: 437/527 (82.9222%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   2,  Average loss: 0.0137, Accuracy: 444/527 (84.2505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   3,  Average loss: 0.0072, Accuracy: 470/527 (89.1841%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   4,  Average loss: 0.0031, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   5,  Average loss: 0.0025, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   6,  Average loss: 0.0030, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Global model norm: 37.636337447796045.
Norm before scaling: 38.672896135508296. Distance: 10.465113859545998
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.8803, Accuracy: 4831/10000 (48.3100%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.3183, Accuracy: 8183/9000 (90.9222%)
Scaling by  100
Scaled Norm after poisoning: 1045.7344906810715, distance: 1046.5114667312537
Total norm for 4 adversaries is: 1045.7344906810715. distance: 1046.5114667312537
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   1,  Average loss: 0.0101, Accuracy: 441/496 (88.9113%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   2,  Average loss: 0.0072, Accuracy: 439/496 (88.5081%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   3,  Average loss: 0.0039, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   4,  Average loss: 0.0021, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.636337447796045.
Norm before scaling: 37.866509722890356. Distance: 6.467720871299485
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.1007, Accuracy: 6370/10000 (63.7000%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.1354, Accuracy: 8681/9000 (96.4556%)
Scaling by  100
Scaled Norm after poisoning: 645.9762960047373, distance: 646.772008709406
Total norm for 4 adversaries is: 645.9762960047373. distance: 646.772008709406
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   1,  Average loss: 0.0083, Accuracy: 484/546 (88.6447%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 501/546 (91.7582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   3,  Average loss: 0.0034, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   4,  Average loss: 0.0018, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   5,  Average loss: 0.0016, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   6,  Average loss: 0.0013, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Global model norm: 37.636337447796045.
Norm before scaling: 37.95987711397144. Distance: 7.155582846648073
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.3874, Accuracy: 5855/10000 (58.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.0713, Accuracy: 8794/9000 (97.7111%)
Scaling by  100
Scaled Norm after poisoning: 714.6787739957022, distance: 715.5582829162136
Total norm for 4 adversaries is: 714.6787739957022. distance: 715.5582829162136
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 229, local model 62, internal_epoch   1,  Average loss: 0.0022, Accuracy: 344/358 (96.0894%)
___Train Local_ResNet_18,  epoch 229, local model 62, internal_epoch   2,  Average loss: 0.0010, Accuracy: 353/358 (98.6034%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.0898, Accuracy: 6724/10000 (67.2400%)
___Train Local_ResNet_18,  epoch 229, local model 68, internal_epoch   1,  Average loss: 0.0026, Accuracy: 400/416 (96.1538%)
___Train Local_ResNet_18,  epoch 229, local model 68, internal_epoch   2,  Average loss: 0.0008, Accuracy: 412/416 (99.0385%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.4585, Accuracy: 6043/10000 (60.4300%)
___Train Local_ResNet_18,  epoch 229, local model 2, internal_epoch   1,  Average loss: 0.0089, Accuracy: 383/461 (83.0803%)
___Train Local_ResNet_18,  epoch 229, local model 2, internal_epoch   2,  Average loss: 0.0142, Accuracy: 381/461 (82.6464%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 43.4446, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 229, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 435/469 (92.7505%)
___Train Local_ResNet_18,  epoch 229, local model 74, internal_epoch   2,  Average loss: 0.0026, Accuracy: 443/469 (94.4563%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 2.4351, Accuracy: 4691/10000 (46.9100%)
___Train Local_ResNet_18,  epoch 229, local model 39, internal_epoch   1,  Average loss: 0.0077, Accuracy: 186/217 (85.7143%)
___Train Local_ResNet_18,  epoch 229, local model 39, internal_epoch   2,  Average loss: 0.0019, Accuracy: 211/217 (97.2350%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 3.8389, Accuracy: 3346/10000 (33.4600%)
___Train Local_ResNet_18,  epoch 229, local model 1, internal_epoch   1,  Average loss: 0.0098, Accuracy: 589/641 (91.8877%)
___Train Local_ResNet_18,  epoch 229, local model 1, internal_epoch   2,  Average loss: 0.0113, Accuracy: 535/641 (83.4633%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 3.0991, Accuracy: 4064/10000 (40.6400%)
time spent on training: 273.8934462070465
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.44986042516641617  data num: [526, 527, 496, 546, 358, 416, 461, 469, 217, 641]
[foolsgold agg] considering poison per batch poison_fraction: 0.035145345716126264
[foolsgold agg] wv: [1.         0.37081916 0.69851241 0.37081916 1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 229: Average loss: 0.6711, Accuracy: 7763/10000 (77.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 229: Average loss: 5.8312, Accuracy: 395/9000 (4.3889%)
Done in 327.6760411262512 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:230 choose agents : [17, 33, 77, 11, 64, 29, 21, 39, 95, 90]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   1,  Average loss: 0.0126, Accuracy: 470/526 (89.3536%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   2,  Average loss: 0.0131, Accuracy: 440/526 (83.6502%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   3,  Average loss: 0.0080, Accuracy: 460/526 (87.4525%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   4,  Average loss: 0.0045, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   5,  Average loss: 0.0031, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   6,  Average loss: 0.0017, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Global model norm: 37.63585093219795.
Norm before scaling: 38.52680175053465. Distance: 9.819502160530545
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.7210, Accuracy: 4836/10000 (48.3600%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.6343, Accuracy: 7196/9000 (79.9556%)
Scaling by  100
Scaled Norm after poisoning: 981.2167191808342, distance: 981.950132389624
Total norm for 4 adversaries is: 981.2167191808342. distance: 981.950132389624
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   1,  Average loss: 0.0148, Accuracy: 428/527 (81.2144%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   2,  Average loss: 0.0111, Accuracy: 453/527 (85.9583%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   3,  Average loss: 0.0070, Accuracy: 471/527 (89.3738%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   4,  Average loss: 0.0046, Accuracy: 495/527 (93.9279%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   5,  Average loss: 0.0047, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   6,  Average loss: 0.0027, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Global model norm: 37.63585093219795.
Norm before scaling: 38.77320058989682. Distance: 10.636425024061444
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.7645, Accuracy: 4823/10000 (48.2300%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.4102, Accuracy: 7701/9000 (85.5667%)
Scaling by  100
Scaled Norm after poisoning: 1063.075256037878, distance: 1063.6426209023405
Total norm for 4 adversaries is: 1063.075256037878. distance: 1063.6426209023405
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   1,  Average loss: 0.0084, Accuracy: 439/496 (88.5081%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   2,  Average loss: 0.0069, Accuracy: 455/496 (91.7339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   3,  Average loss: 0.0037, Accuracy: 468/496 (94.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   4,  Average loss: 0.0022, Accuracy: 478/496 (96.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.63585093219795.
Norm before scaling: 37.86605195455423. Distance: 6.398208558175191
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.0678, Accuracy: 6489/10000 (64.8900%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.1200, Accuracy: 8699/9000 (96.6556%)
Scaling by  100
Scaled Norm after poisoning: 639.0864818238608, distance: 639.8208245282424
Total norm for 4 adversaries is: 639.0864818238608. distance: 639.8208245282424
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   1,  Average loss: 0.0073, Accuracy: 490/546 (89.7436%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   2,  Average loss: 0.0040, Accuracy: 519/546 (95.0549%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   3,  Average loss: 0.0016, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.63585093219795.
Norm before scaling: 37.774973307713104. Distance: 6.142805105603602
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.2524, Accuracy: 6260/10000 (62.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.2770, Accuracy: 8467/9000 (94.0778%)
Scaling by  100
Scaled Norm after poisoning: 613.2150927692501, distance: 614.2804733995702
Total norm for 4 adversaries is: 613.2150927692501. distance: 614.2804733995702
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 230, local model 64, internal_epoch   1,  Average loss: 0.0052, Accuracy: 607/686 (88.4840%)
___Train Local_ResNet_18,  epoch 230, local model 64, internal_epoch   2,  Average loss: 0.0050, Accuracy: 606/686 (88.3382%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 3.5221, Accuracy: 3981/10000 (39.8100%)
___Train Local_ResNet_18,  epoch 230, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 771/848 (90.9198%)
___Train Local_ResNet_18,  epoch 230, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 799/848 (94.2217%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 5.1380, Accuracy: 3146/10000 (31.4600%)
___Train Local_ResNet_18,  epoch 230, local model 21, internal_epoch   1,  Average loss: 0.0041, Accuracy: 240/262 (91.6031%)
___Train Local_ResNet_18,  epoch 230, local model 21, internal_epoch   2,  Average loss: 0.0025, Accuracy: 259/262 (98.8550%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 3.2489, Accuracy: 3735/10000 (37.3500%)
___Train Local_ResNet_18,  epoch 230, local model 39, internal_epoch   1,  Average loss: 0.0063, Accuracy: 190/217 (87.5576%)
___Train Local_ResNet_18,  epoch 230, local model 39, internal_epoch   2,  Average loss: 0.0012, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 2.7959, Accuracy: 4278/10000 (42.7800%)
___Train Local_ResNet_18,  epoch 230, local model 95, internal_epoch   1,  Average loss: 0.0086, Accuracy: 464/569 (81.5466%)
___Train Local_ResNet_18,  epoch 230, local model 95, internal_epoch   2,  Average loss: 0.0073, Accuracy: 495/569 (86.9947%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 6.7967, Accuracy: 2134/10000 (21.3400%)
___Train Local_ResNet_18,  epoch 230, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 519/578 (89.7924%)
___Train Local_ResNet_18,  epoch 230, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 535/578 (92.5606%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 11.8551, Accuracy: 1357/10000 (13.5700%)
time spent on training: 274.9290382862091
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.39866793529971456  data num: [526, 527, 496, 546, 686, 848, 262, 217, 569, 578]
[foolsgold agg] considering poison per batch poison_fraction: 0.0311459324452902
[foolsgold agg] wv: [0.7115526  0.         0.14529523 0.         1.         0.25764643
 1.         1.         0.87992729 0.25764643]
___Test Target_ResNet_18 poisoned: False, epoch: 230: Average loss: 0.6699, Accuracy: 7771/10000 (77.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 230: Average loss: 5.7993, Accuracy: 403/9000 (4.4778%)
Done in 329.52794790267944 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:231 choose agents : [17, 33, 77, 11, 68, 38, 97, 3, 98, 90]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   1,  Average loss: 0.0109, Accuracy: 463/526 (88.0228%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   2,  Average loss: 0.0121, Accuracy: 463/526 (88.0228%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   3,  Average loss: 0.0076, Accuracy: 476/526 (90.4943%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   4,  Average loss: 0.0042, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   5,  Average loss: 0.0035, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   6,  Average loss: 0.0026, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Global model norm: 37.63489247807063.
Norm before scaling: 38.454404311307435. Distance: 9.43803434564477
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.9057, Accuracy: 4602/10000 (46.0200%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.3149, Accuracy: 8093/9000 (89.9222%)
Scaling by  100
Scaled Norm after poisoning: 943.1379803613042, distance: 943.8034753061678
Total norm for 4 adversaries is: 943.1379803613042. distance: 943.8034753061678
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   1,  Average loss: 0.0138, Accuracy: 440/527 (83.4915%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   2,  Average loss: 0.0091, Accuracy: 467/527 (88.6148%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   3,  Average loss: 0.0067, Accuracy: 486/527 (92.2201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   4,  Average loss: 0.0031, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   5,  Average loss: 0.0022, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   6,  Average loss: 0.0024, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.63489247807063.
Norm before scaling: 38.28796497228274. Distance: 8.858921584379422
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.7404, Accuracy: 5054/10000 (50.5400%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.4268, Accuracy: 7968/9000 (88.5333%)
Scaling by  100
Scaled Norm after poisoning: 885.0600615212506, distance: 885.8920998067429
Total norm for 4 adversaries is: 885.0600615212506. distance: 885.8920998067429
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   1,  Average loss: 0.0085, Accuracy: 445/496 (89.7177%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 456/496 (91.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   3,  Average loss: 0.0034, Accuracy: 476/496 (95.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   4,  Average loss: 0.0016, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.63489247807063.
Norm before scaling: 37.79030049527838. Distance: 5.977201699376498
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.0611, Accuracy: 6499/10000 (64.9900%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.1338, Accuracy: 8698/9000 (96.6444%)
Scaling by  100
Scaled Norm after poisoning: 596.8963477857776, distance: 597.7202000100046
Total norm for 4 adversaries is: 596.8963477857776. distance: 597.7202000100046
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   1,  Average loss: 0.0073, Accuracy: 487/546 (89.1941%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   3,  Average loss: 0.0021, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   4,  Average loss: 0.0014, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.63489247807063.
Norm before scaling: 37.84079842432801. Distance: 6.496542377773806
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.3920, Accuracy: 5942/10000 (59.4200%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.1085, Accuracy: 8784/9000 (97.6000%)
Scaling by  100
Scaled Norm after poisoning: 648.6914713482828, distance: 649.6542109076181
Total norm for 4 adversaries is: 648.6914713482828. distance: 649.6542109076181
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 231, local model 68, internal_epoch   1,  Average loss: 0.0028, Accuracy: 400/416 (96.1538%)
___Train Local_ResNet_18,  epoch 231, local model 68, internal_epoch   2,  Average loss: 0.0009, Accuracy: 412/416 (99.0385%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.4899, Accuracy: 5950/10000 (59.5000%)
___Train Local_ResNet_18,  epoch 231, local model 38, internal_epoch   1,  Average loss: 0.0039, Accuracy: 700/756 (92.5926%)
___Train Local_ResNet_18,  epoch 231, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 688/756 (91.0053%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 3.5053, Accuracy: 4071/10000 (40.7100%)
___Train Local_ResNet_18,  epoch 231, local model 97, internal_epoch   1,  Average loss: 0.0027, Accuracy: 396/418 (94.7368%)
___Train Local_ResNet_18,  epoch 231, local model 97, internal_epoch   2,  Average loss: 0.0018, Accuracy: 404/418 (96.6507%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 3.0520, Accuracy: 4455/10000 (44.5500%)
___Train Local_ResNet_18,  epoch 231, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 692/780 (88.7179%)
___Train Local_ResNet_18,  epoch 231, local model 3, internal_epoch   2,  Average loss: 0.0083, Accuracy: 660/780 (84.6154%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 6.0765, Accuracy: 2959/10000 (29.5900%)
___Train Local_ResNet_18,  epoch 231, local model 98, internal_epoch   1,  Average loss: 0.0050, Accuracy: 731/802 (91.1471%)
___Train Local_ResNet_18,  epoch 231, local model 98, internal_epoch   2,  Average loss: 0.0077, Accuracy: 685/802 (85.4115%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 4.1307, Accuracy: 3060/10000 (30.6000%)
___Train Local_ResNet_18,  epoch 231, local model 90, internal_epoch   1,  Average loss: 0.0113, Accuracy: 511/578 (88.4083%)
___Train Local_ResNet_18,  epoch 231, local model 90, internal_epoch   2,  Average loss: 0.0158, Accuracy: 420/578 (72.6644%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1194.8270, Accuracy: 1000/10000 (10.0000%)
time spent on training: 275.9339141845703
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.358426005132592  data num: [526, 527, 496, 546, 416, 756, 418, 780, 802, 578]
[foolsgold agg] considering poison per batch poison_fraction: 0.02800203165098375
[foolsgold agg] wv: [0.52555563 0.         0.         0.         1.         0.83797668
 0.83797668 0.89226393 0.89226393 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 231: Average loss: 0.6698, Accuracy: 7785/10000 (77.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 231: Average loss: 5.7954, Accuracy: 409/9000 (4.5444%)
Done in 330.9011526107788 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:232 choose agents : [17, 33, 77, 11, 88, 25, 27, 56, 93, 42]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   1,  Average loss: 0.0129, Accuracy: 463/526 (88.0228%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   2,  Average loss: 0.0111, Accuracy: 451/526 (85.7414%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   3,  Average loss: 0.0084, Accuracy: 462/526 (87.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   4,  Average loss: 0.0030, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   5,  Average loss: 0.0032, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   6,  Average loss: 0.0025, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Global model norm: 37.63475462733051.
Norm before scaling: 38.58018486299022. Distance: 9.999715801015258
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.6868, Accuracy: 4899/10000 (48.9900%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.1726, Accuracy: 8461/9000 (94.0111%)
Scaling by  100
Scaled Norm after poisoning: 999.2825864088696, distance: 999.9714995938634
Total norm for 4 adversaries is: 999.2825864088696. distance: 999.9714995938634
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   1,  Average loss: 0.0142, Accuracy: 444/527 (84.2505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   2,  Average loss: 0.0119, Accuracy: 453/527 (85.9583%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   3,  Average loss: 0.0088, Accuracy: 462/527 (87.6660%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   4,  Average loss: 0.0050, Accuracy: 487/527 (92.4099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   5,  Average loss: 0.0046, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   6,  Average loss: 0.0031, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Global model norm: 37.63475462733051.
Norm before scaling: 38.99973707844067. Distance: 11.267915490215078
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.8458, Accuracy: 4885/10000 (48.8500%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.1725, Accuracy: 8465/9000 (94.0556%)
Scaling by  100
Scaled Norm after poisoning: 1126.4276496961534, distance: 1126.79157345092
Total norm for 4 adversaries is: 1126.4276496961534. distance: 1126.79157345092
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   1,  Average loss: 0.0092, Accuracy: 440/496 (88.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 457/496 (92.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   3,  Average loss: 0.0033, Accuracy: 476/496 (95.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   4,  Average loss: 0.0026, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.63475462733051.
Norm before scaling: 37.82329068655152. Distance: 6.162722211007797
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.1098, Accuracy: 6317/10000 (63.1700%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.2336, Accuracy: 8459/9000 (93.9889%)
Scaling by  100
Scaled Norm after poisoning: 615.4937550454919, distance: 616.2721598449828
Total norm for 4 adversaries is: 615.4937550454919. distance: 616.2721598449828
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   1,  Average loss: 0.0087, Accuracy: 489/546 (89.5604%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 505/546 (92.4908%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   3,  Average loss: 0.0025, Accuracy: 528/546 (96.7033%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.63475462733051.
Norm before scaling: 37.837814356969666. Distance: 6.595398610919135
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.2724, Accuracy: 6074/10000 (60.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.1563, Accuracy: 8615/9000 (95.7222%)
Scaling by  100
Scaled Norm after poisoning: 658.4768408987517, distance: 659.5398490614498
Total norm for 4 adversaries is: 658.4768408987517. distance: 659.5398490614498
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 232, local model 88, internal_epoch   1,  Average loss: 0.0075, Accuracy: 368/447 (82.3266%)
___Train Local_ResNet_18,  epoch 232, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 403/447 (90.1566%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 4.5712, Accuracy: 2786/10000 (27.8600%)
___Train Local_ResNet_18,  epoch 232, local model 25, internal_epoch   1,  Average loss: 0.0034, Accuracy: 515/545 (94.4954%)
___Train Local_ResNet_18,  epoch 232, local model 25, internal_epoch   2,  Average loss: 0.0016, Accuracy: 527/545 (96.6972%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 4.1733, Accuracy: 3471/10000 (34.7100%)
___Train Local_ResNet_18,  epoch 232, local model 27, internal_epoch   1,  Average loss: 0.0019, Accuracy: 382/397 (96.2217%)
___Train Local_ResNet_18,  epoch 232, local model 27, internal_epoch   2,  Average loss: 0.0007, Accuracy: 396/397 (99.7481%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.5929, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 232, local model 56, internal_epoch   1,  Average loss: 0.0020, Accuracy: 722/743 (97.1736%)
___Train Local_ResNet_18,  epoch 232, local model 56, internal_epoch   2,  Average loss: 0.0012, Accuracy: 731/743 (98.3849%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.4234, Accuracy: 6194/10000 (61.9400%)
___Train Local_ResNet_18,  epoch 232, local model 93, internal_epoch   1,  Average loss: 0.0027, Accuracy: 554/584 (94.8630%)
___Train Local_ResNet_18,  epoch 232, local model 93, internal_epoch   2,  Average loss: 0.0031, Accuracy: 555/584 (95.0342%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 4.3824, Accuracy: 3559/10000 (35.5900%)
___Train Local_ResNet_18,  epoch 232, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 178/198 (89.8990%)
___Train Local_ResNet_18,  epoch 232, local model 42, internal_epoch   2,  Average loss: 0.0005, Accuracy: 198/198 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 3.3159, Accuracy: 3587/10000 (35.8700%)
time spent on training: 276.93908047676086
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4182471551207826  data num: [526, 527, 496, 546, 447, 545, 397, 743, 584, 198]
[foolsgold agg] considering poison per batch poison_fraction: 0.03267555899381114
[foolsgold agg] wv: [0.55693788 0.         0.00137369 0.         1.         0.
 1.         1.         1.         0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 232: Average loss: 0.6689, Accuracy: 7786/10000 (77.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 232: Average loss: 5.7759, Accuracy: 416/9000 (4.6222%)
Done in 332.7007460594177 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:233 choose agents : [17, 33, 77, 11, 18, 66, 27, 82, 86, 67]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   1,  Average loss: 0.0133, Accuracy: 470/526 (89.3536%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   2,  Average loss: 0.0145, Accuracy: 440/526 (83.6502%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   3,  Average loss: 0.0099, Accuracy: 441/526 (83.8403%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   4,  Average loss: 0.0061, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   5,  Average loss: 0.0031, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   6,  Average loss: 0.0030, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Global model norm: 37.63361287943764.
Norm before scaling: 38.81479902108054. Distance: 10.903865345829454
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.8939, Accuracy: 4728/10000 (47.2800%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.4022, Accuracy: 7853/9000 (87.2556%)
Scaling by  100
Scaled Norm after poisoning: 1089.7245638233544, distance: 1090.3866286781033
Total norm for 4 adversaries is: 1089.7245638233544. distance: 1090.3866286781033
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   1,  Average loss: 0.0157, Accuracy: 437/527 (82.9222%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   2,  Average loss: 0.0106, Accuracy: 445/527 (84.4402%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   3,  Average loss: 0.0082, Accuracy: 476/527 (90.3226%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   4,  Average loss: 0.0049, Accuracy: 485/527 (92.0304%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   5,  Average loss: 0.0042, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   6,  Average loss: 0.0035, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.63361287943764.
Norm before scaling: 38.63210865764303. Distance: 10.248598328561584
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.7834, Accuracy: 4807/10000 (48.0700%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.3401, Accuracy: 7825/9000 (86.9444%)
Scaling by  100
Scaled Norm after poisoning: 1024.141469719882, distance: 1024.8598074858824
Total norm for 4 adversaries is: 1024.141469719882. distance: 1024.8598074858824
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   1,  Average loss: 0.0090, Accuracy: 438/496 (88.3065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   2,  Average loss: 0.0066, Accuracy: 447/496 (90.1210%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   3,  Average loss: 0.0038, Accuracy: 477/496 (96.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   4,  Average loss: 0.0019, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.63361287943764.
Norm before scaling: 37.80975745477697. Distance: 6.173391575933337
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.0796, Accuracy: 6463/10000 (64.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.1827, Accuracy: 8536/9000 (94.8444%)
Scaling by  100
Scaled Norm after poisoning: 616.4752123970597, distance: 617.3391490906761
Total norm for 4 adversaries is: 616.4752123970597. distance: 617.3391490906761
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 484/546 (88.6447%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   2,  Average loss: 0.0056, Accuracy: 505/546 (92.4908%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   3,  Average loss: 0.0029, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   4,  Average loss: 0.0021, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.63361287943764.
Norm before scaling: 37.854139972874. Distance: 6.65386547664213
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.3664, Accuracy: 5802/10000 (58.0200%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.1811, Accuracy: 8576/9000 (95.2889%)
Scaling by  100
Scaled Norm after poisoning: 664.374000469615, distance: 665.3864713457887
Total norm for 4 adversaries is: 664.374000469615. distance: 665.3864713457887
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 233, local model 18, internal_epoch   1,  Average loss: 0.0028, Accuracy: 365/386 (94.5596%)
___Train Local_ResNet_18,  epoch 233, local model 18, internal_epoch   2,  Average loss: 0.0016, Accuracy: 374/386 (96.8912%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 2.0600, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 233, local model 66, internal_epoch   1,  Average loss: 0.0025, Accuracy: 532/555 (95.8559%)
___Train Local_ResNet_18,  epoch 233, local model 66, internal_epoch   2,  Average loss: 0.0008, Accuracy: 544/555 (98.0180%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 3.3325, Accuracy: 4078/10000 (40.7800%)
___Train Local_ResNet_18,  epoch 233, local model 27, internal_epoch   1,  Average loss: 0.0019, Accuracy: 384/397 (96.7254%)
___Train Local_ResNet_18,  epoch 233, local model 27, internal_epoch   2,  Average loss: 0.0005, Accuracy: 396/397 (99.7481%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.5097, Accuracy: 5958/10000 (59.5800%)
___Train Local_ResNet_18,  epoch 233, local model 82, internal_epoch   1,  Average loss: 0.0040, Accuracy: 574/601 (95.5075%)
___Train Local_ResNet_18,  epoch 233, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 554/601 (92.1797%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 3.7519, Accuracy: 3954/10000 (39.5400%)
___Train Local_ResNet_18,  epoch 233, local model 86, internal_epoch   1,  Average loss: 0.0038, Accuracy: 200/212 (94.3396%)
___Train Local_ResNet_18,  epoch 233, local model 86, internal_epoch   2,  Average loss: 0.0008, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.4493, Accuracy: 6271/10000 (62.7100%)
___Train Local_ResNet_18,  epoch 233, local model 67, internal_epoch   1,  Average loss: 0.0054, Accuracy: 769/842 (91.3302%)
___Train Local_ResNet_18,  epoch 233, local model 67, internal_epoch   2,  Average loss: 0.0132, Accuracy: 660/842 (78.3848%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 45.6272, Accuracy: 1200/10000 (12.0000%)
time spent on training: 269.39438939094543
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4117531446540881  data num: [526, 527, 496, 546, 386, 555, 397, 601, 212, 842]
[foolsgold agg] considering poison per batch poison_fraction: 0.03216821442610063
[foolsgold agg] wv: [0.57971054 0.         0.         0.         1.         0.82547156
 0.56609145 0.56609145 1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 233: Average loss: 0.6675, Accuracy: 7793/10000 (77.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 233: Average loss: 5.7672, Accuracy: 424/9000 (4.7111%)
Done in 322.36464524269104 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:234 choose agents : [17, 33, 77, 11, 38, 29, 30, 96, 0, 3]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   1,  Average loss: 0.0107, Accuracy: 466/526 (88.5932%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   2,  Average loss: 0.0140, Accuracy: 442/526 (84.0304%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   3,  Average loss: 0.0078, Accuracy: 462/526 (87.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   4,  Average loss: 0.0046, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   5,  Average loss: 0.0035, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   6,  Average loss: 0.0035, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Global model norm: 37.632634905902314.
Norm before scaling: 39.07962437147554. Distance: 11.545674386795188
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.9312, Accuracy: 4492/10000 (44.9200%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.1966, Accuracy: 8358/9000 (92.8667%)
Scaling by  100
Scaled Norm after poisoning: 1154.2148305233302, distance: 1154.5674514726284
Total norm for 4 adversaries is: 1154.2148305233302. distance: 1154.5674514726284
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   1,  Average loss: 0.0141, Accuracy: 444/527 (84.2505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   2,  Average loss: 0.0118, Accuracy: 442/527 (83.8710%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   3,  Average loss: 0.0064, Accuracy: 482/527 (91.4611%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   4,  Average loss: 0.0045, Accuracy: 494/527 (93.7381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   5,  Average loss: 0.0036, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   6,  Average loss: 0.0024, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Global model norm: 37.632634905902314.
Norm before scaling: 38.46157465067408. Distance: 9.677067609157591
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.8833, Accuracy: 4260/10000 (42.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.0522, Accuracy: 8906/9000 (98.9556%)
Scaling by  100
Scaled Norm after poisoning: 966.8587668320539, distance: 967.7068577312036
Total norm for 4 adversaries is: 966.8587668320539. distance: 967.7068577312036
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   1,  Average loss: 0.0095, Accuracy: 436/496 (87.9032%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   2,  Average loss: 0.0065, Accuracy: 453/496 (91.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   3,  Average loss: 0.0034, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   4,  Average loss: 0.0012, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   5,  Average loss: 0.0010, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   6,  Average loss: 0.0013, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Global model norm: 37.632634905902314.
Norm before scaling: 37.795998142474524. Distance: 6.05723264298638
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.0384, Accuracy: 6597/10000 (65.9700%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.1046, Accuracy: 8742/9000 (97.1333%)
Scaling by  100
Scaled Norm after poisoning: 604.8801534188405, distance: 605.7232763399471
Total norm for 4 adversaries is: 604.8801534188405. distance: 605.7232763399471
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 492/546 (90.1099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 503/546 (92.1245%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   3,  Average loss: 0.0026, Accuracy: 526/546 (96.3370%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   4,  Average loss: 0.0011, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   6,  Average loss: 0.0011, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.632634905902314.
Norm before scaling: 37.836819077846485. Distance: 6.497209390068819
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.4099, Accuracy: 5893/10000 (58.9300%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.1117, Accuracy: 8750/9000 (97.2222%)
Scaling by  100
Scaled Norm after poisoning: 648.747326584087, distance: 649.7209497161069
Total norm for 4 adversaries is: 648.747326584087. distance: 649.7209497161069
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 234, local model 38, internal_epoch   1,  Average loss: 0.0021, Accuracy: 727/756 (96.1640%)
___Train Local_ResNet_18,  epoch 234, local model 38, internal_epoch   2,  Average loss: 0.0026, Accuracy: 716/756 (94.7090%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 2.1250, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch 234, local model 29, internal_epoch   1,  Average loss: 0.0059, Accuracy: 760/848 (89.6226%)
___Train Local_ResNet_18,  epoch 234, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 779/848 (91.8632%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 4.2161, Accuracy: 3390/10000 (33.9000%)
___Train Local_ResNet_18,  epoch 234, local model 30, internal_epoch   1,  Average loss: 0.0055, Accuracy: 298/337 (88.4273%)
___Train Local_ResNet_18,  epoch 234, local model 30, internal_epoch   2,  Average loss: 0.0031, Accuracy: 325/337 (96.4392%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 4.7144, Accuracy: 3234/10000 (32.3400%)
___Train Local_ResNet_18,  epoch 234, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 647/708 (91.3842%)
___Train Local_ResNet_18,  epoch 234, local model 96, internal_epoch   2,  Average loss: 0.0234, Accuracy: 397/708 (56.0734%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 30.5628, Accuracy: 1651/10000 (16.5100%)
___Train Local_ResNet_18,  epoch 234, local model 0, internal_epoch   1,  Average loss: 0.0071, Accuracy: 315/367 (85.8311%)
___Train Local_ResNet_18,  epoch 234, local model 0, internal_epoch   2,  Average loss: 0.0022, Accuracy: 355/367 (96.7302%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 7.3818, Accuracy: 1937/10000 (19.3700%)
___Train Local_ResNet_18,  epoch 234, local model 3, internal_epoch   1,  Average loss: 0.0083, Accuracy: 682/780 (87.4359%)
___Train Local_ResNet_18,  epoch 234, local model 3, internal_epoch   2,  Average loss: 0.0188, Accuracy: 551/780 (70.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 250.8256, Accuracy: 1000/10000 (10.0000%)
time spent on training: 273.0093266963959
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.35562722797487695  data num: [526, 527, 496, 546, 756, 848, 337, 708, 367, 780]
[foolsgold agg] considering poison per batch poison_fraction: 0.02778337718553726
[foolsgold agg] wv: [0.87668404 0.         0.19282787 0.         1.         1.
 1.         1.         0.49449476 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 234: Average loss: 0.6668, Accuracy: 7789/10000 (77.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 234: Average loss: 5.7545, Accuracy: 430/9000 (4.7778%)
Done in 327.04596066474915 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:235 choose agents : [17, 33, 77, 11, 8, 68, 79, 90, 21, 25]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   1,  Average loss: 0.0119, Accuracy: 474/526 (90.1141%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   2,  Average loss: 0.0098, Accuracy: 460/526 (87.4525%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   3,  Average loss: 0.0078, Accuracy: 483/526 (91.8251%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   4,  Average loss: 0.0060, Accuracy: 493/526 (93.7262%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   5,  Average loss: 0.0033, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   6,  Average loss: 0.0030, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Global model norm: 37.63243865939497.
Norm before scaling: 38.4337031280205. Distance: 9.497330541502217
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.7662, Accuracy: 4930/10000 (49.3000%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.4551, Accuracy: 7738/9000 (85.9778%)
Scaling by  100
Scaled Norm after poisoning: 948.9383541621658, distance: 949.7330216960975
Total norm for 4 adversaries is: 948.9383541621658. distance: 949.7330216960975
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   1,  Average loss: 0.0149, Accuracy: 439/527 (83.3017%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   2,  Average loss: 0.0121, Accuracy: 443/527 (84.0607%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   3,  Average loss: 0.0081, Accuracy: 466/527 (88.4250%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   4,  Average loss: 0.0037, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   5,  Average loss: 0.0029, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   6,  Average loss: 0.0016, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 37.63243865939497.
Norm before scaling: 38.656324209205245. Distance: 10.385011186148322
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 2.2779, Accuracy: 3933/10000 (39.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.0291, Accuracy: 8944/9000 (99.3778%)
Scaling by  100
Scaled Norm after poisoning: 1037.7509335095776, distance: 1038.5012036584262
Total norm for 4 adversaries is: 1037.7509335095776. distance: 1038.5012036584262
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   1,  Average loss: 0.0075, Accuracy: 448/496 (90.3226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 452/496 (91.1290%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   3,  Average loss: 0.0029, Accuracy: 473/496 (95.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   4,  Average loss: 0.0014, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   5,  Average loss: 0.0015, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   6,  Average loss: 0.0013, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Global model norm: 37.63243865939497.
Norm before scaling: 37.80189998635154. Distance: 5.982385528782832
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.1138, Accuracy: 6407/10000 (64.0700%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.1438, Accuracy: 8658/9000 (96.2000%)
Scaling by  100
Scaled Norm after poisoning: 597.4990062753243, distance: 598.2385863934221
Total norm for 4 adversaries is: 597.4990062753243. distance: 598.2385863934221
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   1,  Average loss: 0.0073, Accuracy: 498/546 (91.2088%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 506/546 (92.6740%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   3,  Average loss: 0.0018, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   4,  Average loss: 0.0007, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 37.63243865939497.
Norm before scaling: 37.82955290830421. Distance: 6.326044941706642
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.2848, Accuracy: 6181/10000 (61.8100%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.2858, Accuracy: 8401/9000 (93.3444%)
Scaling by  100
Scaled Norm after poisoning: 631.7358773649, distance: 632.6045368158531
Total norm for 4 adversaries is: 631.7358773649. distance: 632.6045368158531
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 235, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 496/534 (92.8839%)
___Train Local_ResNet_18,  epoch 235, local model 8, internal_epoch   2,  Average loss: 0.0035, Accuracy: 501/534 (93.8202%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 2.2751, Accuracy: 4723/10000 (47.2300%)
___Train Local_ResNet_18,  epoch 235, local model 68, internal_epoch   1,  Average loss: 0.0024, Accuracy: 402/416 (96.6346%)
___Train Local_ResNet_18,  epoch 235, local model 68, internal_epoch   2,  Average loss: 0.0012, Accuracy: 412/416 (99.0385%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.4628, Accuracy: 6076/10000 (60.7600%)
___Train Local_ResNet_18,  epoch 235, local model 79, internal_epoch   1,  Average loss: 0.0087, Accuracy: 133/154 (86.3636%)
___Train Local_ResNet_18,  epoch 235, local model 79, internal_epoch   2,  Average loss: 0.0006, Accuracy: 154/154 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.7711, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch 235, local model 90, internal_epoch   1,  Average loss: 0.0110, Accuracy: 518/578 (89.6194%)
___Train Local_ResNet_18,  epoch 235, local model 90, internal_epoch   2,  Average loss: 0.0211, Accuracy: 416/578 (71.9723%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 705.3535, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 235, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 245/262 (93.5115%)
___Train Local_ResNet_18,  epoch 235, local model 21, internal_epoch   2,  Average loss: 0.0076, Accuracy: 252/262 (96.1832%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 13.3903, Accuracy: 1370/10000 (13.7000%)
___Train Local_ResNet_18,  epoch 235, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 503/545 (92.2936%)
___Train Local_ResNet_18,  epoch 235, local model 25, internal_epoch   2,  Average loss: 0.0018, Accuracy: 529/545 (97.0642%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 4.4756, Accuracy: 3613/10000 (36.1300%)
time spent on training: 268.673823595047
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4570244328097731  data num: [526, 527, 496, 546, 534, 416, 154, 578, 262, 545]
[foolsgold agg] considering poison per batch poison_fraction: 0.03570503381326352
[foolsgold agg] wv: [0.63812722 0.         0.00346283 0.         0.54319708 1.
 1.         0.54319708 1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 235: Average loss: 0.6654, Accuracy: 7793/10000 (77.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 235: Average loss: 5.7348, Accuracy: 441/9000 (4.9000%)
Done in 322.158819437027 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:236 choose agents : [17, 33, 77, 11, 53, 14, 6, 12, 7, 58]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   1,  Average loss: 0.0128, Accuracy: 471/526 (89.5437%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   2,  Average loss: 0.0125, Accuracy: 463/526 (88.0228%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   3,  Average loss: 0.0082, Accuracy: 470/526 (89.3536%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   4,  Average loss: 0.0038, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   5,  Average loss: 0.0041, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   6,  Average loss: 0.0043, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Global model norm: 37.63116708697891.
Norm before scaling: 38.41729175337666. Distance: 9.393879915050992
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.7298, Accuracy: 5000/10000 (50.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.4577, Accuracy: 7719/9000 (85.7667%)
Scaling by  100
Scaled Norm after poisoning: 938.6265564642841, distance: 939.3879323793765
Total norm for 4 adversaries is: 938.6265564642841. distance: 939.3879323793765
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   1,  Average loss: 0.0126, Accuracy: 439/527 (83.3017%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   2,  Average loss: 0.0095, Accuracy: 461/527 (87.4763%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   3,  Average loss: 0.0072, Accuracy: 483/527 (91.6509%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   4,  Average loss: 0.0032, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   5,  Average loss: 0.0029, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   6,  Average loss: 0.0035, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Global model norm: 37.63116708697891.
Norm before scaling: 38.66661580400301. Distance: 10.336810685669308
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 2.0950, Accuracy: 4381/10000 (43.8100%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.4978, Accuracy: 7866/9000 (87.4000%)
Scaling by  100
Scaled Norm after poisoning: 1033.0189373869193, distance: 1033.6810436493454
Total norm for 4 adversaries is: 1033.0189373869193. distance: 1033.6810436493454
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   1,  Average loss: 0.0080, Accuracy: 448/496 (90.3226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 470/496 (94.7581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   3,  Average loss: 0.0028, Accuracy: 479/496 (96.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   4,  Average loss: 0.0012, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.63116708697891.
Norm before scaling: 37.7324064574513. Distance: 5.568341049437137
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 0.9755, Accuracy: 6857/10000 (68.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.1382, Accuracy: 8658/9000 (96.2000%)
Scaling by  100
Scaled Norm after poisoning: 556.0060701107498, distance: 556.8341034365621
Total norm for 4 adversaries is: 556.0060701107498. distance: 556.8341034365621
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   1,  Average loss: 0.0085, Accuracy: 486/546 (89.0110%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   2,  Average loss: 0.0049, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   3,  Average loss: 0.0026, Accuracy: 522/546 (95.6044%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   4,  Average loss: 0.0017, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   6,  Average loss: 0.0017, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.63116708697891.
Norm before scaling: 37.85982640052811. Distance: 6.62777335220165
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.4291, Accuracy: 5680/10000 (56.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.0688, Accuracy: 8809/9000 (97.8778%)
Scaling by  100
Scaled Norm after poisoning: 661.8333202174094, distance: 662.7773240312315
Total norm for 4 adversaries is: 661.8333202174094. distance: 662.7773240312315
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 236, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 568/625 (90.8800%)
___Train Local_ResNet_18,  epoch 236, local model 53, internal_epoch   2,  Average loss: 0.0035, Accuracy: 580/625 (92.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 4.4932, Accuracy: 3227/10000 (32.2700%)
___Train Local_ResNet_18,  epoch 236, local model 14, internal_epoch   1,  Average loss: 0.0081, Accuracy: 272/318 (85.5346%)
___Train Local_ResNet_18,  epoch 236, local model 14, internal_epoch   2,  Average loss: 0.0015, Accuracy: 308/318 (96.8553%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 5.9863, Accuracy: 2623/10000 (26.2300%)
___Train Local_ResNet_18,  epoch 236, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 485/520 (93.2692%)
___Train Local_ResNet_18,  epoch 236, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 483/520 (92.8846%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 2.8586, Accuracy: 4279/10000 (42.7900%)
___Train Local_ResNet_18,  epoch 236, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 895/977 (91.6070%)
___Train Local_ResNet_18,  epoch 236, local model 12, internal_epoch   2,  Average loss: 0.0078, Accuracy: 840/977 (85.9775%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 6.7611, Accuracy: 2721/10000 (27.2100%)
___Train Local_ResNet_18,  epoch 236, local model 7, internal_epoch   1,  Average loss: 0.0028, Accuracy: 333/352 (94.6023%)
___Train Local_ResNet_18,  epoch 236, local model 7, internal_epoch   2,  Average loss: 0.0009, Accuracy: 347/352 (98.5795%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 2.4768, Accuracy: 4555/10000 (45.5500%)
___Train Local_ResNet_18,  epoch 236, local model 58, internal_epoch   1,  Average loss: 0.0090, Accuracy: 195/234 (83.3333%)
___Train Local_ResNet_18,  epoch 236, local model 58, internal_epoch   2,  Average loss: 0.0008, Accuracy: 231/234 (98.7179%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 5.8708, Accuracy: 2115/10000 (21.1500%)
time spent on training: 271.1082818508148
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4090997851982035  data num: [526, 527, 496, 546, 625, 318, 520, 977, 352, 234]
[foolsgold agg] considering poison per batch poison_fraction: 0.03196092071860965
[foolsgold agg] wv: [0.6685107  0.         0.04033107 0.         1.         0.05027712
 0.         1.         1.         0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 236: Average loss: 0.6640, Accuracy: 7799/10000 (77.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 236: Average loss: 5.6982, Accuracy: 454/9000 (5.0444%)
Done in 324.324738740921 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:237 choose agents : [17, 33, 77, 11, 65, 0, 98, 20, 45, 82]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   1,  Average loss: 0.0101, Accuracy: 477/526 (90.6844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   2,  Average loss: 0.0138, Accuracy: 452/526 (85.9316%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   3,  Average loss: 0.0071, Accuracy: 470/526 (89.3536%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   4,  Average loss: 0.0041, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   5,  Average loss: 0.0033, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   6,  Average loss: 0.0023, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 37.63026690451036.
Norm before scaling: 38.37086767755096. Distance: 9.178055041016997
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.7111, Accuracy: 4933/10000 (49.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.1901, Accuracy: 8390/9000 (93.2222%)
Scaling by  100
Scaled Norm after poisoning: 917.0540128585666, distance: 917.8055349582503
Total norm for 4 adversaries is: 917.0540128585666. distance: 917.8055349582503
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   1,  Average loss: 0.0133, Accuracy: 439/527 (83.3017%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   2,  Average loss: 0.0109, Accuracy: 435/527 (82.5427%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   3,  Average loss: 0.0054, Accuracy: 484/527 (91.8406%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   4,  Average loss: 0.0036, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   5,  Average loss: 0.0027, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   6,  Average loss: 0.0027, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Global model norm: 37.63026690451036.
Norm before scaling: 38.56268834789903. Distance: 9.945284499543261
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.6237, Accuracy: 5164/10000 (51.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.2522, Accuracy: 8254/9000 (91.7111%)
Scaling by  100
Scaled Norm after poisoning: 993.8392412759722, distance: 994.5285943601622
Total norm for 4 adversaries is: 993.8392412759722. distance: 994.5285943601622
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   1,  Average loss: 0.0069, Accuracy: 444/496 (89.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   2,  Average loss: 0.0063, Accuracy: 453/496 (91.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   3,  Average loss: 0.0027, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   4,  Average loss: 0.0020, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   5,  Average loss: 0.0013, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.63026690451036.
Norm before scaling: 37.78882264886669. Distance: 5.953004530441173
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.1419, Accuracy: 6258/10000 (62.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.1150, Accuracy: 8717/9000 (96.8556%)
Scaling by  100
Scaled Norm after poisoning: 594.5172411293048, distance: 595.3005543420903
Total norm for 4 adversaries is: 594.5172411293048. distance: 595.3005543420903
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 493/546 (90.2930%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   3,  Average loss: 0.0023, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   4,  Average loss: 0.0011, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.63026690451036.
Norm before scaling: 37.861256337386806. Distance: 6.608340351474622
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.3563, Accuracy: 6014/10000 (60.1400%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.2598, Accuracy: 8409/9000 (93.4333%)
Scaling by  100
Scaled Norm after poisoning: 659.9200945947925, distance: 660.8340846990264
Total norm for 4 adversaries is: 659.9200945947925. distance: 660.8340846990264
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 237, local model 65, internal_epoch   1,  Average loss: 0.0040, Accuracy: 290/314 (92.3567%)
___Train Local_ResNet_18,  epoch 237, local model 65, internal_epoch   2,  Average loss: 0.0006, Accuracy: 312/314 (99.3631%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 3.4785, Accuracy: 3413/10000 (34.1300%)
___Train Local_ResNet_18,  epoch 237, local model 0, internal_epoch   1,  Average loss: 0.0064, Accuracy: 322/367 (87.7384%)
___Train Local_ResNet_18,  epoch 237, local model 0, internal_epoch   2,  Average loss: 0.0037, Accuracy: 344/367 (93.7330%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 4.7677, Accuracy: 2784/10000 (27.8400%)
___Train Local_ResNet_18,  epoch 237, local model 98, internal_epoch   1,  Average loss: 0.0036, Accuracy: 738/802 (92.0200%)
___Train Local_ResNet_18,  epoch 237, local model 98, internal_epoch   2,  Average loss: 0.0060, Accuracy: 710/802 (88.5287%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 4.0459, Accuracy: 3894/10000 (38.9400%)
___Train Local_ResNet_18,  epoch 237, local model 20, internal_epoch   1,  Average loss: 0.0078, Accuracy: 303/362 (83.7017%)
___Train Local_ResNet_18,  epoch 237, local model 20, internal_epoch   2,  Average loss: 0.0027, Accuracy: 339/362 (93.6464%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 6.0319, Accuracy: 2871/10000 (28.7100%)
___Train Local_ResNet_18,  epoch 237, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 474/529 (89.6030%)
___Train Local_ResNet_18,  epoch 237, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 484/529 (91.4934%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 3.1620, Accuracy: 3606/10000 (36.0600%)
___Train Local_ResNet_18,  epoch 237, local model 82, internal_epoch   1,  Average loss: 0.0021, Accuracy: 577/601 (96.0067%)
___Train Local_ResNet_18,  epoch 237, local model 82, internal_epoch   2,  Average loss: 0.0018, Accuracy: 580/601 (96.5058%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 2.8258, Accuracy: 4740/10000 (47.4000%)
time spent on training: 268.89010071754456
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41321499013806706  data num: [526, 527, 496, 546, 314, 367, 802, 362, 529, 601]
[foolsgold agg] considering poison per batch poison_fraction: 0.03228242110453649
[foolsgold agg] wv: [0.73334028 0.         0.1038635  0.         1.         0.38320476
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 237: Average loss: 0.6628, Accuracy: 7801/10000 (78.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 237: Average loss: 5.6675, Accuracy: 465/9000 (5.1667%)
Done in 322.9240462779999 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:238 choose agents : [17, 33, 77, 11, 88, 46, 85, 42, 29, 8]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   1,  Average loss: 0.0127, Accuracy: 468/526 (88.9734%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   2,  Average loss: 0.0116, Accuracy: 452/526 (85.9316%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   3,  Average loss: 0.0081, Accuracy: 472/526 (89.7338%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   4,  Average loss: 0.0055, Accuracy: 492/526 (93.5361%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   5,  Average loss: 0.0042, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   6,  Average loss: 0.0050, Accuracy: 488/526 (92.7757%), train_poison_data_count: 45
Global model norm: 37.629584049031486.
Norm before scaling: 38.555210704403336. Distance: 9.979124787202267
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 2.1661, Accuracy: 4542/10000 (45.4200%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: 0.6473, Accuracy: 7410/9000 (82.3333%)
Scaling by  100
Scaled Norm after poisoning: 997.1653887395009, distance: 997.9124773746444
Total norm for 4 adversaries is: 997.1653887395009. distance: 997.9124773746444
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   1,  Average loss: 0.0141, Accuracy: 445/527 (84.4402%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   2,  Average loss: 0.0151, Accuracy: 430/527 (81.5939%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   3,  Average loss: 0.0081, Accuracy: 474/527 (89.9431%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   4,  Average loss: 0.0051, Accuracy: 494/527 (93.7381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   5,  Average loss: 0.0026, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   6,  Average loss: 0.0041, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Global model norm: 37.629584049031486.
Norm before scaling: 38.497744011114634. Distance: 9.994337004312078
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.7367, Accuracy: 4822/10000 (48.2200%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: 0.1860, Accuracy: 8374/9000 (93.0444%)
Scaling by  100
Scaled Norm after poisoning: 998.4507373926868, distance: 999.4336833927501
Total norm for 4 adversaries is: 998.4507373926868. distance: 999.4336833927501
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 452/496 (91.1290%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   2,  Average loss: 0.0062, Accuracy: 453/496 (91.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   3,  Average loss: 0.0030, Accuracy: 472/496 (95.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   4,  Average loss: 0.0025, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.629584049031486.
Norm before scaling: 37.78364730814443. Distance: 5.813260920770629
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 0.9913, Accuracy: 6724/10000 (67.2400%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: 0.1581, Accuracy: 8670/9000 (96.3333%)
Scaling by  100
Scaled Norm after poisoning: 580.6362620005747, distance: 581.3261509256229
Total norm for 4 adversaries is: 580.6362620005747. distance: 581.3261509256229
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 491/546 (89.9267%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 513/546 (93.9560%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   3,  Average loss: 0.0026, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   4,  Average loss: 0.0021, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.629584049031486.
Norm before scaling: 37.814905011326225. Distance: 6.520373765962467
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.3696, Accuracy: 5903/10000 (59.0300%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: 0.1338, Accuracy: 8693/9000 (96.5889%)
Scaling by  100
Scaled Norm after poisoning: 650.9342324689953, distance: 652.0374078609294
Total norm for 4 adversaries is: 650.9342324689953. distance: 652.0374078609294
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 238, local model 88, internal_epoch   1,  Average loss: 0.0067, Accuracy: 386/447 (86.3535%)
___Train Local_ResNet_18,  epoch 238, local model 88, internal_epoch   2,  Average loss: 0.0033, Accuracy: 421/447 (94.1834%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 4.8002, Accuracy: 3070/10000 (30.7000%)
___Train Local_ResNet_18,  epoch 238, local model 46, internal_epoch   1,  Average loss: 0.0013, Accuracy: 592/601 (98.5025%)
___Train Local_ResNet_18,  epoch 238, local model 46, internal_epoch   2,  Average loss: 0.0010, Accuracy: 591/601 (98.3361%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.6095, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 238, local model 85, internal_epoch   1,  Average loss: 0.0069, Accuracy: 311/364 (85.4396%)
___Train Local_ResNet_18,  epoch 238, local model 85, internal_epoch   2,  Average loss: 0.0023, Accuracy: 352/364 (96.7033%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 4.1313, Accuracy: 3036/10000 (30.3600%)
___Train Local_ResNet_18,  epoch 238, local model 42, internal_epoch   1,  Average loss: 0.0078, Accuracy: 182/198 (91.9192%)
___Train Local_ResNet_18,  epoch 238, local model 42, internal_epoch   2,  Average loss: 0.0054, Accuracy: 181/198 (91.4141%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 5.4349, Accuracy: 2759/10000 (27.5900%)
___Train Local_ResNet_18,  epoch 238, local model 29, internal_epoch   1,  Average loss: 0.0054, Accuracy: 765/848 (90.2123%)
___Train Local_ResNet_18,  epoch 238, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 783/848 (92.3349%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 6.4322, Accuracy: 2575/10000 (25.7500%)
___Train Local_ResNet_18,  epoch 238, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 498/534 (93.2584%)
___Train Local_ResNet_18,  epoch 238, local model 8, internal_epoch   2,  Average loss: 0.0029, Accuracy: 509/534 (95.3184%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 2.1580, Accuracy: 4667/10000 (46.6700%)
time spent on training: 272.68720269203186
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41183408688814627  data num: [526, 527, 496, 546, 447, 601, 364, 198, 848, 534]
[foolsgold agg] considering poison per batch poison_fraction: 0.03217453803813643
[foolsgold agg] wv: [0.88261302 0.         0.23764169 0.         0.65881756 1.
 0.65881756 1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 238: Average loss: 0.6617, Accuracy: 7808/10000 (78.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 238: Average loss: 5.6306, Accuracy: 485/9000 (5.3889%)
Done in 326.29139852523804 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:239 choose agents : [17, 33, 77, 11, 63, 48, 69, 96, 88, 20]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   1,  Average loss: 0.0120, Accuracy: 467/526 (88.7833%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   2,  Average loss: 0.0102, Accuracy: 467/526 (88.7833%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   3,  Average loss: 0.0061, Accuracy: 482/526 (91.6350%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   4,  Average loss: 0.0037, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   5,  Average loss: 0.0037, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   6,  Average loss: 0.0027, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Global model norm: 37.6288411660524.
Norm before scaling: 38.3631155890044. Distance: 9.101468615395609
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.6694, Accuracy: 5010/10000 (50.1000%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: 0.3572, Accuracy: 7871/9000 (87.4556%)
Scaling by  100
Scaled Norm after poisoning: 909.4391815839034, distance: 910.1468631490195
Total norm for 4 adversaries is: 909.4391815839034. distance: 910.1468631490195
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   1,  Average loss: 0.0139, Accuracy: 442/527 (83.8710%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   2,  Average loss: 0.0105, Accuracy: 450/527 (85.3890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   3,  Average loss: 0.0084, Accuracy: 476/527 (90.3226%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   4,  Average loss: 0.0049, Accuracy: 493/527 (93.5484%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   5,  Average loss: 0.0036, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   6,  Average loss: 0.0031, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Global model norm: 37.6288411660524.
Norm before scaling: 38.50510600526328. Distance: 9.696909414089554
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.8134, Accuracy: 4884/10000 (48.8400%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: 0.9369, Accuracy: 6360/9000 (70.6667%)
Scaling by  100
Scaled Norm after poisoning: 969.0122870738018, distance: 969.6909623689395
Total norm for 4 adversaries is: 969.0122870738018. distance: 969.6909623689395
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   1,  Average loss: 0.0078, Accuracy: 444/496 (89.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   2,  Average loss: 0.0070, Accuracy: 451/496 (90.9274%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   3,  Average loss: 0.0038, Accuracy: 470/496 (94.7581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   4,  Average loss: 0.0024, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   5,  Average loss: 0.0016, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   6,  Average loss: 0.0011, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.6288411660524.
Norm before scaling: 37.774276910269904. Distance: 5.926695298653875
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.0093, Accuracy: 6706/10000 (67.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: 0.1808, Accuracy: 8567/9000 (95.1889%)
Scaling by  100
Scaled Norm after poisoning: 591.8251958982484, distance: 592.6694641619391
Total norm for 4 adversaries is: 591.8251958982484. distance: 592.6694641619391
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 491/546 (89.9267%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   2,  Average loss: 0.0043, Accuracy: 511/546 (93.5897%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   3,  Average loss: 0.0022, Accuracy: 527/546 (96.5201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   4,  Average loss: 0.0013, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 37.6288411660524.
Norm before scaling: 37.81723401409155. Distance: 6.314192441166331
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.3125, Accuracy: 6138/10000 (61.3800%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: 0.1959, Accuracy: 8580/9000 (95.3333%)
Scaling by  100
Scaled Norm after poisoning: 630.508277106653, distance: 631.4192594861199
Total norm for 4 adversaries is: 630.508277106653. distance: 631.4192594861199
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 239, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 703/752 (93.4840%)
___Train Local_ResNet_18,  epoch 239, local model 63, internal_epoch   2,  Average loss: 0.0023, Accuracy: 721/752 (95.8777%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.7934, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 239, local model 48, internal_epoch   1,  Average loss: 0.0057, Accuracy: 332/378 (87.8307%)
___Train Local_ResNet_18,  epoch 239, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 354/378 (93.6508%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 2.7124, Accuracy: 4190/10000 (41.9000%)
___Train Local_ResNet_18,  epoch 239, local model 69, internal_epoch   1,  Average loss: 0.0074, Accuracy: 189/216 (87.5000%)
___Train Local_ResNet_18,  epoch 239, local model 69, internal_epoch   2,  Average loss: 0.0017, Accuracy: 212/216 (98.1481%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 11.9790, Accuracy: 1008/10000 (10.0800%)
___Train Local_ResNet_18,  epoch 239, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 657/708 (92.7966%)
___Train Local_ResNet_18,  epoch 239, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 634/708 (89.5480%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 7.2744, Accuracy: 2577/10000 (25.7700%)
___Train Local_ResNet_18,  epoch 239, local model 88, internal_epoch   1,  Average loss: 0.0070, Accuracy: 387/447 (86.5772%)
___Train Local_ResNet_18,  epoch 239, local model 88, internal_epoch   2,  Average loss: 0.0024, Accuracy: 428/447 (95.7494%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 3.2134, Accuracy: 3802/10000 (38.0200%)
___Train Local_ResNet_18,  epoch 239, local model 20, internal_epoch   1,  Average loss: 0.0069, Accuracy: 317/362 (87.5691%)
___Train Local_ResNet_18,  epoch 239, local model 20, internal_epoch   2,  Average loss: 0.0020, Accuracy: 350/362 (96.6851%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 6.5743, Accuracy: 2775/10000 (27.7500%)
time spent on training: 268.0304706096649
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4225494150867285  data num: [526, 527, 496, 546, 752, 378, 216, 708, 447, 362]
[foolsgold agg] considering poison per batch poison_fraction: 0.033011673053650666
[foolsgold agg] wv: [0.76064362 0.         0.14970361 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 239: Average loss: 0.6605, Accuracy: 7815/10000 (78.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 239: Average loss: 5.6033, Accuracy: 506/9000 (5.6222%)
Done in 321.7848091125488 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:240 choose agents : [17, 33, 77, 11, 71, 51, 95, 80, 24, 55]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   1,  Average loss: 0.0122, Accuracy: 475/526 (90.3042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   2,  Average loss: 0.0120, Accuracy: 447/526 (84.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   3,  Average loss: 0.0079, Accuracy: 475/526 (90.3042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   4,  Average loss: 0.0045, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   5,  Average loss: 0.0049, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   6,  Average loss: 0.0030, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 37.62813070965823.
Norm before scaling: 38.24865640511932. Distance: 8.969074097203837
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.6756, Accuracy: 4734/10000 (47.3400%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: 0.3377, Accuracy: 7937/9000 (88.1889%)
Scaling by  100
Scaled Norm after poisoning: 895.8362713130117, distance: 896.907394885336
Total norm for 4 adversaries is: 895.8362713130117. distance: 896.907394885336
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   1,  Average loss: 0.0110, Accuracy: 449/527 (85.1992%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   2,  Average loss: 0.0107, Accuracy: 465/527 (88.2353%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   3,  Average loss: 0.0062, Accuracy: 472/527 (89.5636%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   4,  Average loss: 0.0037, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   5,  Average loss: 0.0029, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   6,  Average loss: 0.0019, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Global model norm: 37.62813070965823.
Norm before scaling: 38.36005122876451. Distance: 9.000387395362578
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.8167, Accuracy: 4810/10000 (48.1000%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: 0.3537, Accuracy: 8049/9000 (89.4333%)
Scaling by  100
Scaled Norm after poisoning: 899.4144275582864, distance: 900.0386102829144
Total norm for 4 adversaries is: 899.4144275582864. distance: 900.0386102829144
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   1,  Average loss: 0.0084, Accuracy: 444/496 (89.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 458/496 (92.3387%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   3,  Average loss: 0.0041, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   4,  Average loss: 0.0024, Accuracy: 477/496 (96.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   6,  Average loss: 0.0010, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.62813070965823.
Norm before scaling: 37.72514282765789. Distance: 5.723218829002473
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.0142, Accuracy: 6617/10000 (66.1700%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: 0.2400, Accuracy: 8441/9000 (93.7889%)
Scaling by  100
Scaled Norm after poisoning: 571.3350593128343, distance: 572.321970135692
Total norm for 4 adversaries is: 571.3350593128343. distance: 572.321970135692
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   1,  Average loss: 0.0084, Accuracy: 484/546 (88.6447%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   2,  Average loss: 0.0059, Accuracy: 504/546 (92.3077%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   3,  Average loss: 0.0043, Accuracy: 519/546 (95.0549%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   4,  Average loss: 0.0023, Accuracy: 527/546 (96.5201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.62813070965823.
Norm before scaling: 37.8876947964928. Distance: 6.917997699420654
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.3052, Accuracy: 6079/10000 (60.7900%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: 0.1529, Accuracy: 8646/9000 (96.0667%)
Scaling by  100
Scaled Norm after poisoning: 690.7800391586312, distance: 691.7997587813977
Total norm for 4 adversaries is: 690.7800391586312. distance: 691.7997587813977
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 240, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 1060/1166 (90.9091%)
___Train Local_ResNet_18,  epoch 240, local model 71, internal_epoch   2,  Average loss: 0.0075, Accuracy: 1002/1166 (85.9348%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 3.9183, Accuracy: 3810/10000 (38.1000%)
___Train Local_ResNet_18,  epoch 240, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 446/479 (93.1106%)
___Train Local_ResNet_18,  epoch 240, local model 51, internal_epoch   2,  Average loss: 0.0014, Accuracy: 466/479 (97.2860%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 3.9730, Accuracy: 3258/10000 (32.5800%)
___Train Local_ResNet_18,  epoch 240, local model 95, internal_epoch   1,  Average loss: 0.0090, Accuracy: 473/569 (83.1283%)
___Train Local_ResNet_18,  epoch 240, local model 95, internal_epoch   2,  Average loss: 0.0049, Accuracy: 516/569 (90.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 5.5716, Accuracy: 2846/10000 (28.4600%)
___Train Local_ResNet_18,  epoch 240, local model 80, internal_epoch   1,  Average loss: 0.0056, Accuracy: 317/363 (87.3278%)
___Train Local_ResNet_18,  epoch 240, local model 80, internal_epoch   2,  Average loss: 0.0009, Accuracy: 358/363 (98.6226%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 2.7890, Accuracy: 4340/10000 (43.4000%)
___Train Local_ResNet_18,  epoch 240, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 294/320 (91.8750%)
___Train Local_ResNet_18,  epoch 240, local model 24, internal_epoch   2,  Average loss: 0.0011, Accuracy: 315/320 (98.4375%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 3.6878, Accuracy: 3384/10000 (33.8400%)
___Train Local_ResNet_18,  epoch 240, local model 55, internal_epoch   1,  Average loss: 0.0047, Accuracy: 274/299 (91.6388%)
___Train Local_ResNet_18,  epoch 240, local model 55, internal_epoch   2,  Average loss: 0.0009, Accuracy: 294/299 (98.3278%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 6.8883, Accuracy: 2052/10000 (20.5200%)
time spent on training: 267.6896185874939
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.395955395955396  data num: [526, 527, 496, 546, 1166, 479, 569, 363, 320, 299]
[foolsgold agg] considering poison per batch poison_fraction: 0.03093401530901531
[foolsgold agg] wv: [1.         0.06295625 0.32564756 0.06295625 1.         0.
 1.         1.         1.         0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 240: Average loss: 0.6607, Accuracy: 7811/10000 (78.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 240: Average loss: 5.5453, Accuracy: 533/9000 (5.9222%)
Done in 321.1544270515442 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:241 choose agents : [17, 33, 77, 11, 13, 63, 61, 41, 90, 74]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   1,  Average loss: 0.0114, Accuracy: 475/526 (90.3042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   2,  Average loss: 0.0131, Accuracy: 453/526 (86.1217%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   3,  Average loss: 0.0079, Accuracy: 456/526 (86.6920%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   4,  Average loss: 0.0037, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   5,  Average loss: 0.0027, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   6,  Average loss: 0.0025, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Global model norm: 37.62730020481306.
Norm before scaling: 38.31582462889436. Distance: 8.906273129081809
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.9553, Accuracy: 4359/10000 (43.5900%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: 0.0891, Accuracy: 8702/9000 (96.6889%)
Scaling by  100
Scaled Norm after poisoning: 889.9043487926104, distance: 890.6273421021837
Total norm for 4 adversaries is: 889.9043487926104. distance: 890.6273421021837
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   1,  Average loss: 0.0148, Accuracy: 439/527 (83.3017%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   2,  Average loss: 0.0134, Accuracy: 440/527 (83.4915%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   3,  Average loss: 0.0088, Accuracy: 463/527 (87.8558%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   4,  Average loss: 0.0053, Accuracy: 481/527 (91.2713%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   5,  Average loss: 0.0040, Accuracy: 495/527 (93.9279%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   6,  Average loss: 0.0030, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Global model norm: 37.62730020481306.
Norm before scaling: 38.987149199888606. Distance: 11.30933955604162
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.9672, Accuracy: 4200/10000 (42.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: 0.7355, Accuracy: 6918/9000 (76.8667%)
Scaling by  100
Scaled Norm after poisoning: 1130.511333423951, distance: 1130.9339613788243
Total norm for 4 adversaries is: 1130.511333423951. distance: 1130.9339613788243
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   1,  Average loss: 0.0076, Accuracy: 449/496 (90.5242%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   2,  Average loss: 0.0067, Accuracy: 450/496 (90.7258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   3,  Average loss: 0.0034, Accuracy: 473/496 (95.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   4,  Average loss: 0.0024, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.62730020481306.
Norm before scaling: 37.80213248883091. Distance: 6.036761201946469
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.0390, Accuracy: 6609/10000 (66.0900%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: 0.1869, Accuracy: 8576/9000 (95.2889%)
Scaling by  100
Scaled Norm after poisoning: 602.9222327547725, distance: 603.6761083147154
Total norm for 4 adversaries is: 602.9222327547725. distance: 603.6761083147154
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 490/546 (89.7436%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 503/546 (92.1245%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   3,  Average loss: 0.0024, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   4,  Average loss: 0.0018, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.62730020481306.
Norm before scaling: 37.82011157894368. Distance: 6.4197783748603205
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.3095, Accuracy: 6019/10000 (60.1900%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: 0.1792, Accuracy: 8554/9000 (95.0444%)
Scaling by  100
Scaled Norm after poisoning: 641.0029982379177, distance: 641.9779737265135
Total norm for 4 adversaries is: 641.0029982379177. distance: 641.9779737265135
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 241, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 570/620 (91.9355%)
___Train Local_ResNet_18,  epoch 241, local model 13, internal_epoch   2,  Average loss: 0.0028, Accuracy: 596/620 (96.1290%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 3.3027, Accuracy: 4191/10000 (41.9100%)
___Train Local_ResNet_18,  epoch 241, local model 63, internal_epoch   1,  Average loss: 0.0024, Accuracy: 718/752 (95.4787%)
___Train Local_ResNet_18,  epoch 241, local model 63, internal_epoch   2,  Average loss: 0.0017, Accuracy: 726/752 (96.5426%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.5993, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 241, local model 61, internal_epoch   1,  Average loss: 0.0039, Accuracy: 539/590 (91.3559%)
___Train Local_ResNet_18,  epoch 241, local model 61, internal_epoch   2,  Average loss: 0.0060, Accuracy: 538/590 (91.1864%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 4.0284, Accuracy: 3315/10000 (33.1500%)
___Train Local_ResNet_18,  epoch 241, local model 41, internal_epoch   1,  Average loss: 0.0079, Accuracy: 431/513 (84.0156%)
___Train Local_ResNet_18,  epoch 241, local model 41, internal_epoch   2,  Average loss: 0.0244, Accuracy: 473/513 (92.2027%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 4.7143, Accuracy: 3395/10000 (33.9500%)
___Train Local_ResNet_18,  epoch 241, local model 90, internal_epoch   1,  Average loss: 0.0089, Accuracy: 516/578 (89.2734%)
___Train Local_ResNet_18,  epoch 241, local model 90, internal_epoch   2,  Average loss: 0.0188, Accuracy: 424/578 (73.3564%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 103.3071, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 241, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 435/469 (92.7505%)
___Train Local_ResNet_18,  epoch 241, local model 74, internal_epoch   2,  Average loss: 0.0029, Accuracy: 442/469 (94.2431%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 2.5888, Accuracy: 4132/10000 (41.3200%)
time spent on training: 273.04514932632446
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.372974897632188  data num: [526, 527, 496, 546, 620, 752, 590, 513, 578, 469]
[foolsgold agg] considering poison per batch poison_fraction: 0.029138663877514688
[foolsgold agg] wv: [0.57891841 0.         0.03029561 0.         1.         0.
 1.         1.         1.         0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 241: Average loss: 0.6580, Accuracy: 7819/10000 (78.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 241: Average loss: 5.5013, Accuracy: 559/9000 (6.2111%)
Done in 328.03008556365967 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:242 choose agents : [17, 33, 77, 11, 85, 14, 21, 78, 1, 2]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   1,  Average loss: 0.0115, Accuracy: 474/526 (90.1141%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   2,  Average loss: 0.0119, Accuracy: 439/526 (83.4601%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   3,  Average loss: 0.0082, Accuracy: 474/526 (90.1141%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   4,  Average loss: 0.0053, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   5,  Average loss: 0.0042, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   6,  Average loss: 0.0041, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Global model norm: 37.62587435393944.
Norm before scaling: 38.62320643337775. Distance: 9.97023271876382
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 1.6581, Accuracy: 5114/10000 (51.1400%)
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: 0.3284, Accuracy: 7972/9000 (88.5778%)
Scaling by  100
Scaled Norm after poisoning: 996.5616513793816, distance: 997.0232883438581
Total norm for 4 adversaries is: 996.5616513793816. distance: 997.0232883438581
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   1,  Average loss: 0.0145, Accuracy: 433/527 (82.1632%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   2,  Average loss: 0.0092, Accuracy: 462/527 (87.6660%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   3,  Average loss: 0.0089, Accuracy: 470/527 (89.1841%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   4,  Average loss: 0.0042, Accuracy: 500/527 (94.8767%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   5,  Average loss: 0.0020, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   6,  Average loss: 0.0021, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Global model norm: 37.62587435393944.
Norm before scaling: 38.27722236465343. Distance: 8.971306306944788
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 1.6405, Accuracy: 5122/10000 (51.2200%)
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: 0.1712, Accuracy: 8448/9000 (93.8667%)
Scaling by  100
Scaled Norm after poisoning: 896.188910051893, distance: 897.1306343002674
Total norm for 4 adversaries is: 896.188910051893. distance: 897.1306343002674
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   1,  Average loss: 0.0083, Accuracy: 448/496 (90.3226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 456/496 (91.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   3,  Average loss: 0.0027, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   4,  Average loss: 0.0015, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.62587435393944.
Norm before scaling: 37.75416471232015. Distance: 5.7597914546725
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 1.0138, Accuracy: 6812/10000 (68.1200%)
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: 0.2382, Accuracy: 8471/9000 (94.1222%)
Scaling by  100
Scaled Norm after poisoning: 575.1671224522487, distance: 575.9791120344556
Total norm for 4 adversaries is: 575.1671224522487. distance: 575.9791120344556
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   1,  Average loss: 0.0090, Accuracy: 475/546 (86.9963%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 502/546 (91.9414%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   3,  Average loss: 0.0029, Accuracy: 525/546 (96.1538%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   4,  Average loss: 0.0015, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   5,  Average loss: 0.0007, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 37.62587435393944.
Norm before scaling: 37.896051479981885. Distance: 6.822513046168305
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 1.3888, Accuracy: 5810/10000 (58.1000%)
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: 0.1480, Accuracy: 8699/9000 (96.6556%)
Scaling by  100
Scaled Norm after poisoning: 681.372282603277, distance: 682.2512825198645
Total norm for 4 adversaries is: 681.372282603277. distance: 682.2512825198645
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 242, local model 85, internal_epoch   1,  Average loss: 0.0068, Accuracy: 310/364 (85.1648%)
___Train Local_ResNet_18,  epoch 242, local model 85, internal_epoch   2,  Average loss: 0.0029, Accuracy: 343/364 (94.2308%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 4.8347, Accuracy: 2704/10000 (27.0400%)
___Train Local_ResNet_18,  epoch 242, local model 14, internal_epoch   1,  Average loss: 0.0084, Accuracy: 262/318 (82.3899%)
___Train Local_ResNet_18,  epoch 242, local model 14, internal_epoch   2,  Average loss: 0.0016, Accuracy: 308/318 (96.8553%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 10.1891, Accuracy: 1841/10000 (18.4100%)
___Train Local_ResNet_18,  epoch 242, local model 21, internal_epoch   1,  Average loss: 0.0043, Accuracy: 241/262 (91.9847%)
___Train Local_ResNet_18,  epoch 242, local model 21, internal_epoch   2,  Average loss: 0.0038, Accuracy: 259/262 (98.8550%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 3.5421, Accuracy: 3428/10000 (34.2800%)
___Train Local_ResNet_18,  epoch 242, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 230/255 (90.1961%)
___Train Local_ResNet_18,  epoch 242, local model 78, internal_epoch   2,  Average loss: 0.0010, Accuracy: 250/255 (98.0392%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 2.8130, Accuracy: 4345/10000 (43.4500%)
___Train Local_ResNet_18,  epoch 242, local model 1, internal_epoch   1,  Average loss: 0.0072, Accuracy: 595/641 (92.8237%)
___Train Local_ResNet_18,  epoch 242, local model 1, internal_epoch   2,  Average loss: 0.0112, Accuracy: 561/641 (87.5195%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 4.3326, Accuracy: 4076/10000 (40.7600%)
___Train Local_ResNet_18,  epoch 242, local model 2, internal_epoch   1,  Average loss: 0.0080, Accuracy: 400/461 (86.7679%)
___Train Local_ResNet_18,  epoch 242, local model 2, internal_epoch   2,  Average loss: 0.0066, Accuracy: 407/461 (88.2863%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 8.9840, Accuracy: 2425/10000 (24.2500%)
time spent on training: 272.64137148857117
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4765696087352138  data num: [526, 527, 496, 546, 364, 318, 262, 255, 641, 461]
[foolsgold agg] considering poison per batch poison_fraction: 0.03723200068243858
[foolsgold agg] wv: [0.76254036 0.         0.15908236 0.         1.         1.
 1.         1.         1.         0.32487822]
___Test Target_ResNet_18 poisoned: False, epoch: 242: Average loss: 0.6570, Accuracy: 7825/10000 (78.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 242: Average loss: 5.4931, Accuracy: 566/9000 (6.2889%)
Done in 327.8919486999512 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:243 choose agents : [17, 33, 77, 11, 9, 5, 16, 36, 94, 57]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   1,  Average loss: 0.0113, Accuracy: 473/526 (89.9240%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   2,  Average loss: 0.0114, Accuracy: 454/526 (86.3118%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   3,  Average loss: 0.0069, Accuracy: 475/526 (90.3042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   4,  Average loss: 0.0028, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   5,  Average loss: 0.0026, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   6,  Average loss: 0.0030, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Global model norm: 37.62482318012854.
Norm before scaling: 38.193561878218595. Distance: 8.429525039705354
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 1.8048, Accuracy: 4806/10000 (48.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: 0.0683, Accuracy: 8757/9000 (97.3000%)
Scaling by  100
Scaled Norm after poisoning: 842.1346388790809, distance: 842.9525120076456
Total norm for 4 adversaries is: 842.1346388790809. distance: 842.9525120076456
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   1,  Average loss: 0.0138, Accuracy: 449/527 (85.1992%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   2,  Average loss: 0.0109, Accuracy: 452/527 (85.7685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   3,  Average loss: 0.0072, Accuracy: 477/527 (90.5123%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   4,  Average loss: 0.0037, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   5,  Average loss: 0.0025, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   6,  Average loss: 0.0032, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.62482318012854.
Norm before scaling: 38.603332565417844. Distance: 10.194880333872128
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 1.9843, Accuracy: 4669/10000 (46.6900%)
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: 0.3353, Accuracy: 7976/9000 (88.6222%)
Scaling by  100
Scaled Norm after poisoning: 1018.7427913855391, distance: 1019.4880148878651
Total norm for 4 adversaries is: 1018.7427913855391. distance: 1019.4880148878651
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   1,  Average loss: 0.0074, Accuracy: 445/496 (89.7177%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 461/496 (92.9435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   3,  Average loss: 0.0035, Accuracy: 476/496 (95.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   4,  Average loss: 0.0015, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Global model norm: 37.62482318012854.
Norm before scaling: 37.78447922252188. Distance: 5.884755253268325
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 0.9912, Accuracy: 6722/10000 (67.2200%)
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: 0.1750, Accuracy: 8637/9000 (95.9667%)
Scaling by  100
Scaled Norm after poisoning: 587.7583474524203, distance: 588.4754933300112
Total norm for 4 adversaries is: 587.7583474524203. distance: 588.4754933300112
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   1,  Average loss: 0.0073, Accuracy: 487/546 (89.1941%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 495/546 (90.6593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   3,  Average loss: 0.0035, Accuracy: 519/546 (95.0549%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   4,  Average loss: 0.0027, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.62482318012854.
Norm before scaling: 37.8794651735731. Distance: 6.784551001628713
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 1.4609, Accuracy: 5501/10000 (55.0100%)
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: 0.0999, Accuracy: 8778/9000 (97.5333%)
Scaling by  100
Scaled Norm after poisoning: 677.5223935413501, distance: 678.4551155013867
Total norm for 4 adversaries is: 677.5223935413501. distance: 678.4551155013867
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 243, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 340/368 (92.3913%)
___Train Local_ResNet_18,  epoch 243, local model 9, internal_epoch   2,  Average loss: 0.0011, Accuracy: 361/368 (98.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 7.6132, Accuracy: 2124/10000 (21.2400%)
___Train Local_ResNet_18,  epoch 243, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 349/365 (95.6164%)
___Train Local_ResNet_18,  epoch 243, local model 5, internal_epoch   2,  Average loss: 0.0007, Accuracy: 362/365 (99.1781%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 1.2473, Accuracy: 6529/10000 (65.2900%)
___Train Local_ResNet_18,  epoch 243, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 712/773 (92.1087%)
___Train Local_ResNet_18,  epoch 243, local model 16, internal_epoch   2,  Average loss: 0.0282, Accuracy: 422/773 (54.5925%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 93.4577, Accuracy: 1027/10000 (10.2700%)
___Train Local_ResNet_18,  epoch 243, local model 36, internal_epoch   1,  Average loss: 0.0068, Accuracy: 735/849 (86.5724%)
___Train Local_ResNet_18,  epoch 243, local model 36, internal_epoch   2,  Average loss: 0.0162, Accuracy: 591/849 (69.6113%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 25.5218, Accuracy: 1660/10000 (16.6000%)
___Train Local_ResNet_18,  epoch 243, local model 94, internal_epoch   1,  Average loss: 0.0080, Accuracy: 171/203 (84.2365%)
___Train Local_ResNet_18,  epoch 243, local model 94, internal_epoch   2,  Average loss: 0.0017, Accuracy: 202/203 (99.5074%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 3.5339, Accuracy: 3398/10000 (33.9800%)
___Train Local_ResNet_18,  epoch 243, local model 57, internal_epoch   1,  Average loss: 0.0054, Accuracy: 255/290 (87.9310%)
___Train Local_ResNet_18,  epoch 243, local model 57, internal_epoch   2,  Average loss: 0.0008, Accuracy: 286/290 (98.6207%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 3.7468, Accuracy: 4090/10000 (40.9000%)
time spent on training: 277.3229823112488
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.42383168116528425  data num: [526, 527, 496, 546, 368, 365, 773, 849, 203, 290]
[foolsgold agg] considering poison per batch poison_fraction: 0.03311185009103783
[foolsgold agg] wv: [0.79879259 0.         0.         0.         1.         0.89293756
 1.         1.         0.89293756 0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 243: Average loss: 0.6558, Accuracy: 7830/10000 (78.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 243: Average loss: 5.4545, Accuracy: 588/9000 (6.5333%)
Done in 331.17482590675354 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:244 choose agents : [17, 33, 77, 11, 63, 92, 28, 56, 44, 40]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   1,  Average loss: 0.0106, Accuracy: 480/526 (91.2548%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   2,  Average loss: 0.0131, Accuracy: 452/526 (85.9316%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   3,  Average loss: 0.0088, Accuracy: 465/526 (88.4030%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   4,  Average loss: 0.0038, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   5,  Average loss: 0.0047, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   6,  Average loss: 0.0024, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Global model norm: 37.624146714784445.
Norm before scaling: 38.45432018916649. Distance: 9.59453209289244
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.5934, Accuracy: 5100/10000 (51.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: 0.2319, Accuracy: 8226/9000 (91.4000%)
Scaling by  100
Scaled Norm after poisoning: 958.684678348413, distance: 959.4532622801383
Total norm for 4 adversaries is: 958.684678348413. distance: 959.4532622801383
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   1,  Average loss: 0.0131, Accuracy: 442/527 (83.8710%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   2,  Average loss: 0.0121, Accuracy: 450/527 (85.3890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   3,  Average loss: 0.0078, Accuracy: 480/527 (91.0816%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   4,  Average loss: 0.0067, Accuracy: 475/527 (90.1328%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   5,  Average loss: 0.0032, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   6,  Average loss: 0.0036, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.624146714784445.
Norm before scaling: 38.800081044535204. Distance: 10.731613048173264
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.7554, Accuracy: 4620/10000 (46.2000%)
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: 0.1526, Accuracy: 8500/9000 (94.4444%)
Scaling by  100
Scaled Norm after poisoning: 1072.64218171765, distance: 1073.1613345625158
Total norm for 4 adversaries is: 1072.64218171765. distance: 1073.1613345625158
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 456/496 (91.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 455/496 (91.7339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   3,  Average loss: 0.0034, Accuracy: 476/496 (95.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   4,  Average loss: 0.0015, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   5,  Average loss: 0.0013, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.624146714784445.
Norm before scaling: 37.72874569811624. Distance: 5.6552101148835705
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.0237, Accuracy: 6594/10000 (65.9400%)
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: 0.1192, Accuracy: 8718/9000 (96.8667%)
Scaling by  100
Scaled Norm after poisoning: 564.6411471014135, distance: 565.5209434671717
Total norm for 4 adversaries is: 564.6411471014135. distance: 565.5209434671717
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   1,  Average loss: 0.0067, Accuracy: 491/546 (89.9267%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   2,  Average loss: 0.0038, Accuracy: 522/546 (95.6044%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   3,  Average loss: 0.0017, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   4,  Average loss: 0.0013, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   6,  Average loss: 0.0012, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.624146714784445.
Norm before scaling: 37.81882372224677. Distance: 6.302487430280039
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.3459, Accuracy: 6224/10000 (62.2400%)
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: 0.1958, Accuracy: 8587/9000 (95.4111%)
Scaling by  100
Scaled Norm after poisoning: 629.3851166019101, distance: 630.2487356195171
Total norm for 4 adversaries is: 629.3851166019101. distance: 630.2487356195171
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 244, local model 63, internal_epoch   1,  Average loss: 0.0027, Accuracy: 708/752 (94.1489%)
___Train Local_ResNet_18,  epoch 244, local model 63, internal_epoch   2,  Average loss: 0.0020, Accuracy: 720/752 (95.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.4366, Accuracy: 5955/10000 (59.5500%)
___Train Local_ResNet_18,  epoch 244, local model 92, internal_epoch   1,  Average loss: 0.0072, Accuracy: 698/796 (87.6884%)
___Train Local_ResNet_18,  epoch 244, local model 92, internal_epoch   2,  Average loss: 0.0100, Accuracy: 643/796 (80.7789%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 9.0822, Accuracy: 1937/10000 (19.3700%)
___Train Local_ResNet_18,  epoch 244, local model 28, internal_epoch   1,  Average loss: 0.0023, Accuracy: 402/423 (95.0355%)
___Train Local_ResNet_18,  epoch 244, local model 28, internal_epoch   2,  Average loss: 0.0017, Accuracy: 412/423 (97.3995%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.1522, Accuracy: 6569/10000 (65.6900%)
___Train Local_ResNet_18,  epoch 244, local model 56, internal_epoch   1,  Average loss: 0.0018, Accuracy: 725/743 (97.5774%)
___Train Local_ResNet_18,  epoch 244, local model 56, internal_epoch   2,  Average loss: 0.0011, Accuracy: 727/743 (97.8466%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.5546, Accuracy: 6076/10000 (60.7600%)
___Train Local_ResNet_18,  epoch 244, local model 44, internal_epoch   1,  Average loss: 0.0054, Accuracy: 396/436 (90.8257%)
___Train Local_ResNet_18,  epoch 244, local model 44, internal_epoch   2,  Average loss: 0.0023, Accuracy: 418/436 (95.8716%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.6509, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 244, local model 40, internal_epoch   1,  Average loss: 0.0064, Accuracy: 568/652 (87.1166%)
___Train Local_ResNet_18,  epoch 244, local model 40, internal_epoch   2,  Average loss: 0.0070, Accuracy: 577/652 (88.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 4.3133, Accuracy: 3298/10000 (32.9800%)
time spent on training: 273.8980085849762
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3552653891809395  data num: [526, 527, 496, 546, 752, 796, 423, 743, 436, 652]
[foolsgold agg] considering poison per batch poison_fraction: 0.027755108529760895
[foolsgold agg] wv: [0.56432077 0.         0.         0.         1.         1.
 1.         1.         1.         0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 244: Average loss: 0.6551, Accuracy: 7827/10000 (78.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 244: Average loss: 5.4432, Accuracy: 592/9000 (6.5778%)
Done in 328.86748576164246 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:245 choose agents : [17, 33, 77, 11, 74, 85, 2, 99, 35, 70]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   1,  Average loss: 0.0111, Accuracy: 473/526 (89.9240%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   2,  Average loss: 0.0130, Accuracy: 448/526 (85.1711%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   3,  Average loss: 0.0075, Accuracy: 476/526 (90.4943%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   4,  Average loss: 0.0037, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   5,  Average loss: 0.0026, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   6,  Average loss: 0.0027, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Global model norm: 37.62350268251964.
Norm before scaling: 38.38329193294102. Distance: 9.16628259952397
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 1.6259, Accuracy: 5130/10000 (51.3000%)
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: 0.4624, Accuracy: 7583/9000 (84.2556%)
Scaling by  100
Scaled Norm after poisoning: 915.9671459719502, distance: 916.6282302547745
Total norm for 4 adversaries is: 915.9671459719502. distance: 916.6282302547745
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   1,  Average loss: 0.0125, Accuracy: 443/527 (84.0607%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   2,  Average loss: 0.0119, Accuracy: 438/527 (83.1120%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   3,  Average loss: 0.0066, Accuracy: 472/527 (89.5636%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   4,  Average loss: 0.0048, Accuracy: 489/527 (92.7894%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   5,  Average loss: 0.0056, Accuracy: 490/527 (92.9791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   6,  Average loss: 0.0052, Accuracy: 482/527 (91.4611%), train_poison_data_count: 45
Global model norm: 37.62350268251964.
Norm before scaling: 39.14211574007434. Distance: 11.639242000478516
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 1.9671, Accuracy: 4562/10000 (45.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: 1.3640, Accuracy: 5439/9000 (60.4333%)
Scaling by  100
Scaled Norm after poisoning: 1163.7205957617145, distance: 1163.9242887748326
Total norm for 4 adversaries is: 1163.7205957617145. distance: 1163.9242887748326
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   1,  Average loss: 0.0078, Accuracy: 450/496 (90.7258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   2,  Average loss: 0.0060, Accuracy: 459/496 (92.5403%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   3,  Average loss: 0.0035, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   4,  Average loss: 0.0021, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.62350268251964.
Norm before scaling: 37.71203239942542. Distance: 5.574763805363928
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 1.0151, Accuracy: 6619/10000 (66.1900%)
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: 0.1126, Accuracy: 8717/9000 (96.8556%)
Scaling by  100
Scaled Norm after poisoning: 556.556067481076, distance: 557.4763447896242
Total norm for 4 adversaries is: 556.556067481076. distance: 557.4763447896242
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 497/546 (91.0256%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   2,  Average loss: 0.0047, Accuracy: 516/546 (94.5055%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   3,  Average loss: 0.0023, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   4,  Average loss: 0.0015, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   5,  Average loss: 0.0011, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   6,  Average loss: 0.0013, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Global model norm: 37.62350268251964.
Norm before scaling: 37.762133940835824. Distance: 6.13545238266433
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 1.2566, Accuracy: 6144/10000 (61.4400%)
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: 0.1074, Accuracy: 8766/9000 (97.4000%)
Scaling by  100
Scaled Norm after poisoning: 612.4818874872955, distance: 613.545205139768
Total norm for 4 adversaries is: 612.4818874872955. distance: 613.545205139768
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 245, local model 74, internal_epoch   1,  Average loss: 0.0036, Accuracy: 439/469 (93.6034%)
___Train Local_ResNet_18,  epoch 245, local model 74, internal_epoch   2,  Average loss: 0.0021, Accuracy: 448/469 (95.5224%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 3.4672, Accuracy: 3907/10000 (39.0700%)
___Train Local_ResNet_18,  epoch 245, local model 85, internal_epoch   1,  Average loss: 0.0066, Accuracy: 316/364 (86.8132%)
___Train Local_ResNet_18,  epoch 245, local model 85, internal_epoch   2,  Average loss: 0.0038, Accuracy: 342/364 (93.9560%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 5.4508, Accuracy: 2333/10000 (23.3300%)
___Train Local_ResNet_18,  epoch 245, local model 2, internal_epoch   1,  Average loss: 0.0101, Accuracy: 382/461 (82.8633%)
___Train Local_ResNet_18,  epoch 245, local model 2, internal_epoch   2,  Average loss: 0.0104, Accuracy: 395/461 (85.6833%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 7.6597, Accuracy: 1801/10000 (18.0100%)
___Train Local_ResNet_18,  epoch 245, local model 99, internal_epoch   1,  Average loss: 0.0057, Accuracy: 358/391 (91.5601%)
___Train Local_ResNet_18,  epoch 245, local model 99, internal_epoch   2,  Average loss: 0.0092, Accuracy: 345/391 (88.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 8.1718, Accuracy: 2333/10000 (23.3300%)
___Train Local_ResNet_18,  epoch 245, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 372/419 (88.7828%)
___Train Local_ResNet_18,  epoch 245, local model 35, internal_epoch   2,  Average loss: 0.0024, Accuracy: 400/419 (95.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 3.9350, Accuracy: 3534/10000 (35.3400%)
___Train Local_ResNet_18,  epoch 245, local model 70, internal_epoch   1,  Average loss: 0.0029, Accuracy: 577/610 (94.5902%)
___Train Local_ResNet_18,  epoch 245, local model 70, internal_epoch   2,  Average loss: 0.0017, Accuracy: 591/610 (96.8852%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 2.2274, Accuracy: 4671/10000 (46.7100%)
time spent on training: 270.3992486000061
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4356415055105011  data num: [526, 527, 496, 546, 469, 364, 461, 391, 419, 610]
[foolsgold agg] considering poison per batch poison_fraction: 0.0340344926180079
[foolsgold agg] wv: [1.         0.09206336 0.4144717  0.09206336 1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 245: Average loss: 0.6563, Accuracy: 7831/10000 (78.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 245: Average loss: 5.3885, Accuracy: 609/9000 (6.7667%)
Done in 325.98208951950073 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:246 choose agents : [17, 33, 77, 11, 88, 50, 86, 60, 41, 79]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   1,  Average loss: 0.0122, Accuracy: 472/526 (89.7338%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   2,  Average loss: 0.0115, Accuracy: 447/526 (84.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   3,  Average loss: 0.0069, Accuracy: 479/526 (91.0646%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   4,  Average loss: 0.0038, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   5,  Average loss: 0.0023, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   6,  Average loss: 0.0018, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Global model norm: 37.623119826880554.
Norm before scaling: 38.41232184763845. Distance: 9.270924999912571
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.6948, Accuracy: 4969/10000 (49.6900%)
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: 0.1754, Accuracy: 8517/9000 (94.6333%)
Scaling by  100
Scaled Norm after poisoning: 926.456420993454, distance: 927.0923295443664
Total norm for 4 adversaries is: 926.456420993454. distance: 927.0923295443664
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   1,  Average loss: 0.0132, Accuracy: 447/527 (84.8197%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   2,  Average loss: 0.0130, Accuracy: 452/527 (85.7685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   3,  Average loss: 0.0057, Accuracy: 486/527 (92.2201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   4,  Average loss: 0.0036, Accuracy: 495/527 (93.9279%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   5,  Average loss: 0.0029, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   6,  Average loss: 0.0025, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Global model norm: 37.623119826880554.
Norm before scaling: 38.53757931592551. Distance: 9.842668358852862
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 2.1204, Accuracy: 3983/10000 (39.8300%)
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: 0.0058, Accuracy: 8996/9000 (99.9556%)
Scaling by  100
Scaled Norm after poisoning: 983.6023713879506, distance: 984.2668591393292
Total norm for 4 adversaries is: 983.6023713879506. distance: 984.2668591393292
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   1,  Average loss: 0.0090, Accuracy: 445/496 (89.7177%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 461/496 (92.9435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   3,  Average loss: 0.0040, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   4,  Average loss: 0.0017, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   5,  Average loss: 0.0010, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.623119826880554.
Norm before scaling: 37.729662943370066. Distance: 5.690559989310662
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 0.9593, Accuracy: 6799/10000 (67.9900%)
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: 0.1799, Accuracy: 8624/9000 (95.8222%)
Scaling by  100
Scaled Norm after poisoning: 568.1591436384704, distance: 569.055989117064
Total norm for 4 adversaries is: 568.1591436384704. distance: 569.055989117064
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   1,  Average loss: 0.0067, Accuracy: 488/546 (89.3773%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   2,  Average loss: 0.0045, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   3,  Average loss: 0.0028, Accuracy: 525/546 (96.1538%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   4,  Average loss: 0.0010, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   6,  Average loss: 0.0014, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.623119826880554.
Norm before scaling: 37.818743028011255. Distance: 6.402771838284944
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.2914, Accuracy: 6157/10000 (61.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: 0.1496, Accuracy: 8695/9000 (96.6111%)
Scaling by  100
Scaled Norm after poisoning: 639.3329776024384, distance: 640.2771372616704
Total norm for 4 adversaries is: 639.3329776024384. distance: 640.2771372616704
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 246, local model 88, internal_epoch   1,  Average loss: 0.0070, Accuracy: 382/447 (85.4586%)
___Train Local_ResNet_18,  epoch 246, local model 88, internal_epoch   2,  Average loss: 0.0028, Accuracy: 422/447 (94.4072%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 4.7497, Accuracy: 3168/10000 (31.6800%)
___Train Local_ResNet_18,  epoch 246, local model 50, internal_epoch   1,  Average loss: 0.0028, Accuracy: 382/401 (95.2618%)
___Train Local_ResNet_18,  epoch 246, local model 50, internal_epoch   2,  Average loss: 0.0015, Accuracy: 391/401 (97.5062%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 2.7168, Accuracy: 4554/10000 (45.5400%)
___Train Local_ResNet_18,  epoch 246, local model 86, internal_epoch   1,  Average loss: 0.0035, Accuracy: 201/212 (94.8113%)
___Train Local_ResNet_18,  epoch 246, local model 86, internal_epoch   2,  Average loss: 0.0009, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.0949, Accuracy: 6899/10000 (68.9900%)
___Train Local_ResNet_18,  epoch 246, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 261/284 (91.9014%)
___Train Local_ResNet_18,  epoch 246, local model 60, internal_epoch   2,  Average loss: 0.0013, Accuracy: 281/284 (98.9437%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 2.0430, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18,  epoch 246, local model 41, internal_epoch   1,  Average loss: 0.0088, Accuracy: 421/513 (82.0663%)
___Train Local_ResNet_18,  epoch 246, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 475/513 (92.5926%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 4.2764, Accuracy: 3329/10000 (33.2900%)
___Train Local_ResNet_18,  epoch 246, local model 79, internal_epoch   1,  Average loss: 0.0062, Accuracy: 132/154 (85.7143%)
___Train Local_ResNet_18,  epoch 246, local model 79, internal_epoch   2,  Average loss: 0.0004, Accuracy: 154/154 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.0626, Accuracy: 6841/10000 (68.4100%)
time spent on training: 271.9596178531647
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.5102289332683877  data num: [526, 527, 496, 546, 447, 401, 212, 284, 513, 154]
[foolsgold agg] considering poison per batch poison_fraction: 0.03986163541159279
[foolsgold agg] wv: [0.61491345 0.         0.0515235  0.         1.         1.
 0.96562207 1.         1.         0.96562207]
___Test Target_ResNet_18 poisoned: False, epoch: 246: Average loss: 0.6559, Accuracy: 7826/10000 (78.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 246: Average loss: 5.3577, Accuracy: 620/9000 (6.8889%)
Done in 326.58044624328613 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:247 choose agents : [17, 33, 77, 11, 76, 67, 9, 40, 72, 44]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   1,  Average loss: 0.0105, Accuracy: 476/526 (90.4943%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   2,  Average loss: 0.0098, Accuracy: 464/526 (88.2129%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   3,  Average loss: 0.0069, Accuracy: 487/526 (92.5856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   4,  Average loss: 0.0029, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   5,  Average loss: 0.0026, Accuracy: 508/526 (96.5779%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   6,  Average loss: 0.0025, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Global model norm: 37.62189660945056.
Norm before scaling: 38.19162179832034. Distance: 8.484579122486995
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 1.7587, Accuracy: 4860/10000 (48.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: 0.1081, Accuracy: 8622/9000 (95.8000%)
Scaling by  100
Scaled Norm after poisoning: 847.5946112381791, distance: 848.4578657776708
Total norm for 4 adversaries is: 847.5946112381791. distance: 848.4578657776708
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   1,  Average loss: 0.0126, Accuracy: 449/527 (85.1992%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   2,  Average loss: 0.0113, Accuracy: 442/527 (83.8710%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   3,  Average loss: 0.0058, Accuracy: 482/527 (91.4611%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   4,  Average loss: 0.0036, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   5,  Average loss: 0.0036, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   6,  Average loss: 0.0033, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.62189660945056.
Norm before scaling: 38.46985268271361. Distance: 9.663074834584956
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 1.8353, Accuracy: 4697/10000 (46.9700%)
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: 0.5126, Accuracy: 7471/9000 (83.0111%)
Scaling by  100
Scaled Norm after poisoning: 965.5467039454901, distance: 966.3074691835927
Total norm for 4 adversaries is: 965.5467039454901. distance: 966.3074691835927
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   1,  Average loss: 0.0084, Accuracy: 438/496 (88.3065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   2,  Average loss: 0.0064, Accuracy: 449/496 (90.5242%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   3,  Average loss: 0.0031, Accuracy: 474/496 (95.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   4,  Average loss: 0.0016, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   5,  Average loss: 0.0007, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.62189660945056.
Norm before scaling: 37.83027894270425. Distance: 6.152654072034845
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 1.0077, Accuracy: 6720/10000 (67.2000%)
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: 0.2148, Accuracy: 8527/9000 (94.7444%)
Scaling by  100
Scaled Norm after poisoning: 614.6167505039217, distance: 615.265415288394
Total norm for 4 adversaries is: 614.6167505039217. distance: 615.265415288394
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   1,  Average loss: 0.0067, Accuracy: 493/546 (90.2930%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 515/546 (94.3223%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   3,  Average loss: 0.0025, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   4,  Average loss: 0.0013, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   5,  Average loss: 0.0011, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.62189660945056.
Norm before scaling: 37.79378733771101. Distance: 6.1815465163650085
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 1.3157, Accuracy: 6047/10000 (60.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: 0.2084, Accuracy: 8587/9000 (95.4111%)
Scaling by  100
Scaled Norm after poisoning: 617.2566575177622, distance: 618.1545619826809
Total norm for 4 adversaries is: 617.2566575177622. distance: 618.1545619826809
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 247, local model 76, internal_epoch   1,  Average loss: 0.0367, Accuracy: 61/65 (93.8462%)
___Train Local_ResNet_18,  epoch 247, local model 76, internal_epoch   2,  Average loss: 0.0434, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 1.3608, Accuracy: 6141/10000 (61.4100%)
___Train Local_ResNet_18,  epoch 247, local model 67, internal_epoch   1,  Average loss: 0.0036, Accuracy: 775/842 (92.0428%)
___Train Local_ResNet_18,  epoch 247, local model 67, internal_epoch   2,  Average loss: 0.0080, Accuracy: 729/842 (86.5796%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 5.9478, Accuracy: 3188/10000 (31.8800%)
___Train Local_ResNet_18,  epoch 247, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 337/368 (91.5761%)
___Train Local_ResNet_18,  epoch 247, local model 9, internal_epoch   2,  Average loss: 0.0008, Accuracy: 365/368 (99.1848%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 4.9036, Accuracy: 2904/10000 (29.0400%)
___Train Local_ResNet_18,  epoch 247, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 581/652 (89.1104%)
___Train Local_ResNet_18,  epoch 247, local model 40, internal_epoch   2,  Average loss: 0.0101, Accuracy: 533/652 (81.7485%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 18.2152, Accuracy: 1357/10000 (13.5700%)
___Train Local_ResNet_18,  epoch 247, local model 72, internal_epoch   1,  Average loss: 0.0074, Accuracy: 541/618 (87.5405%)
___Train Local_ResNet_18,  epoch 247, local model 72, internal_epoch   2,  Average loss: 0.0069, Accuracy: 557/618 (90.1294%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 6.2770, Accuracy: 3173/10000 (31.7300%)
___Train Local_ResNet_18,  epoch 247, local model 44, internal_epoch   1,  Average loss: 0.0034, Accuracy: 401/436 (91.9725%)
___Train Local_ResNet_18,  epoch 247, local model 44, internal_epoch   2,  Average loss: 0.0014, Accuracy: 423/436 (97.0183%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 2.4355, Accuracy: 4632/10000 (46.3200%)
time spent on training: 272.7872111797333
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41272655634357763  data num: [526, 527, 496, 546, 65, 842, 368, 652, 618, 436]
[foolsgold agg] considering poison per batch poison_fraction: 0.032244262214342005
[foolsgold agg] wv: [0.51907339 0.         0.         0.         0.17451432 0.74202097
 1.         0.         0.74202097 0.17451432]
___Test Target_ResNet_18 poisoned: False, epoch: 247: Average loss: 0.6558, Accuracy: 7824/10000 (78.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 247: Average loss: 5.3537, Accuracy: 623/9000 (6.9222%)
Done in 327.0310606956482 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:248 choose agents : [17, 33, 77, 11, 46, 96, 54, 39, 67, 82]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   1,  Average loss: 0.0129, Accuracy: 478/526 (90.8745%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   2,  Average loss: 0.0114, Accuracy: 460/526 (87.4525%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   3,  Average loss: 0.0063, Accuracy: 472/526 (89.7338%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   4,  Average loss: 0.0047, Accuracy: 495/526 (94.1065%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   5,  Average loss: 0.0028, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   6,  Average loss: 0.0025, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Global model norm: 37.620710667048144.
Norm before scaling: 38.43705220775749. Distance: 9.49992491039917
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.9375, Accuracy: 4620/10000 (46.2000%)
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: 0.2540, Accuracy: 8307/9000 (92.3000%)
Scaling by  100
Scaled Norm after poisoning: 949.255036857851, distance: 949.9924999703945
Total norm for 4 adversaries is: 949.255036857851. distance: 949.9924999703945
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   1,  Average loss: 0.0112, Accuracy: 449/527 (85.1992%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   2,  Average loss: 0.0103, Accuracy: 458/527 (86.9070%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   3,  Average loss: 0.0052, Accuracy: 489/527 (92.7894%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   4,  Average loss: 0.0033, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   5,  Average loss: 0.0021, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   6,  Average loss: 0.0024, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.620710667048144.
Norm before scaling: 38.16826758435108. Distance: 8.363497906319097
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.5403, Accuracy: 5297/10000 (52.9700%)
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: 0.2835, Accuracy: 8100/9000 (90.0000%)
Scaling by  100
Scaled Norm after poisoning: 835.4946887922149, distance: 836.3498071979212
Total norm for 4 adversaries is: 835.4946887922149. distance: 836.3498071979212
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   1,  Average loss: 0.0089, Accuracy: 447/496 (90.1210%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   2,  Average loss: 0.0046, Accuracy: 468/496 (94.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   3,  Average loss: 0.0031, Accuracy: 476/496 (95.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   4,  Average loss: 0.0012, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.620710667048144.
Norm before scaling: 37.72050890420472. Distance: 5.675042563123357
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.0223, Accuracy: 6658/10000 (66.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: 0.1276, Accuracy: 8688/9000 (96.5333%)
Scaling by  100
Scaled Norm after poisoning: 566.5754031900785, distance: 567.5042951379311
Total norm for 4 adversaries is: 566.5754031900785. distance: 567.5042951379311
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   1,  Average loss: 0.0088, Accuracy: 474/546 (86.8132%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 510/546 (93.4066%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   3,  Average loss: 0.0029, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   4,  Average loss: 0.0013, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   6,  Average loss: 0.0011, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.620710667048144.
Norm before scaling: 37.868721117335085. Distance: 6.678100825807322
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.3236, Accuracy: 6060/10000 (60.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: 0.2419, Accuracy: 8493/9000 (94.3667%)
Scaling by  100
Scaled Norm after poisoning: 666.9319211883624, distance: 667.8101105479012
Total norm for 4 adversaries is: 666.9319211883624. distance: 667.8101105479012
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 248, local model 46, internal_epoch   1,  Average loss: 0.0013, Accuracy: 593/601 (98.6689%)
___Train Local_ResNet_18,  epoch 248, local model 46, internal_epoch   2,  Average loss: 0.0014, Accuracy: 586/601 (97.5042%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.6808, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 248, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 665/708 (93.9266%)
___Train Local_ResNet_18,  epoch 248, local model 96, internal_epoch   2,  Average loss: 0.0036, Accuracy: 649/708 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 2.8190, Accuracy: 3868/10000 (38.6800%)
___Train Local_ResNet_18,  epoch 248, local model 54, internal_epoch   1,  Average loss: 0.0032, Accuracy: 412/440 (93.6364%)
___Train Local_ResNet_18,  epoch 248, local model 54, internal_epoch   2,  Average loss: 0.0012, Accuracy: 432/440 (98.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 3.3353, Accuracy: 4397/10000 (43.9700%)
___Train Local_ResNet_18,  epoch 248, local model 39, internal_epoch   1,  Average loss: 0.0054, Accuracy: 194/217 (89.4009%)
___Train Local_ResNet_18,  epoch 248, local model 39, internal_epoch   2,  Average loss: 0.0013, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 2.6622, Accuracy: 4426/10000 (44.2600%)
___Train Local_ResNet_18,  epoch 248, local model 67, internal_epoch   1,  Average loss: 0.0059, Accuracy: 772/842 (91.6865%)
___Train Local_ResNet_18,  epoch 248, local model 67, internal_epoch   2,  Average loss: 0.0151, Accuracy: 619/842 (73.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 9.3132, Accuracy: 2150/10000 (21.5000%)
___Train Local_ResNet_18,  epoch 248, local model 82, internal_epoch   1,  Average loss: 0.0018, Accuracy: 579/601 (96.3394%)
___Train Local_ResNet_18,  epoch 248, local model 82, internal_epoch   2,  Average loss: 0.0015, Accuracy: 589/601 (98.0033%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 2.0961, Accuracy: 4958/10000 (49.5800%)
time spent on training: 275.5531961917877
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.38063226744186046  data num: [526, 527, 496, 546, 601, 708, 440, 217, 842, 601]
[foolsgold agg] considering poison per batch poison_fraction: 0.02973689589389535
[foolsgold agg] wv: [0.62573999 0.         0.05069552 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 248: Average loss: 0.6551, Accuracy: 7825/10000 (78.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 248: Average loss: 5.3321, Accuracy: 630/9000 (7.0000%)
Done in 330.5801122188568 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:249 choose agents : [17, 33, 77, 11, 21, 80, 91, 23, 65, 69]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   1,  Average loss: 0.0105, Accuracy: 473/526 (89.9240%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   2,  Average loss: 0.0087, Accuracy: 463/526 (88.0228%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   3,  Average loss: 0.0061, Accuracy: 485/526 (92.2053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   4,  Average loss: 0.0052, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   5,  Average loss: 0.0035, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   6,  Average loss: 0.0031, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Global model norm: 37.62021097013545.
Norm before scaling: 38.185816950943156. Distance: 8.465649026503604
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.7128, Accuracy: 4874/10000 (48.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: 0.3634, Accuracy: 7892/9000 (87.6889%)
Scaling by  100
Scaled Norm after poisoning: 845.6999689606238, distance: 846.5650078405083
Total norm for 4 adversaries is: 845.6999689606238. distance: 846.5650078405083
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   1,  Average loss: 0.0123, Accuracy: 450/527 (85.3890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   2,  Average loss: 0.0108, Accuracy: 455/527 (86.3378%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   3,  Average loss: 0.0068, Accuracy: 482/527 (91.4611%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   4,  Average loss: 0.0049, Accuracy: 491/527 (93.1689%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   5,  Average loss: 0.0032, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   6,  Average loss: 0.0029, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.62021097013545.
Norm before scaling: 38.50671486693912. Distance: 9.688009531711012
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 2.0378, Accuracy: 4424/10000 (44.2400%)
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: 0.2463, Accuracy: 8244/9000 (91.6000%)
Scaling by  100
Scaled Norm after poisoning: 968.1702781535901, distance: 968.8009986576191
Total norm for 4 adversaries is: 968.1702781535901. distance: 968.8009986576191
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   1,  Average loss: 0.0075, Accuracy: 456/496 (91.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 462/496 (93.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   3,  Average loss: 0.0032, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   4,  Average loss: 0.0014, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   5,  Average loss: 0.0010, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   6,  Average loss: 0.0012, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Global model norm: 37.62021097013545.
Norm before scaling: 37.70492995834978. Distance: 5.4810344379625855
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.0113, Accuracy: 6679/10000 (66.7900%)
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: 0.2139, Accuracy: 8534/9000 (94.8222%)
Scaling by  100
Scaled Norm after poisoning: 547.2354669152942, distance: 548.1034345814666
Total norm for 4 adversaries is: 547.2354669152942. distance: 548.1034345814666
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   1,  Average loss: 0.0069, Accuracy: 485/546 (88.8278%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   3,  Average loss: 0.0022, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   4,  Average loss: 0.0012, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.62021097013545.
Norm before scaling: 37.848096300272324. Distance: 6.5234322370862
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.4195, Accuracy: 5792/10000 (57.9200%)
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: 0.1368, Accuracy: 8691/9000 (96.5667%)
Scaling by  100
Scaled Norm after poisoning: 651.4838831467744, distance: 652.3432282932046
Total norm for 4 adversaries is: 651.4838831467744. distance: 652.3432282932046
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 249, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 237/262 (90.4580%)
___Train Local_ResNet_18,  epoch 249, local model 21, internal_epoch   2,  Average loss: 0.0005, Accuracy: 260/262 (99.2366%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 4.6909, Accuracy: 3158/10000 (31.5800%)
___Train Local_ResNet_18,  epoch 249, local model 80, internal_epoch   1,  Average loss: 0.0048, Accuracy: 327/363 (90.0826%)
___Train Local_ResNet_18,  epoch 249, local model 80, internal_epoch   2,  Average loss: 0.0012, Accuracy: 356/363 (98.0716%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 6.2255, Accuracy: 3025/10000 (30.2500%)
___Train Local_ResNet_18,  epoch 249, local model 91, internal_epoch   1,  Average loss: 0.0043, Accuracy: 212/234 (90.5983%)
___Train Local_ResNet_18,  epoch 249, local model 91, internal_epoch   2,  Average loss: 0.0011, Accuracy: 230/234 (98.2906%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.5703, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 249, local model 23, internal_epoch   1,  Average loss: 0.0038, Accuracy: 227/248 (91.5323%)
___Train Local_ResNet_18,  epoch 249, local model 23, internal_epoch   2,  Average loss: 0.0006, Accuracy: 245/248 (98.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 2.1545, Accuracy: 4708/10000 (47.0800%)
___Train Local_ResNet_18,  epoch 249, local model 65, internal_epoch   1,  Average loss: 0.0043, Accuracy: 288/314 (91.7197%)
___Train Local_ResNet_18,  epoch 249, local model 65, internal_epoch   2,  Average loss: 0.0009, Accuracy: 310/314 (98.7261%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 2.9403, Accuracy: 3956/10000 (39.5600%)
___Train Local_ResNet_18,  epoch 249, local model 69, internal_epoch   1,  Average loss: 0.0071, Accuracy: 189/216 (87.5000%)
___Train Local_ResNet_18,  epoch 249, local model 69, internal_epoch   2,  Average loss: 0.0006, Accuracy: 215/216 (99.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 7.0828, Accuracy: 1332/10000 (13.3200%)
time spent on training: 265.8731458187103
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.5613612004287245  data num: [526, 527, 496, 546, 262, 363, 234, 248, 314, 216]
[foolsgold agg] considering poison per batch poison_fraction: 0.0438563437834941
[foolsgold agg] wv: [0.79825756 0.         0.19157274 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 249: Average loss: 0.6542, Accuracy: 7840/10000 (78.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 249: Average loss: 5.2950, Accuracy: 649/9000 (7.2111%)
Done in 320.3108558654785 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:250 choose agents : [17, 33, 77, 11, 44, 38, 93, 2, 16, 36]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   1,  Average loss: 0.0107, Accuracy: 478/526 (90.8745%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   2,  Average loss: 0.0126, Accuracy: 452/526 (85.9316%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   3,  Average loss: 0.0075, Accuracy: 478/526 (90.8745%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   4,  Average loss: 0.0036, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   5,  Average loss: 0.0042, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   6,  Average loss: 0.0030, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Global model norm: 37.618706972167615.
Norm before scaling: 38.236083048280456. Distance: 8.774935260762122
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 1.5876, Accuracy: 5103/10000 (51.0300%)
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: 0.4286, Accuracy: 7849/9000 (87.2111%)
Scaling by  100
Scaled Norm after poisoning: 876.58039420238, distance: 877.4935897201757
Total norm for 4 adversaries is: 876.58039420238. distance: 877.4935897201757
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   1,  Average loss: 0.0135, Accuracy: 443/527 (84.0607%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   2,  Average loss: 0.0128, Accuracy: 442/527 (83.8710%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   3,  Average loss: 0.0089, Accuracy: 468/527 (88.8046%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   4,  Average loss: 0.0049, Accuracy: 490/527 (92.9791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   5,  Average loss: 0.0037, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   6,  Average loss: 0.0028, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Global model norm: 37.618706972167615.
Norm before scaling: 38.750463076870126. Distance: 10.644436639487799
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 1.9344, Accuracy: 4588/10000 (45.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: 0.4552, Accuracy: 7671/9000 (85.2333%)
Scaling by  100
Scaled Norm after poisoning: 1063.8460297430263, distance: 1064.443692733439
Total norm for 4 adversaries is: 1063.8460297430263. distance: 1064.443692733439
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   1,  Average loss: 0.0081, Accuracy: 442/496 (89.1129%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 460/496 (92.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   3,  Average loss: 0.0021, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   4,  Average loss: 0.0015, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.618706972167615.
Norm before scaling: 37.72805653621718. Distance: 5.595277375273723
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 1.0777, Accuracy: 6561/10000 (65.6100%)
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: 0.1426, Accuracy: 8691/9000 (96.5667%)
Scaling by  100
Scaled Norm after poisoning: 558.7304247130274, distance: 559.5277305460382
Total norm for 4 adversaries is: 558.7304247130274. distance: 559.5277305460382
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   1,  Average loss: 0.0088, Accuracy: 497/546 (91.0256%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   2,  Average loss: 0.0042, Accuracy: 513/546 (93.9560%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   3,  Average loss: 0.0024, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   4,  Average loss: 0.0023, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.618706972167615.
Norm before scaling: 37.70903652371504. Distance: 6.030983400135096
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 1.2532, Accuracy: 6071/10000 (60.7100%)
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: 0.0893, Accuracy: 8764/9000 (97.3778%)
Scaling by  100
Scaled Norm after poisoning: 601.8188577138474, distance: 603.0984061494443
Total norm for 4 adversaries is: 601.8188577138474. distance: 603.0984061494443
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 250, local model 44, internal_epoch   1,  Average loss: 0.0043, Accuracy: 396/436 (90.8257%)
___Train Local_ResNet_18,  epoch 250, local model 44, internal_epoch   2,  Average loss: 0.0022, Accuracy: 420/436 (96.3303%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.5227, Accuracy: 4627/10000 (46.2700%)
___Train Local_ResNet_18,  epoch 250, local model 38, internal_epoch   1,  Average loss: 0.0028, Accuracy: 716/756 (94.7090%)
___Train Local_ResNet_18,  epoch 250, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 679/756 (89.8148%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 3.5313, Accuracy: 4243/10000 (42.4300%)
___Train Local_ResNet_18,  epoch 250, local model 93, internal_epoch   1,  Average loss: 0.0030, Accuracy: 552/584 (94.5205%)
___Train Local_ResNet_18,  epoch 250, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 552/584 (94.5205%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 3.0697, Accuracy: 4164/10000 (41.6400%)
___Train Local_ResNet_18,  epoch 250, local model 2, internal_epoch   1,  Average loss: 0.0066, Accuracy: 399/461 (86.5510%)
___Train Local_ResNet_18,  epoch 250, local model 2, internal_epoch   2,  Average loss: 0.0057, Accuracy: 413/461 (89.5879%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.8297, Accuracy: 4017/10000 (40.1700%)
___Train Local_ResNet_18,  epoch 250, local model 16, internal_epoch   1,  Average loss: 0.0037, Accuracy: 712/773 (92.1087%)
___Train Local_ResNet_18,  epoch 250, local model 16, internal_epoch   2,  Average loss: 0.0057, Accuracy: 699/773 (90.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 5.0005, Accuracy: 3065/10000 (30.6500%)
___Train Local_ResNet_18,  epoch 250, local model 36, internal_epoch   1,  Average loss: 0.0073, Accuracy: 737/849 (86.8080%)
___Train Local_ResNet_18,  epoch 250, local model 36, internal_epoch   2,  Average loss: 0.0113, Accuracy: 666/849 (78.4452%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 8.8081, Accuracy: 1810/10000 (18.1000%)
time spent on training: 277.2595775127411
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.35186429291232785  data num: [526, 527, 496, 546, 436, 756, 584, 461, 773, 849]
[foolsgold agg] considering poison per batch poison_fraction: 0.027489397883775614
[foolsgold agg] wv: [1.         0.4206279  0.74426354 0.4206279  1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 250: Average loss: 0.6556, Accuracy: 7829/10000 (78.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 250: Average loss: 5.2141, Accuracy: 681/9000 (7.5667%)
Done in 332.1940772533417 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:251 choose agents : [17, 33, 77, 11, 36, 26, 95, 49, 48, 27]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   1,  Average loss: 0.0100, Accuracy: 480/526 (91.2548%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   2,  Average loss: 0.0121, Accuracy: 455/526 (86.5019%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   3,  Average loss: 0.0063, Accuracy: 490/526 (93.1559%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   4,  Average loss: 0.0049, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   5,  Average loss: 0.0028, Accuracy: 508/526 (96.5779%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   6,  Average loss: 0.0023, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Global model norm: 37.61915801562666.
Norm before scaling: 38.42867181393097. Distance: 9.328138904145835
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 1.9987, Accuracy: 4504/10000 (45.0400%)
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: 0.4650, Accuracy: 7964/9000 (88.4889%)
Scaling by  100
Scaled Norm after poisoning: 932.2079636540336, distance: 932.8139216907089
Total norm for 4 adversaries is: 932.2079636540336. distance: 932.8139216907089
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   1,  Average loss: 0.0137, Accuracy: 445/527 (84.4402%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   2,  Average loss: 0.0106, Accuracy: 462/527 (87.6660%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   3,  Average loss: 0.0053, Accuracy: 493/527 (93.5484%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   4,  Average loss: 0.0026, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   5,  Average loss: 0.0023, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   6,  Average loss: 0.0017, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Global model norm: 37.61915801562666.
Norm before scaling: 38.164120873803874. Distance: 8.525055253641275
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 1.9138, Accuracy: 4698/10000 (46.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: 0.2396, Accuracy: 8274/9000 (91.9333%)
Scaling by  100
Scaled Norm after poisoning: 851.4947151920557, distance: 852.5055351726462
Total norm for 4 adversaries is: 851.4947151920557. distance: 852.5055351726462
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   1,  Average loss: 0.0083, Accuracy: 445/496 (89.7177%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   2,  Average loss: 0.0073, Accuracy: 450/496 (90.7258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   3,  Average loss: 0.0039, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   4,  Average loss: 0.0024, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   5,  Average loss: 0.0016, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   6,  Average loss: 0.0010, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Global model norm: 37.61915801562666.
Norm before scaling: 37.766476704814714. Distance: 6.026374387883601
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 1.0386, Accuracy: 6635/10000 (66.3500%)
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: 0.1405, Accuracy: 8639/9000 (95.9889%)
Scaling by  100
Scaled Norm after poisoning: 601.7192036157729, distance: 602.6374843137456
Total norm for 4 adversaries is: 601.7192036157729. distance: 602.6374843137456
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   1,  Average loss: 0.0067, Accuracy: 497/546 (91.0256%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   3,  Average loss: 0.0025, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   4,  Average loss: 0.0008, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   5,  Average loss: 0.0011, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.61915801562666.
Norm before scaling: 37.78556795269607. Distance: 6.1951280833405
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 1.2868, Accuracy: 6203/10000 (62.0300%)
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: 0.1626, Accuracy: 8653/9000 (96.1444%)
Scaling by  100
Scaled Norm after poisoning: 618.5694686128633, distance: 619.5127873982909
Total norm for 4 adversaries is: 618.5694686128633. distance: 619.5127873982909
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 251, local model 36, internal_epoch   1,  Average loss: 0.0083, Accuracy: 726/849 (85.5124%)
___Train Local_ResNet_18,  epoch 251, local model 36, internal_epoch   2,  Average loss: 0.0162, Accuracy: 604/849 (71.1425%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 17.5569, Accuracy: 1847/10000 (18.4700%)
___Train Local_ResNet_18,  epoch 251, local model 26, internal_epoch   1,  Average loss: 0.0042, Accuracy: 436/468 (93.1624%)
___Train Local_ResNet_18,  epoch 251, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 437/468 (93.3761%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 2.6419, Accuracy: 4506/10000 (45.0600%)
___Train Local_ResNet_18,  epoch 251, local model 95, internal_epoch   1,  Average loss: 0.0091, Accuracy: 461/569 (81.0193%)
___Train Local_ResNet_18,  epoch 251, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 514/569 (90.3339%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 6.5117, Accuracy: 2513/10000 (25.1300%)
___Train Local_ResNet_18,  epoch 251, local model 49, internal_epoch   1,  Average loss: 0.0034, Accuracy: 396/426 (92.9577%)
___Train Local_ResNet_18,  epoch 251, local model 49, internal_epoch   2,  Average loss: 0.0016, Accuracy: 411/426 (96.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 2.1741, Accuracy: 4804/10000 (48.0400%)
___Train Local_ResNet_18,  epoch 251, local model 48, internal_epoch   1,  Average loss: 0.0048, Accuracy: 343/378 (90.7407%)
___Train Local_ResNet_18,  epoch 251, local model 48, internal_epoch   2,  Average loss: 0.0012, Accuracy: 370/378 (97.8836%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 3.8884, Accuracy: 3075/10000 (30.7500%)
___Train Local_ResNet_18,  epoch 251, local model 27, internal_epoch   1,  Average loss: 0.0020, Accuracy: 384/397 (96.7254%)
___Train Local_ResNet_18,  epoch 251, local model 27, internal_epoch   2,  Average loss: 0.0019, Accuracy: 390/397 (98.2368%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 1.3661, Accuracy: 6108/10000 (61.0800%)
time spent on training: 276.043363571167
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.40428406020841373  data num: [526, 527, 496, 546, 849, 468, 569, 426, 378, 397]
[foolsgold agg] considering poison per batch poison_fraction: 0.03158469220378232
[foolsgold agg] wv: [0.48686537 0.         0.03983956 0.         1.         0.41061985
 0.84576652 0.58335199 0.58335199 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 251: Average loss: 0.6551, Accuracy: 7834/10000 (78.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 251: Average loss: 5.1849, Accuracy: 696/9000 (7.7333%)
Done in 333.0880513191223 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:252 choose agents : [17, 33, 77, 11, 49, 74, 94, 29, 76, 70]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   1,  Average loss: 0.0081, Accuracy: 482/526 (91.6350%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   2,  Average loss: 0.0106, Accuracy: 476/526 (90.4943%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   3,  Average loss: 0.0066, Accuracy: 479/526 (91.0646%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   4,  Average loss: 0.0034, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   5,  Average loss: 0.0028, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   6,  Average loss: 0.0024, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Global model norm: 37.61842790660001.
Norm before scaling: 38.020178005197124. Distance: 7.643468035334336
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 1.7559, Accuracy: 5028/10000 (50.2800%)
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: 0.3663, Accuracy: 7885/9000 (87.6111%)
Scaling by  100
Scaled Norm after poisoning: 763.4380295741103, distance: 764.3467390523754
Total norm for 4 adversaries is: 763.4380295741103. distance: 764.3467390523754
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   1,  Average loss: 0.0123, Accuracy: 446/527 (84.6300%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   2,  Average loss: 0.0096, Accuracy: 462/527 (87.6660%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   3,  Average loss: 0.0076, Accuracy: 474/527 (89.9431%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   4,  Average loss: 0.0038, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   5,  Average loss: 0.0036, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   6,  Average loss: 0.0031, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Global model norm: 37.61842790660001.
Norm before scaling: 38.41117778852352. Distance: 9.493698037603641
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 1.7037, Accuracy: 4776/10000 (47.7600%)
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: 0.1582, Accuracy: 8530/9000 (94.7778%)
Scaling by  100
Scaled Norm after poisoning: 948.5422038581098, distance: 949.3698238831904
Total norm for 4 adversaries is: 948.5422038581098. distance: 949.3698238831904
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 453/496 (91.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   2,  Average loss: 0.0064, Accuracy: 457/496 (92.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   3,  Average loss: 0.0035, Accuracy: 473/496 (95.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   4,  Average loss: 0.0017, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   5,  Average loss: 0.0010, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.61842790660001.
Norm before scaling: 37.73056237208853. Distance: 5.629983178176277
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 0.9191, Accuracy: 6977/10000 (69.7700%)
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: 0.1722, Accuracy: 8640/9000 (96.0000%)
Scaling by  100
Scaled Norm after poisoning: 562.1899145306681, distance: 562.9982793046529
Total norm for 4 adversaries is: 562.1899145306681. distance: 562.9982793046529
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 503/546 (92.1245%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   2,  Average loss: 0.0051, Accuracy: 512/546 (93.7729%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   3,  Average loss: 0.0029, Accuracy: 528/546 (96.7033%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   4,  Average loss: 0.0017, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.61842790660001.
Norm before scaling: 37.77498300225048. Distance: 6.141864214773463
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 1.2354, Accuracy: 6334/10000 (63.3400%)
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: 0.2022, Accuracy: 8575/9000 (95.2778%)
Scaling by  100
Scaled Norm after poisoning: 613.2277564249681, distance: 614.1864537744218
Total norm for 4 adversaries is: 613.2277564249681. distance: 614.1864537744218
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 252, local model 49, internal_epoch   1,  Average loss: 0.0031, Accuracy: 398/426 (93.4272%)
___Train Local_ResNet_18,  epoch 252, local model 49, internal_epoch   2,  Average loss: 0.0017, Accuracy: 412/426 (96.7136%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 1.8234, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 252, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 433/469 (92.3241%)
___Train Local_ResNet_18,  epoch 252, local model 74, internal_epoch   2,  Average loss: 0.0016, Accuracy: 455/469 (97.0149%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 2.0582, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 252, local model 94, internal_epoch   1,  Average loss: 0.0097, Accuracy: 169/203 (83.2512%)
___Train Local_ResNet_18,  epoch 252, local model 94, internal_epoch   2,  Average loss: 0.0031, Accuracy: 197/203 (97.0443%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 9.8759, Accuracy: 2293/10000 (22.9300%)
___Train Local_ResNet_18,  epoch 252, local model 29, internal_epoch   1,  Average loss: 0.0056, Accuracy: 758/848 (89.3868%)
___Train Local_ResNet_18,  epoch 252, local model 29, internal_epoch   2,  Average loss: 0.0059, Accuracy: 754/848 (88.9151%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 10.8413, Accuracy: 1474/10000 (14.7400%)
___Train Local_ResNet_18,  epoch 252, local model 76, internal_epoch   1,  Average loss: 0.0397, Accuracy: 60/65 (92.3077%)
___Train Local_ResNet_18,  epoch 252, local model 76, internal_epoch   2,  Average loss: 0.0426, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 1.6329, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 252, local model 70, internal_epoch   1,  Average loss: 0.0039, Accuracy: 564/610 (92.4590%)
___Train Local_ResNet_18,  epoch 252, local model 70, internal_epoch   2,  Average loss: 0.0023, Accuracy: 576/610 (94.4262%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 2.6014, Accuracy: 4480/10000 (44.8000%)
time spent on training: 275.87768483161926
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4442324003392706  data num: [526, 527, 496, 546, 426, 469, 203, 848, 65, 610]
[foolsgold agg] considering poison per batch poison_fraction: 0.034705656276505514
[foolsgold agg] wv: [0.64096688 0.         0.02698821 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 252: Average loss: 0.6540, Accuracy: 7839/10000 (78.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 252: Average loss: 5.1844, Accuracy: 703/9000 (7.8111%)
Done in 328.90217566490173 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:253 choose agents : [17, 33, 77, 11, 99, 76, 10, 58, 65, 75]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   1,  Average loss: 0.0099, Accuracy: 481/526 (91.4449%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   2,  Average loss: 0.0097, Accuracy: 464/526 (88.2129%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   3,  Average loss: 0.0074, Accuracy: 475/526 (90.3042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   4,  Average loss: 0.0034, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   5,  Average loss: 0.0026, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   6,  Average loss: 0.0031, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Global model norm: 37.61755500209892.
Norm before scaling: 38.28270086536313. Distance: 8.712434183361964
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 1.7861, Accuracy: 4602/10000 (46.0200%)
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: 0.1789, Accuracy: 8457/9000 (93.9667%)
Scaling by  100
Scaled Norm after poisoning: 870.59638323393, distance: 871.2435796033162
Total norm for 4 adversaries is: 870.59638323393. distance: 871.2435796033162
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   1,  Average loss: 0.0125, Accuracy: 447/527 (84.8197%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   2,  Average loss: 0.0101, Accuracy: 460/527 (87.2865%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   3,  Average loss: 0.0056, Accuracy: 486/527 (92.2201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   4,  Average loss: 0.0038, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   5,  Average loss: 0.0046, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   6,  Average loss: 0.0030, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Global model norm: 37.61755500209892.
Norm before scaling: 38.42600819066105. Distance: 9.406875741619091
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 1.6654, Accuracy: 5159/10000 (51.5900%)
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: 0.2078, Accuracy: 8332/9000 (92.5778%)
Scaling by  100
Scaled Norm after poisoning: 940.0036901523313, distance: 940.6876474154426
Total norm for 4 adversaries is: 940.0036901523313. distance: 940.6876474154426
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   1,  Average loss: 0.0074, Accuracy: 450/496 (90.7258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 464/496 (93.5484%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   3,  Average loss: 0.0035, Accuracy: 478/496 (96.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   4,  Average loss: 0.0018, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.61755500209892.
Norm before scaling: 37.729408964112466. Distance: 5.611795482299426
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 0.9892, Accuracy: 6743/10000 (67.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: 0.1211, Accuracy: 8693/9000 (96.5889%)
Scaling by  100
Scaled Norm after poisoning: 560.3849123593533, distance: 561.1795891245511
Total norm for 4 adversaries is: 560.3849123593533. distance: 561.1795891245511
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   1,  Average loss: 0.0055, Accuracy: 498/546 (91.2088%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   2,  Average loss: 0.0043, Accuracy: 518/546 (94.8718%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   3,  Average loss: 0.0020, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   4,  Average loss: 0.0012, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   6,  Average loss: 0.0014, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.61755500209892.
Norm before scaling: 37.714309494209225. Distance: 5.782067813249987
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 1.2575, Accuracy: 6071/10000 (60.7100%)
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: 0.1001, Accuracy: 8778/9000 (97.5333%)
Scaling by  100
Scaled Norm after poisoning: 577.1687903031486, distance: 578.2067374650696
Total norm for 4 adversaries is: 577.1687903031486. distance: 578.2067374650696
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 253, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 357/391 (91.3043%)
___Train Local_ResNet_18,  epoch 253, local model 99, internal_epoch   2,  Average loss: 0.0020, Accuracy: 386/391 (98.7212%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 7.9514, Accuracy: 2139/10000 (21.3900%)
___Train Local_ResNet_18,  epoch 253, local model 76, internal_epoch   1,  Average loss: 0.0325, Accuracy: 60/65 (92.3077%)
___Train Local_ResNet_18,  epoch 253, local model 76, internal_epoch   2,  Average loss: 0.0485, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 0.9286, Accuracy: 7240/10000 (72.4000%)
___Train Local_ResNet_18,  epoch 253, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 695/752 (92.4202%)
___Train Local_ResNet_18,  epoch 253, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 705/752 (93.7500%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 7.8842, Accuracy: 2646/10000 (26.4600%)
___Train Local_ResNet_18,  epoch 253, local model 58, internal_epoch   1,  Average loss: 0.0089, Accuracy: 193/234 (82.4786%)
___Train Local_ResNet_18,  epoch 253, local model 58, internal_epoch   2,  Average loss: 0.0018, Accuracy: 231/234 (98.7179%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 6.2921, Accuracy: 1944/10000 (19.4400%)
___Train Local_ResNet_18,  epoch 253, local model 65, internal_epoch   1,  Average loss: 0.0040, Accuracy: 290/314 (92.3567%)
___Train Local_ResNet_18,  epoch 253, local model 65, internal_epoch   2,  Average loss: 0.0013, Accuracy: 309/314 (98.4076%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 4.6039, Accuracy: 2966/10000 (29.6600%)
___Train Local_ResNet_18,  epoch 253, local model 75, internal_epoch   1,  Average loss: 0.0024, Accuracy: 552/578 (95.5017%)
___Train Local_ResNet_18,  epoch 253, local model 75, internal_epoch   2,  Average loss: 0.0049, Accuracy: 540/578 (93.4256%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 4.6409, Accuracy: 3821/10000 (38.2100%)
time spent on training: 274.09366106987
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4730187401219237  data num: [526, 527, 496, 546, 391, 65, 752, 234, 314, 578]
[foolsgold agg] considering poison per batch poison_fraction: 0.036954589072025285
[foolsgold agg] wv: [0.63275423 0.         0.03513624 0.         1.         0.06051851
 1.         1.         1.         0.06051851]
___Test Target_ResNet_18 poisoned: False, epoch: 253: Average loss: 0.6534, Accuracy: 7836/10000 (78.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 253: Average loss: 5.1767, Accuracy: 705/9000 (7.8333%)
Done in 328.6165852546692 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:254 choose agents : [17, 33, 77, 11, 48, 64, 16, 97, 52, 24]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   1,  Average loss: 0.0099, Accuracy: 483/526 (91.8251%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   2,  Average loss: 0.0106, Accuracy: 456/526 (86.6920%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   3,  Average loss: 0.0064, Accuracy: 482/526 (91.6350%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   4,  Average loss: 0.0061, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   5,  Average loss: 0.0047, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   6,  Average loss: 0.0043, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Global model norm: 37.61620504298563.
Norm before scaling: 38.140240934158044. Distance: 8.315102994261453
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 1.6047, Accuracy: 5008/10000 (50.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: 0.4494, Accuracy: 7594/9000 (84.3778%)
Scaling by  100
Scaled Norm after poisoning: 830.5902268868807, distance: 831.5102975910761
Total norm for 4 adversaries is: 830.5902268868807. distance: 831.5102975910761
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   1,  Average loss: 0.0130, Accuracy: 442/527 (83.8710%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   2,  Average loss: 0.0094, Accuracy: 453/527 (85.9583%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   3,  Average loss: 0.0058, Accuracy: 489/527 (92.7894%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   4,  Average loss: 0.0050, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   5,  Average loss: 0.0048, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   6,  Average loss: 0.0038, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Global model norm: 37.61620504298563.
Norm before scaling: 38.50961540337199. Distance: 9.723030545979318
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 1.8114, Accuracy: 4777/10000 (47.7700%)
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: 0.2026, Accuracy: 8369/9000 (92.9889%)
Scaling by  100
Scaled Norm after poisoning: 971.6663200399611, distance: 972.3030006124634
Total norm for 4 adversaries is: 971.6663200399611. distance: 972.3030006124634
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   1,  Average loss: 0.0069, Accuracy: 449/496 (90.5242%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 458/496 (92.3387%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   3,  Average loss: 0.0033, Accuracy: 474/496 (95.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   4,  Average loss: 0.0024, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   5,  Average loss: 0.0010, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
