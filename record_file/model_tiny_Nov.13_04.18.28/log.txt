current path: saved_models/model_tiny_Nov.13_04.18.28
Loading data
reading data done
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.001 and current epoch is 21
create model done
Poisoned following participants: [17]
We use following environment for graphs:  tiny
----------------------------------Start one training epoch------------------------------------------
Server Epoch:21 choose agents : [17, 96, 42, 19, 99, 26, 16, 84, 97, 87]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 17, internal_epoch   1,  Average loss: 0.0401, Accuracy: 705/1574 (44.7903%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 17, internal_epoch   2,  Average loss: 0.0136, Accuracy: 1105/1574 (70.2033%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 17, internal_epoch   3,  Average loss: 0.0074, Accuracy: 1309/1574 (83.1639%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 17, internal_epoch   4,  Average loss: 0.0068, Accuracy: 1338/1574 (85.0064%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 17, internal_epoch   5,  Average loss: 0.0063, Accuracy: 1360/1574 (86.4041%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 17, internal_epoch   6,  Average loss: 0.0053, Accuracy: 1392/1574 (88.4371%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 17, internal_epoch   7,  Average loss: 0.0053, Accuracy: 1406/1574 (89.3266%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 17, internal_epoch   8,  Average loss: 0.0044, Accuracy: 1425/1574 (90.5337%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 17, internal_epoch   9,  Average loss: 0.0042, Accuracy: 1440/1574 (91.4867%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 17, internal_epoch  10,  Average loss: 0.0047, Accuracy: 1429/1574 (90.7878%), train_poison_data_count: 500
Global model norm: 86.31567076453295.
Norm before scaling: 86.29251669467058. Distance: 1.4200603097546436
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 3.6253, Accuracy: 2963/10000 (29.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 21: Average loss: 0.3745, Accuracy: 8747/9950 (87.9095%)
Scaling by  100
Scaled Norm after poisoning: 164.361572645494, distance: 142.00603805384475
Total norm for 1 adversaries is: 164.361572645494. distance: 142.00603805384475
___Test Local_ResNet_18 poisoned: True, epoch: 21: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  21, local model 96, internal_epoch   1,  Average loss: 0.0561, Accuracy: 95/311 (30.5466%)
___Train Local_ResNet_18,  epoch  21, local model 96, internal_epoch   2,  Average loss: 0.0242, Accuracy: 201/311 (64.6302%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 2.0638, Accuracy: 5045/10000 (50.4500%)
___Train Local_ResNet_18,  epoch  21, local model 42, internal_epoch   1,  Average loss: 0.0159, Accuracy: 1045/1372 (76.1662%)
___Train Local_ResNet_18,  epoch  21, local model 42, internal_epoch   2,  Average loss: 0.0022, Accuracy: 1317/1372 (95.9913%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 3.1103, Accuracy: 3539/10000 (35.3900%)
___Train Local_ResNet_18,  epoch  21, local model 19, internal_epoch   1,  Average loss: 0.0259, Accuracy: 673/1036 (64.9614%)
___Train Local_ResNet_18,  epoch  21, local model 19, internal_epoch   2,  Average loss: 0.0033, Accuracy: 985/1036 (95.0772%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 5.5573, Accuracy: 1717/10000 (17.1700%)
___Train Local_ResNet_18,  epoch  21, local model 99, internal_epoch   1,  Average loss: 0.0306, Accuracy: 433/773 (56.0155%)
___Train Local_ResNet_18,  epoch  21, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 719/773 (93.0142%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 4.5274, Accuracy: 2123/10000 (21.2300%)
___Train Local_ResNet_18,  epoch  21, local model 26, internal_epoch   1,  Average loss: 0.0187, Accuracy: 1018/1446 (70.4011%)
___Train Local_ResNet_18,  epoch  21, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 1365/1446 (94.3983%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 3.2748, Accuracy: 3442/10000 (34.4200%)
___Train Local_ResNet_18,  epoch  21, local model 16, internal_epoch   1,  Average loss: 0.0362, Accuracy: 391/708 (55.2260%)
___Train Local_ResNet_18,  epoch  21, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 660/708 (93.2203%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 5.2654, Accuracy: 1833/10000 (18.3300%)
___Train Local_ResNet_18,  epoch  21, local model 84, internal_epoch   1,  Average loss: 0.0206, Accuracy: 820/1190 (68.9076%)
___Train Local_ResNet_18,  epoch  21, local model 84, internal_epoch   2,  Average loss: 0.0024, Accuracy: 1142/1190 (95.9664%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 3.4192, Accuracy: 3266/10000 (32.6600%)
___Train Local_ResNet_18,  epoch  21, local model 97, internal_epoch   1,  Average loss: 0.0210, Accuracy: 827/1213 (68.1781%)
___Train Local_ResNet_18,  epoch  21, local model 97, internal_epoch   2,  Average loss: 0.0028, Accuracy: 1154/1213 (95.1360%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 3.5529, Accuracy: 3082/10000 (30.8200%)
___Train Local_ResNet_18,  epoch  21, local model 87, internal_epoch   1,  Average loss: 0.0217, Accuracy: 746/1131 (65.9593%)
___Train Local_ResNet_18,  epoch  21, local model 87, internal_epoch   2,  Average loss: 0.0030, Accuracy: 1077/1131 (95.2255%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 3.4430, Accuracy: 3071/10000 (30.7100%)
time spent on training: 267.284960269928
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 21: Average loss: 3.6344, Accuracy: 2961/10000 (29.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 21: Average loss: 0.3740, Accuracy: 8749/9950 (87.9296%)
Done in 371.8159062862396 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:22 choose agents : [17, 75, 11, 52, 41, 30, 32, 38, 98, 94]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 17, internal_epoch   1,  Average loss: 0.0040, Accuracy: 1449/1574 (92.0584%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 17, internal_epoch   2,  Average loss: 0.0032, Accuracy: 1479/1574 (93.9644%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 17, internal_epoch   3,  Average loss: 0.0021, Accuracy: 1515/1574 (96.2516%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 17, internal_epoch   4,  Average loss: 0.0022, Accuracy: 1513/1574 (96.1245%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 17, internal_epoch   5,  Average loss: 0.0022, Accuracy: 1509/1574 (95.8704%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 17, internal_epoch   6,  Average loss: 0.0023, Accuracy: 1505/1574 (95.6163%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 17, internal_epoch   7,  Average loss: 0.0020, Accuracy: 1517/1574 (96.3787%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 17, internal_epoch   8,  Average loss: 0.0021, Accuracy: 1511/1574 (95.9975%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 17, internal_epoch   9,  Average loss: 0.0018, Accuracy: 1518/1574 (96.4422%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 17, internal_epoch  10,  Average loss: 0.0019, Accuracy: 1512/1574 (96.0610%), train_poison_data_count: 500
Global model norm: 86.29146704718984.
Norm before scaling: 86.26898851213134. Distance: 0.4411150554142461
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 3.7275, Accuracy: 2868/10000 (28.6800%)
___Test Local_ResNet_18 poisoned: True, epoch: 22: Average loss: 0.1747, Accuracy: 9404/9950 (94.5126%)
Scaling by  100
Scaled Norm after poisoning: 94.7877151191018, distance: 44.11150588193374
Total norm for 1 adversaries is: 94.7877151191018. distance: 44.11150588193374
___Test Local_ResNet_18 poisoned: True, epoch: 22: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  22, local model 75, internal_epoch   1,  Average loss: 0.0574, Accuracy: 297/776 (38.2732%)
___Train Local_ResNet_18,  epoch  22, local model 75, internal_epoch   2,  Average loss: 0.0063, Accuracy: 702/776 (90.4639%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 5.7296, Accuracy: 1425/10000 (14.2500%)
___Train Local_ResNet_18,  epoch  22, local model 11, internal_epoch   1,  Average loss: 0.0658, Accuracy: 256/712 (35.9551%)
___Train Local_ResNet_18,  epoch  22, local model 11, internal_epoch   2,  Average loss: 0.0059, Accuracy: 646/712 (90.7303%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 8.0007, Accuracy: 534/10000 (5.3400%)
___Train Local_ResNet_18,  epoch  22, local model 52, internal_epoch   1,  Average loss: 0.0748, Accuracy: 164/636 (25.7862%)
___Train Local_ResNet_18,  epoch  22, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 575/636 (90.4088%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 7.4310, Accuracy: 655/10000 (6.5500%)
___Train Local_ResNet_18,  epoch  22, local model 41, internal_epoch   1,  Average loss: 0.0720, Accuracy: 205/719 (28.5118%)
___Train Local_ResNet_18,  epoch  22, local model 41, internal_epoch   2,  Average loss: 0.0099, Accuracy: 614/719 (85.3964%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 5.6567, Accuracy: 1318/10000 (13.1800%)
___Train Local_ResNet_18,  epoch  22, local model 30, internal_epoch   1,  Average loss: 0.0877, Accuracy: 75/486 (15.4321%)
___Train Local_ResNet_18,  epoch  22, local model 30, internal_epoch   2,  Average loss: 0.0075, Accuracy: 429/486 (88.2716%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 4.2844, Accuracy: 2587/10000 (25.8700%)
___Train Local_ResNet_18,  epoch  22, local model 32, internal_epoch   1,  Average loss: 0.0559, Accuracy: 312/735 (42.4490%)
___Train Local_ResNet_18,  epoch  22, local model 32, internal_epoch   2,  Average loss: 0.0042, Accuracy: 682/735 (92.7891%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 5.9429, Accuracy: 1237/10000 (12.3700%)
___Train Local_ResNet_18,  epoch  22, local model 38, internal_epoch   1,  Average loss: 0.0340, Accuracy: 656/1131 (58.0018%)
___Train Local_ResNet_18,  epoch  22, local model 38, internal_epoch   2,  Average loss: 0.0028, Accuracy: 1083/1131 (95.7560%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 4.5587, Accuracy: 2169/10000 (21.6900%)
___Train Local_ResNet_18,  epoch  22, local model 98, internal_epoch   1,  Average loss: 0.1071, Accuracy: 25/373 (6.7024%)
___Train Local_ResNet_18,  epoch  22, local model 98, internal_epoch   2,  Average loss: 0.0243, Accuracy: 229/373 (61.3941%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 2.9623, Accuracy: 3675/10000 (36.7500%)
___Train Local_ResNet_18,  epoch  22, local model 94, internal_epoch   1,  Average loss: 0.0265, Accuracy: 1082/1662 (65.1023%)
___Train Local_ResNet_18,  epoch  22, local model 94, internal_epoch   2,  Average loss: 0.0026, Accuracy: 1583/1662 (95.2467%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 3.4810, Accuracy: 3170/10000 (31.7000%)
time spent on training: 280.5168447494507
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 22: Average loss: 3.4277, Accuracy: 3168/10000 (31.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 22: Average loss: 0.2567, Accuracy: 9193/9950 (92.3920%)
Done in 382.14488792419434 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:23 choose agents : [17, 57, 78, 4, 7, 65, 73, 13, 47, 82]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0018, Accuracy: 1527/1574 (97.0140%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 17, internal_epoch   2,  Average loss: 0.0014, Accuracy: 1538/1574 (97.7128%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 17, internal_epoch   3,  Average loss: 0.0016, Accuracy: 1528/1574 (97.0775%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 17, internal_epoch   4,  Average loss: 0.0015, Accuracy: 1532/1574 (97.3316%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 17, internal_epoch   5,  Average loss: 0.0015, Accuracy: 1531/1574 (97.2681%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 17, internal_epoch   6,  Average loss: 0.0016, Accuracy: 1532/1574 (97.3316%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 17, internal_epoch   7,  Average loss: 0.0013, Accuracy: 1535/1574 (97.5222%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 17, internal_epoch   8,  Average loss: 0.0016, Accuracy: 1528/1574 (97.0775%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 17, internal_epoch   9,  Average loss: 0.0013, Accuracy: 1535/1574 (97.5222%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 17, internal_epoch  10,  Average loss: 0.0014, Accuracy: 1533/1574 (97.3952%), train_poison_data_count: 500
Global model norm: 86.26755369379904.
Norm before scaling: 86.24474621679862. Distance: 0.2637143701288407
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 3.8431, Accuracy: 2797/10000 (27.9700%)
___Test Local_ResNet_18 poisoned: True, epoch: 23: Average loss: 0.1511, Accuracy: 9480/9950 (95.2764%)
Scaling by  100
Scaled Norm after poisoning: 87.96133960794936, distance: 26.37143831475755
Total norm for 1 adversaries is: 87.96133960794936. distance: 26.37143831475755
___Test Local_ResNet_18 poisoned: True, epoch: 23: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  23, local model 57, internal_epoch   1,  Average loss: 0.0467, Accuracy: 552/1154 (47.8336%)
___Train Local_ResNet_18,  epoch  23, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 1054/1154 (91.3345%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 5.3081, Accuracy: 1709/10000 (17.0900%)
___Train Local_ResNet_18,  epoch  23, local model 78, internal_epoch   1,  Average loss: 0.0925, Accuracy: 45/416 (10.8173%)
___Train Local_ResNet_18,  epoch  23, local model 78, internal_epoch   2,  Average loss: 0.0159, Accuracy: 315/416 (75.7212%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 3.1371, Accuracy: 3481/10000 (34.8100%)
___Train Local_ResNet_18,  epoch  23, local model 4, internal_epoch   1,  Average loss: 0.0471, Accuracy: 418/901 (46.3929%)
___Train Local_ResNet_18,  epoch  23, local model 4, internal_epoch   2,  Average loss: 0.0084, Accuracy: 791/901 (87.7913%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 4.8581, Accuracy: 2024/10000 (20.2400%)
___Train Local_ResNet_18,  epoch  23, local model 7, internal_epoch   1,  Average loss: 0.0558, Accuracy: 374/891 (41.9753%)
___Train Local_ResNet_18,  epoch  23, local model 7, internal_epoch   2,  Average loss: 0.0051, Accuracy: 822/891 (92.2559%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 6.2693, Accuracy: 1185/10000 (11.8500%)
___Train Local_ResNet_18,  epoch  23, local model 65, internal_epoch   1,  Average loss: 0.0374, Accuracy: 878/1475 (59.5254%)
___Train Local_ResNet_18,  epoch  23, local model 65, internal_epoch   2,  Average loss: 0.0060, Accuracy: 1339/1475 (90.7797%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 4.0895, Accuracy: 2529/10000 (25.2900%)
___Train Local_ResNet_18,  epoch  23, local model 73, internal_epoch   1,  Average loss: 0.0410, Accuracy: 455/938 (48.5075%)
___Train Local_ResNet_18,  epoch  23, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 847/938 (90.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 3.9245, Accuracy: 2764/10000 (27.6400%)
___Train Local_ResNet_18,  epoch  23, local model 13, internal_epoch   1,  Average loss: 0.0252, Accuracy: 1094/1645 (66.5046%)
___Train Local_ResNet_18,  epoch  23, local model 13, internal_epoch   2,  Average loss: 0.0027, Accuracy: 1565/1645 (95.1368%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 3.1842, Accuracy: 3247/10000 (32.4700%)
___Train Local_ResNet_18,  epoch  23, local model 47, internal_epoch   1,  Average loss: 0.1501, Accuracy: 17/134 (12.6866%)
___Train Local_ResNet_18,  epoch  23, local model 47, internal_epoch   2,  Average loss: 0.1043, Accuracy: 36/134 (26.8657%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 2.9183, Accuracy: 3922/10000 (39.2200%)
___Train Local_ResNet_18,  epoch  23, local model 82, internal_epoch   1,  Average loss: 0.0763, Accuracy: 81/500 (16.2000%)
___Train Local_ResNet_18,  epoch  23, local model 82, internal_epoch   2,  Average loss: 0.0099, Accuracy: 411/500 (82.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 3.7405, Accuracy: 3242/10000 (32.4200%)
time spent on training: 284.2570700645447
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 23: Average loss: 3.5298, Accuracy: 3124/10000 (31.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 23: Average loss: 0.2155, Accuracy: 9326/9950 (93.7286%)
Done in 381.8509244918823 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:24 choose agents : [17, 92, 38, 62, 66, 69, 12, 55, 43, 93]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 17, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1533/1574 (97.3952%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 17, internal_epoch   2,  Average loss: 0.0014, Accuracy: 1532/1574 (97.3316%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 17, internal_epoch   3,  Average loss: 0.0011, Accuracy: 1551/1574 (98.5388%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 17, internal_epoch   4,  Average loss: 0.0013, Accuracy: 1543/1574 (98.0305%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 17, internal_epoch   5,  Average loss: 0.0012, Accuracy: 1541/1574 (97.9034%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 17, internal_epoch   6,  Average loss: 0.0010, Accuracy: 1545/1574 (98.1576%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 17, internal_epoch   7,  Average loss: 0.0009, Accuracy: 1545/1574 (98.1576%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 17, internal_epoch   8,  Average loss: 0.0011, Accuracy: 1552/1574 (98.6023%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 17, internal_epoch   9,  Average loss: 0.0011, Accuracy: 1542/1574 (97.9670%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 17, internal_epoch  10,  Average loss: 0.0010, Accuracy: 1551/1574 (98.5388%), train_poison_data_count: 500
Global model norm: 86.24325437842226.
Norm before scaling: 86.22018563049056. Distance: 0.2382097293267262
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 3.8081, Accuracy: 2825/10000 (28.2500%)
___Test Local_ResNet_18 poisoned: True, epoch: 24: Average loss: 0.1132, Accuracy: 9595/9950 (96.4322%)
Scaling by  100
Scaled Norm after poisoning: 87.18841845394375, distance: 23.820971005984806
Total norm for 1 adversaries is: 87.18841845394375. distance: 23.820971005984806
___Test Local_ResNet_18 poisoned: True, epoch: 24: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  24, local model 92, internal_epoch   1,  Average loss: 0.0315, Accuracy: 1051/1715 (61.2828%)
___Train Local_ResNet_18,  epoch  24, local model 92, internal_epoch   2,  Average loss: 0.0035, Accuracy: 1599/1715 (93.2362%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 4.2340, Accuracy: 2392/10000 (23.9200%)
___Train Local_ResNet_18,  epoch  24, local model 38, internal_epoch   1,  Average loss: 0.0312, Accuracy: 669/1131 (59.1512%)
___Train Local_ResNet_18,  epoch  24, local model 38, internal_epoch   2,  Average loss: 0.0028, Accuracy: 1081/1131 (95.5791%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 4.1582, Accuracy: 2349/10000 (23.4900%)
___Train Local_ResNet_18,  epoch  24, local model 62, internal_epoch   1,  Average loss: 0.0769, Accuracy: 118/568 (20.7746%)
___Train Local_ResNet_18,  epoch  24, local model 62, internal_epoch   2,  Average loss: 0.0078, Accuracy: 487/568 (85.7394%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 4.9437, Accuracy: 1852/10000 (18.5200%)
___Train Local_ResNet_18,  epoch  24, local model 66, internal_epoch   1,  Average loss: 0.0323, Accuracy: 776/1402 (55.3495%)
___Train Local_ResNet_18,  epoch  24, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 1277/1402 (91.0842%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 3.4757, Accuracy: 2965/10000 (29.6500%)
___Train Local_ResNet_18,  epoch  24, local model 69, internal_epoch   1,  Average loss: 0.0798, Accuracy: 167/590 (28.3051%)
___Train Local_ResNet_18,  epoch  24, local model 69, internal_epoch   2,  Average loss: 0.0134, Accuracy: 499/590 (84.5763%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 8.5349, Accuracy: 433/10000 (4.3300%)
___Train Local_ResNet_18,  epoch  24, local model 12, internal_epoch   1,  Average loss: 0.1014, Accuracy: 18/338 (5.3254%)
___Train Local_ResNet_18,  epoch  24, local model 12, internal_epoch   2,  Average loss: 0.0163, Accuracy: 252/338 (74.5562%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 3.2947, Accuracy: 3337/10000 (33.3700%)
___Train Local_ResNet_18,  epoch  24, local model 55, internal_epoch   1,  Average loss: 0.0454, Accuracy: 524/1071 (48.9262%)
___Train Local_ResNet_18,  epoch  24, local model 55, internal_epoch   2,  Average loss: 0.0037, Accuracy: 998/1071 (93.1839%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 5.0520, Accuracy: 1633/10000 (16.3300%)
___Train Local_ResNet_18,  epoch  24, local model 43, internal_epoch   1,  Average loss: 0.0558, Accuracy: 356/946 (37.6321%)
___Train Local_ResNet_18,  epoch  24, local model 43, internal_epoch   2,  Average loss: 0.0048, Accuracy: 843/946 (89.1121%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 4.1951, Accuracy: 2427/10000 (24.2700%)
___Train Local_ResNet_18,  epoch  24, local model 93, internal_epoch   1,  Average loss: 0.0294, Accuracy: 1104/1742 (63.3754%)
___Train Local_ResNet_18,  epoch  24, local model 93, internal_epoch   2,  Average loss: 0.0025, Accuracy: 1656/1742 (95.0631%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 3.6667, Accuracy: 2840/10000 (28.4000%)
time spent on training: 291.52273392677307
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 24: Average loss: 3.4686, Accuracy: 3171/10000 (31.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 24: Average loss: 0.1839, Accuracy: 9421/9950 (94.6834%)
Done in 396.4103078842163 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:25 choose agents : [17, 16, 24, 80, 34, 43, 68, 31, 35, 56]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 17, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1551/1574 (98.5388%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 17, internal_epoch   2,  Average loss: 0.0009, Accuracy: 1557/1574 (98.9199%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 17, internal_epoch   3,  Average loss: 0.0008, Accuracy: 1555/1574 (98.7929%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 17, internal_epoch   4,  Average loss: 0.0010, Accuracy: 1544/1574 (98.0940%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 17, internal_epoch   5,  Average loss: 0.0011, Accuracy: 1551/1574 (98.5388%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 17, internal_epoch   6,  Average loss: 0.0010, Accuracy: 1551/1574 (98.5388%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 17, internal_epoch   7,  Average loss: 0.0011, Accuracy: 1541/1574 (97.9034%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 17, internal_epoch   8,  Average loss: 0.0009, Accuracy: 1551/1574 (98.5388%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 17, internal_epoch   9,  Average loss: 0.0007, Accuracy: 1555/1574 (98.7929%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 17, internal_epoch  10,  Average loss: 0.0009, Accuracy: 1548/1574 (98.3482%), train_poison_data_count: 500
Global model norm: 86.21845550873954.
Norm before scaling: 86.1953064811246. Distance: 0.2032795739746199
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: 3.7827, Accuracy: 2897/10000 (28.9700%)
___Test Local_ResNet_18 poisoned: True, epoch: 25: Average loss: 0.1114, Accuracy: 9601/9950 (96.4925%)
Scaling by  100
Scaled Norm after poisoning: 86.27638013692537, distance: 20.327958360673637
Total norm for 1 adversaries is: 86.27638013692537. distance: 20.327958360673637
___Test Local_ResNet_18 poisoned: True, epoch: 25: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  25, local model 16, internal_epoch   1,  Average loss: 0.0559, Accuracy: 316/708 (44.6328%)
___Train Local_ResNet_18,  epoch  25, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 652/708 (92.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: 6.3285, Accuracy: 1182/10000 (11.8200%)
___Train Local_ResNet_18,  epoch  25, local model 24, internal_epoch   1,  Average loss: 0.1182, Accuracy: 12/312 (3.8462%)
___Train Local_ResNet_18,  epoch  25, local model 24, internal_epoch   2,  Average loss: 0.0308, Accuracy: 168/312 (53.8462%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: 3.6934, Accuracy: 3100/10000 (31.0000%)
___Train Local_ResNet_18,  epoch  25, local model 80, internal_epoch   1,  Average loss: 0.0736, Accuracy: 163/682 (23.9003%)
___Train Local_ResNet_18,  epoch  25, local model 80, internal_epoch   2,  Average loss: 0.0071, Accuracy: 600/682 (87.9765%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: 4.3428, Accuracy: 2400/10000 (24.0000%)
___Train Local_ResNet_18,  epoch  25, local model 34, internal_epoch   1,  Average loss: 0.0364, Accuracy: 805/1427 (56.4121%)
___Train Local_ResNet_18,  epoch  25, local model 34, internal_epoch   2,  Average loss: 0.0057, Accuracy: 1295/1427 (90.7498%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: 3.5463, Accuracy: 2997/10000 (29.9700%)
___Train Local_ResNet_18,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0520, Accuracy: 388/946 (41.0148%)
___Train Local_ResNet_18,  epoch  25, local model 43, internal_epoch   2,  Average loss: 0.0049, Accuracy: 852/946 (90.0634%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: 4.0623, Accuracy: 2558/10000 (25.5800%)
___Train Local_ResNet_18,  epoch  25, local model 68, internal_epoch   1,  Average loss: 0.0399, Accuracy: 611/1163 (52.5365%)
___Train Local_ResNet_18,  epoch  25, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 1046/1163 (89.9398%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: 3.6776, Accuracy: 2776/10000 (27.7600%)
___Train Local_ResNet_18,  epoch  25, local model 31, internal_epoch   1,  Average loss: 0.0910, Accuracy: 52/460 (11.3043%)
___Train Local_ResNet_18,  epoch  25, local model 31, internal_epoch   2,  Average loss: 0.0100, Accuracy: 386/460 (83.9130%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: 4.5954, Accuracy: 2000/10000 (20.0000%)
___Train Local_ResNet_18,  epoch  25, local model 35, internal_epoch   1,  Average loss: 0.1151, Accuracy: 20/271 (7.3801%)
___Train Local_ResNet_18,  epoch  25, local model 35, internal_epoch   2,  Average loss: 0.0345, Accuracy: 129/271 (47.6015%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: 2.8926, Accuracy: 3880/10000 (38.8000%)
___Train Local_ResNet_18,  epoch  25, local model 56, internal_epoch   1,  Average loss: 0.1094, Accuracy: 9/186 (4.8387%)
___Train Local_ResNet_18,  epoch  25, local model 56, internal_epoch   2,  Average loss: 0.0648, Accuracy: 37/186 (19.8925%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: 3.0687, Accuracy: 3607/10000 (36.0700%)
time spent on training: 280.53853273391724
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 25: Average loss: 3.5145, Accuracy: 3144/10000 (31.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 25: Average loss: 0.1607, Accuracy: 9491/9950 (95.3869%)
Done in 376.57400822639465 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:26 choose agents : [17, 23, 60, 7, 45, 59, 26, 71, 62, 97]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 17, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1544/1574 (98.0940%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 17, internal_epoch   2,  Average loss: 0.0009, Accuracy: 1553/1574 (98.6658%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 17, internal_epoch   3,  Average loss: 0.0007, Accuracy: 1558/1574 (98.9835%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 17, internal_epoch   4,  Average loss: 0.0008, Accuracy: 1556/1574 (98.8564%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 17, internal_epoch   5,  Average loss: 0.0007, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 17, internal_epoch   6,  Average loss: 0.0007, Accuracy: 1558/1574 (98.9835%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 17, internal_epoch   7,  Average loss: 0.0007, Accuracy: 1555/1574 (98.7929%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 17, internal_epoch   8,  Average loss: 0.0008, Accuracy: 1549/1574 (98.4117%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 17, internal_epoch   9,  Average loss: 0.0007, Accuracy: 1558/1574 (98.9835%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 17, internal_epoch  10,  Average loss: 0.0005, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Global model norm: 86.19408853533692.
Norm before scaling: 86.1708083002881. Distance: 0.20742362106076842
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: 3.8063, Accuracy: 2933/10000 (29.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 26: Average loss: 0.1092, Accuracy: 9617/9950 (96.6533%)
Scaling by  100
Scaled Norm after poisoning: 86.33715874679193, distance: 20.742363317286873
Total norm for 1 adversaries is: 86.33715874679193. distance: 20.742363317286873
___Test Local_ResNet_18 poisoned: True, epoch: 26: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  26, local model 23, internal_epoch   1,  Average loss: 0.0648, Accuracy: 259/715 (36.2238%)
___Train Local_ResNet_18,  epoch  26, local model 23, internal_epoch   2,  Average loss: 0.0092, Accuracy: 615/715 (86.0140%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: 4.9883, Accuracy: 1684/10000 (16.8400%)
___Train Local_ResNet_18,  epoch  26, local model 60, internal_epoch   1,  Average loss: 0.0236, Accuracy: 1553/2227 (69.7351%)
___Train Local_ResNet_18,  epoch  26, local model 60, internal_epoch   2,  Average loss: 0.0029, Accuracy: 2112/2227 (94.8361%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: 3.7825, Accuracy: 2743/10000 (27.4300%)
___Train Local_ResNet_18,  epoch  26, local model 7, internal_epoch   1,  Average loss: 0.0545, Accuracy: 367/891 (41.1897%)
___Train Local_ResNet_18,  epoch  26, local model 7, internal_epoch   2,  Average loss: 0.0044, Accuracy: 825/891 (92.5926%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: 5.9898, Accuracy: 1327/10000 (13.2700%)
___Train Local_ResNet_18,  epoch  26, local model 45, internal_epoch   1,  Average loss: 0.0671, Accuracy: 200/669 (29.8954%)
___Train Local_ResNet_18,  epoch  26, local model 45, internal_epoch   2,  Average loss: 0.0091, Accuracy: 567/669 (84.7534%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: 4.6408, Accuracy: 1845/10000 (18.4500%)
___Train Local_ResNet_18,  epoch  26, local model 59, internal_epoch   1,  Average loss: 0.0438, Accuracy: 586/1089 (53.8108%)
___Train Local_ResNet_18,  epoch  26, local model 59, internal_epoch   2,  Average loss: 0.0130, Accuracy: 1029/1089 (94.4904%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: 5.7785, Accuracy: 1644/10000 (16.4400%)
___Train Local_ResNet_18,  epoch  26, local model 26, internal_epoch   1,  Average loss: 0.0339, Accuracy: 827/1446 (57.1923%)
___Train Local_ResNet_18,  epoch  26, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 1354/1446 (93.6376%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: 3.8961, Accuracy: 2673/10000 (26.7300%)
___Train Local_ResNet_18,  epoch  26, local model 71, internal_epoch   1,  Average loss: 0.0574, Accuracy: 291/818 (35.5746%)
___Train Local_ResNet_18,  epoch  26, local model 71, internal_epoch   2,  Average loss: 0.0057, Accuracy: 734/818 (89.7311%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: 4.3067, Accuracy: 2413/10000 (24.1300%)
___Train Local_ResNet_18,  epoch  26, local model 62, internal_epoch   1,  Average loss: 0.0730, Accuracy: 131/568 (23.0634%)
___Train Local_ResNet_18,  epoch  26, local model 62, internal_epoch   2,  Average loss: 0.0078, Accuracy: 489/568 (86.0915%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: 4.7028, Accuracy: 2045/10000 (20.4500%)
___Train Local_ResNet_18,  epoch  26, local model 97, internal_epoch   1,  Average loss: 0.0353, Accuracy: 701/1213 (57.7906%)
___Train Local_ResNet_18,  epoch  26, local model 97, internal_epoch   2,  Average loss: 0.0035, Accuracy: 1137/1213 (93.7345%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: 4.5640, Accuracy: 1951/10000 (19.5100%)
time spent on training: 276.7982199192047
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 26: Average loss: 3.4586, Accuracy: 3236/10000 (32.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 26: Average loss: 0.1787, Accuracy: 9452/9950 (94.9950%)
Done in 377.4367036819458 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:27 choose agents : [17, 55, 10, 70, 67, 80, 93, 52, 27, 98]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 17, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 17, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 17, internal_epoch   3,  Average loss: 0.0008, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 17, internal_epoch   4,  Average loss: 0.0007, Accuracy: 1558/1574 (98.9835%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 17, internal_epoch   5,  Average loss: 0.0006, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 17, internal_epoch   6,  Average loss: 0.0007, Accuracy: 1558/1574 (98.9835%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 17, internal_epoch   7,  Average loss: 0.0006, Accuracy: 1557/1574 (98.9199%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 17, internal_epoch   8,  Average loss: 0.0005, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 17, internal_epoch   9,  Average loss: 0.0007, Accuracy: 1558/1574 (98.9835%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 17, internal_epoch  10,  Average loss: 0.0007, Accuracy: 1557/1574 (98.9199%), train_poison_data_count: 500
Global model norm: 86.16904318783081.
Norm before scaling: 86.14567966532042. Distance: 0.15382900405369138
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: 3.8126, Accuracy: 2942/10000 (29.4200%)
___Test Local_ResNet_18 poisoned: True, epoch: 27: Average loss: 0.1048, Accuracy: 9638/9950 (96.8643%)
Scaling by  100
Scaled Norm after poisoning: 85.18687236104076, distance: 15.382900286221071
Total norm for 1 adversaries is: 85.18687236104076. distance: 15.382900286221071
___Test Local_ResNet_18 poisoned: True, epoch: 27: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  27, local model 55, internal_epoch   1,  Average loss: 0.0426, Accuracy: 516/1071 (48.1793%)
___Train Local_ResNet_18,  epoch  27, local model 55, internal_epoch   2,  Average loss: 0.0045, Accuracy: 989/1071 (92.3436%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: 5.0105, Accuracy: 1645/10000 (16.4500%)
___Train Local_ResNet_18,  epoch  27, local model 10, internal_epoch   1,  Average loss: 0.0494, Accuracy: 371/861 (43.0894%)
___Train Local_ResNet_18,  epoch  27, local model 10, internal_epoch   2,  Average loss: 0.0025, Accuracy: 829/861 (96.2834%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: 5.5946, Accuracy: 1583/10000 (15.8300%)
___Train Local_ResNet_18,  epoch  27, local model 70, internal_epoch   1,  Average loss: 0.0293, Accuracy: 868/1418 (61.2130%)
___Train Local_ResNet_18,  epoch  27, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 1314/1418 (92.6657%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: 3.6517, Accuracy: 2782/10000 (27.8200%)
___Train Local_ResNet_18,  epoch  27, local model 67, internal_epoch   1,  Average loss: 0.0846, Accuracy: 60/426 (14.0845%)
___Train Local_ResNet_18,  epoch  27, local model 67, internal_epoch   2,  Average loss: 0.0134, Accuracy: 344/426 (80.7512%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: 3.6390, Accuracy: 2815/10000 (28.1500%)
___Train Local_ResNet_18,  epoch  27, local model 80, internal_epoch   1,  Average loss: 0.0669, Accuracy: 172/682 (25.2199%)
___Train Local_ResNet_18,  epoch  27, local model 80, internal_epoch   2,  Average loss: 0.0066, Accuracy: 609/682 (89.2962%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: 4.4520, Accuracy: 2280/10000 (22.8000%)
___Train Local_ResNet_18,  epoch  27, local model 93, internal_epoch   1,  Average loss: 0.0275, Accuracy: 1108/1742 (63.6051%)
___Train Local_ResNet_18,  epoch  27, local model 93, internal_epoch   2,  Average loss: 0.0026, Accuracy: 1670/1742 (95.8668%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: 3.6486, Accuracy: 2826/10000 (28.2600%)
___Train Local_ResNet_18,  epoch  27, local model 52, internal_epoch   1,  Average loss: 0.0636, Accuracy: 205/636 (32.2327%)
___Train Local_ResNet_18,  epoch  27, local model 52, internal_epoch   2,  Average loss: 0.0048, Accuracy: 583/636 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: 7.4407, Accuracy: 673/10000 (6.7300%)
___Train Local_ResNet_18,  epoch  27, local model 27, internal_epoch   1,  Average loss: 0.0315, Accuracy: 933/1587 (58.7902%)
___Train Local_ResNet_18,  epoch  27, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 1464/1587 (92.2495%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: 3.7057, Accuracy: 2828/10000 (28.2800%)
___Train Local_ResNet_18,  epoch  27, local model 98, internal_epoch   1,  Average loss: 0.0914, Accuracy: 46/373 (12.3324%)
___Train Local_ResNet_18,  epoch  27, local model 98, internal_epoch   2,  Average loss: 0.0194, Accuracy: 249/373 (66.7560%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: 2.9409, Accuracy: 3706/10000 (37.0600%)
time spent on training: 278.3151390552521
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 27: Average loss: 3.4829, Accuracy: 3230/10000 (32.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 27: Average loss: 0.1698, Accuracy: 9470/9950 (95.1759%)
Done in 377.8147885799408 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:28 choose agents : [17, 36, 50, 92, 14, 73, 53, 85, 31, 38]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1552/1574 (98.6023%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 17, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1550/1574 (98.4752%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 17, internal_epoch   3,  Average loss: 0.0008, Accuracy: 1551/1574 (98.5388%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 17, internal_epoch   4,  Average loss: 0.0006, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 17, internal_epoch   5,  Average loss: 0.0007, Accuracy: 1557/1574 (98.9199%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 17, internal_epoch   6,  Average loss: 0.0006, Accuracy: 1555/1574 (98.7929%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 17, internal_epoch   7,  Average loss: 0.0007, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 17, internal_epoch   8,  Average loss: 0.0006, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 17, internal_epoch   9,  Average loss: 0.0005, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 17, internal_epoch  10,  Average loss: 0.0006, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Global model norm: 86.14413226353551.
Norm before scaling: 86.12067126730521. Distance: 0.16203875899503714
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: 3.6985, Accuracy: 3041/10000 (30.4100%)
___Test Local_ResNet_18 poisoned: True, epoch: 28: Average loss: 0.1129, Accuracy: 9616/9950 (96.6432%)
Scaling by  100
Scaled Norm after poisoning: 85.30301286535106, distance: 16.20387647425667
Total norm for 1 adversaries is: 85.30301286535106. distance: 16.20387647425667
___Test Local_ResNet_18 poisoned: True, epoch: 28: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  28, local model 36, internal_epoch   1,  Average loss: 0.0764, Accuracy: 70/408 (17.1569%)
___Train Local_ResNet_18,  epoch  28, local model 36, internal_epoch   2,  Average loss: 0.0123, Accuracy: 324/408 (79.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: 3.5958, Accuracy: 2990/10000 (29.9000%)
___Train Local_ResNet_18,  epoch  28, local model 50, internal_epoch   1,  Average loss: 0.0537, Accuracy: 295/809 (36.4648%)
___Train Local_ResNet_18,  epoch  28, local model 50, internal_epoch   2,  Average loss: 0.0041, Accuracy: 754/809 (93.2015%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: 4.9226, Accuracy: 1706/10000 (17.0600%)
___Train Local_ResNet_18,  epoch  28, local model 92, internal_epoch   1,  Average loss: 0.0291, Accuracy: 1083/1715 (63.1487%)
___Train Local_ResNet_18,  epoch  28, local model 92, internal_epoch   2,  Average loss: 0.0035, Accuracy: 1608/1715 (93.7609%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: 4.2084, Accuracy: 2392/10000 (23.9200%)
___Train Local_ResNet_18,  epoch  28, local model 14, internal_epoch   1,  Average loss: 0.0398, Accuracy: 517/1013 (51.0365%)
___Train Local_ResNet_18,  epoch  28, local model 14, internal_epoch   2,  Average loss: 0.0035, Accuracy: 950/1013 (93.7808%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: 3.9532, Accuracy: 2652/10000 (26.5200%)
___Train Local_ResNet_18,  epoch  28, local model 73, internal_epoch   1,  Average loss: 0.0384, Accuracy: 467/938 (49.7868%)
___Train Local_ResNet_18,  epoch  28, local model 73, internal_epoch   2,  Average loss: 0.0048, Accuracy: 852/938 (90.8316%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: 3.8697, Accuracy: 2797/10000 (27.9700%)
___Train Local_ResNet_18,  epoch  28, local model 53, internal_epoch   1,  Average loss: 0.0561, Accuracy: 324/813 (39.8524%)
___Train Local_ResNet_18,  epoch  28, local model 53, internal_epoch   2,  Average loss: 0.0053, Accuracy: 742/813 (91.2669%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: 8.9069, Accuracy: 312/10000 (3.1200%)
___Train Local_ResNet_18,  epoch  28, local model 85, internal_epoch   1,  Average loss: 0.0220, Accuracy: 1412/1988 (71.0262%)
___Train Local_ResNet_18,  epoch  28, local model 85, internal_epoch   2,  Average loss: 0.0033, Accuracy: 1879/1988 (94.5171%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: 3.2782, Accuracy: 3342/10000 (33.4200%)
___Train Local_ResNet_18,  epoch  28, local model 31, internal_epoch   1,  Average loss: 0.0843, Accuracy: 61/460 (13.2609%)
___Train Local_ResNet_18,  epoch  28, local model 31, internal_epoch   2,  Average loss: 0.0086, Accuracy: 399/460 (86.7391%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: 4.8192, Accuracy: 1716/10000 (17.1600%)
___Train Local_ResNet_18,  epoch  28, local model 38, internal_epoch   1,  Average loss: 0.0274, Accuracy: 709/1131 (62.6879%)
___Train Local_ResNet_18,  epoch  28, local model 38, internal_epoch   2,  Average loss: 0.0025, Accuracy: 1084/1131 (95.8444%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: 4.2102, Accuracy: 2354/10000 (23.5400%)
time spent on training: 279.4267225265503
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 28: Average loss: 3.3752, Accuracy: 3337/10000 (33.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 28: Average loss: 0.1807, Accuracy: 9461/9950 (95.0854%)
Done in 380.00619745254517 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:29 choose agents : [17, 71, 62, 73, 10, 30, 46, 66, 31, 96]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 17, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 17, internal_epoch   3,  Average loss: 0.0008, Accuracy: 1556/1574 (98.8564%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 17, internal_epoch   4,  Average loss: 0.0005, Accuracy: 1558/1574 (98.9835%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 17, internal_epoch   5,  Average loss: 0.0005, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 17, internal_epoch   6,  Average loss: 0.0007, Accuracy: 1552/1574 (98.6023%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 17, internal_epoch   7,  Average loss: 0.0006, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 17, internal_epoch   8,  Average loss: 0.0006, Accuracy: 1558/1574 (98.9835%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 17, internal_epoch   9,  Average loss: 0.0005, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 17, internal_epoch  10,  Average loss: 0.0005, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Global model norm: 86.11911774632999.
Norm before scaling: 86.0956697834958. Distance: 0.13501269042449568
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: 3.7173, Accuracy: 3040/10000 (30.4000%)
___Test Local_ResNet_18 poisoned: True, epoch: 29: Average loss: 0.1075, Accuracy: 9636/9950 (96.8442%)
Scaling by  100
Scaled Norm after poisoning: 84.81291451630464, distance: 13.501269245527784
Total norm for 1 adversaries is: 84.81291451630464. distance: 13.501269245527784
___Test Local_ResNet_18 poisoned: True, epoch: 29: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  29, local model 71, internal_epoch   1,  Average loss: 0.0531, Accuracy: 300/818 (36.6748%)
___Train Local_ResNet_18,  epoch  29, local model 71, internal_epoch   2,  Average loss: 0.0048, Accuracy: 743/818 (90.8313%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: 4.1383, Accuracy: 2566/10000 (25.6600%)
___Train Local_ResNet_18,  epoch  29, local model 62, internal_epoch   1,  Average loss: 0.0643, Accuracy: 161/568 (28.3451%)
___Train Local_ResNet_18,  epoch  29, local model 62, internal_epoch   2,  Average loss: 0.0073, Accuracy: 501/568 (88.2042%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: 4.7664, Accuracy: 1977/10000 (19.7700%)
___Train Local_ResNet_18,  epoch  29, local model 73, internal_epoch   1,  Average loss: 0.0374, Accuracy: 484/938 (51.5991%)
___Train Local_ResNet_18,  epoch  29, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 852/938 (90.8316%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: 3.8577, Accuracy: 2818/10000 (28.1800%)
___Train Local_ResNet_18,  epoch  29, local model 10, internal_epoch   1,  Average loss: 0.0458, Accuracy: 394/861 (45.7607%)
___Train Local_ResNet_18,  epoch  29, local model 10, internal_epoch   2,  Average loss: 0.0022, Accuracy: 832/861 (96.6318%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: 5.4609, Accuracy: 1678/10000 (16.7800%)
___Train Local_ResNet_18,  epoch  29, local model 30, internal_epoch   1,  Average loss: 0.0737, Accuracy: 99/486 (20.3704%)
___Train Local_ResNet_18,  epoch  29, local model 30, internal_epoch   2,  Average loss: 0.0068, Accuracy: 439/486 (90.3292%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: 4.0118, Accuracy: 2765/10000 (27.6500%)
___Train Local_ResNet_18,  epoch  29, local model 46, internal_epoch   1,  Average loss: 0.0226, Accuracy: 1325/1904 (69.5903%)
___Train Local_ResNet_18,  epoch  29, local model 46, internal_epoch   2,  Average loss: 0.0025, Accuracy: 1811/1904 (95.1155%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: 3.5847, Accuracy: 2875/10000 (28.7500%)
___Train Local_ResNet_18,  epoch  29, local model 66, internal_epoch   1,  Average loss: 0.0305, Accuracy: 792/1402 (56.4907%)
___Train Local_ResNet_18,  epoch  29, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 1288/1402 (91.8688%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: 3.4671, Accuracy: 2966/10000 (29.6600%)
___Train Local_ResNet_18,  epoch  29, local model 31, internal_epoch   1,  Average loss: 0.0806, Accuracy: 57/460 (12.3913%)
___Train Local_ResNet_18,  epoch  29, local model 31, internal_epoch   2,  Average loss: 0.0101, Accuracy: 394/460 (85.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: 4.8733, Accuracy: 1754/10000 (17.5400%)
___Train Local_ResNet_18,  epoch  29, local model 96, internal_epoch   1,  Average loss: 0.0887, Accuracy: 46/311 (14.7910%)
___Train Local_ResNet_18,  epoch  29, local model 96, internal_epoch   2,  Average loss: 0.0323, Accuracy: 154/311 (49.5177%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: 2.7219, Accuracy: 4033/10000 (40.3300%)
time spent on training: 324.7796666622162
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 29: Average loss: 3.4244, Accuracy: 3305/10000 (33.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 29: Average loss: 0.1613, Accuracy: 9495/9950 (95.4271%)
Done in 422.4545056819916 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:30 choose agents : [17, 66, 40, 25, 36, 19, 86, 53, 51, 42]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 17, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1558/1574 (98.9835%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 17, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 17, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 17, internal_epoch   5,  Average loss: 0.0005, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 17, internal_epoch   7,  Average loss: 0.0005, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 17, internal_epoch   8,  Average loss: 0.0004, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 17, internal_epoch   9,  Average loss: 0.0007, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 17, internal_epoch  10,  Average loss: 0.0006, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Global model norm: 86.09436535624006.
Norm before scaling: 86.07094468827009. Distance: 0.14046589141966748
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: 3.7382, Accuracy: 3063/10000 (30.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 30: Average loss: 0.1055, Accuracy: 9643/9950 (96.9146%)
Scaling by  100
Scaled Norm after poisoning: 84.87856962762302, distance: 14.0465893063967
Total norm for 1 adversaries is: 84.87856962762302. distance: 14.0465893063967
___Test Local_ResNet_18 poisoned: True, epoch: 30: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  30, local model 66, internal_epoch   1,  Average loss: 0.0280, Accuracy: 821/1402 (58.5592%)
___Train Local_ResNet_18,  epoch  30, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 1295/1402 (92.3680%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: 3.4562, Accuracy: 2994/10000 (29.9400%)
___Train Local_ResNet_18,  epoch  30, local model 40, internal_epoch   1,  Average loss: 0.0280, Accuracy: 978/1573 (62.1742%)
___Train Local_ResNet_18,  epoch  30, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 1439/1573 (91.4812%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: 3.4014, Accuracy: 3173/10000 (31.7300%)
___Train Local_ResNet_18,  epoch  30, local model 25, internal_epoch   1,  Average loss: 0.0674, Accuracy: 234/690 (33.9130%)
___Train Local_ResNet_18,  epoch  30, local model 25, internal_epoch   2,  Average loss: 0.0052, Accuracy: 632/690 (91.5942%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: 7.6192, Accuracy: 594/10000 (5.9400%)
___Train Local_ResNet_18,  epoch  30, local model 36, internal_epoch   1,  Average loss: 0.0728, Accuracy: 66/408 (16.1765%)
___Train Local_ResNet_18,  epoch  30, local model 36, internal_epoch   2,  Average loss: 0.0126, Accuracy: 320/408 (78.4314%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: 3.6248, Accuracy: 2919/10000 (29.1900%)
___Train Local_ResNet_18,  epoch  30, local model 19, internal_epoch   1,  Average loss: 0.0389, Accuracy: 581/1036 (56.0811%)
___Train Local_ResNet_18,  epoch  30, local model 19, internal_epoch   2,  Average loss: 0.0039, Accuracy: 974/1036 (94.0154%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: 6.8218, Accuracy: 985/10000 (9.8500%)
___Train Local_ResNet_18,  epoch  30, local model 86, internal_epoch   1,  Average loss: 0.0456, Accuracy: 460/1003 (45.8624%)
___Train Local_ResNet_18,  epoch  30, local model 86, internal_epoch   2,  Average loss: 0.0058, Accuracy: 898/1003 (89.5314%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: 3.9679, Accuracy: 2589/10000 (25.8900%)
___Train Local_ResNet_18,  epoch  30, local model 53, internal_epoch   1,  Average loss: 0.0532, Accuracy: 331/813 (40.7134%)
___Train Local_ResNet_18,  epoch  30, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 736/813 (90.5289%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: 8.8045, Accuracy: 314/10000 (3.1400%)
___Train Local_ResNet_18,  epoch  30, local model 51, internal_epoch   1,  Average loss: 0.0398, Accuracy: 529/1049 (50.4290%)
___Train Local_ResNet_18,  epoch  30, local model 51, internal_epoch   2,  Average loss: 0.0044, Accuracy: 964/1049 (91.8970%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: 4.1388, Accuracy: 2419/10000 (24.1900%)
___Train Local_ResNet_18,  epoch  30, local model 42, internal_epoch   1,  Average loss: 0.0273, Accuracy: 861/1372 (62.7551%)
___Train Local_ResNet_18,  epoch  30, local model 42, internal_epoch   2,  Average loss: 0.0025, Accuracy: 1306/1372 (95.1895%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: 3.9588, Accuracy: 2536/10000 (25.3600%)
time spent on training: 292.1849699020386
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 30: Average loss: 3.4081, Accuracy: 3360/10000 (33.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 30: Average loss: 0.1774, Accuracy: 9481/9950 (95.2864%)
Done in 391.6143710613251 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:31 choose agents : [17, 7, 51, 87, 43, 4, 95, 16, 36, 2]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 17, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1568/1574 (99.6188%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 17, internal_epoch   4,  Average loss: 0.0006, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 17, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 17, internal_epoch   7,  Average loss: 0.0004, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 17, internal_epoch   8,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 17, internal_epoch   9,  Average loss: 0.0004, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 17, internal_epoch  10,  Average loss: 0.0005, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Global model norm: 86.06937325041207.
Norm before scaling: 86.04586633465462. Distance: 0.13190292493248343
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: 3.6818, Accuracy: 3109/10000 (31.0900%)
___Test Local_ResNet_18 poisoned: True, epoch: 31: Average loss: 0.1021, Accuracy: 9655/9950 (97.0352%)
Scaling by  100
Scaled Norm after poisoning: 84.70945287422178, distance: 13.190292279733784
Total norm for 1 adversaries is: 84.70945287422178. distance: 13.190292279733784
___Test Local_ResNet_18 poisoned: True, epoch: 31: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  31, local model 7, internal_epoch   1,  Average loss: 0.0466, Accuracy: 402/891 (45.1178%)
___Train Local_ResNet_18,  epoch  31, local model 7, internal_epoch   2,  Average loss: 0.0047, Accuracy: 820/891 (92.0314%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: 6.0153, Accuracy: 1345/10000 (13.4500%)
___Train Local_ResNet_18,  epoch  31, local model 51, internal_epoch   1,  Average loss: 0.0382, Accuracy: 548/1049 (52.2402%)
___Train Local_ResNet_18,  epoch  31, local model 51, internal_epoch   2,  Average loss: 0.0041, Accuracy: 975/1049 (92.9457%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: 4.1535, Accuracy: 2386/10000 (23.8600%)
___Train Local_ResNet_18,  epoch  31, local model 87, internal_epoch   1,  Average loss: 0.0346, Accuracy: 608/1131 (53.7577%)
___Train Local_ResNet_18,  epoch  31, local model 87, internal_epoch   2,  Average loss: 0.0036, Accuracy: 1058/1131 (93.5455%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: 4.2474, Accuracy: 2167/10000 (21.6700%)
___Train Local_ResNet_18,  epoch  31, local model 43, internal_epoch   1,  Average loss: 0.0458, Accuracy: 405/946 (42.8118%)
___Train Local_ResNet_18,  epoch  31, local model 43, internal_epoch   2,  Average loss: 0.0050, Accuracy: 848/946 (89.6406%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: 4.1467, Accuracy: 2485/10000 (24.8500%)
___Train Local_ResNet_18,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0410, Accuracy: 461/901 (51.1654%)
___Train Local_ResNet_18,  epoch  31, local model 4, internal_epoch   2,  Average loss: 0.0065, Accuracy: 807/901 (89.5671%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: 4.7009, Accuracy: 2044/10000 (20.4400%)
___Train Local_ResNet_18,  epoch  31, local model 95, internal_epoch   1,  Average loss: 0.0788, Accuracy: 144/599 (24.0401%)
___Train Local_ResNet_18,  epoch  31, local model 95, internal_epoch   2,  Average loss: 0.0112, Accuracy: 523/599 (87.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: 10.0924, Accuracy: 191/10000 (1.9100%)
___Train Local_ResNet_18,  epoch  31, local model 16, internal_epoch   1,  Average loss: 0.0516, Accuracy: 323/708 (45.6215%)
___Train Local_ResNet_18,  epoch  31, local model 16, internal_epoch   2,  Average loss: 0.0068, Accuracy: 657/708 (92.7966%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: 6.0232, Accuracy: 1290/10000 (12.9000%)
___Train Local_ResNet_18,  epoch  31, local model 36, internal_epoch   1,  Average loss: 0.0685, Accuracy: 72/408 (17.6471%)
___Train Local_ResNet_18,  epoch  31, local model 36, internal_epoch   2,  Average loss: 0.0122, Accuracy: 332/408 (81.3725%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: 3.6440, Accuracy: 2952/10000 (29.5200%)
___Train Local_ResNet_18,  epoch  31, local model 2, internal_epoch   1,  Average loss: 0.0666, Accuracy: 163/605 (26.9421%)
___Train Local_ResNet_18,  epoch  31, local model 2, internal_epoch   2,  Average loss: 0.0064, Accuracy: 539/605 (89.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: 5.3981, Accuracy: 1514/10000 (15.1400%)
time spent on training: 273.51552510261536
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 31: Average loss: 3.3815, Accuracy: 3376/10000 (33.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 31: Average loss: 0.1602, Accuracy: 9518/9950 (95.6583%)
Done in 377.0150673389435 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:32 choose agents : [17, 99, 94, 43, 26, 73, 92, 2, 76, 84]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 17, internal_epoch   3,  Average loss: 0.0006, Accuracy: 1557/1574 (98.9199%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 17, internal_epoch   4,  Average loss: 0.0005, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 17, internal_epoch   5,  Average loss: 0.0005, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 17, internal_epoch   6,  Average loss: 0.0005, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 17, internal_epoch   7,  Average loss: 0.0005, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 17, internal_epoch   8,  Average loss: 0.0005, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 17, internal_epoch   9,  Average loss: 0.0006, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 17, internal_epoch  10,  Average loss: 0.0005, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Global model norm: 86.04457533925367.
Norm before scaling: 86.02106448513788. Distance: 0.12191023821517681
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: 3.6782, Accuracy: 3101/10000 (31.0100%)
___Test Local_ResNet_18 poisoned: True, epoch: 32: Average loss: 0.0982, Accuracy: 9660/9950 (97.0854%)
Scaling by  100
Scaled Norm after poisoning: 84.53460309893073, distance: 12.191025131218456
Total norm for 1 adversaries is: 84.53460309893073. distance: 12.191025131218456
___Test Local_ResNet_18 poisoned: True, epoch: 32: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  32, local model 99, internal_epoch   1,  Average loss: 0.0475, Accuracy: 338/773 (43.7257%)
___Train Local_ResNet_18,  epoch  32, local model 99, internal_epoch   2,  Average loss: 0.0100, Accuracy: 709/773 (91.7206%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: 5.6450, Accuracy: 1372/10000 (13.7200%)
___Train Local_ResNet_18,  epoch  32, local model 94, internal_epoch   1,  Average loss: 0.0242, Accuracy: 1116/1662 (67.1480%)
___Train Local_ResNet_18,  epoch  32, local model 94, internal_epoch   2,  Average loss: 0.0028, Accuracy: 1570/1662 (94.4645%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: 3.3056, Accuracy: 3254/10000 (32.5400%)
___Train Local_ResNet_18,  epoch  32, local model 43, internal_epoch   1,  Average loss: 0.0456, Accuracy: 400/946 (42.2833%)
___Train Local_ResNet_18,  epoch  32, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 853/946 (90.1691%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: 4.1520, Accuracy: 2445/10000 (24.4500%)
___Train Local_ResNet_18,  epoch  32, local model 26, internal_epoch   1,  Average loss: 0.0297, Accuracy: 864/1446 (59.7510%)
___Train Local_ResNet_18,  epoch  32, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 1349/1446 (93.2918%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: 3.8139, Accuracy: 2673/10000 (26.7300%)
___Train Local_ResNet_18,  epoch  32, local model 73, internal_epoch   1,  Average loss: 0.0354, Accuracy: 479/938 (51.0661%)
___Train Local_ResNet_18,  epoch  32, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 860/938 (91.6844%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: 3.9015, Accuracy: 2838/10000 (28.3800%)
___Train Local_ResNet_18,  epoch  32, local model 92, internal_epoch   1,  Average loss: 0.0269, Accuracy: 1087/1715 (63.3819%)
___Train Local_ResNet_18,  epoch  32, local model 92, internal_epoch   2,  Average loss: 0.0032, Accuracy: 1601/1715 (93.3528%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: 4.0280, Accuracy: 2516/10000 (25.1600%)
___Train Local_ResNet_18,  epoch  32, local model 2, internal_epoch   1,  Average loss: 0.0649, Accuracy: 176/605 (29.0909%)
___Train Local_ResNet_18,  epoch  32, local model 2, internal_epoch   2,  Average loss: 0.0075, Accuracy: 536/605 (88.5950%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: 5.0952, Accuracy: 1723/10000 (17.2300%)
___Train Local_ResNet_18,  epoch  32, local model 76, internal_epoch   1,  Average loss: 0.0727, Accuracy: 83/466 (17.8112%)
___Train Local_ResNet_18,  epoch  32, local model 76, internal_epoch   2,  Average loss: 0.0103, Accuracy: 386/466 (82.8326%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: 3.4501, Accuracy: 3133/10000 (31.3300%)
___Train Local_ResNet_18,  epoch  32, local model 84, internal_epoch   1,  Average loss: 0.0300, Accuracy: 722/1190 (60.6723%)
___Train Local_ResNet_18,  epoch  32, local model 84, internal_epoch   2,  Average loss: 0.0029, Accuracy: 1128/1190 (94.7899%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: 4.1040, Accuracy: 2458/10000 (24.5800%)
time spent on training: 284.4089984893799
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 32: Average loss: 3.3503, Accuracy: 3388/10000 (33.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 32: Average loss: 0.1586, Accuracy: 9525/9950 (95.7286%)
Done in 387.0752589702606 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:33 choose agents : [17, 37, 49, 4, 59, 6, 46, 48, 1, 28]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 17, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1555/1574 (98.7929%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 17, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 17, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 17, internal_epoch   5,  Average loss: 0.0005, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 17, internal_epoch   6,  Average loss: 0.0005, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 17, internal_epoch   7,  Average loss: 0.0006, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 17, internal_epoch   8,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 17, internal_epoch   9,  Average loss: 0.0005, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 17, internal_epoch  10,  Average loss: 0.0005, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Global model norm: 86.01948645964616.
Norm before scaling: 85.99599145817787. Distance: 0.14790847897255477
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: 3.6144, Accuracy: 3189/10000 (31.8900%)
___Test Local_ResNet_18 poisoned: True, epoch: 33: Average loss: 0.0944, Accuracy: 9676/9950 (97.2462%)
Scaling by  100
Scaled Norm after poisoning: 84.92146245299978, distance: 14.79084630849379
Total norm for 1 adversaries is: 84.92146245299978. distance: 14.79084630849379
___Test Local_ResNet_18 poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  33, local model 37, internal_epoch   1,  Average loss: 0.0372, Accuracy: 626/1129 (55.4473%)
___Train Local_ResNet_18,  epoch  33, local model 37, internal_epoch   2,  Average loss: 0.0027, Accuracy: 1077/1129 (95.3942%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: 5.2157, Accuracy: 1619/10000 (16.1900%)
___Train Local_ResNet_18,  epoch  33, local model 49, internal_epoch   1,  Average loss: 0.0724, Accuracy: 67/440 (15.2273%)
___Train Local_ResNet_18,  epoch  33, local model 49, internal_epoch   2,  Average loss: 0.0149, Accuracy: 339/440 (77.0455%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: 3.2132, Accuracy: 3549/10000 (35.4900%)
___Train Local_ResNet_18,  epoch  33, local model 4, internal_epoch   1,  Average loss: 0.0385, Accuracy: 465/901 (51.6093%)
___Train Local_ResNet_18,  epoch  33, local model 4, internal_epoch   2,  Average loss: 0.0072, Accuracy: 791/901 (87.7913%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: 4.9049, Accuracy: 2022/10000 (20.2200%)
___Train Local_ResNet_18,  epoch  33, local model 59, internal_epoch   1,  Average loss: 0.0396, Accuracy: 599/1089 (55.0046%)
___Train Local_ResNet_18,  epoch  33, local model 59, internal_epoch   2,  Average loss: 0.0057, Accuracy: 1021/1089 (93.7557%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: 5.4051, Accuracy: 1784/10000 (17.8400%)
___Train Local_ResNet_18,  epoch  33, local model 6, internal_epoch   1,  Average loss: 0.0250, Accuracy: 1289/1956 (65.8998%)
___Train Local_ResNet_18,  epoch  33, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 1835/1956 (93.8139%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: 3.7430, Accuracy: 2668/10000 (26.6800%)
___Train Local_ResNet_18,  epoch  33, local model 46, internal_epoch   1,  Average loss: 0.0218, Accuracy: 1344/1904 (70.5882%)
___Train Local_ResNet_18,  epoch  33, local model 46, internal_epoch   2,  Average loss: 0.0025, Accuracy: 1816/1904 (95.3782%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: 3.5703, Accuracy: 2850/10000 (28.5000%)
___Train Local_ResNet_18,  epoch  33, local model 48, internal_epoch   1,  Average loss: 0.0605, Accuracy: 150/631 (23.7718%)
___Train Local_ResNet_18,  epoch  33, local model 48, internal_epoch   2,  Average loss: 0.0094, Accuracy: 535/631 (84.7861%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: 3.2184, Accuracy: 3357/10000 (33.5700%)
___Train Local_ResNet_18,  epoch  33, local model 1, internal_epoch   1,  Average loss: 0.0467, Accuracy: 425/928 (45.7974%)
___Train Local_ResNet_18,  epoch  33, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 843/928 (90.8405%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: 4.9631, Accuracy: 1851/10000 (18.5100%)
___Train Local_ResNet_18,  epoch  33, local model 28, internal_epoch   1,  Average loss: 0.0262, Accuracy: 1004/1581 (63.5041%)
___Train Local_ResNet_18,  epoch  33, local model 28, internal_epoch   2,  Average loss: 0.0031, Accuracy: 1484/1581 (93.8646%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: 3.6501, Accuracy: 2997/10000 (29.9700%)
time spent on training: 286.3422122001648
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 33: Average loss: 3.2930, Accuracy: 3509/10000 (35.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 33: Average loss: 0.1527, Accuracy: 9542/9950 (95.8995%)
Done in 382.28923416137695 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:34 choose agents : [17, 20, 65, 29, 93, 37, 77, 6, 42, 84]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 17, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 17, internal_epoch   3,  Average loss: 0.0009, Accuracy: 1557/1574 (98.9199%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 17, internal_epoch   4,  Average loss: 0.0005, Accuracy: 1556/1574 (98.8564%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 17, internal_epoch   5,  Average loss: 0.0005, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 17, internal_epoch   7,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 17, internal_epoch   8,  Average loss: 0.0007, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 17, internal_epoch   9,  Average loss: 0.0006, Accuracy: 1557/1574 (98.9199%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 17, internal_epoch  10,  Average loss: 0.0004, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Global model norm: 85.99429089425792.
Norm before scaling: 85.9707464099344. Distance: 0.14702810464508728
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: 3.6018, Accuracy: 3174/10000 (31.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 34: Average loss: 0.1140, Accuracy: 9625/9950 (96.7337%)
Scaling by  100
Scaled Norm after poisoning: 84.87693296767974, distance: 14.702809507773505
Total norm for 1 adversaries is: 84.87693296767974. distance: 14.702809507773505
___Test Local_ResNet_18 poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  34, local model 20, internal_epoch   1,  Average loss: 0.0515, Accuracy: 335/807 (41.5118%)
___Train Local_ResNet_18,  epoch  34, local model 20, internal_epoch   2,  Average loss: 0.0056, Accuracy: 722/807 (89.4672%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: 4.5397, Accuracy: 1846/10000 (18.4600%)
___Train Local_ResNet_18,  epoch  34, local model 65, internal_epoch   1,  Average loss: 0.0305, Accuracy: 925/1475 (62.7119%)
___Train Local_ResNet_18,  epoch  34, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 1358/1475 (92.0678%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: 4.1643, Accuracy: 2518/10000 (25.1800%)
___Train Local_ResNet_18,  epoch  34, local model 29, internal_epoch   1,  Average loss: 0.0264, Accuracy: 939/1440 (65.2083%)
___Train Local_ResNet_18,  epoch  34, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 1368/1440 (95.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: 4.5641, Accuracy: 2110/10000 (21.1000%)
___Train Local_ResNet_18,  epoch  34, local model 93, internal_epoch   1,  Average loss: 0.0242, Accuracy: 1144/1742 (65.6716%)
___Train Local_ResNet_18,  epoch  34, local model 93, internal_epoch   2,  Average loss: 0.0027, Accuracy: 1655/1742 (95.0057%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: 3.6550, Accuracy: 2827/10000 (28.2700%)
___Train Local_ResNet_18,  epoch  34, local model 37, internal_epoch   1,  Average loss: 0.0364, Accuracy: 623/1129 (55.1816%)
___Train Local_ResNet_18,  epoch  34, local model 37, internal_epoch   2,  Average loss: 0.0022, Accuracy: 1081/1129 (95.7484%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: 5.1325, Accuracy: 1611/10000 (16.1100%)
___Train Local_ResNet_18,  epoch  34, local model 77, internal_epoch   1,  Average loss: 0.0293, Accuracy: 841/1340 (62.7612%)
___Train Local_ResNet_18,  epoch  34, local model 77, internal_epoch   2,  Average loss: 0.0030, Accuracy: 1266/1340 (94.4776%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: 4.3369, Accuracy: 2062/10000 (20.6200%)
___Train Local_ResNet_18,  epoch  34, local model 6, internal_epoch   1,  Average loss: 0.0241, Accuracy: 1323/1956 (67.6380%)
___Train Local_ResNet_18,  epoch  34, local model 6, internal_epoch   2,  Average loss: 0.0029, Accuracy: 1853/1956 (94.7342%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: 3.7545, Accuracy: 2623/10000 (26.2300%)
___Train Local_ResNet_18,  epoch  34, local model 42, internal_epoch   1,  Average loss: 0.0248, Accuracy: 911/1372 (66.3994%)
___Train Local_ResNet_18,  epoch  34, local model 42, internal_epoch   2,  Average loss: 0.0024, Accuracy: 1306/1372 (95.1895%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: 3.8629, Accuracy: 2605/10000 (26.0500%)
___Train Local_ResNet_18,  epoch  34, local model 84, internal_epoch   1,  Average loss: 0.0284, Accuracy: 722/1190 (60.6723%)
___Train Local_ResNet_18,  epoch  34, local model 84, internal_epoch   2,  Average loss: 0.0028, Accuracy: 1132/1190 (95.1261%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: 4.2303, Accuracy: 2324/10000 (23.2400%)
time spent on training: 284.55461382865906
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 34: Average loss: 3.2756, Accuracy: 3499/10000 (34.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 34: Average loss: 0.1843, Accuracy: 9472/9950 (95.1960%)
Done in 386.3249249458313 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:35 choose agents : [17, 46, 84, 79, 36, 19, 18, 87, 63, 7]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 17, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 17, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 17, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1557/1574 (98.9199%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 17, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 17, internal_epoch   5,  Average loss: 0.0006, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 17, internal_epoch   7,  Average loss: 0.0004, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 17, internal_epoch   8,  Average loss: 0.0005, Accuracy: 1558/1574 (98.9835%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 17, internal_epoch   9,  Average loss: 0.0006, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 17, internal_epoch  10,  Average loss: 0.0005, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Global model norm: 85.9688437158704.
Norm before scaling: 85.94534907337191. Distance: 0.11523586207577953
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: 3.5501, Accuracy: 3219/10000 (32.1900%)
___Test Local_ResNet_18 poisoned: True, epoch: 35: Average loss: 0.0953, Accuracy: 9684/9950 (97.3266%)
Scaling by  100
Scaled Norm after poisoning: 84.3704396915768, distance: 11.523585142062656
Total norm for 1 adversaries is: 84.3704396915768. distance: 11.523585142062656
___Test Local_ResNet_18 poisoned: True, epoch: 35: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  35, local model 46, internal_epoch   1,  Average loss: 0.0200, Accuracy: 1360/1904 (71.4286%)
___Train Local_ResNet_18,  epoch  35, local model 46, internal_epoch   2,  Average loss: 0.0024, Accuracy: 1827/1904 (95.9559%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: 3.4876, Accuracy: 2965/10000 (29.6500%)
___Train Local_ResNet_18,  epoch  35, local model 84, internal_epoch   1,  Average loss: 0.0269, Accuracy: 732/1190 (61.5126%)
___Train Local_ResNet_18,  epoch  35, local model 84, internal_epoch   2,  Average loss: 0.0025, Accuracy: 1138/1190 (95.6303%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: 4.1165, Accuracy: 2481/10000 (24.8100%)
___Train Local_ResNet_18,  epoch  35, local model 79, internal_epoch   1,  Average loss: 0.1033, Accuracy: 21/197 (10.6599%)
___Train Local_ResNet_18,  epoch  35, local model 79, internal_epoch   2,  Average loss: 0.0467, Accuracy: 74/197 (37.5635%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: 2.6916, Accuracy: 4172/10000 (41.7200%)
___Train Local_ResNet_18,  epoch  35, local model 36, internal_epoch   1,  Average loss: 0.0649, Accuracy: 80/408 (19.6078%)
___Train Local_ResNet_18,  epoch  35, local model 36, internal_epoch   2,  Average loss: 0.0103, Accuracy: 329/408 (80.6373%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: 3.5882, Accuracy: 2988/10000 (29.8800%)
___Train Local_ResNet_18,  epoch  35, local model 19, internal_epoch   1,  Average loss: 0.0353, Accuracy: 608/1036 (58.6873%)
___Train Local_ResNet_18,  epoch  35, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 982/1036 (94.7876%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: 7.0527, Accuracy: 872/10000 (8.7200%)
___Train Local_ResNet_18,  epoch  35, local model 18, internal_epoch   1,  Average loss: 0.0595, Accuracy: 158/530 (29.8113%)
___Train Local_ResNet_18,  epoch  35, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 494/530 (93.2075%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: 5.0472, Accuracy: 1728/10000 (17.2800%)
___Train Local_ResNet_18,  epoch  35, local model 87, internal_epoch   1,  Average loss: 0.0314, Accuracy: 649/1131 (57.3828%)
___Train Local_ResNet_18,  epoch  35, local model 87, internal_epoch   2,  Average loss: 0.0037, Accuracy: 1048/1131 (92.6614%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: 4.1139, Accuracy: 2281/10000 (22.8100%)
___Train Local_ResNet_18,  epoch  35, local model 63, internal_epoch   1,  Average loss: 0.0431, Accuracy: 441/888 (49.6622%)
___Train Local_ResNet_18,  epoch  35, local model 63, internal_epoch   2,  Average loss: 0.0038, Accuracy: 833/888 (93.8063%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: 6.2127, Accuracy: 1019/10000 (10.1900%)
___Train Local_ResNet_18,  epoch  35, local model 7, internal_epoch   1,  Average loss: 0.0446, Accuracy: 411/891 (46.1279%)
___Train Local_ResNet_18,  epoch  35, local model 7, internal_epoch   2,  Average loss: 0.0046, Accuracy: 820/891 (92.0314%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: 5.4990, Accuracy: 1619/10000 (16.1900%)
time spent on training: 285.0759987831116
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 35: Average loss: 3.2814, Accuracy: 3482/10000 (34.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 35: Average loss: 0.1494, Accuracy: 9559/9950 (96.0704%)
Done in 384.39299035072327 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:36 choose agents : [17, 55, 33, 83, 35, 65, 71, 5, 98, 41]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1557/1574 (98.9199%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 17, internal_epoch   3,  Average loss: 0.0006, Accuracy: 1555/1574 (98.7929%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 17, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 17, internal_epoch   5,  Average loss: 0.0005, Accuracy: 1556/1574 (98.8564%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 17, internal_epoch   6,  Average loss: 0.0005, Accuracy: 1555/1574 (98.7929%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 17, internal_epoch   7,  Average loss: 0.0005, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 17, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 17, internal_epoch   9,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 17, internal_epoch  10,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Global model norm: 85.9440792936023.
Norm before scaling: 85.92048411085537. Distance: 0.12487321249963623
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: 3.5319, Accuracy: 3244/10000 (32.4400%)
___Test Local_ResNet_18 poisoned: True, epoch: 36: Average loss: 0.0859, Accuracy: 9713/9950 (97.6181%)
Scaling by  100
Scaled Norm after poisoning: 84.47063156894383, distance: 12.487320229092639
Total norm for 1 adversaries is: 84.47063156894383. distance: 12.487320229092639
___Test Local_ResNet_18 poisoned: True, epoch: 36: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  36, local model 55, internal_epoch   1,  Average loss: 0.0368, Accuracy: 559/1071 (52.1942%)
___Train Local_ResNet_18,  epoch  36, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 1000/1071 (93.3707%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: 4.7399, Accuracy: 1805/10000 (18.0500%)
___Train Local_ResNet_18,  epoch  36, local model 33, internal_epoch   1,  Average loss: 0.0750, Accuracy: 92/515 (17.8641%)
___Train Local_ResNet_18,  epoch  36, local model 33, internal_epoch   2,  Average loss: 0.0176, Accuracy: 415/515 (80.5825%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: 3.3998, Accuracy: 3324/10000 (33.2400%)
___Train Local_ResNet_18,  epoch  36, local model 83, internal_epoch   1,  Average loss: 0.0197, Accuracy: 1375/1953 (70.4045%)
___Train Local_ResNet_18,  epoch  36, local model 83, internal_epoch   2,  Average loss: 0.0027, Accuracy: 1867/1953 (95.5965%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: 3.1868, Accuracy: 3218/10000 (32.1800%)
___Train Local_ResNet_18,  epoch  36, local model 35, internal_epoch   1,  Average loss: 0.1026, Accuracy: 28/271 (10.3321%)
___Train Local_ResNet_18,  epoch  36, local model 35, internal_epoch   2,  Average loss: 0.0300, Accuracy: 153/271 (56.4576%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: 3.0117, Accuracy: 3725/10000 (37.2500%)
___Train Local_ResNet_18,  epoch  36, local model 65, internal_epoch   1,  Average loss: 0.0327, Accuracy: 905/1475 (61.3559%)
___Train Local_ResNet_18,  epoch  36, local model 65, internal_epoch   2,  Average loss: 0.0069, Accuracy: 1369/1475 (92.8136%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: 3.8001, Accuracy: 2761/10000 (27.6100%)
___Train Local_ResNet_18,  epoch  36, local model 71, internal_epoch   1,  Average loss: 0.0476, Accuracy: 335/818 (40.9535%)
___Train Local_ResNet_18,  epoch  36, local model 71, internal_epoch   2,  Average loss: 0.0048, Accuracy: 733/818 (89.6088%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: 4.0693, Accuracy: 2611/10000 (26.1100%)
___Train Local_ResNet_18,  epoch  36, local model 5, internal_epoch   1,  Average loss: 0.0166, Accuracy: 1260/1628 (77.3956%)
___Train Local_ResNet_18,  epoch  36, local model 5, internal_epoch   2,  Average loss: 0.0011, Accuracy: 1599/1628 (98.2187%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: 3.3300, Accuracy: 3288/10000 (32.8800%)
___Train Local_ResNet_18,  epoch  36, local model 98, internal_epoch   1,  Average loss: 0.0783, Accuracy: 65/373 (17.4263%)
___Train Local_ResNet_18,  epoch  36, local model 98, internal_epoch   2,  Average loss: 0.0174, Accuracy: 268/373 (71.8499%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: 2.8324, Accuracy: 3828/10000 (38.2800%)
___Train Local_ResNet_18,  epoch  36, local model 41, internal_epoch   1,  Average loss: 0.0601, Accuracy: 243/719 (33.7969%)
___Train Local_ResNet_18,  epoch  36, local model 41, internal_epoch   2,  Average loss: 0.0088, Accuracy: 610/719 (84.8401%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: 5.1328, Accuracy: 1523/10000 (15.2300%)
time spent on training: 285.1316661834717
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 36: Average loss: 3.2697, Accuracy: 3501/10000 (35.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 36: Average loss: 0.1328, Accuracy: 9589/9950 (96.3719%)
Done in 385.3958315849304 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:37 choose agents : [17, 11, 53, 35, 93, 1, 84, 81, 9, 12]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1555/1574 (98.7929%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 17, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 17, internal_epoch   4,  Average loss: 0.0007, Accuracy: 1557/1574 (98.9199%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 17, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 17, internal_epoch   6,  Average loss: 0.0005, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 17, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 17, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 17, internal_epoch   9,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 17, internal_epoch  10,  Average loss: 0.0003, Accuracy: 1569/1574 (99.6823%), train_poison_data_count: 500
Global model norm: 85.91910314450594.
Norm before scaling: 85.89550110090167. Distance: 0.12005056689194875
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: 3.5468, Accuracy: 3224/10000 (32.2400%)
___Test Local_ResNet_18 poisoned: True, epoch: 37: Average loss: 0.0963, Accuracy: 9685/9950 (97.3367%)
Scaling by  100
Scaled Norm after poisoning: 84.37583332921815, distance: 12.00505722292823
Total norm for 1 adversaries is: 84.37583332921815. distance: 12.00505722292823
___Test Local_ResNet_18 poisoned: True, epoch: 37: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  37, local model 11, internal_epoch   1,  Average loss: 0.0533, Accuracy: 292/712 (41.0112%)
___Train Local_ResNet_18,  epoch  37, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 654/712 (91.8539%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: 6.8108, Accuracy: 918/10000 (9.1800%)
___Train Local_ResNet_18,  epoch  37, local model 53, internal_epoch   1,  Average loss: 0.0486, Accuracy: 345/813 (42.4354%)
___Train Local_ResNet_18,  epoch  37, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 740/813 (91.0209%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: 8.6029, Accuracy: 320/10000 (3.2000%)
___Train Local_ResNet_18,  epoch  37, local model 35, internal_epoch   1,  Average loss: 0.0971, Accuracy: 40/271 (14.7601%)
___Train Local_ResNet_18,  epoch  37, local model 35, internal_epoch   2,  Average loss: 0.0298, Accuracy: 160/271 (59.0406%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: 2.8896, Accuracy: 3886/10000 (38.8600%)
___Train Local_ResNet_18,  epoch  37, local model 93, internal_epoch   1,  Average loss: 0.0235, Accuracy: 1166/1742 (66.9346%)
___Train Local_ResNet_18,  epoch  37, local model 93, internal_epoch   2,  Average loss: 0.0030, Accuracy: 1649/1742 (94.6613%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: 3.6755, Accuracy: 2809/10000 (28.0900%)
___Train Local_ResNet_18,  epoch  37, local model 1, internal_epoch   1,  Average loss: 0.0444, Accuracy: 431/928 (46.4440%)
___Train Local_ResNet_18,  epoch  37, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 861/928 (92.7802%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: 5.0841, Accuracy: 1733/10000 (17.3300%)
___Train Local_ResNet_18,  epoch  37, local model 84, internal_epoch   1,  Average loss: 0.0267, Accuracy: 763/1190 (64.1176%)
___Train Local_ResNet_18,  epoch  37, local model 84, internal_epoch   2,  Average loss: 0.0028, Accuracy: 1130/1190 (94.9580%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: 4.0682, Accuracy: 2488/10000 (24.8800%)
___Train Local_ResNet_18,  epoch  37, local model 81, internal_epoch   1,  Average loss: 0.0528, Accuracy: 295/774 (38.1137%)
___Train Local_ResNet_18,  epoch  37, local model 81, internal_epoch   2,  Average loss: 0.0059, Accuracy: 697/774 (90.0517%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: 4.7149, Accuracy: 1897/10000 (18.9700%)
___Train Local_ResNet_18,  epoch  37, local model 9, internal_epoch   1,  Average loss: 0.0320, Accuracy: 768/1275 (60.2353%)
___Train Local_ResNet_18,  epoch  37, local model 9, internal_epoch   2,  Average loss: 0.0009, Accuracy: 1253/1275 (98.2745%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: 5.6136, Accuracy: 1365/10000 (13.6500%)
___Train Local_ResNet_18,  epoch  37, local model 12, internal_epoch   1,  Average loss: 0.0761, Accuracy: 35/338 (10.3550%)
___Train Local_ResNet_18,  epoch  37, local model 12, internal_epoch   2,  Average loss: 0.0139, Accuracy: 268/338 (79.2899%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: 3.2740, Accuracy: 3404/10000 (34.0400%)
time spent on training: 280.2463481426239
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 37: Average loss: 3.2800, Accuracy: 3491/10000 (34.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 37: Average loss: 0.1527, Accuracy: 9550/9950 (95.9799%)
Done in 376.06826305389404 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:38 choose agents : [17, 81, 99, 74, 90, 85, 9, 15, 69, 78]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0003, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 17, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 17, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 17, internal_epoch   5,  Average loss: 0.0005, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 17, internal_epoch   6,  Average loss: 0.0003, Accuracy: 1567/1574 (99.5553%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 17, internal_epoch   7,  Average loss: 0.0006, Accuracy: 1557/1574 (98.9199%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 17, internal_epoch   8,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 17, internal_epoch   9,  Average loss: 0.0007, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 17, internal_epoch  10,  Average loss: 0.0005, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Global model norm: 85.89419931847843.
Norm before scaling: 85.87059611615463. Distance: 0.11826812481087243
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: 3.5331, Accuracy: 3257/10000 (32.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 38: Average loss: 0.0840, Accuracy: 9725/9950 (97.7387%)
Scaling by  100
Scaled Norm after poisoning: 84.32653121756817, distance: 11.826812308474453
Total norm for 1 adversaries is: 84.32653121756817. distance: 11.826812308474453
___Test Local_ResNet_18 poisoned: True, epoch: 38: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  38, local model 81, internal_epoch   1,  Average loss: 0.0476, Accuracy: 312/774 (40.3101%)
___Train Local_ResNet_18,  epoch  38, local model 81, internal_epoch   2,  Average loss: 0.0080, Accuracy: 686/774 (88.6305%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: 4.8672, Accuracy: 1843/10000 (18.4300%)
___Train Local_ResNet_18,  epoch  38, local model 99, internal_epoch   1,  Average loss: 0.0443, Accuracy: 344/773 (44.5019%)
___Train Local_ResNet_18,  epoch  38, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 717/773 (92.7555%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: 5.4488, Accuracy: 1399/10000 (13.9900%)
___Train Local_ResNet_18,  epoch  38, local model 74, internal_epoch   1,  Average loss: 0.0263, Accuracy: 1034/1552 (66.6237%)
___Train Local_ResNet_18,  epoch  38, local model 74, internal_epoch   2,  Average loss: 0.0030, Accuracy: 1467/1552 (94.5232%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: 5.3192, Accuracy: 1579/10000 (15.7900%)
___Train Local_ResNet_18,  epoch  38, local model 90, internal_epoch   1,  Average loss: 0.0654, Accuracy: 201/677 (29.6898%)
___Train Local_ResNet_18,  epoch  38, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 620/677 (91.5805%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: 8.8641, Accuracy: 443/10000 (4.4300%)
___Train Local_ResNet_18,  epoch  38, local model 85, internal_epoch   1,  Average loss: 0.0190, Accuracy: 1461/1988 (73.4909%)
___Train Local_ResNet_18,  epoch  38, local model 85, internal_epoch   2,  Average loss: 0.0040, Accuracy: 1880/1988 (94.5674%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: 3.3336, Accuracy: 3277/10000 (32.7700%)
___Train Local_ResNet_18,  epoch  38, local model 9, internal_epoch   1,  Average loss: 0.0293, Accuracy: 806/1275 (63.2157%)
___Train Local_ResNet_18,  epoch  38, local model 9, internal_epoch   2,  Average loss: 0.0010, Accuracy: 1249/1275 (97.9608%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: 5.2884, Accuracy: 1583/10000 (15.8300%)
___Train Local_ResNet_18,  epoch  38, local model 15, internal_epoch   1,  Average loss: 0.0342, Accuracy: 637/1154 (55.1993%)
___Train Local_ResNet_18,  epoch  38, local model 15, internal_epoch   2,  Average loss: 0.0115, Accuracy: 1097/1154 (95.0607%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: 4.8233, Accuracy: 1904/10000 (19.0400%)
___Train Local_ResNet_18,  epoch  38, local model 69, internal_epoch   1,  Average loss: 0.0660, Accuracy: 187/590 (31.6949%)
___Train Local_ResNet_18,  epoch  38, local model 69, internal_epoch   2,  Average loss: 0.0111, Accuracy: 500/590 (84.7458%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: 8.1121, Accuracy: 529/10000 (5.2900%)
___Train Local_ResNet_18,  epoch  38, local model 78, internal_epoch   1,  Average loss: 0.0678, Accuracy: 71/416 (17.0673%)
___Train Local_ResNet_18,  epoch  38, local model 78, internal_epoch   2,  Average loss: 0.0124, Accuracy: 335/416 (80.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: 3.0844, Accuracy: 3533/10000 (35.3300%)
time spent on training: 280.8683443069458
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 38: Average loss: 3.2491, Accuracy: 3523/10000 (35.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 38: Average loss: 0.1385, Accuracy: 9585/9950 (96.3317%)
Done in 394.67650723457336 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:39 choose agents : [17, 97, 12, 15, 70, 59, 58, 7, 45, 95]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  39, local model 17, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  39, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  39, local model 17, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1566/1574 (99.4917%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  39, local model 17, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1568/1574 (99.6188%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  39, local model 17, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  39, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  39, local model 17, internal_epoch   7,  Average loss: 0.0004, Accuracy: 1566/1574 (99.4917%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  39, local model 17, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  39, local model 17, internal_epoch   9,  Average loss: 0.0004, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  39, local model 17, internal_epoch  10,  Average loss: 0.0004, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Global model norm: 85.86912052289227.
Norm before scaling: 85.84551895701954. Distance: 0.12003791721019838
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 39: Average loss: 3.5133, Accuracy: 3274/10000 (32.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 39: Average loss: 0.0808, Accuracy: 9740/9950 (97.8894%)
Scaling by  100
Scaled Norm after poisoning: 84.32676283178135, distance: 12.003792481359667
Total norm for 1 adversaries is: 84.32676283178135. distance: 12.003792481359667
___Test Local_ResNet_18 poisoned: True, epoch: 39: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  39, local model 97, internal_epoch   1,  Average loss: 0.0300, Accuracy: 717/1213 (59.1096%)
___Train Local_ResNet_18,  epoch  39, local model 97, internal_epoch   2,  Average loss: 0.0036, Accuracy: 1141/1213 (94.0643%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Average loss: 4.4418, Accuracy: 2087/10000 (20.8700%)
___Train Local_ResNet_18,  epoch  39, local model 12, internal_epoch   1,  Average loss: 0.0744, Accuracy: 42/338 (12.4260%)
___Train Local_ResNet_18,  epoch  39, local model 12, internal_epoch   2,  Average loss: 0.0142, Accuracy: 276/338 (81.6568%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Average loss: 3.1731, Accuracy: 3540/10000 (35.4000%)
___Train Local_ResNet_18,  epoch  39, local model 15, internal_epoch   1,  Average loss: 0.0335, Accuracy: 648/1154 (56.1525%)
___Train Local_ResNet_18,  epoch  39, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 1080/1154 (93.5875%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Average loss: 5.5098, Accuracy: 1423/10000 (14.2300%)
___Train Local_ResNet_18,  epoch  39, local model 70, internal_epoch   1,  Average loss: 0.0249, Accuracy: 905/1418 (63.8223%)
___Train Local_ResNet_18,  epoch  39, local model 70, internal_epoch   2,  Average loss: 0.0032, Accuracy: 1340/1418 (94.4993%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Average loss: 3.6789, Accuracy: 2773/10000 (27.7300%)
___Train Local_ResNet_18,  epoch  39, local model 59, internal_epoch   1,  Average loss: 0.0352, Accuracy: 626/1089 (57.4839%)
___Train Local_ResNet_18,  epoch  39, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 1020/1089 (93.6639%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Average loss: 5.4516, Accuracy: 1828/10000 (18.2800%)
___Train Local_ResNet_18,  epoch  39, local model 58, internal_epoch   1,  Average loss: 0.0512, Accuracy: 286/803 (35.6164%)
___Train Local_ResNet_18,  epoch  39, local model 58, internal_epoch   2,  Average loss: 0.0090, Accuracy: 671/803 (83.5616%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Average loss: 4.4240, Accuracy: 2326/10000 (23.2600%)
___Train Local_ResNet_18,  epoch  39, local model 7, internal_epoch   1,  Average loss: 0.0417, Accuracy: 414/891 (46.4646%)
___Train Local_ResNet_18,  epoch  39, local model 7, internal_epoch   2,  Average loss: 0.0050, Accuracy: 816/891 (91.5825%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Average loss: 5.5578, Accuracy: 1544/10000 (15.4400%)
___Train Local_ResNet_18,  epoch  39, local model 45, internal_epoch   1,  Average loss: 0.0526, Accuracy: 226/669 (33.7818%)
___Train Local_ResNet_18,  epoch  39, local model 45, internal_epoch   2,  Average loss: 0.0083, Accuracy: 574/669 (85.7997%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Average loss: 4.4965, Accuracy: 1919/10000 (19.1900%)
___Train Local_ResNet_18,  epoch  39, local model 95, internal_epoch   1,  Average loss: 0.0732, Accuracy: 170/599 (28.3806%)
___Train Local_ResNet_18,  epoch  39, local model 95, internal_epoch   2,  Average loss: 0.0120, Accuracy: 523/599 (87.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 39: Average loss: 9.3049, Accuracy: 258/10000 (2.5800%)
time spent on training: 279.2437539100647
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 39: Average loss: 3.2319, Accuracy: 3559/10000 (35.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 39: Average loss: 0.1386, Accuracy: 9583/9950 (96.3116%)
Done in 376.24190163612366 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:40 choose agents : [17, 44, 33, 86, 16, 19, 39, 79, 65, 31]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  40, local model 17, internal_epoch   1,  Average loss: 0.0003, Accuracy: 1569/1574 (99.6823%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  40, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  40, local model 17, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1557/1574 (98.9199%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  40, local model 17, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  40, local model 17, internal_epoch   5,  Average loss: 0.0005, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  40, local model 17, internal_epoch   6,  Average loss: 0.0005, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  40, local model 17, internal_epoch   7,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  40, local model 17, internal_epoch   8,  Average loss: 0.0004, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  40, local model 17, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  40, local model 17, internal_epoch  10,  Average loss: 0.0004, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Global model norm: 85.84422210463556.
Norm before scaling: 85.82061084665938. Distance: 0.106405360047292
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 40: Average loss: 3.5533, Accuracy: 3249/10000 (32.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 40: Average loss: 0.0909, Accuracy: 9701/9950 (97.4975%)
Scaling by  100
Scaled Norm after poisoning: 84.11856866203799, distance: 10.640534656830132
Total norm for 1 adversaries is: 84.11856866203799. distance: 10.640534656830132
___Test Local_ResNet_18 poisoned: True, epoch: 40: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  40, local model 44, internal_epoch   1,  Average loss: 0.0238, Accuracy: 1143/1750 (65.3143%)
___Train Local_ResNet_18,  epoch  40, local model 44, internal_epoch   2,  Average loss: 0.0032, Accuracy: 1652/1750 (94.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Average loss: 3.2258, Accuracy: 3453/10000 (34.5300%)
___Train Local_ResNet_18,  epoch  40, local model 33, internal_epoch   1,  Average loss: 0.0677, Accuracy: 98/515 (19.0291%)
___Train Local_ResNet_18,  epoch  40, local model 33, internal_epoch   2,  Average loss: 0.0153, Accuracy: 431/515 (83.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Average loss: 3.5580, Accuracy: 3251/10000 (32.5100%)
___Train Local_ResNet_18,  epoch  40, local model 86, internal_epoch   1,  Average loss: 0.0415, Accuracy: 465/1003 (46.3609%)
___Train Local_ResNet_18,  epoch  40, local model 86, internal_epoch   2,  Average loss: 0.0052, Accuracy: 902/1003 (89.9302%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Average loss: 3.8169, Accuracy: 2726/10000 (27.2600%)
___Train Local_ResNet_18,  epoch  40, local model 16, internal_epoch   1,  Average loss: 0.0446, Accuracy: 360/708 (50.8475%)
___Train Local_ResNet_18,  epoch  40, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 656/708 (92.6554%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Average loss: 5.9362, Accuracy: 1356/10000 (13.5600%)
___Train Local_ResNet_18,  epoch  40, local model 19, internal_epoch   1,  Average loss: 0.0338, Accuracy: 608/1036 (58.6873%)
___Train Local_ResNet_18,  epoch  40, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 982/1036 (94.7876%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Average loss: 6.7588, Accuracy: 996/10000 (9.9600%)
___Train Local_ResNet_18,  epoch  40, local model 39, internal_epoch   1,  Average loss: 0.0413, Accuracy: 503/1013 (49.6545%)
___Train Local_ResNet_18,  epoch  40, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 941/1013 (92.8924%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Average loss: 5.2579, Accuracy: 1487/10000 (14.8700%)
___Train Local_ResNet_18,  epoch  40, local model 79, internal_epoch   1,  Average loss: 0.0984, Accuracy: 24/197 (12.1827%)
___Train Local_ResNet_18,  epoch  40, local model 79, internal_epoch   2,  Average loss: 0.0558, Accuracy: 82/197 (41.6244%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Average loss: 2.7521, Accuracy: 4048/10000 (40.4800%)
___Train Local_ResNet_18,  epoch  40, local model 65, internal_epoch   1,  Average loss: 0.0278, Accuracy: 942/1475 (63.8644%)
___Train Local_ResNet_18,  epoch  40, local model 65, internal_epoch   2,  Average loss: 0.0063, Accuracy: 1367/1475 (92.6780%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Average loss: 3.8873, Accuracy: 2708/10000 (27.0800%)
___Train Local_ResNet_18,  epoch  40, local model 31, internal_epoch   1,  Average loss: 0.0704, Accuracy: 73/460 (15.8696%)
___Train Local_ResNet_18,  epoch  40, local model 31, internal_epoch   2,  Average loss: 0.0082, Accuracy: 395/460 (85.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 40: Average loss: 4.3189, Accuracy: 2187/10000 (21.8700%)
time spent on training: 283.4294903278351
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 40: Average loss: 3.2915, Accuracy: 3493/10000 (34.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 40: Average loss: 0.1421, Accuracy: 9579/9950 (96.2714%)
Done in 383.9877645969391 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:41 choose agents : [17, 77, 85, 15, 94, 1, 51, 76, 88, 70]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  41, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  41, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  41, local model 17, internal_epoch   3,  Average loss: 0.0006, Accuracy: 1558/1574 (98.9835%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  41, local model 17, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1566/1574 (99.4917%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  41, local model 17, internal_epoch   5,  Average loss: 0.0005, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  41, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  41, local model 17, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  41, local model 17, internal_epoch   8,  Average loss: 0.0004, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  41, local model 17, internal_epoch   9,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  41, local model 17, internal_epoch  10,  Average loss: 0.0005, Accuracy: 1566/1574 (99.4917%), train_poison_data_count: 500
Global model norm: 85.81932499716338.
Norm before scaling: 85.79572965225309. Distance: 0.12927780644618855
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 41: Average loss: 3.4847, Accuracy: 3315/10000 (33.1500%)
___Test Local_ResNet_18 poisoned: True, epoch: 41: Average loss: 0.0909, Accuracy: 9707/9950 (97.5578%)
Scaling by  100
Scaled Norm after poisoning: 84.41263049745577, distance: 12.927780259634917
Total norm for 1 adversaries is: 84.41263049745577. distance: 12.927780259634917
___Test Local_ResNet_18 poisoned: True, epoch: 41: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  41, local model 77, internal_epoch   1,  Average loss: 0.0277, Accuracy: 843/1340 (62.9104%)
___Train Local_ResNet_18,  epoch  41, local model 77, internal_epoch   2,  Average loss: 0.0032, Accuracy: 1255/1340 (93.6567%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Average loss: 4.1483, Accuracy: 2217/10000 (22.1700%)
___Train Local_ResNet_18,  epoch  41, local model 85, internal_epoch   1,  Average loss: 0.0179, Accuracy: 1478/1988 (74.3461%)
___Train Local_ResNet_18,  epoch  41, local model 85, internal_epoch   2,  Average loss: 0.0037, Accuracy: 1859/1988 (93.5111%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Average loss: 3.2578, Accuracy: 3277/10000 (32.7700%)
___Train Local_ResNet_18,  epoch  41, local model 15, internal_epoch   1,  Average loss: 0.0307, Accuracy: 655/1154 (56.7591%)
___Train Local_ResNet_18,  epoch  41, local model 15, internal_epoch   2,  Average loss: 0.0085, Accuracy: 1093/1154 (94.7140%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Average loss: 5.2128, Accuracy: 1777/10000 (17.7700%)
___Train Local_ResNet_18,  epoch  41, local model 94, internal_epoch   1,  Average loss: 0.0223, Accuracy: 1137/1662 (68.4116%)
___Train Local_ResNet_18,  epoch  41, local model 94, internal_epoch   2,  Average loss: 0.0031, Accuracy: 1573/1662 (94.6450%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Average loss: 3.2491, Accuracy: 3277/10000 (32.7700%)
___Train Local_ResNet_18,  epoch  41, local model 1, internal_epoch   1,  Average loss: 0.0425, Accuracy: 452/928 (48.7069%)
___Train Local_ResNet_18,  epoch  41, local model 1, internal_epoch   2,  Average loss: 0.0044, Accuracy: 858/928 (92.4569%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Average loss: 4.8804, Accuracy: 1843/10000 (18.4300%)
___Train Local_ResNet_18,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0343, Accuracy: 566/1049 (53.9561%)
___Train Local_ResNet_18,  epoch  41, local model 51, internal_epoch   2,  Average loss: 0.0046, Accuracy: 965/1049 (91.9924%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Average loss: 4.1525, Accuracy: 2318/10000 (23.1800%)
___Train Local_ResNet_18,  epoch  41, local model 76, internal_epoch   1,  Average loss: 0.0673, Accuracy: 99/466 (21.2446%)
___Train Local_ResNet_18,  epoch  41, local model 76, internal_epoch   2,  Average loss: 0.0111, Accuracy: 392/466 (84.1202%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Average loss: 3.4180, Accuracy: 3085/10000 (30.8500%)
___Train Local_ResNet_18,  epoch  41, local model 88, internal_epoch   1,  Average loss: 0.0537, Accuracy: 212/603 (35.1575%)
___Train Local_ResNet_18,  epoch  41, local model 88, internal_epoch   2,  Average loss: 0.0089, Accuracy: 518/603 (85.9038%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Average loss: 4.2055, Accuracy: 2435/10000 (24.3500%)
___Train Local_ResNet_18,  epoch  41, local model 70, internal_epoch   1,  Average loss: 0.0235, Accuracy: 938/1418 (66.1495%)
___Train Local_ResNet_18,  epoch  41, local model 70, internal_epoch   2,  Average loss: 0.0034, Accuracy: 1327/1418 (93.5825%)
___Test Local_ResNet_18 poisoned: False, epoch: 41: Average loss: 3.5583, Accuracy: 2839/10000 (28.3900%)
time spent on training: 289.25615310668945
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 41: Average loss: 3.1876, Accuracy: 3595/10000 (35.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 41: Average loss: 0.1560, Accuracy: 9552/9950 (96.0000%)
Done in 383.47894167900085 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:42 choose agents : [17, 43, 46, 67, 28, 15, 57, 39, 74, 81]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  42, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  42, local model 17, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1557/1574 (98.9199%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  42, local model 17, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  42, local model 17, internal_epoch   4,  Average loss: 0.0005, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  42, local model 17, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  42, local model 17, internal_epoch   6,  Average loss: 0.0005, Accuracy: 1558/1574 (98.9835%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  42, local model 17, internal_epoch   7,  Average loss: 0.0005, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  42, local model 17, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1566/1574 (99.4917%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  42, local model 17, internal_epoch   9,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  42, local model 17, internal_epoch  10,  Average loss: 0.0005, Accuracy: 1557/1574 (98.9199%), train_poison_data_count: 500
Global model norm: 85.79418732131566.
Norm before scaling: 85.7705765217595. Distance: 0.14447294167385602
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 42: Average loss: 3.4276, Accuracy: 3375/10000 (33.7500%)
___Test Local_ResNet_18 poisoned: True, epoch: 42: Average loss: 0.0991, Accuracy: 9685/9950 (97.3367%)
Scaling by  100
Scaled Norm after poisoning: 84.62999373652198, distance: 14.447294009579052
Total norm for 1 adversaries is: 84.62999373652198. distance: 14.447294009579052
___Test Local_ResNet_18 poisoned: True, epoch: 42: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  42, local model 43, internal_epoch   1,  Average loss: 0.0421, Accuracy: 426/946 (45.0317%)
___Train Local_ResNet_18,  epoch  42, local model 43, internal_epoch   2,  Average loss: 0.0055, Accuracy: 838/946 (88.5835%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Average loss: 3.8650, Accuracy: 2719/10000 (27.1900%)
___Train Local_ResNet_18,  epoch  42, local model 46, internal_epoch   1,  Average loss: 0.0189, Accuracy: 1376/1904 (72.2689%)
___Train Local_ResNet_18,  epoch  42, local model 46, internal_epoch   2,  Average loss: 0.0025, Accuracy: 1816/1904 (95.3782%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Average loss: 3.4895, Accuracy: 2942/10000 (29.4200%)
___Train Local_ResNet_18,  epoch  42, local model 67, internal_epoch   1,  Average loss: 0.0678, Accuracy: 80/426 (18.7793%)
___Train Local_ResNet_18,  epoch  42, local model 67, internal_epoch   2,  Average loss: 0.0124, Accuracy: 341/426 (80.0469%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Average loss: 3.4625, Accuracy: 2994/10000 (29.9400%)
___Train Local_ResNet_18,  epoch  42, local model 28, internal_epoch   1,  Average loss: 0.0245, Accuracy: 1040/1581 (65.7812%)
___Train Local_ResNet_18,  epoch  42, local model 28, internal_epoch   2,  Average loss: 0.0030, Accuracy: 1500/1581 (94.8767%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Average loss: 3.5714, Accuracy: 3010/10000 (30.1000%)
___Train Local_ResNet_18,  epoch  42, local model 15, internal_epoch   1,  Average loss: 0.0327, Accuracy: 661/1154 (57.2790%)
___Train Local_ResNet_18,  epoch  42, local model 15, internal_epoch   2,  Average loss: 0.0058, Accuracy: 1055/1154 (91.4211%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Average loss: 5.9325, Accuracy: 1206/10000 (12.0600%)
___Train Local_ResNet_18,  epoch  42, local model 57, internal_epoch   1,  Average loss: 0.0428, Accuracy: 616/1154 (53.3795%)
___Train Local_ResNet_18,  epoch  42, local model 57, internal_epoch   2,  Average loss: 0.0085, Accuracy: 1025/1154 (88.8215%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Average loss: 5.7065, Accuracy: 1334/10000 (13.3400%)
___Train Local_ResNet_18,  epoch  42, local model 39, internal_epoch   1,  Average loss: 0.0395, Accuracy: 500/1013 (49.3583%)
___Train Local_ResNet_18,  epoch  42, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 945/1013 (93.2873%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Average loss: 5.1987, Accuracy: 1542/10000 (15.4200%)
___Train Local_ResNet_18,  epoch  42, local model 74, internal_epoch   1,  Average loss: 0.0239, Accuracy: 1038/1552 (66.8814%)
___Train Local_ResNet_18,  epoch  42, local model 74, internal_epoch   2,  Average loss: 0.0025, Accuracy: 1476/1552 (95.1031%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Average loss: 5.4056, Accuracy: 1491/10000 (14.9100%)
___Train Local_ResNet_18,  epoch  42, local model 81, internal_epoch   1,  Average loss: 0.0468, Accuracy: 318/774 (41.0853%)
___Train Local_ResNet_18,  epoch  42, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 690/774 (89.1473%)
___Test Local_ResNet_18 poisoned: False, epoch: 42: Average loss: 4.8271, Accuracy: 1753/10000 (17.5300%)
time spent on training: 283.68135118484497
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 42: Average loss: 3.1490, Accuracy: 3636/10000 (36.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 42: Average loss: 0.1608, Accuracy: 9539/9950 (95.8693%)
Done in 384.9736957550049 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:43 choose agents : [17, 63, 10, 27, 19, 15, 46, 47, 9, 62]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  43, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  43, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1557/1574 (98.9199%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  43, local model 17, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  43, local model 17, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  43, local model 17, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  43, local model 17, internal_epoch   6,  Average loss: 0.0005, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  43, local model 17, internal_epoch   7,  Average loss: 0.0005, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  43, local model 17, internal_epoch   8,  Average loss: 0.0005, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  43, local model 17, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  43, local model 17, internal_epoch  10,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Global model norm: 85.76900527361268.
Norm before scaling: 85.74543024904447. Distance: 0.13385485681091194
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 43: Average loss: 3.4079, Accuracy: 3364/10000 (33.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 43: Average loss: 0.0958, Accuracy: 9698/9950 (97.4673%)
Scaling by  100
Scaled Norm after poisoning: 84.43581431052377, distance: 13.385483100617401
Total norm for 1 adversaries is: 84.43581431052377. distance: 13.385483100617401
___Test Local_ResNet_18 poisoned: True, epoch: 43: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  43, local model 63, internal_epoch   1,  Average loss: 0.0413, Accuracy: 444/888 (50.0000%)
___Train Local_ResNet_18,  epoch  43, local model 63, internal_epoch   2,  Average loss: 0.0033, Accuracy: 830/888 (93.4685%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Average loss: 5.8591, Accuracy: 1153/10000 (11.5300%)
___Train Local_ResNet_18,  epoch  43, local model 10, internal_epoch   1,  Average loss: 0.0390, Accuracy: 412/861 (47.8513%)
___Train Local_ResNet_18,  epoch  43, local model 10, internal_epoch   2,  Average loss: 0.0017, Accuracy: 839/861 (97.4448%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Average loss: 5.2629, Accuracy: 1782/10000 (17.8200%)
___Train Local_ResNet_18,  epoch  43, local model 27, internal_epoch   1,  Average loss: 0.0262, Accuracy: 991/1587 (62.4449%)
___Train Local_ResNet_18,  epoch  43, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 1460/1587 (91.9975%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Average loss: 3.5451, Accuracy: 2993/10000 (29.9300%)
___Train Local_ResNet_18,  epoch  43, local model 19, internal_epoch   1,  Average loss: 0.0323, Accuracy: 634/1036 (61.1969%)
___Train Local_ResNet_18,  epoch  43, local model 19, internal_epoch   2,  Average loss: 0.0036, Accuracy: 977/1036 (94.3050%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Average loss: 6.4197, Accuracy: 1074/10000 (10.7400%)
___Train Local_ResNet_18,  epoch  43, local model 15, internal_epoch   1,  Average loss: 0.0292, Accuracy: 687/1154 (59.5321%)
___Train Local_ResNet_18,  epoch  43, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 1097/1154 (95.0607%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Average loss: 4.8093, Accuracy: 1944/10000 (19.4400%)
___Train Local_ResNet_18,  epoch  43, local model 46, internal_epoch   1,  Average loss: 0.0185, Accuracy: 1375/1904 (72.2164%)
___Train Local_ResNet_18,  epoch  43, local model 46, internal_epoch   2,  Average loss: 0.0022, Accuracy: 1822/1904 (95.6933%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Average loss: 3.5842, Accuracy: 2824/10000 (28.2400%)
___Train Local_ResNet_18,  epoch  43, local model 47, internal_epoch   1,  Average loss: 0.1050, Accuracy: 23/134 (17.1642%)
___Train Local_ResNet_18,  epoch  43, local model 47, internal_epoch   2,  Average loss: 0.0671, Accuracy: 49/134 (36.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Average loss: 2.7378, Accuracy: 4121/10000 (41.2100%)
___Train Local_ResNet_18,  epoch  43, local model 9, internal_epoch   1,  Average loss: 0.0266, Accuracy: 819/1275 (64.2353%)
___Train Local_ResNet_18,  epoch  43, local model 9, internal_epoch   2,  Average loss: 0.0011, Accuracy: 1253/1275 (98.2745%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Average loss: 5.3518, Accuracy: 1491/10000 (14.9100%)
___Train Local_ResNet_18,  epoch  43, local model 62, internal_epoch   1,  Average loss: 0.0561, Accuracy: 173/568 (30.4577%)
___Train Local_ResNet_18,  epoch  43, local model 62, internal_epoch   2,  Average loss: 0.0074, Accuracy: 494/568 (86.9718%)
___Test Local_ResNet_18 poisoned: False, epoch: 43: Average loss: 4.5649, Accuracy: 2134/10000 (21.3400%)
time spent on training: 283.02135705947876
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 43: Average loss: 3.1611, Accuracy: 3595/10000 (35.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 43: Average loss: 0.1454, Accuracy: 9584/9950 (96.3216%)
Done in 384.3245222568512 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:44 choose agents : [17, 14, 44, 87, 57, 98, 39, 9, 64, 33]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  44, local model 17, internal_epoch   1,  Average loss: 0.0003, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  44, local model 17, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  44, local model 17, internal_epoch   3,  Average loss: 0.0008, Accuracy: 1557/1574 (98.9199%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  44, local model 17, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  44, local model 17, internal_epoch   5,  Average loss: 0.0003, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  44, local model 17, internal_epoch   6,  Average loss: 0.0003, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  44, local model 17, internal_epoch   7,  Average loss: 0.0004, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  44, local model 17, internal_epoch   8,  Average loss: 0.0005, Accuracy: 1553/1574 (98.6658%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  44, local model 17, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  44, local model 17, internal_epoch  10,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Global model norm: 85.74405500528886.
Norm before scaling: 85.72045318213151. Distance: 0.11465826528560669
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 44: Average loss: 3.4173, Accuracy: 3384/10000 (33.8400%)
___Test Local_ResNet_18 poisoned: True, epoch: 44: Average loss: 0.0918, Accuracy: 9701/9950 (97.4975%)
Scaling by  100
Scaled Norm after poisoning: 84.12717075579684, distance: 11.465826592241807
Total norm for 1 adversaries is: 84.12717075579684. distance: 11.465826592241807
___Test Local_ResNet_18 poisoned: True, epoch: 44: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  44, local model 14, internal_epoch   1,  Average loss: 0.0325, Accuracy: 561/1013 (55.3801%)
___Train Local_ResNet_18,  epoch  44, local model 14, internal_epoch   2,  Average loss: 0.0037, Accuracy: 947/1013 (93.4847%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Average loss: 3.7316, Accuracy: 2829/10000 (28.2900%)
___Train Local_ResNet_18,  epoch  44, local model 44, internal_epoch   1,  Average loss: 0.0238, Accuracy: 1139/1750 (65.0857%)
___Train Local_ResNet_18,  epoch  44, local model 44, internal_epoch   2,  Average loss: 0.0032, Accuracy: 1648/1750 (94.1714%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Average loss: 3.2128, Accuracy: 3425/10000 (34.2500%)
___Train Local_ResNet_18,  epoch  44, local model 87, internal_epoch   1,  Average loss: 0.0302, Accuracy: 650/1131 (57.4713%)
___Train Local_ResNet_18,  epoch  44, local model 87, internal_epoch   2,  Average loss: 0.0037, Accuracy: 1048/1131 (92.6614%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Average loss: 4.1520, Accuracy: 2209/10000 (22.0900%)
___Train Local_ResNet_18,  epoch  44, local model 57, internal_epoch   1,  Average loss: 0.0383, Accuracy: 591/1154 (51.2132%)
___Train Local_ResNet_18,  epoch  44, local model 57, internal_epoch   2,  Average loss: 0.0085, Accuracy: 1043/1154 (90.3813%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Average loss: 5.2307, Accuracy: 1722/10000 (17.2200%)
___Train Local_ResNet_18,  epoch  44, local model 98, internal_epoch   1,  Average loss: 0.0711, Accuracy: 69/373 (18.4987%)
___Train Local_ResNet_18,  epoch  44, local model 98, internal_epoch   2,  Average loss: 0.0166, Accuracy: 277/373 (74.2627%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Average loss: 2.8166, Accuracy: 3826/10000 (38.2600%)
___Train Local_ResNet_18,  epoch  44, local model 39, internal_epoch   1,  Average loss: 0.0379, Accuracy: 516/1013 (50.9378%)
___Train Local_ResNet_18,  epoch  44, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 944/1013 (93.1885%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Average loss: 4.9787, Accuracy: 1670/10000 (16.7000%)
___Train Local_ResNet_18,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0265, Accuracy: 813/1275 (63.7647%)
___Train Local_ResNet_18,  epoch  44, local model 9, internal_epoch   2,  Average loss: 0.0012, Accuracy: 1251/1275 (98.1176%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Average loss: 5.4747, Accuracy: 1432/10000 (14.3200%)
___Train Local_ResNet_18,  epoch  44, local model 64, internal_epoch   1,  Average loss: 0.0347, Accuracy: 482/953 (50.5771%)
___Train Local_ResNet_18,  epoch  44, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 847/953 (88.8772%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Average loss: 3.9626, Accuracy: 2519/10000 (25.1900%)
___Train Local_ResNet_18,  epoch  44, local model 33, internal_epoch   1,  Average loss: 0.0655, Accuracy: 110/515 (21.3592%)
___Train Local_ResNet_18,  epoch  44, local model 33, internal_epoch   2,  Average loss: 0.0155, Accuracy: 433/515 (84.0777%)
___Test Local_ResNet_18 poisoned: False, epoch: 44: Average loss: 3.4264, Accuracy: 3404/10000 (34.0400%)
time spent on training: 286.4559967517853
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 44: Average loss: 3.1512, Accuracy: 3628/10000 (36.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 44: Average loss: 0.1463, Accuracy: 9581/9950 (96.2915%)
Done in 388.1121747493744 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:45 choose agents : [17, 95, 39, 96, 31, 66, 92, 30, 72, 5]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  45, local model 17, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  45, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  45, local model 17, internal_epoch   3,  Average loss: 0.0006, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  45, local model 17, internal_epoch   4,  Average loss: 0.0005, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  45, local model 17, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  45, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  45, local model 17, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  45, local model 17, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1566/1574 (99.4917%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  45, local model 17, internal_epoch   9,  Average loss: 0.0005, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  45, local model 17, internal_epoch  10,  Average loss: 0.0004, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Global model norm: 85.71910317098225.
Norm before scaling: 85.69551726716807. Distance: 0.11878748054416927
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 45: Average loss: 3.4673, Accuracy: 3322/10000 (33.2200%)
___Test Local_ResNet_18 poisoned: True, epoch: 45: Average loss: 0.0959, Accuracy: 9697/9950 (97.4573%)
Scaling by  100
Scaled Norm after poisoning: 84.16105978642973, distance: 11.8787476097184
Total norm for 1 adversaries is: 84.16105978642973. distance: 11.8787476097184
___Test Local_ResNet_18 poisoned: True, epoch: 45: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  45, local model 95, internal_epoch   1,  Average loss: 0.0687, Accuracy: 176/599 (29.3823%)
___Train Local_ResNet_18,  epoch  45, local model 95, internal_epoch   2,  Average loss: 0.0148, Accuracy: 524/599 (87.4791%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Average loss: 10.0082, Accuracy: 180/10000 (1.8000%)
___Train Local_ResNet_18,  epoch  45, local model 39, internal_epoch   1,  Average loss: 0.0368, Accuracy: 524/1013 (51.7275%)
___Train Local_ResNet_18,  epoch  45, local model 39, internal_epoch   2,  Average loss: 0.0033, Accuracy: 955/1013 (94.2744%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Average loss: 5.0094, Accuracy: 1650/10000 (16.5000%)
___Train Local_ResNet_18,  epoch  45, local model 96, internal_epoch   1,  Average loss: 0.0744, Accuracy: 58/311 (18.6495%)
___Train Local_ResNet_18,  epoch  45, local model 96, internal_epoch   2,  Average loss: 0.0268, Accuracy: 184/311 (59.1640%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Average loss: 2.5897, Accuracy: 4175/10000 (41.7500%)
___Train Local_ResNet_18,  epoch  45, local model 31, internal_epoch   1,  Average loss: 0.0666, Accuracy: 84/460 (18.2609%)
___Train Local_ResNet_18,  epoch  45, local model 31, internal_epoch   2,  Average loss: 0.0089, Accuracy: 402/460 (87.3913%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Average loss: 4.2807, Accuracy: 2166/10000 (21.6600%)
___Train Local_ResNet_18,  epoch  45, local model 66, internal_epoch   1,  Average loss: 0.0241, Accuracy: 867/1402 (61.8402%)
___Train Local_ResNet_18,  epoch  45, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 1292/1402 (92.1541%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Average loss: 3.2573, Accuracy: 3196/10000 (31.9600%)
___Train Local_ResNet_18,  epoch  45, local model 92, internal_epoch   1,  Average loss: 0.0243, Accuracy: 1117/1715 (65.1312%)
___Train Local_ResNet_18,  epoch  45, local model 92, internal_epoch   2,  Average loss: 0.0032, Accuracy: 1605/1715 (93.5860%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Average loss: 3.9871, Accuracy: 2581/10000 (25.8100%)
___Train Local_ResNet_18,  epoch  45, local model 30, internal_epoch   1,  Average loss: 0.0603, Accuracy: 118/486 (24.2798%)
___Train Local_ResNet_18,  epoch  45, local model 30, internal_epoch   2,  Average loss: 0.0063, Accuracy: 447/486 (91.9753%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Average loss: 4.0146, Accuracy: 2708/10000 (27.0800%)
___Train Local_ResNet_18,  epoch  45, local model 72, internal_epoch   1,  Average loss: 0.0347, Accuracy: 669/1241 (53.9081%)
___Train Local_ResNet_18,  epoch  45, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 1108/1241 (89.2828%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Average loss: 3.6644, Accuracy: 2883/10000 (28.8300%)
___Train Local_ResNet_18,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0163, Accuracy: 1266/1628 (77.7641%)
___Train Local_ResNet_18,  epoch  45, local model 5, internal_epoch   2,  Average loss: 0.0013, Accuracy: 1597/1628 (98.0958%)
___Test Local_ResNet_18 poisoned: False, epoch: 45: Average loss: 3.4355, Accuracy: 3115/10000 (31.1500%)
time spent on training: 297.65241622924805
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 45: Average loss: 3.2141, Accuracy: 3558/10000 (35.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 45: Average loss: 0.1446, Accuracy: 9587/9950 (96.3518%)
Done in 396.95466566085815 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:46 choose agents : [17, 59, 3, 47, 87, 91, 38, 79, 42, 90]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  46, local model 17, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  46, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  46, local model 17, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  46, local model 17, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  46, local model 17, internal_epoch   5,  Average loss: 0.0007, Accuracy: 1558/1574 (98.9835%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  46, local model 17, internal_epoch   6,  Average loss: 0.0003, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  46, local model 17, internal_epoch   7,  Average loss: 0.0004, Accuracy: 1566/1574 (99.4917%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  46, local model 17, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1568/1574 (99.6188%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  46, local model 17, internal_epoch   9,  Average loss: 0.0004, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  46, local model 17, internal_epoch  10,  Average loss: 0.0005, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Global model norm: 85.69421814473542.
Norm before scaling: 85.6706567371889. Distance: 0.13616245034716923
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 46: Average loss: 3.4421, Accuracy: 3347/10000 (33.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 46: Average loss: 0.0984, Accuracy: 9687/9950 (97.3568%)
Scaling by  100
Scaled Norm after poisoning: 84.39978224016636, distance: 13.616243961143432
Total norm for 1 adversaries is: 84.39978224016636. distance: 13.616243961143432
___Test Local_ResNet_18 poisoned: True, epoch: 46: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  46, local model 59, internal_epoch   1,  Average loss: 0.0330, Accuracy: 648/1089 (59.5041%)
___Train Local_ResNet_18,  epoch  46, local model 59, internal_epoch   2,  Average loss: 0.0118, Accuracy: 1027/1089 (94.3067%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Average loss: 5.4054, Accuracy: 1830/10000 (18.3000%)
___Train Local_ResNet_18,  epoch  46, local model 3, internal_epoch   1,  Average loss: 0.0424, Accuracy: 336/781 (43.0218%)
___Train Local_ResNet_18,  epoch  46, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 740/781 (94.7503%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Average loss: 3.4210, Accuracy: 3184/10000 (31.8400%)
___Train Local_ResNet_18,  epoch  46, local model 47, internal_epoch   1,  Average loss: 0.1066, Accuracy: 21/134 (15.6716%)
___Train Local_ResNet_18,  epoch  46, local model 47, internal_epoch   2,  Average loss: 0.0653, Accuracy: 43/134 (32.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Average loss: 2.6839, Accuracy: 4168/10000 (41.6800%)
___Train Local_ResNet_18,  epoch  46, local model 87, internal_epoch   1,  Average loss: 0.0290, Accuracy: 665/1131 (58.7975%)
___Train Local_ResNet_18,  epoch  46, local model 87, internal_epoch   2,  Average loss: 0.0031, Accuracy: 1056/1131 (93.3687%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Average loss: 4.1980, Accuracy: 2135/10000 (21.3500%)
___Train Local_ResNet_18,  epoch  46, local model 91, internal_epoch   1,  Average loss: 0.0377, Accuracy: 575/1030 (55.8252%)
___Train Local_ResNet_18,  epoch  46, local model 91, internal_epoch   2,  Average loss: 0.0039, Accuracy: 958/1030 (93.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Average loss: 4.7622, Accuracy: 1987/10000 (19.8700%)
___Train Local_ResNet_18,  epoch  46, local model 38, internal_epoch   1,  Average loss: 0.0232, Accuracy: 758/1131 (67.0203%)
___Train Local_ResNet_18,  epoch  46, local model 38, internal_epoch   2,  Average loss: 0.0022, Accuracy: 1090/1131 (96.3749%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Average loss: 3.9393, Accuracy: 2515/10000 (25.1500%)
___Train Local_ResNet_18,  epoch  46, local model 79, internal_epoch   1,  Average loss: 0.0951, Accuracy: 29/197 (14.7208%)
___Train Local_ResNet_18,  epoch  46, local model 79, internal_epoch   2,  Average loss: 0.0446, Accuracy: 93/197 (47.2081%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Average loss: 2.5690, Accuracy: 4311/10000 (43.1100%)
___Train Local_ResNet_18,  epoch  46, local model 42, internal_epoch   1,  Average loss: 0.0219, Accuracy: 931/1372 (67.8571%)
___Train Local_ResNet_18,  epoch  46, local model 42, internal_epoch   2,  Average loss: 0.0026, Accuracy: 1303/1372 (94.9708%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Average loss: 3.7458, Accuracy: 2714/10000 (27.1400%)
___Train Local_ResNet_18,  epoch  46, local model 90, internal_epoch   1,  Average loss: 0.0617, Accuracy: 229/677 (33.8257%)
___Train Local_ResNet_18,  epoch  46, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 624/677 (92.1713%)
___Test Local_ResNet_18 poisoned: False, epoch: 46: Average loss: 8.6260, Accuracy: 462/10000 (4.6200%)
time spent on training: 279.0446400642395
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 46: Average loss: 3.1984, Accuracy: 3586/10000 (35.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 46: Average loss: 0.1413, Accuracy: 9594/9950 (96.4221%)
Done in 381.28080201148987 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:47 choose agents : [17, 20, 71, 46, 7, 15, 60, 49, 0, 61]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  47, local model 17, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  47, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  47, local model 17, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  47, local model 17, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  47, local model 17, internal_epoch   5,  Average loss: 0.0005, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  47, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  47, local model 17, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  47, local model 17, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  47, local model 17, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1566/1574 (99.4917%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  47, local model 17, internal_epoch  10,  Average loss: 0.0004, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Global model norm: 85.66953962483544.
Norm before scaling: 85.64588591075172. Distance: 0.10941135704811357
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 47: Average loss: 3.4725, Accuracy: 3311/10000 (33.1100%)
___Test Local_ResNet_18 poisoned: True, epoch: 47: Average loss: 0.1022, Accuracy: 9687/9950 (97.3568%)
Scaling by  100
Scaled Norm after poisoning: 83.9794577048831, distance: 10.941135695958753
Total norm for 1 adversaries is: 83.9794577048831. distance: 10.941135695958753
___Test Local_ResNet_18 poisoned: True, epoch: 47: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  47, local model 20, internal_epoch   1,  Average loss: 0.0441, Accuracy: 364/807 (45.1053%)
___Train Local_ResNet_18,  epoch  47, local model 20, internal_epoch   2,  Average loss: 0.0056, Accuracy: 729/807 (90.3346%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Average loss: 4.6699, Accuracy: 1697/10000 (16.9700%)
___Train Local_ResNet_18,  epoch  47, local model 71, internal_epoch   1,  Average loss: 0.0419, Accuracy: 360/818 (44.0098%)
___Train Local_ResNet_18,  epoch  47, local model 71, internal_epoch   2,  Average loss: 0.0051, Accuracy: 740/818 (90.4645%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Average loss: 4.0492, Accuracy: 2596/10000 (25.9600%)
___Train Local_ResNet_18,  epoch  47, local model 46, internal_epoch   1,  Average loss: 0.0182, Accuracy: 1380/1904 (72.4790%)
___Train Local_ResNet_18,  epoch  47, local model 46, internal_epoch   2,  Average loss: 0.0021, Accuracy: 1825/1904 (95.8508%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Average loss: 3.4661, Accuracy: 2952/10000 (29.5200%)
___Train Local_ResNet_18,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0386, Accuracy: 455/891 (51.0662%)
___Train Local_ResNet_18,  epoch  47, local model 7, internal_epoch   2,  Average loss: 0.0045, Accuracy: 829/891 (93.0415%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Average loss: 5.6413, Accuracy: 1470/10000 (14.7000%)
___Train Local_ResNet_18,  epoch  47, local model 15, internal_epoch   1,  Average loss: 0.0331, Accuracy: 679/1154 (58.8388%)
___Train Local_ResNet_18,  epoch  47, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 1079/1154 (93.5009%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Average loss: 5.6078, Accuracy: 1288/10000 (12.8800%)
___Train Local_ResNet_18,  epoch  47, local model 60, internal_epoch   1,  Average loss: 0.0198, Accuracy: 1600/2227 (71.8455%)
___Train Local_ResNet_18,  epoch  47, local model 60, internal_epoch   2,  Average loss: 0.0029, Accuracy: 2104/2227 (94.4769%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Average loss: 3.6352, Accuracy: 2850/10000 (28.5000%)
___Train Local_ResNet_18,  epoch  47, local model 49, internal_epoch   1,  Average loss: 0.0635, Accuracy: 89/440 (20.2273%)
___Train Local_ResNet_18,  epoch  47, local model 49, internal_epoch   2,  Average loss: 0.0133, Accuracy: 349/440 (79.3182%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Average loss: 3.0831, Accuracy: 3668/10000 (36.6800%)
___Train Local_ResNet_18,  epoch  47, local model 0, internal_epoch   1,  Average loss: 0.0328, Accuracy: 877/1657 (52.9270%)
___Train Local_ResNet_18,  epoch  47, local model 0, internal_epoch   2,  Average loss: 0.0063, Accuracy: 1456/1657 (87.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Average loss: 3.6381, Accuracy: 2798/10000 (27.9800%)
___Train Local_ResNet_18,  epoch  47, local model 61, internal_epoch   1,  Average loss: 0.1319, Accuracy: 7/85 (8.2353%)
___Train Local_ResNet_18,  epoch  47, local model 61, internal_epoch   2,  Average loss: 0.1060, Accuracy: 12/85 (14.1176%)
___Test Local_ResNet_18 poisoned: False, epoch: 47: Average loss: 2.8536, Accuracy: 3952/10000 (39.5200%)
time spent on training: 288.311160326004
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 47: Average loss: 3.2118, Accuracy: 3551/10000 (35.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 47: Average loss: 0.1559, Accuracy: 9566/9950 (96.1407%)
Done in 404.26558351516724 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:48 choose agents : [17, 48, 74, 9, 51, 22, 19, 65, 12, 98]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  48, local model 17, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  48, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1560/1574 (99.1105%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  48, local model 17, internal_epoch   3,  Average loss: 0.0003, Accuracy: 1567/1574 (99.5553%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  48, local model 17, internal_epoch   4,  Average loss: 0.0005, Accuracy: 1567/1574 (99.5553%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  48, local model 17, internal_epoch   5,  Average loss: 0.0003, Accuracy: 1568/1574 (99.6188%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  48, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  48, local model 17, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  48, local model 17, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  48, local model 17, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  48, local model 17, internal_epoch  10,  Average loss: 0.0004, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Global model norm: 85.6444606078671.
Norm before scaling: 85.62087695365248. Distance: 0.10958959610373445
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 48: Average loss: 3.4461, Accuracy: 3356/10000 (33.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 48: Average loss: 0.0824, Accuracy: 9735/9950 (97.8392%)
Scaling by  100
Scaled Norm after poisoning: 83.96408039676848, distance: 10.958960182817265
Total norm for 1 adversaries is: 83.96408039676848. distance: 10.958960182817265
___Test Local_ResNet_18 poisoned: True, epoch: 48: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  48, local model 48, internal_epoch   1,  Average loss: 0.0549, Accuracy: 181/631 (28.6846%)
___Train Local_ResNet_18,  epoch  48, local model 48, internal_epoch   2,  Average loss: 0.0099, Accuracy: 525/631 (83.2013%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Average loss: 3.2062, Accuracy: 3300/10000 (33.0000%)
___Train Local_ResNet_18,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0234, Accuracy: 1049/1552 (67.5902%)
___Train Local_ResNet_18,  epoch  48, local model 74, internal_epoch   2,  Average loss: 0.0024, Accuracy: 1477/1552 (95.1675%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Average loss: 5.2563, Accuracy: 1546/10000 (15.4600%)
___Train Local_ResNet_18,  epoch  48, local model 9, internal_epoch   1,  Average loss: 0.0255, Accuracy: 857/1275 (67.2157%)
___Train Local_ResNet_18,  epoch  48, local model 9, internal_epoch   2,  Average loss: 0.0010, Accuracy: 1249/1275 (97.9608%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Average loss: 4.9564, Accuracy: 1722/10000 (17.2200%)
___Train Local_ResNet_18,  epoch  48, local model 51, internal_epoch   1,  Average loss: 0.0324, Accuracy: 574/1049 (54.7188%)
___Train Local_ResNet_18,  epoch  48, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 977/1049 (93.1363%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Average loss: 4.1284, Accuracy: 2390/10000 (23.9000%)
___Train Local_ResNet_18,  epoch  48, local model 22, internal_epoch   1,  Average loss: 0.0238, Accuracy: 1013/1470 (68.9116%)
___Train Local_ResNet_18,  epoch  48, local model 22, internal_epoch   2,  Average loss: 0.0022, Accuracy: 1408/1470 (95.7823%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Average loss: 4.2795, Accuracy: 2171/10000 (21.7100%)
___Train Local_ResNet_18,  epoch  48, local model 19, internal_epoch   1,  Average loss: 0.0304, Accuracy: 633/1036 (61.1004%)
___Train Local_ResNet_18,  epoch  48, local model 19, internal_epoch   2,  Average loss: 0.0039, Accuracy: 975/1036 (94.1120%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Average loss: 6.0638, Accuracy: 1251/10000 (12.5100%)
___Train Local_ResNet_18,  epoch  48, local model 65, internal_epoch   1,  Average loss: 0.0262, Accuracy: 968/1475 (65.6271%)
___Train Local_ResNet_18,  epoch  48, local model 65, internal_epoch   2,  Average loss: 0.0039, Accuracy: 1381/1475 (93.6271%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Average loss: 3.7789, Accuracy: 2850/10000 (28.5000%)
___Train Local_ResNet_18,  epoch  48, local model 12, internal_epoch   1,  Average loss: 0.0692, Accuracy: 49/338 (14.4970%)
___Train Local_ResNet_18,  epoch  48, local model 12, internal_epoch   2,  Average loss: 0.0130, Accuracy: 272/338 (80.4734%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Average loss: 3.1933, Accuracy: 3426/10000 (34.2600%)
___Train Local_ResNet_18,  epoch  48, local model 98, internal_epoch   1,  Average loss: 0.0694, Accuracy: 77/373 (20.6434%)
___Train Local_ResNet_18,  epoch  48, local model 98, internal_epoch   2,  Average loss: 0.0156, Accuracy: 276/373 (73.9946%)
___Test Local_ResNet_18 poisoned: False, epoch: 48: Average loss: 2.7587, Accuracy: 3842/10000 (38.4200%)
time spent on training: 287.2879629135132
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 48: Average loss: 3.1870, Accuracy: 3598/10000 (35.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 48: Average loss: 0.1287, Accuracy: 9623/9950 (96.7136%)
Done in 390.1459240913391 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:49 choose agents : [17, 2, 57, 71, 98, 59, 93, 30, 16, 9]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  49, local model 17, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1566/1574 (99.4917%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  49, local model 17, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1567/1574 (99.5553%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  49, local model 17, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  49, local model 17, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  49, local model 17, internal_epoch   5,  Average loss: 0.0005, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  49, local model 17, internal_epoch   6,  Average loss: 0.0005, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  49, local model 17, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  49, local model 17, internal_epoch   8,  Average loss: 0.0004, Accuracy: 1562/1574 (99.2376%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  49, local model 17, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1566/1574 (99.4917%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  49, local model 17, internal_epoch  10,  Average loss: 0.0003, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Global model norm: 85.61954818410338.
Norm before scaling: 85.59591203001462. Distance: 0.12384435535285847
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 49: Average loss: 3.4791, Accuracy: 3336/10000 (33.3600%)
___Test Local_ResNet_18 poisoned: True, epoch: 49: Average loss: 0.0970, Accuracy: 9689/9950 (97.3769%)
Scaling by  100
Scaled Norm after poisoning: 84.13019753167556, distance: 12.384434658140751
Total norm for 1 adversaries is: 84.13019753167556. distance: 12.384434658140751
___Test Local_ResNet_18 poisoned: True, epoch: 49: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  49, local model 2, internal_epoch   1,  Average loss: 0.0555, Accuracy: 182/605 (30.0826%)
___Train Local_ResNet_18,  epoch  49, local model 2, internal_epoch   2,  Average loss: 0.0064, Accuracy: 542/605 (89.5868%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Average loss: 5.1814, Accuracy: 1628/10000 (16.2800%)
___Train Local_ResNet_18,  epoch  49, local model 57, internal_epoch   1,  Average loss: 0.0337, Accuracy: 630/1154 (54.5927%)
___Train Local_ResNet_18,  epoch  49, local model 57, internal_epoch   2,  Average loss: 0.0084, Accuracy: 1077/1154 (93.3276%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Average loss: 4.9592, Accuracy: 1913/10000 (19.1300%)
___Train Local_ResNet_18,  epoch  49, local model 71, internal_epoch   1,  Average loss: 0.0407, Accuracy: 356/818 (43.5208%)
___Train Local_ResNet_18,  epoch  49, local model 71, internal_epoch   2,  Average loss: 0.0047, Accuracy: 741/818 (90.5868%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Average loss: 3.9269, Accuracy: 2663/10000 (26.6300%)
___Train Local_ResNet_18,  epoch  49, local model 98, internal_epoch   1,  Average loss: 0.0677, Accuracy: 77/373 (20.6434%)
___Train Local_ResNet_18,  epoch  49, local model 98, internal_epoch   2,  Average loss: 0.0159, Accuracy: 286/373 (76.6756%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Average loss: 2.7747, Accuracy: 3867/10000 (38.6700%)
___Train Local_ResNet_18,  epoch  49, local model 59, internal_epoch   1,  Average loss: 0.0328, Accuracy: 642/1089 (58.9532%)
___Train Local_ResNet_18,  epoch  49, local model 59, internal_epoch   2,  Average loss: 0.0068, Accuracy: 1017/1089 (93.3884%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Average loss: 5.2655, Accuracy: 1834/10000 (18.3400%)
___Train Local_ResNet_18,  epoch  49, local model 93, internal_epoch   1,  Average loss: 0.0222, Accuracy: 1201/1742 (68.9437%)
___Train Local_ResNet_18,  epoch  49, local model 93, internal_epoch   2,  Average loss: 0.0025, Accuracy: 1662/1742 (95.4076%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Average loss: 3.5207, Accuracy: 2904/10000 (29.0400%)
___Train Local_ResNet_18,  epoch  49, local model 30, internal_epoch   1,  Average loss: 0.0569, Accuracy: 142/486 (29.2181%)
___Train Local_ResNet_18,  epoch  49, local model 30, internal_epoch   2,  Average loss: 0.0065, Accuracy: 442/486 (90.9465%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Average loss: 3.9641, Accuracy: 2741/10000 (27.4100%)
___Train Local_ResNet_18,  epoch  49, local model 16, internal_epoch   1,  Average loss: 0.0402, Accuracy: 373/708 (52.6836%)
___Train Local_ResNet_18,  epoch  49, local model 16, internal_epoch   2,  Average loss: 0.0131, Accuracy: 647/708 (91.3842%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Average loss: 5.5465, Accuracy: 1539/10000 (15.3900%)
___Train Local_ResNet_18,  epoch  49, local model 9, internal_epoch   1,  Average loss: 0.0256, Accuracy: 835/1275 (65.4902%)
___Train Local_ResNet_18,  epoch  49, local model 9, internal_epoch   2,  Average loss: 0.0010, Accuracy: 1255/1275 (98.4314%)
___Test Local_ResNet_18 poisoned: False, epoch: 49: Average loss: 5.2842, Accuracy: 1513/10000 (15.1300%)
time spent on training: 282.6569001674652
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 49: Average loss: 3.2340, Accuracy: 3546/10000 (35.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 49: Average loss: 0.1549, Accuracy: 9569/9950 (96.1709%)
Done in 384.2595810890198 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:50 choose agents : [17, 64, 29, 52, 50, 6, 34, 78, 33, 12]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  50, local model 17, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1566/1574 (99.4917%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  50, local model 17, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  50, local model 17, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  50, local model 17, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  50, local model 17, internal_epoch   6,  Average loss: 0.0003, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  50, local model 17, internal_epoch   7,  Average loss: 0.0004, Accuracy: 1567/1574 (99.5553%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  50, local model 17, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1568/1574 (99.6188%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  50, local model 17, internal_epoch   9,  Average loss: 0.0004, Accuracy: 1567/1574 (99.5553%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  50, local model 17, internal_epoch  10,  Average loss: 0.0003, Accuracy: 1566/1574 (99.4917%), train_poison_data_count: 500
Global model norm: 85.5947055213186.
Norm before scaling: 85.57104253374794. Distance: 0.11334745347046644
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 50: Average loss: 3.3959, Accuracy: 3407/10000 (34.0700%)
___Test Local_ResNet_18 poisoned: True, epoch: 50: Average loss: 0.0772, Accuracy: 9743/9950 (97.9196%)
Scaling by  100
Scaled Norm after poisoning: 83.95678180431584, distance: 11.334746179216614
Total norm for 1 adversaries is: 83.95678180431584. distance: 11.334746179216614
___Test Local_ResNet_18 poisoned: True, epoch: 50: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  50, local model 64, internal_epoch   1,  Average loss: 0.0327, Accuracy: 495/953 (51.9412%)
___Train Local_ResNet_18,  epoch  50, local model 64, internal_epoch   2,  Average loss: 0.0062, Accuracy: 843/953 (88.4575%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Average loss: 4.0073, Accuracy: 2500/10000 (25.0000%)
___Train Local_ResNet_18,  epoch  50, local model 29, internal_epoch   1,  Average loss: 0.0231, Accuracy: 970/1440 (67.3611%)
___Train Local_ResNet_18,  epoch  50, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 1367/1440 (94.9306%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Average loss: 4.1256, Accuracy: 2379/10000 (23.7900%)
___Train Local_ResNet_18,  epoch  50, local model 52, internal_epoch   1,  Average loss: 0.0499, Accuracy: 242/636 (38.0503%)
___Train Local_ResNet_18,  epoch  50, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 583/636 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Average loss: 6.7513, Accuracy: 889/10000 (8.8900%)
___Train Local_ResNet_18,  epoch  50, local model 50, internal_epoch   1,  Average loss: 0.0437, Accuracy: 341/809 (42.1508%)
___Train Local_ResNet_18,  epoch  50, local model 50, internal_epoch   2,  Average loss: 0.0036, Accuracy: 759/809 (93.8195%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Average loss: 4.7067, Accuracy: 1855/10000 (18.5500%)
___Train Local_ResNet_18,  epoch  50, local model 6, internal_epoch   1,  Average loss: 0.0223, Accuracy: 1325/1956 (67.7403%)
___Train Local_ResNet_18,  epoch  50, local model 6, internal_epoch   2,  Average loss: 0.0031, Accuracy: 1843/1956 (94.2229%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Average loss: 3.7743, Accuracy: 2602/10000 (26.0200%)
___Train Local_ResNet_18,  epoch  50, local model 34, internal_epoch   1,  Average loss: 0.0290, Accuracy: 872/1427 (61.1072%)
___Train Local_ResNet_18,  epoch  50, local model 34, internal_epoch   2,  Average loss: 0.0055, Accuracy: 1295/1427 (90.7498%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Average loss: 3.4401, Accuracy: 3043/10000 (30.4300%)
___Train Local_ResNet_18,  epoch  50, local model 78, internal_epoch   1,  Average loss: 0.0639, Accuracy: 90/416 (21.6346%)
___Train Local_ResNet_18,  epoch  50, local model 78, internal_epoch   2,  Average loss: 0.0113, Accuracy: 349/416 (83.8942%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Average loss: 2.9419, Accuracy: 3697/10000 (36.9700%)
___Train Local_ResNet_18,  epoch  50, local model 33, internal_epoch   1,  Average loss: 0.0642, Accuracy: 117/515 (22.7184%)
___Train Local_ResNet_18,  epoch  50, local model 33, internal_epoch   2,  Average loss: 0.0154, Accuracy: 430/515 (83.4951%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Average loss: 3.4737, Accuracy: 3315/10000 (33.1500%)
___Train Local_ResNet_18,  epoch  50, local model 12, internal_epoch   1,  Average loss: 0.0691, Accuracy: 52/338 (15.3846%)
___Train Local_ResNet_18,  epoch  50, local model 12, internal_epoch   2,  Average loss: 0.0133, Accuracy: 271/338 (80.1775%)
___Test Local_ResNet_18 poisoned: False, epoch: 50: Average loss: 3.1739, Accuracy: 3476/10000 (34.7600%)
time spent on training: 279.05265188217163
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 50: Average loss: 3.1390, Accuracy: 3648/10000 (36.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 50: Average loss: 0.1198, Accuracy: 9636/9950 (96.8442%)
Done in 377.34501695632935 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:51 choose agents : [17, 62, 99, 42, 37, 47, 3, 81, 97, 30]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  51, local model 17, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1564/1574 (99.3647%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  51, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  51, local model 17, internal_epoch   3,  Average loss: 0.0006, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  51, local model 17, internal_epoch   4,  Average loss: 0.0005, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  51, local model 17, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  51, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1563/1574 (99.3011%), train_poison_data_count: 500
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  51, local model 17, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1565/1574 (99.4282%), train_poison_data_count: 500
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  51, local model 17, internal_epoch   8,  Average loss: 0.0004, Accuracy: 1559/1574 (99.0470%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  51, local model 17, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1566/1574 (99.4917%), train_poison_data_count: 500
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  51, local model 17, internal_epoch  10,  Average loss: 0.0004, Accuracy: 1561/1574 (99.1741%), train_poison_data_count: 500
Global model norm: 85.56984423374568.
Norm before scaling: 85.54629423318845. Distance: 0.13055890731561579
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 51: Average loss: 3.3946, Accuracy: 3381/10000 (33.8100%)
___Test Local_ResNet_18 poisoned: True, epoch: 51: Average loss: 0.0983, Accuracy: 9693/9950 (97.4171%)
Scaling by  100
Scaled Norm after poisoning: 84.18993013382004, distance: 13.055889592507965
Total norm for 1 adversaries is: 84.18993013382004. distance: 13.055889592507965
___Test Local_ResNet_18 poisoned: True, epoch: 51: Average loss: nan, Accuracy: 0/9950 (0.0000%)
