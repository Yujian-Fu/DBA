current path: saved_models/model_tiny_Nov.13_03.48.36
Loading data
reading data done
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.001 and current epoch is 21
create model done
Poisoned following participants: [0, 20, 74, 95]
We use following environment for graphs:  tiny
----------------------------------Start one training epoch------------------------------------------
Server Epoch:21 choose agents : [0, 20, 74, 95, 99, 43, 19, 27, 17, 86]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 0, internal_epoch   1,  Average loss: 0.0443, Accuracy: 619/1657 (37.3567%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 0, internal_epoch   2,  Average loss: 0.0187, Accuracy: 952/1657 (57.4532%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 0, internal_epoch   3,  Average loss: 0.0136, Accuracy: 1117/1657 (67.4110%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 0, internal_epoch   4,  Average loss: 0.0130, Accuracy: 1130/1657 (68.1955%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 0, internal_epoch   5,  Average loss: 0.0124, Accuracy: 1152/1657 (69.5232%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 0, internal_epoch   6,  Average loss: 0.0114, Accuracy: 1205/1657 (72.7218%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 0, internal_epoch   7,  Average loss: 0.0103, Accuracy: 1246/1657 (75.1961%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 0, internal_epoch   8,  Average loss: 0.0103, Accuracy: 1257/1657 (75.8600%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 0, internal_epoch   9,  Average loss: 0.0094, Accuracy: 1302/1657 (78.5757%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 0, internal_epoch  10,  Average loss: 0.0097, Accuracy: 1266/1657 (76.4031%), train_poison_data_count: 520
Global model norm: 86.31567359299527.
Norm before scaling: 86.291034169982. Distance: 1.4159499580678836
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 3.3934, Accuracy: 2967/10000 (29.6700%)
___Test Local_ResNet_18 poisoned: True, epoch: 21: Average loss: 0.9496, Accuracy: 7067/9950 (71.0251%)
Scaling by  100
Scaled Norm after poisoning: 163.93241866886794, distance: 141.59498109705373
Total norm for 4 adversaries is: 163.93241866886794. distance: 141.59498109705373
___Test Local_ResNet_18 poisoned: True, epoch: 21: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 20, internal_epoch   1,  Average loss: 0.0605, Accuracy: 252/807 (31.2268%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 20, internal_epoch   2,  Average loss: 0.0205, Accuracy: 485/807 (60.0991%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 20, internal_epoch   3,  Average loss: 0.0166, Accuracy: 514/807 (63.6927%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 20, internal_epoch   4,  Average loss: 0.0157, Accuracy: 520/807 (64.4362%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 20, internal_epoch   5,  Average loss: 0.0148, Accuracy: 551/807 (68.2776%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 20, internal_epoch   6,  Average loss: 0.0151, Accuracy: 538/807 (66.6667%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 20, internal_epoch   7,  Average loss: 0.0128, Accuracy: 571/807 (70.7559%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 20, internal_epoch   8,  Average loss: 0.0132, Accuracy: 558/807 (69.1450%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 20, internal_epoch   9,  Average loss: 0.0112, Accuracy: 581/807 (71.9950%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 20, internal_epoch  10,  Average loss: 0.0122, Accuracy: 566/807 (70.1363%), train_poison_data_count: 260
Global model norm: 86.31567359299527.
Norm before scaling: 86.30474938046574. Distance: 1.1276266904817627
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 3.8826, Accuracy: 2302/10000 (23.0200%)
___Test Local_ResNet_18 poisoned: True, epoch: 21: Average loss: 0.8419, Accuracy: 7521/9950 (75.5879%)
Scaling by  100
Scaled Norm after poisoning: 140.89047164375594, distance: 112.76267078193474
Total norm for 4 adversaries is: 140.89047164375594. distance: 112.76267078193474
___Test Local_ResNet_18 poisoned: True, epoch: 21: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 74, internal_epoch   1,  Average loss: 0.0417, Accuracy: 672/1552 (43.2990%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 74, internal_epoch   2,  Average loss: 0.0146, Accuracy: 1033/1552 (66.5593%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 74, internal_epoch   3,  Average loss: 0.0094, Accuracy: 1193/1552 (76.8686%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 74, internal_epoch   4,  Average loss: 0.0085, Accuracy: 1263/1552 (81.3789%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 74, internal_epoch   5,  Average loss: 0.0075, Accuracy: 1298/1552 (83.6340%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 74, internal_epoch   6,  Average loss: 0.0068, Accuracy: 1324/1552 (85.3093%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 74, internal_epoch   7,  Average loss: 0.0072, Accuracy: 1322/1552 (85.1804%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 74, internal_epoch   8,  Average loss: 0.0064, Accuracy: 1360/1552 (87.6289%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 74, internal_epoch   9,  Average loss: 0.0058, Accuracy: 1362/1552 (87.7577%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 74, internal_epoch  10,  Average loss: 0.0063, Accuracy: 1360/1552 (87.6289%), train_poison_data_count: 496
Global model norm: 86.31567359299527.
Norm before scaling: 86.29295522285554. Distance: 1.469726886939333
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 4.1072, Accuracy: 2437/10000 (24.3700%)
___Test Local_ResNet_18 poisoned: True, epoch: 21: Average loss: 0.6193, Accuracy: 7925/9950 (79.6482%)
Scaling by  100
Scaled Norm after poisoning: 168.65166116140097, distance: 146.9726869289835
Total norm for 4 adversaries is: 168.65166116140097. distance: 146.9726869289835
___Test Local_ResNet_18 poisoned: True, epoch: 21: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 95, internal_epoch   1,  Average loss: 0.0864, Accuracy: 94/599 (15.6928%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 95, internal_epoch   2,  Average loss: 0.0224, Accuracy: 371/599 (61.9366%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 95, internal_epoch   3,  Average loss: 0.0202, Accuracy: 346/599 (57.7629%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 95, internal_epoch   4,  Average loss: 0.0188, Accuracy: 376/599 (62.7713%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 95, internal_epoch   5,  Average loss: 0.0142, Accuracy: 443/599 (73.9566%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 95, internal_epoch   6,  Average loss: 0.0154, Accuracy: 405/599 (67.6127%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 95, internal_epoch   7,  Average loss: 0.0138, Accuracy: 437/599 (72.9549%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 95, internal_epoch   8,  Average loss: 0.0113, Accuracy: 462/599 (77.1285%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 95, internal_epoch   9,  Average loss: 0.0116, Accuracy: 448/599 (74.7913%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  21, local model 95, internal_epoch  10,  Average loss: 0.0117, Accuracy: 448/599 (74.7913%), train_poison_data_count: 200
Global model norm: 86.31567359299527.
Norm before scaling: 86.30739994436311. Distance: 1.106243549478981
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 5.8058, Accuracy: 1084/10000 (10.8400%)
___Test Local_ResNet_18 poisoned: True, epoch: 21: Average loss: 0.5209, Accuracy: 8209/9950 (82.5025%)
Scaling by  100
Scaled Norm after poisoning: 139.36651459595666, distance: 110.62435557721906
Total norm for 4 adversaries is: 139.36651459595666. distance: 110.62435557721906
___Test Local_ResNet_18 poisoned: True, epoch: 21: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  21, local model 99, internal_epoch   1,  Average loss: 0.0320, Accuracy: 442/773 (57.1798%)
___Train Local_ResNet_18,  epoch  21, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 730/773 (94.4373%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 4.5216, Accuracy: 2141/10000 (21.4100%)
___Train Local_ResNet_18,  epoch  21, local model 43, internal_epoch   1,  Average loss: 0.0351, Accuracy: 480/946 (50.7400%)
___Train Local_ResNet_18,  epoch  21, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 864/946 (91.3319%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 3.3591, Accuracy: 3303/10000 (33.0300%)
___Train Local_ResNet_18,  epoch  21, local model 19, internal_epoch   1,  Average loss: 0.0258, Accuracy: 670/1036 (64.6718%)
___Train Local_ResNet_18,  epoch  21, local model 19, internal_epoch   2,  Average loss: 0.0029, Accuracy: 993/1036 (95.8494%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 5.6083, Accuracy: 1681/10000 (16.8100%)
___Train Local_ResNet_18,  epoch  21, local model 27, internal_epoch   1,  Average loss: 0.0181, Accuracy: 1144/1587 (72.0857%)
___Train Local_ResNet_18,  epoch  21, local model 27, internal_epoch   2,  Average loss: 0.0034, Accuracy: 1489/1587 (93.8248%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 3.1398, Accuracy: 3541/10000 (35.4100%)
___Train Local_ResNet_18,  epoch  21, local model 17, internal_epoch   1,  Average loss: 0.0177, Accuracy: 1153/1574 (73.2529%)
___Train Local_ResNet_18,  epoch  21, local model 17, internal_epoch   2,  Average loss: 0.0028, Accuracy: 1496/1574 (95.0445%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 3.7708, Accuracy: 3030/10000 (30.3000%)
___Train Local_ResNet_18,  epoch  21, local model 86, internal_epoch   1,  Average loss: 0.0326, Accuracy: 539/1003 (53.7388%)
___Train Local_ResNet_18,  epoch  21, local model 86, internal_epoch   2,  Average loss: 0.0050, Accuracy: 910/1003 (90.7278%)
___Test Local_ResNet_18 poisoned: False, epoch: 21: Average loss: 3.1662, Accuracy: 3486/10000 (34.8600%)
time spent on training: 551.1026113033295
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 21: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 21: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 717.6469678878784 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:22 choose agents : [0, 20, 74, 95, 89, 77, 12, 53, 42, 31]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 0, internal_epoch   1,  Average loss: 0.1318, Accuracy: 796/1657 (48.0386%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 0, internal_epoch   2,  Average loss: 0.0143, Accuracy: 1319/1657 (79.6017%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 0, internal_epoch   3,  Average loss: 0.0097, Accuracy: 1413/1657 (85.2746%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 0, internal_epoch   4,  Average loss: 0.0089, Accuracy: 1422/1657 (85.8177%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 0, internal_epoch   5,  Average loss: 0.0085, Accuracy: 1422/1657 (85.8177%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 0, internal_epoch   6,  Average loss: 0.0081, Accuracy: 1438/1657 (86.7833%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 0, internal_epoch   7,  Average loss: 0.0077, Accuracy: 1455/1657 (87.8093%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 0, internal_epoch   8,  Average loss: 0.0073, Accuracy: 1458/1657 (87.9903%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 0, internal_epoch   9,  Average loss: 0.0079, Accuracy: 1434/1657 (86.5419%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 0, internal_epoch  10,  Average loss: 0.0071, Accuracy: 1465/1657 (88.4128%), train_poison_data_count: 520
Global model norm: 86.27698570139519.
Norm before scaling: 86.24122464416307. Distance: 2.644255540638381
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 6.2316, Accuracy: 372/10000 (3.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 22: Average loss: 0.3210, Accuracy: 9037/9950 (90.8241%)
Scaling by  100
Scaled Norm after poisoning: 275.76861337904285, distance: 264.42554185914037
Total norm for 4 adversaries is: 275.76861337904285. distance: 264.42554185914037
___Test Local_ResNet_18 poisoned: True, epoch: 22: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 20, internal_epoch   1,  Average loss: 0.2229, Accuracy: 283/807 (35.0682%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 20, internal_epoch   2,  Average loss: 0.0154, Accuracy: 647/807 (80.1735%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 20, internal_epoch   3,  Average loss: 0.0164, Accuracy: 665/807 (82.4040%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 20, internal_epoch   4,  Average loss: 0.0140, Accuracy: 675/807 (83.6431%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 20, internal_epoch   5,  Average loss: 0.0139, Accuracy: 680/807 (84.2627%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 20, internal_epoch   6,  Average loss: 0.0112, Accuracy: 704/807 (87.2367%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 20, internal_epoch   7,  Average loss: 0.0096, Accuracy: 704/807 (87.2367%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 20, internal_epoch   8,  Average loss: 0.0082, Accuracy: 717/807 (88.8476%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 20, internal_epoch   9,  Average loss: 0.0084, Accuracy: 722/807 (89.4672%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 20, internal_epoch  10,  Average loss: 0.0072, Accuracy: 723/807 (89.5911%), train_poison_data_count: 260
Global model norm: 86.27698570139519.
Norm before scaling: 86.25098504872278. Distance: 2.291847279685027
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 5.6611, Accuracy: 277/10000 (2.7700%)
___Test Local_ResNet_18 poisoned: True, epoch: 22: Average loss: 0.3879, Accuracy: 8675/9950 (87.1859%)
Scaling by  100
Scaled Norm after poisoning: 242.88998120291006, distance: 229.1847218266305
Total norm for 4 adversaries is: 242.88998120291006. distance: 229.1847218266305
___Test Local_ResNet_18 poisoned: True, epoch: 22: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 74, internal_epoch   1,  Average loss: 0.1214, Accuracy: 865/1552 (55.7345%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 74, internal_epoch   2,  Average loss: 0.0111, Accuracy: 1373/1552 (88.4665%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 74, internal_epoch   3,  Average loss: 0.0069, Accuracy: 1410/1552 (90.8505%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 74, internal_epoch   4,  Average loss: 0.0065, Accuracy: 1423/1552 (91.6881%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 74, internal_epoch   5,  Average loss: 0.0065, Accuracy: 1425/1552 (91.8170%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 74, internal_epoch   6,  Average loss: 0.0058, Accuracy: 1446/1552 (93.1701%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 74, internal_epoch   7,  Average loss: 0.0054, Accuracy: 1444/1552 (93.0412%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 74, internal_epoch   8,  Average loss: 0.0060, Accuracy: 1429/1552 (92.0747%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 74, internal_epoch   9,  Average loss: 0.0055, Accuracy: 1441/1552 (92.8479%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 74, internal_epoch  10,  Average loss: 0.0063, Accuracy: 1419/1552 (91.4304%), train_poison_data_count: 496
Global model norm: 86.27698570139519.
Norm before scaling: 86.24247023291366. Distance: 2.5120015081595493
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 6.5987, Accuracy: 185/10000 (1.8500%)
___Test Local_ResNet_18 poisoned: True, epoch: 22: Average loss: 0.1711, Accuracy: 9406/9950 (94.5327%)
Scaling by  100
Scaled Norm after poisoning: 263.28458640319224, distance: 251.20013497707362
Total norm for 4 adversaries is: 263.28458640319224. distance: 251.20013497707362
___Test Local_ResNet_18 poisoned: True, epoch: 22: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 95, internal_epoch   1,  Average loss: 0.2422, Accuracy: 202/599 (33.7229%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 95, internal_epoch   2,  Average loss: 0.0277, Accuracy: 476/599 (79.4658%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 95, internal_epoch   3,  Average loss: 0.0162, Accuracy: 521/599 (86.9783%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 95, internal_epoch   4,  Average loss: 0.0140, Accuracy: 521/599 (86.9783%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 95, internal_epoch   5,  Average loss: 0.0125, Accuracy: 532/599 (88.8147%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 95, internal_epoch   6,  Average loss: 0.0113, Accuracy: 536/599 (89.4825%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 95, internal_epoch   7,  Average loss: 0.0105, Accuracy: 544/599 (90.8180%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 95, internal_epoch   8,  Average loss: 0.0094, Accuracy: 541/599 (90.3172%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 95, internal_epoch   9,  Average loss: 0.0074, Accuracy: 548/599 (91.4858%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  22, local model 95, internal_epoch  10,  Average loss: 0.0077, Accuracy: 544/599 (90.8180%), train_poison_data_count: 200
Global model norm: 86.27698570139519.
Norm before scaling: 86.25582238047035. Distance: 1.9483601546365326
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 7.7577, Accuracy: 88/10000 (0.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 22: Average loss: 0.1693, Accuracy: 9270/9950 (93.1658%)
Scaling by  100
Scaled Norm after poisoning: 211.32909022422825, distance: 194.83600876763
Total norm for 4 adversaries is: 211.32909022422825. distance: 194.83600876763
___Test Local_ResNet_18 poisoned: True, epoch: 22: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  22, local model 89, internal_epoch   1,  Average loss: 0.4699, Accuracy: 14/896 (1.5625%)
___Train Local_ResNet_18,  epoch  22, local model 89, internal_epoch   2,  Average loss: 0.0259, Accuracy: 676/896 (75.4464%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 10.5074, Accuracy: 352/10000 (3.5200%)
___Train Local_ResNet_18,  epoch  22, local model 77, internal_epoch   1,  Average loss: 0.3311, Accuracy: 298/1340 (22.2388%)
___Train Local_ResNet_18,  epoch  22, local model 77, internal_epoch   2,  Average loss: 0.0075, Accuracy: 1219/1340 (90.9701%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 10.0333, Accuracy: 324/10000 (3.2400%)
___Train Local_ResNet_18,  epoch  22, local model 12, internal_epoch   1,  Average loss: 0.7606, Accuracy: 0/338 (0.0000%)
___Train Local_ResNet_18,  epoch  22, local model 12, internal_epoch   2,  Average loss: 0.4310, Accuracy: 0/338 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 15.0617, Accuracy: 82/10000 (0.8200%)
___Train Local_ResNet_18,  epoch  22, local model 53, internal_epoch   1,  Average loss: 0.5143, Accuracy: 1/813 (0.1230%)
___Train Local_ResNet_18,  epoch  22, local model 53, internal_epoch   2,  Average loss: 0.0170, Accuracy: 655/813 (80.5658%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 18.0897, Accuracy: 96/10000 (0.9600%)
___Train Local_ResNet_18,  epoch  22, local model 42, internal_epoch   1,  Average loss: 0.3052, Accuracy: 368/1372 (26.8222%)
___Train Local_ResNet_18,  epoch  22, local model 42, internal_epoch   2,  Average loss: 0.0067, Accuracy: 1252/1372 (91.2536%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 9.2167, Accuracy: 542/10000 (5.4200%)
___Train Local_ResNet_18,  epoch  22, local model 31, internal_epoch   1,  Average loss: 0.6786, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18,  epoch  22, local model 31, internal_epoch   2,  Average loss: 0.1913, Accuracy: 73/460 (15.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 22: Average loss: 11.6001, Accuracy: 263/10000 (2.6300%)
time spent on training: 640.0599930286407
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 22: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 22: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 787.9374892711639 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:23 choose agents : [0, 20, 74, 95, 33, 39, 97, 58, 80, 5]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 0, internal_epoch   1,  Average loss: 0.3608, Accuracy: 246/1657 (14.8461%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 0, internal_epoch   2,  Average loss: 0.1112, Accuracy: 334/1657 (20.1569%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 0, internal_epoch   3,  Average loss: 0.0924, Accuracy: 308/1657 (18.5878%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 0, internal_epoch   4,  Average loss: 0.0876, Accuracy: 332/1657 (20.0362%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 0, internal_epoch   5,  Average loss: 0.0852, Accuracy: 338/1657 (20.3983%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 0, internal_epoch   6,  Average loss: 0.0824, Accuracy: 325/1657 (19.6138%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 0, internal_epoch   7,  Average loss: 0.0787, Accuracy: 340/1657 (20.5190%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 0, internal_epoch   8,  Average loss: 0.0762, Accuracy: 335/1657 (20.2173%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 0, internal_epoch   9,  Average loss: 0.0758, Accuracy: 331/1657 (19.9759%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 0, internal_epoch  10,  Average loss: 0.0748, Accuracy: 327/1657 (19.7345%), train_poison_data_count: 520
Global model norm: 86.3858135868529.
Norm before scaling: 86.32807268097962. Distance: 4.494426454608395
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 11.8813, Accuracy: 56/10000 (0.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 23: Average loss: 8.6521, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 454.36105549441623, distance: 449.4426235627858
Total norm for 4 adversaries is: 454.36105549441623. distance: 449.4426235627858
___Test Local_ResNet_18 poisoned: True, epoch: 23: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 20, internal_epoch   1,  Average loss: 0.5434, Accuracy: 232/807 (28.7485%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 20, internal_epoch   2,  Average loss: 0.1782, Accuracy: 256/807 (31.7224%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 20, internal_epoch   3,  Average loss: 0.1369, Accuracy: 286/807 (35.4399%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 20, internal_epoch   4,  Average loss: 0.1134, Accuracy: 270/807 (33.4572%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 20, internal_epoch   5,  Average loss: 0.1218, Accuracy: 278/807 (34.4486%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 20, internal_epoch   6,  Average loss: 0.0987, Accuracy: 278/807 (34.4486%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 20, internal_epoch   7,  Average loss: 0.0965, Accuracy: 280/807 (34.6964%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 20, internal_epoch   8,  Average loss: 0.0847, Accuracy: 280/807 (34.6964%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 20, internal_epoch   9,  Average loss: 0.0845, Accuracy: 282/807 (34.9442%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 20, internal_epoch  10,  Average loss: 0.0750, Accuracy: 289/807 (35.8116%), train_poison_data_count: 260
Global model norm: 86.3858135868529.
Norm before scaling: 86.36307974458038. Distance: 4.31589252987928
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 10.4192, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 23: Average loss: 12.8409, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 437.58031405674546, distance: 431.5892868225531
Total norm for 4 adversaries is: 437.58031405674546. distance: 431.5892868225531
___Test Local_ResNet_18 poisoned: True, epoch: 23: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 74, internal_epoch   1,  Average loss: 0.5253, Accuracy: 633/1552 (40.7861%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 74, internal_epoch   2,  Average loss: 0.0861, Accuracy: 555/1552 (35.7603%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 74, internal_epoch   3,  Average loss: 0.0416, Accuracy: 769/1552 (49.5490%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 74, internal_epoch   4,  Average loss: 0.0288, Accuracy: 1047/1552 (67.4613%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 74, internal_epoch   5,  Average loss: 0.0225, Accuracy: 1088/1552 (70.1031%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 74, internal_epoch   6,  Average loss: 0.0217, Accuracy: 1101/1552 (70.9407%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 74, internal_epoch   7,  Average loss: 0.0182, Accuracy: 1148/1552 (73.9691%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 74, internal_epoch   8,  Average loss: 0.0181, Accuracy: 1121/1552 (72.2294%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 74, internal_epoch   9,  Average loss: 0.0164, Accuracy: 1183/1552 (76.2242%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 74, internal_epoch  10,  Average loss: 0.0185, Accuracy: 1159/1552 (74.6778%), train_poison_data_count: 496
Global model norm: 86.3858135868529.
Norm before scaling: 86.28257423829855. Distance: 5.118734484079621
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 11.1004, Accuracy: 141/10000 (1.4100%)
___Test Local_ResNet_18 poisoned: True, epoch: 23: Average loss: 0.3669, Accuracy: 9144/9950 (91.8995%)
Scaling by  100
Scaled Norm after poisoning: 514.8535592768103, distance: 511.87345848363736
Total norm for 4 adversaries is: 514.8535592768103. distance: 511.87345848363736
___Test Local_ResNet_18 poisoned: True, epoch: 23: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 95, internal_epoch   1,  Average loss: 0.9049, Accuracy: 298/599 (49.7496%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 95, internal_epoch   2,  Average loss: 0.3183, Accuracy: 302/599 (50.4174%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 95, internal_epoch   3,  Average loss: 0.2353, Accuracy: 321/599 (53.5893%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 95, internal_epoch   4,  Average loss: 0.2089, Accuracy: 317/599 (52.9215%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 95, internal_epoch   5,  Average loss: 0.1979, Accuracy: 302/599 (50.4174%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 95, internal_epoch   6,  Average loss: 0.1793, Accuracy: 321/599 (53.5893%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 95, internal_epoch   7,  Average loss: 0.1737, Accuracy: 329/599 (54.9249%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 95, internal_epoch   8,  Average loss: 0.1579, Accuracy: 317/599 (52.9215%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 95, internal_epoch   9,  Average loss: 0.1501, Accuracy: 311/599 (51.9199%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  23, local model 95, internal_epoch  10,  Average loss: 0.1476, Accuracy: 323/599 (53.9232%), train_poison_data_count: 200
Global model norm: 86.3858135868529.
Norm before scaling: 86.30368573748748. Distance: 3.5573422757407616
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 6.6091, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 23: Average loss: 18.2722, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 362.38884071532885, distance: 355.7342538679681
Total norm for 4 adversaries is: 362.38884071532885. distance: 355.7342538679681
___Test Local_ResNet_18 poisoned: True, epoch: 23: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  23, local model 33, internal_epoch   1,  Average loss: 0.3015, Accuracy: 0/515 (0.0000%)
___Train Local_ResNet_18,  epoch  23, local model 33, internal_epoch   2,  Average loss: 0.1775, Accuracy: 0/515 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 9.3658, Accuracy: 194/10000 (1.9400%)
___Train Local_ResNet_18,  epoch  23, local model 39, internal_epoch   1,  Average loss: 0.1953, Accuracy: 3/1013 (0.2962%)
___Train Local_ResNet_18,  epoch  23, local model 39, internal_epoch   2,  Average loss: 0.0670, Accuracy: 374/1013 (36.9200%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 8.3670, Accuracy: 94/10000 (0.9400%)
___Train Local_ResNet_18,  epoch  23, local model 97, internal_epoch   1,  Average loss: 0.1873, Accuracy: 0/1213 (0.0000%)
___Train Local_ResNet_18,  epoch  23, local model 97, internal_epoch   2,  Average loss: 0.0631, Accuracy: 441/1213 (36.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 8.5464, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  23, local model 58, internal_epoch   1,  Average loss: 0.2195, Accuracy: 1/803 (0.1245%)
___Train Local_ResNet_18,  epoch  23, local model 58, internal_epoch   2,  Average loss: 0.0969, Accuracy: 383/803 (47.6961%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 11.7176, Accuracy: 69/10000 (0.6900%)
___Train Local_ResNet_18,  epoch  23, local model 80, internal_epoch   1,  Average loss: 0.2213, Accuracy: 13/682 (1.9062%)
___Train Local_ResNet_18,  epoch  23, local model 80, internal_epoch   2,  Average loss: 0.1160, Accuracy: 123/682 (18.0352%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 11.8947, Accuracy: 163/10000 (1.6300%)
___Train Local_ResNet_18,  epoch  23, local model 5, internal_epoch   1,  Average loss: 0.1491, Accuracy: 311/1628 (19.1032%)
___Train Local_ResNet_18,  epoch  23, local model 5, internal_epoch   2,  Average loss: 0.0174, Accuracy: 1351/1628 (82.9853%)
___Test Local_ResNet_18 poisoned: False, epoch: 23: Average loss: 8.6518, Accuracy: 294/10000 (2.9400%)
time spent on training: 659.0907838344574
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 23: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 23: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 803.7344071865082 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:24 choose agents : [0, 20, 74, 95, 8, 66, 75, 14, 48, 5]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 0, internal_epoch   1,  Average loss: 0.2641, Accuracy: 594/1657 (35.8479%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 0, internal_epoch   2,  Average loss: 0.0383, Accuracy: 736/1657 (44.4176%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 0, internal_epoch   3,  Average loss: 0.0313, Accuracy: 764/1657 (46.1074%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 0, internal_epoch   4,  Average loss: 0.0310, Accuracy: 772/1657 (46.5902%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 0, internal_epoch   5,  Average loss: 0.0277, Accuracy: 789/1657 (47.6162%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 0, internal_epoch   6,  Average loss: 0.0281, Accuracy: 775/1657 (46.7713%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 0, internal_epoch   7,  Average loss: 0.0283, Accuracy: 792/1657 (47.7972%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 0, internal_epoch   8,  Average loss: 0.0282, Accuracy: 807/1657 (48.7025%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 0, internal_epoch   9,  Average loss: 0.0287, Accuracy: 797/1657 (48.0990%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 0, internal_epoch  10,  Average loss: 0.0282, Accuracy: 809/1657 (48.8232%), train_poison_data_count: 520
Global model norm: 86.7630151664939.
Norm before scaling: 86.73522084572247. Distance: 4.361881096340018
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 8.1829, Accuracy: 52/10000 (0.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 24: Average loss: 1.2046, Accuracy: 7606/9950 (76.4422%)
Scaling by  100
Scaled Norm after poisoning: 442.0441154455062, distance: 436.1881044916287
Total norm for 4 adversaries is: 442.0441154455062. distance: 436.1881044916287
___Test Local_ResNet_18 poisoned: True, epoch: 24: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 20, internal_epoch   1,  Average loss: 0.4965, Accuracy: 260/807 (32.2181%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 20, internal_epoch   2,  Average loss: 0.1012, Accuracy: 349/807 (43.2466%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 20, internal_epoch   3,  Average loss: 0.0448, Accuracy: 414/807 (51.3011%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 20, internal_epoch   4,  Average loss: 0.0513, Accuracy: 470/807 (58.2404%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 20, internal_epoch   5,  Average loss: 0.0400, Accuracy: 460/807 (57.0012%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 20, internal_epoch   6,  Average loss: 0.0376, Accuracy: 477/807 (59.1078%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 20, internal_epoch   7,  Average loss: 0.0347, Accuracy: 486/807 (60.2230%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 20, internal_epoch   8,  Average loss: 0.0356, Accuracy: 434/807 (53.7794%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 20, internal_epoch   9,  Average loss: 0.0303, Accuracy: 482/807 (59.7274%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 20, internal_epoch  10,  Average loss: 0.0310, Accuracy: 488/807 (60.4709%), train_poison_data_count: 260
Global model norm: 86.7630151664939.
Norm before scaling: 86.74152853989547. Distance: 4.047549394066996
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 8.5854, Accuracy: 51/10000 (0.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 24: Average loss: 1.5295, Accuracy: 5692/9950 (57.2060%)
Scaling by  100
Scaled Norm after poisoning: 411.51332754845254, distance: 404.7549219898382
Total norm for 4 adversaries is: 411.51332754845254. distance: 404.7549219898382
___Test Local_ResNet_18 poisoned: True, epoch: 24: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 74, internal_epoch   1,  Average loss: 0.3492, Accuracy: 492/1552 (31.7010%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 74, internal_epoch   2,  Average loss: 0.0296, Accuracy: 709/1552 (45.6830%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 74, internal_epoch   3,  Average loss: 0.0228, Accuracy: 785/1552 (50.5799%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 74, internal_epoch   4,  Average loss: 0.0218, Accuracy: 799/1552 (51.4820%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 74, internal_epoch   5,  Average loss: 0.0209, Accuracy: 782/1552 (50.3866%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 74, internal_epoch   6,  Average loss: 0.0202, Accuracy: 798/1552 (51.4175%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 74, internal_epoch   7,  Average loss: 0.0195, Accuracy: 810/1552 (52.1907%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 74, internal_epoch   8,  Average loss: 0.0206, Accuracy: 829/1552 (53.4149%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 74, internal_epoch   9,  Average loss: 0.0196, Accuracy: 847/1552 (54.5747%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 74, internal_epoch  10,  Average loss: 0.0193, Accuracy: 852/1552 (54.8969%), train_poison_data_count: 496
Global model norm: 86.7630151664939.
Norm before scaling: 86.74749523581359. Distance: 5.067228769610116
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 9.6584, Accuracy: 67/10000 (0.6700%)
___Test Local_ResNet_18 poisoned: True, epoch: 24: Average loss: 0.3380, Accuracy: 8746/9950 (87.8995%)
Scaling by  100
Scaled Norm after poisoning: 511.3305407219483, distance: 506.7229118315058
Total norm for 4 adversaries is: 511.3305407219483. distance: 506.7229118315058
___Test Local_ResNet_18 poisoned: True, epoch: 24: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 95, internal_epoch   1,  Average loss: 0.8144, Accuracy: 200/599 (33.3890%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 95, internal_epoch   2,  Average loss: 0.5382, Accuracy: 200/599 (33.3890%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 95, internal_epoch   3,  Average loss: 0.4172, Accuracy: 200/599 (33.3890%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 95, internal_epoch   4,  Average loss: 0.3208, Accuracy: 200/599 (33.3890%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 95, internal_epoch   5,  Average loss: 0.3022, Accuracy: 200/599 (33.3890%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 95, internal_epoch   6,  Average loss: 0.3280, Accuracy: 200/599 (33.3890%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 95, internal_epoch   7,  Average loss: 0.3242, Accuracy: 200/599 (33.3890%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 95, internal_epoch   8,  Average loss: 0.2219, Accuracy: 200/599 (33.3890%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 95, internal_epoch   9,  Average loss: 0.2125, Accuracy: 200/599 (33.3890%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  24, local model 95, internal_epoch  10,  Average loss: 0.2285, Accuracy: 200/599 (33.3890%), train_poison_data_count: 200
Global model norm: 86.7630151664939.
Norm before scaling: 86.78165511248619. Distance: 5.952310821846676
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 20.8479, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 24: Average loss: 0.0538, Accuracy: 9950/9950 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 598.839033046444, distance: 595.2309688263875
Total norm for 4 adversaries is: 598.839033046444. distance: 595.2309688263875
___Test Local_ResNet_18 poisoned: True, epoch: 24: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  24, local model 8, internal_epoch   1,  Average loss: 0.6148, Accuracy: 0/1513 (0.0000%)
___Train Local_ResNet_18,  epoch  24, local model 8, internal_epoch   2,  Average loss: 0.2538, Accuracy: 0/1513 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 233.4809, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  24, local model 66, internal_epoch   1,  Average loss: 0.6379, Accuracy: 0/1402 (0.0000%)
___Train Local_ResNet_18,  epoch  24, local model 66, internal_epoch   2,  Average loss: 0.2761, Accuracy: 5/1402 (0.3566%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 7.1880, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  24, local model 75, internal_epoch   1,  Average loss: 0.8011, Accuracy: 0/776 (0.0000%)
___Train Local_ResNet_18,  epoch  24, local model 75, internal_epoch   2,  Average loss: 0.4436, Accuracy: 0/776 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  24, local model 14, internal_epoch   1,  Average loss: 0.7410, Accuracy: 0/1013 (0.0000%)
___Train Local_ResNet_18,  epoch  24, local model 14, internal_epoch   2,  Average loss: 0.3329, Accuracy: 0/1013 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  24, local model 48, internal_epoch   1,  Average loss: 0.8221, Accuracy: 0/631 (0.0000%)
___Train Local_ResNet_18,  epoch  24, local model 48, internal_epoch   2,  Average loss: 0.4907, Accuracy: 0/631 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  24, local model 5, internal_epoch   1,  Average loss: 0.5893, Accuracy: 0/1628 (0.0000%)
___Train Local_ResNet_18,  epoch  24, local model 5, internal_epoch   2,  Average loss: 0.2052, Accuracy: 76/1628 (4.6683%)
___Test Local_ResNet_18 poisoned: False, epoch: 24: Average loss: 142.7264, Accuracy: 48/10000 (0.4800%)
time spent on training: 665.2676069736481
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 24: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 24: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 822.770724773407 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:25 choose agents : [0, 20, 74, 95, 84, 94, 39, 63, 67, 70]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 0, internal_epoch   1,  Average loss: 0.0641, Accuracy: 561/1657 (33.8564%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 0, internal_epoch   2,  Average loss: 0.0323, Accuracy: 751/1657 (45.3229%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 0, internal_epoch   3,  Average loss: 0.0283, Accuracy: 806/1657 (48.6421%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 0, internal_epoch   4,  Average loss: 0.0282, Accuracy: 793/1657 (47.8576%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 0, internal_epoch   5,  Average loss: 0.0272, Accuracy: 815/1657 (49.1853%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 0, internal_epoch   6,  Average loss: 0.0268, Accuracy: 824/1657 (49.7284%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 0, internal_epoch   7,  Average loss: 0.0278, Accuracy: 800/1657 (48.2800%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 0, internal_epoch   8,  Average loss: 0.0272, Accuracy: 787/1657 (47.4955%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 0, internal_epoch   9,  Average loss: 0.0271, Accuracy: 799/1657 (48.2197%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 0, internal_epoch  10,  Average loss: 0.0268, Accuracy: 786/1657 (47.4351%), train_poison_data_count: 520
Global model norm: 87.16386328347316.
Norm before scaling: 87.1335322445168. Distance: 1.393509776535204
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: 8.7665, Accuracy: 47/10000 (0.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 25: Average loss: 3.1133, Accuracy: 8318/9950 (83.5980%)
Scaling by  100
Scaled Norm after poisoning: 162.15202526294576, distance: 139.35097186376206
Total norm for 4 adversaries is: 162.15202526294576. distance: 139.35097186376206
___Test Local_ResNet_18 poisoned: True, epoch: 25: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.1148, Accuracy: 208/807 (25.7745%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 20, internal_epoch   2,  Average loss: 0.0601, Accuracy: 459/807 (56.8773%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 20, internal_epoch   3,  Average loss: 0.0423, Accuracy: 486/807 (60.2230%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 20, internal_epoch   4,  Average loss: 0.0366, Accuracy: 505/807 (62.5774%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 20, internal_epoch   5,  Average loss: 0.0360, Accuracy: 488/807 (60.4709%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 20, internal_epoch   6,  Average loss: 0.0374, Accuracy: 490/807 (60.7187%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 20, internal_epoch   7,  Average loss: 0.0341, Accuracy: 491/807 (60.8426%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 20, internal_epoch   8,  Average loss: 0.0350, Accuracy: 499/807 (61.8340%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 20, internal_epoch   9,  Average loss: 0.0349, Accuracy: 508/807 (62.9492%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 20, internal_epoch  10,  Average loss: 0.0322, Accuracy: 505/807 (62.5774%), train_poison_data_count: 260
Global model norm: 87.16386328347316.
Norm before scaling: 87.14861924286294. Distance: 1.665351118004003
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: 8.2322, Accuracy: 59/10000 (0.5900%)
___Test Local_ResNet_18 poisoned: True, epoch: 25: Average loss: 1.5745, Accuracy: 8801/9950 (88.4523%)
Scaling by  100
Scaled Norm after poisoning: 186.51681810898447, distance: 166.53509976315803
Total norm for 4 adversaries is: 186.51681810898447. distance: 166.53509976315803
___Test Local_ResNet_18 poisoned: True, epoch: 25: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0601, Accuracy: 577/1552 (37.1778%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 74, internal_epoch   2,  Average loss: 0.0269, Accuracy: 701/1552 (45.1675%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 74, internal_epoch   3,  Average loss: 0.0207, Accuracy: 744/1552 (47.9381%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 74, internal_epoch   4,  Average loss: 0.0205, Accuracy: 768/1552 (49.4845%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 74, internal_epoch   5,  Average loss: 0.0216, Accuracy: 771/1552 (49.6778%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 74, internal_epoch   6,  Average loss: 0.0201, Accuracy: 799/1552 (51.4820%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 74, internal_epoch   7,  Average loss: 0.0197, Accuracy: 781/1552 (50.3222%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 74, internal_epoch   8,  Average loss: 0.0194, Accuracy: 815/1552 (52.5129%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 74, internal_epoch   9,  Average loss: 0.0196, Accuracy: 804/1552 (51.8041%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 74, internal_epoch  10,  Average loss: 0.0196, Accuracy: 804/1552 (51.8041%), train_poison_data_count: 496
Global model norm: 87.16386328347316.
Norm before scaling: 87.1380039838029. Distance: 1.5311288591072008
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: 11.6917, Accuracy: 64/10000 (0.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 25: Average loss: 0.2725, Accuracy: 9299/9950 (93.4573%)
Scaling by  100
Scaled Norm after poisoning: 174.22975021326008, distance: 153.1128885516337
Total norm for 4 adversaries is: 174.22975021326008. distance: 153.1128885516337
___Test Local_ResNet_18 poisoned: True, epoch: 25: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 95, internal_epoch   1,  Average loss: 0.1845, Accuracy: 80/599 (13.3556%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 95, internal_epoch   2,  Average loss: 0.0739, Accuracy: 390/599 (65.1085%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 95, internal_epoch   3,  Average loss: 0.0559, Accuracy: 479/599 (79.9666%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 95, internal_epoch   4,  Average loss: 0.0519, Accuracy: 486/599 (81.1352%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 95, internal_epoch   5,  Average loss: 0.0443, Accuracy: 495/599 (82.6377%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 95, internal_epoch   6,  Average loss: 0.0466, Accuracy: 482/599 (80.4674%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 95, internal_epoch   7,  Average loss: 0.0439, Accuracy: 488/599 (81.4691%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 95, internal_epoch   8,  Average loss: 0.0466, Accuracy: 493/599 (82.3038%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 95, internal_epoch   9,  Average loss: 0.0428, Accuracy: 486/599 (81.1352%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  25, local model 95, internal_epoch  10,  Average loss: 0.0426, Accuracy: 494/599 (82.4708%), train_poison_data_count: 200
Global model norm: 87.16386328347316.
Norm before scaling: 87.15702032198124. Distance: 2.110477074840889
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: 10.1239, Accuracy: 51/10000 (0.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 25: Average loss: 1.2279, Accuracy: 9185/9950 (92.3116%)
Scaling by  100
Scaled Norm after poisoning: 227.09877910008674, distance: 211.04770269420135
Total norm for 4 adversaries is: 227.09877910008674. distance: 211.04770269420135
___Test Local_ResNet_18 poisoned: True, epoch: 25: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  25, local model 84, internal_epoch   1,  Average loss: 0.1455, Accuracy: 36/1190 (3.0252%)
___Train Local_ResNet_18,  epoch  25, local model 84, internal_epoch   2,  Average loss: 0.0614, Accuracy: 439/1190 (36.8908%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  25, local model 94, internal_epoch   1,  Average loss: 0.1264, Accuracy: 46/1662 (2.7677%)
___Train Local_ResNet_18,  epoch  25, local model 94, internal_epoch   2,  Average loss: 0.0512, Accuracy: 422/1662 (25.3911%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: 5.2989, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  25, local model 39, internal_epoch   1,  Average loss: 0.1303, Accuracy: 44/1013 (4.3435%)
___Train Local_ResNet_18,  epoch  25, local model 39, internal_epoch   2,  Average loss: 0.0419, Accuracy: 333/1013 (32.8727%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  25, local model 63, internal_epoch   1,  Average loss: 0.1516, Accuracy: 0/888 (0.0000%)
___Train Local_ResNet_18,  epoch  25, local model 63, internal_epoch   2,  Average loss: 0.0505, Accuracy: 361/888 (40.6532%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  25, local model 67, internal_epoch   1,  Average loss: 0.1972, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18,  epoch  25, local model 67, internal_epoch   2,  Average loss: 0.1179, Accuracy: 0/426 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  25, local model 70, internal_epoch   1,  Average loss: 0.1338, Accuracy: 16/1418 (1.1283%)
___Train Local_ResNet_18,  epoch  25, local model 70, internal_epoch   2,  Average loss: 0.0513, Accuracy: 397/1418 (27.9972%)
___Test Local_ResNet_18 poisoned: False, epoch: 25: Average loss: 5.2989, Accuracy: 50/10000 (0.5000%)
time spent on training: 676.4558732509613
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 25: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 25: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 833.3228793144226 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:26 choose agents : [0, 20, 74, 95, 13, 56, 44, 96, 17, 25]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 0, internal_epoch   1,  Average loss: 0.0613, Accuracy: 672/1657 (40.5552%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 0, internal_epoch   2,  Average loss: 0.0269, Accuracy: 804/1657 (48.5214%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 0, internal_epoch   3,  Average loss: 0.0254, Accuracy: 820/1657 (49.4870%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 0, internal_epoch   4,  Average loss: 0.0259, Accuracy: 803/1657 (48.4611%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 0, internal_epoch   5,  Average loss: 0.0262, Accuracy: 809/1657 (48.8232%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 0, internal_epoch   6,  Average loss: 0.0257, Accuracy: 815/1657 (49.1853%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 0, internal_epoch   7,  Average loss: 0.0255, Accuracy: 819/1657 (49.4267%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 0, internal_epoch   8,  Average loss: 0.0256, Accuracy: 809/1657 (48.8232%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 0, internal_epoch   9,  Average loss: 0.0251, Accuracy: 827/1657 (49.9095%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 0, internal_epoch  10,  Average loss: 0.0252, Accuracy: 827/1657 (49.9095%), train_poison_data_count: 520
Global model norm: 87.14418166715149.
Norm before scaling: 87.11956919049531. Distance: 1.6313098034182205
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: 8.2856, Accuracy: 49/10000 (0.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 26: Average loss: 0.2762, Accuracy: 9720/9950 (97.6884%)
Scaling by  100
Scaled Norm after poisoning: 183.05895780116853, distance: 163.13099845293047
Total norm for 4 adversaries is: 183.05895780116853. distance: 163.13099845293047
___Test Local_ResNet_18 poisoned: True, epoch: 26: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 20, internal_epoch   1,  Average loss: 0.1283, Accuracy: 268/807 (33.2094%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 20, internal_epoch   2,  Average loss: 0.0319, Accuracy: 506/807 (62.7014%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 20, internal_epoch   3,  Average loss: 0.0267, Accuracy: 509/807 (63.0731%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 20, internal_epoch   4,  Average loss: 0.0257, Accuracy: 508/807 (62.9492%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 20, internal_epoch   5,  Average loss: 0.0250, Accuracy: 516/807 (63.9405%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 20, internal_epoch   6,  Average loss: 0.0243, Accuracy: 515/807 (63.8166%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 20, internal_epoch   7,  Average loss: 0.0238, Accuracy: 522/807 (64.6840%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 20, internal_epoch   8,  Average loss: 0.0233, Accuracy: 521/807 (64.5601%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 20, internal_epoch   9,  Average loss: 0.0238, Accuracy: 515/807 (63.8166%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 20, internal_epoch  10,  Average loss: 0.0242, Accuracy: 518/807 (64.1884%), train_poison_data_count: 260
Global model norm: 87.14418166715149.
Norm before scaling: 87.13011664494947. Distance: 1.7929080462516316
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: 7.9736, Accuracy: 52/10000 (0.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 26: Average loss: 0.4966, Accuracy: 9345/9950 (93.9196%)
Scaling by  100
Scaled Norm after poisoning: 197.92083328947461, distance: 179.29077944431498
Total norm for 4 adversaries is: 197.92083328947461. distance: 179.29077944431498
___Test Local_ResNet_18 poisoned: True, epoch: 26: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 74, internal_epoch   1,  Average loss: 0.0793, Accuracy: 509/1552 (32.7964%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 74, internal_epoch   2,  Average loss: 0.0222, Accuracy: 785/1552 (50.5799%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 74, internal_epoch   3,  Average loss: 0.0203, Accuracy: 786/1552 (50.6443%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 74, internal_epoch   4,  Average loss: 0.0202, Accuracy: 789/1552 (50.8376%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 74, internal_epoch   5,  Average loss: 0.0206, Accuracy: 852/1552 (54.8969%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 74, internal_epoch   6,  Average loss: 0.0199, Accuracy: 852/1552 (54.8969%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 74, internal_epoch   7,  Average loss: 0.0196, Accuracy: 882/1552 (56.8299%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 74, internal_epoch   8,  Average loss: 0.0203, Accuracy: 844/1552 (54.3814%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 74, internal_epoch   9,  Average loss: 0.0205, Accuracy: 854/1552 (55.0258%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 74, internal_epoch  10,  Average loss: 0.0200, Accuracy: 870/1552 (56.0567%), train_poison_data_count: 496
Global model norm: 87.14418166715149.
Norm before scaling: 87.11684805388536. Distance: 1.5759526777472663
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: 9.0997, Accuracy: 72/10000 (0.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 26: Average loss: 0.2345, Accuracy: 9228/9950 (92.7437%)
Scaling by  100
Scaled Norm after poisoning: 178.0606353008716, distance: 157.5952650878985
Total norm for 4 adversaries is: 178.0606353008716. distance: 157.5952650878985
___Test Local_ResNet_18 poisoned: True, epoch: 26: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 95, internal_epoch   1,  Average loss: 0.1661, Accuracy: 384/599 (64.1068%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 95, internal_epoch   2,  Average loss: 0.0345, Accuracy: 477/599 (79.6327%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 95, internal_epoch   3,  Average loss: 0.0263, Accuracy: 492/599 (82.1369%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 95, internal_epoch   4,  Average loss: 0.0277, Accuracy: 487/599 (81.3022%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 95, internal_epoch   5,  Average loss: 0.0286, Accuracy: 486/599 (81.1352%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 95, internal_epoch   6,  Average loss: 0.0230, Accuracy: 493/599 (82.3038%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 95, internal_epoch   7,  Average loss: 0.0240, Accuracy: 493/599 (82.3038%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 95, internal_epoch   8,  Average loss: 0.0237, Accuracy: 494/599 (82.4708%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 95, internal_epoch   9,  Average loss: 0.0212, Accuracy: 496/599 (82.8047%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  26, local model 95, internal_epoch  10,  Average loss: 0.0209, Accuracy: 498/599 (83.1386%), train_poison_data_count: 200
Global model norm: 87.14418166715149.
Norm before scaling: 87.13644058224865. Distance: 1.8916432184567014
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: 8.8711, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 26: Average loss: 2.2576, Accuracy: 6512/9950 (65.4472%)
Scaling by  100
Scaled Norm after poisoning: 207.0855424094111, distance: 189.1643217549229
Total norm for 4 adversaries is: 207.0855424094111. distance: 189.1643217549229
___Test Local_ResNet_18 poisoned: True, epoch: 26: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  26, local model 13, internal_epoch   1,  Average loss: 0.1809, Accuracy: 113/1645 (6.8693%)
___Train Local_ResNet_18,  epoch  26, local model 13, internal_epoch   2,  Average loss: 0.0445, Accuracy: 439/1645 (26.6869%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  26, local model 56, internal_epoch   1,  Average loss: 0.4409, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18,  epoch  26, local model 56, internal_epoch   2,  Average loss: 0.3576, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  26, local model 44, internal_epoch   1,  Average loss: 0.1792, Accuracy: 107/1750 (6.1143%)
___Train Local_ResNet_18,  epoch  26, local model 44, internal_epoch   2,  Average loss: 0.0501, Accuracy: 475/1750 (27.1429%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  26, local model 96, internal_epoch   1,  Average loss: 0.4260, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18,  epoch  26, local model 96, internal_epoch   2,  Average loss: 0.2170, Accuracy: 0/311 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  26, local model 17, internal_epoch   1,  Average loss: 0.1892, Accuracy: 120/1574 (7.6239%)
___Train Local_ResNet_18,  epoch  26, local model 17, internal_epoch   2,  Average loss: 0.0389, Accuracy: 409/1574 (25.9848%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  26, local model 25, internal_epoch   1,  Average loss: 0.2988, Accuracy: 9/690 (1.3043%)
___Train Local_ResNet_18,  epoch  26, local model 25, internal_epoch   2,  Average loss: 0.0680, Accuracy: 430/690 (62.3188%)
___Test Local_ResNet_18 poisoned: False, epoch: 26: Average loss: nan, Accuracy: 50/10000 (0.5000%)
time spent on training: 678.3354251384735
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 26: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 26: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 837.9891037940979 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:27 choose agents : [0, 20, 74, 95, 82, 35, 44, 69, 32, 36]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.1027, Accuracy: 282/1657 (17.0187%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 0, internal_epoch   2,  Average loss: 0.0352, Accuracy: 546/1657 (32.9511%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 0, internal_epoch   3,  Average loss: 0.0322, Accuracy: 566/1657 (34.1581%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 0, internal_epoch   4,  Average loss: 0.0315, Accuracy: 564/1657 (34.0374%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 0, internal_epoch   5,  Average loss: 0.0313, Accuracy: 585/1657 (35.3048%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 0, internal_epoch   6,  Average loss: 0.0318, Accuracy: 571/1657 (34.4599%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 0, internal_epoch   7,  Average loss: 0.0313, Accuracy: 609/1657 (36.7532%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 0, internal_epoch   8,  Average loss: 0.0315, Accuracy: 592/1657 (35.7272%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 0, internal_epoch   9,  Average loss: 0.0309, Accuracy: 598/1657 (36.0893%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 0, internal_epoch  10,  Average loss: 0.0310, Accuracy: 591/1657 (35.6669%), train_poison_data_count: 520
Global model norm: 87.13824213390754.
Norm before scaling: 87.10517226408687. Distance: 1.9717789011419113
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: 8.9882, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 27: Average loss: 0.6655, Accuracy: 7243/9950 (72.7940%)
Scaling by  100
Scaled Norm after poisoning: 213.32436606316213, distance: 197.17788209507677
Total norm for 4 adversaries is: 213.32436606316213. distance: 197.17788209507677
___Test Local_ResNet_18 poisoned: True, epoch: 27: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 20, internal_epoch   1,  Average loss: 0.1618, Accuracy: 39/807 (4.8327%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 20, internal_epoch   2,  Average loss: 0.0474, Accuracy: 302/807 (37.4226%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 20, internal_epoch   3,  Average loss: 0.0337, Accuracy: 393/807 (48.6989%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 20, internal_epoch   4,  Average loss: 0.0333, Accuracy: 391/807 (48.4511%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 20, internal_epoch   5,  Average loss: 0.0332, Accuracy: 391/807 (48.4511%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 20, internal_epoch   6,  Average loss: 0.0313, Accuracy: 371/807 (45.9727%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 20, internal_epoch   7,  Average loss: 0.0308, Accuracy: 380/807 (47.0880%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 20, internal_epoch   8,  Average loss: 0.0318, Accuracy: 382/807 (47.3358%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 20, internal_epoch   9,  Average loss: 0.0296, Accuracy: 415/807 (51.4250%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 20, internal_epoch  10,  Average loss: 0.0293, Accuracy: 401/807 (49.6902%), train_poison_data_count: 260
Global model norm: 87.13824213390754.
Norm before scaling: 87.11722077895966. Distance: 1.7217716359096942
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: 8.9119, Accuracy: 53/10000 (0.5300%)
___Test Local_ResNet_18 poisoned: True, epoch: 27: Average loss: 0.4285, Accuracy: 7884/9950 (79.2362%)
Scaling by  100
Scaled Norm after poisoning: 191.24671157303595, distance: 172.1771662053363
Total norm for 4 adversaries is: 191.24671157303595. distance: 172.1771662053363
___Test Local_ResNet_18 poisoned: True, epoch: 27: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 74, internal_epoch   1,  Average loss: 0.0909, Accuracy: 395/1552 (25.4510%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 74, internal_epoch   2,  Average loss: 0.0288, Accuracy: 515/1552 (33.1830%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 74, internal_epoch   3,  Average loss: 0.0258, Accuracy: 540/1552 (34.7938%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 74, internal_epoch   4,  Average loss: 0.0258, Accuracy: 547/1552 (35.2448%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 74, internal_epoch   5,  Average loss: 0.0258, Accuracy: 524/1552 (33.7629%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 74, internal_epoch   6,  Average loss: 0.0253, Accuracy: 566/1552 (36.4691%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 74, internal_epoch   7,  Average loss: 0.0245, Accuracy: 574/1552 (36.9845%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 74, internal_epoch   8,  Average loss: 0.0238, Accuracy: 564/1552 (36.3402%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 74, internal_epoch   9,  Average loss: 0.0236, Accuracy: 585/1552 (37.6933%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 74, internal_epoch  10,  Average loss: 0.0243, Accuracy: 548/1552 (35.3093%), train_poison_data_count: 496
Global model norm: 87.13824213390754.
Norm before scaling: 87.10959781361639. Distance: 1.82517336714335
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: 9.7640, Accuracy: 53/10000 (0.5300%)
___Test Local_ResNet_18 poisoned: True, epoch: 27: Average loss: 0.8220, Accuracy: 8131/9950 (81.7186%)
Scaling by  100
Scaled Norm after poisoning: 200.1835583439609, distance: 182.5173258042918
Total norm for 4 adversaries is: 200.1835583439609. distance: 182.5173258042918
___Test Local_ResNet_18 poisoned: True, epoch: 27: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 95, internal_epoch   1,  Average loss: 0.2597, Accuracy: 0/599 (0.0000%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 95, internal_epoch   2,  Average loss: 0.0772, Accuracy: 74/599 (12.3539%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 95, internal_epoch   3,  Average loss: 0.0356, Accuracy: 288/599 (48.0801%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 95, internal_epoch   4,  Average loss: 0.0340, Accuracy: 318/599 (53.0885%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 95, internal_epoch   5,  Average loss: 0.0279, Accuracy: 363/599 (60.6010%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 95, internal_epoch   6,  Average loss: 0.0276, Accuracy: 364/599 (60.7679%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 95, internal_epoch   7,  Average loss: 0.0240, Accuracy: 366/599 (61.1018%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 95, internal_epoch   8,  Average loss: 0.0246, Accuracy: 372/599 (62.1035%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 95, internal_epoch   9,  Average loss: 0.0248, Accuracy: 369/599 (61.6027%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  27, local model 95, internal_epoch  10,  Average loss: 0.0251, Accuracy: 406/599 (67.7796%), train_poison_data_count: 200
Global model norm: 87.13824213390754.
Norm before scaling: 87.11947391011381. Distance: 2.028690427421414
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: 7.4985, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 27: Average loss: 1.1214, Accuracy: 5537/9950 (55.6482%)
Scaling by  100
Scaled Norm after poisoning: 219.1126725710998, distance: 202.86904065492595
Total norm for 4 adversaries is: 219.1126725710998. distance: 202.86904065492595
___Test Local_ResNet_18 poisoned: True, epoch: 27: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  27, local model 82, internal_epoch   1,  Average loss: 0.1683, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18,  epoch  27, local model 82, internal_epoch   2,  Average loss: 0.0950, Accuracy: 8/500 (1.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  27, local model 35, internal_epoch   1,  Average loss: 0.2256, Accuracy: 0/271 (0.0000%)
___Train Local_ResNet_18,  epoch  27, local model 35, internal_epoch   2,  Average loss: 0.1558, Accuracy: 0/271 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  27, local model 44, internal_epoch   1,  Average loss: 0.1130, Accuracy: 97/1750 (5.5429%)
___Train Local_ResNet_18,  epoch  27, local model 44, internal_epoch   2,  Average loss: 0.0499, Accuracy: 391/1750 (22.3429%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  27, local model 69, internal_epoch   1,  Average loss: 0.1542, Accuracy: 0/590 (0.0000%)
___Train Local_ResNet_18,  epoch  27, local model 69, internal_epoch   2,  Average loss: 0.0398, Accuracy: 447/590 (75.7627%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  27, local model 32, internal_epoch   1,  Average loss: 0.1564, Accuracy: 15/735 (2.0408%)
___Train Local_ResNet_18,  epoch  27, local model 32, internal_epoch   2,  Average loss: 0.0471, Accuracy: 210/735 (28.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  27, local model 36, internal_epoch   1,  Average loss: 0.1852, Accuracy: 0/408 (0.0000%)
___Train Local_ResNet_18,  epoch  27, local model 36, internal_epoch   2,  Average loss: 0.1189, Accuracy: 14/408 (3.4314%)
___Test Local_ResNet_18 poisoned: False, epoch: 27: Average loss: nan, Accuracy: 50/10000 (0.5000%)
time spent on training: 656.8215084075928
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 27: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 27: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 852.0614845752716 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:28 choose agents : [0, 20, 74, 95, 57, 24, 61, 8, 46, 60]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 0, internal_epoch   1,  Average loss: 0.1114, Accuracy: 477/1657 (28.7870%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 0, internal_epoch   2,  Average loss: 0.0438, Accuracy: 536/1657 (32.3476%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 0, internal_epoch   3,  Average loss: 0.0361, Accuracy: 562/1657 (33.9167%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 0, internal_epoch   4,  Average loss: 0.0329, Accuracy: 594/1657 (35.8479%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 0, internal_epoch   5,  Average loss: 0.0344, Accuracy: 612/1657 (36.9342%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 0, internal_epoch   6,  Average loss: 0.0340, Accuracy: 566/1657 (34.1581%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 0, internal_epoch   7,  Average loss: 0.0317, Accuracy: 637/1657 (38.4430%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 0, internal_epoch   8,  Average loss: 0.0332, Accuracy: 613/1657 (36.9946%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 0, internal_epoch   9,  Average loss: 0.0319, Accuracy: 638/1657 (38.5033%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 0, internal_epoch  10,  Average loss: 0.0333, Accuracy: 639/1657 (38.5637%), train_poison_data_count: 520
Global model norm: 87.19483616089315.
Norm before scaling: 87.15106765697136. Distance: 2.003772872442063
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: 7.2223, Accuracy: 48/10000 (0.4800%)
___Test Local_ResNet_18 poisoned: True, epoch: 28: Average loss: 1.2592, Accuracy: 4088/9950 (41.0854%)
Scaling by  100
Scaled Norm after poisoning: 215.8457927549203, distance: 200.37729061385673
Total norm for 4 adversaries is: 215.8457927549203. distance: 200.37729061385673
___Test Local_ResNet_18 poisoned: True, epoch: 28: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 20, internal_epoch   1,  Average loss: 0.1667, Accuracy: 265/807 (32.8377%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 20, internal_epoch   2,  Average loss: 0.0495, Accuracy: 387/807 (47.9554%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 20, internal_epoch   3,  Average loss: 0.0451, Accuracy: 386/807 (47.8315%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 20, internal_epoch   4,  Average loss: 0.0423, Accuracy: 377/807 (46.7162%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 20, internal_epoch   5,  Average loss: 0.0438, Accuracy: 371/807 (45.9727%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 20, internal_epoch   6,  Average loss: 0.0402, Accuracy: 394/807 (48.8228%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 20, internal_epoch   7,  Average loss: 0.0395, Accuracy: 398/807 (49.3185%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 20, internal_epoch   8,  Average loss: 0.0408, Accuracy: 381/807 (47.2119%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 20, internal_epoch   9,  Average loss: 0.0377, Accuracy: 378/807 (46.8401%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 20, internal_epoch  10,  Average loss: 0.0358, Accuracy: 371/807 (45.9727%), train_poison_data_count: 260
Global model norm: 87.19483616089315.
Norm before scaling: 87.16428342324338. Distance: 1.595296147157135
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: 7.5139, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 28: Average loss: 0.9236, Accuracy: 4588/9950 (46.1106%)
Scaling by  100
Scaled Norm after poisoning: 179.62564696299634, distance: 159.52960638232642
Total norm for 4 adversaries is: 179.62564696299634. distance: 159.52960638232642
___Test Local_ResNet_18 poisoned: True, epoch: 28: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 74, internal_epoch   1,  Average loss: 0.1280, Accuracy: 352/1552 (22.6804%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 74, internal_epoch   2,  Average loss: 0.0413, Accuracy: 539/1552 (34.7294%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 74, internal_epoch   3,  Average loss: 0.0343, Accuracy: 512/1552 (32.9897%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 74, internal_epoch   4,  Average loss: 0.0304, Accuracy: 547/1552 (35.2448%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 74, internal_epoch   5,  Average loss: 0.0321, Accuracy: 546/1552 (35.1804%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 74, internal_epoch   6,  Average loss: 0.0294, Accuracy: 601/1552 (38.7242%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 74, internal_epoch   7,  Average loss: 0.0277, Accuracy: 596/1552 (38.4021%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 74, internal_epoch   8,  Average loss: 0.0292, Accuracy: 535/1552 (34.4716%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 74, internal_epoch   9,  Average loss: 0.0275, Accuracy: 587/1552 (37.8222%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 74, internal_epoch  10,  Average loss: 0.0278, Accuracy: 542/1552 (34.9227%), train_poison_data_count: 496
Global model norm: 87.19483616089315.
Norm before scaling: 87.15188004462382. Distance: 2.041113395721942
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: 7.2134, Accuracy: 48/10000 (0.4800%)
___Test Local_ResNet_18 poisoned: True, epoch: 28: Average loss: 1.2737, Accuracy: 4458/9950 (44.8040%)
Scaling by  100
Scaled Norm after poisoning: 219.31444142771355, distance: 204.1113264709972
Total norm for 4 adversaries is: 219.31444142771355. distance: 204.1113264709972
___Test Local_ResNet_18 poisoned: True, epoch: 28: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 95, internal_epoch   1,  Average loss: 0.1494, Accuracy: 198/599 (33.0551%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 95, internal_epoch   2,  Average loss: 0.0351, Accuracy: 367/599 (61.2688%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 95, internal_epoch   3,  Average loss: 0.0336, Accuracy: 401/599 (66.9449%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 95, internal_epoch   4,  Average loss: 0.0342, Accuracy: 395/599 (65.9432%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 95, internal_epoch   5,  Average loss: 0.0311, Accuracy: 408/599 (68.1135%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 95, internal_epoch   6,  Average loss: 0.0325, Accuracy: 407/599 (67.9466%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 95, internal_epoch   7,  Average loss: 0.0254, Accuracy: 415/599 (69.2821%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 95, internal_epoch   8,  Average loss: 0.0259, Accuracy: 409/599 (68.2805%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 95, internal_epoch   9,  Average loss: 0.0225, Accuracy: 394/599 (65.7763%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  28, local model 95, internal_epoch  10,  Average loss: 0.0270, Accuracy: 412/599 (68.7813%), train_poison_data_count: 200
Global model norm: 87.19483616089315.
Norm before scaling: 87.17587288063137. Distance: 1.3214988119096212
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: 8.9145, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 28: Average loss: 1.5185, Accuracy: 3334/9950 (33.5075%)
Scaling by  100
Scaled Norm after poisoning: 156.72036701558608, distance: 132.14988383224178
Total norm for 4 adversaries is: 156.72036701558608. distance: 132.14988383224178
___Test Local_ResNet_18 poisoned: True, epoch: 28: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  28, local model 57, internal_epoch   1,  Average loss: 0.4363, Accuracy: 0/1154 (0.0000%)
___Train Local_ResNet_18,  epoch  28, local model 57, internal_epoch   2,  Average loss: 0.1225, Accuracy: 193/1154 (16.7244%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  28, local model 24, internal_epoch   1,  Average loss: 0.5710, Accuracy: 0/312 (0.0000%)
___Train Local_ResNet_18,  epoch  28, local model 24, internal_epoch   2,  Average loss: 0.4254, Accuracy: 0/312 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  28, local model 61, internal_epoch   1,  Average loss: 0.9072, Accuracy: 0/85 (0.0000%)
___Train Local_ResNet_18,  epoch  28, local model 61, internal_epoch   2,  Average loss: 0.8674, Accuracy: 0/85 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  28, local model 8, internal_epoch   1,  Average loss: 0.3526, Accuracy: 0/1513 (0.0000%)
___Train Local_ResNet_18,  epoch  28, local model 8, internal_epoch   2,  Average loss: 0.1038, Accuracy: 79/1513 (5.2214%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  28, local model 46, internal_epoch   1,  Average loss: 0.3144, Accuracy: 0/1904 (0.0000%)
___Train Local_ResNet_18,  epoch  28, local model 46, internal_epoch   2,  Average loss: 0.0666, Accuracy: 415/1904 (21.7962%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  28, local model 60, internal_epoch   1,  Average loss: 0.2820, Accuracy: 45/2227 (2.0207%)
___Train Local_ResNet_18,  epoch  28, local model 60, internal_epoch   2,  Average loss: 0.0566, Accuracy: 394/2227 (17.6920%)
___Test Local_ResNet_18 poisoned: False, epoch: 28: Average loss: nan, Accuracy: 50/10000 (0.5000%)
time spent on training: 667.1486134529114
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 28: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 28: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 822.5714764595032 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:29 choose agents : [0, 20, 74, 95, 61, 27, 72, 63, 56, 11]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 0, internal_epoch   1,  Average loss: 0.0692, Accuracy: 268/1657 (16.1738%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 0, internal_epoch   2,  Average loss: 0.0486, Accuracy: 602/1657 (36.3307%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 0, internal_epoch   3,  Average loss: 0.0396, Accuracy: 662/1657 (39.9517%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 0, internal_epoch   4,  Average loss: 0.0370, Accuracy: 696/1657 (42.0036%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 0, internal_epoch   5,  Average loss: 0.0358, Accuracy: 717/1657 (43.2710%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 0, internal_epoch   6,  Average loss: 0.0352, Accuracy: 712/1657 (42.9692%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 0, internal_epoch   7,  Average loss: 0.0349, Accuracy: 721/1657 (43.5124%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 0, internal_epoch   8,  Average loss: 0.0330, Accuracy: 754/1657 (45.5039%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 0, internal_epoch   9,  Average loss: 0.0328, Accuracy: 745/1657 (44.9608%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 0, internal_epoch  10,  Average loss: 0.0342, Accuracy: 735/1657 (44.3573%), train_poison_data_count: 520
Global model norm: 87.18959450889194.
Norm before scaling: 87.15721640285301. Distance: 1.2742815555364742
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: 7.4327, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 29: Average loss: 6.8792, Accuracy: 475/9950 (4.7739%)
Scaling by  100
Scaled Norm after poisoning: 152.03018691817425, distance: 127.4281545433053
Total norm for 4 adversaries is: 152.03018691817425. distance: 127.4281545433053
___Test Local_ResNet_18 poisoned: True, epoch: 29: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 20, internal_epoch   1,  Average loss: 0.1066, Accuracy: 92/807 (11.4002%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 20, internal_epoch   2,  Average loss: 0.0877, Accuracy: 93/807 (11.5242%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 20, internal_epoch   3,  Average loss: 0.0744, Accuracy: 143/807 (17.7200%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 20, internal_epoch   4,  Average loss: 0.0706, Accuracy: 173/807 (21.4374%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 20, internal_epoch   5,  Average loss: 0.0681, Accuracy: 167/807 (20.6939%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 20, internal_epoch   6,  Average loss: 0.0658, Accuracy: 153/807 (18.9591%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 20, internal_epoch   7,  Average loss: 0.0657, Accuracy: 152/807 (18.8352%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 20, internal_epoch   8,  Average loss: 0.0608, Accuracy: 197/807 (24.4114%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 20, internal_epoch   9,  Average loss: 0.0612, Accuracy: 273/807 (33.8290%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 20, internal_epoch  10,  Average loss: 0.0595, Accuracy: 351/807 (43.4944%), train_poison_data_count: 260
Global model norm: 87.18959450889194.
Norm before scaling: 87.16667818126517. Distance: 0.9254325499725223
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: 6.4356, Accuracy: 52/10000 (0.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 29: Average loss: 9.6598, Accuracy: 317/9950 (3.1859%)
Scaling by  100
Scaled Norm after poisoning: 125.22378405778193, distance: 92.54325424497455
Total norm for 4 adversaries is: 125.22378405778193. distance: 92.54325424497455
___Test Local_ResNet_18 poisoned: True, epoch: 29: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 74, internal_epoch   1,  Average loss: 0.0719, Accuracy: 461/1552 (29.7036%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 74, internal_epoch   2,  Average loss: 0.0487, Accuracy: 544/1552 (35.0515%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 74, internal_epoch   3,  Average loss: 0.0392, Accuracy: 616/1552 (39.6907%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 74, internal_epoch   4,  Average loss: 0.0380, Accuracy: 610/1552 (39.3041%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 74, internal_epoch   5,  Average loss: 0.0359, Accuracy: 626/1552 (40.3351%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 74, internal_epoch   6,  Average loss: 0.0350, Accuracy: 643/1552 (41.4304%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 74, internal_epoch   7,  Average loss: 0.0334, Accuracy: 673/1552 (43.3634%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 74, internal_epoch   8,  Average loss: 0.0323, Accuracy: 675/1552 (43.4923%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 74, internal_epoch   9,  Average loss: 0.0320, Accuracy: 672/1552 (43.2990%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 74, internal_epoch  10,  Average loss: 0.0326, Accuracy: 661/1552 (42.5902%), train_poison_data_count: 496
Global model norm: 87.18959450889194.
Norm before scaling: 87.16217990314807. Distance: 1.4703863240922899
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: 7.5546, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 29: Average loss: 4.3116, Accuracy: 3158/9950 (31.7387%)
Scaling by  100
Scaled Norm after poisoning: 168.9025757000911, distance: 147.03862561203093
Total norm for 4 adversaries is: 168.9025757000911. distance: 147.03862561203093
___Test Local_ResNet_18 poisoned: True, epoch: 29: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 95, internal_epoch   1,  Average loss: 0.1104, Accuracy: 48/599 (8.0134%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 95, internal_epoch   2,  Average loss: 0.0810, Accuracy: 234/599 (39.0651%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 95, internal_epoch   3,  Average loss: 0.0702, Accuracy: 392/599 (65.4424%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 95, internal_epoch   4,  Average loss: 0.0700, Accuracy: 387/599 (64.6077%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 95, internal_epoch   5,  Average loss: 0.0682, Accuracy: 381/599 (63.6060%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 95, internal_epoch   6,  Average loss: 0.0665, Accuracy: 390/599 (65.1085%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 95, internal_epoch   7,  Average loss: 0.0663, Accuracy: 384/599 (64.1068%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 95, internal_epoch   8,  Average loss: 0.0657, Accuracy: 386/599 (64.4407%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 95, internal_epoch   9,  Average loss: 0.0641, Accuracy: 387/599 (64.6077%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  29, local model 95, internal_epoch  10,  Average loss: 0.0636, Accuracy: 390/599 (65.1085%), train_poison_data_count: 200
Global model norm: 87.18959450889194.
Norm before scaling: 87.18192466492839. Distance: 1.3856965501728984
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: 7.0376, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 29: Average loss: 8.0650, Accuracy: 2443/9950 (24.5528%)
Scaling by  100
Scaled Norm after poisoning: 162.72019336310106, distance: 138.56966743979362
Total norm for 4 adversaries is: 162.72019336310106. distance: 138.56966743979362
___Test Local_ResNet_18 poisoned: True, epoch: 29: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  29, local model 61, internal_epoch   1,  Average loss: 0.4766, Accuracy: 9/85 (10.5882%)
___Train Local_ResNet_18,  epoch  29, local model 61, internal_epoch   2,  Average loss: 0.4148, Accuracy: 9/85 (10.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  29, local model 27, internal_epoch   1,  Average loss: 0.2071, Accuracy: 5/1587 (0.3151%)
___Train Local_ResNet_18,  epoch  29, local model 27, internal_epoch   2,  Average loss: 0.0759, Accuracy: 307/1587 (19.3447%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  29, local model 72, internal_epoch   1,  Average loss: 0.2009, Accuracy: 0/1241 (0.0000%)
___Train Local_ResNet_18,  epoch  29, local model 72, internal_epoch   2,  Average loss: 0.0937, Accuracy: 299/1241 (24.0935%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  29, local model 63, internal_epoch   1,  Average loss: 0.2411, Accuracy: 0/888 (0.0000%)
___Train Local_ResNet_18,  epoch  29, local model 63, internal_epoch   2,  Average loss: 0.1187, Accuracy: 128/888 (14.4144%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  29, local model 56, internal_epoch   1,  Average loss: 0.3106, Accuracy: 0/186 (0.0000%)
___Train Local_ResNet_18,  epoch  29, local model 56, internal_epoch   2,  Average loss: 0.2835, Accuracy: 0/186 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  29, local model 11, internal_epoch   1,  Average loss: 0.2731, Accuracy: 0/712 (0.0000%)
___Train Local_ResNet_18,  epoch  29, local model 11, internal_epoch   2,  Average loss: 0.1276, Accuracy: 45/712 (6.3202%)
___Test Local_ResNet_18 poisoned: False, epoch: 29: Average loss: nan, Accuracy: 50/10000 (0.5000%)
time spent on training: 647.0712492465973
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 29: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 29: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 788.1496188640594 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:30 choose agents : [0, 20, 74, 95, 71, 68, 82, 96, 53, 28]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 0, internal_epoch   1,  Average loss: 0.0662, Accuracy: 546/1657 (32.9511%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 0, internal_epoch   2,  Average loss: 0.0335, Accuracy: 773/1657 (46.6506%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 0, internal_epoch   3,  Average loss: 0.0300, Accuracy: 775/1657 (46.7713%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 0, internal_epoch   4,  Average loss: 0.0299, Accuracy: 771/1657 (46.5299%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 0, internal_epoch   5,  Average loss: 0.0289, Accuracy: 778/1657 (46.9523%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 0, internal_epoch   6,  Average loss: 0.0286, Accuracy: 795/1657 (47.9783%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 0, internal_epoch   7,  Average loss: 0.0292, Accuracy: 777/1657 (46.8920%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 0, internal_epoch   8,  Average loss: 0.0294, Accuracy: 796/1657 (48.0386%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 0, internal_epoch   9,  Average loss: 0.0288, Accuracy: 785/1657 (47.3748%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 0, internal_epoch  10,  Average loss: 0.0289, Accuracy: 791/1657 (47.7369%), train_poison_data_count: 520
Global model norm: 87.13686925965955.
Norm before scaling: 87.09995885206405. Distance: 1.340846273305667
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: 7.0727, Accuracy: 49/10000 (0.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 30: Average loss: 0.5924, Accuracy: 8240/9950 (82.8141%)
Scaling by  100
Scaled Norm after poisoning: 157.3169881660115, distance: 134.08463541034448
Total norm for 4 adversaries is: 157.3169881660115. distance: 134.08463541034448
___Test Local_ResNet_18 poisoned: True, epoch: 30: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 20, internal_epoch   1,  Average loss: 0.0910, Accuracy: 260/807 (32.2181%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 20, internal_epoch   2,  Average loss: 0.0395, Accuracy: 370/807 (45.8488%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 20, internal_epoch   3,  Average loss: 0.0318, Accuracy: 474/807 (58.7361%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 20, internal_epoch   4,  Average loss: 0.0297, Accuracy: 482/807 (59.7274%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 20, internal_epoch   5,  Average loss: 0.0293, Accuracy: 482/807 (59.7274%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 20, internal_epoch   6,  Average loss: 0.0300, Accuracy: 481/807 (59.6035%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 20, internal_epoch   7,  Average loss: 0.0283, Accuracy: 485/807 (60.0991%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 20, internal_epoch   8,  Average loss: 0.0293, Accuracy: 494/807 (61.2144%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 20, internal_epoch   9,  Average loss: 0.0284, Accuracy: 493/807 (61.0905%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 20, internal_epoch  10,  Average loss: 0.0282, Accuracy: 491/807 (60.8426%), train_poison_data_count: 260
Global model norm: 87.13686925965955.
Norm before scaling: 87.11357753315495. Distance: 1.1403139291149582
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: 7.2598, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 30: Average loss: 0.3214, Accuracy: 8710/9950 (87.5377%)
Scaling by  100
Scaled Norm after poisoning: 141.63359831577745, distance: 114.03139558773934
Total norm for 4 adversaries is: 141.63359831577745. distance: 114.03139558773934
___Test Local_ResNet_18 poisoned: True, epoch: 30: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 74, internal_epoch   1,  Average loss: 0.0737, Accuracy: 486/1552 (31.3144%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 74, internal_epoch   2,  Average loss: 0.0325, Accuracy: 677/1552 (43.6211%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 74, internal_epoch   3,  Average loss: 0.0271, Accuracy: 693/1552 (44.6521%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 74, internal_epoch   4,  Average loss: 0.0255, Accuracy: 727/1552 (46.8428%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 74, internal_epoch   5,  Average loss: 0.0256, Accuracy: 719/1552 (46.3273%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 74, internal_epoch   6,  Average loss: 0.0243, Accuracy: 733/1552 (47.2294%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 74, internal_epoch   7,  Average loss: 0.0248, Accuracy: 710/1552 (45.7474%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 74, internal_epoch   8,  Average loss: 0.0235, Accuracy: 734/1552 (47.2938%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 74, internal_epoch   9,  Average loss: 0.0243, Accuracy: 721/1552 (46.4562%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 74, internal_epoch  10,  Average loss: 0.0243, Accuracy: 708/1552 (45.6186%), train_poison_data_count: 496
Global model norm: 87.13686925965955.
Norm before scaling: 87.1029495948616. Distance: 1.3629283721585987
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: 7.1400, Accuracy: 49/10000 (0.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 30: Average loss: 0.7704, Accuracy: 7465/9950 (75.0251%)
Scaling by  100
Scaled Norm after poisoning: 159.34799403546, distance: 136.29284016869704
Total norm for 4 adversaries is: 159.34799403546. distance: 136.29284016869704
___Test Local_ResNet_18 poisoned: True, epoch: 30: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 95, internal_epoch   1,  Average loss: 0.0742, Accuracy: 200/599 (33.3890%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 95, internal_epoch   2,  Average loss: 0.0313, Accuracy: 287/599 (47.9132%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 95, internal_epoch   3,  Average loss: 0.0205, Accuracy: 470/599 (78.4641%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 95, internal_epoch   4,  Average loss: 0.0196, Accuracy: 469/599 (78.2972%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 95, internal_epoch   5,  Average loss: 0.0193, Accuracy: 482/599 (80.4674%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 95, internal_epoch   6,  Average loss: 0.0186, Accuracy: 472/599 (78.7980%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 95, internal_epoch   7,  Average loss: 0.0187, Accuracy: 484/599 (80.8013%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 95, internal_epoch   8,  Average loss: 0.0200, Accuracy: 473/599 (78.9649%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 95, internal_epoch   9,  Average loss: 0.0201, Accuracy: 480/599 (80.1336%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  30, local model 95, internal_epoch  10,  Average loss: 0.0184, Accuracy: 483/599 (80.6344%), train_poison_data_count: 200
Global model norm: 87.13686925965955.
Norm before scaling: 87.12127020800517. Distance: 0.8227380768020081
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 30: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 118.41603120064656, distance: 82.27381102433964
Total norm for 4 adversaries is: 118.41603120064656. distance: 82.27381102433964
___Test Local_ResNet_18 poisoned: True, epoch: 30: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  30, local model 71, internal_epoch   1,  Average loss: 0.3112, Accuracy: 0/818 (0.0000%)
___Train Local_ResNet_18,  epoch  30, local model 71, internal_epoch   2,  Average loss: 0.1719, Accuracy: 0/818 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  30, local model 68, internal_epoch   1,  Average loss: 0.2923, Accuracy: 0/1163 (0.0000%)
___Train Local_ResNet_18,  epoch  30, local model 68, internal_epoch   2,  Average loss: 0.1054, Accuracy: 112/1163 (9.6303%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  30, local model 82, internal_epoch   1,  Average loss: 0.3296, Accuracy: 0/500 (0.0000%)
___Train Local_ResNet_18,  epoch  30, local model 82, internal_epoch   2,  Average loss: 0.2339, Accuracy: 0/500 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  30, local model 96, internal_epoch   1,  Average loss: 0.3184, Accuracy: 0/311 (0.0000%)
___Train Local_ResNet_18,  epoch  30, local model 96, internal_epoch   2,  Average loss: 0.2675, Accuracy: 0/311 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  30, local model 53, internal_epoch   1,  Average loss: 0.2997, Accuracy: 0/813 (0.0000%)
___Train Local_ResNet_18,  epoch  30, local model 53, internal_epoch   2,  Average loss: 0.1461, Accuracy: 0/813 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  30, local model 28, internal_epoch   1,  Average loss: 0.2376, Accuracy: 0/1581 (0.0000%)
___Train Local_ResNet_18,  epoch  30, local model 28, internal_epoch   2,  Average loss: 0.0838, Accuracy: 157/1581 (9.9304%)
___Test Local_ResNet_18 poisoned: False, epoch: 30: Average loss: nan, Accuracy: 50/10000 (0.5000%)
time spent on training: 649.8632235527039
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 30: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 30: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 810.070855140686 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:31 choose agents : [0, 20, 74, 95, 37, 51, 94, 15, 75, 54]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 0, internal_epoch   1,  Average loss: 0.0637, Accuracy: 397/1657 (23.9590%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 0, internal_epoch   2,  Average loss: 0.0371, Accuracy: 732/1657 (44.1762%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 0, internal_epoch   3,  Average loss: 0.0303, Accuracy: 783/1657 (47.2541%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 0, internal_epoch   4,  Average loss: 0.0296, Accuracy: 806/1657 (48.6421%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 0, internal_epoch   5,  Average loss: 0.0309, Accuracy: 771/1657 (46.5299%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 0, internal_epoch   6,  Average loss: 0.0296, Accuracy: 778/1657 (46.9523%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 0, internal_epoch   7,  Average loss: 0.0288, Accuracy: 805/1657 (48.5818%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 0, internal_epoch   8,  Average loss: 0.0297, Accuracy: 786/1657 (47.4351%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 0, internal_epoch   9,  Average loss: 0.0277, Accuracy: 813/1657 (49.0646%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 0, internal_epoch  10,  Average loss: 0.0292, Accuracy: 802/1657 (48.4007%), train_poison_data_count: 520
Global model norm: 87.07402730130696.
Norm before scaling: 87.04107888843347. Distance: 1.1773763083833302
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: 8.5619, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 31: Average loss: 7.4426, Accuracy: 3301/9950 (33.1759%)
Scaling by  100
Scaled Norm after poisoning: 143.98579845335442, distance: 117.73762955853367
Total norm for 4 adversaries is: 143.98579845335442. distance: 117.73762955853367
___Test Local_ResNet_18 poisoned: True, epoch: 31: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 20, internal_epoch   1,  Average loss: 0.0780, Accuracy: 384/807 (47.5836%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 20, internal_epoch   2,  Average loss: 0.0596, Accuracy: 414/807 (51.3011%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 20, internal_epoch   3,  Average loss: 0.0502, Accuracy: 446/807 (55.2664%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 20, internal_epoch   4,  Average loss: 0.0465, Accuracy: 454/807 (56.2577%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 20, internal_epoch   5,  Average loss: 0.0466, Accuracy: 458/807 (56.7534%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 20, internal_epoch   6,  Average loss: 0.0442, Accuracy: 471/807 (58.3643%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 20, internal_epoch   7,  Average loss: 0.0437, Accuracy: 472/807 (58.4882%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 20, internal_epoch   8,  Average loss: 0.0426, Accuracy: 477/807 (59.1078%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 20, internal_epoch   9,  Average loss: 0.0434, Accuracy: 471/807 (58.3643%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 20, internal_epoch  10,  Average loss: 0.0419, Accuracy: 480/807 (59.4796%), train_poison_data_count: 260
Global model norm: 87.07402730130696.
Norm before scaling: 87.05504050958221. Distance: 0.7785838218330039
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: 8.1730, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 31: Average loss: 4.9991, Accuracy: 4494/9950 (45.1658%)
Scaling by  100
Scaled Norm after poisoning: 115.11982972239187, distance: 77.85838569259094
Total norm for 4 adversaries is: 115.11982972239187. distance: 77.85838569259094
___Test Local_ResNet_18 poisoned: True, epoch: 31: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0643, Accuracy: 514/1552 (33.1186%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 74, internal_epoch   2,  Average loss: 0.0438, Accuracy: 653/1552 (42.0747%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 74, internal_epoch   3,  Average loss: 0.0333, Accuracy: 776/1552 (50.0000%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 74, internal_epoch   4,  Average loss: 0.0329, Accuracy: 780/1552 (50.2577%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 74, internal_epoch   5,  Average loss: 0.0318, Accuracy: 784/1552 (50.5155%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 74, internal_epoch   6,  Average loss: 0.0314, Accuracy: 779/1552 (50.1933%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 74, internal_epoch   7,  Average loss: 0.0309, Accuracy: 798/1552 (51.4175%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 74, internal_epoch   8,  Average loss: 0.0305, Accuracy: 799/1552 (51.4820%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 74, internal_epoch   9,  Average loss: 0.0303, Accuracy: 796/1552 (51.2887%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 74, internal_epoch  10,  Average loss: 0.0286, Accuracy: 800/1552 (51.5464%), train_poison_data_count: 496
Global model norm: 87.07402730130696.
Norm before scaling: 87.04436335229438. Distance: 1.2922569228577447
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: 8.1754, Accuracy: 56/10000 (0.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 31: Average loss: 5.6617, Accuracy: 4053/9950 (40.7337%)
Scaling by  100
Scaled Norm after poisoning: 153.61576965761034, distance: 129.22569887603626
Total norm for 4 adversaries is: 153.61576965761034. distance: 129.22569887603626
___Test Local_ResNet_18 poisoned: True, epoch: 31: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 95, internal_epoch   1,  Average loss: 0.0986, Accuracy: 141/599 (23.5392%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 95, internal_epoch   2,  Average loss: 0.0763, Accuracy: 402/599 (67.1119%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 95, internal_epoch   3,  Average loss: 0.0628, Accuracy: 421/599 (70.2838%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 95, internal_epoch   4,  Average loss: 0.0626, Accuracy: 430/599 (71.7863%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 95, internal_epoch   5,  Average loss: 0.0602, Accuracy: 431/599 (71.9533%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 95, internal_epoch   6,  Average loss: 0.0516, Accuracy: 445/599 (74.2905%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 95, internal_epoch   7,  Average loss: 0.0549, Accuracy: 444/599 (74.1235%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 95, internal_epoch   8,  Average loss: 0.0561, Accuracy: 447/599 (74.6244%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 95, internal_epoch   9,  Average loss: 0.0563, Accuracy: 445/599 (74.2905%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  31, local model 95, internal_epoch  10,  Average loss: 0.0551, Accuracy: 441/599 (73.6227%), train_poison_data_count: 200
Global model norm: 87.07402730130696.
Norm before scaling: 87.05827677301855. Distance: 0.6751766918418672
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 31: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 108.7231019177847, distance: 67.51766985158403
Total norm for 4 adversaries is: 108.7231019177847. distance: 67.51766985158403
___Test Local_ResNet_18 poisoned: True, epoch: 31: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  31, local model 37, internal_epoch   1,  Average loss: 0.2001, Accuracy: 0/1129 (0.0000%)
___Train Local_ResNet_18,  epoch  31, local model 37, internal_epoch   2,  Average loss: 0.0869, Accuracy: 29/1129 (2.5686%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  31, local model 51, internal_epoch   1,  Average loss: 0.2116, Accuracy: 8/1049 (0.7626%)
___Train Local_ResNet_18,  epoch  31, local model 51, internal_epoch   2,  Average loss: 0.1081, Accuracy: 120/1049 (11.4395%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  31, local model 94, internal_epoch   1,  Average loss: 0.1864, Accuracy: 0/1662 (0.0000%)
___Train Local_ResNet_18,  epoch  31, local model 94, internal_epoch   2,  Average loss: 0.0830, Accuracy: 22/1662 (1.3237%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  31, local model 15, internal_epoch   1,  Average loss: 0.2201, Accuracy: 0/1154 (0.0000%)
___Train Local_ResNet_18,  epoch  31, local model 15, internal_epoch   2,  Average loss: 0.0976, Accuracy: 21/1154 (1.8198%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  31, local model 75, internal_epoch   1,  Average loss: 0.2439, Accuracy: 0/776 (0.0000%)
___Train Local_ResNet_18,  epoch  31, local model 75, internal_epoch   2,  Average loss: 0.1314, Accuracy: 0/776 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  31, local model 54, internal_epoch   1,  Average loss: 0.2006, Accuracy: 0/1130 (0.0000%)
___Train Local_ResNet_18,  epoch  31, local model 54, internal_epoch   2,  Average loss: 0.0875, Accuracy: 8/1130 (0.7080%)
___Test Local_ResNet_18 poisoned: False, epoch: 31: Average loss: nan, Accuracy: 50/10000 (0.5000%)
time spent on training: 630.1579439640045
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 31: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 31: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 775.0186693668365 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:32 choose agents : [0, 20, 74, 95, 87, 32, 39, 72, 63, 75]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 0, internal_epoch   1,  Average loss: 0.0416, Accuracy: 704/1657 (42.4864%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 0, internal_epoch   2,  Average loss: 0.0283, Accuracy: 810/1657 (48.8835%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 0, internal_epoch   3,  Average loss: 0.0268, Accuracy: 827/1657 (49.9095%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 0, internal_epoch   4,  Average loss: 0.0265, Accuracy: 828/1657 (49.9698%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 0, internal_epoch   5,  Average loss: 0.0269, Accuracy: 825/1657 (49.7888%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 0, internal_epoch   6,  Average loss: 0.0269, Accuracy: 829/1657 (50.0302%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 0, internal_epoch   7,  Average loss: 0.0267, Accuracy: 819/1657 (49.4267%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 0, internal_epoch   8,  Average loss: 0.0265, Accuracy: 830/1657 (50.0905%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 0, internal_epoch   9,  Average loss: 0.0263, Accuracy: 820/1657 (49.4870%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 0, internal_epoch  10,  Average loss: 0.0263, Accuracy: 815/1657 (49.1853%), train_poison_data_count: 520
Global model norm: 87.00201203222974.
Norm before scaling: 86.9813001859092. Distance: 0.9143668752062915
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: 7.7299, Accuracy: 47/10000 (0.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 32: Average loss: 0.1513, Accuracy: 9813/9950 (98.6231%)
Scaling by  100
Scaled Norm after poisoning: 124.44291487465247, distance: 91.43667228777795
Total norm for 4 adversaries is: 124.44291487465247. distance: 91.43667228777795
___Test Local_ResNet_18 poisoned: True, epoch: 32: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 20, internal_epoch   1,  Average loss: 0.0698, Accuracy: 274/807 (33.9529%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 20, internal_epoch   2,  Average loss: 0.0385, Accuracy: 366/807 (45.3532%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 20, internal_epoch   3,  Average loss: 0.0331, Accuracy: 496/807 (61.4622%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 20, internal_epoch   4,  Average loss: 0.0302, Accuracy: 512/807 (63.4449%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 20, internal_epoch   5,  Average loss: 0.0311, Accuracy: 494/807 (61.2144%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 20, internal_epoch   6,  Average loss: 0.0305, Accuracy: 502/807 (62.2057%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 20, internal_epoch   7,  Average loss: 0.0292, Accuracy: 496/807 (61.4622%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 20, internal_epoch   8,  Average loss: 0.0286, Accuracy: 506/807 (62.7014%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 20, internal_epoch   9,  Average loss: 0.0279, Accuracy: 510/807 (63.1970%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 20, internal_epoch  10,  Average loss: 0.0277, Accuracy: 515/807 (63.8166%), train_poison_data_count: 260
Global model norm: 87.00201203222974.
Norm before scaling: 86.99766519855577. Distance: 1.5002996622214484
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: 6.9118, Accuracy: 48/10000 (0.4800%)
___Test Local_ResNet_18 poisoned: True, epoch: 32: Average loss: 0.6351, Accuracy: 8824/9950 (88.6834%)
Scaling by  100
Scaled Norm after poisoning: 172.56181523768518, distance: 150.02996445502146
Total norm for 4 adversaries is: 172.56181523768518. distance: 150.02996445502146
___Test Local_ResNet_18 poisoned: True, epoch: 32: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 74, internal_epoch   1,  Average loss: 0.0452, Accuracy: 609/1552 (39.2397%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 74, internal_epoch   2,  Average loss: 0.0269, Accuracy: 756/1552 (48.7113%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 74, internal_epoch   3,  Average loss: 0.0229, Accuracy: 820/1552 (52.8351%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 74, internal_epoch   4,  Average loss: 0.0225, Accuracy: 830/1552 (53.4794%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 74, internal_epoch   5,  Average loss: 0.0221, Accuracy: 832/1552 (53.6082%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 74, internal_epoch   6,  Average loss: 0.0216, Accuracy: 843/1552 (54.3170%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 74, internal_epoch   7,  Average loss: 0.0219, Accuracy: 848/1552 (54.6392%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 74, internal_epoch   8,  Average loss: 0.0217, Accuracy: 849/1552 (54.7036%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 74, internal_epoch   9,  Average loss: 0.0214, Accuracy: 844/1552 (54.3814%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 74, internal_epoch  10,  Average loss: 0.0213, Accuracy: 857/1552 (55.2191%), train_poison_data_count: 496
Global model norm: 87.00201203222974.
Norm before scaling: 86.98369998166324. Distance: 0.9465600915867469
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: 7.9287, Accuracy: 56/10000 (0.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 32: Average loss: 0.2468, Accuracy: 9400/9950 (94.4724%)
Scaling by  100
Scaled Norm after poisoning: 126.96804623851231, distance: 94.65600755168686
Total norm for 4 adversaries is: 126.96804623851231. distance: 94.65600755168686
___Test Local_ResNet_18 poisoned: True, epoch: 32: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 95, internal_epoch   1,  Average loss: 0.0555, Accuracy: 463/599 (77.2955%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 95, internal_epoch   2,  Average loss: 0.0295, Accuracy: 497/599 (82.9716%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 95, internal_epoch   3,  Average loss: 0.0251, Accuracy: 500/599 (83.4725%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 95, internal_epoch   4,  Average loss: 0.0253, Accuracy: 496/599 (82.8047%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 95, internal_epoch   5,  Average loss: 0.0239, Accuracy: 496/599 (82.8047%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 95, internal_epoch   6,  Average loss: 0.0235, Accuracy: 500/599 (83.4725%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 95, internal_epoch   7,  Average loss: 0.0235, Accuracy: 496/599 (82.8047%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 95, internal_epoch   8,  Average loss: 0.0250, Accuracy: 490/599 (81.8030%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 95, internal_epoch   9,  Average loss: 0.0218, Accuracy: 501/599 (83.6394%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  32, local model 95, internal_epoch  10,  Average loss: 0.0209, Accuracy: 500/599 (83.4725%), train_poison_data_count: 200
Global model norm: 87.00201203222974.
Norm before scaling: 86.99605437353179. Distance: 0.8229195719478523
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 32: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 119.03765324730239, distance: 82.29196070622574
Total norm for 4 adversaries is: 119.03765324730239. distance: 82.29196070622574
___Test Local_ResNet_18 poisoned: True, epoch: 32: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  32, local model 87, internal_epoch   1,  Average loss: 0.2543, Accuracy: 0/1131 (0.0000%)
___Train Local_ResNet_18,  epoch  32, local model 87, internal_epoch   2,  Average loss: 0.0855, Accuracy: 108/1131 (9.5491%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  32, local model 32, internal_epoch   1,  Average loss: 0.2957, Accuracy: 43/735 (5.8503%)
___Train Local_ResNet_18,  epoch  32, local model 32, internal_epoch   2,  Average loss: 0.1062, Accuracy: 51/735 (6.9388%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  32, local model 39, internal_epoch   1,  Average loss: 0.2285, Accuracy: 0/1013 (0.0000%)
___Train Local_ResNet_18,  epoch  32, local model 39, internal_epoch   2,  Average loss: 0.0842, Accuracy: 135/1013 (13.3268%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  32, local model 72, internal_epoch   1,  Average loss: 0.2207, Accuracy: 8/1241 (0.6446%)
___Train Local_ResNet_18,  epoch  32, local model 72, internal_epoch   2,  Average loss: 0.0776, Accuracy: 319/1241 (25.7051%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  32, local model 63, internal_epoch   1,  Average loss: 0.2704, Accuracy: 0/888 (0.0000%)
___Train Local_ResNet_18,  epoch  32, local model 63, internal_epoch   2,  Average loss: 0.0997, Accuracy: 50/888 (5.6306%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  32, local model 75, internal_epoch   1,  Average loss: 0.3076, Accuracy: 0/776 (0.0000%)
___Train Local_ResNet_18,  epoch  32, local model 75, internal_epoch   2,  Average loss: 0.1070, Accuracy: 36/776 (4.6392%)
___Test Local_ResNet_18 poisoned: False, epoch: 32: Average loss: nan, Accuracy: 50/10000 (0.5000%)
time spent on training: 661.4913289546967
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 32: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 32: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 831.0322575569153 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:33 choose agents : [0, 20, 74, 95, 11, 31, 47, 67, 32, 99]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 0, internal_epoch   1,  Average loss: 0.0453, Accuracy: 429/1657 (25.8902%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 0, internal_epoch   2,  Average loss: 0.0344, Accuracy: 788/1657 (47.5558%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 0, internal_epoch   3,  Average loss: 0.0301, Accuracy: 803/1657 (48.4611%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 0, internal_epoch   4,  Average loss: 0.0301, Accuracy: 807/1657 (48.7025%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 0, internal_epoch   5,  Average loss: 0.0307, Accuracy: 800/1657 (48.2800%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 0, internal_epoch   6,  Average loss: 0.0303, Accuracy: 798/1657 (48.1593%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 0, internal_epoch   7,  Average loss: 0.0301, Accuracy: 814/1657 (49.1249%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 0, internal_epoch   8,  Average loss: 0.0289, Accuracy: 823/1657 (49.6681%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 0, internal_epoch   9,  Average loss: 0.0287, Accuracy: 818/1657 (49.3663%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 0, internal_epoch  10,  Average loss: 0.0291, Accuracy: 812/1657 (49.0042%), train_poison_data_count: 520
Global model norm: 86.96798643214927.
Norm before scaling: 86.94779436715172. Distance: 0.956655716689398
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: 7.3929, Accuracy: 48/10000 (0.4800%)
___Test Local_ResNet_18 poisoned: True, epoch: 33: Average loss: 0.1498, Accuracy: 9719/9950 (97.6784%)
Scaling by  100
Scaled Norm after poisoning: 127.56475454279094, distance: 95.66556533374482
Total norm for 4 adversaries is: 127.56475454279094. distance: 95.66556533374482
___Test Local_ResNet_18 poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 20, internal_epoch   1,  Average loss: 0.0455, Accuracy: 322/807 (39.9009%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 20, internal_epoch   2,  Average loss: 0.0339, Accuracy: 489/807 (60.5948%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 20, internal_epoch   3,  Average loss: 0.0289, Accuracy: 510/807 (63.1970%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 20, internal_epoch   4,  Average loss: 0.0295, Accuracy: 500/807 (61.9579%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 20, internal_epoch   5,  Average loss: 0.0291, Accuracy: 500/807 (61.9579%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 20, internal_epoch   6,  Average loss: 0.0285, Accuracy: 509/807 (63.0731%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 20, internal_epoch   7,  Average loss: 0.0290, Accuracy: 502/807 (62.2057%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 20, internal_epoch   8,  Average loss: 0.0287, Accuracy: 506/807 (62.7014%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 20, internal_epoch   9,  Average loss: 0.0273, Accuracy: 514/807 (63.6927%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 20, internal_epoch  10,  Average loss: 0.0267, Accuracy: 521/807 (64.5601%), train_poison_data_count: 260
Global model norm: 86.96798643214927.
Norm before scaling: 86.9587978270816. Distance: 0.5455354906839373
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 101.73503133907464, distance: 54.55355023964985
Total norm for 4 adversaries is: 101.73503133907464. distance: 54.55355023964985
___Test Local_ResNet_18 poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 74, internal_epoch   1,  Average loss: 0.0362, Accuracy: 639/1552 (41.1727%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 74, internal_epoch   2,  Average loss: 0.0270, Accuracy: 730/1552 (47.0361%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 74, internal_epoch   3,  Average loss: 0.0231, Accuracy: 807/1552 (51.9974%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 74, internal_epoch   4,  Average loss: 0.0229, Accuracy: 817/1552 (52.6418%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 74, internal_epoch   5,  Average loss: 0.0236, Accuracy: 816/1552 (52.5773%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 74, internal_epoch   6,  Average loss: 0.0223, Accuracy: 834/1552 (53.7371%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 74, internal_epoch   7,  Average loss: 0.0217, Accuracy: 843/1552 (54.3170%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 74, internal_epoch   8,  Average loss: 0.0214, Accuracy: 843/1552 (54.3170%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 74, internal_epoch   9,  Average loss: 0.0216, Accuracy: 816/1552 (52.5773%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 74, internal_epoch  10,  Average loss: 0.0212, Accuracy: 845/1552 (54.4459%), train_poison_data_count: 496
Global model norm: 86.96798643214927.
Norm before scaling: 86.95263505028183. Distance: 0.7982648808459918
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: 7.7904, Accuracy: 59/10000 (0.5900%)
___Test Local_ResNet_18 poisoned: True, epoch: 33: Average loss: 0.2019, Accuracy: 9698/9950 (97.4673%)
Scaling by  100
Scaled Norm after poisoning: 116.64095466296347, distance: 79.82649030671146
Total norm for 4 adversaries is: 116.64095466296347. distance: 79.82649030671146
___Test Local_ResNet_18 poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 95, internal_epoch   1,  Average loss: 0.0424, Accuracy: 165/599 (27.5459%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 95, internal_epoch   2,  Average loss: 0.0307, Accuracy: 482/599 (80.4674%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 95, internal_epoch   3,  Average loss: 0.0253, Accuracy: 481/599 (80.3005%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 95, internal_epoch   4,  Average loss: 0.0251, Accuracy: 483/599 (80.6344%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 95, internal_epoch   5,  Average loss: 0.0235, Accuracy: 482/599 (80.4674%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 95, internal_epoch   6,  Average loss: 0.0225, Accuracy: 485/599 (80.9683%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 95, internal_epoch   7,  Average loss: 0.0216, Accuracy: 492/599 (82.1369%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 95, internal_epoch   8,  Average loss: 0.0227, Accuracy: 481/599 (80.3005%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 95, internal_epoch   9,  Average loss: 0.0226, Accuracy: 491/599 (81.9699%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  33, local model 95, internal_epoch  10,  Average loss: 0.0212, Accuracy: 491/599 (81.9699%), train_poison_data_count: 200
Global model norm: 86.96798643214927.
Norm before scaling: 86.96282655896714. Distance: 0.511291704272308
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 100.30808012069616, distance: 51.12916872521252
Total norm for 4 adversaries is: 100.30808012069616. distance: 51.12916872521252
___Test Local_ResNet_18 poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  33, local model 11, internal_epoch   1,  Average loss: 0.2173, Accuracy: 0/712 (0.0000%)
___Train Local_ResNet_18,  epoch  33, local model 11, internal_epoch   2,  Average loss: 0.0984, Accuracy: 0/712 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  33, local model 31, internal_epoch   1,  Average loss: 0.2254, Accuracy: 0/460 (0.0000%)
___Train Local_ResNet_18,  epoch  33, local model 31, internal_epoch   2,  Average loss: 0.1680, Accuracy: 0/460 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  33, local model 47, internal_epoch   1,  Average loss: 0.3737, Accuracy: 0/134 (0.0000%)
___Train Local_ResNet_18,  epoch  33, local model 47, internal_epoch   2,  Average loss: 0.3635, Accuracy: 0/134 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  33, local model 67, internal_epoch   1,  Average loss: 0.2230, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18,  epoch  33, local model 67, internal_epoch   2,  Average loss: 0.2025, Accuracy: 0/426 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  33, local model 32, internal_epoch   1,  Average loss: 0.1846, Accuracy: 30/735 (4.0816%)
___Train Local_ResNet_18,  epoch  33, local model 32, internal_epoch   2,  Average loss: 0.1061, Accuracy: 37/735 (5.0340%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  33, local model 99, internal_epoch   1,  Average loss: 0.2153, Accuracy: 0/773 (0.0000%)
___Train Local_ResNet_18,  epoch  33, local model 99, internal_epoch   2,  Average loss: 0.1260, Accuracy: 5/773 (0.6468%)
___Test Local_ResNet_18 poisoned: False, epoch: 33: Average loss: nan, Accuracy: 50/10000 (0.5000%)
time spent on training: 739.9630069732666
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 33: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 916.273202419281 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:34 choose agents : [0, 20, 74, 95, 67, 41, 26, 37, 19, 88]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 0, internal_epoch   1,  Average loss: 0.0468, Accuracy: 620/1657 (37.4170%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 0, internal_epoch   2,  Average loss: 0.0293, Accuracy: 784/1657 (47.3144%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 0, internal_epoch   3,  Average loss: 0.0287, Accuracy: 792/1657 (47.7972%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 0, internal_epoch   4,  Average loss: 0.0287, Accuracy: 791/1657 (47.7369%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 0, internal_epoch   5,  Average loss: 0.0284, Accuracy: 789/1657 (47.6162%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 0, internal_epoch   6,  Average loss: 0.0288, Accuracy: 789/1657 (47.6162%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 0, internal_epoch   7,  Average loss: 0.0279, Accuracy: 793/1657 (47.8576%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 0, internal_epoch   8,  Average loss: 0.0280, Accuracy: 804/1657 (48.5214%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 0, internal_epoch   9,  Average loss: 0.0282, Accuracy: 789/1657 (47.6162%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 0, internal_epoch  10,  Average loss: 0.0278, Accuracy: 797/1657 (48.0990%), train_poison_data_count: 520
Global model norm: 86.92335378707928.
Norm before scaling: 86.89305680152184. Distance: 0.9358124803907285
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: 7.5568, Accuracy: 46/10000 (0.4600%)
___Test Local_ResNet_18 poisoned: True, epoch: 34: Average loss: 0.1874, Accuracy: 9381/9950 (94.2814%)
Scaling by  100
Scaled Norm after poisoning: 125.29519051274474, distance: 93.58124394743852
Total norm for 4 adversaries is: 125.29519051274474. distance: 93.58124394743852
___Test Local_ResNet_18 poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 20, internal_epoch   1,  Average loss: 0.0635, Accuracy: 260/807 (32.2181%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 20, internal_epoch   2,  Average loss: 0.0331, Accuracy: 476/807 (58.9839%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 20, internal_epoch   3,  Average loss: 0.0281, Accuracy: 510/807 (63.1970%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 20, internal_epoch   4,  Average loss: 0.0265, Accuracy: 531/807 (65.7993%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 20, internal_epoch   5,  Average loss: 0.0263, Accuracy: 520/807 (64.4362%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 20, internal_epoch   6,  Average loss: 0.0269, Accuracy: 516/807 (63.9405%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 20, internal_epoch   7,  Average loss: 0.0261, Accuracy: 525/807 (65.0558%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 20, internal_epoch   8,  Average loss: 0.0264, Accuracy: 524/807 (64.9318%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 20, internal_epoch   9,  Average loss: 0.0260, Accuracy: 519/807 (64.3123%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 20, internal_epoch  10,  Average loss: 0.0259, Accuracy: 528/807 (65.4275%), train_poison_data_count: 260
Global model norm: 86.92335378707928.
Norm before scaling: 86.90629775708864. Distance: 0.8749636915030643
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 121.81225147486192, distance: 87.4963643217891
Total norm for 4 adversaries is: 121.81225147486192. distance: 87.4963643217891
___Test Local_ResNet_18 poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 74, internal_epoch   1,  Average loss: 0.0487, Accuracy: 543/1552 (34.9871%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 74, internal_epoch   2,  Average loss: 0.0254, Accuracy: 708/1552 (45.6186%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 74, internal_epoch   3,  Average loss: 0.0227, Accuracy: 830/1552 (53.4794%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 74, internal_epoch   4,  Average loss: 0.0224, Accuracy: 811/1552 (52.2552%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 74, internal_epoch   5,  Average loss: 0.0220, Accuracy: 806/1552 (51.9330%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 74, internal_epoch   6,  Average loss: 0.0218, Accuracy: 791/1552 (50.9665%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 74, internal_epoch   7,  Average loss: 0.0219, Accuracy: 768/1552 (49.4845%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 74, internal_epoch   8,  Average loss: 0.0212, Accuracy: 804/1552 (51.8041%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 74, internal_epoch   9,  Average loss: 0.0218, Accuracy: 781/1552 (50.3222%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 74, internal_epoch  10,  Average loss: 0.0213, Accuracy: 793/1552 (51.0954%), train_poison_data_count: 496
Global model norm: 86.92335378707928.
Norm before scaling: 86.89665872100606. Distance: 1.031876922550178
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: 8.0833, Accuracy: 62/10000 (0.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 34: Average loss: 0.1933, Accuracy: 9325/9950 (93.7186%)
Scaling by  100
Scaled Norm after poisoning: 132.7891891307421, distance: 103.18768927905111
Total norm for 4 adversaries is: 132.7891891307421. distance: 103.18768927905111
___Test Local_ResNet_18 poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 95, internal_epoch   1,  Average loss: 0.0463, Accuracy: 217/599 (36.2270%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 95, internal_epoch   2,  Average loss: 0.0261, Accuracy: 442/599 (73.7896%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 95, internal_epoch   3,  Average loss: 0.0186, Accuracy: 504/599 (84.1402%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 95, internal_epoch   4,  Average loss: 0.0189, Accuracy: 503/599 (83.9733%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 95, internal_epoch   5,  Average loss: 0.0174, Accuracy: 504/599 (84.1402%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 95, internal_epoch   6,  Average loss: 0.0182, Accuracy: 507/599 (84.6411%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 95, internal_epoch   7,  Average loss: 0.0178, Accuracy: 503/599 (83.9733%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 95, internal_epoch   8,  Average loss: 0.0178, Accuracy: 510/599 (85.1419%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 95, internal_epoch   9,  Average loss: 0.0191, Accuracy: 494/599 (82.4708%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  34, local model 95, internal_epoch  10,  Average loss: 0.0169, Accuracy: 517/599 (86.3105%), train_poison_data_count: 200
Global model norm: 86.92335378707928.
Norm before scaling: 86.91280652182392. Distance: 0.6626507281734686
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 108.25712664185208, distance: 66.26507419896058
Total norm for 4 adversaries is: 108.25712664185208. distance: 66.26507419896058
___Test Local_ResNet_18 poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  34, local model 67, internal_epoch   1,  Average loss: 0.2665, Accuracy: 0/426 (0.0000%)
___Train Local_ResNet_18,  epoch  34, local model 67, internal_epoch   2,  Average loss: 0.1990, Accuracy: 0/426 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.2421, Accuracy: 0/719 (0.0000%)
___Train Local_ResNet_18,  epoch  34, local model 41, internal_epoch   2,  Average loss: 0.1124, Accuracy: 4/719 (0.5563%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  34, local model 26, internal_epoch   1,  Average loss: 0.1966, Accuracy: 0/1446 (0.0000%)
___Train Local_ResNet_18,  epoch  34, local model 26, internal_epoch   2,  Average loss: 0.0838, Accuracy: 33/1446 (2.2822%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  34, local model 37, internal_epoch   1,  Average loss: 0.2225, Accuracy: 0/1129 (0.0000%)
___Train Local_ResNet_18,  epoch  34, local model 37, internal_epoch   2,  Average loss: 0.0858, Accuracy: 10/1129 (0.8857%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  34, local model 19, internal_epoch   1,  Average loss: 0.2204, Accuracy: 0/1036 (0.0000%)
___Train Local_ResNet_18,  epoch  34, local model 19, internal_epoch   2,  Average loss: 0.0760, Accuracy: 45/1036 (4.3436%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  34, local model 88, internal_epoch   1,  Average loss: 0.2338, Accuracy: 0/603 (0.0000%)
___Train Local_ResNet_18,  epoch  34, local model 88, internal_epoch   2,  Average loss: 0.1324, Accuracy: 0/603 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 34: Average loss: nan, Accuracy: 50/10000 (0.5000%)
time spent on training: 715.8540213108063
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 34: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 882.6654665470123 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:35 choose agents : [0, 20, 74, 95, 54, 52, 43, 8, 89, 44]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 0, internal_epoch   1,  Average loss: 0.0577, Accuracy: 390/1657 (23.5365%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 0, internal_epoch   2,  Average loss: 0.0424, Accuracy: 693/1657 (41.8226%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 0, internal_epoch   3,  Average loss: 0.0379, Accuracy: 725/1657 (43.7538%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 0, internal_epoch   4,  Average loss: 0.0374, Accuracy: 722/1657 (43.5727%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 0, internal_epoch   5,  Average loss: 0.0361, Accuracy: 752/1657 (45.3832%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 0, internal_epoch   6,  Average loss: 0.0358, Accuracy: 725/1657 (43.7538%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 0, internal_epoch   7,  Average loss: 0.0350, Accuracy: 742/1657 (44.7797%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 0, internal_epoch   8,  Average loss: 0.0340, Accuracy: 755/1657 (45.5643%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 0, internal_epoch   9,  Average loss: 0.0349, Accuracy: 745/1657 (44.9608%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 0, internal_epoch  10,  Average loss: 0.0343, Accuracy: 766/1657 (46.2281%), train_poison_data_count: 520
Global model norm: 86.85837295923174.
Norm before scaling: 86.82710291597463. Distance: 1.0084044617926045
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: 7.8123, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 35: Average loss: 1.1967, Accuracy: 8507/9950 (85.4975%)
Scaling by  100
Scaled Norm after poisoning: 130.64616305837305, distance: 100.84044773025109
Total norm for 4 adversaries is: 130.64616305837305. distance: 100.84044773025109
___Test Local_ResNet_18 poisoned: True, epoch: 35: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 20, internal_epoch   1,  Average loss: 0.0606, Accuracy: 269/807 (33.3333%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 20, internal_epoch   2,  Average loss: 0.0516, Accuracy: 423/807 (52.4164%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 20, internal_epoch   3,  Average loss: 0.0461, Accuracy: 438/807 (54.2751%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 20, internal_epoch   4,  Average loss: 0.0435, Accuracy: 455/807 (56.3817%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 20, internal_epoch   5,  Average loss: 0.0433, Accuracy: 455/807 (56.3817%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 20, internal_epoch   6,  Average loss: 0.0432, Accuracy: 446/807 (55.2664%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 20, internal_epoch   7,  Average loss: 0.0418, Accuracy: 461/807 (57.1252%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 20, internal_epoch   8,  Average loss: 0.0411, Accuracy: 466/807 (57.7447%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 20, internal_epoch   9,  Average loss: 0.0411, Accuracy: 460/807 (57.0012%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 20, internal_epoch  10,  Average loss: 0.0419, Accuracy: 456/807 (56.5056%), train_poison_data_count: 260
Global model norm: 86.85837295923174.
Norm before scaling: 86.84302187981916. Distance: 0.5809090055030655
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 35: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 103.04610618553231, distance: 58.09089851460705
Total norm for 4 adversaries is: 103.04610618553231. distance: 58.09089851460705
___Test Local_ResNet_18 poisoned: True, epoch: 35: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 74, internal_epoch   1,  Average loss: 0.0525, Accuracy: 613/1552 (39.4974%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 74, internal_epoch   2,  Average loss: 0.0411, Accuracy: 654/1552 (42.1392%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 74, internal_epoch   3,  Average loss: 0.0366, Accuracy: 713/1552 (45.9407%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 74, internal_epoch   4,  Average loss: 0.0356, Accuracy: 718/1552 (46.2629%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 74, internal_epoch   5,  Average loss: 0.0340, Accuracy: 728/1552 (46.9072%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 74, internal_epoch   6,  Average loss: 0.0319, Accuracy: 760/1552 (48.9691%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 74, internal_epoch   7,  Average loss: 0.0335, Accuracy: 737/1552 (47.4871%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 74, internal_epoch   8,  Average loss: 0.0320, Accuracy: 749/1552 (48.2603%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 74, internal_epoch   9,  Average loss: 0.0339, Accuracy: 688/1552 (44.3299%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 74, internal_epoch  10,  Average loss: 0.0326, Accuracy: 744/1552 (47.9381%), train_poison_data_count: 496
Global model norm: 86.85837295923174.
Norm before scaling: 86.82907959030776. Distance: 0.932046637843737
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: 8.4570, Accuracy: 60/10000 (0.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 35: Average loss: 2.4471, Accuracy: 7270/9950 (73.0653%)
Scaling by  100
Scaled Norm after poisoning: 125.04346509939054, distance: 93.20466391227426
Total norm for 4 adversaries is: 125.04346509939054. distance: 93.20466391227426
___Test Local_ResNet_18 poisoned: True, epoch: 35: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 95, internal_epoch   1,  Average loss: 0.0649, Accuracy: 139/599 (23.2053%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 95, internal_epoch   2,  Average loss: 0.0526, Accuracy: 433/599 (72.2871%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 95, internal_epoch   3,  Average loss: 0.0486, Accuracy: 434/599 (72.4541%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 95, internal_epoch   4,  Average loss: 0.0454, Accuracy: 445/599 (74.2905%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 95, internal_epoch   5,  Average loss: 0.0464, Accuracy: 451/599 (75.2922%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 95, internal_epoch   6,  Average loss: 0.0455, Accuracy: 437/599 (72.9549%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 95, internal_epoch   7,  Average loss: 0.0432, Accuracy: 466/599 (77.7963%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 95, internal_epoch   8,  Average loss: 0.0422, Accuracy: 468/599 (78.1302%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 95, internal_epoch   9,  Average loss: 0.0419, Accuracy: 456/599 (76.1269%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  35, local model 95, internal_epoch  10,  Average loss: 0.0408, Accuracy: 456/599 (76.1269%), train_poison_data_count: 200
Global model norm: 86.85837295923174.
Norm before scaling: 86.84702505969189. Distance: 0.5398956991503774
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 35: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 101.15847522266733, distance: 53.9895710234567
Total norm for 4 adversaries is: 101.15847522266733. distance: 53.9895710234567
___Test Local_ResNet_18 poisoned: True, epoch: 35: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  35, local model 54, internal_epoch   1,  Average loss: 0.1584, Accuracy: 0/1130 (0.0000%)
___Train Local_ResNet_18,  epoch  35, local model 54, internal_epoch   2,  Average loss: 0.0855, Accuracy: 7/1130 (0.6195%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  35, local model 52, internal_epoch   1,  Average loss: 0.1829, Accuracy: 0/636 (0.0000%)
___Train Local_ResNet_18,  epoch  35, local model 52, internal_epoch   2,  Average loss: 0.1105, Accuracy: 0/636 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  35, local model 43, internal_epoch   1,  Average loss: 0.1762, Accuracy: 0/946 (0.0000%)
___Train Local_ResNet_18,  epoch  35, local model 43, internal_epoch   2,  Average loss: 0.0975, Accuracy: 23/946 (2.4313%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.1635, Accuracy: 0/1513 (0.0000%)
___Train Local_ResNet_18,  epoch  35, local model 8, internal_epoch   2,  Average loss: 0.0937, Accuracy: 9/1513 (0.5948%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  35, local model 89, internal_epoch   1,  Average loss: 0.1782, Accuracy: 0/896 (0.0000%)
___Train Local_ResNet_18,  epoch  35, local model 89, internal_epoch   2,  Average loss: 0.1054, Accuracy: 0/896 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  35, local model 44, internal_epoch   1,  Average loss: 0.1572, Accuracy: 0/1750 (0.0000%)
___Train Local_ResNet_18,  epoch  35, local model 44, internal_epoch   2,  Average loss: 0.0852, Accuracy: 37/1750 (2.1143%)
___Test Local_ResNet_18 poisoned: False, epoch: 35: Average loss: nan, Accuracy: 50/10000 (0.5000%)
time spent on training: 724.4483151435852
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 35: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 35: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 896.1046550273895 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:36 choose agents : [0, 20, 74, 95, 5, 98, 17, 37, 3, 97]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 0, internal_epoch   1,  Average loss: 0.0365, Accuracy: 696/1657 (42.0036%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 0, internal_epoch   2,  Average loss: 0.0291, Accuracy: 801/1657 (48.3404%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 0, internal_epoch   3,  Average loss: 0.0282, Accuracy: 797/1657 (48.0990%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 0, internal_epoch   4,  Average loss: 0.0277, Accuracy: 800/1657 (48.2800%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 0, internal_epoch   5,  Average loss: 0.0281, Accuracy: 816/1657 (49.2456%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 0, internal_epoch   6,  Average loss: 0.0280, Accuracy: 816/1657 (49.2456%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 0, internal_epoch   7,  Average loss: 0.0281, Accuracy: 822/1657 (49.6077%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 0, internal_epoch   8,  Average loss: 0.0275, Accuracy: 812/1657 (49.0042%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 0, internal_epoch   9,  Average loss: 0.0274, Accuracy: 811/1657 (48.9439%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 0, internal_epoch  10,  Average loss: 0.0280, Accuracy: 795/1657 (47.9783%), train_poison_data_count: 520
Global model norm: 86.78392539538213.
Norm before scaling: 86.75903625037424. Distance: 0.6805319527881968
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: 7.6482, Accuracy: 45/10000 (0.4500%)
___Test Local_ResNet_18 poisoned: True, epoch: 36: Average loss: 0.1378, Accuracy: 9577/9950 (96.2513%)
Scaling by  100
Scaled Norm after poisoning: 108.0952451833567, distance: 68.05319466922549
Total norm for 4 adversaries is: 108.0952451833567. distance: 68.05319466922549
___Test Local_ResNet_18 poisoned: True, epoch: 36: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 20, internal_epoch   1,  Average loss: 0.0471, Accuracy: 260/807 (32.2181%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 20, internal_epoch   2,  Average loss: 0.0333, Accuracy: 477/807 (59.1078%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 20, internal_epoch   3,  Average loss: 0.0293, Accuracy: 514/807 (63.6927%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 20, internal_epoch   4,  Average loss: 0.0295, Accuracy: 511/807 (63.3209%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 20, internal_epoch   5,  Average loss: 0.0278, Accuracy: 517/807 (64.0644%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 20, internal_epoch   6,  Average loss: 0.0272, Accuracy: 515/807 (63.8166%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 20, internal_epoch   7,  Average loss: 0.0268, Accuracy: 520/807 (64.4362%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 20, internal_epoch   8,  Average loss: 0.0268, Accuracy: 520/807 (64.4362%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 20, internal_epoch   9,  Average loss: 0.0271, Accuracy: 516/807 (63.9405%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 20, internal_epoch  10,  Average loss: 0.0269, Accuracy: 506/807 (62.7014%), train_poison_data_count: 260
Global model norm: 86.78392539538213.
Norm before scaling: 86.77157456416099. Distance: 0.6549914644500539
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 36: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 107.53889194728575, distance: 65.49914270669885
Total norm for 4 adversaries is: 107.53889194728575. distance: 65.49914270669885
___Test Local_ResNet_18 poisoned: True, epoch: 36: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 74, internal_epoch   1,  Average loss: 0.0375, Accuracy: 661/1552 (42.5902%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 74, internal_epoch   2,  Average loss: 0.0249, Accuracy: 740/1552 (47.6804%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 74, internal_epoch   3,  Average loss: 0.0230, Accuracy: 843/1552 (54.3170%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 74, internal_epoch   4,  Average loss: 0.0222, Accuracy: 826/1552 (53.2216%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 74, internal_epoch   5,  Average loss: 0.0217, Accuracy: 807/1552 (51.9974%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 74, internal_epoch   6,  Average loss: 0.0215, Accuracy: 817/1552 (52.6418%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 74, internal_epoch   7,  Average loss: 0.0221, Accuracy: 829/1552 (53.4149%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 74, internal_epoch   8,  Average loss: 0.0219, Accuracy: 846/1552 (54.5103%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 74, internal_epoch   9,  Average loss: 0.0216, Accuracy: 866/1552 (55.7990%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 74, internal_epoch  10,  Average loss: 0.0219, Accuracy: 859/1552 (55.3479%), train_poison_data_count: 496
Global model norm: 86.78392539538213.
Norm before scaling: 86.76271126703136. Distance: 0.8423836205467773
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: 8.5387, Accuracy: 60/10000 (0.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 36: Average loss: 0.2363, Accuracy: 9309/9950 (93.5578%)
Scaling by  100
Scaled Norm after poisoning: 119.11543688660802, distance: 84.23836738127407
Total norm for 4 adversaries is: 119.11543688660802. distance: 84.23836738127407
___Test Local_ResNet_18 poisoned: True, epoch: 36: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 95, internal_epoch   1,  Average loss: 0.0344, Accuracy: 319/599 (53.2554%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 95, internal_epoch   2,  Average loss: 0.0235, Accuracy: 506/599 (84.4741%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 95, internal_epoch   3,  Average loss: 0.0184, Accuracy: 519/599 (86.6444%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 95, internal_epoch   4,  Average loss: 0.0204, Accuracy: 512/599 (85.4758%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 95, internal_epoch   5,  Average loss: 0.0203, Accuracy: 513/599 (85.6427%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 95, internal_epoch   6,  Average loss: 0.0202, Accuracy: 510/599 (85.1419%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 95, internal_epoch   7,  Average loss: 0.0183, Accuracy: 515/599 (85.9766%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 95, internal_epoch   8,  Average loss: 0.0214, Accuracy: 511/599 (85.3088%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 95, internal_epoch   9,  Average loss: 0.0196, Accuracy: 508/599 (84.8080%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  36, local model 95, internal_epoch  10,  Average loss: 0.0198, Accuracy: 513/599 (85.6427%), train_poison_data_count: 200
Global model norm: 86.78392539538213.
Norm before scaling: 86.77681895871586. Distance: 0.4681000495087944
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 36: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 97.8646326725084, distance: 46.81000963419176
Total norm for 4 adversaries is: 97.8646326725084. distance: 46.81000963419176
___Test Local_ResNet_18 poisoned: True, epoch: 36: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  36, local model 5, internal_epoch   1,  Average loss: 0.1645, Accuracy: 22/1628 (1.3514%)
___Train Local_ResNet_18,  epoch  36, local model 5, internal_epoch   2,  Average loss: 0.0707, Accuracy: 308/1628 (18.9189%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  36, local model 98, internal_epoch   1,  Average loss: 0.3017, Accuracy: 0/373 (0.0000%)
___Train Local_ResNet_18,  epoch  36, local model 98, internal_epoch   2,  Average loss: 0.2225, Accuracy: 0/373 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  36, local model 17, internal_epoch   1,  Average loss: 0.1928, Accuracy: 1/1574 (0.0635%)
___Train Local_ResNet_18,  epoch  36, local model 17, internal_epoch   2,  Average loss: 0.0809, Accuracy: 27/1574 (1.7154%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  36, local model 37, internal_epoch   1,  Average loss: 0.2157, Accuracy: 0/1129 (0.0000%)
___Train Local_ResNet_18,  epoch  36, local model 37, internal_epoch   2,  Average loss: 0.0909, Accuracy: 30/1129 (2.6572%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  36, local model 3, internal_epoch   1,  Average loss: 0.2550, Accuracy: 0/781 (0.0000%)
___Train Local_ResNet_18,  epoch  36, local model 3, internal_epoch   2,  Average loss: 0.1352, Accuracy: 0/781 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  36, local model 97, internal_epoch   1,  Average loss: 0.2060, Accuracy: 0/1213 (0.0000%)
___Train Local_ResNet_18,  epoch  36, local model 97, internal_epoch   2,  Average loss: 0.0832, Accuracy: 17/1213 (1.4015%)
___Test Local_ResNet_18 poisoned: False, epoch: 36: Average loss: nan, Accuracy: 50/10000 (0.5000%)
time spent on training: 739.5095596313477
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 36: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 36: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 901.7761795520782 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:37 choose agents : [0, 20, 74, 95, 44, 27, 75, 94, 3, 78]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 0, internal_epoch   1,  Average loss: 0.0393, Accuracy: 483/1657 (29.1491%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 0, internal_epoch   2,  Average loss: 0.0323, Accuracy: 749/1657 (45.2022%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 0, internal_epoch   3,  Average loss: 0.0298, Accuracy: 774/1657 (46.7109%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 0, internal_epoch   4,  Average loss: 0.0298, Accuracy: 769/1657 (46.4092%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 0, internal_epoch   5,  Average loss: 0.0295, Accuracy: 789/1657 (47.6162%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 0, internal_epoch   6,  Average loss: 0.0295, Accuracy: 774/1657 (46.7109%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 0, internal_epoch   7,  Average loss: 0.0289, Accuracy: 785/1657 (47.3748%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 0, internal_epoch   8,  Average loss: 0.0290, Accuracy: 780/1657 (47.0730%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 0, internal_epoch   9,  Average loss: 0.0288, Accuracy: 786/1657 (47.4351%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 0, internal_epoch  10,  Average loss: 0.0294, Accuracy: 764/1657 (46.1074%), train_poison_data_count: 520
Global model norm: 86.71471555930545.
Norm before scaling: 86.6921411879416. Distance: 0.7076396537413087
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: 7.5097, Accuracy: 49/10000 (0.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 37: Average loss: 0.3226, Accuracy: 9041/9950 (90.8643%)
Scaling by  100
Scaled Norm after poisoning: 109.93394678737774, distance: 70.76396381081793
Total norm for 4 adversaries is: 109.93394678737774. distance: 70.76396381081793
___Test Local_ResNet_18 poisoned: True, epoch: 37: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 20, internal_epoch   1,  Average loss: 0.0374, Accuracy: 295/807 (36.5551%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 20, internal_epoch   2,  Average loss: 0.0322, Accuracy: 501/807 (62.0818%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 20, internal_epoch   3,  Average loss: 0.0284, Accuracy: 510/807 (63.1970%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 20, internal_epoch   4,  Average loss: 0.0303, Accuracy: 484/807 (59.9752%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 20, internal_epoch   5,  Average loss: 0.0287, Accuracy: 495/807 (61.3383%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 20, internal_epoch   6,  Average loss: 0.0274, Accuracy: 506/807 (62.7014%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 20, internal_epoch   7,  Average loss: 0.0286, Accuracy: 493/807 (61.0905%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 20, internal_epoch   8,  Average loss: 0.0292, Accuracy: 488/807 (60.4709%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 20, internal_epoch   9,  Average loss: 0.0291, Accuracy: 490/807 (60.7187%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 20, internal_epoch  10,  Average loss: 0.0301, Accuracy: 488/807 (60.4709%), train_poison_data_count: 260
Global model norm: 86.71471555930545.
Norm before scaling: 86.70432312426814. Distance: 0.40694403052535
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 37: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 94.75545210237246, distance: 40.69440285626667
Total norm for 4 adversaries is: 94.75545210237246. distance: 40.69440285626667
___Test Local_ResNet_18 poisoned: True, epoch: 37: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 74, internal_epoch   1,  Average loss: 0.0322, Accuracy: 751/1552 (48.3892%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 74, internal_epoch   2,  Average loss: 0.0258, Accuracy: 751/1552 (48.3892%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 74, internal_epoch   3,  Average loss: 0.0234, Accuracy: 824/1552 (53.0928%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 74, internal_epoch   4,  Average loss: 0.0236, Accuracy: 789/1552 (50.8376%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 74, internal_epoch   5,  Average loss: 0.0236, Accuracy: 782/1552 (50.3866%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 74, internal_epoch   6,  Average loss: 0.0232, Accuracy: 795/1552 (51.2242%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 74, internal_epoch   7,  Average loss: 0.0226, Accuracy: 808/1552 (52.0619%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 74, internal_epoch   8,  Average loss: 0.0225, Accuracy: 806/1552 (51.9330%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 74, internal_epoch   9,  Average loss: 0.0221, Accuracy: 814/1552 (52.4485%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 74, internal_epoch  10,  Average loss: 0.0222, Accuracy: 787/1552 (50.7088%), train_poison_data_count: 496
Global model norm: 86.71471555930545.
Norm before scaling: 86.69464755140596. Distance: 0.6475799129027423
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: 8.2836, Accuracy: 63/10000 (0.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 37: Average loss: 0.6244, Accuracy: 8270/9950 (83.1156%)
Scaling by  100
Scaled Norm after poisoning: 106.41033857783745, distance: 64.75799299121306
Total norm for 4 adversaries is: 106.41033857783745. distance: 64.75799299121306
___Test Local_ResNet_18 poisoned: True, epoch: 37: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 95, internal_epoch   1,  Average loss: 0.0364, Accuracy: 171/599 (28.5476%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 95, internal_epoch   2,  Average loss: 0.0286, Accuracy: 491/599 (81.9699%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 95, internal_epoch   3,  Average loss: 0.0241, Accuracy: 494/599 (82.4708%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 95, internal_epoch   4,  Average loss: 0.0220, Accuracy: 491/599 (81.9699%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 95, internal_epoch   5,  Average loss: 0.0228, Accuracy: 495/599 (82.6377%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 95, internal_epoch   6,  Average loss: 0.0220, Accuracy: 504/599 (84.1402%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 95, internal_epoch   7,  Average loss: 0.0214, Accuracy: 497/599 (82.9716%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 95, internal_epoch   8,  Average loss: 0.0211, Accuracy: 511/599 (85.3088%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 95, internal_epoch   9,  Average loss: 0.0208, Accuracy: 499/599 (83.3055%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  37, local model 95, internal_epoch  10,  Average loss: 0.0225, Accuracy: 492/599 (82.1369%), train_poison_data_count: 200
Global model norm: 86.71471555930545.
Norm before scaling: 86.70795822490142. Distance: 0.45019602413493615
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 37: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 96.99857541640753, distance: 45.01960022364565
Total norm for 4 adversaries is: 96.99857541640753. distance: 45.01960022364565
___Test Local_ResNet_18 poisoned: True, epoch: 37: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  37, local model 44, internal_epoch   1,  Average loss: 0.1549, Accuracy: 0/1750 (0.0000%)
___Train Local_ResNet_18,  epoch  37, local model 44, internal_epoch   2,  Average loss: 0.0854, Accuracy: 17/1750 (0.9714%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  37, local model 27, internal_epoch   1,  Average loss: 0.1547, Accuracy: 2/1587 (0.1260%)
___Train Local_ResNet_18,  epoch  37, local model 27, internal_epoch   2,  Average loss: 0.0837, Accuracy: 19/1587 (1.1972%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  37, local model 75, internal_epoch   1,  Average loss: 0.2067, Accuracy: 0/776 (0.0000%)
___Train Local_ResNet_18,  epoch  37, local model 75, internal_epoch   2,  Average loss: 0.1153, Accuracy: 0/776 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  37, local model 94, internal_epoch   1,  Average loss: 0.1564, Accuracy: 0/1662 (0.0000%)
___Train Local_ResNet_18,  epoch  37, local model 94, internal_epoch   2,  Average loss: 0.0840, Accuracy: 19/1662 (1.1432%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  37, local model 3, internal_epoch   1,  Average loss: 0.1966, Accuracy: 0/781 (0.0000%)
___Train Local_ResNet_18,  epoch  37, local model 3, internal_epoch   2,  Average loss: 0.1248, Accuracy: 0/781 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  37, local model 78, internal_epoch   1,  Average loss: 0.2253, Accuracy: 0/416 (0.0000%)
___Train Local_ResNet_18,  epoch  37, local model 78, internal_epoch   2,  Average loss: 0.1730, Accuracy: 0/416 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 37: Average loss: nan, Accuracy: 50/10000 (0.5000%)
time spent on training: 725.8325362205505
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 37: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 37: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 881.9986751079559 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:38 choose agents : [0, 20, 74, 95, 86, 38, 50, 5, 60, 7]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 0, internal_epoch   1,  Average loss: 0.0347, Accuracy: 641/1657 (38.6844%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 0, internal_epoch   2,  Average loss: 0.0292, Accuracy: 797/1657 (48.0990%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 0, internal_epoch   3,  Average loss: 0.0281, Accuracy: 806/1657 (48.6421%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 0, internal_epoch   4,  Average loss: 0.0278, Accuracy: 804/1657 (48.5214%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 0, internal_epoch   5,  Average loss: 0.0272, Accuracy: 822/1657 (49.6077%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 0, internal_epoch   6,  Average loss: 0.0277, Accuracy: 796/1657 (48.0386%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 0, internal_epoch   7,  Average loss: 0.0276, Accuracy: 800/1657 (48.2800%), train_poison_data_count: 520
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 0, internal_epoch   8,  Average loss: 0.0276, Accuracy: 792/1657 (47.7972%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 0, internal_epoch   9,  Average loss: 0.0274, Accuracy: 801/1657 (48.3404%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 0, internal_epoch  10,  Average loss: 0.0271, Accuracy: 815/1657 (49.1853%), train_poison_data_count: 520
Global model norm: 86.65135049708545.
Norm before scaling: 86.62640916963487. Distance: 0.5897836717741722
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: 7.9827, Accuracy: 47/10000 (0.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 38: Average loss: 0.1726, Accuracy: 9444/9950 (94.9146%)
Scaling by  100
Scaled Norm after poisoning: 102.56664658741408, distance: 58.97836682976437
Total norm for 4 adversaries is: 102.56664658741408. distance: 58.97836682976437
___Test Local_ResNet_18 poisoned: True, epoch: 38: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 20 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 20, internal_epoch   1,  Average loss: 0.0447, Accuracy: 260/807 (32.2181%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 20, internal_epoch   2,  Average loss: 0.0339, Accuracy: 391/807 (48.4511%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 20, internal_epoch   3,  Average loss: 0.0280, Accuracy: 514/807 (63.6927%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 20, internal_epoch   4,  Average loss: 0.0286, Accuracy: 508/807 (62.9492%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 20, internal_epoch   5,  Average loss: 0.0274, Accuracy: 516/807 (63.9405%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 20, internal_epoch   6,  Average loss: 0.0273, Accuracy: 511/807 (63.3209%), train_poison_data_count: 260
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 20, internal_epoch   7,  Average loss: 0.0269, Accuracy: 517/807 (64.0644%), train_poison_data_count: 260
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 20, internal_epoch   8,  Average loss: 0.0262, Accuracy: 525/807 (65.0558%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 20, internal_epoch   9,  Average loss: 0.0260, Accuracy: 523/807 (64.8079%), train_poison_data_count: 260
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 20, internal_epoch  10,  Average loss: 0.0264, Accuracy: 511/807 (63.3209%), train_poison_data_count: 260
Global model norm: 86.65135049708545.
Norm before scaling: 86.63921183473306. Distance: 0.5969832377133275
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 38: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 104.0497082978852, distance: 59.69832403491848
Total norm for 4 adversaries is: 104.0497082978852. distance: 59.69832403491848
___Test Local_ResNet_18 poisoned: True, epoch: 38: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 74 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 74, internal_epoch   1,  Average loss: 0.0387, Accuracy: 542/1552 (34.9227%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 74, internal_epoch   2,  Average loss: 0.0254, Accuracy: 730/1552 (47.0361%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 74, internal_epoch   3,  Average loss: 0.0216, Accuracy: 778/1552 (50.1289%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 74, internal_epoch   4,  Average loss: 0.0213, Accuracy: 796/1552 (51.2887%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 74, internal_epoch   5,  Average loss: 0.0214, Accuracy: 823/1552 (53.0284%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 74, internal_epoch   6,  Average loss: 0.0211, Accuracy: 841/1552 (54.1881%), train_poison_data_count: 496
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 74, internal_epoch   7,  Average loss: 0.0214, Accuracy: 856/1552 (55.1546%), train_poison_data_count: 496
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 74, internal_epoch   8,  Average loss: 0.0206, Accuracy: 891/1552 (57.4098%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 74, internal_epoch   9,  Average loss: 0.0207, Accuracy: 863/1552 (55.6057%), train_poison_data_count: 496
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 74, internal_epoch  10,  Average loss: 0.0204, Accuracy: 875/1552 (56.3789%), train_poison_data_count: 496
Global model norm: 86.65135049708545.
Norm before scaling: 86.62892870780811. Distance: 0.8607532546385992
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: 8.7140, Accuracy: 60/10000 (0.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 38: Average loss: 0.2668, Accuracy: 9127/9950 (91.7286%)
Scaling by  100
Scaled Norm after poisoning: 120.22828221242288, distance: 86.07532697621602
Total norm for 4 adversaries is: 120.22828221242288. distance: 86.07532697621602
___Test Local_ResNet_18 poisoned: True, epoch: 38: Average loss: nan, Accuracy: 0/9950 (0.0000%)
poison local model 95 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 95, internal_epoch   1,  Average loss: 0.0315, Accuracy: 236/599 (39.3990%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 95, internal_epoch   2,  Average loss: 0.0209, Accuracy: 514/599 (85.8097%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 95, internal_epoch   3,  Average loss: 0.0197, Accuracy: 504/599 (84.1402%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 95, internal_epoch   4,  Average loss: 0.0168, Accuracy: 517/599 (86.3105%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 95, internal_epoch   5,  Average loss: 0.0174, Accuracy: 507/599 (84.6411%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 95, internal_epoch   6,  Average loss: 0.0173, Accuracy: 510/599 (85.1419%), train_poison_data_count: 200
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 95, internal_epoch   7,  Average loss: 0.0183, Accuracy: 509/599 (84.9750%), train_poison_data_count: 200
Current lr: [1.0000000000000002e-06]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 95, internal_epoch   8,  Average loss: 0.0175, Accuracy: 507/599 (84.6411%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 95, internal_epoch   9,  Average loss: 0.0176, Accuracy: 514/599 (85.8097%), train_poison_data_count: 200
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  38, local model 95, internal_epoch  10,  Average loss: 0.0179, Accuracy: 506/599 (84.4741%), train_poison_data_count: 200
Global model norm: 86.65135049708545.
Norm before scaling: 86.64461639814242. Distance: 0.43940217464514
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 38: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 96.45270355691177, distance: 43.940218454754664
Total norm for 4 adversaries is: 96.45270355691177. distance: 43.940218454754664
___Test Local_ResNet_18 poisoned: True, epoch: 38: Average loss: nan, Accuracy: 0/9950 (0.0000%)
___Train Local_ResNet_18,  epoch  38, local model 86, internal_epoch   1,  Average loss: 0.1865, Accuracy: 0/1003 (0.0000%)
___Train Local_ResNet_18,  epoch  38, local model 86, internal_epoch   2,  Average loss: 0.0956, Accuracy: 18/1003 (1.7946%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  38, local model 38, internal_epoch   1,  Average loss: 0.1898, Accuracy: 0/1131 (0.0000%)
___Train Local_ResNet_18,  epoch  38, local model 38, internal_epoch   2,  Average loss: 0.1005, Accuracy: 8/1131 (0.7073%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  38, local model 50, internal_epoch   1,  Average loss: 0.2055, Accuracy: 0/809 (0.0000%)
___Train Local_ResNet_18,  epoch  38, local model 50, internal_epoch   2,  Average loss: 0.1143, Accuracy: 1/809 (0.1236%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  38, local model 5, internal_epoch   1,  Average loss: 0.1413, Accuracy: 3/1628 (0.1843%)
___Train Local_ResNet_18,  epoch  38, local model 5, internal_epoch   2,  Average loss: 0.0682, Accuracy: 291/1628 (17.8747%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  38, local model 60, internal_epoch   1,  Average loss: 0.1472, Accuracy: 62/2227 (2.7840%)
___Train Local_ResNet_18,  epoch  38, local model 60, internal_epoch   2,  Average loss: 0.0754, Accuracy: 64/2227 (2.8738%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Train Local_ResNet_18,  epoch  38, local model 7, internal_epoch   1,  Average loss: 0.1903, Accuracy: 0/891 (0.0000%)
___Train Local_ResNet_18,  epoch  38, local model 7, internal_epoch   2,  Average loss: 0.1021, Accuracy: 2/891 (0.2245%)
___Test Local_ResNet_18 poisoned: False, epoch: 38: Average loss: nan, Accuracy: 50/10000 (0.5000%)
time spent on training: 689.9208197593689
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 38: Average loss: nan, Accuracy: 50/10000 (0.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 38: Average loss: nan, Accuracy: 0/9950 (0.0000%)
Done in 838.2669785022736 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:39 choose agents : [0, 20, 74, 95, 47, 49, 2, 29, 21, 66]. Adversary List: [0, 20, 74, 95]
poison local model 0 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.001]
___PoisonTrain Local_ResNet_18 ,  epoch  39, local model 0, internal_epoch   1,  Average loss: 0.0395, Accuracy: 507/1657 (30.5975%), train_poison_data_count: 520
Current lr: [1e-05]
___PoisonTrain Local_ResNet_18 ,  epoch  39, local model 0, internal_epoch   2,  Average loss: 0.0306, Accuracy: 780/1657 (47.0730%), train_poison_data_count: 520
Current lr: [0.0001]
___PoisonTrain Local_ResNet_18 ,  epoch  39, local model 0, internal_epoch   3,  Average loss: 0.0281, Accuracy: 793/1657 (47.8576%), train_poison_data_count: 520
