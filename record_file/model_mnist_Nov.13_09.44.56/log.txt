current path: saved_models/model_mnist_Nov.13_09.44.56
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [41, 73, 51, 74]
We use following environment for graphs:  mnist_DBA
----------------------------------Start one training epoch------------------------------------------
Server Epoch:11 choose agents : [41, 73, 51, 74, 23, 76, 63, 11, 75, 43]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   1,  Average loss: 0.0240, Accuracy: 353/606 (58.2508%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   2,  Average loss: 0.0115, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   3,  Average loss: 0.0065, Accuracy: 540/606 (89.1089%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   4,  Average loss: 0.0040, Accuracy: 551/606 (90.9241%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   5,  Average loss: 0.0035, Accuracy: 563/606 (92.9043%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   6,  Average loss: 0.0028, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   7,  Average loss: 0.0027, Accuracy: 576/606 (95.0495%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   8,  Average loss: 0.0024, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   9,  Average loss: 0.0026, Accuracy: 578/606 (95.3795%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch  10,  Average loss: 0.0019, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Global model norm: 16.539532092117113.
Norm before scaling: 16.866378729452048. Distance: 4.7374227552734425
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.9674, Accuracy: 6700/10000 (67.0000%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0510, Accuracy: 8823/8968 (98.3831%)
Scaling by  100
Scaled Norm after poisoning: 472.81373512726975, distance: 473.7422492769671
Total norm for 4 adversaries is: 472.81373512726975. distance: 473.7422492769671
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0234, Accuracy: 360/591 (60.9137%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   2,  Average loss: 0.0137, Accuracy: 367/591 (62.0981%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   3,  Average loss: 0.0040, Accuracy: 547/591 (92.5550%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   4,  Average loss: 0.0037, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   5,  Average loss: 0.0032, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   6,  Average loss: 0.0025, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   7,  Average loss: 0.0021, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   8,  Average loss: 0.0021, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   9,  Average loss: 0.0017, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch  10,  Average loss: 0.0017, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Global model norm: 16.539532092117113.
Norm before scaling: 16.75489485090383. Distance: 4.1600881651558925
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.5478, Accuracy: 8261/10000 (82.6100%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0454, Accuracy: 8863/8968 (98.8292%)
Scaling by  100
Scaled Norm after poisoning: 415.11837543645305, distance: 416.00880774930715
Total norm for 4 adversaries is: 415.11837543645305. distance: 416.00880774930715
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0239, Accuracy: 323/568 (56.8662%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   2,  Average loss: 0.0101, Accuracy: 421/568 (74.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   3,  Average loss: 0.0050, Accuracy: 525/568 (92.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   4,  Average loss: 0.0038, Accuracy: 534/568 (94.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   5,  Average loss: 0.0029, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   6,  Average loss: 0.0027, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   7,  Average loss: 0.0022, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   8,  Average loss: 0.0019, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   9,  Average loss: 0.0019, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch  10,  Average loss: 0.0018, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.81629328141498. Distance: 4.6102122435460595
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.9364, Accuracy: 6755/10000 (67.5500%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0756, Accuracy: 8732/8968 (97.3684%)
Scaling by  100
Scaled Norm after poisoning: 460.01289044438744, distance: 461.02123391987055
Total norm for 4 adversaries is: 460.01289044438744. distance: 461.02123391987055
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0267, Accuracy: 303/557 (54.3986%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   2,  Average loss: 0.0120, Accuracy: 388/557 (69.6589%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   3,  Average loss: 0.0056, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   4,  Average loss: 0.0044, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   5,  Average loss: 0.0035, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   6,  Average loss: 0.0034, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   7,  Average loss: 0.0024, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   8,  Average loss: 0.0026, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   9,  Average loss: 0.0022, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch  10,  Average loss: 0.0026, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.85138864653018. Distance: 4.816771160079056
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.9700, Accuracy: 7377/10000 (73.7700%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0550, Accuracy: 8779/8968 (97.8925%)
Scaling by  100
Scaled Norm after poisoning: 480.6324771850109, distance: 481.67709944007095
Total norm for 4 adversaries is: 480.6324771850109. distance: 481.67709944007095
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1213, Accuracy: 9577/10000 (95.7700%)
___Train Local_Simple,  epoch  11, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.0957, Accuracy: 9719/10000 (97.1900%)
___Train Local_Simple,  epoch  11, local model 63, internal_epoch   1,  Average loss: 0.0020, Accuracy: 857/889 (96.4004%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1366, Accuracy: 9601/10000 (96.0100%)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0017, Accuracy: 626/645 (97.0543%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1996, Accuracy: 9381/10000 (93.8100%)
___Train Local_Simple,  epoch  11, local model 75, internal_epoch   1,  Average loss: 0.0010, Accuracy: 669/686 (97.5219%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1799, Accuracy: 9447/10000 (94.4700%)
___Train Local_Simple,  epoch  11, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 398/408 (97.5490%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3283, Accuracy: 8975/10000 (89.7500%)
time spent on training: 135.5118546485901
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.43638413831986467  data num: [606, 591, 568, 557, 293, 78, 889, 645, 686, 408]
[foolsgold agg] considering poison per batch poison_fraction: 0.13637004322495772
[foolsgold agg] wv: [1.         1.         0.99539277 0.99539277 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 0.0838, Accuracy: 9730/10000 (97.3000%)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 12.2632, Accuracy: 41/8968 (0.4572%)
Done in 160.4590015411377 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:12 choose agents : [41, 73, 51, 74, 46, 37, 21, 43, 35, 11]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0260, Accuracy: 332/606 (54.7855%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   2,  Average loss: 0.0106, Accuracy: 437/606 (72.1122%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   3,  Average loss: 0.0047, Accuracy: 555/606 (91.5842%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   4,  Average loss: 0.0037, Accuracy: 562/606 (92.7393%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   5,  Average loss: 0.0030, Accuracy: 571/606 (94.2244%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   6,  Average loss: 0.0030, Accuracy: 570/606 (94.0594%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   7,  Average loss: 0.0023, Accuracy: 578/606 (95.3795%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   8,  Average loss: 0.0022, Accuracy: 582/606 (96.0396%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   9,  Average loss: 0.0019, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch  10,  Average loss: 0.0020, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Global model norm: 16.544515036204693.
Norm before scaling: 16.945063967748652. Distance: 5.196404960327741
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.9733, Accuracy: 6836/10000 (68.3600%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0348, Accuracy: 8850/8968 (98.6842%)
Scaling by  100
Scaled Norm after poisoning: 518.5953082606899, distance: 519.6405007310342
Total norm for 4 adversaries is: 518.5953082606899. distance: 519.6405007310342
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   1,  Average loss: 0.0239, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   2,  Average loss: 0.0126, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   3,  Average loss: 0.0041, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   4,  Average loss: 0.0035, Accuracy: 549/591 (92.8934%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   5,  Average loss: 0.0025, Accuracy: 561/591 (94.9239%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   6,  Average loss: 0.0021, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   7,  Average loss: 0.0018, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   8,  Average loss: 0.0014, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   9,  Average loss: 0.0013, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch  10,  Average loss: 0.0013, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Global model norm: 16.544515036204693.
Norm before scaling: 16.818104316851528. Distance: 4.045562884913067
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.4007, Accuracy: 8793/10000 (87.9300%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0941, Accuracy: 8613/8968 (96.0415%)
Scaling by  100
Scaled Norm after poisoning: 403.9995165529286, distance: 404.55629629879695
Total norm for 4 adversaries is: 403.9995165529286. distance: 404.55629629879695
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   1,  Average loss: 0.0220, Accuracy: 346/568 (60.9155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   2,  Average loss: 0.0081, Accuracy: 467/568 (82.2183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   3,  Average loss: 0.0039, Accuracy: 529/568 (93.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   4,  Average loss: 0.0035, Accuracy: 529/568 (93.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   5,  Average loss: 0.0035, Accuracy: 532/568 (93.6620%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   6,  Average loss: 0.0030, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   7,  Average loss: 0.0027, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   8,  Average loss: 0.0023, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   9,  Average loss: 0.0018, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch  10,  Average loss: 0.0019, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Global model norm: 16.544515036204693.
Norm before scaling: 16.80866138073194. Distance: 4.516577385915023
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.0311, Accuracy: 6183/10000 (61.8300%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0663, Accuracy: 8754/8968 (97.6137%)
Scaling by  100
Scaled Norm after poisoning: 450.67674806894576, distance: 451.65774514559143
Total norm for 4 adversaries is: 450.67674806894576. distance: 451.65774514559143
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   1,  Average loss: 0.0239, Accuracy: 314/557 (56.3734%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   2,  Average loss: 0.0102, Accuracy: 427/557 (76.6607%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   3,  Average loss: 0.0038, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   4,  Average loss: 0.0031, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   5,  Average loss: 0.0027, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   6,  Average loss: 0.0024, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   7,  Average loss: 0.0024, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch  10,  Average loss: 0.0020, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Global model norm: 16.544515036204693.
Norm before scaling: 16.763853806138783. Distance: 4.162269993747942
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.7586, Accuracy: 7761/10000 (77.6100%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0441, Accuracy: 8813/8968 (98.2716%)
Scaling by  100
Scaled Norm after poisoning: 415.3513760961916, distance: 416.227007623244
Total norm for 4 adversaries is: 415.3513760961916. distance: 416.227007623244
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  12, local model 46, internal_epoch   1,  Average loss: 0.0035, Accuracy: 674/710 (94.9296%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2241, Accuracy: 9308/10000 (93.0800%)
___Train Local_Simple,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 841/860 (97.7907%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.4865, Accuracy: 8503/10000 (85.0300%)
___Train Local_Simple,  epoch  12, local model 21, internal_epoch   1,  Average loss: 0.0014, Accuracy: 304/312 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2520, Accuracy: 9259/10000 (92.5900%)
___Train Local_Simple,  epoch  12, local model 43, internal_epoch   1,  Average loss: 0.0017, Accuracy: 395/408 (96.8137%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2927, Accuracy: 9069/10000 (90.6900%)
___Train Local_Simple,  epoch  12, local model 35, internal_epoch   1,  Average loss: 0.0006, Accuracy: 491/499 (98.3968%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3236, Accuracy: 9042/10000 (90.4200%)
___Train Local_Simple,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 629/645 (97.5194%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2117, Accuracy: 9351/10000 (93.5100%)
time spent on training: 131.55151987075806
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4034051424600417  data num: [606, 591, 568, 557, 710, 860, 312, 408, 499, 645]
[foolsgold agg] considering poison per batch poison_fraction: 0.12606410701876303
[foolsgold agg] wv: [1.         1.         0.61576209 0.61576209 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 0.0837, Accuracy: 9729/10000 (97.2900%)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 12.2697, Accuracy: 42/8968 (0.4683%)
Done in 156.54203987121582 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:13 choose agents : [41, 73, 51, 74, 61, 64, 28, 67, 22, 82]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0238, Accuracy: 348/606 (57.4257%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   2,  Average loss: 0.0121, Accuracy: 384/606 (63.3663%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   3,  Average loss: 0.0046, Accuracy: 548/606 (90.4290%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   4,  Average loss: 0.0040, Accuracy: 559/606 (92.2442%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   5,  Average loss: 0.0031, Accuracy: 573/606 (94.5545%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   6,  Average loss: 0.0027, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   7,  Average loss: 0.0025, Accuracy: 584/606 (96.3696%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   8,  Average loss: 0.0022, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   9,  Average loss: 0.0023, Accuracy: 581/606 (95.8746%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch  10,  Average loss: 0.0023, Accuracy: 580/606 (95.7096%), train_poison_data_count: 200
Global model norm: 16.548496991737554.
Norm before scaling: 16.89859551908318. Distance: 4.948249222137046
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.1858, Accuracy: 6378/10000 (63.7800%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0303, Accuracy: 8889/8968 (99.1191%)
Scaling by  100
Scaled Norm after poisoning: 493.8096957583964, distance: 494.8249059010672
Total norm for 4 adversaries is: 493.8096957583964. distance: 494.8249059010672
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   1,  Average loss: 0.0226, Accuracy: 370/591 (62.6058%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   2,  Average loss: 0.0114, Accuracy: 419/591 (70.8968%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   3,  Average loss: 0.0045, Accuracy: 548/591 (92.7242%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   4,  Average loss: 0.0042, Accuracy: 543/591 (91.8782%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   5,  Average loss: 0.0043, Accuracy: 534/591 (90.3553%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   6,  Average loss: 0.0034, Accuracy: 545/591 (92.2166%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   7,  Average loss: 0.0029, Accuracy: 551/591 (93.2318%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   8,  Average loss: 0.0022, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   9,  Average loss: 0.0020, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch  10,  Average loss: 0.0023, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Global model norm: 16.548496991737554.
Norm before scaling: 16.769242350615365. Distance: 4.302235869258152
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.7827, Accuracy: 7321/10000 (73.2100%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0210, Accuracy: 8915/8968 (99.4090%)
Scaling by  100
Scaled Norm after poisoning: 429.24441245635336, distance: 430.2235973886137
Total norm for 4 adversaries is: 429.24441245635336. distance: 430.2235973886137
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   1,  Average loss: 0.0244, Accuracy: 333/568 (58.6268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   2,  Average loss: 0.0097, Accuracy: 422/568 (74.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   3,  Average loss: 0.0043, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   4,  Average loss: 0.0027, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   5,  Average loss: 0.0021, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   6,  Average loss: 0.0020, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   7,  Average loss: 0.0018, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   8,  Average loss: 0.0017, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   9,  Average loss: 0.0015, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch  10,  Average loss: 0.0016, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Global model norm: 16.548496991737554.
Norm before scaling: 16.946608230486067. Distance: 5.068873784709233
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.9033, Accuracy: 6963/10000 (69.6300%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0787, Accuracy: 8724/8968 (97.2792%)
Scaling by  100
Scaled Norm after poisoning: 505.9375424644825, distance: 506.88736113164236
Total norm for 4 adversaries is: 505.9375424644825. distance: 506.88736113164236
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   1,  Average loss: 0.0259, Accuracy: 322/557 (57.8097%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   2,  Average loss: 0.0105, Accuracy: 424/557 (76.1221%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   3,  Average loss: 0.0040, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   4,  Average loss: 0.0031, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   5,  Average loss: 0.0031, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   6,  Average loss: 0.0026, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   7,  Average loss: 0.0024, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   8,  Average loss: 0.0019, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Global model norm: 16.548496991737554.
Norm before scaling: 16.91432682385843. Distance: 4.834437518217989
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.7710, Accuracy: 7887/10000 (78.8700%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0531, Accuracy: 8778/8968 (97.8814%)
Scaling by  100
Scaled Norm after poisoning: 482.57510749623214, distance: 483.4437984399014
Total norm for 4 adversaries is: 482.57510749623214. distance: 483.4437984399014
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  13, local model 61, internal_epoch   1,  Average loss: 0.0015, Accuracy: 680/699 (97.2818%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2869, Accuracy: 9061/10000 (90.6100%)
___Train Local_Simple,  epoch  13, local model 64, internal_epoch   1,  Average loss: 0.0019, Accuracy: 782/813 (96.1870%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.4160, Accuracy: 8471/10000 (84.7100%)
___Train Local_Simple,  epoch  13, local model 28, internal_epoch   1,  Average loss: 0.0016, Accuracy: 487/501 (97.2056%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1459, Accuracy: 9524/10000 (95.2400%)
___Train Local_Simple,  epoch  13, local model 67, internal_epoch   1,  Average loss: 0.0014, Accuracy: 972/998 (97.3948%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3146, Accuracy: 8967/10000 (89.6700%)
___Train Local_Simple,  epoch  13, local model 22, internal_epoch   1,  Average loss: 0.0016, Accuracy: 566/583 (97.0840%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2402, Accuracy: 9266/10000 (92.6600%)
___Train Local_Simple,  epoch  13, local model 82, internal_epoch   1,  Average loss: 0.0015, Accuracy: 691/713 (96.9144%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2804, Accuracy: 9034/10000 (90.3400%)
time spent on training: 128.1743414402008
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.35027907678382864  data num: [606, 591, 568, 557, 699, 813, 501, 998, 583, 713]
[foolsgold agg] considering poison per batch poison_fraction: 0.10946221149494645
[foolsgold agg] wv: [1.        1.        0.8875443 0.8875443 1.        1.        1.
 1.        1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 0.0834, Accuracy: 9730/10000 (97.3000%)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 12.2048, Accuracy: 43/8968 (0.4795%)
Done in 153.86344599723816 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:14 choose agents : [41, 73, 51, 74, 60, 42, 85, 56, 57, 63]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   1,  Average loss: 0.0232, Accuracy: 378/606 (62.3762%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   2,  Average loss: 0.0112, Accuracy: 434/606 (71.6172%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   3,  Average loss: 0.0049, Accuracy: 559/606 (92.2442%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   4,  Average loss: 0.0042, Accuracy: 562/606 (92.7393%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   5,  Average loss: 0.0034, Accuracy: 569/606 (93.8944%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   6,  Average loss: 0.0036, Accuracy: 561/606 (92.5743%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   7,  Average loss: 0.0029, Accuracy: 572/606 (94.3894%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   8,  Average loss: 0.0024, Accuracy: 576/606 (95.0495%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   9,  Average loss: 0.0025, Accuracy: 574/606 (94.7195%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch  10,  Average loss: 0.0027, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Global model norm: 16.55285686256303.
Norm before scaling: 16.933613123547165. Distance: 5.186945506415451
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.2665, Accuracy: 5545/10000 (55.4500%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0152, Accuracy: 8928/8968 (99.5540%)
Scaling by  100
Scaled Norm after poisoning: 517.5930773783591, distance: 518.6945753523937
Total norm for 4 adversaries is: 517.5930773783591. distance: 518.6945753523937
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   1,  Average loss: 0.0265, Accuracy: 348/591 (58.8832%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   2,  Average loss: 0.0138, Accuracy: 371/591 (62.7750%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   3,  Average loss: 0.0062, Accuracy: 513/591 (86.8020%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   4,  Average loss: 0.0062, Accuracy: 503/591 (85.1100%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   5,  Average loss: 0.0046, Accuracy: 529/591 (89.5093%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   6,  Average loss: 0.0038, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   7,  Average loss: 0.0036, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   8,  Average loss: 0.0028, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   9,  Average loss: 0.0025, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch  10,  Average loss: 0.0027, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Global model norm: 16.55285686256303.
Norm before scaling: 17.008200070228074. Distance: 5.259432357502521
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.8067, Accuracy: 7227/10000 (72.2700%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0433, Accuracy: 8842/8968 (98.5950%)
Scaling by  100
Scaled Norm after poisoning: 525.0259814999635, distance: 525.9432300638539
Total norm for 4 adversaries is: 525.0259814999635. distance: 525.9432300638539
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   1,  Average loss: 0.0229, Accuracy: 331/568 (58.2746%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   2,  Average loss: 0.0075, Accuracy: 487/568 (85.7394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   3,  Average loss: 0.0046, Accuracy: 519/568 (91.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   4,  Average loss: 0.0037, Accuracy: 534/568 (94.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   5,  Average loss: 0.0028, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   6,  Average loss: 0.0028, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   7,  Average loss: 0.0026, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   8,  Average loss: 0.0021, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   9,  Average loss: 0.0020, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch  10,  Average loss: 0.0018, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Global model norm: 16.55285686256303.
Norm before scaling: 16.79506712654511. Distance: 4.427945664138781
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.8932, Accuracy: 6700/10000 (67.0000%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0332, Accuracy: 8882/8968 (99.0410%)
Scaling by  100
Scaled Norm after poisoning: 441.8009308500832, distance: 442.79457003219903
Total norm for 4 adversaries is: 441.8009308500832. distance: 442.79457003219903
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0247, Accuracy: 326/557 (58.5278%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   2,  Average loss: 0.0112, Accuracy: 382/557 (68.5817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   3,  Average loss: 0.0044, Accuracy: 502/557 (90.1257%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   4,  Average loss: 0.0041, Accuracy: 520/557 (93.3573%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   5,  Average loss: 0.0037, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   6,  Average loss: 0.0027, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   7,  Average loss: 0.0030, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   8,  Average loss: 0.0025, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   9,  Average loss: 0.0022, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch  10,  Average loss: 0.0022, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Global model norm: 16.55285686256303.
Norm before scaling: 16.781377298167083. Distance: 4.369846687682823
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.7792, Accuracy: 7742/10000 (77.4200%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0559, Accuracy: 8756/8968 (97.6360%)
Scaling by  100
Scaled Norm after poisoning: 435.9836937891141, distance: 436.9846607719772
Total norm for 4 adversaries is: 435.9836937891141. distance: 436.9846607719772
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  14, local model 60, internal_epoch   1,  Average loss: 0.0017, Accuracy: 327/338 (96.7456%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1239, Accuracy: 9627/10000 (96.2700%)
___Train Local_Simple,  epoch  14, local model 42, internal_epoch   1,  Average loss: 0.0013, Accuracy: 232/236 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1115, Accuracy: 9659/10000 (96.5900%)
___Train Local_Simple,  epoch  14, local model 85, internal_epoch   1,  Average loss: 0.0007, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1461, Accuracy: 9538/10000 (95.3800%)
___Train Local_Simple,  epoch  14, local model 56, internal_epoch   1,  Average loss: 0.0017, Accuracy: 854/880 (97.0455%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1404, Accuracy: 9562/10000 (95.6200%)
___Train Local_Simple,  epoch  14, local model 57, internal_epoch   1,  Average loss: 0.0022, Accuracy: 331/343 (96.5015%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3649, Accuracy: 9024/10000 (90.2400%)
___Train Local_Simple,  epoch  14, local model 63, internal_epoch   1,  Average loss: 0.0022, Accuracy: 846/889 (95.1631%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1428, Accuracy: 9550/10000 (95.5000%)
time spent on training: 127.21312952041626
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.42691671263099834  data num: [606, 591, 568, 557, 338, 236, 431, 880, 343, 889]
[foolsgold agg] considering poison per batch poison_fraction: 0.13341147269718698
[foolsgold agg] wv: [1.        1.        0.7574662 0.7574662 1.        1.        1.
 1.        1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 0.0831, Accuracy: 9732/10000 (97.3200%)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 12.1656, Accuracy: 46/8968 (0.5129%)
Done in 152.91487574577332 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:15 choose agents : [41, 73, 51, 74, 77, 18, 43, 91, 42, 52]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   1,  Average loss: 0.0216, Accuracy: 382/606 (63.0363%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   2,  Average loss: 0.0085, Accuracy: 465/606 (76.7327%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   3,  Average loss: 0.0028, Accuracy: 571/606 (94.2244%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   4,  Average loss: 0.0030, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   5,  Average loss: 0.0025, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   6,  Average loss: 0.0025, Accuracy: 582/606 (96.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   7,  Average loss: 0.0019, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   8,  Average loss: 0.0018, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   9,  Average loss: 0.0014, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch  10,  Average loss: 0.0014, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Global model norm: 16.55707550467709.
Norm before scaling: 16.84827165653795. Distance: 4.377762058851634
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.9271, Accuracy: 7282/10000 (72.8200%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0397, Accuracy: 8855/8968 (98.7400%)
Scaling by  100
Scaled Norm after poisoning: 437.0107800443829, distance: 437.77621637658666
Total norm for 4 adversaries is: 437.0107800443829. distance: 437.77621637658666
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   1,  Average loss: 0.0224, Accuracy: 362/591 (61.2521%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   2,  Average loss: 0.0105, Accuracy: 423/591 (71.5736%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   3,  Average loss: 0.0043, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   4,  Average loss: 0.0036, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   5,  Average loss: 0.0032, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   6,  Average loss: 0.0024, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   7,  Average loss: 0.0024, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   8,  Average loss: 0.0019, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   9,  Average loss: 0.0017, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch  10,  Average loss: 0.0015, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Global model norm: 16.55707550467709.
Norm before scaling: 16.833664289689537. Distance: 4.271191440858498
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.5831, Accuracy: 8067/10000 (80.6700%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0476, Accuracy: 8815/8968 (98.2939%)
Scaling by  100
Scaled Norm after poisoning: 426.3849493122383, distance: 427.11911029009224
Total norm for 4 adversaries is: 426.3849493122383. distance: 427.11911029009224
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   1,  Average loss: 0.0215, Accuracy: 361/568 (63.5563%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   2,  Average loss: 0.0083, Accuracy: 488/568 (85.9155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   3,  Average loss: 0.0045, Accuracy: 518/568 (91.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   4,  Average loss: 0.0040, Accuracy: 520/568 (91.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   5,  Average loss: 0.0036, Accuracy: 516/568 (90.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   6,  Average loss: 0.0028, Accuracy: 524/568 (92.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   7,  Average loss: 0.0027, Accuracy: 531/568 (93.4859%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   8,  Average loss: 0.0020, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   9,  Average loss: 0.0022, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch  10,  Average loss: 0.0022, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Global model norm: 16.55707550467709.
Norm before scaling: 16.785115796582623. Distance: 4.2590630331003405
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.0398, Accuracy: 6242/10000 (62.4200%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0480, Accuracy: 8813/8968 (98.2716%)
Scaling by  100
Scaled Norm after poisoning: 424.99022047571873, distance: 425.9063130548783
Total norm for 4 adversaries is: 424.99022047571873. distance: 425.9063130548783
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   1,  Average loss: 0.0226, Accuracy: 325/557 (58.3483%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   2,  Average loss: 0.0098, Accuracy: 421/557 (75.5835%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   3,  Average loss: 0.0044, Accuracy: 514/557 (92.2801%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   4,  Average loss: 0.0034, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   5,  Average loss: 0.0030, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   7,  Average loss: 0.0020, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch  10,  Average loss: 0.0019, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Global model norm: 16.55707550467709.
Norm before scaling: 16.806035837643922. Distance: 4.3845065781636094
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.7816, Accuracy: 7812/10000 (78.1200%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0327, Accuracy: 8848/8968 (98.6619%)
Scaling by  100
Scaled Norm after poisoning: 437.5172318035028, distance: 438.4506279217764
Total norm for 4 adversaries is: 437.5172318035028. distance: 438.4506279217764
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  15, local model 77, internal_epoch   1,  Average loss: 0.0017, Accuracy: 571/589 (96.9440%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2175, Accuracy: 9354/10000 (93.5400%)
___Train Local_Simple,  epoch  15, local model 18, internal_epoch   1,  Average loss: 0.0022, Accuracy: 441/459 (96.0784%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2590, Accuracy: 9113/10000 (91.1300%)
___Train Local_Simple,  epoch  15, local model 43, internal_epoch   1,  Average loss: 0.0017, Accuracy: 394/408 (96.5686%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1204, Accuracy: 9632/10000 (96.3200%)
___Train Local_Simple,  epoch  15, local model 91, internal_epoch   1,  Average loss: 0.0007, Accuracy: 252/256 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.0860, Accuracy: 9719/10000 (97.1900%)
___Train Local_Simple,  epoch  15, local model 42, internal_epoch   1,  Average loss: 0.0012, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1027, Accuracy: 9685/10000 (96.8500%)
___Train Local_Simple,  epoch  15, local model 52, internal_epoch   1,  Average loss: 0.0012, Accuracy: 247/253 (97.6285%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1707, Accuracy: 9450/10000 (94.5000%)
time spent on training: 128.50924730300903
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.5133760778244528  data num: [606, 591, 568, 557, 589, 459, 408, 256, 236, 253]
[foolsgold agg] considering poison per batch poison_fraction: 0.1604300243201415
[foolsgold agg] wv: [1.         1.         0.75193776 0.75193776 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 0.0831, Accuracy: 9734/10000 (97.3400%)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 12.1736, Accuracy: 47/8968 (0.5241%)
Done in 154.76052451133728 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:16 choose agents : [41, 73, 51, 74, 28, 37, 96, 99, 80, 13]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   1,  Average loss: 0.0238, Accuracy: 365/606 (60.2310%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   2,  Average loss: 0.0100, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   3,  Average loss: 0.0042, Accuracy: 562/606 (92.7393%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   4,  Average loss: 0.0031, Accuracy: 576/606 (95.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   5,  Average loss: 0.0029, Accuracy: 576/606 (95.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   6,  Average loss: 0.0026, Accuracy: 576/606 (95.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   7,  Average loss: 0.0021, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   8,  Average loss: 0.0021, Accuracy: 584/606 (96.3696%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   9,  Average loss: 0.0019, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch  10,  Average loss: 0.0017, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Global model norm: 16.561283858652835.
Norm before scaling: 16.89537524987191. Distance: 4.776740846308597
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.0627, Accuracy: 6282/10000 (62.8200%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0182, Accuracy: 8921/8968 (99.4759%)
Scaling by  100
Scaled Norm after poisoning: 476.7419211428758, distance: 477.67410111392894
Total norm for 4 adversaries is: 476.7419211428758. distance: 477.67410111392894
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   1,  Average loss: 0.0237, Accuracy: 353/591 (59.7293%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   2,  Average loss: 0.0133, Accuracy: 384/591 (64.9746%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   3,  Average loss: 0.0038, Accuracy: 549/591 (92.8934%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   4,  Average loss: 0.0036, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   5,  Average loss: 0.0027, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   6,  Average loss: 0.0024, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   7,  Average loss: 0.0020, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   8,  Average loss: 0.0014, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   9,  Average loss: 0.0013, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch  10,  Average loss: 0.0013, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Global model norm: 16.561283858652835.
Norm before scaling: 16.90689711821822. Distance: 4.401666733032673
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.5914, Accuracy: 8165/10000 (81.6500%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0462, Accuracy: 8812/8968 (98.2605%)
Scaling by  100
Scaled Norm after poisoning: 439.59096754824253, distance: 440.1666587782405
Total norm for 4 adversaries is: 439.59096754824253. distance: 440.1666587782405
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   1,  Average loss: 0.0233, Accuracy: 347/568 (61.0915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   2,  Average loss: 0.0082, Accuracy: 485/568 (85.3873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   3,  Average loss: 0.0031, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   4,  Average loss: 0.0029, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   5,  Average loss: 0.0021, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   6,  Average loss: 0.0020, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   7,  Average loss: 0.0015, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   8,  Average loss: 0.0015, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   9,  Average loss: 0.0015, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch  10,  Average loss: 0.0013, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Global model norm: 16.561283858652835.
Norm before scaling: 16.929454060746373. Distance: 4.835217251241067
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.7900, Accuracy: 7336/10000 (73.3600%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0679, Accuracy: 8745/8968 (97.5134%)
Scaling by  100
Scaled Norm after poisoning: 482.66205180229366, distance: 483.52174847673604
Total norm for 4 adversaries is: 482.66205180229366. distance: 483.52174847673604
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   1,  Average loss: 0.0254, Accuracy: 323/557 (57.9892%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   2,  Average loss: 0.0090, Accuracy: 444/557 (79.7127%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   3,  Average loss: 0.0035, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   4,  Average loss: 0.0031, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   5,  Average loss: 0.0029, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   6,  Average loss: 0.0024, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   7,  Average loss: 0.0021, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   8,  Average loss: 0.0023, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch  10,  Average loss: 0.0019, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Global model norm: 16.561283858652835.
Norm before scaling: 16.824769715409555. Distance: 4.563329333871817
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.9749, Accuracy: 7421/10000 (74.2100%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0436, Accuracy: 8803/8968 (98.1601%)
Scaling by  100
Scaled Norm after poisoning: 455.3145204141858, distance: 456.33292054704975
Total norm for 4 adversaries is: 455.3145204141858. distance: 456.33292054704975
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  16, local model 28, internal_epoch   1,  Average loss: 0.0013, Accuracy: 488/501 (97.4052%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1196, Accuracy: 9587/10000 (95.8700%)
___Train Local_Simple,  epoch  16, local model 37, internal_epoch   1,  Average loss: 0.0015, Accuracy: 842/860 (97.9070%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1587, Accuracy: 9510/10000 (95.1000%)
___Train Local_Simple,  epoch  16, local model 96, internal_epoch   1,  Average loss: 0.0016, Accuracy: 656/672 (97.6190%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2734, Accuracy: 9033/10000 (90.3300%)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0009, Accuracy: 372/377 (98.6737%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.0959, Accuracy: 9695/10000 (96.9500%)
___Train Local_Simple,  epoch  16, local model 80, internal_epoch   1,  Average loss: 0.0009, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2609, Accuracy: 9260/10000 (92.6000%)
___Train Local_Simple,  epoch  16, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 715/734 (97.4114%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1906, Accuracy: 9362/10000 (93.6200%)
time spent on training: 129.78333497047424
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3937595387485162  data num: [606, 591, 568, 557, 501, 860, 672, 377, 431, 734]
[foolsgold agg] considering poison per batch poison_fraction: 0.12304985585891132
[foolsgold agg] wv: [1.         1.         0.83173895 0.83173895 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.0830, Accuracy: 9736/10000 (97.3600%)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 12.0890, Accuracy: 49/8968 (0.5464%)
Done in 155.2837963104248 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:17 choose agents : [41, 73, 51, 74, 98, 78, 46, 45, 62, 50]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   1,  Average loss: 0.0244, Accuracy: 357/606 (58.9109%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   2,  Average loss: 0.0082, Accuracy: 466/606 (76.8977%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   3,  Average loss: 0.0041, Accuracy: 558/606 (92.0792%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   4,  Average loss: 0.0034, Accuracy: 559/606 (92.2442%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   5,  Average loss: 0.0024, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   6,  Average loss: 0.0022, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   7,  Average loss: 0.0014, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   8,  Average loss: 0.0016, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   9,  Average loss: 0.0016, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch  10,  Average loss: 0.0018, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Global model norm: 16.565883535581587.
Norm before scaling: 16.967994630977316. Distance: 5.004918540268819
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9068, Accuracy: 7200/10000 (72.0000%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0240, Accuracy: 8894/8968 (99.1748%)
Scaling by  100
Scaled Norm after poisoning: 499.6098946928493, distance: 500.4918674414201
Total norm for 4 adversaries is: 499.6098946928493. distance: 500.4918674414201
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 91.7643, Accuracy: 8967/8968 (99.9888%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   1,  Average loss: 0.0264, Accuracy: 352/591 (59.5601%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   2,  Average loss: 0.0117, Accuracy: 409/591 (69.2047%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   3,  Average loss: 0.0050, Accuracy: 530/591 (89.6785%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   4,  Average loss: 0.0047, Accuracy: 536/591 (90.6937%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   5,  Average loss: 0.0040, Accuracy: 548/591 (92.7242%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   6,  Average loss: 0.0035, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   7,  Average loss: 0.0026, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   8,  Average loss: 0.0030, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   9,  Average loss: 0.0028, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch  10,  Average loss: 0.0025, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Global model norm: 16.565883535581587.
Norm before scaling: 17.02753776199977. Distance: 5.177497688561867
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9063, Accuracy: 6945/10000 (69.4500%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0652, Accuracy: 8759/8968 (97.6695%)
Scaling by  100
Scaled Norm after poisoning: 516.9230781750801, distance: 517.7497887493533
Total norm for 4 adversaries is: 516.9230781750801. distance: 517.7497887493533
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   1,  Average loss: 0.0205, Accuracy: 364/568 (64.0845%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   2,  Average loss: 0.0073, Accuracy: 497/568 (87.5000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   3,  Average loss: 0.0040, Accuracy: 518/568 (91.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   4,  Average loss: 0.0034, Accuracy: 521/568 (91.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   5,  Average loss: 0.0029, Accuracy: 528/568 (92.9577%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   6,  Average loss: 0.0024, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   7,  Average loss: 0.0023, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   8,  Average loss: 0.0021, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   9,  Average loss: 0.0017, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch  10,  Average loss: 0.0018, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Global model norm: 16.565883535581587.
Norm before scaling: 16.82532655758964. Distance: 4.251608600247354
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9876, Accuracy: 6624/10000 (66.2400%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0386, Accuracy: 8833/8968 (98.4946%)
Scaling by  100
Scaled Norm after poisoning: 424.37586524212236, distance: 425.1608702891177
Total norm for 4 adversaries is: 424.37586524212236. distance: 425.1608702891177
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   1,  Average loss: 0.0238, Accuracy: 325/557 (58.3483%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   2,  Average loss: 0.0107, Accuracy: 409/557 (73.4291%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   3,  Average loss: 0.0046, Accuracy: 511/557 (91.7415%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   4,  Average loss: 0.0036, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   5,  Average loss: 0.0029, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   6,  Average loss: 0.0027, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   7,  Average loss: 0.0024, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   8,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   9,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch  10,  Average loss: 0.0021, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Global model norm: 16.565883535581587.
Norm before scaling: 16.886757152830494. Distance: 4.569315170628968
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.8113, Accuracy: 7720/10000 (77.2000%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0413, Accuracy: 8809/8968 (98.2270%)
Scaling by  100
Scaled Norm after poisoning: 456.12100916313864, distance: 456.93152865062837
Total norm for 4 adversaries is: 456.12100916313864. distance: 456.93152865062837
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  17, local model 98, internal_epoch   1,  Average loss: 0.0019, Accuracy: 788/818 (96.3325%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3511, Accuracy: 8891/10000 (88.9100%)
___Train Local_Simple,  epoch  17, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 296/303 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1796, Accuracy: 9462/10000 (94.6200%)
___Train Local_Simple,  epoch  17, local model 46, internal_epoch   1,  Average loss: 0.0025, Accuracy: 692/710 (97.4648%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4543, Accuracy: 8587/10000 (85.8700%)
___Train Local_Simple,  epoch  17, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 614/628 (97.7707%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4204, Accuracy: 8630/10000 (86.3000%)
___Train Local_Simple,  epoch  17, local model 62, internal_epoch   1,  Average loss: 0.0009, Accuracy: 414/423 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1289, Accuracy: 9616/10000 (96.1600%)
___Train Local_Simple,  epoch  17, local model 50, internal_epoch   1,  Average loss: 0.0022, Accuracy: 456/474 (96.2025%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2172, Accuracy: 9294/10000 (92.9400%)
time spent on training: 129.02652072906494
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.40894681225783724  data num: [606, 591, 568, 557, 818, 303, 710, 628, 423, 474]
[foolsgold agg] considering poison per batch poison_fraction: 0.12779587883057414
[foolsgold agg] wv: [1.         1.         0.87226267 0.87226267 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.0833, Accuracy: 9735/10000 (97.3500%)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 12.0052, Accuracy: 50/8968 (0.5575%)
Done in 154.33420825004578 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:18 choose agents : [41, 73, 51, 74, 67, 14, 36, 24, 7, 4]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   1,  Average loss: 0.0225, Accuracy: 358/606 (59.0759%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   2,  Average loss: 0.0088, Accuracy: 449/606 (74.0924%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   3,  Average loss: 0.0036, Accuracy: 560/606 (92.4092%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   4,  Average loss: 0.0028, Accuracy: 576/606 (95.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   5,  Average loss: 0.0023, Accuracy: 580/606 (95.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   6,  Average loss: 0.0022, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   7,  Average loss: 0.0020, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   8,  Average loss: 0.0016, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   9,  Average loss: 0.0015, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch  10,  Average loss: 0.0013, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Global model norm: 16.57031802510516.
Norm before scaling: 16.96520756790985. Distance: 4.670031333671189
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.7857, Accuracy: 7388/10000 (73.8800%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0276, Accuracy: 8869/8968 (98.8961%)
Scaling by  100
Scaled Norm after poisoning: 466.3795396455552, distance: 467.0031283353464
Total norm for 4 adversaries is: 466.3795396455552. distance: 467.0031283353464
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   1,  Average loss: 0.0267, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   2,  Average loss: 0.0148, Accuracy: 372/591 (62.9442%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   3,  Average loss: 0.0062, Accuracy: 516/591 (87.3096%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   4,  Average loss: 0.0044, Accuracy: 542/591 (91.7090%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   5,  Average loss: 0.0034, Accuracy: 549/591 (92.8934%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   6,  Average loss: 0.0031, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   7,  Average loss: 0.0030, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   8,  Average loss: 0.0024, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   9,  Average loss: 0.0025, Accuracy: 564/591 (95.4315%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch  10,  Average loss: 0.0021, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Global model norm: 16.57031802510516.
Norm before scaling: 17.08751278746321. Distance: 5.201139420606124
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.8015, Accuracy: 7421/10000 (74.2100%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0245, Accuracy: 8883/8968 (99.0522%)
Scaling by  100
Scaled Norm after poisoning: 519.4503705841396, distance: 520.1139298269178
Total norm for 4 adversaries is: 519.4503705841396. distance: 520.1139298269178
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   1,  Average loss: 0.0212, Accuracy: 359/568 (63.2042%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   2,  Average loss: 0.0078, Accuracy: 485/568 (85.3873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   3,  Average loss: 0.0037, Accuracy: 532/568 (93.6620%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   4,  Average loss: 0.0033, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   5,  Average loss: 0.0027, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   6,  Average loss: 0.0027, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   7,  Average loss: 0.0023, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   8,  Average loss: 0.0018, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   9,  Average loss: 0.0020, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch  10,  Average loss: 0.0017, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Global model norm: 16.57031802510516.
Norm before scaling: 16.85358703647665. Distance: 4.4357861715090126
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9838, Accuracy: 6542/10000 (65.4200%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0267, Accuracy: 8885/8968 (99.0745%)
Scaling by  100
Scaled Norm after poisoning: 442.7366422321514, distance: 443.57859365618623
Total norm for 4 adversaries is: 442.7366422321514. distance: 443.57859365618623
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   1,  Average loss: 0.0225, Accuracy: 343/557 (61.5799%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   2,  Average loss: 0.0083, Accuracy: 460/557 (82.5853%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   3,  Average loss: 0.0044, Accuracy: 505/557 (90.6643%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   4,  Average loss: 0.0032, Accuracy: 519/557 (93.1777%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   5,  Average loss: 0.0027, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   6,  Average loss: 0.0023, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   7,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   9,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.57031802510516.
Norm before scaling: 16.810374299284096. Distance: 4.288789889873648
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.7448, Accuracy: 7748/10000 (77.4800%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0304, Accuracy: 8858/8968 (98.7734%)
Scaling by  100
Scaled Norm after poisoning: 427.9879707713758, distance: 428.8789893431479
Total norm for 4 adversaries is: 427.9879707713758. distance: 428.8789893431479
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  18, local model 67, internal_epoch   1,  Average loss: 0.0017, Accuracy: 962/998 (96.3928%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4318, Accuracy: 8544/10000 (85.4400%)
___Train Local_Simple,  epoch  18, local model 14, internal_epoch   1,  Average loss: 0.0020, Accuracy: 363/376 (96.5426%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1219, Accuracy: 9622/10000 (96.2200%)
___Train Local_Simple,  epoch  18, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 973/1005 (96.8159%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2276, Accuracy: 9305/10000 (93.0500%)
___Train Local_Simple,  epoch  18, local model 24, internal_epoch   1,  Average loss: 0.0016, Accuracy: 366/379 (96.5699%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1280, Accuracy: 9598/10000 (95.9800%)
___Train Local_Simple,  epoch  18, local model 7, internal_epoch   1,  Average loss: 0.0014, Accuracy: 407/418 (97.3684%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1153, Accuracy: 9632/10000 (96.3200%)
___Train Local_Simple,  epoch  18, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 640/658 (97.2644%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1588, Accuracy: 9503/10000 (95.0300%)
time spent on training: 129.69902968406677
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.37719298245614036  data num: [606, 591, 568, 557, 998, 376, 1005, 379, 418, 658]
[foolsgold agg] considering poison per batch poison_fraction: 0.11787280701754387
[foolsgold agg] wv: [1.         1.         0.82028948 0.82028948 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.0837, Accuracy: 9733/10000 (97.3300%)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 11.9539, Accuracy: 52/8968 (0.5798%)
Done in 154.79066467285156 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:19 choose agents : [41, 73, 51, 74, 80, 39, 26, 29, 4, 42]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   1,  Average loss: 0.0220, Accuracy: 376/606 (62.0462%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   2,  Average loss: 0.0097, Accuracy: 436/606 (71.9472%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   3,  Average loss: 0.0033, Accuracy: 564/606 (93.0693%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   4,  Average loss: 0.0030, Accuracy: 569/606 (93.8944%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   5,  Average loss: 0.0025, Accuracy: 580/606 (95.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   6,  Average loss: 0.0022, Accuracy: 582/606 (96.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   7,  Average loss: 0.0020, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   8,  Average loss: 0.0019, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   9,  Average loss: 0.0019, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch  10,  Average loss: 0.0018, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Global model norm: 16.574992524802706.
Norm before scaling: 16.872763704541615. Distance: 4.435420018964259
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.0497, Accuracy: 6562/10000 (65.6200%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0149, Accuracy: 8929/8968 (99.5651%)
Scaling by  100
Scaled Norm after poisoning: 442.75605233017427, distance: 443.5419758884158
Total norm for 4 adversaries is: 442.75605233017427. distance: 443.5419758884158
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   1,  Average loss: 0.0209, Accuracy: 386/591 (65.3130%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   2,  Average loss: 0.0075, Accuracy: 475/591 (80.3723%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   3,  Average loss: 0.0048, Accuracy: 547/591 (92.5550%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   4,  Average loss: 0.0038, Accuracy: 553/591 (93.5702%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   5,  Average loss: 0.0030, Accuracy: 557/591 (94.2470%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   6,  Average loss: 0.0028, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   7,  Average loss: 0.0028, Accuracy: 564/591 (95.4315%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   8,  Average loss: 0.0020, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   9,  Average loss: 0.0018, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch  10,  Average loss: 0.0017, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Global model norm: 16.574992524802706.
Norm before scaling: 16.897531796405854. Distance: 4.415922330117998
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.6567, Accuracy: 7842/10000 (78.4200%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0368, Accuracy: 8836/8968 (98.5281%)
Scaling by  100
Scaled Norm after poisoning: 440.91722579187126, distance: 441.5922539515384
Total norm for 4 adversaries is: 440.91722579187126. distance: 441.5922539515384
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   1,  Average loss: 0.0216, Accuracy: 351/568 (61.7958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   2,  Average loss: 0.0064, Accuracy: 506/568 (89.0845%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   3,  Average loss: 0.0029, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   4,  Average loss: 0.0027, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   5,  Average loss: 0.0020, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   6,  Average loss: 0.0020, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   7,  Average loss: 0.0014, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   8,  Average loss: 0.0013, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   9,  Average loss: 0.0014, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch  10,  Average loss: 0.0011, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Global model norm: 16.574992524802706.
Norm before scaling: 16.879339719757997. Distance: 4.397795662539714
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8798, Accuracy: 7052/10000 (70.5200%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0332, Accuracy: 8844/8968 (98.6173%)
Scaling by  100
Scaled Norm after poisoning: 439.05000427058417, distance: 439.7795790222643
Total norm for 4 adversaries is: 439.05000427058417. distance: 439.7795790222643
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   1,  Average loss: 0.0239, Accuracy: 329/557 (59.0664%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   2,  Average loss: 0.0088, Accuracy: 456/557 (81.8671%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   3,  Average loss: 0.0042, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   4,  Average loss: 0.0036, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   5,  Average loss: 0.0028, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   6,  Average loss: 0.0028, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   7,  Average loss: 0.0019, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   8,  Average loss: 0.0020, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   9,  Average loss: 0.0022, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch  10,  Average loss: 0.0022, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Global model norm: 16.574992524802706.
Norm before scaling: 16.878410390338527. Distance: 4.5481888488506685
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8184, Accuracy: 7401/10000 (74.0100%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0416, Accuracy: 8807/8968 (98.2047%)
Scaling by  100
Scaled Norm after poisoning: 453.96188234806675, distance: 454.81886847953
Total norm for 4 adversaries is: 453.96188234806675. distance: 454.81886847953
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  19, local model 80, internal_epoch   1,  Average loss: 0.0008, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2924, Accuracy: 9224/10000 (92.2400%)
___Train Local_Simple,  epoch  19, local model 39, internal_epoch   1,  Average loss: 0.0012, Accuracy: 252/257 (98.0545%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1333, Accuracy: 9565/10000 (95.6500%)
___Train Local_Simple,  epoch  19, local model 26, internal_epoch   1,  Average loss: 0.0015, Accuracy: 536/554 (96.7509%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1474, Accuracy: 9549/10000 (95.4900%)
___Train Local_Simple,  epoch  19, local model 29, internal_epoch   1,  Average loss: 0.0013, Accuracy: 979/1002 (97.7046%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2622, Accuracy: 9115/10000 (91.1500%)
___Train Local_Simple,  epoch  19, local model 4, internal_epoch   1,  Average loss: 0.0019, Accuracy: 640/658 (97.2644%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2577, Accuracy: 9148/10000 (91.4800%)
___Train Local_Simple,  epoch  19, local model 42, internal_epoch   1,  Average loss: 0.0011, Accuracy: 232/236 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1073, Accuracy: 9670/10000 (96.7000%)
time spent on training: 126.9574568271637
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.42527472527472526  data num: [606, 591, 568, 557, 431, 257, 554, 1002, 658, 236]
[foolsgold agg] considering poison per batch poison_fraction: 0.13289835164835165
[foolsgold agg] wv: [1.         1.         0.84579833 0.84579833 0.69995491 1.
 1.         1.         1.         0.69995491]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.0840, Accuracy: 9732/10000 (97.3200%)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 11.9592, Accuracy: 54/8968 (0.6021%)
Done in 152.64225935935974 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:20 choose agents : [41, 73, 51, 74, 69, 95, 80, 8, 25, 68]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   1,  Average loss: 0.0228, Accuracy: 355/606 (58.5809%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   2,  Average loss: 0.0104, Accuracy: 443/606 (73.1023%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   3,  Average loss: 0.0038, Accuracy: 558/606 (92.0792%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   4,  Average loss: 0.0034, Accuracy: 563/606 (92.9043%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   5,  Average loss: 0.0028, Accuracy: 569/606 (93.8944%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   6,  Average loss: 0.0021, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   7,  Average loss: 0.0020, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   8,  Average loss: 0.0015, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   9,  Average loss: 0.0017, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch  10,  Average loss: 0.0016, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Global model norm: 16.58054736072516.
Norm before scaling: 16.92879248182156. Distance: 4.661788616165113
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.9280, Accuracy: 7045/10000 (70.4500%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0117, Accuracy: 8932/8968 (99.5986%)
Scaling by  100
Scaled Norm after poisoning: 465.3937680878419, distance: 466.1788484584001
Total norm for 4 adversaries is: 465.3937680878419. distance: 466.1788484584001
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   1,  Average loss: 0.0236, Accuracy: 366/591 (61.9289%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   2,  Average loss: 0.0090, Accuracy: 467/591 (79.0186%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   3,  Average loss: 0.0043, Accuracy: 535/591 (90.5245%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   4,  Average loss: 0.0041, Accuracy: 538/591 (91.0321%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   5,  Average loss: 0.0030, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   6,  Average loss: 0.0031, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   7,  Average loss: 0.0025, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   8,  Average loss: 0.0023, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   9,  Average loss: 0.0021, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch  10,  Average loss: 0.0021, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Global model norm: 16.58054736072516.
Norm before scaling: 17.072132340065746. Distance: 5.240391248700151
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.8575, Accuracy: 6973/10000 (69.7300%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0341, Accuracy: 8850/8968 (98.6842%)
Scaling by  100
Scaled Norm after poisoning: 523.2590777998983, distance: 524.039090860596
Total norm for 4 adversaries is: 523.2590777998983. distance: 524.039090860596
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   1,  Average loss: 0.0216, Accuracy: 374/568 (65.8451%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   2,  Average loss: 0.0082, Accuracy: 484/568 (85.2113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   3,  Average loss: 0.0054, Accuracy: 510/568 (89.7887%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   4,  Average loss: 0.0045, Accuracy: 514/568 (90.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   5,  Average loss: 0.0038, Accuracy: 520/568 (91.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   6,  Average loss: 0.0033, Accuracy: 524/568 (92.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   7,  Average loss: 0.0033, Accuracy: 526/568 (92.6056%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   8,  Average loss: 0.0032, Accuracy: 528/568 (92.9577%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   9,  Average loss: 0.0027, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch  10,  Average loss: 0.0025, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Global model norm: 16.58054736072516.
Norm before scaling: 16.872883077577743. Distance: 4.705800458251589
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.2919, Accuracy: 5320/10000 (53.2000%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0450, Accuracy: 8812/8968 (98.2605%)
Scaling by  100
Scaled Norm after poisoning: 469.5572382574887, distance: 470.58001112988217
Total norm for 4 adversaries is: 469.5572382574887. distance: 470.58001112988217
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   1,  Average loss: 0.0225, Accuracy: 317/557 (56.9120%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   2,  Average loss: 0.0079, Accuracy: 458/557 (82.2262%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   3,  Average loss: 0.0028, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   4,  Average loss: 0.0028, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   5,  Average loss: 0.0022, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   6,  Average loss: 0.0020, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   8,  Average loss: 0.0012, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   9,  Average loss: 0.0014, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.58054736072516.
Norm before scaling: 16.86269625244859. Distance: 4.144092187806053
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6722, Accuracy: 7975/10000 (79.7500%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0369, Accuracy: 8829/8968 (98.4500%)
Scaling by  100
Scaled Norm after poisoning: 413.8069258422338, distance: 414.4092368963317
Total norm for 4 adversaries is: 413.8069258422338. distance: 414.4092368963317
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  20, local model 69, internal_epoch   1,  Average loss: 0.0019, Accuracy: 250/256 (97.6562%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1914, Accuracy: 9401/10000 (94.0100%)
___Train Local_Simple,  epoch  20, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 597/602 (99.1694%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.4010, Accuracy: 7652/10000 (76.5200%)
___Train Local_Simple,  epoch  20, local model 80, internal_epoch   1,  Average loss: 0.0012, Accuracy: 423/431 (98.1439%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1883, Accuracy: 9468/10000 (94.6800%)
___Train Local_Simple,  epoch  20, local model 8, internal_epoch   1,  Average loss: 0.0018, Accuracy: 612/633 (96.6825%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1785, Accuracy: 9422/10000 (94.2200%)
___Train Local_Simple,  epoch  20, local model 25, internal_epoch   1,  Average loss: 0.0020, Accuracy: 624/647 (96.4451%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2913, Accuracy: 9003/10000 (90.0300%)
___Train Local_Simple,  epoch  20, local model 68, internal_epoch   1,  Average loss: 0.0012, Accuracy: 483/494 (97.7733%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1755, Accuracy: 9432/10000 (94.3200%)
time spent on training: 125.99012279510498
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.43119777158774375  data num: [606, 591, 568, 557, 256, 602, 431, 633, 647, 494]
[foolsgold agg] considering poison per batch poison_fraction: 0.13474930362116994
[foolsgold agg] wv: [1.         1.         0.71508201 0.71508201 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.0843, Accuracy: 9731/10000 (97.3100%)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 11.8656, Accuracy: 54/8968 (0.6021%)
Done in 151.2596297264099 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:21 choose agents : [41, 73, 51, 74, 70, 61, 64, 31, 10, 23]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0184, Accuracy: 404/606 (66.6667%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: 0.0067, Accuracy: 503/606 (83.0033%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: 0.0030, Accuracy: 570/606 (94.0594%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: 0.0023, Accuracy: 578/606 (95.3795%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: 0.0017, Accuracy: 584/606 (96.3696%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: 0.0017, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: 0.0017, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: 0.0017, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: 0.0013, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: 0.0012, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Global model norm: 16.58434677222254.
Norm before scaling: 16.897804505885983. Distance: 4.200964390070526
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.7367, Accuracy: 7726/10000 (77.2600%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0126, Accuracy: 8934/8968 (99.6209%)
Scaling by  100
Scaled Norm after poisoning: 419.57210345779663, distance: 420.09643610128376
Total norm for 4 adversaries is: 419.57210345779663. distance: 420.09643610128376
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   1,  Average loss: 0.0224, Accuracy: 384/591 (64.9746%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   2,  Average loss: 0.0071, Accuracy: 470/591 (79.5262%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   3,  Average loss: 0.0027, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   4,  Average loss: 0.0019, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   5,  Average loss: 0.0017, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   6,  Average loss: 0.0012, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   7,  Average loss: 0.0013, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   8,  Average loss: 0.0009, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   9,  Average loss: 0.0009, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch  10,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Global model norm: 16.58434677222254.
Norm before scaling: 17.001580557556352. Distance: 4.481372213359749
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.5072, Accuracy: 8349/10000 (83.4900%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0332, Accuracy: 8854/8968 (98.7288%)
Scaling by  100
Scaled Norm after poisoning: 447.7667501054539, distance: 448.13722089333305
Total norm for 4 adversaries is: 447.7667501054539. distance: 448.13722089333305
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   1,  Average loss: 0.0190, Accuracy: 383/568 (67.4296%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   2,  Average loss: 0.0046, Accuracy: 521/568 (91.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   3,  Average loss: 0.0028, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   4,  Average loss: 0.0024, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   5,  Average loss: 0.0019, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   6,  Average loss: 0.0018, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   7,  Average loss: 0.0016, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   8,  Average loss: 0.0012, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch  10,  Average loss: 0.0013, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Global model norm: 16.58434677222254.
Norm before scaling: 16.862222086409794. Distance: 4.116542816358301
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.8467, Accuracy: 7101/10000 (71.0100%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0282, Accuracy: 8867/8968 (98.8738%)
Scaling by  100
Scaled Norm after poisoning: 411.0585230535915, distance: 411.65430354242625
Total norm for 4 adversaries is: 411.0585230535915. distance: 411.65430354242625
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 855.9506, Accuracy: 8897/8968 (99.2083%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   1,  Average loss: 0.0225, Accuracy: 321/557 (57.6302%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   2,  Average loss: 0.0079, Accuracy: 452/557 (81.1490%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   3,  Average loss: 0.0031, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   4,  Average loss: 0.0026, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   5,  Average loss: 0.0020, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   7,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.58434677222254.
Norm before scaling: 16.87654253655888. Distance: 4.386214352123416
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.7743, Accuracy: 7859/10000 (78.5900%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0253, Accuracy: 8888/8968 (99.1079%)
Scaling by  100
Scaled Norm after poisoning: 437.85571253553377, distance: 438.6214199055947
Total norm for 4 adversaries is: 437.85571253553377. distance: 438.6214199055947
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  21, local model 70, internal_epoch   1,  Average loss: 0.0020, Accuracy: 695/724 (95.9945%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2094, Accuracy: 9328/10000 (93.2800%)
___Train Local_Simple,  epoch  21, local model 61, internal_epoch   1,  Average loss: 0.0017, Accuracy: 677/699 (96.8526%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1829, Accuracy: 9434/10000 (94.3400%)
___Train Local_Simple,  epoch  21, local model 64, internal_epoch   1,  Average loss: 0.0019, Accuracy: 785/813 (96.5560%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2985, Accuracy: 8915/10000 (89.1500%)
___Train Local_Simple,  epoch  21, local model 31, internal_epoch   1,  Average loss: 0.0010, Accuracy: 819/835 (98.0838%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1748, Accuracy: 9488/10000 (94.8800%)
___Train Local_Simple,  epoch  21, local model 10, internal_epoch   1,  Average loss: 0.0018, Accuracy: 863/892 (96.7489%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.0327, Accuracy: 7573/10000 (75.7300%)
___Train Local_Simple,  epoch  21, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1221, Accuracy: 9586/10000 (95.8600%)
time spent on training: 125.48252558708191
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3529948312557008  data num: [606, 591, 568, 557, 724, 699, 813, 835, 892, 293]
[foolsgold agg] considering poison per batch poison_fraction: 0.1103108847674065
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.0844, Accuracy: 9731/10000 (97.3100%)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 11.8031, Accuracy: 57/8968 (0.6356%)
Done in 151.3136751651764 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:22 choose agents : [41, 73, 51, 74, 7, 46, 65, 57, 83, 9]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   1,  Average loss: 0.0196, Accuracy: 402/606 (66.3366%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   2,  Average loss: 0.0064, Accuracy: 507/606 (83.6634%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   3,  Average loss: 0.0025, Accuracy: 580/606 (95.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   4,  Average loss: 0.0020, Accuracy: 582/606 (96.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   5,  Average loss: 0.0019, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   6,  Average loss: 0.0017, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   7,  Average loss: 0.0015, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   8,  Average loss: 0.0013, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   9,  Average loss: 0.0013, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch  10,  Average loss: 0.0013, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Global model norm: 16.58848749827629.
Norm before scaling: 16.933270704098522. Distance: 4.463089993153544
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.8522, Accuracy: 7411/10000 (74.1100%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0161, Accuracy: 8913/8968 (99.3867%)
Scaling by  100
Scaled Norm after poisoning: 445.68011580616877, distance: 446.30899469986036
Total norm for 4 adversaries is: 445.68011580616877. distance: 446.30899469986036
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   1,  Average loss: 0.0203, Accuracy: 384/591 (64.9746%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 529/591 (89.5093%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   3,  Average loss: 0.0023, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   4,  Average loss: 0.0021, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   5,  Average loss: 0.0016, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   6,  Average loss: 0.0013, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   7,  Average loss: 0.0011, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   8,  Average loss: 0.0010, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   9,  Average loss: 0.0009, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch  10,  Average loss: 0.0010, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Global model norm: 16.58848749827629.
Norm before scaling: 16.888047437173853. Distance: 4.120743607385397
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6033, Accuracy: 8137/10000 (81.3700%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0380, Accuracy: 8850/8968 (98.6842%)
Scaling by  100
Scaled Norm after poisoning: 411.5643935036169, distance: 412.07438269686213
Total norm for 4 adversaries is: 411.5643935036169. distance: 412.07438269686213
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   1,  Average loss: 0.0196, Accuracy: 382/568 (67.2535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   2,  Average loss: 0.0056, Accuracy: 510/568 (89.7887%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   3,  Average loss: 0.0027, Accuracy: 529/568 (93.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   4,  Average loss: 0.0028, Accuracy: 526/568 (92.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   5,  Average loss: 0.0020, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   6,  Average loss: 0.0018, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   7,  Average loss: 0.0017, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   8,  Average loss: 0.0013, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch  10,  Average loss: 0.0014, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Global model norm: 16.58848749827629.
Norm before scaling: 16.881429620018118. Distance: 4.134766086295439
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.8734, Accuracy: 7264/10000 (72.6400%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0391, Accuracy: 8818/8968 (98.3274%)
Scaling by  100
Scaled Norm after poisoning: 412.92725978675713, distance: 413.47662796704725
Total norm for 4 adversaries is: 412.92725978675713. distance: 413.47662796704725
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 3775.5346, Accuracy: 8788/8968 (97.9929%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   1,  Average loss: 0.0245, Accuracy: 312/557 (56.0144%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   2,  Average loss: 0.0092, Accuracy: 441/557 (79.1741%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   3,  Average loss: 0.0038, Accuracy: 511/557 (91.7415%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   4,  Average loss: 0.0031, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   5,  Average loss: 0.0025, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   7,  Average loss: 0.0022, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   8,  Average loss: 0.0018, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Global model norm: 16.58848749827629.
Norm before scaling: 16.95314930153788. Distance: 4.824686647033714
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.7804, Accuracy: 7857/10000 (78.5700%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0267, Accuracy: 8865/8968 (98.8515%)
Scaling by  100
Scaled Norm after poisoning: 481.60830817169256, distance: 482.468651831391
Total norm for 4 adversaries is: 481.60830817169256. distance: 482.468651831391
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  22, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 410/418 (98.0861%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1501, Accuracy: 9513/10000 (95.1300%)
___Train Local_Simple,  epoch  22, local model 46, internal_epoch   1,  Average loss: 0.0017, Accuracy: 688/710 (96.9014%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.5005, Accuracy: 8338/10000 (83.3800%)
___Train Local_Simple,  epoch  22, local model 65, internal_epoch   1,  Average loss: 0.0010, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1381, Accuracy: 9553/10000 (95.5300%)
___Train Local_Simple,  epoch  22, local model 57, internal_epoch   1,  Average loss: 0.0016, Accuracy: 330/343 (96.2099%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2260, Accuracy: 9343/10000 (93.4300%)
___Train Local_Simple,  epoch  22, local model 83, internal_epoch   1,  Average loss: 0.0015, Accuracy: 422/433 (97.4596%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1153, Accuracy: 9610/10000 (96.1000%)
___Train Local_Simple,  epoch  22, local model 9, internal_epoch   1,  Average loss: 0.0010, Accuracy: 430/436 (98.6239%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1083, Accuracy: 9660/10000 (96.6000%)
time spent on training: 123.93975353240967
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.46135505662626664  data num: [606, 591, 568, 557, 418, 710, 371, 343, 433, 436]
[foolsgold agg] considering poison per batch poison_fraction: 0.14417345519570832
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.0848, Accuracy: 9730/10000 (97.3000%)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 11.7144, Accuracy: 57/8968 (0.6356%)
Done in 148.56136536598206 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:23 choose agents : [41, 73, 51, 74, 64, 58, 12, 83, 96, 90]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   1,  Average loss: 0.0202, Accuracy: 382/606 (63.0363%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   2,  Average loss: 0.0061, Accuracy: 515/606 (84.9835%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   3,  Average loss: 0.0020, Accuracy: 580/606 (95.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   4,  Average loss: 0.0020, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   5,  Average loss: 0.0017, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   6,  Average loss: 0.0015, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   7,  Average loss: 0.0013, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   8,  Average loss: 0.0013, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   9,  Average loss: 0.0011, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch  10,  Average loss: 0.0012, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Global model norm: 16.593212973890108.
Norm before scaling: 16.923672032062903. Distance: 4.3386995882904404
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.9921, Accuracy: 6926/10000 (69.2600%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0188, Accuracy: 8892/8968 (99.1525%)
Scaling by  100
Scaled Norm after poisoning: 433.2939244900625, distance: 433.86994018945353
Total norm for 4 adversaries is: 433.2939244900625. distance: 433.86994018945353
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   1,  Average loss: 0.0214, Accuracy: 396/591 (67.0051%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   2,  Average loss: 0.0078, Accuracy: 495/591 (83.7563%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   3,  Average loss: 0.0048, Accuracy: 529/591 (89.5093%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   4,  Average loss: 0.0040, Accuracy: 543/591 (91.8782%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   5,  Average loss: 0.0032, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   6,  Average loss: 0.0028, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   7,  Average loss: 0.0026, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   8,  Average loss: 0.0023, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   9,  Average loss: 0.0023, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch  10,  Average loss: 0.0022, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Global model norm: 16.593212973890108.
Norm before scaling: 16.997310650098076. Distance: 4.8860489274150485
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.9250, Accuracy: 6829/10000 (68.2900%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0289, Accuracy: 8875/8968 (98.9630%)
Scaling by  100
Scaled Norm after poisoning: 487.83208240643626, distance: 488.6049177249447
Total norm for 4 adversaries is: 487.83208240643626. distance: 488.6049177249447
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 3354.6418, Accuracy: 8886/8968 (99.0856%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   1,  Average loss: 0.0182, Accuracy: 402/568 (70.7746%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   2,  Average loss: 0.0055, Accuracy: 513/568 (90.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   3,  Average loss: 0.0033, Accuracy: 530/568 (93.3099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   4,  Average loss: 0.0026, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   5,  Average loss: 0.0024, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   6,  Average loss: 0.0018, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   7,  Average loss: 0.0017, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   8,  Average loss: 0.0014, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   9,  Average loss: 0.0013, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch  10,  Average loss: 0.0014, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Global model norm: 16.593212973890108.
Norm before scaling: 16.806111196084483. Distance: 3.93138374137507
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.8870, Accuracy: 7126/10000 (71.2600%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0188, Accuracy: 8898/8968 (99.2194%)
Scaling by  100
Scaled Norm after poisoning: 392.42654567447397, distance: 393.1383543041813
Total norm for 4 adversaries is: 392.42654567447397. distance: 393.1383543041813
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   1,  Average loss: 0.0231, Accuracy: 328/557 (58.8869%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   2,  Average loss: 0.0089, Accuracy: 456/557 (81.8671%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   3,  Average loss: 0.0033, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   4,  Average loss: 0.0028, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   5,  Average loss: 0.0024, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   6,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   7,  Average loss: 0.0017, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   8,  Average loss: 0.0019, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   9,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Global model norm: 16.593212973890108.
Norm before scaling: 16.926227041642633. Distance: 4.667741356582243
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.8352, Accuracy: 7582/10000 (75.8200%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0109, Accuracy: 8932/8968 (99.5986%)
Scaling by  100
Scaled Norm after poisoning: 465.93013491831584, distance: 466.7741189536969
Total norm for 4 adversaries is: 465.93013491831584. distance: 466.7741189536969
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  23, local model 64, internal_epoch   1,  Average loss: 0.0018, Accuracy: 790/813 (97.1710%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1926, Accuracy: 9351/10000 (93.5100%)
___Train Local_Simple,  epoch  23, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 268/276 (97.1014%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1195, Accuracy: 9626/10000 (96.2600%)
___Train Local_Simple,  epoch  23, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1126/1160 (97.0690%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4428, Accuracy: 8904/10000 (89.0400%)
___Train Local_Simple,  epoch  23, local model 83, internal_epoch   1,  Average loss: 0.0015, Accuracy: 421/433 (97.2286%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1128, Accuracy: 9648/10000 (96.4800%)
___Train Local_Simple,  epoch  23, local model 96, internal_epoch   1,  Average loss: 0.0015, Accuracy: 659/672 (98.0655%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1466, Accuracy: 9557/10000 (95.5700%)
___Train Local_Simple,  epoch  23, local model 90, internal_epoch   1,  Average loss: 0.0017, Accuracy: 658/683 (96.3397%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4121, Accuracy: 8676/10000 (86.7600%)
time spent on training: 123.51518440246582
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3651517534203491  data num: [606, 591, 568, 557, 813, 276, 1160, 433, 672, 683]
[foolsgold agg] considering poison per batch poison_fraction: 0.1141099229438591
[foolsgold agg] wv: [1.         1.         0.85243288 0.85243288 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.0847, Accuracy: 9731/10000 (97.3100%)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 11.6042, Accuracy: 59/8968 (0.6579%)
Done in 148.27855277061462 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:24 choose agents : [41, 73, 51, 74, 28, 65, 33, 75, 13, 32]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   1,  Average loss: 0.0204, Accuracy: 393/606 (64.8515%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   2,  Average loss: 0.0059, Accuracy: 511/606 (84.3234%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   3,  Average loss: 0.0030, Accuracy: 570/606 (94.0594%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   4,  Average loss: 0.0028, Accuracy: 567/606 (93.5644%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   5,  Average loss: 0.0027, Accuracy: 571/606 (94.2244%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   6,  Average loss: 0.0022, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   7,  Average loss: 0.0021, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   8,  Average loss: 0.0017, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   9,  Average loss: 0.0019, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch  10,  Average loss: 0.0015, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Global model norm: 16.597256794587132.
Norm before scaling: 16.884115738107592. Distance: 4.236512267638045
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.9296, Accuracy: 6862/10000 (68.6200%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0133, Accuracy: 8930/8968 (99.5763%)
Scaling by  100
Scaled Norm after poisoning: 422.9910792499057, distance: 423.6512237383482
Total norm for 4 adversaries is: 422.9910792499057. distance: 423.6512237383482
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   1,  Average loss: 0.0189, Accuracy: 403/591 (68.1895%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   2,  Average loss: 0.0069, Accuracy: 507/591 (85.7868%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   3,  Average loss: 0.0040, Accuracy: 551/591 (93.2318%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   4,  Average loss: 0.0034, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   5,  Average loss: 0.0027, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   6,  Average loss: 0.0021, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   7,  Average loss: 0.0019, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   8,  Average loss: 0.0017, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   9,  Average loss: 0.0017, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch  10,  Average loss: 0.0016, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Global model norm: 16.597256794587132.
Norm before scaling: 17.012381140232748. Distance: 4.546182166729664
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.6403, Accuracy: 8051/10000 (80.5100%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0315, Accuracy: 8857/8968 (98.7623%)
Scaling by  100
Scaled Norm after poisoning: 454.182369759109, distance: 454.6182120747034
Total norm for 4 adversaries is: 454.182369759109. distance: 454.6182120747034
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   1,  Average loss: 0.0209, Accuracy: 373/568 (65.6690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   2,  Average loss: 0.0060, Accuracy: 511/568 (89.9648%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   3,  Average loss: 0.0045, Accuracy: 521/568 (91.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   4,  Average loss: 0.0041, Accuracy: 519/568 (91.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   5,  Average loss: 0.0038, Accuracy: 518/568 (91.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   6,  Average loss: 0.0029, Accuracy: 528/568 (92.9577%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   7,  Average loss: 0.0027, Accuracy: 526/568 (92.6056%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   8,  Average loss: 0.0029, Accuracy: 524/568 (92.2535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   9,  Average loss: 0.0026, Accuracy: 525/568 (92.4296%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch  10,  Average loss: 0.0027, Accuracy: 526/568 (92.6056%), train_poison_data_count: 180
Global model norm: 16.597256794587132.
Norm before scaling: 16.858684423124945. Distance: 4.62792958446534
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.2736, Accuracy: 5243/10000 (52.4300%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0210, Accuracy: 8892/8968 (99.1525%)
Scaling by  100
Scaled Norm after poisoning: 461.7203225438534, distance: 462.7929646450992
Total norm for 4 adversaries is: 461.7203225438534. distance: 462.7929646450992
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   1,  Average loss: 0.0222, Accuracy: 341/557 (61.2208%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   2,  Average loss: 0.0082, Accuracy: 437/557 (78.4560%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   3,  Average loss: 0.0036, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   4,  Average loss: 0.0031, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   5,  Average loss: 0.0029, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   6,  Average loss: 0.0022, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   7,  Average loss: 0.0019, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch  10,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Global model norm: 16.597256794587132.
Norm before scaling: 16.902651137573525. Distance: 4.39447113674163
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.6908, Accuracy: 7889/10000 (78.8900%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0187, Accuracy: 8895/8968 (99.1860%)
Scaling by  100
Scaled Norm after poisoning: 438.7267087834977, distance: 439.4470957919736
Total norm for 4 adversaries is: 438.7267087834977. distance: 439.4470957919736
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 150839.0631, Accuracy: 7827/8968 (87.2770%)
___Train Local_Simple,  epoch  24, local model 28, internal_epoch   1,  Average loss: 0.0016, Accuracy: 486/501 (97.0060%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1081, Accuracy: 9651/10000 (96.5100%)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0009, Accuracy: 362/371 (97.5741%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1574, Accuracy: 9474/10000 (94.7400%)
___Train Local_Simple,  epoch  24, local model 33, internal_epoch   1,  Average loss: 0.0021, Accuracy: 603/623 (96.7897%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1902, Accuracy: 9360/10000 (93.6000%)
___Train Local_Simple,  epoch  24, local model 75, internal_epoch   1,  Average loss: 0.0010, Accuracy: 672/686 (97.9592%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1762, Accuracy: 9469/10000 (94.6900%)
___Train Local_Simple,  epoch  24, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 719/734 (97.9564%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2365, Accuracy: 9309/10000 (93.0900%)
___Train Local_Simple,  epoch  24, local model 32, internal_epoch   1,  Average loss: 0.0023, Accuracy: 938/977 (96.0082%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3054, Accuracy: 8963/10000 (89.6300%)
time spent on training: 125.74765014648438
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3736723527518507  data num: [606, 591, 568, 557, 501, 371, 623, 686, 734, 977]
[foolsgold agg] considering poison per batch poison_fraction: 0.11677261023495333
[foolsgold agg] wv: [1.         1.         0.87547282 0.87547282 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.0850, Accuracy: 9726/10000 (97.2600%)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 11.5417, Accuracy: 59/8968 (0.6579%)
Done in 150.52996397018433 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:25 choose agents : [41, 73, 51, 74, 80, 23, 25, 12, 58, 19]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   1,  Average loss: 0.0209, Accuracy: 372/606 (61.3861%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   2,  Average loss: 0.0067, Accuracy: 523/606 (86.3036%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   3,  Average loss: 0.0032, Accuracy: 566/606 (93.3993%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   4,  Average loss: 0.0029, Accuracy: 573/606 (94.5545%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   5,  Average loss: 0.0025, Accuracy: 578/606 (95.3795%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   6,  Average loss: 0.0025, Accuracy: 576/606 (95.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   7,  Average loss: 0.0023, Accuracy: 581/606 (95.8746%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   8,  Average loss: 0.0018, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   9,  Average loss: 0.0019, Accuracy: 582/606 (96.0396%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch  10,  Average loss: 0.0017, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Global model norm: 16.602019295186185.
Norm before scaling: 17.01678266694337. Distance: 4.74674374246348
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.9360, Accuracy: 6977/10000 (69.7700%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0041, Accuracy: 8960/8968 (99.9108%)
Scaling by  100
Scaled Norm after poisoning: 474.05972724963675, distance: 474.67437852173987
Total norm for 4 adversaries is: 474.05972724963675. distance: 474.67437852173987
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 76.6131, Accuracy: 8967/8968 (99.9888%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0214, Accuracy: 405/591 (68.5279%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   2,  Average loss: 0.0065, Accuracy: 512/591 (86.6328%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   3,  Average loss: 0.0027, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   4,  Average loss: 0.0020, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   5,  Average loss: 0.0020, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   6,  Average loss: 0.0015, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   7,  Average loss: 0.0013, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   8,  Average loss: 0.0010, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   9,  Average loss: 0.0008, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch  10,  Average loss: 0.0010, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Global model norm: 16.602019295186185.
Norm before scaling: 17.039671441434287. Distance: 4.526709234817499
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4849, Accuracy: 8431/10000 (84.3100%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0353, Accuracy: 8849/8968 (98.6731%)
Scaling by  100
Scaled Norm after poisoning: 452.33816166668936, distance: 452.6709449202588
Total norm for 4 adversaries is: 452.33816166668936. distance: 452.6709449202588
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   1,  Average loss: 0.0182, Accuracy: 407/568 (71.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   2,  Average loss: 0.0051, Accuracy: 514/568 (90.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   3,  Average loss: 0.0025, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   4,  Average loss: 0.0022, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   5,  Average loss: 0.0019, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   6,  Average loss: 0.0017, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   7,  Average loss: 0.0014, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   8,  Average loss: 0.0015, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch  10,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Global model norm: 16.602019295186185.
Norm before scaling: 16.84187105417533. Distance: 3.993900058655428
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.9403, Accuracy: 7070/10000 (70.7000%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0327, Accuracy: 8835/8968 (98.5169%)
Scaling by  100
Scaled Norm after poisoning: 398.7418298536034, distance: 399.39000363053657
Total norm for 4 adversaries is: 398.7418298536034. distance: 399.39000363053657
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1752201.6111, Accuracy: 1354/8968 (15.0981%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0229, Accuracy: 346/557 (62.1185%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   2,  Average loss: 0.0071, Accuracy: 469/557 (84.2011%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   3,  Average loss: 0.0024, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   4,  Average loss: 0.0025, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   5,  Average loss: 0.0023, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   6,  Average loss: 0.0020, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   7,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   8,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   9,  Average loss: 0.0015, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Global model norm: 16.602019295186185.
Norm before scaling: 16.940374489420147. Distance: 4.507578296626662
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.6926, Accuracy: 7917/10000 (79.1700%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0274, Accuracy: 8862/8968 (98.8180%)
Scaling by  100
Scaled Norm after poisoning: 450.068154561062, distance: 450.7578340972012
Total norm for 4 adversaries is: 450.068154561062. distance: 450.7578340972012
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  25, local model 80, internal_epoch   1,  Average loss: 0.0012, Accuracy: 422/431 (97.9118%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1533, Accuracy: 9545/10000 (95.4500%)
___Train Local_Simple,  epoch  25, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1769, Accuracy: 9407/10000 (94.0700%)
___Train Local_Simple,  epoch  25, local model 25, internal_epoch   1,  Average loss: 0.0020, Accuracy: 623/647 (96.2906%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.8941, Accuracy: 7578/10000 (75.7800%)
___Train Local_Simple,  epoch  25, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1132/1160 (97.5862%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.9662, Accuracy: 7587/10000 (75.8700%)
___Train Local_Simple,  epoch  25, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 267/276 (96.7391%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1485, Accuracy: 9538/10000 (95.3800%)
___Train Local_Simple,  epoch  25, local model 19, internal_epoch   1,  Average loss: 0.0028, Accuracy: 200/205 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1456, Accuracy: 9544/10000 (95.4400%)
time spent on training: 123.09994077682495
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.43532058492688414  data num: [606, 591, 568, 557, 431, 293, 647, 1160, 276, 205]
[foolsgold agg] considering poison per batch poison_fraction: 0.13603768278965128
[foolsgold agg] wv: [1.        1.        0.8779384 0.8779384 1.        1.        1.
 1.        1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.0855, Accuracy: 9728/10000 (97.2800%)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 11.4503, Accuracy: 61/8968 (0.6802%)
Done in 147.9790117740631 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:26 choose agents : [41, 73, 51, 74, 11, 13, 82, 50, 34, 14]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   1,  Average loss: 0.0206, Accuracy: 385/606 (63.5314%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   2,  Average loss: 0.0080, Accuracy: 474/606 (78.2178%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   3,  Average loss: 0.0045, Accuracy: 557/606 (91.9142%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   4,  Average loss: 0.0034, Accuracy: 564/606 (93.0693%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   5,  Average loss: 0.0028, Accuracy: 571/606 (94.2244%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   6,  Average loss: 0.0027, Accuracy: 570/606 (94.0594%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   7,  Average loss: 0.0023, Accuracy: 578/606 (95.3795%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   8,  Average loss: 0.0021, Accuracy: 584/606 (96.3696%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   9,  Average loss: 0.0020, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch  10,  Average loss: 0.0018, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Global model norm: 16.606708761187637.
Norm before scaling: 17.038232334487766. Distance: 4.8973091444260595
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.8819, Accuracy: 7424/10000 (74.2400%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0069, Accuracy: 8951/8968 (99.8104%)
Scaling by  100
Scaled Norm after poisoning: 489.0456586557128, distance: 489.7309369694751
Total norm for 4 adversaries is: 489.0456586557128. distance: 489.7309369694751
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 14.3055, Accuracy: 8967/8968 (99.9888%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   1,  Average loss: 0.0216, Accuracy: 401/591 (67.8511%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   2,  Average loss: 0.0070, Accuracy: 503/591 (85.1100%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   3,  Average loss: 0.0038, Accuracy: 545/591 (92.2166%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   4,  Average loss: 0.0029, Accuracy: 553/591 (93.5702%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   5,  Average loss: 0.0026, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   6,  Average loss: 0.0023, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   7,  Average loss: 0.0020, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   8,  Average loss: 0.0017, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   9,  Average loss: 0.0013, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch  10,  Average loss: 0.0014, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Global model norm: 16.606708761187637.
Norm before scaling: 17.016224019529496. Distance: 4.764171541291677
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.7177, Accuracy: 7829/10000 (78.2900%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0317, Accuracy: 8855/8968 (98.7400%)
Scaling by  100
Scaled Norm after poisoning: 475.7691305927697, distance: 476.41714586588927
Total norm for 4 adversaries is: 475.7691305927697. distance: 476.41714586588927
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 1024.0428, Accuracy: 8953/8968 (99.8327%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   1,  Average loss: 0.0181, Accuracy: 396/568 (69.7183%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   2,  Average loss: 0.0060, Accuracy: 498/568 (87.6761%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   3,  Average loss: 0.0044, Accuracy: 516/568 (90.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   4,  Average loss: 0.0032, Accuracy: 523/568 (92.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   5,  Average loss: 0.0024, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   6,  Average loss: 0.0025, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   7,  Average loss: 0.0023, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   8,  Average loss: 0.0017, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   9,  Average loss: 0.0015, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch  10,  Average loss: 0.0012, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Global model norm: 16.606708761187637.
Norm before scaling: 16.909951867701125. Distance: 4.277545969463569
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.9940, Accuracy: 6768/10000 (67.6800%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0179, Accuracy: 8905/8968 (99.2975%)
Scaling by  100
Scaled Norm after poisoning: 427.125768217044, distance: 427.75460254683406
Total norm for 4 adversaries is: 427.125768217044. distance: 427.75460254683406
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 1137.8488, Accuracy: 8853/8968 (98.7177%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   1,  Average loss: 0.0217, Accuracy: 342/557 (61.4004%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   2,  Average loss: 0.0071, Accuracy: 467/557 (83.8420%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   3,  Average loss: 0.0035, Accuracy: 520/557 (93.3573%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   4,  Average loss: 0.0027, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   5,  Average loss: 0.0025, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   7,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch  10,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Global model norm: 16.606708761187637.
Norm before scaling: 16.89299171092298. Distance: 4.366188986084665
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.6809, Accuracy: 7931/10000 (79.3100%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0156, Accuracy: 8906/8968 (99.3087%)
Scaling by  100
Scaled Norm after poisoning: 435.8492249333478, distance: 436.6189163618544
Total norm for 4 adversaries is: 435.8492249333478. distance: 436.6189163618544
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  26, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 622/645 (96.4341%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1871, Accuracy: 9426/10000 (94.2600%)
___Train Local_Simple,  epoch  26, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 723/734 (98.5014%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3199, Accuracy: 9110/10000 (91.1000%)
___Train Local_Simple,  epoch  26, local model 82, internal_epoch   1,  Average loss: 0.0020, Accuracy: 693/713 (97.1950%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.7047, Accuracy: 7755/10000 (77.5500%)
___Train Local_Simple,  epoch  26, local model 50, internal_epoch   1,  Average loss: 0.0027, Accuracy: 454/474 (95.7806%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2611, Accuracy: 9199/10000 (91.9900%)
___Train Local_Simple,  epoch  26, local model 34, internal_epoch   1,  Average loss: 0.0007, Accuracy: 407/413 (98.5472%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2041, Accuracy: 9404/10000 (94.0400%)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 368/376 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1127, Accuracy: 9671/10000 (96.7100%)
time spent on training: 124.3383846282959
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4090188479830897  data num: [606, 591, 568, 557, 645, 734, 713, 474, 413, 376]
[foolsgold agg] considering poison per batch poison_fraction: 0.12781838999471554
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 0.0863, Accuracy: 9726/10000 (97.2600%)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 11.3384, Accuracy: 62/8968 (0.6913%)
Done in 149.26889038085938 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:27 choose agents : [41, 73, 51, 74, 55, 58, 53, 14, 36, 6]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   1,  Average loss: 0.0200, Accuracy: 401/606 (66.1716%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   2,  Average loss: 0.0059, Accuracy: 533/606 (87.9538%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   3,  Average loss: 0.0030, Accuracy: 574/606 (94.7195%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   4,  Average loss: 0.0022, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   5,  Average loss: 0.0020, Accuracy: 584/606 (96.3696%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   6,  Average loss: 0.0020, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   7,  Average loss: 0.0016, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   8,  Average loss: 0.0017, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   9,  Average loss: 0.0013, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch  10,  Average loss: 0.0013, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Global model norm: 16.61173769060788.
Norm before scaling: 16.98607379240004. Distance: 4.4015642506708
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.7317, Accuracy: 7771/10000 (77.7100%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0033, Accuracy: 8961/8968 (99.9219%)
Scaling by  100
Scaled Norm after poisoning: 439.6975523015792, distance: 440.15641750973026
Total norm for 4 adversaries is: 439.6975523015792. distance: 440.15641750973026
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   1,  Average loss: 0.0198, Accuracy: 416/591 (70.3892%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 524/591 (88.6633%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   3,  Average loss: 0.0033, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   4,  Average loss: 0.0031, Accuracy: 559/591 (94.5854%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   5,  Average loss: 0.0028, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   6,  Average loss: 0.0022, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   7,  Average loss: 0.0016, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   8,  Average loss: 0.0016, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   9,  Average loss: 0.0015, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch  10,  Average loss: 0.0015, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Global model norm: 16.61173769060788.
Norm before scaling: 16.98176763852651. Distance: 4.571135617985173
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.6917, Accuracy: 7836/10000 (78.3600%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0184, Accuracy: 8909/8968 (99.3421%)
Scaling by  100
Scaled Norm after poisoning: 456.4890983090396, distance: 457.1135663049173
Total norm for 4 adversaries is: 456.4890983090396. distance: 457.1135663049173
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 11800570.6378, Accuracy: 66/8968 (0.7360%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   1,  Average loss: 0.0172, Accuracy: 402/568 (70.7746%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   2,  Average loss: 0.0051, Accuracy: 510/568 (89.7887%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   3,  Average loss: 0.0036, Accuracy: 524/568 (92.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   4,  Average loss: 0.0032, Accuracy: 524/568 (92.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   5,  Average loss: 0.0024, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   6,  Average loss: 0.0020, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   7,  Average loss: 0.0019, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   8,  Average loss: 0.0016, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch  10,  Average loss: 0.0012, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Global model norm: 16.61173769060788.
Norm before scaling: 16.860976884626414. Distance: 3.988689764100578
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.8275, Accuracy: 7417/10000 (74.1700%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0255, Accuracy: 8880/8968 (99.0187%)
Scaling by  100
Scaled Norm after poisoning: 398.26588951352585, distance: 398.86898694934905
Total norm for 4 adversaries is: 398.26588951352585. distance: 398.86898694934905
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 2.1098, Accuracy: 8965/8968 (99.9665%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   1,  Average loss: 0.0229, Accuracy: 339/557 (60.8618%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   2,  Average loss: 0.0082, Accuracy: 468/557 (84.0215%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   3,  Average loss: 0.0036, Accuracy: 516/557 (92.6391%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   4,  Average loss: 0.0024, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   5,  Average loss: 0.0023, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   7,  Average loss: 0.0018, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   9,  Average loss: 0.0014, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.61173769060788.
Norm before scaling: 16.92504154352361. Distance: 4.596944930570971
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.8609, Accuracy: 7579/10000 (75.7900%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0165, Accuracy: 8913/8968 (99.3867%)
Scaling by  100
Scaled Norm after poisoning: 458.8382067788165, distance: 459.69448074237306
Total norm for 4 adversaries is: 458.8382067788165. distance: 459.69448074237306
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  27, local model 55, internal_epoch   1,  Average loss: 0.0021, Accuracy: 345/354 (97.4576%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2989, Accuracy: 9082/10000 (90.8200%)
___Train Local_Simple,  epoch  27, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 269/276 (97.4638%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1427, Accuracy: 9563/10000 (95.6300%)
___Train Local_Simple,  epoch  27, local model 53, internal_epoch   1,  Average loss: 0.0013, Accuracy: 718/739 (97.1583%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2497, Accuracy: 9262/10000 (92.6200%)
___Train Local_Simple,  epoch  27, local model 14, internal_epoch   1,  Average loss: 0.0015, Accuracy: 365/376 (97.0745%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3539, Accuracy: 9048/10000 (90.4800%)
___Train Local_Simple,  epoch  27, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 976/1005 (97.1144%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2880, Accuracy: 9096/10000 (90.9600%)
___Train Local_Simple,  epoch  27, local model 6, internal_epoch   1,  Average loss: 0.0016, Accuracy: 594/615 (96.5854%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1614, Accuracy: 9495/10000 (94.9500%)
time spent on training: 134.18240213394165
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.40829963073676806  data num: [606, 591, 568, 557, 354, 276, 739, 376, 1005, 615]
[foolsgold agg] considering poison per batch poison_fraction: 0.12759363460524
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 0.0867, Accuracy: 9726/10000 (97.2600%)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 11.2131, Accuracy: 64/8968 (0.7136%)
Done in 157.93284821510315 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:28 choose agents : [41, 73, 51, 74, 47, 92, 37, 43, 17, 2]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   1,  Average loss: 0.0184, Accuracy: 404/606 (66.6667%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   2,  Average loss: 0.0053, Accuracy: 538/606 (88.7789%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   3,  Average loss: 0.0022, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   4,  Average loss: 0.0018, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   5,  Average loss: 0.0016, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   6,  Average loss: 0.0013, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   7,  Average loss: 0.0013, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   8,  Average loss: 0.0013, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch  10,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Global model norm: 16.61715444284441.
Norm before scaling: 16.992327585629454. Distance: 4.377301074202443
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.7757, Accuracy: 7826/10000 (78.2600%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0046, Accuracy: 8956/8968 (99.8662%)
Scaling by  100
Scaled Norm after poisoning: 437.296988613002, distance: 437.73011805220807
Total norm for 4 adversaries is: 437.296988613002. distance: 437.73011805220807
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   1,  Average loss: 0.0197, Accuracy: 431/591 (72.9272%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 522/591 (88.3249%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   3,  Average loss: 0.0033, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   4,  Average loss: 0.0039, Accuracy: 557/591 (94.2470%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   5,  Average loss: 0.0026, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   6,  Average loss: 0.0021, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   7,  Average loss: 0.0022, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   8,  Average loss: 0.0018, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   9,  Average loss: 0.0015, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch  10,  Average loss: 0.0016, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Global model norm: 16.61715444284441.
Norm before scaling: 17.034455331974407. Distance: 4.669298973644056
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6392, Accuracy: 7991/10000 (79.9100%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0133, Accuracy: 8928/8968 (99.5540%)
Scaling by  100
Scaled Norm after poisoning: 466.3943308778528, distance: 466.9298662540232
Total norm for 4 adversaries is: 466.3943308778528. distance: 466.9298662540232
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0211, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   2,  Average loss: 0.0062, Accuracy: 519/568 (91.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   3,  Average loss: 0.0036, Accuracy: 531/568 (93.4859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   4,  Average loss: 0.0033, Accuracy: 533/568 (93.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   5,  Average loss: 0.0032, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   6,  Average loss: 0.0026, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   7,  Average loss: 0.0023, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   8,  Average loss: 0.0019, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   9,  Average loss: 0.0017, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch  10,  Average loss: 0.0016, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Global model norm: 16.61715444284441.
Norm before scaling: 17.007062454752255. Distance: 4.898478189935167
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.0728, Accuracy: 6222/10000 (62.2200%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0065, Accuracy: 8952/8968 (99.8216%)
Scaling by  100
Scaled Norm after poisoning: 489.01792528495315, distance: 489.8478079975453
Total norm for 4 adversaries is: 489.01792528495315. distance: 489.8478079975453
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 23.0624, Accuracy: 8963/8968 (99.9442%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   1,  Average loss: 0.0206, Accuracy: 374/557 (67.1454%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   2,  Average loss: 0.0061, Accuracy: 493/557 (88.5099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   3,  Average loss: 0.0028, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   4,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   5,  Average loss: 0.0019, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   8,  Average loss: 0.0014, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch  10,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.61715444284441.
Norm before scaling: 16.898242457265525. Distance: 4.116715405956863
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.7072, Accuracy: 7816/10000 (78.1600%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0071, Accuracy: 8945/8968 (99.7435%)
Scaling by  100
Scaled Norm after poisoning: 411.09235200256404, distance: 411.67153548065477
Total norm for 4 adversaries is: 411.09235200256404. distance: 411.67153548065477
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  28, local model 47, internal_epoch   1,  Average loss: 0.0015, Accuracy: 751/776 (96.7784%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2167, Accuracy: 9324/10000 (93.2400%)
___Train Local_Simple,  epoch  28, local model 92, internal_epoch   1,  Average loss: 0.0014, Accuracy: 912/937 (97.3319%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.8051, Accuracy: 7770/10000 (77.7000%)
___Train Local_Simple,  epoch  28, local model 37, internal_epoch   1,  Average loss: 0.0014, Accuracy: 834/860 (96.9767%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3896, Accuracy: 8833/10000 (88.3300%)
___Train Local_Simple,  epoch  28, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 399/408 (97.7941%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2260, Accuracy: 9288/10000 (92.8800%)
___Train Local_Simple,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0017, Accuracy: 602/620 (97.0968%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1634, Accuracy: 9468/10000 (94.6800%)
___Train Local_Simple,  epoch  28, local model 2, internal_epoch   1,  Average loss: 0.0013, Accuracy: 540/548 (98.5401%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1514, Accuracy: 9518/10000 (95.1800%)
time spent on training: 130.2880299091339
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3588317107093185  data num: [606, 591, 568, 557, 776, 937, 860, 408, 620, 548]
[foolsgold agg] considering poison per batch poison_fraction: 0.11213490959666203
[foolsgold agg] wv: [1.         1.         0.95475903 0.95475903 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 0.0872, Accuracy: 9723/10000 (97.2300%)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 11.0894, Accuracy: 67/8968 (0.7471%)
Done in 152.9826352596283 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:29 choose agents : [41, 73, 51, 74, 66, 6, 38, 37, 45, 81]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   1,  Average loss: 0.0193, Accuracy: 402/606 (66.3366%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   2,  Average loss: 0.0053, Accuracy: 542/606 (89.4389%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   3,  Average loss: 0.0031, Accuracy: 564/606 (93.0693%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   4,  Average loss: 0.0024, Accuracy: 576/606 (95.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   5,  Average loss: 0.0021, Accuracy: 581/606 (95.8746%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   6,  Average loss: 0.0018, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   7,  Average loss: 0.0012, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   8,  Average loss: 0.0015, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   9,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch  10,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Global model norm: 16.62132647090309.
Norm before scaling: 16.971085136575404. Distance: 4.327208935024792
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.9158, Accuracy: 7335/10000 (73.3500%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0057, Accuracy: 8949/8968 (99.7881%)
Scaling by  100
Scaled Norm after poisoning: 432.23382343935094, distance: 432.7208973460838
Total norm for 4 adversaries is: 432.23382343935094. distance: 432.7208973460838
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   1,  Average loss: 0.0194, Accuracy: 404/591 (68.3587%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   2,  Average loss: 0.0058, Accuracy: 523/591 (88.4941%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   3,  Average loss: 0.0032, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   4,  Average loss: 0.0035, Accuracy: 550/591 (93.0626%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   5,  Average loss: 0.0026, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   6,  Average loss: 0.0020, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   7,  Average loss: 0.0018, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   8,  Average loss: 0.0016, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   9,  Average loss: 0.0012, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch  10,  Average loss: 0.0014, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Global model norm: 16.62132647090309.
Norm before scaling: 17.08965223106972. Distance: 4.7811807864296885
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.7472, Accuracy: 7684/10000 (76.8400%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0235, Accuracy: 8893/8968 (99.1637%)
Scaling by  100
Scaled Norm after poisoning: 477.667199130315, distance: 478.11807184522945
Total norm for 4 adversaries is: 477.667199130315. distance: 478.11807184522945
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 1981536.8564, Accuracy: 2243/8968 (25.0112%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   1,  Average loss: 0.0187, Accuracy: 410/568 (72.1831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   2,  Average loss: 0.0042, Accuracy: 525/568 (92.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   3,  Average loss: 0.0024, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   4,  Average loss: 0.0018, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   5,  Average loss: 0.0015, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   6,  Average loss: 0.0011, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   7,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   8,  Average loss: 0.0009, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   9,  Average loss: 0.0010, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch  10,  Average loss: 0.0011, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Global model norm: 16.62132647090309.
Norm before scaling: 16.99055038809027. Distance: 4.315803478840151
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.6814, Accuracy: 7783/10000 (77.8300%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0231, Accuracy: 8881/8968 (99.0299%)
Scaling by  100
Scaled Norm after poisoning: 431.18010303120434, distance: 431.58036259195114
Total norm for 4 adversaries is: 431.18010303120434. distance: 431.58036259195114
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   1,  Average loss: 0.0219, Accuracy: 345/557 (61.9390%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   2,  Average loss: 0.0079, Accuracy: 488/557 (87.6122%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   3,  Average loss: 0.0036, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   4,  Average loss: 0.0027, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   5,  Average loss: 0.0022, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   6,  Average loss: 0.0020, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   7,  Average loss: 0.0018, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.62132647090309.
Norm before scaling: 17.0393177207502. Distance: 5.111725339516519
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.9785, Accuracy: 7475/10000 (74.7500%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0069, Accuracy: 8949/8968 (99.7881%)
Scaling by  100
Scaled Norm after poisoning: 510.2623406150997, distance: 511.1725491455894
Total norm for 4 adversaries is: 510.2623406150997. distance: 511.1725491455894
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  29, local model 66, internal_epoch   1,  Average loss: 0.0014, Accuracy: 643/660 (97.4242%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1601, Accuracy: 9474/10000 (94.7400%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   1,  Average loss: 0.0011, Accuracy: 601/615 (97.7236%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.4420, Accuracy: 8896/10000 (88.9600%)
___Train Local_Simple,  epoch  29, local model 38, internal_epoch   1,  Average loss: 0.0019, Accuracy: 861/895 (96.2011%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.9701, Accuracy: 7727/10000 (77.2700%)
___Train Local_Simple,  epoch  29, local model 37, internal_epoch   1,  Average loss: 0.0014, Accuracy: 838/860 (97.4419%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3340, Accuracy: 9026/10000 (90.2600%)
___Train Local_Simple,  epoch  29, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 614/628 (97.7707%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2337, Accuracy: 9290/10000 (92.9000%)
___Train Local_Simple,  epoch  29, local model 81, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1202/1227 (97.9625%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3806, Accuracy: 9003/10000 (90.0300%)
time spent on training: 116.62922239303589
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3221867628694325  data num: [606, 591, 568, 557, 660, 615, 895, 860, 628, 1227]
[foolsgold agg] considering poison per batch poison_fraction: 0.10068336339669764
[foolsgold agg] wv: [1.         1.         0.94509076 0.94509076 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.0874, Accuracy: 9721/10000 (97.2100%)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 10.9292, Accuracy: 72/8968 (0.8029%)
Done in 139.44848680496216 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:30 choose agents : [41, 73, 51, 74, 4, 24, 38, 54, 10, 11]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   1,  Average loss: 0.0177, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   2,  Average loss: 0.0047, Accuracy: 551/606 (90.9241%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   3,  Average loss: 0.0025, Accuracy: 574/606 (94.7195%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   4,  Average loss: 0.0020, Accuracy: 581/606 (95.8746%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   5,  Average loss: 0.0020, Accuracy: 581/606 (95.8746%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   6,  Average loss: 0.0017, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   7,  Average loss: 0.0013, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   8,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   9,  Average loss: 0.0011, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch  10,  Average loss: 0.0009, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Global model norm: 16.625755350262942.
Norm before scaling: 17.03354879841452. Distance: 4.292487328343469
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.7798, Accuracy: 7690/10000 (76.9000%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0101, Accuracy: 8928/8968 (99.5540%)
Scaling by  100
Scaled Norm after poisoning: 429.02325476015864, distance: 429.248780574855
Total norm for 4 adversaries is: 429.02325476015864. distance: 429.248780574855
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   1,  Average loss: 0.0198, Accuracy: 404/591 (68.3587%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 526/591 (89.0017%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   3,  Average loss: 0.0019, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   4,  Average loss: 0.0018, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   5,  Average loss: 0.0015, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   6,  Average loss: 0.0014, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   7,  Average loss: 0.0010, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   8,  Average loss: 0.0010, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   9,  Average loss: 0.0009, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch  10,  Average loss: 0.0008, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Global model norm: 16.625755350262942.
Norm before scaling: 17.031011681245445. Distance: 4.401567067342656
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.5653, Accuracy: 8169/10000 (81.6900%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0241, Accuracy: 8880/8968 (99.0187%)
Scaling by  100
Scaled Norm after poisoning: 439.8191922540443, distance: 440.15673699831063
Total norm for 4 adversaries is: 439.8191922540443. distance: 440.15673699831063
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   1,  Average loss: 0.0160, Accuracy: 414/568 (72.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   2,  Average loss: 0.0051, Accuracy: 514/568 (90.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   3,  Average loss: 0.0033, Accuracy: 533/568 (93.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   4,  Average loss: 0.0032, Accuracy: 533/568 (93.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   5,  Average loss: 0.0023, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   6,  Average loss: 0.0025, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   7,  Average loss: 0.0015, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   8,  Average loss: 0.0016, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   9,  Average loss: 0.0015, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch  10,  Average loss: 0.0016, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Global model norm: 16.625755350262942.
Norm before scaling: 16.915929818979063. Distance: 4.061554314509044
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.8620, Accuracy: 7176/10000 (71.7600%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0046, Accuracy: 8954/8968 (99.8439%)
Scaling by  100
Scaled Norm after poisoning: 405.6628256631362, distance: 406.15543130062906
Total norm for 4 adversaries is: 405.6628256631362. distance: 406.15543130062906
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   1,  Average loss: 0.0238, Accuracy: 352/557 (63.1957%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   2,  Average loss: 0.0074, Accuracy: 470/557 (84.3806%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   3,  Average loss: 0.0036, Accuracy: 520/557 (93.3573%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   4,  Average loss: 0.0030, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   5,  Average loss: 0.0021, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   6,  Average loss: 0.0018, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   7,  Average loss: 0.0019, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   9,  Average loss: 0.0014, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.625755350262942.
Norm before scaling: 17.015416952355295. Distance: 4.663521637858289
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.6237, Accuracy: 7975/10000 (79.7500%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0168, Accuracy: 8904/8968 (99.2864%)
Scaling by  100
Scaled Norm after poisoning: 465.72180201811466, distance: 466.35218384285497
Total norm for 4 adversaries is: 465.72180201811466. distance: 466.35218384285497
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  30, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 637/658 (96.8085%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2493, Accuracy: 9124/10000 (91.2400%)
___Train Local_Simple,  epoch  30, local model 24, internal_epoch   1,  Average loss: 0.0018, Accuracy: 366/379 (96.5699%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1673, Accuracy: 9459/10000 (94.5900%)
___Train Local_Simple,  epoch  30, local model 38, internal_epoch   1,  Average loss: 0.0022, Accuracy: 859/895 (95.9777%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.5411, Accuracy: 8402/10000 (84.0200%)
___Train Local_Simple,  epoch  30, local model 54, internal_epoch   1,  Average loss: 0.0015, Accuracy: 503/519 (96.9171%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.5165, Accuracy: 8647/10000 (86.4700%)
___Train Local_Simple,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0017, Accuracy: 861/892 (96.5247%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1772, Accuracy: 9425/10000 (94.2500%)
___Train Local_Simple,  epoch  30, local model 11, internal_epoch   1,  Average loss: 0.0021, Accuracy: 624/645 (96.7442%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1879, Accuracy: 9395/10000 (93.9500%)
time spent on training: 114.79203534126282
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.36798732171156895  data num: [606, 591, 568, 557, 658, 379, 895, 519, 892, 645]
[foolsgold agg] considering poison per batch poison_fraction: 0.1149960380348653
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 0.0878, Accuracy: 9721/10000 (97.2100%)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 10.8467, Accuracy: 77/8968 (0.8586%)
Done in 137.53759455680847 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:31 choose agents : [41, 73, 51, 74, 80, 7, 72, 14, 99, 12]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   1,  Average loss: 0.0196, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   2,  Average loss: 0.0062, Accuracy: 532/606 (87.7888%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   3,  Average loss: 0.0034, Accuracy: 571/606 (94.2244%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   4,  Average loss: 0.0027, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   5,  Average loss: 0.0020, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   6,  Average loss: 0.0020, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   7,  Average loss: 0.0016, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   8,  Average loss: 0.0015, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   9,  Average loss: 0.0013, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch  10,  Average loss: 0.0013, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Global model norm: 16.630935412517015.
Norm before scaling: 17.089291508934586. Distance: 4.923073855729248
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.8837, Accuracy: 7354/10000 (73.5400%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0018, Accuracy: 8964/8968 (99.9554%)
Scaling by  100
Scaled Norm after poisoning: 491.6961078755861, distance: 492.3073703236627
Total norm for 4 adversaries is: 491.6961078755861. distance: 492.3073703236627
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   1,  Average loss: 0.0205, Accuracy: 407/591 (68.8663%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   2,  Average loss: 0.0060, Accuracy: 521/591 (88.1557%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   3,  Average loss: 0.0035, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   4,  Average loss: 0.0027, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   5,  Average loss: 0.0021, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   6,  Average loss: 0.0021, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   7,  Average loss: 0.0014, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   8,  Average loss: 0.0014, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   9,  Average loss: 0.0012, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch  10,  Average loss: 0.0012, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Global model norm: 16.630935412517015.
Norm before scaling: 17.112424813795748. Distance: 4.681665069554456
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.6958, Accuracy: 7722/10000 (77.2200%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0162, Accuracy: 8913/8968 (99.3867%)
Scaling by  100
Scaled Norm after poisoning: 467.85614776339105, distance: 468.166520188063
Total norm for 4 adversaries is: 467.85614776339105. distance: 468.166520188063
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 880.9127, Accuracy: 8891/8968 (99.1414%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   1,  Average loss: 0.0176, Accuracy: 422/568 (74.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   2,  Average loss: 0.0051, Accuracy: 519/568 (91.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   3,  Average loss: 0.0035, Accuracy: 531/568 (93.4859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   4,  Average loss: 0.0027, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   5,  Average loss: 0.0021, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   6,  Average loss: 0.0018, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   7,  Average loss: 0.0017, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   8,  Average loss: 0.0012, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch  10,  Average loss: 0.0013, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Global model norm: 16.630935412517015.
Norm before scaling: 17.00394618290165. Distance: 4.370627043407327
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.8896, Accuracy: 7208/10000 (72.0800%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0182, Accuracy: 8901/8968 (99.2529%)
Scaling by  100
Scaled Norm after poisoning: 436.62888274826713, distance: 437.06271003140955
Total norm for 4 adversaries is: 436.62888274826713. distance: 437.06271003140955
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 5898965.7770, Accuracy: 84/8968 (0.9367%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0193, Accuracy: 378/557 (67.8636%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   2,  Average loss: 0.0065, Accuracy: 489/557 (87.7917%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   3,  Average loss: 0.0024, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   4,  Average loss: 0.0021, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   5,  Average loss: 0.0018, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   6,  Average loss: 0.0016, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   7,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   8,  Average loss: 0.0012, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch  10,  Average loss: 0.0013, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Global model norm: 16.630935412517015.
Norm before scaling: 16.919547501233133. Distance: 4.0812006201100814
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.7170, Accuracy: 7969/10000 (79.6900%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0204, Accuracy: 8891/8968 (99.1414%)
Scaling by  100
Scaled Norm after poisoning: 407.6043194692618, distance: 408.12008036851114
Total norm for 4 adversaries is: 407.6043194692618. distance: 408.12008036851114
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  31, local model 80, internal_epoch   1,  Average loss: 0.0009, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2260, Accuracy: 9345/10000 (93.4500%)
___Train Local_Simple,  epoch  31, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 409/418 (97.8469%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1533, Accuracy: 9521/10000 (95.2100%)
___Train Local_Simple,  epoch  31, local model 72, internal_epoch   1,  Average loss: 0.0006, Accuracy: 723/731 (98.9056%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1991, Accuracy: 9362/10000 (93.6200%)
___Train Local_Simple,  epoch  31, local model 14, internal_epoch   1,  Average loss: 0.0019, Accuracy: 364/376 (96.8085%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2643, Accuracy: 9183/10000 (91.8300%)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: 0.0010, Accuracy: 373/377 (98.9390%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1035, Accuracy: 9690/10000 (96.9000%)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1124/1160 (96.8966%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3614, Accuracy: 8890/10000 (88.9000%)
time spent on training: 114.87988901138306
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3993121238177128  data num: [606, 591, 568, 557, 431, 418, 731, 376, 377, 1160]
[foolsgold agg] considering poison per batch poison_fraction: 0.12478503869303526
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.0881, Accuracy: 9721/10000 (97.2100%)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 10.7790, Accuracy: 76/8968 (0.8475%)
Done in 137.43583965301514 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:32 choose agents : [41, 73, 51, 74, 93, 25, 34, 57, 69, 58]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   1,  Average loss: 0.0174, Accuracy: 436/606 (71.9472%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   2,  Average loss: 0.0046, Accuracy: 551/606 (90.9241%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   3,  Average loss: 0.0025, Accuracy: 571/606 (94.2244%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   4,  Average loss: 0.0022, Accuracy: 582/606 (96.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   5,  Average loss: 0.0015, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   6,  Average loss: 0.0015, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   7,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   9,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch  10,  Average loss: 0.0011, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Global model norm: 16.636528435017343.
Norm before scaling: 17.008634281938065. Distance: 4.196488029267468
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6990, Accuracy: 7937/10000 (79.3700%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0060, Accuracy: 8948/8968 (99.7770%)
Scaling by  100
Scaled Norm after poisoning: 419.3719075891946, distance: 419.64881150790836
Total norm for 4 adversaries is: 419.3719075891946. distance: 419.64881150790836
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   1,  Average loss: 0.0162, Accuracy: 434/591 (73.4349%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 544/591 (92.0474%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   3,  Average loss: 0.0020, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   4,  Average loss: 0.0019, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   5,  Average loss: 0.0015, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   6,  Average loss: 0.0011, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   7,  Average loss: 0.0009, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   8,  Average loss: 0.0008, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   9,  Average loss: 0.0008, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch  10,  Average loss: 0.0007, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Global model norm: 16.636528435017343.
Norm before scaling: 17.010449059247836. Distance: 4.167074234420464
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5375, Accuracy: 8282/10000 (82.8200%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0187, Accuracy: 8899/8968 (99.2306%)
Scaling by  100
Scaled Norm after poisoning: 416.4655598005674, distance: 416.7074438380001
Total norm for 4 adversaries is: 416.4655598005674. distance: 416.7074438380001
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   1,  Average loss: 0.0173, Accuracy: 412/568 (72.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   2,  Average loss: 0.0059, Accuracy: 507/568 (89.2606%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   3,  Average loss: 0.0038, Accuracy: 521/568 (91.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   4,  Average loss: 0.0028, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   5,  Average loss: 0.0027, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   6,  Average loss: 0.0024, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   7,  Average loss: 0.0020, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   8,  Average loss: 0.0018, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   9,  Average loss: 0.0014, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch  10,  Average loss: 0.0017, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Global model norm: 16.636528435017343.
Norm before scaling: 17.100549771578525. Distance: 4.8378052686631445
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.9550, Accuracy: 6984/10000 (69.8400%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0073, Accuracy: 8947/8968 (99.7658%)
Scaling by  100
Scaled Norm after poisoning: 483.2653741734452, distance: 483.7805384417608
Total norm for 4 adversaries is: 483.2653741734452. distance: 483.7805384417608
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 18677153.5486, Accuracy: 1/8968 (0.0112%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   1,  Average loss: 0.0207, Accuracy: 376/557 (67.5045%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   2,  Average loss: 0.0059, Accuracy: 506/557 (90.8438%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   3,  Average loss: 0.0033, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   4,  Average loss: 0.0022, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   5,  Average loss: 0.0019, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   8,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   9,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch  10,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.636528435017343.
Norm before scaling: 16.986886745047265. Distance: 4.334168109205334
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6675, Accuracy: 8067/10000 (80.6700%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0156, Accuracy: 8911/8968 (99.3644%)
Scaling by  100
Scaled Norm after poisoning: 432.9277328550344, distance: 433.4168028584033
Total norm for 4 adversaries is: 432.9277328550344. distance: 433.4168028584033
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 617/623 (99.0369%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3688, Accuracy: 8978/10000 (89.7800%)
___Train Local_Simple,  epoch  32, local model 25, internal_epoch   1,  Average loss: 0.0016, Accuracy: 627/647 (96.9088%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5371, Accuracy: 8282/10000 (82.8200%)
___Train Local_Simple,  epoch  32, local model 34, internal_epoch   1,  Average loss: 0.0006, Accuracy: 404/413 (97.8208%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2738, Accuracy: 9259/10000 (92.5900%)
___Train Local_Simple,  epoch  32, local model 57, internal_epoch   1,  Average loss: 0.0025, Accuracy: 330/343 (96.2099%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2432, Accuracy: 9319/10000 (93.1900%)
___Train Local_Simple,  epoch  32, local model 69, internal_epoch   1,  Average loss: 0.0022, Accuracy: 246/256 (96.0938%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2063, Accuracy: 9367/10000 (93.6700%)
___Train Local_Simple,  epoch  32, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 268/276 (97.1014%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1760, Accuracy: 9458/10000 (94.5800%)
time spent on training: 115.29063296318054
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.47581967213114756  data num: [606, 591, 568, 557, 623, 647, 413, 343, 256, 276]
[foolsgold agg] considering poison per batch poison_fraction: 0.1486936475409836
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.0886, Accuracy: 9720/10000 (97.2000%)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 10.6561, Accuracy: 83/8968 (0.9255%)
Done in 138.0636899471283 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:33 choose agents : [41, 73, 51, 74, 2, 4, 1, 20, 49, 57]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   1,  Average loss: 0.0173, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   2,  Average loss: 0.0043, Accuracy: 553/606 (91.2541%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   3,  Average loss: 0.0021, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   4,  Average loss: 0.0018, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   5,  Average loss: 0.0017, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   6,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   7,  Average loss: 0.0012, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   9,  Average loss: 0.0010, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch  10,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Global model norm: 16.64127786277995.
Norm before scaling: 17.049780272021653. Distance: 4.456711566235708
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.7963, Accuracy: 7790/10000 (77.9000%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0075, Accuracy: 8937/8968 (99.6543%)
Scaling by  100
Scaled Norm after poisoning: 445.29739009453, distance: 445.6711581985085
Total norm for 4 adversaries is: 445.29739009453. distance: 445.6711581985085
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   1,  Average loss: 0.0162, Accuracy: 439/591 (74.2809%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   2,  Average loss: 0.0048, Accuracy: 540/591 (91.3706%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   3,  Average loss: 0.0029, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   4,  Average loss: 0.0019, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   5,  Average loss: 0.0015, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   6,  Average loss: 0.0014, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   7,  Average loss: 0.0012, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   8,  Average loss: 0.0009, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   9,  Average loss: 0.0008, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch  10,  Average loss: 0.0010, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Global model norm: 16.64127786277995.
Norm before scaling: 17.007938102430106. Distance: 4.305512669394143
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.6305, Accuracy: 8006/10000 (80.0600%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0331, Accuracy: 8864/8968 (98.8403%)
Scaling by  100
Scaled Norm after poisoning: 430.1527163403714, distance: 430.5512454981404
Total norm for 4 adversaries is: 430.1527163403714. distance: 430.5512454981404
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 10412.2290, Accuracy: 8792/8968 (98.0375%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   1,  Average loss: 0.0155, Accuracy: 429/568 (75.5282%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   2,  Average loss: 0.0055, Accuracy: 516/568 (90.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   3,  Average loss: 0.0031, Accuracy: 533/568 (93.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   4,  Average loss: 0.0028, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   5,  Average loss: 0.0021, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   6,  Average loss: 0.0022, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   7,  Average loss: 0.0020, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   8,  Average loss: 0.0017, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   9,  Average loss: 0.0018, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch  10,  Average loss: 0.0017, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Global model norm: 16.64127786277995.
Norm before scaling: 16.93209651324916. Distance: 4.017608746313178
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.9726, Accuracy: 6749/10000 (67.4900%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0072, Accuracy: 8954/8968 (99.8439%)
Scaling by  100
Scaled Norm after poisoning: 401.3115801655866, distance: 401.76087026364326
Total norm for 4 adversaries is: 401.3115801655866. distance: 401.76087026364326
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 3045619.6358, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   1,  Average loss: 0.0186, Accuracy: 374/557 (67.1454%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   2,  Average loss: 0.0065, Accuracy: 479/557 (85.9964%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   3,  Average loss: 0.0026, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   4,  Average loss: 0.0023, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   5,  Average loss: 0.0019, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch  10,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Global model norm: 16.64127786277995.
Norm before scaling: 16.97254072529729. Distance: 4.219134503962207
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5822, Accuracy: 8214/10000 (82.1400%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0100, Accuracy: 8931/8968 (99.5874%)
Scaling by  100
Scaled Norm after poisoning: 421.4514169806527, distance: 421.9134612097604
Total norm for 4 adversaries is: 421.4514169806527. distance: 421.9134612097604
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 174608.3556, Accuracy: 7514/8968 (83.7868%)
___Train Local_Simple,  epoch  33, local model 2, internal_epoch   1,  Average loss: 0.0014, Accuracy: 539/548 (98.3577%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1443, Accuracy: 9532/10000 (95.3200%)
___Train Local_Simple,  epoch  33, local model 4, internal_epoch   1,  Average loss: 0.0019, Accuracy: 637/658 (96.8085%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2821, Accuracy: 9030/10000 (90.3000%)
___Train Local_Simple,  epoch  33, local model 1, internal_epoch   1,  Average loss: 0.0018, Accuracy: 736/760 (96.8421%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2490, Accuracy: 9105/10000 (91.0500%)
___Train Local_Simple,  epoch  33, local model 20, internal_epoch   1,  Average loss: 0.0014, Accuracy: 418/429 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5277, Accuracy: 8525/10000 (85.2500%)
___Train Local_Simple,  epoch  33, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 496/506 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2093, Accuracy: 9382/10000 (93.8200%)
___Train Local_Simple,  epoch  33, local model 57, internal_epoch   1,  Average loss: 0.0019, Accuracy: 332/343 (96.7930%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3367, Accuracy: 9024/10000 (90.2400%)
time spent on training: 115.92966938018799
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41717570966582823  data num: [606, 591, 568, 557, 548, 658, 760, 429, 506, 343]
[foolsgold agg] considering poison per batch poison_fraction: 0.13036740927057133
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.0889, Accuracy: 9721/10000 (97.2100%)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 10.5090, Accuracy: 90/8968 (1.0036%)
Done in 138.8042368888855 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:34 choose agents : [41, 73, 51, 74, 27, 43, 49, 0, 45, 25]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0178, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 562/606 (92.7393%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   3,  Average loss: 0.0025, Accuracy: 576/606 (95.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   4,  Average loss: 0.0023, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   5,  Average loss: 0.0018, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   6,  Average loss: 0.0018, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   7,  Average loss: 0.0015, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   8,  Average loss: 0.0015, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   9,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch  10,  Average loss: 0.0015, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Global model norm: 16.64627343249693.
Norm before scaling: 17.100293680089607. Distance: 4.70145302895776
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.8955, Accuracy: 7315/10000 (73.1500%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0032, Accuracy: 8959/8968 (99.8996%)
Scaling by  100
Scaled Norm after poisoning: 469.7185493729197, distance: 470.14527342620386
Total norm for 4 adversaries is: 469.7185493729197. distance: 470.14527342620386
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   1,  Average loss: 0.0174, Accuracy: 435/591 (73.6041%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 533/591 (90.1861%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   3,  Average loss: 0.0032, Accuracy: 548/591 (92.7242%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   4,  Average loss: 0.0027, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   5,  Average loss: 0.0021, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   6,  Average loss: 0.0016, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   7,  Average loss: 0.0013, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   8,  Average loss: 0.0013, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   9,  Average loss: 0.0012, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch  10,  Average loss: 0.0012, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Global model norm: 16.64627343249693.
Norm before scaling: 17.02780838936479. Distance: 4.457888976202246
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.7623, Accuracy: 7677/10000 (76.7700%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0102, Accuracy: 8933/8968 (99.6097%)
Scaling by  100
Scaled Norm after poisoning: 445.31153070069945, distance: 445.7889074438708
Total norm for 4 adversaries is: 445.31153070069945. distance: 445.7889074438708
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 2774278.4353, Accuracy: 3247/8968 (36.2065%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   1,  Average loss: 0.0147, Accuracy: 429/568 (75.5282%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 533/568 (93.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   3,  Average loss: 0.0032, Accuracy: 532/568 (93.6620%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   4,  Average loss: 0.0025, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   5,  Average loss: 0.0024, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   6,  Average loss: 0.0020, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   7,  Average loss: 0.0019, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   8,  Average loss: 0.0014, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   9,  Average loss: 0.0015, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch  10,  Average loss: 0.0016, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Global model norm: 16.64627343249693.
Norm before scaling: 16.933335584104693. Distance: 3.8971423365612985
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.8494, Accuracy: 7053/10000 (70.5300%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0072, Accuracy: 8954/8968 (99.8439%)
Scaling by  100
Scaled Norm after poisoning: 389.3577644660499, distance: 389.71423825670007
Total norm for 4 adversaries is: 389.3577644660499. distance: 389.71423825670007
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 860892.7967, Accuracy: 4/8968 (0.0446%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   1,  Average loss: 0.0170, Accuracy: 411/557 (73.7882%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   3,  Average loss: 0.0027, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   4,  Average loss: 0.0016, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   5,  Average loss: 0.0018, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   8,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch  10,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Global model norm: 16.64627343249693.
Norm before scaling: 16.935827869490172. Distance: 3.7760085672265187
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.5049, Accuracy: 8346/10000 (83.4600%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0084, Accuracy: 8935/8968 (99.6320%)
Scaling by  100
Scaled Norm after poisoning: 377.36727799320386, distance: 377.60085573261085
Total norm for 4 adversaries is: 377.36727799320386. distance: 377.60085573261085
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  34, local model 27, internal_epoch   1,  Average loss: 0.0015, Accuracy: 455/471 (96.6030%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3505, Accuracy: 9097/10000 (90.9700%)
___Train Local_Simple,  epoch  34, local model 43, internal_epoch   1,  Average loss: 0.0013, Accuracy: 398/408 (97.5490%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1761, Accuracy: 9466/10000 (94.6600%)
___Train Local_Simple,  epoch  34, local model 49, internal_epoch   1,  Average loss: 0.0010, Accuracy: 493/506 (97.4308%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1823, Accuracy: 9458/10000 (94.5800%)
___Train Local_Simple,  epoch  34, local model 0, internal_epoch   1,  Average loss: 0.0022, Accuracy: 418/435 (96.0920%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2577, Accuracy: 9224/10000 (92.2400%)
___Train Local_Simple,  epoch  34, local model 45, internal_epoch   1,  Average loss: 0.0013, Accuracy: 614/628 (97.7707%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3406, Accuracy: 8926/10000 (89.2600%)
___Train Local_Simple,  epoch  34, local model 25, internal_epoch   1,  Average loss: 0.0017, Accuracy: 623/647 (96.2906%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.5530, Accuracy: 8403/10000 (84.0300%)
time spent on training: 126.86918258666992
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4286505445818719  data num: [606, 591, 568, 557, 471, 408, 506, 435, 628, 647]
[foolsgold agg] considering poison per batch poison_fraction: 0.13395329518183496
[foolsgold agg] wv: [1.         1.         1.         1.         0.54928581 1.
 0.54928581 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.0893, Accuracy: 9721/10000 (97.2100%)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 10.3816, Accuracy: 97/8968 (1.0816%)
Done in 149.5236942768097 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:35 choose agents : [41, 73, 51, 74, 8, 12, 55, 26, 62, 65]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   1,  Average loss: 0.0155, Accuracy: 447/606 (73.7624%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   2,  Average loss: 0.0043, Accuracy: 560/606 (92.4092%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   3,  Average loss: 0.0019, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   4,  Average loss: 0.0018, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   5,  Average loss: 0.0018, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   6,  Average loss: 0.0014, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   7,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   8,  Average loss: 0.0011, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   9,  Average loss: 0.0009, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch  10,  Average loss: 0.0011, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Global model norm: 16.65071217156529.
Norm before scaling: 17.029814661420826. Distance: 4.23741305551821
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.8431, Accuracy: 7562/10000 (75.6200%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0038, Accuracy: 8956/8968 (99.8662%)
Scaling by  100
Scaled Norm after poisoning: 423.45624036020536, distance: 423.7412794087921
Total norm for 4 adversaries is: 423.45624036020536. distance: 423.7412794087921
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   1,  Average loss: 0.0161, Accuracy: 433/591 (73.2657%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 557/591 (94.2470%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   3,  Average loss: 0.0019, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   4,  Average loss: 0.0017, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   5,  Average loss: 0.0016, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   6,  Average loss: 0.0014, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   7,  Average loss: 0.0011, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   8,  Average loss: 0.0011, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   9,  Average loss: 0.0010, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch  10,  Average loss: 0.0009, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Global model norm: 16.65071217156529.
Norm before scaling: 16.974429477997653. Distance: 4.033819518198045
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.5607, Accuracy: 8223/10000 (82.2300%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0163, Accuracy: 8907/8968 (99.3198%)
Scaling by  100
Scaled Norm after poisoning: 403.05776571107026, distance: 403.3819529924461
Total norm for 4 adversaries is: 403.05776571107026. distance: 403.3819529924461
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   1,  Average loss: 0.0147, Accuracy: 429/568 (75.5282%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 532/568 (93.6620%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   3,  Average loss: 0.0027, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   4,  Average loss: 0.0024, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   5,  Average loss: 0.0022, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   6,  Average loss: 0.0017, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   7,  Average loss: 0.0016, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   8,  Average loss: 0.0015, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch  10,  Average loss: 0.0016, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Global model norm: 16.65071217156529.
Norm before scaling: 16.948065921413054. Distance: 3.876621276336083
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.9254, Accuracy: 6970/10000 (69.7000%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0109, Accuracy: 8929/8968 (99.5651%)
Scaling by  100
Scaled Norm after poisoning: 387.3698571778656, distance: 387.6621031903944
Total norm for 4 adversaries is: 387.3698571778656. distance: 387.6621031903944
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 3457099.5818, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   1,  Average loss: 0.0191, Accuracy: 364/557 (65.3501%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   2,  Average loss: 0.0061, Accuracy: 505/557 (90.6643%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   3,  Average loss: 0.0024, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   4,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   5,  Average loss: 0.0017, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   6,  Average loss: 0.0013, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   8,  Average loss: 0.0009, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Global model norm: 16.65071217156529.
Norm before scaling: 17.004970048419853. Distance: 4.245443482075467
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.5456, Accuracy: 8186/10000 (81.8600%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0104, Accuracy: 8931/8968 (99.5874%)
Scaling by  100
Scaled Norm after poisoning: 424.15216903842423, distance: 424.54435133446304
Total norm for 4 adversaries is: 424.15216903842423. distance: 424.54435133446304
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 2946896.2284, Accuracy: 2677/8968 (29.8506%)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.0023, Accuracy: 606/633 (95.7346%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2221, Accuracy: 9319/10000 (93.1900%)
___Train Local_Simple,  epoch  35, local model 12, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1134/1160 (97.7586%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3401, Accuracy: 8899/10000 (88.9900%)
___Train Local_Simple,  epoch  35, local model 55, internal_epoch   1,  Average loss: 0.0018, Accuracy: 345/354 (97.4576%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3088, Accuracy: 9073/10000 (90.7300%)
___Train Local_Simple,  epoch  35, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 538/554 (97.1119%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1232, Accuracy: 9628/10000 (96.2800%)
___Train Local_Simple,  epoch  35, local model 62, internal_epoch   1,  Average loss: 0.0007, Accuracy: 416/423 (98.3452%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1466, Accuracy: 9562/10000 (95.6200%)
___Train Local_Simple,  epoch  35, local model 65, internal_epoch   1,  Average loss: 0.0011, Accuracy: 360/371 (97.0350%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2533, Accuracy: 9137/10000 (91.3700%)
time spent on training: 117.54921627044678
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3991748323878288  data num: [606, 591, 568, 557, 633, 1160, 354, 554, 423, 371]
[foolsgold agg] considering poison per batch poison_fraction: 0.1247421351211965
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.0899, Accuracy: 9723/10000 (97.2300%)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 10.2597, Accuracy: 106/8968 (1.1820%)
Done in 141.4502193927765 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:36 choose agents : [41, 73, 51, 74, 54, 94, 68, 33, 58, 10]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   1,  Average loss: 0.0144, Accuracy: 466/606 (76.8977%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 564/606 (93.0693%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   3,  Average loss: 0.0022, Accuracy: 581/606 (95.8746%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   4,  Average loss: 0.0015, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   5,  Average loss: 0.0013, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   6,  Average loss: 0.0011, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   7,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   8,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   9,  Average loss: 0.0010, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch  10,  Average loss: 0.0010, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Global model norm: 16.655465800019673.
Norm before scaling: 17.000499942384508. Distance: 3.972553503157537
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6491, Accuracy: 8066/10000 (80.6600%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0071, Accuracy: 8945/8968 (99.7435%)
Scaling by  100
Scaled Norm after poisoning: 397.0797700084959, distance: 397.2553492402588
Total norm for 4 adversaries is: 397.0797700084959. distance: 397.2553492402588
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   1,  Average loss: 0.0148, Accuracy: 451/591 (76.3113%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 549/591 (92.8934%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   3,  Average loss: 0.0019, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   4,  Average loss: 0.0011, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   5,  Average loss: 0.0012, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   6,  Average loss: 0.0010, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   7,  Average loss: 0.0007, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   8,  Average loss: 0.0007, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   9,  Average loss: 0.0007, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch  10,  Average loss: 0.0005, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Global model norm: 16.655465800019673.
Norm before scaling: 16.987115802027265. Distance: 3.913949808717988
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.4635, Accuracy: 8586/10000 (85.8600%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0322, Accuracy: 8872/8968 (98.9295%)
Scaling by  100
Scaled Norm after poisoning: 391.2177103289165, distance: 391.39498112520556
Total norm for 4 adversaries is: 391.2177103289165. distance: 391.39498112520556
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 8957035.4474, Accuracy: 25/8968 (0.2788%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   1,  Average loss: 0.0131, Accuracy: 431/568 (75.8803%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 532/568 (93.6620%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   3,  Average loss: 0.0024, Accuracy: 533/568 (93.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   4,  Average loss: 0.0023, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   5,  Average loss: 0.0015, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   6,  Average loss: 0.0012, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   7,  Average loss: 0.0014, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   8,  Average loss: 0.0010, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   9,  Average loss: 0.0010, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch  10,  Average loss: 0.0009, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Global model norm: 16.655465800019673.
Norm before scaling: 16.9487294488891. Distance: 3.725713669173401
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.7799, Accuracy: 7485/10000 (74.8500%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0178, Accuracy: 8904/8968 (99.2864%)
Scaling by  100
Scaled Norm after poisoning: 372.40330120717243, distance: 372.57138577727625
Total norm for 4 adversaries is: 372.40330120717243. distance: 372.57138577727625
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 6943649.5508, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   1,  Average loss: 0.0167, Accuracy: 401/557 (71.9928%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 510/557 (91.5619%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   3,  Average loss: 0.0019, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   4,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   5,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   8,  Average loss: 0.0009, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Global model norm: 16.655465800019673.
Norm before scaling: 16.970579831991138. Distance: 3.81486400416847
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.5327, Accuracy: 8298/10000 (82.9800%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0118, Accuracy: 8923/8968 (99.4982%)
Scaling by  100
Scaled Norm after poisoning: 381.3313028063655, distance: 381.48638163766736
Total norm for 4 adversaries is: 381.3313028063655. distance: 381.48638163766736
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  36, local model 54, internal_epoch   1,  Average loss: 0.0027, Accuracy: 501/519 (96.5318%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2937, Accuracy: 9066/10000 (90.6600%)
___Train Local_Simple,  epoch  36, local model 94, internal_epoch   1,  Average loss: 0.0022, Accuracy: 143/150 (95.3333%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1420, Accuracy: 9587/10000 (95.8700%)
___Train Local_Simple,  epoch  36, local model 68, internal_epoch   1,  Average loss: 0.0015, Accuracy: 481/494 (97.3684%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1397, Accuracy: 9539/10000 (95.3900%)
___Train Local_Simple,  epoch  36, local model 33, internal_epoch   1,  Average loss: 0.0017, Accuracy: 605/623 (97.1108%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1435, Accuracy: 9548/10000 (95.4800%)
___Train Local_Simple,  epoch  36, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 265/276 (96.0145%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1233, Accuracy: 9616/10000 (96.1600%)
___Train Local_Simple,  epoch  36, local model 10, internal_epoch   1,  Average loss: 0.0015, Accuracy: 865/892 (96.9731%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.5427, Accuracy: 8327/10000 (83.2700%)
time spent on training: 115.74600911140442
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.44010614101592116  data num: [606, 591, 568, 557, 519, 150, 494, 623, 276, 892]
[foolsgold agg] considering poison per batch poison_fraction: 0.13753316906747537
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.0901, Accuracy: 9725/10000 (97.2500%)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 10.1830, Accuracy: 114/8968 (1.2712%)
Done in 137.87466526031494 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:37 choose agents : [41, 73, 51, 74, 13, 81, 37, 94, 61, 57]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   1,  Average loss: 0.0179, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 572/606 (94.3894%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   3,  Average loss: 0.0018, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   4,  Average loss: 0.0014, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   5,  Average loss: 0.0016, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   6,  Average loss: 0.0012, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   7,  Average loss: 0.0011, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   8,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   9,  Average loss: 0.0010, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch  10,  Average loss: 0.0010, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Global model norm: 16.660437882291316.
Norm before scaling: 17.160752447388397. Distance: 4.900383229742327
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6903, Accuracy: 7963/10000 (79.6300%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0064, Accuracy: 8946/8968 (99.7547%)
Scaling by  100
Scaled Norm after poisoning: 489.5976824138366, distance: 490.0383116400186
Total norm for 4 adversaries is: 489.5976824138366. distance: 490.0383116400186
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   1,  Average loss: 0.0148, Accuracy: 440/591 (74.4501%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 539/591 (91.2014%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   3,  Average loss: 0.0030, Accuracy: 550/591 (93.0626%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   4,  Average loss: 0.0023, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   5,  Average loss: 0.0019, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   6,  Average loss: 0.0016, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   7,  Average loss: 0.0016, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   8,  Average loss: 0.0015, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   9,  Average loss: 0.0013, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch  10,  Average loss: 0.0013, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Global model norm: 16.660437882291316.
Norm before scaling: 17.015357765922637. Distance: 4.2697858813022425
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.7711, Accuracy: 7565/10000 (75.6500%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0071, Accuracy: 8942/8968 (99.7101%)
Scaling by  100
Scaled Norm after poisoning: 426.56813640964793, distance: 426.9785745502929
Total norm for 4 adversaries is: 426.56813640964793. distance: 426.9785745502929
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 4484963.8733, Accuracy: 1290/8968 (14.3845%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   1,  Average loss: 0.0136, Accuracy: 438/568 (77.1127%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 532/568 (93.6620%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   3,  Average loss: 0.0018, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   4,  Average loss: 0.0018, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   5,  Average loss: 0.0014, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   6,  Average loss: 0.0014, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   7,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   8,  Average loss: 0.0011, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   9,  Average loss: 0.0008, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch  10,  Average loss: 0.0007, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Global model norm: 16.660437882291316.
Norm before scaling: 17.033383968947383. Distance: 3.974140381382502
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6784, Accuracy: 7844/10000 (78.4400%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0115, Accuracy: 8922/8968 (99.4871%)
Scaling by  100
Scaled Norm after poisoning: 397.35716773452066, distance: 397.41404337919414
Total norm for 4 adversaries is: 397.35716773452066. distance: 397.41404337919414
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 12863721.7520, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   1,  Average loss: 0.0156, Accuracy: 426/557 (76.4811%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 502/557 (90.1257%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   3,  Average loss: 0.0025, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   4,  Average loss: 0.0019, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   5,  Average loss: 0.0015, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   7,  Average loss: 0.0010, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   8,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Global model norm: 16.660437882291316.
Norm before scaling: 16.909480831539078. Distance: 3.467401603287252
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.5107, Accuracy: 8376/10000 (83.7600%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0158, Accuracy: 8915/8968 (99.4090%)
Scaling by  100
Scaled Norm after poisoning: 346.61227663269517, distance: 346.7401765010798
Total norm for 4 adversaries is: 346.61227663269517. distance: 346.7401765010798
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  37, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 708/734 (96.4578%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2816, Accuracy: 9162/10000 (91.6200%)
___Train Local_Simple,  epoch  37, local model 81, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1194/1227 (97.3105%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4163, Accuracy: 8784/10000 (87.8400%)
___Train Local_Simple,  epoch  37, local model 37, internal_epoch   1,  Average loss: 0.0015, Accuracy: 834/860 (96.9767%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.3941, Accuracy: 8903/10000 (89.0300%)
___Train Local_Simple,  epoch  37, local model 94, internal_epoch   1,  Average loss: 0.0031, Accuracy: 144/150 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1631, Accuracy: 9518/10000 (95.1800%)
___Train Local_Simple,  epoch  37, local model 61, internal_epoch   1,  Average loss: 0.0016, Accuracy: 678/699 (96.9957%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4789, Accuracy: 8639/10000 (86.3900%)
___Train Local_Simple,  epoch  37, local model 57, internal_epoch   1,  Average loss: 0.0022, Accuracy: 330/343 (96.2099%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2499, Accuracy: 9286/10000 (92.8600%)
time spent on training: 113.66482901573181
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3665351223362273  data num: [606, 591, 568, 557, 734, 1227, 860, 150, 699, 343]
[foolsgold agg] considering poison per batch poison_fraction: 0.11454222573007103
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.0906, Accuracy: 9725/10000 (97.2500%)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 10.0556, Accuracy: 118/8968 (1.3158%)
Done in 136.672217130661 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:38 choose agents : [41, 73, 51, 74, 60, 92, 23, 39, 79, 86]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   1,  Average loss: 0.0152, Accuracy: 450/606 (74.2574%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 570/606 (94.0594%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   3,  Average loss: 0.0020, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   4,  Average loss: 0.0019, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   5,  Average loss: 0.0015, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   6,  Average loss: 0.0015, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   7,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   8,  Average loss: 0.0013, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   9,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch  10,  Average loss: 0.0010, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Global model norm: 16.66526198507692.
Norm before scaling: 17.040768376608913. Distance: 4.178309589608138
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.7713, Accuracy: 7606/10000 (76.0600%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0034, Accuracy: 8958/8968 (99.8885%)
Scaling by  100
Scaled Norm after poisoning: 417.5886507677142, distance: 417.83095041535637
Total norm for 4 adversaries is: 417.5886507677142. distance: 417.83095041535637
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   1,  Average loss: 0.0162, Accuracy: 466/591 (78.8494%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   3,  Average loss: 0.0020, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   4,  Average loss: 0.0016, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   5,  Average loss: 0.0014, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   6,  Average loss: 0.0012, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   7,  Average loss: 0.0012, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   8,  Average loss: 0.0009, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   9,  Average loss: 0.0008, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch  10,  Average loss: 0.0008, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Global model norm: 16.66526198507692.
Norm before scaling: 17.109726380524215. Distance: 4.331923157536137
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.4969, Accuracy: 8396/10000 (83.9600%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0165, Accuracy: 8912/8968 (99.3756%)
Scaling by  100
Scaled Norm after poisoning: 433.0796152268079, distance: 433.1923288217371
Total norm for 4 adversaries is: 433.0796152268079. distance: 433.1923288217371
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 11596121.9750, Accuracy: 2/8968 (0.0223%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   1,  Average loss: 0.0139, Accuracy: 441/568 (77.6408%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   2,  Average loss: 0.0043, Accuracy: 525/568 (92.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   3,  Average loss: 0.0028, Accuracy: 534/568 (94.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   4,  Average loss: 0.0026, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   5,  Average loss: 0.0017, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   6,  Average loss: 0.0020, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   7,  Average loss: 0.0018, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   8,  Average loss: 0.0014, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   9,  Average loss: 0.0013, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch  10,  Average loss: 0.0013, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Global model norm: 16.66526198507692.
Norm before scaling: 17.039407270984643. Distance: 4.113617190474888
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.8327, Accuracy: 7370/10000 (73.7000%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0114, Accuracy: 8928/8968 (99.5540%)
Scaling by  100
Scaled Norm after poisoning: 411.1752021644788, distance: 411.36170595353184
Total norm for 4 adversaries is: 411.1752021644788. distance: 411.36170595353184
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 343559.0949, Accuracy: 3770/8968 (42.0384%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   1,  Average loss: 0.0171, Accuracy: 411/557 (73.7882%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 514/557 (92.2801%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   3,  Average loss: 0.0027, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   4,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   5,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   8,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Global model norm: 16.66526198507692.
Norm before scaling: 17.02032332977256. Distance: 4.0645612915838765
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.5630, Accuracy: 8250/10000 (82.5000%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0108, Accuracy: 8934/8968 (99.6209%)
Scaling by  100
Scaled Norm after poisoning: 406.236749783916, distance: 406.4561207867339
Total norm for 4 adversaries is: 406.236749783916. distance: 406.4561207867339
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  38, local model 60, internal_epoch   1,  Average loss: 0.0021, Accuracy: 326/338 (96.4497%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1528, Accuracy: 9551/10000 (95.5100%)
___Train Local_Simple,  epoch  38, local model 92, internal_epoch   1,  Average loss: 0.0016, Accuracy: 903/937 (96.3714%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3594, Accuracy: 8708/10000 (87.0800%)
___Train Local_Simple,  epoch  38, local model 23, internal_epoch   1,  Average loss: 0.0016, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1531, Accuracy: 9477/10000 (94.7700%)
___Train Local_Simple,  epoch  38, local model 39, internal_epoch   1,  Average loss: 0.0011, Accuracy: 253/257 (98.4436%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1843, Accuracy: 9408/10000 (94.0800%)
___Train Local_Simple,  epoch  38, local model 79, internal_epoch   1,  Average loss: 0.0021, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1085, Accuracy: 9677/10000 (96.7700%)
___Train Local_Simple,  epoch  38, local model 86, internal_epoch   1,  Average loss: 0.0013, Accuracy: 244/250 (97.6000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1222, Accuracy: 9623/10000 (96.2300%)
time spent on training: 114.75149965286255
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.5070976195675911  data num: [606, 591, 568, 557, 338, 937, 293, 257, 182, 250]
[foolsgold agg] considering poison per batch poison_fraction: 0.15846800611487222
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.0913, Accuracy: 9723/10000 (97.2300%)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 9.9888, Accuracy: 122/8968 (1.3604%)
Done in 137.46190094947815 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:39 choose agents : [41, 73, 51, 74, 63, 99, 97, 37, 44, 52]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   1,  Average loss: 0.0138, Accuracy: 467/606 (77.0627%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   3,  Average loss: 0.0016, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   4,  Average loss: 0.0015, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   5,  Average loss: 0.0015, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   6,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   7,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   9,  Average loss: 0.0008, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch  10,  Average loss: 0.0009, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Global model norm: 16.670378513260896.
Norm before scaling: 17.05667450776006. Distance: 4.0995088794852625
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6376, Accuracy: 8137/10000 (81.3700%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0116, Accuracy: 8927/8968 (99.5428%)
Scaling by  100
Scaled Norm after poisoning: 409.8291183530033, distance: 409.95089263837446
Total norm for 4 adversaries is: 409.8291183530033. distance: 409.95089263837446
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 2110302.0912, Accuracy: 1139/8968 (12.7007%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   1,  Average loss: 0.0136, Accuracy: 474/591 (80.2030%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   3,  Average loss: 0.0013, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   4,  Average loss: 0.0014, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   5,  Average loss: 0.0011, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   6,  Average loss: 0.0009, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   7,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   8,  Average loss: 0.0008, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   9,  Average loss: 0.0007, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch  10,  Average loss: 0.0007, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Global model norm: 16.670378513260896.
Norm before scaling: 16.947961483243347. Distance: 3.71909606349177
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.5216, Accuracy: 8320/10000 (83.2000%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0310, Accuracy: 8866/8968 (98.8626%)
Scaling by  100
Scaled Norm after poisoning: 371.6782252500138, distance: 371.90962023722915
Total norm for 4 adversaries is: 371.6782252500138. distance: 371.90962023722915
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   1,  Average loss: 0.0138, Accuracy: 450/568 (79.2254%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   3,  Average loss: 0.0026, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   4,  Average loss: 0.0019, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   5,  Average loss: 0.0020, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   6,  Average loss: 0.0014, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   7,  Average loss: 0.0013, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   8,  Average loss: 0.0011, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   9,  Average loss: 0.0008, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch  10,  Average loss: 0.0011, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Global model norm: 16.670378513260896.
Norm before scaling: 17.025161074690033. Distance: 3.8687821000204914
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.7229, Accuracy: 7668/10000 (76.6800%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0060, Accuracy: 8947/8968 (99.7658%)
Scaling by  100
Scaled Norm after poisoning: 386.8479998655803, distance: 386.8782108105857
Total norm for 4 adversaries is: 386.8479998655803. distance: 386.8782108105857
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 8760999.3800, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   1,  Average loss: 0.0169, Accuracy: 406/557 (72.8905%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 495/557 (88.8689%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   3,  Average loss: 0.0027, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   4,  Average loss: 0.0024, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   5,  Average loss: 0.0018, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   6,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   8,  Average loss: 0.0010, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Global model norm: 16.670378513260896.
Norm before scaling: 17.026910463488104. Distance: 3.9640271778810976
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.5242, Accuracy: 8279/10000 (82.7900%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0075, Accuracy: 8942/8968 (99.7101%)
Scaling by  100
Scaled Norm after poisoning: 396.28665051323645, distance: 396.4027111095483
Total norm for 4 adversaries is: 396.28665051323645. distance: 396.4027111095483
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  39, local model 63, internal_epoch   1,  Average loss: 0.0023, Accuracy: 844/889 (94.9381%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2153, Accuracy: 9354/10000 (93.5400%)
___Train Local_Simple,  epoch  39, local model 99, internal_epoch   1,  Average loss: 0.0009, Accuracy: 372/377 (98.6737%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1088, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch  39, local model 97, internal_epoch   1,  Average loss: 0.0009, Accuracy: 478/487 (98.1520%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4273, Accuracy: 8875/10000 (88.7500%)
___Train Local_Simple,  epoch  39, local model 37, internal_epoch   1,  Average loss: 0.0015, Accuracy: 839/860 (97.5581%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4855, Accuracy: 8629/10000 (86.2900%)
___Train Local_Simple,  epoch  39, local model 44, internal_epoch   1,  Average loss: 0.0035, Accuracy: 498/517 (96.3250%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1377, Accuracy: 9586/10000 (95.8600%)
___Train Local_Simple,  epoch  39, local model 52, internal_epoch   1,  Average loss: 0.0012, Accuracy: 248/253 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1419, Accuracy: 9559/10000 (95.5900%)
time spent on training: 117.6228244304657
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.407011393514461  data num: [606, 591, 568, 557, 889, 377, 487, 860, 517, 253]
[foolsgold agg] considering poison per batch poison_fraction: 0.12719106047326906
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.0918, Accuracy: 9720/10000 (97.2000%)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 9.9419, Accuracy: 126/8968 (1.4050%)
Done in 140.4766366481781 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:40 choose agents : [41, 73, 51, 74, 88, 25, 28, 8, 16, 6]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   1,  Average loss: 0.0192, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 562/606 (92.7393%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   3,  Average loss: 0.0025, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   4,  Average loss: 0.0023, Accuracy: 575/606 (94.8845%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   5,  Average loss: 0.0019, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   6,  Average loss: 0.0019, Accuracy: 584/606 (96.3696%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   7,  Average loss: 0.0013, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   8,  Average loss: 0.0013, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   9,  Average loss: 0.0013, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch  10,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Global model norm: 16.675823798698353.
Norm before scaling: 17.246986900003904. Distance: 5.302229344044418
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.8795, Accuracy: 7295/10000 (72.9500%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0001, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 529.6608584745526, distance: 530.2229778593153
Total norm for 4 adversaries is: 529.6608584745526. distance: 530.2229778593153
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   1,  Average loss: 0.0138, Accuracy: 468/591 (79.1878%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 550/591 (93.0626%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   3,  Average loss: 0.0013, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   4,  Average loss: 0.0012, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   5,  Average loss: 0.0012, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   6,  Average loss: 0.0009, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   7,  Average loss: 0.0008, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   8,  Average loss: 0.0007, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   9,  Average loss: 0.0006, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch  10,  Average loss: 0.0006, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Global model norm: 16.675823798698353.
Norm before scaling: 17.017681127206068. Distance: 3.886836524597518
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.5315, Accuracy: 8347/10000 (83.4700%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0416, Accuracy: 8864/8968 (98.8403%)
Scaling by  100
Scaled Norm after poisoning: 388.57966525540166, distance: 388.68365591442097
Total norm for 4 adversaries is: 388.57966525540166. distance: 388.68365591442097
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 1433565.5765, Accuracy: 1983/8968 (22.1120%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0158, Accuracy: 424/568 (74.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   2,  Average loss: 0.0043, Accuracy: 528/568 (92.9577%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   3,  Average loss: 0.0026, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   4,  Average loss: 0.0024, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   5,  Average loss: 0.0021, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   6,  Average loss: 0.0017, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   7,  Average loss: 0.0017, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   8,  Average loss: 0.0015, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   9,  Average loss: 0.0014, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch  10,  Average loss: 0.0015, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Global model norm: 16.675823798698353.
Norm before scaling: 17.113426139965277. Distance: 4.377465997255594
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.9453, Accuracy: 6958/10000 (69.5800%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0144, Accuracy: 8913/8968 (99.3867%)
Scaling by  100
Scaled Norm after poisoning: 437.5643345555028, distance: 437.7465733732247
Total norm for 4 adversaries is: 437.5643345555028. distance: 437.7465733732247
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 3801406.6479, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   1,  Average loss: 0.0156, Accuracy: 400/557 (71.8133%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 507/557 (91.0233%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   3,  Average loss: 0.0032, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   4,  Average loss: 0.0020, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   5,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   6,  Average loss: 0.0013, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   7,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   8,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Global model norm: 16.675823798698353.
Norm before scaling: 17.086612640982086. Distance: 4.135600254906631
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.5453, Accuracy: 8280/10000 (82.8000%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0060, Accuracy: 8945/8968 (99.7435%)
Scaling by  100
Scaled Norm after poisoning: 413.50523349166934, distance: 413.56003947431867
Total norm for 4 adversaries is: 413.50523349166934. distance: 413.56003947431867
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 8310122.0955, Accuracy: 1022/8968 (11.3961%)
___Train Local_Simple,  epoch  40, local model 88, internal_epoch   1,  Average loss: 0.0008, Accuracy: 523/530 (98.6792%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2215, Accuracy: 9345/10000 (93.4500%)
___Train Local_Simple,  epoch  40, local model 25, internal_epoch   1,  Average loss: 0.0025, Accuracy: 626/647 (96.7543%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2640, Accuracy: 9113/10000 (91.1300%)
___Train Local_Simple,  epoch  40, local model 28, internal_epoch   1,  Average loss: 0.0015, Accuracy: 489/501 (97.6048%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1490, Accuracy: 9528/10000 (95.2800%)
___Train Local_Simple,  epoch  40, local model 8, internal_epoch   1,  Average loss: 0.0019, Accuracy: 610/633 (96.3665%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1382, Accuracy: 9590/10000 (95.9000%)
___Train Local_Simple,  epoch  40, local model 16, internal_epoch   1,  Average loss: 0.0013, Accuracy: 892/915 (97.4863%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1577, Accuracy: 9511/10000 (95.1100%)
___Train Local_Simple,  epoch  40, local model 6, internal_epoch   1,  Average loss: 0.0019, Accuracy: 591/615 (96.0976%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2657, Accuracy: 9219/10000 (92.1900%)
time spent on training: 114.29901671409607
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3767645627129645  data num: [606, 591, 568, 557, 530, 647, 501, 633, 915, 615]
[foolsgold agg] considering poison per batch poison_fraction: 0.1177389258478014
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.0925, Accuracy: 9719/10000 (97.1900%)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 9.8485, Accuracy: 130/8968 (1.4496%)
Done in 137.5543396472931 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:41 choose agents : [41, 73, 51, 74, 3, 23, 44, 27, 86, 37]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   1,  Average loss: 0.0152, Accuracy: 457/606 (75.4125%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 569/606 (93.8944%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   3,  Average loss: 0.0020, Accuracy: 581/606 (95.8746%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   4,  Average loss: 0.0018, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   5,  Average loss: 0.0013, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   6,  Average loss: 0.0014, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   7,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   9,  Average loss: 0.0010, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch  10,  Average loss: 0.0011, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Global model norm: 16.681177663235346.
Norm before scaling: 17.13810373435098. Distance: 4.377346390534965
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6276, Accuracy: 8082/10000 (80.8200%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0032, Accuracy: 8958/8968 (99.8885%)
Scaling by  100
Scaled Norm after poisoning: 437.62890957979454, distance: 437.7346513585599
Total norm for 4 adversaries is: 437.62890957979454. distance: 437.7346513585599
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   1,  Average loss: 0.0131, Accuracy: 468/591 (79.1878%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 550/591 (93.0626%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   3,  Average loss: 0.0017, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   4,  Average loss: 0.0015, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   5,  Average loss: 0.0013, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   6,  Average loss: 0.0012, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   7,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   8,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   9,  Average loss: 0.0008, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch  10,  Average loss: 0.0008, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Global model norm: 16.681177663235346.
Norm before scaling: 17.045196590436866. Distance: 3.9761509410675475
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.5228, Accuracy: 8298/10000 (82.9800%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0123, Accuracy: 8925/8968 (99.5205%)
Scaling by  100
Scaled Norm after poisoning: 397.5207541751751, distance: 397.6150776819209
Total norm for 4 adversaries is: 397.5207541751751. distance: 397.6150776819209
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 12824630.0642, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0103, Accuracy: 473/568 (83.2746%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   3,  Average loss: 0.0023, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   4,  Average loss: 0.0018, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   5,  Average loss: 0.0016, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   6,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   7,  Average loss: 0.0013, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   8,  Average loss: 0.0011, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   9,  Average loss: 0.0009, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch  10,  Average loss: 0.0009, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Global model norm: 16.681177663235346.
Norm before scaling: 16.915689875522183. Distance: 3.4350120557548487
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.7881, Accuracy: 7448/10000 (74.4800%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0042, Accuracy: 8953/8968 (99.8327%)
Scaling by  100
Scaled Norm after poisoning: 343.33552284900554, distance: 343.50120542001014
Total norm for 4 adversaries is: 343.33552284900554. distance: 343.50120542001014
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   1,  Average loss: 0.0150, Accuracy: 416/557 (74.6858%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 510/557 (91.5619%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   3,  Average loss: 0.0021, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   4,  Average loss: 0.0018, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   5,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   6,  Average loss: 0.0016, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   7,  Average loss: 0.0010, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   8,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Global model norm: 16.681177663235346.
Norm before scaling: 16.98972413897175. Distance: 3.757653627586251
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4855, Accuracy: 8401/10000 (84.0100%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0105, Accuracy: 8927/8968 (99.5428%)
Scaling by  100
Scaled Norm after poisoning: 375.6391844243622, distance: 375.76536478898635
Total norm for 4 adversaries is: 375.6391844243622. distance: 375.76536478898635
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 757997.8260, Accuracy: 5228/8968 (58.2962%)
___Train Local_Simple,  epoch  41, local model 3, internal_epoch   1,  Average loss: 0.0022, Accuracy: 882/923 (95.5580%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.5717, Accuracy: 8394/10000 (83.9400%)
___Train Local_Simple,  epoch  41, local model 23, internal_epoch   1,  Average loss: 0.0014, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1373, Accuracy: 9542/10000 (95.4200%)
___Train Local_Simple,  epoch  41, local model 44, internal_epoch   1,  Average loss: 0.0021, Accuracy: 501/517 (96.9052%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1376, Accuracy: 9566/10000 (95.6600%)
___Train Local_Simple,  epoch  41, local model 27, internal_epoch   1,  Average loss: 0.0023, Accuracy: 446/471 (94.6921%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4119, Accuracy: 8606/10000 (86.0600%)
___Train Local_Simple,  epoch  41, local model 86, internal_epoch   1,  Average loss: 0.0011, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1163, Accuracy: 9648/10000 (96.4800%)
___Train Local_Simple,  epoch  41, local model 37, internal_epoch   1,  Average loss: 0.0015, Accuracy: 836/860 (97.2093%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.3543, Accuracy: 8922/10000 (89.2200%)
time spent on training: 114.98653984069824
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4119943222143364  data num: [606, 591, 568, 557, 923, 293, 517, 471, 250, 860]
[foolsgold agg] considering poison per batch poison_fraction: 0.12874822569198013
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.0926, Accuracy: 9719/10000 (97.1900%)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 9.7654, Accuracy: 136/8968 (1.5165%)
Done in 137.9529469013214 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:42 choose agents : [41, 73, 51, 74, 23, 35, 29, 48, 11, 43]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   1,  Average loss: 0.0149, Accuracy: 449/606 (74.0924%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 566/606 (93.3993%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   3,  Average loss: 0.0024, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   4,  Average loss: 0.0019, Accuracy: 580/606 (95.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   5,  Average loss: 0.0018, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   6,  Average loss: 0.0016, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   7,  Average loss: 0.0012, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   8,  Average loss: 0.0013, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   9,  Average loss: 0.0010, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch  10,  Average loss: 0.0012, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Global model norm: 16.685530299835207.
Norm before scaling: 17.055937346838984. Distance: 4.2563276869172055
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.8301, Accuracy: 7643/10000 (76.4300%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0047, Accuracy: 8952/8968 (99.8216%)
Scaling by  100
Scaled Norm after poisoning: 425.2996737595739, distance: 425.6327275363115
Total norm for 4 adversaries is: 425.2996737595739. distance: 425.6327275363115
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   1,  Average loss: 0.0174, Accuracy: 461/591 (78.0034%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 544/591 (92.0474%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   3,  Average loss: 0.0018, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   4,  Average loss: 0.0017, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   5,  Average loss: 0.0015, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   6,  Average loss: 0.0013, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   7,  Average loss: 0.0012, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   8,  Average loss: 0.0009, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   9,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch  10,  Average loss: 0.0008, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Global model norm: 16.685530299835207.
Norm before scaling: 17.24354675770493. Distance: 4.887958226101896
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6659, Accuracy: 7796/10000 (77.9600%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0122, Accuracy: 8924/8968 (99.5094%)
Scaling by  100
Scaled Norm after poisoning: 488.57325768506814, distance: 488.79579389045483
Total norm for 4 adversaries is: 488.57325768506814. distance: 488.79579389045483
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 32345354.0250, Accuracy: 6/8968 (0.0669%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   1,  Average loss: 0.0121, Accuracy: 457/568 (80.4577%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 530/568 (93.3099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   3,  Average loss: 0.0027, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   4,  Average loss: 0.0021, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   5,  Average loss: 0.0020, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   6,  Average loss: 0.0017, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   7,  Average loss: 0.0013, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   8,  Average loss: 0.0012, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   9,  Average loss: 0.0011, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch  10,  Average loss: 0.0011, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Global model norm: 16.685530299835207.
Norm before scaling: 16.953304110516978. Distance: 3.6253002963153764
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6783, Accuracy: 7746/10000 (77.4600%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0053, Accuracy: 8950/8968 (99.7993%)
Scaling by  100
Scaled Norm after poisoning: 362.3436731888664, distance: 362.53006340853995
Total norm for 4 adversaries is: 362.3436731888664. distance: 362.53006340853995
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   1,  Average loss: 0.0178, Accuracy: 417/557 (74.8654%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 503/557 (90.3052%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   3,  Average loss: 0.0031, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   4,  Average loss: 0.0023, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   5,  Average loss: 0.0018, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   6,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   7,  Average loss: 0.0012, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch  10,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Global model norm: 16.685530299835207.
Norm before scaling: 17.060778408739427. Distance: 4.159047726796894
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.5041, Accuracy: 8343/10000 (83.4300%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0066, Accuracy: 8944/8968 (99.7324%)
Scaling by  100
Scaled Norm after poisoning: 415.6822516959318, distance: 415.90477425728113
Total norm for 4 adversaries is: 415.6822516959318. distance: 415.90477425728113
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  42, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1841, Accuracy: 9415/10000 (94.1500%)
___Train Local_Simple,  epoch  42, local model 35, internal_epoch   1,  Average loss: 0.0011, Accuracy: 490/499 (98.1964%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1564, Accuracy: 9533/10000 (95.3300%)
___Train Local_Simple,  epoch  42, local model 29, internal_epoch   1,  Average loss: 0.0012, Accuracy: 975/1002 (97.3054%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.5752, Accuracy: 8569/10000 (85.6900%)
___Train Local_Simple,  epoch  42, local model 48, internal_epoch   1,  Average loss: 0.0008, Accuracy: 440/448 (98.2143%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1471, Accuracy: 9583/10000 (95.8300%)
___Train Local_Simple,  epoch  42, local model 11, internal_epoch   1,  Average loss: 0.0017, Accuracy: 629/645 (97.5194%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2563, Accuracy: 9150/10000 (91.5000%)
___Train Local_Simple,  epoch  42, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 398/408 (97.5490%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1846, Accuracy: 9456/10000 (94.5600%)
time spent on training: 114.28036737442017
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41338792949973296  data num: [606, 591, 568, 557, 293, 499, 1002, 448, 645, 408]
[foolsgold agg] considering poison per batch poison_fraction: 0.12918372796866656
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.0931, Accuracy: 9717/10000 (97.1700%)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 9.7174, Accuracy: 144/8968 (1.6057%)
Done in 137.1812858581543 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:43 choose agents : [41, 73, 51, 74, 33, 12, 97, 15, 42, 20]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   1,  Average loss: 0.0164, Accuracy: 451/606 (74.4224%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   2,  Average loss: 0.0047, Accuracy: 558/606 (92.0792%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   3,  Average loss: 0.0024, Accuracy: 576/606 (95.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   4,  Average loss: 0.0020, Accuracy: 582/606 (96.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   5,  Average loss: 0.0013, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   6,  Average loss: 0.0011, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   7,  Average loss: 0.0012, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   9,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch  10,  Average loss: 0.0008, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Global model norm: 16.690731121526515.
Norm before scaling: 17.208765253861184. Distance: 4.607837485229183
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.7816, Accuracy: 7671/10000 (76.7100%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0110, Accuracy: 8928/8968 (99.5540%)
Scaling by  100
Scaled Norm after poisoning: 460.68766534388567, distance: 460.7837243490703
Total norm for 4 adversaries is: 460.68766534388567. distance: 460.7837243490703
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   1,  Average loss: 0.0143, Accuracy: 466/591 (78.8494%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   3,  Average loss: 0.0018, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   4,  Average loss: 0.0017, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   5,  Average loss: 0.0017, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   6,  Average loss: 0.0014, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   7,  Average loss: 0.0012, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   8,  Average loss: 0.0009, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   9,  Average loss: 0.0008, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch  10,  Average loss: 0.0009, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Global model norm: 16.690731121526515.
Norm before scaling: 17.057974302498156. Distance: 4.13013831805245
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.6435, Accuracy: 7952/10000 (79.5200%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0079, Accuracy: 8939/8968 (99.6766%)
Scaling by  100
Scaled Norm after poisoning: 412.7863967901559, distance: 413.0138277043518
Total norm for 4 adversaries is: 412.7863967901559. distance: 413.0138277043518
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 2242750.4017, Accuracy: 2678/8968 (29.8617%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   1,  Average loss: 0.0120, Accuracy: 462/568 (81.3380%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   2,  Average loss: 0.0040, Accuracy: 524/568 (92.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   3,  Average loss: 0.0019, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   4,  Average loss: 0.0020, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   5,  Average loss: 0.0016, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   6,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   7,  Average loss: 0.0012, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   8,  Average loss: 0.0008, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   9,  Average loss: 0.0010, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch  10,  Average loss: 0.0009, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Global model norm: 16.690731121526515.
Norm before scaling: 16.95529849978457. Distance: 3.4774687196708274
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.6840, Accuracy: 7811/10000 (78.1100%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0123, Accuracy: 8917/8968 (99.4313%)
Scaling by  100
Scaled Norm after poisoning: 347.6885729356086, distance: 347.7468547665097
Total norm for 4 adversaries is: 347.6885729356086. distance: 347.7468547665097
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   1,  Average loss: 0.0185, Accuracy: 405/557 (72.7110%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 513/557 (92.1005%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   3,  Average loss: 0.0026, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   4,  Average loss: 0.0018, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   5,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   6,  Average loss: 0.0013, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   9,  Average loss: 0.0008, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch  10,  Average loss: 0.0012, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Global model norm: 16.690731121526515.
Norm before scaling: 17.163514869506805. Distance: 4.358801581840861
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.5746, Accuracy: 8205/10000 (82.0500%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0088, Accuracy: 8934/8968 (99.6209%)
Scaling by  100
Scaled Norm after poisoning: 435.8563410115769, distance: 435.8801440763275
Total norm for 4 adversaries is: 435.8563410115769. distance: 435.8801440763275
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 305833.4073, Accuracy: 6110/8968 (68.1311%)
___Train Local_Simple,  epoch  43, local model 33, internal_epoch   1,  Average loss: 0.0017, Accuracy: 601/623 (96.4687%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1646, Accuracy: 9481/10000 (94.8100%)
___Train Local_Simple,  epoch  43, local model 12, internal_epoch   1,  Average loss: 0.0020, Accuracy: 1118/1160 (96.3793%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.4082, Accuracy: 8650/10000 (86.5000%)
___Train Local_Simple,  epoch  43, local model 97, internal_epoch   1,  Average loss: 0.0011, Accuracy: 474/487 (97.3306%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.4582, Accuracy: 8861/10000 (88.6100%)
___Train Local_Simple,  epoch  43, local model 15, internal_epoch   1,  Average loss: 0.0013, Accuracy: 392/401 (97.7556%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1297, Accuracy: 9584/10000 (95.8400%)
___Train Local_Simple,  epoch  43, local model 42, internal_epoch   1,  Average loss: 0.0013, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1217, Accuracy: 9627/10000 (96.2700%)
___Train Local_Simple,  epoch  43, local model 20, internal_epoch   1,  Average loss: 0.0014, Accuracy: 421/429 (98.1352%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2545, Accuracy: 9214/10000 (92.1400%)
time spent on training: 116.15033984184265
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41039236479321317  data num: [606, 591, 568, 557, 623, 1160, 487, 401, 236, 429]
[foolsgold agg] considering poison per batch poison_fraction: 0.12824761399787912
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.0935, Accuracy: 9716/10000 (97.1600%)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 9.6547, Accuracy: 158/8968 (1.7618%)
Done in 138.803936958313 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:44 choose agents : [41, 73, 51, 74, 90, 56, 54, 24, 38, 43]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   1,  Average loss: 0.0145, Accuracy: 481/606 (79.3729%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 576/606 (95.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   3,  Average loss: 0.0023, Accuracy: 572/606 (94.3894%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   4,  Average loss: 0.0018, Accuracy: 584/606 (96.3696%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   5,  Average loss: 0.0016, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   6,  Average loss: 0.0015, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   7,  Average loss: 0.0012, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   8,  Average loss: 0.0013, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   9,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch  10,  Average loss: 0.0009, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Global model norm: 16.696642253723596.
Norm before scaling: 17.079203384011265. Distance: 3.956415789416309
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.6527, Accuracy: 7780/10000 (77.8000%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0032, Accuracy: 8955/8968 (99.8550%)
Scaling by  100
Scaled Norm after poisoning: 395.64865648072157, distance: 395.64158732999744
Total norm for 4 adversaries is: 395.64865648072157. distance: 395.64158732999744
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   1,  Average loss: 0.0121, Accuracy: 492/591 (83.2487%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   2,  Average loss: 0.0030, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   3,  Average loss: 0.0019, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   4,  Average loss: 0.0013, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   5,  Average loss: 0.0012, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   6,  Average loss: 0.0011, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   7,  Average loss: 0.0008, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   8,  Average loss: 0.0007, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   9,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch  10,  Average loss: 0.0007, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Global model norm: 16.696642253723596.
Norm before scaling: 16.97213525883354. Distance: 3.59039574697178
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.5808, Accuracy: 8154/10000 (81.5400%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0097, Accuracy: 8929/8968 (99.5651%)
Scaling by  100
Scaled Norm after poisoning: 358.9243152288516, distance: 359.039604361413
Total norm for 4 adversaries is: 358.9243152288516. distance: 359.039604361413
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 9179.0660, Accuracy: 8005/8968 (89.2618%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   1,  Average loss: 0.0139, Accuracy: 444/568 (78.1690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   2,  Average loss: 0.0042, Accuracy: 529/568 (93.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   3,  Average loss: 0.0035, Accuracy: 529/568 (93.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   4,  Average loss: 0.0027, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   5,  Average loss: 0.0026, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   6,  Average loss: 0.0024, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   7,  Average loss: 0.0024, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   8,  Average loss: 0.0019, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   9,  Average loss: 0.0018, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch  10,  Average loss: 0.0019, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Global model norm: 16.696642253723596.
Norm before scaling: 17.210271669201923. Distance: 4.777328179272459
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.1040, Accuracy: 6462/10000 (64.6200%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0017, Accuracy: 8963/8968 (99.9442%)
Scaling by  100
Scaled Norm after poisoning: 477.45858786391096, distance: 477.73282936176787
Total norm for 4 adversaries is: 477.45858786391096. distance: 477.73282936176787
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 16910453.3559, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   1,  Average loss: 0.0171, Accuracy: 425/557 (76.3016%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 499/557 (89.5871%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   3,  Average loss: 0.0027, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   4,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   5,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   6,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   7,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   8,  Average loss: 0.0010, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   9,  Average loss: 0.0010, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch  10,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Global model norm: 16.696642253723596.
Norm before scaling: 17.161910993966952. Distance: 4.353912102712287
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.5784, Accuracy: 8178/10000 (81.7800%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0062, Accuracy: 8944/8968 (99.7324%)
Scaling by  100
Scaled Norm after poisoning: 435.3435066128815, distance: 435.39120340218176
Total norm for 4 adversaries is: 435.3435066128815. distance: 435.39120340218176
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 990089.7556, Accuracy: 4263/8968 (47.5357%)
___Train Local_Simple,  epoch  44, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 649/683 (95.0220%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.6539, Accuracy: 7792/10000 (77.9200%)
___Train Local_Simple,  epoch  44, local model 56, internal_epoch   1,  Average loss: 0.0015, Accuracy: 856/880 (97.2727%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1743, Accuracy: 9436/10000 (94.3600%)
___Train Local_Simple,  epoch  44, local model 54, internal_epoch   1,  Average loss: 0.0025, Accuracy: 498/519 (95.9538%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.4839, Accuracy: 8596/10000 (85.9600%)
___Train Local_Simple,  epoch  44, local model 24, internal_epoch   1,  Average loss: 0.0019, Accuracy: 365/379 (96.3061%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1320, Accuracy: 9575/10000 (95.7500%)
___Train Local_Simple,  epoch  44, local model 38, internal_epoch   1,  Average loss: 0.0017, Accuracy: 863/895 (96.4246%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1948, Accuracy: 9336/10000 (93.3600%)
___Train Local_Simple,  epoch  44, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 398/408 (97.5490%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2075, Accuracy: 9387/10000 (93.8700%)
time spent on training: 108.58426070213318
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.38153138350312193  data num: [606, 591, 568, 557, 683, 880, 519, 379, 895, 408]
[foolsgold agg] considering poison per batch poison_fraction: 0.11922855734472561
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.0937, Accuracy: 9717/10000 (97.1700%)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 9.6177, Accuracy: 162/8968 (1.8064%)
Done in 130.21283149719238 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:45 choose agents : [41, 73, 51, 74, 32, 62, 8, 35, 96, 27]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   1,  Average loss: 0.0145, Accuracy: 471/606 (77.7228%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   2,  Average loss: 0.0033, Accuracy: 580/606 (95.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   3,  Average loss: 0.0023, Accuracy: 576/606 (95.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   4,  Average loss: 0.0019, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   5,  Average loss: 0.0017, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   6,  Average loss: 0.0014, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   7,  Average loss: 0.0011, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   8,  Average loss: 0.0011, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   9,  Average loss: 0.0010, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch  10,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Global model norm: 16.702053396109246.
Norm before scaling: 17.125962279077196. Distance: 4.275600520558647
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.7629, Accuracy: 7637/10000 (76.3700%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0018, Accuracy: 8964/8968 (99.9554%)
Scaling by  100
Scaled Norm after poisoning: 427.42539553704574, distance: 427.5600286801843
Total norm for 4 adversaries is: 427.42539553704574. distance: 427.5600286801843
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 5547620.4103, Accuracy: 33/8968 (0.3680%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   1,  Average loss: 0.0130, Accuracy: 486/591 (82.2335%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   3,  Average loss: 0.0018, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   4,  Average loss: 0.0014, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   5,  Average loss: 0.0012, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   6,  Average loss: 0.0011, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   7,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   8,  Average loss: 0.0010, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   9,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch  10,  Average loss: 0.0008, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Global model norm: 16.702053396109246.
Norm before scaling: 17.042844748718046. Distance: 4.016874007786851
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.6085, Accuracy: 8193/10000 (81.9300%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0143, Accuracy: 8917/8968 (99.4313%)
Scaling by  100
Scaled Norm after poisoning: 401.4575592450589, distance: 401.6873978916939
Total norm for 4 adversaries is: 401.4575592450589. distance: 401.6873978916939
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 2974.7681, Accuracy: 8793/8968 (98.0486%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0149, Accuracy: 432/568 (76.0563%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   3,  Average loss: 0.0026, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   4,  Average loss: 0.0021, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   5,  Average loss: 0.0020, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   6,  Average loss: 0.0016, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   7,  Average loss: 0.0017, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   8,  Average loss: 0.0014, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   9,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch  10,  Average loss: 0.0010, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Global model norm: 16.702053396109246.
Norm before scaling: 17.072015254034433. Distance: 4.003784058729995
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.8148, Accuracy: 7217/10000 (72.1700%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0127, Accuracy: 8921/8968 (99.4759%)
Scaling by  100
Scaled Norm after poisoning: 400.2853084051424, distance: 400.378453778422
Total norm for 4 adversaries is: 400.2853084051424. distance: 400.378453778422
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 3200224.8733, Accuracy: 7/8968 (0.0781%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   1,  Average loss: 0.0139, Accuracy: 457/557 (82.0467%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   2,  Average loss: 0.0038, Accuracy: 519/557 (93.1777%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   3,  Average loss: 0.0022, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   4,  Average loss: 0.0016, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   5,  Average loss: 0.0013, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   6,  Average loss: 0.0012, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   7,  Average loss: 0.0010, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   8,  Average loss: 0.0008, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch  10,  Average loss: 0.0007, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Global model norm: 16.702053396109246.
Norm before scaling: 16.95070817306343. Distance: 3.4055264605685878
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5067, Accuracy: 8406/10000 (84.0600%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0038, Accuracy: 8954/8968 (99.8439%)
Scaling by  100
Scaled Norm after poisoning: 340.48802291710643, distance: 340.552652867365
Total norm for 4 adversaries is: 340.48802291710643. distance: 340.552652867365
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 462536.7422, Accuracy: 4177/8968 (46.5767%)
___Train Local_Simple,  epoch  45, local model 32, internal_epoch   1,  Average loss: 0.0023, Accuracy: 941/977 (96.3153%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3135, Accuracy: 8926/10000 (89.2600%)
___Train Local_Simple,  epoch  45, local model 62, internal_epoch   1,  Average loss: 0.0013, Accuracy: 413/423 (97.6359%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1310, Accuracy: 9598/10000 (95.9800%)
___Train Local_Simple,  epoch  45, local model 8, internal_epoch   1,  Average loss: 0.0022, Accuracy: 601/633 (94.9447%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1406, Accuracy: 9599/10000 (95.9900%)
___Train Local_Simple,  epoch  45, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 494/499 (98.9980%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2464, Accuracy: 9288/10000 (92.8800%)
___Train Local_Simple,  epoch  45, local model 96, internal_epoch   1,  Average loss: 0.0016, Accuracy: 655/672 (97.4702%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1985, Accuracy: 9352/10000 (93.5200%)
___Train Local_Simple,  epoch  45, local model 27, internal_epoch   1,  Average loss: 0.0020, Accuracy: 453/471 (96.1783%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4309, Accuracy: 8798/10000 (87.9800%)
time spent on training: 112.7190260887146
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3871935967983992  data num: [606, 591, 568, 557, 977, 423, 633, 499, 672, 471]
[foolsgold agg] considering poison per batch poison_fraction: 0.12099799899949976
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.0939, Accuracy: 9720/10000 (97.2000%)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 9.5381, Accuracy: 181/8968 (2.0183%)
Done in 135.75433230400085 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:46 choose agents : [41, 73, 51, 74, 58, 86, 89, 17, 80, 63]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   1,  Average loss: 0.0134, Accuracy: 490/606 (80.8581%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 573/606 (94.5545%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   3,  Average loss: 0.0023, Accuracy: 576/606 (95.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   4,  Average loss: 0.0022, Accuracy: 578/606 (95.3795%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   5,  Average loss: 0.0017, Accuracy: 581/606 (95.8746%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   6,  Average loss: 0.0015, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   7,  Average loss: 0.0015, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   8,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   9,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch  10,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Global model norm: 16.707165963479564.
Norm before scaling: 17.11959508541811. Distance: 4.2349303609803925
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.7889, Accuracy: 7642/10000 (76.4200%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0018, Accuracy: 8963/8968 (99.9442%)
Scaling by  100
Scaled Norm after poisoning: 423.3522654067178, distance: 423.4930636976242
Total norm for 4 adversaries is: 423.3522654067178. distance: 423.4930636976242
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 3265551.9909, Accuracy: 1183/8968 (13.1913%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   1,  Average loss: 0.0161, Accuracy: 464/591 (78.5110%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   2,  Average loss: 0.0045, Accuracy: 538/591 (91.0321%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   3,  Average loss: 0.0029, Accuracy: 553/591 (93.5702%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   4,  Average loss: 0.0026, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   5,  Average loss: 0.0020, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   6,  Average loss: 0.0017, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   7,  Average loss: 0.0012, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   8,  Average loss: 0.0015, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   9,  Average loss: 0.0011, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch  10,  Average loss: 0.0015, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Global model norm: 16.707165963479564.
Norm before scaling: 17.270946224688842. Distance: 4.813642886309085
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.7090, Accuracy: 7686/10000 (76.8600%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0002, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 481.2371589195913, distance: 481.36430460722784
Total norm for 4 adversaries is: 481.2371589195913. distance: 481.36430460722784
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   1,  Average loss: 0.0105, Accuracy: 459/568 (80.8099%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   3,  Average loss: 0.0021, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   4,  Average loss: 0.0017, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   5,  Average loss: 0.0015, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   6,  Average loss: 0.0012, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   7,  Average loss: 0.0009, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   8,  Average loss: 0.0009, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   9,  Average loss: 0.0007, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch  10,  Average loss: 0.0009, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Global model norm: 16.707165963479564.
Norm before scaling: 17.06634589926958. Distance: 3.7355716336315483
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.7371, Accuracy: 7679/10000 (76.7900%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0023, Accuracy: 8959/8968 (99.8996%)
Scaling by  100
Scaled Norm after poisoning: 373.68665851218185, distance: 373.55714087673385
Total norm for 4 adversaries is: 373.68665851218185. distance: 373.55714087673385
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 13620184.6833, Accuracy: 4/8968 (0.0446%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   1,  Average loss: 0.0174, Accuracy: 421/557 (75.5835%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 511/557 (91.7415%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   3,  Average loss: 0.0024, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   4,  Average loss: 0.0020, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   5,  Average loss: 0.0018, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   6,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   8,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Global model norm: 16.707165963479564.
Norm before scaling: 17.120611143523305. Distance: 4.105338663495642
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.4449, Accuracy: 8572/10000 (85.7200%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0070, Accuracy: 8939/8968 (99.6766%)
Scaling by  100
Scaled Norm after poisoning: 410.524569149034, distance: 410.5338749725776
Total norm for 4 adversaries is: 410.524569149034. distance: 410.5338749725776
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 6750167.2899, Accuracy: 593/8968 (6.6124%)
___Train Local_Simple,  epoch  46, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 265/276 (96.0145%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1682, Accuracy: 9482/10000 (94.8200%)
___Train Local_Simple,  epoch  46, local model 86, internal_epoch   1,  Average loss: 0.0011, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1208, Accuracy: 9637/10000 (96.3700%)
___Train Local_Simple,  epoch  46, local model 89, internal_epoch   1,  Average loss: 0.0008, Accuracy: 485/492 (98.5772%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1626, Accuracy: 9521/10000 (95.2100%)
___Train Local_Simple,  epoch  46, local model 17, internal_epoch   1,  Average loss: 0.0017, Accuracy: 604/620 (97.4194%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1676, Accuracy: 9485/10000 (94.8500%)
___Train Local_Simple,  epoch  46, local model 80, internal_epoch   1,  Average loss: 0.0008, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2015, Accuracy: 9426/10000 (94.2600%)
___Train Local_Simple,  epoch  46, local model 63, internal_epoch   1,  Average loss: 0.0025, Accuracy: 844/889 (94.9381%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2238, Accuracy: 9281/10000 (92.8100%)
time spent on training: 111.49896144866943
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.43977272727272726  data num: [606, 591, 568, 557, 276, 250, 492, 620, 431, 889]
[foolsgold agg] considering poison per batch poison_fraction: 0.13742897727272727
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.0941, Accuracy: 9719/10000 (97.1900%)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 9.5113, Accuracy: 185/8968 (2.0629%)
Done in 133.34877109527588 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:47 choose agents : [41, 73, 51, 74, 58, 26, 90, 89, 93, 79]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   1,  Average loss: 0.0133, Accuracy: 482/606 (79.5380%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   2,  Average loss: 0.0026, Accuracy: 582/606 (96.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   3,  Average loss: 0.0013, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   4,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   5,  Average loss: 0.0009, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   6,  Average loss: 0.0008, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   7,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   8,  Average loss: 0.0006, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch  10,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Global model norm: 16.713075847876567.
Norm before scaling: 17.167144373694352. Distance: 4.1891612842698
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.7114, Accuracy: 8052/10000 (80.5200%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0004, Accuracy: 8967/8968 (99.9888%)
Scaling by  100
Scaled Norm after poisoning: 418.9910873157089, distance: 418.91610511533213
Total norm for 4 adversaries is: 418.9910873157089. distance: 418.91610511533213
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   1,  Average loss: 0.0129, Accuracy: 491/591 (83.0795%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   2,  Average loss: 0.0030, Accuracy: 561/591 (94.9239%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   3,  Average loss: 0.0016, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   4,  Average loss: 0.0014, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   5,  Average loss: 0.0012, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   6,  Average loss: 0.0010, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   7,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   8,  Average loss: 0.0008, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   9,  Average loss: 0.0008, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch  10,  Average loss: 0.0008, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Global model norm: 16.713075847876567.
Norm before scaling: 17.04682934944621. Distance: 3.8321962466867636
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.6003, Accuracy: 8093/10000 (80.9300%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0048, Accuracy: 8947/8968 (99.7658%)
Scaling by  100
Scaled Norm after poisoning: 383.1380707395181, distance: 383.2196253455713
Total norm for 4 adversaries is: 383.1380707395181. distance: 383.2196253455713
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   1,  Average loss: 0.0119, Accuracy: 474/568 (83.4507%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   3,  Average loss: 0.0025, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   4,  Average loss: 0.0026, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   5,  Average loss: 0.0015, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   6,  Average loss: 0.0016, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   7,  Average loss: 0.0016, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   8,  Average loss: 0.0014, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   9,  Average loss: 0.0013, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch  10,  Average loss: 0.0013, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Global model norm: 16.713075847876567.
Norm before scaling: 17.023803202818144. Distance: 3.690459663893206
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.9330, Accuracy: 7145/10000 (71.4500%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0073, Accuracy: 8943/8968 (99.7212%)
Scaling by  100
Scaled Norm after poisoning: 368.99947069745235, distance: 369.04598290727944
Total norm for 4 adversaries is: 368.99947069745235. distance: 369.04598290727944
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 281575.0585, Accuracy: 808/8968 (9.0098%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   1,  Average loss: 0.0137, Accuracy: 435/557 (78.0969%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 514/557 (92.2801%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   3,  Average loss: 0.0022, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   4,  Average loss: 0.0016, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   5,  Average loss: 0.0014, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   6,  Average loss: 0.0013, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   7,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   8,  Average loss: 0.0008, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Global model norm: 16.713075847876567.
Norm before scaling: 17.066441566254372. Distance: 3.6876687480009522
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.4584, Accuracy: 8541/10000 (85.4100%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0074, Accuracy: 8940/8968 (99.6878%)
Scaling by  100
Scaled Norm after poisoning: 368.92017259835495, distance: 368.7668852066302
Total norm for 4 adversaries is: 368.92017259835495. distance: 368.7668852066302
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  47, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 265/276 (96.0145%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3054, Accuracy: 9076/10000 (90.7600%)
___Train Local_Simple,  epoch  47, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 539/554 (97.2924%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1082, Accuracy: 9669/10000 (96.6900%)
___Train Local_Simple,  epoch  47, local model 90, internal_epoch   1,  Average loss: 0.0023, Accuracy: 662/683 (96.9253%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.7500, Accuracy: 7938/10000 (79.3800%)
___Train Local_Simple,  epoch  47, local model 89, internal_epoch   1,  Average loss: 0.0007, Accuracy: 485/492 (98.5772%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1529, Accuracy: 9546/10000 (95.4600%)
___Train Local_Simple,  epoch  47, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 619/623 (99.3579%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2084, Accuracy: 9393/10000 (93.9300%)
___Train Local_Simple,  epoch  47, local model 79, internal_epoch   1,  Average loss: 0.0021, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1209, Accuracy: 9646/10000 (96.4600%)
time spent on training: 111.50579690933228
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4524551831644583  data num: [606, 591, 568, 557, 276, 554, 683, 492, 623, 182]
[foolsgold agg] considering poison per batch poison_fraction: 0.14139224473889322
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.0948, Accuracy: 9719/10000 (97.1900%)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 9.4560, Accuracy: 190/8968 (2.1186%)
Done in 133.5486979484558 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:48 choose agents : [41, 73, 51, 74, 36, 67, 87, 65, 30, 98]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   1,  Average loss: 0.0135, Accuracy: 483/606 (79.7030%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   2,  Average loss: 0.0029, Accuracy: 578/606 (95.3795%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   3,  Average loss: 0.0016, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   4,  Average loss: 0.0013, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   5,  Average loss: 0.0013, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   6,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   7,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   9,  Average loss: 0.0011, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch  10,  Average loss: 0.0008, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Global model norm: 16.718161314110155.
Norm before scaling: 17.177675636802643. Distance: 4.312159649230778
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.5529, Accuracy: 8327/10000 (83.2700%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0048, Accuracy: 8951/8968 (99.8104%)
Scaling by  100
Scaled Norm after poisoning: 431.1899777070427, distance: 431.2159588013876
Total norm for 4 adversaries is: 431.1899777070427. distance: 431.2159588013876
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 7.8313, Accuracy: 8966/8968 (99.9777%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   1,  Average loss: 0.0124, Accuracy: 492/591 (83.2487%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   2,  Average loss: 0.0028, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   3,  Average loss: 0.0015, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   4,  Average loss: 0.0010, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   5,  Average loss: 0.0010, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   6,  Average loss: 0.0011, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   7,  Average loss: 0.0009, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   8,  Average loss: 0.0009, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   9,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch  10,  Average loss: 0.0006, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Global model norm: 16.718161314110155.
Norm before scaling: 17.086917160128955. Distance: 3.901384787585457
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4492, Accuracy: 8549/10000 (85.4900%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0029, Accuracy: 8956/8968 (99.8662%)
Scaling by  100
Scaled Norm after poisoning: 390.1436033693235, distance: 390.13847701809675
Total norm for 4 adversaries is: 390.1436033693235. distance: 390.13847701809675
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 9326907.0999, Accuracy: 12/8968 (0.1338%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   1,  Average loss: 0.0109, Accuracy: 477/568 (83.9789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   3,  Average loss: 0.0019, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   4,  Average loss: 0.0020, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   5,  Average loss: 0.0017, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   6,  Average loss: 0.0013, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   7,  Average loss: 0.0014, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   8,  Average loss: 0.0013, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch  10,  Average loss: 0.0010, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Global model norm: 16.718161314110155.
Norm before scaling: 16.96311989356432. Distance: 3.459869840081088
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.7168, Accuracy: 7519/10000 (75.1900%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0041, Accuracy: 8960/8968 (99.9108%)
Scaling by  100
Scaled Norm after poisoning: 345.8532474186125, distance: 345.9869826850426
Total norm for 4 adversaries is: 345.8532474186125. distance: 345.9869826850426
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 1030432.8591, Accuracy: 3/8968 (0.0335%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0158, Accuracy: 429/557 (77.0197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   2,  Average loss: 0.0060, Accuracy: 485/557 (87.0736%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   3,  Average loss: 0.0031, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   4,  Average loss: 0.0028, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   5,  Average loss: 0.0020, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   6,  Average loss: 0.0015, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   7,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   8,  Average loss: 0.0012, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch  10,  Average loss: 0.0012, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Global model norm: 16.718161314110155.
Norm before scaling: 17.160146913410845. Distance: 4.254127517704382
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.5266, Accuracy: 8322/10000 (83.2200%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0059, Accuracy: 8945/8968 (99.7435%)
Scaling by  100
Scaled Norm after poisoning: 425.3741000578197, distance: 425.4127407589011
Total norm for 4 adversaries is: 425.3741000578197. distance: 425.4127407589011
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 5012016.6664, Accuracy: 2301/8968 (25.6579%)
___Train Local_Simple,  epoch  48, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 979/1005 (97.4129%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4396, Accuracy: 8811/10000 (88.1100%)
___Train Local_Simple,  epoch  48, local model 67, internal_epoch   1,  Average loss: 0.0016, Accuracy: 970/998 (97.1944%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2791, Accuracy: 9154/10000 (91.5400%)
___Train Local_Simple,  epoch  48, local model 87, internal_epoch   1,  Average loss: 0.0012, Accuracy: 460/470 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2014, Accuracy: 9393/10000 (93.9300%)
___Train Local_Simple,  epoch  48, local model 65, internal_epoch   1,  Average loss: 0.0011, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1576, Accuracy: 9487/10000 (94.8700%)
___Train Local_Simple,  epoch  48, local model 30, internal_epoch   1,  Average loss: 0.0014, Accuracy: 388/400 (97.0000%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1819, Accuracy: 9479/10000 (94.7900%)
___Train Local_Simple,  epoch  48, local model 98, internal_epoch   1,  Average loss: 0.0016, Accuracy: 787/818 (96.2103%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4404, Accuracy: 8610/10000 (86.1000%)
time spent on training: 110.73008322715759
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.36372180451127817  data num: [606, 591, 568, 557, 1005, 998, 470, 371, 400, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.11366306390977443
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.0952, Accuracy: 9721/10000 (97.2100%)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 9.4091, Accuracy: 202/8968 (2.2525%)
Done in 133.08653450012207 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:49 choose agents : [41, 73, 51, 74, 25, 54, 52, 46, 6, 35]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   1,  Average loss: 0.0125, Accuracy: 493/606 (81.3531%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   2,  Average loss: 0.0024, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   3,  Average loss: 0.0013, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   4,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   5,  Average loss: 0.0012, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   6,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   7,  Average loss: 0.0008, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   8,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   9,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch  10,  Average loss: 0.0006, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Global model norm: 16.723908557261385.
Norm before scaling: 17.008882782412822. Distance: 3.589974584675457
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6534, Accuracy: 7935/10000 (79.3500%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0056, Accuracy: 8948/8968 (99.7770%)
Scaling by  100
Scaled Norm after poisoning: 358.930877746677, distance: 358.9974647368697
Total norm for 4 adversaries is: 358.930877746677. distance: 358.9974647368697
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   1,  Average loss: 0.0148, Accuracy: 476/591 (80.5415%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 546/591 (92.3858%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   3,  Average loss: 0.0020, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   4,  Average loss: 0.0014, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   5,  Average loss: 0.0012, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   6,  Average loss: 0.0010, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   7,  Average loss: 0.0008, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   8,  Average loss: 0.0008, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   9,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch  10,  Average loss: 0.0008, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Global model norm: 16.723908557261385.
Norm before scaling: 17.437754639437795. Distance: 5.174794090707918
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5663, Accuracy: 8126/10000 (81.2600%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0038, Accuracy: 8954/8968 (99.8439%)
Scaling by  100
Scaled Norm after poisoning: 517.5185081231394, distance: 517.4794078028613
Total norm for 4 adversaries is: 517.5185081231394. distance: 517.4794078028613
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 14574099.6503, Accuracy: 1376/8968 (15.3434%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   1,  Average loss: 0.0119, Accuracy: 449/568 (79.0493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   3,  Average loss: 0.0030, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   4,  Average loss: 0.0021, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   5,  Average loss: 0.0020, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   6,  Average loss: 0.0017, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   7,  Average loss: 0.0016, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   8,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch  10,  Average loss: 0.0012, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Global model norm: 16.723908557261385.
Norm before scaling: 17.16244978484096. Distance: 4.216530675290878
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.7319, Accuracy: 7490/10000 (74.9000%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0013, Accuracy: 8963/8968 (99.9442%)
Scaling by  100
Scaled Norm after poisoning: 421.63861896178344, distance: 421.6530341999213
Total norm for 4 adversaries is: 421.63861896178344. distance: 421.6530341999213
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 4579219.2979, Accuracy: 13/8968 (0.1450%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0156, Accuracy: 448/557 (80.4309%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 507/557 (91.0233%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   3,  Average loss: 0.0021, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   4,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   5,  Average loss: 0.0013, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   6,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   7,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   8,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Global model norm: 16.723908557261385.
Norm before scaling: 17.089932589054804. Distance: 3.942250126459547
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5228, Accuracy: 8236/10000 (82.3600%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0041, Accuracy: 8949/8968 (99.7881%)
Scaling by  100
Scaled Norm after poisoning: 394.178358265646, distance: 394.22503091508537
Total norm for 4 adversaries is: 394.178358265646. distance: 394.22503091508537
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 259232.3557, Accuracy: 5008/8968 (55.8430%)
___Train Local_Simple,  epoch  49, local model 25, internal_epoch   1,  Average loss: 0.0023, Accuracy: 621/647 (95.9815%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5620, Accuracy: 8213/10000 (82.1300%)
___Train Local_Simple,  epoch  49, local model 54, internal_epoch   1,  Average loss: 0.0018, Accuracy: 503/519 (96.9171%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.4874, Accuracy: 8481/10000 (84.8100%)
___Train Local_Simple,  epoch  49, local model 52, internal_epoch   1,  Average loss: 0.0013, Accuracy: 247/253 (97.6285%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1564, Accuracy: 9541/10000 (95.4100%)
___Train Local_Simple,  epoch  49, local model 46, internal_epoch   1,  Average loss: 0.0018, Accuracy: 689/710 (97.0423%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3059, Accuracy: 9100/10000 (91.0000%)
___Train Local_Simple,  epoch  49, local model 6, internal_epoch   1,  Average loss: 0.0016, Accuracy: 596/615 (96.9106%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2667, Accuracy: 9145/10000 (91.4500%)
___Train Local_Simple,  epoch  49, local model 35, internal_epoch   1,  Average loss: 0.0008, Accuracy: 491/499 (98.3968%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2539, Accuracy: 9275/10000 (92.7500%)
time spent on training: 111.55924725532532
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4172506738544474  data num: [606, 591, 568, 557, 647, 519, 253, 710, 615, 499]
[foolsgold agg] considering poison per batch poison_fraction: 0.1303908355795148
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.0954, Accuracy: 9719/10000 (97.1900%)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 9.3524, Accuracy: 210/8968 (2.3417%)
Done in 133.30381417274475 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:50 choose agents : [41, 73, 51, 74, 17, 20, 77, 44, 8, 78]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   1,  Average loss: 0.0130, Accuracy: 484/606 (79.8680%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   2,  Average loss: 0.0034, Accuracy: 570/606 (94.0594%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   3,  Average loss: 0.0018, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   4,  Average loss: 0.0017, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   5,  Average loss: 0.0014, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   6,  Average loss: 0.0009, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   7,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   8,  Average loss: 0.0009, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   9,  Average loss: 0.0006, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch  10,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Global model norm: 16.72933915533482.
Norm before scaling: 17.206507600573502. Distance: 4.444739440558694
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6772, Accuracy: 7882/10000 (78.8200%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0010, Accuracy: 8965/8968 (99.9665%)
Scaling by  100
Scaled Norm after poisoning: 444.38797449413505, distance: 444.47389898058134
Total norm for 4 adversaries is: 444.38797449413505. distance: 444.47389898058134
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 2681234.0912, Accuracy: 3577/8968 (39.8863%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   1,  Average loss: 0.0126, Accuracy: 485/591 (82.0643%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   2,  Average loss: 0.0027, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   3,  Average loss: 0.0016, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   4,  Average loss: 0.0015, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   5,  Average loss: 0.0013, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   6,  Average loss: 0.0011, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   7,  Average loss: 0.0010, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   8,  Average loss: 0.0008, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   9,  Average loss: 0.0006, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch  10,  Average loss: 0.0008, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Global model norm: 16.72933915533482.
Norm before scaling: 17.085234646323176. Distance: 4.034777849740048
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6643, Accuracy: 7769/10000 (77.6900%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0110, Accuracy: 8921/8968 (99.4759%)
Scaling by  100
Scaled Norm after poisoning: 403.2985091715565, distance: 403.4777913652745
Total norm for 4 adversaries is: 403.2985091715565. distance: 403.4777913652745
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 21208015.1668, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0106, Accuracy: 477/568 (83.9789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   2,  Average loss: 0.0027, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   3,  Average loss: 0.0018, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   4,  Average loss: 0.0021, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   5,  Average loss: 0.0016, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   6,  Average loss: 0.0014, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   7,  Average loss: 0.0013, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   8,  Average loss: 0.0010, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   9,  Average loss: 0.0011, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch  10,  Average loss: 0.0009, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Global model norm: 16.72933915533482.
Norm before scaling: 17.03707612504637. Distance: 3.661846995808991
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.7136, Accuracy: 7571/10000 (75.7100%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0138, Accuracy: 8920/8968 (99.4648%)
Scaling by  100
Scaled Norm after poisoning: 366.15476577534804, distance: 366.1846998100822
Total norm for 4 adversaries is: 366.15476577534804. distance: 366.1846998100822
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 8270504.5870, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   1,  Average loss: 0.0149, Accuracy: 435/557 (78.0969%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 516/557 (92.6391%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   3,  Average loss: 0.0019, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   4,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   5,  Average loss: 0.0017, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   7,  Average loss: 0.0011, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   9,  Average loss: 0.0008, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Global model norm: 16.72933915533482.
Norm before scaling: 17.11295892115415. Distance: 3.936947375073007
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.5430, Accuracy: 8318/10000 (83.1800%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0059, Accuracy: 8944/8968 (99.7324%)
Scaling by  100
Scaled Norm after poisoning: 393.73051539092063, distance: 393.6947381855643
Total norm for 4 adversaries is: 393.73051539092063. distance: 393.6947381855643
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 6753301.3042, Accuracy: 577/8968 (6.4340%)
___Train Local_Simple,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 604/620 (97.4194%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1928, Accuracy: 9390/10000 (93.9000%)
___Train Local_Simple,  epoch  50, local model 20, internal_epoch   1,  Average loss: 0.0015, Accuracy: 416/429 (96.9697%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.3128, Accuracy: 9065/10000 (90.6500%)
___Train Local_Simple,  epoch  50, local model 77, internal_epoch   1,  Average loss: 0.0018, Accuracy: 570/589 (96.7742%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1715, Accuracy: 9498/10000 (94.9800%)
___Train Local_Simple,  epoch  50, local model 44, internal_epoch   1,  Average loss: 0.0024, Accuracy: 493/517 (95.3578%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1633, Accuracy: 9510/10000 (95.1000%)
___Train Local_Simple,  epoch  50, local model 8, internal_epoch   1,  Average loss: 0.0023, Accuracy: 610/633 (96.3665%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2058, Accuracy: 9366/10000 (93.6600%)
___Train Local_Simple,  epoch  50, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 296/303 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2963, Accuracy: 9097/10000 (90.9700%)
time spent on training: 110.37227773666382
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4289673009421762  data num: [606, 591, 568, 557, 620, 429, 589, 517, 633, 303]
[foolsgold agg] considering poison per batch poison_fraction: 0.13405228154443008
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.0955, Accuracy: 9721/10000 (97.2100%)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 9.3046, Accuracy: 217/8968 (2.4197%)
Done in 132.31809401512146 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:51 choose agents : [41, 73, 51, 74, 3, 39, 14, 32, 4, 30]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   1,  Average loss: 0.0150, Accuracy: 465/606 (76.7327%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   2,  Average loss: 0.0032, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   3,  Average loss: 0.0017, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   4,  Average loss: 0.0016, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   5,  Average loss: 0.0010, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   6,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   7,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   8,  Average loss: 0.0009, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch  10,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Global model norm: 16.734483506592664.
Norm before scaling: 17.252504913236514. Distance: 4.572535517050414
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.7672, Accuracy: 7900/10000 (79.0000%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0001, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 457.1986712579117, distance: 457.25353675504795
Total norm for 4 adversaries is: 457.1986712579117. distance: 457.25353675504795
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   1,  Average loss: 0.0118, Accuracy: 489/591 (82.7411%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   2,  Average loss: 0.0029, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   3,  Average loss: 0.0010, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   4,  Average loss: 0.0011, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   5,  Average loss: 0.0010, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   6,  Average loss: 0.0006, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   7,  Average loss: 0.0007, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   8,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   9,  Average loss: 0.0006, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch  10,  Average loss: 0.0006, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Global model norm: 16.734483506592664.
Norm before scaling: 17.101405464103127. Distance: 3.8397039192018165
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.4975, Accuracy: 8402/10000 (84.0200%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0030, Accuracy: 8955/8968 (99.8550%)
Scaling by  100
Scaled Norm after poisoning: 384.03187937331455, distance: 383.97039680813936
Total norm for 4 adversaries is: 384.03187937331455. distance: 383.97039680813936
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 1890144.8127, Accuracy: 2846/8968 (31.7351%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   1,  Average loss: 0.0100, Accuracy: 479/568 (84.3310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   2,  Average loss: 0.0025, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   3,  Average loss: 0.0020, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   4,  Average loss: 0.0016, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   5,  Average loss: 0.0013, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   6,  Average loss: 0.0012, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   7,  Average loss: 0.0013, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   8,  Average loss: 0.0010, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   9,  Average loss: 0.0008, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch  10,  Average loss: 0.0010, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Global model norm: 16.734483506592664.
Norm before scaling: 17.025666551803578. Distance: 3.3970060293409703
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.7250, Accuracy: 7596/10000 (75.9600%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0163, Accuracy: 8914/8968 (99.3979%)
Scaling by  100
Scaled Norm after poisoning: 339.86117340393565, distance: 339.70059197402054
Total norm for 4 adversaries is: 339.86117340393565. distance: 339.70059197402054
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 1839655.3455, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   1,  Average loss: 0.0136, Accuracy: 433/557 (77.7379%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   2,  Average loss: 0.0033, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   3,  Average loss: 0.0017, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   4,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   5,  Average loss: 0.0011, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   6,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   7,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   9,  Average loss: 0.0010, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch  10,  Average loss: 0.0008, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Global model norm: 16.734483506592664.
Norm before scaling: 17.048458371985664. Distance: 3.631062403969196
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.4680, Accuracy: 8516/10000 (85.1600%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0117, Accuracy: 8929/8968 (99.5651%)
Scaling by  100
Scaled Norm after poisoning: 363.13694042330644, distance: 363.1062387580252
Total norm for 4 adversaries is: 363.13694042330644. distance: 363.1062387580252
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  51, local model 3, internal_epoch   1,  Average loss: 0.0017, Accuracy: 896/923 (97.0748%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2100, Accuracy: 9290/10000 (92.9000%)
___Train Local_Simple,  epoch  51, local model 39, internal_epoch   1,  Average loss: 0.0011, Accuracy: 251/257 (97.6654%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1397, Accuracy: 9562/10000 (95.6200%)
___Train Local_Simple,  epoch  51, local model 14, internal_epoch   1,  Average loss: 0.0022, Accuracy: 366/376 (97.3404%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1141, Accuracy: 9654/10000 (96.5400%)
___Train Local_Simple,  epoch  51, local model 32, internal_epoch   1,  Average loss: 0.0022, Accuracy: 946/977 (96.8270%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.3580, Accuracy: 8913/10000 (89.1300%)
___Train Local_Simple,  epoch  51, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 641/658 (97.4164%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.6567, Accuracy: 8034/10000 (80.3400%)
___Train Local_Simple,  epoch  51, local model 30, internal_epoch   1,  Average loss: 0.0020, Accuracy: 388/400 (97.0000%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2413, Accuracy: 9298/10000 (92.9800%)
time spent on training: 110.02625179290771
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3926940639269406  data num: [606, 591, 568, 557, 923, 257, 376, 977, 658, 400]
[foolsgold agg] considering poison per batch poison_fraction: 0.12271689497716895
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 51: Average loss: 0.0955, Accuracy: 9721/10000 (97.2100%)
___Test Target_Simple poisoned: True, epoch: 51: Average loss: 9.2326, Accuracy: 228/8968 (2.5424%)
Done in 131.38096141815186 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:52 choose agents : [41, 73, 51, 74, 30, 65, 23, 3, 98, 88]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   1,  Average loss: 0.0159, Accuracy: 464/606 (76.5677%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 561/606 (92.5743%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   3,  Average loss: 0.0020, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   4,  Average loss: 0.0019, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   5,  Average loss: 0.0014, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   6,  Average loss: 0.0015, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   7,  Average loss: 0.0010, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   8,  Average loss: 0.0013, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   9,  Average loss: 0.0010, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch  10,  Average loss: 0.0010, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Global model norm: 16.739037413637508.
Norm before scaling: 17.285701350868187. Distance: 4.927100516915012
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.7710, Accuracy: 7778/10000 (77.7800%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0010, Accuracy: 8966/8968 (99.9777%)
Scaling by  100
Scaled Norm after poisoning: 492.4183149264454, distance: 492.71005989831383
Total norm for 4 adversaries is: 492.4183149264454. distance: 492.71005989831383
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   1,  Average loss: 0.0124, Accuracy: 490/591 (82.9103%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   3,  Average loss: 0.0017, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   4,  Average loss: 0.0013, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   5,  Average loss: 0.0010, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   6,  Average loss: 0.0012, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   7,  Average loss: 0.0010, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   8,  Average loss: 0.0006, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   9,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch  10,  Average loss: 0.0007, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Global model norm: 16.739037413637508.
Norm before scaling: 17.13118170105639. Distance: 4.064527973767204
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.5376, Accuracy: 8279/10000 (82.7900%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0014, Accuracy: 8963/8968 (99.9442%)
Scaling by  100
Scaled Norm after poisoning: 406.3991264754392, distance: 406.45279553719394
Total norm for 4 adversaries is: 406.3991264754392. distance: 406.45279553719394
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 1842634.3893, Accuracy: 2307/8968 (25.7248%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   1,  Average loss: 0.0106, Accuracy: 472/568 (83.0986%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   3,  Average loss: 0.0016, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   4,  Average loss: 0.0017, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   5,  Average loss: 0.0013, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   6,  Average loss: 0.0014, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   7,  Average loss: 0.0011, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   8,  Average loss: 0.0010, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   9,  Average loss: 0.0007, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch  10,  Average loss: 0.0008, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Global model norm: 16.739037413637508.
Norm before scaling: 17.052268960727318. Distance: 3.4770910654197253
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.5869, Accuracy: 8035/10000 (80.3500%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0166, Accuracy: 8905/8968 (99.2975%)
Scaling by  100
Scaled Norm after poisoning: 347.8954359789734, distance: 347.70910974548826
Total norm for 4 adversaries is: 347.8954359789734. distance: 347.70910974548826
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 3453984.3559, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   1,  Average loss: 0.0126, Accuracy: 445/557 (79.8923%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   3,  Average loss: 0.0022, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   4,  Average loss: 0.0016, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   5,  Average loss: 0.0013, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   7,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   8,  Average loss: 0.0010, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch  10,  Average loss: 0.0009, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Global model norm: 16.739037413637508.
Norm before scaling: 17.105717181770963. Distance: 3.675594961571963
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.4093, Accuracy: 8664/10000 (86.6400%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0090, Accuracy: 8931/8968 (99.5874%)
Scaling by  100
Scaled Norm after poisoning: 367.790956250966, distance: 367.5594977347205
Total norm for 4 adversaries is: 367.790956250966. distance: 367.5594977347205
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  52, local model 30, internal_epoch   1,  Average loss: 0.0015, Accuracy: 386/400 (96.5000%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2535, Accuracy: 9290/10000 (92.9000%)
___Train Local_Simple,  epoch  52, local model 65, internal_epoch   1,  Average loss: 0.0010, Accuracy: 363/371 (97.8437%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1574, Accuracy: 9503/10000 (95.0300%)
___Train Local_Simple,  epoch  52, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2061, Accuracy: 9368/10000 (93.6800%)
___Train Local_Simple,  epoch  52, local model 3, internal_epoch   1,  Average loss: 0.0019, Accuracy: 892/923 (96.6414%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2285, Accuracy: 9319/10000 (93.1900%)
___Train Local_Simple,  epoch  52, local model 98, internal_epoch   1,  Average loss: 0.0016, Accuracy: 796/818 (97.3105%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.3247, Accuracy: 8978/10000 (89.7800%)
___Train Local_Simple,  epoch  52, local model 88, internal_epoch   1,  Average loss: 0.0009, Accuracy: 522/530 (98.4906%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1747, Accuracy: 9488/10000 (94.8800%)
time spent on training: 111.1253170967102
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41046491073006897  data num: [606, 591, 568, 557, 400, 371, 293, 923, 818, 530]
[foolsgold agg] considering poison per batch poison_fraction: 0.12827028460314654
[foolsgold agg] wv: [1.         1.         1.         1.         0.72288096 1.
 0.72288096 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 52: Average loss: 0.0958, Accuracy: 9721/10000 (97.2100%)
___Test Target_Simple poisoned: True, epoch: 52: Average loss: 9.1993, Accuracy: 239/8968 (2.6650%)
Done in 133.2937068939209 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:53 choose agents : [41, 73, 51, 74, 71, 2, 43, 25, 17, 37]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   1,  Average loss: 0.0119, Accuracy: 492/606 (81.1881%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   2,  Average loss: 0.0028, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   3,  Average loss: 0.0015, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   4,  Average loss: 0.0015, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   5,  Average loss: 0.0014, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   6,  Average loss: 0.0010, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   7,  Average loss: 0.0009, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   8,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch  10,  Average loss: 0.0008, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Global model norm: 16.744806651755866.
Norm before scaling: 17.19317999185787. Distance: 4.124822901767695
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.5564, Accuracy: 8228/10000 (82.2800%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0004, Accuracy: 8967/8968 (99.9888%)
Scaling by  100
Scaled Norm after poisoning: 412.60428605990023, distance: 412.48231022675384
Total norm for 4 adversaries is: 412.60428605990023. distance: 412.48231022675384
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   1,  Average loss: 0.0128, Accuracy: 487/591 (82.4027%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 551/591 (93.2318%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   3,  Average loss: 0.0023, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   4,  Average loss: 0.0020, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   5,  Average loss: 0.0016, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   6,  Average loss: 0.0013, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   7,  Average loss: 0.0012, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   8,  Average loss: 0.0009, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   9,  Average loss: 0.0008, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch  10,  Average loss: 0.0009, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Global model norm: 16.744806651755866.
Norm before scaling: 17.295313488119948. Distance: 4.6353195123099304
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6720, Accuracy: 7967/10000 (79.6700%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0005, Accuracy: 8967/8968 (99.9888%)
Scaling by  100
Scaled Norm after poisoning: 463.5380917465144, distance: 463.53193997285666
Total norm for 4 adversaries is: 463.5380917465144. distance: 463.53193997285666
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 6029209.3992, Accuracy: 3650/8968 (40.7003%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   1,  Average loss: 0.0116, Accuracy: 461/568 (81.1620%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   3,  Average loss: 0.0024, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   4,  Average loss: 0.0017, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   5,  Average loss: 0.0019, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   6,  Average loss: 0.0019, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   7,  Average loss: 0.0013, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   8,  Average loss: 0.0012, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   9,  Average loss: 0.0013, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch  10,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Global model norm: 16.744806651755866.
Norm before scaling: 17.07664624344687. Distance: 3.754236244519394
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.7302, Accuracy: 7448/10000 (74.4800%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0132, Accuracy: 8926/8968 (99.5317%)
Scaling by  100
Scaled Norm after poisoning: 375.4147081894901, distance: 375.42363571037987
Total norm for 4 adversaries is: 375.4147081894901. distance: 375.42363571037987
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 549175.3771, Accuracy: 1/8968 (0.0112%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   1,  Average loss: 0.0143, Accuracy: 437/557 (78.4560%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 510/557 (91.5619%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   3,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   4,  Average loss: 0.0020, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   5,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   6,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   7,  Average loss: 0.0011, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   8,  Average loss: 0.0010, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Global model norm: 16.744806651755866.
Norm before scaling: 17.079647404696328. Distance: 3.6671674704278985
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.4564, Accuracy: 8561/10000 (85.6100%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0044, Accuracy: 8949/8968 (99.7881%)
Scaling by  100
Scaled Norm after poisoning: 366.8096832827618, distance: 366.71674610658295
Total norm for 4 adversaries is: 366.8096832827618. distance: 366.71674610658295
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  53, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1357/1384 (98.0491%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6765, Accuracy: 8264/10000 (82.6400%)
___Train Local_Simple,  epoch  53, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 535/548 (97.6277%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1654, Accuracy: 9470/10000 (94.7000%)
___Train Local_Simple,  epoch  53, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1738, Accuracy: 9487/10000 (94.8700%)
___Train Local_Simple,  epoch  53, local model 25, internal_epoch   1,  Average loss: 0.0015, Accuracy: 626/647 (96.7543%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.7815, Accuracy: 7883/10000 (78.8300%)
___Train Local_Simple,  epoch  53, local model 17, internal_epoch   1,  Average loss: 0.0018, Accuracy: 603/620 (97.2581%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2095, Accuracy: 9312/10000 (93.1200%)
___Train Local_Simple,  epoch  53, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 844/860 (98.1395%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.5393, Accuracy: 8832/10000 (88.3200%)
time spent on training: 112.2770664691925
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.34202386212991603  data num: [606, 591, 568, 557, 1384, 548, 408, 647, 620, 860]
[foolsgold agg] considering poison per batch poison_fraction: 0.10688245691559876
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 53: Average loss: 0.0959, Accuracy: 9722/10000 (97.2200%)
___Test Target_Simple poisoned: True, epoch: 53: Average loss: 9.1635, Accuracy: 249/8968 (2.7765%)
Done in 134.08081078529358 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:54 choose agents : [41, 73, 51, 74, 46, 56, 30, 0, 33, 53]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   1,  Average loss: 0.0129, Accuracy: 476/606 (78.5479%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   2,  Average loss: 0.0021, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   3,  Average loss: 0.0015, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   4,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   5,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   6,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   7,  Average loss: 0.0009, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   8,  Average loss: 0.0006, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch  10,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Global model norm: 16.75061671701644.
Norm before scaling: 17.187207028753065. Distance: 4.3259679604171435
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.6447, Accuracy: 8181/10000 (81.8100%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0004, Accuracy: 8967/8968 (99.9888%)
Scaling by  100
Scaled Norm after poisoning: 432.47062761533294, distance: 432.59679191482684
Total norm for 4 adversaries is: 432.47062761533294. distance: 432.59679191482684
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 777137.8559, Accuracy: 5150/8968 (57.4264%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   1,  Average loss: 0.0126, Accuracy: 476/591 (80.5415%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 550/591 (93.0626%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   3,  Average loss: 0.0023, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   4,  Average loss: 0.0020, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   5,  Average loss: 0.0015, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   6,  Average loss: 0.0015, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   7,  Average loss: 0.0010, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   8,  Average loss: 0.0011, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   9,  Average loss: 0.0010, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch  10,  Average loss: 0.0009, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Global model norm: 16.75061671701644.
Norm before scaling: 17.275001872569092. Distance: 4.478326100574403
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.5915, Accuracy: 8136/10000 (81.3600%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0013, Accuracy: 8963/8968 (99.9442%)
Scaling by  100
Scaled Norm after poisoning: 447.8988620492354, distance: 447.83264522028765
Total norm for 4 adversaries is: 447.8988620492354. distance: 447.83264522028765
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 13202494.1659, Accuracy: 575/8968 (6.4117%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   1,  Average loss: 0.0095, Accuracy: 486/568 (85.5634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   2,  Average loss: 0.0023, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   3,  Average loss: 0.0021, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   4,  Average loss: 0.0017, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   5,  Average loss: 0.0014, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   6,  Average loss: 0.0013, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   7,  Average loss: 0.0014, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   8,  Average loss: 0.0013, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch  10,  Average loss: 0.0012, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Global model norm: 16.75061671701644.
Norm before scaling: 17.05895646296891. Distance: 3.5169641275536936
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.6718, Accuracy: 7640/10000 (76.4000%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0006, Accuracy: 8967/8968 (99.9888%)
Scaling by  100
Scaled Norm after poisoning: 351.818878739473, distance: 351.6964022775894
Total norm for 4 adversaries is: 351.818878739473. distance: 351.6964022775894
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   1,  Average loss: 0.0144, Accuracy: 437/557 (78.4560%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 489/557 (87.7917%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   3,  Average loss: 0.0026, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   4,  Average loss: 0.0026, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   5,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   6,  Average loss: 0.0015, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch  10,  Average loss: 0.0013, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Global model norm: 16.75061671701644.
Norm before scaling: 17.18836024125638. Distance: 4.153737161842089
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.5437, Accuracy: 8229/10000 (82.2900%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0034, Accuracy: 8956/8968 (99.8662%)
Scaling by  100
Scaled Norm after poisoning: 415.42290199265614, distance: 415.37368341651114
Total norm for 4 adversaries is: 415.42290199265614. distance: 415.37368341651114
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  54, local model 46, internal_epoch   1,  Average loss: 0.0024, Accuracy: 675/710 (95.0704%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.7387, Accuracy: 7654/10000 (76.5400%)
___Train Local_Simple,  epoch  54, local model 56, internal_epoch   1,  Average loss: 0.0021, Accuracy: 846/880 (96.1364%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1239, Accuracy: 9627/10000 (96.2700%)
___Train Local_Simple,  epoch  54, local model 30, internal_epoch   1,  Average loss: 0.0015, Accuracy: 388/400 (97.0000%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2259, Accuracy: 9362/10000 (93.6200%)
___Train Local_Simple,  epoch  54, local model 0, internal_epoch   1,  Average loss: 0.0016, Accuracy: 422/435 (97.0115%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1813, Accuracy: 9461/10000 (94.6100%)
___Train Local_Simple,  epoch  54, local model 33, internal_epoch   1,  Average loss: 0.0016, Accuracy: 608/623 (97.5923%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1709, Accuracy: 9467/10000 (94.6700%)
___Train Local_Simple,  epoch  54, local model 53, internal_epoch   1,  Average loss: 0.0012, Accuracy: 724/739 (97.9702%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2637, Accuracy: 9234/10000 (92.3400%)
time spent on training: 111.71991181373596
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3800949418890162  data num: [606, 591, 568, 557, 710, 880, 400, 435, 623, 739]
[foolsgold agg] considering poison per batch poison_fraction: 0.11877966934031757
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 54: Average loss: 0.0963, Accuracy: 9723/10000 (97.2300%)
___Test Target_Simple poisoned: True, epoch: 54: Average loss: 9.0842, Accuracy: 261/8968 (2.9103%)
Done in 133.82172799110413 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:55 choose agents : [41, 73, 51, 74, 17, 65, 6, 24, 86, 35]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   1,  Average loss: 0.0129, Accuracy: 477/606 (78.7129%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 571/606 (94.2244%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   3,  Average loss: 0.0016, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   4,  Average loss: 0.0015, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   5,  Average loss: 0.0016, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   6,  Average loss: 0.0014, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   7,  Average loss: 0.0010, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   9,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch  10,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Global model norm: 16.756597785228884.
Norm before scaling: 17.288189617312177. Distance: 4.578608047988438
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.6977, Accuracy: 7889/10000 (78.8900%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0002, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 457.85447333186556, distance: 457.86078670268324
Total norm for 4 adversaries is: 457.85447333186556. distance: 457.86078670268324
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 4766493.7228, Accuracy: 1980/8968 (22.0785%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   1,  Average loss: 0.0147, Accuracy: 459/591 (77.6650%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   3,  Average loss: 0.0016, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   4,  Average loss: 0.0014, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   5,  Average loss: 0.0014, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   6,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   7,  Average loss: 0.0008, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   8,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   9,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch  10,  Average loss: 0.0007, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Global model norm: 16.756597785228884.
Norm before scaling: 17.27796946286703. Distance: 4.633102536570919
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.5521, Accuracy: 8165/10000 (81.6500%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0020, Accuracy: 8959/8968 (99.8996%)
Scaling by  100
Scaled Norm after poisoning: 463.2116821713373, distance: 463.3102699595596
Total norm for 4 adversaries is: 463.2116821713373. distance: 463.3102699595596
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 1977478.8211, Accuracy: 5392/8968 (60.1249%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   1,  Average loss: 0.0123, Accuracy: 445/568 (78.3451%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   2,  Average loss: 0.0043, Accuracy: 521/568 (91.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   3,  Average loss: 0.0021, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   4,  Average loss: 0.0023, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   5,  Average loss: 0.0017, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   6,  Average loss: 0.0016, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   7,  Average loss: 0.0014, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   8,  Average loss: 0.0013, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   9,  Average loss: 0.0010, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch  10,  Average loss: 0.0012, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Global model norm: 16.756597785228884.
Norm before scaling: 17.25668957132096. Distance: 4.332840426850588
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.7560, Accuracy: 7511/10000 (75.1100%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0052, Accuracy: 8946/8968 (99.7547%)
Scaling by  100
Scaled Norm after poisoning: 433.40452740482533, distance: 433.28406170202015
Total norm for 4 adversaries is: 433.40452740482533. distance: 433.28406170202015
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   1,  Average loss: 0.0140, Accuracy: 444/557 (79.7127%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 493/557 (88.5099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   3,  Average loss: 0.0029, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   4,  Average loss: 0.0019, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   5,  Average loss: 0.0015, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   7,  Average loss: 0.0012, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   8,  Average loss: 0.0009, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   9,  Average loss: 0.0008, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch  10,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Global model norm: 16.756597785228884.
Norm before scaling: 17.201523043600854. Distance: 3.9679091155964987
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.3600, Accuracy: 8867/10000 (88.6700%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0050, Accuracy: 8952/8968 (99.8216%)
Scaling by  100
Scaled Norm after poisoning: 397.0645413531659, distance: 396.79089660046384
Total norm for 4 adversaries is: 397.0645413531659. distance: 396.79089660046384
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  55, local model 17, internal_epoch   1,  Average loss: 0.0019, Accuracy: 599/620 (96.6129%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1844, Accuracy: 9411/10000 (94.1100%)
___Train Local_Simple,  epoch  55, local model 65, internal_epoch   1,  Average loss: 0.0010, Accuracy: 361/371 (97.3046%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.3263, Accuracy: 9059/10000 (90.5900%)
___Train Local_Simple,  epoch  55, local model 6, internal_epoch   1,  Average loss: 0.0018, Accuracy: 597/615 (97.0732%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.5736, Accuracy: 8576/10000 (85.7600%)
___Train Local_Simple,  epoch  55, local model 24, internal_epoch   1,  Average loss: 0.0020, Accuracy: 362/379 (95.5145%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1423, Accuracy: 9537/10000 (95.3700%)
___Train Local_Simple,  epoch  55, local model 86, internal_epoch   1,  Average loss: 0.0010, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1224, Accuracy: 9640/10000 (96.4000%)
___Train Local_Simple,  epoch  55, local model 35, internal_epoch   1,  Average loss: 0.0006, Accuracy: 493/499 (98.7976%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1985, Accuracy: 9446/10000 (94.4600%)
time spent on training: 110.6893801689148
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.45925632911392406  data num: [606, 591, 568, 557, 620, 371, 615, 379, 250, 499]
[foolsgold agg] considering poison per batch poison_fraction: 0.14351760284810128
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 55: Average loss: 0.0968, Accuracy: 9721/10000 (97.2100%)
___Test Target_Simple poisoned: True, epoch: 55: Average loss: 9.1026, Accuracy: 268/8968 (2.9884%)
Done in 133.61128449440002 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:56 choose agents : [41, 73, 51, 74, 84, 85, 60, 94, 30, 76]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   1,  Average loss: 0.0119, Accuracy: 500/606 (82.5083%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   2,  Average loss: 0.0029, Accuracy: 573/606 (94.5545%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   3,  Average loss: 0.0018, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   4,  Average loss: 0.0016, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   5,  Average loss: 0.0012, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   6,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   7,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   8,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   9,  Average loss: 0.0008, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch  10,  Average loss: 0.0009, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Global model norm: 16.762926266660138.
Norm before scaling: 17.16011490220946. Distance: 3.898687870647243
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.5520, Accuracy: 8288/10000 (82.8800%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0006, Accuracy: 8967/8968 (99.9888%)
Scaling by  100
Scaled Norm after poisoning: 390.0077723584493, distance: 389.86878802361184
Total norm for 4 adversaries is: 390.0077723584493. distance: 389.86878802361184
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 2286581.6860, Accuracy: 963/8968 (10.7382%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   1,  Average loss: 0.0127, Accuracy: 484/591 (81.8951%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   2,  Average loss: 0.0030, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   3,  Average loss: 0.0016, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   4,  Average loss: 0.0014, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   5,  Average loss: 0.0012, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   6,  Average loss: 0.0011, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   7,  Average loss: 0.0009, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   8,  Average loss: 0.0008, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   9,  Average loss: 0.0007, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch  10,  Average loss: 0.0007, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Global model norm: 16.762926266660138.
Norm before scaling: 17.20194350506833. Distance: 4.174028276670315
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.5525, Accuracy: 8280/10000 (82.8000%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0016, Accuracy: 8961/8968 (99.9219%)
Scaling by  100
Scaled Norm after poisoning: 417.43859952692446, distance: 417.4028517212119
Total norm for 4 adversaries is: 417.43859952692446. distance: 417.4028517212119
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 21083.6947, Accuracy: 8574/8968 (95.6066%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   1,  Average loss: 0.0101, Accuracy: 482/568 (84.8592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   3,  Average loss: 0.0020, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   4,  Average loss: 0.0022, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   5,  Average loss: 0.0015, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   6,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   7,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   8,  Average loss: 0.0010, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   9,  Average loss: 0.0010, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch  10,  Average loss: 0.0009, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Global model norm: 16.762926266660138.
Norm before scaling: 17.061878458516905. Distance: 3.426946913642781
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.6914, Accuracy: 7601/10000 (76.0100%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0176, Accuracy: 8909/8968 (99.3421%)
Scaling by  100
Scaled Norm after poisoning: 342.8665237741941, distance: 342.69467551305786
Total norm for 4 adversaries is: 342.8665237741941. distance: 342.69467551305786
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   1,  Average loss: 0.0104, Accuracy: 478/557 (85.8169%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   2,  Average loss: 0.0030, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   3,  Average loss: 0.0017, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   4,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   5,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   6,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   7,  Average loss: 0.0009, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   8,  Average loss: 0.0009, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   9,  Average loss: 0.0008, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch  10,  Average loss: 0.0008, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Global model norm: 16.762926266660138.
Norm before scaling: 16.99271640699838. Distance: 3.034199331838162
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.3900, Accuracy: 8736/10000 (87.3600%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0053, Accuracy: 8949/8968 (99.7881%)
Scaling by  100
Scaled Norm after poisoning: 303.644027295944, distance: 303.4199467116491
Total norm for 4 adversaries is: 303.644027295944. distance: 303.4199467116491
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 1625148.1401, Accuracy: 1805/8968 (20.1271%)
___Train Local_Simple,  epoch  56, local model 84, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1206/1246 (96.7897%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.2509, Accuracy: 9233/10000 (92.3300%)
___Train Local_Simple,  epoch  56, local model 85, internal_epoch   1,  Average loss: 0.0010, Accuracy: 423/431 (98.1439%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1967, Accuracy: 9407/10000 (94.0700%)
___Train Local_Simple,  epoch  56, local model 60, internal_epoch   1,  Average loss: 0.0018, Accuracy: 328/338 (97.0414%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1829, Accuracy: 9440/10000 (94.4000%)
___Train Local_Simple,  epoch  56, local model 94, internal_epoch   1,  Average loss: 0.0031, Accuracy: 144/150 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1544, Accuracy: 9557/10000 (95.5700%)
___Train Local_Simple,  epoch  56, local model 30, internal_epoch   1,  Average loss: 0.0014, Accuracy: 388/400 (97.0000%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.3303, Accuracy: 9078/10000 (90.7800%)
___Train Local_Simple,  epoch  56, local model 76, internal_epoch   1,  Average loss: 0.0010, Accuracy: 77/78 (98.7179%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1083, Accuracy: 9689/10000 (96.8900%)
time spent on training: 111.33682537078857
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4676737160120846  data num: [606, 591, 568, 557, 1246, 431, 338, 150, 400, 78]
[foolsgold agg] considering poison per batch poison_fraction: 0.14614803625377643
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 56: Average loss: 0.0973, Accuracy: 9723/10000 (97.2300%)
___Test Target_Simple poisoned: True, epoch: 56: Average loss: 9.0574, Accuracy: 272/8968 (3.0330%)
Done in 133.32960534095764 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:57 choose agents : [41, 73, 51, 74, 42, 25, 16, 95, 52, 59]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   1,  Average loss: 0.0127, Accuracy: 496/606 (81.8482%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   2,  Average loss: 0.0027, Accuracy: 575/606 (94.8845%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   3,  Average loss: 0.0026, Accuracy: 572/606 (94.3894%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   4,  Average loss: 0.0017, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   5,  Average loss: 0.0015, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   6,  Average loss: 0.0011, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   7,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   9,  Average loss: 0.0009, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch  10,  Average loss: 0.0008, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Global model norm: 16.768528952547445.
Norm before scaling: 17.226689164783757. Distance: 4.297949306396767
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.7567, Accuracy: 7920/10000 (79.2000%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0273, Accuracy: 8878/8968 (98.9964%)
Scaling by  100
Scaled Norm after poisoning: 429.785011662808, distance: 429.794936568592
Total norm for 4 adversaries is: 429.785011662808. distance: 429.794936568592
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 1801505.8020, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   1,  Average loss: 0.0140, Accuracy: 475/591 (80.3723%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 547/591 (92.5550%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   3,  Average loss: 0.0022, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   4,  Average loss: 0.0018, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   5,  Average loss: 0.0015, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   6,  Average loss: 0.0015, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   7,  Average loss: 0.0013, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   8,  Average loss: 0.0011, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   9,  Average loss: 0.0010, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch  10,  Average loss: 0.0010, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Global model norm: 16.768528952547445.
Norm before scaling: 17.348859044797443. Distance: 4.856550861794135
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.7048, Accuracy: 7791/10000 (77.9100%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0002, Accuracy: 8967/8968 (99.9888%)
Scaling by  100
Scaled Norm after poisoning: 485.55470855507104, distance: 485.65511489636344
Total norm for 4 adversaries is: 485.55470855507104. distance: 485.65511489636344
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 8853441.4384, Accuracy: 2190/8968 (24.4202%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   1,  Average loss: 0.0109, Accuracy: 484/568 (85.2113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   3,  Average loss: 0.0020, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   4,  Average loss: 0.0021, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   5,  Average loss: 0.0015, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   6,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   7,  Average loss: 0.0009, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   8,  Average loss: 0.0009, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   9,  Average loss: 0.0007, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch  10,  Average loss: 0.0008, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Global model norm: 16.768528952547445.
Norm before scaling: 17.016085027355825. Distance: 3.3633013823257785
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.6278, Accuracy: 7832/10000 (78.3200%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0252, Accuracy: 8882/8968 (99.0410%)
Scaling by  100
Scaled Norm after poisoning: 336.3098692054695, distance: 336.33011359748923
Total norm for 4 adversaries is: 336.3098692054695. distance: 336.33011359748923
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 535999.7345, Accuracy: 32/8968 (0.3568%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   1,  Average loss: 0.0122, Accuracy: 453/557 (81.3285%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   2,  Average loss: 0.0035, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   3,  Average loss: 0.0014, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   4,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   5,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   6,  Average loss: 0.0009, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   7,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   8,  Average loss: 0.0009, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch  10,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Global model norm: 16.768528952547445.
Norm before scaling: 17.06352661174376. Distance: 3.3694248068554273
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.3456, Accuracy: 8908/10000 (89.0800%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0027, Accuracy: 8957/8968 (99.8773%)
Scaling by  100
Scaled Norm after poisoning: 337.1559589047775, distance: 336.9424561405107
Total norm for 4 adversaries is: 337.1559589047775. distance: 336.9424561405107
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  57, local model 42, internal_epoch   1,  Average loss: 0.0019, Accuracy: 229/236 (97.0339%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1472, Accuracy: 9553/10000 (95.5300%)
___Train Local_Simple,  epoch  57, local model 25, internal_epoch   1,  Average loss: 0.0018, Accuracy: 624/647 (96.4451%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.4992, Accuracy: 8488/10000 (84.8800%)
___Train Local_Simple,  epoch  57, local model 16, internal_epoch   1,  Average loss: 0.0013, Accuracy: 895/915 (97.8142%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1811, Accuracy: 9467/10000 (94.6700%)
___Train Local_Simple,  epoch  57, local model 95, internal_epoch   1,  Average loss: 0.0003, Accuracy: 597/602 (99.1694%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.0090, Accuracy: 7856/10000 (78.5600%)
___Train Local_Simple,  epoch  57, local model 52, internal_epoch   1,  Average loss: 0.0014, Accuracy: 246/253 (97.2332%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.2118, Accuracy: 9385/10000 (93.8500%)
___Train Local_Simple,  epoch  57, local model 59, internal_epoch   1,  Average loss: 0.0019, Accuracy: 736/760 (96.8421%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.8393, Accuracy: 7902/10000 (79.0200%)
time spent on training: 109.64669990539551
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4048823016564952  data num: [606, 591, 568, 557, 236, 647, 915, 602, 253, 760]
[foolsgold agg] considering poison per batch poison_fraction: 0.12652571926765474
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 57: Average loss: 0.0974, Accuracy: 9724/10000 (97.2400%)
___Test Target_Simple poisoned: True, epoch: 57: Average loss: 8.9975, Accuracy: 284/8968 (3.1668%)
Done in 130.5124273300171 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:58 choose agents : [41, 73, 51, 74, 52, 81, 77, 21, 10, 8]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   1,  Average loss: 0.0141, Accuracy: 473/606 (78.0528%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   2,  Average loss: 0.0027, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   3,  Average loss: 0.0017, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   4,  Average loss: 0.0014, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   5,  Average loss: 0.0013, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   6,  Average loss: 0.0011, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   7,  Average loss: 0.0011, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch  10,  Average loss: 0.0008, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Global model norm: 16.773946924029428.
Norm before scaling: 17.25217943659583. Distance: 4.565631366701798
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.6984, Accuracy: 7780/10000 (77.8000%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0003, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 456.3704635490776, distance: 456.56312884966957
Total norm for 4 adversaries is: 456.3704635490776. distance: 456.56312884966957
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 26205656.9331, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   1,  Average loss: 0.0129, Accuracy: 485/591 (82.0643%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   3,  Average loss: 0.0013, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   4,  Average loss: 0.0012, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   5,  Average loss: 0.0010, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   6,  Average loss: 0.0008, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   7,  Average loss: 0.0008, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   8,  Average loss: 0.0008, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   9,  Average loss: 0.0007, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch  10,  Average loss: 0.0007, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Global model norm: 16.773946924029428.
Norm before scaling: 17.223481513030038. Distance: 4.288810792079071
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.5520, Accuracy: 8274/10000 (82.7400%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0015, Accuracy: 8962/8968 (99.9331%)
Scaling by  100
Scaled Norm after poisoning: 428.84641773017063, distance: 428.881084188846
Total norm for 4 adversaries is: 428.84641773017063. distance: 428.881084188846
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 14434052.2435, Accuracy: 144/8968 (1.6057%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   1,  Average loss: 0.0105, Accuracy: 474/568 (83.4507%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   2,  Average loss: 0.0026, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   3,  Average loss: 0.0023, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   4,  Average loss: 0.0020, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   5,  Average loss: 0.0014, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   6,  Average loss: 0.0017, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   7,  Average loss: 0.0013, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   8,  Average loss: 0.0012, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   9,  Average loss: 0.0007, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch  10,  Average loss: 0.0012, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Global model norm: 16.773946924029428.
Norm before scaling: 17.092898387721398. Distance: 3.5967976791330227
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.6576, Accuracy: 7795/10000 (77.9500%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0049, Accuracy: 8954/8968 (99.8439%)
Scaling by  100
Scaled Norm after poisoning: 359.774093616397, distance: 359.67976208010367
Total norm for 4 adversaries is: 359.774093616397. distance: 359.67976208010367
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 873126.4876, Accuracy: 117/8968 (1.3046%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   1,  Average loss: 0.0146, Accuracy: 445/557 (79.8923%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 506/557 (90.8438%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   3,  Average loss: 0.0029, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   4,  Average loss: 0.0024, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   5,  Average loss: 0.0019, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   6,  Average loss: 0.0019, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   8,  Average loss: 0.0012, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch  10,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.773946924029428.
Norm before scaling: 17.301892938854355. Distance: 4.3903139486126515
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.4956, Accuracy: 8326/10000 (83.2600%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0079, Accuracy: 8933/8968 (99.6097%)
Scaling by  100
Scaled Norm after poisoning: 439.20549717643564, distance: 439.03139124668525
Total norm for 4 adversaries is: 439.20549717643564. distance: 439.03139124668525
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 16193409.7556, Accuracy: 44/8968 (0.4906%)
___Train Local_Simple,  epoch  58, local model 52, internal_epoch   1,  Average loss: 0.0012, Accuracy: 246/253 (97.2332%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1817, Accuracy: 9475/10000 (94.7500%)
___Train Local_Simple,  epoch  58, local model 81, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1209/1227 (98.5330%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.4096, Accuracy: 8919/10000 (89.1900%)
___Train Local_Simple,  epoch  58, local model 77, internal_epoch   1,  Average loss: 0.0019, Accuracy: 568/589 (96.4346%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1438, Accuracy: 9547/10000 (95.4700%)
___Train Local_Simple,  epoch  58, local model 21, internal_epoch   1,  Average loss: 0.0015, Accuracy: 303/312 (97.1154%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.2240, Accuracy: 9345/10000 (93.4500%)
___Train Local_Simple,  epoch  58, local model 10, internal_epoch   1,  Average loss: 0.0018, Accuracy: 861/892 (96.5247%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.3579, Accuracy: 8854/10000 (88.5400%)
___Train Local_Simple,  epoch  58, local model 8, internal_epoch   1,  Average loss: 0.0020, Accuracy: 614/633 (96.9984%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1954, Accuracy: 9389/10000 (93.8900%)
time spent on training: 106.07062530517578
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.37283236994219654  data num: [606, 591, 568, 557, 253, 1227, 589, 312, 892, 633]
[foolsgold agg] considering poison per batch poison_fraction: 0.11651011560693642
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 58: Average loss: 0.0980, Accuracy: 9724/10000 (97.2400%)
___Test Target_Simple poisoned: True, epoch: 58: Average loss: 8.9474, Accuracy: 306/8968 (3.4121%)
Done in 126.8382499217987 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:59 choose agents : [41, 73, 51, 74, 40, 54, 46, 30, 78, 9]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   1,  Average loss: 0.0128, Accuracy: 496/606 (81.8482%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   2,  Average loss: 0.0030, Accuracy: 573/606 (94.5545%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   3,  Average loss: 0.0019, Accuracy: 580/606 (95.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   4,  Average loss: 0.0017, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   5,  Average loss: 0.0014, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   6,  Average loss: 0.0013, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   7,  Average loss: 0.0009, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   9,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch  10,  Average loss: 0.0009, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Global model norm: 16.780074264853074.
Norm before scaling: 17.27405142933189. Distance: 4.327471852511272
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.7627, Accuracy: 7591/10000 (75.9100%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0035, Accuracy: 8954/8968 (99.8439%)
Scaling by  100
Scaled Norm after poisoning: 432.85238534632106, distance: 432.7471836996747
Total norm for 4 adversaries is: 432.85238534632106. distance: 432.7471836996747
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 11196087.0526, Accuracy: 40/8968 (0.4460%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   1,  Average loss: 0.0127, Accuracy: 506/591 (85.6176%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   2,  Average loss: 0.0030, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   3,  Average loss: 0.0015, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   4,  Average loss: 0.0013, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   5,  Average loss: 0.0013, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   6,  Average loss: 0.0012, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   7,  Average loss: 0.0010, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   8,  Average loss: 0.0007, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   9,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch  10,  Average loss: 0.0007, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Global model norm: 16.780074264853074.
Norm before scaling: 17.292118566039072. Distance: 4.312745460490617
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.4731, Accuracy: 8417/10000 (84.1700%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0011, Accuracy: 8962/8968 (99.9331%)
Scaling by  100
Scaled Norm after poisoning: 431.4672460048387, distance: 431.2745645177791
Total norm for 4 adversaries is: 431.4672460048387. distance: 431.2745645177791
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 736372.9451, Accuracy: 4650/8968 (51.8510%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   1,  Average loss: 0.0082, Accuracy: 499/568 (87.8521%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   2,  Average loss: 0.0022, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   3,  Average loss: 0.0017, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   4,  Average loss: 0.0012, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   5,  Average loss: 0.0010, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   6,  Average loss: 0.0010, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   7,  Average loss: 0.0009, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   8,  Average loss: 0.0006, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   9,  Average loss: 0.0007, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch  10,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Global model norm: 16.780074264853074.
Norm before scaling: 17.014789206975575. Distance: 3.0899477626496084
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.5073, Accuracy: 8378/10000 (83.7800%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0214, Accuracy: 8898/8968 (99.2194%)
Scaling by  100
Scaled Norm after poisoning: 309.18889604495826, distance: 308.9947536973727
Total norm for 4 adversaries is: 309.18889604495826. distance: 308.9947536973727
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   1,  Average loss: 0.0131, Accuracy: 437/557 (78.4560%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   3,  Average loss: 0.0022, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   4,  Average loss: 0.0017, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   5,  Average loss: 0.0013, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   6,  Average loss: 0.0012, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   7,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   8,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch  10,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Global model norm: 16.780074264853074.
Norm before scaling: 17.10548792888283. Distance: 3.4738772877052204
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.4148, Accuracy: 8699/10000 (86.9900%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0063, Accuracy: 8946/8968 (99.7547%)
Scaling by  100
Scaled Norm after poisoning: 347.64310227947857, distance: 347.3877404104814
Total norm for 4 adversaries is: 347.64310227947857. distance: 347.3877404104814
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  59, local model 40, internal_epoch   1,  Average loss: 0.0016, Accuracy: 742/772 (96.1140%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1303, Accuracy: 9606/10000 (96.0600%)
___Train Local_Simple,  epoch  59, local model 54, internal_epoch   1,  Average loss: 0.0015, Accuracy: 504/519 (97.1098%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.3400, Accuracy: 8961/10000 (89.6100%)
___Train Local_Simple,  epoch  59, local model 46, internal_epoch   1,  Average loss: 0.0021, Accuracy: 676/710 (95.2113%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2783, Accuracy: 9127/10000 (91.2700%)
___Train Local_Simple,  epoch  59, local model 30, internal_epoch   1,  Average loss: 0.0016, Accuracy: 389/400 (97.2500%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2382, Accuracy: 9343/10000 (93.4300%)
___Train Local_Simple,  epoch  59, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 296/303 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2681, Accuracy: 9256/10000 (92.5600%)
___Train Local_Simple,  epoch  59, local model 9, internal_epoch   1,  Average loss: 0.0016, Accuracy: 420/436 (96.3303%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.3688, Accuracy: 9059/10000 (90.5900%)
time spent on training: 106.68395686149597
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.42511900402782865  data num: [606, 591, 568, 557, 772, 519, 710, 400, 303, 436]
[foolsgold agg] considering poison per batch poison_fraction: 0.13284968875869646
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.93929884
 1.         1.         0.93929884 1.        ]
___Test Target_Simple poisoned: False, epoch: 59: Average loss: 0.0983, Accuracy: 9723/10000 (97.2300%)
___Test Target_Simple poisoned: True, epoch: 59: Average loss: 8.9413, Accuracy: 327/8968 (3.6463%)
Done in 127.62414479255676 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:60 choose agents : [41, 73, 51, 74, 89, 4, 11, 24, 43, 23]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   1,  Average loss: 0.0137, Accuracy: 490/606 (80.8581%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 566/606 (93.3993%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   3,  Average loss: 0.0024, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   4,  Average loss: 0.0022, Accuracy: 581/606 (95.8746%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   5,  Average loss: 0.0013, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   6,  Average loss: 0.0011, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   7,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   9,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch  10,  Average loss: 0.0008, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Global model norm: 16.786522063788166.
Norm before scaling: 17.352655547235866. Distance: 4.703310332337788
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6852, Accuracy: 7950/10000 (79.5000%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0013, Accuracy: 8965/8968 (99.9665%)
Scaling by  100
Scaled Norm after poisoning: 470.3335751091984, distance: 470.3310004666926
Total norm for 4 adversaries is: 470.3335751091984. distance: 470.3310004666926
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   1,  Average loss: 0.0151, Accuracy: 469/591 (79.3570%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   2,  Average loss: 0.0048, Accuracy: 529/591 (89.5093%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   3,  Average loss: 0.0027, Accuracy: 559/591 (94.5854%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   4,  Average loss: 0.0033, Accuracy: 551/591 (93.2318%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   5,  Average loss: 0.0023, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   6,  Average loss: 0.0020, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   7,  Average loss: 0.0019, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   8,  Average loss: 0.0015, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   9,  Average loss: 0.0014, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch  10,  Average loss: 0.0016, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Global model norm: 16.786522063788166.
Norm before scaling: 17.615889988249954. Distance: 5.774510429735581
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.9290, Accuracy: 6979/10000 (69.7900%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0001, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 577.278285361575, distance: 577.451053120522
Total norm for 4 adversaries is: 577.278285361575. distance: 577.451053120522
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 28649219.6253, Accuracy: 747/8968 (8.3296%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   1,  Average loss: 0.0088, Accuracy: 493/568 (86.7958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   2,  Average loss: 0.0025, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   3,  Average loss: 0.0018, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   4,  Average loss: 0.0017, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   5,  Average loss: 0.0013, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   6,  Average loss: 0.0010, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   7,  Average loss: 0.0009, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   8,  Average loss: 0.0008, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   9,  Average loss: 0.0007, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch  10,  Average loss: 0.0008, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Global model norm: 16.786522063788166.
Norm before scaling: 17.05554817743518. Distance: 3.2730824862959333
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6107, Accuracy: 8004/10000 (80.0400%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0034, Accuracy: 8955/8968 (99.8550%)
Scaling by  100
Scaled Norm after poisoning: 327.4929269274376, distance: 327.3082453895716
Total norm for 4 adversaries is: 327.4929269274376. distance: 327.3082453895716
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   1,  Average loss: 0.0116, Accuracy: 447/557 (80.2513%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 513/557 (92.1005%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   3,  Average loss: 0.0016, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   4,  Average loss: 0.0014, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   5,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   6,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   7,  Average loss: 0.0010, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch  10,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Global model norm: 16.786522063788166.
Norm before scaling: 17.10606239335835. Distance: 3.4806767154303295
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.4489, Accuracy: 8534/10000 (85.3400%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0049, Accuracy: 8953/8968 (99.8327%)
Scaling by  100
Scaled Norm after poisoning: 348.28777612773035, distance: 348.06769052513334
Total norm for 4 adversaries is: 348.28777612773035. distance: 348.06769052513334
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  60, local model 89, internal_epoch   1,  Average loss: 0.0009, Accuracy: 486/492 (98.7805%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1553, Accuracy: 9552/10000 (95.5200%)
___Train Local_Simple,  epoch  60, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 636/658 (96.6565%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1970, Accuracy: 9362/10000 (93.6200%)
___Train Local_Simple,  epoch  60, local model 11, internal_epoch   1,  Average loss: 0.0017, Accuracy: 626/645 (97.0543%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2613, Accuracy: 9135/10000 (91.3500%)
___Train Local_Simple,  epoch  60, local model 24, internal_epoch   1,  Average loss: 0.0021, Accuracy: 364/379 (96.0422%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1328, Accuracy: 9594/10000 (95.9400%)
___Train Local_Simple,  epoch  60, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 398/408 (97.5490%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.3297, Accuracy: 9034/10000 (90.3400%)
___Train Local_Simple,  epoch  60, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2131, Accuracy: 9336/10000 (93.3600%)
time spent on training: 106.23557186126709
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4467962285934193  data num: [606, 591, 568, 557, 492, 658, 645, 379, 408, 293]
[foolsgold agg] considering poison per batch poison_fraction: 0.13962382143544352
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 60: Average loss: 0.0984, Accuracy: 9719/10000 (97.1900%)
___Test Target_Simple poisoned: True, epoch: 60: Average loss: 8.8725, Accuracy: 347/8968 (3.8693%)
Done in 127.37874937057495 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:61 choose agents : [41, 73, 51, 74, 25, 97, 91, 57, 72, 15]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   1,  Average loss: 0.0107, Accuracy: 502/606 (82.8383%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   2,  Average loss: 0.0021, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   3,  Average loss: 0.0016, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   4,  Average loss: 0.0011, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   5,  Average loss: 0.0012, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   6,  Average loss: 0.0009, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   7,  Average loss: 0.0008, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   8,  Average loss: 0.0009, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   9,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch  10,  Average loss: 0.0007, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Global model norm: 16.792338595265605.
Norm before scaling: 17.292291518109035. Distance: 4.339978014279417
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.7344, Accuracy: 8017/10000 (80.1700%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0011, Accuracy: 8965/8968 (99.9665%)
Scaling by  100
Scaled Norm after poisoning: 434.1158579515381, distance: 433.99776785140267
Total norm for 4 adversaries is: 434.1158579515381. distance: 433.99776785140267
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 17871269.8127, Accuracy: 1/8968 (0.0112%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   1,  Average loss: 0.0105, Accuracy: 507/591 (85.7868%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   2,  Average loss: 0.0024, Accuracy: 564/591 (95.4315%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   3,  Average loss: 0.0014, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   4,  Average loss: 0.0014, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   5,  Average loss: 0.0011, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   6,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   7,  Average loss: 0.0008, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   8,  Average loss: 0.0008, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   9,  Average loss: 0.0008, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch  10,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Global model norm: 16.792338595265605.
Norm before scaling: 17.240340472264734. Distance: 4.202489641802003
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.5137, Accuracy: 8291/10000 (82.9100%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0008, Accuracy: 8965/8968 (99.9665%)
Scaling by  100
Scaled Norm after poisoning: 420.2972162648713, distance: 420.248996132055
Total norm for 4 adversaries is: 420.2972162648713. distance: 420.248996132055
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 7577409.2694, Accuracy: 1451/8968 (16.1798%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   1,  Average loss: 0.0101, Accuracy: 480/568 (84.5070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   2,  Average loss: 0.0027, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   3,  Average loss: 0.0023, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   4,  Average loss: 0.0017, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   5,  Average loss: 0.0014, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   6,  Average loss: 0.0012, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   7,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   8,  Average loss: 0.0010, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   9,  Average loss: 0.0009, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch  10,  Average loss: 0.0009, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Global model norm: 16.792338595265605.
Norm before scaling: 17.143157465892642. Distance: 3.7371938114350605
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.6529, Accuracy: 7717/10000 (77.1700%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0173, Accuracy: 8916/8968 (99.4202%)
Scaling by  100
Scaled Norm after poisoning: 373.8208126897164, distance: 373.7193758356663
Total norm for 4 adversaries is: 373.8208126897164. distance: 373.7193758356663
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 757486.2838, Accuracy: 15/8968 (0.1673%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   1,  Average loss: 0.0126, Accuracy: 451/557 (80.9695%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   2,  Average loss: 0.0035, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   3,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   4,  Average loss: 0.0019, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   5,  Average loss: 0.0014, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   6,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   7,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   9,  Average loss: 0.0008, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch  10,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Global model norm: 16.792338595265605.
Norm before scaling: 17.117641232290794. Distance: 3.661584597816603
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.4564, Accuracy: 8527/10000 (85.2700%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0055, Accuracy: 8945/8968 (99.7435%)
Scaling by  100
Scaled Norm after poisoning: 366.2190259940081, distance: 366.1584569895935
Total norm for 4 adversaries is: 366.2190259940081. distance: 366.1584569895935
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  61, local model 25, internal_epoch   1,  Average loss: 0.0021, Accuracy: 623/647 (96.2906%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.5486, Accuracy: 8247/10000 (82.4700%)
___Train Local_Simple,  epoch  61, local model 97, internal_epoch   1,  Average loss: 0.0012, Accuracy: 475/487 (97.5359%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.6584, Accuracy: 8529/10000 (85.2900%)
___Train Local_Simple,  epoch  61, local model 91, internal_epoch   1,  Average loss: 0.0008, Accuracy: 252/256 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1108, Accuracy: 9673/10000 (96.7300%)
___Train Local_Simple,  epoch  61, local model 57, internal_epoch   1,  Average loss: 0.0022, Accuracy: 330/343 (96.2099%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2874, Accuracy: 9250/10000 (92.5000%)
___Train Local_Simple,  epoch  61, local model 72, internal_epoch   1,  Average loss: 0.0006, Accuracy: 721/731 (98.6320%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2505, Accuracy: 9251/10000 (92.5100%)
___Train Local_Simple,  epoch  61, local model 15, internal_epoch   1,  Average loss: 0.0022, Accuracy: 390/401 (97.2569%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1333, Accuracy: 9579/10000 (95.7900%)
time spent on training: 105.57815074920654
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4476576055523424  data num: [606, 591, 568, 557, 647, 487, 256, 343, 731, 401]
[foolsgold agg] considering poison per batch poison_fraction: 0.139893001735107
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 61: Average loss: 0.0988, Accuracy: 9716/10000 (97.1600%)
___Test Target_Simple poisoned: True, epoch: 61: Average loss: 8.8088, Accuracy: 365/8968 (4.0700%)
Done in 126.50393223762512 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:62 choose agents : [41, 73, 51, 74, 94, 95, 90, 69, 20, 81]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   1,  Average loss: 0.0119, Accuracy: 509/606 (83.9934%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   2,  Average loss: 0.0028, Accuracy: 567/606 (93.5644%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   3,  Average loss: 0.0019, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   4,  Average loss: 0.0015, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   5,  Average loss: 0.0013, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   6,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   7,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   9,  Average loss: 0.0008, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch  10,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Global model norm: 16.797629888560078.
Norm before scaling: 17.209878896744886. Distance: 4.040014630659447
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.5607, Accuracy: 8192/10000 (81.9200%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0264, Accuracy: 8891/8968 (99.1414%)
Scaling by  100
Scaled Norm after poisoning: 404.0657434131233, distance: 404.0014696755446
Total norm for 4 adversaries is: 404.0657434131233. distance: 404.0014696755446
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 2555417.7828, Accuracy: 4/8968 (0.0446%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   1,  Average loss: 0.0135, Accuracy: 493/591 (83.4179%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 548/591 (92.7242%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   3,  Average loss: 0.0025, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   4,  Average loss: 0.0020, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   5,  Average loss: 0.0016, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   6,  Average loss: 0.0015, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   7,  Average loss: 0.0013, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   8,  Average loss: 0.0012, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   9,  Average loss: 0.0010, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch  10,  Average loss: 0.0010, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Global model norm: 16.797629888560078.
Norm before scaling: 17.362722765905787. Distance: 4.732368472085708
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.6472, Accuracy: 8042/10000 (80.4200%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0004, Accuracy: 8967/8968 (99.9888%)
Scaling by  100
Scaled Norm after poisoning: 473.2083314989287, distance: 473.23685929986476
Total norm for 4 adversaries is: 473.2083314989287. distance: 473.23685929986476
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 8871345.0232, Accuracy: 2133/8968 (23.7846%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   1,  Average loss: 0.0101, Accuracy: 481/568 (84.6831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   2,  Average loss: 0.0026, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   3,  Average loss: 0.0017, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   4,  Average loss: 0.0017, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   5,  Average loss: 0.0010, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   6,  Average loss: 0.0011, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   7,  Average loss: 0.0011, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   8,  Average loss: 0.0007, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   9,  Average loss: 0.0008, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch  10,  Average loss: 0.0009, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Global model norm: 16.797629888560078.
Norm before scaling: 17.134507261994088. Distance: 3.484715192806377
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.6048, Accuracy: 7973/10000 (79.7300%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0207, Accuracy: 8898/8968 (99.2194%)
Scaling by  100
Scaled Norm after poisoning: 348.77403591007175, distance: 348.47150618809565
Total norm for 4 adversaries is: 348.77403591007175. distance: 348.47150618809565
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   1,  Average loss: 0.0116, Accuracy: 456/557 (81.8671%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   2,  Average loss: 0.0034, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   3,  Average loss: 0.0013, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   4,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   5,  Average loss: 0.0010, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   6,  Average loss: 0.0009, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   7,  Average loss: 0.0009, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   8,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch  10,  Average loss: 0.0006, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Global model norm: 16.797629888560078.
Norm before scaling: 17.071178646504155. Distance: 3.313858185638596
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.3339, Accuracy: 8942/10000 (89.4200%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0099, Accuracy: 8927/8968 (99.5428%)
Scaling by  100
Scaled Norm after poisoning: 331.55244447522927, distance: 331.3857976362294
Total norm for 4 adversaries is: 331.55244447522927. distance: 331.3857976362294
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  62, local model 94, internal_epoch   1,  Average loss: 0.0025, Accuracy: 142/150 (94.6667%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.2172, Accuracy: 9377/10000 (93.7700%)
___Train Local_Simple,  epoch  62, local model 95, internal_epoch   1,  Average loss: 0.0005, Accuracy: 595/602 (98.8372%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.9803, Accuracy: 7966/10000 (79.6600%)
___Train Local_Simple,  epoch  62, local model 90, internal_epoch   1,  Average loss: 0.0023, Accuracy: 656/683 (96.0469%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.8999, Accuracy: 7514/10000 (75.1400%)
___Train Local_Simple,  epoch  62, local model 69, internal_epoch   1,  Average loss: 0.0023, Accuracy: 242/256 (94.5312%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.2085, Accuracy: 9398/10000 (93.9800%)
___Train Local_Simple,  epoch  62, local model 20, internal_epoch   1,  Average loss: 0.0013, Accuracy: 416/429 (96.9697%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.3635, Accuracy: 8973/10000 (89.7300%)
___Train Local_Simple,  epoch  62, local model 81, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1202/1227 (97.9625%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.5165, Accuracy: 8711/10000 (87.1100%)
time spent on training: 104.76895546913147
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.40959604868583527  data num: [606, 591, 568, 557, 150, 602, 683, 256, 429, 1227]
[foolsgold agg] considering poison per batch poison_fraction: 0.12799876521432352
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 62: Average loss: 0.0991, Accuracy: 9716/10000 (97.1600%)
___Test Target_Simple poisoned: True, epoch: 62: Average loss: 8.7660, Accuracy: 392/8968 (4.3711%)
Done in 125.45092606544495 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:63 choose agents : [41, 73, 51, 74, 59, 21, 69, 14, 28, 22]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   1,  Average loss: 0.0131, Accuracy: 497/606 (82.0132%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   2,  Average loss: 0.0030, Accuracy: 570/606 (94.0594%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   3,  Average loss: 0.0017, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   4,  Average loss: 0.0016, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   5,  Average loss: 0.0012, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   6,  Average loss: 0.0010, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   7,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   8,  Average loss: 0.0008, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   9,  Average loss: 0.0008, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch  10,  Average loss: 0.0009, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Global model norm: 16.803403527773398.
Norm before scaling: 17.278036581038457. Distance: 4.504343268043321
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.7732, Accuracy: 7960/10000 (79.6000%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0021, Accuracy: 8962/8968 (99.9331%)
Scaling by  100
Scaled Norm after poisoning: 450.29119050898606, distance: 450.4343389995927
Total norm for 4 adversaries is: 450.29119050898606. distance: 450.4343389995927
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 3538298.6479, Accuracy: 14/8968 (0.1561%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   1,  Average loss: 0.0130, Accuracy: 504/591 (85.2792%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   3,  Average loss: 0.0021, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   4,  Average loss: 0.0016, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   5,  Average loss: 0.0017, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   6,  Average loss: 0.0013, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   7,  Average loss: 0.0010, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   8,  Average loss: 0.0010, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   9,  Average loss: 0.0010, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch  10,  Average loss: 0.0011, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Global model norm: 16.803403527773398.
Norm before scaling: 17.297024968297475. Distance: 4.439177719817602
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.5011, Accuracy: 8307/10000 (83.0700%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0004, Accuracy: 8967/8968 (99.9888%)
Scaling by  100
Scaled Norm after poisoning: 443.91215347183277, distance: 443.9178027799741
Total norm for 4 adversaries is: 443.91215347183277. distance: 443.9178027799741
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 4048121.0513, Accuracy: 716/8968 (7.9839%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   1,  Average loss: 0.0085, Accuracy: 504/568 (88.7324%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   2,  Average loss: 0.0025, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   3,  Average loss: 0.0015, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   4,  Average loss: 0.0011, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   5,  Average loss: 0.0013, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   6,  Average loss: 0.0011, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   7,  Average loss: 0.0008, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   8,  Average loss: 0.0007, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   9,  Average loss: 0.0007, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch  10,  Average loss: 0.0007, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Global model norm: 16.803403527773398.
Norm before scaling: 17.106279150562028. Distance: 3.3857159917504056
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.5811, Accuracy: 8034/10000 (80.3400%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0194, Accuracy: 8898/8968 (99.2194%)
Scaling by  100
Scaled Norm after poisoning: 338.81234435524925, distance: 338.5715858574077
Total norm for 4 adversaries is: 338.81234435524925. distance: 338.5715858574077
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   1,  Average loss: 0.0121, Accuracy: 458/557 (82.2262%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   3,  Average loss: 0.0020, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   4,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   5,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   6,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   7,  Average loss: 0.0009, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   8,  Average loss: 0.0008, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   9,  Average loss: 0.0008, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch  10,  Average loss: 0.0008, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Global model norm: 16.803403527773398.
Norm before scaling: 17.10134479075677. Distance: 3.4384005667368696
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.3569, Accuracy: 8873/10000 (88.7300%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0035, Accuracy: 8951/8968 (99.8104%)
Scaling by  100
Scaled Norm after poisoning: 344.00035201653503, distance: 343.8400450245724
Total norm for 4 adversaries is: 344.00035201653503. distance: 343.8400450245724
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  63, local model 59, internal_epoch   1,  Average loss: 0.0018, Accuracy: 732/760 (96.3158%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.4615, Accuracy: 8515/10000 (85.1500%)
___Train Local_Simple,  epoch  63, local model 21, internal_epoch   1,  Average loss: 0.0016, Accuracy: 300/312 (96.1538%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.3977, Accuracy: 8801/10000 (88.0100%)
___Train Local_Simple,  epoch  63, local model 69, internal_epoch   1,  Average loss: 0.0033, Accuracy: 242/256 (94.5312%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.3043, Accuracy: 9075/10000 (90.7500%)
___Train Local_Simple,  epoch  63, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 364/376 (96.8085%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.3602, Accuracy: 9050/10000 (90.5000%)
___Train Local_Simple,  epoch  63, local model 28, internal_epoch   1,  Average loss: 0.0018, Accuracy: 484/501 (96.6068%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1678, Accuracy: 9466/10000 (94.6600%)
___Train Local_Simple,  epoch  63, local model 22, internal_epoch   1,  Average loss: 0.0017, Accuracy: 562/583 (96.3979%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1738, Accuracy: 9518/10000 (95.1800%)
time spent on training: 105.22511100769043
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4544031311154599  data num: [606, 591, 568, 557, 760, 312, 256, 376, 501, 583]
[foolsgold agg] considering poison per batch poison_fraction: 0.1420009784735812
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.74012272
 0.74012272 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 63: Average loss: 0.0992, Accuracy: 9714/10000 (97.1400%)
___Test Target_Simple poisoned: True, epoch: 63: Average loss: 8.6969, Accuracy: 411/8968 (4.5830%)
Done in 126.35709404945374 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:64 choose agents : [41, 73, 51, 74, 72, 97, 37, 50, 42, 52]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   1,  Average loss: 0.0114, Accuracy: 507/606 (83.6634%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   2,  Average loss: 0.0028, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   3,  Average loss: 0.0020, Accuracy: 581/606 (95.8746%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   4,  Average loss: 0.0018, Accuracy: 581/606 (95.8746%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   5,  Average loss: 0.0014, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   6,  Average loss: 0.0013, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   7,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   9,  Average loss: 0.0010, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch  10,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Global model norm: 16.808830229425265.
Norm before scaling: 17.298282004370677. Distance: 4.392404867497933
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.6437, Accuracy: 8010/10000 (80.1000%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0016, Accuracy: 8964/8968 (99.9554%)
Scaling by  100
Scaled Norm after poisoning: 439.2662205314677, distance: 439.24048438753914
Total norm for 4 adversaries is: 439.2662205314677. distance: 439.24048438753914
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 5483398.9153, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   1,  Average loss: 0.0120, Accuracy: 490/591 (82.9103%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 557/591 (94.2470%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   3,  Average loss: 0.0023, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   4,  Average loss: 0.0019, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   5,  Average loss: 0.0016, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   6,  Average loss: 0.0011, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   7,  Average loss: 0.0011, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   8,  Average loss: 0.0010, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   9,  Average loss: 0.0008, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch  10,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Global model norm: 16.808830229425265.
Norm before scaling: 17.373513137538833. Distance: 4.741923643812709
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.6712, Accuracy: 7822/10000 (78.2200%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0003, Accuracy: 8967/8968 (99.9888%)
Scaling by  100
Scaled Norm after poisoning: 474.1545930653841, distance: 474.1923561435802
Total norm for 4 adversaries is: 474.1545930653841. distance: 474.1923561435802
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 35518104.0357, Accuracy: 9/8968 (0.1004%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   1,  Average loss: 0.0088, Accuracy: 497/568 (87.5000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   3,  Average loss: 0.0023, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   4,  Average loss: 0.0020, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   5,  Average loss: 0.0019, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   6,  Average loss: 0.0015, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   7,  Average loss: 0.0013, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   8,  Average loss: 0.0011, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch  10,  Average loss: 0.0011, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Global model norm: 16.808830229425265.
Norm before scaling: 17.09602075868095. Distance: 3.519741107133119
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.8774, Accuracy: 7420/10000 (74.2000%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0125, Accuracy: 8929/8968 (99.5651%)
Scaling by  100
Scaled Norm after poisoning: 351.99882368411403, distance: 351.9740979461415
Total norm for 4 adversaries is: 351.99882368411403. distance: 351.9740979461415
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   1,  Average loss: 0.0147, Accuracy: 444/557 (79.7127%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 503/557 (90.3052%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   3,  Average loss: 0.0026, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   4,  Average loss: 0.0021, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   5,  Average loss: 0.0016, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   7,  Average loss: 0.0012, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   9,  Average loss: 0.0010, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Global model norm: 16.808830229425265.
Norm before scaling: 17.250767787487387. Distance: 4.126492548172367
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.4026, Accuracy: 8778/10000 (87.7800%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0038, Accuracy: 8953/8968 (99.8327%)
Scaling by  100
Scaled Norm after poisoning: 412.75221456098814, distance: 412.64925330115403
Total norm for 4 adversaries is: 412.75221456098814. distance: 412.64925330115403
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  64, local model 72, internal_epoch   1,  Average loss: 0.0008, Accuracy: 721/731 (98.6320%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.3349, Accuracy: 9041/10000 (90.4100%)
___Train Local_Simple,  epoch  64, local model 97, internal_epoch   1,  Average loss: 0.0010, Accuracy: 476/487 (97.7413%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.2693, Accuracy: 9213/10000 (92.1300%)
___Train Local_Simple,  epoch  64, local model 37, internal_epoch   1,  Average loss: 0.0014, Accuracy: 844/860 (98.1395%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.3582, Accuracy: 8967/10000 (89.6700%)
___Train Local_Simple,  epoch  64, local model 50, internal_epoch   1,  Average loss: 0.0026, Accuracy: 452/474 (95.3586%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.4946, Accuracy: 8624/10000 (86.2400%)
___Train Local_Simple,  epoch  64, local model 42, internal_epoch   1,  Average loss: 0.0020, Accuracy: 226/236 (95.7627%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1544, Accuracy: 9532/10000 (95.3200%)
___Train Local_Simple,  epoch  64, local model 52, internal_epoch   1,  Average loss: 0.0012, Accuracy: 248/253 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1537, Accuracy: 9564/10000 (95.6400%)
time spent on training: 107.8205177783966
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.43296662315867984  data num: [606, 591, 568, 557, 731, 487, 860, 474, 236, 253]
[foolsgold agg] considering poison per batch poison_fraction: 0.13530206973708744
[foolsgold agg] wv: [1. 1. 1. 1. 0. 1. 1. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 64: Average loss: 0.0996, Accuracy: 9709/10000 (97.0900%)
___Test Target_Simple poisoned: True, epoch: 64: Average loss: 8.6694, Accuracy: 425/8968 (4.7391%)
Done in 128.56216955184937 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:65 choose agents : [41, 73, 51, 74, 75, 62, 42, 43, 87, 26]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   1,  Average loss: 0.0124, Accuracy: 494/606 (81.5182%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   2,  Average loss: 0.0034, Accuracy: 584/606 (96.3696%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   3,  Average loss: 0.0024, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   4,  Average loss: 0.0018, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   5,  Average loss: 0.0015, Accuracy: 588/606 (97.0297%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   6,  Average loss: 0.0013, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   7,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   8,  Average loss: 0.0010, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   9,  Average loss: 0.0010, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch  10,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Global model norm: 16.814841408754425.
Norm before scaling: 17.405694209596145. Distance: 4.8233419386007705
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.9197, Accuracy: 7624/10000 (76.2400%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 482.3116212574605, distance: 482.33420078820865
Total norm for 4 adversaries is: 482.3116212574605. distance: 482.33420078820865
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   1,  Average loss: 0.0138, Accuracy: 489/591 (82.7411%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 557/591 (94.2470%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   3,  Average loss: 0.0020, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   4,  Average loss: 0.0019, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   5,  Average loss: 0.0018, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   6,  Average loss: 0.0013, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   7,  Average loss: 0.0015, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   8,  Average loss: 0.0012, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   9,  Average loss: 0.0012, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch  10,  Average loss: 0.0012, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Global model norm: 16.814841408754425.
Norm before scaling: 17.380283348311043. Distance: 4.675661727665158
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.6104, Accuracy: 8091/10000 (80.9100%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0002, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 467.59838536932523, distance: 467.5662052052094
Total norm for 4 adversaries is: 467.59838536932523. distance: 467.5662052052094
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 4075922.1766, Accuracy: 1682/8968 (18.7556%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   1,  Average loss: 0.0087, Accuracy: 495/568 (87.1479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   2,  Average loss: 0.0025, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   3,  Average loss: 0.0016, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   4,  Average loss: 0.0016, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   5,  Average loss: 0.0011, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   6,  Average loss: 0.0011, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   7,  Average loss: 0.0010, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   8,  Average loss: 0.0009, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   9,  Average loss: 0.0006, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch  10,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Global model norm: 16.814841408754425.
Norm before scaling: 17.139936852355508. Distance: 3.4073551729900924
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.5218, Accuracy: 8228/10000 (82.2800%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0413, Accuracy: 8812/8968 (98.2605%)
Scaling by  100
Scaled Norm after poisoning: 341.0663883322424, distance: 340.73550959651976
Total norm for 4 adversaries is: 341.0663883322424. distance: 340.73550959651976
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   1,  Average loss: 0.0120, Accuracy: 446/557 (80.0718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   3,  Average loss: 0.0023, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   4,  Average loss: 0.0021, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   5,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   6,  Average loss: 0.0015, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   7,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   8,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   9,  Average loss: 0.0008, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Global model norm: 16.814841408754425.
Norm before scaling: 17.224318695989563. Distance: 3.870178915220255
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.4334, Accuracy: 8575/10000 (85.7500%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0065, Accuracy: 8938/8968 (99.6655%)
Scaling by  100
Scaled Norm after poisoning: 387.24874919100773, distance: 387.01790575501803
Total norm for 4 adversaries is: 387.24874919100773. distance: 387.01790575501803
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  65, local model 75, internal_epoch   1,  Average loss: 0.0015, Accuracy: 666/686 (97.0845%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1156, Accuracy: 9650/10000 (96.5000%)
___Train Local_Simple,  epoch  65, local model 62, internal_epoch   1,  Average loss: 0.0014, Accuracy: 412/423 (97.3995%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1430, Accuracy: 9584/10000 (95.8400%)
___Train Local_Simple,  epoch  65, local model 42, internal_epoch   1,  Average loss: 0.0017, Accuracy: 227/236 (96.1864%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1986, Accuracy: 9386/10000 (93.8600%)
___Train Local_Simple,  epoch  65, local model 43, internal_epoch   1,  Average loss: 0.0017, Accuracy: 396/408 (97.0588%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1682, Accuracy: 9517/10000 (95.1700%)
___Train Local_Simple,  epoch  65, local model 87, internal_epoch   1,  Average loss: 0.0016, Accuracy: 458/470 (97.4468%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.2739, Accuracy: 9193/10000 (91.9300%)
___Train Local_Simple,  epoch  65, local model 26, internal_epoch   1,  Average loss: 0.0015, Accuracy: 537/554 (96.9314%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1909, Accuracy: 9429/10000 (94.2900%)
time spent on training: 105.15140867233276
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.45538340851147285  data num: [606, 591, 568, 557, 686, 423, 236, 408, 470, 554]
[foolsgold agg] considering poison per batch poison_fraction: 0.14230731515983527
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 65: Average loss: 0.0996, Accuracy: 9706/10000 (97.0600%)
___Test Target_Simple poisoned: True, epoch: 65: Average loss: 8.5618, Accuracy: 450/8968 (5.0178%)
Done in 125.96047616004944 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:66 choose agents : [41, 73, 51, 74, 49, 52, 36, 55, 83, 33]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   1,  Average loss: 0.0149, Accuracy: 477/606 (78.7129%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   2,  Average loss: 0.0033, Accuracy: 570/606 (94.0594%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   3,  Average loss: 0.0020, Accuracy: 580/606 (95.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   4,  Average loss: 0.0016, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   5,  Average loss: 0.0014, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   6,  Average loss: 0.0011, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   7,  Average loss: 0.0012, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   8,  Average loss: 0.0011, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   9,  Average loss: 0.0012, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch  10,  Average loss: 0.0008, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Global model norm: 16.820654497510176.
Norm before scaling: 17.42240049655902. Distance: 4.849070918179198
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.7370, Accuracy: 7803/10000 (78.0300%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 484.8989907702428, distance: 484.90707872746094
Total norm for 4 adversaries is: 484.8989907702428. distance: 484.90707872746094
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   1,  Average loss: 0.0122, Accuracy: 479/591 (81.0491%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   3,  Average loss: 0.0018, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   4,  Average loss: 0.0015, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   5,  Average loss: 0.0014, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   6,  Average loss: 0.0013, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   7,  Average loss: 0.0010, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   8,  Average loss: 0.0010, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   9,  Average loss: 0.0008, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch  10,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Global model norm: 16.820654497510176.
Norm before scaling: 17.36553829185884. Distance: 4.607592428752998
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.6428, Accuracy: 7906/10000 (79.0600%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0001, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 460.7838769423253, distance: 460.7592409545358
Total norm for 4 adversaries is: 460.7838769423253. distance: 460.7592409545358
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 24228249.2721, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   1,  Average loss: 0.0109, Accuracy: 488/568 (85.9155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   3,  Average loss: 0.0022, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   4,  Average loss: 0.0018, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   5,  Average loss: 0.0017, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   6,  Average loss: 0.0016, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   7,  Average loss: 0.0011, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   8,  Average loss: 0.0011, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   9,  Average loss: 0.0010, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch  10,  Average loss: 0.0010, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Global model norm: 16.820654497510176.
Norm before scaling: 17.09877757560692. Distance: 3.5162671668280816
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.6663, Accuracy: 7734/10000 (77.3400%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0297, Accuracy: 8861/8968 (98.8069%)
Scaling by  100
Scaled Norm after poisoning: 351.6123575757826, distance: 351.62672191188767
Total norm for 4 adversaries is: 351.6123575757826. distance: 351.62672191188767
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   1,  Average loss: 0.0123, Accuracy: 436/557 (78.2765%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   2,  Average loss: 0.0035, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   3,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   4,  Average loss: 0.0015, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   5,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   6,  Average loss: 0.0011, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   7,  Average loss: 0.0010, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   8,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch  10,  Average loss: 0.0008, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Global model norm: 16.820654497510176.
Norm before scaling: 17.272618599143687. Distance: 3.865279649929066
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.3340, Accuracy: 8932/10000 (89.3200%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0074, Accuracy: 8944/8968 (99.7324%)
Scaling by  100
Scaled Norm after poisoning: 386.9543133562411, distance: 386.52797440806273
Total norm for 4 adversaries is: 386.9543133562411. distance: 386.52797440806273
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  66, local model 49, internal_epoch   1,  Average loss: 0.0011, Accuracy: 492/506 (97.2332%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2513, Accuracy: 9323/10000 (93.2300%)
___Train Local_Simple,  epoch  66, local model 52, internal_epoch   1,  Average loss: 0.0014, Accuracy: 246/253 (97.2332%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1945, Accuracy: 9456/10000 (94.5600%)
___Train Local_Simple,  epoch  66, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 982/1005 (97.7114%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2048, Accuracy: 9355/10000 (93.5500%)
___Train Local_Simple,  epoch  66, local model 55, internal_epoch   1,  Average loss: 0.0020, Accuracy: 345/354 (97.4576%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2420, Accuracy: 9279/10000 (92.7900%)
___Train Local_Simple,  epoch  66, local model 83, internal_epoch   1,  Average loss: 0.0017, Accuracy: 421/433 (97.2286%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1096, Accuracy: 9671/10000 (96.7100%)
___Train Local_Simple,  epoch  66, local model 33, internal_epoch   1,  Average loss: 0.0025, Accuracy: 599/623 (96.1477%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2181, Accuracy: 9299/10000 (92.9900%)
time spent on training: 105.57424449920654
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.42248908296943233  data num: [606, 591, 568, 557, 506, 253, 1005, 354, 433, 623]
[foolsgold agg] considering poison per batch poison_fraction: 0.1320278384279476
[foolsgold agg] wv: [1.         1.         1.         1.         0.81421722 1.
 1.         1.         0.81421722 1.        ]
___Test Target_Simple poisoned: False, epoch: 66: Average loss: 0.0998, Accuracy: 9706/10000 (97.0600%)
___Test Target_Simple poisoned: True, epoch: 66: Average loss: 8.4780, Accuracy: 476/8968 (5.3078%)
Done in 126.3173131942749 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:67 choose agents : [41, 73, 51, 74, 25, 15, 1, 67, 86, 4]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   1,  Average loss: 0.0115, Accuracy: 503/606 (83.0033%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   2,  Average loss: 0.0028, Accuracy: 582/606 (96.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   3,  Average loss: 0.0020, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   4,  Average loss: 0.0017, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   5,  Average loss: 0.0013, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   6,  Average loss: 0.0010, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   7,  Average loss: 0.0010, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   8,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   9,  Average loss: 0.0009, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch  10,  Average loss: 0.0008, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Global model norm: 16.826020317258532.
Norm before scaling: 17.28965557613587. Distance: 4.317743182377206
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.7025, Accuracy: 7916/10000 (79.1600%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0001, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 431.77498841989444, distance: 431.7743370384581
Total norm for 4 adversaries is: 431.77498841989444. distance: 431.7743370384581
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 11828412.0321, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   1,  Average loss: 0.0125, Accuracy: 499/591 (84.4332%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   3,  Average loss: 0.0014, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   4,  Average loss: 0.0013, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   5,  Average loss: 0.0010, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   6,  Average loss: 0.0008, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   7,  Average loss: 0.0010, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   8,  Average loss: 0.0008, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   9,  Average loss: 0.0008, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch  10,  Average loss: 0.0008, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Global model norm: 16.826020317258532.
Norm before scaling: 17.20966433102978. Distance: 3.99566367660652
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.4867, Accuracy: 8425/10000 (84.2500%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0069, Accuracy: 8945/8968 (99.7435%)
Scaling by  100
Scaled Norm after poisoning: 399.55678570135683, distance: 399.5663665150009
Total norm for 4 adversaries is: 399.55678570135683. distance: 399.5663665150009
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 152969.2439, Accuracy: 5522/8968 (61.5745%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   1,  Average loss: 0.0086, Accuracy: 500/568 (88.0282%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   3,  Average loss: 0.0015, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   4,  Average loss: 0.0014, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   5,  Average loss: 0.0011, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   6,  Average loss: 0.0011, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   7,  Average loss: 0.0008, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   8,  Average loss: 0.0007, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   9,  Average loss: 0.0006, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch  10,  Average loss: 0.0006, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Global model norm: 16.826020317258532.
Norm before scaling: 17.06232740154232. Distance: 3.1760500035229184
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.5610, Accuracy: 8100/10000 (81.0000%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0249, Accuracy: 8897/8968 (99.2083%)
Scaling by  100
Scaled Norm after poisoning: 317.72334663980865, distance: 317.6050023220667
Total norm for 4 adversaries is: 317.72334663980865. distance: 317.6050023220667
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   1,  Average loss: 0.0096, Accuracy: 461/557 (82.7648%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   2,  Average loss: 0.0035, Accuracy: 519/557 (93.1777%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   3,  Average loss: 0.0016, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   4,  Average loss: 0.0011, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   5,  Average loss: 0.0014, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   6,  Average loss: 0.0012, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   7,  Average loss: 0.0010, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   8,  Average loss: 0.0008, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch  10,  Average loss: 0.0009, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Global model norm: 16.826020317258532.
Norm before scaling: 17.159896157401782. Distance: 3.3653314347309657
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.2913, Accuracy: 9101/10000 (91.0100%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0047, Accuracy: 8948/8968 (99.7770%)
Scaling by  100
Scaled Norm after poisoning: 336.95671550660626, distance: 336.5331405485944
Total norm for 4 adversaries is: 336.95671550660626. distance: 336.5331405485944
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  67, local model 25, internal_epoch   1,  Average loss: 0.0017, Accuracy: 624/647 (96.4451%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.7018, Accuracy: 7936/10000 (79.3600%)
___Train Local_Simple,  epoch  67, local model 15, internal_epoch   1,  Average loss: 0.0013, Accuracy: 388/401 (96.7581%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1512, Accuracy: 9534/10000 (95.3400%)
___Train Local_Simple,  epoch  67, local model 1, internal_epoch   1,  Average loss: 0.0027, Accuracy: 716/760 (94.2105%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1860, Accuracy: 9437/10000 (94.3700%)
___Train Local_Simple,  epoch  67, local model 67, internal_epoch   1,  Average loss: 0.0018, Accuracy: 963/998 (96.4930%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.3378, Accuracy: 8974/10000 (89.7400%)
___Train Local_Simple,  epoch  67, local model 86, internal_epoch   1,  Average loss: 0.0012, Accuracy: 244/250 (97.6000%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1273, Accuracy: 9625/10000 (96.2500%)
___Train Local_Simple,  epoch  67, local model 4, internal_epoch   1,  Average loss: 0.0014, Accuracy: 636/658 (96.6565%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.5357, Accuracy: 8648/10000 (86.4800%)
time spent on training: 105.06404995918274
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.38469184890656066  data num: [606, 591, 568, 557, 647, 401, 760, 998, 250, 658]
[foolsgold agg] considering poison per batch poison_fraction: 0.12021620278330021
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 67: Average loss: 0.0996, Accuracy: 9705/10000 (97.0500%)
___Test Target_Simple poisoned: True, epoch: 67: Average loss: 8.3780, Accuracy: 508/8968 (5.6646%)
Done in 125.98903179168701 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:68 choose agents : [41, 73, 51, 74, 83, 32, 48, 45, 93, 49]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   1,  Average loss: 0.0120, Accuracy: 492/606 (81.1881%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   2,  Average loss: 0.0024, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   3,  Average loss: 0.0013, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   4,  Average loss: 0.0012, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   5,  Average loss: 0.0011, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   6,  Average loss: 0.0007, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   7,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   8,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch  10,  Average loss: 0.0007, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Global model norm: 16.831339097946966.
Norm before scaling: 17.264037681559678. Distance: 4.198552817836183
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.5685, Accuracy: 8281/10000 (82.8100%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0054, Accuracy: 8948/8968 (99.7770%)
Scaling by  100
Scaled Norm after poisoning: 419.8502709300067, distance: 419.85525779725566
Total norm for 4 adversaries is: 419.8502709300067. distance: 419.85525779725566
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 4324193.7319, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   1,  Average loss: 0.0099, Accuracy: 508/591 (85.9560%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   2,  Average loss: 0.0023, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   3,  Average loss: 0.0015, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   4,  Average loss: 0.0013, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   5,  Average loss: 0.0010, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   6,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   7,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   8,  Average loss: 0.0007, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   9,  Average loss: 0.0007, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch  10,  Average loss: 0.0006, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Global model norm: 16.831339097946966.
Norm before scaling: 17.25880804337672. Distance: 4.117230351784233
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.5551, Accuracy: 8116/10000 (81.1600%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0004, Accuracy: 8966/8968 (99.9777%)
Scaling by  100
Scaled Norm after poisoning: 411.77815629292434, distance: 411.7230561919019
Total norm for 4 adversaries is: 411.77815629292434. distance: 411.7230561919019
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 1778738.1236, Accuracy: 5271/8968 (58.7756%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   1,  Average loss: 0.0094, Accuracy: 492/568 (86.6197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   2,  Average loss: 0.0020, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   3,  Average loss: 0.0015, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   4,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   5,  Average loss: 0.0010, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   6,  Average loss: 0.0009, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   7,  Average loss: 0.0007, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   8,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   9,  Average loss: 0.0006, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch  10,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Global model norm: 16.831339097946966.
Norm before scaling: 17.07092926517366. Distance: 3.078730799514057
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.4757, Accuracy: 8384/10000 (83.8400%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0418, Accuracy: 8832/8968 (98.4835%)
Scaling by  100
Scaled Norm after poisoning: 308.1128547302108, distance: 307.8731095151053
Total norm for 4 adversaries is: 308.1128547302108. distance: 307.8731095151053
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   1,  Average loss: 0.0094, Accuracy: 476/557 (85.4578%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   3,  Average loss: 0.0015, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   4,  Average loss: 0.0013, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   5,  Average loss: 0.0011, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   6,  Average loss: 0.0011, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   7,  Average loss: 0.0009, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   8,  Average loss: 0.0008, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   9,  Average loss: 0.0008, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch  10,  Average loss: 0.0008, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Global model norm: 16.831339097946966.
Norm before scaling: 17.08958169441939. Distance: 3.169755199137772
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.3942, Accuracy: 8725/10000 (87.2500%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0035, Accuracy: 8954/8968 (99.8439%)
Scaling by  100
Scaled Norm after poisoning: 317.2192040805537, distance: 316.9755387841466
Total norm for 4 adversaries is: 317.2192040805537. distance: 316.9755387841466
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  68, local model 83, internal_epoch   1,  Average loss: 0.0021, Accuracy: 417/433 (96.3048%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1175, Accuracy: 9635/10000 (96.3500%)
___Train Local_Simple,  epoch  68, local model 32, internal_epoch   1,  Average loss: 0.0023, Accuracy: 939/977 (96.1105%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.4460, Accuracy: 8670/10000 (86.7000%)
___Train Local_Simple,  epoch  68, local model 48, internal_epoch   1,  Average loss: 0.0008, Accuracy: 440/448 (98.2143%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1371, Accuracy: 9658/10000 (96.5800%)
___Train Local_Simple,  epoch  68, local model 45, internal_epoch   1,  Average loss: 0.0016, Accuracy: 606/628 (96.4968%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2136, Accuracy: 9377/10000 (93.7700%)
___Train Local_Simple,  epoch  68, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 616/623 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2443, Accuracy: 9299/10000 (92.9900%)
___Train Local_Simple,  epoch  68, local model 49, internal_epoch   1,  Average loss: 0.0010, Accuracy: 496/506 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2428, Accuracy: 9313/10000 (93.1300%)
time spent on training: 106.26280450820923
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3911066195048004  data num: [606, 591, 568, 557, 433, 977, 448, 628, 623, 506]
[foolsgold agg] considering poison per batch poison_fraction: 0.12222081859525014
[foolsgold agg] wv: [1.         1.         1.         1.         0.94594756 1.
 1.         1.         1.         0.94594756]
___Test Target_Simple poisoned: False, epoch: 68: Average loss: 0.1004, Accuracy: 9705/10000 (97.0500%)
___Test Target_Simple poisoned: True, epoch: 68: Average loss: 8.2521, Accuracy: 549/8968 (6.1218%)
Done in 126.93272852897644 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:69 choose agents : [41, 73, 51, 74, 72, 81, 27, 30, 33, 42]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   1,  Average loss: 0.0117, Accuracy: 498/606 (82.1782%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   2,  Average loss: 0.0025, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   3,  Average loss: 0.0015, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   4,  Average loss: 0.0011, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   5,  Average loss: 0.0012, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   6,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   7,  Average loss: 0.0008, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   8,  Average loss: 0.0007, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch  10,  Average loss: 0.0008, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Global model norm: 16.83650937978841.
Norm before scaling: 17.267538249480314. Distance: 4.257535648969494
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.5062, Accuracy: 8444/10000 (84.4400%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0112, Accuracy: 8926/8968 (99.5317%)
Scaling by  100
Scaled Norm after poisoning: 425.68402674401585, distance: 425.7535415296037
Total norm for 4 adversaries is: 425.68402674401585. distance: 425.7535415296037
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 9710064.7850, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   1,  Average loss: 0.0128, Accuracy: 485/591 (82.0643%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   3,  Average loss: 0.0020, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   4,  Average loss: 0.0017, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   5,  Average loss: 0.0019, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   6,  Average loss: 0.0014, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   7,  Average loss: 0.0014, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   8,  Average loss: 0.0013, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   9,  Average loss: 0.0010, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch  10,  Average loss: 0.0010, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Global model norm: 16.83650937978841.
Norm before scaling: 17.533255232913824. Distance: 5.097463740079069
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.6041, Accuracy: 8197/10000 (81.9700%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0015, Accuracy: 8965/8968 (99.9665%)
Scaling by  100
Scaled Norm after poisoning: 509.8246021917734, distance: 509.74638301806516
Total norm for 4 adversaries is: 509.8246021917734. distance: 509.74638301806516
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 1880287.8662, Accuracy: 1599/8968 (17.8301%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   1,  Average loss: 0.0081, Accuracy: 512/568 (90.1408%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   2,  Average loss: 0.0017, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   3,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   4,  Average loss: 0.0012, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   5,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   6,  Average loss: 0.0011, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   7,  Average loss: 0.0008, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   8,  Average loss: 0.0009, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   9,  Average loss: 0.0009, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch  10,  Average loss: 0.0009, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Global model norm: 16.83650937978841.
Norm before scaling: 17.04043437851846. Distance: 3.0592105871955075
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.5962, Accuracy: 8020/10000 (80.2000%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0398, Accuracy: 8823/8968 (98.3831%)
Scaling by  100
Scaled Norm after poisoning: 305.9838511874442, distance: 305.9210733587995
Total norm for 4 adversaries is: 305.9838511874442. distance: 305.9210733587995
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.3302, Accuracy: 8964/8968 (99.9554%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   1,  Average loss: 0.0086, Accuracy: 485/557 (87.0736%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   2,  Average loss: 0.0031, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   3,  Average loss: 0.0019, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   4,  Average loss: 0.0016, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   5,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   6,  Average loss: 0.0011, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   7,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch  10,  Average loss: 0.0009, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Global model norm: 16.83650937978841.
Norm before scaling: 17.047063866678315. Distance: 2.931475853911792
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.3729, Accuracy: 8780/10000 (87.8000%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0098, Accuracy: 8933/8968 (99.6097%)
Scaling by  100
Scaled Norm after poisoning: 293.3821100544476, distance: 293.14760040805385
Total norm for 4 adversaries is: 293.3821100544476. distance: 293.14760040805385
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 7631541.5464, Accuracy: 1/8968 (0.0112%)
___Train Local_Simple,  epoch  69, local model 72, internal_epoch   1,  Average loss: 0.0011, Accuracy: 720/731 (98.4952%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2381, Accuracy: 9279/10000 (92.7900%)
___Train Local_Simple,  epoch  69, local model 81, internal_epoch   1,  Average loss: 0.0012, Accuracy: 1197/1227 (97.5550%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2908, Accuracy: 9100/10000 (91.0000%)
___Train Local_Simple,  epoch  69, local model 27, internal_epoch   1,  Average loss: 0.0018, Accuracy: 456/471 (96.8153%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2190, Accuracy: 9354/10000 (93.5400%)
___Train Local_Simple,  epoch  69, local model 30, internal_epoch   1,  Average loss: 0.0016, Accuracy: 387/400 (96.7500%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2560, Accuracy: 9295/10000 (92.9500%)
___Train Local_Simple,  epoch  69, local model 33, internal_epoch   1,  Average loss: 0.0021, Accuracy: 596/623 (95.6661%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1533, Accuracy: 9482/10000 (94.8200%)
___Train Local_Simple,  epoch  69, local model 42, internal_epoch   1,  Average loss: 0.0017, Accuracy: 230/236 (97.4576%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1464, Accuracy: 9558/10000 (95.5800%)
time spent on training: 105.09001779556274
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3863560732113145  data num: [606, 591, 568, 557, 731, 1227, 471, 400, 623, 236]
[foolsgold agg] considering poison per batch poison_fraction: 0.12073627287853578
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 69: Average loss: 0.1004, Accuracy: 9705/10000 (97.0500%)
___Test Target_Simple poisoned: True, epoch: 69: Average loss: 8.1670, Accuracy: 577/8968 (6.4340%)
Done in 125.79975605010986 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:70 choose agents : [41, 73, 51, 74, 5, 54, 88, 44, 64, 18]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   1,  Average loss: 0.0103, Accuracy: 518/606 (85.4785%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   2,  Average loss: 0.0022, Accuracy: 581/606 (95.8746%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   3,  Average loss: 0.0015, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   4,  Average loss: 0.0013, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   5,  Average loss: 0.0009, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   6,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   7,  Average loss: 0.0007, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   8,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch  10,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Global model norm: 16.841621901452495.
Norm before scaling: 17.20542300585914. Distance: 3.8900522323671227
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.5594, Accuracy: 8259/10000 (82.5900%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0007, Accuracy: 8966/8968 (99.9777%)
Scaling by  100
Scaled Norm after poisoning: 389.0168296487955, distance: 389.00522168731874
Total norm for 4 adversaries is: 389.0168296487955. distance: 389.00522168731874
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 6385654.8724, Accuracy: 324/8968 (3.6128%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   1,  Average loss: 0.0133, Accuracy: 490/591 (82.9103%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   2,  Average loss: 0.0030, Accuracy: 564/591 (95.4315%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   3,  Average loss: 0.0025, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   4,  Average loss: 0.0019, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   5,  Average loss: 0.0016, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   6,  Average loss: 0.0012, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   7,  Average loss: 0.0010, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   8,  Average loss: 0.0009, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   9,  Average loss: 0.0011, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch  10,  Average loss: 0.0008, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Global model norm: 16.841621901452495.
Norm before scaling: 17.592881826659237. Distance: 5.314571380701485
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.6341, Accuracy: 8127/10000 (81.2700%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 531.5004703666781, distance: 531.4571360890735
Total norm for 4 adversaries is: 531.5004703666781. distance: 531.4571360890735
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 20229398.6655, Accuracy: 1252/8968 (13.9607%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   1,  Average loss: 0.0086, Accuracy: 502/568 (88.3803%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   2,  Average loss: 0.0019, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   3,  Average loss: 0.0012, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   4,  Average loss: 0.0010, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   5,  Average loss: 0.0009, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   6,  Average loss: 0.0008, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   7,  Average loss: 0.0006, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   8,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   9,  Average loss: 0.0005, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch  10,  Average loss: 0.0005, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Global model norm: 16.841621901452495.
Norm before scaling: 17.125545298115693. Distance: 3.1758868022799547
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.5189, Accuracy: 8247/10000 (82.4700%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0293, Accuracy: 8882/8968 (99.0410%)
Scaling by  100
Scaled Norm after poisoning: 317.96540692345764, distance: 317.58868102075047
Total norm for 4 adversaries is: 317.96540692345764. distance: 317.58868102075047
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   1,  Average loss: 0.0105, Accuracy: 467/557 (83.8420%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   2,  Average loss: 0.0036, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   3,  Average loss: 0.0019, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   4,  Average loss: 0.0014, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   5,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   6,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   7,  Average loss: 0.0010, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   8,  Average loss: 0.0008, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   9,  Average loss: 0.0010, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch  10,  Average loss: 0.0008, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Global model norm: 16.841621901452495.
Norm before scaling: 17.1185959028068. Distance: 3.3135365717653937
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.3100, Accuracy: 9043/10000 (90.4300%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0149, Accuracy: 8917/8968 (99.4313%)
Scaling by  100
Scaled Norm after poisoning: 331.5441971856844, distance: 331.35367481363477
Total norm for 4 adversaries is: 331.5441971856844. distance: 331.35367481363477
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 68.8951, Accuracy: 8960/8968 (99.9108%)
___Train Local_Simple,  epoch  70, local model 5, internal_epoch   1,  Average loss: 0.0019, Accuracy: 424/434 (97.6959%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2979, Accuracy: 8969/10000 (89.6900%)
___Train Local_Simple,  epoch  70, local model 54, internal_epoch   1,  Average loss: 0.0019, Accuracy: 495/519 (95.3757%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.3393, Accuracy: 8889/10000 (88.8900%)
___Train Local_Simple,  epoch  70, local model 88, internal_epoch   1,  Average loss: 0.0015, Accuracy: 518/530 (97.7358%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1812, Accuracy: 9476/10000 (94.7600%)
___Train Local_Simple,  epoch  70, local model 44, internal_epoch   1,  Average loss: 0.0020, Accuracy: 499/517 (96.5184%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2512, Accuracy: 9226/10000 (92.2600%)
___Train Local_Simple,  epoch  70, local model 64, internal_epoch   1,  Average loss: 0.0020, Accuracy: 786/813 (96.6790%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1880, Accuracy: 9385/10000 (93.8500%)
___Train Local_Simple,  epoch  70, local model 18, internal_epoch   1,  Average loss: 0.0027, Accuracy: 442/459 (96.2963%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2929, Accuracy: 9042/10000 (90.4200%)
time spent on training: 105.2062816619873
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41508759385055416  data num: [606, 591, 568, 557, 434, 519, 530, 517, 813, 459]
[foolsgold agg] considering poison per batch poison_fraction: 0.12971487307829818
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 70: Average loss: 0.1007, Accuracy: 9703/10000 (97.0300%)
___Test Target_Simple poisoned: True, epoch: 70: Average loss: 8.0346, Accuracy: 615/8968 (6.8577%)
Done in 126.6504967212677 sec.
Saving all the graphs.
This run has a label: Nov.13_09.44.56. Visdom environment: mnist_DBA
