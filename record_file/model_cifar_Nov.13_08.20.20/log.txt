current path: saved_models/model_cifar_Nov.13_08.20.20
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 201
create model done
Poisoned following participants: [17, 33, 77, 11]
We use following environment for graphs:  cifar
----------------------------------Start one training epoch------------------------------------------
Server Epoch:201 choose agents : [37, 53, 39, 11, 57, 63, 48, 50, 72, 88]. Adversary List: []
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   1,  Average loss: 0.0088, Accuracy: 600/725 (82.7586%)
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   2,  Average loss: 0.0159, Accuracy: 526/725 (72.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 45.4016, Accuracy: 1570/10000 (15.7000%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   1,  Average loss: 0.0048, Accuracy: 563/625 (90.0800%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   2,  Average loss: 0.0036, Accuracy: 580/625 (92.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.7248, Accuracy: 2870/10000 (28.7000%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   1,  Average loss: 0.0081, Accuracy: 182/217 (83.8710%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   2,  Average loss: 0.0008, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.2919, Accuracy: 3032/10000 (30.3200%)
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 201, local model 11, internal_epoch   1,  Average loss: 0.0036, Accuracy: 508/546 (93.0403%)
___Train Local_ResNet_18,  epoch 201, local model 11, internal_epoch   2,  Average loss: 0.0023, Accuracy: 519/546 (95.0549%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.0673, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   1,  Average loss: 0.0064, Accuracy: 251/290 (86.5517%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   2,  Average loss: 0.0012, Accuracy: 285/290 (98.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 3.9040, Accuracy: 3808/10000 (38.0800%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   1,  Average loss: 0.0030, Accuracy: 703/752 (93.4840%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   2,  Average loss: 0.0028, Accuracy: 713/752 (94.8138%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.2500, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   1,  Average loss: 0.0063, Accuracy: 327/378 (86.5079%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   2,  Average loss: 0.0024, Accuracy: 358/378 (94.7090%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 3.0837, Accuracy: 4039/10000 (40.3900%)
___Train Local_ResNet_18,  epoch 201, local model 50, internal_epoch   1,  Average loss: 0.0027, Accuracy: 384/401 (95.7606%)
___Train Local_ResNet_18,  epoch 201, local model 50, internal_epoch   2,  Average loss: 0.0022, Accuracy: 391/401 (97.5062%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 3.6356, Accuracy: 3805/10000 (38.0500%)
___Train Local_ResNet_18,  epoch 201, local model 72, internal_epoch   1,  Average loss: 0.0081, Accuracy: 527/618 (85.2751%)
___Train Local_ResNet_18,  epoch 201, local model 72, internal_epoch   2,  Average loss: 0.0083, Accuracy: 544/618 (88.0259%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 9.2191, Accuracy: 3037/10000 (30.3700%)
___Train Local_ResNet_18,  epoch 201, local model 88, internal_epoch   1,  Average loss: 0.0086, Accuracy: 372/447 (83.2215%)
___Train Local_ResNet_18,  epoch 201, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 403/447 (90.1566%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.4093, Accuracy: 3019/10000 (30.1900%)
time spent on training: 90.71675729751587
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10922184436887378  data num: [725, 625, 217, 546, 290, 752, 378, 401, 618, 447]
[rfa agg] considering poison per batch poison_fraction: 0.008532956591318263
[rfa agg] init. name: [37, 53, 39, 11, 57, 63, 48, 50, 72, 88], weight: tensor([0.1450, 0.1250, 0.0434, 0.1092, 0.0580, 0.1504, 0.0756, 0.0802, 0.1236,
        0.0894])
[rfa agg] iter:  0, prev_obj_val: 29.953014373779297, obj_val: 35.78252410888672, abs dis: 5.829509735107422
[rfa agg] iter:  0, weight: tensor([0.0546, 0.0746, 0.0366, 0.0898, 0.0761, 0.0588, 0.1732, 0.1963, 0.0713,
        0.1688])
[rfa agg] iter:  1, prev_obj_val: 35.78252410888672, obj_val: 39.268798828125, abs dis: 3.4862747192382812
[rfa agg] iter:  1, weight: tensor([0.0514, 0.0651, 0.0645, 0.0730, 0.1708, 0.0551, 0.2153, 0.1194, 0.0628,
        0.1228])
[rfa agg] iter:  2, prev_obj_val: 39.268798828125, obj_val: 39.25788879394531, abs dis: 0.0109100341796875
[rfa agg] iter:  2, weight: tensor([0.0503, 0.0617, 0.0945, 0.0674, 0.2532, 0.0537, 0.1611, 0.0964, 0.0598,
        0.1019])
[rfa agg] iter:  3, prev_obj_val: 39.25788879394531, obj_val: 39.25730895996094, abs dis: 0.000579833984375
[rfa agg] iter:  3, weight: tensor([0.0490, 0.0601, 0.0928, 0.0656, 0.2757, 0.0523, 0.1539, 0.0937, 0.0582,
        0.0988])
[rfa agg] iter:  4, prev_obj_val: 39.25730895996094, obj_val: 39.257266998291016, abs dis: 4.1961669921875e-05
[rfa agg] iter:  4, weight: tensor([0.0486, 0.0596, 0.0920, 0.0650, 0.2821, 0.0519, 0.1523, 0.0929, 0.0577,
        0.0979])
___Test Target_ResNet_18 poisoned: False, epoch: 201: Average loss: 0.7030, Accuracy: 7700/10000 (77.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 201: Average loss: 6.3648, Accuracy: 254/9000 (2.8222%)
Done in 215.58271956443787 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:202 choose agents : [71, 92, 23, 26, 50, 14, 76, 49, 86, 58]. Adversary List: []
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 1053/1166 (90.3087%)
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   2,  Average loss: 0.0110, Accuracy: 923/1166 (79.1595%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 24.4727, Accuracy: 1546/10000 (15.4600%)
___Train Local_ResNet_18,  epoch 202, local model 92, internal_epoch   1,  Average loss: 0.0076, Accuracy: 691/796 (86.8090%)
___Train Local_ResNet_18,  epoch 202, local model 92, internal_epoch   2,  Average loss: 0.0078, Accuracy: 666/796 (83.6683%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 6.3415, Accuracy: 2454/10000 (24.5400%)
___Train Local_ResNet_18,  epoch 202, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 221/248 (89.1129%)
___Train Local_ResNet_18,  epoch 202, local model 23, internal_epoch   2,  Average loss: 0.0012, Accuracy: 242/248 (97.5806%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 3.2984, Accuracy: 3559/10000 (35.5900%)
___Train Local_ResNet_18,  epoch 202, local model 26, internal_epoch   1,  Average loss: 0.0050, Accuracy: 426/468 (91.0256%)
___Train Local_ResNet_18,  epoch 202, local model 26, internal_epoch   2,  Average loss: 0.0066, Accuracy: 415/468 (88.6752%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 3.2486, Accuracy: 3855/10000 (38.5500%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   1,  Average loss: 0.0020, Accuracy: 388/401 (96.7581%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   2,  Average loss: 0.0009, Accuracy: 396/401 (98.7531%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.5269, Accuracy: 4888/10000 (48.8800%)
___Train Local_ResNet_18,  epoch 202, local model 14, internal_epoch   1,  Average loss: 0.0082, Accuracy: 264/318 (83.0189%)
___Train Local_ResNet_18,  epoch 202, local model 14, internal_epoch   2,  Average loss: 0.0023, Accuracy: 302/318 (94.9686%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 8.5905, Accuracy: 2043/10000 (20.4300%)
___Train Local_ResNet_18,  epoch 202, local model 76, internal_epoch   1,  Average loss: 0.0428, Accuracy: 59/65 (90.7692%)
___Train Local_ResNet_18,  epoch 202, local model 76, internal_epoch   2,  Average loss: 0.0026, Accuracy: 65/65 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.0782, Accuracy: 4594/10000 (45.9400%)
___Train Local_ResNet_18,  epoch 202, local model 49, internal_epoch   1,  Average loss: 0.0038, Accuracy: 395/426 (92.7230%)
___Train Local_ResNet_18,  epoch 202, local model 49, internal_epoch   2,  Average loss: 0.0016, Accuracy: 412/426 (96.7136%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.9247, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch 202, local model 86, internal_epoch   1,  Average loss: 0.0056, Accuracy: 190/212 (89.6226%)
___Train Local_ResNet_18,  epoch 202, local model 86, internal_epoch   2,  Average loss: 0.0020, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.5037, Accuracy: 6034/10000 (60.3400%)
___Train Local_ResNet_18,  epoch 202, local model 58, internal_epoch   1,  Average loss: 0.0094, Accuracy: 197/234 (84.1880%)
___Train Local_ResNet_18,  epoch 202, local model 58, internal_epoch   2,  Average loss: 0.0006, Accuracy: 233/234 (99.5726%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 7.5092, Accuracy: 1673/10000 (16.7300%)
time spent on training: 93.33070707321167
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [1166, 796, 248, 468, 401, 318, 65, 426, 212, 234]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [71, 92, 23, 26, 50, 14, 76, 49, 86, 58], weight: tensor([0.2690, 0.1837, 0.0572, 0.1080, 0.0925, 0.0734, 0.0150, 0.0983, 0.0489,
        0.0540])
[rfa agg] iter:  0, prev_obj_val: 47.47019577026367, obj_val: 48.374820709228516, abs dis: 0.9046249389648438
[rfa agg] iter:  0, weight: tensor([0.0809, 0.1237, 0.0400, 0.2616, 0.1710, 0.0647, 0.0073, 0.1788, 0.0342,
        0.0377])
[rfa agg] iter:  1, prev_obj_val: 48.374820709228516, obj_val: 54.17638397216797, abs dis: 5.801563262939453
[rfa agg] iter:  1, weight: tensor([0.0427, 0.0573, 0.0361, 0.1560, 0.2910, 0.0662, 0.0058, 0.2803, 0.0308,
        0.0340])
[rfa agg] iter:  2, prev_obj_val: 54.17638397216797, obj_val: 59.28739929199219, abs dis: 5.111015319824219
[rfa agg] iter:  2, weight: tensor([0.0502, 0.0610, 0.0911, 0.1025, 0.1499, 0.2142, 0.0108, 0.1572, 0.0774,
        0.0857])
[rfa agg] iter:  3, prev_obj_val: 59.28739929199219, obj_val: 56.528987884521484, abs dis: 2.758411407470703
[rfa agg] iter:  3, weight: tensor([0.0394, 0.0456, 0.1725, 0.0635, 0.0777, 0.2045, 0.0127, 0.0820, 0.1408,
        0.1613])
[rfa agg] iter:  4, prev_obj_val: 56.528987884521484, obj_val: 66.31355285644531, abs dis: 9.784564971923828
[rfa agg] iter:  4, weight: tensor([0.0427, 0.0506, 0.1175, 0.0763, 0.1004, 0.2875, 0.0111, 0.1053, 0.0982,
        0.1104])
[rfa agg] iter:  5, prev_obj_val: 66.31355285644531, obj_val: 70.44515991210938, abs dis: 4.1316070556640625
[rfa agg] iter:  5, weight: tensor([0.0437, 0.0485, 0.2074, 0.0594, 0.0664, 0.1175, 0.0245, 0.0703, 0.1681,
        0.1944])
[rfa agg] iter:  6, prev_obj_val: 70.44515991210938, obj_val: 56.548583984375, abs dis: 13.896575927734375
[rfa agg] iter:  6, weight: tensor([0.0559, 0.0608, 0.1767, 0.0709, 0.0769, 0.1174, 0.0466, 0.0814, 0.1476,
        0.1657])
[rfa agg] iter:  7, prev_obj_val: 56.548583984375, obj_val: 66.30789947509766, abs dis: 9.759315490722656
[rfa agg] iter:  7, weight: tensor([0.0441, 0.0522, 0.1211, 0.0787, 0.1035, 0.2655, 0.0115, 0.1086, 0.1013,
        0.1136])
[rfa agg] iter:  8, prev_obj_val: 66.30789947509766, obj_val: 70.44522094726562, abs dis: 4.137321472167969
[rfa agg] iter:  8, weight: tensor([0.0436, 0.0484, 0.2079, 0.0593, 0.0663, 0.1169, 0.0244, 0.0701, 0.1685,
        0.1946])
[rfa agg] iter:  9, prev_obj_val: 70.44522094726562, obj_val: 56.54859161376953, abs dis: 13.896629333496094
[rfa agg] iter:  9, weight: tensor([0.0559, 0.0608, 0.1767, 0.0709, 0.0769, 0.1173, 0.0466, 0.0814, 0.1476,
        0.1657])
___Test Target_ResNet_18 poisoned: False, epoch: 202: Average loss: 0.6828, Accuracy: 7736/10000 (77.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 202: Average loss: 6.2022, Accuracy: 303/9000 (3.3667%)
Done in 218.75824356079102 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:203 choose agents : [17, 6, 94, 61, 33, 71, 8, 69, 89, 64]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   1,  Average loss: 0.0089, Accuracy: 472/526 (89.7338%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   2,  Average loss: 0.0060, Accuracy: 490/526 (93.1559%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   3,  Average loss: 0.0030, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   4,  Average loss: 0.0024, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   5,  Average loss: 0.0021, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   6,  Average loss: 0.0010, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 37.65011620167991.
Norm before scaling: 38.32271032890452. Distance: 8.62793980129925
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.7248, Accuracy: 4999/10000 (49.9900%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.1222, Accuracy: 8772/9000 (97.4667%)
Scaling by  100
Scaled Norm after poisoning: 862.2627209847356, distance: 862.7940440800458
Total norm for 2 adversaries is: 862.2627209847356. distance: 862.7940440800458
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 203, local model 6, internal_epoch   1,  Average loss: 0.0028, Accuracy: 491/520 (94.4231%)
___Train Local_ResNet_18,  epoch 203, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 494/520 (95.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.5159, Accuracy: 4761/10000 (47.6100%)
___Train Local_ResNet_18,  epoch 203, local model 94, internal_epoch   1,  Average loss: 0.0075, Accuracy: 172/203 (84.7291%)
___Train Local_ResNet_18,  epoch 203, local model 94, internal_epoch   2,  Average loss: 0.0048, Accuracy: 191/203 (94.0887%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 4.6851, Accuracy: 2615/10000 (26.1500%)
___Train Local_ResNet_18,  epoch 203, local model 61, internal_epoch   1,  Average loss: 0.0039, Accuracy: 553/590 (93.7288%)
___Train Local_ResNet_18,  epoch 203, local model 61, internal_epoch   2,  Average loss: 0.0063, Accuracy: 528/590 (89.4915%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 5.7084, Accuracy: 2502/10000 (25.0200%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 203, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 480/527 (91.0816%)
___Train Local_ResNet_18,  epoch 203, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 472/527 (89.5636%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 3.5333, Accuracy: 3522/10000 (35.2200%)
___Train Local_ResNet_18,  epoch 203, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 1080/1166 (92.6244%)
___Train Local_ResNet_18,  epoch 203, local model 71, internal_epoch   2,  Average loss: 0.0067, Accuracy: 1021/1166 (87.5643%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 4.7028, Accuracy: 3539/10000 (35.3900%)
___Train Local_ResNet_18,  epoch 203, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 505/534 (94.5693%)
___Train Local_ResNet_18,  epoch 203, local model 8, internal_epoch   2,  Average loss: 0.0042, Accuracy: 495/534 (92.6966%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.2171, Accuracy: 4584/10000 (45.8400%)
___Train Local_ResNet_18,  epoch 203, local model 69, internal_epoch   1,  Average loss: 0.0074, Accuracy: 184/216 (85.1852%)
___Train Local_ResNet_18,  epoch 203, local model 69, internal_epoch   2,  Average loss: 0.0005, Accuracy: 215/216 (99.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 8.8415, Accuracy: 1255/10000 (12.5500%)
___Train Local_ResNet_18,  epoch 203, local model 89, internal_epoch   1,  Average loss: 0.0075, Accuracy: 353/413 (85.4722%)
___Train Local_ResNet_18,  epoch 203, local model 89, internal_epoch   2,  Average loss: 0.0027, Accuracy: 392/413 (94.9153%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 6.8400, Accuracy: 2085/10000 (20.8500%)
___Train Local_ResNet_18,  epoch 203, local model 64, internal_epoch   1,  Average loss: 0.0046, Accuracy: 615/686 (89.6501%)
___Train Local_ResNet_18,  epoch 203, local model 64, internal_epoch   2,  Average loss: 0.0057, Accuracy: 618/686 (90.0875%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 3.1798, Accuracy: 4213/10000 (42.1300%)
time spent on training: 188.9421796798706
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.19568853372979  data num: [526, 520, 203, 590, 527, 1166, 534, 216, 413, 686]
[rfa agg] considering poison per batch poison_fraction: 0.015288166697639844
[rfa agg] init. name: [17, 6, 94, 61, 33, 71, 8, 69, 89, 64], weight: tensor([0.0978, 0.0966, 0.0377, 0.1096, 0.0979, 0.2167, 0.0992, 0.0401, 0.0768,
        0.1275])
[rfa agg] iter:  0, prev_obj_val: 4227.2841796875, obj_val: 2556.7255859375, abs dis: 1670.55859375
[rfa agg] iter:  0, weight: tensor([0.0115, 0.1050, 0.0402, 0.1195, 0.1064, 0.2446, 0.1078, 0.0428, 0.0827,
        0.1395])
[rfa agg] iter:  1, prev_obj_val: 2556.7255859375, obj_val: 2390.159423828125, abs dis: 166.566162109375
[rfa agg] iter:  1, weight: tensor([0.0011, 0.0961, 0.0323, 0.1127, 0.0974, 0.3199, 0.0987, 0.0343, 0.0717,
        0.1357])
[rfa agg] iter:  2, prev_obj_val: 2390.159423828125, obj_val: 2385.759765625, abs dis: 4.399658203125
[rfa agg] iter:  2, weight: tensor([1.6782e-04, 1.0864e-01, 1.9272e-02, 1.5598e-01, 1.0884e-01, 1.6371e-01,
        1.1118e-01, 2.0517e-02, 5.8157e-02, 2.5354e-01])
[rfa agg] iter:  3, prev_obj_val: 2385.759765625, obj_val: 2396.212158203125, abs dis: 10.452392578125
[rfa agg] iter:  3, weight: tensor([7.0028e-05, 2.2094e-01, 1.4402e-02, 1.4055e-01, 1.7994e-01, 4.1384e-02,
        2.1041e-01, 1.5353e-02, 6.6205e-02, 1.1074e-01])
[rfa agg] iter:  4, prev_obj_val: 2396.212158203125, obj_val: 2393.009765625, abs dis: 3.202392578125
[rfa agg] iter:  4, weight: tensor([1.1151e-04, 1.4015e-01, 3.7724e-02, 1.0545e-01, 1.3650e-01, 5.5012e-02,
        1.4237e-01, 4.0307e-02, 2.4809e-01, 9.4304e-02])
[rfa agg] iter:  5, prev_obj_val: 2393.009765625, obj_val: 2396.14306640625, abs dis: 3.13330078125
[rfa agg] iter:  5, weight: tensor([9.8093e-05, 1.5528e-01, 2.8668e-02, 1.0781e-01, 1.4816e-01, 5.0463e-02,
        1.5682e-01, 3.0575e-02, 2.2847e-01, 9.3665e-02])
[rfa agg] iter:  6, prev_obj_val: 2396.14306640625, obj_val: 2399.53759765625, abs dis: 3.39453125
[rfa agg] iter:  6, weight: tensor([1.0610e-04, 1.3234e-01, 3.5960e-02, 9.9917e-02, 1.2916e-01, 5.2356e-02,
        1.3453e-01, 3.8388e-02, 2.8757e-01, 8.9667e-02])
[rfa agg] iter:  7, prev_obj_val: 2399.53759765625, obj_val: 2396.134765625, abs dis: 3.40283203125
[rfa agg] iter:  7, weight: tensor([1.1955e-04, 1.2171e-01, 4.8157e-02, 9.8057e-02, 1.2016e-01, 5.6681e-02,
        1.2411e-01, 5.1455e-02, 2.8905e-01, 9.0502e-02])
[rfa agg] iter:  8, prev_obj_val: 2396.134765625, obj_val: 2399.537353515625, abs dis: 3.402587890625
[rfa agg] iter:  8, weight: tensor([1.0358e-04, 1.2852e-01, 3.5123e-02, 9.7368e-02, 1.2525e-01, 5.1113e-02,
        1.3057e-01, 3.7480e-02, 3.0697e-01, 8.7506e-02])
[rfa agg] iter:  9, prev_obj_val: 2399.537353515625, obj_val: 2396.134765625, abs dis: 3.402587890625
[rfa agg] iter:  9, weight: tensor([1.1896e-04, 1.2102e-01, 4.7901e-02, 9.7526e-02, 1.1945e-01, 5.6399e-02,
        1.2340e-01, 5.1176e-02, 2.9298e-01, 9.0033e-02])
___Test Target_ResNet_18 poisoned: False, epoch: 203: Average loss: 0.6595, Accuracy: 7806/10000 (78.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 203: Average loss: 5.9264, Accuracy: 381/9000 (4.2333%)
Done in 309.39900493621826 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:204 choose agents : [38, 77, 64, 29, 23, 83, 43, 56, 45, 1]. Adversary List: []
___Train Local_ResNet_18,  epoch 204, local model 38, internal_epoch   1,  Average loss: 0.0037, Accuracy: 709/756 (93.7831%)
___Train Local_ResNet_18,  epoch 204, local model 38, internal_epoch   2,  Average loss: 0.0040, Accuracy: 692/756 (91.5344%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 3.3882, Accuracy: 4322/10000 (43.2200%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 204, local model 77, internal_epoch   1,  Average loss: 0.0028, Accuracy: 468/496 (94.3548%)
___Train Local_ResNet_18,  epoch 204, local model 77, internal_epoch   2,  Average loss: 0.0018, Accuracy: 477/496 (96.1694%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.1783, Accuracy: 6323/10000 (63.2300%)
___Train Local_ResNet_18,  epoch 204, local model 64, internal_epoch   1,  Average loss: 0.0030, Accuracy: 647/686 (94.3149%)
___Train Local_ResNet_18,  epoch 204, local model 64, internal_epoch   2,  Average loss: 0.0036, Accuracy: 634/686 (92.4198%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 3.8059, Accuracy: 3445/10000 (34.4500%)
___Train Local_ResNet_18,  epoch 204, local model 29, internal_epoch   1,  Average loss: 0.0060, Accuracy: 751/848 (88.5613%)
___Train Local_ResNet_18,  epoch 204, local model 29, internal_epoch   2,  Average loss: 0.0061, Accuracy: 750/848 (88.4434%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 9.6818, Accuracy: 1528/10000 (15.2800%)
___Train Local_ResNet_18,  epoch 204, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 232/248 (93.5484%)
___Train Local_ResNet_18,  epoch 204, local model 23, internal_epoch   2,  Average loss: 0.0008, Accuracy: 245/248 (98.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.6129, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 204, local model 83, internal_epoch   1,  Average loss: 0.0022, Accuracy: 349/366 (95.3552%)
___Train Local_ResNet_18,  epoch 204, local model 83, internal_epoch   2,  Average loss: 0.0005, Accuracy: 364/366 (99.4536%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.2850, Accuracy: 6331/10000 (63.3100%)
___Train Local_ResNet_18,  epoch 204, local model 43, internal_epoch   1,  Average loss: 0.0067, Accuracy: 304/345 (88.1159%)
___Train Local_ResNet_18,  epoch 204, local model 43, internal_epoch   2,  Average loss: 0.0020, Accuracy: 329/345 (95.3623%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 8.1451, Accuracy: 2379/10000 (23.7900%)
___Train Local_ResNet_18,  epoch 204, local model 56, internal_epoch   1,  Average loss: 0.0016, Accuracy: 721/743 (97.0390%)
___Train Local_ResNet_18,  epoch 204, local model 56, internal_epoch   2,  Average loss: 0.0011, Accuracy: 728/743 (97.9812%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.3335, Accuracy: 6295/10000 (62.9500%)
___Train Local_ResNet_18,  epoch 204, local model 45, internal_epoch   1,  Average loss: 0.0079, Accuracy: 461/529 (87.1456%)
___Train Local_ResNet_18,  epoch 204, local model 45, internal_epoch   2,  Average loss: 0.0093, Accuracy: 439/529 (82.9868%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 9.2818, Accuracy: 2342/10000 (23.4200%)
___Train Local_ResNet_18,  epoch 204, local model 1, internal_epoch   1,  Average loss: 0.0073, Accuracy: 595/641 (92.8237%)
___Train Local_ResNet_18,  epoch 204, local model 1, internal_epoch   2,  Average loss: 0.0118, Accuracy: 539/641 (84.0874%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 10.7201, Accuracy: 2714/10000 (27.1400%)
time spent on training: 108.24586462974548
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.08766348533050548  data num: [756, 496, 686, 848, 248, 366, 345, 743, 529, 641]
[rfa agg] considering poison per batch poison_fraction: 0.006848709791445741
[rfa agg] init. name: [38, 77, 64, 29, 23, 83, 43, 56, 45, 1], weight: tensor([0.1336, 0.0877, 0.1212, 0.1499, 0.0438, 0.0647, 0.0610, 0.1313, 0.0935,
        0.1133])
[rfa agg] iter:  0, prev_obj_val: 30.630250930786133, obj_val: 41.953460693359375, abs dis: 11.323209762573242
[rfa agg] iter:  0, weight: tensor([0.0788, 0.2973, 0.0941, 0.0592, 0.0266, 0.0760, 0.0693, 0.0790, 0.1332,
        0.0865])
[rfa agg] iter:  1, prev_obj_val: 41.953460693359375, obj_val: 41.85421371459961, abs dis: 0.09924697875976562
[rfa agg] iter:  1, weight: tensor([0.0540, 0.1045, 0.0588, 0.0453, 0.0525, 0.3055, 0.2005, 0.0537, 0.0705,
        0.0546])
[rfa agg] iter:  2, prev_obj_val: 41.85421371459961, obj_val: 38.703590393066406, abs dis: 3.150623321533203
[rfa agg] iter:  2, weight: tensor([0.0469, 0.0896, 0.0511, 0.0393, 0.0459, 0.3631, 0.2095, 0.0466, 0.0606,
        0.0473])
[rfa agg] iter:  3, prev_obj_val: 38.703590393066406, obj_val: 38.69472885131836, abs dis: 0.008861541748046875
[rfa agg] iter:  3, weight: tensor([0.0589, 0.1331, 0.0652, 0.0483, 0.0428, 0.2617, 0.1901, 0.0587, 0.0807,
        0.0604])
[rfa agg] iter:  4, prev_obj_val: 38.69472885131836, obj_val: 38.694671630859375, abs dis: 5.7220458984375e-05
[rfa agg] iter:  4, weight: tensor([0.0598, 0.1358, 0.0662, 0.0490, 0.0434, 0.2525, 0.1899, 0.0596, 0.0823,
        0.0613])
___Test Target_ResNet_18 poisoned: False, epoch: 204: Average loss: 0.6520, Accuracy: 7807/10000 (78.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 204: Average loss: 5.8542, Accuracy: 395/9000 (4.3889%)
Done in 211.32122254371643 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:205 choose agents : [33, 50, 16, 12, 44, 86, 20, 49, 43, 28]. Adversary List: [33]
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   1,  Average loss: 0.0090, Accuracy: 479/527 (90.8918%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   3,  Average loss: 0.0024, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   4,  Average loss: 0.0015, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   5,  Average loss: 0.0017, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   6,  Average loss: 0.0021, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.63287818527587.
Norm before scaling: 38.02086026682836. Distance: 7.577750725696315
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.7445, Accuracy: 5149/10000 (51.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.1274, Accuracy: 8724/9000 (96.9333%)
Scaling by  100
Scaled Norm after poisoning: 756.8568226553817, distance: 757.775032578931
Total norm for 1 adversaries is: 756.8568226553817. distance: 757.775032578931
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 205, local model 50, internal_epoch   1,  Average loss: 0.0018, Accuracy: 392/401 (97.7556%)
___Train Local_ResNet_18,  epoch 205, local model 50, internal_epoch   2,  Average loss: 0.0007, Accuracy: 398/401 (99.2519%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.3185, Accuracy: 4897/10000 (48.9700%)
___Train Local_ResNet_18,  epoch 205, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 726/773 (93.9198%)
___Train Local_ResNet_18,  epoch 205, local model 16, internal_epoch   2,  Average loss: 0.0238, Accuracy: 486/773 (62.8719%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 221.0170, Accuracy: 1007/10000 (10.0700%)
___Train Local_ResNet_18,  epoch 205, local model 12, internal_epoch   1,  Average loss: 0.0059, Accuracy: 874/977 (89.4575%)
___Train Local_ResNet_18,  epoch 205, local model 12, internal_epoch   2,  Average loss: 0.0080, Accuracy: 824/977 (84.3398%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 15.4181, Accuracy: 2464/10000 (24.6400%)
___Train Local_ResNet_18,  epoch 205, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 401/436 (91.9725%)
___Train Local_ResNet_18,  epoch 205, local model 44, internal_epoch   2,  Average loss: 0.0018, Accuracy: 422/436 (96.7890%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.8154, Accuracy: 4091/10000 (40.9100%)
___Train Local_ResNet_18,  epoch 205, local model 86, internal_epoch   1,  Average loss: 0.0036, Accuracy: 199/212 (93.8679%)
___Train Local_ResNet_18,  epoch 205, local model 86, internal_epoch   2,  Average loss: 0.0027, Accuracy: 209/212 (98.5849%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.4324, Accuracy: 6101/10000 (61.0100%)
___Train Local_ResNet_18,  epoch 205, local model 20, internal_epoch   1,  Average loss: 0.0074, Accuracy: 313/362 (86.4641%)
___Train Local_ResNet_18,  epoch 205, local model 20, internal_epoch   2,  Average loss: 0.0018, Accuracy: 350/362 (96.6851%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 5.8105, Accuracy: 2988/10000 (29.8800%)
___Train Local_ResNet_18,  epoch 205, local model 49, internal_epoch   1,  Average loss: 0.0030, Accuracy: 406/426 (95.3052%)
___Train Local_ResNet_18,  epoch 205, local model 49, internal_epoch   2,  Average loss: 0.0006, Accuracy: 423/426 (99.2958%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.7970, Accuracy: 4268/10000 (42.6800%)
___Train Local_ResNet_18,  epoch 205, local model 43, internal_epoch   1,  Average loss: 0.0057, Accuracy: 305/345 (88.4058%)
___Train Local_ResNet_18,  epoch 205, local model 43, internal_epoch   2,  Average loss: 0.0033, Accuracy: 331/345 (95.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 3.2180, Accuracy: 4213/10000 (42.1300%)
___Train Local_ResNet_18,  epoch 205, local model 28, internal_epoch   1,  Average loss: 0.0026, Accuracy: 395/423 (93.3806%)
___Train Local_ResNet_18,  epoch 205, local model 28, internal_epoch   2,  Average loss: 0.0016, Accuracy: 414/423 (97.8723%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.6573, Accuracy: 5718/10000 (57.1800%)
time spent on training: 182.54031705856323
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10794756247439574  data num: [527, 401, 773, 977, 436, 212, 362, 426, 345, 423]
[rfa agg] considering poison per batch poison_fraction: 0.008433403318312167
[rfa agg] init. name: [33, 50, 16, 12, 44, 86, 20, 49, 43, 28], weight: tensor([0.1079, 0.0821, 0.1583, 0.2001, 0.0893, 0.0434, 0.0741, 0.0873, 0.0707,
        0.0866])
[rfa agg] iter:  0, prev_obj_val: 4621.70556640625, obj_val: 2853.48779296875, abs dis: 1768.2177734375
[rfa agg] iter:  0, weight: tensor([0.0143, 0.0899, 0.1769, 0.2260, 0.0977, 0.0470, 0.0809, 0.0955, 0.0771,
        0.0948])
[rfa agg] iter:  1, prev_obj_val: 2853.48779296875, obj_val: 2634.749267578125, abs dis: 218.738525390625
[rfa agg] iter:  1, weight: tensor([0.0016, 0.0843, 0.1915, 0.2665, 0.0916, 0.0414, 0.0742, 0.0895, 0.0707,
        0.0889])
[rfa agg] iter:  2, prev_obj_val: 2634.749267578125, obj_val: 2632.3642578125, abs dis: 2.385009765625
[rfa agg] iter:  2, weight: tensor([1.9354e-04, 7.8007e-02, 3.0427e-01, 2.2712e-01, 8.4557e-02, 2.6029e-02,
        5.8808e-02, 8.2785e-02, 5.6027e-02, 8.2194e-02])
[rfa agg] iter:  3, prev_obj_val: 2632.3642578125, obj_val: 2640.369873046875, abs dis: 8.005615234375
[rfa agg] iter:  3, weight: tensor([0.0002, 0.1245, 0.1622, 0.1230, 0.1339, 0.0319, 0.0828, 0.1318, 0.0789,
        0.1308])
[rfa agg] iter:  4, prev_obj_val: 2640.369873046875, obj_val: 2643.904052734375, abs dis: 3.5341796875
[rfa agg] iter:  4, weight: tensor([9.5151e-05, 1.1837e-01, 4.7887e-02, 4.4743e-02, 1.2545e-01, 6.3010e-02,
        1.8016e-01, 1.2457e-01, 1.7217e-01, 1.2354e-01])
[rfa agg] iter:  5, prev_obj_val: 2643.904052734375, obj_val: 2647.8486328125, abs dis: 3.944580078125
[rfa agg] iter:  5, weight: tensor([1.0975e-04, 1.0918e-01, 5.1490e-02, 4.9261e-02, 1.1660e-01, 1.0853e-01,
        1.7159e-01, 1.1507e-01, 1.6388e-01, 1.1430e-01])
[rfa agg] iter:  6, prev_obj_val: 2647.8486328125, obj_val: 2647.844970703125, abs dis: 0.003662109375
[rfa agg] iter:  6, weight: tensor([1.2357e-04, 9.9412e-02, 5.4908e-02, 5.3125e-02, 1.0679e-01, 2.0202e-01,
        1.4034e-01, 1.0504e-01, 1.3391e-01, 1.0433e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 205: Average loss: 0.6486, Accuracy: 7823/10000 (78.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 205: Average loss: 5.8495, Accuracy: 379/9000 (4.2111%)
Done in 305.4894416332245 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:206 choose agents : [51, 4, 97, 85, 17, 59, 13, 57, 76, 80]. Adversary List: []
___Train Local_ResNet_18,  epoch 206, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 440/479 (91.8580%)
___Train Local_ResNet_18,  epoch 206, local model 51, internal_epoch   2,  Average loss: 0.0024, Accuracy: 455/479 (94.9896%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 3.3110, Accuracy: 3381/10000 (33.8100%)
___Train Local_ResNet_18,  epoch 206, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 486/557 (87.2531%)
___Train Local_ResNet_18,  epoch 206, local model 4, internal_epoch   2,  Average loss: 0.0052, Accuracy: 501/557 (89.9461%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 4.8638, Accuracy: 3428/10000 (34.2800%)
___Train Local_ResNet_18,  epoch 206, local model 97, internal_epoch   1,  Average loss: 0.0028, Accuracy: 394/418 (94.2584%)
___Train Local_ResNet_18,  epoch 206, local model 97, internal_epoch   2,  Average loss: 0.0013, Accuracy: 406/418 (97.1292%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.3359, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch 206, local model 85, internal_epoch   1,  Average loss: 0.0077, Accuracy: 300/364 (82.4176%)
___Train Local_ResNet_18,  epoch 206, local model 85, internal_epoch   2,  Average loss: 0.0037, Accuracy: 335/364 (92.0330%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 6.3847, Accuracy: 2331/10000 (23.3100%)
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 206, local model 17, internal_epoch   1,  Average loss: 0.0027, Accuracy: 498/526 (94.6768%)
___Train Local_ResNet_18,  epoch 206, local model 17, internal_epoch   2,  Average loss: 0.0021, Accuracy: 508/526 (96.5779%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.4317, Accuracy: 4784/10000 (47.8400%)
___Train Local_ResNet_18,  epoch 206, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 601/642 (93.6137%)
___Train Local_ResNet_18,  epoch 206, local model 59, internal_epoch   2,  Average loss: 0.0058, Accuracy: 564/642 (87.8505%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 10.9795, Accuracy: 2284/10000 (22.8400%)
___Train Local_ResNet_18,  epoch 206, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 566/620 (91.2903%)
___Train Local_ResNet_18,  epoch 206, local model 13, internal_epoch   2,  Average loss: 0.0037, Accuracy: 579/620 (93.3871%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 3.2191, Accuracy: 3662/10000 (36.6200%)
___Train Local_ResNet_18,  epoch 206, local model 57, internal_epoch   1,  Average loss: 0.0036, Accuracy: 271/290 (93.4483%)
___Train Local_ResNet_18,  epoch 206, local model 57, internal_epoch   2,  Average loss: 0.0004, Accuracy: 289/290 (99.6552%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.4882, Accuracy: 5008/10000 (50.0800%)
___Train Local_ResNet_18,  epoch 206, local model 76, internal_epoch   1,  Average loss: 0.0270, Accuracy: 65/65 (100.0000%)
___Train Local_ResNet_18,  epoch 206, local model 76, internal_epoch   2,  Average loss: 0.0483, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 0.9145, Accuracy: 7119/10000 (71.1900%)
___Train Local_ResNet_18,  epoch 206, local model 80, internal_epoch   1,  Average loss: 0.0059, Accuracy: 322/363 (88.7052%)
___Train Local_ResNet_18,  epoch 206, local model 80, internal_epoch   2,  Average loss: 0.0015, Accuracy: 353/363 (97.2452%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 4.5676, Accuracy: 3248/10000 (32.4800%)
time spent on training: 116.90226912498474
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.12164662349676225  data num: [479, 557, 418, 364, 526, 642, 620, 290, 65, 363]
[rfa agg] considering poison per batch poison_fraction: 0.009503642460684551
[rfa agg] init. name: [51, 4, 97, 85, 17, 59, 13, 57, 76, 80], weight: tensor([0.1108, 0.1288, 0.0967, 0.0842, 0.1216, 0.1485, 0.1434, 0.0671, 0.0150,
        0.0840])
[rfa agg] iter:  0, prev_obj_val: 22.111328125, obj_val: 31.289690017700195, abs dis: 9.178361892700195
[rfa agg] iter:  0, weight: tensor([0.1124, 0.0822, 0.2048, 0.1448, 0.0812, 0.0557, 0.0686, 0.0730, 0.0058,
        0.1715])
[rfa agg] iter:  1, prev_obj_val: 31.289690017700195, obj_val: 31.25014877319336, abs dis: 0.03954124450683594
[rfa agg] iter:  1, weight: tensor([0.0756, 0.0658, 0.0989, 0.1390, 0.0635, 0.0515, 0.0596, 0.2833, 0.0105,
        0.1522])
[rfa agg] iter:  2, prev_obj_val: 31.25014877319336, obj_val: 27.685693740844727, abs dis: 3.564455032348633
[rfa agg] iter:  2, weight: tensor([0.0700, 0.0610, 0.0909, 0.1294, 0.0588, 0.0478, 0.0553, 0.3365, 0.0098,
        0.1405])
[rfa agg] iter:  3, prev_obj_val: 27.685693740844727, obj_val: 27.668994903564453, abs dis: 0.016698837280273438
[rfa agg] iter:  3, weight: tensor([0.0787, 0.0656, 0.1115, 0.1661, 0.0636, 0.0494, 0.0581, 0.2031, 0.0080,
        0.1960])
[rfa agg] iter:  4, prev_obj_val: 27.668994903564453, obj_val: 27.66876983642578, abs dis: 0.000225067138671875
[rfa agg] iter:  4, weight: tensor([0.0788, 0.0658, 0.1120, 0.1708, 0.0638, 0.0495, 0.0583, 0.1891, 0.0080,
        0.2038])
___Test Target_ResNet_18 poisoned: False, epoch: 206: Average loss: 0.6482, Accuracy: 7826/10000 (78.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 206: Average loss: 5.7759, Accuracy: 403/9000 (4.4778%)
Done in 238.31629824638367 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:207 choose agents : [77, 85, 90, 24, 63, 1, 52, 31, 59, 67]. Adversary List: [77]
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   1,  Average loss: 0.0072, Accuracy: 462/496 (93.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 464/496 (93.5484%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   3,  Average loss: 0.0023, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   4,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.61753066432259.
Norm before scaling: 37.69849484623855. Distance: 5.414213280277749
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 0.9347, Accuracy: 6961/10000 (69.6100%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.1958, Accuracy: 8555/9000 (95.0556%)
Scaling by  100
Scaled Norm after poisoning: 540.5835099686263, distance: 541.4213643272677
Total norm for 1 adversaries is: 540.5835099686263. distance: 541.4213643272677
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 207, local model 85, internal_epoch   1,  Average loss: 0.0052, Accuracy: 322/364 (88.4615%)
___Train Local_ResNet_18,  epoch 207, local model 85, internal_epoch   2,  Average loss: 0.0031, Accuracy: 349/364 (95.8791%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 3.7821, Accuracy: 3229/10000 (32.2900%)
___Train Local_ResNet_18,  epoch 207, local model 90, internal_epoch   1,  Average loss: 0.0084, Accuracy: 528/578 (91.3495%)
___Train Local_ResNet_18,  epoch 207, local model 90, internal_epoch   2,  Average loss: 0.0220, Accuracy: 415/578 (71.7993%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2019.3613, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 24, internal_epoch   1,  Average loss: 0.0037, Accuracy: 294/320 (91.8750%)
___Train Local_ResNet_18,  epoch 207, local model 24, internal_epoch   2,  Average loss: 0.0005, Accuracy: 318/320 (99.3750%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 3.4514, Accuracy: 3214/10000 (32.1400%)
___Train Local_ResNet_18,  epoch 207, local model 63, internal_epoch   1,  Average loss: 0.0018, Accuracy: 724/752 (96.2766%)
___Train Local_ResNet_18,  epoch 207, local model 63, internal_epoch   2,  Average loss: 0.0020, Accuracy: 723/752 (96.1436%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 1.6446, Accuracy: 5895/10000 (58.9500%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   1,  Average loss: 0.0047, Accuracy: 595/641 (92.8237%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   2,  Average loss: 0.0113, Accuracy: 582/641 (90.7956%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.7654, Accuracy: 4531/10000 (45.3100%)
___Train Local_ResNet_18,  epoch 207, local model 52, internal_epoch   1,  Average loss: 0.0066, Accuracy: 186/214 (86.9159%)
___Train Local_ResNet_18,  epoch 207, local model 52, internal_epoch   2,  Average loss: 0.0030, Accuracy: 205/214 (95.7944%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 3.3160, Accuracy: 4135/10000 (41.3500%)
___Train Local_ResNet_18,  epoch 207, local model 31, internal_epoch   1,  Average loss: 0.0050, Accuracy: 660/706 (93.4844%)
___Train Local_ResNet_18,  epoch 207, local model 31, internal_epoch   2,  Average loss: 0.0194, Accuracy: 470/706 (66.5722%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 490.8875, Accuracy: 1010/10000 (10.1000%)
___Train Local_ResNet_18,  epoch 207, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 600/642 (93.4579%)
___Train Local_ResNet_18,  epoch 207, local model 59, internal_epoch   2,  Average loss: 0.0301, Accuracy: 429/642 (66.8224%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 79.2605, Accuracy: 1123/10000 (11.2300%)
___Train Local_ResNet_18,  epoch 207, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 769/842 (91.3302%)
___Train Local_ResNet_18,  epoch 207, local model 67, internal_epoch   2,  Average loss: 0.0126, Accuracy: 652/842 (77.4347%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 29.3816, Accuracy: 1652/10000 (16.5200%)
time spent on training: 181.48311614990234
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0892889288928893  data num: [496, 364, 578, 320, 752, 641, 214, 706, 642, 842]
[rfa agg] considering poison per batch poison_fraction: 0.006975697569756976
[rfa agg] init. name: [77, 85, 90, 24, 63, 1, 52, 31, 59, 67], weight: tensor([0.0893, 0.0655, 0.1041, 0.0576, 0.1354, 0.1154, 0.0385, 0.1271, 0.1156,
        0.1516])
[rfa agg] iter:  0, prev_obj_val: 3462.59423828125, obj_val: 2055.615478515625, abs dis: 1406.978759765625
[rfa agg] iter:  0, weight: tensor([0.0094, 0.0697, 0.1128, 0.0610, 0.1482, 0.1257, 0.0406, 0.1391, 0.1259,
        0.1675])
[rfa agg] iter:  1, prev_obj_val: 2055.615478515625, obj_val: 1934.827392578125, abs dis: 120.7880859375
[rfa agg] iter:  1, weight: tensor([0.0008, 0.0575, 0.1085, 0.0485, 0.1571, 0.1270, 0.0312, 0.1464, 0.1267,
        0.1964])
[rfa agg] iter:  2, prev_obj_val: 1934.827392578125, obj_val: 1941.4044189453125, abs dis: 6.5770263671875
[rfa agg] iter:  2, weight: tensor([1.0951e-04, 4.6628e-02, 1.3855e-01, 3.3346e-02, 1.7804e-01, 2.1856e-01,
        1.8622e-02, 1.1765e-01, 1.4547e-01, 1.0302e-01])
[rfa agg] iter:  3, prev_obj_val: 1941.4044189453125, obj_val: 1941.3948974609375, abs dis: 0.009521484375
[rfa agg] iter:  3, weight: tensor([1.4339e-04, 9.3855e-02, 1.5424e-01, 6.1704e-02, 1.4344e-01, 1.6322e-01,
        3.2286e-02, 1.1301e-01, 1.3743e-01, 1.0067e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 207: Average loss: 0.6500, Accuracy: 7813/10000 (78.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 207: Average loss: 5.5717, Accuracy: 412/9000 (4.5778%)
Done in 304.226190328598 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:208 choose agents : [71, 66, 76, 96, 80, 81, 22, 72, 64, 45]. Adversary List: []
___Train Local_ResNet_18,  epoch 208, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 1112/1166 (95.3688%)
___Train Local_ResNet_18,  epoch 208, local model 71, internal_epoch   2,  Average loss: 0.0074, Accuracy: 989/1166 (84.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 8.3805, Accuracy: 2364/10000 (23.6400%)
___Train Local_ResNet_18,  epoch 208, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 509/555 (91.7117%)
___Train Local_ResNet_18,  epoch 208, local model 66, internal_epoch   2,  Average loss: 0.0023, Accuracy: 532/555 (95.8559%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 5.6697, Accuracy: 3304/10000 (33.0400%)
___Train Local_ResNet_18,  epoch 208, local model 76, internal_epoch   1,  Average loss: 0.0311, Accuracy: 64/65 (98.4615%)
___Train Local_ResNet_18,  epoch 208, local model 76, internal_epoch   2,  Average loss: 0.0023, Accuracy: 65/65 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.6316, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 208, local model 96, internal_epoch   1,  Average loss: 0.0048, Accuracy: 655/708 (92.5141%)
___Train Local_ResNet_18,  epoch 208, local model 96, internal_epoch   2,  Average loss: 0.0203, Accuracy: 504/708 (71.1864%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 26.3610, Accuracy: 1470/10000 (14.7000%)
___Train Local_ResNet_18,  epoch 208, local model 80, internal_epoch   1,  Average loss: 0.0045, Accuracy: 327/363 (90.0826%)
___Train Local_ResNet_18,  epoch 208, local model 80, internal_epoch   2,  Average loss: 0.0014, Accuracy: 355/363 (97.7961%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 4.3459, Accuracy: 3657/10000 (36.5700%)
___Train Local_ResNet_18,  epoch 208, local model 81, internal_epoch   1,  Average loss: 0.0059, Accuracy: 937/1034 (90.6190%)
___Train Local_ResNet_18,  epoch 208, local model 81, internal_epoch   2,  Average loss: 0.0171, Accuracy: 697/1034 (67.4081%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 127.2539, Accuracy: 1075/10000 (10.7500%)
___Train Local_ResNet_18,  epoch 208, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 435/494 (88.0567%)
___Train Local_ResNet_18,  epoch 208, local model 22, internal_epoch   2,  Average loss: 0.0019, Accuracy: 473/494 (95.7490%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 3.1049, Accuracy: 3660/10000 (36.6000%)
___Train Local_ResNet_18,  epoch 208, local model 72, internal_epoch   1,  Average loss: 0.0095, Accuracy: 508/618 (82.2006%)
___Train Local_ResNet_18,  epoch 208, local model 72, internal_epoch   2,  Average loss: 0.0086, Accuracy: 520/618 (84.1424%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 6.7728, Accuracy: 2553/10000 (25.5300%)
___Train Local_ResNet_18,  epoch 208, local model 64, internal_epoch   1,  Average loss: 0.0029, Accuracy: 649/686 (94.6064%)
___Train Local_ResNet_18,  epoch 208, local model 64, internal_epoch   2,  Average loss: 0.0023, Accuracy: 658/686 (95.9184%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.8470, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 208, local model 45, internal_epoch   1,  Average loss: 0.0052, Accuracy: 477/529 (90.1701%)
___Train Local_ResNet_18,  epoch 208, local model 45, internal_epoch   2,  Average loss: 0.0065, Accuracy: 466/529 (88.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 7.6150, Accuracy: 1914/10000 (19.1400%)
time spent on training: 98.18286991119385
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [1166, 555, 65, 708, 363, 1034, 494, 618, 686, 529]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [71, 66, 76, 96, 80, 81, 22, 72, 64, 45], weight: tensor([0.1875, 0.0893, 0.0105, 0.1139, 0.0584, 0.1663, 0.0794, 0.0994, 0.1103,
        0.0851])
[rfa agg] iter:  0, prev_obj_val: 39.30021667480469, obj_val: 44.39080047607422, abs dis: 5.090583801269531
[rfa agg] iter:  0, weight: tensor([0.0539, 0.1565, 0.0034, 0.1020, 0.0374, 0.0587, 0.0914, 0.1608, 0.1983,
        0.1377])
[rfa agg] iter:  1, prev_obj_val: 44.39080047607422, obj_val: 50.456295013427734, abs dis: 6.065494537353516
[rfa agg] iter:  1, weight: tensor([0.0433, 0.2090, 0.0039, 0.0685, 0.0549, 0.0456, 0.1813, 0.1179, 0.1029,
        0.1727])
[rfa agg] iter:  2, prev_obj_val: 50.456295013427734, obj_val: 53.96003341674805, abs dis: 3.5037384033203125
[rfa agg] iter:  2, weight: tensor([0.0478, 0.1540, 0.0056, 0.0676, 0.1040, 0.0498, 0.2401, 0.1015, 0.0908,
        0.1388])
[rfa agg] iter:  3, prev_obj_val: 53.96003341674805, obj_val: 57.625579833984375, abs dis: 3.665546417236328
[rfa agg] iter:  3, weight: tensor([0.0515, 0.1360, 0.0069, 0.0696, 0.1597, 0.0533, 0.2091, 0.0987, 0.0899,
        0.1253])
[rfa agg] iter:  4, prev_obj_val: 57.625579833984375, obj_val: 61.44772720336914, abs dis: 3.8221473693847656
[rfa agg] iter:  4, weight: tensor([0.0523, 0.1184, 0.0081, 0.0679, 0.2481, 0.0538, 0.1645, 0.0919, 0.0848,
        0.1102])
[rfa agg] iter:  5, prev_obj_val: 61.44772720336914, obj_val: 57.62238311767578, abs dis: 3.8253440856933594
[rfa agg] iter:  5, weight: tensor([0.0503, 0.1004, 0.0091, 0.0629, 0.3441, 0.0516, 0.1291, 0.0819, 0.0766,
        0.0940])
[rfa agg] iter:  6, prev_obj_val: 57.62238311767578, obj_val: 57.61790084838867, abs dis: 0.004482269287109375
[rfa agg] iter:  6, weight: tensor([0.0507, 0.1145, 0.0079, 0.0658, 0.2748, 0.0522, 0.1566, 0.0889, 0.0822,
        0.1064])
[rfa agg] iter:  7, prev_obj_val: 57.61790084838867, obj_val: 57.6177978515625, abs dis: 0.000102996826171875
[rfa agg] iter:  7, weight: tensor([0.0513, 0.1161, 0.0080, 0.0666, 0.2645, 0.0528, 0.1595, 0.0900, 0.0832,
        0.1079])
___Test Target_ResNet_18 poisoned: False, epoch: 208: Average loss: 0.6535, Accuracy: 7792/10000 (77.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 208: Average loss: 5.5219, Accuracy: 372/9000 (4.1333%)
Done in 228.9067940711975 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:209 choose agents : [11, 80, 54, 44, 35, 68, 25, 4, 79, 43]. Adversary List: [11]
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   1,  Average loss: 0.0083, Accuracy: 483/546 (88.4615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   2,  Average loss: 0.0057, Accuracy: 508/546 (93.0403%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   3,  Average loss: 0.0022, Accuracy: 528/546 (96.7033%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   4,  Average loss: 0.0017, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.60383248783876.
Norm before scaling: 37.895892030832314. Distance: 6.955620547157882
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.2992, Accuracy: 6147/10000 (61.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.2704, Accuracy: 8400/9000 (93.3333%)
Scaling by  100
Scaled Norm after poisoning: 694.6851804954529, distance: 695.5620479152094
Total norm for 1 adversaries is: 694.6851804954529. distance: 695.5620479152094
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 209, local model 80, internal_epoch   1,  Average loss: 0.0031, Accuracy: 343/363 (94.4904%)
___Train Local_ResNet_18,  epoch 209, local model 80, internal_epoch   2,  Average loss: 0.0007, Accuracy: 360/363 (99.1736%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 3.4709, Accuracy: 4283/10000 (42.8300%)
___Train Local_ResNet_18,  epoch 209, local model 54, internal_epoch   1,  Average loss: 0.0032, Accuracy: 411/440 (93.4091%)
___Train Local_ResNet_18,  epoch 209, local model 54, internal_epoch   2,  Average loss: 0.0015, Accuracy: 430/440 (97.7273%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 3.6439, Accuracy: 3765/10000 (37.6500%)
___Train Local_ResNet_18,  epoch 209, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 407/436 (93.3486%)
___Train Local_ResNet_18,  epoch 209, local model 44, internal_epoch   2,  Average loss: 0.0020, Accuracy: 423/436 (97.0183%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 2.2967, Accuracy: 4723/10000 (47.2300%)
___Train Local_ResNet_18,  epoch 209, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 379/419 (90.4535%)
___Train Local_ResNet_18,  epoch 209, local model 35, internal_epoch   2,  Average loss: 0.0025, Accuracy: 404/419 (96.4200%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 3.8000, Accuracy: 3483/10000 (34.8300%)
___Train Local_ResNet_18,  epoch 209, local model 68, internal_epoch   1,  Average loss: 0.0023, Accuracy: 399/416 (95.9135%)
___Train Local_ResNet_18,  epoch 209, local model 68, internal_epoch   2,  Average loss: 0.0012, Accuracy: 411/416 (98.7981%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.3587, Accuracy: 6273/10000 (62.7300%)
___Train Local_ResNet_18,  epoch 209, local model 25, internal_epoch   1,  Average loss: 0.0034, Accuracy: 512/545 (93.9450%)
___Train Local_ResNet_18,  epoch 209, local model 25, internal_epoch   2,  Average loss: 0.0017, Accuracy: 527/545 (96.6972%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 3.1459, Accuracy: 4199/10000 (41.9900%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   1,  Average loss: 0.0045, Accuracy: 507/557 (91.0233%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 514/557 (92.2801%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 3.5541, Accuracy: 4126/10000 (41.2600%)
___Train Local_ResNet_18,  epoch 209, local model 79, internal_epoch   1,  Average loss: 0.0063, Accuracy: 137/154 (88.9610%)
___Train Local_ResNet_18,  epoch 209, local model 79, internal_epoch   2,  Average loss: 0.0005, Accuracy: 154/154 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.0397, Accuracy: 6853/10000 (68.5300%)
___Train Local_ResNet_18,  epoch 209, local model 43, internal_epoch   1,  Average loss: 0.0036, Accuracy: 325/345 (94.2029%)
___Train Local_ResNet_18,  epoch 209, local model 43, internal_epoch   2,  Average loss: 0.0009, Accuracy: 339/345 (98.2609%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 4.0008, Accuracy: 3868/10000 (38.6800%)
time spent on training: 176.84662914276123
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.12935323383084577  data num: [546, 363, 440, 436, 419, 416, 545, 557, 154, 345]
[rfa agg] considering poison per batch poison_fraction: 0.010105721393034825
[rfa agg] init. name: [11, 80, 54, 44, 35, 68, 25, 4, 79, 43], weight: tensor([0.1294, 0.0860, 0.1042, 0.1033, 0.0993, 0.0986, 0.1291, 0.1320, 0.0365,
        0.0817])
[rfa agg] iter:  0, prev_obj_val: 5414.1337890625, obj_val: 3483.718994140625, abs dis: 1930.414794921875
[rfa agg] iter:  0, weight: tensor([0.0215, 0.0963, 0.1171, 0.1160, 0.1115, 0.1107, 0.1459, 0.1491, 0.0405,
        0.0915])
[rfa agg] iter:  1, prev_obj_val: 3483.718994140625, obj_val: 3155.634765625, abs dis: 328.084228515625
[rfa agg] iter:  1, weight: tensor([0.0031, 0.0963, 0.1188, 0.1177, 0.1131, 0.1123, 0.1526, 0.1560, 0.0388,
        0.0915])
[rfa agg] iter:  2, prev_obj_val: 3155.634765625, obj_val: 3135.2744140625, abs dis: 20.3603515625
[rfa agg] iter:  2, weight: tensor([0.0003, 0.0772, 0.1088, 0.1079, 0.1034, 0.1031, 0.2001, 0.2030, 0.0230,
        0.0733])
[rfa agg] iter:  3, prev_obj_val: 3135.2744140625, obj_val: 3139.0859375, abs dis: 3.8115234375
[rfa agg] iter:  3, weight: tensor([8.5133e-05, 2.1057e-01, 1.1376e-01, 1.1399e-01, 1.0506e-01, 1.1004e-01,
        6.4317e-02, 6.5195e-02, 2.5581e-02, 1.9139e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 209: Average loss: 0.6555, Accuracy: 7801/10000 (78.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 209: Average loss: 5.5018, Accuracy: 371/9000 (4.1222%)
Done in 297.71327567100525 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:210 choose agents : [63, 35, 49, 8, 12, 18, 94, 57, 83, 37]. Adversary List: []
___Train Local_ResNet_18,  epoch 210, local model 63, internal_epoch   1,  Average loss: 0.0013, Accuracy: 738/752 (98.1383%)
___Train Local_ResNet_18,  epoch 210, local model 63, internal_epoch   2,  Average loss: 0.0008, Accuracy: 743/752 (98.8032%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.2813, Accuracy: 6383/10000 (63.8300%)
___Train Local_ResNet_18,  epoch 210, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 373/419 (89.0215%)
___Train Local_ResNet_18,  epoch 210, local model 35, internal_epoch   2,  Average loss: 0.0032, Accuracy: 406/419 (96.8974%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 3.2477, Accuracy: 3498/10000 (34.9800%)
___Train Local_ResNet_18,  epoch 210, local model 49, internal_epoch   1,  Average loss: 0.0025, Accuracy: 408/426 (95.7746%)
___Train Local_ResNet_18,  epoch 210, local model 49, internal_epoch   2,  Average loss: 0.0007, Accuracy: 422/426 (99.0610%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.9395, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 210, local model 8, internal_epoch   1,  Average loss: 0.0025, Accuracy: 514/534 (96.2547%)
___Train Local_ResNet_18,  epoch 210, local model 8, internal_epoch   2,  Average loss: 0.0015, Accuracy: 521/534 (97.5655%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.7897, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch 210, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 879/977 (89.9693%)
___Train Local_ResNet_18,  epoch 210, local model 12, internal_epoch   2,  Average loss: 0.0084, Accuracy: 826/977 (84.5445%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 6.8171, Accuracy: 2351/10000 (23.5100%)
___Train Local_ResNet_18,  epoch 210, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 360/386 (93.2642%)
___Train Local_ResNet_18,  epoch 210, local model 18, internal_epoch   2,  Average loss: 0.0112, Accuracy: 376/386 (97.4093%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 3.1716, Accuracy: 3741/10000 (37.4100%)
___Train Local_ResNet_18,  epoch 210, local model 94, internal_epoch   1,  Average loss: 0.0107, Accuracy: 175/203 (86.2069%)
___Train Local_ResNet_18,  epoch 210, local model 94, internal_epoch   2,  Average loss: 0.0108, Accuracy: 190/203 (93.5961%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 11.7159, Accuracy: 1368/10000 (13.6800%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   1,  Average loss: 0.0027, Accuracy: 278/290 (95.8621%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   2,  Average loss: 0.0005, Accuracy: 288/290 (99.3103%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.6587, Accuracy: 5901/10000 (59.0100%)
___Train Local_ResNet_18,  epoch 210, local model 83, internal_epoch   1,  Average loss: 0.0018, Accuracy: 360/366 (98.3607%)
___Train Local_ResNet_18,  epoch 210, local model 83, internal_epoch   2,  Average loss: 0.0005, Accuracy: 365/366 (99.7268%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.2272, Accuracy: 6454/10000 (64.5400%)
___Train Local_ResNet_18,  epoch 210, local model 37, internal_epoch   1,  Average loss: 0.0051, Accuracy: 656/725 (90.4828%)
___Train Local_ResNet_18,  epoch 210, local model 37, internal_epoch   2,  Average loss: 0.0074, Accuracy: 630/725 (86.8966%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 4.2536, Accuracy: 3253/10000 (32.5300%)
time spent on training: 96.80294036865234
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [752, 419, 426, 534, 977, 386, 203, 290, 366, 725]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [63, 35, 49, 8, 12, 18, 94, 57, 83, 37], weight: tensor([0.1481, 0.0825, 0.0839, 0.1052, 0.1924, 0.0760, 0.0400, 0.0571, 0.0721,
        0.1428])
[rfa agg] iter:  0, prev_obj_val: 32.88155746459961, obj_val: 40.267276763916016, abs dis: 7.385719299316406
[rfa agg] iter:  0, weight: tensor([0.0835, 0.1490, 0.1634, 0.1909, 0.0542, 0.1359, 0.0223, 0.0428, 0.0797,
        0.0782])
[rfa agg] iter:  1, prev_obj_val: 40.267276763916016, obj_val: 47.218116760253906, abs dis: 6.950839996337891
[rfa agg] iter:  1, weight: tensor([0.0443, 0.1243, 0.1359, 0.0618, 0.0342, 0.1128, 0.0331, 0.0945, 0.3171,
        0.0420])
[rfa agg] iter:  2, prev_obj_val: 47.218116760253906, obj_val: 43.573978424072266, abs dis: 3.6441383361816406
[rfa agg] iter:  2, weight: tensor([0.0470, 0.0873, 0.0910, 0.0577, 0.0386, 0.0802, 0.0685, 0.3308, 0.1543,
        0.0447])
[rfa agg] iter:  3, prev_obj_val: 43.573978424072266, obj_val: 43.565574645996094, abs dis: 0.008403778076171875
[rfa agg] iter:  3, weight: tensor([0.0471, 0.1038, 0.1101, 0.0611, 0.0376, 0.0951, 0.0488, 0.2052, 0.2464,
        0.0448])
___Test Target_ResNet_18 poisoned: False, epoch: 210: Average loss: 0.6480, Accuracy: 7804/10000 (78.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 210: Average loss: 5.4382, Accuracy: 429/9000 (4.7667%)
Done in 214.77583599090576 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:211 choose agents : [22, 38, 65, 29, 18, 53, 15, 7, 86, 60]. Adversary List: []
___Train Local_ResNet_18,  epoch 211, local model 22, internal_epoch   1,  Average loss: 0.0047, Accuracy: 443/494 (89.6761%)
___Train Local_ResNet_18,  epoch 211, local model 22, internal_epoch   2,  Average loss: 0.0024, Accuracy: 468/494 (94.7368%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 3.8058, Accuracy: 3451/10000 (34.5100%)
___Train Local_ResNet_18,  epoch 211, local model 38, internal_epoch   1,  Average loss: 0.0034, Accuracy: 711/756 (94.0476%)
___Train Local_ResNet_18,  epoch 211, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 695/756 (91.9312%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.5339, Accuracy: 4499/10000 (44.9900%)
___Train Local_ResNet_18,  epoch 211, local model 65, internal_epoch   1,  Average loss: 0.0036, Accuracy: 291/314 (92.6752%)
___Train Local_ResNet_18,  epoch 211, local model 65, internal_epoch   2,  Average loss: 0.0007, Accuracy: 313/314 (99.6815%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.5068, Accuracy: 4329/10000 (43.2900%)
___Train Local_ResNet_18,  epoch 211, local model 29, internal_epoch   1,  Average loss: 0.0052, Accuracy: 765/848 (90.2123%)
___Train Local_ResNet_18,  epoch 211, local model 29, internal_epoch   2,  Average loss: 0.0048, Accuracy: 777/848 (91.6274%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 9.1538, Accuracy: 1813/10000 (18.1300%)
___Train Local_ResNet_18,  epoch 211, local model 18, internal_epoch   1,  Average loss: 0.0023, Accuracy: 366/386 (94.8187%)
___Train Local_ResNet_18,  epoch 211, local model 18, internal_epoch   2,  Average loss: 0.0088, Accuracy: 381/386 (98.7047%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 4.2956, Accuracy: 2514/10000 (25.1400%)
___Train Local_ResNet_18,  epoch 211, local model 53, internal_epoch   1,  Average loss: 0.0030, Accuracy: 586/625 (93.7600%)
___Train Local_ResNet_18,  epoch 211, local model 53, internal_epoch   2,  Average loss: 0.0023, Accuracy: 599/625 (95.8400%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.1465, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18,  epoch 211, local model 15, internal_epoch   1,  Average loss: 0.0080, Accuracy: 291/341 (85.3372%)
___Train Local_ResNet_18,  epoch 211, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 322/341 (94.4282%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 4.5468, Accuracy: 2966/10000 (29.6600%)
___Train Local_ResNet_18,  epoch 211, local model 7, internal_epoch   1,  Average loss: 0.0018, Accuracy: 344/352 (97.7273%)
___Train Local_ResNet_18,  epoch 211, local model 7, internal_epoch   2,  Average loss: 0.0005, Accuracy: 350/352 (99.4318%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.2759, Accuracy: 4565/10000 (45.6500%)
___Train Local_ResNet_18,  epoch 211, local model 86, internal_epoch   1,  Average loss: 0.0033, Accuracy: 203/212 (95.7547%)
___Train Local_ResNet_18,  epoch 211, local model 86, internal_epoch   2,  Average loss: 0.0008, Accuracy: 212/212 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.3558, Accuracy: 6292/10000 (62.9200%)
___Train Local_ResNet_18,  epoch 211, local model 60, internal_epoch   1,  Average loss: 0.0033, Accuracy: 266/284 (93.6620%)
___Train Local_ResNet_18,  epoch 211, local model 60, internal_epoch   2,  Average loss: 0.0008, Accuracy: 283/284 (99.6479%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.8921, Accuracy: 5068/10000 (50.6800%)
time spent on training: 95.74513220787048
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [494, 756, 314, 848, 386, 625, 341, 352, 212, 284]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [22, 38, 65, 29, 18, 53, 15, 7, 86, 60], weight: tensor([0.1071, 0.1639, 0.0681, 0.1839, 0.0837, 0.1355, 0.0739, 0.0763, 0.0460,
        0.0616])
[rfa agg] iter:  0, prev_obj_val: 33.328426361083984, obj_val: 38.616092681884766, abs dis: 5.287666320800781
[rfa agg] iter:  0, weight: tensor([0.0878, 0.0477, 0.1052, 0.0403, 0.1147, 0.0588, 0.1513, 0.2590, 0.0394,
        0.0958])
[rfa agg] iter:  1, prev_obj_val: 38.616092681884766, obj_val: 54.91178894042969, abs dis: 16.295696258544922
[rfa agg] iter:  1, weight: tensor([0.0572, 0.0383, 0.2460, 0.0334, 0.0650, 0.0443, 0.0980, 0.1193, 0.0697,
        0.2287])
[rfa agg] iter:  2, prev_obj_val: 54.91178894042969, obj_val: 38.60684585571289, abs dis: 16.304943084716797
[rfa agg] iter:  2, weight: tensor([0.0844, 0.0721, 0.1334, 0.0661, 0.0820, 0.0767, 0.0950, 0.1006, 0.1689,
        0.1207])
[rfa agg] iter:  3, prev_obj_val: 38.60684585571289, obj_val: 54.91251754760742, abs dis: 16.30567169189453
[rfa agg] iter:  3, weight: tensor([0.0564, 0.0378, 0.2515, 0.0330, 0.0639, 0.0437, 0.0944, 0.1153, 0.0700,
        0.2340])
[rfa agg] iter:  4, prev_obj_val: 54.91251754760742, obj_val: 38.606834411621094, abs dis: 16.305683135986328
[rfa agg] iter:  4, weight: tensor([0.0844, 0.0721, 0.1335, 0.0661, 0.0820, 0.0767, 0.0950, 0.1006, 0.1689,
        0.1208])
[rfa agg] iter:  5, prev_obj_val: 38.606834411621094, obj_val: 54.91251754760742, abs dis: 16.305683135986328
[rfa agg] iter:  5, weight: tensor([0.0564, 0.0378, 0.2515, 0.0330, 0.0639, 0.0437, 0.0944, 0.1153, 0.0700,
        0.2340])
[rfa agg] iter:  6, prev_obj_val: 54.91251754760742, obj_val: 38.606834411621094, abs dis: 16.305683135986328
[rfa agg] iter:  6, weight: tensor([0.0844, 0.0721, 0.1335, 0.0661, 0.0820, 0.0767, 0.0950, 0.1006, 0.1689,
        0.1208])
[rfa agg] iter:  7, prev_obj_val: 38.606834411621094, obj_val: 54.91251754760742, abs dis: 16.305683135986328
[rfa agg] iter:  7, weight: tensor([0.0564, 0.0378, 0.2515, 0.0330, 0.0639, 0.0437, 0.0944, 0.1153, 0.0700,
        0.2340])
[rfa agg] iter:  8, prev_obj_val: 54.91251754760742, obj_val: 38.606834411621094, abs dis: 16.305683135986328
[rfa agg] iter:  8, weight: tensor([0.0844, 0.0721, 0.1335, 0.0661, 0.0820, 0.0767, 0.0950, 0.1006, 0.1689,
        0.1208])
[rfa agg] iter:  9, prev_obj_val: 38.606834411621094, obj_val: 54.91251754760742, abs dis: 16.305683135986328
[rfa agg] iter:  9, weight: tensor([0.0564, 0.0378, 0.2515, 0.0330, 0.0639, 0.0437, 0.0944, 0.1153, 0.0700,
        0.2340])
___Test Target_ResNet_18 poisoned: False, epoch: 211: Average loss: 0.6411, Accuracy: 7841/10000 (78.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 211: Average loss: 5.4918, Accuracy: 425/9000 (4.7222%)
Done in 229.60506057739258 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:212 choose agents : [81, 8, 28, 77, 1, 93, 53, 12, 50, 10]. Adversary List: []
___Train Local_ResNet_18,  epoch 212, local model 81, internal_epoch   1,  Average loss: 0.0063, Accuracy: 910/1034 (88.0077%)
___Train Local_ResNet_18,  epoch 212, local model 81, internal_epoch   2,  Average loss: 0.0144, Accuracy: 771/1034 (74.5648%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 31.8740, Accuracy: 1853/10000 (18.5300%)
___Train Local_ResNet_18,  epoch 212, local model 8, internal_epoch   1,  Average loss: 0.0024, Accuracy: 509/534 (95.3184%)
___Train Local_ResNet_18,  epoch 212, local model 8, internal_epoch   2,  Average loss: 0.0023, Accuracy: 514/534 (96.2547%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 2.6388, Accuracy: 4341/10000 (43.4100%)
___Train Local_ResNet_18,  epoch 212, local model 28, internal_epoch   1,  Average loss: 0.0022, Accuracy: 406/423 (95.9811%)
___Train Local_ResNet_18,  epoch 212, local model 28, internal_epoch   2,  Average loss: 0.0014, Accuracy: 414/423 (97.8723%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 2.5995, Accuracy: 4595/10000 (45.9500%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 212, local model 77, internal_epoch   1,  Average loss: 0.0015, Accuracy: 486/496 (97.9839%)
___Train Local_ResNet_18,  epoch 212, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1.2299, Accuracy: 6428/10000 (64.2800%)
___Train Local_ResNet_18,  epoch 212, local model 1, internal_epoch   1,  Average loss: 0.0043, Accuracy: 617/641 (96.2559%)
___Train Local_ResNet_18,  epoch 212, local model 1, internal_epoch   2,  Average loss: 0.0118, Accuracy: 584/641 (91.1076%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 5.8473, Accuracy: 2431/10000 (24.3100%)
___Train Local_ResNet_18,  epoch 212, local model 93, internal_epoch   1,  Average loss: 0.0027, Accuracy: 552/584 (94.5205%)
___Train Local_ResNet_18,  epoch 212, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 530/584 (90.7534%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 3.0431, Accuracy: 4062/10000 (40.6200%)
___Train Local_ResNet_18,  epoch 212, local model 53, internal_epoch   1,  Average loss: 0.0030, Accuracy: 584/625 (93.4400%)
___Train Local_ResNet_18,  epoch 212, local model 53, internal_epoch   2,  Average loss: 0.0021, Accuracy: 600/625 (96.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 3.2926, Accuracy: 3730/10000 (37.3000%)
___Train Local_ResNet_18,  epoch 212, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 879/977 (89.9693%)
___Train Local_ResNet_18,  epoch 212, local model 12, internal_epoch   2,  Average loss: 0.0102, Accuracy: 798/977 (81.6786%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 8.8062, Accuracy: 2441/10000 (24.4100%)
___Train Local_ResNet_18,  epoch 212, local model 50, internal_epoch   1,  Average loss: 0.0020, Accuracy: 389/401 (97.0075%)
___Train Local_ResNet_18,  epoch 212, local model 50, internal_epoch   2,  Average loss: 0.0006, Accuracy: 397/401 (99.0025%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1.8639, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 212, local model 10, internal_epoch   1,  Average loss: 0.0037, Accuracy: 699/752 (92.9521%)
___Train Local_ResNet_18,  epoch 212, local model 10, internal_epoch   2,  Average loss: 0.0027, Accuracy: 716/752 (95.2128%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 5.0089, Accuracy: 3336/10000 (33.3600%)
time spent on training: 109.1476743221283
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0766970774702335  data num: [1034, 534, 423, 496, 641, 584, 625, 977, 401, 752]
[rfa agg] considering poison per batch poison_fraction: 0.005991959177361991
[rfa agg] init. name: [81, 8, 28, 77, 1, 93, 53, 12, 50, 10], weight: tensor([0.1599, 0.0826, 0.0654, 0.0767, 0.0991, 0.0903, 0.0966, 0.1511, 0.0620,
        0.1163])
[rfa agg] iter:  0, prev_obj_val: 35.414276123046875, obj_val: 37.68164825439453, abs dis: 2.2673721313476562
[rfa agg] iter:  0, weight: tensor([0.0400, 0.1749, 0.0864, 0.1999, 0.0799, 0.1045, 0.1197, 0.0432, 0.0822,
        0.0693])
[rfa agg] iter:  1, prev_obj_val: 37.68164825439453, obj_val: 40.72785186767578, abs dis: 3.04620361328125
[rfa agg] iter:  1, weight: tensor([0.0323, 0.1274, 0.1087, 0.3216, 0.0591, 0.0752, 0.0844, 0.0347, 0.1038,
        0.0527])
[rfa agg] iter:  2, prev_obj_val: 40.72785186767578, obj_val: 44.183780670166016, abs dis: 3.4559288024902344
[rfa agg] iter:  2, weight: tensor([0.0320, 0.0971, 0.1809, 0.2421, 0.0534, 0.0650, 0.0720, 0.0341, 0.1743,
        0.0491])
[rfa agg] iter:  3, prev_obj_val: 44.183780670166016, obj_val: 52.507301330566406, abs dis: 8.32352066040039
[rfa agg] iter:  3, weight: tensor([0.0293, 0.0730, 0.2691, 0.1345, 0.0454, 0.0534, 0.0586, 0.0311, 0.2628,
        0.0428])
[rfa agg] iter:  4, prev_obj_val: 52.507301330566406, obj_val: 48.21086120605469, abs dis: 4.296440124511719
[rfa agg] iter:  4, weight: tensor([0.0481, 0.0904, 0.2049, 0.1268, 0.0659, 0.0738, 0.0801, 0.0504, 0.1950,
        0.0646])
[rfa agg] iter:  5, prev_obj_val: 48.21086120605469, obj_val: 44.17096710205078, abs dis: 4.039894104003906
[rfa agg] iter:  5, weight: tensor([0.0378, 0.0805, 0.2445, 0.1243, 0.0548, 0.0628, 0.0684, 0.0398, 0.2343,
        0.0528])
[rfa agg] iter:  6, prev_obj_val: 44.17096710205078, obj_val: 56.8724250793457, abs dis: 12.701457977294922
[rfa agg] iter:  6, weight: tensor([0.0285, 0.0708, 0.2781, 0.1281, 0.0441, 0.0520, 0.0570, 0.0302, 0.2695,
        0.0417])
[rfa agg] iter:  7, prev_obj_val: 56.8724250793457, obj_val: 48.21978759765625, abs dis: 8.652637481689453
[rfa agg] iter:  7, weight: tensor([0.0569, 0.0964, 0.1760, 0.1263, 0.0742, 0.0816, 0.0883, 0.0594, 0.1671,
        0.0737])
[rfa agg] iter:  8, prev_obj_val: 48.21978759765625, obj_val: 40.72541809082031, abs dis: 7.4943695068359375
[rfa agg] iter:  8, weight: tensor([0.0383, 0.0814, 0.2412, 0.1256, 0.0554, 0.0636, 0.0692, 0.0403, 0.2315,
        0.0534])
[rfa agg] iter:  9, prev_obj_val: 40.72541809082031, obj_val: 44.17980194091797, abs dis: 3.4543838500976562
[rfa agg] iter:  9, weight: tensor([0.0319, 0.0959, 0.1931, 0.2215, 0.0532, 0.0648, 0.0717, 0.0340, 0.1849,
        0.0490])
___Test Target_ResNet_18 poisoned: False, epoch: 212: Average loss: 0.6399, Accuracy: 7849/10000 (78.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 212: Average loss: 5.5731, Accuracy: 389/9000 (4.3222%)
Done in 247.09395623207092 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:213 choose agents : [18, 39, 62, 65, 87, 12, 74, 4, 7, 35]. Adversary List: []
___Train Local_ResNet_18,  epoch 213, local model 18, internal_epoch   1,  Average loss: 0.0025, Accuracy: 370/386 (95.8549%)
___Train Local_ResNet_18,  epoch 213, local model 18, internal_epoch   2,  Average loss: 0.0018, Accuracy: 377/386 (97.6684%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.5879, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 213, local model 39, internal_epoch   1,  Average loss: 0.0048, Accuracy: 195/217 (89.8618%)
___Train Local_ResNet_18,  epoch 213, local model 39, internal_epoch   2,  Average loss: 0.0012, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 2.5716, Accuracy: 4255/10000 (42.5500%)
___Train Local_ResNet_18,  epoch 213, local model 62, internal_epoch   1,  Average loss: 0.0016, Accuracy: 350/358 (97.7654%)
___Train Local_ResNet_18,  epoch 213, local model 62, internal_epoch   2,  Average loss: 0.0004, Accuracy: 357/358 (99.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.0023, Accuracy: 6909/10000 (69.0900%)
___Train Local_ResNet_18,  epoch 213, local model 65, internal_epoch   1,  Average loss: 0.0024, Accuracy: 304/314 (96.8153%)
___Train Local_ResNet_18,  epoch 213, local model 65, internal_epoch   2,  Average loss: 0.0004, Accuracy: 314/314 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.6116, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 213, local model 87, internal_epoch   1,  Average loss: 0.0070, Accuracy: 336/397 (84.6348%)
___Train Local_ResNet_18,  epoch 213, local model 87, internal_epoch   2,  Average loss: 0.0062, Accuracy: 353/397 (88.9169%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 3.1057, Accuracy: 3694/10000 (36.9400%)
___Train Local_ResNet_18,  epoch 213, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 881/977 (90.1740%)
___Train Local_ResNet_18,  epoch 213, local model 12, internal_epoch   2,  Average loss: 0.0103, Accuracy: 785/977 (80.3480%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 12.1676, Accuracy: 2159/10000 (21.5900%)
___Train Local_ResNet_18,  epoch 213, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 438/469 (93.3902%)
___Train Local_ResNet_18,  epoch 213, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 433/469 (92.3241%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 3.1745, Accuracy: 3708/10000 (37.0800%)
___Train Local_ResNet_18,  epoch 213, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 514/557 (92.2801%)
___Train Local_ResNet_18,  epoch 213, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 512/557 (91.9210%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 3.5732, Accuracy: 3568/10000 (35.6800%)
___Train Local_ResNet_18,  epoch 213, local model 7, internal_epoch   1,  Average loss: 0.0016, Accuracy: 343/352 (97.4432%)
___Train Local_ResNet_18,  epoch 213, local model 7, internal_epoch   2,  Average loss: 0.0003, Accuracy: 351/352 (99.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.6615, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 213, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 384/419 (91.6468%)
___Train Local_ResNet_18,  epoch 213, local model 35, internal_epoch   2,  Average loss: 0.0026, Accuracy: 400/419 (95.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 3.3782, Accuracy: 3614/10000 (36.1400%)
time spent on training: 93.89448666572571
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [386, 217, 358, 314, 397, 977, 469, 557, 352, 419]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [18, 39, 62, 65, 87, 12, 74, 4, 7, 35], weight: tensor([0.0868, 0.0488, 0.0805, 0.0706, 0.0893, 0.2197, 0.1055, 0.1253, 0.0792,
        0.0942])
[rfa agg] iter:  0, prev_obj_val: 29.102584838867188, obj_val: 36.83259963989258, abs dis: 7.730014801025391
[rfa agg] iter:  0, weight: tensor([0.1515, 0.0276, 0.1567, 0.0641, 0.1086, 0.0332, 0.0886, 0.0674, 0.1528,
        0.1497])
[rfa agg] iter:  1, prev_obj_val: 36.83259963989258, obj_val: 48.90658950805664, abs dis: 12.073989868164062
[rfa agg] iter:  1, weight: tensor([0.0712, 0.0757, 0.1281, 0.3133, 0.0677, 0.0334, 0.0576, 0.0514, 0.1255,
        0.0762])
[rfa agg] iter:  2, prev_obj_val: 48.90658950805664, obj_val: 36.82143783569336, abs dis: 12.085151672363281
[rfa agg] iter:  2, weight: tensor([0.0758, 0.2342, 0.0985, 0.1430, 0.0756, 0.0538, 0.0713, 0.0692, 0.0968,
        0.0818])
[rfa agg] iter:  3, prev_obj_val: 36.82143783569336, obj_val: 48.90782165527344, abs dis: 12.086383819580078
[rfa agg] iter:  3, weight: tensor([0.0693, 0.0761, 0.1247, 0.3294, 0.0656, 0.0326, 0.0562, 0.0502, 0.1220,
        0.0739])
[rfa agg] iter:  4, prev_obj_val: 48.90782165527344, obj_val: 36.82141876220703, abs dis: 12.086402893066406
[rfa agg] iter:  4, weight: tensor([0.0758, 0.2342, 0.0985, 0.1431, 0.0756, 0.0538, 0.0713, 0.0692, 0.0968,
        0.0818])
[rfa agg] iter:  5, prev_obj_val: 36.82141876220703, obj_val: 48.90782165527344, abs dis: 12.086402893066406
[rfa agg] iter:  5, weight: tensor([0.0693, 0.0761, 0.1247, 0.3294, 0.0656, 0.0326, 0.0562, 0.0502, 0.1220,
        0.0739])
[rfa agg] iter:  6, prev_obj_val: 48.90782165527344, obj_val: 36.82141876220703, abs dis: 12.086402893066406
[rfa agg] iter:  6, weight: tensor([0.0758, 0.2342, 0.0985, 0.1431, 0.0756, 0.0538, 0.0713, 0.0692, 0.0968,
        0.0818])
[rfa agg] iter:  7, prev_obj_val: 36.82141876220703, obj_val: 48.90782165527344, abs dis: 12.086402893066406
[rfa agg] iter:  7, weight: tensor([0.0693, 0.0761, 0.1247, 0.3294, 0.0656, 0.0326, 0.0562, 0.0502, 0.1220,
        0.0739])
[rfa agg] iter:  8, prev_obj_val: 48.90782165527344, obj_val: 36.82141876220703, abs dis: 12.086402893066406
[rfa agg] iter:  8, weight: tensor([0.0758, 0.2342, 0.0985, 0.1431, 0.0756, 0.0538, 0.0713, 0.0692, 0.0968,
        0.0818])
[rfa agg] iter:  9, prev_obj_val: 36.82141876220703, obj_val: 48.90782165527344, abs dis: 12.086402893066406
[rfa agg] iter:  9, weight: tensor([0.0693, 0.0761, 0.1247, 0.3294, 0.0656, 0.0326, 0.0562, 0.0502, 0.1220,
        0.0739])
___Test Target_ResNet_18 poisoned: False, epoch: 213: Average loss: 0.6381, Accuracy: 7852/10000 (78.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 213: Average loss: 5.5302, Accuracy: 424/9000 (4.7111%)
Done in 224.39792370796204 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:214 choose agents : [17, 30, 72, 51, 63, 46, 54, 95, 26, 2]. Adversary List: []
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 214, local model 17, internal_epoch   1,  Average loss: 0.0020, Accuracy: 506/526 (96.1977%)
___Train Local_ResNet_18,  epoch 214, local model 17, internal_epoch   2,  Average loss: 0.0016, Accuracy: 514/526 (97.7186%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.3980, Accuracy: 6206/10000 (62.0600%)
___Train Local_ResNet_18,  epoch 214, local model 30, internal_epoch   1,  Average loss: 0.0042, Accuracy: 308/337 (91.3947%)
___Train Local_ResNet_18,  epoch 214, local model 30, internal_epoch   2,  Average loss: 0.0031, Accuracy: 326/337 (96.7359%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 3.2444, Accuracy: 3905/10000 (39.0500%)
___Train Local_ResNet_18,  epoch 214, local model 72, internal_epoch   1,  Average loss: 0.0062, Accuracy: 539/618 (87.2168%)
___Train Local_ResNet_18,  epoch 214, local model 72, internal_epoch   2,  Average loss: 0.0062, Accuracy: 555/618 (89.8058%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 5.9041, Accuracy: 3254/10000 (32.5400%)
___Train Local_ResNet_18,  epoch 214, local model 51, internal_epoch   1,  Average loss: 0.0033, Accuracy: 442/479 (92.2756%)
___Train Local_ResNet_18,  epoch 214, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 449/479 (93.7370%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 9.8716, Accuracy: 2178/10000 (21.7800%)
___Train Local_ResNet_18,  epoch 214, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 743/752 (98.8032%)
___Train Local_ResNet_18,  epoch 214, local model 63, internal_epoch   2,  Average loss: 0.0003, Accuracy: 752/752 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 0.9549, Accuracy: 7105/10000 (71.0500%)
___Train Local_ResNet_18,  epoch 214, local model 46, internal_epoch   1,  Average loss: 0.0013, Accuracy: 594/601 (98.8353%)
___Train Local_ResNet_18,  epoch 214, local model 46, internal_epoch   2,  Average loss: 0.0007, Accuracy: 593/601 (98.6689%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.5494, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   1,  Average loss: 0.0026, Accuracy: 422/440 (95.9091%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   2,  Average loss: 0.0008, Accuracy: 434/440 (98.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 2.9602, Accuracy: 4000/10000 (40.0000%)
___Train Local_ResNet_18,  epoch 214, local model 95, internal_epoch   1,  Average loss: 0.0071, Accuracy: 483/569 (84.8858%)
___Train Local_ResNet_18,  epoch 214, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 511/569 (89.8067%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 4.9334, Accuracy: 2867/10000 (28.6700%)
___Train Local_ResNet_18,  epoch 214, local model 26, internal_epoch   1,  Average loss: 0.0025, Accuracy: 448/468 (95.7265%)
___Train Local_ResNet_18,  epoch 214, local model 26, internal_epoch   2,  Average loss: 0.0023, Accuracy: 451/468 (96.3675%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.6230, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 214, local model 2, internal_epoch   1,  Average loss: 0.0082, Accuracy: 402/461 (87.2017%)
___Train Local_ResNet_18,  epoch 214, local model 2, internal_epoch   2,  Average loss: 0.0195, Accuracy: 355/461 (77.0065%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 57.0382, Accuracy: 1009/10000 (10.0900%)
time spent on training: 107.76363515853882
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.1001713959245858  data num: [526, 337, 618, 479, 752, 601, 440, 569, 468, 461]
[rfa agg] considering poison per batch poison_fraction: 0.007825890306608265
[rfa agg] init. name: [17, 30, 72, 51, 63, 46, 54, 95, 26, 2], weight: tensor([0.1002, 0.0642, 0.1177, 0.0912, 0.1432, 0.1145, 0.0838, 0.1084, 0.0891,
        0.0878])
[rfa agg] iter:  0, prev_obj_val: 25.041994094848633, obj_val: 32.834503173828125, abs dis: 7.792509078979492
[rfa agg] iter:  0, weight: tensor([0.0778, 0.1554, 0.0635, 0.1073, 0.0519, 0.0647, 0.2106, 0.0795, 0.1080,
        0.0812])
[rfa agg] iter:  1, prev_obj_val: 32.834503173828125, obj_val: 28.74172592163086, abs dis: 4.092777252197266
[rfa agg] iter:  1, weight: tensor([0.0771, 0.2284, 0.0687, 0.0954, 0.0602, 0.0691, 0.1444, 0.0807, 0.0944,
        0.0815])
[rfa agg] iter:  2, prev_obj_val: 28.74172592163086, obj_val: 25.003267288208008, abs dis: 3.7384586334228516
[rfa agg] iter:  2, weight: tensor([0.0713, 0.2606, 0.0611, 0.0926, 0.0519, 0.0619, 0.1591, 0.0738, 0.0922,
        0.0755])
[rfa agg] iter:  3, prev_obj_val: 25.003267288208008, obj_val: 24.992481231689453, abs dis: 0.010786056518554688
[rfa agg] iter:  3, weight: tensor([0.0750, 0.1730, 0.0608, 0.1038, 0.0501, 0.0624, 0.2159, 0.0762, 0.1047,
        0.0780])
[rfa agg] iter:  4, prev_obj_val: 24.992481231689453, obj_val: 28.749534606933594, abs dis: 3.7570533752441406
[rfa agg] iter:  4, weight: tensor([0.0751, 0.1634, 0.0608, 0.1043, 0.0501, 0.0625, 0.2244, 0.0763, 0.1050,
        0.0782])
[rfa agg] iter:  5, prev_obj_val: 28.749534606933594, obj_val: 28.740076065063477, abs dis: 0.009458541870117188
[rfa agg] iter:  5, weight: tensor([0.0724, 0.2458, 0.0619, 0.0942, 0.0527, 0.0628, 0.1651, 0.0748, 0.0937,
        0.0765])
[rfa agg] iter:  6, prev_obj_val: 28.740076065063477, obj_val: 25.004154205322266, abs dis: 3.735921859741211
[rfa agg] iter:  6, weight: tensor([0.0708, 0.2655, 0.0606, 0.0919, 0.0515, 0.0614, 0.1588, 0.0732, 0.0915,
        0.0748])
[rfa agg] iter:  7, prev_obj_val: 25.004154205322266, obj_val: 24.992488861083984, abs dis: 0.01166534423828125
[rfa agg] iter:  7, weight: tensor([0.0750, 0.1736, 0.0608, 0.1038, 0.0501, 0.0624, 0.2158, 0.0761, 0.1046,
        0.0779])
[rfa agg] iter:  8, prev_obj_val: 24.992488861083984, obj_val: 28.749528884887695, abs dis: 3.757040023803711
[rfa agg] iter:  8, weight: tensor([0.0751, 0.1634, 0.0608, 0.1043, 0.0501, 0.0624, 0.2243, 0.0763, 0.1050,
        0.0782])
[rfa agg] iter:  9, prev_obj_val: 28.749528884887695, obj_val: 28.74007225036621, abs dis: 0.009456634521484375
[rfa agg] iter:  9, weight: tensor([0.0724, 0.2458, 0.0619, 0.0942, 0.0527, 0.0628, 0.1651, 0.0748, 0.0937,
        0.0765])
___Test Target_ResNet_18 poisoned: False, epoch: 214: Average loss: 0.6396, Accuracy: 7825/10000 (78.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 214: Average loss: 5.4106, Accuracy: 491/9000 (5.4556%)
Done in 224.58264207839966 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:215 choose agents : [95, 82, 45, 0, 34, 62, 66, 10, 12, 38]. Adversary List: []
___Train Local_ResNet_18,  epoch 215, local model 95, internal_epoch   1,  Average loss: 0.0076, Accuracy: 481/569 (84.5343%)
___Train Local_ResNet_18,  epoch 215, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 507/569 (89.1037%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 5.2256, Accuracy: 3304/10000 (33.0400%)
___Train Local_ResNet_18,  epoch 215, local model 82, internal_epoch   1,  Average loss: 0.0026, Accuracy: 577/601 (96.0067%)
___Train Local_ResNet_18,  epoch 215, local model 82, internal_epoch   2,  Average loss: 0.0017, Accuracy: 582/601 (96.8386%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 4.1798, Accuracy: 3192/10000 (31.9200%)
___Train Local_ResNet_18,  epoch 215, local model 45, internal_epoch   1,  Average loss: 0.0042, Accuracy: 498/529 (94.1399%)
___Train Local_ResNet_18,  epoch 215, local model 45, internal_epoch   2,  Average loss: 0.0036, Accuracy: 489/529 (92.4386%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 5.1306, Accuracy: 3322/10000 (33.2200%)
___Train Local_ResNet_18,  epoch 215, local model 0, internal_epoch   1,  Average loss: 0.0051, Accuracy: 327/367 (89.1008%)
___Train Local_ResNet_18,  epoch 215, local model 0, internal_epoch   2,  Average loss: 0.0021, Accuracy: 354/367 (96.4578%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 6.8425, Accuracy: 2009/10000 (20.0900%)
___Train Local_ResNet_18,  epoch 215, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 314/349 (89.9713%)
___Train Local_ResNet_18,  epoch 215, local model 34, internal_epoch   2,  Average loss: 0.0019, Accuracy: 339/349 (97.1347%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 5.2180, Accuracy: 2960/10000 (29.6000%)
___Train Local_ResNet_18,  epoch 215, local model 62, internal_epoch   1,  Average loss: 0.0011, Accuracy: 352/358 (98.3240%)
___Train Local_ResNet_18,  epoch 215, local model 62, internal_epoch   2,  Average loss: 0.0003, Accuracy: 357/358 (99.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 0.9237, Accuracy: 7120/10000 (71.2000%)
___Train Local_ResNet_18,  epoch 215, local model 66, internal_epoch   1,  Average loss: 0.0028, Accuracy: 524/555 (94.4144%)
___Train Local_ResNet_18,  epoch 215, local model 66, internal_epoch   2,  Average loss: 0.0018, Accuracy: 540/555 (97.2973%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 2.8263, Accuracy: 4498/10000 (44.9800%)
___Train Local_ResNet_18,  epoch 215, local model 10, internal_epoch   1,  Average loss: 0.0037, Accuracy: 695/752 (92.4202%)
___Train Local_ResNet_18,  epoch 215, local model 10, internal_epoch   2,  Average loss: 0.0025, Accuracy: 724/752 (96.2766%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 3.6321, Accuracy: 3796/10000 (37.9600%)
___Train Local_ResNet_18,  epoch 215, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 895/977 (91.6070%)
___Train Local_ResNet_18,  epoch 215, local model 12, internal_epoch   2,  Average loss: 0.0100, Accuracy: 795/977 (81.3715%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 7.6454, Accuracy: 2837/10000 (28.3700%)
___Train Local_ResNet_18,  epoch 215, local model 38, internal_epoch   1,  Average loss: 0.0018, Accuracy: 737/756 (97.4868%)
___Train Local_ResNet_18,  epoch 215, local model 38, internal_epoch   2,  Average loss: 0.0023, Accuracy: 719/756 (95.1058%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.7831, Accuracy: 5681/10000 (56.8100%)
time spent on training: 96.97315645217896
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [569, 601, 529, 367, 349, 358, 555, 752, 977, 756]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [95, 82, 45, 0, 34, 62, 66, 10, 12, 38], weight: tensor([0.0979, 0.1034, 0.0910, 0.0631, 0.0600, 0.0616, 0.0955, 0.1294, 0.1681,
        0.1301])
[rfa agg] iter:  0, prev_obj_val: 30.9349365234375, obj_val: 42.168968200683594, abs dis: 11.234031677246094
[rfa agg] iter:  0, weight: tensor([0.1503, 0.1128, 0.1527, 0.0702, 0.0674, 0.0714, 0.1753, 0.0747, 0.0493,
        0.0759])
[rfa agg] iter:  1, prev_obj_val: 42.168968200683594, obj_val: 36.055519104003906, abs dis: 6.1134490966796875
[rfa agg] iter:  1, weight: tensor([0.0627, 0.0517, 0.0593, 0.1741, 0.1767, 0.2910, 0.0632, 0.0434, 0.0339,
        0.0439])
[rfa agg] iter:  2, prev_obj_val: 36.055519104003906, obj_val: 45.963348388671875, abs dis: 9.907829284667969
[rfa agg] iter:  2, weight: tensor([0.1067, 0.0839, 0.1034, 0.1364, 0.1325, 0.1491, 0.1125, 0.0641, 0.0465,
        0.0650])
[rfa agg] iter:  3, prev_obj_val: 45.963348388671875, obj_val: 38.860652923583984, abs dis: 7.102695465087891
[rfa agg] iter:  3, weight: tensor([0.0654, 0.0555, 0.0617, 0.1871, 0.1859, 0.2428, 0.0656, 0.0483, 0.0389,
        0.0488])
[rfa agg] iter:  4, prev_obj_val: 38.860652923583984, obj_val: 38.859073638916016, abs dis: 0.00157928466796875
[rfa agg] iter:  4, weight: tensor([0.0768, 0.0622, 0.0735, 0.1743, 0.1732, 0.2223, 0.0790, 0.0501, 0.0378,
        0.0507])
___Test Target_ResNet_18 poisoned: False, epoch: 215: Average loss: 0.6371, Accuracy: 7855/10000 (78.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 215: Average loss: 5.4070, Accuracy: 494/9000 (5.4889%)
Done in 210.37307453155518 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:216 choose agents : [41, 4, 68, 55, 30, 39, 10, 64, 23, 60]. Adversary List: []
___Train Local_ResNet_18,  epoch 216, local model 41, internal_epoch   1,  Average loss: 0.0080, Accuracy: 432/513 (84.2105%)
___Train Local_ResNet_18,  epoch 216, local model 41, internal_epoch   2,  Average loss: 0.0200, Accuracy: 463/513 (90.2534%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 7.6665, Accuracy: 2115/10000 (21.1500%)
___Train Local_ResNet_18,  epoch 216, local model 4, internal_epoch   1,  Average loss: 0.0040, Accuracy: 510/557 (91.5619%)
___Train Local_ResNet_18,  epoch 216, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 507/557 (91.0233%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 2.5782, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 216, local model 68, internal_epoch   1,  Average loss: 0.0019, Accuracy: 404/416 (97.1154%)
___Train Local_ResNet_18,  epoch 216, local model 68, internal_epoch   2,  Average loss: 0.0013, Accuracy: 412/416 (99.0385%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.3009, Accuracy: 6385/10000 (63.8500%)
___Train Local_ResNet_18,  epoch 216, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 272/299 (90.9699%)
___Train Local_ResNet_18,  epoch 216, local model 55, internal_epoch   2,  Average loss: 0.0013, Accuracy: 295/299 (98.6622%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 13.0736, Accuracy: 1457/10000 (14.5700%)
___Train Local_ResNet_18,  epoch 216, local model 30, internal_epoch   1,  Average loss: 0.0028, Accuracy: 322/337 (95.5490%)
___Train Local_ResNet_18,  epoch 216, local model 30, internal_epoch   2,  Average loss: 0.0006, Accuracy: 337/337 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 2.2153, Accuracy: 5033/10000 (50.3300%)
___Train Local_ResNet_18,  epoch 216, local model 39, internal_epoch   1,  Average loss: 0.0040, Accuracy: 204/217 (94.0092%)
___Train Local_ResNet_18,  epoch 216, local model 39, internal_epoch   2,  Average loss: 0.0013, Accuracy: 214/217 (98.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 2.4627, Accuracy: 4490/10000 (44.9000%)
___Train Local_ResNet_18,  epoch 216, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 699/752 (92.9521%)
___Train Local_ResNet_18,  epoch 216, local model 10, internal_epoch   2,  Average loss: 0.0031, Accuracy: 708/752 (94.1489%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 4.1410, Accuracy: 3661/10000 (36.6100%)
___Train Local_ResNet_18,  epoch 216, local model 64, internal_epoch   1,  Average loss: 0.0023, Accuracy: 656/686 (95.6268%)
___Train Local_ResNet_18,  epoch 216, local model 64, internal_epoch   2,  Average loss: 0.0025, Accuracy: 653/686 (95.1895%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 2.2879, Accuracy: 4446/10000 (44.4600%)
___Train Local_ResNet_18,  epoch 216, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 234/248 (94.3548%)
___Train Local_ResNet_18,  epoch 216, local model 23, internal_epoch   2,  Average loss: 0.0005, Accuracy: 247/248 (99.5968%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.2954, Accuracy: 6168/10000 (61.6800%)
___Train Local_ResNet_18,  epoch 216, local model 60, internal_epoch   1,  Average loss: 0.0023, Accuracy: 274/284 (96.4789%)
___Train Local_ResNet_18,  epoch 216, local model 60, internal_epoch   2,  Average loss: 0.0004, Accuracy: 283/284 (99.6479%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.5800, Accuracy: 5704/10000 (57.0400%)
time spent on training: 94.030442237854
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [513, 557, 416, 299, 337, 217, 752, 686, 248, 284]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [41, 4, 68, 55, 30, 39, 10, 64, 23, 60], weight: tensor([0.1191, 0.1293, 0.0965, 0.0694, 0.0782, 0.0504, 0.1745, 0.1592, 0.0576,
        0.0659])
[rfa agg] iter:  0, prev_obj_val: 28.43773078918457, obj_val: 30.446224212646484, abs dis: 2.008493423461914
[rfa agg] iter:  0, weight: tensor([0.0680, 0.0753, 0.1569, 0.1087, 0.2756, 0.0448, 0.0525, 0.0576, 0.0514,
        0.1093])
[rfa agg] iter:  1, prev_obj_val: 30.446224212646484, obj_val: 36.12489700317383, abs dis: 5.678672790527344
[rfa agg] iter:  1, weight: tensor([0.0557, 0.0614, 0.1067, 0.1612, 0.2184, 0.0559, 0.0456, 0.0494, 0.0643,
        0.1815])
[rfa agg] iter:  2, prev_obj_val: 36.12489700317383, obj_val: 52.6573371887207, abs dis: 16.532440185546875
[rfa agg] iter:  2, weight: tensor([0.0450, 0.0494, 0.0668, 0.1709, 0.0888, 0.1397, 0.0404, 0.0427, 0.1650,
        0.1913])
[rfa agg] iter:  3, prev_obj_val: 52.6573371887207, obj_val: 32.98301696777344, abs dis: 19.674320220947266
[rfa agg] iter:  3, weight: tensor([0.0745, 0.0814, 0.0883, 0.1126, 0.0917, 0.1353, 0.0755, 0.0771, 0.1554,
        0.1082])
[rfa agg] iter:  4, prev_obj_val: 32.98301696777344, obj_val: 48.251861572265625, abs dis: 15.268844604492188
[rfa agg] iter:  4, weight: tensor([0.0448, 0.0493, 0.0738, 0.2018, 0.1120, 0.0742, 0.0386, 0.0412, 0.0856,
        0.2786])
[rfa agg] iter:  5, prev_obj_val: 48.251861572265625, obj_val: 32.97783660888672, abs dis: 15.274024963378906
[rfa agg] iter:  5, weight: tensor([0.0655, 0.0715, 0.0806, 0.1135, 0.0868, 0.1584, 0.0647, 0.0666, 0.1828,
        0.1096])
[rfa agg] iter:  6, prev_obj_val: 32.97783660888672, obj_val: 48.25218200683594, abs dis: 15.274345397949219
[rfa agg] iter:  6, weight: tensor([0.0444, 0.0488, 0.0732, 0.2012, 0.1111, 0.0739, 0.0383, 0.0409, 0.0853,
        0.2830])
[rfa agg] iter:  7, prev_obj_val: 48.25218200683594, obj_val: 32.97783279418945, abs dis: 15.274349212646484
[rfa agg] iter:  7, weight: tensor([0.0655, 0.0715, 0.0806, 0.1135, 0.0868, 0.1584, 0.0647, 0.0666, 0.1828,
        0.1096])
[rfa agg] iter:  8, prev_obj_val: 32.97783279418945, obj_val: 48.25218200683594, abs dis: 15.274349212646484
[rfa agg] iter:  8, weight: tensor([0.0444, 0.0488, 0.0732, 0.2012, 0.1111, 0.0739, 0.0383, 0.0409, 0.0853,
        0.2830])
[rfa agg] iter:  9, prev_obj_val: 48.25218200683594, obj_val: 32.97783279418945, abs dis: 15.274349212646484
[rfa agg] iter:  9, weight: tensor([0.0655, 0.0715, 0.0806, 0.1135, 0.0868, 0.1584, 0.0647, 0.0666, 0.1828,
        0.1096])
___Test Target_ResNet_18 poisoned: False, epoch: 216: Average loss: 0.6322, Accuracy: 7866/10000 (78.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 216: Average loss: 5.4383, Accuracy: 490/9000 (5.4444%)
Done in 209.6765854358673 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:217 choose agents : [23, 34, 52, 92, 57, 74, 67, 16, 64, 30]. Adversary List: []
___Train Local_ResNet_18,  epoch 217, local model 23, internal_epoch   1,  Average loss: 0.0027, Accuracy: 236/248 (95.1613%)
___Train Local_ResNet_18,  epoch 217, local model 23, internal_epoch   2,  Average loss: 0.0008, Accuracy: 245/248 (98.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.4647, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch 217, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 323/349 (92.5501%)
___Train Local_ResNet_18,  epoch 217, local model 34, internal_epoch   2,  Average loss: 0.0017, Accuracy: 341/349 (97.7077%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 4.3038, Accuracy: 3904/10000 (39.0400%)
___Train Local_ResNet_18,  epoch 217, local model 52, internal_epoch   1,  Average loss: 0.0054, Accuracy: 194/214 (90.6542%)
___Train Local_ResNet_18,  epoch 217, local model 52, internal_epoch   2,  Average loss: 0.0014, Accuracy: 209/214 (97.6636%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 3.0418, Accuracy: 4215/10000 (42.1500%)
___Train Local_ResNet_18,  epoch 217, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 731/796 (91.8342%)
___Train Local_ResNet_18,  epoch 217, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 715/796 (89.8241%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 5.7554, Accuracy: 2534/10000 (25.3400%)
___Train Local_ResNet_18,  epoch 217, local model 57, internal_epoch   1,  Average loss: 0.0023, Accuracy: 282/290 (97.2414%)
___Train Local_ResNet_18,  epoch 217, local model 57, internal_epoch   2,  Average loss: 0.0007, Accuracy: 288/290 (99.3103%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 2.0036, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 217, local model 74, internal_epoch   1,  Average loss: 0.0030, Accuracy: 440/469 (93.8166%)
___Train Local_ResNet_18,  epoch 217, local model 74, internal_epoch   2,  Average loss: 0.0007, Accuracy: 464/469 (98.9339%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 2.3779, Accuracy: 4653/10000 (46.5300%)
___Train Local_ResNet_18,  epoch 217, local model 67, internal_epoch   1,  Average loss: 0.0030, Accuracy: 795/842 (94.4181%)
___Train Local_ResNet_18,  epoch 217, local model 67, internal_epoch   2,  Average loss: 0.0132, Accuracy: 663/842 (78.7411%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 103.1264, Accuracy: 1045/10000 (10.4500%)
___Train Local_ResNet_18,  epoch 217, local model 16, internal_epoch   1,  Average loss: 0.0026, Accuracy: 745/773 (96.3777%)
___Train Local_ResNet_18,  epoch 217, local model 16, internal_epoch   2,  Average loss: 0.0100, Accuracy: 658/773 (85.1229%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 8.8820, Accuracy: 1984/10000 (19.8400%)
___Train Local_ResNet_18,  epoch 217, local model 64, internal_epoch   1,  Average loss: 0.0019, Accuracy: 664/686 (96.7930%)
___Train Local_ResNet_18,  epoch 217, local model 64, internal_epoch   2,  Average loss: 0.0016, Accuracy: 665/686 (96.9388%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.7273, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 217, local model 30, internal_epoch   1,  Average loss: 0.0039, Accuracy: 323/337 (95.8457%)
___Train Local_ResNet_18,  epoch 217, local model 30, internal_epoch   2,  Average loss: 0.0035, Accuracy: 317/337 (94.0653%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 4.2829, Accuracy: 3436/10000 (34.3600%)
time spent on training: 97.67399668693542
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [248, 349, 214, 796, 290, 469, 842, 773, 686, 337]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [23, 34, 52, 92, 57, 74, 67, 16, 64, 30], weight: tensor([0.0496, 0.0697, 0.0428, 0.1591, 0.0580, 0.0937, 0.1683, 0.1545, 0.1371,
        0.0673])
[rfa agg] iter:  0, prev_obj_val: 35.740909576416016, obj_val: 37.20563888549805, abs dis: 1.4647293090820312
[rfa agg] iter:  0, weight: tensor([0.0333, 0.0887, 0.0286, 0.0839, 0.0515, 0.3553, 0.0736, 0.0809, 0.1200,
        0.0844])
[rfa agg] iter:  1, prev_obj_val: 37.20563888549805, obj_val: 43.313602447509766, abs dis: 6.107963562011719
[rfa agg] iter:  1, weight: tensor([0.0362, 0.1101, 0.0311, 0.0726, 0.0588, 0.3546, 0.0644, 0.0700, 0.0988,
        0.1034])
[rfa agg] iter:  2, prev_obj_val: 43.313602447509766, obj_val: 45.95063781738281, abs dis: 2.637035369873047
[rfa agg] iter:  2, weight: tensor([0.0550, 0.2557, 0.0468, 0.0507, 0.1210, 0.1037, 0.0466, 0.0490, 0.0616,
        0.2099])
[rfa agg] iter:  3, prev_obj_val: 45.95063781738281, obj_val: 45.9465446472168, abs dis: 0.004093170166015625
[rfa agg] iter:  3, weight: tensor([0.0703, 0.2165, 0.0591, 0.0458, 0.2021, 0.0799, 0.0425, 0.0443, 0.0542,
        0.1853])
___Test Target_ResNet_18 poisoned: False, epoch: 217: Average loss: 0.6354, Accuracy: 7858/10000 (78.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 217: Average loss: 5.3991, Accuracy: 534/9000 (5.9333%)
Done in 201.81678771972656 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:218 choose agents : [35, 81, 62, 68, 2, 74, 39, 1, 64, 29]. Adversary List: []
___Train Local_ResNet_18,  epoch 218, local model 35, internal_epoch   1,  Average loss: 0.0037, Accuracy: 386/419 (92.1241%)
___Train Local_ResNet_18,  epoch 218, local model 35, internal_epoch   2,  Average loss: 0.0011, Accuracy: 410/419 (97.8520%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 3.9859, Accuracy: 3060/10000 (30.6000%)
___Train Local_ResNet_18,  epoch 218, local model 81, internal_epoch   1,  Average loss: 0.0063, Accuracy: 908/1034 (87.8143%)
___Train Local_ResNet_18,  epoch 218, local model 81, internal_epoch   2,  Average loss: 0.0112, Accuracy: 833/1034 (80.5609%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 12.1413, Accuracy: 1881/10000 (18.8100%)
___Train Local_ResNet_18,  epoch 218, local model 62, internal_epoch   1,  Average loss: 0.0009, Accuracy: 355/358 (99.1620%)
___Train Local_ResNet_18,  epoch 218, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 358/358 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 0.8581, Accuracy: 7328/10000 (73.2800%)
___Train Local_ResNet_18,  epoch 218, local model 68, internal_epoch   1,  Average loss: 0.0017, Accuracy: 407/416 (97.8365%)
___Train Local_ResNet_18,  epoch 218, local model 68, internal_epoch   2,  Average loss: 0.0006, Accuracy: 414/416 (99.5192%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.2356, Accuracy: 6553/10000 (65.5300%)
___Train Local_ResNet_18,  epoch 218, local model 2, internal_epoch   1,  Average loss: 0.0063, Accuracy: 411/461 (89.1540%)
___Train Local_ResNet_18,  epoch 218, local model 2, internal_epoch   2,  Average loss: 0.0051, Accuracy: 423/461 (91.7570%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 2.7400, Accuracy: 3887/10000 (38.8700%)
___Train Local_ResNet_18,  epoch 218, local model 74, internal_epoch   1,  Average loss: 0.0025, Accuracy: 445/469 (94.8827%)
___Train Local_ResNet_18,  epoch 218, local model 74, internal_epoch   2,  Average loss: 0.0011, Accuracy: 460/469 (98.0810%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 2.1463, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch 218, local model 39, internal_epoch   1,  Average loss: 0.0029, Accuracy: 209/217 (96.3134%)
___Train Local_ResNet_18,  epoch 218, local model 39, internal_epoch   2,  Average loss: 0.0004, Accuracy: 216/217 (99.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.2787, Accuracy: 6284/10000 (62.8400%)
___Train Local_ResNet_18,  epoch 218, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 615/641 (95.9438%)
___Train Local_ResNet_18,  epoch 218, local model 1, internal_epoch   2,  Average loss: 0.0111, Accuracy: 595/641 (92.8237%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 5.0797, Accuracy: 3529/10000 (35.2900%)
___Train Local_ResNet_18,  epoch 218, local model 64, internal_epoch   1,  Average loss: 0.0016, Accuracy: 672/686 (97.9592%)
___Train Local_ResNet_18,  epoch 218, local model 64, internal_epoch   2,  Average loss: 0.0010, Accuracy: 674/686 (98.2507%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.3936, Accuracy: 6114/10000 (61.1400%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   1,  Average loss: 0.0042, Accuracy: 775/848 (91.3915%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   2,  Average loss: 0.0091, Accuracy: 730/848 (86.0849%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 11.9309, Accuracy: 1875/10000 (18.7500%)
time spent on training: 96.91964530944824
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [419, 1034, 358, 416, 461, 469, 217, 641, 686, 848]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 81, 62, 68, 2, 74, 39, 1, 64, 29], weight: tensor([0.0755, 0.1863, 0.0645, 0.0750, 0.0831, 0.0845, 0.0391, 0.1155, 0.1236,
        0.1528])
[rfa agg] iter:  0, prev_obj_val: 33.90806579589844, obj_val: 37.557132720947266, abs dis: 3.649066925048828
[rfa agg] iter:  0, weight: tensor([0.0916, 0.0592, 0.0550, 0.0928, 0.1439, 0.1770, 0.0202, 0.1343, 0.1504,
        0.0756])
[rfa agg] iter:  1, prev_obj_val: 37.557132720947266, obj_val: 42.848812103271484, abs dis: 5.291679382324219
[rfa agg] iter:  1, weight: tensor([0.1682, 0.0352, 0.0761, 0.1938, 0.1386, 0.2041, 0.0203, 0.0585, 0.0636,
        0.0416])
[rfa agg] iter:  2, prev_obj_val: 42.848812103271484, obj_val: 42.82902145385742, abs dis: 0.0197906494140625
[rfa agg] iter:  2, weight: tensor([0.1878, 0.0334, 0.2028, 0.2177, 0.0890, 0.1018, 0.0296, 0.0480, 0.0520,
        0.0379])
[rfa agg] iter:  3, prev_obj_val: 42.82902145385742, obj_val: 42.828956604003906, abs dis: 6.4849853515625e-05
[rfa agg] iter:  3, weight: tensor([0.1899, 0.0326, 0.2089, 0.2201, 0.0858, 0.0986, 0.0290, 0.0470, 0.0509,
        0.0371])
___Test Target_ResNet_18 poisoned: False, epoch: 218: Average loss: 0.6372, Accuracy: 7857/10000 (78.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 218: Average loss: 5.3810, Accuracy: 554/9000 (6.1556%)
Done in 210.93519186973572 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:219 choose agents : [11, 21, 39, 95, 90, 68, 38, 97, 3, 98]. Adversary List: []
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 219, local model 11, internal_epoch   1,  Average loss: 0.0026, Accuracy: 521/546 (95.4212%)
___Train Local_ResNet_18,  epoch 219, local model 11, internal_epoch   2,  Average loss: 0.0020, Accuracy: 526/546 (96.3370%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.4668, Accuracy: 5962/10000 (59.6200%)
___Train Local_ResNet_18,  epoch 219, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 241/262 (91.9847%)
___Train Local_ResNet_18,  epoch 219, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 250/262 (95.4198%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 6.6416, Accuracy: 2519/10000 (25.1900%)
___Train Local_ResNet_18,  epoch 219, local model 39, internal_epoch   1,  Average loss: 0.0040, Accuracy: 208/217 (95.8525%)
___Train Local_ResNet_18,  epoch 219, local model 39, internal_epoch   2,  Average loss: 0.0007, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.7268, Accuracy: 4368/10000 (43.6800%)
___Train Local_ResNet_18,  epoch 219, local model 95, internal_epoch   1,  Average loss: 0.0068, Accuracy: 489/569 (85.9402%)
___Train Local_ResNet_18,  epoch 219, local model 95, internal_epoch   2,  Average loss: 0.0043, Accuracy: 519/569 (91.2127%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 7.6216, Accuracy: 2219/10000 (22.1900%)
___Train Local_ResNet_18,  epoch 219, local model 90, internal_epoch   1,  Average loss: 0.0048, Accuracy: 530/578 (91.6955%)
___Train Local_ResNet_18,  epoch 219, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 538/578 (93.0796%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 5.6007, Accuracy: 2334/10000 (23.3400%)
___Train Local_ResNet_18,  epoch 219, local model 68, internal_epoch   1,  Average loss: 0.0011, Accuracy: 415/416 (99.7596%)
___Train Local_ResNet_18,  epoch 219, local model 68, internal_epoch   2,  Average loss: 0.0003, Accuracy: 415/416 (99.7596%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 0.8974, Accuracy: 7345/10000 (73.4500%)
___Train Local_ResNet_18,  epoch 219, local model 38, internal_epoch   1,  Average loss: 0.0022, Accuracy: 730/756 (96.5608%)
___Train Local_ResNet_18,  epoch 219, local model 38, internal_epoch   2,  Average loss: 0.0026, Accuracy: 720/756 (95.2381%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.6552, Accuracy: 4700/10000 (47.0000%)
___Train Local_ResNet_18,  epoch 219, local model 97, internal_epoch   1,  Average loss: 0.0035, Accuracy: 388/418 (92.8230%)
___Train Local_ResNet_18,  epoch 219, local model 97, internal_epoch   2,  Average loss: 0.0016, Accuracy: 410/418 (98.0861%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.2681, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 219, local model 3, internal_epoch   1,  Average loss: 0.0055, Accuracy: 698/780 (89.4872%)
___Train Local_ResNet_18,  epoch 219, local model 3, internal_epoch   2,  Average loss: 0.0103, Accuracy: 629/780 (80.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 10.6953, Accuracy: 2345/10000 (23.4500%)
___Train Local_ResNet_18,  epoch 219, local model 98, internal_epoch   1,  Average loss: 0.0034, Accuracy: 754/802 (94.0150%)
___Train Local_ResNet_18,  epoch 219, local model 98, internal_epoch   2,  Average loss: 0.0065, Accuracy: 695/802 (86.6584%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 7.3220, Accuracy: 2917/10000 (29.1700%)
time spent on training: 111.70823979377747
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10217065868263472  data num: [546, 262, 217, 569, 578, 416, 756, 418, 780, 802]
[rfa agg] considering poison per batch poison_fraction: 0.007982082709580838
[rfa agg] init. name: [11, 21, 39, 95, 90, 68, 38, 97, 3, 98], weight: tensor([0.1022, 0.0490, 0.0406, 0.1065, 0.1082, 0.0778, 0.1415, 0.0782, 0.1460,
        0.1501])
[rfa agg] iter:  0, prev_obj_val: 30.355655670166016, obj_val: 35.87471389770508, abs dis: 5.5190582275390625
[rfa agg] iter:  0, weight: tensor([0.1299, 0.0398, 0.0245, 0.1210, 0.0849, 0.2388, 0.0658, 0.1837, 0.0545,
        0.0570])
[rfa agg] iter:  1, prev_obj_val: 35.87471389770508, obj_val: 39.35438537597656, abs dis: 3.4796714782714844
[rfa agg] iter:  1, weight: tensor([0.0878, 0.0649, 0.0355, 0.0871, 0.0658, 0.2856, 0.0564, 0.2183, 0.0482,
        0.0504])
[rfa agg] iter:  2, prev_obj_val: 39.35438537597656, obj_val: 42.952903747558594, abs dis: 3.5985183715820312
[rfa agg] iter:  2, weight: tensor([0.0926, 0.1104, 0.0553, 0.0929, 0.0729, 0.2071, 0.0650, 0.1885, 0.0564,
        0.0588])
[rfa agg] iter:  3, prev_obj_val: 42.952903747558594, obj_val: 42.947601318359375, abs dis: 0.00530242919921875
[rfa agg] iter:  3, weight: tensor([0.0886, 0.1762, 0.0804, 0.0898, 0.0724, 0.1566, 0.0667, 0.1495, 0.0587,
        0.0610])
[rfa agg] iter:  4, prev_obj_val: 42.947601318359375, obj_val: 42.947540283203125, abs dis: 6.103515625e-05
[rfa agg] iter:  4, weight: tensor([0.0880, 0.1836, 0.0799, 0.0891, 0.0719, 0.1552, 0.0662, 0.1474, 0.0583,
        0.0606])
___Test Target_ResNet_18 poisoned: False, epoch: 219: Average loss: 0.6344, Accuracy: 7868/10000 (78.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 219: Average loss: 5.4676, Accuracy: 529/9000 (5.8778%)
Done in 232.71826171875 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:220 choose agents : [90, 88, 25, 27, 56, 93, 42, 18, 66, 82]. Adversary List: []
___Train Local_ResNet_18,  epoch 220, local model 90, internal_epoch   1,  Average loss: 0.0060, Accuracy: 532/578 (92.0415%)
___Train Local_ResNet_18,  epoch 220, local model 90, internal_epoch   2,  Average loss: 0.0095, Accuracy: 483/578 (83.5640%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 58.8659, Accuracy: 1135/10000 (11.3500%)
___Train Local_ResNet_18,  epoch 220, local model 88, internal_epoch   1,  Average loss: 0.0062, Accuracy: 387/447 (86.5772%)
___Train Local_ResNet_18,  epoch 220, local model 88, internal_epoch   2,  Average loss: 0.0040, Accuracy: 410/447 (91.7226%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 5.8833, Accuracy: 2754/10000 (27.5400%)
___Train Local_ResNet_18,  epoch 220, local model 25, internal_epoch   1,  Average loss: 0.0021, Accuracy: 524/545 (96.1468%)
___Train Local_ResNet_18,  epoch 220, local model 25, internal_epoch   2,  Average loss: 0.0014, Accuracy: 533/545 (97.7982%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 2.1373, Accuracy: 4997/10000 (49.9700%)
___Train Local_ResNet_18,  epoch 220, local model 27, internal_epoch   1,  Average loss: 0.0019, Accuracy: 384/397 (96.7254%)
___Train Local_ResNet_18,  epoch 220, local model 27, internal_epoch   2,  Average loss: 0.0005, Accuracy: 396/397 (99.7481%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.4106, Accuracy: 6021/10000 (60.2100%)
___Train Local_ResNet_18,  epoch 220, local model 56, internal_epoch   1,  Average loss: 0.0016, Accuracy: 731/743 (98.3849%)
___Train Local_ResNet_18,  epoch 220, local model 56, internal_epoch   2,  Average loss: 0.0008, Accuracy: 737/743 (99.1925%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 2.2011, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 220, local model 93, internal_epoch   1,  Average loss: 0.0024, Accuracy: 562/584 (96.2329%)
___Train Local_ResNet_18,  epoch 220, local model 93, internal_epoch   2,  Average loss: 0.0071, Accuracy: 511/584 (87.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 6.1511, Accuracy: 3180/10000 (31.8000%)
___Train Local_ResNet_18,  epoch 220, local model 42, internal_epoch   1,  Average loss: 0.0032, Accuracy: 188/198 (94.9495%)
___Train Local_ResNet_18,  epoch 220, local model 42, internal_epoch   2,  Average loss: 0.0005, Accuracy: 197/198 (99.4949%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.8837, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   1,  Average loss: 0.0022, Accuracy: 374/386 (96.8912%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   2,  Average loss: 0.0126, Accuracy: 372/386 (96.3731%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 3.1726, Accuracy: 3818/10000 (38.1800%)
___Train Local_ResNet_18,  epoch 220, local model 66, internal_epoch   1,  Average loss: 0.0031, Accuracy: 524/555 (94.4144%)
___Train Local_ResNet_18,  epoch 220, local model 66, internal_epoch   2,  Average loss: 0.0007, Accuracy: 551/555 (99.2793%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 2.7767, Accuracy: 4673/10000 (46.7300%)
___Train Local_ResNet_18,  epoch 220, local model 82, internal_epoch   1,  Average loss: 0.0027, Accuracy: 576/601 (95.8403%)
___Train Local_ResNet_18,  epoch 220, local model 82, internal_epoch   2,  Average loss: 0.0032, Accuracy: 566/601 (94.1764%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 4.1032, Accuracy: 3916/10000 (39.1600%)
time spent on training: 95.92875742912292
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [578, 447, 545, 397, 743, 584, 198, 386, 555, 601]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 88, 25, 27, 56, 93, 42, 18, 66, 82], weight: tensor([0.1148, 0.0888, 0.1083, 0.0789, 0.1476, 0.1160, 0.0393, 0.0767, 0.1103,
        0.1194])
[rfa agg] iter:  0, prev_obj_val: 23.766637802124023, obj_val: 26.878250122070312, abs dis: 3.111612319946289
[rfa agg] iter:  0, weight: tensor([0.0565, 0.1686, 0.0864, 0.2434, 0.0496, 0.0608, 0.0220, 0.1606, 0.0875,
        0.0645])
[rfa agg] iter:  1, prev_obj_val: 26.878250122070312, obj_val: 26.877361297607422, abs dis: 0.000888824462890625
[rfa agg] iter:  1, weight: tensor([0.0561, 0.1825, 0.0801, 0.2267, 0.0512, 0.0599, 0.0298, 0.1695, 0.0811,
        0.0632])
___Test Target_ResNet_18 poisoned: False, epoch: 220: Average loss: 0.6268, Accuracy: 7878/10000 (78.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 220: Average loss: 5.5287, Accuracy: 525/9000 (5.8333%)
Done in 209.11093091964722 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:221 choose agents : [86, 67, 38, 29, 30, 96, 0, 3, 8, 68]. Adversary List: []
___Train Local_ResNet_18,  epoch 221, local model 86, internal_epoch   1,  Average loss: 0.0024, Accuracy: 207/212 (97.6415%)
___Train Local_ResNet_18,  epoch 221, local model 86, internal_epoch   2,  Average loss: 0.0012, Accuracy: 210/212 (99.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.2912, Accuracy: 6544/10000 (65.4400%)
___Train Local_ResNet_18,  epoch 221, local model 67, internal_epoch   1,  Average loss: 0.0025, Accuracy: 804/842 (95.4869%)
___Train Local_ResNet_18,  epoch 221, local model 67, internal_epoch   2,  Average loss: 0.0089, Accuracy: 720/842 (85.5107%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 10.9818, Accuracy: 1854/10000 (18.5400%)
___Train Local_ResNet_18,  epoch 221, local model 38, internal_epoch   1,  Average loss: 0.0017, Accuracy: 734/756 (97.0899%)
___Train Local_ResNet_18,  epoch 221, local model 38, internal_epoch   2,  Average loss: 0.0010, Accuracy: 743/756 (98.2804%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.5775, Accuracy: 6094/10000 (60.9400%)
___Train Local_ResNet_18,  epoch 221, local model 29, internal_epoch   1,  Average loss: 0.0051, Accuracy: 774/848 (91.2736%)
___Train Local_ResNet_18,  epoch 221, local model 29, internal_epoch   2,  Average loss: 0.0068, Accuracy: 751/848 (88.5613%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 15.0875, Accuracy: 1598/10000 (15.9800%)
___Train Local_ResNet_18,  epoch 221, local model 30, internal_epoch   1,  Average loss: 0.0020, Accuracy: 332/337 (98.5163%)
___Train Local_ResNet_18,  epoch 221, local model 30, internal_epoch   2,  Average loss: 0.0004, Accuracy: 337/337 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.8172, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 221, local model 96, internal_epoch   1,  Average loss: 0.0025, Accuracy: 677/708 (95.6215%)
___Train Local_ResNet_18,  epoch 221, local model 96, internal_epoch   2,  Average loss: 0.0098, Accuracy: 622/708 (87.8531%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 9.5228, Accuracy: 1941/10000 (19.4100%)
___Train Local_ResNet_18,  epoch 221, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 341/367 (92.9155%)
___Train Local_ResNet_18,  epoch 221, local model 0, internal_epoch   2,  Average loss: 0.0017, Accuracy: 358/367 (97.5477%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 5.4864, Accuracy: 2692/10000 (26.9200%)
___Train Local_ResNet_18,  epoch 221, local model 3, internal_epoch   1,  Average loss: 0.0068, Accuracy: 691/780 (88.5897%)
___Train Local_ResNet_18,  epoch 221, local model 3, internal_epoch   2,  Average loss: 0.0138, Accuracy: 593/780 (76.0256%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 11.3770, Accuracy: 1778/10000 (17.7800%)
___Train Local_ResNet_18,  epoch 221, local model 8, internal_epoch   1,  Average loss: 0.0014, Accuracy: 524/534 (98.1273%)
___Train Local_ResNet_18,  epoch 221, local model 8, internal_epoch   2,  Average loss: 0.0011, Accuracy: 527/534 (98.6891%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.4618, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 221, local model 68, internal_epoch   1,  Average loss: 0.0009, Accuracy: 416/416 (100.0000%)
___Train Local_ResNet_18,  epoch 221, local model 68, internal_epoch   2,  Average loss: 0.0003, Accuracy: 414/416 (99.5192%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 0.8103, Accuracy: 7520/10000 (75.2000%)
time spent on training: 97.705246925354
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [212, 842, 756, 848, 337, 708, 367, 780, 534, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [86, 67, 38, 29, 30, 96, 0, 3, 8, 68], weight: tensor([0.0366, 0.1452, 0.1303, 0.1462, 0.0581, 0.1221, 0.0633, 0.1345, 0.0921,
        0.0717])
[rfa agg] iter:  0, prev_obj_val: 32.908870697021484, obj_val: 34.822696685791016, abs dis: 1.9138259887695312
[rfa agg] iter:  0, weight: tensor([0.0193, 0.0747, 0.1116, 0.0744, 0.0506, 0.1001, 0.0543, 0.0813, 0.3415,
        0.0921])
[rfa agg] iter:  1, prev_obj_val: 34.822696685791016, obj_val: 41.98040771484375, abs dis: 7.157711029052734
[rfa agg] iter:  1, weight: tensor([0.0212, 0.0671, 0.0955, 0.0669, 0.0598, 0.0864, 0.0638, 0.0720, 0.3468,
        0.1205])
[rfa agg] iter:  2, prev_obj_val: 41.98040771484375, obj_val: 44.835479736328125, abs dis: 2.855072021484375
[rfa agg] iter:  2, weight: tensor([0.0268, 0.0453, 0.0574, 0.0453, 0.1172, 0.0528, 0.1156, 0.0475, 0.0999,
        0.3922])
[rfa agg] iter:  3, prev_obj_val: 44.835479736328125, obj_val: 44.8272705078125, abs dis: 0.008209228515625
[rfa agg] iter:  3, weight: tensor([0.0319, 0.0421, 0.0519, 0.0421, 0.2028, 0.0478, 0.1761, 0.0437, 0.0794,
        0.2822])
[rfa agg] iter:  4, prev_obj_val: 44.8272705078125, obj_val: 44.827205657958984, abs dis: 6.4849853515625e-05
[rfa agg] iter:  4, weight: tensor([0.0317, 0.0418, 0.0516, 0.0418, 0.2074, 0.0475, 0.1826, 0.0434, 0.0788,
        0.2734])
___Test Target_ResNet_18 poisoned: False, epoch: 221: Average loss: 0.6311, Accuracy: 7867/10000 (78.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 221: Average loss: 5.4894, Accuracy: 513/9000 (5.7000%)
Done in 222.41108059883118 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:222 choose agents : [79, 90, 21, 25, 53, 14, 6, 12, 7, 58]. Adversary List: []
___Train Local_ResNet_18,  epoch 222, local model 79, internal_epoch   1,  Average loss: 0.0048, Accuracy: 139/154 (90.2597%)
___Train Local_ResNet_18,  epoch 222, local model 79, internal_epoch   2,  Average loss: 0.0007, Accuracy: 154/154 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.0747, Accuracy: 6866/10000 (68.6600%)
___Train Local_ResNet_18,  epoch 222, local model 90, internal_epoch   1,  Average loss: 0.0121, Accuracy: 544/578 (94.1176%)
___Train Local_ResNet_18,  epoch 222, local model 90, internal_epoch   2,  Average loss: 0.0281, Accuracy: 353/578 (61.0727%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 4714.8357, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 222, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 245/262 (93.5115%)
___Train Local_ResNet_18,  epoch 222, local model 21, internal_epoch   2,  Average loss: 0.0065, Accuracy: 246/262 (93.8931%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 7.9070, Accuracy: 1727/10000 (17.2700%)
___Train Local_ResNet_18,  epoch 222, local model 25, internal_epoch   1,  Average loss: 0.0022, Accuracy: 520/545 (95.4128%)
___Train Local_ResNet_18,  epoch 222, local model 25, internal_epoch   2,  Average loss: 0.0012, Accuracy: 532/545 (97.6147%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 2.3555, Accuracy: 4838/10000 (48.3800%)
___Train Local_ResNet_18,  epoch 222, local model 53, internal_epoch   1,  Average loss: 0.0029, Accuracy: 589/625 (94.2400%)
___Train Local_ResNet_18,  epoch 222, local model 53, internal_epoch   2,  Average loss: 0.0021, Accuracy: 593/625 (94.8800%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 2.5571, Accuracy: 4610/10000 (46.1000%)
___Train Local_ResNet_18,  epoch 222, local model 14, internal_epoch   1,  Average loss: 0.0057, Accuracy: 285/318 (89.6226%)
___Train Local_ResNet_18,  epoch 222, local model 14, internal_epoch   2,  Average loss: 0.0023, Accuracy: 301/318 (94.6541%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 7.7864, Accuracy: 2508/10000 (25.0800%)
___Train Local_ResNet_18,  epoch 222, local model 6, internal_epoch   1,  Average loss: 0.0024, Accuracy: 501/520 (96.3462%)
___Train Local_ResNet_18,  epoch 222, local model 6, internal_epoch   2,  Average loss: 0.0050, Accuracy: 483/520 (92.8846%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 3.1801, Accuracy: 3872/10000 (38.7200%)
___Train Local_ResNet_18,  epoch 222, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 895/977 (91.6070%)
___Train Local_ResNet_18,  epoch 222, local model 12, internal_epoch   2,  Average loss: 0.0116, Accuracy: 772/977 (79.0174%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 10.0420, Accuracy: 2357/10000 (23.5700%)
___Train Local_ResNet_18,  epoch 222, local model 7, internal_epoch   1,  Average loss: 0.0015, Accuracy: 344/352 (97.7273%)
___Train Local_ResNet_18,  epoch 222, local model 7, internal_epoch   2,  Average loss: 0.0004, Accuracy: 351/352 (99.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.4493, Accuracy: 5938/10000 (59.3800%)
___Train Local_ResNet_18,  epoch 222, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 211/234 (90.1709%)
___Train Local_ResNet_18,  epoch 222, local model 58, internal_epoch   2,  Average loss: 0.0004, Accuracy: 233/234 (99.5726%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 3.8676, Accuracy: 2991/10000 (29.9100%)
time spent on training: 95.51838111877441
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [154, 578, 262, 545, 625, 318, 520, 977, 352, 234]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [79, 90, 21, 25, 53, 14, 6, 12, 7, 58], weight: tensor([0.0337, 0.1266, 0.0574, 0.1194, 0.1369, 0.0697, 0.1139, 0.2140, 0.0771,
        0.0513])
[rfa agg] iter:  0, prev_obj_val: 38.570098876953125, obj_val: 44.11495590209961, abs dis: 5.544857025146484
[rfa agg] iter:  0, weight: tensor([0.0249, 0.0695, 0.0762, 0.1610, 0.1291, 0.0945, 0.1507, 0.0705, 0.1742,
        0.0494])
[rfa agg] iter:  1, prev_obj_val: 44.11495590209961, obj_val: 53.43684005737305, abs dis: 9.321884155273438
[rfa agg] iter:  1, weight: tensor([0.0310, 0.0447, 0.1394, 0.0785, 0.0701, 0.1932, 0.0744, 0.0471, 0.2469,
        0.0747])
[rfa agg] iter:  2, prev_obj_val: 53.43684005737305, obj_val: 49.90131759643555, abs dis: 3.5355224609375
[rfa agg] iter:  2, weight: tensor([0.0806, 0.0422, 0.1218, 0.0618, 0.0590, 0.1591, 0.0587, 0.0460, 0.0987,
        0.2721])
[rfa agg] iter:  3, prev_obj_val: 49.90131759643555, obj_val: 49.894989013671875, abs dis: 0.006328582763671875
[rfa agg] iter:  3, weight: tensor([0.0517, 0.0405, 0.1553, 0.0626, 0.0587, 0.2208, 0.0595, 0.0438, 0.1179,
        0.1892])
[rfa agg] iter:  4, prev_obj_val: 49.894989013671875, obj_val: 49.894935607910156, abs dis: 5.340576171875e-05
[rfa agg] iter:  4, weight: tensor([0.0513, 0.0403, 0.1581, 0.0623, 0.0584, 0.2271, 0.0592, 0.0436, 0.1174,
        0.1823])
___Test Target_ResNet_18 poisoned: False, epoch: 222: Average loss: 0.6363, Accuracy: 7852/10000 (78.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 222: Average loss: 5.1877, Accuracy: 715/9000 (7.9444%)
Done in 217.70529198646545 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:223 choose agents : [65, 0, 98, 20, 45, 82, 88, 17, 11, 46]. Adversary List: []
___Train Local_ResNet_18,  epoch 223, local model 65, internal_epoch   1,  Average loss: 0.0024, Accuracy: 305/314 (97.1338%)
___Train Local_ResNet_18,  epoch 223, local model 65, internal_epoch   2,  Average loss: 0.0004, Accuracy: 314/314 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.9658, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 223, local model 0, internal_epoch   1,  Average loss: 0.0032, Accuracy: 350/367 (95.3678%)
___Train Local_ResNet_18,  epoch 223, local model 0, internal_epoch   2,  Average loss: 0.0014, Accuracy: 358/367 (97.5477%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 4.9894, Accuracy: 2779/10000 (27.7900%)
___Train Local_ResNet_18,  epoch 223, local model 98, internal_epoch   1,  Average loss: 0.0030, Accuracy: 757/802 (94.3890%)
___Train Local_ResNet_18,  epoch 223, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 738/802 (92.0200%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 2.7352, Accuracy: 4785/10000 (47.8500%)
___Train Local_ResNet_18,  epoch 223, local model 20, internal_epoch   1,  Average loss: 0.0057, Accuracy: 317/362 (87.5691%)
___Train Local_ResNet_18,  epoch 223, local model 20, internal_epoch   2,  Average loss: 0.0024, Accuracy: 346/362 (95.5801%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 7.6402, Accuracy: 2383/10000 (23.8300%)
___Train Local_ResNet_18,  epoch 223, local model 45, internal_epoch   1,  Average loss: 0.0037, Accuracy: 492/529 (93.0057%)
___Train Local_ResNet_18,  epoch 223, local model 45, internal_epoch   2,  Average loss: 0.0059, Accuracy: 471/529 (89.0359%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 4.3254, Accuracy: 3313/10000 (33.1300%)
___Train Local_ResNet_18,  epoch 223, local model 82, internal_epoch   1,  Average loss: 0.0025, Accuracy: 578/601 (96.1730%)
___Train Local_ResNet_18,  epoch 223, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 565/601 (94.0100%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 2.8484, Accuracy: 4274/10000 (42.7400%)
___Train Local_ResNet_18,  epoch 223, local model 88, internal_epoch   1,  Average loss: 0.0047, Accuracy: 402/447 (89.9329%)
___Train Local_ResNet_18,  epoch 223, local model 88, internal_epoch   2,  Average loss: 0.0024, Accuracy: 423/447 (94.6309%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 4.6971, Accuracy: 2679/10000 (26.7900%)
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 223, local model 17, internal_epoch   1,  Average loss: 0.0023, Accuracy: 505/526 (96.0076%)
___Train Local_ResNet_18,  epoch 223, local model 17, internal_epoch   2,  Average loss: 0.0026, Accuracy: 508/526 (96.5779%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.5585, Accuracy: 5953/10000 (59.5300%)
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 223, local model 11, internal_epoch   1,  Average loss: 0.0022, Accuracy: 526/546 (96.3370%)
___Train Local_ResNet_18,  epoch 223, local model 11, internal_epoch   2,  Average loss: 0.0029, Accuracy: 523/546 (95.7875%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.9721, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 223, local model 46, internal_epoch   1,  Average loss: 0.0011, Accuracy: 593/601 (98.6689%)
___Train Local_ResNet_18,  epoch 223, local model 46, internal_epoch   2,  Average loss: 0.0008, Accuracy: 594/601 (98.8353%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.4014, Accuracy: 6222/10000 (62.2200%)
time spent on training: 125.33487963676453
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.21040235525024534  data num: [314, 367, 802, 362, 529, 601, 447, 526, 546, 601]
[rfa agg] considering poison per batch poison_fraction: 0.016437684003925417
[rfa agg] init. name: [65, 0, 98, 20, 45, 82, 88, 17, 11, 46], weight: tensor([0.0616, 0.0720, 0.1574, 0.0711, 0.1038, 0.1180, 0.0877, 0.1032, 0.1072,
        0.1180])
[rfa agg] iter:  0, prev_obj_val: 29.705305099487305, obj_val: 29.57577896118164, abs dis: 0.12952613830566406
[rfa agg] iter:  0, weight: tensor([0.1062, 0.2239, 0.0421, 0.1959, 0.0622, 0.0546, 0.1307, 0.0634, 0.0659,
        0.0552])
[rfa agg] iter:  1, prev_obj_val: 29.57577896118164, obj_val: 41.1063117980957, abs dis: 11.530532836914062
[rfa agg] iter:  1, weight: tensor([0.0973, 0.2581, 0.0379, 0.2138, 0.0559, 0.0492, 0.1214, 0.0572, 0.0595,
        0.0498])
[rfa agg] iter:  2, prev_obj_val: 41.1063117980957, obj_val: 33.03360366821289, abs dis: 8.072708129882812
[rfa agg] iter:  2, weight: tensor([0.2703, 0.1322, 0.0528, 0.1279, 0.0647, 0.0609, 0.0969, 0.0652, 0.0677,
        0.0613])
[rfa agg] iter:  3, prev_obj_val: 33.03360366821289, obj_val: 26.753721237182617, abs dis: 6.279882431030273
[rfa agg] iter:  3, weight: tensor([0.2039, 0.1961, 0.0412, 0.1782, 0.0566, 0.0511, 0.1042, 0.0574, 0.0597,
        0.0516])
[rfa agg] iter:  4, prev_obj_val: 26.753721237182617, obj_val: 29.587051391601562, abs dis: 2.8333301544189453
[rfa agg] iter:  4, weight: tensor([0.0734, 0.1894, 0.0439, 0.1715, 0.0707, 0.0601, 0.1809, 0.0731, 0.0760,
        0.0611])
[rfa agg] iter:  5, prev_obj_val: 29.587051391601562, obj_val: 33.0290641784668, abs dis: 3.4420127868652344
[rfa agg] iter:  5, weight: tensor([0.0989, 0.2497, 0.0387, 0.2089, 0.0572, 0.0502, 0.1264, 0.0584, 0.0607,
        0.0508])
[rfa agg] iter:  6, prev_obj_val: 33.0290641784668, obj_val: 29.580354690551758, abs dis: 3.448709487915039
[rfa agg] iter:  6, weight: tensor([0.1856, 0.2088, 0.0409, 0.1869, 0.0561, 0.0507, 0.1037, 0.0570, 0.0592,
        0.0512])
[rfa agg] iter:  7, prev_obj_val: 29.580354690551758, obj_val: 41.10582733154297, abs dis: 11.525472640991211
[rfa agg] iter:  7, weight: tensor([0.0988, 0.2559, 0.0380, 0.2138, 0.0561, 0.0493, 0.1209, 0.0574, 0.0597,
        0.0500])
[rfa agg] iter:  8, prev_obj_val: 41.10582733154297, obj_val: 33.03361511230469, abs dis: 8.072212219238281
[rfa agg] iter:  8, weight: tensor([0.2705, 0.1322, 0.0528, 0.1279, 0.0647, 0.0609, 0.0969, 0.0652, 0.0677,
        0.0613])
[rfa agg] iter:  9, prev_obj_val: 33.03361511230469, obj_val: 26.753719329833984, abs dis: 6.279895782470703
[rfa agg] iter:  9, weight: tensor([0.2039, 0.1961, 0.0412, 0.1782, 0.0566, 0.0511, 0.1042, 0.0574, 0.0597,
        0.0516])
___Test Target_ResNet_18 poisoned: False, epoch: 223: Average loss: 0.6338, Accuracy: 7862/10000 (78.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 223: Average loss: 5.2086, Accuracy: 658/9000 (7.3111%)
Done in 261.2230453491211 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:224 choose agents : [85, 42, 29, 8, 63, 48, 69, 96, 88, 17]. Adversary List: []
___Train Local_ResNet_18,  epoch 224, local model 85, internal_epoch   1,  Average loss: 0.0034, Accuracy: 345/364 (94.7802%)
___Train Local_ResNet_18,  epoch 224, local model 85, internal_epoch   2,  Average loss: 0.0014, Accuracy: 356/364 (97.8022%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 2.9693, Accuracy: 3835/10000 (38.3500%)
___Train Local_ResNet_18,  epoch 224, local model 42, internal_epoch   1,  Average loss: 0.0028, Accuracy: 194/198 (97.9798%)
___Train Local_ResNet_18,  epoch 224, local model 42, internal_epoch   2,  Average loss: 0.0024, Accuracy: 196/198 (98.9899%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 2.4956, Accuracy: 4475/10000 (44.7500%)
___Train Local_ResNet_18,  epoch 224, local model 29, internal_epoch   1,  Average loss: 0.0029, Accuracy: 794/848 (93.6321%)
___Train Local_ResNet_18,  epoch 224, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 798/848 (94.1038%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 5.3825, Accuracy: 3140/10000 (31.4000%)
___Train Local_ResNet_18,  epoch 224, local model 8, internal_epoch   1,  Average loss: 0.0011, Accuracy: 527/534 (98.6891%)
___Train Local_ResNet_18,  epoch 224, local model 8, internal_epoch   2,  Average loss: 0.0008, Accuracy: 527/534 (98.6891%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.9823, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 224, local model 63, internal_epoch   1,  Average loss: 0.0014, Accuracy: 735/752 (97.7394%)
___Train Local_ResNet_18,  epoch 224, local model 63, internal_epoch   2,  Average loss: 0.0008, Accuracy: 744/752 (98.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.2618, Accuracy: 6452/10000 (64.5200%)
___Train Local_ResNet_18,  epoch 224, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 350/378 (92.5926%)
___Train Local_ResNet_18,  epoch 224, local model 48, internal_epoch   2,  Average loss: 0.0016, Accuracy: 366/378 (96.8254%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 2.9344, Accuracy: 4214/10000 (42.1400%)
___Train Local_ResNet_18,  epoch 224, local model 69, internal_epoch   1,  Average loss: 0.0074, Accuracy: 187/216 (86.5741%)
___Train Local_ResNet_18,  epoch 224, local model 69, internal_epoch   2,  Average loss: 0.0016, Accuracy: 214/216 (99.0741%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 12.1624, Accuracy: 1035/10000 (10.3500%)
___Train Local_ResNet_18,  epoch 224, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 677/708 (95.6215%)
___Train Local_ResNet_18,  epoch 224, local model 96, internal_epoch   2,  Average loss: 0.0179, Accuracy: 499/708 (70.4802%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 186.7665, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 224, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 413/447 (92.3937%)
___Train Local_ResNet_18,  epoch 224, local model 88, internal_epoch   2,  Average loss: 0.0017, Accuracy: 431/447 (96.4206%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 3.3339, Accuracy: 4151/10000 (41.5100%)
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 224, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 515/526 (97.9087%)
___Train Local_ResNet_18,  epoch 224, local model 17, internal_epoch   2,  Average loss: 0.0011, Accuracy: 516/526 (98.0989%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.2524, Accuracy: 6429/10000 (64.2900%)
time spent on training: 109.60159373283386
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10581371957352645  data num: [364, 198, 848, 534, 752, 378, 216, 708, 447, 526]
[rfa agg] considering poison per batch poison_fraction: 0.008266696841681754
[rfa agg] init. name: [85, 42, 29, 8, 63, 48, 69, 96, 88, 17], weight: tensor([0.0732, 0.0398, 0.1706, 0.1074, 0.1513, 0.0760, 0.0435, 0.1424, 0.0899,
        0.1058])
[rfa agg] iter:  0, prev_obj_val: 35.12961196899414, obj_val: 40.824378967285156, abs dis: 5.694766998291016
[rfa agg] iter:  0, weight: tensor([0.1892, 0.0332, 0.0480, 0.0889, 0.0582, 0.1954, 0.0357, 0.0521, 0.2120,
        0.0872])
[rfa agg] iter:  1, prev_obj_val: 40.824378967285156, obj_val: 44.38405227661133, abs dis: 3.559673309326172
[rfa agg] iter:  1, weight: tensor([0.2341, 0.0578, 0.0450, 0.0687, 0.0524, 0.2399, 0.0606, 0.0472, 0.1266,
        0.0675])
[rfa agg] iter:  2, prev_obj_val: 44.38405227661133, obj_val: 44.37898635864258, abs dis: 0.00506591796875
[rfa agg] iter:  2, weight: tensor([0.1816, 0.1013, 0.0516, 0.0731, 0.0591, 0.1880, 0.1024, 0.0535, 0.1176,
        0.0718])
___Test Target_ResNet_18 poisoned: False, epoch: 224: Average loss: 0.6348, Accuracy: 7859/10000 (78.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 224: Average loss: 5.2193, Accuracy: 668/9000 (7.4222%)
Done in 224.6866693496704 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:225 choose agents : [20, 71, 51, 95, 80, 24, 55, 13, 63, 61]. Adversary List: []
___Train Local_ResNet_18,  epoch 225, local model 20, internal_epoch   1,  Average loss: 0.0045, Accuracy: 329/362 (90.8840%)
___Train Local_ResNet_18,  epoch 225, local model 20, internal_epoch   2,  Average loss: 0.0011, Accuracy: 356/362 (98.3425%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 7.5327, Accuracy: 2545/10000 (25.4500%)
___Train Local_ResNet_18,  epoch 225, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 1091/1166 (93.5678%)
___Train Local_ResNet_18,  epoch 225, local model 71, internal_epoch   2,  Average loss: 0.0094, Accuracy: 965/1166 (82.7616%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 7.7128, Accuracy: 2720/10000 (27.2000%)
___Train Local_ResNet_18,  epoch 225, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 450/479 (93.9457%)
___Train Local_ResNet_18,  epoch 225, local model 51, internal_epoch   2,  Average loss: 0.0024, Accuracy: 462/479 (96.4509%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 4.5131, Accuracy: 3269/10000 (32.6900%)
___Train Local_ResNet_18,  epoch 225, local model 95, internal_epoch   1,  Average loss: 0.0048, Accuracy: 519/569 (91.2127%)
___Train Local_ResNet_18,  epoch 225, local model 95, internal_epoch   2,  Average loss: 0.0037, Accuracy: 527/569 (92.6186%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 4.9095, Accuracy: 2609/10000 (26.0900%)
___Train Local_ResNet_18,  epoch 225, local model 80, internal_epoch   1,  Average loss: 0.0040, Accuracy: 333/363 (91.7355%)
___Train Local_ResNet_18,  epoch 225, local model 80, internal_epoch   2,  Average loss: 0.0009, Accuracy: 357/363 (98.3471%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 3.1104, Accuracy: 4398/10000 (43.9800%)
___Train Local_ResNet_18,  epoch 225, local model 24, internal_epoch   1,  Average loss: 0.0030, Accuracy: 302/320 (94.3750%)
___Train Local_ResNet_18,  epoch 225, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 319/320 (99.6875%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 2.4664, Accuracy: 4217/10000 (42.1700%)
___Train Local_ResNet_18,  epoch 225, local model 55, internal_epoch   1,  Average loss: 0.0045, Accuracy: 274/299 (91.6388%)
___Train Local_ResNet_18,  epoch 225, local model 55, internal_epoch   2,  Average loss: 0.0010, Accuracy: 293/299 (97.9933%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 12.0998, Accuracy: 1533/10000 (15.3300%)
___Train Local_ResNet_18,  epoch 225, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 559/620 (90.1613%)
___Train Local_ResNet_18,  epoch 225, local model 13, internal_epoch   2,  Average loss: 0.0038, Accuracy: 577/620 (93.0645%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 3.8673, Accuracy: 3840/10000 (38.4000%)
___Train Local_ResNet_18,  epoch 225, local model 63, internal_epoch   1,  Average loss: 0.0010, Accuracy: 744/752 (98.9362%)
___Train Local_ResNet_18,  epoch 225, local model 63, internal_epoch   2,  Average loss: 0.0005, Accuracy: 744/752 (98.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 0.9339, Accuracy: 7146/10000 (71.4600%)
___Train Local_ResNet_18,  epoch 225, local model 61, internal_epoch   1,  Average loss: 0.0039, Accuracy: 549/590 (93.0508%)
___Train Local_ResNet_18,  epoch 225, local model 61, internal_epoch   2,  Average loss: 0.0081, Accuracy: 513/590 (86.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 9.7664, Accuracy: 2380/10000 (23.8000%)
time spent on training: 100.0365571975708
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [362, 1166, 479, 569, 363, 320, 299, 620, 752, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 71, 51, 95, 80, 24, 55, 13, 63, 61], weight: tensor([0.0656, 0.2112, 0.0868, 0.1031, 0.0658, 0.0580, 0.0542, 0.1123, 0.1362,
        0.1069])
[rfa agg] iter:  0, prev_obj_val: 36.66008377075195, obj_val: 44.1812858581543, abs dis: 7.521202087402344
[rfa agg] iter:  0, weight: tensor([0.0584, 0.0463, 0.2049, 0.2069, 0.0589, 0.0379, 0.0352, 0.1410, 0.0890,
        0.1215])
[rfa agg] iter:  1, prev_obj_val: 44.1812858581543, obj_val: 53.369258880615234, abs dis: 9.187973022460938
[rfa agg] iter:  1, weight: tensor([0.1846, 0.0398, 0.1248, 0.0925, 0.1925, 0.0865, 0.0791, 0.0735, 0.0587,
        0.0680])
[rfa agg] iter:  2, prev_obj_val: 53.369258880615234, obj_val: 66.12303161621094, abs dis: 12.753772735595703
[rfa agg] iter:  2, weight: tensor([0.1227, 0.0321, 0.0603, 0.0536, 0.1254, 0.2705, 0.2026, 0.0471, 0.0416,
        0.0441])
[rfa agg] iter:  3, prev_obj_val: 66.12303161621094, obj_val: 49.79093551635742, abs dis: 16.332096099853516
[rfa agg] iter:  3, weight: tensor([0.1143, 0.0606, 0.0852, 0.0825, 0.1152, 0.1683, 0.1539, 0.0764, 0.0716,
        0.0719])
[rfa agg] iter:  4, prev_obj_val: 49.79093551635742, obj_val: 49.77131271362305, abs dis: 0.019622802734375
[rfa agg] iter:  4, weight: tensor([0.1743, 0.0323, 0.0694, 0.0590, 0.1836, 0.1848, 0.1550, 0.0507, 0.0435,
        0.0473])
[rfa agg] iter:  5, prev_obj_val: 49.77131271362305, obj_val: 53.33515930175781, abs dis: 3.5638465881347656
[rfa agg] iter:  5, weight: tensor([0.1789, 0.0316, 0.0678, 0.0576, 0.1887, 0.1842, 0.1531, 0.0495, 0.0426,
        0.0461])
[rfa agg] iter:  6, prev_obj_val: 53.33515930175781, obj_val: 66.12529754638672, abs dis: 12.790138244628906
[rfa agg] iter:  6, weight: tensor([0.1162, 0.0303, 0.0568, 0.0505, 0.1189, 0.2917, 0.2103, 0.0444, 0.0393,
        0.0416])
[rfa agg] iter:  7, prev_obj_val: 66.12529754638672, obj_val: 49.79092788696289, abs dis: 16.334369659423828
[rfa agg] iter:  7, weight: tensor([0.1143, 0.0606, 0.0852, 0.0825, 0.1151, 0.1685, 0.1540, 0.0763, 0.0716,
        0.0719])
[rfa agg] iter:  8, prev_obj_val: 49.79092788696289, obj_val: 49.77131271362305, abs dis: 0.01961517333984375
[rfa agg] iter:  8, weight: tensor([0.1743, 0.0323, 0.0694, 0.0590, 0.1835, 0.1848, 0.1551, 0.0507, 0.0435,
        0.0473])
[rfa agg] iter:  9, prev_obj_val: 49.77131271362305, obj_val: 53.33515930175781, abs dis: 3.5638465881347656
[rfa agg] iter:  9, weight: tensor([0.1789, 0.0316, 0.0678, 0.0576, 0.1887, 0.1842, 0.1531, 0.0495, 0.0426,
        0.0461])
___Test Target_ResNet_18 poisoned: False, epoch: 225: Average loss: 0.6253, Accuracy: 7904/10000 (79.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 225: Average loss: 5.3011, Accuracy: 646/9000 (7.1778%)
Done in 222.2172040939331 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:226 choose agents : [41, 90, 74, 85, 14, 21, 78, 1, 2, 9]. Adversary List: []
___Train Local_ResNet_18,  epoch 226, local model 41, internal_epoch   1,  Average loss: 0.0209, Accuracy: 438/513 (85.3801%)
___Train Local_ResNet_18,  epoch 226, local model 41, internal_epoch   2,  Average loss: 0.0114, Accuracy: 409/513 (79.7271%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 6.4069, Accuracy: 2442/10000 (24.4200%)
___Train Local_ResNet_18,  epoch 226, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 541/578 (93.5986%)
___Train Local_ResNet_18,  epoch 226, local model 90, internal_epoch   2,  Average loss: 0.0319, Accuracy: 318/578 (55.0173%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 6028.3524, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 226, local model 74, internal_epoch   1,  Average loss: 0.0021, Accuracy: 455/469 (97.0149%)
___Train Local_ResNet_18,  epoch 226, local model 74, internal_epoch   2,  Average loss: 0.0009, Accuracy: 463/469 (98.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.9376, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 226, local model 85, internal_epoch   1,  Average loss: 0.0029, Accuracy: 348/364 (95.6044%)
___Train Local_ResNet_18,  epoch 226, local model 85, internal_epoch   2,  Average loss: 0.0015, Accuracy: 356/364 (97.8022%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 2.9322, Accuracy: 3869/10000 (38.6900%)
___Train Local_ResNet_18,  epoch 226, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 299/318 (94.0252%)
___Train Local_ResNet_18,  epoch 226, local model 14, internal_epoch   2,  Average loss: 0.0006, Accuracy: 315/318 (99.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 5.1395, Accuracy: 3185/10000 (31.8500%)
___Train Local_ResNet_18,  epoch 226, local model 21, internal_epoch   1,  Average loss: 0.0030, Accuracy: 251/262 (95.8015%)
___Train Local_ResNet_18,  epoch 226, local model 21, internal_epoch   2,  Average loss: 0.0024, Accuracy: 259/262 (98.8550%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 2.5299, Accuracy: 4204/10000 (42.0400%)
___Train Local_ResNet_18,  epoch 226, local model 78, internal_epoch   1,  Average loss: 0.0040, Accuracy: 234/255 (91.7647%)
___Train Local_ResNet_18,  epoch 226, local model 78, internal_epoch   2,  Average loss: 0.0008, Accuracy: 254/255 (99.6078%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 2.9662, Accuracy: 4192/10000 (41.9200%)
___Train Local_ResNet_18,  epoch 226, local model 1, internal_epoch   1,  Average loss: 0.0061, Accuracy: 624/641 (97.3479%)
___Train Local_ResNet_18,  epoch 226, local model 1, internal_epoch   2,  Average loss: 0.0116, Accuracy: 565/641 (88.1435%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 2.9982, Accuracy: 4194/10000 (41.9400%)
___Train Local_ResNet_18,  epoch 226, local model 2, internal_epoch   1,  Average loss: 0.0044, Accuracy: 424/461 (91.9740%)
___Train Local_ResNet_18,  epoch 226, local model 2, internal_epoch   2,  Average loss: 0.0033, Accuracy: 430/461 (93.2755%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 3.3371, Accuracy: 3722/10000 (37.2200%)
___Train Local_ResNet_18,  epoch 226, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 339/368 (92.1196%)
___Train Local_ResNet_18,  epoch 226, local model 9, internal_epoch   2,  Average loss: 0.0012, Accuracy: 360/368 (97.8261%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 9.2915, Accuracy: 1597/10000 (15.9700%)
time spent on training: 94.05171799659729
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [513, 578, 469, 364, 318, 262, 255, 641, 461, 368]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [41, 90, 74, 85, 14, 21, 78, 1, 2, 9], weight: tensor([0.1213, 0.1367, 0.1109, 0.0861, 0.0752, 0.0620, 0.0603, 0.1516, 0.1090,
        0.0870])
[rfa agg] iter:  0, prev_obj_val: 30.834896087646484, obj_val: 39.13197708129883, abs dis: 8.297080993652344
[rfa agg] iter:  0, weight: tensor([0.0722, 0.0410, 0.0918, 0.1598, 0.1420, 0.1144, 0.0741, 0.0605, 0.0877,
        0.1565])
[rfa agg] iter:  1, prev_obj_val: 39.13197708129883, obj_val: 39.10433578491211, abs dis: 0.02764129638671875
[rfa agg] iter:  1, weight: tensor([0.0549, 0.0354, 0.0639, 0.0963, 0.1537, 0.1234, 0.2643, 0.0499, 0.0619,
        0.0963])
[rfa agg] iter:  2, prev_obj_val: 39.10433578491211, obj_val: 43.11884307861328, abs dis: 4.014507293701172
[rfa agg] iter:  2, weight: tensor([0.0517, 0.0332, 0.0601, 0.0906, 0.1463, 0.1175, 0.3051, 0.0469, 0.0583,
        0.0904])
[rfa agg] iter:  3, prev_obj_val: 43.11884307861328, obj_val: 32.257240295410156, abs dis: 10.861602783203125
[rfa agg] iter:  3, weight: tensor([0.0614, 0.0415, 0.0697, 0.0956, 0.1351, 0.1099, 0.2663, 0.0570, 0.0677,
        0.0958])
[rfa agg] iter:  4, prev_obj_val: 32.257240295410156, obj_val: 51.55175018310547, abs dis: 19.294509887695312
[rfa agg] iter:  4, weight: tensor([0.0500, 0.0282, 0.0625, 0.1272, 0.2358, 0.1759, 0.0944, 0.0428, 0.0599,
        0.1234])
[rfa agg] iter:  5, prev_obj_val: 51.55175018310547, obj_val: 32.34058380126953, abs dis: 19.211166381835938
[rfa agg] iter:  5, weight: tensor([0.0797, 0.0587, 0.0872, 0.1056, 0.1286, 0.1054, 0.1664, 0.0769, 0.0851,
        0.1063])
[rfa agg] iter:  6, prev_obj_val: 32.34058380126953, obj_val: 43.13569259643555, abs dis: 10.795108795166016
[rfa agg] iter:  6, weight: tensor([0.0530, 0.0302, 0.0660, 0.1310, 0.2202, 0.1677, 0.0955, 0.0454, 0.0634,
        0.1276])
[rfa agg] iter:  7, prev_obj_val: 43.13569259643555, obj_val: 32.2563362121582, abs dis: 10.879356384277344
[rfa agg] iter:  7, weight: tensor([0.0625, 0.0422, 0.0709, 0.0975, 0.1387, 0.1127, 0.2507, 0.0580, 0.0689,
        0.0978])
[rfa agg] iter:  8, prev_obj_val: 32.2563362121582, obj_val: 47.31617736816406, abs dis: 15.05984115600586
[rfa agg] iter:  8, weight: tensor([0.0500, 0.0282, 0.0625, 0.1272, 0.2358, 0.1759, 0.0942, 0.0429, 0.0599,
        0.1234])
[rfa agg] iter:  9, prev_obj_val: 47.31617736816406, obj_val: 32.293556213378906, abs dis: 15.022621154785156
[rfa agg] iter:  9, weight: tensor([0.0724, 0.0512, 0.0806, 0.1031, 0.1340, 0.1094, 0.1985, 0.0687, 0.0785,
        0.1037])
___Test Target_ResNet_18 poisoned: False, epoch: 226: Average loss: 0.6528, Accuracy: 7811/10000 (78.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 226: Average loss: 4.9378, Accuracy: 673/9000 (7.4778%)
Done in 213.97308921813965 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:227 choose agents : [9, 5, 16, 36, 94, 57, 63, 92, 28, 56]. Adversary List: []
___Train Local_ResNet_18,  epoch 227, local model 9, internal_epoch   1,  Average loss: 0.0037, Accuracy: 346/368 (94.0217%)
___Train Local_ResNet_18,  epoch 227, local model 9, internal_epoch   2,  Average loss: 0.0012, Accuracy: 361/368 (98.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 6.2344, Accuracy: 2283/10000 (22.8300%)
___Train Local_ResNet_18,  epoch 227, local model 5, internal_epoch   1,  Average loss: 0.0019, Accuracy: 352/365 (96.4384%)
___Train Local_ResNet_18,  epoch 227, local model 5, internal_epoch   2,  Average loss: 0.0007, Accuracy: 362/365 (99.1781%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.5164, Accuracy: 6158/10000 (61.5800%)
___Train Local_ResNet_18,  epoch 227, local model 16, internal_epoch   1,  Average loss: 0.0030, Accuracy: 732/773 (94.6960%)
___Train Local_ResNet_18,  epoch 227, local model 16, internal_epoch   2,  Average loss: 0.0037, Accuracy: 721/773 (93.2730%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 2.1044, Accuracy: 5021/10000 (50.2100%)
___Train Local_ResNet_18,  epoch 227, local model 36, internal_epoch   1,  Average loss: 0.0066, Accuracy: 744/849 (87.6325%)
___Train Local_ResNet_18,  epoch 227, local model 36, internal_epoch   2,  Average loss: 0.0196, Accuracy: 558/849 (65.7244%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 63.7735, Accuracy: 1066/10000 (10.6600%)
___Train Local_ResNet_18,  epoch 227, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 189/203 (93.1034%)
___Train Local_ResNet_18,  epoch 227, local model 94, internal_epoch   2,  Average loss: 0.0032, Accuracy: 195/203 (96.0591%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 3.8465, Accuracy: 2999/10000 (29.9900%)
___Train Local_ResNet_18,  epoch 227, local model 57, internal_epoch   1,  Average loss: 0.0016, Accuracy: 285/290 (98.2759%)
___Train Local_ResNet_18,  epoch 227, local model 57, internal_epoch   2,  Average loss: 0.0003, Accuracy: 290/290 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.4370, Accuracy: 6435/10000 (64.3500%)
___Train Local_ResNet_18,  epoch 227, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 739/752 (98.2713%)
___Train Local_ResNet_18,  epoch 227, local model 63, internal_epoch   2,  Average loss: 0.0006, Accuracy: 744/752 (98.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.0259, Accuracy: 6926/10000 (69.2600%)
___Train Local_ResNet_18,  epoch 227, local model 92, internal_epoch   1,  Average loss: 0.0041, Accuracy: 739/796 (92.8392%)
___Train Local_ResNet_18,  epoch 227, local model 92, internal_epoch   2,  Average loss: 0.0058, Accuracy: 714/796 (89.6985%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 4.8714, Accuracy: 2875/10000 (28.7500%)
___Train Local_ResNet_18,  epoch 227, local model 28, internal_epoch   1,  Average loss: 0.0016, Accuracy: 416/423 (98.3452%)
___Train Local_ResNet_18,  epoch 227, local model 28, internal_epoch   2,  Average loss: 0.0008, Accuracy: 418/423 (98.8180%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.7211, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 227, local model 56, internal_epoch   1,  Average loss: 0.0015, Accuracy: 726/743 (97.7120%)
___Train Local_ResNet_18,  epoch 227, local model 56, internal_epoch   2,  Average loss: 0.0009, Accuracy: 737/743 (99.1925%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.5751, Accuracy: 6051/10000 (60.5100%)
time spent on training: 95.96442198753357
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [368, 365, 773, 849, 203, 290, 752, 796, 423, 743]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [9, 5, 16, 36, 94, 57, 63, 92, 28, 56], weight: tensor([0.0662, 0.0656, 0.1390, 0.1526, 0.0365, 0.0521, 0.1352, 0.1431, 0.0761,
        0.1336])
[rfa agg] iter:  0, prev_obj_val: 35.60713577270508, obj_val: 37.34354019165039, abs dis: 1.7364044189453125
[rfa agg] iter:  0, weight: tensor([0.0897, 0.0902, 0.1065, 0.0920, 0.0284, 0.0521, 0.1344, 0.1085, 0.1659,
        0.1323])
[rfa agg] iter:  1, prev_obj_val: 37.34354019165039, obj_val: 39.161048889160156, abs dis: 1.8175086975097656
[rfa agg] iter:  1, weight: tensor([0.1037, 0.1049, 0.0898, 0.0788, 0.0298, 0.0568, 0.1104, 0.0916, 0.2255,
        0.1088])
[rfa agg] iter:  2, prev_obj_val: 39.161048889160156, obj_val: 49.597103118896484, abs dis: 10.436054229736328
[rfa agg] iter:  2, weight: tensor([0.1132, 0.1160, 0.0692, 0.0619, 0.0286, 0.0574, 0.0831, 0.0706, 0.3181,
        0.0819])
[rfa agg] iter:  3, prev_obj_val: 49.597103118896484, obj_val: 49.55563735961914, abs dis: 0.04146575927734375
[rfa agg] iter:  3, weight: tensor([0.1938, 0.2242, 0.0425, 0.0402, 0.0525, 0.1938, 0.0480, 0.0436, 0.1140,
        0.0474])
[rfa agg] iter:  4, prev_obj_val: 49.55563735961914, obj_val: 49.55549240112305, abs dis: 0.00014495849609375
[rfa agg] iter:  4, weight: tensor([0.2008, 0.2309, 0.0408, 0.0385, 0.0507, 0.1969, 0.0461, 0.0418, 0.1081,
        0.0454])
___Test Target_ResNet_18 poisoned: False, epoch: 227: Average loss: 0.6486, Accuracy: 7826/10000 (78.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 227: Average loss: 5.0787, Accuracy: 619/9000 (6.8778%)
Done in 208.83960223197937 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:228 choose agents : [44, 40, 74, 85, 2, 99, 35, 70, 88, 50]. Adversary List: []
___Train Local_ResNet_18,  epoch 228, local model 44, internal_epoch   1,  Average loss: 0.0032, Accuracy: 407/436 (93.3486%)
___Train Local_ResNet_18,  epoch 228, local model 44, internal_epoch   2,  Average loss: 0.0012, Accuracy: 427/436 (97.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.5919, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 228, local model 40, internal_epoch   1,  Average loss: 0.0060, Accuracy: 597/652 (91.5644%)
___Train Local_ResNet_18,  epoch 228, local model 40, internal_epoch   2,  Average loss: 0.0211, Accuracy: 445/652 (68.2515%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 281.1189, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 228, local model 74, internal_epoch   1,  Average loss: 0.0026, Accuracy: 451/469 (96.1620%)
___Train Local_ResNet_18,  epoch 228, local model 74, internal_epoch   2,  Average loss: 0.0022, Accuracy: 450/469 (95.9488%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 2.2820, Accuracy: 4575/10000 (45.7500%)
___Train Local_ResNet_18,  epoch 228, local model 85, internal_epoch   1,  Average loss: 0.0028, Accuracy: 349/364 (95.8791%)
___Train Local_ResNet_18,  epoch 228, local model 85, internal_epoch   2,  Average loss: 0.0014, Accuracy: 356/364 (97.8022%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 2.3326, Accuracy: 4577/10000 (45.7700%)
___Train Local_ResNet_18,  epoch 228, local model 2, internal_epoch   1,  Average loss: 0.0040, Accuracy: 430/461 (93.2755%)
___Train Local_ResNet_18,  epoch 228, local model 2, internal_epoch   2,  Average loss: 0.0051, Accuracy: 419/461 (90.8894%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 3.6254, Accuracy: 3732/10000 (37.3200%)
___Train Local_ResNet_18,  epoch 228, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 366/391 (93.6061%)
___Train Local_ResNet_18,  epoch 228, local model 99, internal_epoch   2,  Average loss: 0.0052, Accuracy: 359/391 (91.8159%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 4.4699, Accuracy: 3810/10000 (38.1000%)
___Train Local_ResNet_18,  epoch 228, local model 35, internal_epoch   1,  Average loss: 0.0033, Accuracy: 389/419 (92.8401%)
___Train Local_ResNet_18,  epoch 228, local model 35, internal_epoch   2,  Average loss: 0.0014, Accuracy: 409/419 (97.6134%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 5.4332, Accuracy: 2459/10000 (24.5900%)
___Train Local_ResNet_18,  epoch 228, local model 70, internal_epoch   1,  Average loss: 0.0029, Accuracy: 574/610 (94.0984%)
___Train Local_ResNet_18,  epoch 228, local model 70, internal_epoch   2,  Average loss: 0.0036, Accuracy: 573/610 (93.9344%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 3.6971, Accuracy: 3766/10000 (37.6600%)
___Train Local_ResNet_18,  epoch 228, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 419/447 (93.7360%)
___Train Local_ResNet_18,  epoch 228, local model 88, internal_epoch   2,  Average loss: 0.0024, Accuracy: 428/447 (95.7494%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 4.7099, Accuracy: 3273/10000 (32.7300%)
___Train Local_ResNet_18,  epoch 228, local model 50, internal_epoch   1,  Average loss: 0.0015, Accuracy: 396/401 (98.7531%)
___Train Local_ResNet_18,  epoch 228, local model 50, internal_epoch   2,  Average loss: 0.0004, Accuracy: 400/401 (99.7506%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 2.4142, Accuracy: 4959/10000 (49.5900%)
time spent on training: 94.25006246566772
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [436, 652, 469, 364, 461, 391, 419, 610, 447, 401]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [44, 40, 74, 85, 2, 99, 35, 70, 88, 50], weight: tensor([0.0938, 0.1402, 0.1009, 0.0783, 0.0991, 0.0841, 0.0901, 0.1312, 0.0961,
        0.0862])
[rfa agg] iter:  0, prev_obj_val: 20.967252731323242, obj_val: 28.858356475830078, abs dis: 7.891103744506836
[rfa agg] iter:  0, weight: tensor([0.1214, 0.0403, 0.0746, 0.1977, 0.0703, 0.0933, 0.1142, 0.0502, 0.1207,
        0.1173])
[rfa agg] iter:  1, prev_obj_val: 28.858356475830078, obj_val: 24.66446876525879, abs dis: 4.193887710571289
[rfa agg] iter:  1, weight: tensor([0.1133, 0.0546, 0.0828, 0.1792, 0.0796, 0.0961, 0.1081, 0.0651, 0.1153,
        0.1059])
[rfa agg] iter:  2, prev_obj_val: 24.66446876525879, obj_val: 28.857284545898438, abs dis: 4.192815780639648
[rfa agg] iter:  2, weight: tensor([0.1125, 0.0453, 0.0757, 0.2195, 0.0722, 0.0924, 0.1068, 0.0554, 0.1138,
        0.1063])
[rfa agg] iter:  3, prev_obj_val: 28.857284545898438, obj_val: 24.664447784423828, abs dis: 4.192836761474609
[rfa agg] iter:  3, weight: tensor([0.1131, 0.0546, 0.0828, 0.1798, 0.0796, 0.0960, 0.1080, 0.0651, 0.1152,
        0.1058])
[rfa agg] iter:  4, prev_obj_val: 24.664447784423828, obj_val: 28.857284545898438, abs dis: 4.192836761474609
[rfa agg] iter:  4, weight: tensor([0.1125, 0.0453, 0.0757, 0.2196, 0.0722, 0.0923, 0.1068, 0.0554, 0.1138,
        0.1063])
[rfa agg] iter:  5, prev_obj_val: 28.857284545898438, obj_val: 24.664451599121094, abs dis: 4.192832946777344
[rfa agg] iter:  5, weight: tensor([0.1131, 0.0546, 0.0828, 0.1798, 0.0796, 0.0960, 0.1080, 0.0651, 0.1152,
        0.1058])
[rfa agg] iter:  6, prev_obj_val: 24.664451599121094, obj_val: 28.857284545898438, abs dis: 4.192832946777344
[rfa agg] iter:  6, weight: tensor([0.1125, 0.0453, 0.0757, 0.2196, 0.0722, 0.0923, 0.1068, 0.0554, 0.1138,
        0.1063])
[rfa agg] iter:  7, prev_obj_val: 28.857284545898438, obj_val: 24.664451599121094, abs dis: 4.192832946777344
[rfa agg] iter:  7, weight: tensor([0.1131, 0.0546, 0.0828, 0.1798, 0.0796, 0.0960, 0.1080, 0.0651, 0.1152,
        0.1058])
[rfa agg] iter:  8, prev_obj_val: 24.664451599121094, obj_val: 28.857284545898438, abs dis: 4.192832946777344
[rfa agg] iter:  8, weight: tensor([0.1125, 0.0453, 0.0757, 0.2196, 0.0722, 0.0923, 0.1068, 0.0554, 0.1138,
        0.1063])
[rfa agg] iter:  9, prev_obj_val: 28.857284545898438, obj_val: 24.664451599121094, abs dis: 4.192832946777344
[rfa agg] iter:  9, weight: tensor([0.1131, 0.0546, 0.0828, 0.1798, 0.0796, 0.0960, 0.1080, 0.0651, 0.1152,
        0.1058])
___Test Target_ResNet_18 poisoned: False, epoch: 228: Average loss: 0.6546, Accuracy: 7816/10000 (78.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 228: Average loss: 5.0474, Accuracy: 612/9000 (6.8000%)
Done in 214.44392776489258 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:229 choose agents : [86, 60, 41, 79, 76, 67, 9, 40, 72, 44]. Adversary List: []
___Train Local_ResNet_18,  epoch 229, local model 86, internal_epoch   1,  Average loss: 0.0033, Accuracy: 208/212 (98.1132%)
___Train Local_ResNet_18,  epoch 229, local model 86, internal_epoch   2,  Average loss: 0.0021, Accuracy: 208/212 (98.1132%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 2.0196, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 229, local model 60, internal_epoch   1,  Average loss: 0.0020, Accuracy: 278/284 (97.8873%)
___Train Local_ResNet_18,  epoch 229, local model 60, internal_epoch   2,  Average loss: 0.0003, Accuracy: 284/284 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.7778, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 229, local model 41, internal_epoch   1,  Average loss: 0.0060, Accuracy: 441/513 (85.9649%)
___Train Local_ResNet_18,  epoch 229, local model 41, internal_epoch   2,  Average loss: 0.0239, Accuracy: 459/513 (89.4737%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 4.2828, Accuracy: 3543/10000 (35.4300%)
___Train Local_ResNet_18,  epoch 229, local model 79, internal_epoch   1,  Average loss: 0.0045, Accuracy: 136/154 (88.3117%)
___Train Local_ResNet_18,  epoch 229, local model 79, internal_epoch   2,  Average loss: 0.0009, Accuracy: 153/154 (99.3506%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.0165, Accuracy: 6996/10000 (69.9600%)
___Train Local_ResNet_18,  epoch 229, local model 76, internal_epoch   1,  Average loss: 0.0355, Accuracy: 63/65 (96.9231%)
___Train Local_ResNet_18,  epoch 229, local model 76, internal_epoch   2,  Average loss: 0.0472, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.0247, Accuracy: 6921/10000 (69.2100%)
___Train Local_ResNet_18,  epoch 229, local model 67, internal_epoch   1,  Average loss: 0.0024, Accuracy: 811/842 (96.3183%)
___Train Local_ResNet_18,  epoch 229, local model 67, internal_epoch   2,  Average loss: 0.0133, Accuracy: 667/842 (79.2162%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 28.5597, Accuracy: 1356/10000 (13.5600%)
___Train Local_ResNet_18,  epoch 229, local model 9, internal_epoch   1,  Average loss: 0.0027, Accuracy: 348/368 (94.5652%)
___Train Local_ResNet_18,  epoch 229, local model 9, internal_epoch   2,  Average loss: 0.0013, Accuracy: 361/368 (98.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 5.2358, Accuracy: 2719/10000 (27.1900%)
___Train Local_ResNet_18,  epoch 229, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 601/652 (92.1779%)
___Train Local_ResNet_18,  epoch 229, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 589/652 (90.3374%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 6.5579, Accuracy: 2570/10000 (25.7000%)
___Train Local_ResNet_18,  epoch 229, local model 72, internal_epoch   1,  Average loss: 0.0067, Accuracy: 530/618 (85.7605%)
___Train Local_ResNet_18,  epoch 229, local model 72, internal_epoch   2,  Average loss: 0.0064, Accuracy: 542/618 (87.7023%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 7.0571, Accuracy: 2548/10000 (25.4800%)
___Train Local_ResNet_18,  epoch 229, local model 44, internal_epoch   1,  Average loss: 0.0020, Accuracy: 420/436 (96.3303%)
___Train Local_ResNet_18,  epoch 229, local model 44, internal_epoch   2,  Average loss: 0.0006, Accuracy: 432/436 (99.0826%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.8753, Accuracy: 5361/10000 (53.6100%)
time spent on training: 93.78621888160706
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [212, 284, 513, 154, 65, 842, 368, 652, 618, 436]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [86, 60, 41, 79, 76, 67, 9, 40, 72, 44], weight: tensor([0.0512, 0.0685, 0.1238, 0.0372, 0.0157, 0.2032, 0.0888, 0.1573, 0.1491,
        0.1052])
[rfa agg] iter:  0, prev_obj_val: 32.03350067138672, obj_val: 41.417964935302734, abs dis: 9.384464263916016
[rfa agg] iter:  0, weight: tensor([0.0361, 0.0712, 0.1180, 0.0199, 0.0067, 0.0614, 0.1573, 0.0822, 0.0987,
        0.3485])
[rfa agg] iter:  1, prev_obj_val: 41.417964935302734, obj_val: 44.69403839111328, abs dis: 3.276073455810547
[rfa agg] iter:  1, weight: tensor([0.0977, 0.3477, 0.0641, 0.0388, 0.0111, 0.0473, 0.1666, 0.0551, 0.0615,
        0.1101])
[rfa agg] iter:  2, prev_obj_val: 44.69403839111328, obj_val: 44.689476013183594, abs dis: 0.0045623779296875
[rfa agg] iter:  2, weight: tensor([0.1828, 0.2819, 0.0635, 0.0570, 0.0147, 0.0498, 0.1332, 0.0565, 0.0624,
        0.0981])
___Test Target_ResNet_18 poisoned: False, epoch: 229: Average loss: 0.6498, Accuracy: 7844/10000 (78.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 229: Average loss: 5.1540, Accuracy: 574/9000 (6.3778%)
Done in 206.22729563713074 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:230 choose agents : [46, 96, 54, 39, 67, 82, 21, 80, 11, 33]. Adversary List: []
___Train Local_ResNet_18,  epoch 230, local model 46, internal_epoch   1,  Average loss: 0.0010, Accuracy: 594/601 (98.8353%)
___Train Local_ResNet_18,  epoch 230, local model 46, internal_epoch   2,  Average loss: 0.0005, Accuracy: 598/601 (99.5008%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.4318, Accuracy: 6055/10000 (60.5500%)
___Train Local_ResNet_18,  epoch 230, local model 96, internal_epoch   1,  Average loss: 0.0020, Accuracy: 682/708 (96.3277%)
___Train Local_ResNet_18,  epoch 230, local model 96, internal_epoch   2,  Average loss: 0.0033, Accuracy: 677/708 (95.6215%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 2.8827, Accuracy: 4283/10000 (42.8300%)
___Train Local_ResNet_18,  epoch 230, local model 54, internal_epoch   1,  Average loss: 0.0023, Accuracy: 424/440 (96.3636%)
___Train Local_ResNet_18,  epoch 230, local model 54, internal_epoch   2,  Average loss: 0.0006, Accuracy: 436/440 (99.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 2.6367, Accuracy: 4871/10000 (48.7100%)
___Train Local_ResNet_18,  epoch 230, local model 39, internal_epoch   1,  Average loss: 0.0023, Accuracy: 208/217 (95.8525%)
___Train Local_ResNet_18,  epoch 230, local model 39, internal_epoch   2,  Average loss: 0.0005, Accuracy: 216/217 (99.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.2377, Accuracy: 6409/10000 (64.0900%)
___Train Local_ResNet_18,  epoch 230, local model 67, internal_epoch   1,  Average loss: 0.0023, Accuracy: 808/842 (95.9620%)
___Train Local_ResNet_18,  epoch 230, local model 67, internal_epoch   2,  Average loss: 0.0201, Accuracy: 585/842 (69.4774%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 119.2870, Accuracy: 1275/10000 (12.7500%)
___Train Local_ResNet_18,  epoch 230, local model 82, internal_epoch   1,  Average loss: 0.0020, Accuracy: 584/601 (97.1714%)
___Train Local_ResNet_18,  epoch 230, local model 82, internal_epoch   2,  Average loss: 0.0015, Accuracy: 587/601 (97.6705%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 2.4574, Accuracy: 4851/10000 (48.5100%)
___Train Local_ResNet_18,  epoch 230, local model 21, internal_epoch   1,  Average loss: 0.0103, Accuracy: 250/262 (95.4198%)
___Train Local_ResNet_18,  epoch 230, local model 21, internal_epoch   2,  Average loss: 0.0256, Accuracy: 220/262 (83.9695%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 21.5964, Accuracy: 1137/10000 (11.3700%)
___Train Local_ResNet_18,  epoch 230, local model 80, internal_epoch   1,  Average loss: 0.0031, Accuracy: 343/363 (94.4904%)
___Train Local_ResNet_18,  epoch 230, local model 80, internal_epoch   2,  Average loss: 0.0009, Accuracy: 360/363 (99.1736%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 4.8569, Accuracy: 3513/10000 (35.1300%)
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 230, local model 11, internal_epoch   1,  Average loss: 0.0020, Accuracy: 529/546 (96.8864%)
___Train Local_ResNet_18,  epoch 230, local model 11, internal_epoch   2,  Average loss: 0.0023, Accuracy: 521/546 (95.4212%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.7066, Accuracy: 5663/10000 (56.6300%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 230, local model 33, internal_epoch   1,  Average loss: 0.0037, Accuracy: 493/527 (93.5484%)
___Train Local_ResNet_18,  epoch 230, local model 33, internal_epoch   2,  Average loss: 0.0030, Accuracy: 498/527 (94.4972%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 2.1185, Accuracy: 4999/10000 (49.9900%)
time spent on training: 121.54075312614441
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.21010377912668887  data num: [601, 708, 440, 217, 842, 601, 262, 363, 546, 527]
[rfa agg] considering poison per batch poison_fraction: 0.016414357744272568
[rfa agg] init. name: [46, 96, 54, 39, 67, 82, 21, 80, 11, 33], weight: tensor([0.1177, 0.1386, 0.0862, 0.0425, 0.1649, 0.1177, 0.0513, 0.0711, 0.1069,
        0.1032])
[rfa agg] iter:  0, prev_obj_val: 31.132375717163086, obj_val: 40.26567459106445, abs dis: 9.133298873901367
[rfa agg] iter:  0, weight: tensor([0.0854, 0.0608, 0.2926, 0.0310, 0.0503, 0.0843, 0.0480, 0.1326, 0.1106,
        0.1044])
[rfa agg] iter:  1, prev_obj_val: 40.26567459106445, obj_val: 36.763492584228516, abs dis: 3.5021820068359375
[rfa agg] iter:  1, weight: tensor([0.0695, 0.0566, 0.1481, 0.0733, 0.0501, 0.0691, 0.1031, 0.2733, 0.0802,
        0.0767])
[rfa agg] iter:  2, prev_obj_val: 36.763492584228516, obj_val: 36.75184631347656, abs dis: 0.011646270751953125
[rfa agg] iter:  2, weight: tensor([0.0622, 0.0488, 0.1648, 0.0445, 0.0422, 0.0617, 0.0714, 0.3601, 0.0739,
        0.0704])
[rfa agg] iter:  3, prev_obj_val: 36.75184631347656, obj_val: 36.75061798095703, abs dis: 0.00122833251953125
[rfa agg] iter:  3, weight: tensor([0.0589, 0.0462, 0.1571, 0.0421, 0.0399, 0.0584, 0.0662, 0.3944, 0.0700,
        0.0667])
[rfa agg] iter:  4, prev_obj_val: 36.75061798095703, obj_val: 36.75041961669922, abs dis: 0.0001983642578125
[rfa agg] iter:  4, weight: tensor([0.0576, 0.0452, 0.1535, 0.0412, 0.0391, 0.0572, 0.0645, 0.4081, 0.0685,
        0.0652])
___Test Target_ResNet_18 poisoned: False, epoch: 230: Average loss: 0.6440, Accuracy: 7868/10000 (78.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 230: Average loss: 5.1946, Accuracy: 557/9000 (6.1889%)
Done in 249.21320581436157 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:231 choose agents : [91, 23, 65, 69, 44, 38, 93, 2, 16, 36]. Adversary List: []
___Train Local_ResNet_18,  epoch 231, local model 91, internal_epoch   1,  Average loss: 0.0027, Accuracy: 224/234 (95.7265%)
___Train Local_ResNet_18,  epoch 231, local model 91, internal_epoch   2,  Average loss: 0.0004, Accuracy: 234/234 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.2538, Accuracy: 6327/10000 (63.2700%)
___Train Local_ResNet_18,  epoch 231, local model 23, internal_epoch   1,  Average loss: 0.0021, Accuracy: 244/248 (98.3871%)
___Train Local_ResNet_18,  epoch 231, local model 23, internal_epoch   2,  Average loss: 0.0004, Accuracy: 247/248 (99.5968%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.1029, Accuracy: 6731/10000 (67.3100%)
___Train Local_ResNet_18,  epoch 231, local model 65, internal_epoch   1,  Average loss: 0.0020, Accuracy: 308/314 (98.0892%)
___Train Local_ResNet_18,  epoch 231, local model 65, internal_epoch   2,  Average loss: 0.0004, Accuracy: 313/314 (99.6815%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 2.5376, Accuracy: 4972/10000 (49.7200%)
___Train Local_ResNet_18,  epoch 231, local model 69, internal_epoch   1,  Average loss: 0.0067, Accuracy: 194/216 (89.8148%)
___Train Local_ResNet_18,  epoch 231, local model 69, internal_epoch   2,  Average loss: 0.0007, Accuracy: 216/216 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 8.8467, Accuracy: 1193/10000 (11.9300%)
___Train Local_ResNet_18,  epoch 231, local model 44, internal_epoch   1,  Average loss: 0.0018, Accuracy: 424/436 (97.2477%)
___Train Local_ResNet_18,  epoch 231, local model 44, internal_epoch   2,  Average loss: 0.0005, Accuracy: 434/436 (99.5413%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.6027, Accuracy: 5821/10000 (58.2100%)
___Train Local_ResNet_18,  epoch 231, local model 38, internal_epoch   1,  Average loss: 0.0022, Accuracy: 724/756 (95.7672%)
___Train Local_ResNet_18,  epoch 231, local model 38, internal_epoch   2,  Average loss: 0.0029, Accuracy: 716/756 (94.7090%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 2.3827, Accuracy: 4881/10000 (48.8100%)
___Train Local_ResNet_18,  epoch 231, local model 93, internal_epoch   1,  Average loss: 0.0021, Accuracy: 566/584 (96.9178%)
___Train Local_ResNet_18,  epoch 231, local model 93, internal_epoch   2,  Average loss: 0.0020, Accuracy: 568/584 (97.2603%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 2.4851, Accuracy: 4727/10000 (47.2700%)
___Train Local_ResNet_18,  epoch 231, local model 2, internal_epoch   1,  Average loss: 0.0039, Accuracy: 425/461 (92.1909%)
___Train Local_ResNet_18,  epoch 231, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 424/461 (91.9740%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 3.2553, Accuracy: 3913/10000 (39.1300%)
___Train Local_ResNet_18,  epoch 231, local model 16, internal_epoch   1,  Average loss: 0.0059, Accuracy: 737/773 (95.3428%)
___Train Local_ResNet_18,  epoch 231, local model 16, internal_epoch   2,  Average loss: 0.0231, Accuracy: 493/773 (63.7775%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 243.6038, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 231, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 765/849 (90.1060%)
___Train Local_ResNet_18,  epoch 231, local model 36, internal_epoch   2,  Average loss: 0.0129, Accuracy: 651/849 (76.6784%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 9.3647, Accuracy: 2344/10000 (23.4400%)
time spent on training: 96.28296971321106
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [234, 248, 314, 216, 436, 756, 584, 461, 773, 849]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [91, 23, 65, 69, 44, 38, 93, 2, 16, 36], weight: tensor([0.0480, 0.0509, 0.0645, 0.0443, 0.0895, 0.1552, 0.1199, 0.0946, 0.1587,
        0.1743])
[rfa agg] iter:  0, prev_obj_val: 35.70246505737305, obj_val: 42.00694274902344, abs dis: 6.304477691650391
[rfa agg] iter:  0, weight: tensor([0.0346, 0.0367, 0.0641, 0.0318, 0.2689, 0.0864, 0.1161, 0.2257, 0.0690,
        0.0666])
[rfa agg] iter:  1, prev_obj_val: 42.00694274902344, obj_val: 47.240482330322266, abs dis: 5.233539581298828
[rfa agg] iter:  1, weight: tensor([0.0665, 0.0707, 0.1674, 0.0605, 0.2313, 0.0725, 0.0836, 0.1263, 0.0610,
        0.0602])
[rfa agg] iter:  2, prev_obj_val: 47.240482330322266, obj_val: 50.27253723144531, abs dis: 3.032054901123047
[rfa agg] iter:  2, weight: tensor([0.0959, 0.1028, 0.3792, 0.0843, 0.0937, 0.0470, 0.0507, 0.0653, 0.0407,
        0.0406])
[rfa agg] iter:  3, prev_obj_val: 50.27253723144531, obj_val: 53.66699981689453, abs dis: 3.3944625854492188
[rfa agg] iter:  3, weight: tensor([0.1638, 0.1790, 0.2372, 0.1328, 0.0725, 0.0422, 0.0444, 0.0541, 0.0370,
        0.0370])
[rfa agg] iter:  4, prev_obj_val: 53.66699981689453, obj_val: 70.97278594970703, abs dis: 17.3057861328125
[rfa agg] iter:  4, weight: tensor([0.2475, 0.2960, 0.0982, 0.1590, 0.0467, 0.0305, 0.0314, 0.0367, 0.0270,
        0.0271])
[rfa agg] iter:  5, prev_obj_val: 70.97278594970703, obj_val: 44.54876708984375, abs dis: 26.42401885986328
[rfa agg] iter:  5, weight: tensor([0.1291, 0.1371, 0.1159, 0.1176, 0.0967, 0.0838, 0.0809, 0.0847, 0.0764,
        0.0778])
[rfa agg] iter:  6, prev_obj_val: 44.54876708984375, obj_val: 50.28123092651367, abs dis: 5.732463836669922
[rfa agg] iter:  6, weight: tensor([0.0823, 0.0876, 0.2700, 0.0744, 0.1507, 0.0628, 0.0698, 0.0954, 0.0537,
        0.0532])
[rfa agg] iter:  7, prev_obj_val: 50.28123092651367, obj_val: 53.667232513427734, abs dis: 3.3860015869140625
[rfa agg] iter:  7, weight: tensor([0.1640, 0.1793, 0.2302, 0.1329, 0.0741, 0.0432, 0.0454, 0.0554, 0.0378,
        0.0378])
[rfa agg] iter:  8, prev_obj_val: 53.667232513427734, obj_val: 70.97271728515625, abs dis: 17.305484771728516
[rfa agg] iter:  8, weight: tensor([0.2473, 0.2956, 0.0983, 0.1591, 0.0468, 0.0306, 0.0314, 0.0368, 0.0270,
        0.0272])
[rfa agg] iter:  9, prev_obj_val: 70.97271728515625, obj_val: 44.54876708984375, abs dis: 26.4239501953125
[rfa agg] iter:  9, weight: tensor([0.1291, 0.1371, 0.1159, 0.1176, 0.0967, 0.0838, 0.0809, 0.0847, 0.0764,
        0.0778])
___Test Target_ResNet_18 poisoned: False, epoch: 231: Average loss: 0.6395, Accuracy: 7879/10000 (78.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 231: Average loss: 5.2288, Accuracy: 540/9000 (6.0000%)
Done in 232.28387069702148 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:232 choose agents : [36, 26, 95, 49, 48, 27, 74, 94, 29, 76]. Adversary List: []
___Train Local_ResNet_18,  epoch 232, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 792/849 (93.2862%)
___Train Local_ResNet_18,  epoch 232, local model 36, internal_epoch   2,  Average loss: 0.0166, Accuracy: 618/849 (72.7915%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 16.3777, Accuracy: 1903/10000 (19.0300%)
___Train Local_ResNet_18,  epoch 232, local model 26, internal_epoch   1,  Average loss: 0.0020, Accuracy: 453/468 (96.7949%)
___Train Local_ResNet_18,  epoch 232, local model 26, internal_epoch   2,  Average loss: 0.0008, Accuracy: 465/468 (99.3590%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 2.1186, Accuracy: 5059/10000 (50.5900%)
___Train Local_ResNet_18,  epoch 232, local model 95, internal_epoch   1,  Average loss: 0.0046, Accuracy: 516/569 (90.6854%)
___Train Local_ResNet_18,  epoch 232, local model 95, internal_epoch   2,  Average loss: 0.0036, Accuracy: 532/569 (93.4974%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 3.3781, Accuracy: 4070/10000 (40.7000%)
___Train Local_ResNet_18,  epoch 232, local model 49, internal_epoch   1,  Average loss: 0.0028, Accuracy: 406/426 (95.3052%)
___Train Local_ResNet_18,  epoch 232, local model 49, internal_epoch   2,  Average loss: 0.0019, Accuracy: 415/426 (97.4178%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 2.3049, Accuracy: 5103/10000 (51.0300%)
___Train Local_ResNet_18,  epoch 232, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 362/378 (95.7672%)
___Train Local_ResNet_18,  epoch 232, local model 48, internal_epoch   2,  Average loss: 0.0010, Accuracy: 370/378 (97.8836%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.9315, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 232, local model 27, internal_epoch   1,  Average loss: 0.0012, Accuracy: 394/397 (99.2443%)
___Train Local_ResNet_18,  epoch 232, local model 27, internal_epoch   2,  Average loss: 0.0008, Accuracy: 395/397 (99.4962%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.5622, Accuracy: 6091/10000 (60.9100%)
___Train Local_ResNet_18,  epoch 232, local model 74, internal_epoch   1,  Average loss: 0.0020, Accuracy: 453/469 (96.5885%)
___Train Local_ResNet_18,  epoch 232, local model 74, internal_epoch   2,  Average loss: 0.0010, Accuracy: 460/469 (98.0810%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.4357, Accuracy: 6034/10000 (60.3400%)
___Train Local_ResNet_18,  epoch 232, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 184/203 (90.6404%)
___Train Local_ResNet_18,  epoch 232, local model 94, internal_epoch   2,  Average loss: 0.0016, Accuracy: 197/203 (97.0443%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 3.0605, Accuracy: 3628/10000 (36.2800%)
___Train Local_ResNet_18,  epoch 232, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 770/848 (90.8019%)
___Train Local_ResNet_18,  epoch 232, local model 29, internal_epoch   2,  Average loss: 0.0057, Accuracy: 760/848 (89.6226%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 16.2533, Accuracy: 2309/10000 (23.0900%)
___Train Local_ResNet_18,  epoch 232, local model 76, internal_epoch   1,  Average loss: 0.0291, Accuracy: 63/65 (96.9231%)
___Train Local_ResNet_18,  epoch 232, local model 76, internal_epoch   2,  Average loss: 0.0417, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 2.0405, Accuracy: 4953/10000 (49.5300%)
time spent on training: 93.60811567306519
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [849, 468, 569, 426, 378, 397, 469, 203, 848, 65]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 26, 95, 49, 48, 27, 74, 94, 29, 76], weight: tensor([0.1817, 0.1002, 0.1218, 0.0912, 0.0809, 0.0850, 0.1004, 0.0435, 0.1815,
        0.0139])
[rfa agg] iter:  0, prev_obj_val: 28.712207794189453, obj_val: 37.179595947265625, abs dis: 8.467388153076172
[rfa agg] iter:  0, weight: tensor([0.0465, 0.2305, 0.1350, 0.1167, 0.0611, 0.1149, 0.2277, 0.0171, 0.0468,
        0.0037])
[rfa agg] iter:  1, prev_obj_val: 37.179595947265625, obj_val: 37.0969123840332, abs dis: 0.08268356323242188
[rfa agg] iter:  1, weight: tensor([0.0423, 0.0933, 0.0743, 0.1504, 0.3082, 0.1488, 0.0934, 0.0402, 0.0425,
        0.0066])
[rfa agg] iter:  2, prev_obj_val: 37.0969123840332, obj_val: 40.751068115234375, abs dis: 3.654155731201172
[rfa agg] iter:  2, weight: tensor([0.0377, 0.0826, 0.0657, 0.1371, 0.3804, 0.1342, 0.0825, 0.0360, 0.0379,
        0.0059])
[rfa agg] iter:  3, prev_obj_val: 40.751068115234375, obj_val: 44.583457946777344, abs dis: 3.8323898315429688
[rfa agg] iter:  3, weight: tensor([0.0482, 0.0906, 0.0774, 0.1322, 0.3138, 0.1262, 0.0906, 0.0635, 0.0484,
        0.0091])
[rfa agg] iter:  4, prev_obj_val: 44.583457946777344, obj_val: 48.47751235961914, abs dis: 3.894054412841797
[rfa agg] iter:  4, weight: tensor([0.0581, 0.0967, 0.0869, 0.1293, 0.2235, 0.1223, 0.0967, 0.1148, 0.0583,
        0.0135])
[rfa agg] iter:  5, prev_obj_val: 48.47751235961914, obj_val: 44.58212661743164, abs dis: 3.8953857421875
[rfa agg] iter:  5, weight: tensor([0.0604, 0.0911, 0.0851, 0.1146, 0.1673, 0.1079, 0.0912, 0.2043, 0.0606,
        0.0177])
[rfa agg] iter:  6, prev_obj_val: 44.58212661743164, obj_val: 48.47718048095703, abs dis: 3.8950538635253906
[rfa agg] iter:  6, weight: tensor([0.0583, 0.0970, 0.0873, 0.1294, 0.2183, 0.1226, 0.0971, 0.1179, 0.0585,
        0.0136])
[rfa agg] iter:  7, prev_obj_val: 48.47718048095703, obj_val: 44.5821418762207, abs dis: 3.895038604736328
[rfa agg] iter:  7, weight: tensor([0.0604, 0.0910, 0.0851, 0.1145, 0.1672, 0.1078, 0.0911, 0.2045, 0.0606,
        0.0177])
[rfa agg] iter:  8, prev_obj_val: 44.5821418762207, obj_val: 48.47718048095703, abs dis: 3.895038604736328
[rfa agg] iter:  8, weight: tensor([0.0583, 0.0970, 0.0873, 0.1294, 0.2183, 0.1226, 0.0971, 0.1179, 0.0585,
        0.0136])
[rfa agg] iter:  9, prev_obj_val: 48.47718048095703, obj_val: 44.5821418762207, abs dis: 3.895038604736328
[rfa agg] iter:  9, weight: tensor([0.0604, 0.0910, 0.0851, 0.1145, 0.1672, 0.1078, 0.0911, 0.2045, 0.0606,
        0.0177])
___Test Target_ResNet_18 poisoned: False, epoch: 232: Average loss: 0.6383, Accuracy: 7869/10000 (78.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 232: Average loss: 5.1798, Accuracy: 586/9000 (6.5111%)
Done in 231.33115220069885 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:233 choose agents : [70, 99, 76, 10, 58, 65, 75, 17, 11, 48]. Adversary List: []
___Train Local_ResNet_18,  epoch 233, local model 70, internal_epoch   1,  Average loss: 0.0025, Accuracy: 585/610 (95.9016%)
___Train Local_ResNet_18,  epoch 233, local model 70, internal_epoch   2,  Average loss: 0.0016, Accuracy: 593/610 (97.2131%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 2.0849, Accuracy: 5023/10000 (50.2300%)
___Train Local_ResNet_18,  epoch 233, local model 99, internal_epoch   1,  Average loss: 0.0035, Accuracy: 371/391 (94.8849%)
___Train Local_ResNet_18,  epoch 233, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 367/391 (93.8619%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 2.6523, Accuracy: 4645/10000 (46.4500%)
___Train Local_ResNet_18,  epoch 233, local model 76, internal_epoch   1,  Average loss: 0.0307, Accuracy: 63/65 (96.9231%)
___Train Local_ResNet_18,  epoch 233, local model 76, internal_epoch   2,  Average loss: 0.0513, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.6746, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 233, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 704/752 (93.6170%)
___Train Local_ResNet_18,  epoch 233, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 713/752 (94.8138%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 4.6975, Accuracy: 3551/10000 (35.5100%)
___Train Local_ResNet_18,  epoch 233, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 215/234 (91.8803%)
___Train Local_ResNet_18,  epoch 233, local model 58, internal_epoch   2,  Average loss: 0.0004, Accuracy: 234/234 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 4.4377, Accuracy: 2690/10000 (26.9000%)
___Train Local_ResNet_18,  epoch 233, local model 65, internal_epoch   1,  Average loss: 0.0017, Accuracy: 311/314 (99.0446%)
___Train Local_ResNet_18,  epoch 233, local model 65, internal_epoch   2,  Average loss: 0.0003, Accuracy: 314/314 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.1986, Accuracy: 6666/10000 (66.6600%)
___Train Local_ResNet_18,  epoch 233, local model 75, internal_epoch   1,  Average loss: 0.0112, Accuracy: 552/578 (95.5017%)
___Train Local_ResNet_18,  epoch 233, local model 75, internal_epoch   2,  Average loss: 0.0214, Accuracy: 367/578 (63.4948%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 29.4569, Accuracy: 1403/10000 (14.0300%)
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 233, local model 17, internal_epoch   1,  Average loss: 0.0015, Accuracy: 519/526 (98.6692%)
___Train Local_ResNet_18,  epoch 233, local model 17, internal_epoch   2,  Average loss: 0.0016, Accuracy: 512/526 (97.3384%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 2.3763, Accuracy: 5328/10000 (53.2800%)
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 233, local model 11, internal_epoch   1,  Average loss: 0.0019, Accuracy: 526/546 (96.3370%)
___Train Local_ResNet_18,  epoch 233, local model 11, internal_epoch   2,  Average loss: 0.0013, Accuracy: 531/546 (97.2527%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 3.1532, Accuracy: 4028/10000 (40.2800%)
___Train Local_ResNet_18,  epoch 233, local model 48, internal_epoch   1,  Average loss: 0.0019, Accuracy: 373/378 (98.6772%)
___Train Local_ResNet_18,  epoch 233, local model 48, internal_epoch   2,  Average loss: 0.0003, Accuracy: 378/378 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.7573, Accuracy: 5498/10000 (54.9800%)
time spent on training: 122.77290916442871
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.24396904870277653  data num: [610, 391, 65, 752, 234, 314, 578, 526, 546, 378]
[rfa agg] considering poison per batch poison_fraction: 0.019060081929904417
[rfa agg] init. name: [70, 99, 76, 10, 58, 65, 75, 17, 11, 48], weight: tensor([0.1388, 0.0890, 0.0148, 0.1711, 0.0533, 0.0715, 0.1315, 0.1197, 0.1243,
        0.0860])
[rfa agg] iter:  0, prev_obj_val: 25.72751808166504, obj_val: 36.22056579589844, abs dis: 10.493047714233398
[rfa agg] iter:  0, weight: tensor([0.0981, 0.2138, 0.0064, 0.0734, 0.0382, 0.0759, 0.0770, 0.1239, 0.1281,
        0.1651])
[rfa agg] iter:  1, prev_obj_val: 36.22056579589844, obj_val: 39.7847785949707, abs dis: 3.5642127990722656
[rfa agg] iter:  1, weight: tensor([0.0570, 0.0866, 0.0101, 0.0502, 0.0983, 0.3602, 0.0494, 0.0614, 0.0637,
        0.1631])
[rfa agg] iter:  2, prev_obj_val: 39.7847785949707, obj_val: 36.141929626464844, abs dis: 3.6428489685058594
[rfa agg] iter:  2, weight: tensor([0.0586, 0.0791, 0.0137, 0.0529, 0.1893, 0.2987, 0.0512, 0.0618, 0.0640,
        0.1307])
[rfa agg] iter:  3, prev_obj_val: 36.141929626464844, obj_val: 47.802406311035156, abs dis: 11.660476684570312
[rfa agg] iter:  3, weight: tensor([0.0480, 0.0715, 0.0086, 0.0422, 0.0866, 0.4559, 0.0413, 0.0517, 0.0536,
        0.1407])
[rfa agg] iter:  4, prev_obj_val: 47.802406311035156, obj_val: 36.17076873779297, abs dis: 11.631637573242188
[rfa agg] iter:  4, weight: tensor([0.0706, 0.0822, 0.0320, 0.0664, 0.2689, 0.1569, 0.0630, 0.0720, 0.0746,
        0.1133])
[rfa agg] iter:  5, prev_obj_val: 36.17076873779297, obj_val: 36.1286506652832, abs dis: 0.042118072509765625
[rfa agg] iter:  5, weight: tensor([0.0523, 0.0779, 0.0093, 0.0460, 0.0949, 0.4080, 0.0451, 0.0563, 0.0583,
        0.1518])
[rfa agg] iter:  6, prev_obj_val: 36.1286506652832, obj_val: 56.322792053222656, abs dis: 20.194141387939453
[rfa agg] iter:  6, weight: tensor([0.0445, 0.0663, 0.0079, 0.0391, 0.0793, 0.4960, 0.0383, 0.0479, 0.0496,
        0.1312])
[rfa agg] iter:  7, prev_obj_val: 56.322792053222656, obj_val: 39.79609680175781, abs dis: 16.526695251464844
[rfa agg] iter:  7, weight: tensor([0.0831, 0.0877, 0.1116, 0.0808, 0.1540, 0.1286, 0.0752, 0.0828, 0.0859,
        0.1104])
[rfa agg] iter:  8, prev_obj_val: 39.79609680175781, obj_val: 36.144371032714844, abs dis: 3.6517257690429688
[rfa agg] iter:  8, weight: tensor([0.0602, 0.0811, 0.0141, 0.0544, 0.1941, 0.2809, 0.0529, 0.0634, 0.0658,
        0.1330])
[rfa agg] iter:  9, prev_obj_val: 36.144371032714844, obj_val: 47.801631927490234, abs dis: 11.65726089477539
[rfa agg] iter:  9, weight: tensor([0.0486, 0.0724, 0.0087, 0.0427, 0.0877, 0.4492, 0.0419, 0.0523, 0.0542,
        0.1424])
___Test Target_ResNet_18 poisoned: False, epoch: 233: Average loss: 0.6380, Accuracy: 7874/10000 (78.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 233: Average loss: 5.2648, Accuracy: 523/9000 (5.8111%)
Done in 245.71592736244202 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:234 choose agents : [64, 16, 97, 52, 24, 10, 34, 27, 49, 56]. Adversary List: []
___Train Local_ResNet_18,  epoch 234, local model 64, internal_epoch   1,  Average loss: 0.0017, Accuracy: 668/686 (97.3761%)
___Train Local_ResNet_18,  epoch 234, local model 64, internal_epoch   2,  Average loss: 0.0012, Accuracy: 671/686 (97.8134%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.7238, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 234, local model 16, internal_epoch   1,  Average loss: 0.0016, Accuracy: 755/773 (97.6714%)
___Train Local_ResNet_18,  epoch 234, local model 16, internal_epoch   2,  Average loss: 0.0061, Accuracy: 686/773 (88.7451%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 7.1326, Accuracy: 3087/10000 (30.8700%)
___Train Local_ResNet_18,  epoch 234, local model 97, internal_epoch   1,  Average loss: 0.0018, Accuracy: 405/418 (96.8900%)
___Train Local_ResNet_18,  epoch 234, local model 97, internal_epoch   2,  Average loss: 0.0006, Accuracy: 416/418 (99.5215%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 2.0984, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 234, local model 52, internal_epoch   1,  Average loss: 0.0048, Accuracy: 204/214 (95.3271%)
___Train Local_ResNet_18,  epoch 234, local model 52, internal_epoch   2,  Average loss: 0.0013, Accuracy: 211/214 (98.5981%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 2.9998, Accuracy: 4196/10000 (41.9600%)
___Train Local_ResNet_18,  epoch 234, local model 24, internal_epoch   1,  Average loss: 0.0024, Accuracy: 308/320 (96.2500%)
___Train Local_ResNet_18,  epoch 234, local model 24, internal_epoch   2,  Average loss: 0.0004, Accuracy: 317/320 (99.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.6783, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 234, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 705/752 (93.7500%)
___Train Local_ResNet_18,  epoch 234, local model 10, internal_epoch   2,  Average loss: 0.0025, Accuracy: 711/752 (94.5479%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 5.7947, Accuracy: 2998/10000 (29.9800%)
___Train Local_ResNet_18,  epoch 234, local model 34, internal_epoch   1,  Average loss: 0.0030, Accuracy: 331/349 (94.8424%)
___Train Local_ResNet_18,  epoch 234, local model 34, internal_epoch   2,  Average loss: 0.0007, Accuracy: 347/349 (99.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 3.7356, Accuracy: 3919/10000 (39.1900%)
___Train Local_ResNet_18,  epoch 234, local model 27, internal_epoch   1,  Average loss: 0.0030, Accuracy: 389/397 (97.9849%)
___Train Local_ResNet_18,  epoch 234, local model 27, internal_epoch   2,  Average loss: 0.0018, Accuracy: 387/397 (97.4811%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.9513, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 234, local model 49, internal_epoch   1,  Average loss: 0.0017, Accuracy: 416/426 (97.6526%)
___Train Local_ResNet_18,  epoch 234, local model 49, internal_epoch   2,  Average loss: 0.0007, Accuracy: 420/426 (98.5915%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 2.0046, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 234, local model 56, internal_epoch   1,  Average loss: 0.0013, Accuracy: 733/743 (98.6541%)
___Train Local_ResNet_18,  epoch 234, local model 56, internal_epoch   2,  Average loss: 0.0012, Accuracy: 732/743 (98.5195%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.3672, Accuracy: 6452/10000 (64.5200%)
time spent on training: 102.15360808372498
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [686, 773, 418, 214, 320, 752, 349, 397, 426, 743]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [64, 16, 97, 52, 24, 10, 34, 27, 49, 56], weight: tensor([0.1351, 0.1522, 0.0823, 0.0421, 0.0630, 0.1481, 0.0687, 0.0782, 0.0839,
        0.1463])
[rfa agg] iter:  0, prev_obj_val: 30.799800872802734, obj_val: 35.87111282348633, abs dis: 5.071311950683594
[rfa agg] iter:  0, weight: tensor([0.0502, 0.0376, 0.2343, 0.0209, 0.0464, 0.0438, 0.0893, 0.1787, 0.2549,
        0.0439])
[rfa agg] iter:  1, prev_obj_val: 35.87111282348633, obj_val: 35.83653259277344, abs dis: 0.034580230712890625
[rfa agg] iter:  1, weight: tensor([0.0507, 0.0406, 0.1446, 0.0388, 0.1112, 0.0461, 0.2432, 0.1299, 0.1488,
        0.0460])
[rfa agg] iter:  2, prev_obj_val: 35.83653259277344, obj_val: 39.13422393798828, abs dis: 3.2976913452148438
[rfa agg] iter:  2, weight: tensor([0.0484, 0.0387, 0.1359, 0.0371, 0.1070, 0.0439, 0.2830, 0.1224, 0.1398,
        0.0439])
[rfa agg] iter:  3, prev_obj_val: 39.13422393798828, obj_val: 39.127201080322266, abs dis: 0.007022857666015625
[rfa agg] iter:  3, weight: tensor([0.0510, 0.0419, 0.1100, 0.0561, 0.2115, 0.0471, 0.2213, 0.1017, 0.1126,
        0.0470])
[rfa agg] iter:  4, prev_obj_val: 39.127201080322266, obj_val: 39.12713623046875, abs dis: 6.4849853515625e-05
[rfa agg] iter:  4, weight: tensor([0.0509, 0.0418, 0.1096, 0.0561, 0.2206, 0.0469, 0.2137, 0.1012, 0.1122,
        0.0468])
___Test Target_ResNet_18 poisoned: False, epoch: 234: Average loss: 0.6325, Accuracy: 7916/10000 (79.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 234: Average loss: 5.3501, Accuracy: 489/9000 (5.4333%)
Done in 227.44867849349976 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:235 choose agents : [48, 14, 45, 65, 37, 38, 24, 99, 56, 20]. Adversary List: []
___Train Local_ResNet_18,  epoch 235, local model 48, internal_epoch   1,  Average loss: 0.0019, Accuracy: 367/378 (97.0899%)
___Train Local_ResNet_18,  epoch 235, local model 48, internal_epoch   2,  Average loss: 0.0004, Accuracy: 377/378 (99.7354%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.6277, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 235, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 291/318 (91.5094%)
___Train Local_ResNet_18,  epoch 235, local model 14, internal_epoch   2,  Average loss: 0.0006, Accuracy: 313/318 (98.4277%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 4.5789, Accuracy: 3333/10000 (33.3300%)
___Train Local_ResNet_18,  epoch 235, local model 45, internal_epoch   1,  Average loss: 0.0044, Accuracy: 495/529 (93.5728%)
___Train Local_ResNet_18,  epoch 235, local model 45, internal_epoch   2,  Average loss: 0.0110, Accuracy: 430/529 (81.2854%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 12.9483, Accuracy: 1487/10000 (14.8700%)
___Train Local_ResNet_18,  epoch 235, local model 65, internal_epoch   1,  Average loss: 0.0012, Accuracy: 314/314 (100.0000%)
___Train Local_ResNet_18,  epoch 235, local model 65, internal_epoch   2,  Average loss: 0.0002, Accuracy: 314/314 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.0857, Accuracy: 6922/10000 (69.2200%)
___Train Local_ResNet_18,  epoch 235, local model 37, internal_epoch   1,  Average loss: 0.0047, Accuracy: 667/725 (92.0000%)
___Train Local_ResNet_18,  epoch 235, local model 37, internal_epoch   2,  Average loss: 0.0180, Accuracy: 541/725 (74.6207%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 30.2415, Accuracy: 1694/10000 (16.9400%)
___Train Local_ResNet_18,  epoch 235, local model 38, internal_epoch   1,  Average loss: 0.0018, Accuracy: 735/756 (97.2222%)
___Train Local_ResNet_18,  epoch 235, local model 38, internal_epoch   2,  Average loss: 0.0029, Accuracy: 718/756 (94.9735%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 2.2983, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch 235, local model 24, internal_epoch   1,  Average loss: 0.0022, Accuracy: 309/320 (96.5625%)
___Train Local_ResNet_18,  epoch 235, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 319/320 (99.6875%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.5594, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 235, local model 99, internal_epoch   1,  Average loss: 0.0057, Accuracy: 363/391 (92.8389%)
___Train Local_ResNet_18,  epoch 235, local model 99, internal_epoch   2,  Average loss: 0.0162, Accuracy: 312/391 (79.7954%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 23.2605, Accuracy: 1707/10000 (17.0700%)
___Train Local_ResNet_18,  epoch 235, local model 56, internal_epoch   1,  Average loss: 0.0009, Accuracy: 735/743 (98.9233%)
___Train Local_ResNet_18,  epoch 235, local model 56, internal_epoch   2,  Average loss: 0.0006, Accuracy: 738/743 (99.3271%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.1683, Accuracy: 6679/10000 (66.7900%)
___Train Local_ResNet_18,  epoch 235, local model 20, internal_epoch   1,  Average loss: 0.0039, Accuracy: 340/362 (93.9227%)
___Train Local_ResNet_18,  epoch 235, local model 20, internal_epoch   2,  Average loss: 0.0011, Accuracy: 355/362 (98.0663%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 5.0842, Accuracy: 3722/10000 (37.2200%)
time spent on training: 96.33606576919556
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [378, 318, 529, 314, 725, 756, 320, 391, 743, 362]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [48, 14, 45, 65, 37, 38, 24, 99, 56, 20], weight: tensor([0.0782, 0.0658, 0.1094, 0.0649, 0.1499, 0.1563, 0.0662, 0.0809, 0.1536,
        0.0749])
[rfa agg] iter:  0, prev_obj_val: 34.71772766113281, obj_val: 54.233455657958984, abs dis: 19.515727996826172
[rfa agg] iter:  0, weight: tensor([0.1774, 0.1346, 0.0485, 0.1603, 0.0369, 0.0393, 0.1564, 0.0609, 0.0388,
        0.1470])
[rfa agg] iter:  1, prev_obj_val: 54.233455657958984, obj_val: 37.40652847290039, abs dis: 16.826927185058594
[rfa agg] iter:  1, weight: tensor([0.1103, 0.1362, 0.0760, 0.1373, 0.0696, 0.0737, 0.1394, 0.0801, 0.0727,
        0.1048])
[rfa agg] iter:  2, prev_obj_val: 37.40652847290039, obj_val: 54.24385070800781, abs dis: 16.837322235107422
[rfa agg] iter:  2, weight: tensor([0.0928, 0.1632, 0.0335, 0.2674, 0.0267, 0.0285, 0.2356, 0.0409, 0.0282,
        0.0831])
[rfa agg] iter:  3, prev_obj_val: 54.24385070800781, obj_val: 37.40608596801758, abs dis: 16.837764739990234
[rfa agg] iter:  3, weight: tensor([0.1102, 0.1365, 0.0759, 0.1376, 0.0695, 0.0736, 0.1397, 0.0798, 0.0726,
        0.1045])
[rfa agg] iter:  4, prev_obj_val: 37.40608596801758, obj_val: 54.243873596191406, abs dis: 16.837787628173828
[rfa agg] iter:  4, weight: tensor([0.0928, 0.1632, 0.0335, 0.2675, 0.0267, 0.0285, 0.2357, 0.0409, 0.0282,
        0.0830])
[rfa agg] iter:  5, prev_obj_val: 54.243873596191406, obj_val: 37.40608596801758, abs dis: 16.837787628173828
[rfa agg] iter:  5, weight: tensor([0.1102, 0.1365, 0.0759, 0.1376, 0.0695, 0.0736, 0.1397, 0.0798, 0.0726,
        0.1045])
[rfa agg] iter:  6, prev_obj_val: 37.40608596801758, obj_val: 54.243873596191406, abs dis: 16.837787628173828
[rfa agg] iter:  6, weight: tensor([0.0928, 0.1632, 0.0335, 0.2675, 0.0267, 0.0285, 0.2357, 0.0409, 0.0282,
        0.0830])
[rfa agg] iter:  7, prev_obj_val: 54.243873596191406, obj_val: 37.40608596801758, abs dis: 16.837787628173828
[rfa agg] iter:  7, weight: tensor([0.1102, 0.1365, 0.0759, 0.1376, 0.0695, 0.0736, 0.1397, 0.0798, 0.0726,
        0.1045])
[rfa agg] iter:  8, prev_obj_val: 37.40608596801758, obj_val: 54.243873596191406, abs dis: 16.837787628173828
[rfa agg] iter:  8, weight: tensor([0.0928, 0.1632, 0.0335, 0.2675, 0.0267, 0.0285, 0.2357, 0.0409, 0.0282,
        0.0830])
[rfa agg] iter:  9, prev_obj_val: 54.243873596191406, obj_val: 37.40608596801758, abs dis: 16.837787628173828
[rfa agg] iter:  9, weight: tensor([0.1102, 0.1365, 0.0759, 0.1376, 0.0695, 0.0736, 0.1397, 0.0798, 0.0726,
        0.1045])
___Test Target_ResNet_18 poisoned: False, epoch: 235: Average loss: 0.6327, Accuracy: 7917/10000 (79.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 235: Average loss: 5.3885, Accuracy: 488/9000 (5.4222%)
Done in 232.45837473869324 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:236 choose agents : [0, 86, 37, 20, 36, 50, 78, 63, 83, 4]. Adversary List: []
___Train Local_ResNet_18,  epoch 236, local model 0, internal_epoch   1,  Average loss: 0.0025, Accuracy: 357/367 (97.2752%)
___Train Local_ResNet_18,  epoch 236, local model 0, internal_epoch   2,  Average loss: 0.0014, Accuracy: 359/367 (97.8202%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 2.9695, Accuracy: 3897/10000 (38.9700%)
___Train Local_ResNet_18,  epoch 236, local model 86, internal_epoch   1,  Average loss: 0.0024, Accuracy: 210/212 (99.0566%)
___Train Local_ResNet_18,  epoch 236, local model 86, internal_epoch   2,  Average loss: 0.0011, Accuracy: 210/212 (99.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.0213, Accuracy: 7030/10000 (70.3000%)
___Train Local_ResNet_18,  epoch 236, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 665/725 (91.7241%)
___Train Local_ResNet_18,  epoch 236, local model 37, internal_epoch   2,  Average loss: 0.0102, Accuracy: 619/725 (85.3793%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 4.6444, Accuracy: 3360/10000 (33.6000%)
___Train Local_ResNet_18,  epoch 236, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 325/362 (89.7790%)
___Train Local_ResNet_18,  epoch 236, local model 20, internal_epoch   2,  Average loss: 0.0023, Accuracy: 350/362 (96.6851%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 6.2138, Accuracy: 2422/10000 (24.2200%)
___Train Local_ResNet_18,  epoch 236, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 799/849 (94.1107%)
___Train Local_ResNet_18,  epoch 236, local model 36, internal_epoch   2,  Average loss: 0.0094, Accuracy: 708/849 (83.3922%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 4.5062, Accuracy: 3567/10000 (35.6700%)
___Train Local_ResNet_18,  epoch 236, local model 50, internal_epoch   1,  Average loss: 0.0016, Accuracy: 392/401 (97.7556%)
___Train Local_ResNet_18,  epoch 236, local model 50, internal_epoch   2,  Average loss: 0.0009, Accuracy: 395/401 (98.5037%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.7055, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 236, local model 78, internal_epoch   1,  Average loss: 0.0029, Accuracy: 242/255 (94.9020%)
___Train Local_ResNet_18,  epoch 236, local model 78, internal_epoch   2,  Average loss: 0.0008, Accuracy: 252/255 (98.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 2.5367, Accuracy: 4749/10000 (47.4900%)
___Train Local_ResNet_18,  epoch 236, local model 63, internal_epoch   1,  Average loss: 0.0010, Accuracy: 740/752 (98.4043%)
___Train Local_ResNet_18,  epoch 236, local model 63, internal_epoch   2,  Average loss: 0.0012, Accuracy: 733/752 (97.4734%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.4739, Accuracy: 6159/10000 (61.5900%)
___Train Local_ResNet_18,  epoch 236, local model 83, internal_epoch   1,  Average loss: 0.0008, Accuracy: 365/366 (99.7268%)
___Train Local_ResNet_18,  epoch 236, local model 83, internal_epoch   2,  Average loss: 0.0002, Accuracy: 366/366 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 0.7963, Accuracy: 7477/10000 (74.7700%)
___Train Local_ResNet_18,  epoch 236, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 520/557 (93.3573%)
___Train Local_ResNet_18,  epoch 236, local model 4, internal_epoch   2,  Average loss: 0.0025, Accuracy: 532/557 (95.5117%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 2.6172, Accuracy: 4945/10000 (49.4500%)
time spent on training: 94.92805886268616
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [367, 212, 725, 362, 849, 401, 255, 752, 366, 557]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [0, 86, 37, 20, 36, 50, 78, 63, 83, 4], weight: tensor([0.0757, 0.0437, 0.1496, 0.0747, 0.1752, 0.0827, 0.0526, 0.1552, 0.0755,
        0.1149])
[rfa agg] iter:  0, prev_obj_val: 34.187538146972656, obj_val: 38.995384216308594, abs dis: 4.8078460693359375
[rfa agg] iter:  0, weight: tensor([0.1716, 0.0302, 0.0466, 0.1567, 0.0405, 0.1900, 0.0362, 0.0493, 0.2023,
        0.0765])
[rfa agg] iter:  1, prev_obj_val: 38.995384216308594, obj_val: 42.436485290527344, abs dis: 3.44110107421875
[rfa agg] iter:  1, weight: tensor([0.2007, 0.0502, 0.0399, 0.1813, 0.0359, 0.0940, 0.0600, 0.0421, 0.2392,
        0.0566])
[rfa agg] iter:  2, prev_obj_val: 42.436485290527344, obj_val: 45.99221420288086, abs dis: 3.5557289123535156
[rfa agg] iter:  2, weight: tensor([0.1620, 0.0958, 0.0486, 0.1547, 0.0446, 0.0935, 0.1138, 0.0513, 0.1705,
        0.0653])
[rfa agg] iter:  3, prev_obj_val: 45.99221420288086, obj_val: 42.43828201293945, abs dis: 3.5539321899414062
[rfa agg] iter:  3, weight: tensor([0.1158, 0.1735, 0.0469, 0.1124, 0.0435, 0.0778, 0.2021, 0.0493, 0.1188,
        0.0600])
[rfa agg] iter:  4, prev_obj_val: 42.43828201293945, obj_val: 45.991859436035156, abs dis: 3.553577423095703
[rfa agg] iter:  4, weight: tensor([0.1596, 0.0973, 0.0488, 0.1525, 0.0447, 0.0937, 0.1161, 0.0514, 0.1705,
        0.0654])
[rfa agg] iter:  5, prev_obj_val: 45.991859436035156, obj_val: 42.438297271728516, abs dis: 3.5535621643066406
[rfa agg] iter:  5, weight: tensor([0.1157, 0.1735, 0.0469, 0.1123, 0.0435, 0.0778, 0.2022, 0.0493, 0.1187,
        0.0600])
[rfa agg] iter:  6, prev_obj_val: 42.438297271728516, obj_val: 45.99186325073242, abs dis: 3.5535659790039062
[rfa agg] iter:  6, weight: tensor([0.1596, 0.0973, 0.0488, 0.1525, 0.0447, 0.0937, 0.1161, 0.0514, 0.1705,
        0.0654])
[rfa agg] iter:  7, prev_obj_val: 45.99186325073242, obj_val: 42.438297271728516, abs dis: 3.5535659790039062
[rfa agg] iter:  7, weight: tensor([0.1157, 0.1735, 0.0469, 0.1123, 0.0435, 0.0778, 0.2022, 0.0493, 0.1187,
        0.0600])
[rfa agg] iter:  8, prev_obj_val: 42.438297271728516, obj_val: 45.99186325073242, abs dis: 3.5535659790039062
[rfa agg] iter:  8, weight: tensor([0.1596, 0.0973, 0.0488, 0.1525, 0.0447, 0.0937, 0.1161, 0.0514, 0.1705,
        0.0654])
[rfa agg] iter:  9, prev_obj_val: 45.99186325073242, obj_val: 42.438297271728516, abs dis: 3.5535659790039062
[rfa agg] iter:  9, weight: tensor([0.1157, 0.1735, 0.0469, 0.1123, 0.0435, 0.0778, 0.2022, 0.0493, 0.1187,
        0.0600])
___Test Target_ResNet_18 poisoned: False, epoch: 236: Average loss: 0.6309, Accuracy: 7929/10000 (79.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 236: Average loss: 5.4445, Accuracy: 471/9000 (5.2333%)
Done in 233.23897671699524 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:237 choose agents : [1, 0, 37, 91, 77, 21, 13, 70, 54, 57]. Adversary List: []
___Train Local_ResNet_18,  epoch 237, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 624/641 (97.3479%)
___Train Local_ResNet_18,  epoch 237, local model 1, internal_epoch   2,  Average loss: 0.0103, Accuracy: 589/641 (91.8877%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 3.2385, Accuracy: 3730/10000 (37.3000%)
___Train Local_ResNet_18,  epoch 237, local model 0, internal_epoch   1,  Average loss: 0.0017, Accuracy: 362/367 (98.6376%)
___Train Local_ResNet_18,  epoch 237, local model 0, internal_epoch   2,  Average loss: 0.0008, Accuracy: 363/367 (98.9101%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 2.6042, Accuracy: 4282/10000 (42.8200%)
___Train Local_ResNet_18,  epoch 237, local model 37, internal_epoch   1,  Average loss: 0.0046, Accuracy: 663/725 (91.4483%)
___Train Local_ResNet_18,  epoch 237, local model 37, internal_epoch   2,  Average loss: 0.0094, Accuracy: 599/725 (82.6207%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 28.7843, Accuracy: 1368/10000 (13.6800%)
___Train Local_ResNet_18,  epoch 237, local model 91, internal_epoch   1,  Average loss: 0.0021, Accuracy: 226/234 (96.5812%)
___Train Local_ResNet_18,  epoch 237, local model 91, internal_epoch   2,  Average loss: 0.0005, Accuracy: 233/234 (99.5726%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 0.9831, Accuracy: 6985/10000 (69.8500%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 237, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 494/496 (99.5968%)
___Train Local_ResNet_18,  epoch 237, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 496/496 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.1493, Accuracy: 6829/10000 (68.2900%)
___Train Local_ResNet_18,  epoch 237, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 250/262 (95.4198%)
___Train Local_ResNet_18,  epoch 237, local model 21, internal_epoch   2,  Average loss: 0.0070, Accuracy: 253/262 (96.5649%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 4.9484, Accuracy: 3311/10000 (33.1100%)
___Train Local_ResNet_18,  epoch 237, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 576/620 (92.9032%)
___Train Local_ResNet_18,  epoch 237, local model 13, internal_epoch   2,  Average loss: 0.0027, Accuracy: 583/620 (94.0323%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 3.3620, Accuracy: 4104/10000 (41.0400%)
___Train Local_ResNet_18,  epoch 237, local model 70, internal_epoch   1,  Average loss: 0.0024, Accuracy: 584/610 (95.7377%)
___Train Local_ResNet_18,  epoch 237, local model 70, internal_epoch   2,  Average loss: 0.0019, Accuracy: 581/610 (95.2459%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 2.5553, Accuracy: 4877/10000 (48.7700%)
___Train Local_ResNet_18,  epoch 237, local model 54, internal_epoch   1,  Average loss: 0.0020, Accuracy: 429/440 (97.5000%)
___Train Local_ResNet_18,  epoch 237, local model 54, internal_epoch   2,  Average loss: 0.0011, Accuracy: 433/440 (98.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 3.3402, Accuracy: 4478/10000 (44.7800%)
___Train Local_ResNet_18,  epoch 237, local model 57, internal_epoch   1,  Average loss: 0.0017, Accuracy: 289/290 (99.6552%)
___Train Local_ResNet_18,  epoch 237, local model 57, internal_epoch   2,  Average loss: 0.0004, Accuracy: 288/290 (99.3103%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.2444, Accuracy: 6612/10000 (66.1200%)
time spent on training: 106.93969988822937
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10586979722518676  data num: [641, 367, 725, 234, 496, 262, 620, 610, 440, 290]
[rfa agg] considering poison per batch poison_fraction: 0.008271077908217716
[rfa agg] init. name: [1, 0, 37, 91, 77, 21, 13, 70, 54, 57], weight: tensor([0.1368, 0.0783, 0.1547, 0.0499, 0.1059, 0.0559, 0.1323, 0.1302, 0.0939,
        0.0619])
[rfa agg] iter:  0, prev_obj_val: 29.789518356323242, obj_val: 32.451168060302734, abs dis: 2.661649703979492
[rfa agg] iter:  0, weight: tensor([0.0508, 0.2922, 0.0473, 0.0460, 0.0974, 0.0832, 0.0606, 0.0601, 0.1547,
        0.1077])
[rfa agg] iter:  1, prev_obj_val: 32.451168060302734, obj_val: 39.30309295654297, abs dis: 6.851924896240234
[rfa agg] iter:  1, weight: tensor([0.0453, 0.2422, 0.0428, 0.0600, 0.0776, 0.1192, 0.0531, 0.0526, 0.1109,
        0.1965])
[rfa agg] iter:  2, prev_obj_val: 39.30309295654297, obj_val: 35.59362030029297, abs dis: 3.70947265625
[rfa agg] iter:  2, weight: tensor([0.0449, 0.1097, 0.0435, 0.1781, 0.0649, 0.1433, 0.0510, 0.0504, 0.0795,
        0.2347])
[rfa agg] iter:  3, prev_obj_val: 35.59362030029297, obj_val: 51.98807907104492, abs dis: 16.394458770751953
[rfa agg] iter:  3, weight: tensor([0.0361, 0.1166, 0.0346, 0.0767, 0.0562, 0.1376, 0.0416, 0.0412, 0.0732,
        0.3861])
[rfa agg] iter:  4, prev_obj_val: 51.98807907104492, obj_val: 35.61839294433594, abs dis: 16.369686126708984
[rfa agg] iter:  4, weight: tensor([0.0690, 0.1052, 0.0688, 0.1928, 0.0858, 0.1079, 0.0760, 0.0750, 0.0947,
        0.1250])
[rfa agg] iter:  5, prev_obj_val: 35.61839294433594, obj_val: 51.985801696777344, abs dis: 16.367408752441406
[rfa agg] iter:  5, weight: tensor([0.0386, 0.1240, 0.0370, 0.0817, 0.0601, 0.1392, 0.0445, 0.0440, 0.0782,
        0.3527])
[rfa agg] iter:  6, prev_obj_val: 51.985801696777344, obj_val: 35.618408203125, abs dis: 16.367393493652344
[rfa agg] iter:  6, weight: tensor([0.0690, 0.1052, 0.0688, 0.1928, 0.0858, 0.1079, 0.0760, 0.0750, 0.0947,
        0.1249])
[rfa agg] iter:  7, prev_obj_val: 35.618408203125, obj_val: 51.985801696777344, abs dis: 16.367393493652344
[rfa agg] iter:  7, weight: tensor([0.0386, 0.1240, 0.0370, 0.0817, 0.0601, 0.1392, 0.0445, 0.0440, 0.0782,
        0.3527])
[rfa agg] iter:  8, prev_obj_val: 51.985801696777344, obj_val: 35.618408203125, abs dis: 16.367393493652344
[rfa agg] iter:  8, weight: tensor([0.0690, 0.1052, 0.0688, 0.1928, 0.0858, 0.1079, 0.0760, 0.0750, 0.0947,
        0.1249])
[rfa agg] iter:  9, prev_obj_val: 35.618408203125, obj_val: 51.985801696777344, abs dis: 16.367393493652344
[rfa agg] iter:  9, weight: tensor([0.0386, 0.1240, 0.0370, 0.0817, 0.0601, 0.1392, 0.0445, 0.0440, 0.0782,
        0.3527])
___Test Target_ResNet_18 poisoned: False, epoch: 237: Average loss: 0.6306, Accuracy: 7925/10000 (79.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 237: Average loss: 5.5174, Accuracy: 488/9000 (5.4222%)
Done in 234.93059921264648 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:238 choose agents : [41, 28, 85, 59, 89, 31, 33, 42, 82, 68]. Adversary List: []
___Train Local_ResNet_18,  epoch 238, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 469/513 (91.4230%)
___Train Local_ResNet_18,  epoch 238, local model 41, internal_epoch   2,  Average loss: 0.0032, Accuracy: 478/513 (93.1774%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 4.0189, Accuracy: 3421/10000 (34.2100%)
___Train Local_ResNet_18,  epoch 238, local model 28, internal_epoch   1,  Average loss: 0.0011, Accuracy: 418/423 (98.8180%)
___Train Local_ResNet_18,  epoch 238, local model 28, internal_epoch   2,  Average loss: 0.0005, Accuracy: 422/423 (99.7636%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.9039, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 238, local model 85, internal_epoch   1,  Average loss: 0.0027, Accuracy: 350/364 (96.1538%)
___Train Local_ResNet_18,  epoch 238, local model 85, internal_epoch   2,  Average loss: 0.0022, Accuracy: 352/364 (96.7033%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 4.1635, Accuracy: 2955/10000 (29.5500%)
___Train Local_ResNet_18,  epoch 238, local model 59, internal_epoch   1,  Average loss: 0.0019, Accuracy: 618/642 (96.2617%)
___Train Local_ResNet_18,  epoch 238, local model 59, internal_epoch   2,  Average loss: 0.0018, Accuracy: 629/642 (97.9751%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 3.4767, Accuracy: 3950/10000 (39.5000%)
___Train Local_ResNet_18,  epoch 238, local model 89, internal_epoch   1,  Average loss: 0.0033, Accuracy: 387/413 (93.7046%)
___Train Local_ResNet_18,  epoch 238, local model 89, internal_epoch   2,  Average loss: 0.0008, Accuracy: 410/413 (99.2736%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 3.7043, Accuracy: 3506/10000 (35.0600%)
___Train Local_ResNet_18,  epoch 238, local model 31, internal_epoch   1,  Average loss: 0.0052, Accuracy: 682/706 (96.6006%)
___Train Local_ResNet_18,  epoch 238, local model 31, internal_epoch   2,  Average loss: 0.0253, Accuracy: 475/706 (67.2805%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 34.3979, Accuracy: 1360/10000 (13.6000%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 238, local model 33, internal_epoch   1,  Average loss: 0.0032, Accuracy: 501/527 (95.0664%)
___Train Local_ResNet_18,  epoch 238, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 488/527 (92.5996%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 2.5451, Accuracy: 4434/10000 (44.3400%)
___Train Local_ResNet_18,  epoch 238, local model 42, internal_epoch   1,  Average loss: 0.0037, Accuracy: 193/198 (97.4747%)
___Train Local_ResNet_18,  epoch 238, local model 42, internal_epoch   2,  Average loss: 0.0031, Accuracy: 194/198 (97.9798%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 3.9171, Accuracy: 3465/10000 (34.6500%)
___Train Local_ResNet_18,  epoch 238, local model 82, internal_epoch   1,  Average loss: 0.0026, Accuracy: 579/601 (96.3394%)
___Train Local_ResNet_18,  epoch 238, local model 82, internal_epoch   2,  Average loss: 0.0026, Accuracy: 570/601 (94.8419%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 3.8210, Accuracy: 3508/10000 (35.0800%)
___Train Local_ResNet_18,  epoch 238, local model 68, internal_epoch   1,  Average loss: 0.0007, Accuracy: 416/416 (100.0000%)
___Train Local_ResNet_18,  epoch 238, local model 68, internal_epoch   2,  Average loss: 0.0003, Accuracy: 414/416 (99.5192%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 0.7757, Accuracy: 7637/10000 (76.3700%)
time spent on training: 113.31409764289856
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10972308973558192  data num: [513, 423, 364, 642, 413, 706, 527, 198, 601, 416]
[rfa agg] considering poison per batch poison_fraction: 0.008572116385592337
[rfa agg] init. name: [41, 28, 85, 59, 89, 31, 33, 42, 82, 68], weight: tensor([0.1068, 0.0881, 0.0758, 0.1337, 0.0860, 0.1470, 0.1097, 0.0412, 0.1251,
        0.0866])
[rfa agg] iter:  0, prev_obj_val: 29.176244735717773, obj_val: 28.926137924194336, abs dis: 0.2501068115234375
[rfa agg] iter:  0, weight: tensor([0.0668, 0.1521, 0.2274, 0.0522, 0.1359, 0.0451, 0.0690, 0.0385, 0.0603,
        0.1527])
[rfa agg] iter:  1, prev_obj_val: 28.926137924194336, obj_val: 32.68184280395508, abs dis: 3.755704879760742
[rfa agg] iter:  1, weight: tensor([0.0585, 0.1425, 0.2983, 0.0455, 0.1262, 0.0387, 0.0604, 0.0341, 0.0527,
        0.1430])
[rfa agg] iter:  2, prev_obj_val: 32.68184280395508, obj_val: 32.679222106933594, abs dis: 0.002620697021484375
[rfa agg] iter:  2, weight: tensor([0.0664, 0.1286, 0.2682, 0.0543, 0.1194, 0.0473, 0.0685, 0.0578, 0.0616,
        0.1278])
___Test Target_ResNet_18 poisoned: False, epoch: 238: Average loss: 0.6301, Accuracy: 7905/10000 (79.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 238: Average loss: 5.4873, Accuracy: 468/9000 (5.2000%)
Done in 228.50419187545776 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:239 choose agents : [37, 47, 73, 15, 90, 9, 71, 78, 77, 69]. Adversary List: []
___Train Local_ResNet_18,  epoch 239, local model 37, internal_epoch   1,  Average loss: 0.0034, Accuracy: 679/725 (93.6552%)
___Train Local_ResNet_18,  epoch 239, local model 37, internal_epoch   2,  Average loss: 0.0074, Accuracy: 630/725 (86.8966%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 4.6789, Accuracy: 3681/10000 (36.8100%)
___Train Local_ResNet_18,  epoch 239, local model 47, internal_epoch   1,  Average loss: 0.0027, Accuracy: 622/654 (95.1070%)
___Train Local_ResNet_18,  epoch 239, local model 47, internal_epoch   2,  Average loss: 0.0030, Accuracy: 626/654 (95.7187%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.8512, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 239, local model 73, internal_epoch   1,  Average loss: 0.0099, Accuracy: 412/500 (82.4000%)
___Train Local_ResNet_18,  epoch 239, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 463/500 (92.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 7.3834, Accuracy: 2035/10000 (20.3500%)
___Train Local_ResNet_18,  epoch 239, local model 15, internal_epoch   1,  Average loss: 0.0079, Accuracy: 290/341 (85.0440%)
___Train Local_ResNet_18,  epoch 239, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 325/341 (95.3079%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 3.3655, Accuracy: 3388/10000 (33.8800%)
___Train Local_ResNet_18,  epoch 239, local model 90, internal_epoch   1,  Average loss: 0.0081, Accuracy: 537/578 (92.9066%)
___Train Local_ResNet_18,  epoch 239, local model 90, internal_epoch   2,  Average loss: 0.0125, Accuracy: 474/578 (82.0069%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 48.2760, Accuracy: 1494/10000 (14.9400%)
___Train Local_ResNet_18,  epoch 239, local model 9, internal_epoch   1,  Average loss: 0.0028, Accuracy: 351/368 (95.3804%)
___Train Local_ResNet_18,  epoch 239, local model 9, internal_epoch   2,  Average loss: 0.0009, Accuracy: 364/368 (98.9130%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 6.5582, Accuracy: 2233/10000 (22.3300%)
___Train Local_ResNet_18,  epoch 239, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 1104/1166 (94.6827%)
___Train Local_ResNet_18,  epoch 239, local model 71, internal_epoch   2,  Average loss: 0.0142, Accuracy: 879/1166 (75.3859%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 5.0826, Accuracy: 3219/10000 (32.1900%)
___Train Local_ResNet_18,  epoch 239, local model 78, internal_epoch   1,  Average loss: 0.0022, Accuracy: 247/255 (96.8627%)
___Train Local_ResNet_18,  epoch 239, local model 78, internal_epoch   2,  Average loss: 0.0005, Accuracy: 254/255 (99.6078%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.6491, Accuracy: 5975/10000 (59.7500%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 239, local model 77, internal_epoch   1,  Average loss: 0.0009, Accuracy: 492/496 (99.1935%)
___Train Local_ResNet_18,  epoch 239, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.4296, Accuracy: 6357/10000 (63.5700%)
___Train Local_ResNet_18,  epoch 239, local model 69, internal_epoch   1,  Average loss: 0.0061, Accuracy: 191/216 (88.4259%)
___Train Local_ResNet_18,  epoch 239, local model 69, internal_epoch   2,  Average loss: 0.0009, Accuracy: 214/216 (99.0741%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 6.6950, Accuracy: 1671/10000 (16.7100%)
time spent on training: 109.73554396629333
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.09360256652198529  data num: [725, 654, 500, 341, 578, 368, 1166, 255, 496, 216]
[rfa agg] considering poison per batch poison_fraction: 0.0073127005095301005
[rfa agg] init. name: [37, 47, 73, 15, 90, 9, 71, 78, 77, 69], weight: tensor([0.1368, 0.1234, 0.0944, 0.0644, 0.1091, 0.0694, 0.2200, 0.0481, 0.0936,
        0.0408])
[rfa agg] iter:  0, prev_obj_val: 39.378421783447266, obj_val: 46.708316802978516, abs dis: 7.32989501953125
[rfa agg] iter:  0, weight: tensor([0.0915, 0.1141, 0.1754, 0.0592, 0.1204, 0.0659, 0.0513, 0.0263, 0.2737,
        0.0222])
[rfa agg] iter:  1, prev_obj_val: 46.708316802978516, obj_val: 52.557682037353516, abs dis: 5.849365234375
[rfa agg] iter:  1, weight: tensor([0.0621, 0.0688, 0.1322, 0.1566, 0.0726, 0.2213, 0.0443, 0.0483, 0.1532,
        0.0406])
[rfa agg] iter:  2, prev_obj_val: 52.557682037353516, obj_val: 52.550048828125, abs dis: 0.007633209228515625
[rfa agg] iter:  2, weight: tensor([0.0552, 0.0592, 0.0926, 0.1806, 0.0608, 0.2590, 0.0430, 0.0823, 0.0987,
        0.0685])
___Test Target_ResNet_18 poisoned: False, epoch: 239: Average loss: 0.6334, Accuracy: 7911/10000 (79.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 239: Average loss: 5.5318, Accuracy: 451/9000 (5.0111%)
Done in 226.7937045097351 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:240 choose agents : [28, 33, 87, 46, 26, 67, 13, 69, 54, 34]. Adversary List: []
___Train Local_ResNet_18,  epoch 240, local model 28, internal_epoch   1,  Average loss: 0.0010, Accuracy: 422/423 (99.7636%)
___Train Local_ResNet_18,  epoch 240, local model 28, internal_epoch   2,  Average loss: 0.0004, Accuracy: 421/423 (99.5272%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.8220, Accuracy: 5915/10000 (59.1500%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 240, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 495/527 (93.9279%)
___Train Local_ResNet_18,  epoch 240, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 491/527 (93.1689%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 2.9600, Accuracy: 4640/10000 (46.4000%)
___Train Local_ResNet_18,  epoch 240, local model 87, internal_epoch   1,  Average loss: 0.0060, Accuracy: 346/397 (87.1537%)
___Train Local_ResNet_18,  epoch 240, local model 87, internal_epoch   2,  Average loss: 0.0065, Accuracy: 359/397 (90.4282%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 3.9122, Accuracy: 3773/10000 (37.7300%)
___Train Local_ResNet_18,  epoch 240, local model 46, internal_epoch   1,  Average loss: 0.0011, Accuracy: 594/601 (98.8353%)
___Train Local_ResNet_18,  epoch 240, local model 46, internal_epoch   2,  Average loss: 0.0013, Accuracy: 586/601 (97.5042%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.6767, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 240, local model 26, internal_epoch   1,  Average loss: 0.0017, Accuracy: 459/468 (98.0769%)
___Train Local_ResNet_18,  epoch 240, local model 26, internal_epoch   2,  Average loss: 0.0018, Accuracy: 457/468 (97.6496%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 2.0984, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 240, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 798/842 (94.7743%)
___Train Local_ResNet_18,  epoch 240, local model 67, internal_epoch   2,  Average loss: 0.0189, Accuracy: 566/842 (67.2209%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 435.5999, Accuracy: 1087/10000 (10.8700%)
___Train Local_ResNet_18,  epoch 240, local model 13, internal_epoch   1,  Average loss: 0.0035, Accuracy: 577/620 (93.0645%)
___Train Local_ResNet_18,  epoch 240, local model 13, internal_epoch   2,  Average loss: 0.0019, Accuracy: 600/620 (96.7742%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 2.7082, Accuracy: 4409/10000 (44.0900%)
___Train Local_ResNet_18,  epoch 240, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 195/216 (90.2778%)
___Train Local_ResNet_18,  epoch 240, local model 69, internal_epoch   2,  Average loss: 0.0006, Accuracy: 215/216 (99.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 6.3007, Accuracy: 1687/10000 (16.8700%)
___Train Local_ResNet_18,  epoch 240, local model 54, internal_epoch   1,  Average loss: 0.0022, Accuracy: 425/440 (96.5909%)
___Train Local_ResNet_18,  epoch 240, local model 54, internal_epoch   2,  Average loss: 0.0007, Accuracy: 433/440 (98.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 3.0482, Accuracy: 4531/10000 (45.3100%)
___Train Local_ResNet_18,  epoch 240, local model 34, internal_epoch   1,  Average loss: 0.0020, Accuracy: 342/349 (97.9943%)
___Train Local_ResNet_18,  epoch 240, local model 34, internal_epoch   2,  Average loss: 0.0007, Accuracy: 347/349 (99.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 2.3680, Accuracy: 5486/10000 (54.8600%)
time spent on training: 108.76631331443787
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10792545566250256  data num: [423, 527, 397, 601, 468, 842, 620, 216, 440, 349]
[rfa agg] considering poison per batch poison_fraction: 0.008431676223633012
[rfa agg] init. name: [28, 33, 87, 46, 26, 67, 13, 69, 54, 34], weight: tensor([0.0866, 0.1079, 0.0813, 0.1231, 0.0958, 0.1724, 0.1270, 0.0442, 0.0901,
        0.0715])
[rfa agg] iter:  0, prev_obj_val: 27.674625396728516, obj_val: 34.29114532470703, abs dis: 6.616519927978516
[rfa agg] iter:  0, weight: tensor([0.1962, 0.0679, 0.1237, 0.0579, 0.0967, 0.0372, 0.0589, 0.0289, 0.1802,
        0.1525])
[rfa agg] iter:  1, prev_obj_val: 34.29114532470703, obj_val: 34.28429412841797, abs dis: 0.0068511962890625
[rfa agg] iter:  1, weight: tensor([0.1276, 0.0675, 0.1067, 0.0611, 0.0843, 0.0439, 0.0624, 0.0636, 0.1292,
        0.2537])
___Test Target_ResNet_18 poisoned: False, epoch: 240: Average loss: 0.6279, Accuracy: 7907/10000 (79.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 240: Average loss: 5.5966, Accuracy: 454/9000 (5.0444%)
Done in 224.61341047286987 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:241 choose agents : [78, 91, 57, 30, 75, 17, 28, 31, 85, 45]. Adversary List: []
___Train Local_ResNet_18,  epoch 241, local model 78, internal_epoch   1,  Average loss: 0.0022, Accuracy: 246/255 (96.4706%)
___Train Local_ResNet_18,  epoch 241, local model 78, internal_epoch   2,  Average loss: 0.0005, Accuracy: 254/255 (99.6078%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.9221, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 241, local model 91, internal_epoch   1,  Average loss: 0.0022, Accuracy: 227/234 (97.0085%)
___Train Local_ResNet_18,  epoch 241, local model 91, internal_epoch   2,  Average loss: 0.0005, Accuracy: 233/234 (99.5726%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.0811, Accuracy: 6768/10000 (67.6800%)
___Train Local_ResNet_18,  epoch 241, local model 57, internal_epoch   1,  Average loss: 0.0016, Accuracy: 287/290 (98.9655%)
___Train Local_ResNet_18,  epoch 241, local model 57, internal_epoch   2,  Average loss: 0.0005, Accuracy: 288/290 (99.3103%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.3108, Accuracy: 6567/10000 (65.6700%)
___Train Local_ResNet_18,  epoch 241, local model 30, internal_epoch   1,  Average loss: 0.0024, Accuracy: 328/337 (97.3294%)
___Train Local_ResNet_18,  epoch 241, local model 30, internal_epoch   2,  Average loss: 0.0025, Accuracy: 326/337 (96.7359%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 2.4076, Accuracy: 4766/10000 (47.6600%)
___Train Local_ResNet_18,  epoch 241, local model 75, internal_epoch   1,  Average loss: 0.0022, Accuracy: 562/578 (97.2318%)
___Train Local_ResNet_18,  epoch 241, local model 75, internal_epoch   2,  Average loss: 0.0057, Accuracy: 545/578 (94.2907%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 3.7315, Accuracy: 3635/10000 (36.3500%)
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 241, local model 17, internal_epoch   1,  Average loss: 0.0011, Accuracy: 521/526 (99.0494%)
___Train Local_ResNet_18,  epoch 241, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 525/526 (99.8099%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.4988, Accuracy: 6372/10000 (63.7200%)
___Train Local_ResNet_18,  epoch 241, local model 28, internal_epoch   1,  Average loss: 0.0009, Accuracy: 422/423 (99.7636%)
___Train Local_ResNet_18,  epoch 241, local model 28, internal_epoch   2,  Average loss: 0.0003, Accuracy: 422/423 (99.7636%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.8407, Accuracy: 5971/10000 (59.7100%)
___Train Local_ResNet_18,  epoch 241, local model 31, internal_epoch   1,  Average loss: 0.0034, Accuracy: 684/706 (96.8839%)
___Train Local_ResNet_18,  epoch 241, local model 31, internal_epoch   2,  Average loss: 0.0163, Accuracy: 511/706 (72.3796%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 113.7343, Accuracy: 1517/10000 (15.1700%)
___Train Local_ResNet_18,  epoch 241, local model 85, internal_epoch   1,  Average loss: 0.0018, Accuracy: 359/364 (98.6264%)
___Train Local_ResNet_18,  epoch 241, local model 85, internal_epoch   2,  Average loss: 0.0006, Accuracy: 363/364 (99.7253%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 2.2902, Accuracy: 4843/10000 (48.4300%)
___Train Local_ResNet_18,  epoch 241, local model 45, internal_epoch   1,  Average loss: 0.0039, Accuracy: 500/529 (94.5180%)
___Train Local_ResNet_18,  epoch 241, local model 45, internal_epoch   2,  Average loss: 0.0092, Accuracy: 449/529 (84.8771%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 25.7246, Accuracy: 1440/10000 (14.4000%)
time spent on training: 105.67674517631531
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.123998114097124  data num: [255, 234, 290, 337, 578, 526, 423, 706, 364, 529]
[rfa agg] considering poison per batch poison_fraction: 0.009687352663837813
[rfa agg] init. name: [78, 91, 57, 30, 75, 17, 28, 31, 85, 45], weight: tensor([0.0601, 0.0552, 0.0684, 0.0794, 0.1363, 0.1240, 0.0997, 0.1664, 0.0858,
        0.1247])
[rfa agg] iter:  0, prev_obj_val: 28.559959411621094, obj_val: 31.02679443359375, abs dis: 2.4668350219726562
[rfa agg] iter:  0, weight: tensor([0.0676, 0.0623, 0.1680, 0.1704, 0.0532, 0.0627, 0.1127, 0.0439, 0.1987,
        0.0606])
[rfa agg] iter:  1, prev_obj_val: 31.02679443359375, obj_val: 46.367374420166016, abs dis: 15.340579986572266
[rfa agg] iter:  1, weight: tensor([0.0862, 0.0799, 0.3579, 0.1101, 0.0407, 0.0469, 0.0752, 0.0343, 0.1233,
        0.0455])
[rfa agg] iter:  2, prev_obj_val: 46.367374420166016, obj_val: 31.04534339904785, abs dis: 15.322031021118164
[rfa agg] iter:  2, weight: tensor([0.1889, 0.1751, 0.1129, 0.0868, 0.0640, 0.0684, 0.0826, 0.0594, 0.0943,
        0.0676])
[rfa agg] iter:  3, prev_obj_val: 31.04534339904785, obj_val: 46.3656120300293, abs dis: 15.320268630981445
[rfa agg] iter:  3, weight: tensor([0.0900, 0.0832, 0.3396, 0.1111, 0.0421, 0.0485, 0.0776, 0.0356, 0.1252,
        0.0470])
[rfa agg] iter:  4, prev_obj_val: 46.3656120300293, obj_val: 31.045352935791016, abs dis: 15.320259094238281
[rfa agg] iter:  4, weight: tensor([0.1889, 0.1752, 0.1128, 0.0868, 0.0640, 0.0684, 0.0826, 0.0594, 0.0943,
        0.0676])
[rfa agg] iter:  5, prev_obj_val: 31.045352935791016, obj_val: 46.3656120300293, abs dis: 15.320259094238281
[rfa agg] iter:  5, weight: tensor([0.0900, 0.0832, 0.3396, 0.1111, 0.0421, 0.0485, 0.0776, 0.0356, 0.1252,
        0.0470])
[rfa agg] iter:  6, prev_obj_val: 46.3656120300293, obj_val: 31.045352935791016, abs dis: 15.320259094238281
[rfa agg] iter:  6, weight: tensor([0.1889, 0.1752, 0.1128, 0.0868, 0.0640, 0.0684, 0.0826, 0.0594, 0.0943,
        0.0676])
[rfa agg] iter:  7, prev_obj_val: 31.045352935791016, obj_val: 46.3656120300293, abs dis: 15.320259094238281
[rfa agg] iter:  7, weight: tensor([0.0900, 0.0832, 0.3396, 0.1111, 0.0421, 0.0485, 0.0776, 0.0356, 0.1252,
        0.0470])
[rfa agg] iter:  8, prev_obj_val: 46.3656120300293, obj_val: 31.045352935791016, abs dis: 15.320259094238281
[rfa agg] iter:  8, weight: tensor([0.1889, 0.1752, 0.1128, 0.0868, 0.0640, 0.0684, 0.0826, 0.0594, 0.0943,
        0.0676])
[rfa agg] iter:  9, prev_obj_val: 31.045352935791016, obj_val: 46.3656120300293, abs dis: 15.320259094238281
[rfa agg] iter:  9, weight: tensor([0.0900, 0.0832, 0.3396, 0.1111, 0.0421, 0.0485, 0.0776, 0.0356, 0.1252,
        0.0470])
___Test Target_ResNet_18 poisoned: False, epoch: 241: Average loss: 0.6299, Accuracy: 7921/10000 (79.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 241: Average loss: 5.5771, Accuracy: 478/9000 (5.3111%)
Done in 241.45984816551208 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:242 choose agents : [96, 51, 32, 66, 85, 8, 2, 40, 10, 91]. Adversary List: []
___Train Local_ResNet_18,  epoch 242, local model 96, internal_epoch   1,  Average loss: 0.0024, Accuracy: 694/708 (98.0226%)
___Train Local_ResNet_18,  epoch 242, local model 96, internal_epoch   2,  Average loss: 0.0186, Accuracy: 518/708 (73.1638%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 96.2891, Accuracy: 1026/10000 (10.2600%)
___Train Local_ResNet_18,  epoch 242, local model 51, internal_epoch   1,  Average loss: 0.0025, Accuracy: 455/479 (94.9896%)
___Train Local_ResNet_18,  epoch 242, local model 51, internal_epoch   2,  Average loss: 0.0012, Accuracy: 473/479 (98.7474%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 4.7286, Accuracy: 3260/10000 (32.6000%)
___Train Local_ResNet_18,  epoch 242, local model 32, internal_epoch   1,  Average loss: 0.0026, Accuracy: 783/824 (95.0243%)
___Train Local_ResNet_18,  epoch 242, local model 32, internal_epoch   2,  Average loss: 0.0026, Accuracy: 786/824 (95.3883%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 2.0563, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 242, local model 66, internal_epoch   1,  Average loss: 0.0027, Accuracy: 529/555 (95.3153%)
___Train Local_ResNet_18,  epoch 242, local model 66, internal_epoch   2,  Average loss: 0.0017, Accuracy: 536/555 (96.5766%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 2.7410, Accuracy: 4636/10000 (46.3600%)
___Train Local_ResNet_18,  epoch 242, local model 85, internal_epoch   1,  Average loss: 0.0013, Accuracy: 362/364 (99.4505%)
___Train Local_ResNet_18,  epoch 242, local model 85, internal_epoch   2,  Average loss: 0.0010, Accuracy: 361/364 (99.1758%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 1.4429, Accuracy: 6291/10000 (62.9100%)
___Train Local_ResNet_18,  epoch 242, local model 8, internal_epoch   1,  Average loss: 0.0011, Accuracy: 526/534 (98.5019%)
___Train Local_ResNet_18,  epoch 242, local model 8, internal_epoch   2,  Average loss: 0.0008, Accuracy: 529/534 (99.0637%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 1.6531, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 242, local model 2, internal_epoch   1,  Average loss: 0.0030, Accuracy: 435/461 (94.3601%)
___Train Local_ResNet_18,  epoch 242, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 437/461 (94.7939%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 2.3954, Accuracy: 5040/10000 (50.4000%)
___Train Local_ResNet_18,  epoch 242, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 601/652 (92.1779%)
___Train Local_ResNet_18,  epoch 242, local model 40, internal_epoch   2,  Average loss: 0.0092, Accuracy: 559/652 (85.7362%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 14.9652, Accuracy: 2122/10000 (21.2200%)
___Train Local_ResNet_18,  epoch 242, local model 10, internal_epoch   1,  Average loss: 0.0029, Accuracy: 705/752 (93.7500%)
___Train Local_ResNet_18,  epoch 242, local model 10, internal_epoch   2,  Average loss: 0.0028, Accuracy: 714/752 (94.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 4.6398, Accuracy: 3350/10000 (33.5000%)
___Train Local_ResNet_18,  epoch 242, local model 91, internal_epoch   1,  Average loss: 0.0018, Accuracy: 230/234 (98.2906%)
___Train Local_ResNet_18,  epoch 242, local model 91, internal_epoch   2,  Average loss: 0.0002, Accuracy: 234/234 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 0.9401, Accuracy: 7088/10000 (70.8800%)
time spent on training: 96.78823518753052
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [708, 479, 824, 555, 364, 534, 461, 652, 752, 234]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [96, 51, 32, 66, 85, 8, 2, 40, 10, 91], weight: tensor([0.1273, 0.0861, 0.1481, 0.0998, 0.0654, 0.0960, 0.0829, 0.1172, 0.1352,
        0.0421])
[rfa agg] iter:  0, prev_obj_val: 28.901138305664062, obj_val: 28.77872657775879, abs dis: 0.12241172790527344
[rfa agg] iter:  0, weight: tensor([0.0559, 0.2061, 0.0563, 0.1236, 0.0880, 0.1268, 0.1891, 0.0670, 0.0621,
        0.0253])
[rfa agg] iter:  1, prev_obj_val: 28.77872657775879, obj_val: 28.77796173095703, abs dis: 0.0007648468017578125
[rfa agg] iter:  1, weight: tensor([0.0523, 0.2202, 0.0531, 0.1190, 0.0846, 0.1220, 0.2029, 0.0632, 0.0586,
        0.0240])
___Test Target_ResNet_18 poisoned: False, epoch: 242: Average loss: 0.6263, Accuracy: 7937/10000 (79.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 242: Average loss: 5.5267, Accuracy: 544/9000 (6.0444%)
Done in 211.39709186553955 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:243 choose agents : [59, 80, 32, 77, 16, 83, 57, 96, 3, 10]. Adversary List: []
___Train Local_ResNet_18,  epoch 243, local model 59, internal_epoch   1,  Average loss: 0.0019, Accuracy: 620/642 (96.5732%)
___Train Local_ResNet_18,  epoch 243, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 625/642 (97.3520%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 2.9837, Accuracy: 4026/10000 (40.2600%)
___Train Local_ResNet_18,  epoch 243, local model 80, internal_epoch   1,  Average loss: 0.0024, Accuracy: 350/363 (96.4187%)
___Train Local_ResNet_18,  epoch 243, local model 80, internal_epoch   2,  Average loss: 0.0008, Accuracy: 359/363 (98.8981%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 2.6004, Accuracy: 5029/10000 (50.2900%)
___Train Local_ResNet_18,  epoch 243, local model 32, internal_epoch   1,  Average loss: 0.0023, Accuracy: 785/824 (95.2670%)
___Train Local_ResNet_18,  epoch 243, local model 32, internal_epoch   2,  Average loss: 0.0032, Accuracy: 769/824 (93.3252%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 2.2506, Accuracy: 5185/10000 (51.8500%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 243, local model 77, internal_epoch   1,  Average loss: 0.0009, Accuracy: 494/496 (99.5968%)
___Train Local_ResNet_18,  epoch 243, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 496/496 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 1.2815, Accuracy: 6555/10000 (65.5500%)
___Train Local_ResNet_18,  epoch 243, local model 16, internal_epoch   1,  Average loss: 0.0026, Accuracy: 736/773 (95.2135%)
___Train Local_ResNet_18,  epoch 243, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 730/773 (94.4373%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 7.9629, Accuracy: 2968/10000 (29.6800%)
___Train Local_ResNet_18,  epoch 243, local model 83, internal_epoch   1,  Average loss: 0.0008, Accuracy: 364/366 (99.4536%)
___Train Local_ResNet_18,  epoch 243, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 366/366 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 0.7824, Accuracy: 7552/10000 (75.5200%)
___Train Local_ResNet_18,  epoch 243, local model 57, internal_epoch   1,  Average loss: 0.0010, Accuracy: 289/290 (99.6552%)
___Train Local_ResNet_18,  epoch 243, local model 57, internal_epoch   2,  Average loss: 0.0002, Accuracy: 290/290 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 0.9130, Accuracy: 7280/10000 (72.8000%)
___Train Local_ResNet_18,  epoch 243, local model 96, internal_epoch   1,  Average loss: 0.0021, Accuracy: 693/708 (97.8814%)
___Train Local_ResNet_18,  epoch 243, local model 96, internal_epoch   2,  Average loss: 0.0143, Accuracy: 550/708 (77.6836%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 25.2440, Accuracy: 1383/10000 (13.8300%)
___Train Local_ResNet_18,  epoch 243, local model 3, internal_epoch   1,  Average loss: 0.0046, Accuracy: 711/780 (91.1538%)
___Train Local_ResNet_18,  epoch 243, local model 3, internal_epoch   2,  Average loss: 0.0101, Accuracy: 637/780 (81.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 33.1358, Accuracy: 1304/10000 (13.0400%)
___Train Local_ResNet_18,  epoch 243, local model 10, internal_epoch   1,  Average loss: 0.0042, Accuracy: 690/752 (91.7553%)
___Train Local_ResNet_18,  epoch 243, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 700/752 (93.0851%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 7.9353, Accuracy: 2197/10000 (21.9700%)
time spent on training: 111.85562944412231
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.08274941608274941  data num: [642, 363, 824, 496, 773, 366, 290, 708, 780, 752]
[rfa agg] considering poison per batch poison_fraction: 0.006464798131464798
[rfa agg] init. name: [59, 80, 32, 77, 16, 83, 57, 96, 3, 10], weight: tensor([0.1071, 0.0606, 0.1375, 0.0827, 0.1290, 0.0611, 0.0484, 0.1181, 0.1301,
        0.1255])
[rfa agg] iter:  0, prev_obj_val: 32.30473327636719, obj_val: 37.14278793334961, abs dis: 4.838054656982422
[rfa agg] iter:  0, weight: tensor([0.1119, 0.0651, 0.0825, 0.3073, 0.0774, 0.0663, 0.0379, 0.0834, 0.0745,
        0.0937])
[rfa agg] iter:  1, prev_obj_val: 37.14278793334961, obj_val: 42.88646697998047, abs dis: 5.743679046630859
[rfa agg] iter:  1, weight: tensor([0.0787, 0.1006, 0.0649, 0.3455, 0.0609, 0.1043, 0.0506, 0.0643, 0.0592,
        0.0710])
[rfa agg] iter:  2, prev_obj_val: 42.88646697998047, obj_val: 42.86439895629883, abs dis: 0.022068023681640625
[rfa agg] iter:  2, weight: tensor([0.0583, 0.2179, 0.0521, 0.1343, 0.0489, 0.2556, 0.0788, 0.0508, 0.0479,
        0.0555])
[rfa agg] iter:  3, prev_obj_val: 42.86439895629883, obj_val: 42.864280700683594, abs dis: 0.000118255615234375
[rfa agg] iter:  3, weight: tensor([0.0566, 0.2285, 0.0505, 0.1295, 0.0474, 0.2613, 0.0768, 0.0492, 0.0465,
        0.0538])
___Test Target_ResNet_18 poisoned: False, epoch: 243: Average loss: 0.6268, Accuracy: 7930/10000 (79.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 243: Average loss: 5.6074, Accuracy: 534/9000 (5.9333%)
Done in 230.24304175376892 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:244 choose agents : [15, 14, 29, 50, 17, 36, 2, 0, 94, 1]. Adversary List: []
___Train Local_ResNet_18,  epoch 244, local model 15, internal_epoch   1,  Average loss: 0.0060, Accuracy: 300/341 (87.9765%)
___Train Local_ResNet_18,  epoch 244, local model 15, internal_epoch   2,  Average loss: 0.0037, Accuracy: 321/341 (94.1349%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 3.8334, Accuracy: 3117/10000 (31.1700%)
___Train Local_ResNet_18,  epoch 244, local model 14, internal_epoch   1,  Average loss: 0.0026, Accuracy: 304/318 (95.5975%)
___Train Local_ResNet_18,  epoch 244, local model 14, internal_epoch   2,  Average loss: 0.0005, Accuracy: 316/318 (99.3711%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 4.7952, Accuracy: 3186/10000 (31.8600%)
___Train Local_ResNet_18,  epoch 244, local model 29, internal_epoch   1,  Average loss: 0.0041, Accuracy: 779/848 (91.8632%)
___Train Local_ResNet_18,  epoch 244, local model 29, internal_epoch   2,  Average loss: 0.0066, Accuracy: 751/848 (88.5613%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 9.5040, Accuracy: 2290/10000 (22.9000%)
___Train Local_ResNet_18,  epoch 244, local model 50, internal_epoch   1,  Average loss: 0.0012, Accuracy: 397/401 (99.0025%)
___Train Local_ResNet_18,  epoch 244, local model 50, internal_epoch   2,  Average loss: 0.0005, Accuracy: 399/401 (99.5012%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.9870, Accuracy: 5594/10000 (55.9400%)
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 244, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 519/526 (98.6692%)
___Train Local_ResNet_18,  epoch 244, local model 17, internal_epoch   2,  Average loss: 0.0028, Accuracy: 501/526 (95.2471%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 3.5173, Accuracy: 4276/10000 (42.7600%)
___Train Local_ResNet_18,  epoch 244, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 800/849 (94.2285%)
___Train Local_ResNet_18,  epoch 244, local model 36, internal_epoch   2,  Average loss: 0.0164, Accuracy: 635/849 (74.7939%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 18.8741, Accuracy: 1999/10000 (19.9900%)
___Train Local_ResNet_18,  epoch 244, local model 2, internal_epoch   1,  Average loss: 0.0025, Accuracy: 443/461 (96.0954%)
___Train Local_ResNet_18,  epoch 244, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 448/461 (97.1800%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 4.6493, Accuracy: 3276/10000 (32.7600%)
___Train Local_ResNet_18,  epoch 244, local model 0, internal_epoch   1,  Average loss: 0.0013, Accuracy: 364/367 (99.1826%)
___Train Local_ResNet_18,  epoch 244, local model 0, internal_epoch   2,  Average loss: 0.0004, Accuracy: 366/367 (99.7275%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.6401, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 244, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 190/203 (93.5961%)
___Train Local_ResNet_18,  epoch 244, local model 94, internal_epoch   2,  Average loss: 0.0021, Accuracy: 197/203 (97.0443%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 2.1169, Accuracy: 5062/10000 (50.6200%)
___Train Local_ResNet_18,  epoch 244, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 618/641 (96.4119%)
___Train Local_ResNet_18,  epoch 244, local model 1, internal_epoch   2,  Average loss: 0.0123, Accuracy: 582/641 (90.7956%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 2.8524, Accuracy: 4140/10000 (41.4000%)
time spent on training: 106.89211750030518
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10615539858728557  data num: [341, 318, 848, 401, 526, 849, 461, 367, 203, 641]
[rfa agg] considering poison per batch poison_fraction: 0.008293390514631686
[rfa agg] init. name: [15, 14, 29, 50, 17, 36, 2, 0, 94, 1], weight: tensor([0.0688, 0.0642, 0.1711, 0.0809, 0.1062, 0.1713, 0.0930, 0.0741, 0.0410,
        0.1294])
[rfa agg] iter:  0, prev_obj_val: 36.21632766723633, obj_val: 45.102108001708984, abs dis: 8.885780334472656
[rfa agg] iter:  0, weight: tensor([0.1364, 0.0797, 0.0453, 0.2127, 0.0814, 0.0451, 0.1112, 0.1994, 0.0322,
        0.0567])
[rfa agg] iter:  1, prev_obj_val: 45.102108001708984, obj_val: 41.57987594604492, abs dis: 3.5222320556640625
[rfa agg] iter:  1, weight: tensor([0.1220, 0.3024, 0.0411, 0.0872, 0.0572, 0.0409, 0.0665, 0.1533, 0.0826,
        0.0467])
[rfa agg] iter:  2, prev_obj_val: 41.57987594604492, obj_val: 41.57194900512695, abs dis: 0.00792694091796875
[rfa agg] iter:  2, weight: tensor([0.1503, 0.2053, 0.0389, 0.1021, 0.0583, 0.0387, 0.0708, 0.2384, 0.0518,
        0.0455])
[rfa agg] iter:  3, prev_obj_val: 41.57194900512695, obj_val: 45.078941345214844, abs dis: 3.5069923400878906
[rfa agg] iter:  3, weight: tensor([0.1541, 0.1961, 0.0389, 0.1022, 0.0582, 0.0387, 0.0707, 0.2439, 0.0517,
        0.0455])
[rfa agg] iter:  4, prev_obj_val: 45.078941345214844, obj_val: 48.94565200805664, abs dis: 3.866710662841797
[rfa agg] iter:  4, weight: tensor([0.1175, 0.3300, 0.0394, 0.0833, 0.0548, 0.0392, 0.0637, 0.1480, 0.0795,
        0.0447])
[rfa agg] iter:  5, prev_obj_val: 48.94565200805664, obj_val: 41.584381103515625, abs dis: 7.361270904541016
[rfa agg] iter:  5, weight: tensor([0.1039, 0.2682, 0.0451, 0.0809, 0.0589, 0.0449, 0.0662, 0.1218, 0.1603,
        0.0499])
[rfa agg] iter:  6, prev_obj_val: 41.584381103515625, obj_val: 41.57194519042969, abs dis: 0.0124359130859375
[rfa agg] iter:  6, weight: tensor([0.1491, 0.2033, 0.0392, 0.1027, 0.0586, 0.0389, 0.0711, 0.2389, 0.0523,
        0.0458])
[rfa agg] iter:  7, prev_obj_val: 41.57194519042969, obj_val: 45.07894515991211, abs dis: 3.506999969482422
[rfa agg] iter:  7, weight: tensor([0.1540, 0.1960, 0.0389, 0.1022, 0.0582, 0.0387, 0.0707, 0.2440, 0.0517,
        0.0455])
[rfa agg] iter:  8, prev_obj_val: 45.07894515991211, obj_val: 48.945655822753906, abs dis: 3.866710662841797
[rfa agg] iter:  8, weight: tensor([0.1175, 0.3300, 0.0394, 0.0833, 0.0548, 0.0392, 0.0637, 0.1480, 0.0795,
        0.0447])
[rfa agg] iter:  9, prev_obj_val: 48.945655822753906, obj_val: 41.58437728881836, abs dis: 7.361278533935547
[rfa agg] iter:  9, weight: tensor([0.1039, 0.2682, 0.0451, 0.0809, 0.0589, 0.0449, 0.0662, 0.1218, 0.1603,
        0.0499])
___Test Target_ResNet_18 poisoned: False, epoch: 244: Average loss: 0.6265, Accuracy: 7921/10000 (79.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 244: Average loss: 5.4918, Accuracy: 643/9000 (7.1444%)
Done in 226.64506554603577 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:245 choose agents : [38, 41, 82, 49, 74, 23, 97, 83, 22, 4]. Adversary List: []
___Train Local_ResNet_18,  epoch 245, local model 38, internal_epoch   1,  Average loss: 0.0025, Accuracy: 716/756 (94.7090%)
___Train Local_ResNet_18,  epoch 245, local model 38, internal_epoch   2,  Average loss: 0.0038, Accuracy: 699/756 (92.4603%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 4.0866, Accuracy: 4090/10000 (40.9000%)
___Train Local_ResNet_18,  epoch 245, local model 41, internal_epoch   1,  Average loss: 0.0041, Accuracy: 471/513 (91.8129%)
___Train Local_ResNet_18,  epoch 245, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 469/513 (91.4230%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 4.0710, Accuracy: 3562/10000 (35.6200%)
___Train Local_ResNet_18,  epoch 245, local model 82, internal_epoch   1,  Average loss: 0.0023, Accuracy: 575/601 (95.6739%)
___Train Local_ResNet_18,  epoch 245, local model 82, internal_epoch   2,  Average loss: 0.0016, Accuracy: 587/601 (97.6705%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 2.3449, Accuracy: 4960/10000 (49.6000%)
___Train Local_ResNet_18,  epoch 245, local model 49, internal_epoch   1,  Average loss: 0.0017, Accuracy: 415/426 (97.4178%)
___Train Local_ResNet_18,  epoch 245, local model 49, internal_epoch   2,  Average loss: 0.0004, Accuracy: 424/426 (99.5305%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 2.5480, Accuracy: 4893/10000 (48.9300%)
___Train Local_ResNet_18,  epoch 245, local model 74, internal_epoch   1,  Average loss: 0.0022, Accuracy: 451/469 (96.1620%)
___Train Local_ResNet_18,  epoch 245, local model 74, internal_epoch   2,  Average loss: 0.0014, Accuracy: 459/469 (97.8678%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 3.0540, Accuracy: 4480/10000 (44.8000%)
___Train Local_ResNet_18,  epoch 245, local model 23, internal_epoch   1,  Average loss: 0.0020, Accuracy: 241/248 (97.1774%)
___Train Local_ResNet_18,  epoch 245, local model 23, internal_epoch   2,  Average loss: 0.0004, Accuracy: 247/248 (99.5968%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 1.2719, Accuracy: 6373/10000 (63.7300%)
___Train Local_ResNet_18,  epoch 245, local model 97, internal_epoch   1,  Average loss: 0.0016, Accuracy: 408/418 (97.6077%)
___Train Local_ResNet_18,  epoch 245, local model 97, internal_epoch   2,  Average loss: 0.0011, Accuracy: 412/418 (98.5646%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 2.3373, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18,  epoch 245, local model 83, internal_epoch   1,  Average loss: 0.0005, Accuracy: 366/366 (100.0000%)
___Train Local_ResNet_18,  epoch 245, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 366/366 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 0.6931, Accuracy: 7797/10000 (77.9700%)
___Train Local_ResNet_18,  epoch 245, local model 22, internal_epoch   1,  Average loss: 0.0034, Accuracy: 456/494 (92.3077%)
___Train Local_ResNet_18,  epoch 245, local model 22, internal_epoch   2,  Average loss: 0.0016, Accuracy: 483/494 (97.7733%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 3.1311, Accuracy: 4059/10000 (40.5900%)
___Train Local_ResNet_18,  epoch 245, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 515/557 (92.4596%)
___Train Local_ResNet_18,  epoch 245, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 507/557 (91.0233%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 5.4115, Accuracy: 2255/10000 (22.5500%)
time spent on training: 95.62949728965759
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [756, 513, 601, 426, 469, 248, 418, 366, 494, 557]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 41, 82, 49, 74, 23, 97, 83, 22, 4], weight: tensor([0.1559, 0.1058, 0.1240, 0.0879, 0.0967, 0.0512, 0.0862, 0.0755, 0.1019,
        0.1149])
[rfa agg] iter:  0, prev_obj_val: 25.891605377197266, obj_val: 37.41457748413086, abs dis: 11.522972106933594
[rfa agg] iter:  0, weight: tensor([0.0405, 0.0534, 0.0481, 0.1240, 0.0729, 0.0397, 0.1203, 0.3689, 0.0747,
        0.0576])
[rfa agg] iter:  1, prev_obj_val: 37.41457748413086, obj_val: 33.45576477050781, abs dis: 3.958812713623047
[rfa agg] iter:  1, weight: tensor([0.0585, 0.0656, 0.0634, 0.0986, 0.0775, 0.2459, 0.0965, 0.1422, 0.0808,
        0.0709])
[rfa agg] iter:  2, prev_obj_val: 33.45576477050781, obj_val: 29.548311233520508, abs dis: 3.9074535369873047
[rfa agg] iter:  2, weight: tensor([0.0591, 0.0693, 0.0657, 0.1151, 0.0849, 0.1326, 0.1125, 0.1978, 0.0882,
        0.0748])
[rfa agg] iter:  3, prev_obj_val: 29.548311233520508, obj_val: 29.54645538330078, abs dis: 0.0018558502197265625
[rfa agg] iter:  3, weight: tensor([0.0503, 0.0622, 0.0576, 0.1195, 0.0800, 0.0710, 0.1163, 0.2935, 0.0826,
        0.0671])
___Test Target_ResNet_18 poisoned: False, epoch: 245: Average loss: 0.6244, Accuracy: 7941/10000 (79.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 245: Average loss: 5.5811, Accuracy: 580/9000 (6.4444%)
Done in 206.6536364555359 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:246 choose agents : [43, 92, 33, 62, 59, 26, 11, 93, 86, 90]. Adversary List: []
___Train Local_ResNet_18,  epoch 246, local model 43, internal_epoch   1,  Average loss: 0.0045, Accuracy: 310/345 (89.8551%)
___Train Local_ResNet_18,  epoch 246, local model 43, internal_epoch   2,  Average loss: 0.0016, Accuracy: 336/345 (97.3913%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 3.0098, Accuracy: 4581/10000 (45.8100%)
___Train Local_ResNet_18,  epoch 246, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 729/796 (91.5829%)
___Train Local_ResNet_18,  epoch 246, local model 92, internal_epoch   2,  Average loss: 0.0100, Accuracy: 661/796 (83.0402%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 7.8677, Accuracy: 1928/10000 (19.2800%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 246, local model 33, internal_epoch   1,  Average loss: 0.0028, Accuracy: 506/527 (96.0152%)
___Train Local_ResNet_18,  epoch 246, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 484/527 (91.8406%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 4.3218, Accuracy: 3285/10000 (32.8500%)
___Train Local_ResNet_18,  epoch 246, local model 62, internal_epoch   1,  Average loss: 0.0006, Accuracy: 358/358 (100.0000%)
___Train Local_ResNet_18,  epoch 246, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 358/358 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 0.7750, Accuracy: 7575/10000 (75.7500%)
___Train Local_ResNet_18,  epoch 246, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 628/642 (97.8193%)
___Train Local_ResNet_18,  epoch 246, local model 59, internal_epoch   2,  Average loss: 0.0220, Accuracy: 426/642 (66.3551%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 690.5506, Accuracy: 1129/10000 (11.2900%)
___Train Local_ResNet_18,  epoch 246, local model 26, internal_epoch   1,  Average loss: 0.0019, Accuracy: 453/468 (96.7949%)
___Train Local_ResNet_18,  epoch 246, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 441/468 (94.2308%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 2.0580, Accuracy: 5519/10000 (55.1900%)
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 246, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 538/546 (98.5348%)
___Train Local_ResNet_18,  epoch 246, local model 11, internal_epoch   2,  Average loss: 0.0011, Accuracy: 535/546 (97.9853%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.7919, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 246, local model 93, internal_epoch   1,  Average loss: 0.0022, Accuracy: 562/584 (96.2329%)
___Train Local_ResNet_18,  epoch 246, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 548/584 (93.8356%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 6.9143, Accuracy: 1756/10000 (17.5600%)
___Train Local_ResNet_18,  epoch 246, local model 86, internal_epoch   1,  Average loss: 0.0016, Accuracy: 211/212 (99.5283%)
___Train Local_ResNet_18,  epoch 246, local model 86, internal_epoch   2,  Average loss: 0.0007, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.0451, Accuracy: 6984/10000 (69.8400%)
___Train Local_ResNet_18,  epoch 246, local model 90, internal_epoch   1,  Average loss: 0.0071, Accuracy: 528/578 (91.3495%)
___Train Local_ResNet_18,  epoch 246, local model 90, internal_epoch   2,  Average loss: 0.0149, Accuracy: 459/578 (79.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 55.3039, Accuracy: 1024/10000 (10.2400%)
time spent on training: 119.73700737953186
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.21222310126582278  data num: [345, 796, 527, 358, 642, 468, 546, 584, 212, 578]
[rfa agg] considering poison per batch poison_fraction: 0.016579929786392403
[rfa agg] init. name: [43, 92, 33, 62, 59, 26, 11, 93, 86, 90], weight: tensor([0.0682, 0.1574, 0.1042, 0.0708, 0.1270, 0.0926, 0.1080, 0.1155, 0.0419,
        0.1143])
[rfa agg] iter:  0, prev_obj_val: 31.549579620361328, obj_val: 37.913055419921875, abs dis: 6.363475799560547
[rfa agg] iter:  0, weight: tensor([0.1657, 0.0559, 0.0914, 0.2222, 0.0577, 0.1266, 0.0981, 0.0747, 0.0386,
        0.0692])
[rfa agg] iter:  1, prev_obj_val: 37.913055419921875, obj_val: 34.3193359375, abs dis: 3.593719482421875
[rfa agg] iter:  1, weight: tensor([0.2038, 0.0497, 0.0696, 0.2844, 0.0497, 0.0861, 0.0736, 0.0605, 0.0655,
        0.0571])
[rfa agg] iter:  2, prev_obj_val: 34.3193359375, obj_val: 45.72943115234375, abs dis: 11.41009521484375
[rfa agg] iter:  2, weight: tensor([0.1979, 0.0377, 0.0570, 0.4054, 0.0380, 0.0748, 0.0608, 0.0481, 0.0355,
        0.0448])
[rfa agg] iter:  3, prev_obj_val: 45.72943115234375, obj_val: 41.765869140625, abs dis: 3.96356201171875
[rfa agg] iter:  3, weight: tensor([0.1377, 0.0591, 0.0736, 0.1512, 0.0581, 0.0841, 0.0773, 0.0670, 0.2277,
        0.0641])
[rfa agg] iter:  4, prev_obj_val: 41.765869140625, obj_val: 37.90992736816406, abs dis: 3.8559417724609375
[rfa agg] iter:  4, weight: tensor([0.1742, 0.0587, 0.0771, 0.2046, 0.0583, 0.0911, 0.0812, 0.0688, 0.1208,
        0.0654])
[rfa agg] iter:  5, prev_obj_val: 37.90992736816406, obj_val: 34.31907272338867, abs dis: 3.5908546447753906
[rfa agg] iter:  5, weight: tensor([0.2053, 0.0495, 0.0693, 0.2852, 0.0495, 0.0855, 0.0733, 0.0602, 0.0654,
        0.0568])
[rfa agg] iter:  6, prev_obj_val: 34.31907272338867, obj_val: 45.729496002197266, abs dis: 11.410423278808594
[rfa agg] iter:  6, weight: tensor([0.1982, 0.0377, 0.0570, 0.4056, 0.0380, 0.0747, 0.0607, 0.0480, 0.0354,
        0.0447])
[rfa agg] iter:  7, prev_obj_val: 45.729496002197266, obj_val: 41.765872955322266, abs dis: 3.963623046875
[rfa agg] iter:  7, weight: tensor([0.1377, 0.0591, 0.0736, 0.1512, 0.0581, 0.0841, 0.0773, 0.0670, 0.2277,
        0.0641])
[rfa agg] iter:  8, prev_obj_val: 41.765872955322266, obj_val: 37.90992736816406, abs dis: 3.855945587158203
[rfa agg] iter:  8, weight: tensor([0.1742, 0.0587, 0.0771, 0.2046, 0.0583, 0.0911, 0.0812, 0.0688, 0.1208,
        0.0654])
[rfa agg] iter:  9, prev_obj_val: 37.90992736816406, obj_val: 34.31907272338867, abs dis: 3.5908546447753906
[rfa agg] iter:  9, weight: tensor([0.2053, 0.0495, 0.0693, 0.2852, 0.0495, 0.0855, 0.0733, 0.0602, 0.0654,
        0.0568])
___Test Target_ResNet_18 poisoned: False, epoch: 246: Average loss: 0.6276, Accuracy: 7910/10000 (79.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 246: Average loss: 5.6011, Accuracy: 522/9000 (5.8000%)
Done in 254.94163131713867 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:247 choose agents : [80, 12, 53, 55, 18, 42, 52, 31, 29, 13]. Adversary List: []
___Train Local_ResNet_18,  epoch 247, local model 80, internal_epoch   1,  Average loss: 0.0018, Accuracy: 357/363 (98.3471%)
___Train Local_ResNet_18,  epoch 247, local model 80, internal_epoch   2,  Average loss: 0.0006, Accuracy: 361/363 (99.4490%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 2.3926, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 247, local model 12, internal_epoch   1,  Average loss: 0.0030, Accuracy: 928/977 (94.9846%)
___Train Local_ResNet_18,  epoch 247, local model 12, internal_epoch   2,  Average loss: 0.0067, Accuracy: 866/977 (88.6387%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 9.6219, Accuracy: 2242/10000 (22.4200%)
___Train Local_ResNet_18,  epoch 247, local model 53, internal_epoch   1,  Average loss: 0.0018, Accuracy: 604/625 (96.6400%)
___Train Local_ResNet_18,  epoch 247, local model 53, internal_epoch   2,  Average loss: 0.0018, Accuracy: 603/625 (96.4800%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 2.1997, Accuracy: 4837/10000 (48.3700%)
___Train Local_ResNet_18,  epoch 247, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 282/299 (94.3144%)
___Train Local_ResNet_18,  epoch 247, local model 55, internal_epoch   2,  Average loss: 0.0006, Accuracy: 297/299 (99.3311%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 4.4229, Accuracy: 3049/10000 (30.4900%)
___Train Local_ResNet_18,  epoch 247, local model 18, internal_epoch   1,  Average loss: 0.0053, Accuracy: 377/386 (97.6684%)
___Train Local_ResNet_18,  epoch 247, local model 18, internal_epoch   2,  Average loss: 0.0229, Accuracy: 242/386 (62.6943%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 150.9356, Accuracy: 1001/10000 (10.0100%)
___Train Local_ResNet_18,  epoch 247, local model 42, internal_epoch   1,  Average loss: 0.0024, Accuracy: 193/198 (97.4747%)
___Train Local_ResNet_18,  epoch 247, local model 42, internal_epoch   2,  Average loss: 0.0003, Accuracy: 198/198 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 1.6875, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 247, local model 52, internal_epoch   1,  Average loss: 0.0049, Accuracy: 200/214 (93.4579%)
___Train Local_ResNet_18,  epoch 247, local model 52, internal_epoch   2,  Average loss: 0.0021, Accuracy: 211/214 (98.5981%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 3.5968, Accuracy: 3960/10000 (39.6000%)
___Train Local_ResNet_18,  epoch 247, local model 31, internal_epoch   1,  Average loss: 0.0017, Accuracy: 684/706 (96.8839%)
___Train Local_ResNet_18,  epoch 247, local model 31, internal_epoch   2,  Average loss: 0.0020, Accuracy: 678/706 (96.0340%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 1.9239, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 247, local model 29, internal_epoch   1,  Average loss: 0.0043, Accuracy: 775/848 (91.3915%)
___Train Local_ResNet_18,  epoch 247, local model 29, internal_epoch   2,  Average loss: 0.0065, Accuracy: 757/848 (89.2689%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 22.6223, Accuracy: 1523/10000 (15.2300%)
___Train Local_ResNet_18,  epoch 247, local model 13, internal_epoch   1,  Average loss: 0.0036, Accuracy: 574/620 (92.5806%)
___Train Local_ResNet_18,  epoch 247, local model 13, internal_epoch   2,  Average loss: 0.0035, Accuracy: 586/620 (94.5161%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 4.7170, Accuracy: 3489/10000 (34.8900%)
time spent on training: 95.85732293128967
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [363, 977, 625, 299, 386, 198, 214, 706, 848, 620]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 12, 53, 55, 18, 42, 52, 31, 29, 13], weight: tensor([0.0693, 0.1866, 0.1194, 0.0571, 0.0737, 0.0378, 0.0409, 0.1348, 0.1620,
        0.1184])
[rfa agg] iter:  0, prev_obj_val: 37.602333068847656, obj_val: 39.556861877441406, abs dis: 1.95452880859375
[rfa agg] iter:  0, weight: tensor([0.0869, 0.0789, 0.2256, 0.0515, 0.0789, 0.0268, 0.0289, 0.1203, 0.0915,
        0.2107])
[rfa agg] iter:  1, prev_obj_val: 39.556861877441406, obj_val: 43.91407012939453, abs dis: 4.357208251953125
[rfa agg] iter:  1, weight: tensor([0.1153, 0.0789, 0.1940, 0.0640, 0.0916, 0.0322, 0.0347, 0.1134, 0.0897,
        0.1862])
[rfa agg] iter:  2, prev_obj_val: 43.91407012939453, obj_val: 46.24576950073242, abs dis: 2.3316993713378906
[rfa agg] iter:  2, weight: tensor([0.2130, 0.0706, 0.1335, 0.0940, 0.1001, 0.0428, 0.0460, 0.0917, 0.0779,
        0.1303])
[rfa agg] iter:  3, prev_obj_val: 46.24576950073242, obj_val: 51.7087287902832, abs dis: 5.462959289550781
[rfa agg] iter:  3, weight: tensor([0.3104, 0.0594, 0.1020, 0.1081, 0.0880, 0.0453, 0.0486, 0.0740, 0.0646,
        0.0998])
[rfa agg] iter:  4, prev_obj_val: 51.7087287902832, obj_val: 54.902915954589844, abs dis: 3.1941871643066406
[rfa agg] iter:  4, weight: tensor([0.2947, 0.0480, 0.0713, 0.2059, 0.0680, 0.0654, 0.0696, 0.0560, 0.0510,
        0.0701])
[rfa agg] iter:  5, prev_obj_val: 54.902915954589844, obj_val: 54.89093780517578, abs dis: 0.0119781494140625
[rfa agg] iter:  5, weight: tensor([0.1732, 0.0447, 0.0628, 0.3114, 0.0598, 0.0920, 0.0964, 0.0508, 0.0471,
        0.0618])
[rfa agg] iter:  6, prev_obj_val: 54.89093780517578, obj_val: 58.41599655151367, abs dis: 3.5250587463378906
[rfa agg] iter:  6, weight: tensor([0.1634, 0.0427, 0.0600, 0.3439, 0.0568, 0.0883, 0.0923, 0.0486, 0.0450,
        0.0590])
[rfa agg] iter:  7, prev_obj_val: 58.41599655151367, obj_val: 54.89693069458008, abs dis: 3.5190658569335938
[rfa agg] iter:  7, weight: tensor([0.1233, 0.0445, 0.0594, 0.2461, 0.0562, 0.1590, 0.1571, 0.0494, 0.0464,
        0.0585])
[rfa agg] iter:  8, prev_obj_val: 54.89693069458008, obj_val: 58.41471481323242, abs dis: 3.5177841186523438
[rfa agg] iter:  8, weight: tensor([0.1667, 0.0435, 0.0611, 0.3292, 0.0578, 0.0910, 0.0954, 0.0495, 0.0458,
        0.0601])
[rfa agg] iter:  9, prev_obj_val: 58.41471481323242, obj_val: 54.8970947265625, abs dis: 3.517620086669922
[rfa agg] iter:  9, weight: tensor([0.1235, 0.0445, 0.0595, 0.2444, 0.0563, 0.1595, 0.1577, 0.0494, 0.0465,
        0.0586])
___Test Target_ResNet_18 poisoned: False, epoch: 247: Average loss: 0.6283, Accuracy: 7936/10000 (79.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 247: Average loss: 5.7039, Accuracy: 503/9000 (5.5889%)
Done in 233.3287386894226 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:248 choose agents : [28, 59, 11, 20, 4, 19, 50, 93, 13, 55]. Adversary List: []
___Train Local_ResNet_18,  epoch 248, local model 28, internal_epoch   1,  Average loss: 0.0009, Accuracy: 422/423 (99.7636%)
___Train Local_ResNet_18,  epoch 248, local model 28, internal_epoch   2,  Average loss: 0.0005, Accuracy: 420/423 (99.2908%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.5696, Accuracy: 6225/10000 (62.2500%)
___Train Local_ResNet_18,  epoch 248, local model 59, internal_epoch   1,  Average loss: 0.0016, Accuracy: 621/642 (96.7290%)
___Train Local_ResNet_18,  epoch 248, local model 59, internal_epoch   2,  Average loss: 0.0014, Accuracy: 625/642 (97.3520%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 2.1010, Accuracy: 4959/10000 (49.5900%)
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 248, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 536/546 (98.1685%)
___Train Local_ResNet_18,  epoch 248, local model 11, internal_epoch   2,  Average loss: 0.0007, Accuracy: 541/546 (99.0842%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.9897, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 248, local model 20, internal_epoch   1,  Average loss: 0.0037, Accuracy: 341/362 (94.1989%)
___Train Local_ResNet_18,  epoch 248, local model 20, internal_epoch   2,  Average loss: 0.0022, Accuracy: 342/362 (94.4751%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 5.5953, Accuracy: 2917/10000 (29.1700%)
___Train Local_ResNet_18,  epoch 248, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 518/557 (92.9982%)
___Train Local_ResNet_18,  epoch 248, local model 4, internal_epoch   2,  Average loss: 0.0032, Accuracy: 522/557 (93.7163%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 3.6758, Accuracy: 4808/10000 (48.0800%)
___Train Local_ResNet_18,  epoch 248, local model 19, internal_epoch   1,  Average loss: 0.0118, Accuracy: 134/173 (77.4566%)
___Train Local_ResNet_18,  epoch 248, local model 19, internal_epoch   2,  Average loss: 0.0023, Accuracy: 166/173 (95.9538%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 5.2985, Accuracy: 3480/10000 (34.8000%)
___Train Local_ResNet_18,  epoch 248, local model 50, internal_epoch   1,  Average loss: 0.0009, Accuracy: 400/401 (99.7506%)
___Train Local_ResNet_18,  epoch 248, local model 50, internal_epoch   2,  Average loss: 0.0002, Accuracy: 401/401 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.2611, Accuracy: 6620/10000 (66.2000%)
___Train Local_ResNet_18,  epoch 248, local model 93, internal_epoch   1,  Average loss: 0.0016, Accuracy: 568/584 (97.2603%)
___Train Local_ResNet_18,  epoch 248, local model 93, internal_epoch   2,  Average loss: 0.0053, Accuracy: 548/584 (93.8356%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 3.8549, Accuracy: 3298/10000 (32.9800%)
___Train Local_ResNet_18,  epoch 248, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 590/620 (95.1613%)
___Train Local_ResNet_18,  epoch 248, local model 13, internal_epoch   2,  Average loss: 0.0028, Accuracy: 586/620 (94.5161%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 2.0705, Accuracy: 4965/10000 (49.6500%)
___Train Local_ResNet_18,  epoch 248, local model 55, internal_epoch   1,  Average loss: 0.0022, Accuracy: 290/299 (96.9900%)
___Train Local_ResNet_18,  epoch 248, local model 55, internal_epoch   2,  Average loss: 0.0005, Accuracy: 296/299 (98.9967%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 6.5795, Accuracy: 2486/10000 (24.8600%)
time spent on training: 108.94406771659851
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.11851530280008682  data num: [423, 642, 546, 362, 557, 173, 401, 584, 620, 299]
[rfa agg] considering poison per batch poison_fraction: 0.009259008031256783
[rfa agg] init. name: [28, 59, 11, 20, 4, 19, 50, 93, 13, 55], weight: tensor([0.0918, 0.1394, 0.1185, 0.0786, 0.1209, 0.0376, 0.0870, 0.1268, 0.1346,
        0.0649])
[rfa agg] iter:  0, prev_obj_val: 23.250070571899414, obj_val: 26.129060745239258, abs dis: 2.8789901733398438
[rfa agg] iter:  0, weight: tensor([0.2315, 0.0476, 0.0721, 0.1632, 0.0711, 0.0165, 0.2208, 0.0546, 0.0581,
        0.0645])
[rfa agg] iter:  1, prev_obj_val: 26.129060745239258, obj_val: 23.198274612426758, abs dis: 2.9307861328125
[rfa agg] iter:  1, weight: tensor([0.1536, 0.0479, 0.0676, 0.2820, 0.0670, 0.0214, 0.1456, 0.0535, 0.0569,
        0.1044])
[rfa agg] iter:  2, prev_obj_val: 23.198274612426758, obj_val: 23.184175491333008, abs dis: 0.01409912109375
[rfa agg] iter:  2, weight: tensor([0.2320, 0.0456, 0.0692, 0.1798, 0.0678, 0.0158, 0.2201, 0.0521, 0.0555,
        0.0622])
[rfa agg] iter:  3, prev_obj_val: 23.184175491333008, obj_val: 26.128435134887695, abs dis: 2.9442596435546875
[rfa agg] iter:  3, weight: tensor([0.2386, 0.0453, 0.0688, 0.1690, 0.0675, 0.0157, 0.2261, 0.0518, 0.0551,
        0.0619])
[rfa agg] iter:  4, prev_obj_val: 26.128435134887695, obj_val: 23.198585510253906, abs dis: 2.929849624633789
[rfa agg] iter:  4, weight: tensor([0.1533, 0.0478, 0.0674, 0.2836, 0.0669, 0.0214, 0.1454, 0.0534, 0.0568,
        0.1042])
[rfa agg] iter:  5, prev_obj_val: 23.198585510253906, obj_val: 23.184179306030273, abs dis: 0.014406204223632812
[rfa agg] iter:  5, weight: tensor([0.2319, 0.0456, 0.0692, 0.1800, 0.0678, 0.0158, 0.2200, 0.0521, 0.0555,
        0.0622])
[rfa agg] iter:  6, prev_obj_val: 23.184179306030273, obj_val: 26.12843132019043, abs dis: 2.9442520141601562
[rfa agg] iter:  6, weight: tensor([0.2386, 0.0453, 0.0688, 0.1690, 0.0675, 0.0157, 0.2261, 0.0518, 0.0551,
        0.0619])
[rfa agg] iter:  7, prev_obj_val: 26.12843132019043, obj_val: 23.198585510253906, abs dis: 2.9298458099365234
[rfa agg] iter:  7, weight: tensor([0.1533, 0.0478, 0.0674, 0.2836, 0.0669, 0.0214, 0.1454, 0.0534, 0.0568,
        0.1042])
[rfa agg] iter:  8, prev_obj_val: 23.198585510253906, obj_val: 23.184179306030273, abs dis: 0.014406204223632812
[rfa agg] iter:  8, weight: tensor([0.2319, 0.0456, 0.0692, 0.1800, 0.0678, 0.0158, 0.2200, 0.0521, 0.0555,
        0.0622])
[rfa agg] iter:  9, prev_obj_val: 23.184179306030273, obj_val: 26.12843132019043, abs dis: 2.9442520141601562
[rfa agg] iter:  9, weight: tensor([0.2386, 0.0453, 0.0688, 0.1690, 0.0675, 0.0157, 0.2261, 0.0518, 0.0551,
        0.0619])
___Test Target_ResNet_18 poisoned: False, epoch: 248: Average loss: 0.6265, Accuracy: 7958/10000 (79.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 248: Average loss: 5.7795, Accuracy: 456/9000 (5.0667%)
Done in 233.51192045211792 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:249 choose agents : [13, 33, 16, 5, 8, 3, 39, 27, 19, 93]. Adversary List: []
___Train Local_ResNet_18,  epoch 249, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 594/620 (95.8065%)
___Train Local_ResNet_18,  epoch 249, local model 13, internal_epoch   2,  Average loss: 0.0020, Accuracy: 594/620 (95.8065%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 3.2394, Accuracy: 4071/10000 (40.7100%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 249, local model 33, internal_epoch   1,  Average loss: 0.0026, Accuracy: 509/527 (96.5844%)
___Train Local_ResNet_18,  epoch 249, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 500/527 (94.8767%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 2.7602, Accuracy: 4521/10000 (45.2100%)
___Train Local_ResNet_18,  epoch 249, local model 16, internal_epoch   1,  Average loss: 0.0027, Accuracy: 756/773 (97.8008%)
___Train Local_ResNet_18,  epoch 249, local model 16, internal_epoch   2,  Average loss: 0.0211, Accuracy: 520/773 (67.2704%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 20.9243, Accuracy: 1692/10000 (16.9200%)
___Train Local_ResNet_18,  epoch 249, local model 5, internal_epoch   1,  Average loss: 0.0011, Accuracy: 360/365 (98.6301%)
___Train Local_ResNet_18,  epoch 249, local model 5, internal_epoch   2,  Average loss: 0.0003, Accuracy: 364/365 (99.7260%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 0.9749, Accuracy: 7093/10000 (70.9300%)
___Train Local_ResNet_18,  epoch 249, local model 8, internal_epoch   1,  Average loss: 0.0015, Accuracy: 526/534 (98.5019%)
___Train Local_ResNet_18,  epoch 249, local model 8, internal_epoch   2,  Average loss: 0.0011, Accuracy: 522/534 (97.7528%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 2.4336, Accuracy: 4422/10000 (44.2200%)
___Train Local_ResNet_18,  epoch 249, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 718/780 (92.0513%)
___Train Local_ResNet_18,  epoch 249, local model 3, internal_epoch   2,  Average loss: 0.0091, Accuracy: 658/780 (84.3590%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 12.3675, Accuracy: 2060/10000 (20.6000%)
___Train Local_ResNet_18,  epoch 249, local model 39, internal_epoch   1,  Average loss: 0.0025, Accuracy: 209/217 (96.3134%)
___Train Local_ResNet_18,  epoch 249, local model 39, internal_epoch   2,  Average loss: 0.0006, Accuracy: 216/217 (99.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.3664, Accuracy: 6277/10000 (62.7700%)
___Train Local_ResNet_18,  epoch 249, local model 27, internal_epoch   1,  Average loss: 0.0016, Accuracy: 391/397 (98.4887%)
___Train Local_ResNet_18,  epoch 249, local model 27, internal_epoch   2,  Average loss: 0.0030, Accuracy: 384/397 (96.7254%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.8918, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 249, local model 19, internal_epoch   1,  Average loss: 0.0107, Accuracy: 139/173 (80.3468%)
___Train Local_ResNet_18,  epoch 249, local model 19, internal_epoch   2,  Average loss: 0.0021, Accuracy: 168/173 (97.1098%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 5.9254, Accuracy: 3065/10000 (30.6500%)
___Train Local_ResNet_18,  epoch 249, local model 93, internal_epoch   1,  Average loss: 0.0013, Accuracy: 571/584 (97.7740%)
___Train Local_ResNet_18,  epoch 249, local model 93, internal_epoch   2,  Average loss: 0.0010, Accuracy: 580/584 (99.3151%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.5202, Accuracy: 6013/10000 (60.1300%)
time spent on training: 106.84968543052673
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10603621730382294  data num: [620, 527, 773, 365, 534, 780, 217, 397, 173, 584]
[rfa agg] considering poison per batch poison_fraction: 0.008284079476861167
[rfa agg] init. name: [13, 33, 16, 5, 8, 3, 39, 27, 19, 93], weight: tensor([0.1247, 0.1060, 0.1555, 0.0734, 0.1074, 0.1569, 0.0437, 0.0799, 0.0348,
        0.1175])
[rfa agg] iter:  0, prev_obj_val: 29.701065063476562, obj_val: 34.779945373535156, abs dis: 5.078880310058594
[rfa agg] iter:  0, weight: tensor([0.1106, 0.1433, 0.0623, 0.1080, 0.1533, 0.0654, 0.0291, 0.2030, 0.0181,
        0.1069])
[rfa agg] iter:  1, prev_obj_val: 34.779945373535156, obj_val: 37.853328704833984, abs dis: 3.073383331298828
[rfa agg] iter:  1, weight: tensor([0.0784, 0.0918, 0.0508, 0.2598, 0.0950, 0.0532, 0.0390, 0.2348, 0.0223,
        0.0749])
[rfa agg] iter:  2, prev_obj_val: 37.853328704833984, obj_val: 37.82826232910156, abs dis: 0.025066375732421875
[rfa agg] iter:  2, weight: tensor([0.0617, 0.0692, 0.0425, 0.4438, 0.0712, 0.0443, 0.0434, 0.1421, 0.0231,
        0.0588])
[rfa agg] iter:  3, prev_obj_val: 37.82826232910156, obj_val: 37.82399368286133, abs dis: 0.004268646240234375
[rfa agg] iter:  3, weight: tensor([0.0538, 0.0603, 0.0370, 0.5176, 0.0621, 0.0386, 0.0379, 0.1212, 0.0202,
        0.0513])
[rfa agg] iter:  4, prev_obj_val: 37.82399368286133, obj_val: 48.74860763549805, abs dis: 10.924613952636719
[rfa agg] iter:  4, weight: tensor([0.0498, 0.0559, 0.0343, 0.5533, 0.0576, 0.0358, 0.0352, 0.1117, 0.0187,
        0.0476])
[rfa agg] iter:  5, prev_obj_val: 48.74860763549805, obj_val: 48.7148551940918, abs dis: 0.03375244140625
[rfa agg] iter:  5, weight: tensor([0.0749, 0.0776, 0.0588, 0.1625, 0.0793, 0.0608, 0.2375, 0.1039, 0.0737,
        0.0711])
___Test Target_ResNet_18 poisoned: False, epoch: 249: Average loss: 0.6214, Accuracy: 7953/10000 (79.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 249: Average loss: 5.7659, Accuracy: 456/9000 (5.0667%)
Done in 229.14618492126465 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:250 choose agents : [92, 14, 74, 41, 87, 44, 60, 80, 2, 45]. Adversary List: []
___Train Local_ResNet_18,  epoch 250, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 747/796 (93.8442%)
___Train Local_ResNet_18,  epoch 250, local model 92, internal_epoch   2,  Average loss: 0.0074, Accuracy: 677/796 (85.0503%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 13.2679, Accuracy: 1846/10000 (18.4600%)
___Train Local_ResNet_18,  epoch 250, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 301/318 (94.6541%)
___Train Local_ResNet_18,  epoch 250, local model 14, internal_epoch   2,  Average loss: 0.0006, Accuracy: 316/318 (99.3711%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.9404, Accuracy: 4433/10000 (44.3300%)
___Train Local_ResNet_18,  epoch 250, local model 74, internal_epoch   1,  Average loss: 0.0016, Accuracy: 460/469 (98.0810%)
___Train Local_ResNet_18,  epoch 250, local model 74, internal_epoch   2,  Average loss: 0.0008, Accuracy: 464/469 (98.9339%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 1.4064, Accuracy: 6079/10000 (60.7900%)
___Train Local_ResNet_18,  epoch 250, local model 41, internal_epoch   1,  Average loss: 0.0210, Accuracy: 454/513 (88.4990%)
___Train Local_ResNet_18,  epoch 250, local model 41, internal_epoch   2,  Average loss: 0.0139, Accuracy: 415/513 (80.8967%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 31.0516, Accuracy: 1740/10000 (17.4000%)
___Train Local_ResNet_18,  epoch 250, local model 87, internal_epoch   1,  Average loss: 0.0051, Accuracy: 362/397 (91.1839%)
___Train Local_ResNet_18,  epoch 250, local model 87, internal_epoch   2,  Average loss: 0.0062, Accuracy: 354/397 (89.1688%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.9732, Accuracy: 3819/10000 (38.1900%)
___Train Local_ResNet_18,  epoch 250, local model 44, internal_epoch   1,  Average loss: 0.0019, Accuracy: 423/436 (97.0183%)
___Train Local_ResNet_18,  epoch 250, local model 44, internal_epoch   2,  Average loss: 0.0009, Accuracy: 430/436 (98.6239%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.0941, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch 250, local model 60, internal_epoch   1,  Average loss: 0.0015, Accuracy: 280/284 (98.5915%)
___Train Local_ResNet_18,  epoch 250, local model 60, internal_epoch   2,  Average loss: 0.0002, Accuracy: 284/284 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 1.0962, Accuracy: 6743/10000 (67.4300%)
___Train Local_ResNet_18,  epoch 250, local model 80, internal_epoch   1,  Average loss: 0.0014, Accuracy: 358/363 (98.6226%)
___Train Local_ResNet_18,  epoch 250, local model 80, internal_epoch   2,  Average loss: 0.0005, Accuracy: 362/363 (99.7245%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.8004, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch 250, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 440/461 (95.4447%)
___Train Local_ResNet_18,  epoch 250, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 439/461 (95.2278%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.7017, Accuracy: 4394/10000 (43.9400%)
___Train Local_ResNet_18,  epoch 250, local model 45, internal_epoch   1,  Average loss: 0.0037, Accuracy: 493/529 (93.1947%)
___Train Local_ResNet_18,  epoch 250, local model 45, internal_epoch   2,  Average loss: 0.0068, Accuracy: 461/529 (87.1456%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 4.3072, Accuracy: 3236/10000 (32.3600%)
time spent on training: 95.35813808441162
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [796, 318, 469, 513, 397, 436, 284, 363, 461, 529]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [92, 14, 74, 41, 87, 44, 60, 80, 2, 45], weight: tensor([0.1743, 0.0696, 0.1027, 0.1124, 0.0869, 0.0955, 0.0622, 0.0795, 0.1010,
        0.1159])
[rfa agg] iter:  0, prev_obj_val: 25.255006790161133, obj_val: 28.0474853515625, abs dis: 2.792478561401367
[rfa agg] iter:  0, weight: tensor([0.0399, 0.1008, 0.0802, 0.0563, 0.1006, 0.1348, 0.0930, 0.2598, 0.0757,
        0.0589])
[rfa agg] iter:  1, prev_obj_val: 28.0474853515625, obj_val: 44.205596923828125, abs dis: 16.158111572265625
[rfa agg] iter:  1, weight: tensor([0.0369, 0.1743, 0.0650, 0.0487, 0.0796, 0.0980, 0.1714, 0.2132, 0.0621,
        0.0508])
[rfa agg] iter:  2, prev_obj_val: 44.205596923828125, obj_val: 31.435537338256836, abs dis: 12.770059585571289
[rfa agg] iter:  2, weight: tensor([0.0668, 0.1659, 0.0834, 0.0732, 0.0882, 0.0994, 0.1501, 0.1159, 0.0813,
        0.0758])
[rfa agg] iter:  3, prev_obj_val: 31.435537338256836, obj_val: 53.036067962646484, abs dis: 21.60053062438965
[rfa agg] iter:  3, weight: tensor([0.0314, 0.2613, 0.0494, 0.0392, 0.0576, 0.0678, 0.2967, 0.1081, 0.0476,
        0.0408])
[rfa agg] iter:  4, prev_obj_val: 53.036067962646484, obj_val: 28.069509506225586, abs dis: 24.9665584564209
[rfa agg] iter:  4, weight: tensor([0.0812, 0.1363, 0.0917, 0.0836, 0.0932, 0.1041, 0.1222, 0.1114, 0.0896,
        0.0866])
[rfa agg] iter:  5, prev_obj_val: 28.069509506225586, obj_val: 39.823360443115234, abs dis: 11.753850936889648
[rfa agg] iter:  5, weight: tensor([0.0377, 0.1769, 0.0663, 0.0499, 0.0809, 0.0994, 0.1714, 0.2020, 0.0634,
        0.0520])
[rfa agg] iter:  6, prev_obj_val: 39.823360443115234, obj_val: 31.419633865356445, abs dis: 8.403726577758789
[rfa agg] iter:  6, weight: tensor([0.0567, 0.1938, 0.0755, 0.0645, 0.0820, 0.0932, 0.1778, 0.1161, 0.0734,
        0.0669])
[rfa agg] iter:  7, prev_obj_val: 31.419633865356445, obj_val: 48.618858337402344, abs dis: 17.1992244720459
[rfa agg] iter:  7, weight: tensor([0.0304, 0.2670, 0.0479, 0.0380, 0.0557, 0.0657, 0.3047, 0.1050, 0.0461,
        0.0395])
[rfa agg] iter:  8, prev_obj_val: 48.618858337402344, obj_val: 31.448143005371094, abs dis: 17.17071533203125
[rfa agg] iter:  8, weight: tensor([0.0746, 0.1487, 0.0884, 0.0791, 0.0914, 0.1024, 0.1336, 0.1137, 0.0862,
        0.0820])
[rfa agg] iter:  9, prev_obj_val: 31.448143005371094, obj_val: 53.03532409667969, abs dis: 21.587181091308594
[rfa agg] iter:  9, weight: tensor([0.0321, 0.2578, 0.0504, 0.0401, 0.0588, 0.0692, 0.2912, 0.1101, 0.0486,
        0.0417])
___Test Target_ResNet_18 poisoned: False, epoch: 250: Average loss: 0.6176, Accuracy: 7955/10000 (79.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 250: Average loss: 5.6699, Accuracy: 571/9000 (6.3444%)
Done in 231.39279961585999 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:251 choose agents : [67, 9, 92, 47, 24, 79, 63, 14, 87, 2]. Adversary List: []
___Train Local_ResNet_18,  epoch 251, local model 67, internal_epoch   1,  Average loss: 0.0021, Accuracy: 817/842 (97.0309%)
___Train Local_ResNet_18,  epoch 251, local model 67, internal_epoch   2,  Average loss: 0.0184, Accuracy: 591/842 (70.1900%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 22.1346, Accuracy: 1485/10000 (14.8500%)
___Train Local_ResNet_18,  epoch 251, local model 9, internal_epoch   1,  Average loss: 0.0025, Accuracy: 350/368 (95.1087%)
___Train Local_ResNet_18,  epoch 251, local model 9, internal_epoch   2,  Average loss: 0.0010, Accuracy: 362/368 (98.3696%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 5.1049, Accuracy: 3127/10000 (31.2700%)
___Train Local_ResNet_18,  epoch 251, local model 92, internal_epoch   1,  Average loss: 0.0041, Accuracy: 740/796 (92.9648%)
___Train Local_ResNet_18,  epoch 251, local model 92, internal_epoch   2,  Average loss: 0.0092, Accuracy: 675/796 (84.7990%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 7.9811, Accuracy: 2413/10000 (24.1300%)
___Train Local_ResNet_18,  epoch 251, local model 47, internal_epoch   1,  Average loss: 0.0021, Accuracy: 626/654 (95.7187%)
___Train Local_ResNet_18,  epoch 251, local model 47, internal_epoch   2,  Average loss: 0.0026, Accuracy: 613/654 (93.7309%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 2.9028, Accuracy: 4251/10000 (42.5100%)
___Train Local_ResNet_18,  epoch 251, local model 24, internal_epoch   1,  Average loss: 0.0019, Accuracy: 311/320 (97.1875%)
___Train Local_ResNet_18,  epoch 251, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 317/320 (99.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 1.5916, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 251, local model 79, internal_epoch   1,  Average loss: 0.0042, Accuracy: 135/154 (87.6623%)
___Train Local_ResNet_18,  epoch 251, local model 79, internal_epoch   2,  Average loss: 0.0008, Accuracy: 153/154 (99.3506%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 1.0988, Accuracy: 6920/10000 (69.2000%)
___Train Local_ResNet_18,  epoch 251, local model 63, internal_epoch   1,  Average loss: 0.0008, Accuracy: 747/752 (99.3351%)
___Train Local_ResNet_18,  epoch 251, local model 63, internal_epoch   2,  Average loss: 0.0004, Accuracy: 750/752 (99.7340%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 1.0101, Accuracy: 7097/10000 (70.9700%)
___Train Local_ResNet_18,  epoch 251, local model 14, internal_epoch   1,  Average loss: 0.0019, Accuracy: 314/318 (98.7421%)
___Train Local_ResNet_18,  epoch 251, local model 14, internal_epoch   2,  Average loss: 0.0002, Accuracy: 318/318 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 2.9147, Accuracy: 4808/10000 (48.0800%)
___Train Local_ResNet_18,  epoch 251, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 371/397 (93.4509%)
___Train Local_ResNet_18,  epoch 251, local model 87, internal_epoch   2,  Average loss: 0.0064, Accuracy: 353/397 (88.9169%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 5.3011, Accuracy: 2892/10000 (28.9200%)
___Train Local_ResNet_18,  epoch 251, local model 2, internal_epoch   1,  Average loss: 0.0050, Accuracy: 437/461 (94.7939%)
___Train Local_ResNet_18,  epoch 251, local model 2, internal_epoch   2,  Average loss: 0.0130, Accuracy: 394/461 (85.4664%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 23.0360, Accuracy: 1057/10000 (10.5700%)
time spent on training: 95.6525661945343
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [842, 368, 796, 654, 320, 154, 752, 318, 397, 461]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [67, 9, 92, 47, 24, 79, 63, 14, 87, 2], weight: tensor([0.1663, 0.0727, 0.1573, 0.1292, 0.0632, 0.0304, 0.1486, 0.0628, 0.0784,
        0.0911])
[rfa agg] iter:  0, prev_obj_val: 35.48099899291992, obj_val: 41.58226776123047, abs dis: 6.101268768310547
[rfa agg] iter:  0, weight: tensor([0.0692, 0.1239, 0.0786, 0.1009, 0.0698, 0.0190, 0.0926, 0.0693, 0.1906,
        0.1861])
[rfa agg] iter:  1, prev_obj_val: 41.58226776123047, obj_val: 44.29335021972656, abs dis: 2.7110824584960938
[rfa agg] iter:  1, weight: tensor([0.0463, 0.2724, 0.0509, 0.0588, 0.1318, 0.0231, 0.0570, 0.1311, 0.1365,
        0.0921])
[rfa agg] iter:  2, prev_obj_val: 44.29335021972656, obj_val: 41.515296936035156, abs dis: 2.7780532836914062
[rfa agg] iter:  2, weight: tensor([0.0392, 0.2207, 0.0427, 0.0481, 0.2094, 0.0249, 0.0473, 0.2068, 0.0931,
        0.0679])
[rfa agg] iter:  3, prev_obj_val: 41.515296936035156, obj_val: 44.294002532958984, abs dis: 2.778705596923828
[rfa agg] iter:  3, weight: tensor([0.0422, 0.3275, 0.0465, 0.0537, 0.1273, 0.0213, 0.0522, 0.1261, 0.1214,
        0.0818])
[rfa agg] iter:  4, prev_obj_val: 44.294002532958984, obj_val: 41.51460647583008, abs dis: 2.7793960571289062
[rfa agg] iter:  4, weight: tensor([0.0389, 0.2274, 0.0423, 0.0477, 0.2082, 0.0247, 0.0469, 0.2049, 0.0918,
        0.0672])
[rfa agg] iter:  5, prev_obj_val: 41.51460647583008, obj_val: 44.29418182373047, abs dis: 2.7795753479003906
[rfa agg] iter:  5, weight: tensor([0.0421, 0.3295, 0.0464, 0.0536, 0.1269, 0.0212, 0.0520, 0.1257, 0.1210,
        0.0815])
[rfa agg] iter:  6, prev_obj_val: 44.29418182373047, obj_val: 41.51457595825195, abs dis: 2.7796058654785156
[rfa agg] iter:  6, weight: tensor([0.0388, 0.2276, 0.0423, 0.0477, 0.2081, 0.0247, 0.0469, 0.2048, 0.0918,
        0.0672])
[rfa agg] iter:  7, prev_obj_val: 41.51457595825195, obj_val: 44.294189453125, abs dis: 2.779613494873047
[rfa agg] iter:  7, weight: tensor([0.0421, 0.3296, 0.0464, 0.0536, 0.1269, 0.0212, 0.0520, 0.1257, 0.1210,
        0.0815])
[rfa agg] iter:  8, prev_obj_val: 44.294189453125, obj_val: 41.51457214355469, abs dis: 2.7796173095703125
[rfa agg] iter:  8, weight: tensor([0.0388, 0.2276, 0.0423, 0.0477, 0.2081, 0.0247, 0.0469, 0.2048, 0.0918,
        0.0672])
[rfa agg] iter:  9, prev_obj_val: 41.51457214355469, obj_val: 44.294189453125, abs dis: 2.7796173095703125
[rfa agg] iter:  9, weight: tensor([0.0421, 0.3296, 0.0464, 0.0536, 0.1269, 0.0212, 0.0520, 0.1257, 0.1210,
        0.0815])
___Test Target_ResNet_18 poisoned: False, epoch: 251: Average loss: 0.6195, Accuracy: 7940/10000 (79.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 251: Average loss: 5.6121, Accuracy: 641/9000 (7.1222%)
Done in 232.88527512550354 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:252 choose agents : [64, 12, 61, 1, 84, 9, 0, 14, 88, 16]. Adversary List: []
___Train Local_ResNet_18,  epoch 252, local model 64, internal_epoch   1,  Average loss: 0.0020, Accuracy: 654/686 (95.3353%)
___Train Local_ResNet_18,  epoch 252, local model 64, internal_epoch   2,  Average loss: 0.0028, Accuracy: 652/686 (95.0437%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 1.7318, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 252, local model 12, internal_epoch   1,  Average loss: 0.0032, Accuracy: 916/977 (93.7564%)
___Train Local_ResNet_18,  epoch 252, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 853/977 (87.3081%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 3.1727, Accuracy: 3046/10000 (30.4600%)
___Train Local_ResNet_18,  epoch 252, local model 61, internal_epoch   1,  Average loss: 0.0034, Accuracy: 549/590 (93.0508%)
___Train Local_ResNet_18,  epoch 252, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 543/590 (92.0339%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 3.2634, Accuracy: 3525/10000 (35.2500%)
___Train Local_ResNet_18,  epoch 252, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 614/641 (95.7878%)
___Train Local_ResNet_18,  epoch 252, local model 1, internal_epoch   2,  Average loss: 0.0119, Accuracy: 582/641 (90.7956%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 3.9101, Accuracy: 4013/10000 (40.1300%)
___Train Local_ResNet_18,  epoch 252, local model 84, internal_epoch   1,  Average loss: 0.0028, Accuracy: 1001/1053 (95.0617%)
___Train Local_ResNet_18,  epoch 252, local model 84, internal_epoch   2,  Average loss: 0.0091, Accuracy: 880/1053 (83.5708%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 8.4021, Accuracy: 2924/10000 (29.2400%)
___Train Local_ResNet_18,  epoch 252, local model 9, internal_epoch   1,  Average loss: 0.0015, Accuracy: 363/368 (98.6413%)
___Train Local_ResNet_18,  epoch 252, local model 9, internal_epoch   2,  Average loss: 0.0007, Accuracy: 363/368 (98.6413%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 2.6326, Accuracy: 4953/10000 (49.5300%)
___Train Local_ResNet_18,  epoch 252, local model 0, internal_epoch   1,  Average loss: 0.0015, Accuracy: 365/367 (99.4550%)
___Train Local_ResNet_18,  epoch 252, local model 0, internal_epoch   2,  Average loss: 0.0007, Accuracy: 364/367 (99.1826%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 2.2486, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch 252, local model 14, internal_epoch   1,  Average loss: 0.0014, Accuracy: 317/318 (99.6855%)
___Train Local_ResNet_18,  epoch 252, local model 14, internal_epoch   2,  Average loss: 0.0002, Accuracy: 318/318 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 1.7322, Accuracy: 5989/10000 (59.8900%)
___Train Local_ResNet_18,  epoch 252, local model 88, internal_epoch   1,  Average loss: 0.0037, Accuracy: 415/447 (92.8412%)
___Train Local_ResNet_18,  epoch 252, local model 88, internal_epoch   2,  Average loss: 0.0029, Accuracy: 424/447 (94.8546%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 3.5567, Accuracy: 3482/10000 (34.8200%)
___Train Local_ResNet_18,  epoch 252, local model 16, internal_epoch   1,  Average loss: 0.0019, Accuracy: 758/773 (98.0595%)
___Train Local_ResNet_18,  epoch 252, local model 16, internal_epoch   2,  Average loss: 0.0113, Accuracy: 623/773 (80.5951%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 9.3717, Accuracy: 2304/10000 (23.0400%)
time spent on training: 99.60032844543457
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [686, 977, 590, 641, 1053, 368, 367, 318, 447, 773]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [64, 12, 61, 1, 84, 9, 0, 14, 88, 16], weight: tensor([0.1103, 0.1571, 0.0949, 0.1031, 0.1693, 0.0592, 0.0590, 0.0511, 0.0719,
        0.1243])
[rfa agg] iter:  0, prev_obj_val: 37.15187072753906, obj_val: 41.15381622314453, abs dis: 4.001945495605469
[rfa agg] iter:  0, weight: tensor([0.1812, 0.0675, 0.2317, 0.1593, 0.0632, 0.0476, 0.0475, 0.0322, 0.0777,
        0.0920])
[rfa agg] iter:  1, prev_obj_val: 41.15381622314453, obj_val: 45.68175506591797, abs dis: 4.5279388427734375
[rfa agg] iter:  1, weight: tensor([0.1384, 0.0675, 0.1801, 0.1262, 0.0642, 0.0761, 0.0759, 0.0476, 0.1387,
        0.0851])
[rfa agg] iter:  2, prev_obj_val: 45.68175506591797, obj_val: 50.872196197509766, abs dis: 5.190441131591797
[rfa agg] iter:  2, weight: tensor([0.0937, 0.0555, 0.1089, 0.0864, 0.0535, 0.1143, 0.1140, 0.0615, 0.2461,
        0.0660])
[rfa agg] iter:  3, prev_obj_val: 50.872196197509766, obj_val: 53.93598556518555, abs dis: 3.0637893676757812
[rfa agg] iter:  3, weight: tensor([0.0572, 0.0387, 0.0619, 0.0529, 0.0377, 0.2073, 0.2092, 0.0783, 0.2129,
        0.0438])
[rfa agg] iter:  4, prev_obj_val: 53.93598556518555, obj_val: 74.70511627197266, abs dis: 20.76913070678711
[rfa agg] iter:  4, weight: tensor([0.0407, 0.0291, 0.0431, 0.0377, 0.0285, 0.2865, 0.2975, 0.0908, 0.1140,
        0.0322])
[rfa agg] iter:  5, prev_obj_val: 74.70511627197266, obj_val: 53.97210693359375, abs dis: 20.733009338378906
[rfa agg] iter:  5, weight: tensor([0.0808, 0.0690, 0.0797, 0.0752, 0.0688, 0.1297, 0.1295, 0.1848, 0.1113,
        0.0711])
[rfa agg] iter:  6, prev_obj_val: 53.97210693359375, obj_val: 70.2847900390625, abs dis: 16.31268310546875
[rfa agg] iter:  6, weight: tensor([0.0435, 0.0310, 0.0460, 0.0403, 0.0304, 0.2781, 0.2832, 0.0968, 0.1162,
        0.0345])
[rfa agg] iter:  7, prev_obj_val: 70.2847900390625, obj_val: 53.957191467285156, abs dis: 16.327598571777344
[rfa agg] iter:  7, weight: tensor([0.0725, 0.0601, 0.0722, 0.0674, 0.0598, 0.1352, 0.1350, 0.2268, 0.1081,
        0.0628])
[rfa agg] iter:  8, prev_obj_val: 53.957191467285156, obj_val: 70.28569030761719, abs dis: 16.32849884033203
[rfa agg] iter:  8, weight: tensor([0.0424, 0.0303, 0.0449, 0.0393, 0.0297, 0.2822, 0.2885, 0.0953, 0.1138,
        0.0336])
[rfa agg] iter:  9, prev_obj_val: 70.28569030761719, obj_val: 53.95718002319336, abs dis: 16.328510284423828
[rfa agg] iter:  9, weight: tensor([0.0725, 0.0601, 0.0722, 0.0674, 0.0598, 0.1352, 0.1350, 0.2269, 0.1081,
        0.0628])
___Test Target_ResNet_18 poisoned: False, epoch: 252: Average loss: 0.6212, Accuracy: 7943/10000 (79.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 252: Average loss: 5.5934, Accuracy: 681/9000 (7.5667%)
Done in 235.9119508266449 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:253 choose agents : [48, 44, 4, 45, 1, 58, 22, 13, 52, 20]. Adversary List: []
___Train Local_ResNet_18,  epoch 253, local model 48, internal_epoch   1,  Average loss: 0.0017, Accuracy: 370/378 (97.8836%)
___Train Local_ResNet_18,  epoch 253, local model 48, internal_epoch   2,  Average loss: 0.0004, Accuracy: 378/378 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 1.7973, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 253, local model 44, internal_epoch   1,  Average loss: 0.0013, Accuracy: 429/436 (98.3945%)
___Train Local_ResNet_18,  epoch 253, local model 44, internal_epoch   2,  Average loss: 0.0005, Accuracy: 434/436 (99.5413%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 1.6316, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 253, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 516/557 (92.6391%)
___Train Local_ResNet_18,  epoch 253, local model 4, internal_epoch   2,  Average loss: 0.0026, Accuracy: 524/557 (94.0754%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 2.9443, Accuracy: 4666/10000 (46.6600%)
___Train Local_ResNet_18,  epoch 253, local model 45, internal_epoch   1,  Average loss: 0.0038, Accuracy: 499/529 (94.3289%)
___Train Local_ResNet_18,  epoch 253, local model 45, internal_epoch   2,  Average loss: 0.0130, Accuracy: 441/529 (83.3648%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 9.9740, Accuracy: 2134/10000 (21.3400%)
___Train Local_ResNet_18,  epoch 253, local model 1, internal_epoch   1,  Average loss: 0.0049, Accuracy: 630/641 (98.2839%)
___Train Local_ResNet_18,  epoch 253, local model 1, internal_epoch   2,  Average loss: 0.0106, Accuracy: 577/641 (90.0156%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 5.5744, Accuracy: 3126/10000 (31.2600%)
___Train Local_ResNet_18,  epoch 253, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 217/234 (92.7350%)
___Train Local_ResNet_18,  epoch 253, local model 58, internal_epoch   2,  Average loss: 0.0007, Accuracy: 232/234 (99.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 3.6433, Accuracy: 3497/10000 (34.9700%)
___Train Local_ResNet_18,  epoch 253, local model 22, internal_epoch   1,  Average loss: 0.0029, Accuracy: 464/494 (93.9271%)
___Train Local_ResNet_18,  epoch 253, local model 22, internal_epoch   2,  Average loss: 0.0015, Accuracy: 478/494 (96.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 2.6802, Accuracy: 4292/10000 (42.9200%)
___Train Local_ResNet_18,  epoch 253, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 589/620 (95.0000%)
___Train Local_ResNet_18,  epoch 253, local model 13, internal_epoch   2,  Average loss: 0.0022, Accuracy: 596/620 (96.1290%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 2.6541, Accuracy: 4493/10000 (44.9300%)
___Train Local_ResNet_18,  epoch 253, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 205/214 (95.7944%)
___Train Local_ResNet_18,  epoch 253, local model 52, internal_epoch   2,  Average loss: 0.0010, Accuracy: 212/214 (99.0654%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 2.1749, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch 253, local model 20, internal_epoch   1,  Average loss: 0.0026, Accuracy: 349/362 (96.4088%)
___Train Local_ResNet_18,  epoch 253, local model 20, internal_epoch   2,  Average loss: 0.0009, Accuracy: 358/362 (98.8950%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 4.7384, Accuracy: 4123/10000 (41.2300%)
time spent on training: 94.66138362884521
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [378, 436, 557, 529, 641, 234, 494, 620, 214, 362]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [48, 44, 4, 45, 1, 58, 22, 13, 52, 20], weight: tensor([0.0847, 0.0976, 0.1247, 0.1185, 0.1436, 0.0524, 0.1106, 0.1389, 0.0479,
        0.0811])
[rfa agg] iter:  0, prev_obj_val: 24.12953758239746, obj_val: 34.05573654174805, abs dis: 9.926198959350586
[rfa agg] iter:  0, weight: tensor([0.2862, 0.1324, 0.0595, 0.0546, 0.0422, 0.0380, 0.0778, 0.0507, 0.0348,
        0.2237])
[rfa agg] iter:  1, prev_obj_val: 34.05573654174805, obj_val: 30.5163516998291, abs dis: 3.5393848419189453
[rfa agg] iter:  1, weight: tensor([0.1287, 0.0899, 0.0633, 0.0590, 0.0509, 0.1858, 0.0722, 0.0581, 0.1709,
        0.1212])
[rfa agg] iter:  2, prev_obj_val: 30.5163516998291, obj_val: 30.511398315429688, abs dis: 0.0049533843994140625
[rfa agg] iter:  2, weight: tensor([0.1803, 0.1087, 0.0690, 0.0640, 0.0536, 0.1117, 0.0815, 0.0621, 0.1023,
        0.1667])
___Test Target_ResNet_18 poisoned: False, epoch: 253: Average loss: 0.6219, Accuracy: 7934/10000 (79.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 253: Average loss: 5.6113, Accuracy: 624/9000 (6.9333%)
Done in 212.5426151752472 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:254 choose agents : [95, 47, 93, 56, 5, 31, 75, 13, 77, 4]. Adversary List: []
___Train Local_ResNet_18,  epoch 254, local model 95, internal_epoch   1,  Average loss: 0.0052, Accuracy: 507/569 (89.1037%)
___Train Local_ResNet_18,  epoch 254, local model 95, internal_epoch   2,  Average loss: 0.0053, Accuracy: 502/569 (88.2250%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 6.0335, Accuracy: 2735/10000 (27.3500%)
___Train Local_ResNet_18,  epoch 254, local model 47, internal_epoch   1,  Average loss: 0.0018, Accuracy: 633/654 (96.7890%)
___Train Local_ResNet_18,  epoch 254, local model 47, internal_epoch   2,  Average loss: 0.0016, Accuracy: 630/654 (96.3303%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 1.6712, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 254, local model 93, internal_epoch   1,  Average loss: 0.0017, Accuracy: 573/584 (98.1164%)
___Train Local_ResNet_18,  epoch 254, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 550/584 (94.1781%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 2.9668, Accuracy: 3954/10000 (39.5400%)
___Train Local_ResNet_18,  epoch 254, local model 56, internal_epoch   1,  Average loss: 0.0009, Accuracy: 737/743 (99.1925%)
___Train Local_ResNet_18,  epoch 254, local model 56, internal_epoch   2,  Average loss: 0.0005, Accuracy: 738/743 (99.3271%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 1.1474, Accuracy: 6792/10000 (67.9200%)
___Train Local_ResNet_18,  epoch 254, local model 5, internal_epoch   1,  Average loss: 0.0011, Accuracy: 363/365 (99.4521%)
___Train Local_ResNet_18,  epoch 254, local model 5, internal_epoch   2,  Average loss: 0.0002, Accuracy: 364/365 (99.7260%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 1.1106, Accuracy: 6767/10000 (67.6700%)
___Train Local_ResNet_18,  epoch 254, local model 31, internal_epoch   1,  Average loss: 0.0017, Accuracy: 682/706 (96.6006%)
___Train Local_ResNet_18,  epoch 254, local model 31, internal_epoch   2,  Average loss: 0.0029, Accuracy: 662/706 (93.7677%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 3.9282, Accuracy: 3479/10000 (34.7900%)
___Train Local_ResNet_18,  epoch 254, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 564/578 (97.5779%)
___Train Local_ResNet_18,  epoch 254, local model 75, internal_epoch   2,  Average loss: 0.0385, Accuracy: 306/578 (52.9412%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 628.6672, Accuracy: 1002/10000 (10.0200%)
___Train Local_ResNet_18,  epoch 254, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 586/620 (94.5161%)
___Train Local_ResNet_18,  epoch 254, local model 13, internal_epoch   2,  Average loss: 0.0022, Accuracy: 590/620 (95.1613%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 2.1006, Accuracy: 5039/10000 (50.3900%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 254, local model 77, internal_epoch   1,  Average loss: 0.0008, Accuracy: 495/496 (99.7984%)
___Train Local_ResNet_18,  epoch 254, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 496/496 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 1.1819, Accuracy: 6792/10000 (67.9200%)
___Train Local_ResNet_18,  epoch 254, local model 4, internal_epoch   1,  Average loss: 0.0024, Accuracy: 529/557 (94.9731%)
___Train Local_ResNet_18,  epoch 254, local model 4, internal_epoch   2,  Average loss: 0.0031, Accuracy: 528/557 (94.7935%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 2.8683, Accuracy: 4713/10000 (47.1300%)
time spent on training: 110.04888081550598
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.08446866485013624  data num: [569, 654, 584, 743, 365, 706, 578, 620, 496, 557]
[rfa agg] considering poison per batch poison_fraction: 0.006599114441416894
[rfa agg] init. name: [95, 47, 93, 56, 5, 31, 75, 13, 77, 4], weight: tensor([0.0969, 0.1114, 0.0995, 0.1265, 0.0622, 0.1202, 0.0984, 0.1056, 0.0845,
        0.0949])
[rfa agg] iter:  0, prev_obj_val: 30.431594848632812, obj_val: 34.03307342529297, abs dis: 3.6014785766601562
[rfa agg] iter:  0, weight: tensor([0.1105, 0.0724, 0.0837, 0.0666, 0.1451, 0.0627, 0.0565, 0.0891, 0.1980,
        0.1154])
[rfa agg] iter:  1, prev_obj_val: 34.03307342529297, obj_val: 34.02881622314453, abs dis: 0.0042572021484375
[rfa agg] iter:  1, weight: tensor([0.0963, 0.0664, 0.0748, 0.0623, 0.2619, 0.0587, 0.0528, 0.0796, 0.1485,
        0.0986])
[rfa agg] iter:  2, prev_obj_val: 34.02881622314453, obj_val: 34.02877426147461, abs dis: 4.1961669921875e-05
[rfa agg] iter:  2, weight: tensor([0.0950, 0.0657, 0.0739, 0.0616, 0.2707, 0.0581, 0.0521, 0.0787, 0.1469,
        0.0974])
___Test Target_ResNet_18 poisoned: False, epoch: 254: Average loss: 0.6308, Accuracy: 7887/10000 (78.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 254: Average loss: 5.5523, Accuracy: 577/9000 (6.4111%)
Done in 224.51445698738098 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:255 choose agents : [17, 65, 22, 0, 49, 14, 87, 55, 30, 92]. Adversary List: []
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 255, local model 17, internal_epoch   1,  Average loss: 0.0011, Accuracy: 522/526 (99.2395%)
___Train Local_ResNet_18,  epoch 255, local model 17, internal_epoch   2,  Average loss: 0.0008, Accuracy: 519/526 (98.6692%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 1.1509, Accuracy: 6814/10000 (68.1400%)
___Train Local_ResNet_18,  epoch 255, local model 65, internal_epoch   1,  Average loss: 0.0012, Accuracy: 313/314 (99.6815%)
___Train Local_ResNet_18,  epoch 255, local model 65, internal_epoch   2,  Average loss: 0.0002, Accuracy: 314/314 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 0.9607, Accuracy: 7220/10000 (72.2000%)
___Train Local_ResNet_18,  epoch 255, local model 22, internal_epoch   1,  Average loss: 0.0026, Accuracy: 473/494 (95.7490%)
___Train Local_ResNet_18,  epoch 255, local model 22, internal_epoch   2,  Average loss: 0.0016, Accuracy: 477/494 (96.5587%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 1.8035, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 255, local model 0, internal_epoch   1,  Average loss: 0.0010, Accuracy: 366/367 (99.7275%)
___Train Local_ResNet_18,  epoch 255, local model 0, internal_epoch   2,  Average loss: 0.0003, Accuracy: 367/367 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 1.4465, Accuracy: 6336/10000 (63.3600%)
___Train Local_ResNet_18,  epoch 255, local model 49, internal_epoch   1,  Average loss: 0.0018, Accuracy: 414/426 (97.1831%)
___Train Local_ResNet_18,  epoch 255, local model 49, internal_epoch   2,  Average loss: 0.0006, Accuracy: 423/426 (99.2958%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 2.6156, Accuracy: 4742/10000 (47.4200%)
___Train Local_ResNet_18,  epoch 255, local model 14, internal_epoch   1,  Average loss: 0.0014, Accuracy: 316/318 (99.3711%)
___Train Local_ResNet_18,  epoch 255, local model 14, internal_epoch   2,  Average loss: 0.0005, Accuracy: 317/318 (99.6855%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 2.2196, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 255, local model 87, internal_epoch   1,  Average loss: 0.0039, Accuracy: 367/397 (92.4433%)
___Train Local_ResNet_18,  epoch 255, local model 87, internal_epoch   2,  Average loss: 0.0049, Accuracy: 365/397 (91.9395%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 2.2697, Accuracy: 4731/10000 (47.3100%)
___Train Local_ResNet_18,  epoch 255, local model 55, internal_epoch   1,  Average loss: 0.0021, Accuracy: 289/299 (96.6555%)
___Train Local_ResNet_18,  epoch 255, local model 55, internal_epoch   2,  Average loss: 0.0003, Accuracy: 298/299 (99.6656%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 4.3507, Accuracy: 3655/10000 (36.5500%)
___Train Local_ResNet_18,  epoch 255, local model 30, internal_epoch   1,  Average loss: 0.0018, Accuracy: 332/337 (98.5163%)
___Train Local_ResNet_18,  epoch 255, local model 30, internal_epoch   2,  Average loss: 0.0012, Accuracy: 332/337 (98.5163%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 1.6841, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 255, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 749/796 (94.0955%)
___Train Local_ResNet_18,  epoch 255, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 717/796 (90.0754%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 7.9755, Accuracy: 2180/10000 (21.8000%)
time spent on training: 107.00374794006348
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.12306972391202621  data num: [526, 314, 494, 367, 426, 318, 397, 299, 337, 796]
[rfa agg] considering poison per batch poison_fraction: 0.009614822180627048
[rfa agg] init. name: [17, 65, 22, 0, 49, 14, 87, 55, 30, 92], weight: tensor([0.1231, 0.0735, 0.1156, 0.0859, 0.0997, 0.0744, 0.0929, 0.0700, 0.0788,
        0.1862])
[rfa agg] iter:  0, prev_obj_val: 27.049541473388672, obj_val: 43.99140930175781, abs dis: 16.94186782836914
[rfa agg] iter:  0, weight: tensor([0.0338, 0.2496, 0.0417, 0.0889, 0.0535, 0.2156, 0.0479, 0.1637, 0.0798,
        0.0256])
[rfa agg] iter:  1, prev_obj_val: 43.99140930175781, obj_val: 26.826183319091797, abs dis: 17.165225982666016
[rfa agg] iter:  1, weight: tensor([0.0752, 0.1345, 0.0842, 0.1048, 0.0910, 0.1358, 0.0839, 0.1267, 0.0960,
        0.0679])
[rfa agg] iter:  2, prev_obj_val: 26.826183319091797, obj_val: 48.43416976928711, abs dis: 21.607986450195312
[rfa agg] iter:  2, weight: tensor([0.0274, 0.2948, 0.0338, 0.0740, 0.0436, 0.2372, 0.0390, 0.1633, 0.0663,
        0.0206])
[rfa agg] iter:  3, prev_obj_val: 48.43416976928711, obj_val: 26.83760643005371, abs dis: 21.5965633392334
[rfa agg] iter:  3, weight: tensor([0.0810, 0.1257, 0.0894, 0.1049, 0.0945, 0.1270, 0.0872, 0.1188, 0.0961,
        0.0755])
[rfa agg] iter:  4, prev_obj_val: 26.83760643005371, obj_val: 48.433937072753906, abs dis: 21.596330642700195
[rfa agg] iter:  4, weight: tensor([0.0279, 0.2916, 0.0343, 0.0751, 0.0443, 0.2356, 0.0397, 0.1632, 0.0674,
        0.0210])
[rfa agg] iter:  5, prev_obj_val: 48.433937072753906, obj_val: 26.837608337402344, abs dis: 21.596328735351562
[rfa agg] iter:  5, weight: tensor([0.0810, 0.1257, 0.0894, 0.1049, 0.0945, 0.1270, 0.0872, 0.1188, 0.0961,
        0.0755])
[rfa agg] iter:  6, prev_obj_val: 26.837608337402344, obj_val: 48.433937072753906, abs dis: 21.596328735351562
[rfa agg] iter:  6, weight: tensor([0.0279, 0.2916, 0.0343, 0.0751, 0.0443, 0.2356, 0.0397, 0.1632, 0.0674,
        0.0210])
[rfa agg] iter:  7, prev_obj_val: 48.433937072753906, obj_val: 26.837608337402344, abs dis: 21.596328735351562
[rfa agg] iter:  7, weight: tensor([0.0810, 0.1257, 0.0894, 0.1049, 0.0945, 0.1270, 0.0872, 0.1188, 0.0961,
        0.0755])
[rfa agg] iter:  8, prev_obj_val: 26.837608337402344, obj_val: 48.433937072753906, abs dis: 21.596328735351562
[rfa agg] iter:  8, weight: tensor([0.0279, 0.2916, 0.0343, 0.0751, 0.0443, 0.2356, 0.0397, 0.1632, 0.0674,
        0.0210])
[rfa agg] iter:  9, prev_obj_val: 48.433937072753906, obj_val: 26.837608337402344, abs dis: 21.596328735351562
[rfa agg] iter:  9, weight: tensor([0.0810, 0.1257, 0.0894, 0.1049, 0.0945, 0.1270, 0.0872, 0.1188, 0.0961,
        0.0755])
___Test Target_ResNet_18 poisoned: False, epoch: 255: Average loss: 0.6294, Accuracy: 7903/10000 (79.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 255: Average loss: 5.5205, Accuracy: 605/9000 (6.7222%)
Done in 234.40912055969238 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:256 choose agents : [89, 69, 73, 15, 31, 36, 22, 1, 0, 96]. Adversary List: []
___Train Local_ResNet_18,  epoch 256, local model 89, internal_epoch   1,  Average loss: 0.0029, Accuracy: 393/413 (95.1574%)
___Train Local_ResNet_18,  epoch 256, local model 89, internal_epoch   2,  Average loss: 0.0022, Accuracy: 397/413 (96.1259%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 3.4597, Accuracy: 3557/10000 (35.5700%)
___Train Local_ResNet_18,  epoch 256, local model 69, internal_epoch   1,  Average loss: 0.0052, Accuracy: 197/216 (91.2037%)
___Train Local_ResNet_18,  epoch 256, local model 69, internal_epoch   2,  Average loss: 0.0011, Accuracy: 214/216 (99.0741%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 7.2718, Accuracy: 1520/10000 (15.2000%)
___Train Local_ResNet_18,  epoch 256, local model 73, internal_epoch   1,  Average loss: 0.0088, Accuracy: 414/500 (82.8000%)
___Train Local_ResNet_18,  epoch 256, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 465/500 (93.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 6.8840, Accuracy: 2593/10000 (25.9300%)
___Train Local_ResNet_18,  epoch 256, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 304/341 (89.1496%)
___Train Local_ResNet_18,  epoch 256, local model 15, internal_epoch   2,  Average loss: 0.0023, Accuracy: 328/341 (96.1877%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 4.3534, Accuracy: 3120/10000 (31.2000%)
___Train Local_ResNet_18,  epoch 256, local model 31, internal_epoch   1,  Average loss: 0.0028, Accuracy: 688/706 (97.4504%)
___Train Local_ResNet_18,  epoch 256, local model 31, internal_epoch   2,  Average loss: 0.0197, Accuracy: 504/706 (71.3881%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 33.2618, Accuracy: 1089/10000 (10.8900%)
___Train Local_ResNet_18,  epoch 256, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 802/849 (94.4641%)
___Train Local_ResNet_18,  epoch 256, local model 36, internal_epoch   2,  Average loss: 0.0173, Accuracy: 608/849 (71.6137%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 7.8448, Accuracy: 2012/10000 (20.1200%)
___Train Local_ResNet_18,  epoch 256, local model 22, internal_epoch   1,  Average loss: 0.0023, Accuracy: 472/494 (95.5466%)
___Train Local_ResNet_18,  epoch 256, local model 22, internal_epoch   2,  Average loss: 0.0014, Accuracy: 481/494 (97.3684%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 2.2403, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch 256, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 625/641 (97.5039%)
___Train Local_ResNet_18,  epoch 256, local model 1, internal_epoch   2,  Average loss: 0.0110, Accuracy: 614/641 (95.7878%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 3.8072, Accuracy: 4025/10000 (40.2500%)
___Train Local_ResNet_18,  epoch 256, local model 0, internal_epoch   1,  Average loss: 0.0011, Accuracy: 365/367 (99.4550%)
___Train Local_ResNet_18,  epoch 256, local model 0, internal_epoch   2,  Average loss: 0.0005, Accuracy: 365/367 (99.4550%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 1.7108, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 256, local model 96, internal_epoch   1,  Average loss: 0.0010, Accuracy: 702/708 (99.1525%)
___Train Local_ResNet_18,  epoch 256, local model 96, internal_epoch   2,  Average loss: 0.0011, Accuracy: 700/708 (98.8701%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 1.8648, Accuracy: 5700/10000 (57.0000%)
time spent on training: 96.18049120903015
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [413, 216, 500, 341, 706, 849, 494, 641, 367, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 69, 73, 15, 31, 36, 22, 1, 0, 96], weight: tensor([0.0789, 0.0413, 0.0955, 0.0651, 0.1349, 0.1622, 0.0944, 0.1224, 0.0701,
        0.1352])
[rfa agg] iter:  0, prev_obj_val: 31.100357055664062, obj_val: 38.5632438659668, abs dis: 7.462886810302734
[rfa agg] iter:  0, weight: tensor([0.1777, 0.0248, 0.1620, 0.0801, 0.0583, 0.0514, 0.2163, 0.0727, 0.0932,
        0.0636])
[rfa agg] iter:  1, prev_obj_val: 38.5632438659668, obj_val: 42.08354949951172, abs dis: 3.520305633544922
[rfa agg] iter:  1, weight: tensor([0.1330, 0.0398, 0.0854, 0.1647, 0.0421, 0.0393, 0.0903, 0.0483, 0.3122,
        0.0448])
[rfa agg] iter:  2, prev_obj_val: 42.08354949951172, obj_val: 38.4826545715332, abs dis: 3.6008949279785156
[rfa agg] iter:  2, weight: tensor([0.1148, 0.0621, 0.0830, 0.1825, 0.0464, 0.0440, 0.0866, 0.0522, 0.2791,
        0.0492])
[rfa agg] iter:  3, prev_obj_val: 38.4826545715332, obj_val: 49.96808624267578, abs dis: 11.485431671142578
[rfa agg] iter:  3, weight: tensor([0.1170, 0.0356, 0.0742, 0.1725, 0.0373, 0.0348, 0.0793, 0.0428, 0.3668,
        0.0398])
[rfa agg] iter:  4, prev_obj_val: 49.96808624267578, obj_val: 45.96670913696289, abs dis: 4.001377105712891
[rfa agg] iter:  4, weight: tensor([0.1023, 0.1997, 0.0871, 0.1327, 0.0576, 0.0558, 0.0887, 0.0626, 0.1534,
        0.0602])
[rfa agg] iter:  5, prev_obj_val: 45.96670913696289, obj_val: 45.963592529296875, abs dis: 0.003116607666015625
[rfa agg] iter:  5, weight: tensor([0.1133, 0.1151, 0.0907, 0.1608, 0.0556, 0.0533, 0.0931, 0.0613, 0.1984,
        0.0584])
___Test Target_ResNet_18 poisoned: False, epoch: 256: Average loss: 0.6310, Accuracy: 7900/10000 (79.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 256: Average loss: 5.4965, Accuracy: 581/9000 (6.4556%)
Done in 221.9357249736786 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:257 choose agents : [54, 37, 60, 30, 4, 36, 19, 95, 47, 88]. Adversary List: []
___Train Local_ResNet_18,  epoch 257, local model 54, internal_epoch   1,  Average loss: 0.0016, Accuracy: 430/440 (97.7273%)
___Train Local_ResNet_18,  epoch 257, local model 54, internal_epoch   2,  Average loss: 0.0004, Accuracy: 438/440 (99.5455%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 2.3212, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 257, local model 37, internal_epoch   1,  Average loss: 0.0032, Accuracy: 693/725 (95.5862%)
___Train Local_ResNet_18,  epoch 257, local model 37, internal_epoch   2,  Average loss: 0.0102, Accuracy: 604/725 (83.3103%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 6.7395, Accuracy: 2386/10000 (23.8600%)
___Train Local_ResNet_18,  epoch 257, local model 60, internal_epoch   1,  Average loss: 0.0012, Accuracy: 281/284 (98.9437%)
___Train Local_ResNet_18,  epoch 257, local model 60, internal_epoch   2,  Average loss: 0.0002, Accuracy: 284/284 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 1.0442, Accuracy: 6818/10000 (68.1800%)
___Train Local_ResNet_18,  epoch 257, local model 30, internal_epoch   1,  Average loss: 0.0016, Accuracy: 333/337 (98.8131%)
___Train Local_ResNet_18,  epoch 257, local model 30, internal_epoch   2,  Average loss: 0.0007, Accuracy: 336/337 (99.7033%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 1.4101, Accuracy: 6333/10000 (63.3300%)
___Train Local_ResNet_18,  epoch 257, local model 4, internal_epoch   1,  Average loss: 0.0022, Accuracy: 539/557 (96.7684%)
___Train Local_ResNet_18,  epoch 257, local model 4, internal_epoch   2,  Average loss: 0.0020, Accuracy: 535/557 (96.0503%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 3.9450, Accuracy: 4390/10000 (43.9000%)
___Train Local_ResNet_18,  epoch 257, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 798/849 (93.9929%)
___Train Local_ResNet_18,  epoch 257, local model 36, internal_epoch   2,  Average loss: 0.0189, Accuracy: 574/849 (67.6090%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 21.7320, Accuracy: 1807/10000 (18.0700%)
___Train Local_ResNet_18,  epoch 257, local model 19, internal_epoch   1,  Average loss: 0.0112, Accuracy: 137/173 (79.1908%)
___Train Local_ResNet_18,  epoch 257, local model 19, internal_epoch   2,  Average loss: 0.0027, Accuracy: 166/173 (95.9538%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 9.1083, Accuracy: 2277/10000 (22.7700%)
___Train Local_ResNet_18,  epoch 257, local model 95, internal_epoch   1,  Average loss: 0.0046, Accuracy: 521/569 (91.5641%)
___Train Local_ResNet_18,  epoch 257, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 508/569 (89.2794%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 4.8452, Accuracy: 2915/10000 (29.1500%)
___Train Local_ResNet_18,  epoch 257, local model 47, internal_epoch   1,  Average loss: 0.0014, Accuracy: 642/654 (98.1651%)
___Train Local_ResNet_18,  epoch 257, local model 47, internal_epoch   2,  Average loss: 0.0016, Accuracy: 639/654 (97.7064%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 1.5870, Accuracy: 6151/10000 (61.5100%)
___Train Local_ResNet_18,  epoch 257, local model 88, internal_epoch   1,  Average loss: 0.0035, Accuracy: 419/447 (93.7360%)
___Train Local_ResNet_18,  epoch 257, local model 88, internal_epoch   2,  Average loss: 0.0017, Accuracy: 427/447 (95.5257%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 4.0769, Accuracy: 3763/10000 (37.6300%)
time spent on training: 95.85101056098938
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [440, 725, 284, 337, 557, 849, 173, 569, 654, 447]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 37, 60, 30, 4, 36, 19, 95, 47, 88], weight: tensor([0.0874, 0.1440, 0.0564, 0.0669, 0.1106, 0.1686, 0.0344, 0.1130, 0.1299,
        0.0888])
[rfa agg] iter:  0, prev_obj_val: 31.006622314453125, obj_val: 39.52003479003906, abs dis: 8.513412475585938
[rfa agg] iter:  0, weight: tensor([0.2550, 0.0538, 0.0524, 0.1110, 0.0979, 0.0446, 0.0163, 0.0953, 0.0616,
        0.2121])
[rfa agg] iter:  1, prev_obj_val: 39.52003479003906, obj_val: 39.493988037109375, abs dis: 0.0260467529296875
[rfa agg] iter:  1, weight: tensor([0.1257, 0.0486, 0.2026, 0.2353, 0.0693, 0.0429, 0.0301, 0.0693, 0.0526,
        0.1237])
[rfa agg] iter:  2, prev_obj_val: 39.493988037109375, obj_val: 39.493873596191406, abs dis: 0.00011444091796875
[rfa agg] iter:  2, weight: tensor([0.1214, 0.0472, 0.2109, 0.2452, 0.0672, 0.0417, 0.0293, 0.0672, 0.0511,
        0.1188])
___Test Target_ResNet_18 poisoned: False, epoch: 257: Average loss: 0.6305, Accuracy: 7888/10000 (78.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 257: Average loss: 5.5005, Accuracy: 599/9000 (6.6556%)
Done in 215.08774137496948 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:258 choose agents : [8, 66, 49, 58, 44, 26, 21, 79, 98, 32]. Adversary List: []
___Train Local_ResNet_18,  epoch 258, local model 8, internal_epoch   1,  Average loss: 0.0008, Accuracy: 532/534 (99.6255%)
___Train Local_ResNet_18,  epoch 258, local model 8, internal_epoch   2,  Average loss: 0.0004, Accuracy: 532/534 (99.6255%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 1.0667, Accuracy: 6900/10000 (69.0000%)
___Train Local_ResNet_18,  epoch 258, local model 66, internal_epoch   1,  Average loss: 0.0032, Accuracy: 524/555 (94.4144%)
___Train Local_ResNet_18,  epoch 258, local model 66, internal_epoch   2,  Average loss: 0.0019, Accuracy: 533/555 (96.0360%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 3.6961, Accuracy: 4073/10000 (40.7300%)
___Train Local_ResNet_18,  epoch 258, local model 49, internal_epoch   1,  Average loss: 0.0014, Accuracy: 419/426 (98.3568%)
___Train Local_ResNet_18,  epoch 258, local model 49, internal_epoch   2,  Average loss: 0.0005, Accuracy: 424/426 (99.5305%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 2.1074, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 258, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 217/234 (92.7350%)
___Train Local_ResNet_18,  epoch 258, local model 58, internal_epoch   2,  Average loss: 0.0004, Accuracy: 234/234 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 3.5782, Accuracy: 3260/10000 (32.6000%)
___Train Local_ResNet_18,  epoch 258, local model 44, internal_epoch   1,  Average loss: 0.0014, Accuracy: 428/436 (98.1651%)
___Train Local_ResNet_18,  epoch 258, local model 44, internal_epoch   2,  Average loss: 0.0005, Accuracy: 434/436 (99.5413%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 1.7241, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 258, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 460/468 (98.2906%)
___Train Local_ResNet_18,  epoch 258, local model 26, internal_epoch   2,  Average loss: 0.0011, Accuracy: 460/468 (98.2906%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 1.9438, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 258, local model 21, internal_epoch   1,  Average loss: 0.0025, Accuracy: 257/262 (98.0916%)
___Train Local_ResNet_18,  epoch 258, local model 21, internal_epoch   2,  Average loss: 0.0007, Accuracy: 257/262 (98.0916%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 3.1201, Accuracy: 4045/10000 (40.4500%)
___Train Local_ResNet_18,  epoch 258, local model 79, internal_epoch   1,  Average loss: 0.0036, Accuracy: 144/154 (93.5065%)
___Train Local_ResNet_18,  epoch 258, local model 79, internal_epoch   2,  Average loss: 0.0004, Accuracy: 154/154 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 1.0161, Accuracy: 7039/10000 (70.3900%)
___Train Local_ResNet_18,  epoch 258, local model 98, internal_epoch   1,  Average loss: 0.0029, Accuracy: 762/802 (95.0125%)
___Train Local_ResNet_18,  epoch 258, local model 98, internal_epoch   2,  Average loss: 0.0065, Accuracy: 697/802 (86.9077%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 3.3951, Accuracy: 4299/10000 (42.9900%)
___Train Local_ResNet_18,  epoch 258, local model 32, internal_epoch   1,  Average loss: 0.0015, Accuracy: 800/824 (97.0874%)
___Train Local_ResNet_18,  epoch 258, local model 32, internal_epoch   2,  Average loss: 0.0025, Accuracy: 782/824 (94.9029%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 7.7478, Accuracy: 2281/10000 (22.8100%)
time spent on training: 93.41431999206543
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [534, 555, 426, 234, 436, 468, 262, 154, 802, 824]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [8, 66, 49, 58, 44, 26, 21, 79, 98, 32], weight: tensor([0.1137, 0.1182, 0.0907, 0.0498, 0.0929, 0.0997, 0.0558, 0.0328, 0.1708,
        0.1755])
[rfa agg] iter:  0, prev_obj_val: 26.76980209350586, obj_val: 34.2867317199707, abs dis: 7.516929626464844
[rfa agg] iter:  0, weight: tensor([0.1147, 0.1079, 0.2019, 0.0222, 0.2105, 0.1997, 0.0344, 0.0114, 0.0477,
        0.0497])
[rfa agg] iter:  1, prev_obj_val: 34.2867317199707, obj_val: 40.79218292236328, abs dis: 6.505451202392578
[rfa agg] iter:  1, weight: tensor([0.0876, 0.0884, 0.1964, 0.0567, 0.2024, 0.1126, 0.1170, 0.0253, 0.0557,
        0.0579])
[rfa agg] iter:  2, prev_obj_val: 40.79218292236328, obj_val: 40.766502380371094, abs dis: 0.0256805419921875
[rfa agg] iter:  2, weight: tensor([0.0685, 0.0700, 0.1078, 0.1119, 0.1105, 0.0791, 0.3094, 0.0391, 0.0509,
        0.0528])
[rfa agg] iter:  3, prev_obj_val: 40.766502380371094, obj_val: 40.76445007324219, abs dis: 0.00205230712890625
[rfa agg] iter:  3, weight: tensor([0.0631, 0.0644, 0.0988, 0.1034, 0.1013, 0.0727, 0.3649, 0.0360, 0.0469,
        0.0486])
[rfa agg] iter:  4, prev_obj_val: 40.76445007324219, obj_val: 40.7641716003418, abs dis: 0.000278472900390625
[rfa agg] iter:  4, weight: tensor([0.0611, 0.0624, 0.0957, 0.0999, 0.0982, 0.0705, 0.3848, 0.0348, 0.0454,
        0.0471])
[rfa agg] iter:  5, prev_obj_val: 40.7641716003418, obj_val: 40.764129638671875, abs dis: 4.1961669921875e-05
[rfa agg] iter:  5, weight: tensor([0.0604, 0.0616, 0.0945, 0.0986, 0.0970, 0.0696, 0.3924, 0.0344, 0.0449,
        0.0465])
___Test Target_ResNet_18 poisoned: False, epoch: 258: Average loss: 0.6272, Accuracy: 7922/10000 (79.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 258: Average loss: 5.6000, Accuracy: 596/9000 (6.6222%)
Done in 220.21361255645752 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:259 choose agents : [81, 15, 55, 12, 47, 26, 82, 33, 64, 70]. Adversary List: []
___Train Local_ResNet_18,  epoch 259, local model 81, internal_epoch   1,  Average loss: 0.0056, Accuracy: 948/1034 (91.6828%)
___Train Local_ResNet_18,  epoch 259, local model 81, internal_epoch   2,  Average loss: 0.0108, Accuracy: 822/1034 (79.4971%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 11.6960, Accuracy: 2329/10000 (23.2900%)
___Train Local_ResNet_18,  epoch 259, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 313/341 (91.7889%)
___Train Local_ResNet_18,  epoch 259, local model 15, internal_epoch   2,  Average loss: 0.0038, Accuracy: 321/341 (94.1349%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 3.0214, Accuracy: 4022/10000 (40.2200%)
___Train Local_ResNet_18,  epoch 259, local model 55, internal_epoch   1,  Average loss: 0.0020, Accuracy: 290/299 (96.9900%)
___Train Local_ResNet_18,  epoch 259, local model 55, internal_epoch   2,  Average loss: 0.0003, Accuracy: 299/299 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 6.6450, Accuracy: 2649/10000 (26.4900%)
___Train Local_ResNet_18,  epoch 259, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 895/977 (91.6070%)
___Train Local_ResNet_18,  epoch 259, local model 12, internal_epoch   2,  Average loss: 0.0109, Accuracy: 787/977 (80.5527%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 10.5732, Accuracy: 2247/10000 (22.4700%)
___Train Local_ResNet_18,  epoch 259, local model 47, internal_epoch   1,  Average loss: 0.0018, Accuracy: 633/654 (96.7890%)
___Train Local_ResNet_18,  epoch 259, local model 47, internal_epoch   2,  Average loss: 0.0029, Accuracy: 632/654 (96.6361%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 1.4845, Accuracy: 6178/10000 (61.7800%)
___Train Local_ResNet_18,  epoch 259, local model 26, internal_epoch   1,  Average loss: 0.0011, Accuracy: 462/468 (98.7179%)
___Train Local_ResNet_18,  epoch 259, local model 26, internal_epoch   2,  Average loss: 0.0008, Accuracy: 462/468 (98.7179%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 2.3714, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 259, local model 82, internal_epoch   1,  Average loss: 0.0012, Accuracy: 589/601 (98.0033%)
___Train Local_ResNet_18,  epoch 259, local model 82, internal_epoch   2,  Average loss: 0.0009, Accuracy: 592/601 (98.5025%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 1.8873, Accuracy: 5520/10000 (55.2000%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 259, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 505/527 (95.8254%)
___Train Local_ResNet_18,  epoch 259, local model 33, internal_epoch   2,  Average loss: 0.0062, Accuracy: 470/527 (89.1841%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 6.0476, Accuracy: 3016/10000 (30.1600%)
___Train Local_ResNet_18,  epoch 259, local model 64, internal_epoch   1,  Average loss: 0.0017, Accuracy: 668/686 (97.3761%)
___Train Local_ResNet_18,  epoch 259, local model 64, internal_epoch   2,  Average loss: 0.0016, Accuracy: 666/686 (97.0845%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 1.7294, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 259, local model 70, internal_epoch   1,  Average loss: 0.0026, Accuracy: 577/610 (94.5902%)
___Train Local_ResNet_18,  epoch 259, local model 70, internal_epoch   2,  Average loss: 0.0014, Accuracy: 588/610 (96.3934%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 3.0628, Accuracy: 3720/10000 (37.2000%)
time spent on training: 111.16443133354187
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.08504114894303695  data num: [1034, 341, 299, 977, 654, 468, 601, 527, 686, 610]
[rfa agg] considering poison per batch poison_fraction: 0.006643839761174762
[rfa agg] init. name: [81, 15, 55, 12, 47, 26, 82, 33, 64, 70], weight: tensor([0.1669, 0.0550, 0.0482, 0.1577, 0.1055, 0.0755, 0.0970, 0.0850, 0.1107,
        0.0984])
[rfa agg] iter:  0, prev_obj_val: 33.81660461425781, obj_val: 38.7952766418457, abs dis: 4.978672027587891
[rfa agg] iter:  0, weight: tensor([0.0445, 0.0385, 0.0261, 0.0480, 0.1058, 0.1375, 0.1697, 0.1599, 0.1120,
        0.1580])
[rfa agg] iter:  1, prev_obj_val: 38.7952766418457, obj_val: 41.96520233154297, abs dis: 3.1699256896972656
[rfa agg] iter:  1, weight: tensor([0.0403, 0.0570, 0.0354, 0.0428, 0.0758, 0.3293, 0.1037, 0.1338, 0.0799,
        0.1021])
[rfa agg] iter:  2, prev_obj_val: 41.96520233154297, obj_val: 48.888633728027344, abs dis: 6.923431396484375
[rfa agg] iter:  2, weight: tensor([0.0443, 0.0844, 0.0490, 0.0468, 0.0759, 0.3051, 0.0973, 0.1207, 0.0799,
        0.0965])
[rfa agg] iter:  3, prev_obj_val: 48.888633728027344, obj_val: 52.502037048339844, abs dis: 3.6134033203125
[rfa agg] iter:  3, weight: tensor([0.0509, 0.2010, 0.1005, 0.0532, 0.0754, 0.1587, 0.0891, 0.1025, 0.0793,
        0.0893])
[rfa agg] iter:  4, prev_obj_val: 52.502037048339844, obj_val: 52.495155334472656, abs dis: 0.0068817138671875
[rfa agg] iter:  4, weight: tensor([0.0476, 0.2700, 0.1407, 0.0495, 0.0665, 0.1172, 0.0765, 0.0852, 0.0699,
        0.0768])
[rfa agg] iter:  5, prev_obj_val: 52.495155334472656, obj_val: 52.494728088378906, abs dis: 0.00042724609375
[rfa agg] iter:  5, weight: tensor([0.0464, 0.2888, 0.1375, 0.0483, 0.0648, 0.1139, 0.0745, 0.0829, 0.0681,
        0.0748])
___Test Target_ResNet_18 poisoned: False, epoch: 259: Average loss: 0.6343, Accuracy: 7905/10000 (79.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 259: Average loss: 5.6630, Accuracy: 560/9000 (6.2222%)
Done in 237.5856490135193 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:260 choose agents : [62, 25, 12, 16, 22, 72, 58, 28, 15, 29]. Adversary List: []
___Train Local_ResNet_18,  epoch 260, local model 62, internal_epoch   1,  Average loss: 0.0004, Accuracy: 358/358 (100.0000%)
___Train Local_ResNet_18,  epoch 260, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 358/358 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 0.6988, Accuracy: 7787/10000 (77.8700%)
___Train Local_ResNet_18,  epoch 260, local model 25, internal_epoch   1,  Average loss: 0.0019, Accuracy: 528/545 (96.8807%)
___Train Local_ResNet_18,  epoch 260, local model 25, internal_epoch   2,  Average loss: 0.0007, Accuracy: 537/545 (98.5321%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 2.6422, Accuracy: 4570/10000 (45.7000%)
___Train Local_ResNet_18,  epoch 260, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 906/977 (92.7329%)
___Train Local_ResNet_18,  epoch 260, local model 12, internal_epoch   2,  Average loss: 0.0115, Accuracy: 786/977 (80.4504%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 10.9229, Accuracy: 1808/10000 (18.0800%)
___Train Local_ResNet_18,  epoch 260, local model 16, internal_epoch   1,  Average loss: 0.0016, Accuracy: 755/773 (97.6714%)
___Train Local_ResNet_18,  epoch 260, local model 16, internal_epoch   2,  Average loss: 0.0147, Accuracy: 590/773 (76.3260%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 15.8392, Accuracy: 1509/10000 (15.0900%)
___Train Local_ResNet_18,  epoch 260, local model 22, internal_epoch   1,  Average loss: 0.0017, Accuracy: 486/494 (98.3806%)
___Train Local_ResNet_18,  epoch 260, local model 22, internal_epoch   2,  Average loss: 0.0005, Accuracy: 492/494 (99.5951%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 2.7636, Accuracy: 4299/10000 (42.9900%)
___Train Local_ResNet_18,  epoch 260, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 552/618 (89.3204%)
___Train Local_ResNet_18,  epoch 260, local model 72, internal_epoch   2,  Average loss: 0.0112, Accuracy: 514/618 (83.1715%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 8.9855, Accuracy: 3028/10000 (30.2800%)
___Train Local_ResNet_18,  epoch 260, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 219/234 (93.5897%)
___Train Local_ResNet_18,  epoch 260, local model 58, internal_epoch   2,  Average loss: 0.0003, Accuracy: 234/234 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 4.4806, Accuracy: 2871/10000 (28.7100%)
___Train Local_ResNet_18,  epoch 260, local model 28, internal_epoch   1,  Average loss: 0.0006, Accuracy: 422/423 (99.7636%)
___Train Local_ResNet_18,  epoch 260, local model 28, internal_epoch   2,  Average loss: 0.0002, Accuracy: 423/423 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 1.1400, Accuracy: 6946/10000 (69.4600%)
___Train Local_ResNet_18,  epoch 260, local model 15, internal_epoch   1,  Average loss: 0.0030, Accuracy: 322/341 (94.4282%)
___Train Local_ResNet_18,  epoch 260, local model 15, internal_epoch   2,  Average loss: 0.0015, Accuracy: 332/341 (97.3607%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 4.0889, Accuracy: 3852/10000 (38.5200%)
___Train Local_ResNet_18,  epoch 260, local model 29, internal_epoch   1,  Average loss: 0.0035, Accuracy: 793/848 (93.5142%)
___Train Local_ResNet_18,  epoch 260, local model 29, internal_epoch   2,  Average loss: 0.0090, Accuracy: 724/848 (85.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 15.1186, Accuracy: 1760/10000 (17.6000%)
time spent on training: 96.90828323364258
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [358, 545, 977, 773, 494, 618, 234, 423, 341, 848]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [62, 25, 12, 16, 22, 72, 58, 28, 15, 29], weight: tensor([0.0638, 0.0971, 0.1741, 0.1378, 0.0880, 0.1101, 0.0417, 0.0754, 0.0608,
        0.1511])
[rfa agg] iter:  0, prev_obj_val: 34.79891586303711, obj_val: 43.08333969116211, abs dis: 8.284423828125
[rfa agg] iter:  0, weight: tensor([0.0569, 0.2337, 0.0518, 0.0658, 0.2302, 0.1199, 0.0210, 0.1071, 0.0532,
        0.0604])
[rfa agg] iter:  1, prev_obj_val: 43.08333969116211, obj_val: 46.12681579589844, abs dis: 3.043476104736328
[rfa agg] iter:  1, weight: tensor([0.2108, 0.0760, 0.0362, 0.0412, 0.1118, 0.0588, 0.0330, 0.2399, 0.1526,
        0.0395])
[rfa agg] iter:  2, prev_obj_val: 46.12681579589844, obj_val: 57.87974166870117, abs dis: 11.752925872802734
[rfa agg] iter:  2, weight: tensor([0.4376, 0.0486, 0.0263, 0.0293, 0.0655, 0.0397, 0.0314, 0.1118, 0.1814,
        0.0284])
[rfa agg] iter:  3, prev_obj_val: 57.87974166870117, obj_val: 53.836669921875, abs dis: 4.043071746826172
[rfa agg] iter:  3, weight: tensor([0.1456, 0.0736, 0.0515, 0.0547, 0.0858, 0.0666, 0.2318, 0.1033, 0.1330,
        0.0540])
[rfa agg] iter:  4, prev_obj_val: 53.836669921875, obj_val: 46.140480041503906, abs dis: 7.696189880371094
[rfa agg] iter:  4, weight: tensor([0.1961, 0.0761, 0.0496, 0.0535, 0.0918, 0.0672, 0.1254, 0.1182, 0.1697,
        0.0524])
[rfa agg] iter:  5, prev_obj_val: 46.140480041503906, obj_val: 62.0014762878418, abs dis: 15.86099624633789
[rfa agg] iter:  5, weight: tensor([0.4067, 0.0514, 0.0279, 0.0311, 0.0692, 0.0421, 0.0333, 0.1169, 0.1913,
        0.0301])
[rfa agg] iter:  6, prev_obj_val: 62.0014762878418, obj_val: 49.89764404296875, abs dis: 12.103832244873047
[rfa agg] iter:  6, weight: tensor([0.1051, 0.0637, 0.0474, 0.0497, 0.0722, 0.0589, 0.3731, 0.0828, 0.0978,
        0.0493])
[rfa agg] iter:  7, prev_obj_val: 49.89764404296875, obj_val: 46.12250900268555, abs dis: 3.775135040283203
[rfa agg] iter:  7, weight: tensor([0.2780, 0.0670, 0.0402, 0.0440, 0.0846, 0.0572, 0.0671, 0.1207, 0.1983,
        0.0429])
[rfa agg] iter:  8, prev_obj_val: 46.12250900268555, obj_val: 57.88010025024414, abs dis: 11.757591247558594
[rfa agg] iter:  8, weight: tensor([0.4289, 0.0485, 0.0263, 0.0293, 0.0653, 0.0397, 0.0314, 0.1109, 0.1912,
        0.0284])
[rfa agg] iter:  9, prev_obj_val: 57.88010025024414, obj_val: 53.83665466308594, abs dis: 4.043445587158203
[rfa agg] iter:  9, weight: tensor([0.1456, 0.0737, 0.0515, 0.0547, 0.0858, 0.0666, 0.2315, 0.1034, 0.1331,
        0.0540])
___Test Target_ResNet_18 poisoned: False, epoch: 260: Average loss: 0.6364, Accuracy: 7902/10000 (79.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 260: Average loss: 5.6665, Accuracy: 571/9000 (6.3444%)
Done in 236.0507297515869 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:261 choose agents : [61, 83, 69, 20, 34, 8, 28, 50, 93, 92]. Adversary List: []
___Train Local_ResNet_18,  epoch 261, local model 61, internal_epoch   1,  Average loss: 0.0027, Accuracy: 562/590 (95.2542%)
___Train Local_ResNet_18,  epoch 261, local model 61, internal_epoch   2,  Average loss: 0.0049, Accuracy: 557/590 (94.4068%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 4.1801, Accuracy: 3288/10000 (32.8800%)
___Train Local_ResNet_18,  epoch 261, local model 83, internal_epoch   1,  Average loss: 0.0005, Accuracy: 365/366 (99.7268%)
___Train Local_ResNet_18,  epoch 261, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 366/366 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 0.7375, Accuracy: 7700/10000 (77.0000%)
___Train Local_ResNet_18,  epoch 261, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 204/216 (94.4444%)
___Train Local_ResNet_18,  epoch 261, local model 69, internal_epoch   2,  Average loss: 0.0007, Accuracy: 213/216 (98.6111%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 6.0221, Accuracy: 1990/10000 (19.9000%)
___Train Local_ResNet_18,  epoch 261, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 344/362 (95.0276%)
___Train Local_ResNet_18,  epoch 261, local model 20, internal_epoch   2,  Average loss: 0.0013, Accuracy: 354/362 (97.7901%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 8.5168, Accuracy: 2136/10000 (21.3600%)
___Train Local_ResNet_18,  epoch 261, local model 34, internal_epoch   1,  Average loss: 0.0024, Accuracy: 335/349 (95.9885%)
___Train Local_ResNet_18,  epoch 261, local model 34, internal_epoch   2,  Average loss: 0.0014, Accuracy: 341/349 (97.7077%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 3.1290, Accuracy: 4714/10000 (47.1400%)
___Train Local_ResNet_18,  epoch 261, local model 8, internal_epoch   1,  Average loss: 0.0010, Accuracy: 530/534 (99.2509%)
___Train Local_ResNet_18,  epoch 261, local model 8, internal_epoch   2,  Average loss: 0.0007, Accuracy: 530/534 (99.2509%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 1.4068, Accuracy: 6138/10000 (61.3800%)
___Train Local_ResNet_18,  epoch 261, local model 28, internal_epoch   1,  Average loss: 0.0006, Accuracy: 422/423 (99.7636%)
___Train Local_ResNet_18,  epoch 261, local model 28, internal_epoch   2,  Average loss: 0.0002, Accuracy: 423/423 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 0.9474, Accuracy: 7290/10000 (72.9000%)
___Train Local_ResNet_18,  epoch 261, local model 50, internal_epoch   1,  Average loss: 0.0008, Accuracy: 401/401 (100.0000%)
___Train Local_ResNet_18,  epoch 261, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 1.1060, Accuracy: 6858/10000 (68.5800%)
___Train Local_ResNet_18,  epoch 261, local model 93, internal_epoch   1,  Average loss: 0.0012, Accuracy: 581/584 (99.4863%)
___Train Local_ResNet_18,  epoch 261, local model 93, internal_epoch   2,  Average loss: 0.0068, Accuracy: 541/584 (92.6370%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 5.9347, Accuracy: 2706/10000 (27.0600%)
___Train Local_ResNet_18,  epoch 261, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 750/796 (94.2211%)
___Train Local_ResNet_18,  epoch 261, local model 92, internal_epoch   2,  Average loss: 0.0054, Accuracy: 711/796 (89.3216%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 5.0157, Accuracy: 2874/10000 (28.7400%)
time spent on training: 95.15212607383728
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [590, 366, 216, 362, 349, 534, 423, 401, 584, 796]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 83, 69, 20, 34, 8, 28, 50, 93, 92], weight: tensor([0.1277, 0.0792, 0.0467, 0.0783, 0.0755, 0.1156, 0.0915, 0.0868, 0.1264,
        0.1723])
[rfa agg] iter:  0, prev_obj_val: 26.967378616333008, obj_val: 42.224754333496094, abs dis: 15.257375717163086
[rfa agg] iter:  0, weight: tensor([0.0377, 0.2886, 0.0276, 0.1625, 0.1679, 0.0460, 0.1048, 0.0981, 0.0372,
        0.0295])
[rfa agg] iter:  1, prev_obj_val: 42.224754333496094, obj_val: 30.255102157592773, abs dis: 11.96965217590332
[rfa agg] iter:  1, weight: tensor([0.0557, 0.1046, 0.3168, 0.1014, 0.0982, 0.0610, 0.0807, 0.0764, 0.0551,
        0.0503])
[rfa agg] iter:  2, prev_obj_val: 30.255102157592773, obj_val: 42.22148895263672, abs dis: 11.966386795043945
[rfa agg] iter:  2, weight: tensor([0.0446, 0.2320, 0.0492, 0.1760, 0.1770, 0.0526, 0.0967, 0.0913, 0.0441,
        0.0364])
[rfa agg] iter:  3, prev_obj_val: 42.22148895263672, obj_val: 30.255409240722656, abs dis: 11.966079711914062
[rfa agg] iter:  3, weight: tensor([0.0556, 0.1043, 0.3181, 0.1012, 0.0980, 0.0609, 0.0805, 0.0762, 0.0550,
        0.0502])
[rfa agg] iter:  4, prev_obj_val: 30.255409240722656, obj_val: 42.22148513793945, abs dis: 11.966075897216797
[rfa agg] iter:  4, weight: tensor([0.0446, 0.2320, 0.0492, 0.1760, 0.1770, 0.0526, 0.0968, 0.0913, 0.0441,
        0.0364])
[rfa agg] iter:  5, prev_obj_val: 42.22148513793945, obj_val: 30.255409240722656, abs dis: 11.966075897216797
[rfa agg] iter:  5, weight: tensor([0.0556, 0.1043, 0.3182, 0.1012, 0.0980, 0.0609, 0.0805, 0.0762, 0.0550,
        0.0502])
[rfa agg] iter:  6, prev_obj_val: 30.255409240722656, obj_val: 42.22148513793945, abs dis: 11.966075897216797
[rfa agg] iter:  6, weight: tensor([0.0446, 0.2320, 0.0492, 0.1760, 0.1770, 0.0526, 0.0968, 0.0913, 0.0441,
        0.0364])
[rfa agg] iter:  7, prev_obj_val: 42.22148513793945, obj_val: 30.255409240722656, abs dis: 11.966075897216797
[rfa agg] iter:  7, weight: tensor([0.0556, 0.1043, 0.3182, 0.1012, 0.0980, 0.0609, 0.0805, 0.0762, 0.0550,
        0.0502])
[rfa agg] iter:  8, prev_obj_val: 30.255409240722656, obj_val: 42.22148513793945, abs dis: 11.966075897216797
[rfa agg] iter:  8, weight: tensor([0.0446, 0.2320, 0.0492, 0.1760, 0.1770, 0.0526, 0.0968, 0.0913, 0.0441,
        0.0364])
[rfa agg] iter:  9, prev_obj_val: 42.22148513793945, obj_val: 30.255409240722656, abs dis: 11.966075897216797
[rfa agg] iter:  9, weight: tensor([0.0556, 0.1043, 0.3182, 0.1012, 0.0980, 0.0609, 0.0805, 0.0762, 0.0550,
        0.0502])
___Test Target_ResNet_18 poisoned: False, epoch: 261: Average loss: 0.6345, Accuracy: 7900/10000 (79.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 261: Average loss: 5.7117, Accuracy: 546/9000 (6.0667%)
Done in 213.36057114601135 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:262 choose agents : [60, 95, 5, 2, 44, 0, 6, 41, 19, 53]. Adversary List: []
___Train Local_ResNet_18,  epoch 262, local model 60, internal_epoch   1,  Average loss: 0.0010, Accuracy: 282/284 (99.2958%)
___Train Local_ResNet_18,  epoch 262, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 284/284 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 0.8834, Accuracy: 7283/10000 (72.8300%)
___Train Local_ResNet_18,  epoch 262, local model 95, internal_epoch   1,  Average loss: 0.0051, Accuracy: 511/569 (89.8067%)
___Train Local_ResNet_18,  epoch 262, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 507/569 (89.1037%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 5.1372, Accuracy: 2887/10000 (28.8700%)
___Train Local_ResNet_18,  epoch 262, local model 5, internal_epoch   1,  Average loss: 0.0009, Accuracy: 365/365 (100.0000%)
___Train Local_ResNet_18,  epoch 262, local model 5, internal_epoch   2,  Average loss: 0.0002, Accuracy: 364/365 (99.7260%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 0.9472, Accuracy: 7241/10000 (72.4100%)
___Train Local_ResNet_18,  epoch 262, local model 2, internal_epoch   1,  Average loss: 0.0026, Accuracy: 448/461 (97.1800%)
___Train Local_ResNet_18,  epoch 262, local model 2, internal_epoch   2,  Average loss: 0.0055, Accuracy: 425/461 (92.1909%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 5.1006, Accuracy: 2811/10000 (28.1100%)
___Train Local_ResNet_18,  epoch 262, local model 44, internal_epoch   1,  Average loss: 0.0011, Accuracy: 432/436 (99.0826%)
___Train Local_ResNet_18,  epoch 262, local model 44, internal_epoch   2,  Average loss: 0.0005, Accuracy: 433/436 (99.3119%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 1.3177, Accuracy: 6448/10000 (64.4800%)
___Train Local_ResNet_18,  epoch 262, local model 0, internal_epoch   1,  Average loss: 0.0010, Accuracy: 367/367 (100.0000%)
___Train Local_ResNet_18,  epoch 262, local model 0, internal_epoch   2,  Average loss: 0.0003, Accuracy: 366/367 (99.7275%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 1.6140, Accuracy: 5976/10000 (59.7600%)
___Train Local_ResNet_18,  epoch 262, local model 6, internal_epoch   1,  Average loss: 0.0017, Accuracy: 503/520 (96.7308%)
___Train Local_ResNet_18,  epoch 262, local model 6, internal_epoch   2,  Average loss: 0.0018, Accuracy: 504/520 (96.9231%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 2.4163, Accuracy: 4750/10000 (47.5000%)
___Train Local_ResNet_18,  epoch 262, local model 41, internal_epoch   1,  Average loss: 0.0040, Accuracy: 467/513 (91.0331%)
___Train Local_ResNet_18,  epoch 262, local model 41, internal_epoch   2,  Average loss: 0.0025, Accuracy: 486/513 (94.7368%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 3.7768, Accuracy: 3928/10000 (39.2800%)
___Train Local_ResNet_18,  epoch 262, local model 19, internal_epoch   1,  Average loss: 0.0086, Accuracy: 145/173 (83.8150%)
___Train Local_ResNet_18,  epoch 262, local model 19, internal_epoch   2,  Average loss: 0.0033, Accuracy: 164/173 (94.7977%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 5.6697, Accuracy: 3213/10000 (32.1300%)
___Train Local_ResNet_18,  epoch 262, local model 53, internal_epoch   1,  Average loss: 0.0016, Accuracy: 609/625 (97.4400%)
___Train Local_ResNet_18,  epoch 262, local model 53, internal_epoch   2,  Average loss: 0.0011, Accuracy: 610/625 (97.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 2.5952, Accuracy: 4651/10000 (46.5100%)
time spent on training: 93.00316715240479
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [284, 569, 365, 461, 436, 367, 520, 513, 173, 625]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [60, 95, 5, 2, 44, 0, 6, 41, 19, 53], weight: tensor([0.0658, 0.1319, 0.0846, 0.1069, 0.1011, 0.0851, 0.1206, 0.1189, 0.0401,
        0.1449])
[rfa agg] iter:  0, prev_obj_val: 20.882591247558594, obj_val: 39.49456024169922, abs dis: 18.611968994140625
[rfa agg] iter:  0, weight: tensor([0.0712, 0.0468, 0.2824, 0.0564, 0.1061, 0.2935, 0.0446, 0.0433, 0.0150,
        0.0406])
[rfa agg] iter:  1, prev_obj_val: 39.49456024169922, obj_val: 27.424610137939453, abs dis: 12.069950103759766
[rfa agg] iter:  1, weight: tensor([0.1384, 0.0748, 0.1076, 0.0746, 0.0917, 0.1082, 0.0695, 0.0681, 0.1963,
        0.0707])
[rfa agg] iter:  2, prev_obj_val: 27.424610137939453, obj_val: 39.492652893066406, abs dis: 12.068042755126953
[rfa agg] iter:  2, weight: tensor([0.4098, 0.0483, 0.1244, 0.0526, 0.0759, 0.1253, 0.0454, 0.0444, 0.0301,
        0.0438])
[rfa agg] iter:  3, prev_obj_val: 39.492652893066406, obj_val: 27.424571990966797, abs dis: 12.06808090209961
[rfa agg] iter:  3, weight: tensor([0.1391, 0.0747, 0.1073, 0.0745, 0.0916, 0.1079, 0.0694, 0.0680, 0.1967,
        0.0707])
[rfa agg] iter:  4, prev_obj_val: 27.424571990966797, obj_val: 39.4926643371582, abs dis: 12.068092346191406
[rfa agg] iter:  4, weight: tensor([0.4100, 0.0483, 0.1244, 0.0525, 0.0758, 0.1252, 0.0454, 0.0443, 0.0301,
        0.0438])
[rfa agg] iter:  5, prev_obj_val: 39.4926643371582, obj_val: 27.424571990966797, abs dis: 12.068092346191406
[rfa agg] iter:  5, weight: tensor([0.1391, 0.0747, 0.1073, 0.0745, 0.0916, 0.1079, 0.0694, 0.0680, 0.1967,
        0.0707])
[rfa agg] iter:  6, prev_obj_val: 27.424571990966797, obj_val: 39.4926643371582, abs dis: 12.068092346191406
[rfa agg] iter:  6, weight: tensor([0.4100, 0.0483, 0.1244, 0.0525, 0.0758, 0.1252, 0.0454, 0.0443, 0.0301,
        0.0438])
[rfa agg] iter:  7, prev_obj_val: 39.4926643371582, obj_val: 27.424571990966797, abs dis: 12.068092346191406
[rfa agg] iter:  7, weight: tensor([0.1391, 0.0747, 0.1073, 0.0745, 0.0916, 0.1079, 0.0694, 0.0680, 0.1967,
        0.0707])
[rfa agg] iter:  8, prev_obj_val: 27.424571990966797, obj_val: 39.4926643371582, abs dis: 12.068092346191406
[rfa agg] iter:  8, weight: tensor([0.4100, 0.0483, 0.1244, 0.0525, 0.0758, 0.1252, 0.0454, 0.0443, 0.0301,
        0.0438])
[rfa agg] iter:  9, prev_obj_val: 39.4926643371582, obj_val: 27.424571990966797, abs dis: 12.068092346191406
[rfa agg] iter:  9, weight: tensor([0.1391, 0.0747, 0.1073, 0.0745, 0.0916, 0.1079, 0.0694, 0.0680, 0.1967,
        0.0707])
___Test Target_ResNet_18 poisoned: False, epoch: 262: Average loss: 0.6311, Accuracy: 7915/10000 (79.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 262: Average loss: 5.6579, Accuracy: 595/9000 (6.6111%)
Done in 213.26161694526672 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:263 choose agents : [33, 50, 21, 14, 79, 18, 71, 99, 97, 72]. Adversary List: []
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 263, local model 33, internal_epoch   1,  Average loss: 0.0021, Accuracy: 519/527 (98.4820%)
___Train Local_ResNet_18,  epoch 263, local model 33, internal_epoch   2,  Average loss: 0.0078, Accuracy: 462/527 (87.6660%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 3.1125, Accuracy: 3639/10000 (36.3900%)
___Train Local_ResNet_18,  epoch 263, local model 50, internal_epoch   1,  Average loss: 0.0009, Accuracy: 398/401 (99.2519%)
___Train Local_ResNet_18,  epoch 263, local model 50, internal_epoch   2,  Average loss: 0.0003, Accuracy: 400/401 (99.7506%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 1.2416, Accuracy: 6666/10000 (66.6600%)
___Train Local_ResNet_18,  epoch 263, local model 21, internal_epoch   1,  Average loss: 0.0011, Accuracy: 262/262 (100.0000%)
___Train Local_ResNet_18,  epoch 263, local model 21, internal_epoch   2,  Average loss: 0.0012, Accuracy: 259/262 (98.8550%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 3.4128, Accuracy: 4007/10000 (40.0700%)
___Train Local_ResNet_18,  epoch 263, local model 14, internal_epoch   1,  Average loss: 0.0016, Accuracy: 315/318 (99.0566%)
___Train Local_ResNet_18,  epoch 263, local model 14, internal_epoch   2,  Average loss: 0.0004, Accuracy: 317/318 (99.6855%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 2.8094, Accuracy: 4831/10000 (48.3100%)
___Train Local_ResNet_18,  epoch 263, local model 79, internal_epoch   1,  Average loss: 0.0033, Accuracy: 143/154 (92.8571%)
___Train Local_ResNet_18,  epoch 263, local model 79, internal_epoch   2,  Average loss: 0.0004, Accuracy: 154/154 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 0.9817, Accuracy: 7144/10000 (71.4400%)
___Train Local_ResNet_18,  epoch 263, local model 18, internal_epoch   1,  Average loss: 0.0028, Accuracy: 384/386 (99.4819%)
___Train Local_ResNet_18,  epoch 263, local model 18, internal_epoch   2,  Average loss: 0.0104, Accuracy: 327/386 (84.7150%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 11.5397, Accuracy: 1871/10000 (18.7100%)
___Train Local_ResNet_18,  epoch 263, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 1098/1166 (94.1681%)
___Train Local_ResNet_18,  epoch 263, local model 71, internal_epoch   2,  Average loss: 0.0097, Accuracy: 955/1166 (81.9039%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 47.6364, Accuracy: 1365/10000 (13.6500%)
___Train Local_ResNet_18,  epoch 263, local model 99, internal_epoch   1,  Average loss: 0.0029, Accuracy: 369/391 (94.3734%)
___Train Local_ResNet_18,  epoch 263, local model 99, internal_epoch   2,  Average loss: 0.0011, Accuracy: 385/391 (98.4655%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 3.5668, Accuracy: 4058/10000 (40.5800%)
___Train Local_ResNet_18,  epoch 263, local model 97, internal_epoch   1,  Average loss: 0.0013, Accuracy: 408/418 (97.6077%)
___Train Local_ResNet_18,  epoch 263, local model 97, internal_epoch   2,  Average loss: 0.0006, Accuracy: 415/418 (99.2823%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 2.0373, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 263, local model 72, internal_epoch   1,  Average loss: 0.0071, Accuracy: 530/618 (85.7605%)
___Train Local_ResNet_18,  epoch 263, local model 72, internal_epoch   2,  Average loss: 0.0101, Accuracy: 511/618 (82.6861%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 25.3780, Accuracy: 1172/10000 (11.7200%)
time spent on training: 107.04523730278015
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.11355311355311355  data num: [527, 401, 262, 318, 154, 386, 1166, 391, 418, 618]
[rfa agg] considering poison per batch poison_fraction: 0.008871336996336996
[rfa agg] init. name: [33, 50, 21, 14, 79, 18, 71, 99, 97, 72], weight: tensor([0.1136, 0.0864, 0.0565, 0.0685, 0.0332, 0.0832, 0.2512, 0.0842, 0.0901,
        0.1332])
[rfa agg] iter:  0, prev_obj_val: 38.64680099487305, obj_val: 46.68022155761719, abs dis: 8.03342056274414
[rfa agg] iter:  0, weight: tensor([0.2193, 0.1263, 0.0380, 0.0461, 0.0144, 0.1011, 0.0568, 0.1183, 0.1300,
        0.1497])
[rfa agg] iter:  1, prev_obj_val: 46.68022155761719, obj_val: 49.705467224121094, abs dis: 3.0252456665039062
[rfa agg] iter:  1, weight: tensor([0.0666, 0.1161, 0.1684, 0.2017, 0.0276, 0.0923, 0.0391, 0.1087, 0.1196,
        0.0598])
[rfa agg] iter:  2, prev_obj_val: 49.705467224121094, obj_val: 65.8280029296875, abs dis: 16.122535705566406
[rfa agg] iter:  2, weight: tensor([0.0444, 0.0688, 0.2714, 0.3242, 0.0265, 0.0584, 0.0288, 0.0653, 0.0712,
        0.0411])
[rfa agg] iter:  3, prev_obj_val: 65.8280029296875, obj_val: 61.637855529785156, abs dis: 4.190147399902344
[rfa agg] iter:  3, weight: tensor([0.0613, 0.0708, 0.0920, 0.1117, 0.3439, 0.0656, 0.0513, 0.0685, 0.0737,
        0.0611])
[rfa agg] iter:  4, prev_obj_val: 61.637855529785156, obj_val: 46.558074951171875, abs dis: 15.079780578613281
[rfa agg] iter:  4, weight: tensor([0.0693, 0.0839, 0.1252, 0.1519, 0.2012, 0.0770, 0.0550, 0.0811, 0.0873,
        0.0681])
[rfa agg] iter:  5, prev_obj_val: 46.558074951171875, obj_val: 49.698333740234375, abs dis: 3.1402587890625
[rfa agg] iter:  5, weight: tensor([0.0618, 0.1111, 0.1831, 0.2213, 0.0262, 0.0870, 0.0366, 0.1033, 0.1141,
        0.0556])
[rfa agg] iter:  6, prev_obj_val: 49.698333740234375, obj_val: 65.82893371582031, abs dis: 16.130599975585938
[rfa agg] iter:  6, weight: tensor([0.0435, 0.0674, 0.2743, 0.3296, 0.0259, 0.0571, 0.0282, 0.0640, 0.0697,
        0.0403])
[rfa agg] iter:  7, prev_obj_val: 65.82893371582031, obj_val: 61.63786697387695, abs dis: 4.191066741943359
[rfa agg] iter:  7, weight: tensor([0.0613, 0.0708, 0.0920, 0.1117, 0.3441, 0.0656, 0.0513, 0.0685, 0.0736,
        0.0610])
[rfa agg] iter:  8, prev_obj_val: 61.63786697387695, obj_val: 46.55807113647461, abs dis: 15.079795837402344
[rfa agg] iter:  8, weight: tensor([0.0693, 0.0839, 0.1252, 0.1519, 0.2012, 0.0770, 0.0550, 0.0811, 0.0873,
        0.0681])
[rfa agg] iter:  9, prev_obj_val: 46.55807113647461, obj_val: 49.698333740234375, abs dis: 3.1402626037597656
[rfa agg] iter:  9, weight: tensor([0.0618, 0.1111, 0.1831, 0.2213, 0.0262, 0.0870, 0.0366, 0.1033, 0.1141,
        0.0556])
___Test Target_ResNet_18 poisoned: False, epoch: 263: Average loss: 0.6316, Accuracy: 7923/10000 (79.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 263: Average loss: 5.7999, Accuracy: 530/9000 (5.8889%)
Done in 248.4712097644806 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:264 choose agents : [42, 71, 89, 16, 50, 15, 3, 85, 25, 38]. Adversary List: []
___Train Local_ResNet_18,  epoch 264, local model 42, internal_epoch   1,  Average loss: 0.0020, Accuracy: 196/198 (98.9899%)
___Train Local_ResNet_18,  epoch 264, local model 42, internal_epoch   2,  Average loss: 0.0012, Accuracy: 195/198 (98.4848%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 2.0275, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 264, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 1135/1166 (97.3413%)
___Train Local_ResNet_18,  epoch 264, local model 71, internal_epoch   2,  Average loss: 0.0064, Accuracy: 1011/1166 (86.7067%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 8.9937, Accuracy: 2299/10000 (22.9900%)
___Train Local_ResNet_18,  epoch 264, local model 89, internal_epoch   1,  Average loss: 0.0028, Accuracy: 392/413 (94.9153%)
___Train Local_ResNet_18,  epoch 264, local model 89, internal_epoch   2,  Average loss: 0.0026, Accuracy: 397/413 (96.1259%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 2.8994, Accuracy: 4102/10000 (41.0200%)
___Train Local_ResNet_18,  epoch 264, local model 16, internal_epoch   1,  Average loss: 0.0016, Accuracy: 760/773 (98.3182%)
___Train Local_ResNet_18,  epoch 264, local model 16, internal_epoch   2,  Average loss: 0.0069, Accuracy: 690/773 (89.2626%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 5.6936, Accuracy: 3488/10000 (34.8800%)
___Train Local_ResNet_18,  epoch 264, local model 50, internal_epoch   1,  Average loss: 0.0008, Accuracy: 400/401 (99.7506%)
___Train Local_ResNet_18,  epoch 264, local model 50, internal_epoch   2,  Average loss: 0.0002, Accuracy: 400/401 (99.7506%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 0.9377, Accuracy: 7215/10000 (72.1500%)
___Train Local_ResNet_18,  epoch 264, local model 15, internal_epoch   1,  Average loss: 0.0025, Accuracy: 329/341 (96.4809%)
___Train Local_ResNet_18,  epoch 264, local model 15, internal_epoch   2,  Average loss: 0.0021, Accuracy: 332/341 (97.3607%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 4.5832, Accuracy: 3286/10000 (32.8600%)
___Train Local_ResNet_18,  epoch 264, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 723/780 (92.6923%)
___Train Local_ResNet_18,  epoch 264, local model 3, internal_epoch   2,  Average loss: 0.0157, Accuracy: 590/780 (75.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 11.6363, Accuracy: 2506/10000 (25.0600%)
___Train Local_ResNet_18,  epoch 264, local model 85, internal_epoch   1,  Average loss: 0.0016, Accuracy: 361/364 (99.1758%)
___Train Local_ResNet_18,  epoch 264, local model 85, internal_epoch   2,  Average loss: 0.0008, Accuracy: 361/364 (99.1758%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 1.4440, Accuracy: 6184/10000 (61.8400%)
___Train Local_ResNet_18,  epoch 264, local model 25, internal_epoch   1,  Average loss: 0.0018, Accuracy: 526/545 (96.5138%)
___Train Local_ResNet_18,  epoch 264, local model 25, internal_epoch   2,  Average loss: 0.0013, Accuracy: 530/545 (97.2477%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 2.7993, Accuracy: 4323/10000 (43.2300%)
___Train Local_ResNet_18,  epoch 264, local model 38, internal_epoch   1,  Average loss: 0.0014, Accuracy: 734/756 (97.0899%)
___Train Local_ResNet_18,  epoch 264, local model 38, internal_epoch   2,  Average loss: 0.0030, Accuracy: 708/756 (93.6508%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 2.7026, Accuracy: 4588/10000 (45.8800%)
time spent on training: 102.10434246063232
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [198, 1166, 413, 773, 401, 341, 780, 364, 545, 756]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 71, 89, 16, 50, 15, 3, 85, 25, 38], weight: tensor([0.0345, 0.2032, 0.0720, 0.1347, 0.0699, 0.0594, 0.1360, 0.0634, 0.0950,
        0.1318])
[rfa agg] iter:  0, prev_obj_val: 40.80143356323242, obj_val: 45.603492736816406, abs dis: 4.802059173583984
[rfa agg] iter:  0, weight: tensor([0.0192, 0.0564, 0.0934, 0.0897, 0.0942, 0.0540, 0.0867, 0.0580, 0.3311,
        0.1172])
[rfa agg] iter:  1, prev_obj_val: 45.603492736816406, obj_val: 50.35992431640625, abs dis: 4.756431579589844
[rfa agg] iter:  1, weight: tensor([0.0227, 0.0408, 0.1932, 0.0555, 0.2486, 0.0855, 0.0545, 0.0933, 0.1390,
        0.0669])
[rfa agg] iter:  2, prev_obj_val: 50.35992431640625, obj_val: 50.34196853637695, abs dis: 0.017955780029296875
[rfa agg] iter:  2, weight: tensor([0.0261, 0.0310, 0.1784, 0.0390, 0.2293, 0.1560, 0.0385, 0.1853, 0.0709,
        0.0455])
[rfa agg] iter:  3, prev_obj_val: 50.34196853637695, obj_val: 57.32390594482422, abs dis: 6.981937408447266
[rfa agg] iter:  3, weight: tensor([0.0255, 0.0303, 0.1742, 0.0381, 0.2294, 0.1607, 0.0376, 0.1906, 0.0690,
        0.0444])
[rfa agg] iter:  4, prev_obj_val: 57.32390594482422, obj_val: 53.533512115478516, abs dis: 3.790393829345703
[rfa agg] iter:  4, weight: tensor([0.0554, 0.0377, 0.1124, 0.0446, 0.1155, 0.2163, 0.0442, 0.2562, 0.0672,
        0.0506])
[rfa agg] iter:  5, prev_obj_val: 53.533512115478516, obj_val: 69.65069580078125, abs dis: 16.117183685302734
[rfa agg] iter:  5, weight: tensor([0.0301, 0.0277, 0.1081, 0.0338, 0.1196, 0.2330, 0.0334, 0.3201, 0.0553,
        0.0388])
[rfa agg] iter:  6, prev_obj_val: 69.65069580078125, obj_val: 57.346553802490234, abs dis: 12.304141998291016
[rfa agg] iter:  6, weight: tensor([0.2848, 0.0520, 0.0906, 0.0572, 0.0895, 0.1121, 0.0570, 0.1210, 0.0727,
        0.0632])
[rfa agg] iter:  7, prev_obj_val: 57.346553802490234, obj_val: 53.53461456298828, abs dis: 3.811939239501953
[rfa agg] iter:  7, weight: tensor([0.0576, 0.0385, 0.1131, 0.0456, 0.1173, 0.2113, 0.0453, 0.2506, 0.0688,
        0.0518])
[rfa agg] iter:  8, prev_obj_val: 53.53461456298828, obj_val: 69.6504898071289, abs dis: 16.115875244140625
[rfa agg] iter:  8, weight: tensor([0.0302, 0.0278, 0.1085, 0.0339, 0.1200, 0.2324, 0.0336, 0.3191, 0.0555,
        0.0390])
[rfa agg] iter:  9, prev_obj_val: 69.6504898071289, obj_val: 57.3465576171875, abs dis: 12.303932189941406
[rfa agg] iter:  9, weight: tensor([0.2849, 0.0520, 0.0906, 0.0571, 0.0895, 0.1121, 0.0570, 0.1209, 0.0727,
        0.0632])
___Test Target_ResNet_18 poisoned: False, epoch: 264: Average loss: 0.6327, Accuracy: 7925/10000 (79.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 264: Average loss: 5.7735, Accuracy: 572/9000 (6.3556%)
Done in 229.8541967868805 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:265 choose agents : [60, 76, 30, 77, 54, 52, 84, 88, 82, 96]. Adversary List: []
___Train Local_ResNet_18,  epoch 265, local model 60, internal_epoch   1,  Average loss: 0.0008, Accuracy: 283/284 (99.6479%)
___Train Local_ResNet_18,  epoch 265, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 284/284 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 0.8215, Accuracy: 7503/10000 (75.0300%)
___Train Local_ResNet_18,  epoch 265, local model 76, internal_epoch   1,  Average loss: 0.0258, Accuracy: 64/65 (98.4615%)
___Train Local_ResNet_18,  epoch 265, local model 76, internal_epoch   2,  Average loss: 0.0032, Accuracy: 65/65 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 1.2403, Accuracy: 6631/10000 (66.3100%)
___Train Local_ResNet_18,  epoch 265, local model 30, internal_epoch   1,  Average loss: 0.0017, Accuracy: 335/337 (99.4065%)
___Train Local_ResNet_18,  epoch 265, local model 30, internal_epoch   2,  Average loss: 0.0014, Accuracy: 330/337 (97.9228%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 1.6998, Accuracy: 5518/10000 (55.1800%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 265, local model 77, internal_epoch   1,  Average loss: 0.0007, Accuracy: 494/496 (99.5968%)
___Train Local_ResNet_18,  epoch 265, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 496/496 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 0.9396, Accuracy: 7331/10000 (73.3100%)
___Train Local_ResNet_18,  epoch 265, local model 54, internal_epoch   1,  Average loss: 0.0019, Accuracy: 429/440 (97.5000%)
___Train Local_ResNet_18,  epoch 265, local model 54, internal_epoch   2,  Average loss: 0.0007, Accuracy: 433/440 (98.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 2.8180, Accuracy: 4730/10000 (47.3000%)
___Train Local_ResNet_18,  epoch 265, local model 52, internal_epoch   1,  Average loss: 0.0032, Accuracy: 207/214 (96.7290%)
___Train Local_ResNet_18,  epoch 265, local model 52, internal_epoch   2,  Average loss: 0.0011, Accuracy: 212/214 (99.0654%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 2.5578, Accuracy: 4871/10000 (48.7100%)
___Train Local_ResNet_18,  epoch 265, local model 84, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1017/1053 (96.5812%)
___Train Local_ResNet_18,  epoch 265, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 970/1053 (92.1178%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 2.7522, Accuracy: 4436/10000 (44.3600%)
___Train Local_ResNet_18,  epoch 265, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 421/447 (94.1834%)
___Train Local_ResNet_18,  epoch 265, local model 88, internal_epoch   2,  Average loss: 0.0021, Accuracy: 430/447 (96.1969%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 5.6107, Accuracy: 3104/10000 (31.0400%)
___Train Local_ResNet_18,  epoch 265, local model 82, internal_epoch   1,  Average loss: 0.0011, Accuracy: 591/601 (98.3361%)
___Train Local_ResNet_18,  epoch 265, local model 82, internal_epoch   2,  Average loss: 0.0011, Accuracy: 590/601 (98.1697%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 1.8182, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 265, local model 96, internal_epoch   1,  Average loss: 0.0012, Accuracy: 696/708 (98.3051%)
___Train Local_ResNet_18,  epoch 265, local model 96, internal_epoch   2,  Average loss: 0.0036, Accuracy: 659/708 (93.0791%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 2.3184, Accuracy: 5044/10000 (50.4400%)
time spent on training: 100.35599517822266
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10678148546824542  data num: [284, 65, 337, 496, 440, 214, 1053, 447, 601, 708]
[rfa agg] considering poison per batch poison_fraction: 0.008342303552206673
[rfa agg] init. name: [60, 76, 30, 77, 54, 52, 84, 88, 82, 96], weight: tensor([0.0611, 0.0140, 0.0726, 0.1068, 0.0947, 0.0461, 0.2267, 0.0962, 0.1294,
        0.1524])
[rfa agg] iter:  0, prev_obj_val: 35.16930389404297, obj_val: 44.58260726928711, abs dis: 9.41330337524414
[rfa agg] iter:  0, weight: tensor([0.0409, 0.0043, 0.0771, 0.2793, 0.2113, 0.0220, 0.0401, 0.1838, 0.0849,
        0.0563])
[rfa agg] iter:  1, prev_obj_val: 44.58260726928711, obj_val: 47.952903747558594, abs dis: 3.3702964782714844
[rfa agg] iter:  1, weight: tensor([0.2241, 0.0082, 0.2239, 0.0875, 0.1251, 0.0612, 0.0404, 0.1229, 0.0588,
        0.0479])
[rfa agg] iter:  2, prev_obj_val: 47.952903747558594, obj_val: 55.75078582763672, abs dis: 7.797882080078125
[rfa agg] iter:  2, weight: tensor([0.4833, 0.0078, 0.1139, 0.0591, 0.0770, 0.0720, 0.0314, 0.0766, 0.0429,
        0.0361])
[rfa agg] iter:  3, prev_obj_val: 55.75078582763672, obj_val: 47.96889114379883, abs dis: 7.781894683837891
[rfa agg] iter:  3, weight: tensor([0.1595, 0.0183, 0.0936, 0.0701, 0.0821, 0.3419, 0.0457, 0.0824, 0.0565,
        0.0498])
[rfa agg] iter:  4, prev_obj_val: 47.96889114379883, obj_val: 55.75019073486328, abs dis: 7.781299591064453
[rfa agg] iter:  4, weight: tensor([0.4783, 0.0078, 0.1125, 0.0598, 0.0777, 0.0752, 0.0317, 0.0770, 0.0434,
        0.0365])
[rfa agg] iter:  5, prev_obj_val: 55.75019073486328, obj_val: 47.969024658203125, abs dis: 7.781166076660156
[rfa agg] iter:  5, weight: tensor([0.1593, 0.0183, 0.0935, 0.0700, 0.0820, 0.3427, 0.0457, 0.0824, 0.0564,
        0.0498])
[rfa agg] iter:  6, prev_obj_val: 47.969024658203125, obj_val: 55.750179290771484, abs dis: 7.781154632568359
[rfa agg] iter:  6, weight: tensor([0.4782, 0.0078, 0.1125, 0.0598, 0.0777, 0.0753, 0.0317, 0.0770, 0.0434,
        0.0365])
[rfa agg] iter:  7, prev_obj_val: 55.750179290771484, obj_val: 47.96902847290039, abs dis: 7.781150817871094
[rfa agg] iter:  7, weight: tensor([0.1593, 0.0183, 0.0935, 0.0700, 0.0820, 0.3427, 0.0457, 0.0824, 0.0564,
        0.0498])
[rfa agg] iter:  8, prev_obj_val: 47.96902847290039, obj_val: 55.750179290771484, abs dis: 7.781150817871094
[rfa agg] iter:  8, weight: tensor([0.4782, 0.0078, 0.1125, 0.0598, 0.0777, 0.0753, 0.0317, 0.0770, 0.0434,
        0.0365])
[rfa agg] iter:  9, prev_obj_val: 55.750179290771484, obj_val: 47.96902847290039, abs dis: 7.781150817871094
[rfa agg] iter:  9, weight: tensor([0.1593, 0.0183, 0.0935, 0.0700, 0.0820, 0.3427, 0.0457, 0.0824, 0.0564,
        0.0498])
___Test Target_ResNet_18 poisoned: False, epoch: 265: Average loss: 0.6326, Accuracy: 7921/10000 (79.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 265: Average loss: 5.8353, Accuracy: 527/9000 (5.8556%)
Done in 255.41149592399597 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:266 choose agents : [84, 78, 54, 95, 6, 36, 46, 81, 13, 55]. Adversary List: []
___Train Local_ResNet_18,  epoch 266, local model 84, internal_epoch   1,  Average loss: 0.0018, Accuracy: 1025/1053 (97.3409%)
___Train Local_ResNet_18,  epoch 266, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 948/1053 (90.0285%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 5.3035, Accuracy: 3415/10000 (34.1500%)
___Train Local_ResNet_18,  epoch 266, local model 78, internal_epoch   1,  Average loss: 0.0023, Accuracy: 246/255 (96.4706%)
___Train Local_ResNet_18,  epoch 266, local model 78, internal_epoch   2,  Average loss: 0.0009, Accuracy: 252/255 (98.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 2.4786, Accuracy: 5054/10000 (50.5400%)
___Train Local_ResNet_18,  epoch 266, local model 54, internal_epoch   1,  Average loss: 0.0014, Accuracy: 433/440 (98.4091%)
___Train Local_ResNet_18,  epoch 266, local model 54, internal_epoch   2,  Average loss: 0.0007, Accuracy: 435/440 (98.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 1.9506, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 266, local model 95, internal_epoch   1,  Average loss: 0.0042, Accuracy: 523/569 (91.9156%)
___Train Local_ResNet_18,  epoch 266, local model 95, internal_epoch   2,  Average loss: 0.0053, Accuracy: 511/569 (89.8067%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 6.7667, Accuracy: 2752/10000 (27.5200%)
___Train Local_ResNet_18,  epoch 266, local model 6, internal_epoch   1,  Average loss: 0.0021, Accuracy: 501/520 (96.3462%)
___Train Local_ResNet_18,  epoch 266, local model 6, internal_epoch   2,  Average loss: 0.0080, Accuracy: 470/520 (90.3846%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 8.5210, Accuracy: 2121/10000 (21.2100%)
___Train Local_ResNet_18,  epoch 266, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 815/849 (95.9953%)
___Train Local_ResNet_18,  epoch 266, local model 36, internal_epoch   2,  Average loss: 0.0092, Accuracy: 708/849 (83.3922%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 8.4130, Accuracy: 1977/10000 (19.7700%)
___Train Local_ResNet_18,  epoch 266, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 598/601 (99.5008%)
___Train Local_ResNet_18,  epoch 266, local model 46, internal_epoch   2,  Average loss: 0.0004, Accuracy: 598/601 (99.5008%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 1.3292, Accuracy: 6395/10000 (63.9500%)
___Train Local_ResNet_18,  epoch 266, local model 81, internal_epoch   1,  Average loss: 0.0053, Accuracy: 940/1034 (90.9091%)
___Train Local_ResNet_18,  epoch 266, local model 81, internal_epoch   2,  Average loss: 0.0127, Accuracy: 796/1034 (76.9826%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 20.3662, Accuracy: 1593/10000 (15.9300%)
___Train Local_ResNet_18,  epoch 266, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 591/620 (95.3226%)
___Train Local_ResNet_18,  epoch 266, local model 13, internal_epoch   2,  Average loss: 0.0035, Accuracy: 582/620 (93.8710%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 3.8195, Accuracy: 3886/10000 (38.8600%)
___Train Local_ResNet_18,  epoch 266, local model 55, internal_epoch   1,  Average loss: 0.0017, Accuracy: 295/299 (98.6622%)
___Train Local_ResNet_18,  epoch 266, local model 55, internal_epoch   2,  Average loss: 0.0004, Accuracy: 298/299 (99.6656%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 5.1169, Accuracy: 3222/10000 (32.2200%)
time spent on training: 101.04095649719238
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [1053, 255, 440, 569, 520, 849, 601, 1034, 620, 299]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 78, 54, 95, 6, 36, 46, 81, 13, 55], weight: tensor([0.1688, 0.0409, 0.0705, 0.0912, 0.0833, 0.1361, 0.0963, 0.1657, 0.0994,
        0.0479])
[rfa agg] iter:  0, prev_obj_val: 42.097259521484375, obj_val: 47.32334518432617, abs dis: 5.226085662841797
[rfa agg] iter:  0, weight: tensor([0.0518, 0.0237, 0.1125, 0.1895, 0.1753, 0.0632, 0.1548, 0.0498, 0.1439,
        0.0355])
[rfa agg] iter:  1, prev_obj_val: 47.32334518432617, obj_val: 50.35130310058594, abs dis: 3.0279579162597656
[rfa agg] iter:  1, weight: tensor([0.0497, 0.0327, 0.2706, 0.1442, 0.1320, 0.0577, 0.1068, 0.0477, 0.1055,
        0.0531])
[rfa agg] iter:  2, prev_obj_val: 50.35130310058594, obj_val: 57.291656494140625, abs dis: 6.9403533935546875
[rfa agg] iter:  2, weight: tensor([0.0429, 0.0345, 0.4111, 0.1041, 0.0954, 0.0487, 0.0812, 0.0412, 0.0811,
        0.0598])
[rfa agg] iter:  3, prev_obj_val: 57.291656494140625, obj_val: 60.89329147338867, abs dis: 3.601634979248047
[rfa agg] iter:  3, weight: tensor([0.0544, 0.0714, 0.2378, 0.1023, 0.0938, 0.0597, 0.0854, 0.0525, 0.0864,
        0.1562])
[rfa agg] iter:  4, prev_obj_val: 60.89329147338867, obj_val: 60.888938903808594, abs dis: 0.004352569580078125
[rfa agg] iter:  4, weight: tensor([0.0519, 0.0936, 0.1610, 0.0888, 0.0813, 0.0562, 0.0759, 0.0502, 0.0770,
        0.2640])
___Test Target_ResNet_18 poisoned: False, epoch: 266: Average loss: 0.6273, Accuracy: 7945/10000 (79.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 266: Average loss: 5.8971, Accuracy: 518/9000 (5.7556%)
Done in 254.06532168388367 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:267 choose agents : [67, 80, 33, 13, 16, 30, 47, 50, 87, 61]. Adversary List: []
___Train Local_ResNet_18,  epoch 267, local model 67, internal_epoch   1,  Average loss: 0.0019, Accuracy: 809/842 (96.0808%)
___Train Local_ResNet_18,  epoch 267, local model 67, internal_epoch   2,  Average loss: 0.0068, Accuracy: 744/842 (88.3610%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 9.5989, Accuracy: 2106/10000 (21.0600%)
___Train Local_ResNet_18,  epoch 267, local model 80, internal_epoch   1,  Average loss: 0.0015, Accuracy: 360/363 (99.1736%)
___Train Local_ResNet_18,  epoch 267, local model 80, internal_epoch   2,  Average loss: 0.0005, Accuracy: 360/363 (99.1736%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 2.4560, Accuracy: 5378/10000 (53.7800%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 267, local model 33, internal_epoch   1,  Average loss: 0.0023, Accuracy: 506/527 (96.0152%)
___Train Local_ResNet_18,  epoch 267, local model 33, internal_epoch   2,  Average loss: 0.0056, Accuracy: 482/527 (91.4611%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 3.2737, Accuracy: 3897/10000 (38.9700%)
___Train Local_ResNet_18,  epoch 267, local model 13, internal_epoch   1,  Average loss: 0.0035, Accuracy: 576/620 (92.9032%)
___Train Local_ResNet_18,  epoch 267, local model 13, internal_epoch   2,  Average loss: 0.0031, Accuracy: 586/620 (94.5161%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 6.1197, Accuracy: 2859/10000 (28.5900%)
___Train Local_ResNet_18,  epoch 267, local model 16, internal_epoch   1,  Average loss: 0.0013, Accuracy: 764/773 (98.8357%)
___Train Local_ResNet_18,  epoch 267, local model 16, internal_epoch   2,  Average loss: 0.0078, Accuracy: 706/773 (91.3325%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 3.6659, Accuracy: 3284/10000 (32.8400%)
___Train Local_ResNet_18,  epoch 267, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 336/337 (99.7033%)
___Train Local_ResNet_18,  epoch 267, local model 30, internal_epoch   2,  Average loss: 0.0007, Accuracy: 335/337 (99.4065%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 1.2598, Accuracy: 6681/10000 (66.8100%)
___Train Local_ResNet_18,  epoch 267, local model 47, internal_epoch   1,  Average loss: 0.0014, Accuracy: 643/654 (98.3180%)
___Train Local_ResNet_18,  epoch 267, local model 47, internal_epoch   2,  Average loss: 0.0022, Accuracy: 631/654 (96.4832%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 1.9476, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 267, local model 50, internal_epoch   1,  Average loss: 0.0007, Accuracy: 401/401 (100.0000%)
___Train Local_ResNet_18,  epoch 267, local model 50, internal_epoch   2,  Average loss: 0.0003, Accuracy: 400/401 (99.7506%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 1.1790, Accuracy: 6833/10000 (68.3300%)
___Train Local_ResNet_18,  epoch 267, local model 87, internal_epoch   1,  Average loss: 0.0032, Accuracy: 378/397 (95.2141%)
___Train Local_ResNet_18,  epoch 267, local model 87, internal_epoch   2,  Average loss: 0.0028, Accuracy: 386/397 (97.2292%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 6.0959, Accuracy: 2844/10000 (28.4400%)
___Train Local_ResNet_18,  epoch 267, local model 61, internal_epoch   1,  Average loss: 0.0025, Accuracy: 567/590 (96.1017%)
___Train Local_ResNet_18,  epoch 267, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 559/590 (94.7458%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 3.6407, Accuracy: 3237/10000 (32.3700%)
time spent on training: 119.29375553131104
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.09574854651162791  data num: [842, 363, 527, 620, 773, 337, 654, 401, 397, 590]
[rfa agg] considering poison per batch poison_fraction: 0.00748035519622093
[rfa agg] init. name: [67, 80, 33, 13, 16, 30, 47, 50, 87, 61], weight: tensor([0.1530, 0.0660, 0.0957, 0.1126, 0.1404, 0.0612, 0.1188, 0.0729, 0.0721,
        0.1072])
[rfa agg] iter:  0, prev_obj_val: 27.443172454833984, obj_val: 38.045509338378906, abs dis: 10.602336883544922
[rfa agg] iter:  0, weight: tensor([0.0559, 0.0719, 0.1556, 0.1135, 0.0614, 0.0668, 0.0860, 0.1510, 0.1289,
        0.1090])
[rfa agg] iter:  1, prev_obj_val: 38.045509338378906, obj_val: 55.23591995239258, abs dis: 17.190410614013672
[rfa agg] iter:  1, weight: tensor([0.0320, 0.2723, 0.0520, 0.0465, 0.0336, 0.2613, 0.0399, 0.1171, 0.1010,
        0.0444])
[rfa agg] iter:  2, prev_obj_val: 55.23591995239258, obj_val: 46.418212890625, abs dis: 8.817707061767578
[rfa agg] iter:  2, weight: tensor([0.0712, 0.1531, 0.0883, 0.0869, 0.0726, 0.1422, 0.0792, 0.1135, 0.1101,
        0.0828])
[rfa agg] iter:  3, prev_obj_val: 46.418212890625, obj_val: 37.970767974853516, abs dis: 8.447444915771484
[rfa agg] iter:  3, weight: tensor([0.0542, 0.1998, 0.0752, 0.0713, 0.0560, 0.1861, 0.0634, 0.1160, 0.1100,
        0.0680])
[rfa agg] iter:  4, prev_obj_val: 37.970767974853516, obj_val: 55.23952865600586, abs dis: 17.268760681152344
[rfa agg] iter:  4, weight: tensor([0.0285, 0.2986, 0.0460, 0.0413, 0.0299, 0.2851, 0.0355, 0.1054, 0.0904,
        0.0394])
[rfa agg] iter:  5, prev_obj_val: 55.23952865600586, obj_val: 46.41820526123047, abs dis: 8.82132339477539
[rfa agg] iter:  5, weight: tensor([0.0711, 0.1532, 0.0883, 0.0869, 0.0726, 0.1423, 0.0792, 0.1135, 0.1101,
        0.0828])
[rfa agg] iter:  6, prev_obj_val: 46.41820526123047, obj_val: 37.970767974853516, abs dis: 8.447437286376953
[rfa agg] iter:  6, weight: tensor([0.0542, 0.1998, 0.0752, 0.0713, 0.0560, 0.1861, 0.0634, 0.1160, 0.1100,
        0.0680])
[rfa agg] iter:  7, prev_obj_val: 37.970767974853516, obj_val: 55.23952865600586, abs dis: 17.268760681152344
[rfa agg] iter:  7, weight: tensor([0.0285, 0.2986, 0.0460, 0.0413, 0.0299, 0.2851, 0.0355, 0.1054, 0.0904,
        0.0394])
[rfa agg] iter:  8, prev_obj_val: 55.23952865600586, obj_val: 46.41820526123047, abs dis: 8.82132339477539
[rfa agg] iter:  8, weight: tensor([0.0711, 0.1532, 0.0883, 0.0869, 0.0726, 0.1423, 0.0792, 0.1135, 0.1101,
        0.0828])
[rfa agg] iter:  9, prev_obj_val: 46.41820526123047, obj_val: 37.970767974853516, abs dis: 8.447437286376953
[rfa agg] iter:  9, weight: tensor([0.0542, 0.1998, 0.0752, 0.0713, 0.0560, 0.1861, 0.0634, 0.1160, 0.1100,
        0.0680])
___Test Target_ResNet_18 poisoned: False, epoch: 267: Average loss: 0.6252, Accuracy: 7949/10000 (79.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 267: Average loss: 5.9131, Accuracy: 528/9000 (5.8667%)
Done in 271.1380980014801 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:268 choose agents : [42, 8, 37, 58, 30, 34, 82, 0, 53, 74]. Adversary List: []
___Train Local_ResNet_18,  epoch 268, local model 42, internal_epoch   1,  Average loss: 0.0024, Accuracy: 196/198 (98.9899%)
___Train Local_ResNet_18,  epoch 268, local model 42, internal_epoch   2,  Average loss: 0.0208, Accuracy: 191/198 (96.4646%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 3.0237, Accuracy: 4013/10000 (40.1300%)
___Train Local_ResNet_18,  epoch 268, local model 8, internal_epoch   1,  Average loss: 0.0007, Accuracy: 532/534 (99.6255%)
___Train Local_ResNet_18,  epoch 268, local model 8, internal_epoch   2,  Average loss: 0.0002, Accuracy: 534/534 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 1.2727, Accuracy: 6432/10000 (64.3200%)
___Train Local_ResNet_18,  epoch 268, local model 37, internal_epoch   1,  Average loss: 0.0032, Accuracy: 681/725 (93.9310%)
___Train Local_ResNet_18,  epoch 268, local model 37, internal_epoch   2,  Average loss: 0.0092, Accuracy: 609/725 (84.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 11.6332, Accuracy: 2119/10000 (21.1900%)
___Train Local_ResNet_18,  epoch 268, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 220/234 (94.0171%)
___Train Local_ResNet_18,  epoch 268, local model 58, internal_epoch   2,  Average loss: 0.0006, Accuracy: 232/234 (99.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 3.7353, Accuracy: 3435/10000 (34.3500%)
___Train Local_ResNet_18,  epoch 268, local model 30, internal_epoch   1,  Average loss: 0.0009, Accuracy: 337/337 (100.0000%)
___Train Local_ResNet_18,  epoch 268, local model 30, internal_epoch   2,  Average loss: 0.0006, Accuracy: 336/337 (99.7033%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 1.2317, Accuracy: 6842/10000 (68.4200%)
___Train Local_ResNet_18,  epoch 268, local model 34, internal_epoch   1,  Average loss: 0.0018, Accuracy: 344/349 (98.5673%)
___Train Local_ResNet_18,  epoch 268, local model 34, internal_epoch   2,  Average loss: 0.0008, Accuracy: 346/349 (99.1404%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 3.1806, Accuracy: 5005/10000 (50.0500%)
___Train Local_ResNet_18,  epoch 268, local model 82, internal_epoch   1,  Average loss: 0.0010, Accuracy: 596/601 (99.1681%)
___Train Local_ResNet_18,  epoch 268, local model 82, internal_epoch   2,  Average loss: 0.0010, Accuracy: 593/601 (98.6689%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 1.6780, Accuracy: 5940/10000 (59.4000%)
___Train Local_ResNet_18,  epoch 268, local model 0, internal_epoch   1,  Average loss: 0.0010, Accuracy: 366/367 (99.7275%)
___Train Local_ResNet_18,  epoch 268, local model 0, internal_epoch   2,  Average loss: 0.0003, Accuracy: 367/367 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 1.7525, Accuracy: 6032/10000 (60.3200%)
___Train Local_ResNet_18,  epoch 268, local model 53, internal_epoch   1,  Average loss: 0.0017, Accuracy: 607/625 (97.1200%)
___Train Local_ResNet_18,  epoch 268, local model 53, internal_epoch   2,  Average loss: 0.0026, Accuracy: 593/625 (94.8800%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 2.0940, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch 268, local model 74, internal_epoch   1,  Average loss: 0.0026, Accuracy: 455/469 (97.0149%)
___Train Local_ResNet_18,  epoch 268, local model 74, internal_epoch   2,  Average loss: 0.0010, Accuracy: 464/469 (98.9339%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 1.6678, Accuracy: 5565/10000 (55.6500%)
time spent on training: 100.7721266746521
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [198, 534, 725, 234, 337, 349, 601, 367, 625, 469]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 8, 37, 58, 30, 34, 82, 0, 53, 74], weight: tensor([0.0446, 0.1203, 0.1633, 0.0527, 0.0759, 0.0786, 0.1354, 0.0827, 0.1408,
        0.1057])
[rfa agg] iter:  0, prev_obj_val: 33.32627487182617, obj_val: 36.845008850097656, abs dis: 3.5187339782714844
[rfa agg] iter:  0, weight: tensor([0.0865, 0.0665, 0.0511, 0.1081, 0.1589, 0.1577, 0.0598, 0.1727, 0.0620,
        0.0767])
[rfa agg] iter:  1, prev_obj_val: 36.845008850097656, obj_val: 33.254634857177734, abs dis: 3.590373992919922
[rfa agg] iter:  1, weight: tensor([0.1475, 0.0612, 0.0491, 0.2031, 0.1147, 0.1168, 0.0562, 0.1249, 0.0582,
        0.0684])
[rfa agg] iter:  2, prev_obj_val: 33.254634857177734, obj_val: 36.8448600769043, abs dis: 3.5902252197265625
[rfa agg] iter:  2, weight: tensor([0.0884, 0.0651, 0.0497, 0.1099, 0.1598, 0.1591, 0.0585, 0.1739, 0.0605,
        0.0751])
[rfa agg] iter:  3, prev_obj_val: 36.8448600769043, obj_val: 33.2546501159668, abs dis: 3.5902099609375
[rfa agg] iter:  3, weight: tensor([0.1476, 0.0611, 0.0491, 0.2032, 0.1146, 0.1168, 0.0562, 0.1249, 0.0582,
        0.0683])
[rfa agg] iter:  4, prev_obj_val: 33.2546501159668, obj_val: 36.8448600769043, abs dis: 3.5902099609375
[rfa agg] iter:  4, weight: tensor([0.0884, 0.0651, 0.0497, 0.1099, 0.1598, 0.1591, 0.0585, 0.1739, 0.0605,
        0.0751])
[rfa agg] iter:  5, prev_obj_val: 36.8448600769043, obj_val: 33.2546501159668, abs dis: 3.5902099609375
[rfa agg] iter:  5, weight: tensor([0.1476, 0.0611, 0.0491, 0.2032, 0.1146, 0.1168, 0.0562, 0.1249, 0.0582,
        0.0683])
[rfa agg] iter:  6, prev_obj_val: 33.2546501159668, obj_val: 36.8448600769043, abs dis: 3.5902099609375
[rfa agg] iter:  6, weight: tensor([0.0884, 0.0651, 0.0497, 0.1099, 0.1598, 0.1591, 0.0585, 0.1739, 0.0605,
        0.0751])
[rfa agg] iter:  7, prev_obj_val: 36.8448600769043, obj_val: 33.2546501159668, abs dis: 3.5902099609375
[rfa agg] iter:  7, weight: tensor([0.1476, 0.0611, 0.0491, 0.2032, 0.1146, 0.1168, 0.0562, 0.1249, 0.0582,
        0.0683])
[rfa agg] iter:  8, prev_obj_val: 33.2546501159668, obj_val: 36.8448600769043, abs dis: 3.5902099609375
[rfa agg] iter:  8, weight: tensor([0.0884, 0.0651, 0.0497, 0.1099, 0.1598, 0.1591, 0.0585, 0.1739, 0.0605,
        0.0751])
[rfa agg] iter:  9, prev_obj_val: 36.8448600769043, obj_val: 33.2546501159668, abs dis: 3.5902099609375
[rfa agg] iter:  9, weight: tensor([0.1476, 0.0611, 0.0491, 0.2032, 0.1146, 0.1168, 0.0562, 0.1249, 0.0582,
        0.0683])
___Test Target_ResNet_18 poisoned: False, epoch: 268: Average loss: 0.6206, Accuracy: 7977/10000 (79.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 268: Average loss: 5.9085, Accuracy: 558/9000 (6.2000%)
Done in 264.8668119907379 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:269 choose agents : [63, 59, 29, 16, 50, 97, 34, 65, 4, 86]. Adversary List: []
___Train Local_ResNet_18,  epoch 269, local model 63, internal_epoch   1,  Average loss: 0.0007, Accuracy: 745/752 (99.0691%)
___Train Local_ResNet_18,  epoch 269, local model 63, internal_epoch   2,  Average loss: 0.0007, Accuracy: 745/752 (99.0691%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 0.8878, Accuracy: 7357/10000 (73.5700%)
___Train Local_ResNet_18,  epoch 269, local model 59, internal_epoch   1,  Average loss: 0.0014, Accuracy: 630/642 (98.1308%)
___Train Local_ResNet_18,  epoch 269, local model 59, internal_epoch   2,  Average loss: 0.0016, Accuracy: 625/642 (97.3520%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 2.1920, Accuracy: 4769/10000 (47.6900%)
___Train Local_ResNet_18,  epoch 269, local model 29, internal_epoch   1,  Average loss: 0.0028, Accuracy: 806/848 (95.0472%)
___Train Local_ResNet_18,  epoch 269, local model 29, internal_epoch   2,  Average loss: 0.0059, Accuracy: 768/848 (90.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 11.9405, Accuracy: 1726/10000 (17.2600%)
___Train Local_ResNet_18,  epoch 269, local model 16, internal_epoch   1,  Average loss: 0.0023, Accuracy: 765/773 (98.9651%)
___Train Local_ResNet_18,  epoch 269, local model 16, internal_epoch   2,  Average loss: 0.0242, Accuracy: 462/773 (59.7671%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 357.1633, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 269, local model 50, internal_epoch   1,  Average loss: 0.0010, Accuracy: 400/401 (99.7506%)
___Train Local_ResNet_18,  epoch 269, local model 50, internal_epoch   2,  Average loss: 0.0008, Accuracy: 396/401 (98.7531%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 2.0010, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 269, local model 97, internal_epoch   1,  Average loss: 0.0011, Accuracy: 415/418 (99.2823%)
___Train Local_ResNet_18,  epoch 269, local model 97, internal_epoch   2,  Average loss: 0.0003, Accuracy: 418/418 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 1.5358, Accuracy: 6226/10000 (62.2600%)
___Train Local_ResNet_18,  epoch 269, local model 34, internal_epoch   1,  Average loss: 0.0016, Accuracy: 342/349 (97.9943%)
___Train Local_ResNet_18,  epoch 269, local model 34, internal_epoch   2,  Average loss: 0.0005, Accuracy: 347/349 (99.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 2.1921, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 269, local model 65, internal_epoch   1,  Average loss: 0.0011, Accuracy: 313/314 (99.6815%)
___Train Local_ResNet_18,  epoch 269, local model 65, internal_epoch   2,  Average loss: 0.0002, Accuracy: 314/314 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 1.0277, Accuracy: 7205/10000 (72.0500%)
___Train Local_ResNet_18,  epoch 269, local model 4, internal_epoch   1,  Average loss: 0.0026, Accuracy: 530/557 (95.1526%)
___Train Local_ResNet_18,  epoch 269, local model 4, internal_epoch   2,  Average loss: 0.0030, Accuracy: 531/557 (95.3321%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 2.8421, Accuracy: 4666/10000 (46.6600%)
___Train Local_ResNet_18,  epoch 269, local model 86, internal_epoch   1,  Average loss: 0.0014, Accuracy: 212/212 (100.0000%)
___Train Local_ResNet_18,  epoch 269, local model 86, internal_epoch   2,  Average loss: 0.0010, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 0.9967, Accuracy: 7230/10000 (72.3000%)
time spent on training: 102.60221743583679
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [752, 642, 848, 773, 401, 418, 349, 314, 557, 212]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [63, 59, 29, 16, 50, 97, 34, 65, 4, 86], weight: tensor([0.1428, 0.1219, 0.1610, 0.1468, 0.0761, 0.0794, 0.0663, 0.0596, 0.1058,
        0.0403])
[rfa agg] iter:  0, prev_obj_val: 33.51845932006836, obj_val: 40.701866149902344, abs dis: 7.183406829833984
[rfa agg] iter:  0, weight: tensor([0.0707, 0.0762, 0.0546, 0.0552, 0.2141, 0.2247, 0.0917, 0.0524, 0.1349,
        0.0256])
[rfa agg] iter:  1, prev_obj_val: 40.701866149902344, obj_val: 37.701622009277344, abs dis: 3.000244140625
[rfa agg] iter:  1, weight: tensor([0.0483, 0.0491, 0.0403, 0.0400, 0.1442, 0.1508, 0.3021, 0.1154, 0.0694,
        0.0404])
[rfa agg] iter:  2, prev_obj_val: 37.701622009277344, obj_val: 40.67372131347656, abs dis: 2.9720993041992188
[rfa agg] iter:  2, weight: tensor([0.0475, 0.0490, 0.0387, 0.0384, 0.2183, 0.2304, 0.2031, 0.0717, 0.0736,
        0.0293])
[rfa agg] iter:  3, prev_obj_val: 40.67372131347656, obj_val: 40.657142639160156, abs dis: 0.01657867431640625
[rfa agg] iter:  3, weight: tensor([0.0455, 0.0463, 0.0380, 0.0377, 0.1374, 0.1438, 0.3380, 0.1099, 0.0652,
        0.0382])
[rfa agg] iter:  4, prev_obj_val: 40.657142639160156, obj_val: 51.552982330322266, abs dis: 10.89583969116211
[rfa agg] iter:  4, weight: tensor([0.0427, 0.0434, 0.0357, 0.0353, 0.1272, 0.1332, 0.3822, 0.1033, 0.0611,
        0.0359])
[rfa agg] iter:  5, prev_obj_val: 51.552982330322266, obj_val: 44.019287109375, abs dis: 7.533695220947266
[rfa agg] iter:  5, weight: tensor([0.0512, 0.0502, 0.0452, 0.0444, 0.0810, 0.0845, 0.1169, 0.2782, 0.0622,
        0.1861])
[rfa agg] iter:  6, prev_obj_val: 44.019287109375, obj_val: 44.012542724609375, abs dis: 0.006744384765625
[rfa agg] iter:  6, weight: tensor([0.0488, 0.0489, 0.0416, 0.0412, 0.1090, 0.1138, 0.2316, 0.2405, 0.0655,
        0.0589])
___Test Target_ResNet_18 poisoned: False, epoch: 269: Average loss: 0.6195, Accuracy: 7977/10000 (79.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 269: Average loss: 5.9354, Accuracy: 526/9000 (5.8444%)
Done in 228.1667160987854 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:270 choose agents : [12, 45, 87, 95, 26, 42, 46, 88, 92, 38]. Adversary List: []
___Train Local_ResNet_18,  epoch 270, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 899/977 (92.0164%)
___Train Local_ResNet_18,  epoch 270, local model 12, internal_epoch   2,  Average loss: 0.0121, Accuracy: 746/977 (76.3562%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 23.7405, Accuracy: 1481/10000 (14.8100%)
___Train Local_ResNet_18,  epoch 270, local model 45, internal_epoch   1,  Average loss: 0.0026, Accuracy: 503/529 (95.0851%)
___Train Local_ResNet_18,  epoch 270, local model 45, internal_epoch   2,  Average loss: 0.0031, Accuracy: 499/529 (94.3289%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 3.6162, Accuracy: 4031/10000 (40.3100%)
___Train Local_ResNet_18,  epoch 270, local model 87, internal_epoch   1,  Average loss: 0.0035, Accuracy: 371/397 (93.4509%)
___Train Local_ResNet_18,  epoch 270, local model 87, internal_epoch   2,  Average loss: 0.0027, Accuracy: 379/397 (95.4660%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 2.8014, Accuracy: 4655/10000 (46.5500%)
___Train Local_ResNet_18,  epoch 270, local model 95, internal_epoch   1,  Average loss: 0.0034, Accuracy: 529/569 (92.9701%)
___Train Local_ResNet_18,  epoch 270, local model 95, internal_epoch   2,  Average loss: 0.0052, Accuracy: 509/569 (89.4552%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 5.5923, Accuracy: 2740/10000 (27.4000%)
___Train Local_ResNet_18,  epoch 270, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 460/468 (98.2906%)
___Train Local_ResNet_18,  epoch 270, local model 26, internal_epoch   2,  Average loss: 0.0011, Accuracy: 462/468 (98.7179%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 2.5175, Accuracy: 4805/10000 (48.0500%)
___Train Local_ResNet_18,  epoch 270, local model 42, internal_epoch   1,  Average loss: 0.0021, Accuracy: 193/198 (97.4747%)
___Train Local_ResNet_18,  epoch 270, local model 42, internal_epoch   2,  Average loss: 0.0009, Accuracy: 197/198 (99.4949%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 2.1540, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 270, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 599/601 (99.6672%)
___Train Local_ResNet_18,  epoch 270, local model 46, internal_epoch   2,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 1.2530, Accuracy: 6547/10000 (65.4700%)
___Train Local_ResNet_18,  epoch 270, local model 88, internal_epoch   1,  Average loss: 0.0035, Accuracy: 417/447 (93.2886%)
___Train Local_ResNet_18,  epoch 270, local model 88, internal_epoch   2,  Average loss: 0.0021, Accuracy: 430/447 (96.1969%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 3.4866, Accuracy: 3980/10000 (39.8000%)
___Train Local_ResNet_18,  epoch 270, local model 92, internal_epoch   1,  Average loss: 0.0025, Accuracy: 760/796 (95.4774%)
___Train Local_ResNet_18,  epoch 270, local model 92, internal_epoch   2,  Average loss: 0.0098, Accuracy: 671/796 (84.2965%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 17.4701, Accuracy: 1413/10000 (14.1300%)
___Train Local_ResNet_18,  epoch 270, local model 38, internal_epoch   1,  Average loss: 0.0012, Accuracy: 747/756 (98.8095%)
___Train Local_ResNet_18,  epoch 270, local model 38, internal_epoch   2,  Average loss: 0.0012, Accuracy: 740/756 (97.8836%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 3.5724, Accuracy: 4451/10000 (44.5100%)
time spent on training: 104.42959403991699
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [977, 529, 397, 569, 468, 198, 601, 447, 796, 756]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [12, 45, 87, 95, 26, 42, 46, 88, 92, 38], weight: tensor([0.1703, 0.0922, 0.0692, 0.0992, 0.0816, 0.0345, 0.1047, 0.0779, 0.1387,
        0.1318])
[rfa agg] iter:  0, prev_obj_val: 29.431873321533203, obj_val: 33.82896041870117, abs dis: 4.397087097167969
[rfa agg] iter:  0, weight: tensor([0.0422, 0.1721, 0.0774, 0.1622, 0.1926, 0.0145, 0.1254, 0.0874, 0.0564,
        0.0700])
[rfa agg] iter:  1, prev_obj_val: 33.82896041870117, obj_val: 40.478031158447266, abs dis: 6.649070739746094
[rfa agg] iter:  1, weight: tensor([0.0373, 0.1055, 0.1508, 0.1082, 0.2266, 0.0187, 0.0793, 0.1715, 0.0468,
        0.0553])
[rfa agg] iter:  2, prev_obj_val: 40.478031158447266, obj_val: 40.46566390991211, abs dis: 0.01236724853515625
[rfa agg] iter:  2, weight: tensor([0.0428, 0.0858, 0.2050, 0.0903, 0.1275, 0.0332, 0.0726, 0.2341, 0.0509,
        0.0579])
[rfa agg] iter:  3, prev_obj_val: 40.46566390991211, obj_val: 44.38043975830078, abs dis: 3.914775848388672
[rfa agg] iter:  3, weight: tensor([0.0422, 0.0843, 0.2083, 0.0887, 0.1244, 0.0327, 0.0716, 0.2406, 0.0502,
        0.0571])
[rfa agg] iter:  4, prev_obj_val: 44.38043975830078, obj_val: 48.399078369140625, abs dis: 4.018638610839844
[rfa agg] iter:  4, weight: tensor([0.0510, 0.0906, 0.1797, 0.0958, 0.1210, 0.0514, 0.0797, 0.2049, 0.0594,
        0.0666])
[rfa agg] iter:  5, prev_obj_val: 48.399078369140625, obj_val: 48.397422790527344, abs dis: 0.00165557861328125
[rfa agg] iter:  5, weight: tensor([0.0579, 0.0934, 0.1543, 0.0992, 0.1165, 0.0802, 0.0844, 0.1747, 0.0661,
        0.0732])
___Test Target_ResNet_18 poisoned: False, epoch: 270: Average loss: 0.6212, Accuracy: 7959/10000 (79.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 270: Average loss: 5.7589, Accuracy: 606/9000 (6.7333%)
Done in 243.95270204544067 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:271 choose agents : [53, 41, 66, 33, 0, 84, 78, 6, 8, 67]. Adversary List: []
___Train Local_ResNet_18,  epoch 271, local model 53, internal_epoch   1,  Average loss: 0.0015, Accuracy: 611/625 (97.7600%)
___Train Local_ResNet_18,  epoch 271, local model 53, internal_epoch   2,  Average loss: 0.0014, Accuracy: 606/625 (96.9600%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 2.1787, Accuracy: 4976/10000 (49.7600%)
___Train Local_ResNet_18,  epoch 271, local model 41, internal_epoch   1,  Average loss: 0.0171, Accuracy: 460/513 (89.6686%)
___Train Local_ResNet_18,  epoch 271, local model 41, internal_epoch   2,  Average loss: 0.0115, Accuracy: 396/513 (77.1930%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 4.9189, Accuracy: 2602/10000 (26.0200%)
___Train Local_ResNet_18,  epoch 271, local model 66, internal_epoch   1,  Average loss: 0.0014, Accuracy: 542/555 (97.6577%)
___Train Local_ResNet_18,  epoch 271, local model 66, internal_epoch   2,  Average loss: 0.0004, Accuracy: 553/555 (99.6396%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 2.5129, Accuracy: 4881/10000 (48.8100%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 271, local model 33, internal_epoch   1,  Average loss: 0.0020, Accuracy: 516/527 (97.9127%)
___Train Local_ResNet_18,  epoch 271, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 480/527 (91.0816%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 3.2476, Accuracy: 3720/10000 (37.2000%)
___Train Local_ResNet_18,  epoch 271, local model 0, internal_epoch   1,  Average loss: 0.0009, Accuracy: 367/367 (100.0000%)
___Train Local_ResNet_18,  epoch 271, local model 0, internal_epoch   2,  Average loss: 0.0005, Accuracy: 365/367 (99.4550%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 1.5426, Accuracy: 6266/10000 (62.6600%)
___Train Local_ResNet_18,  epoch 271, local model 84, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1034/1053 (98.1956%)
___Train Local_ResNet_18,  epoch 271, local model 84, internal_epoch   2,  Average loss: 0.0021, Accuracy: 1010/1053 (95.9164%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 2.8407, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch 271, local model 78, internal_epoch   1,  Average loss: 0.0023, Accuracy: 247/255 (96.8627%)
___Train Local_ResNet_18,  epoch 271, local model 78, internal_epoch   2,  Average loss: 0.0008, Accuracy: 252/255 (98.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 2.1277, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 271, local model 6, internal_epoch   1,  Average loss: 0.0016, Accuracy: 512/520 (98.4615%)
___Train Local_ResNet_18,  epoch 271, local model 6, internal_epoch   2,  Average loss: 0.0097, Accuracy: 452/520 (86.9231%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 4.6098, Accuracy: 2752/10000 (27.5200%)
___Train Local_ResNet_18,  epoch 271, local model 8, internal_epoch   1,  Average loss: 0.0006, Accuracy: 533/534 (99.8127%)
___Train Local_ResNet_18,  epoch 271, local model 8, internal_epoch   2,  Average loss: 0.0002, Accuracy: 534/534 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 1.0705, Accuracy: 6913/10000 (69.1300%)
___Train Local_ResNet_18,  epoch 271, local model 67, internal_epoch   1,  Average loss: 0.0018, Accuracy: 818/842 (97.1496%)
___Train Local_ResNet_18,  epoch 271, local model 67, internal_epoch   2,  Average loss: 0.0093, Accuracy: 725/842 (86.1045%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 17.2673, Accuracy: 1449/10000 (14.4900%)
time spent on training: 117.66145849227905
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.09100328095320324  data num: [625, 513, 555, 527, 367, 1053, 255, 520, 534, 842]
[rfa agg] considering poison per batch poison_fraction: 0.007109631324469004
[rfa agg] init. name: [53, 41, 66, 33, 0, 84, 78, 6, 8, 67], weight: tensor([0.1079, 0.0886, 0.0958, 0.0910, 0.0634, 0.1818, 0.0440, 0.0898, 0.0922,
        0.1454])
[rfa agg] iter:  0, prev_obj_val: 30.254762649536133, obj_val: 32.91086959838867, abs dis: 2.656106948852539
[rfa agg] iter:  0, weight: tensor([0.1032, 0.1025, 0.1871, 0.1387, 0.0398, 0.0339, 0.0155, 0.1152, 0.2233,
        0.0409])
[rfa agg] iter:  1, prev_obj_val: 32.91086959838867, obj_val: 32.90918731689453, abs dis: 0.001682281494140625
[rfa agg] iter:  1, weight: tensor([0.1032, 0.1126, 0.1698, 0.1408, 0.0632, 0.0407, 0.0222, 0.1234, 0.1765,
        0.0477])
___Test Target_ResNet_18 poisoned: False, epoch: 271: Average loss: 0.6237, Accuracy: 7937/10000 (79.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 271: Average loss: 5.6967, Accuracy: 637/9000 (7.0778%)
Done in 245.52000761032104 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:272 choose agents : [70, 2, 35, 42, 1, 56, 66, 71, 57, 80]. Adversary List: []
___Train Local_ResNet_18,  epoch 272, local model 70, internal_epoch   1,  Average loss: 0.0023, Accuracy: 583/610 (95.5738%)
___Train Local_ResNet_18,  epoch 272, local model 70, internal_epoch   2,  Average loss: 0.0024, Accuracy: 582/610 (95.4098%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 1.7800, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 272, local model 2, internal_epoch   1,  Average loss: 0.0023, Accuracy: 449/461 (97.3970%)
___Train Local_ResNet_18,  epoch 272, local model 2, internal_epoch   2,  Average loss: 0.0031, Accuracy: 435/461 (94.3601%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 2.7444, Accuracy: 4793/10000 (47.9300%)
___Train Local_ResNet_18,  epoch 272, local model 35, internal_epoch   1,  Average loss: 0.0028, Accuracy: 398/419 (94.9881%)
___Train Local_ResNet_18,  epoch 272, local model 35, internal_epoch   2,  Average loss: 0.0011, Accuracy: 412/419 (98.3294%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 3.2469, Accuracy: 4060/10000 (40.6000%)
___Train Local_ResNet_18,  epoch 272, local model 42, internal_epoch   1,  Average loss: 0.0160, Accuracy: 194/198 (97.9798%)
___Train Local_ResNet_18,  epoch 272, local model 42, internal_epoch   2,  Average loss: 0.0083, Accuracy: 179/198 (90.4040%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 15.5862, Accuracy: 1131/10000 (11.3100%)
___Train Local_ResNet_18,  epoch 272, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 632/641 (98.5959%)
___Train Local_ResNet_18,  epoch 272, local model 1, internal_epoch   2,  Average loss: 0.0123, Accuracy: 585/641 (91.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 4.3905, Accuracy: 3537/10000 (35.3700%)
___Train Local_ResNet_18,  epoch 272, local model 56, internal_epoch   1,  Average loss: 0.0008, Accuracy: 738/743 (99.3271%)
___Train Local_ResNet_18,  epoch 272, local model 56, internal_epoch   2,  Average loss: 0.0005, Accuracy: 739/743 (99.4616%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 1.1038, Accuracy: 6939/10000 (69.3900%)
___Train Local_ResNet_18,  epoch 272, local model 66, internal_epoch   1,  Average loss: 0.0017, Accuracy: 538/555 (96.9369%)
___Train Local_ResNet_18,  epoch 272, local model 66, internal_epoch   2,  Average loss: 0.0007, Accuracy: 548/555 (98.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 2.3435, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch 272, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 1123/1166 (96.3122%)
___Train Local_ResNet_18,  epoch 272, local model 71, internal_epoch   2,  Average loss: 0.0087, Accuracy: 987/1166 (84.6484%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 7.0464, Accuracy: 2663/10000 (26.6300%)
___Train Local_ResNet_18,  epoch 272, local model 57, internal_epoch   1,  Average loss: 0.0011, Accuracy: 288/290 (99.3103%)
___Train Local_ResNet_18,  epoch 272, local model 57, internal_epoch   2,  Average loss: 0.0005, Accuracy: 288/290 (99.3103%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 1.2100, Accuracy: 6844/10000 (68.4400%)
___Train Local_ResNet_18,  epoch 272, local model 80, internal_epoch   1,  Average loss: 0.0013, Accuracy: 362/363 (99.7245%)
___Train Local_ResNet_18,  epoch 272, local model 80, internal_epoch   2,  Average loss: 0.0004, Accuracy: 362/363 (99.7245%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 2.5587, Accuracy: 5509/10000 (55.0900%)
time spent on training: 113.06334471702576
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [610, 461, 419, 198, 641, 743, 555, 1166, 290, 363]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 2, 35, 42, 1, 56, 66, 71, 57, 80], weight: tensor([0.1120, 0.0846, 0.0769, 0.0364, 0.1177, 0.1364, 0.1019, 0.2141, 0.0533,
        0.0667])
[rfa agg] iter:  0, prev_obj_val: 35.294227600097656, obj_val: 38.11924362182617, abs dis: 2.8250160217285156
[rfa agg] iter:  0, weight: tensor([0.1754, 0.1348, 0.0742, 0.0147, 0.1077, 0.0917, 0.2857, 0.0436, 0.0272,
        0.0450])
[rfa agg] iter:  1, prev_obj_val: 38.11924362182617, obj_val: 45.48237609863281, abs dis: 7.363132476806641
[rfa agg] iter:  1, weight: tensor([0.1106, 0.2509, 0.1346, 0.0186, 0.0784, 0.0711, 0.1900, 0.0404, 0.0370,
        0.0685])
[rfa agg] iter:  2, prev_obj_val: 45.48237609863281, obj_val: 52.01845932006836, abs dis: 6.536083221435547
[rfa agg] iter:  2, weight: tensor([0.0711, 0.1193, 0.2197, 0.0309, 0.0581, 0.0563, 0.0904, 0.0386, 0.0787,
        0.2368])
[rfa agg] iter:  3, prev_obj_val: 52.01845932006836, obj_val: 48.51442337036133, abs dis: 3.5040359497070312
[rfa agg] iter:  3, weight: tensor([0.0590, 0.0786, 0.1162, 0.0495, 0.0506, 0.0504, 0.0690, 0.0378, 0.2191,
        0.2700])
[rfa agg] iter:  4, prev_obj_val: 48.51442337036133, obj_val: 52.011775970458984, abs dis: 3.4973526000976562
[rfa agg] iter:  4, weight: tensor([0.0511, 0.0744, 0.1229, 0.0308, 0.0429, 0.0422, 0.0619, 0.0304, 0.0962,
        0.4473])
[rfa agg] iter:  5, prev_obj_val: 52.011775970458984, obj_val: 48.51289749145508, abs dis: 3.4988784790039062
[rfa agg] iter:  5, weight: tensor([0.0574, 0.0764, 0.1116, 0.0483, 0.0493, 0.0491, 0.0671, 0.0368, 0.2185,
        0.2856])
[rfa agg] iter:  6, prev_obj_val: 48.51289749145508, obj_val: 52.01219940185547, abs dis: 3.4993019104003906
[rfa agg] iter:  6, weight: tensor([0.0506, 0.0736, 0.1214, 0.0305, 0.0425, 0.0417, 0.0612, 0.0300, 0.0953,
        0.4533])
[rfa agg] iter:  7, prev_obj_val: 52.01219940185547, obj_val: 48.51287078857422, abs dis: 3.49932861328125
[rfa agg] iter:  7, weight: tensor([0.0574, 0.0763, 0.1115, 0.0482, 0.0493, 0.0490, 0.0671, 0.0368, 0.2184,
        0.2859])
[rfa agg] iter:  8, prev_obj_val: 48.51287078857422, obj_val: 52.01221466064453, abs dis: 3.4993438720703125
[rfa agg] iter:  8, weight: tensor([0.0505, 0.0735, 0.1214, 0.0305, 0.0425, 0.0417, 0.0612, 0.0300, 0.0952,
        0.4534])
[rfa agg] iter:  9, prev_obj_val: 52.01221466064453, obj_val: 48.51286697387695, abs dis: 3.499347686767578
[rfa agg] iter:  9, weight: tensor([0.0574, 0.0763, 0.1115, 0.0482, 0.0493, 0.0490, 0.0671, 0.0368, 0.2184,
        0.2860])
___Test Target_ResNet_18 poisoned: False, epoch: 272: Average loss: 0.6245, Accuracy: 7941/10000 (79.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 272: Average loss: 5.7487, Accuracy: 610/9000 (6.7778%)
Done in 259.3266532421112 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:273 choose agents : [17, 62, 81, 52, 9, 7, 60, 39, 47, 77]. Adversary List: []
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 273, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 518/526 (98.4791%)
___Train Local_ResNet_18,  epoch 273, local model 17, internal_epoch   2,  Average loss: 0.0012, Accuracy: 518/526 (98.4791%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 1.7252, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 273, local model 62, internal_epoch   1,  Average loss: 0.0005, Accuracy: 357/358 (99.7207%)
___Train Local_ResNet_18,  epoch 273, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 358/358 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 0.7454, Accuracy: 7647/10000 (76.4700%)
___Train Local_ResNet_18,  epoch 273, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 945/1034 (91.3926%)
___Train Local_ResNet_18,  epoch 273, local model 81, internal_epoch   2,  Average loss: 0.0131, Accuracy: 794/1034 (76.7892%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 14.6310, Accuracy: 1978/10000 (19.7800%)
___Train Local_ResNet_18,  epoch 273, local model 52, internal_epoch   1,  Average loss: 0.0019, Accuracy: 214/214 (100.0000%)
___Train Local_ResNet_18,  epoch 273, local model 52, internal_epoch   2,  Average loss: 0.0005, Accuracy: 214/214 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 1.1846, Accuracy: 6859/10000 (68.5900%)
___Train Local_ResNet_18,  epoch 273, local model 9, internal_epoch   1,  Average loss: 0.0016, Accuracy: 358/368 (97.2826%)
___Train Local_ResNet_18,  epoch 273, local model 9, internal_epoch   2,  Average loss: 0.0006, Accuracy: 364/368 (98.9130%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 4.7597, Accuracy: 3148/10000 (31.4800%)
___Train Local_ResNet_18,  epoch 273, local model 7, internal_epoch   1,  Average loss: 0.0012, Accuracy: 346/352 (98.2955%)
___Train Local_ResNet_18,  epoch 273, local model 7, internal_epoch   2,  Average loss: 0.0006, Accuracy: 350/352 (99.4318%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 1.6304, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 273, local model 60, internal_epoch   1,  Average loss: 0.0009, Accuracy: 284/284 (100.0000%)
___Train Local_ResNet_18,  epoch 273, local model 60, internal_epoch   2,  Average loss: 0.0003, Accuracy: 284/284 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 0.9103, Accuracy: 7268/10000 (72.6800%)
___Train Local_ResNet_18,  epoch 273, local model 39, internal_epoch   1,  Average loss: 0.0017, Accuracy: 213/217 (98.1567%)
___Train Local_ResNet_18,  epoch 273, local model 39, internal_epoch   2,  Average loss: 0.0003, Accuracy: 217/217 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 1.1127, Accuracy: 6775/10000 (67.7500%)
___Train Local_ResNet_18,  epoch 273, local model 47, internal_epoch   1,  Average loss: 0.0014, Accuracy: 646/654 (98.7768%)
___Train Local_ResNet_18,  epoch 273, local model 47, internal_epoch   2,  Average loss: 0.0031, Accuracy: 620/654 (94.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 2.5712, Accuracy: 4867/10000 (48.6700%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 273, local model 77, internal_epoch   1,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%)
___Train Local_ResNet_18,  epoch 273, local model 77, internal_epoch   2,  Average loss: 0.0005, Accuracy: 491/496 (98.9919%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 0.9062, Accuracy: 7299/10000 (72.9900%)
time spent on training: 128.63599061965942
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.22695980457472795  data num: [526, 358, 1034, 214, 368, 352, 284, 217, 654, 496]
[rfa agg] considering poison per batch poison_fraction: 0.01773123473240062
[rfa agg] init. name: [17, 62, 81, 52, 9, 7, 60, 39, 47, 77], weight: tensor([0.1168, 0.0795, 0.2296, 0.0475, 0.0817, 0.0782, 0.0631, 0.0482, 0.1452,
        0.1101])
[rfa agg] iter:  0, prev_obj_val: 36.94157409667969, obj_val: 43.36521911621094, abs dis: 6.42364501953125
[rfa agg] iter:  0, weight: tensor([0.0824, 0.1943, 0.0396, 0.0340, 0.1817, 0.1786, 0.0721, 0.0344, 0.0580,
        0.1249])
[rfa agg] iter:  1, prev_obj_val: 43.36521911621094, obj_val: 59.260276794433594, abs dis: 15.895057678222656
[rfa agg] iter:  1, weight: tensor([0.0420, 0.1133, 0.0273, 0.0667, 0.1114, 0.1081, 0.3761, 0.0673, 0.0348,
        0.0530])
[rfa agg] iter:  2, prev_obj_val: 59.260276794433594, obj_val: 43.37154006958008, abs dis: 15.888736724853516
[rfa agg] iter:  2, weight: tensor([0.0694, 0.0947, 0.0580, 0.1652, 0.0967, 0.0927, 0.1125, 0.1674, 0.0646,
        0.0787])
[rfa agg] iter:  3, prev_obj_val: 43.37154006958008, obj_val: 59.26018524169922, abs dis: 15.88864517211914
[rfa agg] iter:  3, weight: tensor([0.0422, 0.1132, 0.0275, 0.0672, 0.1104, 0.1074, 0.3761, 0.0680, 0.0349,
        0.0532])
[rfa agg] iter:  4, prev_obj_val: 59.26018524169922, obj_val: 43.37154006958008, abs dis: 15.88864517211914
[rfa agg] iter:  4, weight: tensor([0.0694, 0.0947, 0.0580, 0.1652, 0.0967, 0.0927, 0.1125, 0.1674, 0.0646,
        0.0787])
[rfa agg] iter:  5, prev_obj_val: 43.37154006958008, obj_val: 59.26018524169922, abs dis: 15.88864517211914
[rfa agg] iter:  5, weight: tensor([0.0422, 0.1132, 0.0275, 0.0672, 0.1104, 0.1074, 0.3761, 0.0680, 0.0349,
        0.0532])
[rfa agg] iter:  6, prev_obj_val: 59.26018524169922, obj_val: 43.37154006958008, abs dis: 15.88864517211914
[rfa agg] iter:  6, weight: tensor([0.0694, 0.0947, 0.0580, 0.1652, 0.0967, 0.0927, 0.1125, 0.1674, 0.0646,
        0.0787])
[rfa agg] iter:  7, prev_obj_val: 43.37154006958008, obj_val: 59.26018524169922, abs dis: 15.88864517211914
[rfa agg] iter:  7, weight: tensor([0.0422, 0.1132, 0.0275, 0.0672, 0.1104, 0.1074, 0.3761, 0.0680, 0.0349,
        0.0532])
[rfa agg] iter:  8, prev_obj_val: 59.26018524169922, obj_val: 43.37154006958008, abs dis: 15.88864517211914
[rfa agg] iter:  8, weight: tensor([0.0694, 0.0947, 0.0580, 0.1652, 0.0967, 0.0927, 0.1125, 0.1674, 0.0646,
        0.0787])
[rfa agg] iter:  9, prev_obj_val: 43.37154006958008, obj_val: 59.26018524169922, abs dis: 15.88864517211914
[rfa agg] iter:  9, weight: tensor([0.0422, 0.1132, 0.0275, 0.0672, 0.1104, 0.1074, 0.3761, 0.0680, 0.0349,
        0.0532])
___Test Target_ResNet_18 poisoned: False, epoch: 273: Average loss: 0.6231, Accuracy: 7964/10000 (79.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 273: Average loss: 5.8510, Accuracy: 583/9000 (6.4778%)
Done in 283.5847556591034 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:274 choose agents : [86, 75, 23, 20, 40, 58, 9, 59, 19, 79]. Adversary List: []
___Train Local_ResNet_18,  epoch 274, local model 86, internal_epoch   1,  Average loss: 0.0014, Accuracy: 210/212 (99.0566%)
___Train Local_ResNet_18,  epoch 274, local model 86, internal_epoch   2,  Average loss: 0.0012, Accuracy: 210/212 (99.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 0.9823, Accuracy: 7236/10000 (72.3600%)
___Train Local_ResNet_18,  epoch 274, local model 75, internal_epoch   1,  Average loss: 0.0078, Accuracy: 559/578 (96.7128%)
___Train Local_ResNet_18,  epoch 274, local model 75, internal_epoch   2,  Average loss: 0.0273, Accuracy: 340/578 (58.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 595.0265, Accuracy: 1364/10000 (13.6400%)
___Train Local_ResNet_18,  epoch 274, local model 23, internal_epoch   1,  Average loss: 0.0015, Accuracy: 244/248 (98.3871%)
___Train Local_ResNet_18,  epoch 274, local model 23, internal_epoch   2,  Average loss: 0.0004, Accuracy: 247/248 (99.5968%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 0.8672, Accuracy: 7320/10000 (73.2000%)
___Train Local_ResNet_18,  epoch 274, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 350/362 (96.6851%)
___Train Local_ResNet_18,  epoch 274, local model 20, internal_epoch   2,  Average loss: 0.0010, Accuracy: 357/362 (98.6188%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 4.9589, Accuracy: 3926/10000 (39.2600%)
___Train Local_ResNet_18,  epoch 274, local model 40, internal_epoch   1,  Average loss: 0.0029, Accuracy: 625/652 (95.8589%)
___Train Local_ResNet_18,  epoch 274, local model 40, internal_epoch   2,  Average loss: 0.0111, Accuracy: 533/652 (81.7485%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 12.2983, Accuracy: 2131/10000 (21.3100%)
___Train Local_ResNet_18,  epoch 274, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 229/234 (97.8632%)
___Train Local_ResNet_18,  epoch 274, local model 58, internal_epoch   2,  Average loss: 0.0004, Accuracy: 233/234 (99.5726%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 1.2900, Accuracy: 6392/10000 (63.9200%)
___Train Local_ResNet_18,  epoch 274, local model 9, internal_epoch   1,  Average loss: 0.0015, Accuracy: 366/368 (99.4565%)
___Train Local_ResNet_18,  epoch 274, local model 9, internal_epoch   2,  Average loss: 0.0004, Accuracy: 366/368 (99.4565%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 7.5481, Accuracy: 2413/10000 (24.1300%)
___Train Local_ResNet_18,  epoch 274, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 634/642 (98.7539%)
___Train Local_ResNet_18,  epoch 274, local model 59, internal_epoch   2,  Average loss: 0.0204, Accuracy: 475/642 (73.9875%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 82.2032, Accuracy: 748/10000 (7.4800%)
___Train Local_ResNet_18,  epoch 274, local model 19, internal_epoch   1,  Average loss: 0.0074, Accuracy: 148/173 (85.5491%)
___Train Local_ResNet_18,  epoch 274, local model 19, internal_epoch   2,  Average loss: 0.0022, Accuracy: 169/173 (97.6879%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 6.8769, Accuracy: 2930/10000 (29.3000%)
___Train Local_ResNet_18,  epoch 274, local model 79, internal_epoch   1,  Average loss: 0.0037, Accuracy: 144/154 (93.5065%)
___Train Local_ResNet_18,  epoch 274, local model 79, internal_epoch   2,  Average loss: 0.0009, Accuracy: 153/154 (99.3506%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 1.2466, Accuracy: 6575/10000 (65.7500%)
time spent on training: 98.31733059883118
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [212, 578, 248, 362, 652, 234, 368, 642, 173, 154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [86, 75, 23, 20, 40, 58, 9, 59, 19, 79], weight: tensor([0.0585, 0.1595, 0.0685, 0.0999, 0.1800, 0.0646, 0.1016, 0.1772, 0.0478,
        0.0425])
[rfa agg] iter:  0, prev_obj_val: 32.66411209106445, obj_val: 41.11592483520508, abs dis: 8.451812744140625
[rfa agg] iter:  0, weight: tensor([0.0772, 0.0683, 0.0906, 0.2274, 0.0702, 0.0855, 0.2374, 0.0669, 0.0404,
        0.0361])
[rfa agg] iter:  1, prev_obj_val: 41.11592483520508, obj_val: 57.55699920654297, abs dis: 16.44107437133789
[rfa agg] iter:  1, weight: tensor([0.1568, 0.0387, 0.1865, 0.0675, 0.0404, 0.1746, 0.0689, 0.0388, 0.1180,
        0.1098])
[rfa agg] iter:  2, prev_obj_val: 57.55699920654297, obj_val: 48.87647247314453, abs dis: 8.680526733398438
[rfa agg] iter:  2, weight: tensor([0.0995, 0.0760, 0.1165, 0.0945, 0.0799, 0.1099, 0.0962, 0.0774, 0.1319,
        0.1183])
[rfa agg] iter:  3, prev_obj_val: 48.87647247314453, obj_val: 48.85688781738281, abs dis: 0.01958465576171875
[rfa agg] iter:  3, weight: tensor([0.1004, 0.0532, 0.1178, 0.0753, 0.0556, 0.1110, 0.0767, 0.0537, 0.1851,
        0.1711])
[rfa agg] iter:  4, prev_obj_val: 48.85688781738281, obj_val: 48.85675811767578, abs dis: 0.00012969970703125
[rfa agg] iter:  4, weight: tensor([0.0984, 0.0514, 0.1155, 0.0731, 0.0539, 0.1088, 0.0745, 0.0520, 0.1936,
        0.1789])
___Test Target_ResNet_18 poisoned: False, epoch: 274: Average loss: 0.6208, Accuracy: 7988/10000 (79.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 274: Average loss: 5.9105, Accuracy: 530/9000 (5.8889%)
Done in 229.67785620689392 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:275 choose agents : [68, 60, 87, 9, 57, 40, 20, 39, 73, 48]. Adversary List: []
___Train Local_ResNet_18,  epoch 275, local model 68, internal_epoch   1,  Average loss: 0.0009, Accuracy: 412/416 (99.0385%)
___Train Local_ResNet_18,  epoch 275, local model 68, internal_epoch   2,  Average loss: 0.0004, Accuracy: 413/416 (99.2788%)
___Test Local_ResNet_18 poisoned: False, epoch: 275: Average loss: 0.9435, Accuracy: 7346/10000 (73.4600%)
___Train Local_ResNet_18,  epoch 275, local model 60, internal_epoch   1,  Average loss: 0.0008, Accuracy: 282/284 (99.2958%)
___Train Local_ResNet_18,  epoch 275, local model 60, internal_epoch   2,  Average loss: 0.0002, Accuracy: 284/284 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 275: Average loss: 0.8939, Accuracy: 7270/10000 (72.7000%)
___Train Local_ResNet_18,  epoch 275, local model 87, internal_epoch   1,  Average loss: 0.0027, Accuracy: 377/397 (94.9622%)
___Train Local_ResNet_18,  epoch 275, local model 87, internal_epoch   2,  Average loss: 0.0032, Accuracy: 383/397 (96.4736%)
___Test Local_ResNet_18 poisoned: False, epoch: 275: Average loss: 2.6677, Accuracy: 4675/10000 (46.7500%)
___Train Local_ResNet_18,  epoch 275, local model 9, internal_epoch   1,  Average loss: 0.0019, Accuracy: 361/368 (98.0978%)
___Train Local_ResNet_18,  epoch 275, local model 9, internal_epoch   2,  Average loss: 0.0010, Accuracy: 361/368 (98.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 275: Average loss: 4.9158, Accuracy: 3055/10000 (30.5500%)
___Train Local_ResNet_18,  epoch 275, local model 57, internal_epoch   1,  Average loss: 0.0013, Accuracy: 288/290 (99.3103%)
___Train Local_ResNet_18,  epoch 275, local model 57, internal_epoch   2,  Average loss: 0.0004, Accuracy: 289/290 (99.6552%)
___Test Local_ResNet_18 poisoned: False, epoch: 275: Average loss: 1.1454, Accuracy: 6902/10000 (69.0200%)
___Train Local_ResNet_18,  epoch 275, local model 40, internal_epoch   1,  Average loss: 0.0027, Accuracy: 628/652 (96.3190%)
