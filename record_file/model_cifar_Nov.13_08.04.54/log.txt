current path: saved_models/model_cifar_Nov.13_08.04.54
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 201
create model done
Poisoned following participants: [17, 33, 77, 11]
We use following environment for graphs:  cifar
----------------------------------Start one training epoch------------------------------------------
Server Epoch:201 choose agents : [17, 33, 77, 11, 37, 53, 39, 57, 63, 48]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   1,  Average loss: 0.0159, Accuracy: 447/526 (84.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   2,  Average loss: 0.0178, Accuracy: 404/526 (76.8061%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   3,  Average loss: 0.0108, Accuracy: 439/526 (83.4601%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   4,  Average loss: 0.0064, Accuracy: 480/526 (91.2548%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   5,  Average loss: 0.0036, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   6,  Average loss: 0.0022, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 39.632489865383015. Distance: 13.463770536719261
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.1044, Accuracy: 4233/10000 (42.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.1748, Accuracy: 8422/9000 (93.5778%)
Scaling by  100
Scaled Norm after poisoning: 1345.8253044136152, distance: 1346.3770831383013
Total norm for 4 adversaries is: 1345.8253044136152. distance: 1346.3770831383013
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   1,  Average loss: 0.0159, Accuracy: 433/527 (82.1632%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   2,  Average loss: 0.0166, Accuracy: 429/527 (81.4042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   3,  Average loss: 0.0097, Accuracy: 458/527 (86.9070%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   4,  Average loss: 0.0061, Accuracy: 488/527 (92.5996%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   5,  Average loss: 0.0037, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   6,  Average loss: 0.0031, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 38.9786850807592. Distance: 11.483806985315304
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.2513, Accuracy: 4020/10000 (40.2000%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.1937, Accuracy: 8347/9000 (92.7444%)
Scaling by  100
Scaled Norm after poisoning: 1147.6465048088633, distance: 1148.3807077794368
Total norm for 4 adversaries is: 1147.6465048088633. distance: 1148.3807077794368
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   1,  Average loss: 0.0098, Accuracy: 428/496 (86.2903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   2,  Average loss: 0.0062, Accuracy: 457/496 (92.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   3,  Average loss: 0.0035, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   4,  Average loss: 0.0020, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.66304237236004.
Norm before scaling: 37.93123629046959. Distance: 6.736976775906354
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.1820, Accuracy: 6232/10000 (62.3200%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.1776, Accuracy: 8604/9000 (95.6000%)
Scaling by  100
Scaled Norm after poisoning: 672.8862041608521, distance: 673.6977020518921
Total norm for 4 adversaries is: 672.8862041608521. distance: 673.6977020518921
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   1,  Average loss: 0.0076, Accuracy: 485/546 (88.8278%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 499/546 (91.3919%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   3,  Average loss: 0.0027, Accuracy: 520/546 (95.2381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   4,  Average loss: 0.0019, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 37.97067896334618. Distance: 7.089102007945205
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.4146, Accuracy: 5838/10000 (58.3800%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.2013, Accuracy: 8536/9000 (94.8444%)
Scaling by  100
Scaled Norm after poisoning: 708.0066207317556, distance: 708.9102111692284
Total norm for 4 adversaries is: 708.0066207317556. distance: 708.9102111692284
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   1,  Average loss: 0.0113, Accuracy: 583/725 (80.4138%)
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   2,  Average loss: 0.0185, Accuracy: 498/725 (68.6897%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 43.9652, Accuracy: 1090/10000 (10.9000%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   1,  Average loss: 0.0049, Accuracy: 558/625 (89.2800%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   2,  Average loss: 0.0042, Accuracy: 575/625 (92.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.7916, Accuracy: 4146/10000 (41.4600%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   1,  Average loss: 0.0074, Accuracy: 186/217 (85.7143%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   2,  Average loss: 0.0012, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.1519, Accuracy: 3159/10000 (31.5900%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   1,  Average loss: 0.0074, Accuracy: 245/290 (84.4828%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   2,  Average loss: 0.0019, Accuracy: 280/290 (96.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.7525, Accuracy: 2987/10000 (29.8700%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 705/752 (93.7500%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   2,  Average loss: 0.0029, Accuracy: 704/752 (93.6170%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.8162, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   1,  Average loss: 0.0059, Accuracy: 332/378 (87.8307%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   2,  Average loss: 0.0019, Accuracy: 364/378 (96.2963%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 3.7133, Accuracy: 3250/10000 (32.5000%)
time spent on training: 123.27585077285767
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4122392758756395  data num: [526, 527, 496, 546, 725, 625, 217, 290, 752, 378]
[rfa agg] considering poison per batch poison_fraction: 0.03220619342778434
[rfa agg] init. name: [17, 33, 77, 11, 37, 53, 39, 57, 63, 48], weight: tensor([0.1035, 0.1037, 0.0976, 0.1074, 0.1427, 0.1230, 0.0427, 0.0571, 0.1480,
        0.0744])
[rfa agg] iter:  0, prev_obj_val: 11365.931640625, obj_val: 11020.390625, abs dis: 345.541015625
[rfa agg] iter:  0, weight: tensor([0.0785, 0.0787, 0.0911, 0.0817, 0.1630, 0.1403, 0.0484, 0.0648, 0.1691,
        0.0845])
[rfa agg] iter:  1, prev_obj_val: 11020.390625, obj_val: 10714.623046875, abs dis: 305.767578125
[rfa agg] iter:  1, weight: tensor([0.0612, 0.0614, 0.0692, 0.0637, 0.1812, 0.1559, 0.0537, 0.0719, 0.1880,
        0.0938])
[rfa agg] iter:  2, prev_obj_val: 10714.623046875, obj_val: 10457.08203125, abs dis: 257.541015625
[rfa agg] iter:  2, weight: tensor([0.0464, 0.0466, 0.0515, 0.0483, 0.1966, 0.1690, 0.0582, 0.0778, 0.2040,
        0.1016])
[rfa agg] iter:  3, prev_obj_val: 10457.08203125, obj_val: 10250.8125, abs dis: 206.26953125
[rfa agg] iter:  3, weight: tensor([0.0344, 0.0345, 0.0377, 0.0358, 0.2092, 0.1796, 0.0616, 0.0825, 0.2169,
        0.1078])
[rfa agg] iter:  4, prev_obj_val: 10250.8125, obj_val: 10090.251953125, abs dis: 160.560546875
[rfa agg] iter:  4, weight: tensor([0.0251, 0.0251, 0.0272, 0.0261, 0.2190, 0.1878, 0.0642, 0.0860, 0.2272,
        0.1124])
[rfa agg] iter:  5, prev_obj_val: 10090.251953125, obj_val: 9968.28125, abs dis: 121.970703125
[rfa agg] iter:  5, weight: tensor([0.0180, 0.0180, 0.0194, 0.0187, 0.2268, 0.1940, 0.0659, 0.0884, 0.2352,
        0.1156])
[rfa agg] iter:  6, prev_obj_val: 9968.28125, obj_val: 9879.373046875, abs dis: 88.908203125
[rfa agg] iter:  6, weight: tensor([0.0127, 0.0127, 0.0136, 0.0132, 0.2330, 0.1988, 0.0669, 0.0899, 0.2417,
        0.1177])
[rfa agg] iter:  7, prev_obj_val: 9879.373046875, obj_val: 9814.083984375, abs dis: 65.2890625
[rfa agg] iter:  7, weight: tensor([0.0088, 0.0089, 0.0095, 0.0092, 0.2381, 0.2022, 0.0672, 0.0904, 0.2470,
        0.1187])
[rfa agg] iter:  8, prev_obj_val: 9814.083984375, obj_val: 9768.470703125, abs dis: 45.61328125
[rfa agg] iter:  8, weight: tensor([0.0061, 0.0061, 0.0065, 0.0063, 0.2428, 0.2048, 0.0667, 0.0901, 0.2519,
        0.1187])
[rfa agg] iter:  9, prev_obj_val: 9768.470703125, obj_val: 9736.24609375, abs dis: 32.224609375
[rfa agg] iter:  9, weight: tensor([0.0041, 0.0041, 0.0044, 0.0043, 0.2476, 0.2067, 0.0655, 0.0888, 0.2569,
        0.1175])
___Test Target_ResNet_18 poisoned: False, epoch: 201: Average loss: 0.7323, Accuracy: 7551/10000 (75.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 201: Average loss: 4.7357, Accuracy: 378/9000 (4.2000%)
Done in 158.9363067150116 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:202 choose agents : [17, 33, 77, 11, 63, 50, 39, 72, 88, 71]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   1,  Average loss: 0.0110, Accuracy: 471/526 (89.5437%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   2,  Average loss: 0.0092, Accuracy: 464/526 (88.2129%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   3,  Average loss: 0.0063, Accuracy: 487/526 (92.5856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   4,  Average loss: 0.0038, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   5,  Average loss: 0.0037, Accuracy: 493/526 (93.7262%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   6,  Average loss: 0.0027, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Global model norm: 37.60595058672563.
Norm before scaling: 38.20312180470334. Distance: 8.48970799890893
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.6244, Accuracy: 5249/10000 (52.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.6403, Accuracy: 7101/9000 (78.9000%)
Scaling by  100
Scaled Norm after poisoning: 848.2246533200978, distance: 848.9707371282004
Total norm for 4 adversaries is: 848.2246533200978. distance: 848.9707371282004
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   1,  Average loss: 0.0077, Accuracy: 473/527 (89.7533%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   2,  Average loss: 0.0070, Accuracy: 476/527 (90.3226%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   3,  Average loss: 0.0046, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   4,  Average loss: 0.0055, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   5,  Average loss: 0.0057, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   6,  Average loss: 0.0037, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Global model norm: 37.60595058672563.
Norm before scaling: 38.063502206120134. Distance: 7.863528661346158
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.5815, Accuracy: 5136/10000 (51.3600%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.2815, Accuracy: 8054/9000 (89.4889%)
Scaling by  100
Scaled Norm after poisoning: 785.5212839255216, distance: 786.3528152171899
Total norm for 4 adversaries is: 785.5212839255216. distance: 786.3528152171899
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   1,  Average loss: 0.0048, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   2,  Average loss: 0.0046, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   3,  Average loss: 0.0035, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   4,  Average loss: 0.0018, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   5,  Average loss: 0.0013, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   6,  Average loss: 0.0012, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.60595058672563.
Norm before scaling: 37.59712844597061. Distance: 4.77281631948128
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 0.9262, Accuracy: 6961/10000 (69.6100%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.2461, Accuracy: 8437/9000 (93.7444%)
Scaling by  100
Scaled Norm after poisoning: 476.3061974717524, distance: 477.28160908943477
Total norm for 4 adversaries is: 476.3061974717524. distance: 477.28160908943477
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   1,  Average loss: 0.0041, Accuracy: 512/546 (93.7729%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   2,  Average loss: 0.0039, Accuracy: 521/546 (95.4212%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   3,  Average loss: 0.0019, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   4,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.60595058672563.
Norm before scaling: 37.64704406401401. Distance: 5.2584364182191194
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.2490, Accuracy: 6155/10000 (61.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.1114, Accuracy: 8739/9000 (97.1000%)
Scaling by  100
Scaled Norm after poisoning: 524.8522411117247, distance: 525.8436079292017
Total norm for 4 adversaries is: 524.8522411117247. distance: 525.8436079292017
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 202, local model 63, internal_epoch   1,  Average loss: 0.0016, Accuracy: 734/752 (97.6064%)
___Train Local_ResNet_18,  epoch 202, local model 63, internal_epoch   2,  Average loss: 0.0008, Accuracy: 746/752 (99.2021%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.0928, Accuracy: 6727/10000 (67.2700%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   1,  Average loss: 0.0029, Accuracy: 383/401 (95.5112%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   2,  Average loss: 0.0017, Accuracy: 390/401 (97.2569%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.9589, Accuracy: 4123/10000 (41.2300%)
___Train Local_ResNet_18,  epoch 202, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 193/217 (88.9401%)
___Train Local_ResNet_18,  epoch 202, local model 39, internal_epoch   2,  Average loss: 0.0011, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 3.1380, Accuracy: 3704/10000 (37.0400%)
___Train Local_ResNet_18,  epoch 202, local model 72, internal_epoch   1,  Average loss: 0.0094, Accuracy: 506/618 (81.8770%)
___Train Local_ResNet_18,  epoch 202, local model 72, internal_epoch   2,  Average loss: 0.0069, Accuracy: 533/618 (86.2460%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 7.1848, Accuracy: 2464/10000 (24.6400%)
___Train Local_ResNet_18,  epoch 202, local model 88, internal_epoch   1,  Average loss: 0.0077, Accuracy: 375/447 (83.8926%)
___Train Local_ResNet_18,  epoch 202, local model 88, internal_epoch   2,  Average loss: 0.0038, Accuracy: 413/447 (92.3937%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 4.8430, Accuracy: 2792/10000 (27.9200%)
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 1064/1166 (91.2521%)
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   2,  Average loss: 0.0111, Accuracy: 916/1166 (78.5592%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 5.0080, Accuracy: 3124/10000 (31.2400%)
time spent on training: 139.9766685962677
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.36780196629213485  data num: [526, 527, 496, 546, 752, 401, 217, 618, 447, 1166]
[rfa agg] considering poison per batch poison_fraction: 0.028734528616573034
[rfa agg] init. name: [17, 33, 77, 11, 63, 50, 39, 72, 88, 71], weight: tensor([0.0923, 0.0925, 0.0871, 0.0959, 0.1320, 0.0704, 0.0381, 0.1085, 0.0785,
        0.2047])
[rfa agg] iter:  0, prev_obj_val: 10884.646484375, obj_val: 10168.4111328125, abs dis: 716.2353515625
[rfa agg] iter:  0, weight: tensor([0.0605, 0.0606, 0.0691, 0.0629, 0.1559, 0.0827, 0.0446, 0.1279, 0.0922,
        0.2435])
[rfa agg] iter:  1, prev_obj_val: 10168.4111328125, obj_val: 9618.068359375, abs dis: 550.3427734375
[rfa agg] iter:  1, weight: tensor([0.0395, 0.0396, 0.0437, 0.0410, 0.1745, 0.0924, 0.0498, 0.1430, 0.1030,
        0.2735])
[rfa agg] iter:  2, prev_obj_val: 9618.068359375, obj_val: 9235.841796875, abs dis: 382.2265625
[rfa agg] iter:  2, weight: tensor([0.0246, 0.0247, 0.0268, 0.0256, 0.1875, 0.0988, 0.0531, 0.1533, 0.1101,
        0.2955])
[rfa agg] iter:  3, prev_obj_val: 9235.841796875, obj_val: 8984.994140625, abs dis: 250.84765625
[rfa agg] iter:  3, weight: tensor([0.0149, 0.0149, 0.0160, 0.0154, 0.1958, 0.1025, 0.0548, 0.1597, 0.1142,
        0.3118])
[rfa agg] iter:  4, prev_obj_val: 8984.994140625, obj_val: 8828.8271484375, abs dis: 156.1669921875
[rfa agg] iter:  4, weight: tensor([0.0087, 0.0088, 0.0093, 0.0091, 0.2008, 0.1038, 0.0551, 0.1629, 0.1157,
        0.3258])
[rfa agg] iter:  5, prev_obj_val: 8828.8271484375, obj_val: 8735.396484375, abs dis: 93.4306640625
[rfa agg] iter:  5, weight: tensor([0.0050, 0.0050, 0.0053, 0.0052, 0.2033, 0.1028, 0.0540, 0.1635, 0.1146,
        0.3413])
[rfa agg] iter:  6, prev_obj_val: 8735.396484375, obj_val: 8679.8740234375, abs dis: 55.5224609375
[rfa agg] iter:  6, weight: tensor([0.0028, 0.0028, 0.0030, 0.0029, 0.2034, 0.0989, 0.0509, 0.1609, 0.1103,
        0.3642])
[rfa agg] iter:  7, prev_obj_val: 8679.8740234375, obj_val: 8649.3125, abs dis: 30.5615234375
[rfa agg] iter:  7, weight: tensor([0.0015, 0.0015, 0.0016, 0.0015, 0.1986, 0.0901, 0.0448, 0.1524, 0.1005,
        0.4075])
[rfa agg] iter:  8, prev_obj_val: 8649.3125, obj_val: 8632.595703125, abs dis: 16.716796875
[rfa agg] iter:  8, weight: tensor([0.0007, 0.0007, 0.0008, 0.0008, 0.1791, 0.0723, 0.0341, 0.1302, 0.0806,
        0.5007])
[rfa agg] iter:  9, prev_obj_val: 8632.595703125, obj_val: 8631.921875, abs dis: 0.673828125
[rfa agg] iter:  9, weight: tensor([2.0037e-04, 2.0077e-04, 2.1286e-04, 2.0809e-04, 9.4743e-02, 3.1350e-02,
        1.3813e-02, 6.2176e-02, 3.4901e-02, 7.6220e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 202: Average loss: 0.8073, Accuracy: 7347/10000 (73.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 202: Average loss: 4.2498, Accuracy: 439/9000 (4.8778%)
Done in 175.672119140625 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:203 choose agents : [17, 33, 77, 11, 92, 23, 26, 50, 14, 76]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   1,  Average loss: 0.0089, Accuracy: 473/526 (89.9240%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   2,  Average loss: 0.0103, Accuracy: 468/526 (88.9734%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   3,  Average loss: 0.0069, Accuracy: 475/526 (90.3042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   4,  Average loss: 0.0048, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   5,  Average loss: 0.0038, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   6,  Average loss: 0.0021, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Global model norm: 37.62455551543932.
Norm before scaling: 38.189430699965925. Distance: 8.270820470330705
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.7431, Accuracy: 5060/10000 (50.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.5328, Accuracy: 7469/9000 (82.9889%)
Scaling by  100
Scaled Norm after poisoning: 826.3911377186955, distance: 827.0821830386627
Total norm for 4 adversaries is: 826.3911377186955. distance: 827.0821830386627
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   1,  Average loss: 0.0100, Accuracy: 469/527 (88.9943%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   2,  Average loss: 0.0085, Accuracy: 465/527 (88.2353%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   3,  Average loss: 0.0054, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   4,  Average loss: 0.0029, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   5,  Average loss: 0.0027, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   6,  Average loss: 0.0023, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.62455551543932.
Norm before scaling: 38.26313665857943. Distance: 8.500880027542783
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.5542, Accuracy: 5161/10000 (51.6100%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.3032, Accuracy: 8212/9000 (91.2444%)
Scaling by  100
Scaled Norm after poisoning: 849.5202690342355, distance: 850.0880469104362
Total norm for 4 adversaries is: 849.5202690342355. distance: 850.0880469104362
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   1,  Average loss: 0.0051, Accuracy: 461/496 (92.9435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 466/496 (93.9516%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   3,  Average loss: 0.0026, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   4,  Average loss: 0.0022, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   5,  Average loss: 0.0010, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   6,  Average loss: 0.0013, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Global model norm: 37.62455551543932.
Norm before scaling: 37.626041435960616. Distance: 4.835994492104094
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 0.9900, Accuracy: 6733/10000 (67.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.1461, Accuracy: 8641/9000 (96.0111%)
Scaling by  100
Scaled Norm after poisoning: 482.6557229278443, distance: 483.5994436256105
Total norm for 4 adversaries is: 482.6557229278443. distance: 483.5994436256105
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   1,  Average loss: 0.0051, Accuracy: 509/546 (93.2234%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   2,  Average loss: 0.0044, Accuracy: 518/546 (94.8718%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   3,  Average loss: 0.0015, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   4,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   5,  Average loss: 0.0024, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   6,  Average loss: 0.0013, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.62455551543932.
Norm before scaling: 37.634041038956674. Distance: 5.211626136035807
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.2384, Accuracy: 6230/10000 (62.3000%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.0828, Accuracy: 8777/9000 (97.5222%)
Scaling by  100
Scaled Norm after poisoning: 519.982060988646, distance: 521.1626725409255
Total norm for 4 adversaries is: 519.982060988646. distance: 521.1626725409255
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 203, local model 92, internal_epoch   1,  Average loss: 0.0062, Accuracy: 702/796 (88.1910%)
___Train Local_ResNet_18,  epoch 203, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 715/796 (89.8241%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 9.9823, Accuracy: 2204/10000 (22.0400%)
___Train Local_ResNet_18,  epoch 203, local model 23, internal_epoch   1,  Average loss: 0.0049, Accuracy: 221/248 (89.1129%)
___Train Local_ResNet_18,  epoch 203, local model 23, internal_epoch   2,  Average loss: 0.0005, Accuracy: 248/248 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.9077, Accuracy: 4745/10000 (47.4500%)
___Train Local_ResNet_18,  epoch 203, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 438/468 (93.5897%)
___Train Local_ResNet_18,  epoch 203, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 438/468 (93.5897%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.9938, Accuracy: 4914/10000 (49.1400%)
___Train Local_ResNet_18,  epoch 203, local model 50, internal_epoch   1,  Average loss: 0.0033, Accuracy: 377/401 (94.0150%)
___Train Local_ResNet_18,  epoch 203, local model 50, internal_epoch   2,  Average loss: 0.0018, Accuracy: 388/401 (96.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.0261, Accuracy: 4958/10000 (49.5800%)
___Train Local_ResNet_18,  epoch 203, local model 14, internal_epoch   1,  Average loss: 0.0068, Accuracy: 271/318 (85.2201%)
___Train Local_ResNet_18,  epoch 203, local model 14, internal_epoch   2,  Average loss: 0.0016, Accuracy: 308/318 (96.8553%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 7.1201, Accuracy: 2287/10000 (22.8700%)
___Train Local_ResNet_18,  epoch 203, local model 76, internal_epoch   1,  Average loss: 0.0341, Accuracy: 62/65 (95.3846%)
___Train Local_ResNet_18,  epoch 203, local model 76, internal_epoch   2,  Average loss: 0.0406, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.0392, Accuracy: 6749/10000 (67.4900%)
time spent on training: 135.7242510318756
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.47711227510817583  data num: [526, 527, 496, 546, 796, 248, 468, 401, 318, 65]
[rfa agg] considering poison per batch poison_fraction: 0.03727439649282624
[rfa agg] init. name: [17, 33, 77, 11, 92, 23, 26, 50, 14, 76], weight: tensor([0.1198, 0.1200, 0.1130, 0.1243, 0.1813, 0.0565, 0.1066, 0.0913, 0.0724,
        0.0148])
[rfa agg] iter:  0, prev_obj_val: 11703.3544921875, obj_val: 11677.4189453125, abs dis: 25.935546875
[rfa agg] iter:  0, weight: tensor([0.1076, 0.1078, 0.1282, 0.1119, 0.1894, 0.0586, 0.1109, 0.0950, 0.0752,
        0.0153])
[rfa agg] iter:  1, prev_obj_val: 11677.4189453125, obj_val: 11651.7275390625, abs dis: 25.69140625
[rfa agg] iter:  1, weight: tensor([0.1023, 0.1025, 0.1206, 0.1063, 0.1978, 0.0611, 0.1158, 0.0991, 0.0785,
        0.0160])
[rfa agg] iter:  2, prev_obj_val: 11651.7275390625, obj_val: 11626.26953125, abs dis: 25.4580078125
[rfa agg] iter:  2, weight: tensor([0.0970, 0.0972, 0.1132, 0.1008, 0.2060, 0.0637, 0.1206, 0.1032, 0.0817,
        0.0167])
[rfa agg] iter:  3, prev_obj_val: 11626.26953125, obj_val: 11601.65625, abs dis: 24.61328125
[rfa agg] iter:  3, weight: tensor([0.0917, 0.0919, 0.1061, 0.0953, 0.2141, 0.0662, 0.1253, 0.1073, 0.0849,
        0.0173])
[rfa agg] iter:  4, prev_obj_val: 11601.65625, obj_val: 11577.2685546875, abs dis: 24.3876953125
[rfa agg] iter:  4, weight: tensor([0.0866, 0.0867, 0.0993, 0.0899, 0.2220, 0.0685, 0.1299, 0.1112, 0.0880,
        0.0179])
[rfa agg] iter:  5, prev_obj_val: 11577.2685546875, obj_val: 11553.3095703125, abs dis: 23.958984375
[rfa agg] iter:  5, weight: tensor([0.0814, 0.0816, 0.0928, 0.0846, 0.2297, 0.0709, 0.1344, 0.1150, 0.0910,
        0.0185])
[rfa agg] iter:  6, prev_obj_val: 11553.3095703125, obj_val: 11530.3955078125, abs dis: 22.9140625
[rfa agg] iter:  6, weight: tensor([0.0764, 0.0766, 0.0865, 0.0794, 0.2373, 0.0732, 0.1388, 0.1188, 0.0940,
        0.0191])
[rfa agg] iter:  7, prev_obj_val: 11530.3955078125, obj_val: 11508.111328125, abs dis: 22.2841796875
[rfa agg] iter:  7, weight: tensor([0.0716, 0.0717, 0.0805, 0.0744, 0.2446, 0.0754, 0.1429, 0.1223, 0.0968,
        0.0197])
[rfa agg] iter:  8, prev_obj_val: 11508.111328125, obj_val: 11486.6611328125, abs dis: 21.4501953125
[rfa agg] iter:  8, weight: tensor([0.0669, 0.0670, 0.0749, 0.0695, 0.2516, 0.0775, 0.1470, 0.1258, 0.0995,
        0.0203])
[rfa agg] iter:  9, prev_obj_val: 11486.6611328125, obj_val: 11466.044921875, abs dis: 20.6162109375
[rfa agg] iter:  9, weight: tensor([0.0624, 0.0625, 0.0695, 0.0648, 0.2584, 0.0795, 0.1509, 0.1291, 0.1021,
        0.0208])
___Test Target_ResNet_18 poisoned: False, epoch: 203: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 171.67441129684448 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:204 choose agents : [17, 33, 77, 11, 49, 86, 26, 58, 6, 94]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   1,  Average loss: 0.0112, Accuracy: 420/526 (79.8479%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 489/526 (92.9658%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   3,  Average loss: 0.0030, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   4,  Average loss: 0.0021, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   5,  Average loss: 0.0016, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   6,  Average loss: 0.0013, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Global model norm: 37.97631579713121.
Norm before scaling: 38.34209609564679. Distance: 7.050324333792731
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.8304, Accuracy: 4971/10000 (49.7100%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.2347, Accuracy: 8227/9000 (91.4111%)
Scaling by  100
Scaled Norm after poisoning: 704.5095368410565, distance: 705.0323574134736
Total norm for 4 adversaries is: 704.5095368410565. distance: 705.0323574134736
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   1,  Average loss: 0.0093, Accuracy: 446/527 (84.6300%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   2,  Average loss: 0.0034, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   3,  Average loss: 0.0043, Accuracy: 491/527 (93.1689%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   4,  Average loss: 0.0066, Accuracy: 481/527 (91.2713%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   5,  Average loss: 0.0056, Accuracy: 491/527 (93.1689%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   6,  Average loss: 0.0032, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Global model norm: 37.97631579713121.
Norm before scaling: 39.04871006592279. Distance: 9.888384283480946
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 2.2422, Accuracy: 3916/10000 (39.1600%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.1296, Accuracy: 8621/9000 (95.7889%)
Scaling by  100
Scaled Norm after poisoning: 988.800156755651, distance: 988.8385232180227
Total norm for 4 adversaries is: 988.800156755651. distance: 988.8385232180227
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   1,  Average loss: 0.0140, Accuracy: 350/496 (70.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 462/496 (93.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   3,  Average loss: 0.0014, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   4,  Average loss: 0.0010, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.97631579713121.
Norm before scaling: 38.221814510723945. Distance: 6.220506889565734
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.1790, Accuracy: 6415/10000 (64.1500%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.1332, Accuracy: 8642/9000 (96.0222%)
Scaling by  100
Scaled Norm after poisoning: 621.6031692325901, distance: 622.0507917364948
Total norm for 4 adversaries is: 621.6031692325901. distance: 622.0507917364948
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   1,  Average loss: 0.0123, Accuracy: 422/546 (77.2894%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   2,  Average loss: 0.0027, Accuracy: 522/546 (95.6044%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   3,  Average loss: 0.0026, Accuracy: 527/546 (96.5201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.97631579713121.
Norm before scaling: 38.431247903622484. Distance: 7.487006566978847
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.7211, Accuracy: 5272/10000 (52.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.0951, Accuracy: 8751/9000 (97.2333%)
Scaling by  100
Scaled Norm after poisoning: 748.2415218363653, distance: 748.7006661543718
Total norm for 4 adversaries is: 748.2415218363653. distance: 748.7006661543718
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 204, local model 49, internal_epoch   1,  Average loss: 0.0384, Accuracy: 231/426 (54.2254%)
___Train Local_ResNet_18,  epoch 204, local model 49, internal_epoch   2,  Average loss: 0.0096, Accuracy: 354/426 (83.0986%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 11.9897, Accuracy: 2183/10000 (21.8300%)
___Train Local_ResNet_18,  epoch 204, local model 86, internal_epoch   1,  Average loss: 0.0477, Accuracy: 97/212 (45.7547%)
___Train Local_ResNet_18,  epoch 204, local model 86, internal_epoch   2,  Average loss: 0.0119, Accuracy: 167/212 (78.7736%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 12.7663, Accuracy: 1261/10000 (12.6100%)
___Train Local_ResNet_18,  epoch 204, local model 26, internal_epoch   1,  Average loss: 0.0293, Accuracy: 252/468 (53.8462%)
___Train Local_ResNet_18,  epoch 204, local model 26, internal_epoch   2,  Average loss: 0.0119, Accuracy: 360/468 (76.9231%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 2.7165, Accuracy: 3543/10000 (35.4300%)
___Train Local_ResNet_18,  epoch 204, local model 58, internal_epoch   1,  Average loss: 0.0617, Accuracy: 65/234 (27.7778%)
___Train Local_ResNet_18,  epoch 204, local model 58, internal_epoch   2,  Average loss: 0.0089, Accuracy: 199/234 (85.0427%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 28.4048, Accuracy: 1001/10000 (10.0100%)
___Train Local_ResNet_18,  epoch 204, local model 6, internal_epoch   1,  Average loss: 0.0321, Accuracy: 303/520 (58.2692%)
___Train Local_ResNet_18,  epoch 204, local model 6, internal_epoch   2,  Average loss: 0.0147, Accuracy: 359/520 (69.0385%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 5.0526, Accuracy: 2349/10000 (23.4900%)
___Train Local_ResNet_18,  epoch 204, local model 94, internal_epoch   1,  Average loss: 0.0427, Accuracy: 100/203 (49.2611%)
___Train Local_ResNet_18,  epoch 204, local model 94, internal_epoch   2,  Average loss: 0.0114, Accuracy: 155/203 (76.3547%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 6.9755, Accuracy: 2213/10000 (22.1300%)
time spent on training: 136.61556220054626
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.5038480038480039  data num: [526, 527, 496, 546, 426, 212, 468, 234, 520, 203]
[rfa agg] considering poison per batch poison_fraction: 0.0393631253006253
[rfa agg] init. name: [17, 33, 77, 11, 49, 86, 26, 58, 6, 94], weight: tensor([0.1265, 0.1267, 0.1193, 0.1313, 0.1025, 0.0510, 0.1126, 0.0563, 0.1251,
        0.0488])
[rfa agg] iter:  0, prev_obj_val: 11741.4189453125, obj_val: 11741.0087890625, abs dis: 0.41015625
[rfa agg] iter:  0, weight: tensor([0.1200, 0.1201, 0.1447, 0.1245, 0.1014, 0.0503, 0.1114, 0.0555, 0.1239,
        0.0482])
[rfa agg] iter:  1, prev_obj_val: 11741.0087890625, obj_val: 11740.615234375, abs dis: 0.3935546875
[rfa agg] iter:  1, weight: tensor([0.1205, 0.1206, 0.1455, 0.1251, 0.1008, 0.0501, 0.1109, 0.0553, 0.1233,
        0.0479])
[rfa agg] iter:  2, prev_obj_val: 11740.615234375, obj_val: 11740.2216796875, abs dis: 0.3935546875
[rfa agg] iter:  2, weight: tensor([0.1211, 0.1211, 0.1464, 0.1257, 0.1003, 0.0498, 0.1103, 0.0550, 0.1226,
        0.0477])
[rfa agg] iter:  3, prev_obj_val: 11740.2216796875, obj_val: 11739.8271484375, abs dis: 0.39453125
[rfa agg] iter:  3, weight: tensor([0.1216, 0.1217, 0.1472, 0.1262, 0.0998, 0.0496, 0.1097, 0.0547, 0.1220,
        0.0475])
[rfa agg] iter:  4, prev_obj_val: 11739.8271484375, obj_val: 11739.46484375, abs dis: 0.3623046875
[rfa agg] iter:  4, weight: tensor([0.1222, 0.1222, 0.1481, 0.1268, 0.0993, 0.0493, 0.1092, 0.0544, 0.1214,
        0.0472])
[rfa agg] iter:  5, prev_obj_val: 11739.46484375, obj_val: 11739.0751953125, abs dis: 0.3896484375
[rfa agg] iter:  5, weight: tensor([0.1227, 0.1227, 0.1489, 0.1273, 0.0988, 0.0491, 0.1086, 0.0542, 0.1208,
        0.0470])
[rfa agg] iter:  6, prev_obj_val: 11739.0751953125, obj_val: 11738.6826171875, abs dis: 0.392578125
[rfa agg] iter:  6, weight: tensor([0.1232, 0.1233, 0.1497, 0.1279, 0.0983, 0.0488, 0.1081, 0.0539, 0.1202,
        0.0467])
[rfa agg] iter:  7, prev_obj_val: 11738.6826171875, obj_val: 11738.291015625, abs dis: 0.3916015625
[rfa agg] iter:  7, weight: tensor([0.1237, 0.1238, 0.1506, 0.1284, 0.0978, 0.0486, 0.1075, 0.0536, 0.1195,
        0.0465])
[rfa agg] iter:  8, prev_obj_val: 11738.291015625, obj_val: 11737.87109375, abs dis: 0.419921875
[rfa agg] iter:  8, weight: tensor([0.1243, 0.1243, 0.1515, 0.1290, 0.0973, 0.0483, 0.1069, 0.0533, 0.1189,
        0.0462])
[rfa agg] iter:  9, prev_obj_val: 11737.87109375, obj_val: 11737.4814453125, abs dis: 0.3896484375
[rfa agg] iter:  9, weight: tensor([0.1249, 0.1249, 0.1524, 0.1296, 0.0967, 0.0480, 0.1063, 0.0530, 0.1182,
        0.0460])
___Test Target_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 172.01305985450745 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:205 choose agents : [17, 33, 77, 11, 61, 71, 8, 69, 89, 64]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   1,  Average loss: 0.0588, Accuracy: 222/526 (42.2053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   2,  Average loss: 0.0238, Accuracy: 298/526 (56.6540%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   3,  Average loss: 0.0187, Accuracy: 343/526 (65.2091%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   4,  Average loss: 0.0152, Accuracy: 395/526 (75.0951%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   5,  Average loss: 0.0127, Accuracy: 427/526 (81.1787%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   6,  Average loss: 0.0107, Accuracy: 443/526 (84.2205%), train_poison_data_count: 45
Global model norm: 43.64152987559914.
Norm before scaling: 44.52447591020163. Distance: 12.113169768311575
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.2370, Accuracy: 3523/10000 (35.2300%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 1.5418, Accuracy: 2699/9000 (29.9889%)
Scaling by  100
Scaled Norm after poisoning: 1209.2579852951148, distance: 1211.3168454207182
Total norm for 4 adversaries is: 1209.2579852951148. distance: 1211.3168454207182
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   1,  Average loss: 0.0629, Accuracy: 179/527 (33.9658%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   2,  Average loss: 0.0264, Accuracy: 271/527 (51.4231%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   3,  Average loss: 0.0207, Accuracy: 329/527 (62.4288%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   4,  Average loss: 0.0153, Accuracy: 391/527 (74.1935%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   5,  Average loss: 0.0105, Accuracy: 430/527 (81.5939%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   6,  Average loss: 0.0081, Accuracy: 453/527 (85.9583%), train_poison_data_count: 45
Global model norm: 43.64152987559914.
Norm before scaling: 44.2295219322068. Distance: 11.19882225928768
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.4834, Accuracy: 2737/10000 (27.3700%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.2742, Accuracy: 8288/9000 (92.0889%)
Scaling by  100
Scaled Norm after poisoning: 1117.4373024917327, distance: 1119.8821366554607
Total norm for 4 adversaries is: 1117.4373024917327. distance: 1119.8821366554607
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   1,  Average loss: 0.0654, Accuracy: 158/496 (31.8548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   2,  Average loss: 0.0284, Accuracy: 233/496 (46.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   3,  Average loss: 0.0229, Accuracy: 241/496 (48.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   4,  Average loss: 0.0186, Accuracy: 313/496 (63.1048%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   5,  Average loss: 0.0137, Accuracy: 376/496 (75.8065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   6,  Average loss: 0.0102, Accuracy: 406/496 (81.8548%), train_poison_data_count: 40
Global model norm: 43.64152987559914.
Norm before scaling: 44.21322155148771. Distance: 11.098623489396106
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.0878, Accuracy: 3104/10000 (31.0400%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 1.6893, Accuracy: 2832/9000 (31.4667%)
Scaling by  100
Scaled Norm after poisoning: 1107.43109266446, distance: 1109.8623225427557
Total norm for 4 adversaries is: 1107.43109266446. distance: 1109.8623225427557
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   1,  Average loss: 0.0516, Accuracy: 218/546 (39.9267%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   2,  Average loss: 0.0248, Accuracy: 279/546 (51.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   3,  Average loss: 0.0179, Accuracy: 346/546 (63.3700%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   4,  Average loss: 0.0112, Accuracy: 435/546 (79.6703%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   5,  Average loss: 0.0068, Accuracy: 483/546 (88.4615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   6,  Average loss: 0.0032, Accuracy: 526/546 (96.3370%), train_poison_data_count: 45
Global model norm: 43.64152987559914.
Norm before scaling: 44.27495737531474. Distance: 10.728742651600761
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.9174, Accuracy: 3772/10000 (37.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.1836, Accuracy: 8346/9000 (92.7333%)
Scaling by  100
Scaled Norm after poisoning: 1070.9911881056726, distance: 1072.8742936616572
Total norm for 4 adversaries is: 1070.9911881056726. distance: 1072.8742936616572
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 205, local model 61, internal_epoch   1,  Average loss: 0.0366, Accuracy: 315/590 (53.3898%)
___Train Local_ResNet_18,  epoch 205, local model 61, internal_epoch   2,  Average loss: 0.0163, Accuracy: 395/590 (66.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 71, internal_epoch   1,  Average loss: 0.0291, Accuracy: 644/1166 (55.2316%)
___Train Local_ResNet_18,  epoch 205, local model 71, internal_epoch   2,  Average loss: 0.0149, Accuracy: 798/1166 (68.4391%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.9689, Accuracy: 2518/10000 (25.1800%)
___Train Local_ResNet_18,  epoch 205, local model 8, internal_epoch   1,  Average loss: 0.0508, Accuracy: 204/534 (38.2022%)
___Train Local_ResNet_18,  epoch 205, local model 8, internal_epoch   2,  Average loss: 0.0288, Accuracy: 259/534 (48.5019%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 69, internal_epoch   1,  Average loss: 0.0373, Accuracy: 108/216 (50.0000%)
___Train Local_ResNet_18,  epoch 205, local model 69, internal_epoch   2,  Average loss: 0.0209, Accuracy: 160/216 (74.0741%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 89, internal_epoch   1,  Average loss: 0.0564, Accuracy: 153/413 (37.0460%)
___Train Local_ResNet_18,  epoch 205, local model 89, internal_epoch   2,  Average loss: 0.0177, Accuracy: 280/413 (67.7966%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 64, internal_epoch   1,  Average loss: 0.0396, Accuracy: 293/686 (42.7114%)
___Train Local_ResNet_18,  epoch 205, local model 64, internal_epoch   2,  Average loss: 0.0197, Accuracy: 383/686 (55.8309%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 139.2375361919403
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3675438596491228  data num: [526, 527, 496, 546, 590, 1166, 534, 216, 413, 686]
[rfa agg] considering poison per batch poison_fraction: 0.028714364035087717
[rfa agg] init. name: [17, 33, 77, 11, 61, 71, 8, 69, 89, 64], weight: tensor([0.0923, 0.0925, 0.0870, 0.0958, 0.1035, 0.2046, 0.0937, 0.0379, 0.0725,
        0.1204])
[rfa agg] iter:  0, prev_obj_val: 10964.4052734375, obj_val: 10234.9697265625, abs dis: 729.435546875
[rfa agg] iter:  0, weight: tensor([0.0602, 0.0606, 0.0686, 0.0627, 0.1221, 0.2436, 0.1104, 0.0444, 0.0852,
        0.1421])
[rfa agg] iter:  1, prev_obj_val: 10234.9697265625, obj_val: 9677.4462890625, abs dis: 557.5234375
[rfa agg] iter:  1, weight: tensor([0.0392, 0.0394, 0.0433, 0.0408, 0.1366, 0.2736, 0.1234, 0.0495, 0.0951,
        0.1590])
[rfa agg] iter:  2, prev_obj_val: 9677.4462890625, obj_val: 9290.0888671875, abs dis: 387.357421875
[rfa agg] iter:  2, weight: tensor([0.0244, 0.0245, 0.0265, 0.0254, 0.1464, 0.2956, 0.1322, 0.0528, 0.1017,
        0.1706])
[rfa agg] iter:  3, prev_obj_val: 9290.0888671875, obj_val: 9039.13671875, abs dis: 250.9521484375
[rfa agg] iter:  3, weight: tensor([0.0147, 0.0147, 0.0158, 0.0152, 0.1524, 0.3119, 0.1374, 0.0545, 0.1055,
        0.1779])
[rfa agg] iter:  4, prev_obj_val: 9039.13671875, obj_val: 8885.0390625, abs dis: 154.09765625
[rfa agg] iter:  4, weight: tensor([0.0086, 0.0086, 0.0092, 0.0089, 0.1555, 0.3258, 0.1398, 0.0548, 0.1068,
        0.1819])
[rfa agg] iter:  5, prev_obj_val: 8885.0390625, obj_val: 8789.6240234375, abs dis: 95.4150390625
[rfa agg] iter:  5, weight: tensor([0.0050, 0.0050, 0.0053, 0.0052, 0.1560, 0.3412, 0.1397, 0.0536, 0.1057,
        0.1834])
[rfa agg] iter:  6, prev_obj_val: 8789.6240234375, obj_val: 8734.91015625, abs dis: 54.7138671875
[rfa agg] iter:  6, weight: tensor([0.0027, 0.0028, 0.0029, 0.0029, 0.1535, 0.3650, 0.1364, 0.0504, 0.1016,
        0.1819])
[rfa agg] iter:  7, prev_obj_val: 8734.91015625, obj_val: 8702.1640625, abs dis: 32.74609375
[rfa agg] iter:  7, weight: tensor([0.0015, 0.0015, 0.0016, 0.0015, 0.1455, 0.4092, 0.1275, 0.0443, 0.0925,
        0.1751])
[rfa agg] iter:  8, prev_obj_val: 8702.1640625, obj_val: 8688.6123046875, abs dis: 13.5517578125
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0006, 0.0007, 0.0007, 0.1199, 0.5232, 0.1024, 0.0320, 0.0709,
        0.1490])
[rfa agg] iter:  9, prev_obj_val: 8688.6123046875, obj_val: 8688.9248046875, abs dis: 0.3125
[rfa agg] iter:  9, weight: tensor([2.1474e-04, 2.1550e-04, 2.2782e-04, 2.2323e-04, 7.2043e-02, 7.1861e-01,
        5.9082e-02, 1.5900e-02, 3.8216e-02, 9.5270e-02])
___Test Target_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 174.8401267528534 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:206 choose agents : [17, 33, 77, 11, 38, 64, 29, 23, 83, 43]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   1,  Average loss: 0.0433, Accuracy: 266/526 (50.5703%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   2,  Average loss: 0.0239, Accuracy: 298/526 (56.6540%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   3,  Average loss: 0.0175, Accuracy: 379/526 (72.0532%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   4,  Average loss: 0.0142, Accuracy: 397/526 (75.4753%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   5,  Average loss: 0.0117, Accuracy: 414/526 (78.7072%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   6,  Average loss: 0.0090, Accuracy: 453/526 (86.1217%), train_poison_data_count: 45
Global model norm: 43.5669468453078.
Norm before scaling: 43.86401020884391. Distance: 9.37501302082429
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.1332, Accuracy: 3706/10000 (37.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 1.3036, Accuracy: 3940/9000 (43.7778%)
Scaling by  100
Scaled Norm after poisoning: 935.2084326501766, distance: 937.5013333323852
Total norm for 4 adversaries is: 935.2084326501766. distance: 937.5013333323852
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   1,  Average loss: 0.0520, Accuracy: 202/527 (38.3302%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   2,  Average loss: 0.0263, Accuracy: 272/527 (51.6129%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   3,  Average loss: 0.0183, Accuracy: 366/527 (69.4497%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   4,  Average loss: 0.0137, Accuracy: 410/527 (77.7989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   5,  Average loss: 0.0102, Accuracy: 451/527 (85.5787%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   6,  Average loss: 0.0062, Accuracy: 488/527 (92.5996%), train_poison_data_count: 45
Global model norm: 43.5669468453078.
Norm before scaling: 43.7908751576206. Distance: 9.057042655717177
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.3764, Accuracy: 3402/10000 (34.0200%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.5041, Accuracy: 7437/9000 (82.6333%)
Scaling by  100
Scaled Norm after poisoning: 903.3002338646879, distance: 905.7042149620371
Total norm for 4 adversaries is: 903.3002338646879. distance: 905.7042149620371
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   1,  Average loss: 0.0478, Accuracy: 192/496 (38.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   2,  Average loss: 0.0236, Accuracy: 269/496 (54.2339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   3,  Average loss: 0.0187, Accuracy: 305/496 (61.4919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   4,  Average loss: 0.0134, Accuracy: 362/496 (72.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   5,  Average loss: 0.0088, Accuracy: 419/496 (84.4758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   6,  Average loss: 0.0051, Accuracy: 456/496 (91.9355%), train_poison_data_count: 40
Global model norm: 43.5669468453078.
Norm before scaling: 43.85730841007645. Distance: 8.963292604776866
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.4705, Accuracy: 2871/10000 (28.7100%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.0853, Accuracy: 8753/9000 (97.2556%)
Scaling by  100
Scaled Norm after poisoning: 894.3201328383477, distance: 896.3292154671742
Total norm for 4 adversaries is: 894.3201328383477. distance: 896.3292154671742
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   1,  Average loss: 0.0416, Accuracy: 250/546 (45.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   2,  Average loss: 0.0199, Accuracy: 338/546 (61.9048%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   3,  Average loss: 0.0131, Accuracy: 405/546 (74.1758%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   4,  Average loss: 0.0069, Accuracy: 487/546 (89.1941%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   5,  Average loss: 0.0036, Accuracy: 521/546 (95.4212%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   6,  Average loss: 0.0019, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Global model norm: 43.5669468453078.
Norm before scaling: 43.76846150661741. Distance: 8.256646917650889
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.1457, Accuracy: 3958/10000 (39.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.1570, Accuracy: 8469/9000 (94.1000%)
Scaling by  100
Scaled Norm after poisoning: 823.7493550832073, distance: 825.6646186557832
Total norm for 4 adversaries is: 823.7493550832073. distance: 825.6646186557832
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 206, local model 38, internal_epoch   1,  Average loss: 0.0247, Accuracy: 434/756 (57.4074%)
___Train Local_ResNet_18,  epoch 206, local model 38, internal_epoch   2,  Average loss: 0.0136, Accuracy: 537/756 (71.0317%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 64, internal_epoch   1,  Average loss: 0.0271, Accuracy: 352/686 (51.3120%)
___Train Local_ResNet_18,  epoch 206, local model 64, internal_epoch   2,  Average loss: 0.0138, Accuracy: 482/686 (70.2624%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 29, internal_epoch   1,  Average loss: 0.0196, Accuracy: 591/848 (69.6934%)
___Train Local_ResNet_18,  epoch 206, local model 29, internal_epoch   2,  Average loss: 0.0098, Accuracy: 682/848 (80.4245%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 23, internal_epoch   1,  Average loss: 0.0354, Accuracy: 119/248 (47.9839%)
___Train Local_ResNet_18,  epoch 206, local model 23, internal_epoch   2,  Average loss: 0.0125, Accuracy: 178/248 (71.7742%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 83, internal_epoch   1,  Average loss: 0.0409, Accuracy: 151/366 (41.2568%)
___Train Local_ResNet_18,  epoch 206, local model 83, internal_epoch   2,  Average loss: 0.0156, Accuracy: 255/366 (69.6721%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 43, internal_epoch   1,  Average loss: 0.0352, Accuracy: 172/345 (49.8551%)
___Train Local_ResNet_18,  epoch 206, local model 43, internal_epoch   2,  Average loss: 0.0179, Accuracy: 237/345 (68.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 135.71202445030212
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.39202844311377244  data num: [526, 527, 496, 546, 756, 686, 848, 248, 366, 345]
[rfa agg] considering poison per batch poison_fraction: 0.03062722211826347
[rfa agg] init. name: [17, 33, 77, 11, 38, 64, 29, 23, 83, 43], weight: tensor([0.0984, 0.0986, 0.0928, 0.1022, 0.1415, 0.1284, 0.1587, 0.0464, 0.0685,
        0.0646])
[rfa agg] iter:  0, prev_obj_val: 11205.7666015625, obj_val: 10699.357421875, abs dis: 506.4091796875
[rfa agg] iter:  0, weight: tensor([0.0700, 0.0703, 0.0805, 0.0729, 0.1646, 0.1492, 0.1850, 0.0536, 0.0792,
        0.0747])
[rfa agg] iter:  1, prev_obj_val: 10699.357421875, obj_val: 10276.84765625, abs dis: 422.509765625
[rfa agg] iter:  1, weight: tensor([0.0505, 0.0507, 0.0564, 0.0526, 0.1842, 0.1669, 0.2071, 0.0598, 0.0885,
        0.0834])
[rfa agg] iter:  2, prev_obj_val: 10276.84765625, obj_val: 9949.6728515625, abs dis: 327.1748046875
[rfa agg] iter:  2, weight: tensor([0.0351, 0.0352, 0.0385, 0.0365, 0.1994, 0.1806, 0.2245, 0.0645, 0.0955,
        0.0900])
[rfa agg] iter:  3, prev_obj_val: 9949.6728515625, obj_val: 9710.9091796875, abs dis: 238.763671875
[rfa agg] iter:  3, weight: tensor([0.0238, 0.0238, 0.0258, 0.0247, 0.2107, 0.1907, 0.2377, 0.0677, 0.1004,
        0.0947])
[rfa agg] iter:  4, prev_obj_val: 9710.9091796875, obj_val: 9543.0361328125, abs dis: 167.873046875
[rfa agg] iter:  4, weight: tensor([0.0158, 0.0158, 0.0170, 0.0164, 0.2189, 0.1979, 0.2475, 0.0696, 0.1035,
        0.0976])
[rfa agg] iter:  5, prev_obj_val: 9543.0361328125, obj_val: 9427.5888671875, abs dis: 115.447265625
[rfa agg] iter:  5, weight: tensor([0.0103, 0.0103, 0.0110, 0.0107, 0.2249, 0.2029, 0.2554, 0.0704, 0.1051,
        0.0991])
[rfa agg] iter:  6, prev_obj_val: 9427.5888671875, obj_val: 9349.9951171875, abs dis: 77.59375
[rfa agg] iter:  6, weight: tensor([0.0066, 0.0066, 0.0070, 0.0068, 0.2296, 0.2064, 0.2625, 0.0701, 0.1052,
        0.0992])
[rfa agg] iter:  7, prev_obj_val: 9349.9951171875, obj_val: 9300.5419921875, abs dis: 49.453125
[rfa agg] iter:  7, weight: tensor([0.0041, 0.0041, 0.0044, 0.0043, 0.2337, 0.2090, 0.2703, 0.0684, 0.1038,
        0.0978])
[rfa agg] iter:  8, prev_obj_val: 9300.5419921875, obj_val: 9266.673828125, abs dis: 33.8681640625
[rfa agg] iter:  8, weight: tensor([0.0026, 0.0026, 0.0027, 0.0027, 0.2378, 0.2107, 0.2805, 0.0653, 0.1005,
        0.0947])
[rfa agg] iter:  9, prev_obj_val: 9266.673828125, obj_val: 9246.427734375, abs dis: 20.24609375
[rfa agg] iter:  9, weight: tensor([0.0015, 0.0015, 0.0016, 0.0016, 0.2429, 0.2115, 0.2978, 0.0595, 0.0938,
        0.0884])
___Test Target_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 171.8714427947998 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:207 choose agents : [17, 33, 77, 11, 56, 45, 1, 50, 16, 12]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   1,  Average loss: 0.0360, Accuracy: 293/526 (55.7034%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   2,  Average loss: 0.0192, Accuracy: 374/526 (71.1027%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   3,  Average loss: 0.0171, Accuracy: 376/526 (71.4829%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   4,  Average loss: 0.0132, Accuracy: 419/526 (79.6578%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   5,  Average loss: 0.0106, Accuracy: 447/526 (84.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   6,  Average loss: 0.0084, Accuracy: 463/526 (88.0228%), train_poison_data_count: 45
Global model norm: 43.48832458258193.
Norm before scaling: 43.811113844423794. Distance: 9.151828570647695
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.2026, Accuracy: 3944/10000 (39.4400%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.9683, Accuracy: 5078/9000 (56.4222%)
Scaling by  100
Scaled Norm after poisoning: 913.1775908879937, distance: 915.1829052162196
Total norm for 4 adversaries is: 913.1775908879937. distance: 915.1829052162196
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   1,  Average loss: 0.0398, Accuracy: 252/527 (47.8178%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   2,  Average loss: 0.0225, Accuracy: 308/527 (58.4440%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   3,  Average loss: 0.0143, Accuracy: 394/527 (74.7628%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   4,  Average loss: 0.0085, Accuracy: 455/527 (86.3378%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   5,  Average loss: 0.0053, Accuracy: 488/527 (92.5996%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   6,  Average loss: 0.0053, Accuracy: 494/527 (93.7381%), train_poison_data_count: 45
Global model norm: 43.48832458258193.
Norm before scaling: 43.8377607500443. Distance: 8.935154747201937
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.8327, Accuracy: 3398/10000 (33.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.3004, Accuracy: 8003/9000 (88.9222%)
Scaling by  100
Scaled Norm after poisoning: 891.812164920394, distance: 893.5154237616719
Total norm for 4 adversaries is: 891.812164920394. distance: 893.5154237616719
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   1,  Average loss: 0.0387, Accuracy: 234/496 (47.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   2,  Average loss: 0.0178, Accuracy: 340/496 (68.5484%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   3,  Average loss: 0.0121, Accuracy: 374/496 (75.4032%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   4,  Average loss: 0.0077, Accuracy: 424/496 (85.4839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   5,  Average loss: 0.0045, Accuracy: 460/496 (92.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   6,  Average loss: 0.0028, Accuracy: 476/496 (95.9677%), train_poison_data_count: 40
Global model norm: 43.48832458258193.
Norm before scaling: 43.61918780676544. Distance: 7.544036015332559
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.1204, Accuracy: 3533/10000 (35.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.0563, Accuracy: 8806/9000 (97.8444%)
Scaling by  100
Scaled Norm after poisoning: 752.6384424144172, distance: 754.4036137903901
Total norm for 4 adversaries is: 752.6384424144172. distance: 754.4036137903901
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   1,  Average loss: 0.0325, Accuracy: 296/546 (54.2125%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   2,  Average loss: 0.0154, Accuracy: 394/546 (72.1612%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   3,  Average loss: 0.0091, Accuracy: 457/546 (83.6996%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   4,  Average loss: 0.0040, Accuracy: 520/546 (95.2381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   5,  Average loss: 0.0016, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   6,  Average loss: 0.0015, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Global model norm: 43.48832458258193.
Norm before scaling: 43.580158611567434. Distance: 7.311718760434474
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.0909, Accuracy: 4110/10000 (41.1000%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.1591, Accuracy: 8470/9000 (94.1111%)
Scaling by  100
Scaled Norm after poisoning: 729.3537807538945, distance: 731.1718761686611
Total norm for 4 adversaries is: 729.3537807538945. distance: 731.1718761686611
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 207, local model 56, internal_epoch   1,  Average loss: 0.0250, Accuracy: 425/743 (57.2005%)
___Train Local_ResNet_18,  epoch 207, local model 56, internal_epoch   2,  Average loss: 0.0121, Accuracy: 553/743 (74.4280%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 45, internal_epoch   1,  Average loss: 0.0309, Accuracy: 271/529 (51.2287%)
___Train Local_ResNet_18,  epoch 207, local model 45, internal_epoch   2,  Average loss: 0.0197, Accuracy: 316/529 (59.7353%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   1,  Average loss: 0.0202, Accuracy: 397/641 (61.9345%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   2,  Average loss: 0.0112, Accuracy: 507/641 (79.0952%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 50, internal_epoch   1,  Average loss: 0.0211, Accuracy: 266/401 (66.3342%)
___Train Local_ResNet_18,  epoch 207, local model 50, internal_epoch   2,  Average loss: 0.0106, Accuracy: 316/401 (78.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 16, internal_epoch   1,  Average loss: 0.0317, Accuracy: 433/773 (56.0155%)
___Train Local_ResNet_18,  epoch 207, local model 16, internal_epoch   2,  Average loss: 0.0224, Accuracy: 436/773 (56.4036%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 12, internal_epoch   1,  Average loss: 0.0282, Accuracy: 537/977 (54.9642%)
___Train Local_ResNet_18,  epoch 207, local model 12, internal_epoch   2,  Average loss: 0.0140, Accuracy: 680/977 (69.6008%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 3.3893, Accuracy: 2516/10000 (25.1600%)
time spent on training: 138.6892647743225
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.34015262217892517  data num: [526, 527, 496, 546, 743, 529, 641, 401, 773, 977]
[rfa agg] considering poison per batch poison_fraction: 0.026574423607728527
[rfa agg] init. name: [17, 33, 77, 11, 56, 45, 1, 50, 16, 12], weight: tensor([0.0854, 0.0856, 0.0805, 0.0887, 0.1206, 0.0859, 0.1041, 0.0651, 0.1255,
        0.1586])
[rfa agg] iter:  0, prev_obj_val: 10530.1767578125, obj_val: 9546.0400390625, abs dis: 984.13671875
[rfa agg] iter:  0, weight: tensor([0.0504, 0.0504, 0.0570, 0.0523, 0.1444, 0.1025, 0.1244, 0.0775, 0.1504,
        0.1907])
[rfa agg] iter:  1, prev_obj_val: 9546.0400390625, obj_val: 8873.4287109375, abs dis: 672.611328125
[rfa agg] iter:  1, weight: tensor([0.0289, 0.0290, 0.0317, 0.0301, 0.1609, 0.1139, 0.1386, 0.0861, 0.1677,
        0.2131])
[rfa agg] iter:  2, prev_obj_val: 8873.4287109375, obj_val: 8464.78125, abs dis: 408.6474609375
[rfa agg] iter:  2, weight: tensor([0.0158, 0.0158, 0.0170, 0.0164, 0.1709, 0.1205, 0.1469, 0.0908, 0.1783,
        0.2276])
[rfa agg] iter:  3, prev_obj_val: 8464.78125, obj_val: 8231.1162109375, abs dis: 233.6650390625
[rfa agg] iter:  3, weight: tensor([0.0083, 0.0083, 0.0089, 0.0086, 0.1764, 0.1234, 0.1513, 0.0925, 0.1846,
        0.2376])
[rfa agg] iter:  4, prev_obj_val: 8231.1162109375, obj_val: 8105.017578125, abs dis: 126.0986328125
[rfa agg] iter:  4, weight: tensor([0.0042, 0.0042, 0.0045, 0.0044, 0.1792, 0.1233, 0.1529, 0.0915, 0.1887,
        0.2471])
[rfa agg] iter:  5, prev_obj_val: 8105.017578125, obj_val: 8042.06787109375, abs dis: 62.94970703125
[rfa agg] iter:  5, weight: tensor([0.0020, 0.0021, 0.0022, 0.0021, 0.1801, 0.1197, 0.1518, 0.0869, 0.1918,
        0.2613])
[rfa agg] iter:  6, prev_obj_val: 8042.06787109375, obj_val: 8009.529296875, abs dis: 32.53857421875
[rfa agg] iter:  6, weight: tensor([0.0010, 0.0010, 0.0010, 0.0010, 0.1779, 0.1105, 0.1463, 0.0772, 0.1943,
        0.2899])
[rfa agg] iter:  7, prev_obj_val: 8009.529296875, obj_val: 7996.892578125, abs dis: 12.63671875
[rfa agg] iter:  7, weight: tensor([0.0004, 0.0004, 0.0004, 0.0004, 0.1633, 0.0874, 0.1270, 0.0569, 0.1896,
        0.3742])
[rfa agg] iter:  8, prev_obj_val: 7996.892578125, obj_val: 8001.875, abs dis: 4.982421875
[rfa agg] iter:  8, weight: tensor([1.3204e-04, 1.3224e-04, 1.4015e-04, 1.3713e-04, 2.0925e-01, 6.7994e-02,
        1.3109e-01, 3.7824e-02, 2.7655e-01, 2.7675e-01])
[rfa agg] iter:  9, prev_obj_val: 8001.875, obj_val: 8006.41357421875, abs dis: 4.53857421875
[rfa agg] iter:  9, weight: tensor([1.0376e-04, 1.0393e-04, 1.1013e-04, 1.0777e-04, 3.0223e-01, 9.5412e-02,
        2.4657e-01, 4.5153e-02, 2.0085e-01, 1.0935e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 174.31727623939514 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:208 choose agents : [17, 33, 77, 11, 44, 86, 20, 50, 49, 43]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   1,  Average loss: 0.0307, Accuracy: 322/526 (61.2167%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   2,  Average loss: 0.0199, Accuracy: 347/526 (65.9696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   3,  Average loss: 0.0154, Accuracy: 389/526 (73.9544%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   4,  Average loss: 0.0113, Accuracy: 424/526 (80.6084%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   5,  Average loss: 0.0116, Accuracy: 449/526 (85.3612%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   6,  Average loss: 0.0090, Accuracy: 459/526 (87.2624%), train_poison_data_count: 45
Global model norm: 43.444138712564694.
Norm before scaling: 43.71695738819491. Distance: 8.52902114314159
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.2186, Accuracy: 3572/10000 (35.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.8630, Accuracy: 5724/9000 (63.6000%)
Scaling by  100
Scaled Norm after poisoning: 851.1361524456589, distance: 852.9021045817626
Total norm for 4 adversaries is: 851.1361524456589. distance: 852.9021045817626
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   1,  Average loss: 0.0355, Accuracy: 268/527 (50.8539%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   2,  Average loss: 0.0246, Accuracy: 282/527 (53.5104%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   3,  Average loss: 0.0160, Accuracy: 378/527 (71.7268%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   4,  Average loss: 0.0102, Accuracy: 442/527 (83.8710%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   5,  Average loss: 0.0064, Accuracy: 467/527 (88.6148%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   6,  Average loss: 0.0060, Accuracy: 481/527 (91.2713%), train_poison_data_count: 45
Global model norm: 43.444138712564694.
Norm before scaling: 43.887585000629734. Distance: 9.078884703582126
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.3061, Accuracy: 3799/10000 (37.9900%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.3491, Accuracy: 7849/9000 (87.2111%)
Scaling by  100
Scaled Norm after poisoning: 906.5202355711647, distance: 907.8884155004953
Total norm for 4 adversaries is: 906.5202355711647. distance: 907.8884155004953
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   1,  Average loss: 0.0334, Accuracy: 257/496 (51.8145%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   2,  Average loss: 0.0146, Accuracy: 355/496 (71.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   3,  Average loss: 0.0107, Accuracy: 396/496 (79.8387%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   4,  Average loss: 0.0069, Accuracy: 433/496 (87.2984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   5,  Average loss: 0.0037, Accuracy: 474/496 (95.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   6,  Average loss: 0.0025, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Global model norm: 43.444138712564694.
Norm before scaling: 43.59536287338941. Distance: 7.301961494187548
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.7232, Accuracy: 4611/10000 (46.1100%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.1472, Accuracy: 8511/9000 (94.5667%)
Scaling by  100
Scaled Norm after poisoning: 728.7373926868306, distance: 730.1961637121905
Total norm for 4 adversaries is: 728.7373926868306. distance: 730.1961637121905
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   1,  Average loss: 0.0283, Accuracy: 312/546 (57.1429%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   2,  Average loss: 0.0149, Accuracy: 415/546 (76.0073%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   3,  Average loss: 0.0103, Accuracy: 453/546 (82.9670%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   4,  Average loss: 0.0045, Accuracy: 504/546 (92.3077%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   5,  Average loss: 0.0028, Accuracy: 525/546 (96.1538%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   6,  Average loss: 0.0013, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Global model norm: 43.444138712564694.
Norm before scaling: 43.54998923650843. Distance: 7.127899650680821
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.0162, Accuracy: 4442/10000 (44.4200%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.1849, Accuracy: 8424/9000 (93.6000%)
Scaling by  100
Scaled Norm after poisoning: 711.1941542223192, distance: 712.7900506109776
Total norm for 4 adversaries is: 711.1941542223192. distance: 712.7900506109776
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 208, local model 44, internal_epoch   1,  Average loss: 0.0181, Accuracy: 277/436 (63.5321%)
___Train Local_ResNet_18,  epoch 208, local model 44, internal_epoch   2,  Average loss: 0.0084, Accuracy: 366/436 (83.9450%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 86, internal_epoch   1,  Average loss: 0.0391, Accuracy: 103/212 (48.5849%)
___Train Local_ResNet_18,  epoch 208, local model 86, internal_epoch   2,  Average loss: 0.0198, Accuracy: 150/212 (70.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 20, internal_epoch   1,  Average loss: 0.0322, Accuracy: 168/362 (46.4088%)
___Train Local_ResNet_18,  epoch 208, local model 20, internal_epoch   2,  Average loss: 0.0126, Accuracy: 271/362 (74.8619%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 50, internal_epoch   1,  Average loss: 0.0213, Accuracy: 274/401 (68.3292%)
___Train Local_ResNet_18,  epoch 208, local model 50, internal_epoch   2,  Average loss: 0.0104, Accuracy: 320/401 (79.8005%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 49, internal_epoch   1,  Average loss: 0.0217, Accuracy: 263/426 (61.7371%)
___Train Local_ResNet_18,  epoch 208, local model 49, internal_epoch   2,  Average loss: 0.0089, Accuracy: 354/426 (83.0986%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 43, internal_epoch   1,  Average loss: 0.0220, Accuracy: 204/345 (59.1304%)
___Train Local_ResNet_18,  epoch 208, local model 43, internal_epoch   2,  Average loss: 0.0111, Accuracy: 279/345 (80.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 137.24810791015625
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4898293196165537  data num: [526, 527, 496, 546, 436, 212, 362, 401, 426, 345]
[rfa agg] considering poison per batch poison_fraction: 0.03826791559504326
[rfa agg] init. name: [17, 33, 77, 11, 44, 86, 20, 50, 49, 43], weight: tensor([0.1230, 0.1232, 0.1160, 0.1277, 0.1019, 0.0496, 0.0846, 0.0938, 0.0996,
        0.0807])
[rfa agg] iter:  0, prev_obj_val: 11759.6953125, obj_val: 11753.8837890625, abs dis: 5.8115234375
[rfa agg] iter:  0, weight: tensor([0.1134, 0.1136, 0.1359, 0.1180, 0.1038, 0.0503, 0.0861, 0.0955, 0.1014,
        0.0821])
[rfa agg] iter:  1, prev_obj_val: 11753.8837890625, obj_val: 11748.109375, abs dis: 5.7744140625
[rfa agg] iter:  1, weight: tensor([0.1109, 0.1110, 0.1321, 0.1153, 0.1061, 0.0515, 0.0880, 0.0976, 0.1037,
        0.0839])
[rfa agg] iter:  2, prev_obj_val: 11748.109375, obj_val: 11742.443359375, abs dis: 5.666015625
[rfa agg] iter:  2, weight: tensor([0.1083, 0.1085, 0.1284, 0.1127, 0.1084, 0.0526, 0.0899, 0.0997, 0.1059,
        0.0857])
[rfa agg] iter:  3, prev_obj_val: 11742.443359375, obj_val: 11736.7890625, abs dis: 5.654296875
[rfa agg] iter:  3, weight: tensor([0.1058, 0.1060, 0.1247, 0.1100, 0.1106, 0.0537, 0.0918, 0.1018, 0.1081,
        0.0875])
[rfa agg] iter:  4, prev_obj_val: 11736.7890625, obj_val: 11731.0498046875, abs dis: 5.7392578125
[rfa agg] iter:  4, weight: tensor([0.1033, 0.1034, 0.1212, 0.1074, 0.1129, 0.0548, 0.0937, 0.1038, 0.1103,
        0.0893])
[rfa agg] iter:  5, prev_obj_val: 11731.0498046875, obj_val: 11725.4169921875, abs dis: 5.6328125
[rfa agg] iter:  5, weight: tensor([0.1007, 0.1008, 0.1176, 0.1047, 0.1152, 0.0559, 0.0956, 0.1059, 0.1126,
        0.0911])
[rfa agg] iter:  6, prev_obj_val: 11725.4169921875, obj_val: 11719.6982421875, abs dis: 5.71875
[rfa agg] iter:  6, weight: tensor([0.0981, 0.0983, 0.1141, 0.1020, 0.1174, 0.0570, 0.0974, 0.1080, 0.1148,
        0.0928])
[rfa agg] iter:  7, prev_obj_val: 11719.6982421875, obj_val: 11714.0849609375, abs dis: 5.61328125
[rfa agg] iter:  7, weight: tensor([0.0955, 0.0957, 0.1106, 0.0993, 0.1197, 0.0581, 0.0993, 0.1101, 0.1170,
        0.0947])
[rfa agg] iter:  8, prev_obj_val: 11714.0849609375, obj_val: 11708.5751953125, abs dis: 5.509765625
[rfa agg] iter:  8, weight: tensor([0.0930, 0.0931, 0.1072, 0.0966, 0.1220, 0.0591, 0.1012, 0.1122, 0.1192,
        0.0964])
[rfa agg] iter:  9, prev_obj_val: 11708.5751953125, obj_val: 11703.1689453125, abs dis: 5.40625
[rfa agg] iter:  9, weight: tensor([0.0904, 0.0906, 0.1039, 0.0940, 0.1242, 0.0602, 0.1030, 0.1142, 0.1213,
        0.0982])
___Test Target_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 172.91746830940247 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:209 choose agents : [17, 33, 77, 11, 28, 51, 4, 97, 85, 59]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   1,  Average loss: 0.0966, Accuracy: 121/526 (23.0038%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   2,  Average loss: 0.0237, Accuracy: 302/526 (57.4144%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   3,  Average loss: 0.0203, Accuracy: 336/526 (63.8783%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   4,  Average loss: 0.0157, Accuracy: 355/526 (67.4905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   5,  Average loss: 0.0108, Accuracy: 431/526 (81.9392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   6,  Average loss: 0.0082, Accuracy: 472/526 (89.7338%), train_poison_data_count: 45
Global model norm: 45.75209982800653.
Norm before scaling: 46.427210123415236. Distance: 13.040425754453796
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 2.3489, Accuracy: 3720/10000 (37.2000%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 1.4290, Accuracy: 4300/9000 (47.7778%)
Scaling by  100
Scaled Norm after poisoning: 1300.7068270751868, distance: 1304.0427044387773
Total norm for 4 adversaries is: 1300.7068270751868. distance: 1304.0427044387773
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   1,  Average loss: 0.0588, Accuracy: 222/527 (42.1252%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   2,  Average loss: 0.0201, Accuracy: 339/527 (64.3264%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   3,  Average loss: 0.0154, Accuracy: 361/527 (68.5009%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   4,  Average loss: 0.0114, Accuracy: 423/527 (80.2657%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   5,  Average loss: 0.0080, Accuracy: 469/527 (88.9943%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   6,  Average loss: 0.0059, Accuracy: 485/527 (92.0304%), train_poison_data_count: 45
Global model norm: 45.75209982800653.
Norm before scaling: 46.58327975921189. Distance: 12.187294669744697
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 2.4437, Accuracy: 3614/10000 (36.1400%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.5115, Accuracy: 7289/9000 (80.9889%)
Scaling by  100
Scaled Norm after poisoning: 1216.641432386716, distance: 1218.7295126483152
Total norm for 4 adversaries is: 1216.641432386716. distance: 1218.7295126483152
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   1,  Average loss: 0.0608, Accuracy: 168/496 (33.8710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   2,  Average loss: 0.0305, Accuracy: 168/496 (33.8710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   3,  Average loss: 0.0273, Accuracy: 229/496 (46.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   4,  Average loss: 0.0247, Accuracy: 231/496 (46.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   5,  Average loss: 0.0220, Accuracy: 271/496 (54.6371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   6,  Average loss: 0.0190, Accuracy: 296/496 (59.6774%), train_poison_data_count: 40
Global model norm: 45.75209982800653.
Norm before scaling: 46.05449864783162. Distance: 10.280419591511771
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 2.1983, Accuracy: 2542/10000 (25.4200%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.1379, Accuracy: 8445/9000 (93.8333%)
Scaling by  100
Scaled Norm after poisoning: 1025.2662459088372, distance: 1028.041949533189
Total norm for 4 adversaries is: 1025.2662459088372. distance: 1028.041949533189
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   1,  Average loss: 0.0659, Accuracy: 154/546 (28.2051%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   2,  Average loss: 0.0279, Accuracy: 223/546 (40.8425%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   3,  Average loss: 0.0231, Accuracy: 275/546 (50.3663%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   4,  Average loss: 0.0188, Accuracy: 360/546 (65.9341%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   5,  Average loss: 0.0148, Accuracy: 388/546 (71.0623%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   6,  Average loss: 0.0119, Accuracy: 407/546 (74.5421%), train_poison_data_count: 45
Global model norm: 45.75209982800653.
Norm before scaling: 46.237535271343674. Distance: 11.494840708554385
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 2.7891, Accuracy: 2670/10000 (26.7000%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.5374, Accuracy: 7624/9000 (84.7111%)
Scaling by  100
Scaled Norm after poisoning: 1146.585855921832, distance: 1149.4841777945444
Total norm for 4 adversaries is: 1146.585855921832. distance: 1149.4841777945444
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 209, local model 28, internal_epoch   1,  Average loss: 0.0999, Accuracy: 74/423 (17.4941%)
___Train Local_ResNet_18,  epoch 209, local model 28, internal_epoch   2,  Average loss: 0.0330, Accuracy: 124/423 (29.3144%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 51, internal_epoch   1,  Average loss: 0.0976, Accuracy: 122/479 (25.4697%)
___Train Local_ResNet_18,  epoch 209, local model 51, internal_epoch   2,  Average loss: 0.0259, Accuracy: 294/479 (61.3779%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   1,  Average loss: 0.0704, Accuracy: 195/557 (35.0090%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   2,  Average loss: 0.0236, Accuracy: 310/557 (55.6553%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 97, internal_epoch   1,  Average loss: 0.1082, Accuracy: 79/418 (18.8995%)
___Train Local_ResNet_18,  epoch 209, local model 97, internal_epoch   2,  Average loss: 0.0251, Accuracy: 219/418 (52.3923%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 85, internal_epoch   1,  Average loss: 0.0863, Accuracy: 91/364 (25.0000%)
___Train Local_ResNet_18,  epoch 209, local model 85, internal_epoch   2,  Average loss: 0.0249, Accuracy: 174/364 (47.8022%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 59, internal_epoch   1,  Average loss: 0.0856, Accuracy: 133/642 (20.7165%)
___Train Local_ResNet_18,  epoch 209, local model 59, internal_epoch   2,  Average loss: 0.0303, Accuracy: 228/642 (35.5140%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 137.84002876281738
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4208517476898353  data num: [526, 527, 496, 546, 423, 479, 557, 418, 364, 642]
[rfa agg] considering poison per batch poison_fraction: 0.032879042788268385
[rfa agg] init. name: [17, 33, 77, 11, 28, 51, 4, 97, 85, 59], weight: tensor([0.1057, 0.1059, 0.0996, 0.1097, 0.0850, 0.0962, 0.1119, 0.0840, 0.0731,
        0.1290])
[rfa agg] iter:  0, prev_obj_val: 11695.22265625, obj_val: 11383.03125, abs dis: 312.19140625
[rfa agg] iter:  0, weight: tensor([0.0828, 0.0831, 0.0920, 0.0844, 0.0964, 0.1092, 0.1271, 0.0952, 0.0829,
        0.1468])
[rfa agg] iter:  1, prev_obj_val: 11383.03125, obj_val: 11107.3544921875, abs dis: 275.6767578125
[rfa agg] iter:  1, weight: tensor([0.0658, 0.0661, 0.0718, 0.0673, 0.1068, 0.1211, 0.1410, 0.1055, 0.0918,
        0.1628])
[rfa agg] iter:  2, prev_obj_val: 11107.3544921875, obj_val: 10872.8828125, abs dis: 234.4716796875
[rfa agg] iter:  2, weight: tensor([0.0512, 0.0514, 0.0551, 0.0524, 0.1157, 0.1312, 0.1528, 0.1143, 0.0994,
        0.1766])
[rfa agg] iter:  3, prev_obj_val: 10872.8828125, obj_val: 10681.0576171875, abs dis: 191.8251953125
[rfa agg] iter:  3, weight: tensor([0.0391, 0.0392, 0.0416, 0.0400, 0.1230, 0.1395, 0.1625, 0.1215, 0.1056,
        0.1880])
[rfa agg] iter:  4, prev_obj_val: 10681.0576171875, obj_val: 10528.5390625, abs dis: 152.5185546875
[rfa agg] iter:  4, weight: tensor([0.0294, 0.0295, 0.0311, 0.0301, 0.1287, 0.1461, 0.1703, 0.1272, 0.1105,
        0.1972])
[rfa agg] iter:  5, prev_obj_val: 10528.5390625, obj_val: 10409.2392578125, abs dis: 119.2998046875
[rfa agg] iter:  5, weight: tensor([0.0218, 0.0219, 0.0229, 0.0224, 0.1331, 0.1512, 0.1764, 0.1315, 0.1142,
        0.2046])
[rfa agg] iter:  6, prev_obj_val: 10409.2392578125, obj_val: 10317.8564453125, abs dis: 91.3828125
[rfa agg] iter:  6, weight: tensor([0.0160, 0.0160, 0.0168, 0.0164, 0.1364, 0.1551, 0.1811, 0.1348, 0.1168,
        0.2106])
[rfa agg] iter:  7, prev_obj_val: 10317.8564453125, obj_val: 10249.19921875, abs dis: 68.6572265625
[rfa agg] iter:  7, weight: tensor([0.0116, 0.0116, 0.0121, 0.0119, 0.1387, 0.1580, 0.1848, 0.1371, 0.1186,
        0.2156])
[rfa agg] iter:  8, prev_obj_val: 10249.19921875, obj_val: 10196.7255859375, abs dis: 52.4736328125
[rfa agg] iter:  8, weight: tensor([0.0083, 0.0083, 0.0087, 0.0085, 0.1402, 0.1602, 0.1877, 0.1385, 0.1197,
        0.2200])
[rfa agg] iter:  9, prev_obj_val: 10196.7255859375, obj_val: 10159.5283203125, abs dis: 37.197265625
[rfa agg] iter:  9, weight: tensor([0.0058, 0.0058, 0.0061, 0.0060, 0.1410, 0.1617, 0.1901, 0.1393, 0.1199,
        0.2244])
___Test Target_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 175.24279880523682 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:210 choose agents : [17, 33, 77, 11, 51, 13, 57, 76, 80, 85]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   1,  Average loss: 0.0371, Accuracy: 211/526 (40.1141%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   2,  Average loss: 0.0148, Accuracy: 401/526 (76.2357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   3,  Average loss: 0.0083, Accuracy: 460/526 (87.4525%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   4,  Average loss: 0.0056, Accuracy: 494/526 (93.9163%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   5,  Average loss: 0.0026, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   6,  Average loss: 0.0027, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Global model norm: 45.47132724654626.
Norm before scaling: 45.688298877249466. Distance: 7.934714241483063
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 2.3823, Accuracy: 4134/10000 (41.3400%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.4633, Accuracy: 7450/9000 (82.7778%)
Scaling by  100
Scaled Norm after poisoning: 792.0520421664223, distance: 793.4714078024488
Total norm for 4 adversaries is: 792.0520421664223. distance: 793.4714078024488
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   1,  Average loss: 0.0188, Accuracy: 345/527 (65.4649%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   2,  Average loss: 0.0114, Accuracy: 416/527 (78.9374%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   3,  Average loss: 0.0083, Accuracy: 464/527 (88.0455%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   4,  Average loss: 0.0052, Accuracy: 493/527 (93.5484%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   5,  Average loss: 0.0030, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   6,  Average loss: 0.0019, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Global model norm: 45.47132724654626.
Norm before scaling: 45.52751250102788. Distance: 6.582431135849666
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 2.2408, Accuracy: 4363/10000 (43.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 1.1277, Accuracy: 5759/9000 (63.9889%)
Scaling by  100
Scaled Norm after poisoning: 656.9095970908021, distance: 658.2430924438174
Total norm for 4 adversaries is: 656.9095970908021. distance: 658.2430924438174
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   1,  Average loss: 0.0249, Accuracy: 228/496 (45.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   2,  Average loss: 0.0154, Accuracy: 320/496 (64.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   3,  Average loss: 0.0091, Accuracy: 392/496 (79.0323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   4,  Average loss: 0.0051, Accuracy: 461/496 (92.9435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   5,  Average loss: 0.0026, Accuracy: 476/496 (95.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   6,  Average loss: 0.0017, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Global model norm: 45.47132724654626.
Norm before scaling: 45.39607594206244. Distance: 5.316726977605163
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 2.0963, Accuracy: 4461/10000 (44.6100%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.0940, Accuracy: 8677/9000 (96.4111%)
Scaling by  100
Scaled Norm after poisoning: 530.3140578939992, distance: 531.6727435650619
Total norm for 4 adversaries is: 530.3140578939992. distance: 531.6727435650619
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   1,  Average loss: 0.0246, Accuracy: 281/546 (51.4652%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   2,  Average loss: 0.0133, Accuracy: 426/546 (78.0220%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   3,  Average loss: 0.0077, Accuracy: 482/546 (88.2784%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   4,  Average loss: 0.0047, Accuracy: 505/546 (92.4908%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   5,  Average loss: 0.0034, Accuracy: 513/546 (93.9560%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   6,  Average loss: 0.0016, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Global model norm: 45.47132724654626.
Norm before scaling: 45.42093437278537. Distance: 5.939275536333062
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.8725, Accuracy: 4458/10000 (44.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.2286, Accuracy: 8347/9000 (92.7444%)
Scaling by  100
Scaled Norm after poisoning: 592.3107556426778, distance: 593.9275260921993
Total norm for 4 adversaries is: 592.3107556426778. distance: 593.9275260921993
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 210, local model 51, internal_epoch   1,  Average loss: 0.0513, Accuracy: 177/479 (36.9520%)
___Train Local_ResNet_18,  epoch 210, local model 51, internal_epoch   2,  Average loss: 0.0175, Accuracy: 327/479 (68.2672%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 13, internal_epoch   1,  Average loss: 0.0404, Accuracy: 231/620 (37.2581%)
___Train Local_ResNet_18,  epoch 210, local model 13, internal_epoch   2,  Average loss: 0.0182, Accuracy: 385/620 (62.0968%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   1,  Average loss: 0.0366, Accuracy: 106/290 (36.5517%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   2,  Average loss: 0.0198, Accuracy: 179/290 (61.7241%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 76, internal_epoch   1,  Average loss: 0.2172, Accuracy: 14/65 (21.5385%)
___Train Local_ResNet_18,  epoch 210, local model 76, internal_epoch   2,  Average loss: 0.1138, Accuracy: 22/65 (33.8462%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 80, internal_epoch   1,  Average loss: 0.0534, Accuracy: 101/363 (27.8237%)
___Train Local_ResNet_18,  epoch 210, local model 80, internal_epoch   2,  Average loss: 0.0139, Accuracy: 275/363 (75.7576%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 85, internal_epoch   1,  Average loss: 0.0406, Accuracy: 130/364 (35.7143%)
___Train Local_ResNet_18,  epoch 210, local model 85, internal_epoch   2,  Average loss: 0.0186, Accuracy: 213/364 (58.5165%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 137.65689897537231
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4899438727782975  data num: [526, 527, 496, 546, 479, 620, 290, 65, 363, 364]
[rfa agg] considering poison per batch poison_fraction: 0.038276865060804494
[rfa agg] init. name: [17, 33, 77, 11, 51, 13, 57, 76, 80, 85], weight: tensor([0.1230, 0.1232, 0.1160, 0.1277, 0.1120, 0.1450, 0.0678, 0.0152, 0.0849,
        0.0851])
[rfa agg] iter:  0, prev_obj_val: 11802.466796875, obj_val: 11796.8330078125, abs dis: 5.6337890625
[rfa agg] iter:  0, weight: tensor([0.1136, 0.1139, 0.1356, 0.1180, 0.1140, 0.1478, 0.0689, 0.0154, 0.0863,
        0.0865])
[rfa agg] iter:  1, prev_obj_val: 11796.8330078125, obj_val: 11791.390625, abs dis: 5.4423828125
[rfa agg] iter:  1, weight: tensor([0.1111, 0.1113, 0.1319, 0.1154, 0.1165, 0.1511, 0.0704, 0.0157, 0.0882,
        0.0884])
[rfa agg] iter:  2, prev_obj_val: 11791.390625, obj_val: 11785.9560546875, abs dis: 5.4345703125
[rfa agg] iter:  2, weight: tensor([0.1086, 0.1088, 0.1283, 0.1128, 0.1190, 0.1543, 0.0719, 0.0161, 0.0900,
        0.0903])
[rfa agg] iter:  3, prev_obj_val: 11785.9560546875, obj_val: 11780.529296875, abs dis: 5.4267578125
[rfa agg] iter:  3, weight: tensor([0.1061, 0.1063, 0.1247, 0.1102, 0.1214, 0.1574, 0.0733, 0.0164, 0.0919,
        0.0921])
[rfa agg] iter:  4, prev_obj_val: 11780.529296875, obj_val: 11775.109375, abs dis: 5.419921875
[rfa agg] iter:  4, weight: tensor([0.1036, 0.1038, 0.1212, 0.1076, 0.1239, 0.1606, 0.0748, 0.0167, 0.0937,
        0.0940])
[rfa agg] iter:  5, prev_obj_val: 11775.109375, obj_val: 11769.8818359375, abs dis: 5.2275390625
[rfa agg] iter:  5, weight: tensor([0.1011, 0.1013, 0.1178, 0.1050, 0.1263, 0.1638, 0.0763, 0.0170, 0.0956,
        0.0958])
[rfa agg] iter:  6, prev_obj_val: 11769.8818359375, obj_val: 11764.5693359375, abs dis: 5.3125
[rfa agg] iter:  6, weight: tensor([0.0987, 0.0989, 0.1145, 0.1025, 0.1287, 0.1668, 0.0777, 0.0174, 0.0973,
        0.0976])
[rfa agg] iter:  7, prev_obj_val: 11764.5693359375, obj_val: 11759.35546875, abs dis: 5.2138671875
[rfa agg] iter:  7, weight: tensor([0.0962, 0.0964, 0.1111, 0.0999, 0.1311, 0.1699, 0.0791, 0.0177, 0.0991,
        0.0994])
[rfa agg] iter:  8, prev_obj_val: 11759.35546875, obj_val: 11754.1455078125, abs dis: 5.2099609375
[rfa agg] iter:  8, weight: tensor([0.0938, 0.0940, 0.1079, 0.0974, 0.1334, 0.1730, 0.0805, 0.0180, 0.1009,
        0.1012])
[rfa agg] iter:  9, prev_obj_val: 11754.1455078125, obj_val: 11749.125, abs dis: 5.0205078125
[rfa agg] iter:  9, weight: tensor([0.0913, 0.0915, 0.1047, 0.0948, 0.1357, 0.1760, 0.0819, 0.0183, 0.1027,
        0.1030])
___Test Target_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 173.14501643180847 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:211 choose agents : [17, 33, 77, 11, 90, 24, 63, 1, 52, 31]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   1,  Average loss: 0.0455, Accuracy: 349/526 (66.3498%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   2,  Average loss: 0.0146, Accuracy: 420/526 (79.8479%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   3,  Average loss: 0.0086, Accuracy: 444/526 (84.4106%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   4,  Average loss: 0.0038, Accuracy: 489/526 (92.9658%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   5,  Average loss: 0.0028, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   6,  Average loss: 0.0045, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Global model norm: 46.80691148634595.
Norm before scaling: 48.35412683557888. Distance: 14.433286109711977
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.8585, Accuracy: 3961/10000 (39.6100%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.6854, Accuracy: 7427/9000 (82.5222%)
Scaling by  100
Scaled Norm after poisoning: 1441.9708301487933, distance: 1443.3286614628007
Total norm for 4 adversaries is: 1441.9708301487933. distance: 1443.3286614628007
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   1,  Average loss: 0.0742, Accuracy: 216/527 (40.9867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   2,  Average loss: 0.0170, Accuracy: 431/527 (81.7837%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   3,  Average loss: 0.0111, Accuracy: 428/527 (81.2144%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   4,  Average loss: 0.0098, Accuracy: 435/527 (82.5427%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   5,  Average loss: 0.0054, Accuracy: 481/527 (91.2713%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   6,  Average loss: 0.0033, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Global model norm: 46.80691148634595.
Norm before scaling: 48.675443789707764. Distance: 16.30056735496498
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.2866, Accuracy: 3985/10000 (39.8500%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.5869, Accuracy: 7503/9000 (83.3667%)
Scaling by  100
Scaled Norm after poisoning: 1628.0498303184704, distance: 1630.0566707939943
Total norm for 4 adversaries is: 1628.0498303184704. distance: 1630.0566707939943
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   1,  Average loss: 0.0823, Accuracy: 185/496 (37.2984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   2,  Average loss: 0.0199, Accuracy: 316/496 (63.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   3,  Average loss: 0.0113, Accuracy: 386/496 (77.8226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   4,  Average loss: 0.0061, Accuracy: 462/496 (93.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   5,  Average loss: 0.0026, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   6,  Average loss: 0.0019, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Global model norm: 46.80691148634595.
Norm before scaling: 48.03154735187724. Distance: 14.243437745110135
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.9528, Accuracy: 4284/10000 (42.8400%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.1592, Accuracy: 8494/9000 (94.3778%)
Scaling by  100
Scaled Norm after poisoning: 1422.066454143406, distance: 1424.3438401593908
Total norm for 4 adversaries is: 1422.066454143406. distance: 1424.3438401593908
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   1,  Average loss: 0.0685, Accuracy: 249/546 (45.6044%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   2,  Average loss: 0.0165, Accuracy: 392/546 (71.7949%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   3,  Average loss: 0.0082, Accuracy: 476/546 (87.1795%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   4,  Average loss: 0.0044, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   5,  Average loss: 0.0026, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   6,  Average loss: 0.0021, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Global model norm: 46.80691148634595.
Norm before scaling: 48.09223976267507. Distance: 14.33974212967943
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.1499, Accuracy: 4173/10000 (41.7300%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.1413, Accuracy: 8556/9000 (95.0667%)
Scaling by  100
Scaled Norm after poisoning: 1431.8197774161383, distance: 1433.9741542301242
Total norm for 4 adversaries is: 1431.8197774161383. distance: 1433.9741542301242
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 211, local model 90, internal_epoch   1,  Average loss: 0.0563, Accuracy: 372/578 (64.3599%)
___Train Local_ResNet_18,  epoch 211, local model 90, internal_epoch   2,  Average loss: 0.0344, Accuracy: 209/578 (36.1592%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 24, internal_epoch   1,  Average loss: 0.0720, Accuracy: 121/320 (37.8125%)
___Train Local_ResNet_18,  epoch 211, local model 24, internal_epoch   2,  Average loss: 0.0228, Accuracy: 198/320 (61.8750%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 63, internal_epoch   1,  Average loss: 0.0562, Accuracy: 307/752 (40.8245%)
___Train Local_ResNet_18,  epoch 211, local model 63, internal_epoch   2,  Average loss: 0.0209, Accuracy: 427/752 (56.7819%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 1, internal_epoch   1,  Average loss: 0.0568, Accuracy: 309/641 (48.2059%)
___Train Local_ResNet_18,  epoch 211, local model 1, internal_epoch   2,  Average loss: 0.0309, Accuracy: 309/641 (48.2059%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 52, internal_epoch   1,  Average loss: 0.1054, Accuracy: 70/214 (32.7103%)
___Train Local_ResNet_18,  epoch 211, local model 52, internal_epoch   2,  Average loss: 0.0331, Accuracy: 129/214 (60.2804%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 31, internal_epoch   1,  Average loss: 0.0553, Accuracy: 316/706 (44.7592%)
___Train Local_ResNet_18,  epoch 211, local model 31, internal_epoch   2,  Average loss: 0.0232, Accuracy: 399/706 (56.5156%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 138.1637578010559
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3948360346777233  data num: [526, 527, 496, 546, 578, 320, 752, 641, 214, 706]
[rfa agg] considering poison per batch poison_fraction: 0.030846565209197135
[rfa agg] init. name: [17, 33, 77, 11, 90, 24, 63, 1, 52, 31], weight: tensor([0.0991, 0.0993, 0.0935, 0.1029, 0.1089, 0.0603, 0.1417, 0.1208, 0.0403,
        0.1331])
[rfa agg] iter:  0, prev_obj_val: 11847.34765625, obj_val: 11333.18359375, abs dis: 514.1640625
[rfa agg] iter:  0, weight: tensor([0.0716, 0.0716, 0.0806, 0.0743, 0.1264, 0.0696, 0.1647, 0.1402, 0.0465,
        0.1546])
[rfa agg] iter:  1, prev_obj_val: 11333.18359375, obj_val: 10903.07421875, abs dis: 430.109375
[rfa agg] iter:  1, weight: tensor([0.0521, 0.0521, 0.0572, 0.0540, 0.1413, 0.0776, 0.1842, 0.1568, 0.0518,
        0.1729])
[rfa agg] iter:  2, prev_obj_val: 10903.07421875, obj_val: 10565.599609375, abs dis: 337.474609375
[rfa agg] iter:  2, weight: tensor([0.0366, 0.0366, 0.0396, 0.0380, 0.1529, 0.0838, 0.1995, 0.1698, 0.0559,
        0.1873])
[rfa agg] iter:  3, prev_obj_val: 10565.599609375, obj_val: 10316.96484375, abs dis: 248.634765625
[rfa agg] iter:  3, weight: tensor([0.0250, 0.0251, 0.0268, 0.0260, 0.1615, 0.0882, 0.2111, 0.1795, 0.0588,
        0.1981])
[rfa agg] iter:  4, prev_obj_val: 10316.96484375, obj_val: 10139.572265625, abs dis: 177.392578125
[rfa agg] iter:  4, weight: tensor([0.0168, 0.0168, 0.0178, 0.0174, 0.1676, 0.0909, 0.2195, 0.1864, 0.0606,
        0.2060])
[rfa agg] iter:  5, prev_obj_val: 10139.572265625, obj_val: 10017.9990234375, abs dis: 121.5732421875
[rfa agg] iter:  5, weight: tensor([0.0111, 0.0111, 0.0117, 0.0115, 0.1718, 0.0923, 0.2258, 0.1914, 0.0613,
        0.2119])
[rfa agg] iter:  6, prev_obj_val: 10017.9990234375, obj_val: 9934.740234375, abs dis: 83.2587890625
[rfa agg] iter:  6, weight: tensor([0.0072, 0.0072, 0.0076, 0.0075, 0.1745, 0.0924, 0.2308, 0.1951, 0.0612,
        0.2165])
[rfa agg] iter:  7, prev_obj_val: 9934.740234375, obj_val: 9879.5234375, abs dis: 55.216796875
[rfa agg] iter:  7, weight: tensor([0.0046, 0.0046, 0.0048, 0.0048, 0.1760, 0.0911, 0.2353, 0.1980, 0.0601,
        0.2208])
[rfa agg] iter:  8, prev_obj_val: 9879.5234375, obj_val: 9844.5341796875, abs dis: 34.9892578125
[rfa agg] iter:  8, weight: tensor([0.0029, 0.0029, 0.0030, 0.0030, 0.1759, 0.0881, 0.2403, 0.2008, 0.0577,
        0.2255])
[rfa agg] iter:  9, prev_obj_val: 9844.5341796875, obj_val: 9821.76171875, abs dis: 22.7724609375
[rfa agg] iter:  9, weight: tensor([0.0018, 0.0018, 0.0018, 0.0018, 0.1728, 0.0830, 0.2471, 0.2041, 0.0538,
        0.2320])
___Test Target_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 175.51236200332642 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:212 choose agents : [17, 33, 77, 11, 59, 67, 71, 66, 76, 96]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   1,  Average loss: 0.0232, Accuracy: 386/526 (73.3840%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   2,  Average loss: 0.0098, Accuracy: 448/526 (85.1711%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   3,  Average loss: 0.0059, Accuracy: 486/526 (92.3954%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   4,  Average loss: 0.0040, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   5,  Average loss: 0.0047, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   6,  Average loss: 0.0041, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Global model norm: 46.66608130678266.
Norm before scaling: 47.28285584682095. Distance: 10.260465164199047
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 2.9484, Accuracy: 3738/10000 (37.3800%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.4471, Accuracy: 7804/9000 (86.7111%)
Scaling by  100
Scaled Norm after poisoning: 1024.8004073964842, distance: 1026.0465389055216
Total norm for 4 adversaries is: 1024.8004073964842. distance: 1026.0465389055216
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   1,  Average loss: 0.0385, Accuracy: 290/527 (55.0285%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   2,  Average loss: 0.0101, Accuracy: 465/527 (88.2353%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   3,  Average loss: 0.0092, Accuracy: 460/527 (87.2865%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   4,  Average loss: 0.0053, Accuracy: 486/527 (92.2201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   5,  Average loss: 0.0050, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   6,  Average loss: 0.0034, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Global model norm: 46.66608130678266.
Norm before scaling: 47.68367551013921. Distance: 12.043784688950108
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 3.4232, Accuracy: 3471/10000 (34.7100%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 1.3813, Accuracy: 6601/9000 (73.3444%)
Scaling by  100
Scaled Norm after poisoning: 1203.2460263803077, distance: 1204.3784704153425
Total norm for 4 adversaries is: 1203.2460263803077. distance: 1204.3784704153425
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   1,  Average loss: 0.0454, Accuracy: 257/496 (51.8145%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   2,  Average loss: 0.0123, Accuracy: 382/496 (77.0161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   3,  Average loss: 0.0059, Accuracy: 445/496 (89.7177%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   4,  Average loss: 0.0028, Accuracy: 476/496 (95.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   5,  Average loss: 0.0016, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   6,  Average loss: 0.0018, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Global model norm: 46.66608130678266.
Norm before scaling: 47.12965463169792. Distance: 9.787204282928872
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 2.1919, Accuracy: 4254/10000 (42.5400%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.1169, Accuracy: 8678/9000 (96.4222%)
Scaling by  100
Scaled Norm after poisoning: 977.159403577533, distance: 978.7204018513153
Total norm for 4 adversaries is: 977.159403577533. distance: 978.7204018513153
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   1,  Average loss: 0.0349, Accuracy: 322/546 (58.9744%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   2,  Average loss: 0.0087, Accuracy: 471/546 (86.2637%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   3,  Average loss: 0.0035, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   4,  Average loss: 0.0026, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 46.66608130678266.
Norm before scaling: 47.202387965944055. Distance: 10.115366556085096
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 2.3533, Accuracy: 4535/10000 (45.3500%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.1963, Accuracy: 8520/9000 (94.6667%)
Scaling by  100
Scaled Norm after poisoning: 1010.0427280565907, distance: 1011.5367022505906
Total norm for 4 adversaries is: 1010.0427280565907. distance: 1011.5367022505906
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 212, local model 59, internal_epoch   1,  Average loss: 0.0344, Accuracy: 390/642 (60.7477%)
___Train Local_ResNet_18,  epoch 212, local model 59, internal_epoch   2,  Average loss: 0.0164, Accuracy: 454/642 (70.7165%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 67, internal_epoch   1,  Average loss: 0.0352, Accuracy: 446/842 (52.9691%)
___Train Local_ResNet_18,  epoch 212, local model 67, internal_epoch   2,  Average loss: 0.0179, Accuracy: 539/842 (64.0143%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 71, internal_epoch   1,  Average loss: 0.0292, Accuracy: 712/1166 (61.0635%)
___Train Local_ResNet_18,  epoch 212, local model 71, internal_epoch   2,  Average loss: 0.0115, Accuracy: 901/1166 (77.2727%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 66, internal_epoch   1,  Average loss: 0.0237, Accuracy: 392/555 (70.6306%)
___Train Local_ResNet_18,  epoch 212, local model 66, internal_epoch   2,  Average loss: 0.0084, Accuracy: 475/555 (85.5856%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 76, internal_epoch   1,  Average loss: 0.1801, Accuracy: 20/65 (30.7692%)
___Train Local_ResNet_18,  epoch 212, local model 76, internal_epoch   2,  Average loss: 0.0563, Accuracy: 33/65 (50.7692%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 96, internal_epoch   1,  Average loss: 0.0470, Accuracy: 313/708 (44.2090%)
___Train Local_ResNet_18,  epoch 212, local model 96, internal_epoch   2,  Average loss: 0.0311, Accuracy: 264/708 (37.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 150.79268527030945
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3449695372962292  data num: [526, 527, 496, 546, 642, 842, 1166, 555, 65, 708]
[rfa agg] considering poison per batch poison_fraction: 0.026950745101267905
[rfa agg] init. name: [17, 33, 77, 11, 59, 67, 71, 66, 76, 96], weight: tensor([0.0866, 0.0868, 0.0817, 0.0899, 0.1057, 0.1386, 0.1920, 0.0914, 0.0107,
        0.1166])
[rfa agg] iter:  0, prev_obj_val: 10968.7353515625, obj_val: 9996.53125, abs dis: 972.2041015625
[rfa agg] iter:  0, weight: tensor([0.0522, 0.0522, 0.0585, 0.0542, 0.1260, 0.1658, 0.2308, 0.1087, 0.0126,
        0.1391])
[rfa agg] iter:  1, prev_obj_val: 9996.53125, obj_val: 9319.275390625, abs dis: 677.255859375
[rfa agg] iter:  1, weight: tensor([0.0306, 0.0306, 0.0333, 0.0318, 0.1403, 0.1850, 0.2584, 0.1209, 0.0140,
        0.1550])
[rfa agg] iter:  2, prev_obj_val: 9319.275390625, obj_val: 8897.3916015625, abs dis: 421.8837890625
[rfa agg] iter:  2, weight: tensor([0.0171, 0.0171, 0.0183, 0.0177, 0.1489, 0.1970, 0.2767, 0.1279, 0.0147,
        0.1647])
[rfa agg] iter:  3, prev_obj_val: 8897.3916015625, obj_val: 8654.1083984375, abs dis: 243.283203125
[rfa agg] iter:  3, weight: tensor([0.0092, 0.0092, 0.0098, 0.0095, 0.1530, 0.2039, 0.2900, 0.1309, 0.0147,
        0.1697])
[rfa agg] iter:  4, prev_obj_val: 8654.1083984375, obj_val: 8521.6884765625, abs dis: 132.419921875
[rfa agg] iter:  4, weight: tensor([0.0048, 0.0048, 0.0051, 0.0050, 0.1538, 0.2078, 0.3026, 0.1304, 0.0142,
        0.1713])
[rfa agg] iter:  5, prev_obj_val: 8521.6884765625, obj_val: 8448.8564453125, abs dis: 72.83203125
[rfa agg] iter:  5, weight: tensor([0.0025, 0.0025, 0.0026, 0.0026, 0.1511, 0.2096, 0.3203, 0.1261, 0.0130,
        0.1696])
[rfa agg] iter:  6, prev_obj_val: 8448.8564453125, obj_val: 8411.162109375, abs dis: 37.6943359375
[rfa agg] iter:  6, weight: tensor([0.0012, 0.0012, 0.0013, 0.0013, 0.1425, 0.2085, 0.3560, 0.1152, 0.0108,
        0.1620])
[rfa agg] iter:  7, prev_obj_val: 8411.162109375, obj_val: 8397.05078125, abs dis: 14.111328125
[rfa agg] iter:  7, weight: tensor([0.0005, 0.0005, 0.0005, 0.0005, 0.1193, 0.1948, 0.4479, 0.0910, 0.0073,
        0.1376])
[rfa agg] iter:  8, prev_obj_val: 8397.05078125, obj_val: 8397.0703125, abs dis: 0.01953125
[rfa agg] iter:  8, weight: tensor([2.1236e-04, 2.1256e-04, 2.2391e-04, 2.2053e-04, 9.4424e-02, 1.8671e-01,
        5.4224e-01, 6.5596e-02, 4.2287e-03, 1.0593e-01])
[rfa agg] iter:  9, prev_obj_val: 8397.0703125, obj_val: 8397.5234375, abs dis: 0.453125
[rfa agg] iter:  9, weight: tensor([2.0311e-04, 2.0331e-04, 2.1416e-04, 2.1093e-04, 1.0478e-01, 2.1517e-01,
        4.9104e-01, 7.0985e-02, 4.3499e-03, 1.1285e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 188.20505213737488 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:213 choose agents : [17, 33, 77, 11, 80, 81, 22, 72, 64, 45]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   1,  Average loss: 0.0189, Accuracy: 404/526 (76.8061%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   2,  Average loss: 0.0077, Accuracy: 468/526 (88.9734%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   3,  Average loss: 0.0050, Accuracy: 488/526 (92.7757%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   4,  Average loss: 0.0051, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   5,  Average loss: 0.0037, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   6,  Average loss: 0.0031, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Global model norm: 46.5880566399198.
Norm before scaling: 47.22741999324916. Distance: 9.857323773226424
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 2.6819, Accuracy: 4299/10000 (42.9900%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 1.1247, Accuracy: 6192/9000 (68.8000%)
Scaling by  100
Scaled Norm after poisoning: 984.9468577035007, distance: 985.7323736694458
Total norm for 4 adversaries is: 984.9468577035007. distance: 985.7323736694458
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   1,  Average loss: 0.0316, Accuracy: 312/527 (59.2030%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   2,  Average loss: 0.0077, Accuracy: 464/527 (88.0455%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   3,  Average loss: 0.0081, Accuracy: 480/527 (91.0816%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   4,  Average loss: 0.0069, Accuracy: 477/527 (90.5123%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   5,  Average loss: 0.0044, Accuracy: 485/527 (92.0304%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   6,  Average loss: 0.0030, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Global model norm: 46.5880566399198.
Norm before scaling: 47.390962432857386. Distance: 10.929232366327815
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 2.5399, Accuracy: 3924/10000 (39.2400%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.4599, Accuracy: 7751/9000 (86.1222%)
Scaling by  100
Scaled Norm after poisoning: 1091.9031550462705, distance: 1092.9232589710953
Total norm for 4 adversaries is: 1091.9031550462705. distance: 1092.9232589710953
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   1,  Average loss: 0.0296, Accuracy: 288/496 (58.0645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   2,  Average loss: 0.0093, Accuracy: 414/496 (83.4677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   3,  Average loss: 0.0053, Accuracy: 454/496 (91.5323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   4,  Average loss: 0.0026, Accuracy: 478/496 (96.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   5,  Average loss: 0.0016, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 46.5880566399198.
Norm before scaling: 46.89706511922548. Distance: 8.34270707945414
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 2.1213, Accuracy: 4573/10000 (45.7300%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.1792, Accuracy: 8663/9000 (96.2556%)
Scaling by  100
Scaled Norm after poisoning: 833.1306545194457, distance: 834.2707519145089
Total norm for 4 adversaries is: 833.1306545194457. distance: 834.2707519145089
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   1,  Average loss: 0.0264, Accuracy: 368/546 (67.3993%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   2,  Average loss: 0.0078, Accuracy: 480/546 (87.9121%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   3,  Average loss: 0.0040, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   4,  Average loss: 0.0019, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   6,  Average loss: 0.0011, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Global model norm: 46.5880566399198.
Norm before scaling: 46.90170853680999. Distance: 8.723825160286404
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 2.3439, Accuracy: 4560/10000 (45.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.2126, Accuracy: 8430/9000 (93.6667%)
Scaling by  100
Scaled Norm after poisoning: 870.9440639329256, distance: 872.3826210442296
Total norm for 4 adversaries is: 870.9440639329256. distance: 872.3826210442296
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 213, local model 80, internal_epoch   1,  Average loss: 0.0244, Accuracy: 246/363 (67.7686%)
___Train Local_ResNet_18,  epoch 213, local model 80, internal_epoch   2,  Average loss: 0.0106, Accuracy: 303/363 (83.4711%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 81, internal_epoch   1,  Average loss: 0.0280, Accuracy: 623/1034 (60.2515%)
___Train Local_ResNet_18,  epoch 213, local model 81, internal_epoch   2,  Average loss: 0.0134, Accuracy: 789/1034 (76.3056%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 22, internal_epoch   1,  Average loss: 0.0348, Accuracy: 274/494 (55.4656%)
___Train Local_ResNet_18,  epoch 213, local model 22, internal_epoch   2,  Average loss: 0.0161, Accuracy: 355/494 (71.8623%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 72, internal_epoch   1,  Average loss: 0.0298, Accuracy: 372/618 (60.1942%)
___Train Local_ResNet_18,  epoch 213, local model 72, internal_epoch   2,  Average loss: 0.0110, Accuracy: 482/618 (77.9935%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 64, internal_epoch   1,  Average loss: 0.0250, Accuracy: 407/686 (59.3294%)
___Train Local_ResNet_18,  epoch 213, local model 64, internal_epoch   2,  Average loss: 0.0102, Accuracy: 543/686 (79.1545%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 45, internal_epoch   1,  Average loss: 0.0382, Accuracy: 276/529 (52.1739%)
___Train Local_ResNet_18,  epoch 213, local model 45, internal_epoch   2,  Average loss: 0.0165, Accuracy: 365/529 (68.9981%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 154.43354058265686
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3600274961333563  data num: [526, 527, 496, 546, 363, 1034, 494, 618, 686, 529]
[rfa agg] considering poison per batch poison_fraction: 0.02812714813541846
[rfa agg] init. name: [17, 33, 77, 11, 80, 81, 22, 72, 64, 45], weight: tensor([0.0904, 0.0906, 0.0852, 0.0938, 0.0624, 0.1777, 0.0849, 0.1062, 0.1179,
        0.0909])
[rfa agg] iter:  0, prev_obj_val: 11113.54296875, obj_val: 10297.7041015625, abs dis: 815.8388671875
[rfa agg] iter:  0, weight: tensor([0.0578, 0.0578, 0.0650, 0.0600, 0.0736, 0.2121, 0.1004, 0.1259, 0.1398,
        0.1076])
[rfa agg] iter:  1, prev_obj_val: 10297.7041015625, obj_val: 9689.5927734375, abs dis: 608.111328125
[rfa agg] iter:  1, weight: tensor([0.0364, 0.0364, 0.0398, 0.0378, 0.0821, 0.2380, 0.1121, 0.1407, 0.1564,
        0.1203])
[rfa agg] iter:  2, prev_obj_val: 9689.5927734375, obj_val: 9282.916015625, abs dis: 406.6767578125
[rfa agg] iter:  2, weight: tensor([0.0218, 0.0218, 0.0234, 0.0226, 0.0875, 0.2563, 0.1197, 0.1506, 0.1675,
        0.1286])
[rfa agg] iter:  3, prev_obj_val: 9282.916015625, obj_val: 9028.701171875, abs dis: 254.21484375
[rfa agg] iter:  3, weight: tensor([0.0126, 0.0127, 0.0135, 0.0131, 0.0903, 0.2695, 0.1240, 0.1565, 0.1744,
        0.1334])
[rfa agg] iter:  4, prev_obj_val: 9028.701171875, obj_val: 8877.716796875, abs dis: 150.984375
[rfa agg] iter:  4, weight: tensor([0.0072, 0.0072, 0.0076, 0.0074, 0.0910, 0.2808, 0.1256, 0.1595, 0.1783,
        0.1355])
[rfa agg] iter:  5, prev_obj_val: 8877.716796875, obj_val: 8788.8798828125, abs dis: 88.8369140625
[rfa agg] iter:  5, weight: tensor([0.0040, 0.0040, 0.0042, 0.0041, 0.0894, 0.2939, 0.1247, 0.1602, 0.1801,
        0.1354])
[rfa agg] iter:  6, prev_obj_val: 8788.8798828125, obj_val: 8737.630859375, abs dis: 51.2490234375
[rfa agg] iter:  6, weight: tensor([0.0021, 0.0021, 0.0022, 0.0022, 0.0848, 0.3154, 0.1207, 0.1583, 0.1798,
        0.1323])
[rfa agg] iter:  7, prev_obj_val: 8737.630859375, obj_val: 8710.2724609375, abs dis: 27.3583984375
[rfa agg] iter:  7, weight: tensor([0.0010, 0.0010, 0.0011, 0.0011, 0.0747, 0.3620, 0.1102, 0.1507, 0.1749,
        0.1233])
[rfa agg] iter:  8, prev_obj_val: 8710.2724609375, obj_val: 8702.666015625, abs dis: 7.6064453125
[rfa agg] iter:  8, weight: tensor([4.2076e-04, 4.2130e-04, 4.4384e-04, 4.3684e-04, 5.2994e-02, 4.8968e-01,
        8.3572e-02, 1.2386e-01, 1.5107e-01, 9.7098e-02])
[rfa agg] iter:  9, prev_obj_val: 8702.666015625, obj_val: 8703.439453125, abs dis: 0.7734375
[rfa agg] iter:  9, weight: tensor([2.2424e-04, 2.2452e-04, 2.3648e-04, 2.3280e-04, 4.2641e-02, 5.1288e-01,
        7.3231e-02, 1.2071e-01, 1.6053e-01, 8.9086e-02])
___Test Target_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 194.6336281299591 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:214 choose agents : [17, 33, 77, 11, 80, 54, 44, 35, 68, 25]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   1,  Average loss: 0.0168, Accuracy: 435/526 (82.6996%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   2,  Average loss: 0.0070, Accuracy: 471/526 (89.5437%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   3,  Average loss: 0.0060, Accuracy: 488/526 (92.7757%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   4,  Average loss: 0.0031, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   5,  Average loss: 0.0036, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   6,  Average loss: 0.0033, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 46.53196356068052.
Norm before scaling: 46.94558487710133. Distance: 8.883302485523974
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 2.8730, Accuracy: 4008/10000 (40.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.7006, Accuracy: 7333/9000 (81.4778%)
Scaling by  100
Scaled Norm after poisoning: 887.2828607608737, distance: 888.3301751038293
Total norm for 4 adversaries is: 887.2828607608737. distance: 888.3301751038293
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   1,  Average loss: 0.0254, Accuracy: 336/527 (63.7571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   2,  Average loss: 0.0074, Accuracy: 479/527 (90.8918%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   3,  Average loss: 0.0052, Accuracy: 487/527 (92.4099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   4,  Average loss: 0.0039, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   5,  Average loss: 0.0046, Accuracy: 492/527 (93.3586%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   6,  Average loss: 0.0027, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Global model norm: 46.53196356068052.
Norm before scaling: 47.073159275947795. Distance: 9.528944793595697
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 2.4169, Accuracy: 4459/10000 (44.5900%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.9711, Accuracy: 6853/9000 (76.1444%)
Scaling by  100
Scaled Norm after poisoning: 951.9239071480451, distance: 952.8945705060975
Total norm for 4 adversaries is: 951.9239071480451. distance: 952.8945705060975
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   1,  Average loss: 0.0272, Accuracy: 297/496 (59.8790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   2,  Average loss: 0.0072, Accuracy: 429/496 (86.4919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   3,  Average loss: 0.0026, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   4,  Average loss: 0.0016, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   5,  Average loss: 0.0019, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   6,  Average loss: 0.0019, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Global model norm: 46.53196356068052.
Norm before scaling: 46.648428995351765. Distance: 7.1106006949083875
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 2.0566, Accuracy: 4568/10000 (45.6800%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.0852, Accuracy: 8791/9000 (97.6778%)
Scaling by  100
Scaled Norm after poisoning: 709.7892733058171, distance: 711.060058117456
Total norm for 4 adversaries is: 709.7892733058171. distance: 711.060058117456
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   1,  Average loss: 0.0214, Accuracy: 391/546 (71.6117%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   2,  Average loss: 0.0060, Accuracy: 492/546 (90.1099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   3,  Average loss: 0.0023, Accuracy: 526/546 (96.3370%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   4,  Average loss: 0.0011, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   5,  Average loss: 0.0016, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 46.53196356068052.
Norm before scaling: 46.63263122451783. Distance: 7.3811960862764305
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 2.2249, Accuracy: 4700/10000 (47.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.1995, Accuracy: 8555/9000 (95.0556%)
Scaling by  100
Scaled Norm after poisoning: 736.5292764038643, distance: 738.1196549340764
Total norm for 4 adversaries is: 736.5292764038643. distance: 738.1196549340764
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 214, local model 80, internal_epoch   1,  Average loss: 0.0190, Accuracy: 271/363 (74.6556%)
___Train Local_ResNet_18,  epoch 214, local model 80, internal_epoch   2,  Average loss: 0.0084, Accuracy: 317/363 (87.3278%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   1,  Average loss: 0.0248, Accuracy: 269/440 (61.1364%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   2,  Average loss: 0.0087, Accuracy: 369/440 (83.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 44, internal_epoch   1,  Average loss: 0.0272, Accuracy: 243/436 (55.7339%)
___Train Local_ResNet_18,  epoch 214, local model 44, internal_epoch   2,  Average loss: 0.0101, Accuracy: 352/436 (80.7339%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 35, internal_epoch   1,  Average loss: 0.0243, Accuracy: 250/419 (59.6659%)
___Train Local_ResNet_18,  epoch 214, local model 35, internal_epoch   2,  Average loss: 0.0078, Accuracy: 346/419 (82.5776%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 68, internal_epoch   1,  Average loss: 0.0326, Accuracy: 215/416 (51.6827%)
___Train Local_ResNet_18,  epoch 214, local model 68, internal_epoch   2,  Average loss: 0.0133, Accuracy: 319/416 (76.6827%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 25, internal_epoch   1,  Average loss: 0.0248, Accuracy: 343/545 (62.9358%)
___Train Local_ResNet_18,  epoch 214, local model 25, internal_epoch   2,  Average loss: 0.0097, Accuracy: 467/545 (85.6881%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 141.8308072090149
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4444208739923632  data num: [526, 527, 496, 546, 363, 440, 436, 419, 416, 545]
[rfa agg] considering poison per batch poison_fraction: 0.03472038078065337
[rfa agg] init. name: [17, 33, 77, 11, 80, 54, 44, 35, 68, 25], weight: tensor([0.1116, 0.1118, 0.1052, 0.1158, 0.0770, 0.0933, 0.0925, 0.0889, 0.0882,
        0.1156])
[rfa agg] iter:  0, prev_obj_val: 11866.0859375, obj_val: 11717.49609375, abs dis: 148.58984375
[rfa agg] iter:  0, weight: tensor([0.0930, 0.0932, 0.1081, 0.0966, 0.0843, 0.1023, 0.1014, 0.0974, 0.0967,
        0.1269])
[rfa agg] iter:  1, prev_obj_val: 11717.49609375, obj_val: 11576.0732421875, abs dis: 141.4228515625
[rfa agg] iter:  1, weight: tensor([0.0809, 0.0810, 0.0921, 0.0840, 0.0916, 0.1112, 0.1102, 0.1059, 0.1051,
        0.1380])
[rfa agg] iter:  2, prev_obj_val: 11576.0732421875, obj_val: 11444.517578125, abs dis: 131.5556640625
[rfa agg] iter:  2, weight: tensor([0.0694, 0.0695, 0.0778, 0.0721, 0.0984, 0.1194, 0.1184, 0.1137, 0.1129,
        0.1483])
[rfa agg] iter:  3, prev_obj_val: 11444.517578125, obj_val: 11324.333984375, abs dis: 120.18359375
[rfa agg] iter:  3, weight: tensor([0.0588, 0.0589, 0.0652, 0.0611, 0.1046, 0.1270, 0.1258, 0.1209, 0.1200,
        0.1577])
[rfa agg] iter:  4, prev_obj_val: 11324.333984375, obj_val: 11217.4677734375, abs dis: 106.8662109375
[rfa agg] iter:  4, weight: tensor([0.0493, 0.0494, 0.0541, 0.0512, 0.1101, 0.1337, 0.1325, 0.1273, 0.1264,
        0.1661])
[rfa agg] iter:  5, prev_obj_val: 11217.4677734375, obj_val: 11123.943359375, abs dis: 93.5244140625
[rfa agg] iter:  5, weight: tensor([0.0409, 0.0410, 0.0445, 0.0425, 0.1149, 0.1396, 0.1383, 0.1329, 0.1319,
        0.1735])
[rfa agg] iter:  6, prev_obj_val: 11123.943359375, obj_val: 11044.201171875, abs dis: 79.7421875
[rfa agg] iter:  6, weight: tensor([0.0336, 0.0337, 0.0364, 0.0349, 0.1190, 0.1446, 0.1433, 0.1377, 0.1367,
        0.1799])
[rfa agg] iter:  7, prev_obj_val: 11044.201171875, obj_val: 10976.2763671875, abs dis: 67.9248046875
[rfa agg] iter:  7, weight: tensor([0.0275, 0.0276, 0.0296, 0.0286, 0.1225, 0.1489, 0.1475, 0.1417, 0.1407,
        0.1854])
[rfa agg] iter:  8, prev_obj_val: 10976.2763671875, obj_val: 10919.5693359375, abs dis: 56.70703125
[rfa agg] iter:  8, weight: tensor([0.0223, 0.0224, 0.0240, 0.0232, 0.1253, 0.1524, 0.1510, 0.1451, 0.1441,
        0.1901])
[rfa agg] iter:  9, prev_obj_val: 10919.5693359375, obj_val: 10872.5830078125, abs dis: 46.986328125
[rfa agg] iter:  9, weight: tensor([0.0181, 0.0181, 0.0193, 0.0188, 0.1276, 0.1554, 0.1539, 0.1479, 0.1469,
        0.1941])
___Test Target_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 177.71855473518372 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:215 choose agents : [17, 33, 77, 11, 4, 79, 43, 63, 35, 49]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 491/526 (93.3460%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   2,  Average loss: 0.0032, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   3,  Average loss: 0.0046, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   4,  Average loss: 0.0050, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   5,  Average loss: 0.0033, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   6,  Average loss: 0.0021, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Global model norm: 46.3453435540252.
Norm before scaling: 46.336463730994296. Distance: 6.299411310211821
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 2.1869, Accuracy: 4393/10000 (43.9300%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.2775, Accuracy: 8107/9000 (90.0778%)
Scaling by  100
Scaled Norm after poisoning: 628.4291676473969, distance: 629.9411182801135
Total norm for 4 adversaries is: 628.4291676473969. distance: 629.9411182801135
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 495/527 (93.9279%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 500/527 (94.8767%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   3,  Average loss: 0.0034, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   4,  Average loss: 0.0031, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   5,  Average loss: 0.0025, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   6,  Average loss: 0.0023, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 46.3453435540252.
Norm before scaling: 46.17833076695037. Distance: 5.029567460864183
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.9937, Accuracy: 4583/10000 (45.8300%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.3732, Accuracy: 7949/9000 (88.3222%)
Scaling by  100
Scaled Norm after poisoning: 501.0373925666626, distance: 502.95678865087405
Total norm for 4 adversaries is: 501.0373925666626. distance: 502.95678865087405
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 448/496 (90.3226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   2,  Average loss: 0.0024, Accuracy: 479/496 (96.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   3,  Average loss: 0.0017, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   4,  Average loss: 0.0025, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   5,  Average loss: 0.0014, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   6,  Average loss: 0.0014, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Global model norm: 46.3453435540252.
Norm before scaling: 46.156562075789935. Distance: 4.2651632988313875
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.8307, Accuracy: 4904/10000 (49.0400%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.1084, Accuracy: 8728/9000 (96.9778%)
Scaling by  100
Scaled Norm after poisoning: 424.85127912600194, distance: 426.5163207604136
Total norm for 4 adversaries is: 424.85127912600194. distance: 426.5163207604136
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   1,  Average loss: 0.0025, Accuracy: 519/546 (95.0549%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   2,  Average loss: 0.0016, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   3,  Average loss: 0.0019, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   4,  Average loss: 0.0014, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   5,  Average loss: 0.0016, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 46.3453435540252.
Norm before scaling: 46.01895149266631. Distance: 3.6197554698570538
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.8543, Accuracy: 5282/10000 (52.8200%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.1975, Accuracy: 8521/9000 (94.6778%)
Scaling by  100
Scaled Norm after poisoning: 358.9557336914957, distance: 361.9755581354907
Total norm for 4 adversaries is: 358.9557336914957. distance: 361.9755581354907
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 215, local model 4, internal_epoch   1,  Average loss: 0.0226, Accuracy: 368/557 (66.0682%)
___Train Local_ResNet_18,  epoch 215, local model 4, internal_epoch   2,  Average loss: 0.0088, Accuracy: 466/557 (83.6625%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 79, internal_epoch   1,  Average loss: 0.0362, Accuracy: 85/154 (55.1948%)
___Train Local_ResNet_18,  epoch 215, local model 79, internal_epoch   2,  Average loss: 0.0064, Accuracy: 136/154 (88.3117%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 43, internal_epoch   1,  Average loss: 0.0299, Accuracy: 198/345 (57.3913%)
___Train Local_ResNet_18,  epoch 215, local model 43, internal_epoch   2,  Average loss: 0.0104, Accuracy: 285/345 (82.6087%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 63, internal_epoch   1,  Average loss: 0.0226, Accuracy: 463/752 (61.5691%)
___Train Local_ResNet_18,  epoch 215, local model 63, internal_epoch   2,  Average loss: 0.0135, Accuracy: 569/752 (75.6649%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 35, internal_epoch   1,  Average loss: 0.0243, Accuracy: 260/419 (62.0525%)
___Train Local_ResNet_18,  epoch 215, local model 35, internal_epoch   2,  Average loss: 0.0111, Accuracy: 333/419 (79.4749%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 49, internal_epoch   1,  Average loss: 0.0242, Accuracy: 275/426 (64.5540%)
___Train Local_ResNet_18,  epoch 215, local model 49, internal_epoch   2,  Average loss: 0.0082, Accuracy: 349/426 (81.9249%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 138.81153392791748
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4412384161752317  data num: [526, 527, 496, 546, 557, 154, 345, 752, 419, 426]
[rfa agg] considering poison per batch poison_fraction: 0.034471751263689974
[rfa agg] init. name: [17, 33, 77, 11, 4, 79, 43, 63, 35, 49], weight: tensor([0.1108, 0.1110, 0.1045, 0.1150, 0.1173, 0.0324, 0.0727, 0.1584, 0.0882,
        0.0897])
[rfa agg] iter:  0, prev_obj_val: 11570.83203125, obj_val: 11409.841796875, abs dis: 160.990234375
[rfa agg] iter:  0, weight: tensor([0.0914, 0.0916, 0.1071, 0.0949, 0.1292, 0.0355, 0.0798, 0.1748, 0.0970,
        0.0986])
[rfa agg] iter:  1, prev_obj_val: 11409.841796875, obj_val: 11257.9169921875, abs dis: 151.9248046875
[rfa agg] iter:  1, weight: tensor([0.0787, 0.0789, 0.0902, 0.0817, 0.1408, 0.0387, 0.0870, 0.1907, 0.1057,
        0.1075])
[rfa agg] iter:  2, prev_obj_val: 11257.9169921875, obj_val: 11117.126953125, abs dis: 140.7900390625
[rfa agg] iter:  2, weight: tensor([0.0668, 0.0670, 0.0753, 0.0694, 0.1516, 0.0416, 0.0936, 0.2053, 0.1137,
        0.1156])
[rfa agg] iter:  3, prev_obj_val: 11117.126953125, obj_val: 10990.615234375, abs dis: 126.51171875
[rfa agg] iter:  3, weight: tensor([0.0560, 0.0561, 0.0623, 0.0581, 0.1613, 0.0442, 0.0995, 0.2186, 0.1210,
        0.1230])
[rfa agg] iter:  4, prev_obj_val: 10990.615234375, obj_val: 10879.412109375, abs dis: 111.203125
[rfa agg] iter:  4, weight: tensor([0.0463, 0.0464, 0.0510, 0.0481, 0.1698, 0.0465, 0.1047, 0.2304, 0.1273,
        0.1294])
[rfa agg] iter:  5, prev_obj_val: 10879.412109375, obj_val: 10783.5107421875, abs dis: 95.9013671875
[rfa agg] iter:  5, weight: tensor([0.0380, 0.0381, 0.0415, 0.0394, 0.1772, 0.0484, 0.1091, 0.2407, 0.1328,
        0.1350])
[rfa agg] iter:  6, prev_obj_val: 10783.5107421875, obj_val: 10701.3232421875, abs dis: 82.1875
[rfa agg] iter:  6, weight: tensor([0.0309, 0.0309, 0.0335, 0.0320, 0.1835, 0.0500, 0.1128, 0.2495, 0.1373,
        0.1396])
[rfa agg] iter:  7, prev_obj_val: 10701.3232421875, obj_val: 10633.36328125, abs dis: 67.9599609375
[rfa agg] iter:  7, weight: tensor([0.0248, 0.0249, 0.0268, 0.0258, 0.1888, 0.0513, 0.1159, 0.2572, 0.1411,
        0.1435])
[rfa agg] iter:  8, prev_obj_val: 10633.36328125, obj_val: 10577.5263671875, abs dis: 55.8369140625
[rfa agg] iter:  8, weight: tensor([0.0199, 0.0199, 0.0214, 0.0206, 0.1931, 0.0522, 0.1183, 0.2637, 0.1442,
        0.1466])
[rfa agg] iter:  9, prev_obj_val: 10577.5263671875, obj_val: 10531.177734375, abs dis: 46.3486328125
[rfa agg] iter:  9, weight: tensor([0.0158, 0.0159, 0.0170, 0.0164, 0.1967, 0.0529, 0.1202, 0.2694, 0.1466,
        0.1491])
___Test Target_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 178.29068875312805 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:216 choose agents : [17, 33, 77, 11, 8, 12, 18, 94, 57, 83]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   1,  Average loss: 0.0030, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   3,  Average loss: 0.0021, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   4,  Average loss: 0.0021, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   5,  Average loss: 0.0021, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   6,  Average loss: 0.0016, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Global model norm: 46.061307438768495.
Norm before scaling: 45.794971813064535. Distance: 4.259291421765755
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.9646, Accuracy: 4914/10000 (49.1400%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.1665, Accuracy: 8476/9000 (94.1778%)
Scaling by  100
Scaled Norm after poisoning: 423.4106864204067, distance: 425.92909474465347
Total norm for 4 adversaries is: 423.4106864204067. distance: 425.92909474465347
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   2,  Average loss: 0.0032, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   3,  Average loss: 0.0032, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   4,  Average loss: 0.0035, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   5,  Average loss: 0.0051, Accuracy: 494/527 (93.7381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   6,  Average loss: 0.0047, Accuracy: 493/527 (93.5484%), train_poison_data_count: 45
Global model norm: 46.061307438768495.
Norm before scaling: 46.14103506844531. Distance: 6.545026495452244
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 2.2816, Accuracy: 4269/10000 (42.6900%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.1627, Accuracy: 8448/9000 (93.8667%)
Scaling by  100
Scaled Norm after poisoning: 653.4115280586959, distance: 654.5026021720616
Total norm for 4 adversaries is: 653.4115280586959. distance: 654.5026021720616
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   1,  Average loss: 0.0030, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   2,  Average loss: 0.0019, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   3,  Average loss: 0.0010, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   4,  Average loss: 0.0015, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 46.061307438768495.
Norm before scaling: 45.76692395305806. Distance: 2.78697207459529
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.6206, Accuracy: 5413/10000 (54.1300%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.1107, Accuracy: 8729/9000 (96.9889%)
Scaling by  100
Scaled Norm after poisoning: 276.2495475109416, distance: 278.6972203395649
Total norm for 4 adversaries is: 276.2495475109416. distance: 278.6972203395649
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   1,  Average loss: 0.0018, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   2,  Average loss: 0.0012, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   3,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   4,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 46.061307438768495.
Norm before scaling: 45.66490656298609. Distance: 2.5680672250962444
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.6974, Accuracy: 5480/10000 (54.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.1248, Accuracy: 8637/9000 (95.9667%)
Scaling by  100
Scaled Norm after poisoning: 252.5386650470577, distance: 256.8066971235369
Total norm for 4 adversaries is: 252.5386650470577. distance: 256.8066971235369
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 216, local model 8, internal_epoch   1,  Average loss: 0.0235, Accuracy: 321/534 (60.1124%)
___Train Local_ResNet_18,  epoch 216, local model 8, internal_epoch   2,  Average loss: 0.0110, Accuracy: 426/534 (79.7753%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 3.2863, Accuracy: 3212/10000 (32.1200%)
___Train Local_ResNet_18,  epoch 216, local model 12, internal_epoch   1,  Average loss: 0.0208, Accuracy: 645/977 (66.0184%)
___Train Local_ResNet_18,  epoch 216, local model 12, internal_epoch   2,  Average loss: 0.0102, Accuracy: 784/977 (80.2456%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 2.4119, Accuracy: 4038/10000 (40.3800%)
___Train Local_ResNet_18,  epoch 216, local model 18, internal_epoch   1,  Average loss: 0.0270, Accuracy: 250/386 (64.7668%)
___Train Local_ResNet_18,  epoch 216, local model 18, internal_epoch   2,  Average loss: 0.0177, Accuracy: 249/386 (64.5078%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 9.2358, Accuracy: 2051/10000 (20.5100%)
___Train Local_ResNet_18,  epoch 216, local model 94, internal_epoch   1,  Average loss: 0.0287, Accuracy: 117/203 (57.6355%)
___Train Local_ResNet_18,  epoch 216, local model 94, internal_epoch   2,  Average loss: 0.0062, Accuracy: 181/203 (89.1626%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 216, local model 57, internal_epoch   1,  Average loss: 0.0240, Accuracy: 177/290 (61.0345%)
___Train Local_ResNet_18,  epoch 216, local model 57, internal_epoch   2,  Average loss: 0.0090, Accuracy: 243/290 (83.7931%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 216, local model 83, internal_epoch   1,  Average loss: 0.0243, Accuracy: 211/366 (57.6503%)
___Train Local_ResNet_18,  epoch 216, local model 83, internal_epoch   2,  Average loss: 0.0087, Accuracy: 306/366 (83.6066%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 3.8685, Accuracy: 3267/10000 (32.6700%)
time spent on training: 147.87970876693726
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4318697175840033  data num: [526, 527, 496, 546, 534, 977, 386, 203, 290, 366]
[rfa agg] considering poison per batch poison_fraction: 0.033739821686250254
[rfa agg] init. name: [17, 33, 77, 11, 8, 12, 18, 94, 57, 83], weight: tensor([0.1084, 0.1086, 0.1022, 0.1126, 0.1101, 0.2014, 0.0796, 0.0418, 0.0598,
        0.0754])
[rfa agg] iter:  0, prev_obj_val: 11497.0, obj_val: 11284.46484375, abs dis: 212.53515625
[rfa agg] iter:  0, weight: tensor([0.0872, 0.0873, 0.1018, 0.0906, 0.1226, 0.2256, 0.0884, 0.0464, 0.0663,
        0.0838])
[rfa agg] iter:  1, prev_obj_val: 11284.46484375, obj_val: 11086.66796875, abs dis: 197.796875
[rfa agg] iter:  1, weight: tensor([0.0729, 0.0730, 0.0831, 0.0757, 0.1346, 0.2480, 0.0971, 0.0509, 0.0728,
        0.0920])
[rfa agg] iter:  2, prev_obj_val: 11086.66796875, obj_val: 10909.064453125, abs dis: 177.603515625
[rfa agg] iter:  2, weight: tensor([0.0598, 0.0599, 0.0670, 0.0621, 0.1454, 0.2683, 0.1048, 0.0549, 0.0786,
        0.0993])
[rfa agg] iter:  3, prev_obj_val: 10909.064453125, obj_val: 10754.681640625, abs dis: 154.3828125
[rfa agg] iter:  3, weight: tensor([0.0483, 0.0483, 0.0534, 0.0501, 0.1547, 0.2862, 0.1115, 0.0584, 0.0835,
        0.1056])
[rfa agg] iter:  4, prev_obj_val: 10754.681640625, obj_val: 10622.2841796875, abs dis: 132.3974609375
[rfa agg] iter:  4, weight: tensor([0.0384, 0.0385, 0.0421, 0.0399, 0.1626, 0.3016, 0.1171, 0.0612, 0.0876,
        0.1108])
[rfa agg] iter:  5, prev_obj_val: 10622.2841796875, obj_val: 10514.3017578125, abs dis: 107.982421875
[rfa agg] iter:  5, weight: tensor([0.0302, 0.0302, 0.0328, 0.0313, 0.1692, 0.3149, 0.1217, 0.0636, 0.0910,
        0.1151])
[rfa agg] iter:  6, prev_obj_val: 10514.3017578125, obj_val: 10425.240234375, abs dis: 89.0615234375
[rfa agg] iter:  6, weight: tensor([0.0235, 0.0235, 0.0254, 0.0244, 0.1744, 0.3261, 0.1253, 0.0653, 0.0936,
        0.1184])
[rfa agg] iter:  7, prev_obj_val: 10425.240234375, obj_val: 10353.875, abs dis: 71.365234375
[rfa agg] iter:  7, weight: tensor([0.0181, 0.0181, 0.0194, 0.0188, 0.1786, 0.3360, 0.1280, 0.0666, 0.0954,
        0.1209])
[rfa agg] iter:  8, prev_obj_val: 10353.875, obj_val: 10297.7626953125, abs dis: 56.1123046875
[rfa agg] iter:  8, weight: tensor([0.0138, 0.0138, 0.0148, 0.0143, 0.1817, 0.3450, 0.1300, 0.0673, 0.0967,
        0.1226])
[rfa agg] iter:  9, prev_obj_val: 10297.7626953125, obj_val: 10253.8515625, abs dis: 43.9111328125
[rfa agg] iter:  9, weight: tensor([0.0104, 0.0104, 0.0112, 0.0108, 0.1840, 0.3535, 0.1312, 0.0676, 0.0973,
        0.1236])
___Test Target_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 189.09550523757935 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:217 choose agents : [17, 33, 77, 11, 37, 22, 38, 65, 29, 18]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   1,  Average loss: 0.0022, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   2,  Average loss: 0.0012, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   3,  Average loss: 0.0021, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   4,  Average loss: 0.0031, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   5,  Average loss: 0.0041, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   6,  Average loss: 0.0020, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Global model norm: 45.85817715641753.
Norm before scaling: 45.72306990014724. Distance: 5.018200364662849
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 2.1219, Accuracy: 4654/10000 (46.5400%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.3599, Accuracy: 8139/9000 (90.4333%)
Scaling by  100
Scaled Norm after poisoning: 500.1707520937225, distance: 501.8200312362989
Total norm for 4 adversaries is: 500.1707520937225. distance: 501.8200312362989
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   1,  Average loss: 0.0024, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   2,  Average loss: 0.0026, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   3,  Average loss: 0.0021, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   4,  Average loss: 0.0015, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   5,  Average loss: 0.0021, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   6,  Average loss: 0.0015, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Global model norm: 45.85817715641753.
Norm before scaling: 45.60378359440146. Distance: 4.005763907854984
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.7344, Accuracy: 5070/10000 (50.7000%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.2293, Accuracy: 8337/9000 (92.6333%)
Scaling by  100
Scaled Norm after poisoning: 398.28768261772797, distance: 400.576362102159
Total norm for 4 adversaries is: 398.28768261772797. distance: 400.576362102159
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   1,  Average loss: 0.0018, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   2,  Average loss: 0.0011, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   3,  Average loss: 0.0006, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   4,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 45.85817715641753.
Norm before scaling: 45.52115214895983. Distance: 2.08930942442765
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.5740, Accuracy: 5436/10000 (54.3600%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.0915, Accuracy: 8794/9000 (97.7111%)
Scaling by  100
Scaled Norm after poisoning: 205.52106035635376, distance: 208.93091898101153
Total norm for 4 adversaries is: 205.52106035635376. distance: 208.93091898101153
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   1,  Average loss: 0.0022, Accuracy: 525/546 (96.1538%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   2,  Average loss: 0.0009, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   3,  Average loss: 0.0016, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   4,  Average loss: 0.0011, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   5,  Average loss: 0.0011, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   6,  Average loss: 0.0012, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Global model norm: 45.85817715641753.
Norm before scaling: 45.484415256766795. Distance: 2.853033485908693
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.7124, Accuracy: 5459/10000 (54.5900%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.1108, Accuracy: 8637/9000 (95.9667%)
Scaling by  100
Scaled Norm after poisoning: 281.55461281960913, distance: 285.30336102559323
Total norm for 4 adversaries is: 281.55461281960913. distance: 285.30336102559323
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 217, local model 37, internal_epoch   1,  Average loss: 0.0250, Accuracy: 434/725 (59.8621%)
___Train Local_ResNet_18,  epoch 217, local model 37, internal_epoch   2,  Average loss: 0.0136, Accuracy: 514/725 (70.8966%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 3.4469, Accuracy: 2615/10000 (26.1500%)
___Train Local_ResNet_18,  epoch 217, local model 22, internal_epoch   1,  Average loss: 0.0245, Accuracy: 302/494 (61.1336%)
___Train Local_ResNet_18,  epoch 217, local model 22, internal_epoch   2,  Average loss: 0.0085, Accuracy: 415/494 (84.0081%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 4.3705, Accuracy: 3224/10000 (32.2400%)
___Train Local_ResNet_18,  epoch 217, local model 38, internal_epoch   1,  Average loss: 0.0171, Accuracy: 510/756 (67.4603%)
___Train Local_ResNet_18,  epoch 217, local model 38, internal_epoch   2,  Average loss: 0.0079, Accuracy: 649/756 (85.8466%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 3.4755, Accuracy: 3734/10000 (37.3400%)
___Train Local_ResNet_18,  epoch 217, local model 65, internal_epoch   1,  Average loss: 0.0226, Accuracy: 199/314 (63.3758%)
___Train Local_ResNet_18,  epoch 217, local model 65, internal_epoch   2,  Average loss: 0.0059, Accuracy: 274/314 (87.2611%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 12.6709, Accuracy: 1304/10000 (13.0400%)
___Train Local_ResNet_18,  epoch 217, local model 29, internal_epoch   1,  Average loss: 0.0189, Accuracy: 607/848 (71.5802%)
___Train Local_ResNet_18,  epoch 217, local model 29, internal_epoch   2,  Average loss: 0.0093, Accuracy: 704/848 (83.0189%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 4.4022, Accuracy: 2980/10000 (29.8000%)
___Train Local_ResNet_18,  epoch 217, local model 18, internal_epoch   1,  Average loss: 0.0274, Accuracy: 252/386 (65.2850%)
___Train Local_ResNet_18,  epoch 217, local model 18, internal_epoch   2,  Average loss: 0.0133, Accuracy: 299/386 (77.4611%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 4.0417, Accuracy: 3241/10000 (32.4100%)
time spent on training: 152.9575855731964
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.37290850836596656  data num: [526, 527, 496, 546, 725, 494, 756, 314, 848, 386]
[rfa agg] considering poison per batch poison_fraction: 0.029133477216091136
[rfa agg] init. name: [17, 33, 77, 11, 37, 22, 38, 65, 29, 18], weight: tensor([0.0936, 0.0938, 0.0883, 0.0972, 0.1290, 0.0879, 0.1346, 0.0559, 0.1509,
        0.0687])
[rfa agg] iter:  0, prev_obj_val: 10950.4013671875, obj_val: 10280.37890625, abs dis: 670.0224609375
[rfa agg] iter:  0, weight: tensor([0.0625, 0.0627, 0.0715, 0.0649, 0.1521, 0.1032, 0.1587, 0.0654, 0.1783,
        0.0806])
[rfa agg] iter:  1, prev_obj_val: 10280.37890625, obj_val: 9756.048828125, abs dis: 524.330078125
[rfa agg] iter:  1, weight: tensor([0.0417, 0.0418, 0.0462, 0.0433, 0.1705, 0.1155, 0.1778, 0.0731, 0.2000,
        0.0901])
[rfa agg] iter:  2, prev_obj_val: 9756.048828125, obj_val: 9381.8857421875, abs dis: 374.1630859375
[rfa agg] iter:  2, weight: tensor([0.0266, 0.0267, 0.0290, 0.0276, 0.1837, 0.1241, 0.1915, 0.0783, 0.2158,
        0.0967])
[rfa agg] iter:  3, prev_obj_val: 9381.8857421875, obj_val: 9131.705078125, abs dis: 250.1806640625
[rfa agg] iter:  3, weight: tensor([0.0164, 0.0165, 0.0177, 0.0171, 0.1927, 0.1295, 0.2009, 0.0814, 0.2270,
        0.1008])
[rfa agg] iter:  4, prev_obj_val: 9131.705078125, obj_val: 8970.2392578125, abs dis: 161.4658203125
[rfa agg] iter:  4, weight: tensor([0.0099, 0.0099, 0.0106, 0.0103, 0.1988, 0.1324, 0.2073, 0.0827, 0.2352,
        0.1029])
[rfa agg] iter:  5, prev_obj_val: 8970.2392578125, obj_val: 8871.337890625, abs dis: 98.9013671875
[rfa agg] iter:  5, weight: tensor([0.0058, 0.0058, 0.0062, 0.0060, 0.2032, 0.1332, 0.2119, 0.0824, 0.2424,
        0.1031])
[rfa agg] iter:  6, prev_obj_val: 8871.337890625, obj_val: 8813.400390625, abs dis: 57.9375
[rfa agg] iter:  6, weight: tensor([0.0033, 0.0033, 0.0036, 0.0035, 0.2068, 0.1319, 0.2157, 0.0800, 0.2504,
        0.1015])
[rfa agg] iter:  7, prev_obj_val: 8813.400390625, obj_val: 8778.271484375, abs dis: 35.12890625
[rfa agg] iter:  7, weight: tensor([0.0019, 0.0019, 0.0020, 0.0020, 0.2104, 0.1279, 0.2194, 0.0752, 0.2619,
        0.0973])
[rfa agg] iter:  8, prev_obj_val: 8778.271484375, obj_val: 8755.8837890625, abs dis: 22.3876953125
[rfa agg] iter:  8, weight: tensor([0.0010, 0.0010, 0.0011, 0.0011, 0.2145, 0.1192, 0.2238, 0.0665, 0.2829,
        0.0890])
[rfa agg] iter:  9, prev_obj_val: 8755.8837890625, obj_val: 8745.6953125, abs dis: 10.1884765625
[rfa agg] iter:  9, weight: tensor([0.0004, 0.0004, 0.0005, 0.0005, 0.2162, 0.0972, 0.2260, 0.0491, 0.3398,
        0.0698])
___Test Target_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 194.51534461975098 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:218 choose agents : [17, 33, 77, 11, 53, 15, 7, 29, 86, 60]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   1,  Average loss: 0.0026, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   2,  Average loss: 0.0014, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   3,  Average loss: 0.0028, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   4,  Average loss: 0.0016, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   5,  Average loss: 0.0029, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   6,  Average loss: 0.0020, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Global model norm: 45.806296476303345.
Norm before scaling: 45.51327287520092. Distance: 3.848021576089306
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 2.0041, Accuracy: 4751/10000 (47.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.3737, Accuracy: 7796/9000 (86.6222%)
Scaling by  100
Scaled Norm after poisoning: 382.118212239354, distance: 384.8021813217799
Total norm for 4 adversaries is: 382.118212239354. distance: 384.8021813217799
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   1,  Average loss: 0.0034, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   2,  Average loss: 0.0023, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   3,  Average loss: 0.0017, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   4,  Average loss: 0.0014, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   5,  Average loss: 0.0020, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   6,  Average loss: 0.0019, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Global model norm: 45.806296476303345.
Norm before scaling: 45.445618041993335. Distance: 2.8155557774238664
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.8366, Accuracy: 4938/10000 (49.3800%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.2762, Accuracy: 8097/9000 (89.9667%)
Scaling by  100
Scaled Norm after poisoning: 278.0067866752537, distance: 281.555570114498
Total norm for 4 adversaries is: 278.0067866752537. distance: 281.555570114498
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   1,  Average loss: 0.0021, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   2,  Average loss: 0.0014, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   3,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   4,  Average loss: 0.0006, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 45.806296476303345.
Norm before scaling: 45.47684635820188. Distance: 2.0138579910655845
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.4211, Accuracy: 5842/10000 (58.4200%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.1219, Accuracy: 8712/9000 (96.8000%)
Scaling by  100
Scaled Norm after poisoning: 198.09496026211772, distance: 201.38579463619075
Total norm for 4 adversaries is: 198.09496026211772. distance: 201.38579463619075
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   1,  Average loss: 0.0024, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   2,  Average loss: 0.0014, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   3,  Average loss: 0.0009, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   4,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 45.806296476303345.
Norm before scaling: 45.4540300485694. Distance: 2.797099354872006
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.7343, Accuracy: 5577/10000 (55.7700%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.2266, Accuracy: 8511/9000 (94.5667%)
Scaling by  100
Scaled Norm after poisoning: 276.2945665408569, distance: 279.7099222855707
Total norm for 4 adversaries is: 276.2945665408569. distance: 279.7099222855707
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 218, local model 53, internal_epoch   1,  Average loss: 0.0185, Accuracy: 407/625 (65.1200%)
___Train Local_ResNet_18,  epoch 218, local model 53, internal_epoch   2,  Average loss: 0.0075, Accuracy: 538/625 (86.0800%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 3.3079, Accuracy: 3521/10000 (35.2100%)
___Train Local_ResNet_18,  epoch 218, local model 15, internal_epoch   1,  Average loss: 0.0245, Accuracy: 218/341 (63.9296%)
___Train Local_ResNet_18,  epoch 218, local model 15, internal_epoch   2,  Average loss: 0.0078, Accuracy: 290/341 (85.0440%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 3.1086, Accuracy: 3725/10000 (37.2500%)
___Train Local_ResNet_18,  epoch 218, local model 7, internal_epoch   1,  Average loss: 0.0199, Accuracy: 217/352 (61.6477%)
___Train Local_ResNet_18,  epoch 218, local model 7, internal_epoch   2,  Average loss: 0.0059, Accuracy: 313/352 (88.9205%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 5.8470, Accuracy: 2773/10000 (27.7300%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   1,  Average loss: 0.0151, Accuracy: 649/848 (76.5330%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   2,  Average loss: 0.0067, Accuracy: 743/848 (87.6179%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 3.8073, Accuracy: 3518/10000 (35.1800%)
___Train Local_ResNet_18,  epoch 218, local model 86, internal_epoch   1,  Average loss: 0.0277, Accuracy: 127/212 (59.9057%)
___Train Local_ResNet_18,  epoch 218, local model 86, internal_epoch   2,  Average loss: 0.0061, Accuracy: 191/212 (90.0943%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 4.4472, Accuracy: 2388/10000 (23.8800%)
___Train Local_ResNet_18,  epoch 218, local model 60, internal_epoch   1,  Average loss: 0.0238, Accuracy: 175/284 (61.6197%)
___Train Local_ResNet_18,  epoch 218, local model 60, internal_epoch   2,  Average loss: 0.0070, Accuracy: 247/284 (86.9718%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 4.2568, Accuracy: 2851/10000 (28.5100%)
time spent on training: 151.39012360572815
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4404036157241959  data num: [526, 527, 496, 546, 625, 341, 352, 848, 212, 284]
[rfa agg] considering poison per batch poison_fraction: 0.0344065324784528
[rfa agg] init. name: [17, 33, 77, 11, 53, 15, 7, 29, 86, 60], weight: tensor([0.1106, 0.1108, 0.1043, 0.1148, 0.1314, 0.0717, 0.0740, 0.1783, 0.0446,
        0.0597])
[rfa agg] iter:  0, prev_obj_val: 11549.923828125, obj_val: 11384.9716796875, abs dis: 164.9521484375
[rfa agg] iter:  0, weight: tensor([0.0910, 0.0912, 0.1066, 0.0945, 0.1449, 0.0788, 0.0813, 0.1973, 0.0489,
        0.0656])
[rfa agg] iter:  1, prev_obj_val: 11384.9716796875, obj_val: 11230.2001953125, abs dis: 154.771484375
[rfa agg] iter:  1, weight: tensor([0.0781, 0.0783, 0.0895, 0.0811, 0.1581, 0.0859, 0.0887, 0.2154, 0.0533,
        0.0715])
[rfa agg] iter:  2, prev_obj_val: 11230.2001953125, obj_val: 11088.259765625, abs dis: 141.9404296875
[rfa agg] iter:  2, weight: tensor([0.0662, 0.0663, 0.0746, 0.0687, 0.1702, 0.0924, 0.0954, 0.2320, 0.0573,
        0.0769])
[rfa agg] iter:  3, prev_obj_val: 11088.259765625, obj_val: 10959.6748046875, abs dis: 128.5849609375
[rfa agg] iter:  3, weight: tensor([0.0554, 0.0555, 0.0616, 0.0575, 0.1810, 0.0982, 0.1014, 0.2469, 0.0609,
        0.0817])
[rfa agg] iter:  4, prev_obj_val: 10959.6748046875, obj_val: 10846.57421875, abs dis: 113.1005859375
[rfa agg] iter:  4, weight: tensor([0.0457, 0.0458, 0.0503, 0.0475, 0.1906, 0.1033, 0.1066, 0.2603, 0.0640,
        0.0859])
[rfa agg] iter:  5, prev_obj_val: 10846.57421875, obj_val: 10748.953125, abs dis: 97.62109375
[rfa agg] iter:  5, weight: tensor([0.0374, 0.0374, 0.0408, 0.0388, 0.1988, 0.1076, 0.1111, 0.2720, 0.0666,
        0.0894])
[rfa agg] iter:  6, prev_obj_val: 10748.953125, obj_val: 10666.8056640625, abs dis: 82.1474609375
[rfa agg] iter:  6, weight: tensor([0.0302, 0.0303, 0.0328, 0.0314, 0.2059, 0.1112, 0.1148, 0.2822, 0.0688,
        0.0924])
[rfa agg] iter:  7, prev_obj_val: 10666.8056640625, obj_val: 10598.52734375, abs dis: 68.2783203125
[rfa agg] iter:  7, weight: tensor([0.0243, 0.0243, 0.0262, 0.0252, 0.2118, 0.1141, 0.1178, 0.2910, 0.0705,
        0.0948])
[rfa agg] iter:  8, prev_obj_val: 10598.52734375, obj_val: 10541.455078125, abs dis: 57.072265625
[rfa agg] iter:  8, weight: tensor([0.0194, 0.0194, 0.0209, 0.0201, 0.2167, 0.1164, 0.1202, 0.2986, 0.0718,
        0.0966])
[rfa agg] iter:  9, prev_obj_val: 10541.455078125, obj_val: 10493.98828125, abs dis: 47.466796875
[rfa agg] iter:  9, weight: tensor([0.0153, 0.0154, 0.0164, 0.0159, 0.2207, 0.1181, 0.1220, 0.3055, 0.0728,
        0.0979])
___Test Target_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.1633, Accuracy: 6205/10000 (62.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.3602, Accuracy: 8111/9000 (90.1222%)
Done in 192.89773893356323 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:219 choose agents : [17, 33, 77, 11, 81, 8, 28, 1, 93, 53]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   1,  Average loss: 0.0018, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   2,  Average loss: 0.0012, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   3,  Average loss: 0.0015, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   4,  Average loss: 0.0012, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   5,  Average loss: 0.0030, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   6,  Average loss: 0.0038, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Global model norm: 45.517000815972594.
Norm before scaling: 45.127774055573994. Distance: 2.730722309176454
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.6699, Accuracy: 5281/10000 (52.8100%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.2793, Accuracy: 8087/9000 (89.8556%)
Scaling by  100
Scaled Norm after poisoning: 269.0100340833033, distance: 273.0722489104303
Total norm for 4 adversaries is: 269.0100340833033. distance: 273.0722489104303
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   1,  Average loss: 0.0017, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   2,  Average loss: 0.0011, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   3,  Average loss: 0.0017, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   4,  Average loss: 0.0015, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   5,  Average loss: 0.0007, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   6,  Average loss: 0.0010, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Global model norm: 45.517000815972594.
Norm before scaling: 45.165305104208585. Distance: 2.7303559330457565
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.7267, Accuracy: 5253/10000 (52.5300%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.2042, Accuracy: 8428/9000 (93.6444%)
Scaling by  100
Scaled Norm after poisoning: 269.6024706628261, distance: 273.0355831892613
Total norm for 4 adversaries is: 269.6024706628261. distance: 273.0355831892613
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   1,  Average loss: 0.0021, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   2,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   3,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   4,  Average loss: 0.0002, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 45.517000815972594.
Norm before scaling: 45.17433677570707. Distance: 1.8708504217963213
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.3996, Accuracy: 5890/10000 (58.9000%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.0863, Accuracy: 8796/9000 (97.7333%)
Scaling by  100
Scaled Norm after poisoning: 183.34381125361173, distance: 187.08507214299595
Total norm for 4 adversaries is: 183.34381125361173. distance: 187.08507214299595
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   2,  Average loss: 0.0006, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   3,  Average loss: 0.0011, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   4,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   5,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   6,  Average loss: 0.0001, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Global model norm: 45.517000815972594.
Norm before scaling: 45.11255860994738. Distance: 2.162881356719464
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.6300, Accuracy: 5651/10000 (56.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.1719, Accuracy: 8595/9000 (95.5000%)
Scaling by  100
Scaled Norm after poisoning: 211.4689878268206, distance: 216.2881288640225
Total norm for 4 adversaries is: 211.4689878268206. distance: 216.2881288640225
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 219, local model 81, internal_epoch   1,  Average loss: 0.0167, Accuracy: 759/1034 (73.4043%)
___Train Local_ResNet_18,  epoch 219, local model 81, internal_epoch   2,  Average loss: 0.0081, Accuracy: 873/1034 (84.4294%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 3.8856, Accuracy: 3485/10000 (34.8500%)
___Train Local_ResNet_18,  epoch 219, local model 8, internal_epoch   1,  Average loss: 0.0177, Accuracy: 350/534 (65.5431%)
___Train Local_ResNet_18,  epoch 219, local model 8, internal_epoch   2,  Average loss: 0.0059, Accuracy: 466/534 (87.2659%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.7131, Accuracy: 3590/10000 (35.9000%)
___Train Local_ResNet_18,  epoch 219, local model 28, internal_epoch   1,  Average loss: 0.0210, Accuracy: 267/423 (63.1206%)
___Train Local_ResNet_18,  epoch 219, local model 28, internal_epoch   2,  Average loss: 0.0072, Accuracy: 365/423 (86.2884%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.7747, Accuracy: 4273/10000 (42.7300%)
___Train Local_ResNet_18,  epoch 219, local model 1, internal_epoch   1,  Average loss: 0.0227, Accuracy: 435/641 (67.8627%)
___Train Local_ResNet_18,  epoch 219, local model 1, internal_epoch   2,  Average loss: 0.0151, Accuracy: 483/641 (75.3510%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 3.4453, Accuracy: 3086/10000 (30.8600%)
___Train Local_ResNet_18,  epoch 219, local model 93, internal_epoch   1,  Average loss: 0.0178, Accuracy: 422/584 (72.2603%)
___Train Local_ResNet_18,  epoch 219, local model 93, internal_epoch   2,  Average loss: 0.0114, Accuracy: 449/584 (76.8836%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 11.0683, Accuracy: 1753/10000 (17.5300%)
___Train Local_ResNet_18,  epoch 219, local model 53, internal_epoch   1,  Average loss: 0.0196, Accuracy: 407/625 (65.1200%)
___Train Local_ResNet_18,  epoch 219, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 540/625 (86.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 3.8176, Accuracy: 3413/10000 (34.1300%)
time spent on training: 153.28816533088684
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.35293126684636117  data num: [526, 527, 496, 546, 1034, 534, 423, 641, 584, 625]
[rfa agg] considering poison per batch poison_fraction: 0.027572755222371965
[rfa agg] init. name: [17, 33, 77, 11, 81, 8, 28, 1, 93, 53], weight: tensor([0.0886, 0.0888, 0.0836, 0.0920, 0.1742, 0.0900, 0.0713, 0.1080, 0.0984,
        0.1053])
[rfa agg] iter:  0, prev_obj_val: 10687.1279296875, obj_val: 9831.8408203125, abs dis: 855.287109375
[rfa agg] iter:  0, weight: tensor([0.0550, 0.0551, 0.0624, 0.0571, 0.2086, 0.1068, 0.0844, 0.1285, 0.1169,
        0.1252])
[rfa agg] iter:  1, prev_obj_val: 9831.8408203125, obj_val: 9212.126953125, abs dis: 619.7138671875
[rfa agg] iter:  1, weight: tensor([0.0336, 0.0336, 0.0370, 0.0348, 0.2339, 0.1192, 0.0941, 0.1435, 0.1306,
        0.1397])
[rfa agg] iter:  2, prev_obj_val: 9212.126953125, obj_val: 8809.5283203125, abs dis: 402.5986328125
[rfa agg] iter:  2, weight: tensor([0.0195, 0.0195, 0.0211, 0.0202, 0.2513, 0.1269, 0.1000, 0.1532, 0.1392,
        0.1490])
[rfa agg] iter:  3, prev_obj_val: 8809.5283203125, obj_val: 8567.4599609375, abs dis: 242.068359375
[rfa agg] iter:  3, weight: tensor([0.0109, 0.0110, 0.0117, 0.0113, 0.2639, 0.1311, 0.1029, 0.1589, 0.1441,
        0.1542])
[rfa agg] iter:  4, prev_obj_val: 8567.4599609375, obj_val: 8426.7158203125, abs dis: 140.744140625
[rfa agg] iter:  4, weight: tensor([0.0060, 0.0060, 0.0064, 0.0062, 0.2752, 0.1325, 0.1032, 0.1618, 0.1462,
        0.1564])
[rfa agg] iter:  5, prev_obj_val: 8426.7158203125, obj_val: 8347.849609375, abs dis: 78.8662109375
[rfa agg] iter:  5, weight: tensor([0.0032, 0.0032, 0.0034, 0.0033, 0.2902, 0.1313, 0.1009, 0.1627, 0.1458,
        0.1561])
[rfa agg] iter:  6, prev_obj_val: 8347.849609375, obj_val: 8304.6064453125, abs dis: 43.2431640625
[rfa agg] iter:  6, weight: tensor([0.0016, 0.0016, 0.0017, 0.0017, 0.3178, 0.1262, 0.0945, 0.1608, 0.1421,
        0.1521])
[rfa agg] iter:  7, prev_obj_val: 8304.6064453125, obj_val: 8284.125, abs dis: 20.4814453125
[rfa agg] iter:  7, weight: tensor([0.0007, 0.0007, 0.0008, 0.0008, 0.3870, 0.1118, 0.0797, 0.1508, 0.1292,
        0.1384])
[rfa agg] iter:  8, prev_obj_val: 8284.125, obj_val: 8280.4677734375, abs dis: 3.6572265625
[rfa agg] iter:  8, weight: tensor([2.6277e-04, 2.6328e-04, 2.7901e-04, 2.7278e-04, 5.9721e-01, 7.1052e-02,
        4.7013e-02, 1.0587e-01, 8.5749e-02, 9.2026e-02])
[rfa agg] iter:  9, prev_obj_val: 8280.4677734375, obj_val: 8281.802734375, abs dis: 1.3349609375
[rfa agg] iter:  9, weight: tensor([2.0306e-04, 2.0346e-04, 2.1556e-04, 2.1080e-04, 4.1005e-01, 9.7387e-02,
        5.7492e-02, 1.7267e-01, 1.2562e-01, 1.3595e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.0878, Accuracy: 6362/10000 (63.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.6171, Accuracy: 7532/9000 (83.6889%)
Done in 195.21373772621155 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:220 choose agents : [17, 33, 77, 11, 12, 50, 10, 18, 39, 62]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   1,  Average loss: 0.0019, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   2,  Average loss: 0.0018, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   3,  Average loss: 0.0020, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   4,  Average loss: 0.0025, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   5,  Average loss: 0.0024, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   6,  Average loss: 0.0020, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Global model norm: 45.47385065892265.
Norm before scaling: 45.15405352573219. Distance: 3.4892517995155297
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.6839, Accuracy: 5350/10000 (53.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.1013, Accuracy: 8674/9000 (96.3778%)
Scaling by  100
Scaled Norm after poisoning: 345.97825527769805, distance: 348.9251912122425
Total norm for 4 adversaries is: 345.97825527769805. distance: 348.9251912122425
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   1,  Average loss: 0.0019, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   2,  Average loss: 0.0012, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   3,  Average loss: 0.0024, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   4,  Average loss: 0.0022, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   5,  Average loss: 0.0010, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   6,  Average loss: 0.0014, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Global model norm: 45.47385065892265.
Norm before scaling: 45.108897371475535. Distance: 2.675177602130725
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.4445, Accuracy: 5668/10000 (56.6800%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.1734, Accuracy: 8444/9000 (93.8222%)
Scaling by  100
Scaled Norm after poisoning: 263.84115723290785, distance: 267.51775642001786
Total norm for 4 adversaries is: 263.84115723290785. distance: 267.51775642001786
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   1,  Average loss: 0.0020, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   2,  Average loss: 0.0010, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   3,  Average loss: 0.0011, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Global model norm: 45.47385065892265.
Norm before scaling: 45.13679295347644. Distance: 1.8260709520491598
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.3527, Accuracy: 5945/10000 (59.4500%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.1208, Accuracy: 8712/9000 (96.8000%)
Scaling by  100
Scaled Norm after poisoning: 178.95732622436836, distance: 182.6070961449746
Total norm for 4 adversaries is: 178.95732622436836. distance: 182.6070961449746
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   1,  Average loss: 0.0018, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   2,  Average loss: 0.0006, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   3,  Average loss: 0.0005, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   4,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   5,  Average loss: 0.0006, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   6,  Average loss: 0.0002, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Global model norm: 45.47385065892265.
Norm before scaling: 45.07053391456274. Distance: 2.1902009910078943
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.6669, Accuracy: 5588/10000 (55.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.1525, Accuracy: 8617/9000 (95.7444%)
Scaling by  100
Scaled Norm after poisoning: 214.25743861065828, distance: 219.02012785643697
Total norm for 4 adversaries is: 214.25743861065828. distance: 219.02012785643697
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 220, local model 12, internal_epoch   1,  Average loss: 0.0147, Accuracy: 713/977 (72.9785%)
___Train Local_ResNet_18,  epoch 220, local model 12, internal_epoch   2,  Average loss: 0.0078, Accuracy: 829/977 (84.8516%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 2.6754, Accuracy: 4256/10000 (42.5600%)
___Train Local_ResNet_18,  epoch 220, local model 50, internal_epoch   1,  Average loss: 0.0148, Accuracy: 305/401 (76.0599%)
___Train Local_ResNet_18,  epoch 220, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 365/401 (91.0224%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 3.8661, Accuracy: 3259/10000 (32.5900%)
___Train Local_ResNet_18,  epoch 220, local model 10, internal_epoch   1,  Average loss: 0.0136, Accuracy: 579/752 (76.9947%)
___Train Local_ResNet_18,  epoch 220, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 698/752 (92.8191%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 4.6233, Accuracy: 3199/10000 (31.9900%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   1,  Average loss: 0.0172, Accuracy: 271/386 (70.2073%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   2,  Average loss: 0.0083, Accuracy: 340/386 (88.0829%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 8.6255, Accuracy: 1471/10000 (14.7100%)
___Train Local_ResNet_18,  epoch 220, local model 39, internal_epoch   1,  Average loss: 0.0240, Accuracy: 127/217 (58.5253%)
___Train Local_ResNet_18,  epoch 220, local model 39, internal_epoch   2,  Average loss: 0.0052, Accuracy: 200/217 (92.1659%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 9.2090, Accuracy: 1688/10000 (16.8800%)
___Train Local_ResNet_18,  epoch 220, local model 62, internal_epoch   1,  Average loss: 0.0193, Accuracy: 239/358 (66.7598%)
___Train Local_ResNet_18,  epoch 220, local model 62, internal_epoch   2,  Average loss: 0.0051, Accuracy: 326/358 (91.0615%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 2.3741, Accuracy: 4189/10000 (41.8900%)
time spent on training: 151.58877515792847
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.40397223293482454  data num: [526, 527, 496, 546, 977, 401, 752, 386, 217, 358]
[rfa agg] considering poison per batch poison_fraction: 0.03156033069803317
[rfa agg] init. name: [17, 33, 77, 11, 12, 50, 10, 18, 39, 62], weight: tensor([0.1014, 0.1016, 0.0956, 0.1053, 0.1884, 0.0773, 0.1450, 0.0744, 0.0418,
        0.0690])
[rfa agg] iter:  0, prev_obj_val: 11276.4169921875, obj_val: 10872.474609375, abs dis: 403.9423828125
[rfa agg] iter:  0, weight: tensor([0.0752, 0.0754, 0.0869, 0.0781, 0.2174, 0.0885, 0.1667, 0.0852, 0.0477,
        0.0789])
[rfa agg] iter:  1, prev_obj_val: 10872.474609375, obj_val: 10521.8662109375, abs dis: 350.6083984375
[rfa agg] iter:  1, weight: tensor([0.0570, 0.0571, 0.0640, 0.0592, 0.2426, 0.0985, 0.1858, 0.0948, 0.0531,
        0.0878])
[rfa agg] iter:  2, prev_obj_val: 10521.8662109375, obj_val: 10234.869140625, abs dis: 286.9970703125
[rfa agg] iter:  2, weight: tensor([0.0418, 0.0419, 0.0461, 0.0434, 0.2635, 0.1066, 0.2015, 0.1026, 0.0574,
        0.0950])
[rfa agg] iter:  3, prev_obj_val: 10234.869140625, obj_val: 10012.3310546875, abs dis: 222.5380859375
[rfa agg] iter:  3, weight: tensor([0.0299, 0.0300, 0.0326, 0.0311, 0.2803, 0.1127, 0.2138, 0.1085, 0.0606,
        0.1004])
[rfa agg] iter:  4, prev_obj_val: 10012.3310546875, obj_val: 9845.6484375, abs dis: 166.6826171875
[rfa agg] iter:  4, weight: tensor([0.0210, 0.0210, 0.0227, 0.0218, 0.2935, 0.1171, 0.2231, 0.1127, 0.0628,
        0.1042])
[rfa agg] iter:  5, prev_obj_val: 9845.6484375, obj_val: 9725.369140625, abs dis: 120.279296875
[rfa agg] iter:  5, weight: tensor([0.0145, 0.0145, 0.0155, 0.0150, 0.3043, 0.1200, 0.2300, 0.1155, 0.0641,
        0.1066])
[rfa agg] iter:  6, prev_obj_val: 9725.369140625, obj_val: 9640.3173828125, abs dis: 85.0517578125
[rfa agg] iter:  6, weight: tensor([0.0099, 0.0099, 0.0105, 0.0102, 0.3138, 0.1214, 0.2352, 0.1169, 0.0645,
        0.1077])
[rfa agg] iter:  7, prev_obj_val: 9640.3173828125, obj_val: 9579.330078125, abs dis: 60.9873046875
[rfa agg] iter:  7, weight: tensor([0.0066, 0.0066, 0.0071, 0.0069, 0.3233, 0.1216, 0.2392, 0.1171, 0.0640,
        0.1076])
[rfa agg] iter:  8, prev_obj_val: 9579.330078125, obj_val: 9538.1123046875, abs dis: 41.2177734375
[rfa agg] iter:  8, weight: tensor([0.0043, 0.0043, 0.0046, 0.0045, 0.3351, 0.1203, 0.2425, 0.1158, 0.0625,
        0.1060])
[rfa agg] iter:  9, prev_obj_val: 9538.1123046875, obj_val: 9510.6591796875, abs dis: 27.453125
[rfa agg] iter:  9, weight: tensor([0.0028, 0.0028, 0.0030, 0.0029, 0.3513, 0.1172, 0.2452, 0.1128, 0.0597,
        0.1025])
___Test Target_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.0800, Accuracy: 6375/10000 (63.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.6599, Accuracy: 7436/9000 (82.6222%)
Done in 194.00674414634705 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:221 choose agents : [17, 33, 77, 11, 65, 87, 12, 74, 4, 7]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   1,  Average loss: 0.0031, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   2,  Average loss: 0.0013, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   3,  Average loss: 0.0012, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   4,  Average loss: 0.0015, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   5,  Average loss: 0.0036, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   6,  Average loss: 0.0030, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Global model norm: 45.39333307326088.
Norm before scaling: 45.04075032071652. Distance: 3.0892757853467354
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.6743, Accuracy: 5279/10000 (52.7900%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.4399, Accuracy: 7695/9000 (85.5000%)
Scaling by  100
Scaled Norm after poisoning: 305.5386764592987, distance: 308.9275678658349
Total norm for 4 adversaries is: 305.5386764592987. distance: 308.9275678658349
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   1,  Average loss: 0.0023, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   2,  Average loss: 0.0013, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   3,  Average loss: 0.0021, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   4,  Average loss: 0.0007, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   5,  Average loss: 0.0009, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   6,  Average loss: 0.0006, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Global model norm: 45.39333307326088.
Norm before scaling: 45.00522159375649. Distance: 2.125101872414508
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.5137, Accuracy: 5518/10000 (55.1800%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.2120, Accuracy: 8387/9000 (93.1889%)
Scaling by  100
Scaled Norm after poisoning: 207.9929010206839, distance: 212.51018357951696
Total norm for 4 adversaries is: 207.9929010206839. distance: 212.51018357951696
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   1,  Average loss: 0.0020, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   2,  Average loss: 0.0010, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   3,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   4,  Average loss: 0.0008, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Global model norm: 45.39333307326088.
Norm before scaling: 45.05679873564796. Distance: 1.803191849181735
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.2873, Accuracy: 6062/10000 (60.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.1325, Accuracy: 8692/9000 (96.5778%)
Scaling by  100
Scaled Norm after poisoning: 176.65345002645716, distance: 180.31918315171018
Total norm for 4 adversaries is: 176.65345002645716. distance: 180.31918315171018
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   1,  Average loss: 0.0019, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   2,  Average loss: 0.0012, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   3,  Average loss: 0.0007, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   4,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 45.39333307326088.
Norm before scaling: 44.999845377338524. Distance: 2.1433078632453086
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.5820, Accuracy: 5736/10000 (57.3600%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.1842, Accuracy: 8587/9000 (95.4111%)
Scaling by  100
Scaled Norm after poisoning: 209.71883148933003, distance: 214.33078990196438
Total norm for 4 adversaries is: 209.71883148933003. distance: 214.33078990196438
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 221, local model 65, internal_epoch   1,  Average loss: 0.0206, Accuracy: 200/314 (63.6943%)
___Train Local_ResNet_18,  epoch 221, local model 65, internal_epoch   2,  Average loss: 0.0047, Accuracy: 281/314 (89.4904%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 7.3716, Accuracy: 1664/10000 (16.6400%)
___Train Local_ResNet_18,  epoch 221, local model 87, internal_epoch   1,  Average loss: 0.0231, Accuracy: 235/397 (59.1940%)
___Train Local_ResNet_18,  epoch 221, local model 87, internal_epoch   2,  Average loss: 0.0088, Accuracy: 339/397 (85.3904%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 2.4854, Accuracy: 4007/10000 (40.0700%)
___Train Local_ResNet_18,  epoch 221, local model 12, internal_epoch   1,  Average loss: 0.0141, Accuracy: 725/977 (74.2068%)
___Train Local_ResNet_18,  epoch 221, local model 12, internal_epoch   2,  Average loss: 0.0081, Accuracy: 811/977 (83.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 2.1175, Accuracy: 4591/10000 (45.9100%)
___Train Local_ResNet_18,  epoch 221, local model 74, internal_epoch   1,  Average loss: 0.0209, Accuracy: 317/469 (67.5906%)
___Train Local_ResNet_18,  epoch 221, local model 74, internal_epoch   2,  Average loss: 0.0062, Accuracy: 413/469 (88.0597%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 2.8725, Accuracy: 3794/10000 (37.9400%)
___Train Local_ResNet_18,  epoch 221, local model 4, internal_epoch   1,  Average loss: 0.0161, Accuracy: 385/557 (69.1203%)
___Train Local_ResNet_18,  epoch 221, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 516/557 (92.6391%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 2.9676, Accuracy: 4612/10000 (46.1200%)
___Train Local_ResNet_18,  epoch 221, local model 7, internal_epoch   1,  Average loss: 0.0185, Accuracy: 230/352 (65.3409%)
___Train Local_ResNet_18,  epoch 221, local model 7, internal_epoch   2,  Average loss: 0.0052, Accuracy: 324/352 (92.0455%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 3.7596, Accuracy: 3446/10000 (34.4600%)
time spent on training: 154.5455026626587
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4059290835109475  data num: [526, 527, 496, 546, 314, 397, 977, 469, 557, 352]
[rfa agg] considering poison per batch poison_fraction: 0.03171320964929277
[rfa agg] init. name: [17, 33, 77, 11, 65, 87, 12, 74, 4, 7], weight: tensor([0.1019, 0.1021, 0.0961, 0.1058, 0.0608, 0.0769, 0.1893, 0.0909, 0.1079,
        0.0682])
[rfa agg] iter:  0, prev_obj_val: 11296.373046875, obj_val: 10905.728515625, abs dis: 390.64453125
[rfa agg] iter:  0, weight: tensor([0.0760, 0.0762, 0.0879, 0.0790, 0.0694, 0.0879, 0.2182, 0.1040, 0.1236,
        0.0779])
[rfa agg] iter:  1, prev_obj_val: 10905.728515625, obj_val: 10564.796875, abs dis: 340.931640625
[rfa agg] iter:  1, weight: tensor([0.0580, 0.0581, 0.0652, 0.0602, 0.0772, 0.0979, 0.2435, 0.1158, 0.1376,
        0.0867])
[rfa agg] iter:  2, prev_obj_val: 10564.796875, obj_val: 10286.1787109375, abs dis: 278.6181640625
[rfa agg] iter:  2, weight: tensor([0.0428, 0.0429, 0.0473, 0.0445, 0.0836, 0.1060, 0.2646, 0.1254, 0.1492,
        0.0938])
[rfa agg] iter:  3, prev_obj_val: 10286.1787109375, obj_val: 10068.1787109375, abs dis: 218.0
[rfa agg] iter:  3, weight: tensor([0.0309, 0.0310, 0.0337, 0.0321, 0.0884, 0.1122, 0.2815, 0.1328, 0.1581,
        0.0993])
[rfa agg] iter:  4, prev_obj_val: 10068.1787109375, obj_val: 9902.369140625, abs dis: 165.8095703125
[rfa agg] iter:  4, weight: tensor([0.0219, 0.0220, 0.0237, 0.0228, 0.0917, 0.1167, 0.2951, 0.1383, 0.1647,
        0.1032])
[rfa agg] iter:  5, prev_obj_val: 9902.369140625, obj_val: 9782.013671875, abs dis: 120.35546875
[rfa agg] iter:  5, weight: tensor([0.0152, 0.0153, 0.0164, 0.0158, 0.0939, 0.1198, 0.3064, 0.1421, 0.1695,
        0.1057])
[rfa agg] iter:  6, prev_obj_val: 9782.013671875, obj_val: 9695.3310546875, abs dis: 86.6826171875
[rfa agg] iter:  6, weight: tensor([0.0105, 0.0105, 0.0112, 0.0109, 0.0950, 0.1215, 0.3164, 0.1444, 0.1726,
        0.1071])
[rfa agg] iter:  7, prev_obj_val: 9695.3310546875, obj_val: 9634.7431640625, abs dis: 60.587890625
[rfa agg] iter:  7, weight: tensor([0.0071, 0.0071, 0.0076, 0.0074, 0.0949, 0.1221, 0.3265, 0.1456, 0.1744,
        0.1073])
[rfa agg] iter:  8, prev_obj_val: 9634.7431640625, obj_val: 9591.8359375, abs dis: 42.9072265625
[rfa agg] iter:  8, weight: tensor([0.0047, 0.0047, 0.0050, 0.0049, 0.0937, 0.1215, 0.3386, 0.1454, 0.1750,
        0.1064])
[rfa agg] iter:  9, prev_obj_val: 9591.8359375, obj_val: 9562.4091796875, abs dis: 29.4267578125
[rfa agg] iter:  9, weight: tensor([0.0031, 0.0031, 0.0033, 0.0032, 0.0908, 0.1193, 0.3556, 0.1437, 0.1741,
        0.1038])
___Test Target_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.0514, Accuracy: 6436/10000 (64.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.6696, Accuracy: 7405/9000 (82.2778%)
Done in 197.00337648391724 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:222 choose agents : [17, 33, 77, 11, 35, 30, 72, 51, 63, 46]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   1,  Average loss: 0.0021, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   2,  Average loss: 0.0019, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   3,  Average loss: 0.0021, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   4,  Average loss: 0.0010, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   5,  Average loss: 0.0008, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   6,  Average loss: 0.0018, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Global model norm: 45.31394663639027.
Norm before scaling: 44.95982092987999. Distance: 2.726970215839357
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.5717, Accuracy: 5501/10000 (55.0100%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.2002, Accuracy: 8415/9000 (93.5000%)
Scaling by  100
Scaled Norm after poisoning: 269.2147290036338, distance: 272.69701880016953
Total norm for 4 adversaries is: 269.2147290036338. distance: 272.69701880016953
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   1,  Average loss: 0.0018, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   2,  Average loss: 0.0014, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   3,  Average loss: 0.0025, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   4,  Average loss: 0.0012, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   5,  Average loss: 0.0043, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   6,  Average loss: 0.0027, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Global model norm: 45.31394663639027.
Norm before scaling: 45.21071002297188. Distance: 5.075004111603072
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 2.1751, Accuracy: 4558/10000 (45.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.2977, Accuracy: 8114/9000 (90.1556%)
Scaling by  100
Scaled Norm after poisoning: 506.0631445284274, distance: 507.5004002461476
Total norm for 4 adversaries is: 506.0631445284274. distance: 507.5004002461476
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   1,  Average loss: 0.0018, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   2,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   3,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   4,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 45.31394663639027.
Norm before scaling: 44.98252834651819. Distance: 1.8242103200713613
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.2736, Accuracy: 6109/10000 (61.0900%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.1271, Accuracy: 8729/9000 (96.9889%)
Scaling by  100
Scaled Norm after poisoning: 178.9005757833803, distance: 182.42105527117752
Total norm for 4 adversaries is: 178.9005757833803. distance: 182.42105527117752
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   1,  Average loss: 0.0019, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   2,  Average loss: 0.0009, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   3,  Average loss: 0.0009, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   4,  Average loss: 0.0007, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Global model norm: 45.31394663639027.
Norm before scaling: 44.93346182090734. Distance: 2.349733674399439
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.5952, Accuracy: 5620/10000 (56.2000%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.1326, Accuracy: 8671/9000 (96.3444%)
Scaling by  100
Scaled Norm after poisoning: 230.82438874066145, distance: 234.97333625328642
Total norm for 4 adversaries is: 230.82438874066145. distance: 234.97333625328642
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 222, local model 35, internal_epoch   1,  Average loss: 0.0197, Accuracy: 281/419 (67.0644%)
___Train Local_ResNet_18,  epoch 222, local model 35, internal_epoch   2,  Average loss: 0.0060, Accuracy: 371/419 (88.5442%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 4.4435, Accuracy: 3424/10000 (34.2400%)
___Train Local_ResNet_18,  epoch 222, local model 30, internal_epoch   1,  Average loss: 0.0231, Accuracy: 179/337 (53.1157%)
___Train Local_ResNet_18,  epoch 222, local model 30, internal_epoch   2,  Average loss: 0.0080, Accuracy: 287/337 (85.1632%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 5.3561, Accuracy: 2762/10000 (27.6200%)
___Train Local_ResNet_18,  epoch 222, local model 72, internal_epoch   1,  Average loss: 0.0186, Accuracy: 418/618 (67.6375%)
___Train Local_ResNet_18,  epoch 222, local model 72, internal_epoch   2,  Average loss: 0.0060, Accuracy: 543/618 (87.8641%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 4.3104, Accuracy: 2614/10000 (26.1400%)
___Train Local_ResNet_18,  epoch 222, local model 51, internal_epoch   1,  Average loss: 0.0188, Accuracy: 325/479 (67.8497%)
___Train Local_ResNet_18,  epoch 222, local model 51, internal_epoch   2,  Average loss: 0.0059, Accuracy: 427/479 (89.1441%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 9.1659, Accuracy: 2007/10000 (20.0700%)
___Train Local_ResNet_18,  epoch 222, local model 63, internal_epoch   1,  Average loss: 0.0151, Accuracy: 538/752 (71.5426%)
___Train Local_ResNet_18,  epoch 222, local model 63, internal_epoch   2,  Average loss: 0.0073, Accuracy: 648/752 (86.1702%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 2.3288, Accuracy: 4312/10000 (43.1200%)
___Train Local_ResNet_18,  epoch 222, local model 46, internal_epoch   1,  Average loss: 0.0165, Accuracy: 413/601 (68.7188%)
___Train Local_ResNet_18,  epoch 222, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 542/601 (90.1830%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 3.0641, Accuracy: 4517/10000 (45.1700%)
time spent on training: 153.46448040008545
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.39520845123561593  data num: [526, 527, 496, 546, 419, 337, 618, 479, 752, 601]
[rfa agg] considering poison per batch poison_fraction: 0.030875660252782496
[rfa agg] init. name: [17, 33, 77, 11, 35, 30, 72, 51, 63, 46], weight: tensor([0.0992, 0.0994, 0.0936, 0.1030, 0.0790, 0.0636, 0.1166, 0.0904, 0.1419,
        0.1134])
[rfa agg] iter:  0, prev_obj_val: 11200.00390625, obj_val: 10724.4462890625, abs dis: 475.5576171875
[rfa agg] iter:  0, weight: tensor([0.0716, 0.0717, 0.0824, 0.0743, 0.0913, 0.0733, 0.1350, 0.1045, 0.1646,
        0.1313])
[rfa agg] iter:  1, prev_obj_val: 10724.4462890625, obj_val: 10323.05078125, abs dis: 401.3955078125
[rfa agg] iter:  1, weight: tensor([0.0524, 0.0524, 0.0586, 0.0543, 0.1019, 0.0819, 0.1509, 0.1167, 0.1841,
        0.1468])
[rfa agg] iter:  2, prev_obj_val: 10323.05078125, obj_val: 10007.96484375, abs dis: 315.0859375
[rfa agg] iter:  2, weight: tensor([0.0370, 0.0370, 0.0406, 0.0384, 0.1102, 0.0885, 0.1634, 0.1262, 0.1996,
        0.1590])
[rfa agg] iter:  3, prev_obj_val: 10007.96484375, obj_val: 9772.6015625, abs dis: 235.36328125
[rfa agg] iter:  3, weight: tensor([0.0255, 0.0255, 0.0276, 0.0264, 0.1163, 0.0933, 0.1728, 0.1333, 0.2113,
        0.1680])
[rfa agg] iter:  4, prev_obj_val: 9772.6015625, obj_val: 9603.8212890625, abs dis: 168.7802734375
[rfa agg] iter:  4, weight: tensor([0.0172, 0.0172, 0.0185, 0.0178, 0.1204, 0.0965, 0.1796, 0.1382, 0.2201,
        0.1746])
[rfa agg] iter:  5, prev_obj_val: 9603.8212890625, obj_val: 9486.6181640625, abs dis: 117.203125
[rfa agg] iter:  5, weight: tensor([0.0114, 0.0114, 0.0122, 0.0118, 0.1230, 0.0984, 0.1844, 0.1414, 0.2269,
        0.1793])
[rfa agg] iter:  6, prev_obj_val: 9486.6181640625, obj_val: 9405.9931640625, abs dis: 80.625
[rfa agg] iter:  6, weight: tensor([0.0074, 0.0074, 0.0079, 0.0077, 0.1242, 0.0991, 0.1879, 0.1432, 0.2325,
        0.1827])
[rfa agg] iter:  7, prev_obj_val: 9405.9931640625, obj_val: 9352.564453125, abs dis: 53.4287109375
[rfa agg] iter:  7, weight: tensor([0.0047, 0.0047, 0.0050, 0.0049, 0.1243, 0.0987, 0.1905, 0.1439, 0.2381,
        0.1853])
[rfa agg] iter:  8, prev_obj_val: 9352.564453125, obj_val: 9316.029296875, abs dis: 36.53515625
[rfa agg] iter:  8, weight: tensor([0.0029, 0.0030, 0.0031, 0.0031, 0.1229, 0.0969, 0.1927, 0.1433, 0.2448,
        0.1874])
[rfa agg] iter:  9, prev_obj_val: 9316.029296875, obj_val: 9292.6484375, abs dis: 23.380859375
[rfa agg] iter:  9, weight: tensor([0.0017, 0.0017, 0.0019, 0.0018, 0.1193, 0.0930, 0.1948, 0.1409, 0.2553,
        0.1895])
___Test Target_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.0177, Accuracy: 6548/10000 (65.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.7117, Accuracy: 7311/9000 (81.2333%)
Done in 195.0903024673462 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:223 choose agents : [17, 33, 77, 11, 54, 95, 26, 2, 82, 45]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   1,  Average loss: 0.0022, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   2,  Average loss: 0.0010, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   3,  Average loss: 0.0011, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   4,  Average loss: 0.0011, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   5,  Average loss: 0.0009, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   6,  Average loss: 0.0011, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Global model norm: 45.257952080960315.
Norm before scaling: 44.92943550507493. Distance: 2.927698706472602
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.6897, Accuracy: 5334/10000 (53.3400%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.2178, Accuracy: 8475/9000 (94.1667%)
Scaling by  100
Scaled Norm after poisoning: 289.7283614655286, distance: 292.76990752124783
Total norm for 4 adversaries is: 289.7283614655286. distance: 292.76990752124783
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   1,  Average loss: 0.0023, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   2,  Average loss: 0.0007, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   3,  Average loss: 0.0006, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   4,  Average loss: 0.0008, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   5,  Average loss: 0.0010, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   6,  Average loss: 0.0007, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Global model norm: 45.257952080960315.
Norm before scaling: 44.90899271808626. Distance: 2.4901809507136954
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.5899, Accuracy: 5438/10000 (54.3800%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.1797, Accuracy: 8495/9000 (94.3889%)
Scaling by  100
Scaled Norm after poisoning: 245.54372860297207, distance: 249.01807947667174
Total norm for 4 adversaries is: 245.54372860297207. distance: 249.01807947667174
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   1,  Average loss: 0.0018, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   2,  Average loss: 0.0009, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   3,  Average loss: 0.0010, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 45.257952080960315.
Norm before scaling: 44.92725647113829. Distance: 1.8392447045102094
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.3501, Accuracy: 5820/10000 (58.2000%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.0636, Accuracy: 8823/9000 (98.0333%)
Scaling by  100
Scaled Norm after poisoning: 180.43237999317085, distance: 183.92448136055734
Total norm for 4 adversaries is: 180.43237999317085. distance: 183.92448136055734
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   1,  Average loss: 0.0019, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   2,  Average loss: 0.0007, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   3,  Average loss: 0.0006, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   4,  Average loss: 0.0011, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   6,  Average loss: 0.0002, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 45.257952080960315.
Norm before scaling: 44.86689162252259. Distance: 2.075435877600474
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.5406, Accuracy: 5775/10000 (57.7500%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.2059, Accuracy: 8556/9000 (95.0667%)
Scaling by  100
Scaled Norm after poisoning: 202.89753610196945, distance: 207.54357599670485
Total norm for 4 adversaries is: 202.89753610196945. distance: 207.54357599670485
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 223, local model 54, internal_epoch   1,  Average loss: 0.0165, Accuracy: 307/440 (69.7727%)
___Train Local_ResNet_18,  epoch 223, local model 54, internal_epoch   2,  Average loss: 0.0040, Accuracy: 399/440 (90.6818%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 4.7210, Accuracy: 3135/10000 (31.3500%)
___Train Local_ResNet_18,  epoch 223, local model 95, internal_epoch   1,  Average loss: 0.0172, Accuracy: 383/569 (67.3111%)
___Train Local_ResNet_18,  epoch 223, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 497/569 (87.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 6.0481, Accuracy: 2731/10000 (27.3100%)
___Train Local_ResNet_18,  epoch 223, local model 26, internal_epoch   1,  Average loss: 0.0179, Accuracy: 291/468 (62.1795%)
___Train Local_ResNet_18,  epoch 223, local model 26, internal_epoch   2,  Average loss: 0.0053, Accuracy: 413/468 (88.2479%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 2.3973, Accuracy: 4109/10000 (41.0900%)
___Train Local_ResNet_18,  epoch 223, local model 2, internal_epoch   1,  Average loss: 0.0198, Accuracy: 310/461 (67.2451%)
___Train Local_ResNet_18,  epoch 223, local model 2, internal_epoch   2,  Average loss: 0.0089, Accuracy: 380/461 (82.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 3.0635, Accuracy: 3361/10000 (33.6100%)
___Train Local_ResNet_18,  epoch 223, local model 82, internal_epoch   1,  Average loss: 0.0124, Accuracy: 467/601 (77.7038%)
___Train Local_ResNet_18,  epoch 223, local model 82, internal_epoch   2,  Average loss: 0.0055, Accuracy: 538/601 (89.5175%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 3.1052, Accuracy: 4034/10000 (40.3400%)
___Train Local_ResNet_18,  epoch 223, local model 45, internal_epoch   1,  Average loss: 0.0187, Accuracy: 367/529 (69.3762%)
___Train Local_ResNet_18,  epoch 223, local model 45, internal_epoch   2,  Average loss: 0.0074, Accuracy: 464/529 (87.7127%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 3.4465, Accuracy: 3700/10000 (37.0000%)
time spent on training: 162.97304224967957
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4057718380786364  data num: [526, 527, 496, 546, 440, 569, 468, 461, 601, 529]
[rfa agg] considering poison per batch poison_fraction: 0.03170092484989347
[rfa agg] init. name: [17, 33, 77, 11, 54, 95, 26, 2, 82, 45], weight: tensor([0.1019, 0.1021, 0.0961, 0.1058, 0.0852, 0.1102, 0.0906, 0.0893, 0.1164,
        0.1025])
[rfa agg] iter:  0, prev_obj_val: 11301.7041015625, obj_val: 10911.263671875, abs dis: 390.4404296875
[rfa agg] iter:  0, weight: tensor([0.0760, 0.0762, 0.0878, 0.0789, 0.0975, 0.1264, 0.1038, 0.1023, 0.1336,
        0.1175])
[rfa agg] iter:  1, prev_obj_val: 10911.263671875, obj_val: 10568.9296875, abs dis: 342.333984375
[rfa agg] iter:  1, weight: tensor([0.0580, 0.0581, 0.0652, 0.0602, 0.1086, 0.1408, 0.1156, 0.1139, 0.1489,
        0.1309])
[rfa agg] iter:  2, prev_obj_val: 10568.9296875, obj_val: 10289.0087890625, abs dis: 279.9208984375
[rfa agg] iter:  2, weight: tensor([0.0428, 0.0429, 0.0472, 0.0444, 0.1177, 0.1527, 0.1254, 0.1235, 0.1615,
        0.1419])
[rfa agg] iter:  3, prev_obj_val: 10289.0087890625, obj_val: 10069.8046875, abs dis: 219.2041015625
[rfa agg] iter:  3, weight: tensor([0.0309, 0.0310, 0.0337, 0.0321, 0.1247, 0.1619, 0.1329, 0.1309, 0.1714,
        0.1506])
[rfa agg] iter:  4, prev_obj_val: 10069.8046875, obj_val: 9905.4052734375, abs dis: 164.3994140625
[rfa agg] iter:  4, weight: tensor([0.0219, 0.0219, 0.0236, 0.0227, 0.1299, 0.1690, 0.1385, 0.1365, 0.1790,
        0.1571])
[rfa agg] iter:  5, prev_obj_val: 9905.4052734375, obj_val: 9784.0078125, abs dis: 121.3974609375
[rfa agg] iter:  5, weight: tensor([0.0153, 0.0153, 0.0164, 0.0158, 0.1335, 0.1741, 0.1426, 0.1405, 0.1847,
        0.1619])
[rfa agg] iter:  6, prev_obj_val: 9784.0078125, obj_val: 9696.3359375, abs dis: 87.671875
[rfa agg] iter:  6, weight: tensor([0.0105, 0.0105, 0.0112, 0.0109, 0.1359, 0.1779, 0.1454, 0.1433, 0.1891,
        0.1654])
[rfa agg] iter:  7, prev_obj_val: 9696.3359375, obj_val: 9636.48828125, abs dis: 59.84765625
[rfa agg] iter:  7, weight: tensor([0.0071, 0.0071, 0.0075, 0.0073, 0.1372, 0.1807, 0.1473, 0.1451, 0.1927,
        0.1680])
[rfa agg] iter:  8, prev_obj_val: 9636.48828125, obj_val: 9593.5048828125, abs dis: 42.9833984375
[rfa agg] iter:  8, weight: tensor([0.0047, 0.0048, 0.0051, 0.0049, 0.1376, 0.1828, 0.1483, 0.1461, 0.1957,
        0.1699])
[rfa agg] iter:  9, prev_obj_val: 9593.5048828125, obj_val: 9563.1806640625, abs dis: 30.32421875
[rfa agg] iter:  9, weight: tensor([0.0031, 0.0031, 0.0033, 0.0032, 0.1370, 0.1845, 0.1487, 0.1465, 0.1990,
        0.1716])
___Test Target_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.0061, Accuracy: 6575/10000 (65.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.5583, Accuracy: 7693/9000 (85.4778%)
Done in 208.38940238952637 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:224 choose agents : [17, 33, 77, 11, 0, 34, 62, 66, 95, 10]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   1,  Average loss: 0.0039, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   2,  Average loss: 0.0018, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   3,  Average loss: 0.0030, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   4,  Average loss: 0.0032, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   5,  Average loss: 0.0018, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   6,  Average loss: 0.0023, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Global model norm: 45.182984354680606.
Norm before scaling: 45.06711303971417. Distance: 5.09785417779065
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.8760, Accuracy: 5018/10000 (50.1800%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.1873, Accuracy: 8502/9000 (94.4667%)
Scaling by  100
Scaled Norm after poisoning: 508.2106477633069, distance: 509.7854634549714
Total norm for 4 adversaries is: 508.2106477633069. distance: 509.7854634549714
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   1,  Average loss: 0.0020, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   2,  Average loss: 0.0031, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   3,  Average loss: 0.0015, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   4,  Average loss: 0.0012, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   5,  Average loss: 0.0009, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   6,  Average loss: 0.0006, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Global model norm: 45.182984354680606.
Norm before scaling: 44.811930675428115. Distance: 2.3803898737239946
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.4154, Accuracy: 5683/10000 (56.8300%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.2328, Accuracy: 8423/9000 (93.5889%)
Scaling by  100
Scaled Norm after poisoning: 234.08999337861496, distance: 238.03899365440108
Total norm for 4 adversaries is: 234.08999337861496. distance: 238.03899365440108
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   1,  Average loss: 0.0016, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   2,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   3,  Average loss: 0.0011, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 45.182984354680606.
Norm before scaling: 44.84499263304447. Distance: 1.65033421166066
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.2010, Accuracy: 6278/10000 (62.7800%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.1193, Accuracy: 8717/9000 (96.8556%)
Scaling by  100
Scaled Norm after poisoning: 161.12810315087805, distance: 165.03343056218944
Total norm for 4 adversaries is: 161.12810315087805. distance: 165.03343056218944
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   1,  Average loss: 0.0018, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   2,  Average loss: 0.0003, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   3,  Average loss: 0.0005, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   4,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   5,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 45.182984354680606.
Norm before scaling: 44.77798422320672. Distance: 1.885090443189373
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.5325, Accuracy: 5743/10000 (57.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.1480, Accuracy: 8656/9000 (96.1778%)
Scaling by  100
Scaled Norm after poisoning: 183.2439886462855, distance: 188.50903492936354
Total norm for 4 adversaries is: 183.2439886462855. distance: 188.50903492936354
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 224, local model 0, internal_epoch   1,  Average loss: 0.0205, Accuracy: 214/367 (58.3106%)
___Train Local_ResNet_18,  epoch 224, local model 0, internal_epoch   2,  Average loss: 0.0062, Accuracy: 325/367 (88.5559%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 4.7568, Accuracy: 2372/10000 (23.7200%)
___Train Local_ResNet_18,  epoch 224, local model 34, internal_epoch   1,  Average loss: 0.0203, Accuracy: 231/349 (66.1891%)
___Train Local_ResNet_18,  epoch 224, local model 34, internal_epoch   2,  Average loss: 0.0065, Accuracy: 301/349 (86.2464%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 5.9574, Accuracy: 2213/10000 (22.1300%)
___Train Local_ResNet_18,  epoch 224, local model 62, internal_epoch   1,  Average loss: 0.0168, Accuracy: 250/358 (69.8324%)
___Train Local_ResNet_18,  epoch 224, local model 62, internal_epoch   2,  Average loss: 0.0052, Accuracy: 329/358 (91.8994%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 2.5007, Accuracy: 3871/10000 (38.7100%)
___Train Local_ResNet_18,  epoch 224, local model 66, internal_epoch   1,  Average loss: 0.0112, Accuracy: 440/555 (79.2793%)
___Train Local_ResNet_18,  epoch 224, local model 66, internal_epoch   2,  Average loss: 0.0024, Accuracy: 530/555 (95.4955%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 4.7916, Accuracy: 3756/10000 (37.5600%)
___Train Local_ResNet_18,  epoch 224, local model 95, internal_epoch   1,  Average loss: 0.0178, Accuracy: 384/569 (67.4868%)
___Train Local_ResNet_18,  epoch 224, local model 95, internal_epoch   2,  Average loss: 0.0048, Accuracy: 510/569 (89.6309%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 7.5134, Accuracy: 2321/10000 (23.2100%)
___Train Local_ResNet_18,  epoch 224, local model 10, internal_epoch   1,  Average loss: 0.0112, Accuracy: 612/752 (81.3830%)
___Train Local_ResNet_18,  epoch 224, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 698/752 (92.8191%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 5.0365, Accuracy: 3234/10000 (32.3400%)
time spent on training: 164.42031455039978
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41526263627353815  data num: [526, 527, 496, 546, 367, 349, 358, 555, 569, 752]
[rfa agg] considering poison per batch poison_fraction: 0.03244239345887017
[rfa agg] init. name: [17, 33, 77, 11, 0, 34, 62, 66, 95, 10], weight: tensor([0.1043, 0.1045, 0.0983, 0.1082, 0.0727, 0.0692, 0.0710, 0.1100, 0.1128,
        0.1491])
[rfa agg] iter:  0, prev_obj_val: 11381.056640625, obj_val: 11059.3623046875, abs dis: 321.6943359375
[rfa agg] iter:  0, weight: tensor([0.0799, 0.0802, 0.0928, 0.0831, 0.0824, 0.0784, 0.0804, 0.1250, 0.1281,
        0.1698])
[rfa agg] iter:  1, prev_obj_val: 11059.3623046875, obj_val: 10773.3876953125, abs dis: 285.974609375
[rfa agg] iter:  1, weight: tensor([0.0631, 0.0632, 0.0713, 0.0655, 0.0914, 0.0869, 0.0892, 0.1387, 0.1422,
        0.1886])
[rfa agg] iter:  2, prev_obj_val: 10773.3876953125, obj_val: 10529.166015625, abs dis: 244.2216796875
[rfa agg] iter:  2, weight: tensor([0.0486, 0.0487, 0.0539, 0.0504, 0.0989, 0.0941, 0.0965, 0.1503, 0.1541,
        0.2045])
[rfa agg] iter:  3, prev_obj_val: 10529.166015625, obj_val: 10330.46875, abs dis: 198.697265625
[rfa agg] iter:  3, weight: tensor([0.0366, 0.0366, 0.0400, 0.0380, 0.1051, 0.0999, 0.1025, 0.1598, 0.1638,
        0.2178])
[rfa agg] iter:  4, prev_obj_val: 10330.46875, obj_val: 10174.2490234375, abs dis: 156.2197265625
[rfa agg] iter:  4, weight: tensor([0.0271, 0.0271, 0.0294, 0.0281, 0.1098, 0.1044, 0.1071, 0.1673, 0.1715,
        0.2284])
[rfa agg] iter:  5, prev_obj_val: 10174.2490234375, obj_val: 10053.677734375, abs dis: 120.5712890625
[rfa agg] iter:  5, weight: tensor([0.0198, 0.0198, 0.0213, 0.0205, 0.1132, 0.1077, 0.1105, 0.1730, 0.1774,
        0.2369])
[rfa agg] iter:  6, prev_obj_val: 10053.677734375, obj_val: 9962.6865234375, abs dis: 90.9912109375
[rfa agg] iter:  6, weight: tensor([0.0142, 0.0143, 0.0153, 0.0148, 0.1156, 0.1100, 0.1128, 0.1774, 0.1819,
        0.2438])
[rfa agg] iter:  7, prev_obj_val: 9962.6865234375, obj_val: 9895.205078125, abs dis: 67.4814453125
[rfa agg] iter:  7, weight: tensor([0.0101, 0.0101, 0.0108, 0.0105, 0.1171, 0.1114, 0.1143, 0.1807, 0.1852,
        0.2498])
[rfa agg] iter:  8, prev_obj_val: 9895.205078125, obj_val: 9847.44140625, abs dis: 47.763671875
[rfa agg] iter:  8, weight: tensor([0.0071, 0.0071, 0.0076, 0.0074, 0.1178, 0.1120, 0.1149, 0.1831, 0.1878,
        0.2554])
[rfa agg] iter:  9, prev_obj_val: 9847.44140625, obj_val: 9811.8134765625, abs dis: 35.6279296875
[rfa agg] iter:  9, weight: tensor([0.0050, 0.0050, 0.0053, 0.0051, 0.1175, 0.1118, 0.1147, 0.1849, 0.1896,
        0.2612])
___Test Target_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.0277, Accuracy: 6500/10000 (65.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.4799, Accuracy: 7894/9000 (87.7111%)
Done in 210.50237274169922 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:225 choose agents : [17, 33, 77, 11, 12, 38, 41, 4, 68, 55]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   1,  Average loss: 0.0021, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   2,  Average loss: 0.0023, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   3,  Average loss: 0.0016, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   4,  Average loss: 0.0014, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   5,  Average loss: 0.0022, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   6,  Average loss: 0.0013, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 45.074699284909265.
Norm before scaling: 44.69732737221265. Distance: 2.6179288355084953
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.3998, Accuracy: 5748/10000 (57.4800%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.1478, Accuracy: 8521/9000 (94.6778%)
Scaling by  100
Scaled Norm after poisoning: 257.8646083703617, distance: 261.7928868877075
Total norm for 4 adversaries is: 257.8646083703617. distance: 261.7928868877075
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   1,  Average loss: 0.0019, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   2,  Average loss: 0.0014, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   3,  Average loss: 0.0011, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   4,  Average loss: 0.0018, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   5,  Average loss: 0.0017, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   6,  Average loss: 0.0013, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Global model norm: 45.074699284909265.
Norm before scaling: 44.71379116242759. Distance: 2.463303557832405
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.4890, Accuracy: 5618/10000 (56.1800%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.2284, Accuracy: 8314/9000 (92.3778%)
Scaling by  100
Scaled Norm after poisoning: 242.61705454532662, distance: 246.33032478006032
Total norm for 4 adversaries is: 242.61705454532662. distance: 246.33032478006032
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   1,  Average loss: 0.0014, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   3,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   4,  Average loss: 0.0007, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   6,  Average loss: 0.0013, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Global model norm: 45.074699284909265.
Norm before scaling: 44.72982998435929. Distance: 1.664337422043031
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.2482, Accuracy: 6091/10000 (60.9100%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.0644, Accuracy: 8808/9000 (97.8667%)
Scaling by  100
Scaled Norm after poisoning: 162.35104350796456, distance: 166.43374479428743
Total norm for 4 adversaries is: 162.35104350796456. distance: 166.43374479428743
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   1,  Average loss: 0.0017, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   2,  Average loss: 0.0008, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   3,  Average loss: 0.0007, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   4,  Average loss: 0.0003, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 45.074699284909265.
Norm before scaling: 44.665504857985766. Distance: 1.889623203158384
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.5566, Accuracy: 5705/10000 (57.0500%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.1568, Accuracy: 8614/9000 (95.7111%)
Scaling by  100
Scaled Norm after poisoning: 183.60099187844818, distance: 188.96230816289793
Total norm for 4 adversaries is: 183.60099187844818. distance: 188.96230816289793
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 225, local model 12, internal_epoch   1,  Average loss: 0.0133, Accuracy: 743/977 (76.0491%)
___Train Local_ResNet_18,  epoch 225, local model 12, internal_epoch   2,  Average loss: 0.0087, Accuracy: 813/977 (83.2139%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 4.0320, Accuracy: 3392/10000 (33.9200%)
___Train Local_ResNet_18,  epoch 225, local model 38, internal_epoch   1,  Average loss: 0.0132, Accuracy: 564/756 (74.6032%)
___Train Local_ResNet_18,  epoch 225, local model 38, internal_epoch   2,  Average loss: 0.0065, Accuracy: 656/756 (86.7725%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 2.9980, Accuracy: 3917/10000 (39.1700%)
___Train Local_ResNet_18,  epoch 225, local model 41, internal_epoch   1,  Average loss: 0.0189, Accuracy: 351/513 (68.4211%)
___Train Local_ResNet_18,  epoch 225, local model 41, internal_epoch   2,  Average loss: 0.0064, Accuracy: 444/513 (86.5497%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 4.0929, Accuracy: 2824/10000 (28.2400%)
___Train Local_ResNet_18,  epoch 225, local model 4, internal_epoch   1,  Average loss: 0.0150, Accuracy: 395/557 (70.9156%)
___Train Local_ResNet_18,  epoch 225, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 521/557 (93.5368%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 2.7518, Accuracy: 4731/10000 (47.3100%)
___Train Local_ResNet_18,  epoch 225, local model 68, internal_epoch   1,  Average loss: 0.0175, Accuracy: 277/416 (66.5865%)
___Train Local_ResNet_18,  epoch 225, local model 68, internal_epoch   2,  Average loss: 0.0061, Accuracy: 378/416 (90.8654%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 3.2493, Accuracy: 3668/10000 (36.6800%)
___Train Local_ResNet_18,  epoch 225, local model 55, internal_epoch   1,  Average loss: 0.0192, Accuracy: 196/299 (65.5518%)
___Train Local_ResNet_18,  epoch 225, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 275/299 (91.9732%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 6.5909, Accuracy: 2237/10000 (22.3700%)
time spent on training: 163.44098782539368
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3732406912524497  data num: [526, 527, 496, 546, 977, 756, 513, 557, 416, 299]
[rfa agg] considering poison per batch poison_fraction: 0.029159429004097633
[rfa agg] init. name: [17, 33, 77, 11, 12, 38, 41, 4, 68, 55], weight: tensor([0.0937, 0.0939, 0.0884, 0.0973, 0.1741, 0.1347, 0.0914, 0.0992, 0.0741,
        0.0533])
[rfa agg] iter:  0, prev_obj_val: 10953.5556640625, obj_val: 10286.6845703125, abs dis: 666.87109375
[rfa agg] iter:  0, weight: tensor([0.0628, 0.0629, 0.0717, 0.0652, 0.2059, 0.1586, 0.1073, 0.1165, 0.0868,
        0.0623])
[rfa agg] iter:  1, prev_obj_val: 10286.6845703125, obj_val: 9765.0185546875, abs dis: 521.666015625
[rfa agg] iter:  1, weight: tensor([0.0419, 0.0420, 0.0465, 0.0435, 0.2311, 0.1778, 0.1201, 0.1304, 0.0971,
        0.0696])
[rfa agg] iter:  2, prev_obj_val: 9765.0185546875, obj_val: 9390.7900390625, abs dis: 374.228515625
[rfa agg] iter:  2, weight: tensor([0.0268, 0.0269, 0.0292, 0.0278, 0.2497, 0.1915, 0.1291, 0.1402, 0.1042,
        0.0746])
[rfa agg] iter:  3, prev_obj_val: 9390.7900390625, obj_val: 9139.0458984375, abs dis: 251.744140625
[rfa agg] iter:  3, weight: tensor([0.0166, 0.0166, 0.0179, 0.0172, 0.2633, 0.2009, 0.1349, 0.1465, 0.1086,
        0.0775])
[rfa agg] iter:  4, prev_obj_val: 9139.0458984375, obj_val: 8979.1640625, abs dis: 159.8818359375
[rfa agg] iter:  4, weight: tensor([0.0100, 0.0100, 0.0107, 0.0104, 0.2740, 0.2071, 0.1382, 0.1500, 0.1108,
        0.0788])
[rfa agg] iter:  5, prev_obj_val: 8979.1640625, obj_val: 8880.525390625, abs dis: 98.638671875
[rfa agg] iter:  5, weight: tensor([0.0059, 0.0059, 0.0063, 0.0061, 0.2841, 0.2114, 0.1394, 0.1514, 0.1110,
        0.0783])
[rfa agg] iter:  6, prev_obj_val: 8880.525390625, obj_val: 8819.328125, abs dis: 61.197265625
[rfa agg] iter:  6, weight: tensor([0.0034, 0.0034, 0.0037, 0.0036, 0.2969, 0.2146, 0.1387, 0.1506, 0.1091,
        0.0761])
[rfa agg] iter:  7, prev_obj_val: 8819.328125, obj_val: 8783.1220703125, abs dis: 36.2060546875
[rfa agg] iter:  7, weight: tensor([0.0019, 0.0019, 0.0020, 0.0020, 0.3184, 0.2170, 0.1352, 0.1468, 0.1039,
        0.0710])
[rfa agg] iter:  8, prev_obj_val: 8783.1220703125, obj_val: 8762.9130859375, abs dis: 20.208984375
[rfa agg] iter:  8, weight: tensor([0.0010, 0.0010, 0.0011, 0.0010, 0.3627, 0.2168, 0.1257, 0.1365, 0.0929,
        0.0613])
[rfa agg] iter:  9, prev_obj_val: 8762.9130859375, obj_val: 8754.53125, abs dis: 8.3818359375
[rfa agg] iter:  9, weight: tensor([4.4247e-04, 4.4332e-04, 4.6985e-04, 4.5932e-04, 4.7767e-01, 1.9889e-01,
        1.0017e-01, 1.0876e-01, 6.9281e-02, 4.3409e-02])
___Test Target_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.0086, Accuracy: 6577/10000 (65.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.5618, Accuracy: 7701/9000 (85.5667%)
Done in 209.71436476707458 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:226 choose agents : [17, 33, 77, 11, 30, 39, 10, 64, 23, 60]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   1,  Average loss: 0.0021, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   2,  Average loss: 0.0015, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   3,  Average loss: 0.0030, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   4,  Average loss: 0.0016, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   5,  Average loss: 0.0023, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   6,  Average loss: 0.0009, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Global model norm: 45.04130591225403.
Norm before scaling: 44.66526708735071. Distance: 2.713739184160788
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.5667, Accuracy: 5402/10000 (54.0200%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.1101, Accuracy: 8638/9000 (95.9778%)
Scaling by  100
Scaled Norm after poisoning: 267.5121638589543, distance: 271.3739348205719
Total norm for 4 adversaries is: 267.5121638589543. distance: 271.3739348205719
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   1,  Average loss: 0.0018, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   2,  Average loss: 0.0013, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   3,  Average loss: 0.0011, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   4,  Average loss: 0.0012, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   5,  Average loss: 0.0019, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   6,  Average loss: 0.0015, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Global model norm: 45.04130591225403.
Norm before scaling: 44.706030358226. Distance: 2.751126405469376
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.5245, Accuracy: 5346/10000 (53.4600%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.0624, Accuracy: 8813/9000 (97.9222%)
Scaling by  100
Scaled Norm after poisoning: 271.9371480691816, distance: 275.11264738284933
Total norm for 4 adversaries is: 271.9371480691816. distance: 275.11264738284933
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   1,  Average loss: 0.0017, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   2,  Average loss: 0.0007, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   3,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   4,  Average loss: 0.0007, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 45.04130591225403.
Norm before scaling: 44.70763450472204. Distance: 1.6978849240321727
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.2113, Accuracy: 6197/10000 (61.9700%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.0891, Accuracy: 8790/9000 (97.6667%)
Scaling by  100
Scaled Norm after poisoning: 166.05378458499524, distance: 169.78847709171845
Total norm for 4 adversaries is: 166.05378458499524. distance: 169.78847709171845
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   1,  Average loss: 0.0018, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   2,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   3,  Average loss: 0.0012, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   4,  Average loss: 0.0007, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 45.04130591225403.
Norm before scaling: 44.6449849660316. Distance: 1.98133136088828
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.5352, Accuracy: 5825/10000 (58.2500%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.1627, Accuracy: 8551/9000 (95.0111%)
Scaling by  100
Scaled Norm after poisoning: 193.23162509666992, distance: 198.13314257715695
Total norm for 4 adversaries is: 193.23162509666992. distance: 198.13314257715695
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 226, local model 30, internal_epoch   1,  Average loss: 0.0208, Accuracy: 190/337 (56.3798%)
___Train Local_ResNet_18,  epoch 226, local model 30, internal_epoch   2,  Average loss: 0.0057, Accuracy: 300/337 (89.0208%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 4.4977, Accuracy: 3034/10000 (30.3400%)
___Train Local_ResNet_18,  epoch 226, local model 39, internal_epoch   1,  Average loss: 0.0241, Accuracy: 121/217 (55.7604%)
___Train Local_ResNet_18,  epoch 226, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 206/217 (94.9309%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 8.8506, Accuracy: 1591/10000 (15.9100%)
___Train Local_ResNet_18,  epoch 226, local model 10, internal_epoch   1,  Average loss: 0.0109, Accuracy: 602/752 (80.0532%)
___Train Local_ResNet_18,  epoch 226, local model 10, internal_epoch   2,  Average loss: 0.0055, Accuracy: 678/752 (90.1596%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 5.6920, Accuracy: 2982/10000 (29.8200%)
___Train Local_ResNet_18,  epoch 226, local model 64, internal_epoch   1,  Average loss: 0.0161, Accuracy: 467/686 (68.0758%)
___Train Local_ResNet_18,  epoch 226, local model 64, internal_epoch   2,  Average loss: 0.0065, Accuracy: 593/686 (86.4431%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 3.0835, Accuracy: 3896/10000 (38.9600%)
___Train Local_ResNet_18,  epoch 226, local model 23, internal_epoch   1,  Average loss: 0.0227, Accuracy: 146/248 (58.8710%)
___Train Local_ResNet_18,  epoch 226, local model 23, internal_epoch   2,  Average loss: 0.0065, Accuracy: 219/248 (88.3065%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 6.0113, Accuracy: 2054/10000 (20.5400%)
___Train Local_ResNet_18,  epoch 226, local model 60, internal_epoch   1,  Average loss: 0.0208, Accuracy: 170/284 (59.8592%)
___Train Local_ResNet_18,  epoch 226, local model 60, internal_epoch   2,  Average loss: 0.0057, Accuracy: 253/284 (89.0845%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 6.8734, Accuracy: 1925/10000 (19.2500%)
time spent on training: 163.35265445709229
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4535613769214116  data num: [526, 527, 496, 546, 337, 217, 752, 686, 248, 284]
[rfa agg] considering poison per batch poison_fraction: 0.03543448257198528
[rfa agg] init. name: [17, 33, 77, 11, 30, 39, 10, 64, 23, 60], weight: tensor([0.1139, 0.1141, 0.1074, 0.1182, 0.0730, 0.0470, 0.1628, 0.1485, 0.0537,
        0.0615])
[rfa agg] iter:  0, prev_obj_val: 11617.818359375, obj_val: 11516.322265625, abs dis: 101.49609375
[rfa agg] iter:  0, weight: tensor([0.0970, 0.0972, 0.1142, 0.1007, 0.0787, 0.0506, 0.1766, 0.1609, 0.0578,
        0.0663])
[rfa agg] iter:  1, prev_obj_val: 11516.322265625, obj_val: 11417.7548828125, abs dis: 98.5673828125
[rfa agg] iter:  1, weight: tensor([0.0867, 0.0868, 0.1002, 0.0900, 0.0848, 0.0545, 0.1902, 0.1733, 0.0623,
        0.0714])
[rfa agg] iter:  2, prev_obj_val: 11417.7548828125, obj_val: 11324.609375, abs dis: 93.1455078125
[rfa agg] iter:  2, weight: tensor([0.0767, 0.0768, 0.0873, 0.0796, 0.0905, 0.0581, 0.2032, 0.1852, 0.0665,
        0.0762])
[rfa agg] iter:  3, prev_obj_val: 11324.609375, obj_val: 11238.12890625, abs dis: 86.48046875
[rfa agg] iter:  3, weight: tensor([0.0673, 0.0674, 0.0756, 0.0698, 0.0958, 0.0615, 0.2153, 0.1962, 0.0703,
        0.0806])
[rfa agg] iter:  4, prev_obj_val: 11238.12890625, obj_val: 11158.3095703125, abs dis: 79.8193359375
[rfa agg] iter:  4, weight: tensor([0.0586, 0.0587, 0.0652, 0.0608, 0.1007, 0.0646, 0.2265, 0.2063, 0.0739,
        0.0847])
[rfa agg] iter:  5, prev_obj_val: 11158.3095703125, obj_val: 11085.14453125, abs dis: 73.1650390625
[rfa agg] iter:  5, weight: tensor([0.0507, 0.0508, 0.0559, 0.0526, 0.1050, 0.0674, 0.2366, 0.2155, 0.0771,
        0.0884])
[rfa agg] iter:  6, prev_obj_val: 11085.14453125, obj_val: 11019.05078125, abs dis: 66.09375
[rfa agg] iter:  6, weight: tensor([0.0434, 0.0435, 0.0476, 0.0451, 0.1090, 0.0699, 0.2459, 0.2239, 0.0799,
        0.0917])
[rfa agg] iter:  7, prev_obj_val: 11019.05078125, obj_val: 10961.2734375, abs dis: 57.77734375
[rfa agg] iter:  7, weight: tensor([0.0370, 0.0370, 0.0403, 0.0384, 0.1125, 0.0721, 0.2543, 0.2315, 0.0824,
        0.0946])
[rfa agg] iter:  8, prev_obj_val: 10961.2734375, obj_val: 10910.5654296875, abs dis: 50.7080078125
[rfa agg] iter:  8, weight: tensor([0.0313, 0.0314, 0.0340, 0.0325, 0.1155, 0.0740, 0.2616, 0.2380, 0.0846,
        0.0971])
[rfa agg] iter:  9, prev_obj_val: 10910.5654296875, obj_val: 10866.091796875, abs dis: 44.4736328125
[rfa agg] iter:  9, weight: tensor([0.0264, 0.0265, 0.0286, 0.0274, 0.1180, 0.0756, 0.2681, 0.2439, 0.0863,
        0.0992])
___Test Target_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.1251, Accuracy: 6443/10000 (64.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.1410, Accuracy: 8620/9000 (95.7778%)
Done in 208.51937627792358 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:227 choose agents : [17, 33, 77, 11, 23, 34, 52, 92, 57, 74]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   1,  Average loss: 0.0019, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   2,  Average loss: 0.0019, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   3,  Average loss: 0.0017, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   4,  Average loss: 0.0025, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   5,  Average loss: 0.0022, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   6,  Average loss: 0.0030, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Global model norm: 44.582324055213434.
Norm before scaling: 44.33996333594349. Distance: 4.0291484707431655
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 2.0792, Accuracy: 4493/10000 (44.9300%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.0022, Accuracy: 8998/9000 (99.9778%)
Scaling by  100
Scaled Norm after poisoning: 400.6862277705586, distance: 402.91482893410614
Total norm for 4 adversaries is: 400.6862277705586. distance: 402.91482893410614
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   1,  Average loss: 0.0020, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   2,  Average loss: 0.0014, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   3,  Average loss: 0.0011, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   4,  Average loss: 0.0013, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   5,  Average loss: 0.0026, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   6,  Average loss: 0.0027, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Global model norm: 44.582324055213434.
Norm before scaling: 44.282089408504795. Distance: 3.343563894636543
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.7713, Accuracy: 5245/10000 (52.4500%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.6831, Accuracy: 7492/9000 (83.2444%)
Scaling by  100
Scaled Norm after poisoning: 331.65617785969255, distance: 334.35633125454643
Total norm for 4 adversaries is: 331.65617785969255. distance: 334.35633125454643
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   1,  Average loss: 0.0012, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   3,  Average loss: 0.0010, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   4,  Average loss: 0.0008, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   5,  Average loss: 0.0014, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 44.582324055213434.
Norm before scaling: 44.240786525363816. Distance: 1.7860186807866532
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.2664, Accuracy: 6047/10000 (60.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.0621, Accuracy: 8811/9000 (97.9000%)
Scaling by  100
Scaled Norm after poisoning: 174.73872795369377, distance: 178.60186716024276
Total norm for 4 adversaries is: 174.73872795369377. distance: 178.60186716024276
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   1,  Average loss: 0.0005, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   2,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   3,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   4,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 44.582324055213434.
Norm before scaling: 44.14338348681558. Distance: 1.396427009311258
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.4583, Accuracy: 5877/10000 (58.7700%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.0857, Accuracy: 8759/9000 (97.3222%)
Scaling by  100
Scaled Norm after poisoning: 131.902100296015, distance: 139.64270114966624
Total norm for 4 adversaries is: 131.902100296015. distance: 139.64270114966624
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 227, local model 23, internal_epoch   1,  Average loss: 0.0264, Accuracy: 143/248 (57.6613%)
___Train Local_ResNet_18,  epoch 227, local model 23, internal_epoch   2,  Average loss: 0.0057, Accuracy: 219/248 (88.3065%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 10.7381, Accuracy: 1553/10000 (15.5300%)
___Train Local_ResNet_18,  epoch 227, local model 34, internal_epoch   1,  Average loss: 0.0220, Accuracy: 224/349 (64.1834%)
___Train Local_ResNet_18,  epoch 227, local model 34, internal_epoch   2,  Average loss: 0.0073, Accuracy: 301/349 (86.2464%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 6.3366, Accuracy: 2712/10000 (27.1200%)
___Train Local_ResNet_18,  epoch 227, local model 52, internal_epoch   1,  Average loss: 0.0279, Accuracy: 130/214 (60.7477%)
___Train Local_ResNet_18,  epoch 227, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 198/214 (92.5234%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 8.4464, Accuracy: 2611/10000 (26.1100%)
___Train Local_ResNet_18,  epoch 227, local model 92, internal_epoch   1,  Average loss: 0.0190, Accuracy: 516/796 (64.8241%)
___Train Local_ResNet_18,  epoch 227, local model 92, internal_epoch   2,  Average loss: 0.0092, Accuracy: 662/796 (83.1658%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 3.8141, Accuracy: 3146/10000 (31.4600%)
___Train Local_ResNet_18,  epoch 227, local model 57, internal_epoch   1,  Average loss: 0.0191, Accuracy: 189/290 (65.1724%)
___Train Local_ResNet_18,  epoch 227, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 265/290 (91.3793%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 5.9186, Accuracy: 3697/10000 (36.9700%)
___Train Local_ResNet_18,  epoch 227, local model 74, internal_epoch   1,  Average loss: 0.0182, Accuracy: 325/469 (69.2964%)
___Train Local_ResNet_18,  epoch 227, local model 74, internal_epoch   2,  Average loss: 0.0090, Accuracy: 395/469 (84.2217%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 3.7625, Accuracy: 3552/10000 (35.5200%)
time spent on training: 163.83080315589905
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4696256444743331  data num: [526, 527, 496, 546, 248, 349, 214, 796, 290, 469]
[rfa agg] considering poison per batch poison_fraction: 0.036689503474557274
[rfa agg] init. name: [17, 33, 77, 11, 23, 34, 52, 92, 57, 74], weight: tensor([0.1179, 0.1181, 0.1112, 0.1224, 0.0556, 0.0782, 0.0480, 0.1784, 0.0650,
        0.1051])
[rfa agg] iter:  0, prev_obj_val: 11677.966796875, obj_val: 11633.28515625, abs dis: 44.681640625
[rfa agg] iter:  0, weight: tensor([0.1042, 0.1044, 0.1236, 0.1082, 0.0585, 0.0824, 0.0504, 0.1890, 0.0684,
        0.1109])
[rfa agg] iter:  1, prev_obj_val: 11633.28515625, obj_val: 11589.43359375, abs dis: 43.8515625
[rfa agg] iter:  1, weight: tensor([0.0972, 0.0974, 0.1137, 0.1009, 0.0617, 0.0870, 0.0532, 0.1996, 0.0722,
        0.1171])
[rfa agg] iter:  2, prev_obj_val: 11589.43359375, obj_val: 11546.685546875, abs dis: 42.748046875
[rfa agg] iter:  2, weight: tensor([0.0903, 0.0905, 0.1044, 0.0938, 0.0648, 0.0914, 0.0559, 0.2099, 0.0759,
        0.1231])
[rfa agg] iter:  3, prev_obj_val: 11546.685546875, obj_val: 11505.576171875, abs dis: 41.109375
[rfa agg] iter:  3, weight: tensor([0.0836, 0.0837, 0.0956, 0.0868, 0.0679, 0.0957, 0.0586, 0.2198, 0.0794,
        0.1289])
[rfa agg] iter:  4, prev_obj_val: 11505.576171875, obj_val: 11465.83984375, abs dis: 39.736328125
[rfa agg] iter:  4, weight: tensor([0.0771, 0.0772, 0.0874, 0.0800, 0.0708, 0.0998, 0.0611, 0.2294, 0.0828,
        0.1344])
[rfa agg] iter:  5, prev_obj_val: 11465.83984375, obj_val: 11427.73828125, abs dis: 38.1015625
[rfa agg] iter:  5, weight: tensor([0.0708, 0.0709, 0.0797, 0.0735, 0.0735, 0.1037, 0.0635, 0.2386, 0.0861,
        0.1397])
[rfa agg] iter:  6, prev_obj_val: 11427.73828125, obj_val: 11391.2744140625, abs dis: 36.4638671875
[rfa agg] iter:  6, weight: tensor([0.0648, 0.0649, 0.0724, 0.0673, 0.0762, 0.1075, 0.0657, 0.2473, 0.0892,
        0.1448])
[rfa agg] iter:  7, prev_obj_val: 11391.2744140625, obj_val: 11356.7197265625, abs dis: 34.5546875
[rfa agg] iter:  7, weight: tensor([0.0591, 0.0592, 0.0656, 0.0613, 0.0787, 0.1110, 0.0679, 0.2557, 0.0921,
        0.1496])
[rfa agg] iter:  8, prev_obj_val: 11356.7197265625, obj_val: 11324.34375, abs dis: 32.3759765625
[rfa agg] iter:  8, weight: tensor([0.0536, 0.0537, 0.0592, 0.0557, 0.0810, 0.1143, 0.0699, 0.2636, 0.0948,
        0.1541])
[rfa agg] iter:  9, prev_obj_val: 11324.34375, obj_val: 11294.416015625, abs dis: 29.927734375
[rfa agg] iter:  9, weight: tensor([0.0485, 0.0486, 0.0533, 0.0504, 0.0831, 0.1174, 0.0717, 0.2711, 0.0974,
        0.1583])
___Test Target_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.4083, Accuracy: 5879/10000 (58.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.2484, Accuracy: 8399/9000 (93.3222%)
Done in 211.01623225212097 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:228 choose agents : [17, 33, 77, 11, 67, 16, 64, 30, 35, 81]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   1,  Average loss: 0.0026, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   2,  Average loss: 0.0019, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   3,  Average loss: 0.0013, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   4,  Average loss: 0.0025, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   5,  Average loss: 0.0011, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   6,  Average loss: 0.0016, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 43.80016933739383.
Norm before scaling: 43.46974831483025. Distance: 3.2010738597525084
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.6043, Accuracy: 5548/10000 (55.4800%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.2580, Accuracy: 8234/9000 (91.4889%)
Scaling by  100
Scaled Norm after poisoning: 316.98411582838025, distance: 320.1073916477094
Total norm for 4 adversaries is: 316.98411582838025. distance: 320.1073916477094
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   1,  Average loss: 0.0021, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   2,  Average loss: 0.0009, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   3,  Average loss: 0.0015, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   4,  Average loss: 0.0014, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   5,  Average loss: 0.0006, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   6,  Average loss: 0.0013, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Global model norm: 43.80016933739383.
Norm before scaling: 43.425618035415596. Distance: 2.478601140079376
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.5364, Accuracy: 5679/10000 (56.7900%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.1552, Accuracy: 8524/9000 (94.7111%)
Scaling by  100
Scaled Norm after poisoning: 243.86819249852982, distance: 247.86010734384024
Total norm for 4 adversaries is: 243.86819249852982. distance: 247.86010734384024
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   2,  Average loss: 0.0009, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   3,  Average loss: 0.0006, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   4,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 43.80016933739383.
Norm before scaling: 43.45534845758704. Distance: 1.8422936975931739
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.3283, Accuracy: 5998/10000 (59.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.0691, Accuracy: 8810/9000 (97.8889%)
Scaling by  100
Scaled Norm after poisoning: 180.30743602074486, distance: 184.22938105457013
Total norm for 4 adversaries is: 180.30743602074486. distance: 184.22938105457013
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   2,  Average loss: 0.0006, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   3,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   4,  Average loss: 0.0003, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   5,  Average loss: 0.0003, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 43.80016933739383.
Norm before scaling: 43.39606133796519. Distance: 1.948639502680645
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.5891, Accuracy: 5742/10000 (57.4200%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.0728, Accuracy: 8779/9000 (97.5444%)
Scaling by  100
Scaled Norm after poisoning: 189.70252205756253, distance: 194.86394492375956
Total norm for 4 adversaries is: 189.70252205756253. distance: 194.86394492375956
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 228, local model 67, internal_epoch   1,  Average loss: 0.0202, Accuracy: 535/842 (63.5392%)
___Train Local_ResNet_18,  epoch 228, local model 67, internal_epoch   2,  Average loss: 0.0114, Accuracy: 635/842 (75.4157%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 5.2490, Accuracy: 2819/10000 (28.1900%)
___Train Local_ResNet_18,  epoch 228, local model 16, internal_epoch   1,  Average loss: 0.0239, Accuracy: 470/773 (60.8021%)
___Train Local_ResNet_18,  epoch 228, local model 16, internal_epoch   2,  Average loss: 0.0148, Accuracy: 556/773 (71.9276%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 3.4934, Accuracy: 3057/10000 (30.5700%)
___Train Local_ResNet_18,  epoch 228, local model 64, internal_epoch   1,  Average loss: 0.0177, Accuracy: 465/686 (67.7843%)
___Train Local_ResNet_18,  epoch 228, local model 64, internal_epoch   2,  Average loss: 0.0076, Accuracy: 578/686 (84.2566%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 3.9603, Accuracy: 3668/10000 (36.6800%)
___Train Local_ResNet_18,  epoch 228, local model 30, internal_epoch   1,  Average loss: 0.0233, Accuracy: 195/337 (57.8635%)
___Train Local_ResNet_18,  epoch 228, local model 30, internal_epoch   2,  Average loss: 0.0101, Accuracy: 278/337 (82.4926%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 7.1267, Accuracy: 2006/10000 (20.0600%)
___Train Local_ResNet_18,  epoch 228, local model 35, internal_epoch   1,  Average loss: 0.0207, Accuracy: 281/419 (67.0644%)
___Train Local_ResNet_18,  epoch 228, local model 35, internal_epoch   2,  Average loss: 0.0095, Accuracy: 351/419 (83.7709%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 9.5739, Accuracy: 2398/10000 (23.9800%)
___Train Local_ResNet_18,  epoch 228, local model 81, internal_epoch   1,  Average loss: 0.0157, Accuracy: 751/1034 (72.6306%)
___Train Local_ResNet_18,  epoch 228, local model 81, internal_epoch   2,  Average loss: 0.0081, Accuracy: 854/1034 (82.5919%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 3.4966, Accuracy: 4030/10000 (40.3000%)
time spent on training: 164.5338008403778
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.338667959909473  data num: [526, 527, 496, 546, 842, 773, 686, 337, 419, 1034]
[rfa agg] considering poison per batch poison_fraction: 0.02645843436792758
[rfa agg] init. name: [17, 33, 77, 11, 67, 16, 64, 30, 35, 81], weight: tensor([0.0850, 0.0852, 0.0802, 0.0883, 0.1361, 0.1250, 0.1109, 0.0545, 0.0677,
        0.1672])
[rfa agg] iter:  0, prev_obj_val: 10475.8935546875, obj_val: 9481.4453125, abs dis: 994.4482421875
[rfa agg] iter:  0, weight: tensor([0.0498, 0.0500, 0.0564, 0.0518, 0.1633, 0.1497, 0.1326, 0.0648, 0.0806,
        0.2012])
[rfa agg] iter:  1, prev_obj_val: 9481.4453125, obj_val: 8804.5654296875, abs dis: 676.8798828125
[rfa agg] iter:  1, weight: tensor([0.0284, 0.0285, 0.0312, 0.0295, 0.1820, 0.1668, 0.1475, 0.0718, 0.0894,
        0.2248])
[rfa agg] iter:  2, prev_obj_val: 8804.5654296875, obj_val: 8397.591796875, abs dis: 406.9736328125
[rfa agg] iter:  2, weight: tensor([0.0154, 0.0154, 0.0166, 0.0160, 0.1936, 0.1771, 0.1562, 0.0755, 0.0942,
        0.2401])
[rfa agg] iter:  3, prev_obj_val: 8397.591796875, obj_val: 8168.1533203125, abs dis: 229.4384765625
[rfa agg] iter:  3, weight: tensor([0.0080, 0.0081, 0.0086, 0.0083, 0.2005, 0.1830, 0.1604, 0.0765, 0.0957,
        0.2509])
[rfa agg] iter:  4, prev_obj_val: 8168.1533203125, obj_val: 8041.228515625, abs dis: 126.9248046875
[rfa agg] iter:  4, weight: tensor([0.0041, 0.0041, 0.0043, 0.0042, 0.2052, 0.1862, 0.1614, 0.0749, 0.0941,
        0.2615])
[rfa agg] iter:  5, prev_obj_val: 8041.228515625, obj_val: 7977.91796875, abs dis: 63.310546875
[rfa agg] iter:  5, weight: tensor([0.0019, 0.0019, 0.0020, 0.0020, 0.2095, 0.1875, 0.1584, 0.0695, 0.0883,
        0.2790])
[rfa agg] iter:  6, prev_obj_val: 7977.91796875, obj_val: 7946.9384765625, abs dis: 30.9794921875
[rfa agg] iter:  6, weight: tensor([0.0008, 0.0008, 0.0009, 0.0009, 0.2131, 0.1846, 0.1472, 0.0576, 0.0747,
        0.3194])
[rfa agg] iter:  7, prev_obj_val: 7946.9384765625, obj_val: 7941.38232421875, abs dis: 5.55615234375
[rfa agg] iter:  7, weight: tensor([2.5593e-04, 2.5644e-04, 2.7177e-04, 2.6569e-04, 1.9266e-01, 1.5123e-01,
        1.0404e-01, 3.2407e-02, 4.3502e-02, 4.7511e-01])
[rfa agg] iter:  8, prev_obj_val: 7941.38232421875, obj_val: 7946.7333984375, abs dis: 5.35107421875
[rfa agg] iter:  8, weight: tensor([1.3539e-04, 1.3566e-04, 1.4374e-04, 1.4056e-04, 3.0435e-01, 2.0624e-01,
        1.1113e-01, 2.5530e-02, 3.5623e-02, 3.1658e-01])
[rfa agg] iter:  9, prev_obj_val: 7946.7333984375, obj_val: 7950.97314453125, abs dis: 4.23974609375
[rfa agg] iter:  9, weight: tensor([1.2347e-04, 1.2371e-04, 1.3107e-04, 1.2818e-04, 2.6300e-01, 3.0923e-01,
        2.1012e-01, 3.1958e-02, 4.6643e-02, 1.3854e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.2339, Accuracy: 6136/10000 (61.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.3900, Accuracy: 8068/9000 (89.6444%)
Done in 210.63308429718018 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:229 choose agents : [17, 33, 77, 11, 62, 68, 2, 74, 39, 1]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   1,  Average loss: 0.0027, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   2,  Average loss: 0.0016, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   3,  Average loss: 0.0020, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   4,  Average loss: 0.0006, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   5,  Average loss: 0.0019, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   6,  Average loss: 0.0017, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Global model norm: 43.76425409536232.
Norm before scaling: 43.47496417210284. Distance: 3.4876195743529936
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.6419, Accuracy: 5414/10000 (54.1400%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.2756, Accuracy: 8313/9000 (92.3667%)
Scaling by  100
Scaled Norm after poisoning: 346.1359920609239, distance: 348.7619509601069
Total norm for 4 adversaries is: 346.1359920609239. distance: 348.7619509601069
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   1,  Average loss: 0.0021, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   2,  Average loss: 0.0014, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   3,  Average loss: 0.0012, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   4,  Average loss: 0.0006, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   5,  Average loss: 0.0005, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   6,  Average loss: 0.0029, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Global model norm: 43.76425409536232.
Norm before scaling: 43.42561944092594. Distance: 2.730431115760179
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.5467, Accuracy: 5551/10000 (55.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.1714, Accuracy: 8567/9000 (95.1889%)
Scaling by  100
Scaled Norm after poisoning: 269.75877534382454, distance: 273.0430941261837
Total norm for 4 adversaries is: 269.75877534382454. distance: 273.0430941261837
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   1,  Average loss: 0.0014, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   2,  Average loss: 0.0011, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   3,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   4,  Average loss: 0.0005, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 43.76425409536232.
Norm before scaling: 43.41903412576174. Distance: 1.6461449179280396
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.2585, Accuracy: 6156/10000 (61.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.1033, Accuracy: 8736/9000 (97.0667%)
Scaling by  100
Scaled Norm after poisoning: 160.4135768100693, distance: 164.6144940174619
Total norm for 4 adversaries is: 160.4135768100693. distance: 164.6144940174619
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   1,  Average loss: 0.0013, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   2,  Average loss: 0.0005, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   3,  Average loss: 0.0005, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   4,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   5,  Average loss: 0.0006, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 43.76425409536232.
Norm before scaling: 43.377818431036125. Distance: 2.0828455035949505
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.5042, Accuracy: 5822/10000 (58.2200%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.0598, Accuracy: 8817/9000 (97.9667%)
Scaling by  100
Scaled Norm after poisoning: 203.7068493417686, distance: 208.28454845475216
Total norm for 4 adversaries is: 203.7068493417686. distance: 208.28454845475216
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 229, local model 62, internal_epoch   1,  Average loss: 0.0189, Accuracy: 245/358 (68.4358%)
___Train Local_ResNet_18,  epoch 229, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 322/358 (89.9441%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 3.2315, Accuracy: 3540/10000 (35.4000%)
___Train Local_ResNet_18,  epoch 229, local model 68, internal_epoch   1,  Average loss: 0.0196, Accuracy: 262/416 (62.9808%)
___Train Local_ResNet_18,  epoch 229, local model 68, internal_epoch   2,  Average loss: 0.0059, Accuracy: 373/416 (89.6635%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 3.9066, Accuracy: 3139/10000 (31.3900%)
___Train Local_ResNet_18,  epoch 229, local model 2, internal_epoch   1,  Average loss: 0.0209, Accuracy: 311/461 (67.4620%)
___Train Local_ResNet_18,  epoch 229, local model 2, internal_epoch   2,  Average loss: 0.0115, Accuracy: 350/461 (75.9219%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 5.6183, Accuracy: 2627/10000 (26.2700%)
___Train Local_ResNet_18,  epoch 229, local model 74, internal_epoch   1,  Average loss: 0.0155, Accuracy: 329/469 (70.1493%)
___Train Local_ResNet_18,  epoch 229, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 405/469 (86.3539%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 3.2775, Accuracy: 3260/10000 (32.6000%)
___Train Local_ResNet_18,  epoch 229, local model 39, internal_epoch   1,  Average loss: 0.0274, Accuracy: 115/217 (52.9954%)
___Train Local_ResNet_18,  epoch 229, local model 39, internal_epoch   2,  Average loss: 0.0089, Accuracy: 190/217 (87.5576%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 10.6445, Accuracy: 1493/10000 (14.9300%)
___Train Local_ResNet_18,  epoch 229, local model 1, internal_epoch   1,  Average loss: 0.0227, Accuracy: 444/641 (69.2668%)
___Train Local_ResNet_18,  epoch 229, local model 1, internal_epoch   2,  Average loss: 0.0134, Accuracy: 502/641 (78.3151%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 3.7013, Accuracy: 3513/10000 (35.1300%)
time spent on training: 164.6484751701355
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.44986042516641617  data num: [526, 527, 496, 546, 358, 416, 461, 469, 217, 641]
[rfa agg] considering poison per batch poison_fraction: 0.035145345716126264
[rfa agg] init. name: [17, 33, 77, 11, 62, 68, 2, 74, 39, 1], weight: tensor([0.1129, 0.1132, 0.1065, 0.1172, 0.0769, 0.0893, 0.0990, 0.1007, 0.0466,
        0.1376])
[rfa agg] iter:  0, prev_obj_val: 11604.6357421875, obj_val: 11486.9521484375, abs dis: 117.68359375
[rfa agg] iter:  0, weight: tensor([0.0953, 0.0955, 0.1121, 0.0990, 0.0834, 0.0970, 0.1076, 0.1095, 0.0505,
        0.1500])
[rfa agg] iter:  1, prev_obj_val: 11486.9521484375, obj_val: 11373.7919921875, abs dis: 113.16015625
[rfa agg] iter:  1, weight: tensor([0.0843, 0.0845, 0.0972, 0.0875, 0.0902, 0.1049, 0.1163, 0.1183, 0.0545,
        0.1622])
[rfa agg] iter:  2, prev_obj_val: 11373.7919921875, obj_val: 11267.3857421875, abs dis: 106.40625
[rfa agg] iter:  2, weight: tensor([0.0737, 0.0739, 0.0837, 0.0766, 0.0965, 0.1123, 0.1245, 0.1267, 0.0584,
        0.1737])
[rfa agg] iter:  3, prev_obj_val: 11267.3857421875, obj_val: 11169.0712890625, abs dis: 98.314453125
[rfa agg] iter:  3, weight: tensor([0.0639, 0.0640, 0.0716, 0.0663, 0.1023, 0.1191, 0.1321, 0.1344, 0.0619,
        0.1844])
[rfa agg] iter:  4, prev_obj_val: 11169.0712890625, obj_val: 11079.748046875, abs dis: 89.3232421875
[rfa agg] iter:  4, weight: tensor([0.0548, 0.0550, 0.0609, 0.0570, 0.1076, 0.1252, 0.1390, 0.1414, 0.0650,
        0.1941])
[rfa agg] iter:  5, prev_obj_val: 11079.748046875, obj_val: 10998.955078125, abs dis: 80.79296875
[rfa agg] iter:  5, weight: tensor([0.0467, 0.0468, 0.0514, 0.0485, 0.1123, 0.1307, 0.1451, 0.1477, 0.0679,
        0.2028])
[rfa agg] iter:  6, prev_obj_val: 10998.955078125, obj_val: 10927.59765625, abs dis: 71.357421875
[rfa agg] iter:  6, weight: tensor([0.0394, 0.0395, 0.0431, 0.0409, 0.1165, 0.1356, 0.1506, 0.1532, 0.0703,
        0.2107])
[rfa agg] iter:  7, prev_obj_val: 10927.59765625, obj_val: 10865.216796875, abs dis: 62.380859375
[rfa agg] iter:  7, weight: tensor([0.0330, 0.0331, 0.0359, 0.0343, 0.1201, 0.1399, 0.1554, 0.1581, 0.0725,
        0.2176])
[rfa agg] iter:  8, prev_obj_val: 10865.216796875, obj_val: 10811.3623046875, abs dis: 53.8544921875
[rfa agg] iter:  8, weight: tensor([0.0275, 0.0276, 0.0298, 0.0286, 0.1232, 0.1436, 0.1595, 0.1623, 0.0743,
        0.2237])
[rfa agg] iter:  9, prev_obj_val: 10811.3623046875, obj_val: 10765.5908203125, abs dis: 45.771484375
[rfa agg] iter:  9, weight: tensor([0.0228, 0.0228, 0.0245, 0.0236, 0.1258, 0.1467, 0.1631, 0.1659, 0.0757,
        0.2291])
___Test Target_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.1853, Accuracy: 6253/10000 (62.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.1671, Accuracy: 8582/9000 (95.3556%)
Done in 210.5258491039276 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:230 choose agents : [17, 33, 77, 11, 64, 29, 21, 39, 95, 90]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   1,  Average loss: 0.0009, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   2,  Average loss: 0.0014, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   3,  Average loss: 0.0010, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   4,  Average loss: 0.0008, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   5,  Average loss: 0.0008, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Global model norm: 43.374929642414116.
Norm before scaling: 42.99920511619953. Distance: 2.3685354291614713
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.4983, Accuracy: 5813/10000 (58.1300%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.1322, Accuracy: 8637/9000 (95.9667%)
Scaling by  100
Scaled Norm after poisoning: 232.7546068958679, distance: 236.85356103508346
Total norm for 4 adversaries is: 232.7546068958679. distance: 236.85356103508346
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   1,  Average loss: 0.0017, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   2,  Average loss: 0.0016, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   3,  Average loss: 0.0007, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   4,  Average loss: 0.0011, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   5,  Average loss: 0.0011, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   6,  Average loss: 0.0012, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Global model norm: 43.374929642414116.
Norm before scaling: 43.0546513506925. Distance: 3.003559226440091
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.5624, Accuracy: 5633/10000 (56.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.1045, Accuracy: 8659/9000 (96.2111%)
Scaling by  100
Scaled Norm after poisoning: 297.36303307153025, distance: 300.3559086733604
Total norm for 4 adversaries is: 297.36303307153025. distance: 300.3559086733604
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   2,  Average loss: 0.0008, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   3,  Average loss: 0.0008, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   4,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 43.374929642414116.
Norm before scaling: 43.018476907821245. Distance: 1.4724911058348351
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.2209, Accuracy: 6288/10000 (62.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.0587, Accuracy: 8821/9000 (98.0111%)
Scaling by  100
Scaled Norm after poisoning: 142.363339074707, distance: 147.24910467681968
Total norm for 4 adversaries is: 142.363339074707. distance: 147.24910467681968
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   1,  Average loss: 0.0004, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   2,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   3,  Average loss: 0.0001, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   4,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 43.374929642414116.
Norm before scaling: 42.934597222658034. Distance: 1.0923397236453674
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.3171, Accuracy: 6227/10000 (62.2700%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.1102, Accuracy: 8718/9000 (96.8667%)
Scaling by  100
Scaled Norm after poisoning: 99.46695332967377, distance: 109.23397604883519
Total norm for 4 adversaries is: 99.46695332967377. distance: 109.23397604883519
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 230, local model 64, internal_epoch   1,  Average loss: 0.0170, Accuracy: 463/686 (67.4927%)
___Train Local_ResNet_18,  epoch 230, local model 64, internal_epoch   2,  Average loss: 0.0084, Accuracy: 566/686 (82.5073%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 4.8969, Accuracy: 2884/10000 (28.8400%)
___Train Local_ResNet_18,  epoch 230, local model 29, internal_epoch   1,  Average loss: 0.0154, Accuracy: 626/848 (73.8208%)
___Train Local_ResNet_18,  epoch 230, local model 29, internal_epoch   2,  Average loss: 0.0071, Accuracy: 741/848 (87.3821%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 4.2084, Accuracy: 3177/10000 (31.7700%)
___Train Local_ResNet_18,  epoch 230, local model 21, internal_epoch   1,  Average loss: 0.0223, Accuracy: 182/262 (69.4656%)
___Train Local_ResNet_18,  epoch 230, local model 21, internal_epoch   2,  Average loss: 0.0110, Accuracy: 226/262 (86.2595%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 5.4468, Accuracy: 2926/10000 (29.2600%)
___Train Local_ResNet_18,  epoch 230, local model 39, internal_epoch   1,  Average loss: 0.0249, Accuracy: 127/217 (58.5253%)
___Train Local_ResNet_18,  epoch 230, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 200/217 (92.1659%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 8.1760, Accuracy: 2036/10000 (20.3600%)
___Train Local_ResNet_18,  epoch 230, local model 95, internal_epoch   1,  Average loss: 0.0182, Accuracy: 376/569 (66.0808%)
___Train Local_ResNet_18,  epoch 230, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 505/569 (88.7522%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 8.6728, Accuracy: 2512/10000 (25.1200%)
___Train Local_ResNet_18,  epoch 230, local model 90, internal_epoch   1,  Average loss: 0.0202, Accuracy: 405/578 (70.0692%)
___Train Local_ResNet_18,  epoch 230, local model 90, internal_epoch   2,  Average loss: 0.0091, Accuracy: 485/578 (83.9100%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 6.5914, Accuracy: 2682/10000 (26.8200%)
time spent on training: 164.7107379436493
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.39866793529971456  data num: [526, 527, 496, 546, 686, 848, 262, 217, 569, 578]
[rfa agg] considering poison per batch poison_fraction: 0.0311459324452902
[rfa agg] init. name: [17, 33, 77, 11, 64, 29, 21, 39, 95, 90], weight: tensor([0.1001, 0.1003, 0.0944, 0.1039, 0.1305, 0.1614, 0.0499, 0.0413, 0.1083,
        0.1100])
[rfa agg] iter:  0, prev_obj_val: 11227.4345703125, obj_val: 10781.35546875, abs dis: 446.0791015625
[rfa agg] iter:  0, weight: tensor([0.0730, 0.0731, 0.0842, 0.0758, 0.1507, 0.1869, 0.0572, 0.0474, 0.1248,
        0.1269])
[rfa agg] iter:  1, prev_obj_val: 10781.35546875, obj_val: 10399.6767578125, abs dis: 381.6787109375
[rfa agg] iter:  1, weight: tensor([0.0542, 0.0543, 0.0607, 0.0562, 0.1683, 0.2089, 0.0638, 0.0528, 0.1393,
        0.1416])
[rfa agg] iter:  2, prev_obj_val: 10399.6767578125, obj_val: 10095.9814453125, abs dis: 303.6953125
[rfa agg] iter:  2, weight: tensor([0.0388, 0.0389, 0.0427, 0.0403, 0.1824, 0.2266, 0.0690, 0.0570, 0.1508,
        0.1534])
[rfa agg] iter:  3, prev_obj_val: 10095.9814453125, obj_val: 9863.9130859375, abs dis: 232.068359375
[rfa agg] iter:  3, weight: tensor([0.0272, 0.0272, 0.0295, 0.0282, 0.1931, 0.2404, 0.0727, 0.0601, 0.1594,
        0.1623])
[rfa agg] iter:  4, prev_obj_val: 9863.9130859375, obj_val: 9696.2119140625, abs dis: 167.701171875
[rfa agg] iter:  4, weight: tensor([0.0186, 0.0186, 0.0200, 0.0193, 0.2010, 0.2510, 0.0752, 0.0621, 0.1656,
        0.1688])
[rfa agg] iter:  5, prev_obj_val: 9696.2119140625, obj_val: 9578.375, abs dis: 117.8369140625
[rfa agg] iter:  5, weight: tensor([0.0125, 0.0125, 0.0134, 0.0130, 0.2066, 0.2594, 0.0766, 0.0631, 0.1697,
        0.1732])
[rfa agg] iter:  6, prev_obj_val: 9578.375, obj_val: 9494.9931640625, abs dis: 83.3818359375
[rfa agg] iter:  6, weight: tensor([0.0083, 0.0083, 0.0089, 0.0086, 0.2107, 0.2666, 0.0770, 0.0633, 0.1722,
        0.1762])
[rfa agg] iter:  7, prev_obj_val: 9494.9931640625, obj_val: 9439.720703125, abs dis: 55.2724609375
[rfa agg] iter:  7, weight: tensor([0.0054, 0.0054, 0.0057, 0.0056, 0.2138, 0.2739, 0.0763, 0.0625, 0.1733,
        0.1781])
[rfa agg] iter:  8, prev_obj_val: 9439.720703125, obj_val: 9400.78515625, abs dis: 38.935546875
[rfa agg] iter:  8, weight: tensor([0.0035, 0.0035, 0.0037, 0.0036, 0.2162, 0.2826, 0.0744, 0.0607, 0.1730,
        0.1789])
[rfa agg] iter:  9, prev_obj_val: 9400.78515625, obj_val: 9375.486328125, abs dis: 25.298828125
[rfa agg] iter:  9, weight: tensor([0.0021, 0.0021, 0.0022, 0.0022, 0.2182, 0.2961, 0.0707, 0.0571, 0.1708,
        0.1785])
___Test Target_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.0744, Accuracy: 6426/10000 (64.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.2462, Accuracy: 8403/9000 (93.3667%)
Done in 211.48682808876038 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:231 choose agents : [17, 33, 77, 11, 68, 38, 97, 3, 98, 90]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   2,  Average loss: 0.0018, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   3,  Average loss: 0.0015, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   4,  Average loss: 0.0014, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   5,  Average loss: 0.0013, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   6,  Average loss: 0.0013, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 43.30537600368241.
Norm before scaling: 43.01617837003306. Distance: 3.025786835034705
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.6003, Accuracy: 5334/10000 (53.3400%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.2231, Accuracy: 8418/9000 (93.5333%)
Scaling by  100
Scaled Norm after poisoning: 300.02885277919523, distance: 302.5786442191517
Total norm for 4 adversaries is: 300.02885277919523. distance: 302.5786442191517
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   1,  Average loss: 0.0009, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   2,  Average loss: 0.0014, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   3,  Average loss: 0.0014, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   4,  Average loss: 0.0013, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   5,  Average loss: 0.0010, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   6,  Average loss: 0.0014, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Global model norm: 43.30537600368241.
Norm before scaling: 42.923743474984214. Distance: 2.153007834115949
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.3975, Accuracy: 5943/10000 (59.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.0890, Accuracy: 8700/9000 (96.6667%)
Scaling by  100
Scaled Norm after poisoning: 210.89205992047212, distance: 215.30077979712476
Total norm for 4 adversaries is: 210.89205992047212. distance: 215.30077979712476
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   1,  Average loss: 0.0009, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   3,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   5,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 43.30537600368241.
Norm before scaling: 42.941768517358916. Distance: 1.1180517415099447
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.1795, Accuracy: 6374/10000 (63.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.0661, Accuracy: 8809/9000 (97.8778%)
Scaling by  100
Scaled Norm after poisoning: 105.42653321744959, distance: 111.80516762570727
Total norm for 4 adversaries is: 105.42653321744959. distance: 111.80516762570727
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   2,  Average loss: 0.0005, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   3,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   4,  Average loss: 0.0005, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   5,  Average loss: 0.0003, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 43.30537600368241.
Norm before scaling: 42.87810324957542. Distance: 1.26885545790288
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.3713, Accuracy: 6094/10000 (60.9400%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.0950, Accuracy: 8751/9000 (97.2333%)
Scaling by  100
Scaled Norm after poisoning: 118.87779307970013, distance: 126.885552208969
Total norm for 4 adversaries is: 118.87779307970013. distance: 126.885552208969
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 231, local model 68, internal_epoch   1,  Average loss: 0.0176, Accuracy: 275/416 (66.1058%)
___Train Local_ResNet_18,  epoch 231, local model 68, internal_epoch   2,  Average loss: 0.0054, Accuracy: 372/416 (89.4231%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 3.8719, Accuracy: 3109/10000 (31.0900%)
___Train Local_ResNet_18,  epoch 231, local model 38, internal_epoch   1,  Average loss: 0.0171, Accuracy: 510/756 (67.4603%)
___Train Local_ResNet_18,  epoch 231, local model 38, internal_epoch   2,  Average loss: 0.0093, Accuracy: 615/756 (81.3492%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 4.3222, Accuracy: 3995/10000 (39.9500%)
___Train Local_ResNet_18,  epoch 231, local model 97, internal_epoch   1,  Average loss: 0.0151, Accuracy: 303/418 (72.4880%)
___Train Local_ResNet_18,  epoch 231, local model 97, internal_epoch   2,  Average loss: 0.0069, Accuracy: 363/418 (86.8421%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 4.0572, Accuracy: 4071/10000 (40.7100%)
___Train Local_ResNet_18,  epoch 231, local model 3, internal_epoch   1,  Average loss: 0.0184, Accuracy: 529/780 (67.8205%)
___Train Local_ResNet_18,  epoch 231, local model 3, internal_epoch   2,  Average loss: 0.0072, Accuracy: 659/780 (84.4872%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 3.7054, Accuracy: 3440/10000 (34.4000%)
___Train Local_ResNet_18,  epoch 231, local model 98, internal_epoch   1,  Average loss: 0.0188, Accuracy: 546/802 (68.0798%)
___Train Local_ResNet_18,  epoch 231, local model 98, internal_epoch   2,  Average loss: 0.0106, Accuracy: 641/802 (79.9252%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 5.3579, Accuracy: 2188/10000 (21.8800%)
___Train Local_ResNet_18,  epoch 231, local model 90, internal_epoch   1,  Average loss: 0.0258, Accuracy: 412/578 (71.2803%)
___Train Local_ResNet_18,  epoch 231, local model 90, internal_epoch   2,  Average loss: 0.0125, Accuracy: 450/578 (77.8547%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 13.8136, Accuracy: 1522/10000 (15.2200%)
time spent on training: 167.32600116729736
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.358426005132592  data num: [526, 527, 496, 546, 416, 756, 418, 780, 802, 578]
[rfa agg] considering poison per batch poison_fraction: 0.02800203165098375
[rfa agg] init. name: [17, 33, 77, 11, 68, 38, 97, 3, 98, 90], weight: tensor([0.0900, 0.0902, 0.0849, 0.0934, 0.0712, 0.1293, 0.0715, 0.1334, 0.1372,
        0.0989])
[rfa agg] iter:  0, prev_obj_val: 10763.404296875, obj_val: 9961.67578125, abs dis: 801.728515625
[rfa agg] iter:  0, weight: tensor([0.0570, 0.0571, 0.0648, 0.0592, 0.0842, 0.1538, 0.0846, 0.1588, 0.1633,
        0.1173])
[rfa agg] iter:  1, prev_obj_val: 9961.67578125, obj_val: 9366.427734375, abs dis: 595.248046875
[rfa agg] iter:  1, weight: tensor([0.0357, 0.0358, 0.0394, 0.0371, 0.0939, 0.1720, 0.0944, 0.1778, 0.1828,
        0.1311])
[rfa agg] iter:  2, prev_obj_val: 9366.427734375, obj_val: 8968.763671875, abs dis: 397.6640625
[rfa agg] iter:  2, weight: tensor([0.0213, 0.0214, 0.0231, 0.0221, 0.1001, 0.1844, 0.1006, 0.1907, 0.1961,
        0.1402])
[rfa agg] iter:  3, prev_obj_val: 8968.763671875, obj_val: 8721.8203125, abs dis: 246.943359375
[rfa agg] iter:  3, weight: tensor([0.0123, 0.0123, 0.0132, 0.0127, 0.1035, 0.1922, 0.1040, 0.1992, 0.2048,
        0.1457])
[rfa agg] iter:  4, prev_obj_val: 8721.8203125, obj_val: 8574.9404296875, abs dis: 146.8798828125
[rfa agg] iter:  4, weight: tensor([0.0069, 0.0069, 0.0074, 0.0072, 0.1045, 0.1973, 0.1050, 0.2052, 0.2110,
        0.1486])
[rfa agg] iter:  5, prev_obj_val: 8574.9404296875, obj_val: 8490.14453125, abs dis: 84.7958984375
[rfa agg] iter:  5, weight: tensor([0.0038, 0.0038, 0.0040, 0.0039, 0.1033, 0.2011, 0.1038, 0.2104, 0.2164,
        0.1495])
[rfa agg] iter:  6, prev_obj_val: 8490.14453125, obj_val: 8440.880859375, abs dis: 49.263671875
[rfa agg] iter:  6, weight: tensor([0.0020, 0.0020, 0.0021, 0.0021, 0.0992, 0.2046, 0.0997, 0.2169, 0.2230,
        0.1484])
[rfa agg] iter:  7, prev_obj_val: 8440.880859375, obj_val: 8415.8662109375, abs dis: 25.0146484375
[rfa agg] iter:  7, weight: tensor([0.0010, 0.0010, 0.0010, 0.0010, 0.0896, 0.2091, 0.0900, 0.2287, 0.2352,
        0.1434])
[rfa agg] iter:  8, prev_obj_val: 8415.8662109375, obj_val: 8403.517578125, abs dis: 12.3486328125
[rfa agg] iter:  8, weight: tensor([0.0004, 0.0004, 0.0004, 0.0004, 0.0712, 0.2134, 0.0715, 0.2531, 0.2601,
        0.1291])
[rfa agg] iter:  9, prev_obj_val: 8403.517578125, obj_val: 8410.576171875, abs dis: 7.05859375
[rfa agg] iter:  9, weight: tensor([1.2342e-04, 1.2367e-04, 1.3103e-04, 1.2813e-04, 3.6972e-02, 2.0096e-01,
        3.7160e-02, 3.1650e-01, 3.2256e-01, 8.5350e-02])
___Test Target_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.0512, Accuracy: 6428/10000 (64.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.4006, Accuracy: 8081/9000 (89.7889%)
Done in 214.64734935760498 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:232 choose agents : [17, 33, 77, 11, 88, 25, 27, 56, 93, 42]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   1,  Average loss: 0.0015, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   2,  Average loss: 0.0020, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   3,  Average loss: 0.0015, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   4,  Average loss: 0.0010, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   5,  Average loss: 0.0009, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   6,  Average loss: 0.0010, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Global model norm: 43.270965610253604.
Norm before scaling: 42.92131188199954. Distance: 2.5742658920486607
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.4539, Accuracy: 5770/10000 (57.7000%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.1192, Accuracy: 8606/9000 (95.6222%)
Scaling by  100
Scaled Norm after poisoning: 253.89837103159996, distance: 257.42656719926947
Total norm for 4 adversaries is: 253.89837103159996. distance: 257.42656719926947
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   1,  Average loss: 0.0017, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   2,  Average loss: 0.0011, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   3,  Average loss: 0.0009, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   4,  Average loss: 0.0008, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   5,  Average loss: 0.0014, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   6,  Average loss: 0.0010, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Global model norm: 43.270965610253604.
Norm before scaling: 42.917194923680505. Distance: 2.393091861299146
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.5692, Accuracy: 5622/10000 (56.2200%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.1643, Accuracy: 8492/9000 (94.3556%)
Scaling by  100
Scaled Norm after poisoning: 235.62582062191316, distance: 239.3091946102364
Total norm for 4 adversaries is: 235.62582062191316. distance: 239.3091946102364
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   1,  Average loss: 0.0013, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   3,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   4,  Average loss: 0.0005, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Global model norm: 43.270965610253604.
Norm before scaling: 42.9341451564195. Distance: 1.4774551519051646
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.1349, Accuracy: 6462/10000 (64.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.1212, Accuracy: 8724/9000 (96.9333%)
Scaling by  100
Scaled Norm after poisoning: 143.45485325312282, distance: 147.74551865031304
Total norm for 4 adversaries is: 143.45485325312282. distance: 147.74551865031304
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   1,  Average loss: 0.0008, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   2,  Average loss: 0.0002, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   3,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   4,  Average loss: 0.0003, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   5,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 43.270965610253604.
Norm before scaling: 42.850832519990206. Distance: 1.2964725559359067
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.3713, Accuracy: 6071/10000 (60.7100%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.0733, Accuracy: 8786/9000 (97.6222%)
Scaling by  100
Scaled Norm after poisoning: 122.04278914713683, distance: 129.64725279098667
Total norm for 4 adversaries is: 122.04278914713683. distance: 129.64725279098667
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 232, local model 88, internal_epoch   1,  Average loss: 0.0213, Accuracy: 266/447 (59.5078%)
___Train Local_ResNet_18,  epoch 232, local model 88, internal_epoch   2,  Average loss: 0.0080, Accuracy: 377/447 (84.3400%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 5.8646, Accuracy: 2690/10000 (26.9000%)
___Train Local_ResNet_18,  epoch 232, local model 25, internal_epoch   1,  Average loss: 0.0128, Accuracy: 411/545 (75.4128%)
___Train Local_ResNet_18,  epoch 232, local model 25, internal_epoch   2,  Average loss: 0.0057, Accuracy: 491/545 (90.0917%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 4.2143, Accuracy: 3273/10000 (32.7300%)
___Train Local_ResNet_18,  epoch 232, local model 27, internal_epoch   1,  Average loss: 0.0153, Accuracy: 301/397 (75.8186%)
___Train Local_ResNet_18,  epoch 232, local model 27, internal_epoch   2,  Average loss: 0.0069, Accuracy: 350/397 (88.1612%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 3.5877, Accuracy: 3334/10000 (33.3400%)
___Train Local_ResNet_18,  epoch 232, local model 56, internal_epoch   1,  Average loss: 0.0138, Accuracy: 545/743 (73.3513%)
___Train Local_ResNet_18,  epoch 232, local model 56, internal_epoch   2,  Average loss: 0.0062, Accuracy: 646/743 (86.9448%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.9609, Accuracy: 4835/10000 (48.3500%)
___Train Local_ResNet_18,  epoch 232, local model 93, internal_epoch   1,  Average loss: 0.0144, Accuracy: 439/584 (75.1712%)
___Train Local_ResNet_18,  epoch 232, local model 93, internal_epoch   2,  Average loss: 0.0071, Accuracy: 514/584 (88.0137%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 2.8484, Accuracy: 4110/10000 (41.1000%)
___Train Local_ResNet_18,  epoch 232, local model 42, internal_epoch   1,  Average loss: 0.0245, Accuracy: 133/198 (67.1717%)
___Train Local_ResNet_18,  epoch 232, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 182/198 (91.9192%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 7.7455, Accuracy: 1809/10000 (18.0900%)
time spent on training: 169.9648973941803
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4182471551207826  data num: [526, 527, 496, 546, 447, 545, 397, 743, 584, 198]
[rfa agg] considering poison per batch poison_fraction: 0.03267555899381114
[rfa agg] init. name: [17, 33, 77, 11, 88, 25, 27, 56, 93, 42], weight: tensor([0.1050, 0.1052, 0.0990, 0.1090, 0.0892, 0.1088, 0.0793, 0.1483, 0.1166,
        0.0395])
[rfa agg] iter:  0, prev_obj_val: 11402.4140625, obj_val: 11103.9287109375, abs dis: 298.4853515625
[rfa agg] iter:  0, weight: tensor([0.0814, 0.0815, 0.0945, 0.0845, 0.1008, 0.1231, 0.0895, 0.1683, 0.1320,
        0.0445])
[rfa agg] iter:  1, prev_obj_val: 11103.9287109375, obj_val: 10833.26953125, abs dis: 270.6591796875
[rfa agg] iter:  1, weight: tensor([0.0650, 0.0651, 0.0735, 0.0675, 0.1115, 0.1363, 0.0991, 0.1865, 0.1462,
        0.0492])
[rfa agg] iter:  2, prev_obj_val: 10833.26953125, obj_val: 10599.93359375, abs dis: 233.3359375
[rfa agg] iter:  2, weight: tensor([0.0506, 0.0507, 0.0562, 0.0525, 0.1208, 0.1477, 0.1073, 0.2023, 0.1585,
        0.0533])
[rfa agg] iter:  3, prev_obj_val: 10599.93359375, obj_val: 10407.564453125, abs dis: 192.369140625
[rfa agg] iter:  3, weight: tensor([0.0386, 0.0386, 0.0423, 0.0400, 0.1284, 0.1572, 0.1141, 0.2155, 0.1687,
        0.0566])
[rfa agg] iter:  4, prev_obj_val: 10407.564453125, obj_val: 10253.96875, abs dis: 153.595703125
[rfa agg] iter:  4, weight: tensor([0.0289, 0.0290, 0.0314, 0.0300, 0.1344, 0.1647, 0.1194, 0.2262, 0.1769,
        0.0591])
[rfa agg] iter:  5, prev_obj_val: 10253.96875, obj_val: 10134.021484375, abs dis: 119.947265625
[rfa agg] iter:  5, weight: tensor([0.0213, 0.0214, 0.0230, 0.0222, 0.1390, 0.1705, 0.1234, 0.2348, 0.1833,
        0.0610])
[rfa agg] iter:  6, prev_obj_val: 10134.021484375, obj_val: 10043.33203125, abs dis: 90.689453125
[rfa agg] iter:  6, weight: tensor([0.0156, 0.0156, 0.0167, 0.0162, 0.1423, 0.1750, 0.1264, 0.2418, 0.1884,
        0.0622])
[rfa agg] iter:  7, prev_obj_val: 10043.33203125, obj_val: 9974.5849609375, abs dis: 68.7470703125
[rfa agg] iter:  7, weight: tensor([0.0112, 0.0113, 0.0120, 0.0117, 0.1445, 0.1783, 0.1283, 0.2476, 0.1922,
        0.0629])
[rfa agg] iter:  8, prev_obj_val: 9974.5849609375, obj_val: 9924.126953125, abs dis: 50.4580078125
[rfa agg] iter:  8, weight: tensor([0.0080, 0.0080, 0.0085, 0.0083, 0.1458, 0.1807, 0.1295, 0.2528, 0.1953,
        0.0630])
[rfa agg] iter:  9, prev_obj_val: 9924.126953125, obj_val: 9886.837890625, abs dis: 37.2890625
[rfa agg] iter:  9, weight: tensor([0.0056, 0.0056, 0.0060, 0.0059, 0.1462, 0.1825, 0.1298, 0.2580, 0.1979,
        0.0625])
___Test Target_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.0113, Accuracy: 6603/10000 (66.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.3551, Accuracy: 8167/9000 (90.7444%)
Done in 217.0962884426117 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:233 choose agents : [17, 33, 77, 11, 18, 66, 27, 82, 86, 67]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   1,  Average loss: 0.0017, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   2,  Average loss: 0.0009, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   3,  Average loss: 0.0010, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   4,  Average loss: 0.0028, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   5,  Average loss: 0.0008, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   6,  Average loss: 0.0010, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Global model norm: 43.154087506917435.
Norm before scaling: 42.78763249048286. Distance: 2.331180998980153
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.4022, Accuracy: 5788/10000 (57.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.1962, Accuracy: 8463/9000 (94.0333%)
Scaling by  100
Scaled Norm after poisoning: 229.15830193067413, distance: 233.1180964125265
Total norm for 4 adversaries is: 229.15830193067413. distance: 233.1180964125265
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   1,  Average loss: 0.0019, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   2,  Average loss: 0.0009, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   3,  Average loss: 0.0007, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   4,  Average loss: 0.0015, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   5,  Average loss: 0.0016, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   6,  Average loss: 0.0024, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Global model norm: 43.154087506917435.
Norm before scaling: 42.78524309113117. Distance: 2.1088808964487527
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.3701, Accuracy: 6059/10000 (60.5900%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.1844, Accuracy: 8458/9000 (93.9778%)
Scaling by  100
Scaled Norm after poisoning: 206.69192238994248, distance: 210.88807754351595
Total norm for 4 adversaries is: 206.69192238994248. distance: 210.88807754351595
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   2,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   3,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   4,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 43.154087506917435.
Norm before scaling: 42.80017785721661. Distance: 1.2313401300583153
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.1477, Accuracy: 6447/10000 (64.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.0916, Accuracy: 8765/9000 (97.3889%)
Scaling by  100
Scaled Norm after poisoning: 117.60381052499957, distance: 123.13400585718594
Total norm for 4 adversaries is: 117.60381052499957. distance: 123.13400585718594
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   1,  Average loss: 0.0011, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   2,  Average loss: 0.0004, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   3,  Average loss: 0.0005, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   4,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   5,  Average loss: 0.0003, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 43.154087506917435.
Norm before scaling: 42.738672373050356. Distance: 1.3459047739457983
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.3563, Accuracy: 6043/10000 (60.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.0598, Accuracy: 8825/9000 (98.0556%)
Scaling by  100
Scaled Norm after poisoning: 127.3876764729913, distance: 134.59048129882737
Total norm for 4 adversaries is: 127.3876764729913. distance: 134.59048129882737
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 233, local model 18, internal_epoch   1,  Average loss: 0.0157, Accuracy: 282/386 (73.0570%)
___Train Local_ResNet_18,  epoch 233, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 357/386 (92.4870%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 3.3185, Accuracy: 3924/10000 (39.2400%)
___Train Local_ResNet_18,  epoch 233, local model 66, internal_epoch   1,  Average loss: 0.0092, Accuracy: 462/555 (83.2432%)
___Train Local_ResNet_18,  epoch 233, local model 66, internal_epoch   2,  Average loss: 0.0029, Accuracy: 528/555 (95.1351%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 4.3158, Accuracy: 3994/10000 (39.9400%)
___Train Local_ResNet_18,  epoch 233, local model 27, internal_epoch   1,  Average loss: 0.0124, Accuracy: 311/397 (78.3375%)
___Train Local_ResNet_18,  epoch 233, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 358/397 (90.1763%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 4.7549, Accuracy: 3461/10000 (34.6100%)
___Train Local_ResNet_18,  epoch 233, local model 82, internal_epoch   1,  Average loss: 0.0134, Accuracy: 477/601 (79.3677%)
___Train Local_ResNet_18,  epoch 233, local model 82, internal_epoch   2,  Average loss: 0.0054, Accuracy: 537/601 (89.3511%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 4.0692, Accuracy: 3656/10000 (36.5600%)
___Train Local_ResNet_18,  epoch 233, local model 86, internal_epoch   1,  Average loss: 0.0210, Accuracy: 138/212 (65.0943%)
___Train Local_ResNet_18,  epoch 233, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 196/212 (92.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 5.4771, Accuracy: 1953/10000 (19.5300%)
___Train Local_ResNet_18,  epoch 233, local model 67, internal_epoch   1,  Average loss: 0.0146, Accuracy: 591/842 (70.1900%)
___Train Local_ResNet_18,  epoch 233, local model 67, internal_epoch   2,  Average loss: 0.0105, Accuracy: 693/842 (82.3040%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 7.5704, Accuracy: 1559/10000 (15.5900%)
time spent on training: 166.84846758842468
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4117531446540881  data num: [526, 527, 496, 546, 386, 555, 397, 601, 212, 842]
[rfa agg] considering poison per batch poison_fraction: 0.03216821442610063
[rfa agg] init. name: [17, 33, 77, 11, 18, 66, 27, 82, 86, 67], weight: tensor([0.1034, 0.1036, 0.0975, 0.1073, 0.0759, 0.1091, 0.0780, 0.1181, 0.0417,
        0.1655])
[rfa agg] iter:  0, prev_obj_val: 11346.6982421875, obj_val: 11001.6318359375, abs dis: 345.06640625
[rfa agg] iter:  0, weight: tensor([0.0785, 0.0787, 0.0910, 0.0815, 0.0862, 0.1242, 0.0887, 0.1346, 0.0472,
        0.1893])
[rfa agg] iter:  1, prev_obj_val: 11001.6318359375, obj_val: 10694.4931640625, abs dis: 307.138671875
[rfa agg] iter:  1, weight: tensor([0.0612, 0.0614, 0.0691, 0.0636, 0.0957, 0.1380, 0.0985, 0.1496, 0.0524,
        0.2106])
[rfa agg] iter:  2, prev_obj_val: 10694.4931640625, obj_val: 10437.1123046875, abs dis: 257.380859375
[rfa agg] iter:  2, weight: tensor([0.0464, 0.0465, 0.0514, 0.0482, 0.1037, 0.1496, 0.1067, 0.1622, 0.0567,
        0.2286])
[rfa agg] iter:  3, prev_obj_val: 10437.1123046875, obj_val: 10228.6875, abs dis: 208.4248046875
[rfa agg] iter:  3, weight: tensor([0.0344, 0.0345, 0.0376, 0.0357, 0.1100, 0.1588, 0.1131, 0.1723, 0.0601,
        0.2434])
[rfa agg] iter:  4, prev_obj_val: 10228.6875, obj_val: 10067.634765625, abs dis: 161.052734375
[rfa agg] iter:  4, weight: tensor([0.0250, 0.0250, 0.0271, 0.0259, 0.1148, 0.1660, 0.1181, 0.1802, 0.0626,
        0.2553])
[rfa agg] iter:  5, prev_obj_val: 10067.634765625, obj_val: 9946.849609375, abs dis: 120.78515625
[rfa agg] iter:  5, weight: tensor([0.0179, 0.0179, 0.0192, 0.0186, 0.1182, 0.1713, 0.1216, 0.1862, 0.0642,
        0.2648])
[rfa agg] iter:  6, prev_obj_val: 9946.849609375, obj_val: 9857.64453125, abs dis: 89.205078125
[rfa agg] iter:  6, weight: tensor([0.0126, 0.0127, 0.0135, 0.0131, 0.1205, 0.1751, 0.1239, 0.1906, 0.0652,
        0.2728])
[rfa agg] iter:  7, prev_obj_val: 9857.64453125, obj_val: 9792.1279296875, abs dis: 65.5166015625
[rfa agg] iter:  7, weight: tensor([0.0088, 0.0088, 0.0094, 0.0092, 0.1217, 0.1776, 0.1252, 0.1938, 0.0654,
        0.2799])
[rfa agg] iter:  8, prev_obj_val: 9792.1279296875, obj_val: 9744.7734375, abs dis: 47.3544921875
[rfa agg] iter:  8, weight: tensor([0.0060, 0.0061, 0.0064, 0.0063, 0.1220, 0.1792, 0.1255, 0.1962, 0.0649,
        0.2874])
[rfa agg] iter:  9, prev_obj_val: 9744.7734375, obj_val: 9710.8466796875, abs dis: 33.9267578125
[rfa agg] iter:  9, weight: tensor([0.0041, 0.0041, 0.0043, 0.0042, 0.1212, 0.1798, 0.1246, 0.1978, 0.0636,
        0.2964])
___Test Target_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.0338, Accuracy: 6525/10000 (65.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.3753, Accuracy: 8126/9000 (90.2889%)
Done in 210.58454751968384 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:234 choose agents : [17, 33, 77, 11, 38, 29, 30, 96, 0, 3]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   1,  Average loss: 0.0010, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   2,  Average loss: 0.0010, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   3,  Average loss: 0.0009, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   4,  Average loss: 0.0007, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   5,  Average loss: 0.0011, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   6,  Average loss: 0.0015, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 43.06255669444744.
Norm before scaling: 42.681653092894464. Distance: 2.050376401631344
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.3290, Accuracy: 5911/10000 (59.1100%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.1011, Accuracy: 8725/9000 (96.9444%)
Scaling by  100
Scaled Norm after poisoning: 200.52023160082874, distance: 205.0376394561496
Total norm for 4 adversaries is: 200.52023160082874. distance: 205.0376394561496
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   1,  Average loss: 0.0024, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   2,  Average loss: 0.0013, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   3,  Average loss: 0.0015, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   4,  Average loss: 0.0011, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   5,  Average loss: 0.0018, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   6,  Average loss: 0.0012, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Global model norm: 43.06255669444744.
Norm before scaling: 42.706486558140384. Distance: 2.3797524737018527
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.3430, Accuracy: 5920/10000 (59.2000%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.1573, Accuracy: 8508/9000 (94.5333%)
Scaling by  100
Scaled Norm after poisoning: 234.23560854938344, distance: 237.9752646022271
Total norm for 4 adversaries is: 234.23560854938344. distance: 237.9752646022271
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   1,  Average loss: 0.0013, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   2,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   3,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 43.06255669444744.
Norm before scaling: 42.729778660496244. Distance: 1.5544589080679965
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.1243, Accuracy: 6506/10000 (65.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.0888, Accuracy: 8774/9000 (97.4889%)
Scaling by  100
Scaled Norm after poisoning: 151.39741653798126, distance: 155.44588713801662
Total norm for 4 adversaries is: 151.39741653798126. distance: 155.44588713801662
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   2,  Average loss: 0.0003, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   3,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   4,  Average loss: 0.0001, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 43.06255669444744.
Norm before scaling: 42.64380112529912. Distance: 1.2515272347462214
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.2500, Accuracy: 6266/10000 (62.6600%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.0737, Accuracy: 8795/9000 (97.7222%)
Scaling by  100
Scaled Norm after poisoning: 117.3539484582858, distance: 125.1527192073748
Total norm for 4 adversaries is: 117.3539484582858. distance: 125.1527192073748
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 234, local model 38, internal_epoch   1,  Average loss: 0.0109, Accuracy: 591/756 (78.1746%)
___Train Local_ResNet_18,  epoch 234, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 679/756 (89.8148%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 2.5131, Accuracy: 4119/10000 (41.1900%)
___Train Local_ResNet_18,  epoch 234, local model 29, internal_epoch   1,  Average loss: 0.0129, Accuracy: 662/848 (78.0660%)
___Train Local_ResNet_18,  epoch 234, local model 29, internal_epoch   2,  Average loss: 0.0056, Accuracy: 757/848 (89.2689%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 3.6868, Accuracy: 3159/10000 (31.5900%)
___Train Local_ResNet_18,  epoch 234, local model 30, internal_epoch   1,  Average loss: 0.0225, Accuracy: 198/337 (58.7537%)
___Train Local_ResNet_18,  epoch 234, local model 30, internal_epoch   2,  Average loss: 0.0075, Accuracy: 286/337 (84.8665%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 5.0689, Accuracy: 2784/10000 (27.8400%)
___Train Local_ResNet_18,  epoch 234, local model 96, internal_epoch   1,  Average loss: 0.0214, Accuracy: 442/708 (62.4294%)
___Train Local_ResNet_18,  epoch 234, local model 96, internal_epoch   2,  Average loss: 0.0155, Accuracy: 482/708 (68.0791%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 5.6608, Accuracy: 2222/10000 (22.2200%)
___Train Local_ResNet_18,  epoch 234, local model 0, internal_epoch   1,  Average loss: 0.0203, Accuracy: 219/367 (59.6730%)
___Train Local_ResNet_18,  epoch 234, local model 0, internal_epoch   2,  Average loss: 0.0066, Accuracy: 315/367 (85.8311%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 4.9773, Accuracy: 2285/10000 (22.8500%)
___Train Local_ResNet_18,  epoch 234, local model 3, internal_epoch   1,  Average loss: 0.0187, Accuracy: 546/780 (70.0000%)
___Train Local_ResNet_18,  epoch 234, local model 3, internal_epoch   2,  Average loss: 0.0106, Accuracy: 605/780 (77.5641%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 5.9470, Accuracy: 2104/10000 (21.0400%)
time spent on training: 159.5255253314972
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.35562722797487695  data num: [526, 527, 496, 546, 756, 848, 337, 708, 367, 780]
[rfa agg] considering poison per batch poison_fraction: 0.02778337718553726
[rfa agg] init. name: [17, 33, 77, 11, 38, 29, 30, 96, 0, 3], weight: tensor([0.0893, 0.0895, 0.0842, 0.0927, 0.1283, 0.1439, 0.0572, 0.1202, 0.0623,
        0.1324])
[rfa agg] iter:  0, prev_obj_val: 10726.015625, obj_val: 9895.5458984375, abs dis: 830.4697265625
[rfa agg] iter:  0, weight: tensor([0.0560, 0.0561, 0.0637, 0.0582, 0.1526, 0.1716, 0.0676, 0.1429, 0.0736,
        0.1576])
[rfa agg] iter:  1, prev_obj_val: 9895.5458984375, obj_val: 9287.2490234375, abs dis: 608.296875
[rfa agg] iter:  1, weight: tensor([0.0346, 0.0347, 0.0382, 0.0360, 0.1707, 0.1921, 0.0754, 0.1599, 0.0821,
        0.1764])
[rfa agg] iter:  2, prev_obj_val: 9287.2490234375, obj_val: 8886.8955078125, abs dis: 400.353515625
[rfa agg] iter:  2, weight: tensor([0.0204, 0.0204, 0.0221, 0.0212, 0.1826, 0.2060, 0.0801, 0.1710, 0.0873,
        0.1889])
[rfa agg] iter:  3, prev_obj_val: 8886.8955078125, obj_val: 8641.5302734375, abs dis: 245.365234375
[rfa agg] iter:  3, weight: tensor([0.0116, 0.0116, 0.0124, 0.0120, 0.1900, 0.2152, 0.0824, 0.1780, 0.0898,
        0.1970])
[rfa agg] iter:  4, prev_obj_val: 8641.5302734375, obj_val: 8496.916015625, abs dis: 144.6142578125
[rfa agg] iter:  4, weight: tensor([0.0064, 0.0064, 0.0068, 0.0067, 0.1946, 0.2219, 0.0826, 0.1822, 0.0900,
        0.2024])
[rfa agg] iter:  5, prev_obj_val: 8496.916015625, obj_val: 8415.61328125, abs dis: 81.302734375
[rfa agg] iter:  5, weight: tensor([0.0034, 0.0034, 0.0037, 0.0036, 0.1974, 0.2284, 0.0806, 0.1849, 0.0878,
        0.2068])
[rfa agg] iter:  6, prev_obj_val: 8415.61328125, obj_val: 8367.9755859375, abs dis: 47.6376953125
[rfa agg] iter:  6, weight: tensor([0.0018, 0.0018, 0.0019, 0.0018, 0.1993, 0.2374, 0.0755, 0.1865, 0.0822,
        0.2117])
[rfa agg] iter:  7, prev_obj_val: 8367.9755859375, obj_val: 8343.8974609375, abs dis: 24.078125
[rfa agg] iter:  7, weight: tensor([0.0008, 0.0008, 0.0009, 0.0008, 0.1996, 0.2568, 0.0642, 0.1865, 0.0699,
        0.2197])
[rfa agg] iter:  8, prev_obj_val: 8343.8974609375, obj_val: 8336.43359375, abs dis: 7.4638671875
[rfa agg] iter:  8, weight: tensor([3.0016e-04, 3.0073e-04, 3.1869e-04, 3.1159e-04, 1.8985e-01, 3.1311e-01,
        4.2849e-02, 1.7547e-01, 4.6646e-02, 2.3085e-01])
[rfa agg] iter:  9, prev_obj_val: 8336.43359375, obj_val: 8341.4765625, abs dis: 5.04296875
[rfa agg] iter:  9, weight: tensor([8.9390e-05, 8.9558e-05, 9.4886e-05, 9.2794e-05, 2.3282e-01, 2.7133e-01,
        2.1763e-02, 1.7946e-01, 2.3673e-02, 2.7059e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.0147, Accuracy: 6548/10000 (65.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.4650, Accuracy: 7928/9000 (88.0889%)
Done in 203.8713457584381 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:235 choose agents : [17, 33, 77, 11, 8, 68, 79, 90, 21, 25]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   2,  Average loss: 0.0009, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   3,  Average loss: 0.0036, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   4,  Average loss: 0.0018, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   5,  Average loss: 0.0020, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   6,  Average loss: 0.0014, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Global model norm: 43.03158332069525.
Norm before scaling: 42.68685371948546. Distance: 2.6300141719247723
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.3364, Accuracy: 6037/10000 (60.3700%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.1633, Accuracy: 8487/9000 (94.3000%)
Scaling by  100
Scaled Norm after poisoning: 259.5665557713474, distance: 263.0014109990667
Total norm for 4 adversaries is: 259.5665557713474. distance: 263.0014109990667
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   1,  Average loss: 0.0020, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   2,  Average loss: 0.0009, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   3,  Average loss: 0.0010, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   4,  Average loss: 0.0006, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   5,  Average loss: 0.0005, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   6,  Average loss: 0.0007, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Global model norm: 43.03158332069525.
Norm before scaling: 42.66999549595711. Distance: 1.9685469023078148
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.3393, Accuracy: 6085/10000 (60.8500%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.1345, Accuracy: 8619/9000 (95.7667%)
Scaling by  100
Scaled Norm after poisoning: 192.65789993210763, distance: 196.85469141285407
Total norm for 4 adversaries is: 192.65789993210763. distance: 196.85469141285407
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   1,  Average loss: 0.0009, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   3,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   4,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   5,  Average loss: 0.0006, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 43.03158332069525.
Norm before scaling: 42.699304336491394. Distance: 1.4460852954025878
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.1249, Accuracy: 6460/10000 (64.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.0754, Accuracy: 8800/9000 (97.7778%)
Scaling by  100
Scaled Norm after poisoning: 140.3765096201106, distance: 144.60853001508937
Total norm for 4 adversaries is: 140.3765096201106. distance: 144.60853001508937
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   1,  Average loss: 0.0010, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   2,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   3,  Average loss: 0.0003, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   4,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 43.03158332069525.
Norm before scaling: 42.62564149077407. Distance: 1.3584989158168337
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.3268, Accuracy: 6142/10000 (61.4200%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.1084, Accuracy: 8725/9000 (96.9444%)
Scaling by  100
Scaled Norm after poisoning: 129.01606307452573, distance: 135.84989274701323
Total norm for 4 adversaries is: 129.01606307452573. distance: 135.84989274701323
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 235, local model 8, internal_epoch   1,  Average loss: 0.0141, Accuracy: 379/534 (70.9738%)
___Train Local_ResNet_18,  epoch 235, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 481/534 (90.0749%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 2.4933, Accuracy: 3858/10000 (38.5800%)
___Train Local_ResNet_18,  epoch 235, local model 68, internal_epoch   1,  Average loss: 0.0146, Accuracy: 300/416 (72.1154%)
___Train Local_ResNet_18,  epoch 235, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 385/416 (92.5481%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 3.3615, Accuracy: 3192/10000 (31.9200%)
___Train Local_ResNet_18,  epoch 235, local model 79, internal_epoch   1,  Average loss: 0.0229, Accuracy: 93/154 (60.3896%)
___Train Local_ResNet_18,  epoch 235, local model 79, internal_epoch   2,  Average loss: 0.0022, Accuracy: 151/154 (98.0519%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 3.0680, Accuracy: 3834/10000 (38.3400%)
___Train Local_ResNet_18,  epoch 235, local model 90, internal_epoch   1,  Average loss: 0.0230, Accuracy: 424/578 (73.3564%)
___Train Local_ResNet_18,  epoch 235, local model 90, internal_epoch   2,  Average loss: 0.0148, Accuracy: 417/578 (72.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 28.5791, Accuracy: 1136/10000 (11.3600%)
___Train Local_ResNet_18,  epoch 235, local model 21, internal_epoch   1,  Average loss: 0.0159, Accuracy: 192/262 (73.2824%)
___Train Local_ResNet_18,  epoch 235, local model 21, internal_epoch   2,  Average loss: 0.0123, Accuracy: 225/262 (85.8779%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 4.6599, Accuracy: 2926/10000 (29.2600%)
___Train Local_ResNet_18,  epoch 235, local model 25, internal_epoch   1,  Average loss: 0.0116, Accuracy: 430/545 (78.8991%)
___Train Local_ResNet_18,  epoch 235, local model 25, internal_epoch   2,  Average loss: 0.0033, Accuracy: 512/545 (93.9450%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 4.0628, Accuracy: 3723/10000 (37.2300%)
time spent on training: 161.19888544082642
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4570244328097731  data num: [526, 527, 496, 546, 534, 416, 154, 578, 262, 545]
[rfa agg] considering poison per batch poison_fraction: 0.03570503381326352
[rfa agg] init. name: [17, 33, 77, 11, 8, 68, 79, 90, 21, 25], weight: tensor([0.1147, 0.1150, 0.1082, 0.1191, 0.1165, 0.0908, 0.0336, 0.1261, 0.0572,
        0.1189])
[rfa agg] iter:  0, prev_obj_val: 11634.5634765625, obj_val: 11547.599609375, abs dis: 86.9638671875
[rfa agg] iter:  0, weight: tensor([0.0986, 0.0988, 0.1163, 0.1024, 0.1254, 0.0975, 0.0360, 0.1358, 0.0613,
        0.1279])
[rfa agg] iter:  1, prev_obj_val: 11547.599609375, obj_val: 11462.9580078125, abs dis: 84.6416015625
[rfa agg] iter:  1, weight: tensor([0.0890, 0.0892, 0.1032, 0.0924, 0.1344, 0.1045, 0.0386, 0.1457, 0.0657,
        0.1372])
[rfa agg] iter:  2, prev_obj_val: 11462.9580078125, obj_val: 11382.173828125, abs dis: 80.7841796875
[rfa agg] iter:  2, weight: tensor([0.0797, 0.0799, 0.0911, 0.0828, 0.1431, 0.1113, 0.0410, 0.1551, 0.0699,
        0.1461])
[rfa agg] iter:  3, prev_obj_val: 11382.173828125, obj_val: 11305.6259765625, abs dis: 76.5478515625
[rfa agg] iter:  3, weight: tensor([0.0708, 0.0710, 0.0800, 0.0735, 0.1513, 0.1176, 0.0433, 0.1640, 0.0739,
        0.1545])
[rfa agg] iter:  4, prev_obj_val: 11305.6259765625, obj_val: 11234.46875, abs dis: 71.1572265625
[rfa agg] iter:  4, weight: tensor([0.0625, 0.0626, 0.0698, 0.0649, 0.1590, 0.1235, 0.0455, 0.1723, 0.0776,
        0.1623])
[rfa agg] iter:  5, prev_obj_val: 11234.46875, obj_val: 11168.7001953125, abs dis: 65.7685546875
[rfa agg] iter:  5, weight: tensor([0.0548, 0.0549, 0.0607, 0.0568, 0.1660, 0.1290, 0.0475, 0.1800, 0.0810,
        0.1695])
[rfa agg] iter:  6, prev_obj_val: 11168.7001953125, obj_val: 11109.0888671875, abs dis: 59.611328125
[rfa agg] iter:  6, weight: tensor([0.0477, 0.0477, 0.0524, 0.0495, 0.1725, 0.1339, 0.0492, 0.1870, 0.0841,
        0.1760])
[rfa agg] iter:  7, prev_obj_val: 11109.0888671875, obj_val: 11055.2451171875, abs dis: 53.84375
[rfa agg] iter:  7, weight: tensor([0.0413, 0.0413, 0.0451, 0.0428, 0.1783, 0.1383, 0.0508, 0.1933, 0.0868,
        0.1819])
[rfa agg] iter:  8, prev_obj_val: 11055.2451171875, obj_val: 11007.173828125, abs dis: 48.0712890625
[rfa agg] iter:  8, weight: tensor([0.0355, 0.0356, 0.0386, 0.0369, 0.1835, 0.1423, 0.0522, 0.1990, 0.0892,
        0.1872])
[rfa agg] iter:  9, prev_obj_val: 11007.173828125, obj_val: 10965.2587890625, abs dis: 41.9150390625
[rfa agg] iter:  9, weight: tensor([0.0304, 0.0305, 0.0330, 0.0316, 0.1881, 0.1457, 0.0534, 0.2041, 0.0913,
        0.1919])
___Test Target_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.1422, Accuracy: 6519/10000 (65.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.0926, Accuracy: 8731/9000 (97.0111%)
Done in 201.73785305023193 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:236 choose agents : [17, 33, 77, 11, 53, 14, 6, 12, 7, 58]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   1,  Average loss: 0.0010, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   2,  Average loss: 0.0016, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   3,  Average loss: 0.0014, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   4,  Average loss: 0.0008, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   5,  Average loss: 0.0007, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   6,  Average loss: 0.0012, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 42.52903132989717.
Norm before scaling: 42.1487611491281. Distance: 2.0736886764206166
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.4227, Accuracy: 5855/10000 (58.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.0585, Accuracy: 8797/9000 (97.7444%)
Scaling by  100
Scaled Norm after poisoning: 202.88053558375185, distance: 207.36886858024278
Total norm for 4 adversaries is: 202.88053558375185. distance: 207.36886858024278
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   1,  Average loss: 0.0009, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   2,  Average loss: 0.0006, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   3,  Average loss: 0.0011, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   4,  Average loss: 0.0007, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   5,  Average loss: 0.0024, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   6,  Average loss: 0.0009, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Global model norm: 42.52903132989717.
Norm before scaling: 42.152104653953074. Distance: 2.242018955820958
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.2916, Accuracy: 6084/10000 (60.8400%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.1412, Accuracy: 8596/9000 (95.5111%)
Scaling by  100
Scaled Norm after poisoning: 219.95598814024137, distance: 224.20190921076028
Total norm for 4 adversaries is: 219.95598814024137. distance: 224.20190921076028
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   1,  Average loss: 0.0006, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   3,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   4,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 42.52903132989717.
Norm before scaling: 42.18096158823092. Distance: 1.288301231548559
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.1592, Accuracy: 6407/10000 (64.0700%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.0606, Accuracy: 8824/9000 (98.0444%)
Scaling by  100
Scaled Norm after poisoning: 123.65852442942419, distance: 128.83011766954962
Total norm for 4 adversaries is: 123.65852442942419. distance: 128.83011766954962
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   2,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   3,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   4,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 42.52903132989717.
Norm before scaling: 42.10235765972985. Distance: 1.190653228425133
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.3135, Accuracy: 6263/10000 (62.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.0959, Accuracy: 8727/9000 (96.9667%)
Scaling by  100
Scaled Norm after poisoning: 110.60065056883707, distance: 119.06531328697288
Total norm for 4 adversaries is: 110.60065056883707. distance: 119.06531328697288
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 236, local model 53, internal_epoch   1,  Average loss: 0.0181, Accuracy: 422/625 (67.5200%)
___Train Local_ResNet_18,  epoch 236, local model 53, internal_epoch   2,  Average loss: 0.0068, Accuracy: 540/625 (86.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 3.4434, Accuracy: 3458/10000 (34.5800%)
___Train Local_ResNet_18,  epoch 236, local model 14, internal_epoch   1,  Average loss: 0.0199, Accuracy: 205/318 (64.4654%)
___Train Local_ResNet_18,  epoch 236, local model 14, internal_epoch   2,  Average loss: 0.0061, Accuracy: 281/318 (88.3648%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 8.1900, Accuracy: 2000/10000 (20.0000%)
___Train Local_ResNet_18,  epoch 236, local model 6, internal_epoch   1,  Average loss: 0.0161, Accuracy: 368/520 (70.7692%)
___Train Local_ResNet_18,  epoch 236, local model 6, internal_epoch   2,  Average loss: 0.0096, Accuracy: 449/520 (86.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 5.6241, Accuracy: 3149/10000 (31.4900%)
___Train Local_ResNet_18,  epoch 236, local model 12, internal_epoch   1,  Average loss: 0.0141, Accuracy: 738/977 (75.5374%)
___Train Local_ResNet_18,  epoch 236, local model 12, internal_epoch   2,  Average loss: 0.0079, Accuracy: 830/977 (84.9539%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 3.5872, Accuracy: 3902/10000 (39.0200%)
___Train Local_ResNet_18,  epoch 236, local model 7, internal_epoch   1,  Average loss: 0.0187, Accuracy: 233/352 (66.1932%)
___Train Local_ResNet_18,  epoch 236, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 309/352 (87.7841%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 6.0235, Accuracy: 2703/10000 (27.0300%)
___Train Local_ResNet_18,  epoch 236, local model 58, internal_epoch   1,  Average loss: 0.0263, Accuracy: 138/234 (58.9744%)
___Train Local_ResNet_18,  epoch 236, local model 58, internal_epoch   2,  Average loss: 0.0034, Accuracy: 217/234 (92.7350%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 12.3192, Accuracy: 1375/10000 (13.7500%)
time spent on training: 162.1154432296753
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4090997851982035  data num: [526, 527, 496, 546, 625, 318, 520, 977, 352, 234]
[rfa agg] considering poison per batch poison_fraction: 0.03196092071860965
[rfa agg] init. name: [17, 33, 77, 11, 53, 14, 6, 12, 7, 58], weight: tensor([0.1027, 0.1029, 0.0969, 0.1066, 0.1220, 0.0621, 0.1015, 0.1908, 0.0687,
        0.0457])
[rfa agg] iter:  0, prev_obj_val: 11320.048828125, obj_val: 10954.8828125, abs dis: 365.166015625
[rfa agg] iter:  0, weight: tensor([0.0773, 0.0775, 0.0895, 0.0803, 0.1395, 0.0706, 0.1159, 0.2192, 0.0783,
        0.0519])
[rfa agg] iter:  1, prev_obj_val: 10954.8828125, obj_val: 10633.6533203125, abs dis: 321.2294921875
[rfa agg] iter:  1, weight: tensor([0.0597, 0.0598, 0.0672, 0.0620, 0.1551, 0.0785, 0.1289, 0.2442, 0.0870,
        0.0577])
[rfa agg] iter:  2, prev_obj_val: 10633.6533203125, obj_val: 10366.1103515625, abs dis: 267.54296875
[rfa agg] iter:  2, weight: tensor([0.0448, 0.0448, 0.0495, 0.0465, 0.1681, 0.0849, 0.1397, 0.2653, 0.0941,
        0.0624])
[rfa agg] iter:  3, prev_obj_val: 10366.1103515625, obj_val: 10153.8701171875, abs dis: 212.240234375
[rfa agg] iter:  3, weight: tensor([0.0328, 0.0328, 0.0358, 0.0340, 0.1784, 0.0899, 0.1482, 0.2825, 0.0997,
        0.0660])
[rfa agg] iter:  4, prev_obj_val: 10153.8701171875, obj_val: 9991.2373046875, abs dis: 162.6328125
[rfa agg] iter:  4, weight: tensor([0.0236, 0.0236, 0.0255, 0.0245, 0.1863, 0.0935, 0.1546, 0.2963, 0.1037,
        0.0686])
[rfa agg] iter:  5, prev_obj_val: 9991.2373046875, obj_val: 9870.080078125, abs dis: 121.1572265625
[rfa agg] iter:  5, weight: tensor([0.0167, 0.0167, 0.0179, 0.0173, 0.1921, 0.0958, 0.1592, 0.3076, 0.1065,
        0.0702])
[rfa agg] iter:  6, prev_obj_val: 9870.080078125, obj_val: 9780.640625, abs dis: 89.439453125
[rfa agg] iter:  6, weight: tensor([0.0116, 0.0117, 0.0125, 0.0121, 0.1962, 0.0971, 0.1623, 0.3175, 0.1081,
        0.0711])
[rfa agg] iter:  7, prev_obj_val: 9780.640625, obj_val: 9716.4130859375, abs dis: 64.2275390625
[rfa agg] iter:  7, weight: tensor([0.0080, 0.0080, 0.0085, 0.0083, 0.1990, 0.0973, 0.1642, 0.3272, 0.1085,
        0.0710])
[rfa agg] iter:  8, prev_obj_val: 9716.4130859375, obj_val: 9670.896484375, abs dis: 45.5166015625
[rfa agg] iter:  8, weight: tensor([0.0053, 0.0054, 0.0057, 0.0055, 0.2007, 0.0963, 0.1650, 0.3383, 0.1078,
        0.0700])
[rfa agg] iter:  9, prev_obj_val: 9670.896484375, obj_val: 9639.21875, abs dis: 31.677734375
[rfa agg] iter:  9, weight: tensor([0.0035, 0.0035, 0.0037, 0.0036, 0.2011, 0.0937, 0.1643, 0.3532, 0.1055,
        0.0678])
___Test Target_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.0066, Accuracy: 6746/10000 (67.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.1694, Accuracy: 8560/9000 (95.1111%)
Done in 206.25957536697388 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:237 choose agents : [17, 33, 77, 11, 65, 0, 98, 20, 45, 82]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   2,  Average loss: 0.0015, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   3,  Average loss: 0.0016, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   4,  Average loss: 0.0016, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   5,  Average loss: 0.0016, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   6,  Average loss: 0.0015, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Global model norm: 42.44654410485396.
Norm before scaling: 42.13866531177527. Distance: 3.197000444771954
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.6179, Accuracy: 5268/10000 (52.6800%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.0719, Accuracy: 8730/9000 (97.0000%)
Scaling by  100
Scaled Norm after poisoning: 316.83358950322804, distance: 319.700054738813
Total norm for 4 adversaries is: 316.83358950322804. distance: 319.700054738813
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   1,  Average loss: 0.0007, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   2,  Average loss: 0.0004, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   3,  Average loss: 0.0007, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   4,  Average loss: 0.0013, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   5,  Average loss: 0.0017, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   6,  Average loss: 0.0011, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Global model norm: 42.44654410485396.
Norm before scaling: 42.05115989872485. Distance: 1.7758863573230064
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.3765, Accuracy: 5899/10000 (58.9900%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.0797, Accuracy: 8711/9000 (96.7889%)
Scaling by  100
Scaled Norm after poisoning: 172.2878790897665, distance: 177.58861674351485
Total norm for 4 adversaries is: 172.2878790897665. distance: 177.58861674351485
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   1,  Average loss: 0.0005, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   2,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   3,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   4,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 42.44654410485396.
Norm before scaling: 42.08711581212013. Distance: 1.0173513558838287
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.0574, Accuracy: 6714/10000 (67.1400%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.1142, Accuracy: 8725/9000 (96.9444%)
Scaling by  100
Scaled Norm after poisoning: 94.92009900601927, distance: 101.73514172841162
Total norm for 4 adversaries is: 94.92009900601927. distance: 101.73514172841162
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   1,  Average loss: 0.0005, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   2,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   3,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   4,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 42.44654410485396.
Norm before scaling: 42.03004470855492. Distance: 1.2747107383366094
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.3634, Accuracy: 6095/10000 (60.9500%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.0817, Accuracy: 8767/9000 (97.4111%)
Scaling by  100
Scaled Norm after poisoning: 119.87326070818504, distance: 127.47106365882611
Total norm for 4 adversaries is: 119.87326070818504. distance: 127.47106365882611
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 237, local model 65, internal_epoch   1,  Average loss: 0.0228, Accuracy: 196/314 (62.4204%)
___Train Local_ResNet_18,  epoch 237, local model 65, internal_epoch   2,  Average loss: 0.0056, Accuracy: 277/314 (88.2166%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 10.9202, Accuracy: 1582/10000 (15.8200%)
___Train Local_ResNet_18,  epoch 237, local model 0, internal_epoch   1,  Average loss: 0.0182, Accuracy: 239/367 (65.1226%)
___Train Local_ResNet_18,  epoch 237, local model 0, internal_epoch   2,  Average loss: 0.0074, Accuracy: 315/367 (85.8311%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 4.2367, Accuracy: 2866/10000 (28.6600%)
___Train Local_ResNet_18,  epoch 237, local model 98, internal_epoch   1,  Average loss: 0.0168, Accuracy: 552/802 (68.8279%)
___Train Local_ResNet_18,  epoch 237, local model 98, internal_epoch   2,  Average loss: 0.0074, Accuracy: 687/802 (85.6608%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 2.2906, Accuracy: 4622/10000 (46.2200%)
___Train Local_ResNet_18,  epoch 237, local model 20, internal_epoch   1,  Average loss: 0.0189, Accuracy: 248/362 (68.5083%)
___Train Local_ResNet_18,  epoch 237, local model 20, internal_epoch   2,  Average loss: 0.0060, Accuracy: 319/362 (88.1215%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 3.8922, Accuracy: 4044/10000 (40.4400%)
___Train Local_ResNet_18,  epoch 237, local model 45, internal_epoch   1,  Average loss: 0.0184, Accuracy: 369/529 (69.7543%)
___Train Local_ResNet_18,  epoch 237, local model 45, internal_epoch   2,  Average loss: 0.0085, Accuracy: 442/529 (83.5539%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 4.7496, Accuracy: 2934/10000 (29.3400%)
___Train Local_ResNet_18,  epoch 237, local model 82, internal_epoch   1,  Average loss: 0.0128, Accuracy: 470/601 (78.2030%)
___Train Local_ResNet_18,  epoch 237, local model 82, internal_epoch   2,  Average loss: 0.0092, Accuracy: 499/601 (83.0283%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 4.8564, Accuracy: 3844/10000 (38.4400%)
time spent on training: 155.6782557964325
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41321499013806706  data num: [526, 527, 496, 546, 314, 367, 802, 362, 529, 601]
[rfa agg] considering poison per batch poison_fraction: 0.03228242110453649
[rfa agg] init. name: [17, 33, 77, 11, 65, 0, 98, 20, 45, 82], weight: tensor([0.1037, 0.1039, 0.0978, 0.1077, 0.0619, 0.0724, 0.1582, 0.0714, 0.1043,
        0.1185])
[rfa agg] iter:  0, prev_obj_val: 11360.4677734375, obj_val: 11025.009765625, abs dis: 335.4580078125
[rfa agg] iter:  0, weight: tensor([0.0791, 0.0793, 0.0917, 0.0821, 0.0702, 0.0821, 0.1807, 0.0810, 0.1187,
        0.1350])
[rfa agg] iter:  1, prev_obj_val: 11025.009765625, obj_val: 10726.8486328125, abs dis: 298.1611328125
[rfa agg] iter:  1, weight: tensor([0.0620, 0.0621, 0.0699, 0.0644, 0.0779, 0.0912, 0.2008, 0.0899, 0.1318,
        0.1500])
[rfa agg] iter:  2, prev_obj_val: 10726.8486328125, obj_val: 10475.287109375, abs dis: 251.5615234375
[rfa agg] iter:  2, weight: tensor([0.0473, 0.0474, 0.0524, 0.0491, 0.0843, 0.0987, 0.2180, 0.0974, 0.1429,
        0.1626])
[rfa agg] iter:  3, prev_obj_val: 10475.287109375, obj_val: 10271.0947265625, abs dis: 204.1923828125
[rfa agg] iter:  3, weight: tensor([0.0353, 0.0354, 0.0386, 0.0366, 0.0894, 0.1047, 0.2320, 0.1033, 0.1518,
        0.1728])
[rfa agg] iter:  4, prev_obj_val: 10271.0947265625, obj_val: 10111.162109375, abs dis: 159.9326171875
[rfa agg] iter:  4, weight: tensor([0.0258, 0.0259, 0.0280, 0.0268, 0.0933, 0.1093, 0.2433, 0.1078, 0.1588,
        0.1809])
[rfa agg] iter:  5, prev_obj_val: 10111.162109375, obj_val: 9990.0498046875, abs dis: 121.1123046875
[rfa agg] iter:  5, weight: tensor([0.0186, 0.0186, 0.0200, 0.0193, 0.0960, 0.1126, 0.2525, 0.1111, 0.1641,
        0.1871])
[rfa agg] iter:  6, prev_obj_val: 9990.0498046875, obj_val: 9900.7734375, abs dis: 89.2763671875
[rfa agg] iter:  6, weight: tensor([0.0132, 0.0133, 0.0142, 0.0137, 0.0977, 0.1148, 0.2600, 0.1132, 0.1680,
        0.1918])
[rfa agg] iter:  7, prev_obj_val: 9900.7734375, obj_val: 9834.791015625, abs dis: 65.982421875
[rfa agg] iter:  7, weight: tensor([0.0093, 0.0093, 0.0100, 0.0097, 0.0986, 0.1160, 0.2665, 0.1144, 0.1708,
        0.1954])
[rfa agg] iter:  8, prev_obj_val: 9834.791015625, obj_val: 9787.447265625, abs dis: 47.34375
[rfa agg] iter:  8, weight: tensor([0.0065, 0.0065, 0.0069, 0.0067, 0.0985, 0.1163, 0.2731, 0.1147, 0.1727,
        0.1983])
[rfa agg] iter:  9, prev_obj_val: 9787.447265625, obj_val: 9753.306640625, abs dis: 34.140625
[rfa agg] iter:  9, weight: tensor([0.0044, 0.0044, 0.0047, 0.0046, 0.0974, 0.1155, 0.2804, 0.1139, 0.1739,
        0.2006])
___Test Target_ResNet_18 poisoned: False, epoch: 237: Average loss: 0.9937, Accuracy: 6744/10000 (67.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.2248, Accuracy: 8452/9000 (93.9111%)
Done in 196.6887767314911 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:238 choose agents : [17, 33, 77, 11, 88, 46, 85, 42, 29, 8]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   1,  Average loss: 0.0019, Accuracy: 525/526 (99.8099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   2,  Average loss: 0.0008, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   3,  Average loss: 0.0007, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   4,  Average loss: 0.0005, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   5,  Average loss: 0.0010, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   6,  Average loss: 0.0016, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Global model norm: 42.34953114363768.
Norm before scaling: 41.97209766525703. Distance: 2.1164096656228204
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.4428, Accuracy: 5601/10000 (56.0100%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: 0.0346, Accuracy: 8881/9000 (98.6778%)
Scaling by  100
Scaled Norm after poisoning: 207.25560720701864, distance: 211.64095664887267
Total norm for 4 adversaries is: 207.25560720701864. distance: 211.64095664887267
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   1,  Average loss: 0.0018, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   2,  Average loss: 0.0019, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   3,  Average loss: 0.0014, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   4,  Average loss: 0.0020, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   5,  Average loss: 0.0011, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   6,  Average loss: 0.0028, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Global model norm: 42.34953114363768.
Norm before scaling: 42.03732385249669. Distance: 2.9377947720286035
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.3165, Accuracy: 5812/10000 (58.1200%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: 0.0749, Accuracy: 8772/9000 (97.4667%)
Scaling by  100
Scaled Norm after poisoning: 290.8645652404225, distance: 293.7794400141031
Total norm for 4 adversaries is: 290.8645652404225. distance: 293.7794400141031
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   1,  Average loss: 0.0005, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   3,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 42.34953114363768.
Norm before scaling: 41.99741609890274. Distance: 1.0702658872826396
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.0519, Accuracy: 6684/10000 (66.8400%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: 0.1109, Accuracy: 8734/9000 (97.0444%)
Scaling by  100
Scaled Norm after poisoning: 100.81485873713011, distance: 107.02658292744378
Total norm for 4 adversaries is: 100.81485873713011. distance: 107.02658292744378
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   1,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   2,  Average loss: 0.0008, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   3,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   4,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   6,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Global model norm: 42.34953114363768.
Norm before scaling: 41.93841251568706. Distance: 1.2559876087269957
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.2570, Accuracy: 6305/10000 (63.0500%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: 0.1344, Accuracy: 8702/9000 (96.6889%)
Scaling by  100
Scaled Norm after poisoning: 118.09119886765482, distance: 125.59875347709468
Total norm for 4 adversaries is: 118.09119886765482. distance: 125.59875347709468
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 238, local model 88, internal_epoch   1,  Average loss: 0.0180, Accuracy: 298/447 (66.6667%)
___Train Local_ResNet_18,  epoch 238, local model 88, internal_epoch   2,  Average loss: 0.0065, Accuracy: 387/447 (86.5772%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 4.8199, Accuracy: 2799/10000 (27.9900%)
___Train Local_ResNet_18,  epoch 238, local model 46, internal_epoch   1,  Average loss: 0.0144, Accuracy: 445/601 (74.0433%)
___Train Local_ResNet_18,  epoch 238, local model 46, internal_epoch   2,  Average loss: 0.0070, Accuracy: 521/601 (86.6889%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 3.3357, Accuracy: 4092/10000 (40.9200%)
___Train Local_ResNet_18,  epoch 238, local model 85, internal_epoch   1,  Average loss: 0.0235, Accuracy: 204/364 (56.0440%)
___Train Local_ResNet_18,  epoch 238, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 315/364 (86.5385%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 4.0368, Accuracy: 2653/10000 (26.5300%)
___Train Local_ResNet_18,  epoch 238, local model 42, internal_epoch   1,  Average loss: 0.0307, Accuracy: 131/198 (66.1616%)
___Train Local_ResNet_18,  epoch 238, local model 42, internal_epoch   2,  Average loss: 0.0080, Accuracy: 176/198 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 6.3401, Accuracy: 2549/10000 (25.4900%)
___Train Local_ResNet_18,  epoch 238, local model 29, internal_epoch   1,  Average loss: 0.0124, Accuracy: 665/848 (78.4198%)
___Train Local_ResNet_18,  epoch 238, local model 29, internal_epoch   2,  Average loss: 0.0077, Accuracy: 731/848 (86.2028%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 4.5841, Accuracy: 2406/10000 (24.0600%)
___Train Local_ResNet_18,  epoch 238, local model 8, internal_epoch   1,  Average loss: 0.0153, Accuracy: 363/534 (67.9775%)
___Train Local_ResNet_18,  epoch 238, local model 8, internal_epoch   2,  Average loss: 0.0065, Accuracy: 470/534 (88.0150%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 2.5619, Accuracy: 4100/10000 (41.0000%)
time spent on training: 163.0418746471405
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41183408688814627  data num: [526, 527, 496, 546, 447, 601, 364, 198, 848, 534]
[rfa agg] considering poison per batch poison_fraction: 0.03217453803813643
[rfa agg] init. name: [17, 33, 77, 11, 88, 46, 85, 42, 29, 8], weight: tensor([0.1034, 0.1036, 0.0975, 0.1073, 0.0879, 0.1181, 0.0716, 0.0389, 0.1667,
        0.1050])
[rfa agg] iter:  0, prev_obj_val: 11347.5537109375, obj_val: 11002.017578125, abs dis: 345.5361328125
[rfa agg] iter:  0, weight: tensor([0.0786, 0.0787, 0.0910, 0.0816, 0.0999, 0.1347, 0.0813, 0.0441, 0.1907,
        0.1195])
[rfa agg] iter:  1, prev_obj_val: 11002.017578125, obj_val: 10695.9501953125, abs dis: 306.0673828125
[rfa agg] iter:  1, weight: tensor([0.0612, 0.0613, 0.0690, 0.0636, 0.1109, 0.1497, 0.0902, 0.0490, 0.2122,
        0.1328])
[rfa agg] iter:  2, prev_obj_val: 10695.9501953125, obj_val: 10438.8046875, abs dis: 257.1455078125
[rfa agg] iter:  2, weight: tensor([0.0464, 0.0465, 0.0514, 0.0482, 0.1201, 0.1623, 0.0977, 0.0530, 0.2303,
        0.1440])
[rfa agg] iter:  3, prev_obj_val: 10438.8046875, obj_val: 10232.150390625, abs dis: 206.654296875
[rfa agg] iter:  3, weight: tensor([0.0344, 0.0345, 0.0376, 0.0358, 0.1275, 0.1724, 0.1036, 0.0561, 0.2452,
        0.1529])
[rfa agg] iter:  4, prev_obj_val: 10232.150390625, obj_val: 10071.2451171875, abs dis: 160.9052734375
[rfa agg] iter:  4, weight: tensor([0.0251, 0.0251, 0.0272, 0.0260, 0.1330, 0.1803, 0.1080, 0.0584, 0.2571,
        0.1597])
[rfa agg] iter:  5, prev_obj_val: 10071.2451171875, obj_val: 9948.994140625, abs dis: 122.2509765625
[rfa agg] iter:  5, weight: tensor([0.0180, 0.0180, 0.0193, 0.0186, 0.1370, 0.1863, 0.1111, 0.0600, 0.2668,
        0.1649])
[rfa agg] iter:  6, prev_obj_val: 9948.994140625, obj_val: 9859.8720703125, abs dis: 89.1220703125
[rfa agg] iter:  6, weight: tensor([0.0127, 0.0127, 0.0136, 0.0131, 0.1397, 0.1907, 0.1131, 0.0609, 0.2749,
        0.1686])
[rfa agg] iter:  7, prev_obj_val: 9859.8720703125, obj_val: 9794.41796875, abs dis: 65.4541015625
[rfa agg] iter:  7, weight: tensor([0.0088, 0.0088, 0.0094, 0.0092, 0.1411, 0.1940, 0.1141, 0.0612, 0.2822,
        0.1711])
[rfa agg] iter:  8, prev_obj_val: 9794.41796875, obj_val: 9747.1064453125, abs dis: 47.3115234375
[rfa agg] iter:  8, weight: tensor([0.0061, 0.0061, 0.0065, 0.0063, 0.1415, 0.1964, 0.1140, 0.0607, 0.2898,
        0.1727])
[rfa agg] iter:  9, prev_obj_val: 9747.1064453125, obj_val: 9713.2138671875, abs dis: 33.892578125
[rfa agg] iter:  9, weight: tensor([0.0041, 0.0041, 0.0043, 0.0042, 0.1406, 0.1982, 0.1127, 0.0595, 0.2991,
        0.1733])
___Test Target_ResNet_18 poisoned: False, epoch: 238: Average loss: 0.9723, Accuracy: 6739/10000 (67.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 238: Average loss: 0.2568, Accuracy: 8377/9000 (93.0778%)
Done in 215.73366236686707 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:239 choose agents : [17, 33, 77, 11, 63, 48, 69, 96, 88, 20]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   2,  Average loss: 0.0006, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   3,  Average loss: 0.0009, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   4,  Average loss: 0.0007, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   5,  Average loss: 0.0015, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   6,  Average loss: 0.0011, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Global model norm: 42.26049818721083.
Norm before scaling: 42.0158182056733. Distance: 3.493385058401058
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.9739, Accuracy: 4975/10000 (49.7500%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: 0.1197, Accuracy: 8631/9000 (95.9000%)
Scaling by  100
Scaled Norm after poisoning: 347.18994711108786, distance: 349.33850435501665
Total norm for 4 adversaries is: 347.18994711108786. distance: 349.33850435501665
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   1,  Average loss: 0.0014, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   2,  Average loss: 0.0010, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   3,  Average loss: 0.0014, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   4,  Average loss: 0.0015, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   5,  Average loss: 0.0013, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   6,  Average loss: 0.0014, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Global model norm: 42.26049818721083.
Norm before scaling: 41.899034031041516. Distance: 2.1803693901120624
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.2146, Accuracy: 6170/10000 (61.7000%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: 0.1085, Accuracy: 8651/9000 (96.1222%)
Scaling by  100
Scaled Norm after poisoning: 214.0294043758941, distance: 218.03692706167917
Total norm for 4 adversaries is: 214.0294043758941. distance: 218.03692706167917
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   1,  Average loss: 0.0005, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   2,  Average loss: 0.0007, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   3,  Average loss: 0.0004, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   4,  Average loss: 0.0006, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 42.26049818721083.
Norm before scaling: 41.91488742780943. Distance: 1.1788816920933762
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.0481, Accuracy: 6732/10000 (67.3200%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: 0.0767, Accuracy: 8775/9000 (97.5000%)
Scaling by  100
Scaled Norm after poisoning: 112.40734900074372, distance: 117.888180267892
Total norm for 4 adversaries is: 112.40734900074372. distance: 117.888180267892
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   2,  Average loss: 0.0002, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   3,  Average loss: 0.0005, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   4,  Average loss: 0.0005, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   6,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Global model norm: 42.26049818721083.
Norm before scaling: 41.84396587883072. Distance: 1.1596721319826586
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.2407, Accuracy: 6337/10000 (63.3700%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: 0.0899, Accuracy: 8757/9000 (97.3000%)
Scaling by  100
Scaled Norm after poisoning: 107.68759068481381, distance: 115.96719633154886
Total norm for 4 adversaries is: 107.68759068481381. distance: 115.96719633154886
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 239, local model 63, internal_epoch   1,  Average loss: 0.0154, Accuracy: 535/752 (71.1436%)
___Train Local_ResNet_18,  epoch 239, local model 63, internal_epoch   2,  Average loss: 0.0070, Accuracy: 646/752 (85.9043%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 2.2820, Accuracy: 4310/10000 (43.1000%)
___Train Local_ResNet_18,  epoch 239, local model 48, internal_epoch   1,  Average loss: 0.0216, Accuracy: 224/378 (59.2593%)
___Train Local_ResNet_18,  epoch 239, local model 48, internal_epoch   2,  Average loss: 0.0072, Accuracy: 322/378 (85.1852%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 5.0922, Accuracy: 2286/10000 (22.8600%)
___Train Local_ResNet_18,  epoch 239, local model 69, internal_epoch   1,  Average loss: 0.0218, Accuracy: 137/216 (63.4259%)
___Train Local_ResNet_18,  epoch 239, local model 69, internal_epoch   2,  Average loss: 0.0024, Accuracy: 208/216 (96.2963%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 10.4970, Accuracy: 1581/10000 (15.8100%)
___Train Local_ResNet_18,  epoch 239, local model 96, internal_epoch   1,  Average loss: 0.0181, Accuracy: 479/708 (67.6554%)
___Train Local_ResNet_18,  epoch 239, local model 96, internal_epoch   2,  Average loss: 0.0190, Accuracy: 436/708 (61.5819%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 6.7194, Accuracy: 1854/10000 (18.5400%)
___Train Local_ResNet_18,  epoch 239, local model 88, internal_epoch   1,  Average loss: 0.0167, Accuracy: 295/447 (65.9955%)
___Train Local_ResNet_18,  epoch 239, local model 88, internal_epoch   2,  Average loss: 0.0055, Accuracy: 397/447 (88.8143%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 5.7274, Accuracy: 2805/10000 (28.0500%)
___Train Local_ResNet_18,  epoch 239, local model 20, internal_epoch   1,  Average loss: 0.0169, Accuracy: 254/362 (70.1657%)
___Train Local_ResNet_18,  epoch 239, local model 20, internal_epoch   2,  Average loss: 0.0045, Accuracy: 328/362 (90.6077%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 10.7823, Accuracy: 1639/10000 (16.3900%)
time spent on training: 155.40853476524353
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4225494150867285  data num: [526, 527, 496, 546, 752, 378, 216, 708, 447, 362]
[rfa agg] considering poison per batch poison_fraction: 0.033011673053650666
[rfa agg] init. name: [17, 33, 77, 11, 63, 48, 69, 96, 88, 20], weight: tensor([0.1061, 0.1063, 0.1000, 0.1101, 0.1517, 0.0762, 0.0436, 0.1428, 0.0902,
        0.0730])
[rfa agg] iter:  0, prev_obj_val: 11432.7216796875, obj_val: 11162.412109375, abs dis: 270.3095703125
[rfa agg] iter:  0, weight: tensor([0.0831, 0.0833, 0.0967, 0.0863, 0.1713, 0.0857, 0.0489, 0.1613, 0.1014,
        0.0820])
[rfa agg] iter:  1, prev_obj_val: 11162.412109375, obj_val: 10916.3828125, abs dis: 246.029296875
[rfa agg] iter:  1, weight: tensor([0.0673, 0.0675, 0.0764, 0.0699, 0.1894, 0.0946, 0.0539, 0.1783, 0.1120,
        0.0906])
[rfa agg] iter:  2, prev_obj_val: 10916.3828125, obj_val: 10701.5576171875, abs dis: 214.8251953125
[rfa agg] iter:  2, weight: tensor([0.0534, 0.0535, 0.0594, 0.0554, 0.2053, 0.1023, 0.0583, 0.1932, 0.1212,
        0.0980])
[rfa agg] iter:  3, prev_obj_val: 10701.5576171875, obj_val: 10520.00390625, abs dis: 181.5537109375
[rfa agg] iter:  3, weight: tensor([0.0415, 0.0416, 0.0456, 0.0431, 0.2187, 0.1088, 0.0619, 0.2059, 0.1289,
        0.1042])
[rfa agg] iter:  4, prev_obj_val: 10520.00390625, obj_val: 10373.1015625, abs dis: 146.90234375
[rfa agg] iter:  4, weight: tensor([0.0317, 0.0317, 0.0345, 0.0329, 0.2298, 0.1140, 0.0648, 0.2164, 0.1351,
        0.1092])
[rfa agg] iter:  5, prev_obj_val: 10373.1015625, obj_val: 10256.0, abs dis: 117.1015625
[rfa agg] iter:  5, weight: tensor([0.0239, 0.0239, 0.0258, 0.0248, 0.2388, 0.1179, 0.0670, 0.2249, 0.1399,
        0.1130])
[rfa agg] iter:  6, prev_obj_val: 10256.0, obj_val: 10164.537109375, abs dis: 91.462890625
[rfa agg] iter:  6, weight: tensor([0.0178, 0.0178, 0.0192, 0.0185, 0.2462, 0.1209, 0.0685, 0.2318, 0.1435,
        0.1158])
[rfa agg] iter:  7, prev_obj_val: 10164.537109375, obj_val: 10094.55859375, abs dis: 69.978515625
[rfa agg] iter:  7, weight: tensor([0.0131, 0.0131, 0.0141, 0.0136, 0.2523, 0.1229, 0.0695, 0.2376, 0.1461,
        0.1177])
[rfa agg] iter:  8, prev_obj_val: 10094.55859375, obj_val: 10041.908203125, abs dis: 52.650390625
[rfa agg] iter:  8, weight: tensor([0.0096, 0.0096, 0.0102, 0.0099, 0.2577, 0.1240, 0.0699, 0.2426, 0.1477,
        0.1188])
[rfa agg] iter:  9, prev_obj_val: 10041.908203125, obj_val: 10002.423828125, abs dis: 39.484375
[rfa agg] iter:  9, weight: tensor([0.0069, 0.0069, 0.0074, 0.0072, 0.2626, 0.1244, 0.0697, 0.2473, 0.1485,
        0.1191])
___Test Target_ResNet_18 poisoned: False, epoch: 239: Average loss: 0.9500, Accuracy: 6811/10000 (68.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 239: Average loss: 0.2413, Accuracy: 8409/9000 (93.4333%)
Done in 196.88359093666077 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:240 choose agents : [17, 33, 77, 11, 71, 51, 95, 80, 24, 55]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   1,  Average loss: 0.0009, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   2,  Average loss: 0.0007, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   3,  Average loss: 0.0013, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   4,  Average loss: 0.0016, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   5,  Average loss: 0.0017, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   6,  Average loss: 0.0020, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 42.129927440393395.
Norm before scaling: 41.752798020948546. Distance: 2.0911562211921577
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.3691, Accuracy: 5888/10000 (58.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: 0.1890, Accuracy: 8365/9000 (92.9444%)
Scaling by  100
Scaled Norm after poisoning: 204.7034535767533, distance: 209.11562292186588
Total norm for 4 adversaries is: 204.7034535767533. distance: 209.11562292186588
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   1,  Average loss: 0.0009, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   2,  Average loss: 0.0005, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   3,  Average loss: 0.0006, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   4,  Average loss: 0.0008, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   5,  Average loss: 0.0008, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   6,  Average loss: 0.0007, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Global model norm: 42.129927440393395.
Norm before scaling: 41.77247097137884. Distance: 2.1134721313689573
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.5282, Accuracy: 5715/10000 (57.1500%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: 0.1203, Accuracy: 8655/9000 (96.1667%)
Scaling by  100
Scaled Norm after poisoning: 207.35656752017766, distance: 211.34723169171156
Total norm for 4 adversaries is: 207.35656752017766. distance: 211.34723169171156
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   1,  Average loss: 0.0009, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   2,  Average loss: 0.0005, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   3,  Average loss: 0.0009, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 42.129927440393395.
Norm before scaling: 41.791800217622686. Distance: 1.2767873129515495
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.0370, Accuracy: 6694/10000 (66.9400%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: 0.0924, Accuracy: 8747/9000 (97.1889%)
Scaling by  100
Scaled Norm after poisoning: 122.78501998538951, distance: 127.67872736628838
Total norm for 4 adversaries is: 122.78501998538951. distance: 127.67872736628838
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   2,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   3,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   4,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 42.129927440393395.
Norm before scaling: 41.72064895022757. Distance: 1.3118137200279112
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.2772, Accuracy: 6247/10000 (62.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: 0.0862, Accuracy: 8758/9000 (97.3111%)
Scaling by  100
Scaled Norm after poisoning: 124.01458063847775, distance: 131.1813585389517
Total norm for 4 adversaries is: 124.01458063847775. distance: 131.1813585389517
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 240, local model 71, internal_epoch   1,  Average loss: 0.0139, Accuracy: 857/1166 (73.4991%)
___Train Local_ResNet_18,  epoch 240, local model 71, internal_epoch   2,  Average loss: 0.0060, Accuracy: 1036/1166 (88.8508%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 3.1793, Accuracy: 3934/10000 (39.3400%)
___Train Local_ResNet_18,  epoch 240, local model 51, internal_epoch   1,  Average loss: 0.0162, Accuracy: 337/479 (70.3549%)
___Train Local_ResNet_18,  epoch 240, local model 51, internal_epoch   2,  Average loss: 0.0041, Accuracy: 440/479 (91.8580%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 10.1451, Accuracy: 1932/10000 (19.3200%)
___Train Local_ResNet_18,  epoch 240, local model 95, internal_epoch   1,  Average loss: 0.0155, Accuracy: 404/569 (71.0018%)
___Train Local_ResNet_18,  epoch 240, local model 95, internal_epoch   2,  Average loss: 0.0043, Accuracy: 520/569 (91.3884%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 10.1398, Accuracy: 1899/10000 (18.9900%)
___Train Local_ResNet_18,  epoch 240, local model 80, internal_epoch   1,  Average loss: 0.0135, Accuracy: 284/363 (78.2369%)
___Train Local_ResNet_18,  epoch 240, local model 80, internal_epoch   2,  Average loss: 0.0030, Accuracy: 342/363 (94.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 5.0133, Accuracy: 3224/10000 (32.2400%)
___Train Local_ResNet_18,  epoch 240, local model 24, internal_epoch   1,  Average loss: 0.0143, Accuracy: 221/320 (69.0625%)
___Train Local_ResNet_18,  epoch 240, local model 24, internal_epoch   2,  Average loss: 0.0030, Accuracy: 298/320 (93.1250%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 6.9958, Accuracy: 1644/10000 (16.4400%)
___Train Local_ResNet_18,  epoch 240, local model 55, internal_epoch   1,  Average loss: 0.0175, Accuracy: 207/299 (69.2308%)
___Train Local_ResNet_18,  epoch 240, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 274/299 (91.6388%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 6.4749, Accuracy: 2606/10000 (26.0600%)
time spent on training: 155.26393294334412
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.395955395955396  data num: [526, 527, 496, 546, 1166, 479, 569, 363, 320, 299]
[rfa agg] considering poison per batch poison_fraction: 0.03093401530901531
[rfa agg] init. name: [17, 33, 77, 11, 71, 51, 95, 80, 24, 55], weight: tensor([0.0994, 0.0996, 0.0937, 0.1032, 0.2204, 0.0905, 0.1075, 0.0686, 0.0605,
        0.0565])
[rfa agg] iter:  0, prev_obj_val: 11194.271484375, obj_val: 10725.125, abs dis: 469.146484375
[rfa agg] iter:  0, weight: tensor([0.0718, 0.0719, 0.0827, 0.0745, 0.2569, 0.1044, 0.1242, 0.0790, 0.0696,
        0.0650])
[rfa agg] iter:  1, prev_obj_val: 10725.125, obj_val: 10328.6103515625, abs dis: 396.5146484375
[rfa agg] iter:  1, weight: tensor([0.0526, 0.0527, 0.0589, 0.0546, 0.2878, 0.1166, 0.1386, 0.0881, 0.0776,
        0.0725])
[rfa agg] iter:  2, prev_obj_val: 10328.6103515625, obj_val: 10014.94140625, abs dis: 313.6689453125
[rfa agg] iter:  2, weight: tensor([0.0373, 0.0374, 0.0410, 0.0387, 0.3127, 0.1260, 0.1499, 0.0951, 0.0837,
        0.0782])
[rfa agg] iter:  3, prev_obj_val: 10014.94140625, obj_val: 9779.4638671875, abs dis: 235.4775390625
[rfa agg] iter:  3, weight: tensor([0.0257, 0.0257, 0.0279, 0.0267, 0.3324, 0.1328, 0.1582, 0.1002, 0.0881,
        0.0823])
[rfa agg] iter:  4, prev_obj_val: 9779.4638671875, obj_val: 9611.935546875, abs dis: 167.5283203125
[rfa agg] iter:  4, weight: tensor([0.0173, 0.0173, 0.0186, 0.0179, 0.3484, 0.1374, 0.1639, 0.1034, 0.0908,
        0.0849])
[rfa agg] iter:  5, prev_obj_val: 9611.935546875, obj_val: 9494.671875, abs dis: 117.263671875
[rfa agg] iter:  5, weight: tensor([0.0114, 0.0115, 0.0123, 0.0119, 0.3624, 0.1401, 0.1673, 0.1050, 0.0921,
        0.0861])
[rfa agg] iter:  6, prev_obj_val: 9494.671875, obj_val: 9416.501953125, abs dis: 78.169921875
[rfa agg] iter:  6, weight: tensor([0.0074, 0.0075, 0.0079, 0.0077, 0.3767, 0.1410, 0.1688, 0.1051, 0.0919,
        0.0859])
[rfa agg] iter:  7, prev_obj_val: 9416.501953125, obj_val: 9361.609375, abs dis: 54.892578125
[rfa agg] iter:  7, weight: tensor([0.0048, 0.0048, 0.0051, 0.0050, 0.3939, 0.1400, 0.1684, 0.1035, 0.0902,
        0.0843])
[rfa agg] iter:  8, prev_obj_val: 9361.609375, obj_val: 9325.3486328125, abs dis: 36.2607421875
[rfa agg] iter:  8, weight: tensor([0.0029, 0.0030, 0.0031, 0.0031, 0.4206, 0.1363, 0.1650, 0.0994, 0.0861,
        0.0804])
[rfa agg] iter:  9, prev_obj_val: 9325.3486328125, obj_val: 9303.0849609375, abs dis: 22.263671875
[rfa agg] iter:  9, weight: tensor([0.0017, 0.0017, 0.0018, 0.0018, 0.4682, 0.1273, 0.1560, 0.0909, 0.0779,
        0.0728])
___Test Target_ResNet_18 poisoned: False, epoch: 240: Average loss: 0.9237, Accuracy: 6909/10000 (69.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 240: Average loss: 0.3149, Accuracy: 8232/9000 (91.4667%)
Done in 197.29326629638672 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:241 choose agents : [17, 33, 77, 11, 13, 63, 61, 41, 90, 74]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   2,  Average loss: 0.0014, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   3,  Average loss: 0.0011, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   4,  Average loss: 0.0006, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   5,  Average loss: 0.0006, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   6,  Average loss: 0.0011, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Global model norm: 42.074434715639676.
Norm before scaling: 41.688822071895814. Distance: 1.6850299418248305
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.1858, Accuracy: 6251/10000 (62.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: 0.0376, Accuracy: 8870/9000 (98.5556%)
Scaling by  100
Scaled Norm after poisoning: 163.24701495165232, distance: 168.50297312844364
Total norm for 4 adversaries is: 163.24701495165232. distance: 168.50297312844364
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   1,  Average loss: 0.0022, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   2,  Average loss: 0.0012, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   3,  Average loss: 0.0015, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   4,  Average loss: 0.0008, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   5,  Average loss: 0.0005, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   6,  Average loss: 0.0005, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Global model norm: 42.074434715639676.
Norm before scaling: 41.707433507297296. Distance: 1.9277413628015765
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.3017, Accuracy: 6155/10000 (61.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: 0.1637, Accuracy: 8568/9000 (95.2000%)
Scaling by  100
Scaled Norm after poisoning: 188.3764930265982, distance: 192.77414529378675
Total norm for 4 adversaries is: 188.3764930265982. distance: 192.77414529378675
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   1,  Average loss: 0.0008, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   3,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   4,  Average loss: 0.0006, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Global model norm: 42.074434715639676.
Norm before scaling: 41.73562831560629. Distance: 1.12459291934356
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.0027, Accuracy: 6808/10000 (68.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: 0.1421, Accuracy: 8669/9000 (96.3222%)
Scaling by  100
Scaled Norm after poisoning: 107.0110473634031, distance: 112.45929819272394
Total norm for 4 adversaries is: 107.0110473634031. distance: 112.45929819272394
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   1,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   2,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   3,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   4,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 42.074434715639676.
Norm before scaling: 41.67405582266907. Distance: 1.3184814848686603
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.2032, Accuracy: 6421/10000 (64.2100%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: 0.0581, Accuracy: 8804/9000 (97.8222%)
Scaling by  100
Scaled Norm after poisoning: 125.00889030884963, distance: 131.84813855578318
Total norm for 4 adversaries is: 125.00889030884963. distance: 131.84813855578318
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 241, local model 13, internal_epoch   1,  Average loss: 0.0143, Accuracy: 460/620 (74.1935%)
___Train Local_ResNet_18,  epoch 241, local model 13, internal_epoch   2,  Average loss: 0.0074, Accuracy: 529/620 (85.3226%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 4.6211, Accuracy: 3766/10000 (37.6600%)
___Train Local_ResNet_18,  epoch 241, local model 63, internal_epoch   1,  Average loss: 0.0106, Accuracy: 595/752 (79.1223%)
___Train Local_ResNet_18,  epoch 241, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 665/752 (88.4309%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 2.3328, Accuracy: 4648/10000 (46.4800%)
___Train Local_ResNet_18,  epoch 241, local model 61, internal_epoch   1,  Average loss: 0.0159, Accuracy: 420/590 (71.1864%)
___Train Local_ResNet_18,  epoch 241, local model 61, internal_epoch   2,  Average loss: 0.0073, Accuracy: 527/590 (89.3220%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 3.8928, Accuracy: 2980/10000 (29.8000%)
___Train Local_ResNet_18,  epoch 241, local model 41, internal_epoch   1,  Average loss: 0.0179, Accuracy: 357/513 (69.5906%)
___Train Local_ResNet_18,  epoch 241, local model 41, internal_epoch   2,  Average loss: 0.0213, Accuracy: 448/513 (87.3294%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 8.0061, Accuracy: 2258/10000 (22.5800%)
___Train Local_ResNet_18,  epoch 241, local model 90, internal_epoch   1,  Average loss: 0.0174, Accuracy: 433/578 (74.9135%)
___Train Local_ResNet_18,  epoch 241, local model 90, internal_epoch   2,  Average loss: 0.0083, Accuracy: 501/578 (86.6782%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 4.2606, Accuracy: 2848/10000 (28.4800%)
___Train Local_ResNet_18,  epoch 241, local model 74, internal_epoch   1,  Average loss: 0.0128, Accuracy: 349/469 (74.4136%)
___Train Local_ResNet_18,  epoch 241, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 428/469 (91.2580%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 3.6133, Accuracy: 3149/10000 (31.4900%)
time spent on training: 156.91730785369873
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.372974897632188  data num: [526, 527, 496, 546, 620, 752, 590, 513, 578, 469]
[rfa agg] considering poison per batch poison_fraction: 0.029138663877514688
[rfa agg] init. name: [17, 33, 77, 11, 13, 63, 61, 41, 90, 74], weight: tensor([0.0936, 0.0938, 0.0883, 0.0972, 0.1104, 0.1339, 0.1050, 0.0913, 0.1029,
        0.0835])
[rfa agg] iter:  0, prev_obj_val: 10952.0224609375, obj_val: 10282.732421875, abs dis: 669.2900390625
[rfa agg] iter:  0, weight: tensor([0.0626, 0.0627, 0.0716, 0.0650, 0.1299, 0.1579, 0.1236, 0.1074, 0.1211,
        0.0981])
[rfa agg] iter:  1, prev_obj_val: 10282.732421875, obj_val: 9758.9072265625, abs dis: 523.8251953125
[rfa agg] iter:  1, weight: tensor([0.0418, 0.0418, 0.0463, 0.0434, 0.1455, 0.1770, 0.1385, 0.1202, 0.1357,
        0.1098])
[rfa agg] iter:  2, prev_obj_val: 9758.9072265625, obj_val: 9383.94140625, abs dis: 374.9658203125
[rfa agg] iter:  2, weight: tensor([0.0267, 0.0267, 0.0290, 0.0277, 0.1567, 0.1909, 0.1491, 0.1293, 0.1460,
        0.1180])
[rfa agg] iter:  3, prev_obj_val: 9383.94140625, obj_val: 9135.1064453125, abs dis: 248.8349609375
[rfa agg] iter:  3, weight: tensor([0.0165, 0.0165, 0.0177, 0.0171, 0.1641, 0.2004, 0.1562, 0.1353, 0.1530,
        0.1233])
[rfa agg] iter:  4, prev_obj_val: 9135.1064453125, obj_val: 8974.9052734375, abs dis: 160.201171875
[rfa agg] iter:  4, weight: tensor([0.0100, 0.0100, 0.0107, 0.0103, 0.1688, 0.2071, 0.1606, 0.1389, 0.1574,
        0.1262])
[rfa agg] iter:  5, prev_obj_val: 8974.9052734375, obj_val: 8877.2060546875, abs dis: 97.69921875
[rfa agg] iter:  5, weight: tensor([0.0059, 0.0059, 0.0063, 0.0061, 0.1717, 0.2124, 0.1634, 0.1407, 0.1601,
        0.1275])
[rfa agg] iter:  6, prev_obj_val: 8877.2060546875, obj_val: 8817.0185546875, abs dis: 60.1875
[rfa agg] iter:  6, weight: tensor([0.0034, 0.0034, 0.0037, 0.0036, 0.1734, 0.2174, 0.1650, 0.1412, 0.1617,
        0.1271])
[rfa agg] iter:  7, prev_obj_val: 8817.0185546875, obj_val: 8778.4599609375, abs dis: 38.55859375
[rfa agg] iter:  7, weight: tensor([0.0020, 0.0020, 0.0021, 0.0020, 0.1743, 0.2243, 0.1659, 0.1402, 0.1625,
        0.1248])
[rfa agg] iter:  8, prev_obj_val: 8778.4599609375, obj_val: 8757.0498046875, abs dis: 21.41015625
[rfa agg] iter:  8, weight: tensor([0.0010, 0.0010, 0.0011, 0.0010, 0.1743, 0.2378, 0.1659, 0.1367, 0.1624,
        0.1188])
[rfa agg] iter:  9, prev_obj_val: 8757.0498046875, obj_val: 8745.3056640625, abs dis: 11.744140625
[rfa agg] iter:  9, weight: tensor([0.0005, 0.0005, 0.0005, 0.0005, 0.1714, 0.2712, 0.1632, 0.1272, 0.1595,
        0.1054])
___Test Target_ResNet_18 poisoned: False, epoch: 241: Average loss: 0.8953, Accuracy: 6985/10000 (69.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 241: Average loss: 0.3476, Accuracy: 8153/9000 (90.5889%)
Done in 201.33982396125793 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:242 choose agents : [17, 33, 77, 11, 85, 14, 21, 78, 1, 2]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   2,  Average loss: 0.0012, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   3,  Average loss: 0.0015, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   4,  Average loss: 0.0026, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   5,  Average loss: 0.0013, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   6,  Average loss: 0.0022, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Global model norm: 42.04311519328997.
Norm before scaling: 41.72243956063242. Distance: 2.6624567556675096
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 1.3047, Accuracy: 6059/10000 (60.5900%)
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: 0.1990, Accuracy: 8443/9000 (93.8111%)
Scaling by  100
Scaled Norm after poisoning: 263.1718040320809, distance: 266.2456865847783
Total norm for 4 adversaries is: 263.1718040320809. distance: 266.2456865847783
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   1,  Average loss: 0.0019, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   2,  Average loss: 0.0005, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   3,  Average loss: 0.0013, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   4,  Average loss: 0.0013, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   5,  Average loss: 0.0006, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   6,  Average loss: 0.0015, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Global model norm: 42.04311519328997.
Norm before scaling: 41.71055338486742. Distance: 2.364781532439517
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 1.4521, Accuracy: 5752/10000 (57.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: 0.0797, Accuracy: 8748/9000 (97.2000%)
Scaling by  100
Scaled Norm after poisoning: 233.12024123829318, distance: 236.47817189172028
Total norm for 4 adversaries is: 233.12024123829318. distance: 236.47817189172028
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   3,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 42.04311519328997.
Norm before scaling: 41.708235449331525. Distance: 1.1623632842857075
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 1.0148, Accuracy: 6817/10000 (68.1700%)
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: 0.0826, Accuracy: 8766/9000 (97.4000%)
Scaling by  100
Scaled Norm after poisoning: 111.07984705550778, distance: 116.23632312018476
Total norm for 4 adversaries is: 111.07984705550778. distance: 116.23632312018476
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   2,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   3,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   4,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   5,  Average loss: 0.0003, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 42.04311519328997.
Norm before scaling: 41.6474255703834. Distance: 1.3485439749150425
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 1.2278, Accuracy: 6364/10000 (63.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: 0.0965, Accuracy: 8746/9000 (97.1778%)
Scaling by  100
Scaled Norm after poisoning: 128.29626510785496, distance: 134.85439920289957
Total norm for 4 adversaries is: 128.29626510785496. distance: 134.85439920289957
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 242, local model 85, internal_epoch   1,  Average loss: 0.0209, Accuracy: 213/364 (58.5165%)
___Train Local_ResNet_18,  epoch 242, local model 85, internal_epoch   2,  Average loss: 0.0053, Accuracy: 326/364 (89.5604%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 4.0485, Accuracy: 2705/10000 (27.0500%)
___Train Local_ResNet_18,  epoch 242, local model 14, internal_epoch   1,  Average loss: 0.0147, Accuracy: 218/318 (68.5535%)
___Train Local_ResNet_18,  epoch 242, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 288/318 (90.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 5.1723, Accuracy: 2624/10000 (26.2400%)
___Train Local_ResNet_18,  epoch 242, local model 21, internal_epoch   1,  Average loss: 0.0134, Accuracy: 197/262 (75.1908%)
___Train Local_ResNet_18,  epoch 242, local model 21, internal_epoch   2,  Average loss: 0.0057, Accuracy: 249/262 (95.0382%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 5.0026, Accuracy: 2944/10000 (29.4400%)
___Train Local_ResNet_18,  epoch 242, local model 78, internal_epoch   1,  Average loss: 0.0162, Accuracy: 182/255 (71.3725%)
___Train Local_ResNet_18,  epoch 242, local model 78, internal_epoch   2,  Average loss: 0.0014, Accuracy: 248/255 (97.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 6.4433, Accuracy: 2427/10000 (24.2700%)
___Train Local_ResNet_18,  epoch 242, local model 1, internal_epoch   1,  Average loss: 0.0157, Accuracy: 496/641 (77.3791%)
___Train Local_ResNet_18,  epoch 242, local model 1, internal_epoch   2,  Average loss: 0.0113, Accuracy: 542/641 (84.5554%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 3.0417, Accuracy: 3950/10000 (39.5000%)
___Train Local_ResNet_18,  epoch 242, local model 2, internal_epoch   1,  Average loss: 0.0150, Accuracy: 335/461 (72.6681%)
___Train Local_ResNet_18,  epoch 242, local model 2, internal_epoch   2,  Average loss: 0.0061, Accuracy: 405/461 (87.8525%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 2.4610, Accuracy: 4109/10000 (41.0900%)
time spent on training: 236.05446434020996
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4765696087352138  data num: [526, 527, 496, 546, 364, 318, 262, 255, 641, 461]
[rfa agg] considering poison per batch poison_fraction: 0.03723200068243858
[rfa agg] init. name: [17, 33, 77, 11, 85, 14, 21, 78, 1, 2], weight: tensor([0.1197, 0.1199, 0.1128, 0.1242, 0.0828, 0.0723, 0.0596, 0.0580, 0.1458,
        0.1049])
[rfa agg] iter:  0, prev_obj_val: 11699.1494140625, obj_val: 11672.482421875, abs dis: 26.6669921875
[rfa agg] iter:  0, weight: tensor([0.1075, 0.1077, 0.1279, 0.1116, 0.0862, 0.0752, 0.0620, 0.0603, 0.1524,
        0.1093])
[rfa agg] iter:  1, prev_obj_val: 11672.482421875, obj_val: 11646.240234375, abs dis: 26.2421875
[rfa agg] iter:  1, weight: tensor([0.1020, 0.1022, 0.1201, 0.1059, 0.0900, 0.0786, 0.0647, 0.0630, 0.1592,
        0.1142])
[rfa agg] iter:  2, prev_obj_val: 11646.240234375, obj_val: 11620.2099609375, abs dis: 26.0302734375
[rfa agg] iter:  2, weight: tensor([0.0967, 0.0969, 0.1127, 0.1004, 0.0938, 0.0818, 0.0674, 0.0656, 0.1658,
        0.1190])
[rfa agg] iter:  3, prev_obj_val: 11620.2099609375, obj_val: 11594.603515625, abs dis: 25.6064453125
[rfa agg] iter:  3, weight: tensor([0.0913, 0.0915, 0.1055, 0.0948, 0.0975, 0.0851, 0.0701, 0.0681, 0.1724,
        0.1237])
[rfa agg] iter:  4, prev_obj_val: 11594.603515625, obj_val: 11569.4208984375, abs dis: 25.1826171875
[rfa agg] iter:  4, weight: tensor([0.0861, 0.0862, 0.0986, 0.0893, 0.1011, 0.0882, 0.0727, 0.0707, 0.1789,
        0.1283])
[rfa agg] iter:  5, prev_obj_val: 11569.4208984375, obj_val: 11545.078125, abs dis: 24.3427734375
[rfa agg] iter:  5, weight: tensor([0.0809, 0.0810, 0.0920, 0.0839, 0.1046, 0.0913, 0.0752, 0.0731, 0.1852,
        0.1328])
[rfa agg] iter:  6, prev_obj_val: 11545.078125, obj_val: 11521.5771484375, abs dis: 23.5009765625
[rfa agg] iter:  6, weight: tensor([0.0758, 0.0760, 0.0857, 0.0787, 0.1080, 0.0943, 0.0777, 0.0755, 0.1913,
        0.1371])
[rfa agg] iter:  7, prev_obj_val: 11521.5771484375, obj_val: 11498.5, abs dis: 23.0771484375
[rfa agg] iter:  7, weight: tensor([0.0710, 0.0711, 0.0797, 0.0737, 0.1113, 0.0971, 0.0800, 0.0778, 0.1971,
        0.1413])
[rfa agg] iter:  8, prev_obj_val: 11498.5, obj_val: 11476.4697265625, abs dis: 22.0302734375
[rfa agg] iter:  8, weight: tensor([0.0662, 0.0663, 0.0739, 0.0687, 0.1145, 0.0999, 0.0823, 0.0800, 0.2029,
        0.1453])
[rfa agg] iter:  9, prev_obj_val: 11476.4697265625, obj_val: 11455.28125, abs dis: 21.1884765625
[rfa agg] iter:  9, weight: tensor([0.0616, 0.0617, 0.0685, 0.0640, 0.1175, 0.1025, 0.0845, 0.0821, 0.2084,
        0.1492])
___Test Target_ResNet_18 poisoned: False, epoch: 242: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 300.73547315597534 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:243 choose agents : [17, 33, 77, 11, 9, 5, 16, 36, 94, 57]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   1,  Average loss: 0.0017, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   2,  Average loss: 0.0009, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   3,  Average loss: 0.0013, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   4,  Average loss: 0.0008, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   5,  Average loss: 0.0007, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   6,  Average loss: 0.0014, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 41.11422374958878.
Norm before scaling: 40.771775120595066. Distance: 2.722514910976747
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 1.5499, Accuracy: 5530/10000 (55.3000%)
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: 0.0340, Accuracy: 8885/9000 (98.7222%)
Scaling by  100
Scaled Norm after poisoning: 268.8231441161642, distance: 272.25152088647735
Total norm for 4 adversaries is: 268.8231441161642. distance: 272.25152088647735
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   1,  Average loss: 0.0019, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   2,  Average loss: 0.0020, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   3,  Average loss: 0.0013, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   4,  Average loss: 0.0012, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   5,  Average loss: 0.0007, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   6,  Average loss: 0.0015, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Global model norm: 41.11422374958878.
Norm before scaling: 40.764090319425904. Distance: 2.5297131052305892
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 1.5113, Accuracy: 5746/10000 (57.4600%)
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: 0.2174, Accuracy: 8351/9000 (92.7889%)
Scaling by  100
Scaled Norm after poisoning: 249.35541903074815, distance: 252.9713190882516
Total norm for 4 adversaries is: 249.35541903074815. distance: 252.9713190882516
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   1,  Average loss: 0.0019, Accuracy: 477/496 (96.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   2,  Average loss: 0.0007, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   3,  Average loss: 0.0008, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   4,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   5,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Global model norm: 41.11422374958878.
Norm before scaling: 40.909762191659404. Distance: 3.1931407608655733
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 1.2365, Accuracy: 6278/10000 (62.7800%)
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: 0.0837, Accuracy: 8771/9000 (97.4556%)
Scaling by  100
Scaled Norm after poisoning: 317.73441149803085, distance: 319.31407197694875
Total norm for 4 adversaries is: 317.73441149803085. distance: 319.31407197694875
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   1,  Average loss: 0.0011, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   2,  Average loss: 0.0007, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   3,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   4,  Average loss: 0.0008, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 41.11422374958878.
Norm before scaling: 40.75579156265324. Distance: 2.2870537077581736
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 1.5630, Accuracy: 5893/10000 (58.9300%)
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: 0.1096, Accuracy: 8698/9000 (96.6444%)
Scaling by  100
Scaled Norm after poisoning: 224.80880765663966, distance: 228.70535766570927
Total norm for 4 adversaries is: 224.80880765663966. distance: 228.70535766570927
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 243, local model 9, internal_epoch   1,  Average loss: 0.0268, Accuracy: 227/368 (61.6848%)
___Train Local_ResNet_18,  epoch 243, local model 9, internal_epoch   2,  Average loss: 0.0076, Accuracy: 301/368 (81.7935%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 25.3846, Accuracy: 1353/10000 (13.5300%)
___Train Local_ResNet_18,  epoch 243, local model 5, internal_epoch   1,  Average loss: 0.0246, Accuracy: 244/365 (66.8493%)
___Train Local_ResNet_18,  epoch 243, local model 5, internal_epoch   2,  Average loss: 0.0075, Accuracy: 303/365 (83.0137%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 10.8548, Accuracy: 2361/10000 (23.6100%)
___Train Local_ResNet_18,  epoch 243, local model 16, internal_epoch   1,  Average loss: 0.0273, Accuracy: 461/773 (59.6378%)
___Train Local_ResNet_18,  epoch 243, local model 16, internal_epoch   2,  Average loss: 0.0199, Accuracy: 493/773 (63.7775%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 4.3270, Accuracy: 2476/10000 (24.7600%)
___Train Local_ResNet_18,  epoch 243, local model 36, internal_epoch   1,  Average loss: 0.0275, Accuracy: 482/849 (56.7727%)
___Train Local_ResNet_18,  epoch 243, local model 36, internal_epoch   2,  Average loss: 0.0167, Accuracy: 536/849 (63.1331%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 2.0890, Accuracy: 4121/10000 (41.2100%)
___Train Local_ResNet_18,  epoch 243, local model 94, internal_epoch   1,  Average loss: 0.0360, Accuracy: 113/203 (55.6650%)
___Train Local_ResNet_18,  epoch 243, local model 94, internal_epoch   2,  Average loss: 0.0103, Accuracy: 173/203 (85.2217%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 8.7209, Accuracy: 2399/10000 (23.9900%)
___Train Local_ResNet_18,  epoch 243, local model 57, internal_epoch   1,  Average loss: 0.0251, Accuracy: 166/290 (57.2414%)
___Train Local_ResNet_18,  epoch 243, local model 57, internal_epoch   2,  Average loss: 0.0081, Accuracy: 251/290 (86.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 12.7753, Accuracy: 2462/10000 (24.6200%)
time spent on training: 233.19557785987854
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.42383168116528425  data num: [526, 527, 496, 546, 368, 365, 773, 849, 203, 290]
[rfa agg] considering poison per batch poison_fraction: 0.03311185009103783
[rfa agg] init. name: [17, 33, 77, 11, 9, 5, 16, 36, 94, 57], weight: tensor([0.1064, 0.1066, 0.1003, 0.1105, 0.0744, 0.0738, 0.1564, 0.1718, 0.0411,
        0.0587])
[rfa agg] iter:  0, prev_obj_val: 11438.5283203125, obj_val: 11176.044921875, abs dis: 262.4833984375
[rfa agg] iter:  0, weight: tensor([0.0837, 0.0839, 0.0974, 0.0869, 0.0835, 0.0828, 0.1764, 0.1939, 0.0460,
        0.0657])
[rfa agg] iter:  1, prev_obj_val: 11176.044921875, obj_val: 10937.458984375, abs dis: 238.5859375
[rfa agg] iter:  1, weight: tensor([0.0681, 0.0682, 0.0772, 0.0707, 0.0921, 0.0913, 0.1949, 0.2143, 0.0507,
        0.0725])
[rfa agg] iter:  2, prev_obj_val: 10937.458984375, obj_val: 10728.203125, abs dis: 209.255859375
[rfa agg] iter:  2, weight: tensor([0.0542, 0.0543, 0.0604, 0.0563, 0.0996, 0.0987, 0.2111, 0.2322, 0.0548,
        0.0783])
[rfa agg] iter:  3, prev_obj_val: 10728.203125, obj_val: 10549.630859375, abs dis: 178.572265625
[rfa agg] iter:  3, weight: tensor([0.0424, 0.0425, 0.0466, 0.0440, 0.1058, 0.1049, 0.2249, 0.2474, 0.0582,
        0.0832])
[rfa agg] iter:  4, prev_obj_val: 10549.630859375, obj_val: 10405.1435546875, abs dis: 144.4873046875
[rfa agg] iter:  4, weight: tensor([0.0325, 0.0326, 0.0354, 0.0338, 0.1109, 0.1100, 0.2365, 0.2603, 0.0609,
        0.0872])
[rfa agg] iter:  5, prev_obj_val: 10405.1435546875, obj_val: 10288.6103515625, abs dis: 116.533203125
[rfa agg] iter:  5, weight: tensor([0.0247, 0.0248, 0.0267, 0.0257, 0.1147, 0.1138, 0.2458, 0.2708, 0.0629,
        0.0901])
[rfa agg] iter:  6, prev_obj_val: 10288.6103515625, obj_val: 10197.294921875, abs dis: 91.3154296875
[rfa agg] iter:  6, weight: tensor([0.0185, 0.0186, 0.0199, 0.0192, 0.1175, 0.1166, 0.2535, 0.2795, 0.0644,
        0.0923])
[rfa agg] iter:  7, prev_obj_val: 10197.294921875, obj_val: 10127.109375, abs dis: 70.185546875
[rfa agg] iter:  7, weight: tensor([0.0137, 0.0137, 0.0147, 0.0142, 0.1194, 0.1184, 0.2599, 0.2869, 0.0652,
        0.0936])
[rfa agg] iter:  8, prev_obj_val: 10127.109375, obj_val: 10073.2900390625, abs dis: 53.8193359375
[rfa agg] iter:  8, weight: tensor([0.0101, 0.0101, 0.0108, 0.0105, 0.1204, 0.1194, 0.2654, 0.2936, 0.0655,
        0.0943])
[rfa agg] iter:  9, prev_obj_val: 10073.2900390625, obj_val: 10033.10546875, abs dis: 40.1845703125
[rfa agg] iter:  9, weight: tensor([0.0073, 0.0073, 0.0078, 0.0076, 0.1205, 0.1196, 0.2705, 0.3000, 0.0653,
        0.0941])
___Test Target_ResNet_18 poisoned: False, epoch: 243: Average loss: 1.2182, Accuracy: 6573/10000 (65.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 243: Average loss: 0.1175, Accuracy: 8673/9000 (96.3667%)
Done in 303.222843170166 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:244 choose agents : [17, 33, 77, 11, 63, 92, 28, 56, 44, 40]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   2,  Average loss: 0.0009, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   3,  Average loss: 0.0011, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   4,  Average loss: 0.0005, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   5,  Average loss: 0.0012, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   6,  Average loss: 0.0003, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Global model norm: 40.963669474265544.
Norm before scaling: 40.57592889706131. Distance: 1.6770708150771598
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.3359, Accuracy: 6053/10000 (60.5300%)
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: 0.0696, Accuracy: 8760/9000 (97.3333%)
Scaling by  100
Scaled Norm after poisoning: 162.36010203980226, distance: 167.70707232962778
Total norm for 4 adversaries is: 162.36010203980226. distance: 167.70707232962778
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   1,  Average loss: 0.0012, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   2,  Average loss: 0.0012, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   3,  Average loss: 0.0008, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   4,  Average loss: 0.0009, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   5,  Average loss: 0.0005, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   6,  Average loss: 0.0009, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Global model norm: 40.963669474265544.
Norm before scaling: 40.621907935212434. Distance: 2.3384208619676543
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.3749, Accuracy: 5935/10000 (59.3500%)
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: 0.0696, Accuracy: 8759/9000 (97.3222%)
Scaling by  100
Scaled Norm after poisoning: 230.27163816621012, distance: 233.84206074827514
Total norm for 4 adversaries is: 230.27163816621012. distance: 233.84206074827514
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   1,  Average loss: 0.0007, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   3,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   4,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 40.963669474265544.
Norm before scaling: 40.617711185073716. Distance: 1.0900227936277533
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.1426, Accuracy: 6581/10000 (65.8100%)
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: 0.0805, Accuracy: 8788/9000 (97.6444%)
Scaling by  100
Scaled Norm after poisoning: 103.04530538038838, distance: 109.00228907430109
Total norm for 4 adversaries is: 103.04530538038838. distance: 109.00228907430109
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   2,  Average loss: 0.0008, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   3,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   4,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 40.963669474265544.
Norm before scaling: 40.55581849824387. Distance: 1.3269089011750268
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.3579, Accuracy: 6191/10000 (61.9100%)
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: 0.0992, Accuracy: 8728/9000 (96.9778%)
Scaling by  100
Scaled Norm after poisoning: 125.6345573167968, distance: 132.69089285582112
Total norm for 4 adversaries is: 125.6345573167968. distance: 132.69089285582112
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 244, local model 63, internal_epoch   1,  Average loss: 0.0138, Accuracy: 544/752 (72.3404%)
___Train Local_ResNet_18,  epoch 244, local model 63, internal_epoch   2,  Average loss: 0.0070, Accuracy: 640/752 (85.1064%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 2.7998, Accuracy: 4069/10000 (40.6900%)
___Train Local_ResNet_18,  epoch 244, local model 92, internal_epoch   1,  Average loss: 0.0225, Accuracy: 511/796 (64.1960%)
___Train Local_ResNet_18,  epoch 244, local model 92, internal_epoch   2,  Average loss: 0.0123, Accuracy: 602/796 (75.6281%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 5.0949, Accuracy: 2465/10000 (24.6500%)
___Train Local_ResNet_18,  epoch 244, local model 28, internal_epoch   1,  Average loss: 0.0194, Accuracy: 279/423 (65.9574%)
___Train Local_ResNet_18,  epoch 244, local model 28, internal_epoch   2,  Average loss: 0.0085, Accuracy: 353/423 (83.4515%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 3.8927, Accuracy: 3620/10000 (36.2000%)
___Train Local_ResNet_18,  epoch 244, local model 56, internal_epoch   1,  Average loss: 0.0147, Accuracy: 564/743 (75.9085%)
___Train Local_ResNet_18,  epoch 244, local model 56, internal_epoch   2,  Average loss: 0.0081, Accuracy: 628/743 (84.5222%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 3.6423, Accuracy: 3459/10000 (34.5900%)
___Train Local_ResNet_18,  epoch 244, local model 44, internal_epoch   1,  Average loss: 0.0210, Accuracy: 275/436 (63.0734%)
___Train Local_ResNet_18,  epoch 244, local model 44, internal_epoch   2,  Average loss: 0.0080, Accuracy: 364/436 (83.4862%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 12.1029, Accuracy: 1228/10000 (12.2800%)
___Train Local_ResNet_18,  epoch 244, local model 40, internal_epoch   1,  Average loss: 0.0217, Accuracy: 427/652 (65.4908%)
___Train Local_ResNet_18,  epoch 244, local model 40, internal_epoch   2,  Average loss: 0.0119, Accuracy: 498/652 (76.3804%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 6.8945, Accuracy: 2562/10000 (25.6200%)
time spent on training: 243.01488065719604
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3552653891809395  data num: [526, 527, 496, 546, 752, 796, 423, 743, 436, 652]
[rfa agg] considering poison per batch poison_fraction: 0.027755108529760895
[rfa agg] init. name: [17, 33, 77, 11, 63, 92, 28, 56, 44, 40], weight: tensor([0.0892, 0.0894, 0.0841, 0.0926, 0.1275, 0.1350, 0.0717, 0.1260, 0.0739,
        0.1106])
[rfa agg] iter:  0, prev_obj_val: 10722.8505859375, obj_val: 9889.0634765625, abs dis: 833.787109375
[rfa agg] iter:  0, weight: tensor([0.0559, 0.0560, 0.0635, 0.0580, 0.1518, 0.1609, 0.0849, 0.1500, 0.0875,
        0.1315])
[rfa agg] iter:  1, prev_obj_val: 9889.0634765625, obj_val: 9280.572265625, abs dis: 608.4912109375
[rfa agg] iter:  1, weight: tensor([0.0345, 0.0346, 0.0380, 0.0358, 0.1698, 0.1801, 0.0947, 0.1678, 0.0977,
        0.1470])
[rfa agg] iter:  2, prev_obj_val: 9280.572265625, obj_val: 8879.23828125, abs dis: 401.333984375
[rfa agg] iter:  2, weight: tensor([0.0203, 0.0203, 0.0220, 0.0211, 0.1818, 0.1929, 0.1009, 0.1796, 0.1040,
        0.1572])
[rfa agg] iter:  3, prev_obj_val: 8879.23828125, obj_val: 8634.56640625, abs dis: 244.671875
[rfa agg] iter:  3, weight: tensor([0.0115, 0.0115, 0.0124, 0.0120, 0.1894, 0.2014, 0.1041, 0.1871, 0.1073,
        0.1634])
[rfa agg] iter:  4, prev_obj_val: 8634.56640625, obj_val: 8489.5986328125, abs dis: 144.9677734375
[rfa agg] iter:  4, weight: tensor([0.0064, 0.0064, 0.0068, 0.0066, 0.1943, 0.2074, 0.1049, 0.1920, 0.1082,
        0.1671])
[rfa agg] iter:  5, prev_obj_val: 8489.5986328125, obj_val: 8408.10546875, abs dis: 81.4931640625
[rfa agg] iter:  5, weight: tensor([0.0034, 0.0034, 0.0036, 0.0035, 0.1981, 0.2130, 0.1034, 0.1957, 0.1066,
        0.1691])
[rfa agg] iter:  6, prev_obj_val: 8408.10546875, obj_val: 8360.380859375, abs dis: 47.724609375
[rfa agg] iter:  6, weight: tensor([0.0018, 0.0018, 0.0019, 0.0018, 0.2021, 0.2205, 0.0987, 0.1997, 0.1018,
        0.1700])
[rfa agg] iter:  7, prev_obj_val: 8360.380859375, obj_val: 8337.56640625, abs dis: 22.814453125
[rfa agg] iter:  7, weight: tensor([0.0008, 0.0008, 0.0008, 0.0008, 0.2083, 0.2363, 0.0873, 0.2059, 0.0900,
        0.1690])
[rfa agg] iter:  8, prev_obj_val: 8337.56640625, obj_val: 8329.501953125, abs dis: 8.064453125
[rfa agg] iter:  8, weight: tensor([0.0003, 0.0003, 0.0003, 0.0003, 0.2173, 0.2742, 0.0652, 0.2148, 0.0672,
        0.1599])
[rfa agg] iter:  9, prev_obj_val: 8329.501953125, obj_val: 8337.8017578125, abs dis: 8.2998046875
[rfa agg] iter:  9, weight: tensor([8.8133e-05, 8.8298e-05, 9.3547e-05, 9.1486e-05, 2.7122e-01, 2.0945e-01,
        3.6927e-02, 2.7303e-01, 3.8202e-02, 1.7081e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.0768, Accuracy: 6726/10000 (67.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 244: Average loss: 0.1952, Accuracy: 8515/9000 (94.6111%)
Done in 307.7718360424042 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:245 choose agents : [17, 33, 77, 11, 74, 85, 2, 99, 35, 70]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   2,  Average loss: 0.0011, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   3,  Average loss: 0.0018, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   4,  Average loss: 0.0013, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   5,  Average loss: 0.0013, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   6,  Average loss: 0.0013, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Global model norm: 40.93546333197079.
Norm before scaling: 40.69110907092451. Distance: 3.4823169874312345
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 1.5046, Accuracy: 5540/10000 (55.4000%)
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: 0.0411, Accuracy: 8826/9000 (98.0667%)
Scaling by  100
Scaled Norm after poisoning: 346.0257283606235, distance: 348.2316824866744
Total norm for 4 adversaries is: 346.0257283606235. distance: 348.2316824866744
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   1,  Average loss: 0.0012, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   2,  Average loss: 0.0013, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   3,  Average loss: 0.0010, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   4,  Average loss: 0.0011, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   5,  Average loss: 0.0014, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   6,  Average loss: 0.0019, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Global model norm: 40.93546333197079.
Norm before scaling: 40.66613602422321. Distance: 3.10236369433749
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 1.7328, Accuracy: 5200/10000 (52.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: 0.1449, Accuracy: 8602/9000 (95.5778%)
Scaling by  100
Scaled Norm after poisoning: 307.8345740815999, distance: 310.2363262498446
Total norm for 4 adversaries is: 307.8345740815999. distance: 310.2363262498446
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   1,  Average loss: 0.0006, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   2,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   3,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   4,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 40.93546333197079.
Norm before scaling: 40.587720274848834. Distance: 1.0706967965641485
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 1.0696, Accuracy: 6735/10000 (67.3500%)
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: 0.0782, Accuracy: 8762/9000 (97.3556%)
Scaling by  100
Scaled Norm after poisoning: 100.94594585408073, distance: 107.06967832035828
Total norm for 4 adversaries is: 100.94594585408073. distance: 107.06967832035828
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   2,  Average loss: 0.0007, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   3,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   4,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 40.93546333197079.
Norm before scaling: 40.53048651218071. Distance: 1.350436761634573
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 1.2089, Accuracy: 6450/10000 (64.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: 0.0859, Accuracy: 8739/9000 (97.1000%)
Scaling by  100
Scaled Norm after poisoning: 128.1833403761971, distance: 135.04369229299456
Total norm for 4 adversaries is: 128.1833403761971. distance: 135.04369229299456
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 245, local model 74, internal_epoch   1,  Average loss: 0.0154, Accuracy: 343/469 (73.1343%)
___Train Local_ResNet_18,  epoch 245, local model 74, internal_epoch   2,  Average loss: 0.0067, Accuracy: 426/469 (90.8316%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 3.2424, Accuracy: 3447/10000 (34.4700%)
___Train Local_ResNet_18,  epoch 245, local model 85, internal_epoch   1,  Average loss: 0.0219, Accuracy: 204/364 (56.0440%)
___Train Local_ResNet_18,  epoch 245, local model 85, internal_epoch   2,  Average loss: 0.0070, Accuracy: 314/364 (86.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 5.7569, Accuracy: 1787/10000 (17.8700%)
___Train Local_ResNet_18,  epoch 245, local model 2, internal_epoch   1,  Average loss: 0.0191, Accuracy: 312/461 (67.6790%)
___Train Local_ResNet_18,  epoch 245, local model 2, internal_epoch   2,  Average loss: 0.0098, Accuracy: 380/461 (82.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 7.7888, Accuracy: 2543/10000 (25.4300%)
___Train Local_ResNet_18,  epoch 245, local model 99, internal_epoch   1,  Average loss: 0.0180, Accuracy: 280/391 (71.6113%)
___Train Local_ResNet_18,  epoch 245, local model 99, internal_epoch   2,  Average loss: 0.0109, Accuracy: 318/391 (81.3299%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 6.0337, Accuracy: 2595/10000 (25.9500%)
___Train Local_ResNet_18,  epoch 245, local model 35, internal_epoch   1,  Average loss: 0.0213, Accuracy: 282/419 (67.3031%)
___Train Local_ResNet_18,  epoch 245, local model 35, internal_epoch   2,  Average loss: 0.0101, Accuracy: 342/419 (81.6229%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 8.1093, Accuracy: 2644/10000 (26.4400%)
___Train Local_ResNet_18,  epoch 245, local model 70, internal_epoch   1,  Average loss: 0.0158, Accuracy: 435/610 (71.3115%)
___Train Local_ResNet_18,  epoch 245, local model 70, internal_epoch   2,  Average loss: 0.0059, Accuracy: 537/610 (88.0328%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 5.7930, Accuracy: 2709/10000 (27.0900%)
time spent on training: 239.41908812522888
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4356415055105011  data num: [526, 527, 496, 546, 469, 364, 461, 391, 419, 610]
[rfa agg] considering poison per batch poison_fraction: 0.0340344926180079
[rfa agg] init. name: [17, 33, 77, 11, 74, 85, 2, 99, 35, 70], weight: tensor([0.1094, 0.1096, 0.1031, 0.1135, 0.0975, 0.0757, 0.0959, 0.0813, 0.0871,
        0.1268])
[rfa agg] iter:  0, prev_obj_val: 11526.677734375, obj_val: 11336.591796875, abs dis: 190.0859375
[rfa agg] iter:  0, weight: tensor([0.0890, 0.0891, 0.1040, 0.0924, 0.1081, 0.0838, 0.1063, 0.0900, 0.0965,
        0.1409])
[rfa agg] iter:  1, prev_obj_val: 11336.591796875, obj_val: 11158.62109375, abs dis: 177.970703125
[rfa agg] iter:  1, weight: tensor([0.0753, 0.0755, 0.0861, 0.0782, 0.1184, 0.0917, 0.1164, 0.0986, 0.1057,
        0.1543])
[rfa agg] iter:  2, prev_obj_val: 11158.62109375, obj_val: 10997.3662109375, abs dis: 161.2548828125
[rfa agg] iter:  2, weight: tensor([0.0627, 0.0628, 0.0704, 0.0651, 0.1277, 0.0989, 0.1255, 0.1063, 0.1139,
        0.1665])
[rfa agg] iter:  3, prev_obj_val: 10997.3662109375, obj_val: 10854.548828125, abs dis: 142.8173828125
[rfa agg] iter:  3, weight: tensor([0.0515, 0.0516, 0.0571, 0.0535, 0.1359, 0.1052, 0.1336, 0.1131, 0.1212,
        0.1773])
[rfa agg] iter:  4, prev_obj_val: 10854.548828125, obj_val: 10730.166015625, abs dis: 124.3828125
[rfa agg] iter:  4, weight: tensor([0.0417, 0.0418, 0.0458, 0.0433, 0.1430, 0.1106, 0.1406, 0.1190, 0.1275,
        0.1867])
[rfa agg] iter:  5, prev_obj_val: 10730.166015625, obj_val: 10625.939453125, abs dis: 104.2265625
[rfa agg] iter:  5, weight: tensor([0.0334, 0.0334, 0.0363, 0.0346, 0.1490, 0.1152, 0.1465, 0.1240, 0.1329,
        0.1947])
[rfa agg] iter:  6, prev_obj_val: 10625.939453125, obj_val: 10539.568359375, abs dis: 86.37109375
[rfa agg] iter:  6, weight: tensor([0.0264, 0.0265, 0.0286, 0.0275, 0.1540, 0.1189, 0.1514, 0.1280, 0.1372,
        0.2014])
[rfa agg] iter:  7, prev_obj_val: 10539.568359375, obj_val: 10468.744140625, abs dis: 70.82421875
[rfa agg] iter:  7, weight: tensor([0.0208, 0.0208, 0.0224, 0.0216, 0.1581, 0.1218, 0.1554, 0.1313, 0.1407,
        0.2071])
[rfa agg] iter:  8, prev_obj_val: 10468.744140625, obj_val: 10411.7412109375, abs dis: 57.0029296875
[rfa agg] iter:  8, weight: tensor([0.0162, 0.0162, 0.0174, 0.0168, 0.1614, 0.1241, 0.1586, 0.1339, 0.1435,
        0.2118])
[rfa agg] iter:  9, prev_obj_val: 10411.7412109375, obj_val: 10366.2587890625, abs dis: 45.482421875
[rfa agg] iter:  9, weight: tensor([0.0125, 0.0125, 0.0134, 0.0130, 0.1640, 0.1258, 0.1612, 0.1359, 0.1457,
        0.2158])
___Test Target_ResNet_18 poisoned: False, epoch: 245: Average loss: 1.0253, Accuracy: 6763/10000 (67.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 245: Average loss: 0.1524, Accuracy: 8590/9000 (95.4444%)
Done in 306.260502576828 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:246 choose agents : [17, 33, 77, 11, 88, 50, 86, 60, 41, 79]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   2,  Average loss: 0.0007, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   3,  Average loss: 0.0010, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   4,  Average loss: 0.0009, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   5,  Average loss: 0.0005, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   6,  Average loss: 0.0002, Accuracy: 525/526 (99.8099%), train_poison_data_count: 45
Global model norm: 40.72029838047988.
Norm before scaling: 40.45769033238613. Distance: 3.1183012308833025
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.3892, Accuracy: 6052/10000 (60.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: 0.1282, Accuracy: 8671/9000 (96.3444%)
Scaling by  100
Scaled Norm after poisoning: 309.5028271276371, distance: 311.83009446251333
Total norm for 4 adversaries is: 309.5028271276371. distance: 311.83009446251333
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   1,  Average loss: 0.0008, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   2,  Average loss: 0.0017, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   3,  Average loss: 0.0008, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   4,  Average loss: 0.0013, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   5,  Average loss: 0.0008, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   6,  Average loss: 0.0005, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Global model norm: 40.72029838047988.
Norm before scaling: 40.36050769074502. Distance: 2.0157132388177192
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.2441, Accuracy: 6252/10000 (62.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: 0.1040, Accuracy: 8640/9000 (96.0000%)
Scaling by  100
Scaled Norm after poisoning: 197.397045950541, distance: 201.57129825758923
Total norm for 4 adversaries is: 197.397045950541. distance: 201.57129825758923
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   1,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   3,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   4,  Average loss: 0.0001, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   5,  Average loss: 0.0001, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 40.72029838047988.
Norm before scaling: 40.37813969264882. Distance: 0.980445344805148
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.0870, Accuracy: 6652/10000 (66.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: 0.0705, Accuracy: 8811/9000 (97.9000%)
Scaling by  100
Scaled Norm after poisoning: 91.65095982858008, distance: 98.04454304995765
Total norm for 4 adversaries is: 91.65095982858008. distance: 98.04454304995765
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   1,  Average loss: 0.0005, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   2,  Average loss: 0.0002, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   3,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   4,  Average loss: 0.0001, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   5,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 40.72029838047988.
Norm before scaling: 40.31197159295161. Distance: 0.924142312301397
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.1607, Accuracy: 6589/10000 (65.8900%)
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: 0.0858, Accuracy: 8765/9000 (97.3889%)
Scaling by  100
Scaled Norm after poisoning: 82.4884905560694, distance: 92.41422332019569
Total norm for 4 adversaries is: 82.4884905560694. distance: 92.41422332019569
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 246, local model 88, internal_epoch   1,  Average loss: 0.0177, Accuracy: 287/447 (64.2058%)
___Train Local_ResNet_18,  epoch 246, local model 88, internal_epoch   2,  Average loss: 0.0057, Accuracy: 398/447 (89.0380%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 5.8375, Accuracy: 2866/10000 (28.6600%)
___Train Local_ResNet_18,  epoch 246, local model 50, internal_epoch   1,  Average loss: 0.0133, Accuracy: 316/401 (78.8030%)
___Train Local_ResNet_18,  epoch 246, local model 50, internal_epoch   2,  Average loss: 0.0061, Accuracy: 357/401 (89.0274%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 7.1075, Accuracy: 2529/10000 (25.2900%)
___Train Local_ResNet_18,  epoch 246, local model 86, internal_epoch   1,  Average loss: 0.0191, Accuracy: 142/212 (66.9811%)
___Train Local_ResNet_18,  epoch 246, local model 86, internal_epoch   2,  Average loss: 0.0060, Accuracy: 196/212 (92.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 4.8716, Accuracy: 2937/10000 (29.3700%)
___Train Local_ResNet_18,  epoch 246, local model 60, internal_epoch   1,  Average loss: 0.0192, Accuracy: 176/284 (61.9718%)
___Train Local_ResNet_18,  epoch 246, local model 60, internal_epoch   2,  Average loss: 0.0056, Accuracy: 261/284 (91.9014%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 7.2202, Accuracy: 2159/10000 (21.5900%)
___Train Local_ResNet_18,  epoch 246, local model 41, internal_epoch   1,  Average loss: 0.0181, Accuracy: 354/513 (69.0058%)
___Train Local_ResNet_18,  epoch 246, local model 41, internal_epoch   2,  Average loss: 0.0071, Accuracy: 444/513 (86.5497%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 13.8039, Accuracy: 1916/10000 (19.1600%)
___Train Local_ResNet_18,  epoch 246, local model 79, internal_epoch   1,  Average loss: 0.0223, Accuracy: 99/154 (64.2857%)
___Train Local_ResNet_18,  epoch 246, local model 79, internal_epoch   2,  Average loss: 0.0025, Accuracy: 149/154 (96.7532%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 3.7736, Accuracy: 3781/10000 (37.8100%)
time spent on training: 231.97759914398193
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.5102289332683877  data num: [526, 527, 496, 546, 447, 401, 212, 284, 513, 154]
[rfa agg] considering poison per batch poison_fraction: 0.03986163541159279
[rfa agg] init. name: [17, 33, 77, 11, 88, 50, 86, 60, 41, 79], weight: tensor([0.1281, 0.1283, 0.1208, 0.1330, 0.1089, 0.0977, 0.0516, 0.0692, 0.1249,
        0.0375])
[rfa agg] iter:  0, prev_obj_val: 11724.5048828125, obj_val: 11720.04296875, abs dis: 4.4619140625
[rfa agg] iter:  0, weight: tensor([0.1229, 0.1231, 0.1488, 0.1276, 0.1062, 0.0953, 0.0502, 0.0674, 0.1221,
        0.0365])
[rfa agg] iter:  1, prev_obj_val: 11720.04296875, obj_val: 11715.6728515625, abs dis: 4.3701171875
[rfa agg] iter:  1, weight: tensor([0.1249, 0.1252, 0.1520, 0.1297, 0.1041, 0.0934, 0.0493, 0.0660, 0.1196,
        0.0358])
[rfa agg] iter:  2, prev_obj_val: 11715.6728515625, obj_val: 11711.212890625, abs dis: 4.4599609375
[rfa agg] iter:  2, weight: tensor([0.1269, 0.1272, 0.1553, 0.1318, 0.1020, 0.0915, 0.0483, 0.0647, 0.1173,
        0.0351])
[rfa agg] iter:  3, prev_obj_val: 11711.212890625, obj_val: 11706.755859375, abs dis: 4.45703125
[rfa agg] iter:  3, weight: tensor([0.1289, 0.1292, 0.1586, 0.1338, 0.0999, 0.0897, 0.0473, 0.0634, 0.1149,
        0.0343])
[rfa agg] iter:  4, prev_obj_val: 11706.755859375, obj_val: 11702.3896484375, abs dis: 4.3662109375
[rfa agg] iter:  4, weight: tensor([0.1309, 0.1312, 0.1620, 0.1359, 0.0978, 0.0878, 0.0463, 0.0621, 0.1124,
        0.0336])
[rfa agg] iter:  5, prev_obj_val: 11702.3896484375, obj_val: 11698.1142578125, abs dis: 4.275390625
[rfa agg] iter:  5, weight: tensor([0.1328, 0.1331, 0.1654, 0.1379, 0.0958, 0.0859, 0.0453, 0.0608, 0.1101,
        0.0329])
[rfa agg] iter:  6, prev_obj_val: 11698.1142578125, obj_val: 11693.7509765625, abs dis: 4.36328125
[rfa agg] iter:  6, weight: tensor([0.1347, 0.1350, 0.1688, 0.1398, 0.0938, 0.0841, 0.0444, 0.0595, 0.1078,
        0.0322])
[rfa agg] iter:  7, prev_obj_val: 11693.7509765625, obj_val: 11689.5693359375, abs dis: 4.181640625
[rfa agg] iter:  7, weight: tensor([0.1366, 0.1368, 0.1723, 0.1418, 0.0917, 0.0823, 0.0434, 0.0582, 0.1054,
        0.0315])
[rfa agg] iter:  8, prev_obj_val: 11689.5693359375, obj_val: 11685.298828125, abs dis: 4.2705078125
[rfa agg] iter:  8, weight: tensor([0.1383, 0.1386, 0.1757, 0.1437, 0.0897, 0.0805, 0.0425, 0.0569, 0.1031,
        0.0308])
[rfa agg] iter:  9, prev_obj_val: 11685.298828125, obj_val: 11681.12109375, abs dis: 4.177734375
[rfa agg] iter:  9, weight: tensor([0.1401, 0.1404, 0.1793, 0.1455, 0.0877, 0.0787, 0.0415, 0.0557, 0.1008,
        0.0301])
___Test Target_ResNet_18 poisoned: False, epoch: 246: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 296.961795091629 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:247 choose agents : [17, 33, 77, 11, 76, 67, 9, 40, 72, 44]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   1,  Average loss: 0.0064, Accuracy: 492/526 (93.5361%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 494/526 (93.9163%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   3,  Average loss: 0.0072, Accuracy: 482/526 (91.6350%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   4,  Average loss: 0.0032, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   5,  Average loss: 0.0029, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   6,  Average loss: 0.0024, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Global model norm: 38.76181932901644.
Norm before scaling: 39.487780262241415. Distance: 8.810206337979459
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 2.4066, Accuracy: 3895/10000 (38.9500%)
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: 0.1563, Accuracy: 8450/9000 (93.8889%)
Scaling by  100
Scaled Norm after poisoning: 880.6921283853967, distance: 881.0206793827259
Total norm for 4 adversaries is: 880.6921283853967. distance: 881.0206793827259
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   1,  Average loss: 0.0069, Accuracy: 477/527 (90.5123%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 492/527 (93.3586%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   3,  Average loss: 0.0022, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   4,  Average loss: 0.0020, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   5,  Average loss: 0.0027, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   6,  Average loss: 0.0016, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Global model norm: 38.76181932901644.
Norm before scaling: 39.388959269123724. Distance: 8.341764178041164
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 1.9420, Accuracy: 4864/10000 (48.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: 0.1273, Accuracy: 8554/9000 (95.0444%)
Scaling by  100
Scaled Norm after poisoning: 833.8437353605291, distance: 834.1763902197184
Total norm for 4 adversaries is: 833.8437353605291. distance: 834.1763902197184
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   1,  Average loss: 0.0107, Accuracy: 407/496 (82.0565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   2,  Average loss: 0.0026, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   3,  Average loss: 0.0022, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   4,  Average loss: 0.0012, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 38.76181932901644.
Norm before scaling: 39.177982421771354. Distance: 7.410306825450243
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 1.5149, Accuracy: 5663/10000 (56.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: 0.2244, Accuracy: 8433/9000 (93.7000%)
Scaling by  100
Scaled Norm after poisoning: 740.5276412801888, distance: 741.0306589473879
Total norm for 4 adversaries is: 740.5276412801888. distance: 741.0306589473879
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 482/546 (88.2784%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   2,  Average loss: 0.0032, Accuracy: 520/546 (95.2381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   3,  Average loss: 0.0017, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   4,  Average loss: 0.0013, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   6,  Average loss: 0.0015, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 38.76181932901644.
Norm before scaling: 39.26314562655656. Distance: 7.879501267349855
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 2.0021, Accuracy: 5009/10000 (50.0900%)
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: 0.2735, Accuracy: 8444/9000 (93.8222%)
Scaling by  100
Scaled Norm after poisoning: 787.4457124145131, distance: 787.9501094612526
Total norm for 4 adversaries is: 787.4457124145131. distance: 787.9501094612526
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 247, local model 76, internal_epoch   1,  Average loss: 0.1527, Accuracy: 20/65 (30.7692%)
___Train Local_ResNet_18,  epoch 247, local model 76, internal_epoch   2,  Average loss: 0.0512, Accuracy: 47/65 (72.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 247, local model 67, internal_epoch   1,  Average loss: 0.0310, Accuracy: 459/842 (54.5131%)
___Train Local_ResNet_18,  epoch 247, local model 67, internal_epoch   2,  Average loss: 0.0164, Accuracy: 536/842 (63.6580%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 6.2363, Accuracy: 2702/10000 (27.0200%)
___Train Local_ResNet_18,  epoch 247, local model 9, internal_epoch   1,  Average loss: 0.0400, Accuracy: 189/368 (51.3587%)
___Train Local_ResNet_18,  epoch 247, local model 9, internal_epoch   2,  Average loss: 0.0102, Accuracy: 292/368 (79.3478%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 33.2047, Accuracy: 2162/10000 (21.6200%)
___Train Local_ResNet_18,  epoch 247, local model 40, internal_epoch   1,  Average loss: 0.0281, Accuracy: 378/652 (57.9755%)
___Train Local_ResNet_18,  epoch 247, local model 40, internal_epoch   2,  Average loss: 0.0136, Accuracy: 467/652 (71.6258%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 7.2529, Accuracy: 2354/10000 (23.5400%)
___Train Local_ResNet_18,  epoch 247, local model 72, internal_epoch   1,  Average loss: 0.0290, Accuracy: 401/618 (64.8867%)
___Train Local_ResNet_18,  epoch 247, local model 72, internal_epoch   2,  Average loss: 0.0112, Accuracy: 480/618 (77.6699%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 9.4442, Accuracy: 1685/10000 (16.8500%)
___Train Local_ResNet_18,  epoch 247, local model 44, internal_epoch   1,  Average loss: 0.0358, Accuracy: 228/436 (52.2936%)
___Train Local_ResNet_18,  epoch 247, local model 44, internal_epoch   2,  Average loss: 0.0145, Accuracy: 313/436 (71.7890%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 98.4285, Accuracy: 1015/10000 (10.1500%)
time spent on training: 250.43158841133118
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41272655634357763  data num: [526, 527, 496, 546, 65, 842, 368, 652, 618, 436]
[rfa agg] considering poison per batch poison_fraction: 0.032244262214342005
[rfa agg] init. name: [17, 33, 77, 11, 76, 67, 9, 40, 72, 44], weight: tensor([0.1036, 0.1038, 0.0977, 0.1076, 0.0128, 0.1659, 0.0725, 0.1284, 0.1217,
        0.0859])
[rfa agg] iter:  0, prev_obj_val: 11364.5419921875, obj_val: 11023.69140625, abs dis: 340.8505859375
[rfa agg] iter:  0, weight: tensor([0.0788, 0.0790, 0.0913, 0.0819, 0.0145, 0.1896, 0.0823, 0.1464, 0.1386,
        0.0975])
[rfa agg] iter:  1, prev_obj_val: 11023.69140625, obj_val: 10721.4580078125, abs dis: 302.2333984375
[rfa agg] iter:  1, weight: tensor([0.0616, 0.0618, 0.0695, 0.0640, 0.0160, 0.2108, 0.0913, 0.1627, 0.1540,
        0.1083])
[rfa agg] iter:  2, prev_obj_val: 10721.4580078125, obj_val: 10467.1015625, abs dis: 254.3564453125
[rfa agg] iter:  2, weight: tensor([0.0469, 0.0470, 0.0519, 0.0487, 0.0173, 0.2288, 0.0988, 0.1764, 0.1669,
        0.1172])
[rfa agg] iter:  3, prev_obj_val: 10467.1015625, obj_val: 10262.1123046875, abs dis: 204.9892578125
[rfa agg] iter:  3, weight: tensor([0.0349, 0.0350, 0.0381, 0.0362, 0.0184, 0.2435, 0.1048, 0.1874, 0.1773,
        0.1244])
[rfa agg] iter:  4, prev_obj_val: 10262.1123046875, obj_val: 10101.7568359375, abs dis: 160.35546875
[rfa agg] iter:  4, weight: tensor([0.0255, 0.0256, 0.0276, 0.0265, 0.0191, 0.2553, 0.1092, 0.1961, 0.1854,
        0.1297])
[rfa agg] iter:  5, prev_obj_val: 10101.7568359375, obj_val: 9980.5302734375, abs dis: 121.2265625
[rfa agg] iter:  5, weight: tensor([0.0183, 0.0184, 0.0197, 0.0190, 0.0196, 0.2648, 0.1124, 0.2028, 0.1915,
        0.1336])
[rfa agg] iter:  6, prev_obj_val: 9980.5302734375, obj_val: 9890.6044921875, abs dis: 89.92578125
[rfa agg] iter:  6, weight: tensor([0.0130, 0.0130, 0.0139, 0.0135, 0.0198, 0.2726, 0.1143, 0.2078, 0.1959,
        0.1361])
[rfa agg] iter:  7, prev_obj_val: 9890.6044921875, obj_val: 9824.9365234375, abs dis: 65.66796875
[rfa agg] iter:  7, weight: tensor([0.0091, 0.0091, 0.0097, 0.0094, 0.0198, 0.2795, 0.1152, 0.2116, 0.1991,
        0.1375])
[rfa agg] iter:  8, prev_obj_val: 9824.9365234375, obj_val: 9778.8310546875, abs dis: 46.10546875
[rfa agg] iter:  8, weight: tensor([0.0063, 0.0063, 0.0067, 0.0065, 0.0195, 0.2863, 0.1150, 0.2146, 0.2013,
        0.1376])
[rfa agg] iter:  9, prev_obj_val: 9778.8310546875, obj_val: 9746.04296875, abs dis: 32.7880859375
[rfa agg] iter:  9, weight: tensor([0.0043, 0.0043, 0.0046, 0.0045, 0.0190, 0.2938, 0.1136, 0.2169, 0.2025,
        0.1366])
___Test Target_ResNet_18 poisoned: False, epoch: 247: Average loss: 2.0187, Accuracy: 5151/10000 (51.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 247: Average loss: 0.2761, Accuracy: 8464/9000 (94.0444%)
Done in 317.1756429672241 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:248 choose agents : [17, 33, 77, 11, 46, 96, 54, 39, 67, 82]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   1,  Average loss: 0.0023, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   2,  Average loss: 0.0020, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   3,  Average loss: 0.0014, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   4,  Average loss: 0.0020, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   5,  Average loss: 0.0007, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   6,  Average loss: 0.0014, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Global model norm: 38.67708456072132.
Norm before scaling: 38.46937036207751. Distance: 3.7219357989235378
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.6647, Accuracy: 5298/10000 (52.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: 0.1706, Accuracy: 8509/9000 (94.5444%)
Scaling by  100
Scaled Norm after poisoning: 370.1841602500031, distance: 372.19360301461387
Total norm for 4 adversaries is: 370.1841602500031. distance: 372.19360301461387
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   1,  Average loss: 0.0019, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   2,  Average loss: 0.0014, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   3,  Average loss: 0.0010, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   4,  Average loss: 0.0010, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   5,  Average loss: 0.0012, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   6,  Average loss: 0.0013, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Global model norm: 38.67708456072132.
Norm before scaling: 38.46528784684478. Distance: 3.648656017612962
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.8353, Accuracy: 5006/10000 (50.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: 0.1344, Accuracy: 8581/9000 (95.3444%)
Scaling by  100
Scaled Norm after poisoning: 362.8466876657413, distance: 364.86562166775866
Total norm for 4 adversaries is: 362.8466876657413. distance: 364.86562166775866
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   1,  Average loss: 0.0018, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   2,  Average loss: 0.0005, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   3,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   4,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 38.67708456072132.
Norm before scaling: 38.477048696166754. Distance: 3.013771871315741
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.3664, Accuracy: 5994/10000 (59.9400%)
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: 0.0650, Accuracy: 8832/9000 (98.1333%)
Scaling by  100
Scaled Norm after poisoning: 299.78745074635793, distance: 301.3772423184936
Total norm for 4 adversaries is: 299.78745074635793. distance: 301.3772423184936
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   2,  Average loss: 0.0005, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   3,  Average loss: 0.0007, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   4,  Average loss: 0.0008, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   6,  Average loss: 0.0002, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 38.67708456072132.
Norm before scaling: 38.469828884139844. Distance: 3.415330036127734
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.7626, Accuracy: 5377/10000 (53.7700%)
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: 0.1107, Accuracy: 8773/9000 (97.4778%)
Scaling by  100
Scaled Norm after poisoning: 339.66950849318226, distance: 341.53303280941947
Total norm for 4 adversaries is: 339.66950849318226. distance: 341.53303280941947
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 248, local model 46, internal_epoch   1,  Average loss: 0.0198, Accuracy: 402/601 (66.8885%)
___Train Local_ResNet_18,  epoch 248, local model 46, internal_epoch   2,  Average loss: 0.0106, Accuracy: 482/601 (80.1997%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 4.1410, Accuracy: 3007/10000 (30.0700%)
___Train Local_ResNet_18,  epoch 248, local model 96, internal_epoch   1,  Average loss: 0.0235, Accuracy: 418/708 (59.0395%)
___Train Local_ResNet_18,  epoch 248, local model 96, internal_epoch   2,  Average loss: 0.0149, Accuracy: 490/708 (69.2090%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 7.5478, Accuracy: 2232/10000 (22.3200%)
___Train Local_ResNet_18,  epoch 248, local model 54, internal_epoch   1,  Average loss: 0.0202, Accuracy: 285/440 (64.7727%)
___Train Local_ResNet_18,  epoch 248, local model 54, internal_epoch   2,  Average loss: 0.0083, Accuracy: 374/440 (85.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 13.4626, Accuracy: 2060/10000 (20.6000%)
___Train Local_ResNet_18,  epoch 248, local model 39, internal_epoch   1,  Average loss: 0.0292, Accuracy: 111/217 (51.1521%)
___Train Local_ResNet_18,  epoch 248, local model 39, internal_epoch   2,  Average loss: 0.0051, Accuracy: 201/217 (92.6267%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 19.7136, Accuracy: 1021/10000 (10.2100%)
___Train Local_ResNet_18,  epoch 248, local model 67, internal_epoch   1,  Average loss: 0.0197, Accuracy: 555/842 (65.9145%)
___Train Local_ResNet_18,  epoch 248, local model 67, internal_epoch   2,  Average loss: 0.0138, Accuracy: 556/842 (66.0333%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 3.2068, Accuracy: 3690/10000 (36.9000%)
___Train Local_ResNet_18,  epoch 248, local model 82, internal_epoch   1,  Average loss: 0.0155, Accuracy: 452/601 (75.2080%)
___Train Local_ResNet_18,  epoch 248, local model 82, internal_epoch   2,  Average loss: 0.0095, Accuracy: 513/601 (85.3577%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 6.1473, Accuracy: 2946/10000 (29.4600%)
time spent on training: 243.17824268341064
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.38063226744186046  data num: [526, 527, 496, 546, 601, 708, 440, 217, 842, 601]
[rfa agg] considering poison per batch poison_fraction: 0.02973689589389535
[rfa agg] init. name: [17, 33, 77, 11, 46, 96, 54, 39, 67, 82], weight: tensor([0.0956, 0.0957, 0.0901, 0.0992, 0.1092, 0.1286, 0.0799, 0.0394, 0.1530,
        0.1092])
[rfa agg] iter:  0, prev_obj_val: 11041.8828125, obj_val: 10442.6513671875, abs dis: 599.2314453125
[rfa agg] iter:  0, weight: tensor([0.0657, 0.0658, 0.0753, 0.0682, 0.1277, 0.1508, 0.0932, 0.0458, 0.1797,
        0.1277])
[rfa agg] iter:  1, prev_obj_val: 10442.6513671875, obj_val: 9958.8251953125, abs dis: 483.826171875
[rfa agg] iter:  1, weight: tensor([0.0453, 0.0454, 0.0504, 0.0471, 0.1430, 0.1689, 0.1042, 0.0512, 0.2014,
        0.1430])
[rfa agg] iter:  2, prev_obj_val: 9958.8251953125, obj_val: 9603.1875, abs dis: 355.6376953125
[rfa agg] iter:  2, weight: tensor([0.0300, 0.0300, 0.0327, 0.0311, 0.1542, 0.1825, 0.1122, 0.0550, 0.2179,
        0.1542])
[rfa agg] iter:  3, prev_obj_val: 9603.1875, obj_val: 9355.4296875, abs dis: 247.7578125
[rfa agg] iter:  3, weight: tensor([0.0193, 0.0193, 0.0208, 0.0200, 0.1619, 0.1920, 0.1175, 0.0574, 0.2297,
        0.1619])
[rfa agg] iter:  4, prev_obj_val: 9355.4296875, obj_val: 9188.8447265625, abs dis: 166.5849609375
[rfa agg] iter:  4, weight: tensor([0.0121, 0.0122, 0.0130, 0.0126, 0.1669, 0.1986, 0.1205, 0.0586, 0.2385,
        0.1669])
[rfa agg] iter:  5, prev_obj_val: 9188.8447265625, obj_val: 9081.0087890625, abs dis: 107.8359375
[rfa agg] iter:  5, weight: tensor([0.0075, 0.0075, 0.0080, 0.0077, 0.1700, 0.2034, 0.1216, 0.0586, 0.2458,
        0.1700])
[rfa agg] iter:  6, prev_obj_val: 9081.0087890625, obj_val: 9013.7744140625, abs dis: 67.234375
[rfa agg] iter:  6, weight: tensor([0.0045, 0.0045, 0.0048, 0.0047, 0.1714, 0.2073, 0.1209, 0.0575, 0.2531,
        0.1714])
[rfa agg] iter:  7, prev_obj_val: 9013.7744140625, obj_val: 8972.2080078125, abs dis: 41.56640625
[rfa agg] iter:  7, weight: tensor([0.0026, 0.0026, 0.0028, 0.0027, 0.1714, 0.2110, 0.1179, 0.0548, 0.2627,
        0.1714])
[rfa agg] iter:  8, prev_obj_val: 8972.2080078125, obj_val: 8946.75, abs dis: 25.4580078125
[rfa agg] iter:  8, weight: tensor([0.0015, 0.0015, 0.0016, 0.0016, 0.1693, 0.2153, 0.1116, 0.0500, 0.2783,
        0.1693])
[rfa agg] iter:  9, prev_obj_val: 8946.75, obj_val: 8932.21484375, abs dis: 14.53515625
[rfa agg] iter:  9, weight: tensor([0.0008, 0.0008, 0.0009, 0.0008, 0.1626, 0.2205, 0.0993, 0.0420, 0.3096,
        0.1627])
___Test Target_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.3317, Accuracy: 5968/10000 (59.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 248: Average loss: 0.3006, Accuracy: 8361/9000 (92.9000%)
Done in 309.5379271507263 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:249 choose agents : [17, 33, 77, 11, 21, 80, 91, 23, 65, 69]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   1,  Average loss: 0.0015, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   2,  Average loss: 0.0010, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   3,  Average loss: 0.0025, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   4,  Average loss: 0.0017, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   5,  Average loss: 0.0018, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   6,  Average loss: 0.0018, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Global model norm: 38.63865365978252.
Norm before scaling: 38.3885470159029. Distance: 3.431764846837449
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.8336, Accuracy: 4513/10000 (45.1300%)
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: 0.0204, Accuracy: 8937/9000 (99.3000%)
Scaling by  100
Scaled Norm after poisoning: 340.8208038141158, distance: 343.176521632818
Total norm for 4 adversaries is: 340.8208038141158. distance: 343.176521632818
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   1,  Average loss: 0.0022, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   2,  Average loss: 0.0006, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   3,  Average loss: 0.0010, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   4,  Average loss: 0.0011, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   5,  Average loss: 0.0008, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   6,  Average loss: 0.0014, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Global model norm: 38.63865365978252.
Norm before scaling: 38.38331896546581. Distance: 2.940431471323355
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.8478, Accuracy: 5118/10000 (51.1800%)
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: 0.0985, Accuracy: 8690/9000 (96.5556%)
Scaling by  100
Scaled Norm after poisoning: 291.7585822430936, distance: 294.0431383105207
Total norm for 4 adversaries is: 291.7585822430936. distance: 294.0431383105207
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   1,  Average loss: 0.0015, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   2,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   3,  Average loss: 0.0012, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   4,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   6,  Average loss: 0.0010, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 38.63865365978252.
Norm before scaling: 38.40054594287609. Distance: 2.5775468582644763
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.3046, Accuracy: 6054/10000 (60.5400%)
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: 0.1293, Accuracy: 8692/9000 (96.5778%)
Scaling by  100
Scaled Norm after poisoning: 255.7961682424113, distance: 257.75469806581606
Total norm for 4 adversaries is: 255.7961682424113. distance: 257.75469806581606
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   1,  Average loss: 0.0017, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   2,  Average loss: 0.0015, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   3,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   4,  Average loss: 0.0007, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   5,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 38.63865365978252.
Norm before scaling: 38.340572657678834. Distance: 2.555705856197242
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.6316, Accuracy: 5595/10000 (55.9500%)
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: 0.1066, Accuracy: 8734/9000 (97.0444%)
Scaling by  100
Scaled Norm after poisoning: 252.70835308463788, distance: 255.57058558987183
Total norm for 4 adversaries is: 252.70835308463788. distance: 255.57058558987183
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 249, local model 21, internal_epoch   1,  Average loss: 0.0195, Accuracy: 177/262 (67.5573%)
___Train Local_ResNet_18,  epoch 249, local model 21, internal_epoch   2,  Average loss: 0.0068, Accuracy: 229/262 (87.4046%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 12.0166, Accuracy: 2344/10000 (23.4400%)
___Train Local_ResNet_18,  epoch 249, local model 80, internal_epoch   1,  Average loss: 0.0165, Accuracy: 274/363 (75.4821%)
___Train Local_ResNet_18,  epoch 249, local model 80, internal_epoch   2,  Average loss: 0.0061, Accuracy: 324/363 (89.2562%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 4.8094, Accuracy: 2981/10000 (29.8100%)
___Train Local_ResNet_18,  epoch 249, local model 91, internal_epoch   1,  Average loss: 0.0246, Accuracy: 137/234 (58.5470%)
___Train Local_ResNet_18,  epoch 249, local model 91, internal_epoch   2,  Average loss: 0.0043, Accuracy: 216/234 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 14.1470, Accuracy: 1394/10000 (13.9400%)
___Train Local_ResNet_18,  epoch 249, local model 23, internal_epoch   1,  Average loss: 0.0255, Accuracy: 127/248 (51.2097%)
___Train Local_ResNet_18,  epoch 249, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 220/248 (88.7097%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 11.9303, Accuracy: 1537/10000 (15.3700%)
___Train Local_ResNet_18,  epoch 249, local model 65, internal_epoch   1,  Average loss: 0.0273, Accuracy: 182/314 (57.9618%)
___Train Local_ResNet_18,  epoch 249, local model 65, internal_epoch   2,  Average loss: 0.0065, Accuracy: 272/314 (86.6242%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 15.6278, Accuracy: 1390/10000 (13.9000%)
___Train Local_ResNet_18,  epoch 249, local model 69, internal_epoch   1,  Average loss: 0.0269, Accuracy: 130/216 (60.1852%)
___Train Local_ResNet_18,  epoch 249, local model 69, internal_epoch   2,  Average loss: 0.0056, Accuracy: 201/216 (93.0556%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 15.3611, Accuracy: 1241/10000 (12.4100%)
time spent on training: 246.04632353782654
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.5613612004287245  data num: [526, 527, 496, 546, 262, 363, 234, 248, 314, 216]
[rfa agg] considering poison per batch poison_fraction: 0.0438563437834941
[rfa agg] init. name: [17, 33, 77, 11, 21, 80, 91, 23, 65, 69], weight: tensor([0.1409, 0.1412, 0.1329, 0.1463, 0.0702, 0.0973, 0.0627, 0.0665, 0.0841,
        0.0579])
[rfa agg] iter:  0, prev_obj_val: 11564.658203125, obj_val: 11397.626953125, abs dis: 167.03125
[rfa agg] iter:  0, weight: tensor([0.1453, 0.1456, 0.1815, 0.1509, 0.0603, 0.0836, 0.0538, 0.0570, 0.0723,
        0.0497])
[rfa agg] iter:  1, prev_obj_val: 11397.626953125, obj_val: 11241.6875, abs dis: 155.939453125
[rfa agg] iter:  1, weight: tensor([0.1561, 0.1564, 0.2044, 0.1621, 0.0514, 0.0712, 0.0459, 0.0486, 0.0616,
        0.0423])
[rfa agg] iter:  2, prev_obj_val: 11241.6875, obj_val: 11098.5078125, abs dis: 143.1796875
[rfa agg] iter:  2, weight: tensor([0.1647, 0.1650, 0.2292, 0.1710, 0.0432, 0.0599, 0.0386, 0.0409, 0.0518,
        0.0356])
[rfa agg] iter:  3, prev_obj_val: 11098.5078125, obj_val: 10971.4287109375, abs dis: 127.0791015625
[rfa agg] iter:  3, weight: tensor([0.1706, 0.1710, 0.2575, 0.1772, 0.0358, 0.0497, 0.0320, 0.0339, 0.0429,
        0.0295])
[rfa agg] iter:  4, prev_obj_val: 10971.4287109375, obj_val: 10862.685546875, abs dis: 108.7431640625
[rfa agg] iter:  4, weight: tensor([0.1731, 0.1734, 0.2910, 0.1798, 0.0293, 0.0405, 0.0261, 0.0277, 0.0351,
        0.0241])
[rfa agg] iter:  5, prev_obj_val: 10862.685546875, obj_val: 10771.81640625, abs dis: 90.869140625
[rfa agg] iter:  5, weight: tensor([0.1712, 0.1716, 0.3323, 0.1779, 0.0235, 0.0326, 0.0210, 0.0223, 0.0282,
        0.0194])
[rfa agg] iter:  6, prev_obj_val: 10771.81640625, obj_val: 10698.3916015625, abs dis: 73.4248046875
[rfa agg] iter:  6, weight: tensor([0.1637, 0.1642, 0.3860, 0.1702, 0.0185, 0.0257, 0.0166, 0.0175, 0.0222,
        0.0153])
[rfa agg] iter:  7, prev_obj_val: 10698.3916015625, obj_val: 10643.0625, abs dis: 55.3291015625
[rfa agg] iter:  7, weight: tensor([0.1488, 0.1492, 0.4590, 0.1548, 0.0141, 0.0196, 0.0126, 0.0134, 0.0169,
        0.0116])
[rfa agg] iter:  8, prev_obj_val: 10643.0625, obj_val: 10605.3212890625, abs dis: 37.7412109375
[rfa agg] iter:  8, weight: tensor([0.1247, 0.1251, 0.5568, 0.1298, 0.0102, 0.0141, 0.0091, 0.0096, 0.0122,
        0.0084])
[rfa agg] iter:  9, prev_obj_val: 10605.3212890625, obj_val: 10583.2236328125, abs dis: 22.09765625
[rfa agg] iter:  9, weight: tensor([0.0922, 0.0925, 0.6776, 0.0960, 0.0067, 0.0093, 0.0060, 0.0063, 0.0080,
        0.0055])
___Test Target_ResNet_18 poisoned: False, epoch: 249: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 316.0713720321655 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:250 choose agents : [17, 33, 77, 11, 44, 38, 93, 2, 16, 36]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   1,  Average loss: 0.0767, Accuracy: 128/526 (24.3346%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   2,  Average loss: 0.0305, Accuracy: 262/526 (49.8099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   3,  Average loss: 0.0221, Accuracy: 306/526 (58.1749%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   4,  Average loss: 0.0157, Accuracy: 368/526 (69.9620%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   5,  Average loss: 0.0140, Accuracy: 395/526 (75.0951%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   6,  Average loss: 0.0104, Accuracy: 423/526 (80.4183%), train_poison_data_count: 45
Global model norm: 39.95520257601787.
Norm before scaling: 40.368375157920646. Distance: 10.896775116830545
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.6363, Accuracy: 2924/10000 (29.2400%)
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: 0.8462, Accuracy: 6260/9000 (69.5556%)
Scaling by  100
Scaled Norm after poisoning: 1086.4798088321752, distance: 1089.677417862736
Total norm for 4 adversaries is: 1086.4798088321752. distance: 1089.677417862736
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   1,  Average loss: 0.0762, Accuracy: 138/527 (26.1860%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   2,  Average loss: 0.0316, Accuracy: 205/527 (38.8994%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   3,  Average loss: 0.0220, Accuracy: 276/527 (52.3719%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   4,  Average loss: 0.0176, Accuracy: 336/527 (63.7571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   5,  Average loss: 0.0133, Accuracy: 369/527 (70.0190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   6,  Average loss: 0.0089, Accuracy: 449/527 (85.1992%), train_poison_data_count: 45
Global model norm: 39.95520257601787.
Norm before scaling: 40.49096126712649. Distance: 10.782300461166127
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.8161, Accuracy: 2905/10000 (29.0500%)
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: 0.6062, Accuracy: 7198/9000 (79.9778%)
Scaling by  100
Scaled Norm after poisoning: 1075.5743814353334, distance: 1078.2299151850684
Total norm for 4 adversaries is: 1075.5743814353334. distance: 1078.2299151850684
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   1,  Average loss: 0.0499, Accuracy: 173/496 (34.8790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   2,  Average loss: 0.0231, Accuracy: 258/496 (52.0161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   3,  Average loss: 0.0177, Accuracy: 305/496 (61.4919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   4,  Average loss: 0.0129, Accuracy: 366/496 (73.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   5,  Average loss: 0.0075, Accuracy: 431/496 (86.8952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   6,  Average loss: 0.0044, Accuracy: 467/496 (94.1532%), train_poison_data_count: 40
Global model norm: 39.95520257601787.
Norm before scaling: 40.62317754325648. Distance: 9.816338632626252
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.4949, Accuracy: 3177/10000 (31.7700%)
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: 0.3619, Accuracy: 7840/9000 (87.1111%)
Scaling by  100
Scaled Norm after poisoning: 980.279392571322, distance: 981.633873957088
Total norm for 4 adversaries is: 980.279392571322. distance: 981.633873957088
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   1,  Average loss: 0.0730, Accuracy: 143/546 (26.1905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   2,  Average loss: 0.0293, Accuracy: 239/546 (43.7729%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   3,  Average loss: 0.0237, Accuracy: 276/546 (50.5495%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   4,  Average loss: 0.0196, Accuracy: 321/546 (58.7912%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   5,  Average loss: 0.0162, Accuracy: 366/546 (67.0330%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   6,  Average loss: 0.0126, Accuracy: 406/546 (74.3590%), train_poison_data_count: 45
Global model norm: 39.95520257601787.
Norm before scaling: 40.37245269392779. Distance: 10.77482895859206
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.8275, Accuracy: 2283/10000 (22.8300%)
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: 0.2780, Accuracy: 8257/9000 (91.7444%)
Scaling by  100
Scaled Norm after poisoning: 1074.3872090638458, distance: 1077.4828304896557
Total norm for 4 adversaries is: 1074.3872090638458. distance: 1077.4828304896557
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 250, local model 44, internal_epoch   1,  Average loss: 0.0752, Accuracy: 115/436 (26.3761%)
___Train Local_ResNet_18,  epoch 250, local model 44, internal_epoch   2,  Average loss: 0.0302, Accuracy: 226/436 (51.8349%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 250, local model 38, internal_epoch   1,  Average loss: 0.0549, Accuracy: 294/756 (38.8889%)
___Train Local_ResNet_18,  epoch 250, local model 38, internal_epoch   2,  Average loss: 0.0222, Accuracy: 380/756 (50.2646%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 7.2757, Accuracy: 1274/10000 (12.7400%)
___Train Local_ResNet_18,  epoch 250, local model 93, internal_epoch   1,  Average loss: 0.0551, Accuracy: 225/584 (38.5274%)
___Train Local_ResNet_18,  epoch 250, local model 93, internal_epoch   2,  Average loss: 0.0255, Accuracy: 313/584 (53.5959%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 7.1026, Accuracy: 1985/10000 (19.8500%)
___Train Local_ResNet_18,  epoch 250, local model 2, internal_epoch   1,  Average loss: 0.0452, Accuracy: 197/461 (42.7332%)
___Train Local_ResNet_18,  epoch 250, local model 2, internal_epoch   2,  Average loss: 0.0291, Accuracy: 219/461 (47.5054%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 250, local model 16, internal_epoch   1,  Average loss: 0.0421, Accuracy: 344/773 (44.5019%)
___Train Local_ResNet_18,  epoch 250, local model 16, internal_epoch   2,  Average loss: 0.0246, Accuracy: 411/773 (53.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.8614, Accuracy: 2143/10000 (21.4300%)
___Train Local_ResNet_18,  epoch 250, local model 36, internal_epoch   1,  Average loss: 0.0459, Accuracy: 248/849 (29.2108%)
___Train Local_ResNet_18,  epoch 250, local model 36, internal_epoch   2,  Average loss: 0.0282, Accuracy: 328/849 (38.6337%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 3.8089, Accuracy: 1975/10000 (19.7500%)
time spent on training: 251.35083031654358
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.35186429291232785  data num: [526, 527, 496, 546, 436, 756, 584, 461, 773, 849]
[rfa agg] considering poison per batch poison_fraction: 0.027489397883775614
[rfa agg] init. name: [17, 33, 77, 11, 44, 38, 93, 2, 16, 36], weight: tensor([0.0883, 0.0885, 0.0833, 0.0917, 0.0732, 0.1270, 0.0981, 0.0774, 0.1298,
        0.1426])
[rfa agg] iter:  0, prev_obj_val: 10716.90625, obj_val: 9844.53125, abs dis: 872.375
[rfa agg] iter:  0, weight: tensor([0.0545, 0.0547, 0.0618, 0.0566, 0.0869, 0.1514, 0.1167, 0.0919, 0.1550,
        0.1704])
[rfa agg] iter:  1, prev_obj_val: 9844.53125, obj_val: 9216.2275390625, abs dis: 628.3037109375
[rfa agg] iter:  1, weight: tensor([0.0331, 0.0332, 0.0364, 0.0344, 0.0968, 0.1693, 0.1303, 0.1025, 0.1734,
        0.1907])
[rfa agg] iter:  2, prev_obj_val: 9216.2275390625, obj_val: 8811.673828125, abs dis: 404.5537109375
[rfa agg] iter:  2, weight: tensor([0.0191, 0.0191, 0.0206, 0.0198, 0.1028, 0.1808, 0.1389, 0.1090, 0.1854,
        0.2042])
[rfa agg] iter:  3, prev_obj_val: 8811.673828125, obj_val: 8566.8896484375, abs dis: 244.7841796875
[rfa agg] iter:  3, weight: tensor([0.0106, 0.0107, 0.0114, 0.0111, 0.1058, 0.1880, 0.1438, 0.1124, 0.1931,
        0.2132])
[rfa agg] iter:  4, prev_obj_val: 8566.8896484375, obj_val: 8428.576171875, abs dis: 138.3134765625
[rfa agg] iter:  4, weight: tensor([0.0057, 0.0057, 0.0061, 0.0060, 0.1062, 0.1924, 0.1460, 0.1132, 0.1985,
        0.2201])
[rfa agg] iter:  5, prev_obj_val: 8428.576171875, obj_val: 8350.244140625, abs dis: 78.33203125
[rfa agg] iter:  5, weight: tensor([0.0030, 0.0030, 0.0032, 0.0031, 0.1038, 0.1955, 0.1460, 0.1116, 0.2033,
        0.2273])
[rfa agg] iter:  6, prev_obj_val: 8350.244140625, obj_val: 8308.0478515625, abs dis: 42.1962890625
[rfa agg] iter:  6, weight: tensor([0.0015, 0.0015, 0.0016, 0.0016, 0.0975, 0.1983, 0.1432, 0.1062, 0.2098,
        0.2389])
[rfa agg] iter:  7, prev_obj_val: 8308.0478515625, obj_val: 8285.6904296875, abs dis: 22.357421875
[rfa agg] iter:  7, weight: tensor([0.0007, 0.0007, 0.0007, 0.0007, 0.0836, 0.2003, 0.1339, 0.0934, 0.2215,
        0.2644])
[rfa agg] iter:  8, prev_obj_val: 8285.6904296875, obj_val: 8285.353515625, abs dis: 0.3369140625
[rfa agg] iter:  8, weight: tensor([2.1349e-04, 2.1393e-04, 2.2655e-04, 2.2165e-04, 5.1676e-02, 1.8904e-01,
        9.9945e-02, 6.0360e-02, 2.4648e-01, 3.5162e-01])
[rfa agg] iter:  9, prev_obj_val: 8285.353515625, obj_val: 8291.0908203125, abs dis: 5.7373046875
[rfa agg] iter:  9, weight: tensor([1.2605e-04, 1.2631e-04, 1.3374e-04, 1.3087e-04, 5.2631e-02, 2.7135e-01,
        1.2545e-01, 6.3978e-02, 2.6611e-01, 2.1996e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 250: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 321.39873576164246 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:251 choose agents : [17, 33, 77, 11, 36, 26, 95, 49, 48, 27]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   1,  Average loss: 0.0528, Accuracy: 165/526 (31.3688%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   2,  Average loss: 0.0285, Accuracy: 254/526 (48.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   3,  Average loss: 0.0217, Accuracy: 328/526 (62.3574%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   4,  Average loss: 0.0177, Accuracy: 351/526 (66.7300%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   5,  Average loss: 0.0124, Accuracy: 404/526 (76.8061%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   6,  Average loss: 0.0083, Accuracy: 449/526 (85.3612%), train_poison_data_count: 45
Global model norm: 39.841522609309564.
Norm before scaling: 40.476284288997554. Distance: 10.245384107382822
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 2.2894, Accuracy: 3249/10000 (32.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: 0.4912, Accuracy: 7487/9000 (83.1889%)
Scaling by  100
Scaled Norm after poisoning: 1022.6767878953741, distance: 1024.5384326612643
Total norm for 4 adversaries is: 1022.6767878953741. distance: 1024.5384326612643
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   1,  Average loss: 0.0563, Accuracy: 146/527 (27.7040%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   2,  Average loss: 0.0261, Accuracy: 244/527 (46.2998%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   3,  Average loss: 0.0181, Accuracy: 327/527 (62.0493%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   4,  Average loss: 0.0125, Accuracy: 392/527 (74.3833%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   5,  Average loss: 0.0094, Accuracy: 436/527 (82.7324%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   6,  Average loss: 0.0058, Accuracy: 475/527 (90.1328%), train_poison_data_count: 45
Global model norm: 39.841522609309564.
Norm before scaling: 40.20690202817328. Distance: 8.886304935420203
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 2.9954, Accuracy: 2771/10000 (27.7100%)
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: 0.5009, Accuracy: 7677/9000 (85.3000%)
Scaling by  100
Scaled Norm after poisoning: 886.7240974508362, distance: 888.6305123615776
Total norm for 4 adversaries is: 886.7240974508362. distance: 888.6305123615776
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   1,  Average loss: 0.0366, Accuracy: 188/496 (37.9032%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   2,  Average loss: 0.0184, Accuracy: 313/496 (63.1048%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   3,  Average loss: 0.0117, Accuracy: 391/496 (78.8306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   4,  Average loss: 0.0052, Accuracy: 461/496 (92.9435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   5,  Average loss: 0.0030, Accuracy: 473/496 (95.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   6,  Average loss: 0.0016, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Global model norm: 39.841522609309564.
Norm before scaling: 40.10535746338169. Distance: 7.224414007056996
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 2.3725, Accuracy: 3589/10000 (35.8900%)
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: 0.2065, Accuracy: 8321/9000 (92.4556%)
Scaling by  100
Scaled Norm after poisoning: 721.386880425476, distance: 722.4413903563388
Total norm for 4 adversaries is: 721.386880425476. distance: 722.4413903563388
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   1,  Average loss: 0.0511, Accuracy: 179/546 (32.7839%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   2,  Average loss: 0.0245, Accuracy: 269/546 (49.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   3,  Average loss: 0.0182, Accuracy: 345/546 (63.1868%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   4,  Average loss: 0.0117, Accuracy: 416/546 (76.1905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   5,  Average loss: 0.0084, Accuracy: 467/546 (85.5311%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   6,  Average loss: 0.0040, Accuracy: 512/546 (93.7729%), train_poison_data_count: 45
Global model norm: 39.841522609309564.
Norm before scaling: 40.204293973483104. Distance: 8.860384229332622
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 2.5821, Accuracy: 3337/10000 (33.3700%)
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: 0.5346, Accuracy: 7770/9000 (86.3333%)
Scaling by  100
Scaled Norm after poisoning: 884.1406845067136, distance: 886.0385149642199
Total norm for 4 adversaries is: 884.1406845067136. distance: 886.0385149642199
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 251, local model 36, internal_epoch   1,  Average loss: 0.0376, Accuracy: 265/849 (31.2132%)
___Train Local_ResNet_18,  epoch 251, local model 36, internal_epoch   2,  Average loss: 0.0275, Accuracy: 358/849 (42.1673%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 5.0503, Accuracy: 1797/10000 (17.9700%)
___Train Local_ResNet_18,  epoch 251, local model 26, internal_epoch   1,  Average loss: 0.0474, Accuracy: 157/468 (33.5470%)
___Train Local_ResNet_18,  epoch 251, local model 26, internal_epoch   2,  Average loss: 0.0293, Accuracy: 210/468 (44.8718%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 251, local model 95, internal_epoch   1,  Average loss: 0.0279, Accuracy: 289/569 (50.7909%)
___Train Local_ResNet_18,  epoch 251, local model 95, internal_epoch   2,  Average loss: 0.0166, Accuracy: 353/569 (62.0387%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 251, local model 49, internal_epoch   1,  Average loss: 0.0428, Accuracy: 171/426 (40.1408%)
___Train Local_ResNet_18,  epoch 251, local model 49, internal_epoch   2,  Average loss: 0.0211, Accuracy: 261/426 (61.2676%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 251, local model 48, internal_epoch   1,  Average loss: 0.0368, Accuracy: 158/378 (41.7989%)
___Train Local_ResNet_18,  epoch 251, local model 48, internal_epoch   2,  Average loss: 0.0221, Accuracy: 198/378 (52.3810%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 251, local model 27, internal_epoch   1,  Average loss: 0.0524, Accuracy: 145/397 (36.5239%)
___Train Local_ResNet_18,  epoch 251, local model 27, internal_epoch   2,  Average loss: 0.0201, Accuracy: 259/397 (65.2393%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 244.6117582321167
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.40428406020841373  data num: [526, 527, 496, 546, 849, 468, 569, 426, 378, 397]
[rfa agg] considering poison per batch poison_fraction: 0.03158469220378232
[rfa agg] init. name: [17, 33, 77, 11, 36, 26, 95, 49, 48, 27], weight: tensor([0.1015, 0.1017, 0.0957, 0.1054, 0.1638, 0.0903, 0.1098, 0.0822, 0.0729,
        0.0766])
[rfa agg] iter:  0, prev_obj_val: 11318.2490234375, obj_val: 10913.451171875, abs dis: 404.7978515625
[rfa agg] iter:  0, weight: tensor([0.0751, 0.0754, 0.0869, 0.0782, 0.1890, 0.1036, 0.1261, 0.0942, 0.0835,
        0.0878])
[rfa agg] iter:  1, prev_obj_val: 10913.451171875, obj_val: 10560.65625, abs dis: 352.794921875
[rfa agg] iter:  1, weight: tensor([0.0570, 0.0572, 0.0641, 0.0592, 0.2109, 0.1154, 0.1405, 0.1049, 0.0930,
        0.0978])
[rfa agg] iter:  2, prev_obj_val: 10560.65625, obj_val: 10274.25, abs dis: 286.40625
[rfa agg] iter:  2, weight: tensor([0.0418, 0.0419, 0.0461, 0.0434, 0.2291, 0.1251, 0.1523, 0.1137, 0.1007,
        0.1059])
[rfa agg] iter:  3, prev_obj_val: 10274.25, obj_val: 10051.5693359375, abs dis: 222.6806640625
[rfa agg] iter:  3, weight: tensor([0.0299, 0.0300, 0.0326, 0.0311, 0.2435, 0.1325, 0.1614, 0.1203, 0.1065,
        0.1121])
[rfa agg] iter:  4, prev_obj_val: 10051.5693359375, obj_val: 9885.6630859375, abs dis: 165.90625
[rfa agg] iter:  4, weight: tensor([0.0210, 0.0211, 0.0227, 0.0218, 0.2549, 0.1379, 0.1682, 0.1251, 0.1107,
        0.1166])
[rfa agg] iter:  5, prev_obj_val: 9885.6630859375, obj_val: 9764.484375, abs dis: 121.1787109375
[rfa agg] iter:  5, weight: tensor([0.0145, 0.0146, 0.0156, 0.0151, 0.2640, 0.1417, 0.1730, 0.1284, 0.1134,
        0.1197])
[rfa agg] iter:  6, prev_obj_val: 9764.484375, obj_val: 9678.5556640625, abs dis: 85.9287109375
[rfa agg] iter:  6, weight: tensor([0.0099, 0.0099, 0.0106, 0.0103, 0.2720, 0.1442, 0.1764, 0.1304, 0.1149,
        0.1215])
[rfa agg] iter:  7, prev_obj_val: 9678.5556640625, obj_val: 9617.5634765625, abs dis: 60.9921875
[rfa agg] iter:  7, weight: tensor([0.0066, 0.0066, 0.0071, 0.0069, 0.2799, 0.1455, 0.1786, 0.1312, 0.1153,
        0.1223])
[rfa agg] iter:  8, prev_obj_val: 9617.5634765625, obj_val: 9577.201171875, abs dis: 40.3623046875
[rfa agg] iter:  8, weight: tensor([0.0043, 0.0043, 0.0046, 0.0045, 0.2894, 0.1458, 0.1798, 0.1308, 0.1145,
        0.1219])
[rfa agg] iter:  9, prev_obj_val: 9577.201171875, obj_val: 9548.9091796875, abs dis: 28.2919921875
[rfa agg] iter:  9, weight: tensor([0.0028, 0.0028, 0.0030, 0.0029, 0.3020, 0.1449, 0.1800, 0.1291, 0.1121,
        0.1203])
___Test Target_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 311.6022777557373 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:252 choose agents : [17, 33, 77, 11, 49, 74, 94, 29, 76, 70]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   1,  Average loss: 0.0351, Accuracy: 226/526 (42.9658%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   2,  Average loss: 0.0210, Accuracy: 322/526 (61.2167%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   3,  Average loss: 0.0146, Accuracy: 387/526 (73.5741%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   4,  Average loss: 0.0079, Accuracy: 465/526 (88.4030%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   5,  Average loss: 0.0051, Accuracy: 490/526 (93.1559%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   6,  Average loss: 0.0039, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Global model norm: 39.72896916874307.
Norm before scaling: 40.29448331648127. Distance: 8.887527864951702
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 3.0458, Accuracy: 3229/10000 (32.2900%)
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: 0.4096, Accuracy: 7695/9000 (85.5000%)
Scaling by  100
Scaled Norm after poisoning: 887.7422556688399, distance: 888.7526371268892
Total norm for 4 adversaries is: 887.7422556688399. distance: 888.7526371268892
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   1,  Average loss: 0.0392, Accuracy: 180/527 (34.1556%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   2,  Average loss: 0.0214, Accuracy: 294/527 (55.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   3,  Average loss: 0.0142, Accuracy: 380/527 (72.1063%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   4,  Average loss: 0.0088, Accuracy: 445/527 (84.4402%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   5,  Average loss: 0.0056, Accuracy: 495/527 (93.9279%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   6,  Average loss: 0.0045, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Global model norm: 39.72896916874307.
Norm before scaling: 40.12197284628618. Distance: 8.120434696231582
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 2.7859, Accuracy: 3274/10000 (32.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: 0.4160, Accuracy: 7809/9000 (86.7667%)
Scaling by  100
Scaled Norm after poisoning: 810.886551867769, distance: 812.0435256191629
Total norm for 4 adversaries is: 810.886551867769. distance: 812.0435256191629
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   1,  Average loss: 0.0256, Accuracy: 240/496 (48.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   2,  Average loss: 0.0138, Accuracy: 348/496 (70.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   3,  Average loss: 0.0066, Accuracy: 444/496 (89.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   4,  Average loss: 0.0035, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   5,  Average loss: 0.0018, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   6,  Average loss: 0.0012, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 39.72896916874307.
Norm before scaling: 39.96622567038246. Distance: 6.469528372554003
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 2.2599, Accuracy: 3698/10000 (36.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: 0.1216, Accuracy: 8598/9000 (95.5333%)
Scaling by  100
Scaled Norm after poisoning: 646.3991365634704, distance: 646.9528334816998
Total norm for 4 adversaries is: 646.3991365634704. distance: 646.9528334816998
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   1,  Average loss: 0.0357, Accuracy: 219/546 (40.1099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   2,  Average loss: 0.0172, Accuracy: 353/546 (64.6520%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   3,  Average loss: 0.0117, Accuracy: 424/546 (77.6557%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   4,  Average loss: 0.0067, Accuracy: 476/546 (87.1795%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   5,  Average loss: 0.0038, Accuracy: 512/546 (93.7729%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   6,  Average loss: 0.0017, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Global model norm: 39.72896916874307.
Norm before scaling: 40.058678883685744. Distance: 7.657214792926326
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 2.7485, Accuracy: 3487/10000 (34.8700%)
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: 0.3563, Accuracy: 8175/9000 (90.8333%)
Scaling by  100
Scaled Norm after poisoning: 764.6405609827405, distance: 765.7214327025201
Total norm for 4 adversaries is: 764.6405609827405. distance: 765.7214327025201
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 252, local model 49, internal_epoch   1,  Average loss: 0.0333, Accuracy: 209/426 (49.0610%)
___Train Local_ResNet_18,  epoch 252, local model 49, internal_epoch   2,  Average loss: 0.0164, Accuracy: 300/426 (70.4225%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 252, local model 74, internal_epoch   1,  Average loss: 0.0318, Accuracy: 208/469 (44.3497%)
___Train Local_ResNet_18,  epoch 252, local model 74, internal_epoch   2,  Average loss: 0.0206, Accuracy: 283/469 (60.3412%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 4.7559, Accuracy: 1832/10000 (18.3200%)
___Train Local_ResNet_18,  epoch 252, local model 94, internal_epoch   1,  Average loss: 0.0297, Accuracy: 109/203 (53.6946%)
___Train Local_ResNet_18,  epoch 252, local model 94, internal_epoch   2,  Average loss: 0.0155, Accuracy: 154/203 (75.8621%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 252, local model 29, internal_epoch   1,  Average loss: 0.0299, Accuracy: 481/848 (56.7217%)
___Train Local_ResNet_18,  epoch 252, local model 29, internal_epoch   2,  Average loss: 0.0153, Accuracy: 617/848 (72.7594%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 5.8771, Accuracy: 1800/10000 (18.0000%)
___Train Local_ResNet_18,  epoch 252, local model 76, internal_epoch   1,  Average loss: 0.0793, Accuracy: 14/65 (21.5385%)
___Train Local_ResNet_18,  epoch 252, local model 76, internal_epoch   2,  Average loss: 0.0907, Accuracy: 25/65 (38.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 252, local model 70, internal_epoch   1,  Average loss: 0.0306, Accuracy: 291/610 (47.7049%)
___Train Local_ResNet_18,  epoch 252, local model 70, internal_epoch   2,  Average loss: 0.0139, Accuracy: 428/610 (70.1639%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 4.6364, Accuracy: 2321/10000 (23.2100%)
time spent on training: 243.21571683883667
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4442324003392706  data num: [526, 527, 496, 546, 426, 469, 203, 848, 65, 610]
[rfa agg] considering poison per batch poison_fraction: 0.034705656276505514
[rfa agg] init. name: [17, 33, 77, 11, 49, 74, 94, 29, 76, 70], weight: tensor([0.1115, 0.1117, 0.1052, 0.1158, 0.0903, 0.0994, 0.0430, 0.1798, 0.0138,
        0.1293])
[rfa agg] iter:  0, prev_obj_val: 11591.1865234375, obj_val: 11444.98046875, abs dis: 146.2060546875
[rfa agg] iter:  0, weight: tensor([0.0927, 0.0930, 0.1088, 0.0963, 0.0988, 0.1088, 0.0469, 0.1978, 0.0150,
        0.1418])
[rfa agg] iter:  1, prev_obj_val: 11444.98046875, obj_val: 11306.4541015625, abs dis: 138.5263671875
[rfa agg] iter:  1, weight: tensor([0.0806, 0.0808, 0.0926, 0.0837, 0.1074, 0.1183, 0.0510, 0.2152, 0.0163,
        0.1542])
[rfa agg] iter:  2, prev_obj_val: 11306.4541015625, obj_val: 11178.5537109375, abs dis: 127.900390625
[rfa agg] iter:  2, weight: tensor([0.0691, 0.0693, 0.0781, 0.0718, 0.1153, 0.1271, 0.0548, 0.2314, 0.0175,
        0.1657])
[rfa agg] iter:  3, prev_obj_val: 11178.5537109375, obj_val: 11061.748046875, abs dis: 116.8056640625
[rfa agg] iter:  3, weight: tensor([0.0587, 0.0588, 0.0655, 0.0609, 0.1224, 0.1350, 0.0581, 0.2460, 0.0186,
        0.1760])
[rfa agg] iter:  4, prev_obj_val: 11061.748046875, obj_val: 10957.517578125, abs dis: 104.23046875
[rfa agg] iter:  4, weight: tensor([0.0492, 0.0493, 0.0544, 0.0511, 0.1288, 0.1420, 0.0611, 0.2592, 0.0195,
        0.1853])
[rfa agg] iter:  5, prev_obj_val: 10957.517578125, obj_val: 10865.841796875, abs dis: 91.67578125
[rfa agg] iter:  5, weight: tensor([0.0409, 0.0410, 0.0448, 0.0425, 0.1343, 0.1482, 0.0637, 0.2710, 0.0203,
        0.1934])
[rfa agg] iter:  6, prev_obj_val: 10865.841796875, obj_val: 10787.20703125, abs dis: 78.634765625
[rfa agg] iter:  6, weight: tensor([0.0336, 0.0337, 0.0366, 0.0349, 0.1391, 0.1535, 0.0658, 0.2813, 0.0210,
        0.2005])
[rfa agg] iter:  7, prev_obj_val: 10787.20703125, obj_val: 10721.1064453125, abs dis: 66.1005859375
[rfa agg] iter:  7, weight: tensor([0.0275, 0.0275, 0.0298, 0.0285, 0.1430, 0.1579, 0.0676, 0.2902, 0.0215,
        0.2065])
[rfa agg] iter:  8, prev_obj_val: 10721.1064453125, obj_val: 10665.0302734375, abs dis: 56.076171875
[rfa agg] iter:  8, weight: tensor([0.0224, 0.0224, 0.0241, 0.0232, 0.1462, 0.1615, 0.0690, 0.2980, 0.0219,
        0.2114])
[rfa agg] iter:  9, prev_obj_val: 10665.0302734375, obj_val: 10618.96875, abs dis: 46.0615234375
[rfa agg] iter:  9, weight: tensor([0.0180, 0.0181, 0.0194, 0.0187, 0.1487, 0.1644, 0.0700, 0.3049, 0.0222,
        0.2156])
___Test Target_ResNet_18 poisoned: False, epoch: 252: Average loss: 1.8928, Accuracy: 3698/10000 (36.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 252: Average loss: 0.6091, Accuracy: 7102/9000 (78.9111%)
Done in 308.36106729507446 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:253 choose agents : [17, 33, 77, 11, 99, 76, 10, 58, 65, 75]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   1,  Average loss: 0.0144, Accuracy: 378/526 (71.8631%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   2,  Average loss: 0.0074, Accuracy: 459/526 (87.2624%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   3,  Average loss: 0.0046, Accuracy: 491/526 (93.3460%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   4,  Average loss: 0.0034, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   5,  Average loss: 0.0031, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   6,  Average loss: 0.0031, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Global model norm: 39.572626875803465.
Norm before scaling: 39.95878155841107. Distance: 6.985844058659917
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 2.6833, Accuracy: 3249/10000 (32.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: 0.0080, Accuracy: 8987/9000 (99.8556%)
Scaling by  100
Scaled Norm after poisoning: 698.4104049554245, distance: 698.5844168745822
Total norm for 4 adversaries is: 698.4104049554245. distance: 698.5844168745822
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   1,  Average loss: 0.0128, Accuracy: 400/527 (75.9013%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   2,  Average loss: 0.0093, Accuracy: 441/527 (83.6812%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   3,  Average loss: 0.0055, Accuracy: 476/527 (90.3226%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   4,  Average loss: 0.0043, Accuracy: 495/527 (93.9279%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   5,  Average loss: 0.0044, Accuracy: 500/527 (94.8767%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   6,  Average loss: 0.0026, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Global model norm: 39.572626875803465.
Norm before scaling: 40.21544457570841. Distance: 8.045563644664776
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 2.7887, Accuracy: 3472/10000 (34.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: 0.2565, Accuracy: 8271/9000 (91.9000%)
Scaling by  100
Scaled Norm after poisoning: 804.6941577394482, distance: 804.5563606733838
Total norm for 4 adversaries is: 804.6941577394482. distance: 804.5563606733838
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   1,  Average loss: 0.0117, Accuracy: 373/496 (75.2016%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 460/496 (92.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   3,  Average loss: 0.0023, Accuracy: 479/496 (96.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   4,  Average loss: 0.0019, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   5,  Average loss: 0.0013, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   6,  Average loss: 0.0012, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 39.572626875803465.
Norm before scaling: 39.73873261840628. Distance: 5.478403345273235
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 2.6963, Accuracy: 3297/10000 (32.9700%)
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: 0.0482, Accuracy: 8826/9000 (98.0667%)
Scaling by  100
Scaled Norm after poisoning: 547.7328272068418, distance: 547.8403337195975
Total norm for 4 adversaries is: 547.7328272068418. distance: 547.8403337195975
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   1,  Average loss: 0.0144, Accuracy: 399/546 (73.0769%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   2,  Average loss: 0.0062, Accuracy: 494/546 (90.4762%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   3,  Average loss: 0.0033, Accuracy: 521/546 (95.4212%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   4,  Average loss: 0.0024, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   6,  Average loss: 0.0013, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Global model norm: 39.572626875803465.
Norm before scaling: 39.87022251699491. Distance: 6.42646302661664
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 2.6581, Accuracy: 3623/10000 (36.2300%)
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: 0.2363, Accuracy: 8408/9000 (93.4222%)
Scaling by  100
Scaled Norm after poisoning: 642.4909046048823, distance: 642.6464084160123
Total norm for 4 adversaries is: 642.4909046048823. distance: 642.6464084160123
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 253, local model 99, internal_epoch   1,  Average loss: 0.0278, Accuracy: 198/391 (50.6394%)
___Train Local_ResNet_18,  epoch 253, local model 99, internal_epoch   2,  Average loss: 0.0156, Accuracy: 281/391 (71.8670%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 9.1342, Accuracy: 1697/10000 (16.9700%)
___Train Local_ResNet_18,  epoch 253, local model 76, internal_epoch   1,  Average loss: 0.0804, Accuracy: 22/65 (33.8462%)
___Train Local_ResNet_18,  epoch 253, local model 76, internal_epoch   2,  Average loss: 0.0632, Accuracy: 51/65 (78.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 4.8174, Accuracy: 1886/10000 (18.8600%)
___Train Local_ResNet_18,  epoch 253, local model 10, internal_epoch   1,  Average loss: 0.0178, Accuracy: 540/752 (71.8085%)
___Train Local_ResNet_18,  epoch 253, local model 10, internal_epoch   2,  Average loss: 0.0077, Accuracy: 637/752 (84.7074%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 5.2325, Accuracy: 2545/10000 (25.4500%)
___Train Local_ResNet_18,  epoch 253, local model 58, internal_epoch   1,  Average loss: 0.0370, Accuracy: 87/234 (37.1795%)
___Train Local_ResNet_18,  epoch 253, local model 58, internal_epoch   2,  Average loss: 0.0121, Accuracy: 184/234 (78.6325%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 11.5409, Accuracy: 1024/10000 (10.2400%)
___Train Local_ResNet_18,  epoch 253, local model 65, internal_epoch   1,  Average loss: 0.0319, Accuracy: 150/314 (47.7707%)
___Train Local_ResNet_18,  epoch 253, local model 65, internal_epoch   2,  Average loss: 0.0134, Accuracy: 224/314 (71.3376%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 10.0393, Accuracy: 1258/10000 (12.5800%)
___Train Local_ResNet_18,  epoch 253, local model 75, internal_epoch   1,  Average loss: 0.0258, Accuracy: 327/578 (56.5744%)
___Train Local_ResNet_18,  epoch 253, local model 75, internal_epoch   2,  Average loss: 0.0201, Accuracy: 347/578 (60.0346%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 6.8105, Accuracy: 1581/10000 (15.8100%)
time spent on training: 242.2765588760376
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4730187401219237  data num: [526, 527, 496, 546, 391, 65, 752, 234, 314, 578]
[rfa agg] considering poison per batch poison_fraction: 0.036954589072025285
[rfa agg] init. name: [17, 33, 77, 11, 99, 76, 10, 58, 65, 75], weight: tensor([0.1188, 0.1190, 0.1120, 0.1233, 0.0883, 0.0147, 0.1698, 0.0528, 0.0709,
        0.1305])
[rfa agg] iter:  0, prev_obj_val: 11694.330078125, obj_val: 11658.6591796875, abs dis: 35.6708984375
[rfa agg] iter:  0, weight: tensor([0.1058, 0.1060, 0.1257, 0.1099, 0.0924, 0.0153, 0.1785, 0.0552, 0.0741,
        0.1370])
[rfa agg] iter:  1, prev_obj_val: 11658.6591796875, obj_val: 11623.28515625, abs dis: 35.3740234375
[rfa agg] iter:  1, weight: tensor([0.0996, 0.0997, 0.1169, 0.1034, 0.0971, 0.0161, 0.1875, 0.0580, 0.0778,
        0.1439])
[rfa agg] iter:  2, prev_obj_val: 11623.28515625, obj_val: 11588.921875, abs dis: 34.36328125
[rfa agg] iter:  2, weight: tensor([0.0934, 0.0935, 0.1084, 0.0970, 0.1017, 0.0168, 0.1964, 0.0607, 0.0815,
        0.1507])
[rfa agg] iter:  3, prev_obj_val: 11588.921875, obj_val: 11555.0703125, abs dis: 33.8515625
[rfa agg] iter:  3, weight: tensor([0.0873, 0.0875, 0.1004, 0.0907, 0.1061, 0.0175, 0.2050, 0.0633, 0.0850,
        0.1573])
[rfa agg] iter:  4, prev_obj_val: 11555.0703125, obj_val: 11522.216796875, abs dis: 32.853515625
[rfa agg] iter:  4, weight: tensor([0.0813, 0.0815, 0.0927, 0.0844, 0.1104, 0.0183, 0.2134, 0.0659, 0.0885,
        0.1637])
[rfa agg] iter:  5, prev_obj_val: 11522.216796875, obj_val: 11490.599609375, abs dis: 31.6171875
[rfa agg] iter:  5, weight: tensor([0.0755, 0.0756, 0.0854, 0.0784, 0.1146, 0.0189, 0.2216, 0.0683, 0.0918,
        0.1699])
[rfa agg] iter:  6, prev_obj_val: 11490.599609375, obj_val: 11459.970703125, abs dis: 30.62890625
[rfa agg] iter:  6, weight: tensor([0.0699, 0.0700, 0.0785, 0.0726, 0.1185, 0.0196, 0.2294, 0.0707, 0.0950,
        0.1759])
[rfa agg] iter:  7, prev_obj_val: 11459.970703125, obj_val: 11431.056640625, abs dis: 28.9140625
[rfa agg] iter:  7, weight: tensor([0.0644, 0.0645, 0.0719, 0.0669, 0.1224, 0.0202, 0.2369, 0.0730, 0.0980,
        0.1816])
[rfa agg] iter:  8, prev_obj_val: 11431.056640625, obj_val: 11403.609375, abs dis: 27.447265625
[rfa agg] iter:  8, weight: tensor([0.0593, 0.0594, 0.0658, 0.0616, 0.1260, 0.0208, 0.2441, 0.0751, 0.1009,
        0.1870])
[rfa agg] iter:  9, prev_obj_val: 11403.609375, obj_val: 11377.8740234375, abs dis: 25.7353515625
[rfa agg] iter:  9, weight: tensor([0.0544, 0.0545, 0.0601, 0.0565, 0.1294, 0.0213, 0.2508, 0.0771, 0.1036,
        0.1922])
___Test Target_ResNet_18 poisoned: False, epoch: 253: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 310.1096374988556 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:254 choose agents : [17, 33, 77, 11, 48, 64, 16, 97, 52, 24]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   1,  Average loss: 0.0084, Accuracy: 453/526 (86.1217%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   2,  Average loss: 0.0061, Accuracy: 485/526 (92.2053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   3,  Average loss: 0.0050, Accuracy: 488/526 (92.7757%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   4,  Average loss: 0.0044, Accuracy: 488/526 (92.7757%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   5,  Average loss: 0.0047, Accuracy: 489/526 (92.9658%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   6,  Average loss: 0.0042, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Global model norm: 39.890493414393234.
Norm before scaling: 40.50486744959641. Distance: 8.26255213364675
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 2.8339, Accuracy: 3832/10000 (38.3200%)
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: 0.2008, Accuracy: 8363/9000 (92.9222%)
Scaling by  100
Scaled Norm after poisoning: 826.0757758825761, distance: 826.2551815268695
Total norm for 4 adversaries is: 826.0757758825761. distance: 826.2551815268695
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   1,  Average loss: 0.0085, Accuracy: 445/527 (84.4402%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 490/527 (92.9791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   3,  Average loss: 0.0028, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   4,  Average loss: 0.0041, Accuracy: 500/527 (94.8767%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   5,  Average loss: 0.0052, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   6,  Average loss: 0.0047, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Global model norm: 39.890493414393234.
Norm before scaling: 40.4804474527711. Distance: 8.15419231781769
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 2.6607, Accuracy: 3534/10000 (35.3400%)
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: 0.3879, Accuracy: 8047/9000 (89.4111%)
Scaling by  100
Scaled Norm after poisoning: 815.2252756140476, distance: 815.4192556593204
Total norm for 4 adversaries is: 815.2252756140476. distance: 815.4192556593204
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   1,  Average loss: 0.0072, Accuracy: 420/496 (84.6774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   2,  Average loss: 0.0028, Accuracy: 474/496 (95.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   3,  Average loss: 0.0012, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   4,  Average loss: 0.0015, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 39.890493414393234.
Norm before scaling: 39.971837620184225. Distance: 5.314442716936703
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 2.0455, Accuracy: 4437/10000 (44.3700%)
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: 0.1368, Accuracy: 8621/9000 (95.7889%)
Scaling by  100
Scaled Norm after poisoning: 530.8950284660801, distance: 531.4442586010315
Total norm for 4 adversaries is: 530.8950284660801. distance: 531.4442586010315
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 458/546 (83.8828%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 11, internal_epoch   2,  Average loss: 0.0023, Accuracy: 526/546 (96.3370%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 11, internal_epoch   3,  Average loss: 0.0021, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 11, internal_epoch   4,  Average loss: 0.0009, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 39.890493414393234.
Norm before scaling: 40.056787997147715. Distance: 6.076690112201424
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 2.2042, Accuracy: 4589/10000 (45.8900%)
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: 0.1712, Accuracy: 8546/9000 (94.9556%)
Scaling by  100
Scaled Norm after poisoning: 607.0335400535954, distance: 607.669035125207
Total norm for 4 adversaries is: 607.0335400535954. distance: 607.669035125207
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 254, local model 48, internal_epoch   1,  Average loss: 0.0378, Accuracy: 166/378 (43.9153%)
___Train Local_ResNet_18,  epoch 254, local model 48, internal_epoch   2,  Average loss: 0.0169, Accuracy: 250/378 (66.1376%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 5.1263, Accuracy: 2552/10000 (25.5200%)
___Train Local_ResNet_18,  epoch 254, local model 64, internal_epoch   1,  Average loss: 0.0285, Accuracy: 379/686 (55.2478%)
___Train Local_ResNet_18,  epoch 254, local model 64, internal_epoch   2,  Average loss: 0.0141, Accuracy: 469/686 (68.3673%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 5.7357, Accuracy: 3121/10000 (31.2100%)
___Train Local_ResNet_18,  epoch 254, local model 16, internal_epoch   1,  Average loss: 0.0312, Accuracy: 410/773 (53.0401%)
___Train Local_ResNet_18,  epoch 254, local model 16, internal_epoch   2,  Average loss: 0.0203, Accuracy: 474/773 (61.3195%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 3.7597, Accuracy: 2032/10000 (20.3200%)
___Train Local_ResNet_18,  epoch 254, local model 97, internal_epoch   1,  Average loss: 0.0285, Accuracy: 245/418 (58.6124%)
___Train Local_ResNet_18,  epoch 254, local model 97, internal_epoch   2,  Average loss: 0.0141, Accuracy: 313/418 (74.8804%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 11.8413, Accuracy: 1822/10000 (18.2200%)
___Train Local_ResNet_18,  epoch 254, local model 52, internal_epoch   1,  Average loss: 0.0405, Accuracy: 94/214 (43.9252%)
___Train Local_ResNet_18,  epoch 254, local model 52, internal_epoch   2,  Average loss: 0.0070, Accuracy: 187/214 (87.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 254, local model 24, internal_epoch   1,  Average loss: 0.0396, Accuracy: 143/320 (44.6875%)
___Train Local_ResNet_18,  epoch 254, local model 24, internal_epoch   2,  Average loss: 0.0094, Accuracy: 253/320 (79.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 246.30576586723328
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.42895167895167896  data num: [526, 527, 496, 546, 378, 686, 773, 418, 214, 320]
[rfa agg] considering poison per batch poison_fraction: 0.03351184991809992
[rfa agg] init. name: [17, 33, 77, 11, 48, 64, 16, 97, 52, 24], weight: tensor([0.1077, 0.1079, 0.1016, 0.1118, 0.0774, 0.1405, 0.1583, 0.0856, 0.0438,
        0.0655])
[rfa agg] iter:  0, prev_obj_val: 11488.2451171875, obj_val: 11256.056640625, abs dis: 232.1884765625
[rfa agg] iter:  0, weight: tensor([0.0859, 0.0861, 0.1002, 0.0893, 0.0863, 0.1573, 0.1776, 0.0955, 0.0488,
        0.0730])
[rfa agg] iter:  1, prev_obj_val: 11256.056640625, obj_val: 11043.150390625, abs dis: 212.90625
[rfa agg] iter:  1, weight: tensor([0.0710, 0.0712, 0.0809, 0.0738, 0.0950, 0.1733, 0.1957, 0.1052, 0.0537,
        0.0803])
[rfa agg] iter:  2, prev_obj_val: 11043.150390625, obj_val: 10853.2763671875, abs dis: 189.8740234375
[rfa agg] iter:  2, weight: tensor([0.0577, 0.0578, 0.0645, 0.0599, 0.1026, 0.1875, 0.2118, 0.1136, 0.0579,
        0.0868])
[rfa agg] iter:  3, prev_obj_val: 10853.2763671875, obj_val: 10688.9384765625, abs dis: 164.337890625
[rfa agg] iter:  3, weight: tensor([0.0460, 0.0461, 0.0507, 0.0478, 0.1092, 0.1997, 0.2258, 0.1209, 0.0616,
        0.0923])
[rfa agg] iter:  4, prev_obj_val: 10688.9384765625, obj_val: 10552.021484375, abs dis: 136.9169921875
[rfa agg] iter:  4, weight: tensor([0.0361, 0.0362, 0.0394, 0.0375, 0.1146, 0.2101, 0.2377, 0.1270, 0.0646,
        0.0968])
[rfa agg] iter:  5, prev_obj_val: 10552.021484375, obj_val: 10439.9580078125, abs dis: 112.0634765625
[rfa agg] iter:  5, weight: tensor([0.0280, 0.0280, 0.0304, 0.0291, 0.1189, 0.2186, 0.2477, 0.1319, 0.0670,
        0.1004])
[rfa agg] iter:  6, prev_obj_val: 10439.9580078125, obj_val: 10350.19140625, abs dis: 89.7666015625
[rfa agg] iter:  6, weight: tensor([0.0215, 0.0215, 0.0232, 0.0223, 0.1223, 0.2257, 0.2560, 0.1357, 0.0688,
        0.1032])
[rfa agg] iter:  7, prev_obj_val: 10350.19140625, obj_val: 10280.169921875, abs dis: 70.021484375
[rfa agg] iter:  7, weight: tensor([0.0163, 0.0163, 0.0175, 0.0169, 0.1247, 0.2314, 0.2631, 0.1385, 0.0700,
        0.1051])
[rfa agg] iter:  8, prev_obj_val: 10280.169921875, obj_val: 10224.7919921875, abs dis: 55.3779296875
[rfa agg] iter:  8, weight: tensor([0.0123, 0.0123, 0.0132, 0.0128, 0.1264, 0.2361, 0.2692, 0.1406, 0.0708,
        0.1064])
[rfa agg] iter:  9, prev_obj_val: 10224.7919921875, obj_val: 10182.1533203125, abs dis: 42.638671875
[rfa agg] iter:  9, weight: tensor([0.0092, 0.0092, 0.0098, 0.0096, 0.1273, 0.2401, 0.2749, 0.1419, 0.0710,
        0.1070])
___Test Target_ResNet_18 poisoned: False, epoch: 254: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 254: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 314.49792075157166 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:255 choose agents : [17, 33, 77, 11, 10, 34, 27, 49, 56, 48]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 17, internal_epoch   1,  Average loss: 0.0034, Accuracy: 494/526 (93.9163%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 17, internal_epoch   2,  Average loss: 0.0018, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 17, internal_epoch   3,  Average loss: 0.0020, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 17, internal_epoch   4,  Average loss: 0.0021, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 17, internal_epoch   5,  Average loss: 0.0031, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 17, internal_epoch   6,  Average loss: 0.0023, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Global model norm: 39.77601626264956.
Norm before scaling: 39.80353362532653. Distance: 5.099714286131224
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 2.3812, Accuracy: 4060/10000 (40.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 255: Average loss: 0.1891, Accuracy: 8423/9000 (93.5889%)
Scaling by  100
Scaled Norm after poisoning: 509.1868670979251, distance: 509.97139932058934
Total norm for 4 adversaries is: 509.1868670979251. distance: 509.97139932058934
___Test Local_ResNet_18 poisoned: True, epoch: 255: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 33, internal_epoch   1,  Average loss: 0.0046, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 33, internal_epoch   2,  Average loss: 0.0015, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 33, internal_epoch   3,  Average loss: 0.0018, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 33, internal_epoch   4,  Average loss: 0.0015, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 33, internal_epoch   5,  Average loss: 0.0043, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 33, internal_epoch   6,  Average loss: 0.0036, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Global model norm: 39.77601626264956.
Norm before scaling: 39.757926870291385. Distance: 4.981706724204701
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 2.3730, Accuracy: 4291/10000 (42.9100%)
___Test Local_ResNet_18 poisoned: True, epoch: 255: Average loss: 0.1419, Accuracy: 8549/9000 (94.9889%)
Scaling by  100
Scaled Norm after poisoning: 497.1222969501569, distance: 498.1706691737281
Total norm for 4 adversaries is: 497.1222969501569. distance: 498.1706691737281
___Test Local_ResNet_18 poisoned: True, epoch: 255: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 77, internal_epoch   1,  Average loss: 0.0029, Accuracy: 473/496 (95.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 77, internal_epoch   2,  Average loss: 0.0016, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 77, internal_epoch   3,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 77, internal_epoch   4,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 77, internal_epoch   5,  Average loss: 0.0007, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 39.77601626264956.
Norm before scaling: 39.58122767151589. Distance: 2.8394813778644963
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 1.8423, Accuracy: 4885/10000 (48.8500%)
___Test Local_ResNet_18 poisoned: True, epoch: 255: Average loss: 0.1442, Accuracy: 8644/9000 (96.0444%)
Scaling by  100
Scaled Norm after poisoning: 282.5891314037042, distance: 283.9481274150263
Total norm for 4 adversaries is: 282.5891314037042. distance: 283.9481274150263
___Test Local_ResNet_18 poisoned: True, epoch: 255: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 11, internal_epoch   1,  Average loss: 0.0040, Accuracy: 505/546 (92.4908%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 11, internal_epoch   2,  Average loss: 0.0016, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 11, internal_epoch   3,  Average loss: 0.0016, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 11, internal_epoch   4,  Average loss: 0.0011, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 11, internal_epoch   5,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 39.77601626264956.
Norm before scaling: 39.74096269859272. Distance: 4.560418686300673
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 2.2949, Accuracy: 4465/10000 (44.6500%)
___Test Local_ResNet_18 poisoned: True, epoch: 255: Average loss: 0.2136, Accuracy: 8534/9000 (94.8222%)
Scaling by  100
Scaled Norm after poisoning: 455.1899328851639, distance: 456.0418532053829
Total norm for 4 adversaries is: 455.1899328851639. distance: 456.0418532053829
___Test Local_ResNet_18 poisoned: True, epoch: 255: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 255, local model 10, internal_epoch   1,  Average loss: 0.0179, Accuracy: 555/752 (73.8032%)
___Train Local_ResNet_18,  epoch 255, local model 10, internal_epoch   2,  Average loss: 0.0071, Accuracy: 651/752 (86.5691%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 4.7786, Accuracy: 3155/10000 (31.5500%)
___Train Local_ResNet_18,  epoch 255, local model 34, internal_epoch   1,  Average loss: 0.0321, Accuracy: 185/349 (53.0086%)
___Train Local_ResNet_18,  epoch 255, local model 34, internal_epoch   2,  Average loss: 0.0109, Accuracy: 280/349 (80.2292%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 8.2406, Accuracy: 1818/10000 (18.1800%)
___Train Local_ResNet_18,  epoch 255, local model 27, internal_epoch   1,  Average loss: 0.0240, Accuracy: 251/397 (63.2242%)
___Train Local_ResNet_18,  epoch 255, local model 27, internal_epoch   2,  Average loss: 0.0127, Accuracy: 319/397 (80.3526%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 6.7604, Accuracy: 2762/10000 (27.6200%)
___Train Local_ResNet_18,  epoch 255, local model 49, internal_epoch   1,  Average loss: 0.0228, Accuracy: 261/426 (61.2676%)
___Train Local_ResNet_18,  epoch 255, local model 49, internal_epoch   2,  Average loss: 0.0114, Accuracy: 340/426 (79.8122%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 5.7411, Accuracy: 2431/10000 (24.3100%)
___Train Local_ResNet_18,  epoch 255, local model 56, internal_epoch   1,  Average loss: 0.0214, Accuracy: 473/743 (63.6608%)
___Train Local_ResNet_18,  epoch 255, local model 56, internal_epoch   2,  Average loss: 0.0139, Accuracy: 525/743 (70.6595%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 3.0593, Accuracy: 3972/10000 (39.7200%)
___Train Local_ResNet_18,  epoch 255, local model 48, internal_epoch   1,  Average loss: 0.0294, Accuracy: 188/378 (49.7354%)
___Train Local_ResNet_18,  epoch 255, local model 48, internal_epoch   2,  Average loss: 0.0120, Accuracy: 278/378 (73.5450%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 6.1615, Accuracy: 2375/10000 (23.7500%)
time spent on training: 243.86359190940857
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4075875486381323  data num: [526, 527, 496, 546, 752, 349, 397, 426, 743, 378]
[rfa agg] considering poison per batch poison_fraction: 0.031842777237354083
[rfa agg] init. name: [17, 33, 77, 11, 10, 34, 27, 49, 56, 48], weight: tensor([0.1023, 0.1025, 0.0965, 0.1062, 0.1463, 0.0679, 0.0772, 0.0829, 0.1446,
        0.0735])
[rfa agg] iter:  0, prev_obj_val: 11315.490234375, obj_val: 10939.0087890625, abs dis: 376.4814453125
[rfa agg] iter:  0, weight: tensor([0.0767, 0.0769, 0.0887, 0.0796, 0.1679, 0.0775, 0.0882, 0.0947, 0.1659,
        0.0839])
[rfa agg] iter:  1, prev_obj_val: 10939.0087890625, obj_val: 10609.7626953125, abs dis: 329.24609375
[rfa agg] iter:  1, weight: tensor([0.0589, 0.0590, 0.0663, 0.0612, 0.1870, 0.0862, 0.0981, 0.1053, 0.1847,
        0.0933])
[rfa agg] iter:  2, prev_obj_val: 10609.7626953125, obj_val: 10335.9775390625, abs dis: 273.78515625
[rfa agg] iter:  2, weight: tensor([0.0440, 0.0440, 0.0486, 0.0456, 0.2028, 0.0933, 0.1063, 0.1140, 0.2004,
        0.1010])
[rfa agg] iter:  3, prev_obj_val: 10335.9775390625, obj_val: 10120.935546875, abs dis: 215.0419921875
[rfa agg] iter:  3, weight: tensor([0.0320, 0.0320, 0.0349, 0.0332, 0.2156, 0.0988, 0.1126, 0.1208, 0.2130,
        0.1070])
[rfa agg] iter:  4, prev_obj_val: 10120.935546875, obj_val: 9956.359375, abs dis: 164.576171875
[rfa agg] iter:  4, weight: tensor([0.0229, 0.0229, 0.0247, 0.0237, 0.2255, 0.1028, 0.1173, 0.1259, 0.2228,
        0.1114])
[rfa agg] iter:  5, prev_obj_val: 9956.359375, obj_val: 9833.9677734375, abs dis: 122.3916015625
[rfa agg] iter:  5, weight: tensor([0.0161, 0.0161, 0.0173, 0.0167, 0.2333, 0.1056, 0.1206, 0.1295, 0.2305,
        0.1144])
[rfa agg] iter:  6, prev_obj_val: 9833.9677734375, obj_val: 9746.3134765625, abs dis: 87.654296875
[rfa agg] iter:  6, weight: tensor([0.0111, 0.0111, 0.0119, 0.0115, 0.2396, 0.1073, 0.1228, 0.1318, 0.2367,
        0.1162])
[rfa agg] iter:  7, prev_obj_val: 9746.3134765625, obj_val: 9682.6474609375, abs dis: 63.666015625
[rfa agg] iter:  7, weight: tensor([0.0076, 0.0076, 0.0081, 0.0079, 0.2450, 0.1080, 0.1239, 0.1329, 0.2420,
        0.1170])
[rfa agg] iter:  8, prev_obj_val: 9682.6474609375, obj_val: 9638.8369140625, abs dis: 43.810546875
[rfa agg] iter:  8, weight: tensor([0.0051, 0.0051, 0.0054, 0.0053, 0.2504, 0.1077, 0.1240, 0.1331, 0.2474,
        0.1166])
[rfa agg] iter:  9, prev_obj_val: 9638.8369140625, obj_val: 9609.92578125, abs dis: 28.9111328125
[rfa agg] iter:  9, weight: tensor([0.0033, 0.0033, 0.0035, 0.0035, 0.2567, 0.1061, 0.1230, 0.1320, 0.2536,
        0.1150])
___Test Target_ResNet_18 poisoned: False, epoch: 255: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 255: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 313.4478483200073 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:256 choose agents : [17, 33, 77, 11, 14, 45, 65, 37, 38, 24]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 17, internal_epoch   1,  Average loss: 0.0046, Accuracy: 495/526 (94.1065%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 17, internal_epoch   2,  Average loss: 0.0034, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 17, internal_epoch   3,  Average loss: 0.0031, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 17, internal_epoch   4,  Average loss: 0.0022, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 17, internal_epoch   5,  Average loss: 0.0018, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 17, internal_epoch   6,  Average loss: 0.0011, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Global model norm: 39.70126637473687.
Norm before scaling: 39.91921621527892. Distance: 6.122060576464782
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 2.3747, Accuracy: 3908/10000 (39.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 256: Average loss: 0.0605, Accuracy: 8781/9000 (97.5667%)
Scaling by  100
Scaled Norm after poisoning: 611.8495270489306, distance: 612.2060774363482
Total norm for 4 adversaries is: 611.8495270489306. distance: 612.2060774363482
___Test Local_ResNet_18 poisoned: True, epoch: 256: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 488/527 (92.5996%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 33, internal_epoch   2,  Average loss: 0.0031, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 33, internal_epoch   3,  Average loss: 0.0034, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 33, internal_epoch   4,  Average loss: 0.0035, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 33, internal_epoch   5,  Average loss: 0.0042, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 33, internal_epoch   6,  Average loss: 0.0048, Accuracy: 487/527 (92.4099%), train_poison_data_count: 45
Global model norm: 39.70126637473687.
Norm before scaling: 40.09196885657868. Distance: 6.849377134642855
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 2.5670, Accuracy: 4098/10000 (40.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 256: Average loss: 0.2777, Accuracy: 8148/9000 (90.5333%)
Scaling by  100
Scaled Norm after poisoning: 684.9393905667858, distance: 684.9376796468421
Total norm for 4 adversaries is: 684.9393905667858. distance: 684.9376796468421
___Test Local_ResNet_18 poisoned: True, epoch: 256: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 77, internal_epoch   1,  Average loss: 0.0028, Accuracy: 474/496 (95.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 77, internal_epoch   2,  Average loss: 0.0011, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 77, internal_epoch   3,  Average loss: 0.0007, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 77, internal_epoch   4,  Average loss: 0.0002, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 39.70126637473687.
Norm before scaling: 39.48635976412456. Distance: 2.527761433680122
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 1.9041, Accuracy: 4753/10000 (47.5300%)
___Test Local_ResNet_18 poisoned: True, epoch: 256: Average loss: 0.0680, Accuracy: 8788/9000 (97.6444%)
Scaling by  100
Scaled Norm after poisoning: 251.25929709166982, distance: 252.77616395241859
Total norm for 4 adversaries is: 251.25929709166982. distance: 252.77616395241859
___Test Local_ResNet_18 poisoned: True, epoch: 256: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 11, internal_epoch   1,  Average loss: 0.0031, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 11, internal_epoch   2,  Average loss: 0.0011, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 11, internal_epoch   3,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 11, internal_epoch   4,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 39.70126637473687.
Norm before scaling: 39.50400339433571. Distance: 3.429603662530622
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 2.0195, Accuracy: 4756/10000 (47.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 256: Average loss: 0.1498, Accuracy: 8638/9000 (95.9778%)
Scaling by  100
Scaled Norm after poisoning: 341.26142380146047, distance: 342.96032022669914
Total norm for 4 adversaries is: 341.26142380146047. distance: 342.96032022669914
___Test Local_ResNet_18 poisoned: True, epoch: 256: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 256, local model 14, internal_epoch   1,  Average loss: 0.0199, Accuracy: 187/318 (58.8050%)
___Train Local_ResNet_18,  epoch 256, local model 14, internal_epoch   2,  Average loss: 0.0076, Accuracy: 273/318 (85.8491%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 11.2662, Accuracy: 1704/10000 (17.0400%)
___Train Local_ResNet_18,  epoch 256, local model 45, internal_epoch   1,  Average loss: 0.0256, Accuracy: 310/529 (58.6011%)
___Train Local_ResNet_18,  epoch 256, local model 45, internal_epoch   2,  Average loss: 0.0104, Accuracy: 419/529 (79.2060%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 3.8650, Accuracy: 3017/10000 (30.1700%)
___Train Local_ResNet_18,  epoch 256, local model 65, internal_epoch   1,  Average loss: 0.0268, Accuracy: 178/314 (56.6879%)
___Train Local_ResNet_18,  epoch 256, local model 65, internal_epoch   2,  Average loss: 0.0073, Accuracy: 268/314 (85.3503%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 6.0588, Accuracy: 2474/10000 (24.7400%)
___Train Local_ResNet_18,  epoch 256, local model 37, internal_epoch   1,  Average loss: 0.0225, Accuracy: 433/725 (59.7241%)
___Train Local_ResNet_18,  epoch 256, local model 37, internal_epoch   2,  Average loss: 0.0115, Accuracy: 552/725 (76.1379%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 5.6957, Accuracy: 2101/10000 (21.0100%)
___Train Local_ResNet_18,  epoch 256, local model 38, internal_epoch   1,  Average loss: 0.0207, Accuracy: 471/756 (62.3016%)
___Train Local_ResNet_18,  epoch 256, local model 38, internal_epoch   2,  Average loss: 0.0107, Accuracy: 596/756 (78.8360%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 3.4086, Accuracy: 3490/10000 (34.9000%)
___Train Local_ResNet_18,  epoch 256, local model 24, internal_epoch   1,  Average loss: 0.0248, Accuracy: 180/320 (56.2500%)
___Train Local_ResNet_18,  epoch 256, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 279/320 (87.1875%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 10.8086, Accuracy: 1252/10000 (12.5200%)
time spent on training: 240.660480260849
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4142772394700415  data num: [526, 527, 496, 546, 318, 529, 314, 725, 756, 320]
[rfa agg] considering poison per batch poison_fraction: 0.032365409333596995
[rfa agg] init. name: [17, 33, 77, 11, 14, 45, 65, 37, 38, 24], weight: tensor([0.1040, 0.1042, 0.0981, 0.1080, 0.0629, 0.1046, 0.0621, 0.1434, 0.1495,
        0.0633])
[rfa agg] iter:  0, prev_obj_val: 11371.92578125, obj_val: 11043.2646484375, abs dis: 328.6611328125
[rfa agg] iter:  0, weight: tensor([0.0795, 0.0796, 0.0922, 0.0826, 0.0712, 0.1189, 0.0703, 0.1634, 0.1704,
        0.0717])
[rfa agg] iter:  1, prev_obj_val: 11043.2646484375, obj_val: 10750.021484375, abs dis: 293.2431640625
[rfa agg] iter:  1, weight: tensor([0.0625, 0.0626, 0.0706, 0.0649, 0.0790, 0.1320, 0.0780, 0.1816, 0.1893,
        0.0795])
[rfa agg] iter:  2, prev_obj_val: 10750.021484375, obj_val: 10500.578125, abs dis: 249.443359375
[rfa agg] iter:  2, weight: tensor([0.0478, 0.0479, 0.0530, 0.0497, 0.0855, 0.1431, 0.0844, 0.1970, 0.2054,
        0.0861])
[rfa agg] iter:  3, prev_obj_val: 10500.578125, obj_val: 10298.74609375, abs dis: 201.83203125
[rfa agg] iter:  3, weight: tensor([0.0358, 0.0358, 0.0391, 0.0372, 0.0907, 0.1521, 0.0896, 0.2097, 0.2187,
        0.0913])
[rfa agg] iter:  4, prev_obj_val: 10298.74609375, obj_val: 10139.904296875, abs dis: 158.841796875
[rfa agg] iter:  4, weight: tensor([0.0263, 0.0263, 0.0285, 0.0273, 0.0947, 0.1591, 0.0935, 0.2198, 0.2292,
        0.0953])
[rfa agg] iter:  5, prev_obj_val: 10139.904296875, obj_val: 10018.6728515625, abs dis: 121.2314453125
[rfa agg] iter:  5, weight: tensor([0.0190, 0.0190, 0.0205, 0.0197, 0.0975, 0.1645, 0.0963, 0.2279, 0.2376,
        0.0981])
[rfa agg] iter:  6, prev_obj_val: 10018.6728515625, obj_val: 9928.138671875, abs dis: 90.5341796875
[rfa agg] iter:  6, weight: tensor([0.0135, 0.0135, 0.0145, 0.0140, 0.0993, 0.1684, 0.0980, 0.2344, 0.2444,
        0.0999])
[rfa agg] iter:  7, prev_obj_val: 9928.138671875, obj_val: 9864.4619140625, abs dis: 63.6767578125
[rfa agg] iter:  7, weight: tensor([0.0095, 0.0095, 0.0101, 0.0098, 0.1002, 0.1713, 0.0989, 0.2398, 0.2501,
        0.1008])
[rfa agg] iter:  8, prev_obj_val: 9864.4619140625, obj_val: 9818.4375, abs dis: 46.0244140625
[rfa agg] iter:  8, weight: tensor([0.0067, 0.0067, 0.0071, 0.0069, 0.1001, 0.1732, 0.0989, 0.2446, 0.2551,
        0.1007])
[rfa agg] iter:  9, prev_obj_val: 9818.4375, obj_val: 9783.1650390625, abs dis: 35.2724609375
[rfa agg] iter:  9, weight: tensor([0.0047, 0.0047, 0.0050, 0.0048, 0.0992, 0.1743, 0.0979, 0.2495, 0.2602,
        0.0998])
___Test Target_ResNet_18 poisoned: False, epoch: 256: Average loss: 1.7221, Accuracy: 5000/10000 (50.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 256: Average loss: 0.5846, Accuracy: 7620/9000 (84.6667%)
Done in 310.6116473674774 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:257 choose agents : [17, 33, 77, 11, 99, 56, 20, 0, 86, 37]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 17, internal_epoch   1,  Average loss: 0.0039, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 17, internal_epoch   2,  Average loss: 0.0032, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 17, internal_epoch   3,  Average loss: 0.0021, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 17, internal_epoch   4,  Average loss: 0.0022, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 17, internal_epoch   5,  Average loss: 0.0040, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 17, internal_epoch   6,  Average loss: 0.0032, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Global model norm: 39.62063295385452.
Norm before scaling: 39.897557111639834. Distance: 6.508360254652911
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 2.6567, Accuracy: 3969/10000 (39.6900%)
___Test Local_ResNet_18 poisoned: True, epoch: 257: Average loss: 0.2216, Accuracy: 8275/9000 (91.9444%)
Scaling by  100
Scaled Norm after poisoning: 650.4794145474551, distance: 650.8359528329701
Total norm for 4 adversaries is: 650.4794145474551. distance: 650.8359528329701
___Test Local_ResNet_18 poisoned: True, epoch: 257: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 33, internal_epoch   2,  Average loss: 0.0025, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 33, internal_epoch   3,  Average loss: 0.0017, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 33, internal_epoch   4,  Average loss: 0.0039, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 33, internal_epoch   5,  Average loss: 0.0025, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 33, internal_epoch   6,  Average loss: 0.0031, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Global model norm: 39.62063295385452.
Norm before scaling: 39.606764583606804. Distance: 4.817011712375028
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 2.3697, Accuracy: 3998/10000 (39.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 257: Average loss: 0.3774, Accuracy: 8037/9000 (89.3000%)
Scaling by  100
Scaled Norm after poisoning: 480.8072313828069, distance: 481.70116838658384
Total norm for 4 adversaries is: 480.8072313828069. distance: 481.70116838658384
___Test Local_ResNet_18 poisoned: True, epoch: 257: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 77, internal_epoch   1,  Average loss: 0.0026, Accuracy: 478/496 (96.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 77, internal_epoch   2,  Average loss: 0.0013, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 77, internal_epoch   3,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 77, internal_epoch   4,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 77, internal_epoch   5,  Average loss: 0.0007, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 39.62063295385452.
Norm before scaling: 39.390976731372916. Distance: 2.3647518910115033
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 1.7556, Accuracy: 4867/10000 (48.6700%)
___Test Local_ResNet_18 poisoned: True, epoch: 257: Average loss: 0.0966, Accuracy: 8732/9000 (97.0222%)
Scaling by  100
Scaled Norm after poisoning: 234.76913526909792, distance: 236.47517377623385
Total norm for 4 adversaries is: 234.76913526909792. distance: 236.47517377623385
___Test Local_ResNet_18 poisoned: True, epoch: 257: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 11, internal_epoch   1,  Average loss: 0.0030, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 11, internal_epoch   2,  Average loss: 0.0008, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 11, internal_epoch   3,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 11, internal_epoch   4,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 11, internal_epoch   5,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 11, internal_epoch   6,  Average loss: 0.0013, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 39.62063295385452.
Norm before scaling: 39.382002725507434. Distance: 2.919128759342939
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 1.9486, Accuracy: 4753/10000 (47.5300%)
___Test Local_ResNet_18 poisoned: True, epoch: 257: Average loss: 0.1217, Accuracy: 8701/9000 (96.6778%)
Scaling by  100
Scaled Norm after poisoning: 289.9061135738603, distance: 291.9128722752733
Total norm for 4 adversaries is: 289.9061135738603. distance: 291.9128722752733
___Test Local_ResNet_18 poisoned: True, epoch: 257: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 257, local model 99, internal_epoch   1,  Average loss: 0.0219, Accuracy: 238/391 (60.8696%)
___Train Local_ResNet_18,  epoch 257, local model 99, internal_epoch   2,  Average loss: 0.0161, Accuracy: 302/391 (77.2379%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 11.0011, Accuracy: 1345/10000 (13.4500%)
___Train Local_ResNet_18,  epoch 257, local model 56, internal_epoch   1,  Average loss: 0.0187, Accuracy: 491/743 (66.0834%)
___Train Local_ResNet_18,  epoch 257, local model 56, internal_epoch   2,  Average loss: 0.0085, Accuracy: 624/743 (83.9838%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 2.4193, Accuracy: 4434/10000 (44.3400%)
___Train Local_ResNet_18,  epoch 257, local model 20, internal_epoch   1,  Average loss: 0.0259, Accuracy: 210/362 (58.0110%)
___Train Local_ResNet_18,  epoch 257, local model 20, internal_epoch   2,  Average loss: 0.0083, Accuracy: 304/362 (83.9779%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 8.1030, Accuracy: 2251/10000 (22.5100%)
___Train Local_ResNet_18,  epoch 257, local model 0, internal_epoch   1,  Average loss: 0.0265, Accuracy: 188/367 (51.2262%)
___Train Local_ResNet_18,  epoch 257, local model 0, internal_epoch   2,  Average loss: 0.0067, Accuracy: 316/367 (86.1035%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 6.4562, Accuracy: 1619/10000 (16.1900%)
___Train Local_ResNet_18,  epoch 257, local model 86, internal_epoch   1,  Average loss: 0.0295, Accuracy: 106/212 (50.0000%)
___Train Local_ResNet_18,  epoch 257, local model 86, internal_epoch   2,  Average loss: 0.0082, Accuracy: 185/212 (87.2642%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 6.0536, Accuracy: 1987/10000 (19.8700%)
___Train Local_ResNet_18,  epoch 257, local model 37, internal_epoch   1,  Average loss: 0.0219, Accuracy: 433/725 (59.7241%)
___Train Local_ResNet_18,  epoch 257, local model 37, internal_epoch   2,  Average loss: 0.0125, Accuracy: 530/725 (73.1034%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 8.8553, Accuracy: 2371/10000 (23.7100%)
time spent on training: 249.10071539878845
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4279877425944842  data num: [526, 527, 496, 546, 391, 743, 362, 367, 212, 725]
[rfa agg] considering poison per batch poison_fraction: 0.03343654239019408
[rfa agg] init. name: [17, 33, 77, 11, 99, 56, 20, 0, 86, 37], weight: tensor([0.1075, 0.1077, 0.1013, 0.1115, 0.0799, 0.1518, 0.0740, 0.0750, 0.0433,
        0.1481])
[rfa agg] iter:  0, prev_obj_val: 11474.193359375, obj_val: 11237.455078125, abs dis: 236.73828125
[rfa agg] iter:  0, weight: tensor([0.0855, 0.0857, 0.0997, 0.0888, 0.0892, 0.1703, 0.0825, 0.0837, 0.0483,
        0.1662])
[rfa agg] iter:  1, prev_obj_val: 11237.455078125, obj_val: 11020.1337890625, abs dis: 217.3212890625
[rfa agg] iter:  1, weight: tensor([0.0705, 0.0707, 0.0803, 0.0733, 0.0983, 0.1877, 0.0909, 0.0921, 0.0531,
        0.1832])
[rfa agg] iter:  2, prev_obj_val: 11020.1337890625, obj_val: 10827.3486328125, abs dis: 192.78515625
[rfa agg] iter:  2, weight: tensor([0.0571, 0.0572, 0.0638, 0.0593, 0.1062, 0.2031, 0.0982, 0.0996, 0.0574,
        0.1982])
[rfa agg] iter:  3, prev_obj_val: 10827.3486328125, obj_val: 10662.3095703125, abs dis: 165.0390625
[rfa agg] iter:  3, weight: tensor([0.0454, 0.0455, 0.0501, 0.0471, 0.1130, 0.2165, 0.1044, 0.1059, 0.0610,
        0.2112])
[rfa agg] iter:  4, prev_obj_val: 10662.3095703125, obj_val: 10523.71875, abs dis: 138.5908203125
[rfa agg] iter:  4, weight: tensor([0.0356, 0.0357, 0.0389, 0.0370, 0.1186, 0.2276, 0.1096, 0.1111, 0.0639,
        0.2221])
[rfa agg] iter:  5, prev_obj_val: 10523.71875, obj_val: 10410.2724609375, abs dis: 113.4462890625
[rfa agg] iter:  5, weight: tensor([0.0275, 0.0276, 0.0298, 0.0286, 0.1231, 0.2370, 0.1137, 0.1152, 0.0662,
        0.2313])
[rfa agg] iter:  6, prev_obj_val: 10410.2724609375, obj_val: 10318.74609375, abs dis: 91.5263671875
[rfa agg] iter:  6, weight: tensor([0.0210, 0.0211, 0.0227, 0.0218, 0.1266, 0.2447, 0.1168, 0.1184, 0.0680,
        0.2388])
[rfa agg] iter:  7, prev_obj_val: 10318.74609375, obj_val: 10247.2041015625, abs dis: 71.5419921875
[rfa agg] iter:  7, weight: tensor([0.0158, 0.0159, 0.0170, 0.0165, 0.1293, 0.2512, 0.1192, 0.1208, 0.0692,
        0.2451])
[rfa agg] iter:  8, prev_obj_val: 10247.2041015625, obj_val: 10192.4267578125, abs dis: 54.77734375
[rfa agg] iter:  8, weight: tensor([0.0118, 0.0119, 0.0127, 0.0123, 0.1311, 0.2567, 0.1207, 0.1224, 0.0699,
        0.2505])
[rfa agg] iter:  9, prev_obj_val: 10192.4267578125, obj_val: 10150.5400390625, abs dis: 41.88671875
[rfa agg] iter:  9, weight: tensor([0.0088, 0.0088, 0.0094, 0.0091, 0.1323, 0.2616, 0.1215, 0.1232, 0.0701,
        0.2553])
___Test Target_ResNet_18 poisoned: False, epoch: 257: Average loss: 1.4696, Accuracy: 5473/10000 (54.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 257: Average loss: 0.4532, Accuracy: 7880/9000 (87.5556%)
Done in 325.292852640152 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:258 choose agents : [17, 33, 77, 11, 20, 36, 50, 78, 63, 37]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 17, internal_epoch   1,  Average loss: 0.0027, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 17, internal_epoch   2,  Average loss: 0.0018, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 17, internal_epoch   3,  Average loss: 0.0018, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 17, internal_epoch   4,  Average loss: 0.0025, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 17, internal_epoch   5,  Average loss: 0.0012, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 17, internal_epoch   6,  Average loss: 0.0019, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 39.49514006643333.
Norm before scaling: 39.38491783576154. Distance: 4.098644562877784
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 2.3884, Accuracy: 4302/10000 (43.0200%)
___Test Local_ResNet_18 poisoned: True, epoch: 258: Average loss: 0.3083, Accuracy: 8068/9000 (89.6444%)
Scaling by  100
Scaled Norm after poisoning: 408.6555892496761, distance: 409.8644974256736
Total norm for 4 adversaries is: 408.6555892496761. distance: 409.8644974256736
___Test Local_ResNet_18 poisoned: True, epoch: 258: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 33, internal_epoch   1,  Average loss: 0.0029, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 33, internal_epoch   2,  Average loss: 0.0016, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 33, internal_epoch   3,  Average loss: 0.0018, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 33, internal_epoch   4,  Average loss: 0.0017, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 33, internal_epoch   5,  Average loss: 0.0020, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 33, internal_epoch   6,  Average loss: 0.0023, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Global model norm: 39.49514006643333.
Norm before scaling: 39.41556690017917. Distance: 4.31712270460955
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 2.0353, Accuracy: 4615/10000 (46.1500%)
___Test Local_ResNet_18 poisoned: True, epoch: 258: Average loss: 0.1695, Accuracy: 8517/9000 (94.6333%)
Scaling by  100
Scaled Norm after poisoning: 430.6317307166298, distance: 431.7122522583764
Total norm for 4 adversaries is: 430.6317307166298. distance: 431.7122522583764
___Test Local_ResNet_18 poisoned: True, epoch: 258: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 77, internal_epoch   1,  Average loss: 0.0019, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 77, internal_epoch   2,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 77, internal_epoch   3,  Average loss: 0.0011, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 77, internal_epoch   5,  Average loss: 0.0006, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 39.49514006643333.
Norm before scaling: 39.23306044940367. Distance: 1.9535005742412237
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 1.7052, Accuracy: 5054/10000 (50.5400%)
___Test Local_ResNet_18 poisoned: True, epoch: 258: Average loss: 0.0710, Accuracy: 8781/9000 (97.5667%)
Scaling by  100
Scaled Norm after poisoning: 193.07139223613632, distance: 195.35007638531908
Total norm for 4 adversaries is: 193.07139223613632. distance: 195.35007638531908
___Test Local_ResNet_18 poisoned: True, epoch: 258: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 11, internal_epoch   1,  Average loss: 0.0024, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 11, internal_epoch   2,  Average loss: 0.0008, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 11, internal_epoch   3,  Average loss: 0.0010, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 11, internal_epoch   4,  Average loss: 0.0007, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 39.49514006643333.
Norm before scaling: 39.25724890764602. Distance: 2.9201689446578665
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 1.9948, Accuracy: 4958/10000 (49.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 258: Average loss: 0.2789, Accuracy: 8439/9000 (93.7667%)
Scaling by  100
Scaled Norm after poisoning: 290.01294421542633, distance: 292.01686862662575
Total norm for 4 adversaries is: 290.01294421542633. distance: 292.01686862662575
___Test Local_ResNet_18 poisoned: True, epoch: 258: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 258, local model 20, internal_epoch   1,  Average loss: 0.0248, Accuracy: 212/362 (58.5635%)
___Train Local_ResNet_18,  epoch 258, local model 20, internal_epoch   2,  Average loss: 0.0062, Accuracy: 317/362 (87.5691%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 8.1766, Accuracy: 1855/10000 (18.5500%)
___Train Local_ResNet_18,  epoch 258, local model 36, internal_epoch   1,  Average loss: 0.0243, Accuracy: 458/849 (53.9458%)
___Train Local_ResNet_18,  epoch 258, local model 36, internal_epoch   2,  Average loss: 0.0159, Accuracy: 556/849 (65.4888%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 2.6515, Accuracy: 3322/10000 (33.2200%)
___Train Local_ResNet_18,  epoch 258, local model 50, internal_epoch   1,  Average loss: 0.0183, Accuracy: 268/401 (66.8329%)
___Train Local_ResNet_18,  epoch 258, local model 50, internal_epoch   2,  Average loss: 0.0105, Accuracy: 333/401 (83.0424%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 4.2340, Accuracy: 2648/10000 (26.4800%)
___Train Local_ResNet_18,  epoch 258, local model 78, internal_epoch   1,  Average loss: 0.0246, Accuracy: 138/255 (54.1176%)
___Train Local_ResNet_18,  epoch 258, local model 78, internal_epoch   2,  Average loss: 0.0048, Accuracy: 234/255 (91.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 12.5541, Accuracy: 1940/10000 (19.4000%)
___Train Local_ResNet_18,  epoch 258, local model 63, internal_epoch   1,  Average loss: 0.0208, Accuracy: 463/752 (61.5691%)
___Train Local_ResNet_18,  epoch 258, local model 63, internal_epoch   2,  Average loss: 0.0109, Accuracy: 586/752 (77.9255%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 2.0231, Accuracy: 3985/10000 (39.8500%)
___Train Local_ResNet_18,  epoch 258, local model 37, internal_epoch   1,  Average loss: 0.0178, Accuracy: 500/725 (68.9655%)
___Train Local_ResNet_18,  epoch 258, local model 37, internal_epoch   2,  Average loss: 0.0103, Accuracy: 558/725 (76.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 4.9356, Accuracy: 2593/10000 (25.9300%)
time spent on training: 262.24456310272217
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3851810994668137  data num: [526, 527, 496, 546, 362, 849, 401, 255, 752, 725]
[rfa agg] considering poison per batch poison_fraction: 0.03009227339584482
[rfa agg] init. name: [17, 33, 77, 11, 20, 36, 50, 78, 63, 37], weight: tensor([0.0967, 0.0969, 0.0912, 0.1004, 0.0666, 0.1561, 0.0737, 0.0469, 0.1383,
        0.1333])
[rfa agg] iter:  0, prev_obj_val: 11090.8203125, obj_val: 10530.85546875, abs dis: 559.96484375
[rfa agg] iter:  0, weight: tensor([0.0675, 0.0676, 0.0775, 0.0701, 0.0773, 0.1827, 0.0857, 0.0543, 0.1615,
        0.1557])
[rfa agg] iter:  1, prev_obj_val: 10530.85546875, obj_val: 10073.6865234375, abs dis: 457.1689453125
[rfa agg] iter:  1, weight: tensor([0.0474, 0.0475, 0.0528, 0.0492, 0.0864, 0.2048, 0.0958, 0.0607, 0.1809,
        0.1744])
[rfa agg] iter:  2, prev_obj_val: 10073.6865234375, obj_val: 9728.5166015625, abs dis: 345.169921875
[rfa agg] iter:  2, weight: tensor([0.0321, 0.0321, 0.0351, 0.0333, 0.0931, 0.2217, 0.1033, 0.0653, 0.1956,
        0.1886])
[rfa agg] iter:  3, prev_obj_val: 9728.5166015625, obj_val: 9481.978515625, abs dis: 246.5380859375
[rfa agg] iter:  3, weight: tensor([0.0211, 0.0211, 0.0228, 0.0219, 0.0975, 0.2341, 0.1084, 0.0683, 0.2062,
        0.1988])
[rfa agg] iter:  4, prev_obj_val: 9481.978515625, obj_val: 9313.517578125, abs dis: 168.4609375
[rfa agg] iter:  4, weight: tensor([0.0135, 0.0135, 0.0145, 0.0140, 0.1001, 0.2434, 0.1114, 0.0699, 0.2136,
        0.2060])
[rfa agg] iter:  5, prev_obj_val: 9313.517578125, obj_val: 9204.6435546875, abs dis: 108.8740234375
[rfa agg] iter:  5, weight: tensor([0.0084, 0.0085, 0.0090, 0.0088, 0.1011, 0.2509, 0.1128, 0.0703, 0.2190,
        0.2112])
[rfa agg] iter:  6, prev_obj_val: 9204.6435546875, obj_val: 9133.7880859375, abs dis: 70.85546875
[rfa agg] iter:  6, weight: tensor([0.0053, 0.0053, 0.0056, 0.0055, 0.1005, 0.2578, 0.1126, 0.0693, 0.2231,
        0.2151])
[rfa agg] iter:  7, prev_obj_val: 9133.7880859375, obj_val: 9088.6298828125, abs dis: 45.158203125
[rfa agg] iter:  7, weight: tensor([0.0032, 0.0032, 0.0034, 0.0033, 0.0981, 0.2661, 0.1105, 0.0668, 0.2268,
        0.2186])
[rfa agg] iter:  8, prev_obj_val: 9088.6298828125, obj_val: 9059.9482421875, abs dis: 28.681640625
[rfa agg] iter:  8, weight: tensor([0.0019, 0.0019, 0.0020, 0.0020, 0.0930, 0.2782, 0.1059, 0.0622, 0.2306,
        0.2223])
[rfa agg] iter:  9, prev_obj_val: 9059.9482421875, obj_val: 9041.6630859375, abs dis: 18.28515625
[rfa agg] iter:  9, weight: tensor([0.0010, 0.0010, 0.0011, 0.0011, 0.0836, 0.3000, 0.0968, 0.0542, 0.2347,
        0.2263])
___Test Target_ResNet_18 poisoned: False, epoch: 258: Average loss: 1.4016, Accuracy: 5592/10000 (55.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 258: Average loss: 0.5860, Accuracy: 7499/9000 (83.3222%)
Done in 334.6645448207855 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:259 choose agents : [17, 33, 77, 11, 83, 4, 1, 0, 37, 91]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 17, internal_epoch   1,  Average loss: 0.0040, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 17, internal_epoch   3,  Average loss: 0.0035, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 17, internal_epoch   4,  Average loss: 0.0040, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 17, internal_epoch   5,  Average loss: 0.0039, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 17, internal_epoch   6,  Average loss: 0.0020, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Global model norm: 39.45478492795186.
Norm before scaling: 39.76630494261521. Distance: 6.611019137443525
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 2.4392, Accuracy: 3860/10000 (38.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 259: Average loss: 0.1329, Accuracy: 8588/9000 (95.4222%)
Scaling by  100
Scaled Norm after poisoning: 660.8401849161414, distance: 661.1019919422419
Total norm for 4 adversaries is: 660.8401849161414. distance: 661.1019919422419
___Test Local_ResNet_18 poisoned: True, epoch: 259: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 33, internal_epoch   2,  Average loss: 0.0009, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 33, internal_epoch   3,  Average loss: 0.0011, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 33, internal_epoch   4,  Average loss: 0.0016, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 33, internal_epoch   5,  Average loss: 0.0019, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 33, internal_epoch   6,  Average loss: 0.0018, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Global model norm: 39.45478492795186.
Norm before scaling: 39.22340609811315. Distance: 2.9943406448192893
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 2.1041, Accuracy: 4575/10000 (45.7500%)
___Test Local_ResNet_18 poisoned: True, epoch: 259: Average loss: 0.1377, Accuracy: 8627/9000 (95.8556%)
Scaling by  100
Scaled Norm after poisoning: 297.4901915399901, distance: 299.4341016818225
Total norm for 4 adversaries is: 297.4901915399901. distance: 299.4341016818225
___Test Local_ResNet_18 poisoned: True, epoch: 259: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 77, internal_epoch   1,  Average loss: 0.0021, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 77, internal_epoch   2,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 77, internal_epoch   3,  Average loss: 0.0006, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 39.45478492795186.
Norm before scaling: 39.20678664645478. Distance: 2.016812115407928
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 1.7063, Accuracy: 5134/10000 (51.3400%)
___Test Local_ResNet_18 poisoned: True, epoch: 259: Average loss: 0.0450, Accuracy: 8847/9000 (98.3000%)
Scaling by  100
Scaled Norm after poisoning: 199.68582745778428, distance: 201.68120535575446
Total norm for 4 adversaries is: 199.68582745778428. distance: 201.68120535575446
___Test Local_ResNet_18 poisoned: True, epoch: 259: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 11, internal_epoch   1,  Average loss: 0.0024, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 11, internal_epoch   2,  Average loss: 0.0008, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 11, internal_epoch   3,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 11, internal_epoch   4,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 39.45478492795186.
Norm before scaling: 39.200222839967694. Distance: 2.6095329739383506
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 1.9283, Accuracy: 4926/10000 (49.2600%)
___Test Local_ResNet_18 poisoned: True, epoch: 259: Average loss: 0.0962, Accuracy: 8747/9000 (97.1889%)
Scaling by  100
Scaled Norm after poisoning: 258.7857916066877, distance: 260.95330041982606
Total norm for 4 adversaries is: 258.7857916066877. distance: 260.95330041982606
___Test Local_ResNet_18 poisoned: True, epoch: 259: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 259, local model 83, internal_epoch   1,  Average loss: 0.0229, Accuracy: 205/366 (56.0109%)
___Train Local_ResNet_18,  epoch 259, local model 83, internal_epoch   2,  Average loss: 0.0072, Accuracy: 319/366 (87.1585%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 2.9726, Accuracy: 3682/10000 (36.8200%)
___Train Local_ResNet_18,  epoch 259, local model 4, internal_epoch   1,  Average loss: 0.0200, Accuracy: 372/557 (66.7864%)
___Train Local_ResNet_18,  epoch 259, local model 4, internal_epoch   2,  Average loss: 0.0072, Accuracy: 470/557 (84.3806%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 4.4404, Accuracy: 3275/10000 (32.7500%)
___Train Local_ResNet_18,  epoch 259, local model 1, internal_epoch   1,  Average loss: 0.0215, Accuracy: 397/641 (61.9345%)
___Train Local_ResNet_18,  epoch 259, local model 1, internal_epoch   2,  Average loss: 0.0140, Accuracy: 479/641 (74.7270%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 4.3079, Accuracy: 2976/10000 (29.7600%)
___Train Local_ResNet_18,  epoch 259, local model 0, internal_epoch   1,  Average loss: 0.0218, Accuracy: 215/367 (58.5831%)
___Train Local_ResNet_18,  epoch 259, local model 0, internal_epoch   2,  Average loss: 0.0053, Accuracy: 330/367 (89.9183%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 4.1233, Accuracy: 2482/10000 (24.8200%)
___Train Local_ResNet_18,  epoch 259, local model 37, internal_epoch   1,  Average loss: 0.0169, Accuracy: 488/725 (67.3103%)
___Train Local_ResNet_18,  epoch 259, local model 37, internal_epoch   2,  Average loss: 0.0081, Accuracy: 610/725 (84.1379%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 4.7010, Accuracy: 2214/10000 (22.1400%)
___Train Local_ResNet_18,  epoch 259, local model 91, internal_epoch   1,  Average loss: 0.0254, Accuracy: 131/234 (55.9829%)
___Train Local_ResNet_18,  epoch 259, local model 91, internal_epoch   2,  Average loss: 0.0032, Accuracy: 223/234 (95.2991%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 7.4883, Accuracy: 1919/10000 (19.1900%)
time spent on training: 247.42830419540405
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4202607823470411  data num: [526, 527, 496, 546, 366, 557, 641, 367, 725, 234]
[rfa agg] considering poison per batch poison_fraction: 0.03283287362086259
[rfa agg] init. name: [17, 33, 77, 11, 83, 4, 1, 0, 37, 91], weight: tensor([0.1055, 0.1057, 0.0995, 0.1095, 0.0734, 0.1117, 0.1286, 0.0736, 0.1454,
        0.0469])
[rfa agg] iter:  0, prev_obj_val: 11417.5927734375, obj_val: 11131.291015625, abs dis: 286.3017578125
[rfa agg] iter:  0, weight: tensor([0.0821, 0.0823, 0.0954, 0.0853, 0.0827, 0.1262, 0.1455, 0.0829, 0.1647,
        0.0528])
[rfa agg] iter:  1, prev_obj_val: 11131.291015625, obj_val: 10872.888671875, abs dis: 258.40234375
[rfa agg] iter:  1, weight: tensor([0.0659, 0.0661, 0.0747, 0.0685, 0.0915, 0.1397, 0.1611, 0.0917, 0.1824,
        0.0584])
[rfa agg] iter:  2, prev_obj_val: 10872.888671875, obj_val: 10648.0654296875, abs dis: 224.8232421875
[rfa agg] iter:  2, weight: tensor([0.0518, 0.0519, 0.0576, 0.0538, 0.0990, 0.1513, 0.1746, 0.0992, 0.1977,
        0.0631])
[rfa agg] iter:  3, prev_obj_val: 10648.0654296875, obj_val: 10461.7978515625, abs dis: 186.267578125
[rfa agg] iter:  3, weight: tensor([0.0398, 0.0399, 0.0437, 0.0414, 0.1052, 0.1610, 0.1859, 0.1055, 0.2106,
        0.0670])
[rfa agg] iter:  4, prev_obj_val: 10461.7978515625, obj_val: 10311.939453125, abs dis: 149.8583984375
[rfa agg] iter:  4, weight: tensor([0.0302, 0.0302, 0.0328, 0.0313, 0.1101, 0.1687, 0.1951, 0.1104, 0.2212,
        0.0701])
[rfa agg] iter:  5, prev_obj_val: 10311.939453125, obj_val: 10193.484375, abs dis: 118.455078125
[rfa agg] iter:  5, weight: tensor([0.0225, 0.0226, 0.0244, 0.0234, 0.1138, 0.1748, 0.2024, 0.1141, 0.2296,
        0.0723])
[rfa agg] iter:  6, prev_obj_val: 10193.484375, obj_val: 10101.4365234375, abs dis: 92.0478515625
[rfa agg] iter:  6, weight: tensor([0.0166, 0.0167, 0.0179, 0.0173, 0.1165, 0.1795, 0.2083, 0.1168, 0.2366,
        0.0739])
[rfa agg] iter:  7, prev_obj_val: 10101.4365234375, obj_val: 10032.2275390625, abs dis: 69.208984375
[rfa agg] iter:  7, weight: tensor([0.0121, 0.0121, 0.0130, 0.0126, 0.1183, 0.1831, 0.2131, 0.1186, 0.2424,
        0.0748])
[rfa agg] iter:  8, prev_obj_val: 10032.2275390625, obj_val: 9980.142578125, abs dis: 52.0849609375
[rfa agg] iter:  8, weight: tensor([0.0087, 0.0087, 0.0093, 0.0091, 0.1192, 0.1857, 0.2171, 0.1195, 0.2475,
        0.0751])
[rfa agg] iter:  9, prev_obj_val: 9980.142578125, obj_val: 9941.62109375, abs dis: 38.521484375
[rfa agg] iter:  9, weight: tensor([0.0062, 0.0062, 0.0066, 0.0064, 0.1193, 0.1876, 0.2207, 0.1197, 0.2525,
        0.0747])
___Test Target_ResNet_18 poisoned: False, epoch: 259: Average loss: 1.3415, Accuracy: 5668/10000 (56.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 259: Average loss: 0.4424, Accuracy: 7885/9000 (87.6111%)
Done in 314.8183808326721 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:260 choose agents : [17, 33, 77, 11, 21, 13, 70, 54, 57, 41]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 17, internal_epoch   1,  Average loss: 0.0029, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 17, internal_epoch   2,  Average loss: 0.0020, Accuracy: 508/526 (96.5779%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 17, internal_epoch   3,  Average loss: 0.0012, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 17, internal_epoch   4,  Average loss: 0.0019, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 17, internal_epoch   5,  Average loss: 0.0024, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 17, internal_epoch   6,  Average loss: 0.0016, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Global model norm: 39.35647195526582.
Norm before scaling: 39.14176021307837. Distance: 3.259579113195172
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 2.2523, Accuracy: 4469/10000 (44.6900%)
___Test Local_ResNet_18 poisoned: True, epoch: 260: Average loss: 0.2248, Accuracy: 8327/9000 (92.5222%)
Scaling by  100
Scaled Norm after poisoning: 324.11352659986284, distance: 325.9578912605124
Total norm for 4 adversaries is: 324.11352659986284. distance: 325.9578912605124
___Test Local_ResNet_18 poisoned: True, epoch: 260: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 33, internal_epoch   1,  Average loss: 0.0019, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 33, internal_epoch   2,  Average loss: 0.0012, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 33, internal_epoch   3,  Average loss: 0.0013, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 33, internal_epoch   4,  Average loss: 0.0012, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 33, internal_epoch   5,  Average loss: 0.0016, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 33, internal_epoch   6,  Average loss: 0.0019, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 39.35647195526582.
Norm before scaling: 39.18278823099101. Distance: 3.612884268732921
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 2.0950, Accuracy: 4575/10000 (45.7500%)
___Test Local_ResNet_18 poisoned: True, epoch: 260: Average loss: 0.1342, Accuracy: 8574/9000 (95.2667%)
Scaling by  100
Scaled Norm after poisoning: 359.73449410641734, distance: 361.28843869891546
Total norm for 4 adversaries is: 359.73449410641734. distance: 361.28843869891546
___Test Local_ResNet_18 poisoned: True, epoch: 260: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 77, internal_epoch   1,  Average loss: 0.0016, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 77, internal_epoch   3,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 77, internal_epoch   4,  Average loss: 0.0007, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 39.35647195526582.
Norm before scaling: 39.09487564576479. Distance: 1.782595611404911
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 1.5497, Accuracy: 5366/10000 (53.6600%)
___Test Local_ResNet_18 poisoned: True, epoch: 260: Average loss: 0.1042, Accuracy: 8723/9000 (96.9222%)
Scaling by  100
Scaled Norm after poisoning: 175.9413631902686, distance: 178.25955992070945
Total norm for 4 adversaries is: 175.9413631902686. distance: 178.25955992070945
___Test Local_ResNet_18 poisoned: True, epoch: 260: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 11, internal_epoch   1,  Average loss: 0.0021, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 11, internal_epoch   2,  Average loss: 0.0009, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 11, internal_epoch   3,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 11, internal_epoch   4,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 11, internal_epoch   5,  Average loss: 0.0007, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 39.35647195526582.
Norm before scaling: 39.071153728946086. Distance: 2.317363058939198
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 1.8029, Accuracy: 5009/10000 (50.0900%)
___Test Local_ResNet_18 poisoned: True, epoch: 260: Average loss: 0.0938, Accuracy: 8717/9000 (96.8556%)
Scaling by  100
Scaled Norm after poisoning: 229.0763126804035, distance: 231.7362961158653
Total norm for 4 adversaries is: 229.0763126804035. distance: 231.7362961158653
___Test Local_ResNet_18 poisoned: True, epoch: 260: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 260, local model 21, internal_epoch   1,  Average loss: 0.0225, Accuracy: 165/262 (62.9771%)
___Train Local_ResNet_18,  epoch 260, local model 21, internal_epoch   2,  Average loss: 0.0093, Accuracy: 218/262 (83.2061%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 7.7022, Accuracy: 2456/10000 (24.5600%)
___Train Local_ResNet_18,  epoch 260, local model 13, internal_epoch   1,  Average loss: 0.0203, Accuracy: 410/620 (66.1290%)
___Train Local_ResNet_18,  epoch 260, local model 13, internal_epoch   2,  Average loss: 0.0082, Accuracy: 531/620 (85.6452%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 5.2347, Accuracy: 2256/10000 (22.5600%)
___Train Local_ResNet_18,  epoch 260, local model 70, internal_epoch   1,  Average loss: 0.0204, Accuracy: 403/610 (66.0656%)
___Train Local_ResNet_18,  epoch 260, local model 70, internal_epoch   2,  Average loss: 0.0096, Accuracy: 497/610 (81.4754%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 3.1712, Accuracy: 3450/10000 (34.5000%)
___Train Local_ResNet_18,  epoch 260, local model 54, internal_epoch   1,  Average loss: 0.0195, Accuracy: 285/440 (64.7727%)
___Train Local_ResNet_18,  epoch 260, local model 54, internal_epoch   2,  Average loss: 0.0100, Accuracy: 363/440 (82.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 9.9998, Accuracy: 2292/10000 (22.9200%)
___Train Local_ResNet_18,  epoch 260, local model 57, internal_epoch   1,  Average loss: 0.0189, Accuracy: 173/290 (59.6552%)
___Train Local_ResNet_18,  epoch 260, local model 57, internal_epoch   2,  Average loss: 0.0046, Accuracy: 266/290 (91.7241%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 4.8788, Accuracy: 3606/10000 (36.0600%)
___Train Local_ResNet_18,  epoch 260, local model 41, internal_epoch   1,  Average loss: 0.0210, Accuracy: 328/513 (63.9376%)
___Train Local_ResNet_18,  epoch 260, local model 41, internal_epoch   2,  Average loss: 0.0100, Accuracy: 428/513 (83.4308%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 3.5087, Accuracy: 2970/10000 (29.7000%)
time spent on training: 251.3165407180786
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4337474120082816  data num: [526, 527, 496, 546, 262, 620, 610, 440, 290, 513]
[rfa agg] considering poison per batch poison_fraction: 0.033886516563147
[rfa agg] init. name: [17, 33, 77, 11, 21, 13, 70, 54, 57, 41], weight: tensor([0.1089, 0.1091, 0.1027, 0.1130, 0.0542, 0.1284, 0.1263, 0.0911, 0.0600,
        0.1062])
[rfa agg] iter:  0, prev_obj_val: 11513.1142578125, obj_val: 11310.888671875, abs dis: 202.2255859375
[rfa agg] iter:  0, weight: tensor([0.0881, 0.0883, 0.1029, 0.0915, 0.0601, 0.1429, 0.1406, 0.1011, 0.0665,
        0.1181])
[rfa agg] iter:  1, prev_obj_val: 11310.888671875, obj_val: 11123.5146484375, abs dis: 187.3740234375
[rfa agg] iter:  1, weight: tensor([0.0740, 0.0742, 0.0845, 0.0769, 0.0659, 0.1568, 0.1543, 0.1109, 0.0730,
        0.1296])
[rfa agg] iter:  2, prev_obj_val: 11123.5146484375, obj_val: 10953.943359375, abs dis: 169.5712890625
[rfa agg] iter:  2, weight: tensor([0.0612, 0.0613, 0.0686, 0.0635, 0.0711, 0.1693, 0.1666, 0.1197, 0.0787,
        0.1399])
[rfa agg] iter:  3, prev_obj_val: 10953.943359375, obj_val: 10804.54296875, abs dis: 149.400390625
[rfa agg] iter:  3, weight: tensor([0.0498, 0.0499, 0.0551, 0.0517, 0.0756, 0.1803, 0.1774, 0.1274, 0.0837,
        0.1490])
[rfa agg] iter:  4, prev_obj_val: 10804.54296875, obj_val: 10676.4912109375, abs dis: 128.0517578125
[rfa agg] iter:  4, weight: tensor([0.0400, 0.0400, 0.0438, 0.0415, 0.0795, 0.1898, 0.1867, 0.1340, 0.0880,
        0.1568])
[rfa agg] iter:  5, prev_obj_val: 10676.4912109375, obj_val: 10568.599609375, abs dis: 107.8916015625
[rfa agg] iter:  5, weight: tensor([0.0317, 0.0317, 0.0344, 0.0329, 0.0826, 0.1978, 0.1946, 0.1394, 0.0915,
        0.1633])
[rfa agg] iter:  6, prev_obj_val: 10568.599609375, obj_val: 10482.05078125, abs dis: 86.548828125
[rfa agg] iter:  6, weight: tensor([0.0248, 0.0248, 0.0268, 0.0257, 0.0852, 0.2046, 0.2013, 0.1439, 0.0943,
        0.1688])
[rfa agg] iter:  7, prev_obj_val: 10482.05078125, obj_val: 10412.1064453125, abs dis: 69.9443359375
[rfa agg] iter:  7, weight: tensor([0.0193, 0.0193, 0.0208, 0.0200, 0.0871, 0.2100, 0.2066, 0.1474, 0.0964,
        0.1731])
[rfa agg] iter:  8, prev_obj_val: 10412.1064453125, obj_val: 10355.19921875, abs dis: 56.9072265625
[rfa agg] iter:  8, weight: tensor([0.0149, 0.0150, 0.0160, 0.0155, 0.0885, 0.2145, 0.2110, 0.1500, 0.0979,
        0.1766])
[rfa agg] iter:  9, prev_obj_val: 10355.19921875, obj_val: 10310.1533203125, abs dis: 45.0458984375
[rfa agg] iter:  9, weight: tensor([0.0114, 0.0114, 0.0122, 0.0118, 0.0894, 0.2184, 0.2148, 0.1520, 0.0990,
        0.1795])
___Test Target_ResNet_18 poisoned: False, epoch: 260: Average loss: 1.2915, Accuracy: 5804/10000 (58.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 260: Average loss: 0.2905, Accuracy: 8242/9000 (91.5778%)
Done in 317.89224886894226 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:261 choose agents : [17, 33, 77, 11, 28, 85, 59, 89, 31, 42]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 17, internal_epoch   1,  Average loss: 0.0020, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 17, internal_epoch   2,  Average loss: 0.0019, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 17, internal_epoch   3,  Average loss: 0.0024, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 17, internal_epoch   4,  Average loss: 0.0038, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 17, internal_epoch   5,  Average loss: 0.0043, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 17, internal_epoch   6,  Average loss: 0.0029, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Global model norm: 39.178451345155125.
Norm before scaling: 39.32291476959156. Distance: 5.837438101920225
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 3.5527, Accuracy: 3191/10000 (31.9100%)
___Test Local_ResNet_18 poisoned: True, epoch: 261: Average loss: 0.2809, Accuracy: 8173/9000 (90.8111%)
Scaling by  100
Scaled Norm after poisoning: 583.110758132621, distance: 583.7438168837423
Total norm for 4 adversaries is: 583.110758132621. distance: 583.7438168837423
___Test Local_ResNet_18 poisoned: True, epoch: 261: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 33, internal_epoch   1,  Average loss: 0.0021, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 33, internal_epoch   2,  Average loss: 0.0011, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 33, internal_epoch   3,  Average loss: 0.0022, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 33, internal_epoch   4,  Average loss: 0.0019, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 33, internal_epoch   5,  Average loss: 0.0021, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 33, internal_epoch   6,  Average loss: 0.0025, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Global model norm: 39.178451345155125.
Norm before scaling: 39.01951384804147. Distance: 3.696546546101195
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 1.8947, Accuracy: 4704/10000 (47.0400%)
___Test Local_ResNet_18 poisoned: True, epoch: 261: Average loss: 0.1007, Accuracy: 8692/9000 (96.5778%)
Scaling by  100
Scaled Norm after poisoning: 368.19857074681863, distance: 369.6546318863055
Total norm for 4 adversaries is: 368.19857074681863. distance: 369.6546318863055
___Test Local_ResNet_18 poisoned: True, epoch: 261: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 77, internal_epoch   1,  Average loss: 0.0016, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 77, internal_epoch   2,  Average loss: 0.0007, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 77, internal_epoch   3,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 77, internal_epoch   4,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 39.178451345155125.
Norm before scaling: 38.91995240634937. Distance: 1.9077120942759174
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 1.6257, Accuracy: 5263/10000 (52.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 261: Average loss: 0.1114, Accuracy: 8706/9000 (96.7333%)
Scaling by  100
Scaled Norm after poisoning: 188.53600244714536, distance: 190.7712041785919
Total norm for 4 adversaries is: 188.53600244714536. distance: 190.7712041785919
___Test Local_ResNet_18 poisoned: True, epoch: 261: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 11, internal_epoch   2,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 11, internal_epoch   3,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 11, internal_epoch   4,  Average loss: 0.0006, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 11, internal_epoch   5,  Average loss: 0.0001, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 39.178451345155125.
Norm before scaling: 38.857691207991564. Distance: 1.8500936613344305
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 1.8083, Accuracy: 5086/10000 (50.8600%)
___Test Local_ResNet_18 poisoned: True, epoch: 261: Average loss: 0.0781, Accuracy: 8782/9000 (97.5778%)
Scaling by  100
Scaled Norm after poisoning: 181.433258648325, distance: 185.00936420557204
Total norm for 4 adversaries is: 181.433258648325. distance: 185.00936420557204
___Test Local_ResNet_18 poisoned: True, epoch: 261: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 261, local model 28, internal_epoch   1,  Average loss: 0.0207, Accuracy: 263/423 (62.1749%)
___Train Local_ResNet_18,  epoch 261, local model 28, internal_epoch   2,  Average loss: 0.0077, Accuracy: 364/423 (86.0520%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 2.5678, Accuracy: 3478/10000 (34.7800%)
___Train Local_ResNet_18,  epoch 261, local model 85, internal_epoch   1,  Average loss: 0.0290, Accuracy: 180/364 (49.4505%)
___Train Local_ResNet_18,  epoch 261, local model 85, internal_epoch   2,  Average loss: 0.0103, Accuracy: 286/364 (78.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 5.8970, Accuracy: 2032/10000 (20.3200%)
___Train Local_ResNet_18,  epoch 261, local model 59, internal_epoch   1,  Average loss: 0.0182, Accuracy: 439/642 (68.3801%)
___Train Local_ResNet_18,  epoch 261, local model 59, internal_epoch   2,  Average loss: 0.0157, Accuracy: 498/642 (77.5701%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 9.8279, Accuracy: 1881/10000 (18.8100%)
___Train Local_ResNet_18,  epoch 261, local model 89, internal_epoch   1,  Average loss: 0.0207, Accuracy: 259/413 (62.7119%)
___Train Local_ResNet_18,  epoch 261, local model 89, internal_epoch   2,  Average loss: 0.0077, Accuracy: 352/413 (85.2300%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 7.6556, Accuracy: 2131/10000 (21.3100%)
___Train Local_ResNet_18,  epoch 261, local model 31, internal_epoch   1,  Average loss: 0.0221, Accuracy: 452/706 (64.0227%)
___Train Local_ResNet_18,  epoch 261, local model 31, internal_epoch   2,  Average loss: 0.0128, Accuracy: 542/706 (76.7705%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 2.9621, Accuracy: 3454/10000 (34.5400%)
___Train Local_ResNet_18,  epoch 261, local model 42, internal_epoch   1,  Average loss: 0.0370, Accuracy: 114/198 (57.5758%)
___Train Local_ResNet_18,  epoch 261, local model 42, internal_epoch   2,  Average loss: 0.0084, Accuracy: 165/198 (83.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 10.6065, Accuracy: 1571/10000 (15.7100%)
time spent on training: 240.483745098114
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.432761826068994  data num: [526, 527, 496, 546, 423, 364, 642, 413, 706, 198]
[rfa agg] considering poison per batch poison_fraction: 0.03380951766164016
[rfa agg] init. name: [17, 33, 77, 11, 28, 85, 59, 89, 31, 42], weight: tensor([0.1087, 0.1089, 0.1025, 0.1128, 0.0874, 0.0752, 0.1326, 0.0853, 0.1458,
        0.0409])
[rfa agg] iter:  0, prev_obj_val: 11505.078125, obj_val: 11299.15625, abs dis: 205.921875
[rfa agg] iter:  0, weight: tensor([0.0876, 0.0878, 0.1023, 0.0910, 0.0971, 0.0835, 0.1479, 0.0948, 0.1627,
        0.0453])
[rfa agg] iter:  1, prev_obj_val: 11299.15625, obj_val: 11106.52734375, abs dis: 192.62890625
[rfa agg] iter:  1, weight: tensor([0.0735, 0.0737, 0.0839, 0.0764, 0.1065, 0.0915, 0.1623, 0.1039, 0.1786,
        0.0497])
[rfa agg] iter:  2, prev_obj_val: 11106.52734375, obj_val: 10932.5810546875, abs dis: 173.9462890625
[rfa agg] iter:  2, weight: tensor([0.0606, 0.0607, 0.0679, 0.0629, 0.1149, 0.0988, 0.1753, 0.1122, 0.1930,
        0.0536])
[rfa agg] iter:  3, prev_obj_val: 10932.5810546875, obj_val: 10780.3193359375, abs dis: 152.26171875
[rfa agg] iter:  3, weight: tensor([0.0491, 0.0492, 0.0543, 0.0510, 0.1223, 0.1051, 0.1868, 0.1194, 0.2057,
        0.0570])
[rfa agg] iter:  4, prev_obj_val: 10780.3193359375, obj_val: 10650.9345703125, abs dis: 129.384765625
[rfa agg] iter:  4, weight: tensor([0.0393, 0.0393, 0.0430, 0.0408, 0.1286, 0.1104, 0.1966, 0.1255, 0.2166,
        0.0598])
[rfa agg] iter:  5, prev_obj_val: 10650.9345703125, obj_val: 10542.021484375, abs dis: 108.9130859375
[rfa agg] iter:  5, weight: tensor([0.0310, 0.0311, 0.0337, 0.0322, 0.1337, 0.1148, 0.2049, 0.1306, 0.2259,
        0.0622])
[rfa agg] iter:  6, prev_obj_val: 10542.021484375, obj_val: 10452.96484375, abs dis: 89.056640625
[rfa agg] iter:  6, weight: tensor([0.0242, 0.0242, 0.0261, 0.0251, 0.1379, 0.1183, 0.2118, 0.1346, 0.2337,
        0.0640])
[rfa agg] iter:  7, prev_obj_val: 10452.96484375, obj_val: 10381.3642578125, abs dis: 71.6005859375
[rfa agg] iter:  7, weight: tensor([0.0187, 0.0187, 0.0201, 0.0194, 0.1412, 0.1210, 0.2176, 0.1378, 0.2402,
        0.0653])
[rfa agg] iter:  8, prev_obj_val: 10381.3642578125, obj_val: 10325.4072265625, abs dis: 55.95703125
[rfa agg] iter:  8, weight: tensor([0.0143, 0.0143, 0.0153, 0.0148, 0.1436, 0.1230, 0.2224, 0.1402, 0.2458,
        0.0662])
[rfa agg] iter:  9, prev_obj_val: 10325.4072265625, obj_val: 10280.8876953125, abs dis: 44.51953125
[rfa agg] iter:  9, weight: tensor([0.0109, 0.0109, 0.0116, 0.0113, 0.1453, 0.1242, 0.2265, 0.1419, 0.2507,
        0.0667])
___Test Target_ResNet_18 poisoned: False, epoch: 261: Average loss: 1.2813, Accuracy: 5902/10000 (59.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 261: Average loss: 0.2739, Accuracy: 8272/9000 (91.9111%)
Done in 308.4943506717682 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:262 choose agents : [17, 33, 77, 11, 82, 68, 37, 47, 73, 15]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 17, internal_epoch   1,  Average loss: 0.0021, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 17, internal_epoch   2,  Average loss: 0.0010, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 17, internal_epoch   3,  Average loss: 0.0018, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 17, internal_epoch   4,  Average loss: 0.0012, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 17, internal_epoch   5,  Average loss: 0.0022, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 17, internal_epoch   6,  Average loss: 0.0008, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Global model norm: 39.01771025915267.
Norm before scaling: 38.726876921509565. Distance: 2.458861719879549
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 1.7481, Accuracy: 5072/10000 (50.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 262: Average loss: 0.1496, Accuracy: 8525/9000 (94.7222%)
Scaling by  100
Scaled Norm after poisoning: 243.1393070983176, distance: 245.88620017703312
Total norm for 4 adversaries is: 243.1393070983176. distance: 245.88620017703312
___Test Local_ResNet_18 poisoned: True, epoch: 262: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 33, internal_epoch   1,  Average loss: 0.0017, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 33, internal_epoch   2,  Average loss: 0.0009, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 33, internal_epoch   3,  Average loss: 0.0006, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 33, internal_epoch   4,  Average loss: 0.0011, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 33, internal_epoch   5,  Average loss: 0.0009, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 33, internal_epoch   6,  Average loss: 0.0016, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Global model norm: 39.01771025915267.
Norm before scaling: 38.70984878009891. Distance: 2.0645045163083724
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 1.6960, Accuracy: 5257/10000 (52.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 262: Average loss: 0.1247, Accuracy: 8604/9000 (95.6000%)
Scaling by  100
Scaled Norm after poisoning: 203.2856191882495, distance: 206.4504612945924
Total norm for 4 adversaries is: 203.2856191882495. distance: 206.4504612945924
___Test Local_ResNet_18 poisoned: True, epoch: 262: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 77, internal_epoch   1,  Average loss: 0.0012, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 77, internal_epoch   3,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 39.01771025915267.
Norm before scaling: 38.744097647758714. Distance: 1.6256385428961933
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 1.5438, Accuracy: 5353/10000 (53.5300%)
___Test Local_ResNet_18 poisoned: True, epoch: 262: Average loss: 0.0809, Accuracy: 8776/9000 (97.5111%)
Scaling by  100
Scaled Norm after poisoning: 159.8669857256338, distance: 162.56383361621366
Total norm for 4 adversaries is: 159.8669857256338. distance: 162.56383361621366
___Test Local_ResNet_18 poisoned: True, epoch: 262: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 11, internal_epoch   1,  Average loss: 0.0011, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 11, internal_epoch   2,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 11, internal_epoch   3,  Average loss: 0.0003, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 11, internal_epoch   4,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 11, internal_epoch   6,  Average loss: 0.0001, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Global model norm: 39.01771025915267.
Norm before scaling: 38.695663453637636. Distance: 1.7599770337470364
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 1.7725, Accuracy: 5191/10000 (51.9100%)
___Test Local_ResNet_18 poisoned: True, epoch: 262: Average loss: 0.0950, Accuracy: 8747/9000 (97.1889%)
Scaling by  100
Scaled Norm after poisoning: 172.29368889885376, distance: 175.99771394111914
Total norm for 4 adversaries is: 172.29368889885376. distance: 175.99771394111914
___Test Local_ResNet_18 poisoned: True, epoch: 262: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 262, local model 82, internal_epoch   1,  Average loss: 0.0162, Accuracy: 430/601 (71.5474%)
___Train Local_ResNet_18,  epoch 262, local model 82, internal_epoch   2,  Average loss: 0.0078, Accuracy: 508/601 (84.5258%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 3.6182, Accuracy: 3175/10000 (31.7500%)
___Train Local_ResNet_18,  epoch 262, local model 68, internal_epoch   1,  Average loss: 0.0220, Accuracy: 250/416 (60.0962%)
___Train Local_ResNet_18,  epoch 262, local model 68, internal_epoch   2,  Average loss: 0.0078, Accuracy: 348/416 (83.6538%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 4.2214, Accuracy: 2709/10000 (27.0900%)
___Train Local_ResNet_18,  epoch 262, local model 37, internal_epoch   1,  Average loss: 0.0172, Accuracy: 495/725 (68.2759%)
___Train Local_ResNet_18,  epoch 262, local model 37, internal_epoch   2,  Average loss: 0.0108, Accuracy: 563/725 (77.6552%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 4.7133, Accuracy: 2699/10000 (26.9900%)
___Train Local_ResNet_18,  epoch 262, local model 47, internal_epoch   1,  Average loss: 0.0199, Accuracy: 451/654 (68.9602%)
___Train Local_ResNet_18,  epoch 262, local model 47, internal_epoch   2,  Average loss: 0.0111, Accuracy: 514/654 (78.5933%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 4.0188, Accuracy: 2549/10000 (25.4900%)
___Train Local_ResNet_18,  epoch 262, local model 73, internal_epoch   1,  Average loss: 0.0226, Accuracy: 324/500 (64.8000%)
___Train Local_ResNet_18,  epoch 262, local model 73, internal_epoch   2,  Average loss: 0.0113, Accuracy: 418/500 (83.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 10.4616, Accuracy: 1901/10000 (19.0100%)
___Train Local_ResNet_18,  epoch 262, local model 15, internal_epoch   1,  Average loss: 0.0225, Accuracy: 220/341 (64.5161%)
___Train Local_ResNet_18,  epoch 262, local model 15, internal_epoch   2,  Average loss: 0.0093, Accuracy: 291/341 (85.3372%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 5.1375, Accuracy: 2587/10000 (25.8700%)
time spent on training: 247.0867486000061
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3929107276819205  data num: [526, 527, 496, 546, 601, 416, 725, 654, 500, 341]
[rfa agg] considering poison per batch poison_fraction: 0.03069615060015004
[rfa agg] init. name: [17, 33, 77, 11, 82, 68, 37, 47, 73, 15], weight: tensor([0.0986, 0.0988, 0.0930, 0.1024, 0.1127, 0.0780, 0.1360, 0.1227, 0.0938,
        0.0640])
[rfa agg] iter:  0, prev_obj_val: 11172.876953125, obj_val: 10678.5244140625, abs dis: 494.3525390625
[rfa agg] iter:  0, weight: tensor([0.0706, 0.0707, 0.0812, 0.0733, 0.1308, 0.0903, 0.1581, 0.1425, 0.1086,
        0.0739])
[rfa agg] iter:  1, prev_obj_val: 10678.5244140625, obj_val: 10263.7109375, abs dis: 414.8134765625
[rfa agg] iter:  1, weight: tensor([0.0511, 0.0512, 0.0572, 0.0531, 0.1463, 0.1009, 0.1769, 0.1594, 0.1214,
        0.0826])
[rfa agg] iter:  2, prev_obj_val: 10263.7109375, obj_val: 9941.83203125, abs dis: 321.87890625
[rfa agg] iter:  2, weight: tensor([0.0357, 0.0358, 0.0392, 0.0371, 0.1583, 0.1090, 0.1917, 0.1726, 0.1313,
        0.0892])
[rfa agg] iter:  3, prev_obj_val: 9941.83203125, obj_val: 9704.2587890625, abs dis: 237.5732421875
[rfa agg] iter:  3, weight: tensor([0.0243, 0.0244, 0.0264, 0.0253, 0.1672, 0.1149, 0.2028, 0.1825, 0.1384,
        0.0939])
[rfa agg] iter:  4, prev_obj_val: 9704.2587890625, obj_val: 9535.6630859375, abs dis: 168.595703125
[rfa agg] iter:  4, weight: tensor([0.0162, 0.0162, 0.0174, 0.0168, 0.1736, 0.1188, 0.2110, 0.1896, 0.1433,
        0.0970])
[rfa agg] iter:  5, prev_obj_val: 9535.6630859375, obj_val: 9420.71875, abs dis: 114.9443359375
[rfa agg] iter:  5, weight: tensor([0.0106, 0.0106, 0.0114, 0.0110, 0.1780, 0.1211, 0.2173, 0.1949, 0.1464,
        0.0987])
[rfa agg] iter:  6, prev_obj_val: 9420.71875, obj_val: 9344.0966796875, abs dis: 76.6220703125
[rfa agg] iter:  6, weight: tensor([0.0069, 0.0069, 0.0073, 0.0071, 0.1811, 0.1221, 0.2225, 0.1989, 0.1480,
        0.0992])
[rfa agg] iter:  7, prev_obj_val: 9344.0966796875, obj_val: 9291.4365234375, abs dis: 52.66015625
[rfa agg] iter:  7, weight: tensor([0.0044, 0.0044, 0.0047, 0.0045, 0.1834, 0.1218, 0.2276, 0.2024, 0.1484,
        0.0985])
[rfa agg] iter:  8, prev_obj_val: 9291.4365234375, obj_val: 9256.994140625, abs dis: 34.4423828125
[rfa agg] iter:  8, weight: tensor([0.0027, 0.0027, 0.0029, 0.0028, 0.1852, 0.1200, 0.2340, 0.2062, 0.1473,
        0.0963])
[rfa agg] iter:  9, prev_obj_val: 9256.994140625, obj_val: 9234.095703125, abs dis: 22.8984375
[rfa agg] iter:  9, weight: tensor([0.0016, 0.0016, 0.0017, 0.0017, 0.1866, 0.1158, 0.2438, 0.2112, 0.1442,
        0.0918])
___Test Target_ResNet_18 poisoned: False, epoch: 262: Average loss: 1.2137, Accuracy: 6041/10000 (60.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 262: Average loss: 0.3763, Accuracy: 8055/9000 (89.5000%)
Done in 315.5468473434448 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:263 choose agents : [17, 33, 77, 11, 90, 9, 71, 78, 69, 28]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 17, internal_epoch   1,  Average loss: 0.0024, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 17, internal_epoch   2,  Average loss: 0.0018, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 17, internal_epoch   3,  Average loss: 0.0015, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 17, internal_epoch   4,  Average loss: 0.0021, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 17, internal_epoch   5,  Average loss: 0.0024, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 17, internal_epoch   6,  Average loss: 0.0033, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Global model norm: 38.96791360870665.
Norm before scaling: 39.10707924993808. Distance: 5.569628487598447
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 2.7467, Accuracy: 3695/10000 (36.9500%)
___Test Local_ResNet_18 poisoned: True, epoch: 263: Average loss: 0.1437, Accuracy: 8546/9000 (94.9556%)
Scaling by  100
Scaled Norm after poisoning: 556.5165372655156, distance: 556.9628297741242
Total norm for 4 adversaries is: 556.5165372655156. distance: 556.9628297741242
___Test Local_ResNet_18 poisoned: True, epoch: 263: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 33, internal_epoch   1,  Average loss: 0.0026, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 33, internal_epoch   2,  Average loss: 0.0012, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 33, internal_epoch   3,  Average loss: 0.0009, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 33, internal_epoch   4,  Average loss: 0.0012, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 33, internal_epoch   5,  Average loss: 0.0015, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 33, internal_epoch   6,  Average loss: 0.0018, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Global model norm: 38.96791360870665.
Norm before scaling: 38.714022171498954. Distance: 2.7273009428818877
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 2.0229, Accuracy: 4501/10000 (45.0100%)
___Test Local_ResNet_18 poisoned: True, epoch: 263: Average loss: 0.0765, Accuracy: 8753/9000 (97.2556%)
Scaling by  100
Scaled Norm after poisoning: 270.5256601738549, distance: 272.7300920782303
Total norm for 4 adversaries is: 270.5256601738549. distance: 272.7300920782303
___Test Local_ResNet_18 poisoned: True, epoch: 263: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 77, internal_epoch   1,  Average loss: 0.0014, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 77, internal_epoch   3,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 77, internal_epoch   4,  Average loss: 0.0005, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 38.96791360870665.
Norm before scaling: 38.69701045512512. Distance: 1.6232945956648088
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 1.5297, Accuracy: 5439/10000 (54.3900%)
___Test Local_ResNet_18 poisoned: True, epoch: 263: Average loss: 0.0649, Accuracy: 8813/9000 (97.9222%)
Scaling by  100
Scaled Norm after poisoning: 159.69309554775685, distance: 162.32945377379917
Total norm for 4 adversaries is: 159.69309554775685. distance: 162.32945377379917
___Test Local_ResNet_18 poisoned: True, epoch: 263: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 11, internal_epoch   2,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 11, internal_epoch   3,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 11, internal_epoch   4,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Global model norm: 38.96791360870665.
Norm before scaling: 38.65840674561453. Distance: 1.9059113999115342
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 1.6095, Accuracy: 5411/10000 (54.1100%)
___Test Local_ResNet_18 poisoned: True, epoch: 263: Average loss: 0.1330, Accuracy: 8646/9000 (96.0667%)
Scaling by  100
Scaled Norm after poisoning: 187.29028897342755, distance: 190.591134286855
Total norm for 4 adversaries is: 187.29028897342755. distance: 190.591134286855
___Test Local_ResNet_18 poisoned: True, epoch: 263: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 263, local model 90, internal_epoch   1,  Average loss: 0.0241, Accuracy: 379/578 (65.5709%)
___Train Local_ResNet_18,  epoch 263, local model 90, internal_epoch   2,  Average loss: 0.0330, Accuracy: 350/578 (60.5536%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 648.4022, Accuracy: 1084/10000 (10.8400%)
___Train Local_ResNet_18,  epoch 263, local model 9, internal_epoch   1,  Average loss: 0.0220, Accuracy: 242/368 (65.7609%)
___Train Local_ResNet_18,  epoch 263, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 326/368 (88.5870%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 6.7485, Accuracy: 2181/10000 (21.8100%)
___Train Local_ResNet_18,  epoch 263, local model 71, internal_epoch   1,  Average loss: 0.0169, Accuracy: 806/1166 (69.1252%)
___Train Local_ResNet_18,  epoch 263, local model 71, internal_epoch   2,  Average loss: 0.0089, Accuracy: 963/1166 (82.5901%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 2.7124, Accuracy: 3914/10000 (39.1400%)
___Train Local_ResNet_18,  epoch 263, local model 78, internal_epoch   1,  Average loss: 0.0210, Accuracy: 163/255 (63.9216%)
___Train Local_ResNet_18,  epoch 263, local model 78, internal_epoch   2,  Average loss: 0.0023, Accuracy: 239/255 (93.7255%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 6.6178, Accuracy: 2445/10000 (24.4500%)
___Train Local_ResNet_18,  epoch 263, local model 69, internal_epoch   1,  Average loss: 0.0321, Accuracy: 119/216 (55.0926%)
___Train Local_ResNet_18,  epoch 263, local model 69, internal_epoch   2,  Average loss: 0.0020, Accuracy: 213/216 (98.6111%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 6.6738, Accuracy: 2404/10000 (24.0400%)
___Train Local_ResNet_18,  epoch 263, local model 28, internal_epoch   1,  Average loss: 0.0211, Accuracy: 269/423 (63.5934%)
___Train Local_ResNet_18,  epoch 263, local model 28, internal_epoch   2,  Average loss: 0.0066, Accuracy: 374/423 (88.4161%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 2.1763, Accuracy: 4035/10000 (40.3500%)
time spent on training: 255.86756682395935
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41070378357184867  data num: [526, 527, 496, 546, 578, 368, 1166, 255, 216, 423]
[rfa agg] considering poison per batch poison_fraction: 0.032086233091550675
[rfa agg] init. name: [17, 33, 77, 11, 90, 9, 71, 78, 69, 28], weight: tensor([0.1031, 0.1033, 0.0972, 0.1070, 0.1133, 0.0721, 0.2286, 0.0500, 0.0423,
        0.0829])
[rfa agg] iter:  0, prev_obj_val: 11329.7890625, obj_val: 10975.755859375, abs dis: 354.033203125
[rfa agg] iter:  0, weight: tensor([0.0780, 0.0782, 0.0904, 0.0810, 0.1291, 0.0819, 0.2626, 0.0566, 0.0480,
        0.0942])
[rfa agg] iter:  1, prev_obj_val: 10975.755859375, obj_val: 10663.32421875, abs dis: 312.431640625
[rfa agg] iter:  1, weight: tensor([0.0605, 0.0607, 0.0683, 0.0629, 0.1435, 0.0909, 0.2925, 0.0629, 0.0532,
        0.1046])
[rfa agg] iter:  2, prev_obj_val: 10663.32421875, obj_val: 10402.8544921875, abs dis: 260.4697265625
[rfa agg] iter:  2, weight: tensor([0.0457, 0.0458, 0.0506, 0.0475, 0.1554, 0.0984, 0.3179, 0.0680, 0.0576,
        0.1132])
[rfa agg] iter:  3, prev_obj_val: 10402.8544921875, obj_val: 10193.53515625, abs dis: 209.3193359375
[rfa agg] iter:  3, weight: tensor([0.0337, 0.0338, 0.0369, 0.0350, 0.1649, 0.1041, 0.3388, 0.0719, 0.0609,
        0.1199])
[rfa agg] iter:  4, prev_obj_val: 10193.53515625, obj_val: 10031.369140625, abs dis: 162.166015625
[rfa agg] iter:  4, weight: tensor([0.0244, 0.0245, 0.0264, 0.0254, 0.1721, 0.1084, 0.3560, 0.0747, 0.0633,
        0.1249])
[rfa agg] iter:  5, prev_obj_val: 10031.369140625, obj_val: 9910.763671875, abs dis: 120.60546875
[rfa agg] iter:  5, weight: tensor([0.0174, 0.0174, 0.0187, 0.0180, 0.1773, 0.1112, 0.3705, 0.0765, 0.0648,
        0.1283])
[rfa agg] iter:  6, prev_obj_val: 9910.763671875, obj_val: 9821.3330078125, abs dis: 89.4306640625
[rfa agg] iter:  6, weight: tensor([0.0122, 0.0122, 0.0131, 0.0127, 0.1807, 0.1127, 0.3833, 0.0773, 0.0655,
        0.1302])
[rfa agg] iter:  7, prev_obj_val: 9821.3330078125, obj_val: 9757.4912109375, abs dis: 63.841796875
[rfa agg] iter:  7, weight: tensor([0.0084, 0.0085, 0.0090, 0.0088, 0.1827, 0.1130, 0.3964, 0.0771, 0.0653,
        0.1308])
[rfa agg] iter:  8, prev_obj_val: 9757.4912109375, obj_val: 9712.06640625, abs dis: 45.4248046875
[rfa agg] iter:  8, weight: tensor([0.0058, 0.0058, 0.0062, 0.0060, 0.1831, 0.1118, 0.4112, 0.0759, 0.0643,
        0.1299])
[rfa agg] iter:  9, prev_obj_val: 9712.06640625, obj_val: 9679.4873046875, abs dis: 32.5791015625
[rfa agg] iter:  9, weight: tensor([0.0039, 0.0039, 0.0041, 0.0040, 0.1816, 0.1090, 0.4308, 0.0733, 0.0621,
        0.1272])
___Test Target_ResNet_18 poisoned: False, epoch: 263: Average loss: 1.3037, Accuracy: 5678/10000 (56.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 263: Average loss: 0.4219, Accuracy: 7974/9000 (88.6000%)
Done in 349.11736583709717 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:264 choose agents : [17, 33, 77, 11, 87, 46, 26, 67, 13, 69]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 17, internal_epoch   1,  Average loss: 0.0022, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 17, internal_epoch   2,  Average loss: 0.0010, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 17, internal_epoch   3,  Average loss: 0.0029, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 17, internal_epoch   4,  Average loss: 0.0017, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 17, internal_epoch   5,  Average loss: 0.0016, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 17, internal_epoch   6,  Average loss: 0.0012, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Global model norm: 38.88776229921985.
Norm before scaling: 38.6484967214525. Distance: 2.902693346206136
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 1.8910, Accuracy: 4615/10000 (46.1500%)
___Test Local_ResNet_18 poisoned: True, epoch: 264: Average loss: 0.0437, Accuracy: 8822/9000 (98.0222%)
Scaling by  100
Scaled Norm after poisoning: 288.22007650404925, distance: 290.2692984540391
Total norm for 4 adversaries is: 288.22007650404925. distance: 290.2692984540391
___Test Local_ResNet_18 poisoned: True, epoch: 264: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 33, internal_epoch   1,  Average loss: 0.0017, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 33, internal_epoch   2,  Average loss: 0.0009, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 33, internal_epoch   3,  Average loss: 0.0005, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 33, internal_epoch   4,  Average loss: 0.0013, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 33, internal_epoch   5,  Average loss: 0.0015, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 33, internal_epoch   6,  Average loss: 0.0019, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Global model norm: 38.88776229921985.
Norm before scaling: 38.66826687713389. Distance: 2.9340249467242927
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 1.7675, Accuracy: 4930/10000 (49.3000%)
___Test Local_ResNet_18 poisoned: True, epoch: 264: Average loss: 0.1774, Accuracy: 8548/9000 (94.9778%)
Scaling by  100
Scaled Norm after poisoning: 291.6060725748008, distance: 293.4025072319594
Total norm for 4 adversaries is: 291.6060725748008. distance: 293.4025072319594
___Test Local_ResNet_18 poisoned: True, epoch: 264: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 77, internal_epoch   1,  Average loss: 0.0019, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 77, internal_epoch   3,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 77, internal_epoch   4,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 77, internal_epoch   5,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 38.88776229921985.
Norm before scaling: 38.64762181396159. Distance: 2.0189851653417055
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 1.5582, Accuracy: 5420/10000 (54.2000%)
___Test Local_ResNet_18 poisoned: True, epoch: 264: Average loss: 0.1566, Accuracy: 8629/9000 (95.8778%)
Scaling by  100
Scaled Norm after poisoning: 200.0143061289617, distance: 201.8985086931055
Total norm for 4 adversaries is: 200.0143061289617. distance: 201.8985086931055
___Test Local_ResNet_18 poisoned: True, epoch: 264: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 11, internal_epoch   2,  Average loss: 0.0010, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 11, internal_epoch   3,  Average loss: 0.0008, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 11, internal_epoch   4,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 11, internal_epoch   5,  Average loss: 0.0007, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 38.88776229921985.
Norm before scaling: 38.585623511832424. Distance: 2.0091774898297134
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 1.5602, Accuracy: 5532/10000 (55.3200%)
___Test Local_ResNet_18 poisoned: True, epoch: 264: Average loss: 0.0828, Accuracy: 8751/9000 (97.2333%)
Scaling by  100
Scaled Norm after poisoning: 197.82766529545356, distance: 200.9177478627759
Total norm for 4 adversaries is: 197.82766529545356. distance: 200.9177478627759
___Test Local_ResNet_18 poisoned: True, epoch: 264: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 264, local model 87, internal_epoch   1,  Average loss: 0.0209, Accuracy: 225/397 (56.6751%)
___Train Local_ResNet_18,  epoch 264, local model 87, internal_epoch   2,  Average loss: 0.0075, Accuracy: 337/397 (84.8866%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 3.0341, Accuracy: 2764/10000 (27.6400%)
___Train Local_ResNet_18,  epoch 264, local model 46, internal_epoch   1,  Average loss: 0.0170, Accuracy: 410/601 (68.2196%)
___Train Local_ResNet_18,  epoch 264, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 530/601 (88.1864%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 3.5652, Accuracy: 3434/10000 (34.3400%)
___Train Local_ResNet_18,  epoch 264, local model 26, internal_epoch   1,  Average loss: 0.0217, Accuracy: 271/468 (57.9060%)
___Train Local_ResNet_18,  epoch 264, local model 26, internal_epoch   2,  Average loss: 0.0109, Accuracy: 374/468 (79.9145%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 3.8287, Accuracy: 2438/10000 (24.3800%)
___Train Local_ResNet_18,  epoch 264, local model 67, internal_epoch   1,  Average loss: 0.0176, Accuracy: 541/842 (64.2518%)
___Train Local_ResNet_18,  epoch 264, local model 67, internal_epoch   2,  Average loss: 0.0125, Accuracy: 619/842 (73.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 4.6552, Accuracy: 2633/10000 (26.3300%)
___Train Local_ResNet_18,  epoch 264, local model 13, internal_epoch   1,  Average loss: 0.0165, Accuracy: 448/620 (72.2581%)
___Train Local_ResNet_18,  epoch 264, local model 13, internal_epoch   2,  Average loss: 0.0081, Accuracy: 535/620 (86.2903%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 4.3470, Accuracy: 3121/10000 (31.2100%)
___Train Local_ResNet_18,  epoch 264, local model 69, internal_epoch   1,  Average loss: 0.0273, Accuracy: 128/216 (59.2593%)
___Train Local_ResNet_18,  epoch 264, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 200/216 (92.5926%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 8.5042, Accuracy: 1608/10000 (16.0800%)
time spent on training: 286.1450791358948
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.39988547432716165  data num: [526, 527, 496, 546, 397, 601, 468, 842, 620, 216]
[rfa agg] considering poison per batch poison_fraction: 0.031241052681809503
[rfa agg] init. name: [17, 33, 77, 11, 87, 46, 26, 67, 13, 69], weight: tensor([0.1004, 0.1006, 0.0947, 0.1042, 0.0758, 0.1147, 0.0893, 0.1607, 0.1183,
        0.0412])
[rfa agg] iter:  0, prev_obj_val: 11241.3505859375, obj_val: 10805.1083984375, abs dis: 436.2421875
[rfa agg] iter:  0, weight: tensor([0.0735, 0.0737, 0.0848, 0.0764, 0.0871, 0.1322, 0.1028, 0.1859, 0.1364,
        0.0472])
[rfa agg] iter:  1, prev_obj_val: 10805.1083984375, obj_val: 10430.701171875, abs dis: 374.4072265625
[rfa agg] iter:  1, weight: tensor([0.0548, 0.0549, 0.0615, 0.0569, 0.0971, 0.1475, 0.1146, 0.2077, 0.1522,
        0.0526])
[rfa agg] iter:  2, prev_obj_val: 10430.701171875, obj_val: 10129.755859375, abs dis: 300.9453125
[rfa agg] iter:  2, weight: tensor([0.0396, 0.0396, 0.0435, 0.0411, 0.1051, 0.1599, 0.1241, 0.2255, 0.1649,
        0.0569])
[rfa agg] iter:  3, prev_obj_val: 10129.755859375, obj_val: 9900.470703125, abs dis: 229.28515625
[rfa agg] iter:  3, weight: tensor([0.0278, 0.0278, 0.0302, 0.0288, 0.1110, 0.1692, 0.1312, 0.2393, 0.1746,
        0.0600])
[rfa agg] iter:  4, prev_obj_val: 9900.470703125, obj_val: 9732.990234375, abs dis: 167.48046875
[rfa agg] iter:  4, weight: tensor([0.0191, 0.0192, 0.0206, 0.0199, 0.1152, 0.1761, 0.1362, 0.2501, 0.1817,
        0.0620])
[rfa agg] iter:  5, prev_obj_val: 9732.990234375, obj_val: 9612.9794921875, abs dis: 120.0107421875
[rfa agg] iter:  5, weight: tensor([0.0130, 0.0130, 0.0139, 0.0135, 0.1178, 0.1809, 0.1395, 0.2586, 0.1867,
        0.0632])
[rfa agg] iter:  6, prev_obj_val: 9612.9794921875, obj_val: 9529.697265625, abs dis: 83.2822265625
[rfa agg] iter:  6, weight: tensor([0.0086, 0.0086, 0.0092, 0.0090, 0.1191, 0.1843, 0.1415, 0.2660, 0.1902,
        0.0635])
[rfa agg] iter:  7, prev_obj_val: 9529.697265625, obj_val: 9471.49609375, abs dis: 58.201171875
[rfa agg] iter:  7, weight: tensor([0.0057, 0.0057, 0.0060, 0.0059, 0.1193, 0.1866, 0.1421, 0.2735, 0.1925,
        0.0629])
[rfa agg] iter:  8, prev_obj_val: 9471.49609375, obj_val: 9433.009765625, abs dis: 38.486328125
[rfa agg] iter:  8, weight: tensor([0.0036, 0.0036, 0.0038, 0.0037, 0.1180, 0.1879, 0.1414, 0.2829, 0.1939,
        0.0612])
[rfa agg] iter:  9, prev_obj_val: 9433.009765625, obj_val: 9407.9716796875, abs dis: 25.0380859375
[rfa agg] iter:  9, weight: tensor([0.0022, 0.0022, 0.0024, 0.0023, 0.1148, 0.1883, 0.1389, 0.2966, 0.1942,
        0.0580])
___Test Target_ResNet_18 poisoned: False, epoch: 264: Average loss: 1.2609, Accuracy: 5706/10000 (57.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 264: Average loss: 0.4663, Accuracy: 7850/9000 (87.2222%)
Done in 363.5470781326294 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:265 choose agents : [17, 33, 77, 11, 54, 34, 78, 91, 57, 30]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 17, internal_epoch   1,  Average loss: 0.0022, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 17, internal_epoch   2,  Average loss: 0.0008, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 17, internal_epoch   3,  Average loss: 0.0012, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 17, internal_epoch   4,  Average loss: 0.0006, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 17, internal_epoch   5,  Average loss: 0.0025, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 17, internal_epoch   6,  Average loss: 0.0021, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 38.83673980135868.
Norm before scaling: 38.61445231690299. Distance: 2.915895432731013
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 1.8842, Accuracy: 4651/10000 (46.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 265: Average loss: 0.0607, Accuracy: 8779/9000 (97.5444%)
Scaling by  100
Scaled Norm after poisoning: 289.7599626199244, distance: 291.58954188636466
Total norm for 4 adversaries is: 289.7599626199244. distance: 291.58954188636466
___Test Local_ResNet_18 poisoned: True, epoch: 265: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 33, internal_epoch   1,  Average loss: 0.0020, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 33, internal_epoch   2,  Average loss: 0.0015, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 33, internal_epoch   3,  Average loss: 0.0014, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 33, internal_epoch   4,  Average loss: 0.0019, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 33, internal_epoch   5,  Average loss: 0.0007, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 33, internal_epoch   6,  Average loss: 0.0020, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Global model norm: 38.83673980135868.
Norm before scaling: 38.61294752795848. Distance: 2.9544208246901444
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 1.7283, Accuracy: 4946/10000 (49.4600%)
___Test Local_ResNet_18 poisoned: True, epoch: 265: Average loss: 0.1193, Accuracy: 8640/9000 (96.0000%)
Scaling by  100
Scaled Norm after poisoning: 293.57824766150503, distance: 295.4420681368853
Total norm for 4 adversaries is: 293.57824766150503. distance: 295.4420681368853
___Test Local_ResNet_18 poisoned: True, epoch: 265: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 77, internal_epoch   1,  Average loss: 0.0019, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 77, internal_epoch   3,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 77, internal_epoch   4,  Average loss: 0.0002, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 38.83673980135868.
Norm before scaling: 38.58538623948191. Distance: 1.8647850893572524
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 1.5817, Accuracy: 5314/10000 (53.1400%)
___Test Local_ResNet_18 poisoned: True, epoch: 265: Average loss: 0.0471, Accuracy: 8856/9000 (98.4000%)
Scaling by  100
Scaled Norm after poisoning: 184.36041255852624, distance: 186.47853009797134
Total norm for 4 adversaries is: 184.36041255852624. distance: 186.47853009797134
___Test Local_ResNet_18 poisoned: True, epoch: 265: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 11, internal_epoch   2,  Average loss: 0.0007, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 11, internal_epoch   3,  Average loss: 0.0007, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 11, internal_epoch   4,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 11, internal_epoch   5,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 38.83673980135868.
Norm before scaling: 38.53766325632384. Distance: 2.0525057853217605
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 1.6620, Accuracy: 5496/10000 (54.9600%)
___Test Local_ResNet_18 poisoned: True, epoch: 265: Average loss: 0.1078, Accuracy: 8710/9000 (96.7778%)
Scaling by  100
Scaled Norm after poisoning: 202.23927080626552, distance: 205.25058998088167
Total norm for 4 adversaries is: 202.23927080626552. distance: 205.25058998088167
___Test Local_ResNet_18 poisoned: True, epoch: 265: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 265, local model 54, internal_epoch   1,  Average loss: 0.0162, Accuracy: 310/440 (70.4545%)
___Train Local_ResNet_18,  epoch 265, local model 54, internal_epoch   2,  Average loss: 0.0046, Accuracy: 399/440 (90.6818%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 6.2686, Accuracy: 2317/10000 (23.1700%)
___Train Local_ResNet_18,  epoch 265, local model 34, internal_epoch   1,  Average loss: 0.0208, Accuracy: 220/349 (63.0372%)
___Train Local_ResNet_18,  epoch 265, local model 34, internal_epoch   2,  Average loss: 0.0059, Accuracy: 305/349 (87.3926%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 7.9422, Accuracy: 1812/10000 (18.1200%)
___Train Local_ResNet_18,  epoch 265, local model 78, internal_epoch   1,  Average loss: 0.0192, Accuracy: 154/255 (60.3922%)
___Train Local_ResNet_18,  epoch 265, local model 78, internal_epoch   2,  Average loss: 0.0028, Accuracy: 239/255 (93.7255%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 5.8085, Accuracy: 2518/10000 (25.1800%)
___Train Local_ResNet_18,  epoch 265, local model 91, internal_epoch   1,  Average loss: 0.0212, Accuracy: 144/234 (61.5385%)
___Train Local_ResNet_18,  epoch 265, local model 91, internal_epoch   2,  Average loss: 0.0033, Accuracy: 221/234 (94.4444%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 3.5543, Accuracy: 3292/10000 (32.9200%)
___Train Local_ResNet_18,  epoch 265, local model 57, internal_epoch   1,  Average loss: 0.0183, Accuracy: 180/290 (62.0690%)
___Train Local_ResNet_18,  epoch 265, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 256/290 (88.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 4.3008, Accuracy: 3262/10000 (32.6200%)
___Train Local_ResNet_18,  epoch 265, local model 30, internal_epoch   1,  Average loss: 0.0240, Accuracy: 179/337 (53.1157%)
___Train Local_ResNet_18,  epoch 265, local model 30, internal_epoch   2,  Average loss: 0.0074, Accuracy: 284/337 (84.2730%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 7.6437, Accuracy: 1610/10000 (16.1000%)
time spent on training: 278.46399426460266
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.52375  data num: [526, 527, 496, 546, 440, 349, 255, 234, 290, 337]
[rfa agg] considering poison per batch poison_fraction: 0.040917968750000006
[rfa agg] init. name: [17, 33, 77, 11, 54, 34, 78, 91, 57, 30], weight: tensor([0.1315, 0.1318, 0.1240, 0.1365, 0.1100, 0.0873, 0.0637, 0.0585, 0.0725,
        0.0843])
[rfa agg] iter:  0, prev_obj_val: 11708.67578125, obj_val: 11683.892578125, abs dis: 24.783203125
[rfa agg] iter:  0, weight: tensor([0.1290, 0.1293, 0.1574, 0.1340, 0.1041, 0.0825, 0.0602, 0.0553, 0.0685,
        0.0797])
[rfa agg] iter:  1, prev_obj_val: 11683.892578125, obj_val: 11659.333984375, abs dis: 24.55859375
[rfa agg] iter:  1, weight: tensor([0.1338, 0.1340, 0.1654, 0.1389, 0.0989, 0.0784, 0.0572, 0.0525, 0.0651,
        0.0757])
[rfa agg] iter:  2, prev_obj_val: 11659.333984375, obj_val: 11634.998046875, abs dis: 24.3359375
[rfa agg] iter:  2, weight: tensor([0.1383, 0.1386, 0.1737, 0.1436, 0.0938, 0.0744, 0.0543, 0.0498, 0.0617,
        0.0718])
[rfa agg] iter:  3, prev_obj_val: 11634.998046875, obj_val: 11611.0908203125, abs dis: 23.9072265625
[rfa agg] iter:  3, weight: tensor([0.1427, 0.1430, 0.1822, 0.1482, 0.0887, 0.0703, 0.0513, 0.0471, 0.0584,
        0.0679])
[rfa agg] iter:  4, prev_obj_val: 11611.0908203125, obj_val: 11587.83203125, abs dis: 23.2587890625
[rfa agg] iter:  4, weight: tensor([0.1469, 0.1472, 0.1910, 0.1525, 0.0838, 0.0664, 0.0485, 0.0445, 0.0552,
        0.0641])
[rfa agg] iter:  5, prev_obj_val: 11587.83203125, obj_val: 11565.0087890625, abs dis: 22.8232421875
[rfa agg] iter:  5, weight: tensor([0.1508, 0.1511, 0.2001, 0.1565, 0.0790, 0.0626, 0.0457, 0.0419, 0.0520,
        0.0604])
[rfa agg] iter:  6, prev_obj_val: 11565.0087890625, obj_val: 11543.046875, abs dis: 21.9619140625
[rfa agg] iter:  6, weight: tensor([0.1544, 0.1547, 0.2096, 0.1603, 0.0742, 0.0588, 0.0429, 0.0394, 0.0489,
        0.0568])
[rfa agg] iter:  7, prev_obj_val: 11543.046875, obj_val: 11522.154296875, abs dis: 20.892578125
[rfa agg] iter:  7, weight: tensor([0.1576, 0.1579, 0.2194, 0.1637, 0.0697, 0.0552, 0.0403, 0.0370, 0.0459,
        0.0533])
[rfa agg] iter:  8, prev_obj_val: 11522.154296875, obj_val: 11501.9169921875, abs dis: 20.2373046875
[rfa agg] iter:  8, weight: tensor([0.1605, 0.1608, 0.2295, 0.1667, 0.0653, 0.0518, 0.0378, 0.0347, 0.0430,
        0.0500])
[rfa agg] iter:  9, prev_obj_val: 11501.9169921875, obj_val: 11482.541015625, abs dis: 19.3759765625
[rfa agg] iter:  9, weight: tensor([0.1630, 0.1633, 0.2401, 0.1692, 0.0611, 0.0484, 0.0354, 0.0324, 0.0402,
        0.0468])
___Test Target_ResNet_18 poisoned: False, epoch: 265: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 265: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 362.3000576496124 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:266 choose agents : [17, 33, 77, 11, 75, 28, 31, 85, 45, 96]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 17, internal_epoch   1,  Average loss: 0.0564, Accuracy: 164/526 (31.1787%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 17, internal_epoch   2,  Average loss: 0.0266, Accuracy: 274/526 (52.0913%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 17, internal_epoch   3,  Average loss: 0.0211, Accuracy: 311/526 (59.1255%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 17, internal_epoch   4,  Average loss: 0.0186, Accuracy: 343/526 (65.2091%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 17, internal_epoch   5,  Average loss: 0.0141, Accuracy: 393/526 (74.7148%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 17, internal_epoch   6,  Average loss: 0.0121, Accuracy: 418/526 (79.4677%), train_poison_data_count: 45
Global model norm: 37.66194199719393.
Norm before scaling: 39.03971053969839. Distance: 13.18607036922777
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 2.5139, Accuracy: 2974/10000 (29.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 266: Average loss: 1.7322, Accuracy: 2774/9000 (30.8222%)
Scaling by  100
Scaled Norm after poisoning: 1316.5573952547606, distance: 1318.6070301647871
Total norm for 4 adversaries is: 1316.5573952547606. distance: 1318.6070301647871
___Test Local_ResNet_18 poisoned: True, epoch: 266: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 33, internal_epoch   1,  Average loss: 0.0430, Accuracy: 246/527 (46.6793%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 33, internal_epoch   2,  Average loss: 0.0190, Accuracy: 317/527 (60.1518%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 33, internal_epoch   3,  Average loss: 0.0123, Accuracy: 400/527 (75.9013%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 33, internal_epoch   4,  Average loss: 0.0064, Accuracy: 477/527 (90.5123%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 33, internal_epoch   5,  Average loss: 0.0033, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 33, internal_epoch   6,  Average loss: 0.0026, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.66194199719393.
Norm before scaling: 39.6754918472388. Distance: 13.79499750550024
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 3.3159, Accuracy: 2786/10000 (27.8600%)
___Test Local_ResNet_18 poisoned: True, epoch: 266: Average loss: 0.6478, Accuracy: 7532/9000 (83.6889%)
Scaling by  100
Scaled Norm after poisoning: 1378.7602674141724, distance: 1379.4996828560709
Total norm for 4 adversaries is: 1378.7602674141724. distance: 1379.4996828560709
___Test Local_ResNet_18 poisoned: True, epoch: 266: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 77, internal_epoch   1,  Average loss: 0.0469, Accuracy: 182/496 (36.6935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 77, internal_epoch   2,  Average loss: 0.0252, Accuracy: 232/496 (46.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 77, internal_epoch   3,  Average loss: 0.0206, Accuracy: 283/496 (57.0565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 77, internal_epoch   4,  Average loss: 0.0139, Accuracy: 354/496 (71.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 77, internal_epoch   5,  Average loss: 0.0075, Accuracy: 426/496 (85.8871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 77, internal_epoch   6,  Average loss: 0.0042, Accuracy: 456/496 (91.9355%), train_poison_data_count: 40
Global model norm: 37.66194199719393.
Norm before scaling: 39.089056597763076. Distance: 12.275482454161297
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 2.9708, Accuracy: 2837/10000 (28.3700%)
___Test Local_ResNet_18 poisoned: True, epoch: 266: Average loss: 0.7243, Accuracy: 6921/9000 (76.9000%)
Scaling by  100
Scaled Norm after poisoning: 1226.4492447712623, distance: 1227.5482678901062
Total norm for 4 adversaries is: 1226.4492447712623. distance: 1227.5482678901062
___Test Local_ResNet_18 poisoned: True, epoch: 266: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 11, internal_epoch   1,  Average loss: 0.0476, Accuracy: 151/546 (27.6557%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 11, internal_epoch   2,  Average loss: 0.0277, Accuracy: 241/546 (44.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 11, internal_epoch   3,  Average loss: 0.0226, Accuracy: 297/546 (54.3956%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 11, internal_epoch   4,  Average loss: 0.0176, Accuracy: 354/546 (64.8352%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 11, internal_epoch   5,  Average loss: 0.0119, Accuracy: 421/546 (77.1062%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 11, internal_epoch   6,  Average loss: 0.0078, Accuracy: 462/546 (84.6154%), train_poison_data_count: 45
Global model norm: 37.66194199719393.
Norm before scaling: 38.68603591736946. Distance: 11.21007727535949
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 3.3006, Accuracy: 2443/10000 (24.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 266: Average loss: 1.5294, Accuracy: 4454/9000 (49.4889%)
Scaling by  100
Scaled Norm after poisoning: 1119.5217170738583, distance: 1121.0076939967896
Total norm for 4 adversaries is: 1119.5217170738583. distance: 1121.0076939967896
___Test Local_ResNet_18 poisoned: True, epoch: 266: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 266, local model 75, internal_epoch   1,  Average loss: 0.0762, Accuracy: 155/578 (26.8166%)
___Train Local_ResNet_18,  epoch 266, local model 75, internal_epoch   2,  Average loss: 0.0405, Accuracy: 226/578 (39.1003%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 266, local model 28, internal_epoch   1,  Average loss: 0.0785, Accuracy: 92/423 (21.7494%)
___Train Local_ResNet_18,  epoch 266, local model 28, internal_epoch   2,  Average loss: 0.0326, Accuracy: 125/423 (29.5508%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 266, local model 31, internal_epoch   1,  Average loss: 0.0645, Accuracy: 204/706 (28.8952%)
___Train Local_ResNet_18,  epoch 266, local model 31, internal_epoch   2,  Average loss: 0.0296, Accuracy: 259/706 (36.6856%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 266, local model 85, internal_epoch   1,  Average loss: 0.0781, Accuracy: 80/364 (21.9780%)
___Train Local_ResNet_18,  epoch 266, local model 85, internal_epoch   2,  Average loss: 0.0343, Accuracy: 110/364 (30.2198%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 266, local model 45, internal_epoch   1,  Average loss: 0.0644, Accuracy: 180/529 (34.0265%)
___Train Local_ResNet_18,  epoch 266, local model 45, internal_epoch   2,  Average loss: 0.0261, Accuracy: 258/529 (48.7713%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 266, local model 96, internal_epoch   1,  Average loss: 0.0542, Accuracy: 225/708 (31.7797%)
___Train Local_ResNet_18,  epoch 266, local model 96, internal_epoch   2,  Average loss: 0.0269, Accuracy: 279/708 (39.4068%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 286.69492292404175
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3877475476587081  data num: [526, 527, 496, 546, 578, 423, 706, 364, 529, 708]
[rfa agg] considering poison per batch poison_fraction: 0.030292777160836573
[rfa agg] init. name: [17, 33, 77, 11, 75, 28, 31, 85, 45, 96], weight: tensor([0.0974, 0.0975, 0.0918, 0.1011, 0.1070, 0.0783, 0.1307, 0.0674, 0.0979,
        0.1310])
[rfa agg] iter:  0, prev_obj_val: 11178.40234375, obj_val: 10631.1455078125, abs dis: 547.2568359375
[rfa agg] iter:  0, weight: tensor([0.0682, 0.0685, 0.0783, 0.0710, 0.1248, 0.0910, 0.1527, 0.0783, 0.1141,
        0.1531])
[rfa agg] iter:  1, prev_obj_val: 10631.1455078125, obj_val: 10183.8154296875, abs dis: 447.330078125
[rfa agg] iter:  1, weight: tensor([0.0483, 0.0485, 0.0539, 0.0503, 0.1397, 0.1018, 0.1710, 0.0875, 0.1276,
        0.1715])
[rfa agg] iter:  2, prev_obj_val: 10183.8154296875, obj_val: 9844.04296875, abs dis: 339.7724609375
[rfa agg] iter:  2, weight: tensor([0.0330, 0.0331, 0.0361, 0.0343, 0.1509, 0.1098, 0.1851, 0.0943, 0.1379,
        0.1856])
[rfa agg] iter:  3, prev_obj_val: 9844.04296875, obj_val: 9599.4599609375, abs dis: 244.5830078125
[rfa agg] iter:  3, weight: tensor([0.0219, 0.0219, 0.0237, 0.0227, 0.1590, 0.1154, 0.1953, 0.0990, 0.1451,
        0.1959])
[rfa agg] iter:  4, prev_obj_val: 9599.4599609375, obj_val: 9430.74609375, abs dis: 168.7138671875
[rfa agg] iter:  4, weight: tensor([0.0142, 0.0142, 0.0152, 0.0147, 0.1646, 0.1189, 0.2028, 0.1019, 0.1500,
        0.2034])
[rfa agg] iter:  5, prev_obj_val: 9430.74609375, obj_val: 9319.662109375, abs dis: 111.083984375
[rfa agg] iter:  5, weight: tensor([0.0090, 0.0090, 0.0096, 0.0094, 0.1684, 0.1208, 0.2085, 0.1032, 0.1530,
        0.2091])
[rfa agg] iter:  6, prev_obj_val: 9319.662109375, obj_val: 9246.029296875, abs dis: 73.6328125
[rfa agg] iter:  6, weight: tensor([0.0056, 0.0057, 0.0060, 0.0059, 0.1709, 0.1211, 0.2132, 0.1032, 0.1547,
        0.2138])
[rfa agg] iter:  7, prev_obj_val: 9246.029296875, obj_val: 9198.7451171875, abs dis: 47.2841796875
[rfa agg] iter:  7, weight: tensor([0.0035, 0.0035, 0.0037, 0.0036, 0.1725, 0.1199, 0.2181, 0.1015, 0.1551,
        0.2188])
[rfa agg] iter:  8, prev_obj_val: 9198.7451171875, obj_val: 9169.7900390625, abs dis: 28.955078125
[rfa agg] iter:  8, weight: tensor([0.0020, 0.0021, 0.0022, 0.0021, 0.1733, 0.1166, 0.2246, 0.0977, 0.1540,
        0.2254])
[rfa agg] iter:  9, prev_obj_val: 9169.7900390625, obj_val: 9151.3623046875, abs dis: 18.427734375
[rfa agg] iter:  9, weight: tensor([0.0012, 0.0012, 0.0013, 0.0012, 0.1732, 0.1102, 0.2347, 0.0907, 0.1509,
        0.2354])
___Test Target_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 266: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 367.7288842201233 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:267 choose agents : [17, 33, 77, 11, 51, 32, 66, 85, 8, 2]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 17, internal_epoch   1,  Average loss: 0.0316, Accuracy: 247/526 (46.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 17, internal_epoch   2,  Average loss: 0.0138, Accuracy: 391/526 (74.3346%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 17, internal_epoch   3,  Average loss: 0.0060, Accuracy: 483/526 (91.8251%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 17, internal_epoch   4,  Average loss: 0.0044, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 17, internal_epoch   5,  Average loss: 0.0024, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 17, internal_epoch   6,  Average loss: 0.0033, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Global model norm: 37.509240397992265.
Norm before scaling: 38.22211951111392. Distance: 9.149927241135112
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 2.9654, Accuracy: 3444/10000 (34.4400%)
___Test Local_ResNet_18 poisoned: True, epoch: 267: Average loss: 0.4437, Accuracy: 7853/9000 (87.2556%)
Scaling by  100
Scaled Norm after poisoning: 914.1363068492576, distance: 914.9926912276403
Total norm for 4 adversaries is: 914.1363068492576. distance: 914.9926912276403
___Test Local_ResNet_18 poisoned: True, epoch: 267: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 33, internal_epoch   1,  Average loss: 0.0276, Accuracy: 282/527 (53.5104%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 33, internal_epoch   2,  Average loss: 0.0120, Accuracy: 412/527 (78.1784%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 33, internal_epoch   3,  Average loss: 0.0062, Accuracy: 477/527 (90.5123%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 33, internal_epoch   4,  Average loss: 0.0038, Accuracy: 491/527 (93.1689%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 33, internal_epoch   5,  Average loss: 0.0026, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 33, internal_epoch   6,  Average loss: 0.0036, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.509240397992265.
Norm before scaling: 38.381776490954174. Distance: 9.531167151919645
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 2.8841, Accuracy: 3374/10000 (33.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 267: Average loss: 0.2488, Accuracy: 8247/9000 (91.6333%)
Scaling by  100
Scaled Norm after poisoning: 952.5628260120169, distance: 953.1166966851436
Total norm for 4 adversaries is: 952.5628260120169. distance: 953.1166966851436
___Test Local_ResNet_18 poisoned: True, epoch: 267: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 77, internal_epoch   1,  Average loss: 0.0268, Accuracy: 262/496 (52.8226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 77, internal_epoch   2,  Average loss: 0.0113, Accuracy: 386/496 (77.8226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 77, internal_epoch   3,  Average loss: 0.0037, Accuracy: 470/496 (94.7581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 77, internal_epoch   4,  Average loss: 0.0018, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 77, internal_epoch   6,  Average loss: 0.0012, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Global model norm: 37.509240397992265.
Norm before scaling: 37.872867939681605. Distance: 7.2554527035261875
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 2.5210, Accuracy: 3721/10000 (37.2100%)
___Test Local_ResNet_18 poisoned: True, epoch: 267: Average loss: 0.1718, Accuracy: 8496/9000 (94.4000%)
Scaling by  100
Scaled Norm after poisoning: 724.775654944342, distance: 725.545312161825
Total norm for 4 adversaries is: 724.775654944342. distance: 725.545312161825
___Test Local_ResNet_18 poisoned: True, epoch: 267: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 11, internal_epoch   1,  Average loss: 0.0277, Accuracy: 248/546 (45.4212%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 11, internal_epoch   2,  Average loss: 0.0138, Accuracy: 396/546 (72.5275%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 11, internal_epoch   3,  Average loss: 0.0075, Accuracy: 472/546 (86.4469%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 11, internal_epoch   4,  Average loss: 0.0036, Accuracy: 521/546 (95.4212%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 11, internal_epoch   5,  Average loss: 0.0018, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 267, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.509240397992265.
Norm before scaling: 38.04482797367962. Distance: 8.179918346044122
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 2.4553, Accuracy: 3625/10000 (36.2500%)
___Test Local_ResNet_18 poisoned: True, epoch: 267: Average loss: 0.1279, Accuracy: 8641/9000 (96.0111%)
Scaling by  100
Scaled Norm after poisoning: 817.2350105691753, distance: 817.9918627345874
Total norm for 4 adversaries is: 817.2350105691753. distance: 817.9918627345874
___Test Local_ResNet_18 poisoned: True, epoch: 267: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 267, local model 51, internal_epoch   1,  Average loss: 0.0440, Accuracy: 225/479 (46.9729%)
___Train Local_ResNet_18,  epoch 267, local model 51, internal_epoch   2,  Average loss: 0.0208, Accuracy: 318/479 (66.3883%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 267, local model 32, internal_epoch   1,  Average loss: 0.0383, Accuracy: 303/824 (36.7718%)
___Train Local_ResNet_18,  epoch 267, local model 32, internal_epoch   2,  Average loss: 0.0245, Accuracy: 398/824 (48.3010%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 2.8836, Accuracy: 3095/10000 (30.9500%)
___Train Local_ResNet_18,  epoch 267, local model 66, internal_epoch   1,  Average loss: 0.0397, Accuracy: 287/555 (51.7117%)
___Train Local_ResNet_18,  epoch 267, local model 66, internal_epoch   2,  Average loss: 0.0165, Accuracy: 381/555 (68.6486%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 267, local model 85, internal_epoch   1,  Average loss: 0.0428, Accuracy: 102/364 (28.0220%)
___Train Local_ResNet_18,  epoch 267, local model 85, internal_epoch   2,  Average loss: 0.0232, Accuracy: 174/364 (47.8022%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 267, local model 8, internal_epoch   1,  Average loss: 0.0419, Accuracy: 185/534 (34.6442%)
___Train Local_ResNet_18,  epoch 267, local model 8, internal_epoch   2,  Average loss: 0.0257, Accuracy: 237/534 (44.3820%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 267, local model 2, internal_epoch   1,  Average loss: 0.0371, Accuracy: 208/461 (45.1193%)
___Train Local_ResNet_18,  epoch 267, local model 2, internal_epoch   2,  Average loss: 0.0212, Accuracy: 263/461 (57.0499%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 278.9344356060028
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.39439006024096385  data num: [526, 527, 496, 546, 479, 824, 555, 364, 534, 461]
[rfa agg] considering poison per batch poison_fraction: 0.0308117234563253
[rfa agg] init. name: [17, 33, 77, 11, 51, 32, 66, 85, 8, 2], weight: tensor([0.0990, 0.0992, 0.0934, 0.1028, 0.0902, 0.1551, 0.1045, 0.0685, 0.1005,
        0.0868])
[rfa agg] iter:  0, prev_obj_val: 11209.5576171875, obj_val: 10725.1484375, abs dis: 484.4091796875
[rfa agg] iter:  0, weight: tensor([0.0711, 0.0713, 0.0819, 0.0739, 0.1044, 0.1804, 0.1210, 0.0792, 0.1165,
        0.1004])
[rfa agg] iter:  1, prev_obj_val: 10725.1484375, obj_val: 10317.74609375, abs dis: 407.40234375
[rfa agg] iter:  1, weight: tensor([0.0518, 0.0519, 0.0580, 0.0538, 0.1166, 0.2019, 0.1353, 0.0884, 0.1301,
        0.1122])
[rfa agg] iter:  2, prev_obj_val: 10317.74609375, obj_val: 9998.5537109375, abs dis: 319.1923828125
[rfa agg] iter:  2, weight: tensor([0.0365, 0.0365, 0.0400, 0.0379, 0.1261, 0.2189, 0.1464, 0.0955, 0.1408,
        0.1214])
[rfa agg] iter:  3, prev_obj_val: 9998.5537109375, obj_val: 9761.8115234375, abs dis: 236.7421875
[rfa agg] iter:  3, weight: tensor([0.0250, 0.0250, 0.0271, 0.0259, 0.1331, 0.2319, 0.1546, 0.1006, 0.1487,
        0.1281])
[rfa agg] iter:  4, prev_obj_val: 9761.8115234375, obj_val: 9593.2763671875, abs dis: 168.53515625
[rfa agg] iter:  4, weight: tensor([0.0167, 0.0168, 0.0180, 0.0174, 0.1379, 0.2418, 0.1604, 0.1040, 0.1543,
        0.1327])
[rfa agg] iter:  5, prev_obj_val: 9593.2763671875, obj_val: 9475.884765625, abs dis: 117.3916015625
[rfa agg] iter:  5, weight: tensor([0.0110, 0.0110, 0.0118, 0.0114, 0.1410, 0.2496, 0.1643, 0.1060, 0.1581,
        0.1357])
[rfa agg] iter:  6, prev_obj_val: 9475.884765625, obj_val: 9397.3203125, abs dis: 78.564453125
[rfa agg] iter:  6, weight: tensor([0.0071, 0.0071, 0.0076, 0.0074, 0.1428, 0.2566, 0.1668, 0.1067, 0.1605,
        0.1374])
[rfa agg] iter:  7, prev_obj_val: 9397.3203125, obj_val: 9345.2822265625, abs dis: 52.0380859375
[rfa agg] iter:  7, weight: tensor([0.0045, 0.0045, 0.0048, 0.0047, 0.1433, 0.2640, 0.1682, 0.1061, 0.1619,
        0.1379])
[rfa agg] iter:  8, prev_obj_val: 9345.2822265625, obj_val: 9311.2578125, abs dis: 34.0244140625
[rfa agg] iter:  8, weight: tensor([0.0028, 0.0028, 0.0030, 0.0029, 0.1425, 0.2737, 0.1687, 0.1040, 0.1623,
        0.1372])
[rfa agg] iter:  9, prev_obj_val: 9311.2578125, obj_val: 9288.6484375, abs dis: 22.609375
[rfa agg] iter:  9, weight: tensor([0.0017, 0.0017, 0.0018, 0.0018, 0.1400, 0.2890, 0.1678, 0.0997, 0.1615,
        0.1348])
___Test Target_ResNet_18 poisoned: False, epoch: 267: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 267: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 353.85568737983704 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:268 choose agents : [17, 33, 77, 11, 40, 10, 91, 59, 80, 32]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 17, internal_epoch   1,  Average loss: 0.0237, Accuracy: 304/526 (57.7947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 17, internal_epoch   2,  Average loss: 0.0104, Accuracy: 441/526 (83.8403%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 17, internal_epoch   3,  Average loss: 0.0058, Accuracy: 474/526 (90.1141%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 17, internal_epoch   4,  Average loss: 0.0041, Accuracy: 493/526 (93.7262%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 17, internal_epoch   5,  Average loss: 0.0027, Accuracy: 508/526 (96.5779%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 17, internal_epoch   6,  Average loss: 0.0014, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 37.42150802273089.
Norm before scaling: 38.5353350303126. Distance: 10.235582213509485
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 2.7150, Accuracy: 3595/10000 (35.9500%)
___Test Local_ResNet_18 poisoned: True, epoch: 268: Average loss: 0.2281, Accuracy: 8355/9000 (92.8333%)
Scaling by  100
Scaled Norm after poisoning: 1023.2572684813922, distance: 1023.558254326543
Total norm for 4 adversaries is: 1023.2572684813922. distance: 1023.558254326543
___Test Local_ResNet_18 poisoned: True, epoch: 268: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 33, internal_epoch   1,  Average loss: 0.0203, Accuracy: 347/527 (65.8444%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 33, internal_epoch   2,  Average loss: 0.0096, Accuracy: 428/527 (81.2144%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 33, internal_epoch   3,  Average loss: 0.0057, Accuracy: 467/527 (88.6148%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 33, internal_epoch   4,  Average loss: 0.0043, Accuracy: 491/527 (93.1689%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 33, internal_epoch   5,  Average loss: 0.0028, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 33, internal_epoch   6,  Average loss: 0.0021, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Global model norm: 37.42150802273089.
Norm before scaling: 38.68491099727628. Distance: 10.565570091684815
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 3.2921, Accuracy: 2909/10000 (29.0900%)
___Test Local_ResNet_18 poisoned: True, epoch: 268: Average loss: 0.0696, Accuracy: 8747/9000 (97.1889%)
Scaling by  100
Scaled Norm after poisoning: 1056.4871627237123, distance: 1056.5569672289328
Total norm for 4 adversaries is: 1056.4871627237123. distance: 1056.5569672289328
___Test Local_ResNet_18 poisoned: True, epoch: 268: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 77, internal_epoch   1,  Average loss: 0.0188, Accuracy: 313/496 (63.1048%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 77, internal_epoch   2,  Average loss: 0.0068, Accuracy: 431/496 (86.8952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 77, internal_epoch   3,  Average loss: 0.0025, Accuracy: 476/496 (95.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 77, internal_epoch   4,  Average loss: 0.0017, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 77, internal_epoch   5,  Average loss: 0.0018, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 77, internal_epoch   6,  Average loss: 0.0016, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Global model norm: 37.42150802273089.
Norm before scaling: 37.79778413282401. Distance: 7.048390836567576
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 2.4492, Accuracy: 3654/10000 (36.5400%)
___Test Local_ResNet_18 poisoned: True, epoch: 268: Average loss: 0.0441, Accuracy: 8858/9000 (98.4222%)
Scaling by  100
Scaled Norm after poisoning: 704.3158914861996, distance: 704.8391217150195
Total norm for 4 adversaries is: 704.3158914861996. distance: 704.8391217150195
___Test Local_ResNet_18 poisoned: True, epoch: 268: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 11, internal_epoch   1,  Average loss: 0.0225, Accuracy: 302/546 (55.3114%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 474/546 (86.8132%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 11, internal_epoch   3,  Average loss: 0.0033, Accuracy: 520/546 (95.2381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 11, internal_epoch   4,  Average loss: 0.0012, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 11, internal_epoch   5,  Average loss: 0.0007, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 268, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.42150802273089.
Norm before scaling: 37.87792312874183. Distance: 7.607400814316162
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 2.4999, Accuracy: 3865/10000 (38.6500%)
___Test Local_ResNet_18 poisoned: True, epoch: 268: Average loss: 0.0535, Accuracy: 8840/9000 (98.2222%)
Scaling by  100
Scaled Norm after poisoning: 760.1154106449889, distance: 760.7401001656216
Total norm for 4 adversaries is: 760.1154106449889. distance: 760.7401001656216
___Test Local_ResNet_18 poisoned: True, epoch: 268: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 268, local model 40, internal_epoch   1,  Average loss: 0.0276, Accuracy: 319/652 (48.9264%)
___Train Local_ResNet_18,  epoch 268, local model 40, internal_epoch   2,  Average loss: 0.0180, Accuracy: 418/652 (64.1104%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 268, local model 10, internal_epoch   1,  Average loss: 0.0268, Accuracy: 446/752 (59.3085%)
___Train Local_ResNet_18,  epoch 268, local model 10, internal_epoch   2,  Average loss: 0.0170, Accuracy: 532/752 (70.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 17.0951, Accuracy: 1023/10000 (10.2300%)
___Train Local_ResNet_18,  epoch 268, local model 91, internal_epoch   1,  Average loss: 0.0514, Accuracy: 50/234 (21.3675%)
___Train Local_ResNet_18,  epoch 268, local model 91, internal_epoch   2,  Average loss: 0.0175, Accuracy: 148/234 (63.2479%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 268, local model 59, internal_epoch   1,  Average loss: 0.0352, Accuracy: 300/642 (46.7290%)
___Train Local_ResNet_18,  epoch 268, local model 59, internal_epoch   2,  Average loss: 0.0284, Accuracy: 287/642 (44.7040%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 268, local model 80, internal_epoch   1,  Average loss: 0.0350, Accuracy: 174/363 (47.9339%)
___Train Local_ResNet_18,  epoch 268, local model 80, internal_epoch   2,  Average loss: 0.0149, Accuracy: 277/363 (76.3085%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 268, local model 32, internal_epoch   1,  Average loss: 0.0324, Accuracy: 324/824 (39.3204%)
___Train Local_ResNet_18,  epoch 268, local model 32, internal_epoch   2,  Average loss: 0.0217, Accuracy: 449/824 (54.4903%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 306.8710675239563
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.37666307083782813  data num: [526, 527, 496, 546, 652, 752, 234, 642, 363, 824]
[rfa agg] considering poison per batch poison_fraction: 0.029426802409205324
[rfa agg] init. name: [17, 33, 77, 11, 40, 10, 91, 59, 80, 32], weight: tensor([0.0946, 0.0948, 0.0892, 0.0982, 0.1172, 0.1352, 0.0421, 0.1154, 0.0653,
        0.1481])
[rfa agg] iter:  0, prev_obj_val: 11009.1865234375, obj_val: 10370.8740234375, abs dis: 638.3125
[rfa agg] iter:  0, weight: tensor([0.0640, 0.0641, 0.0732, 0.0665, 0.1377, 0.1590, 0.0491, 0.1356, 0.0763,
        0.1744])
[rfa agg] iter:  1, prev_obj_val: 10370.8740234375, obj_val: 9866.6640625, abs dis: 504.2099609375
[rfa agg] iter:  1, weight: tensor([0.0433, 0.0434, 0.0481, 0.0450, 0.1543, 0.1782, 0.0548, 0.1519, 0.0853,
        0.1956])
[rfa agg] iter:  2, prev_obj_val: 9866.6640625, obj_val: 9499.6640625, abs dis: 367.0
[rfa agg] iter:  2, weight: tensor([0.0282, 0.0282, 0.0307, 0.0293, 0.1663, 0.1922, 0.0588, 0.1637, 0.0916,
        0.2111])
[rfa agg] iter:  3, prev_obj_val: 9499.6640625, obj_val: 9247.671875, abs dis: 251.9921875
[rfa agg] iter:  3, weight: tensor([0.0177, 0.0178, 0.0191, 0.0184, 0.1745, 0.2019, 0.0612, 0.1718, 0.0956,
        0.2220])
[rfa agg] iter:  4, prev_obj_val: 9247.671875, obj_val: 9084.123046875, abs dis: 163.548828125
[rfa agg] iter:  4, weight: tensor([0.0108, 0.0109, 0.0116, 0.0113, 0.1799, 0.2087, 0.0622, 0.1772, 0.0976,
        0.2299])
[rfa agg] iter:  5, prev_obj_val: 9084.123046875, obj_val: 8984.6845703125, abs dis: 99.4384765625
[rfa agg] iter:  5, weight: tensor([0.0065, 0.0065, 0.0069, 0.0067, 0.1834, 0.2135, 0.0620, 0.1806, 0.0978,
        0.2360])
[rfa agg] iter:  6, prev_obj_val: 8984.6845703125, obj_val: 8921.759765625, abs dis: 62.9248046875
[rfa agg] iter:  6, weight: tensor([0.0039, 0.0039, 0.0041, 0.0040, 0.1856, 0.2173, 0.0604, 0.1828, 0.0963,
        0.2417])
[rfa agg] iter:  7, prev_obj_val: 8921.759765625, obj_val: 8884.2998046875, abs dis: 37.4599609375
[rfa agg] iter:  7, weight: tensor([0.0022, 0.0023, 0.0024, 0.0023, 0.1870, 0.2212, 0.0570, 0.1841, 0.0924,
        0.2490])
[rfa agg] iter:  8, prev_obj_val: 8884.2998046875, obj_val: 8860.2587890625, abs dis: 24.041015625
[rfa agg] iter:  8, weight: tensor([0.0013, 0.0013, 0.0014, 0.0013, 0.1875, 0.2258, 0.0514, 0.1846, 0.0855,
        0.2601])
[rfa agg] iter:  9, prev_obj_val: 8860.2587890625, obj_val: 8846.6650390625, abs dis: 13.59375
[rfa agg] iter:  9, weight: tensor([0.0006, 0.0006, 0.0007, 0.0007, 0.1856, 0.2317, 0.0416, 0.1827, 0.0723,
        0.2835])
___Test Target_ResNet_18 poisoned: False, epoch: 268: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 268: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 390.58381748199463 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:269 choose agents : [17, 33, 77, 11, 16, 83, 57, 96, 3, 10]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 17, internal_epoch   1,  Average loss: 0.0197, Accuracy: 322/526 (61.2167%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 17, internal_epoch   2,  Average loss: 0.0070, Accuracy: 465/526 (88.4030%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 17, internal_epoch   3,  Average loss: 0.0038, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 17, internal_epoch   4,  Average loss: 0.0041, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 17, internal_epoch   5,  Average loss: 0.0049, Accuracy: 492/526 (93.5361%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 17, internal_epoch   6,  Average loss: 0.0048, Accuracy: 493/526 (93.7262%), train_poison_data_count: 45
Global model norm: 37.36096948709475.
Norm before scaling: 38.41048339158204. Distance: 9.781593194857752
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 3.2611, Accuracy: 3460/10000 (34.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 269: Average loss: 0.2008, Accuracy: 8504/9000 (94.4889%)
Scaling by  100
Scaled Norm after poisoning: 978.0470016824345, distance: 978.1593045102622
Total norm for 4 adversaries is: 978.0470016824345. distance: 978.1593045102622
___Test Local_ResNet_18 poisoned: True, epoch: 269: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 33, internal_epoch   1,  Average loss: 0.0185, Accuracy: 369/527 (70.0190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 33, internal_epoch   2,  Average loss: 0.0069, Accuracy: 474/527 (89.9431%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 33, internal_epoch   3,  Average loss: 0.0037, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 33, internal_epoch   4,  Average loss: 0.0034, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 33, internal_epoch   5,  Average loss: 0.0036, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 33, internal_epoch   6,  Average loss: 0.0028, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Global model norm: 37.36096948709475.
Norm before scaling: 38.077660158221384. Distance: 8.514944066812037
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 2.7026, Accuracy: 3490/10000 (34.9000%)
___Test Local_ResNet_18 poisoned: True, epoch: 269: Average loss: 0.0985, Accuracy: 8690/9000 (96.5556%)
Scaling by  100
Scaled Norm after poisoning: 851.2312773271433, distance: 851.494348190286
Total norm for 4 adversaries is: 851.2312773271433. distance: 851.494348190286
___Test Local_ResNet_18 poisoned: True, epoch: 269: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 77, internal_epoch   1,  Average loss: 0.0156, Accuracy: 332/496 (66.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 461/496 (92.9435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 77, internal_epoch   3,  Average loss: 0.0024, Accuracy: 477/496 (96.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 77, internal_epoch   4,  Average loss: 0.0013, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 77, internal_epoch   5,  Average loss: 0.0007, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 77, internal_epoch   6,  Average loss: 0.0010, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.36096948709475.
Norm before scaling: 37.6696131631236. Distance: 6.383839182651842
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 3.1288, Accuracy: 3287/10000 (32.8700%)
___Test Local_ResNet_18 poisoned: True, epoch: 269: Average loss: 0.0597, Accuracy: 8828/9000 (98.0889%)
Scaling by  100
Scaled Norm after poisoning: 638.0989588222191, distance: 638.3839215158853
Total norm for 4 adversaries is: 638.0989588222191. distance: 638.3839215158853
___Test Local_ResNet_18 poisoned: True, epoch: 269: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 11, internal_epoch   1,  Average loss: 0.0200, Accuracy: 316/546 (57.8755%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 488/546 (89.3773%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 11, internal_epoch   3,  Average loss: 0.0029, Accuracy: 521/546 (95.4212%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 11, internal_epoch   4,  Average loss: 0.0023, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 269, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.36096948709475.
Norm before scaling: 38.00593119059264. Distance: 8.263899682587343
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 2.8724, Accuracy: 3585/10000 (35.8500%)
___Test Local_ResNet_18 poisoned: True, epoch: 269: Average loss: 0.0379, Accuracy: 8883/9000 (98.7000%)
Scaling by  100
Scaled Norm after poisoning: 826.0436580472003, distance: 826.3900032672225
Total norm for 4 adversaries is: 826.0436580472003. distance: 826.3900032672225
___Test Local_ResNet_18 poisoned: True, epoch: 269: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 269, local model 16, internal_epoch   1,  Average loss: 0.0299, Accuracy: 348/773 (45.0194%)
___Train Local_ResNet_18,  epoch 269, local model 16, internal_epoch   2,  Average loss: 0.0217, Accuracy: 469/773 (60.6727%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 269, local model 83, internal_epoch   1,  Average loss: 0.0350, Accuracy: 123/366 (33.6066%)
___Train Local_ResNet_18,  epoch 269, local model 83, internal_epoch   2,  Average loss: 0.0172, Accuracy: 239/366 (65.3005%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 269, local model 57, internal_epoch   1,  Average loss: 0.0294, Accuracy: 120/290 (41.3793%)
___Train Local_ResNet_18,  epoch 269, local model 57, internal_epoch   2,  Average loss: 0.0126, Accuracy: 205/290 (70.6897%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 269, local model 96, internal_epoch   1,  Average loss: 0.0277, Accuracy: 331/708 (46.7514%)
___Train Local_ResNet_18,  epoch 269, local model 96, internal_epoch   2,  Average loss: 0.0190, Accuracy: 410/708 (57.9096%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 269, local model 3, internal_epoch   1,  Average loss: 0.0243, Accuracy: 455/780 (58.3333%)
___Train Local_ResNet_18,  epoch 269, local model 3, internal_epoch   2,  Average loss: 0.0154, Accuracy: 516/780 (66.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 6.6983, Accuracy: 2287/10000 (22.8700%)
___Train Local_ResNet_18,  epoch 269, local model 10, internal_epoch   1,  Average loss: 0.0208, Accuracy: 477/752 (63.4309%)
___Train Local_ResNet_18,  epoch 269, local model 10, internal_epoch   2,  Average loss: 0.0087, Accuracy: 614/752 (81.6489%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 298.7782723903656
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.36346287300485774  data num: [526, 527, 496, 546, 773, 366, 290, 708, 780, 752]
[rfa agg] considering poison per batch poison_fraction: 0.02839553695350451
[rfa agg] init. name: [17, 33, 77, 11, 16, 83, 57, 96, 3, 10], weight: tensor([0.0913, 0.0914, 0.0861, 0.0947, 0.1341, 0.0635, 0.0503, 0.1228, 0.1353,
        0.1305])
[rfa agg] iter:  0, prev_obj_val: 10840.6044921875, obj_val: 10083.154296875, abs dis: 757.4501953125
[rfa agg] iter:  0, weight: tensor([0.0588, 0.0590, 0.0671, 0.0611, 0.1591, 0.0748, 0.0592, 0.1456, 0.1606,
        0.1547])
[rfa agg] iter:  1, prev_obj_val: 10083.154296875, obj_val: 9509.4599609375, abs dis: 573.6943359375
[rfa agg] iter:  1, weight: tensor([0.0377, 0.0378, 0.0417, 0.0391, 0.1782, 0.0835, 0.0660, 0.1630, 0.1799,
        0.1731])
[rfa agg] iter:  2, prev_obj_val: 9509.4599609375, obj_val: 9119.3134765625, abs dis: 390.146484375
[rfa agg] iter:  2, weight: tensor([0.0230, 0.0230, 0.0250, 0.0239, 0.1915, 0.0891, 0.0705, 0.1750, 0.1933,
        0.1859])
[rfa agg] iter:  3, prev_obj_val: 9119.3134765625, obj_val: 8872.2880859375, abs dis: 247.025390625
[rfa agg] iter:  3, weight: tensor([0.0136, 0.0136, 0.0146, 0.0141, 0.2003, 0.0922, 0.0728, 0.1827, 0.2021,
        0.1941])
[rfa agg] iter:  4, prev_obj_val: 8872.2880859375, obj_val: 8720.6669921875, abs dis: 151.62109375
[rfa agg] iter:  4, weight: tensor([0.0079, 0.0079, 0.0084, 0.0082, 0.2063, 0.0931, 0.0733, 0.1876, 0.2082,
        0.1993])
[rfa agg] iter:  5, prev_obj_val: 8720.6669921875, obj_val: 8627.7646484375, abs dis: 92.90234375
[rfa agg] iter:  5, weight: tensor([0.0044, 0.0044, 0.0047, 0.0046, 0.2111, 0.0919, 0.0720, 0.1909, 0.2130,
        0.2028])
[rfa agg] iter:  6, prev_obj_val: 8627.7646484375, obj_val: 8575.240234375, abs dis: 52.5244140625
[rfa agg] iter:  6, weight: tensor([0.0024, 0.0024, 0.0025, 0.0025, 0.2164, 0.0880, 0.0683, 0.1936, 0.2183,
        0.2057])
[rfa agg] iter:  7, prev_obj_val: 8575.240234375, obj_val: 8543.623046875, abs dis: 31.6171875
[rfa agg] iter:  7, weight: tensor([0.0012, 0.0012, 0.0013, 0.0012, 0.2242, 0.0797, 0.0609, 0.1960, 0.2262,
        0.2082])
[rfa agg] iter:  8, prev_obj_val: 8543.623046875, obj_val: 8528.58984375, abs dis: 15.033203125
[rfa agg] iter:  8, weight: tensor([0.0005, 0.0005, 0.0005, 0.0005, 0.2416, 0.0613, 0.0456, 0.1968, 0.2435,
        0.2092])
[rfa agg] iter:  9, prev_obj_val: 8528.58984375, obj_val: 8534.6123046875, abs dis: 6.0224609375
[rfa agg] iter:  9, weight: tensor([1.3169e-04, 1.3197e-04, 1.3985e-04, 1.3674e-04, 2.9509e-01, 2.8817e-02,
        2.0453e-02, 1.7571e-01, 2.9129e-01, 1.8810e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 269: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 269: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 390.17665433883667 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:270 choose agents : [17, 33, 77, 11, 15, 14, 29, 50, 36, 2]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 17, internal_epoch   1,  Average loss: 0.0183, Accuracy: 341/526 (64.8289%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 17, internal_epoch   2,  Average loss: 0.0076, Accuracy: 466/526 (88.5932%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 17, internal_epoch   3,  Average loss: 0.0056, Accuracy: 485/526 (92.2053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 17, internal_epoch   4,  Average loss: 0.0037, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 17, internal_epoch   5,  Average loss: 0.0030, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 17, internal_epoch   6,  Average loss: 0.0018, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Global model norm: 37.32073035274765.
Norm before scaling: 38.26222103581743. Distance: 9.417028189501984
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 3.2507, Accuracy: 3335/10000 (33.3500%)
___Test Local_ResNet_18 poisoned: True, epoch: 270: Average loss: 0.1335, Accuracy: 8524/9000 (94.7111%)
Scaling by  100
Scaled Norm after poisoning: 941.5121480894445, distance: 941.7028459126584
Total norm for 4 adversaries is: 941.5121480894445. distance: 941.7028459126584
___Test Local_ResNet_18 poisoned: True, epoch: 270: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 33, internal_epoch   1,  Average loss: 0.0168, Accuracy: 367/527 (69.6395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 485/527 (92.0304%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 33, internal_epoch   3,  Average loss: 0.0051, Accuracy: 494/527 (93.7381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 33, internal_epoch   4,  Average loss: 0.0064, Accuracy: 467/527 (88.6148%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 33, internal_epoch   5,  Average loss: 0.0036, Accuracy: 493/527 (93.5484%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 33, internal_epoch   6,  Average loss: 0.0027, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Global model norm: 37.32073035274765.
Norm before scaling: 38.26642889110669. Distance: 9.197637038914364
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 2.9247, Accuracy: 3508/10000 (35.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 270: Average loss: 0.1034, Accuracy: 8689/9000 (96.5444%)
Scaling by  100
Scaled Norm after poisoning: 919.8079962687865, distance: 919.7636924775842
Total norm for 4 adversaries is: 919.8079962687865. distance: 919.7636924775842
___Test Local_ResNet_18 poisoned: True, epoch: 270: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 77, internal_epoch   1,  Average loss: 0.0139, Accuracy: 364/496 (73.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 77, internal_epoch   2,  Average loss: 0.0038, Accuracy: 463/496 (93.3468%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 77, internal_epoch   3,  Average loss: 0.0019, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 77, internal_epoch   4,  Average loss: 0.0012, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 77, internal_epoch   6,  Average loss: 0.0012, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.32073035274765.
Norm before scaling: 37.50762943222352. Distance: 5.722096282330263
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 2.3816, Accuracy: 3887/10000 (38.8700%)
___Test Local_ResNet_18 poisoned: True, epoch: 270: Average loss: 0.0783, Accuracy: 8758/9000 (97.3111%)
Scaling by  100
Scaled Norm after poisoning: 571.7876299378993, distance: 572.2095879133799
Total norm for 4 adversaries is: 571.7876299378993. distance: 572.2095879133799
___Test Local_ResNet_18 poisoned: True, epoch: 270: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 11, internal_epoch   1,  Average loss: 0.0183, Accuracy: 351/546 (64.2857%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 11, internal_epoch   2,  Average loss: 0.0051, Accuracy: 501/546 (91.7582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 11, internal_epoch   3,  Average loss: 0.0031, Accuracy: 518/546 (94.8718%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 11, internal_epoch   4,  Average loss: 0.0025, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 11, internal_epoch   5,  Average loss: 0.0017, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 270, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.32073035274765.
Norm before scaling: 37.79353863426922. Distance: 7.430355198457483
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 2.8569, Accuracy: 3632/10000 (36.3200%)
___Test Local_ResNet_18 poisoned: True, epoch: 270: Average loss: 0.1486, Accuracy: 8642/9000 (96.0222%)
Scaling by  100
Scaled Norm after poisoning: 742.6474180255392, distance: 743.0355812476278
Total norm for 4 adversaries is: 742.6474180255392. distance: 743.0355812476278
___Test Local_ResNet_18 poisoned: True, epoch: 270: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 270, local model 15, internal_epoch   1,  Average loss: 0.0271, Accuracy: 187/341 (54.8387%)
___Train Local_ResNet_18,  epoch 270, local model 15, internal_epoch   2,  Average loss: 0.0114, Accuracy: 267/341 (78.2991%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 270, local model 14, internal_epoch   1,  Average loss: 0.0245, Accuracy: 153/318 (48.1132%)
___Train Local_ResNet_18,  epoch 270, local model 14, internal_epoch   2,  Average loss: 0.0109, Accuracy: 252/318 (79.2453%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 270, local model 29, internal_epoch   1,  Average loss: 0.0254, Accuracy: 501/848 (59.0802%)
___Train Local_ResNet_18,  epoch 270, local model 29, internal_epoch   2,  Average loss: 0.0146, Accuracy: 624/848 (73.5849%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 5.2880, Accuracy: 1435/10000 (14.3500%)
___Train Local_ResNet_18,  epoch 270, local model 50, internal_epoch   1,  Average loss: 0.0266, Accuracy: 220/401 (54.8628%)
___Train Local_ResNet_18,  epoch 270, local model 50, internal_epoch   2,  Average loss: 0.0142, Accuracy: 301/401 (75.0623%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 270, local model 36, internal_epoch   1,  Average loss: 0.0291, Accuracy: 338/849 (39.8115%)
___Train Local_ResNet_18,  epoch 270, local model 36, internal_epoch   2,  Average loss: 0.0181, Accuracy: 509/849 (59.9529%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 270, local model 2, internal_epoch   1,  Average loss: 0.0244, Accuracy: 260/461 (56.3991%)
___Train Local_ResNet_18,  epoch 270, local model 2, internal_epoch   2,  Average loss: 0.0165, Accuracy: 316/461 (68.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 290.42742109298706
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3943158290984378  data num: [526, 527, 496, 546, 341, 318, 848, 401, 849, 461]
[rfa agg] considering poison per batch poison_fraction: 0.030805924148315456
[rfa agg] init. name: [17, 33, 77, 11, 15, 14, 29, 50, 36, 2], weight: tensor([0.0990, 0.0992, 0.0934, 0.1028, 0.0642, 0.0599, 0.1596, 0.0755, 0.1598,
        0.0868])
[rfa agg] iter:  0, prev_obj_val: 11195.423828125, obj_val: 10711.123046875, abs dis: 484.30078125
[rfa agg] iter:  0, weight: tensor([0.0711, 0.0712, 0.0819, 0.0739, 0.0741, 0.0690, 0.1856, 0.0872, 0.1858,
        0.1003])
[rfa agg] iter:  1, prev_obj_val: 10711.123046875, obj_val: 10302.8525390625, abs dis: 408.2705078125
[rfa agg] iter:  1, weight: tensor([0.0518, 0.0519, 0.0580, 0.0538, 0.0827, 0.0770, 0.2077, 0.0973, 0.2079,
        0.1120])
[rfa agg] iter:  2, prev_obj_val: 10302.8525390625, obj_val: 9983.7099609375, abs dis: 319.142578125
[rfa agg] iter:  2, weight: tensor([0.0364, 0.0365, 0.0400, 0.0378, 0.0893, 0.0831, 0.2252, 0.1052, 0.2255,
        0.1211])
[rfa agg] iter:  3, prev_obj_val: 9983.7099609375, obj_val: 9746.99609375, abs dis: 236.7138671875
[rfa agg] iter:  3, weight: tensor([0.0249, 0.0249, 0.0270, 0.0258, 0.0940, 0.0874, 0.2386, 0.1108, 0.2388,
        0.1277])
[rfa agg] iter:  4, prev_obj_val: 9746.99609375, obj_val: 9578.474609375, abs dis: 168.521484375
[rfa agg] iter:  4, weight: tensor([0.0167, 0.0167, 0.0179, 0.0173, 0.0970, 0.0901, 0.2486, 0.1145, 0.2489,
        0.1321])
[rfa agg] iter:  5, prev_obj_val: 9578.474609375, obj_val: 9463.9296875, abs dis: 114.544921875
[rfa agg] iter:  5, weight: tensor([0.0109, 0.0110, 0.0117, 0.0114, 0.0986, 0.0915, 0.2566, 0.1166, 0.2569,
        0.1348])
[rfa agg] iter:  6, prev_obj_val: 9463.9296875, obj_val: 9385.3671875, abs dis: 78.5625
[rfa agg] iter:  6, weight: tensor([0.0071, 0.0072, 0.0076, 0.0074, 0.0989, 0.0915, 0.2634, 0.1173, 0.2637,
        0.1359])
[rfa agg] iter:  7, prev_obj_val: 9385.3671875, obj_val: 9332.3759765625, abs dis: 52.9912109375
[rfa agg] iter:  7, weight: tensor([0.0046, 0.0046, 0.0049, 0.0047, 0.0978, 0.0900, 0.2705, 0.1165, 0.2709,
        0.1356])
[rfa agg] iter:  8, prev_obj_val: 9332.3759765625, obj_val: 9297.3896484375, abs dis: 34.986328125
[rfa agg] iter:  8, weight: tensor([0.0028, 0.0028, 0.0030, 0.0029, 0.0948, 0.0867, 0.2797, 0.1138, 0.2800,
        0.1334])
[rfa agg] iter:  9, prev_obj_val: 9297.3896484375, obj_val: 9276.6259765625, abs dis: 20.763671875
[rfa agg] iter:  9, weight: tensor([0.0017, 0.0017, 0.0018, 0.0017, 0.0890, 0.0805, 0.2935, 0.1080, 0.2939,
        0.1282])
___Test Target_ResNet_18 poisoned: False, epoch: 270: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 270: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 371.8271629810333 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:271 choose agents : [17, 33, 77, 11, 0, 94, 1, 38, 41, 82]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 17, internal_epoch   1,  Average loss: 0.0141, Accuracy: 391/526 (74.3346%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 17, internal_epoch   2,  Average loss: 0.0064, Accuracy: 481/526 (91.4449%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 17, internal_epoch   3,  Average loss: 0.0039, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 17, internal_epoch   4,  Average loss: 0.0044, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 17, internal_epoch   5,  Average loss: 0.0035, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 17, internal_epoch   6,  Average loss: 0.0027, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Global model norm: 37.274027813130985.
Norm before scaling: 38.14711992784072. Distance: 9.030580066793796
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 3.0595, Accuracy: 3501/10000 (35.0100%)
___Test Local_ResNet_18 poisoned: True, epoch: 271: Average loss: 0.1257, Accuracy: 8567/9000 (95.1889%)
Scaling by  100
Scaled Norm after poisoning: 902.95777863641, distance: 903.0579300354989
Total norm for 4 adversaries is: 902.95777863641. distance: 903.0579300354989
___Test Local_ResNet_18 poisoned: True, epoch: 271: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 33, internal_epoch   1,  Average loss: 0.0139, Accuracy: 417/527 (79.1271%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 33, internal_epoch   2,  Average loss: 0.0055, Accuracy: 478/527 (90.7021%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 33, internal_epoch   3,  Average loss: 0.0054, Accuracy: 487/527 (92.4099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 33, internal_epoch   4,  Average loss: 0.0075, Accuracy: 482/527 (91.4611%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 33, internal_epoch   5,  Average loss: 0.0073, Accuracy: 478/527 (90.7021%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 33, internal_epoch   6,  Average loss: 0.0049, Accuracy: 477/527 (90.5123%), train_poison_data_count: 45
Global model norm: 37.274027813130985.
Norm before scaling: 38.523401851788414. Distance: 10.25113280944858
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 3.6866, Accuracy: 2683/10000 (26.8300%)
___Test Local_ResNet_18 poisoned: True, epoch: 271: Average loss: 0.1591, Accuracy: 8493/9000 (94.3667%)
Scaling by  100
Scaled Norm after poisoning: 1025.2842898435536, distance: 1025.1133473913994
Total norm for 4 adversaries is: 1025.2842898435536. distance: 1025.1133473913994
___Test Local_ResNet_18 poisoned: True, epoch: 271: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 77, internal_epoch   1,  Average loss: 0.0108, Accuracy: 390/496 (78.6290%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 77, internal_epoch   2,  Average loss: 0.0024, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 77, internal_epoch   3,  Average loss: 0.0015, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 77, internal_epoch   4,  Average loss: 0.0012, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.274027813130985.
Norm before scaling: 37.40886876014914. Distance: 5.258181962838609
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 2.2653, Accuracy: 4214/10000 (42.1400%)
___Test Local_ResNet_18 poisoned: True, epoch: 271: Average loss: 0.0845, Accuracy: 8767/9000 (97.4111%)
Scaling by  100
Scaled Norm after poisoning: 525.4677380677143, distance: 525.8182314260318
Total norm for 4 adversaries is: 525.4677380677143. distance: 525.8182314260318
___Test Local_ResNet_18 poisoned: True, epoch: 271: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 11, internal_epoch   1,  Average loss: 0.0136, Accuracy: 401/546 (73.4432%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 11, internal_epoch   2,  Average loss: 0.0034, Accuracy: 510/546 (93.4066%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 11, internal_epoch   3,  Average loss: 0.0021, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 11, internal_epoch   4,  Average loss: 0.0015, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 271, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.274027813130985.
Norm before scaling: 37.753002325249746. Distance: 7.344393308342559
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 2.5503, Accuracy: 4040/10000 (40.4000%)
___Test Local_ResNet_18 poisoned: True, epoch: 271: Average loss: 0.0969, Accuracy: 8763/9000 (97.3667%)
Scaling by  100
Scaled Norm after poisoning: 734.1594683718245, distance: 734.4393695193634
Total norm for 4 adversaries is: 734.1594683718245. distance: 734.4393695193634
___Test Local_ResNet_18 poisoned: True, epoch: 271: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 271, local model 0, internal_epoch   1,  Average loss: 0.0257, Accuracy: 156/367 (42.5068%)
___Train Local_ResNet_18,  epoch 271, local model 0, internal_epoch   2,  Average loss: 0.0099, Accuracy: 295/367 (80.3815%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 271, local model 94, internal_epoch   1,  Average loss: 0.0255, Accuracy: 119/203 (58.6207%)
___Train Local_ResNet_18,  epoch 271, local model 94, internal_epoch   2,  Average loss: 0.0111, Accuracy: 169/203 (83.2512%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 271, local model 1, internal_epoch   1,  Average loss: 0.0273, Accuracy: 323/641 (50.3900%)
___Train Local_ResNet_18,  epoch 271, local model 1, internal_epoch   2,  Average loss: 0.0182, Accuracy: 411/641 (64.1186%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 3.1106, Accuracy: 2883/10000 (28.8300%)
___Train Local_ResNet_18,  epoch 271, local model 38, internal_epoch   1,  Average loss: 0.0253, Accuracy: 373/756 (49.3386%)
___Train Local_ResNet_18,  epoch 271, local model 38, internal_epoch   2,  Average loss: 0.0132, Accuracy: 544/756 (71.9577%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 3.7488, Accuracy: 3171/10000 (31.7100%)
___Train Local_ResNet_18,  epoch 271, local model 41, internal_epoch   1,  Average loss: 0.0179, Accuracy: 326/513 (63.5478%)
___Train Local_ResNet_18,  epoch 271, local model 41, internal_epoch   2,  Average loss: 0.0094, Accuracy: 423/513 (82.4561%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 271, local model 82, internal_epoch   1,  Average loss: 0.0207, Accuracy: 379/601 (63.0616%)
___Train Local_ResNet_18,  epoch 271, local model 82, internal_epoch   2,  Average loss: 0.0104, Accuracy: 469/601 (78.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 287.99679374694824
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4047527047913447  data num: [526, 527, 496, 546, 367, 203, 641, 756, 513, 601]
[rfa agg] considering poison per batch poison_fraction: 0.031621305061823805
[rfa agg] init. name: [17, 33, 77, 11, 0, 94, 1, 38, 41, 82], weight: tensor([0.1016, 0.1018, 0.0958, 0.1055, 0.0709, 0.0392, 0.1238, 0.1461, 0.0991,
        0.1161])
[rfa agg] iter:  0, prev_obj_val: 11296.0068359375, obj_val: 10896.1044921875, abs dis: 399.90234375
[rfa agg] iter:  0, weight: tensor([0.0754, 0.0755, 0.0872, 0.0783, 0.0812, 0.0448, 0.1424, 0.1681, 0.1138,
        0.1334])
[rfa agg] iter:  1, prev_obj_val: 10896.1044921875, obj_val: 10548.541015625, abs dis: 347.5634765625
[rfa agg] iter:  1, weight: tensor([0.0572, 0.0573, 0.0643, 0.0594, 0.0903, 0.0498, 0.1587, 0.1874, 0.1267,
        0.1486])
[rfa agg] iter:  2, prev_obj_val: 10548.541015625, obj_val: 10265.115234375, abs dis: 283.42578125
[rfa agg] iter:  2, weight: tensor([0.0421, 0.0422, 0.0465, 0.0437, 0.0978, 0.0539, 0.1721, 0.2033, 0.1373,
        0.1611])
[rfa agg] iter:  3, prev_obj_val: 10265.115234375, obj_val: 10044.912109375, abs dis: 220.203125
[rfa agg] iter:  3, weight: tensor([0.0302, 0.0303, 0.0330, 0.0314, 0.1034, 0.0569, 0.1826, 0.2158, 0.1455,
        0.1708])
[rfa agg] iter:  4, prev_obj_val: 10044.912109375, obj_val: 9879.3564453125, abs dis: 165.5556640625
[rfa agg] iter:  4, weight: tensor([0.0213, 0.0214, 0.0230, 0.0221, 0.1074, 0.0591, 0.1905, 0.2254, 0.1516,
        0.1781])
[rfa agg] iter:  5, prev_obj_val: 9879.3564453125, obj_val: 9757.3359375, abs dis: 122.0205078125
[rfa agg] iter:  5, weight: tensor([0.0148, 0.0148, 0.0159, 0.0154, 0.1101, 0.0604, 0.1965, 0.2328, 0.1559,
        0.1835])
[rfa agg] iter:  6, prev_obj_val: 9757.3359375, obj_val: 9671.16015625, abs dis: 86.17578125
[rfa agg] iter:  6, weight: tensor([0.0101, 0.0101, 0.0108, 0.0104, 0.1115, 0.0609, 0.2011, 0.2388, 0.1589,
        0.1874])
[rfa agg] iter:  7, prev_obj_val: 9671.16015625, obj_val: 9609.736328125, abs dis: 61.423828125
[rfa agg] iter:  7, weight: tensor([0.0068, 0.0068, 0.0072, 0.0070, 0.1119, 0.0608, 0.2048, 0.2439, 0.1608,
        0.1902])
[rfa agg] iter:  8, prev_obj_val: 9609.736328125, obj_val: 9566.2373046875, abs dis: 43.4990234375
[rfa agg] iter:  8, weight: tensor([0.0044, 0.0044, 0.0047, 0.0046, 0.1110, 0.0597, 0.2081, 0.2491, 0.1618,
        0.1923])
[rfa agg] iter:  9, prev_obj_val: 9566.2373046875, obj_val: 9538.9560546875, abs dis: 27.28125
[rfa agg] iter:  9, weight: tensor([0.0028, 0.0028, 0.0030, 0.0029, 0.1084, 0.0575, 0.2116, 0.2555, 0.1617,
        0.1938])
___Test Target_ResNet_18 poisoned: False, epoch: 271: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 271: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 367.3059241771698 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:272 choose agents : [17, 33, 77, 11, 49, 74, 23, 97, 83, 22]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 17, internal_epoch   1,  Average loss: 0.0098, Accuracy: 443/526 (84.2205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 487/526 (92.5856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 17, internal_epoch   3,  Average loss: 0.0070, Accuracy: 482/526 (91.6350%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 17, internal_epoch   4,  Average loss: 0.0062, Accuracy: 476/526 (90.4943%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 17, internal_epoch   5,  Average loss: 0.0053, Accuracy: 485/526 (92.2053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 17, internal_epoch   6,  Average loss: 0.0035, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Global model norm: 37.230943964349905.
Norm before scaling: 38.23376678868514. Distance: 9.58588059337734
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 3.1763, Accuracy: 3252/10000 (32.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 272: Average loss: 0.0895, Accuracy: 8674/9000 (96.3778%)
Scaling by  100
Scaled Norm after poisoning: 958.4654075656565, distance: 958.5880241271534
Total norm for 4 adversaries is: 958.4654075656565. distance: 958.5880241271534
___Test Local_ResNet_18 poisoned: True, epoch: 272: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 33, internal_epoch   1,  Average loss: 0.0086, Accuracy: 451/527 (85.5787%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 33, internal_epoch   3,  Average loss: 0.0033, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 33, internal_epoch   4,  Average loss: 0.0039, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 33, internal_epoch   5,  Average loss: 0.0037, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 33, internal_epoch   6,  Average loss: 0.0033, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Global model norm: 37.230943964349905.
Norm before scaling: 37.6758895880376. Distance: 7.1241194866940125
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 4.7434, Accuracy: 2380/10000 (23.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 272: Average loss: 0.0924, Accuracy: 8694/9000 (96.6000%)
Scaling by  100
Scaled Norm after poisoning: 712.1618495819613, distance: 712.4119682459019
Total norm for 4 adversaries is: 712.1618495819613. distance: 712.4119682459019
___Test Local_ResNet_18 poisoned: True, epoch: 272: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 77, internal_epoch   1,  Average loss: 0.0079, Accuracy: 424/496 (85.4839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 77, internal_epoch   2,  Average loss: 0.0013, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 77, internal_epoch   3,  Average loss: 0.0014, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 77, internal_epoch   4,  Average loss: 0.0011, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 77, internal_epoch   5,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.230943964349905.
Norm before scaling: 37.32455377433366. Distance: 4.8325518710790805
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 2.3465, Accuracy: 4127/10000 (41.2700%)
___Test Local_ResNet_18 poisoned: True, epoch: 272: Average loss: 0.0629, Accuracy: 8822/9000 (98.0222%)
Scaling by  100
Scaled Norm after poisoning: 482.99509896581765, distance: 483.25518944445906
Total norm for 4 adversaries is: 482.99509896581765. distance: 483.25518944445906
___Test Local_ResNet_18 poisoned: True, epoch: 272: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 11, internal_epoch   1,  Average loss: 0.0096, Accuracy: 456/546 (83.5165%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 11, internal_epoch   2,  Average loss: 0.0034, Accuracy: 519/546 (95.0549%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 11, internal_epoch   3,  Average loss: 0.0025, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 11, internal_epoch   4,  Average loss: 0.0024, Accuracy: 525/546 (96.1538%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 11, internal_epoch   5,  Average loss: 0.0016, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 272, local model 11, internal_epoch   6,  Average loss: 0.0012, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.230943964349905.
Norm before scaling: 37.63801749997102. Distance: 6.846868492551677
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 2.4699, Accuracy: 3980/10000 (39.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 272: Average loss: 0.1287, Accuracy: 8658/9000 (96.2000%)
Scaling by  100
Scaled Norm after poisoning: 684.5012326504606, distance: 684.6867897075275
Total norm for 4 adversaries is: 684.5012326504606. distance: 684.6867897075275
___Test Local_ResNet_18 poisoned: True, epoch: 272: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 272, local model 49, internal_epoch   1,  Average loss: 0.0233, Accuracy: 239/426 (56.1033%)
___Train Local_ResNet_18,  epoch 272, local model 49, internal_epoch   2,  Average loss: 0.0093, Accuracy: 357/426 (83.8028%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 272, local model 74, internal_epoch   1,  Average loss: 0.0271, Accuracy: 238/469 (50.7463%)
___Train Local_ResNet_18,  epoch 272, local model 74, internal_epoch   2,  Average loss: 0.0129, Accuracy: 355/469 (75.6930%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 272, local model 23, internal_epoch   1,  Average loss: 0.0273, Accuracy: 104/248 (41.9355%)
___Train Local_ResNet_18,  epoch 272, local model 23, internal_epoch   2,  Average loss: 0.0102, Accuracy: 192/248 (77.4194%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 272, local model 97, internal_epoch   1,  Average loss: 0.0223, Accuracy: 254/418 (60.7656%)
___Train Local_ResNet_18,  epoch 272, local model 97, internal_epoch   2,  Average loss: 0.0110, Accuracy: 330/418 (78.9474%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 272, local model 83, internal_epoch   1,  Average loss: 0.0272, Accuracy: 156/366 (42.6230%)
___Train Local_ResNet_18,  epoch 272, local model 83, internal_epoch   2,  Average loss: 0.0106, Accuracy: 293/366 (80.0546%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 272, local model 22, internal_epoch   1,  Average loss: 0.0257, Accuracy: 245/494 (49.5951%)
___Train Local_ResNet_18,  epoch 272, local model 22, internal_epoch   2,  Average loss: 0.0112, Accuracy: 388/494 (78.5425%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 285.3985469341278
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4639061116031887  data num: [526, 527, 496, 546, 426, 469, 248, 418, 366, 494]
[rfa agg] considering poison per batch poison_fraction: 0.03624266496899912
[rfa agg] init. name: [17, 33, 77, 11, 49, 74, 23, 97, 83, 22], weight: tensor([0.1165, 0.1167, 0.1098, 0.1209, 0.0943, 0.1039, 0.0549, 0.0926, 0.0810,
        0.1094])
[rfa agg] iter:  0, prev_obj_val: 11674.615234375, obj_val: 11611.7783203125, abs dis: 62.8369140625
[rfa agg] iter:  0, weight: tensor([0.1015, 0.1018, 0.1202, 0.1055, 0.1005, 0.1107, 0.0583, 0.0986, 0.0862,
        0.1166])
[rfa agg] iter:  1, prev_obj_val: 11611.7783203125, obj_val: 11549.990234375, abs dis: 61.7880859375
[rfa agg] iter:  1, weight: tensor([0.0933, 0.0936, 0.1088, 0.0970, 0.1069, 0.1177, 0.0620, 0.1049, 0.0917,
        0.1240])
[rfa agg] iter:  2, prev_obj_val: 11549.990234375, obj_val: 11490.5244140625, abs dis: 59.4658203125
[rfa agg] iter:  2, weight: tensor([0.0852, 0.0855, 0.0981, 0.0886, 0.1131, 0.1246, 0.0656, 0.1110, 0.0971,
        0.1313])
[rfa agg] iter:  3, prev_obj_val: 11490.5244140625, obj_val: 11433.693359375, abs dis: 56.8310546875
[rfa agg] iter:  3, weight: tensor([0.0775, 0.0777, 0.0881, 0.0805, 0.1190, 0.1312, 0.0691, 0.1168, 0.1021,
        0.1382])
[rfa agg] iter:  4, prev_obj_val: 11433.693359375, obj_val: 11379.810546875, abs dis: 53.8828125
[rfa agg] iter:  4, weight: tensor([0.0700, 0.0702, 0.0789, 0.0727, 0.1246, 0.1374, 0.0723, 0.1223, 0.1069,
        0.1447])
[rfa agg] iter:  5, prev_obj_val: 11379.810546875, obj_val: 11328.875, abs dis: 50.935546875
[rfa agg] iter:  5, weight: tensor([0.0630, 0.0631, 0.0704, 0.0654, 0.1299, 0.1432, 0.0753, 0.1275, 0.1114,
        0.1508])
[rfa agg] iter:  6, prev_obj_val: 11328.875, obj_val: 11280.8720703125, abs dis: 48.0029296875
[rfa agg] iter:  6, weight: tensor([0.0563, 0.0565, 0.0625, 0.0585, 0.1348, 0.1487, 0.0781, 0.1323, 0.1157,
        0.1566])
[rfa agg] iter:  7, prev_obj_val: 11280.8720703125, obj_val: 11236.7763671875, abs dis: 44.095703125
[rfa agg] iter:  7, weight: tensor([0.0501, 0.0502, 0.0552, 0.0520, 0.1394, 0.1538, 0.0808, 0.1368, 0.1196,
        0.1620])
[rfa agg] iter:  8, prev_obj_val: 11236.7763671875, obj_val: 11196.2548828125, abs dis: 40.521484375
[rfa agg] iter:  8, weight: tensor([0.0444, 0.0445, 0.0487, 0.0461, 0.1437, 0.1585, 0.0832, 0.1410, 0.1232,
        0.1669])
[rfa agg] iter:  9, prev_obj_val: 11196.2548828125, obj_val: 11159.634765625, abs dis: 36.6201171875
[rfa agg] iter:  9, weight: tensor([0.0392, 0.0393, 0.0427, 0.0407, 0.1475, 0.1627, 0.0853, 0.1447, 0.1265,
        0.1714])
___Test Target_ResNet_18 poisoned: False, epoch: 272: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 272: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 373.37675189971924 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:273 choose agents : [17, 33, 77, 11, 4, 43, 92, 62, 59, 26]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 273, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 483/526 (91.8251%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 273, local model 17, internal_epoch   2,  Average loss: 0.0023, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 273, local model 17, internal_epoch   3,  Average loss: 0.0027, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 273, local model 17, internal_epoch   4,  Average loss: 0.0029, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 273, local model 17, internal_epoch   5,  Average loss: 0.0028, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 273, local model 17, internal_epoch   6,  Average loss: 0.0031, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Global model norm: 37.430968362815904.
Norm before scaling: 37.89662323656786. Distance: 7.2559471730892655
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 2.7629, Accuracy: 3967/10000 (39.6700%)
___Test Local_ResNet_18 poisoned: True, epoch: 273: Average loss: 0.1886, Accuracy: 8441/9000 (93.7889%)
Scaling by  100
Scaled Norm after poisoning: 725.3492693178921, distance: 725.5947560449979
Total norm for 4 adversaries is: 725.3492693178921. distance: 725.5947560449979
___Test Local_ResNet_18 poisoned: True, epoch: 273: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 273, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 488/527 (92.5996%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 273, local model 33, internal_epoch   2,  Average loss: 0.0033, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 273, local model 33, internal_epoch   3,  Average loss: 0.0072, Accuracy: 482/527 (91.4611%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 273, local model 33, internal_epoch   4,  Average loss: 0.0055, Accuracy: 475/527 (90.1328%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 273, local model 33, internal_epoch   5,  Average loss: 0.0039, Accuracy: 494/527 (93.7381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 273, local model 33, internal_epoch   6,  Average loss: 0.0036, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Global model norm: 37.430968362815904.
Norm before scaling: 38.464526194802204. Distance: 9.499685984993217
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 3.0602, Accuracy: 3647/10000 (36.4700%)
