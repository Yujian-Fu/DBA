current path: saved_models/model_mnist_Nov.13_06.44.55
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [41, 73, 51, 74]
We use following environment for graphs:  mnist_DBA
----------------------------------Start one training epoch------------------------------------------
Server Epoch:11 choose agents : [41, 73, 51, 74, 23, 76, 63, 11, 75, 43]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   1,  Average loss: 0.0251, Accuracy: 337/606 (55.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   2,  Average loss: 0.0158, Accuracy: 348/606 (57.4257%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   3,  Average loss: 0.0129, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   4,  Average loss: 0.0122, Accuracy: 390/606 (64.3564%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   5,  Average loss: 0.0118, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   6,  Average loss: 0.0118, Accuracy: 393/606 (64.8515%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   7,  Average loss: 0.0112, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   8,  Average loss: 0.0113, Accuracy: 380/606 (62.7063%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   9,  Average loss: 0.0111, Accuracy: 394/606 (65.0165%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch  10,  Average loss: 0.0105, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Global model norm: 16.539532092117113.
Norm before scaling: 16.77163528831165. Distance: 4.683459155110971
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.3942, Accuracy: 4208/10000 (42.0800%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.8780, Accuracy: 5913/8968 (65.9344%)
Scaling by  100
Scaled Norm after poisoning: 467.12004947871804, distance: 468.34587579586946
Total norm for 4 adversaries is: 467.12004947871804. distance: 468.34587579586946
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 101855.3120, Accuracy: 2/8968 (0.0223%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0245, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   2,  Average loss: 0.0196, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   3,  Average loss: 0.0167, Accuracy: 307/591 (51.9459%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   4,  Average loss: 0.0153, Accuracy: 312/591 (52.7919%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   5,  Average loss: 0.0148, Accuracy: 328/591 (55.4992%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   6,  Average loss: 0.0140, Accuracy: 354/591 (59.8985%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   7,  Average loss: 0.0142, Accuracy: 350/591 (59.2217%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   8,  Average loss: 0.0138, Accuracy: 352/591 (59.5601%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   9,  Average loss: 0.0134, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch  10,  Average loss: 0.0137, Accuracy: 340/591 (57.5296%), train_poison_data_count: 195
Global model norm: 16.539532092117113.
Norm before scaling: 16.596378786300324. Distance: 4.013856253368458
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0764, Accuracy: 5301/10000 (53.0100%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.9458, Accuracy: 4998/8968 (55.7315%)
Scaling by  100
Scaled Norm after poisoning: 399.95155956690553, distance: 401.3856468534967
Total norm for 4 adversaries is: 399.95155956690553. distance: 401.3856468534967
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0251, Accuracy: 314/568 (55.2817%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   2,  Average loss: 0.0127, Accuracy: 356/568 (62.6761%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   3,  Average loss: 0.0113, Accuracy: 371/568 (65.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   4,  Average loss: 0.0109, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   5,  Average loss: 0.0104, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   6,  Average loss: 0.0104, Accuracy: 388/568 (68.3099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   7,  Average loss: 0.0103, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   8,  Average loss: 0.0102, Accuracy: 377/568 (66.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   9,  Average loss: 0.0100, Accuracy: 385/568 (67.7817%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch  10,  Average loss: 0.0098, Accuracy: 401/568 (70.5986%), train_poison_data_count: 180
Global model norm: 16.53953116955235.
Norm before scaling: 16.71982235900839. Distance: 4.641732337436879
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.3197, Accuracy: 5095/10000 (50.9500%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.7898, Accuracy: 5209/8968 (58.0843%)
Scaling by  100
Scaled Norm after poisoning: 462.7909895406349, distance: 464.1732906469307
Total norm for 4 adversaries is: 462.7909895406349. distance: 464.1732906469307
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 7268.1959, Accuracy: 8133/8968 (90.6891%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0265, Accuracy: 309/557 (55.4758%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   2,  Average loss: 0.0131, Accuracy: 376/557 (67.5045%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   3,  Average loss: 0.0077, Accuracy: 484/557 (86.8941%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   4,  Average loss: 0.0061, Accuracy: 493/557 (88.5099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   5,  Average loss: 0.0050, Accuracy: 508/557 (91.2029%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   6,  Average loss: 0.0046, Accuracy: 506/557 (90.8438%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   7,  Average loss: 0.0036, Accuracy: 514/557 (92.2801%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   8,  Average loss: 0.0037, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   9,  Average loss: 0.0030, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch  10,  Average loss: 0.0034, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Global model norm: 16.53953116955235.
Norm before scaling: 16.8426212081183. Distance: 4.7092919963161535
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0161, Accuracy: 7197/10000 (71.9700%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1113, Accuracy: 8567/8968 (95.5285%)
Scaling by  100
Scaled Norm after poisoning: 469.9382938216463, distance: 470.9292177440257
Total norm for 4 adversaries is: 469.9382938216463. distance: 470.9292177440257
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1213, Accuracy: 9577/10000 (95.7700%)
___Train Local_Simple,  epoch  11, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.0957, Accuracy: 9719/10000 (97.1900%)
___Train Local_Simple,  epoch  11, local model 63, internal_epoch   1,  Average loss: 0.0020, Accuracy: 857/889 (96.4004%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1366, Accuracy: 9601/10000 (96.0100%)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0017, Accuracy: 626/645 (97.0543%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1996, Accuracy: 9381/10000 (93.8100%)
___Train Local_Simple,  epoch  11, local model 75, internal_epoch   1,  Average loss: 0.0010, Accuracy: 669/686 (97.5219%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1799, Accuracy: 9447/10000 (94.4700%)
___Train Local_Simple,  epoch  11, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 398/408 (97.5490%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3283, Accuracy: 8975/10000 (89.7500%)
time spent on training: 160.3632595539093
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.43638413831986467  data num: [606, 591, 568, 557, 293, 78, 889, 645, 686, 408]
[rfa agg] considering poison per batch poison_fraction: 0.13637004322495772
[rfa agg] init. name: [41, 73, 51, 74, 23, 76, 63, 11, 75, 43], weight: tensor([0.1139, 0.1111, 0.1067, 0.1047, 0.0551, 0.0147, 0.1671, 0.1212, 0.1289,
        0.0767])
[rfa agg] iter:  0, prev_obj_val: 236.8278350830078, obj_val: 218.84011840820312, abs dis: 17.987716674804688
[rfa agg] iter:  0, weight: tensor([0.0641, 0.0758, 0.0628, 0.0577, 0.0722, 0.0192, 0.2195, 0.1590, 0.1691,
        0.1006])
[rfa agg] iter:  1, prev_obj_val: 218.84011840820312, obj_val: 209.63600158691406, abs dis: 9.204116821289062
[rfa agg] iter:  1, weight: tensor([0.0390, 0.0459, 0.0375, 0.0353, 0.0822, 0.0219, 0.2501, 0.1811, 0.1925,
        0.1145])
[rfa agg] iter:  2, prev_obj_val: 209.63600158691406, obj_val: 204.43014526367188, abs dis: 5.2058563232421875
[rfa agg] iter:  2, weight: tensor([0.0238, 0.0277, 0.0227, 0.0217, 0.0882, 0.0235, 0.2687, 0.1943, 0.2064,
        0.1229])
[rfa agg] iter:  3, prev_obj_val: 204.43014526367188, obj_val: 201.37615966796875, abs dis: 3.053985595703125
[rfa agg] iter:  3, weight: tensor([0.0146, 0.0168, 0.0138, 0.0133, 0.0917, 0.0245, 0.2803, 0.2023, 0.2148,
        0.1280])
[rfa agg] iter:  4, prev_obj_val: 201.37615966796875, obj_val: 199.55621337890625, abs dis: 1.8199462890625
[rfa agg] iter:  4, weight: tensor([0.0089, 0.0102, 0.0084, 0.0081, 0.0938, 0.0251, 0.2879, 0.2071, 0.2196,
        0.1310])
[rfa agg] iter:  5, prev_obj_val: 199.55621337890625, obj_val: 198.46620178222656, abs dis: 1.0900115966796875
[rfa agg] iter:  5, weight: tensor([0.0054, 0.0062, 0.0051, 0.0050, 0.0949, 0.0255, 0.2933, 0.2098, 0.2221,
        0.1327])
[rfa agg] iter:  6, prev_obj_val: 198.46620178222656, obj_val: 197.816650390625, abs dis: 0.6495513916015625
[rfa agg] iter:  6, weight: tensor([0.0033, 0.0038, 0.0031, 0.0030, 0.0954, 0.0258, 0.2977, 0.2111, 0.2230,
        0.1337])
[rfa agg] iter:  7, prev_obj_val: 197.816650390625, obj_val: 197.4383544921875, abs dis: 0.3782958984375
[rfa agg] iter:  7, weight: tensor([0.0021, 0.0023, 0.0019, 0.0019, 0.0954, 0.0260, 0.3020, 0.2113, 0.2228,
        0.1342])
[rfa agg] iter:  8, prev_obj_val: 197.4383544921875, obj_val: 197.2311248779297, abs dis: 0.2072296142578125
[rfa agg] iter:  8, weight: tensor([0.0013, 0.0015, 0.0012, 0.0012, 0.0953, 0.0263, 0.3065, 0.2103, 0.2218,
        0.1347])
[rfa agg] iter:  9, prev_obj_val: 197.2311248779297, obj_val: 197.13209533691406, abs dis: 0.099029541015625
[rfa agg] iter:  9, weight: tensor([0.0009, 0.0010, 0.0008, 0.0008, 0.0955, 0.0268, 0.3101, 0.2077, 0.2208,
        0.1357])
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 0.0805, Accuracy: 9744/10000 (97.4400%)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 10.8247, Accuracy: 47/8968 (0.5241%)
Done in 201.23661398887634 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:12 choose agents : [41, 73, 51, 74, 46, 37, 21, 43, 35, 11]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0252, Accuracy: 319/606 (52.6403%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   2,  Average loss: 0.0145, Accuracy: 365/606 (60.2310%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   3,  Average loss: 0.0117, Accuracy: 394/606 (65.0165%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   4,  Average loss: 0.0115, Accuracy: 403/606 (66.5017%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   5,  Average loss: 0.0108, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   6,  Average loss: 0.0109, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   7,  Average loss: 0.0107, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   8,  Average loss: 0.0107, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   9,  Average loss: 0.0105, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch  10,  Average loss: 0.0105, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Global model norm: 16.52226927755622.
Norm before scaling: 16.75258605124286. Distance: 4.483004157781535
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.3148, Accuracy: 4878/10000 (48.7800%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.8748, Accuracy: 5367/8968 (59.8461%)
Scaling by  100
Scaled Norm after poisoning: 447.21689718189316, distance: 448.3004363705215
Total norm for 4 adversaries is: 447.21689718189316. distance: 448.3004363705215
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   1,  Average loss: 0.0243, Accuracy: 349/591 (59.0525%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   2,  Average loss: 0.0194, Accuracy: 283/591 (47.8849%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   3,  Average loss: 0.0167, Accuracy: 327/591 (55.3299%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   4,  Average loss: 0.0147, Accuracy: 345/591 (58.3756%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   5,  Average loss: 0.0136, Accuracy: 332/591 (56.1760%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   6,  Average loss: 0.0137, Accuracy: 348/591 (58.8832%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   7,  Average loss: 0.0133, Accuracy: 359/591 (60.7445%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   8,  Average loss: 0.0131, Accuracy: 365/591 (61.7597%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   9,  Average loss: 0.0127, Accuracy: 368/591 (62.2673%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch  10,  Average loss: 0.0131, Accuracy: 369/591 (62.4365%), train_poison_data_count: 195
Global model norm: 16.52226927755622.
Norm before scaling: 16.66328324625498. Distance: 3.673139768255642
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.8682, Accuracy: 6448/10000 (64.4800%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 1.0208, Accuracy: 4018/8968 (44.8037%)
Scaling by  100
Scaled Norm after poisoning: 366.4850781409797, distance: 367.31394099598236
Total norm for 4 adversaries is: 366.4850781409797. distance: 367.31394099598236
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   1,  Average loss: 0.0220, Accuracy: 339/568 (59.6831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   2,  Average loss: 0.0130, Accuracy: 357/568 (62.8521%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   3,  Average loss: 0.0114, Accuracy: 373/568 (65.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   4,  Average loss: 0.0111, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   5,  Average loss: 0.0114, Accuracy: 371/568 (65.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   6,  Average loss: 0.0112, Accuracy: 375/568 (66.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   7,  Average loss: 0.0109, Accuracy: 371/568 (65.3169%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   8,  Average loss: 0.0103, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   9,  Average loss: 0.0105, Accuracy: 383/568 (67.4296%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch  10,  Average loss: 0.0103, Accuracy: 398/568 (70.0704%), train_poison_data_count: 180
Global model norm: 16.52226927755622.
Norm before scaling: 16.618108482646743. Distance: 4.028464367689401
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.5398, Accuracy: 4645/10000 (46.4500%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.7133, Accuracy: 5921/8968 (66.0236%)
Scaling by  100
Scaled Norm after poisoning: 401.5632928007738, distance: 402.8464541546816
Total norm for 4 adversaries is: 401.5632928007738. distance: 402.8464541546816
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 27.4423, Accuracy: 8954/8968 (99.8439%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   1,  Average loss: 0.0224, Accuracy: 312/557 (56.0144%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   2,  Average loss: 0.0116, Accuracy: 391/557 (70.1975%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   3,  Average loss: 0.0057, Accuracy: 498/557 (89.4075%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   4,  Average loss: 0.0045, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   5,  Average loss: 0.0038, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   6,  Average loss: 0.0033, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   7,  Average loss: 0.0034, Accuracy: 513/557 (92.1005%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   8,  Average loss: 0.0026, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   9,  Average loss: 0.0024, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch  10,  Average loss: 0.0027, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Global model norm: 16.52226927755622.
Norm before scaling: 16.709839002289097. Distance: 3.680771848133249
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.7387, Accuracy: 7707/10000 (77.0700%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0916, Accuracy: 8651/8968 (96.4652%)
Scaling by  100
Scaled Norm after poisoning: 367.45388741310114, distance: 368.0771615775692
Total norm for 4 adversaries is: 367.45388741310114. distance: 368.0771615775692
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  12, local model 46, internal_epoch   1,  Average loss: 0.0034, Accuracy: 676/710 (95.2113%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2092, Accuracy: 9351/10000 (93.5100%)
___Train Local_Simple,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0011, Accuracy: 843/860 (98.0233%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.4855, Accuracy: 8471/10000 (84.7100%)
___Train Local_Simple,  epoch  12, local model 21, internal_epoch   1,  Average loss: 0.0013, Accuracy: 304/312 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2264, Accuracy: 9306/10000 (93.0600%)
___Train Local_Simple,  epoch  12, local model 43, internal_epoch   1,  Average loss: 0.0015, Accuracy: 397/408 (97.3039%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3078, Accuracy: 9023/10000 (90.2300%)
___Train Local_Simple,  epoch  12, local model 35, internal_epoch   1,  Average loss: 0.0006, Accuracy: 491/499 (98.3968%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2825, Accuracy: 9122/10000 (91.2200%)
___Train Local_Simple,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 629/645 (97.5194%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1991, Accuracy: 9393/10000 (93.9300%)
time spent on training: 181.75541973114014
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4034051424600417  data num: [606, 591, 568, 557, 710, 860, 312, 408, 499, 645]
[rfa agg] considering poison per batch poison_fraction: 0.12606410701876303
[rfa agg] init. name: [41, 73, 51, 74, 46, 37, 21, 43, 35, 11], weight: tensor([0.1053, 0.1027, 0.0987, 0.0968, 0.1233, 0.1494, 0.0542, 0.0709, 0.0867,
        0.1121])
[rfa agg] iter:  0, prev_obj_val: 199.8925018310547, obj_val: 178.7204132080078, abs dis: 21.172088623046875
[rfa agg] iter:  0, weight: tensor([0.0457, 0.0554, 0.0495, 0.0510, 0.1652, 0.2002, 0.0725, 0.0948, 0.1159,
        0.1498])
[rfa agg] iter:  1, prev_obj_val: 178.7204132080078, obj_val: 169.2783966064453, abs dis: 9.4420166015625
[rfa agg] iter:  1, weight: tensor([0.0229, 0.0278, 0.0245, 0.0259, 0.1862, 0.2256, 0.0815, 0.1067, 0.1304,
        0.1684])
[rfa agg] iter:  2, prev_obj_val: 169.2783966064453, obj_val: 164.73440551757812, abs dis: 4.5439910888671875
[rfa agg] iter:  2, weight: tensor([0.0116, 0.0139, 0.0122, 0.0130, 0.1970, 0.2388, 0.0860, 0.1125, 0.1375,
        0.1775])
[rfa agg] iter:  3, prev_obj_val: 164.73440551757812, obj_val: 162.5084686279297, abs dis: 2.2259368896484375
[rfa agg] iter:  3, weight: tensor([0.0058, 0.0069, 0.0061, 0.0065, 0.2028, 0.2463, 0.0880, 0.1153, 0.1408,
        0.1814])
[rfa agg] iter:  4, prev_obj_val: 162.5084686279297, obj_val: 161.4262237548828, abs dis: 1.082244873046875
[rfa agg] iter:  4, weight: tensor([0.0029, 0.0035, 0.0031, 0.0033, 0.2063, 0.2517, 0.0887, 0.1165, 0.1419,
        0.1821])
[rfa agg] iter:  5, prev_obj_val: 161.4262237548828, obj_val: 160.92771911621094, abs dis: 0.498504638671875
[rfa agg] iter:  5, weight: tensor([0.0015, 0.0018, 0.0016, 0.0017, 0.2080, 0.2573, 0.0888, 0.1172, 0.1420,
        0.1803])
[rfa agg] iter:  6, prev_obj_val: 160.92771911621094, obj_val: 160.73536682128906, abs dis: 0.192352294921875
[rfa agg] iter:  6, weight: tensor([0.0008, 0.0010, 0.0008, 0.0009, 0.2048, 0.2642, 0.0893, 0.1190, 0.1428,
        0.1765])
[rfa agg] iter:  7, prev_obj_val: 160.73536682128906, obj_val: 160.6844024658203, abs dis: 0.05096435546875
[rfa agg] iter:  7, weight: tensor([0.0005, 0.0006, 0.0005, 0.0006, 0.1920, 0.2692, 0.0919, 0.1247, 0.1472,
        0.1728])
[rfa agg] iter:  8, prev_obj_val: 160.6844024658203, obj_val: 160.67584228515625, abs dis: 0.0085601806640625
[rfa agg] iter:  8, weight: tensor([0.0004, 0.0005, 0.0004, 0.0005, 0.1757, 0.2684, 0.0958, 0.1327, 0.1546,
        0.1711])
[rfa agg] iter:  9, prev_obj_val: 160.67584228515625, obj_val: 160.6747283935547, abs dis: 0.0011138916015625
[rfa agg] iter:  9, weight: tensor([0.0004, 0.0004, 0.0004, 0.0004, 0.1653, 0.2656, 0.0983, 0.1383, 0.1601,
        0.1707])
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 0.0804, Accuracy: 9747/10000 (97.4700%)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 10.2539, Accuracy: 53/8968 (0.5910%)
Done in 220.35058283805847 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:13 choose agents : [41, 73, 51, 74, 61, 64, 28, 67, 22, 82]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0231, Accuracy: 343/606 (56.6007%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   2,  Average loss: 0.0156, Accuracy: 325/606 (53.6304%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   3,  Average loss: 0.0121, Accuracy: 399/606 (65.8416%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   4,  Average loss: 0.0114, Accuracy: 402/606 (66.3366%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   5,  Average loss: 0.0112, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   6,  Average loss: 0.0112, Accuracy: 403/606 (66.5017%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   7,  Average loss: 0.0109, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   8,  Average loss: 0.0107, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   9,  Average loss: 0.0108, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch  10,  Average loss: 0.0109, Accuracy: 404/606 (66.6667%), train_poison_data_count: 200
Global model norm: 16.51418365281039.
Norm before scaling: 16.681017584555505. Distance: 4.148311519685506
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.4948, Accuracy: 4739/10000 (47.3900%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.9158, Accuracy: 5247/8968 (58.5080%)
Scaling by  100
Scaled Norm after poisoning: 413.75192597739044, distance: 414.8311968439693
Total norm for 4 adversaries is: 413.75192597739044. distance: 414.8311968439693
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 26523.1648, Accuracy: 4296/8968 (47.9037%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   1,  Average loss: 0.0242, Accuracy: 351/591 (59.3909%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   2,  Average loss: 0.0233, Accuracy: 254/591 (42.9780%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   3,  Average loss: 0.0162, Accuracy: 325/591 (54.9915%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   4,  Average loss: 0.0159, Accuracy: 345/591 (58.3756%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   5,  Average loss: 0.0164, Accuracy: 314/591 (53.1303%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   6,  Average loss: 0.0152, Accuracy: 330/591 (55.8376%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   7,  Average loss: 0.0149, Accuracy: 357/591 (60.4061%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   8,  Average loss: 0.0141, Accuracy: 363/591 (61.4213%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   9,  Average loss: 0.0138, Accuracy: 370/591 (62.6058%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch  10,  Average loss: 0.0142, Accuracy: 343/591 (58.0372%), train_poison_data_count: 195
Global model norm: 16.51418365281039.
Norm before scaling: 16.561240555003817. Distance: 3.6472920288032302
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.2574, Accuracy: 4792/10000 (47.9200%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.8821, Accuracy: 5438/8968 (60.6378%)
Scaling by  100
Scaled Norm after poisoning: 363.4906936566602, distance: 364.7292017716706
Total norm for 4 adversaries is: 363.4906936566602. distance: 364.7292017716706
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0907, Accuracy: 8967/8968 (99.9888%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   1,  Average loss: 0.0229, Accuracy: 316/568 (55.6338%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   2,  Average loss: 0.0133, Accuracy: 340/568 (59.8592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   3,  Average loss: 0.0124, Accuracy: 382/568 (67.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   4,  Average loss: 0.0110, Accuracy: 380/568 (66.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   5,  Average loss: 0.0102, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   6,  Average loss: 0.0099, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   7,  Average loss: 0.0101, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   8,  Average loss: 0.0098, Accuracy: 387/568 (68.1338%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   9,  Average loss: 0.0095, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch  10,  Average loss: 0.0096, Accuracy: 393/568 (69.1901%), train_poison_data_count: 180
Global model norm: 16.51418365281039.
Norm before scaling: 16.7174767695671. Distance: 4.316660767383055
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.3074, Accuracy: 5196/10000 (51.9600%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.7230, Accuracy: 5717/8968 (63.7489%)
Scaling by  100
Scaled Norm after poisoning: 430.60502493584534, distance: 431.66610360323637
Total norm for 4 adversaries is: 430.60502493584534. distance: 431.66610360323637
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   1,  Average loss: 0.0233, Accuracy: 337/557 (60.5027%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   2,  Average loss: 0.0113, Accuracy: 396/557 (71.0952%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   3,  Average loss: 0.0057, Accuracy: 492/557 (88.3303%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   4,  Average loss: 0.0045, Accuracy: 508/557 (91.2029%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   5,  Average loss: 0.0043, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   6,  Average loss: 0.0036, Accuracy: 516/557 (92.6391%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   7,  Average loss: 0.0033, Accuracy: 514/557 (92.2801%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   8,  Average loss: 0.0025, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   9,  Average loss: 0.0024, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch  10,  Average loss: 0.0024, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Global model norm: 16.51418365281039.
Norm before scaling: 16.800355744001376. Distance: 4.138245787926805
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.7201, Accuracy: 7870/10000 (78.7000%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1481, Accuracy: 8400/8968 (93.6664%)
Scaling by  100
Scaled Norm after poisoning: 413.23657721697384, distance: 413.8245778708655
Total norm for 4 adversaries is: 413.23657721697384. distance: 413.8245778708655
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  13, local model 61, internal_epoch   1,  Average loss: 0.0015, Accuracy: 675/699 (96.5665%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2637, Accuracy: 9127/10000 (91.2700%)
___Train Local_Simple,  epoch  13, local model 64, internal_epoch   1,  Average loss: 0.0018, Accuracy: 783/813 (96.3100%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3366, Accuracy: 8758/10000 (87.5800%)
___Train Local_Simple,  epoch  13, local model 28, internal_epoch   1,  Average loss: 0.0015, Accuracy: 486/501 (97.0060%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1376, Accuracy: 9551/10000 (95.5100%)
___Train Local_Simple,  epoch  13, local model 67, internal_epoch   1,  Average loss: 0.0014, Accuracy: 974/998 (97.5952%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3156, Accuracy: 8972/10000 (89.7200%)
___Train Local_Simple,  epoch  13, local model 22, internal_epoch   1,  Average loss: 0.0015, Accuracy: 568/583 (97.4271%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2025, Accuracy: 9393/10000 (93.9300%)
___Train Local_Simple,  epoch  13, local model 82, internal_epoch   1,  Average loss: 0.0014, Accuracy: 692/713 (97.0547%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2823, Accuracy: 9043/10000 (90.4300%)
time spent on training: 168.68390035629272
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.35027907678382864  data num: [606, 591, 568, 557, 699, 813, 501, 998, 583, 713]
[rfa agg] considering poison per batch poison_fraction: 0.10946221149494645
[rfa agg] init. name: [41, 73, 51, 74, 61, 64, 28, 67, 22, 82], weight: tensor([0.0914, 0.0892, 0.0857, 0.0840, 0.1054, 0.1226, 0.0756, 0.1506, 0.0879,
        0.1076])
[rfa agg] iter:  0, prev_obj_val: 186.09625244140625, obj_val: 159.88510131835938, abs dis: 26.211151123046875
[rfa agg] iter:  0, weight: tensor([0.0371, 0.0426, 0.0340, 0.0335, 0.1384, 0.1611, 0.0992, 0.1975, 0.1155,
        0.1411])
[rfa agg] iter:  1, prev_obj_val: 159.88510131835938, obj_val: 149.39039611816406, abs dis: 10.494705200195312
[rfa agg] iter:  1, weight: tensor([0.0154, 0.0173, 0.0139, 0.0140, 0.1525, 0.1776, 0.1093, 0.2174, 0.1273,
        0.1552])
[rfa agg] iter:  2, prev_obj_val: 149.39039611816406, obj_val: 145.13961791992188, abs dis: 4.2507781982421875
[rfa agg] iter:  2, weight: tensor([0.0063, 0.0070, 0.0057, 0.0058, 0.1585, 0.1849, 0.1135, 0.2253, 0.1324,
        0.1608])
[rfa agg] iter:  3, prev_obj_val: 145.13961791992188, obj_val: 143.46067810058594, abs dis: 1.6789398193359375
[rfa agg] iter:  3, weight: tensor([0.0026, 0.0028, 0.0023, 0.0024, 0.1612, 0.1887, 0.1155, 0.2273, 0.1350,
        0.1623])
[rfa agg] iter:  4, prev_obj_val: 143.46067810058594, obj_val: 142.87008666992188, abs dis: 0.5905914306640625
[rfa agg] iter:  4, weight: tensor([0.0011, 0.0012, 0.0010, 0.0010, 0.1632, 0.1914, 0.1176, 0.2241, 0.1376,
        0.1618])
[rfa agg] iter:  5, prev_obj_val: 142.87008666992188, obj_val: 142.7314910888672, abs dis: 0.1385955810546875
[rfa agg] iter:  5, weight: tensor([0.0005, 0.0006, 0.0005, 0.0005, 0.1665, 0.1912, 0.1235, 0.2122, 0.1424,
        0.1622])
[rfa agg] iter:  6, prev_obj_val: 142.7314910888672, obj_val: 142.71627807617188, abs dis: 0.0152130126953125
[rfa agg] iter:  6, weight: tensor([0.0004, 0.0004, 0.0003, 0.0003, 0.1697, 0.1848, 0.1336, 0.1967, 0.1476,
        0.1662])
[rfa agg] iter:  7, prev_obj_val: 142.71627807617188, obj_val: 142.71539306640625, abs dis: 0.000885009765625
[rfa agg] iter:  7, weight: tensor([0.0003, 0.0004, 0.0003, 0.0003, 0.1713, 0.1793, 0.1401, 0.1880, 0.1502,
        0.1698])
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 0.0804, Accuracy: 9752/10000 (97.5200%)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 9.7907, Accuracy: 56/8968 (0.6244%)
Done in 206.83619475364685 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:14 choose agents : [41, 73, 51, 74, 60, 42, 85, 56, 57, 63]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   1,  Average loss: 0.0221, Accuracy: 364/606 (60.0660%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   2,  Average loss: 0.0160, Accuracy: 329/606 (54.2904%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   3,  Average loss: 0.0133, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   4,  Average loss: 0.0125, Accuracy: 401/606 (66.1716%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   5,  Average loss: 0.0115, Accuracy: 398/606 (65.6766%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   6,  Average loss: 0.0117, Accuracy: 392/606 (64.6865%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   7,  Average loss: 0.0109, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   8,  Average loss: 0.0107, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   9,  Average loss: 0.0109, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch  10,  Average loss: 0.0109, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Global model norm: 16.50632609848513.
Norm before scaling: 16.674214192738216. Distance: 4.247742895014768
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.4741, Accuracy: 4454/10000 (44.5400%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.9154, Accuracy: 5487/8968 (61.1842%)
Scaling by  100
Scaled Norm after poisoning: 423.625313514195, distance: 424.7743150780188
Total norm for 4 adversaries is: 423.625313514195. distance: 424.7743150780188
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 24461.5938, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   1,  Average loss: 0.0253, Accuracy: 341/591 (57.6988%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   2,  Average loss: 0.0212, Accuracy: 257/591 (43.4856%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   3,  Average loss: 0.0183, Accuracy: 321/591 (54.3147%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   4,  Average loss: 0.0174, Accuracy: 317/591 (53.6379%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   5,  Average loss: 0.0162, Accuracy: 313/591 (52.9611%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   6,  Average loss: 0.0152, Accuracy: 319/591 (53.9763%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   7,  Average loss: 0.0151, Accuracy: 330/591 (55.8376%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   8,  Average loss: 0.0141, Accuracy: 345/591 (58.3756%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   9,  Average loss: 0.0141, Accuracy: 347/591 (58.7140%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch  10,  Average loss: 0.0139, Accuracy: 347/591 (58.7140%), train_poison_data_count: 195
Global model norm: 16.50632609848513.
Norm before scaling: 16.699272203861817. Distance: 4.253439016753183
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.2113, Accuracy: 4494/10000 (44.9400%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.8204, Accuracy: 5932/8968 (66.1463%)
Scaling by  100
Scaled Norm after poisoning: 424.28931388263834, distance: 425.3439049757267
Total norm for 4 adversaries is: 424.28931388263834. distance: 425.3439049757267
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   1,  Average loss: 0.0214, Accuracy: 329/568 (57.9225%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   2,  Average loss: 0.0120, Accuracy: 378/568 (66.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   3,  Average loss: 0.0115, Accuracy: 372/568 (65.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   4,  Average loss: 0.0110, Accuracy: 373/568 (65.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   5,  Average loss: 0.0105, Accuracy: 393/568 (69.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   6,  Average loss: 0.0105, Accuracy: 396/568 (69.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   7,  Average loss: 0.0103, Accuracy: 388/568 (68.3099%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   8,  Average loss: 0.0099, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   9,  Average loss: 0.0098, Accuracy: 399/568 (70.2465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch  10,  Average loss: 0.0099, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Global model norm: 16.50632609848513.
Norm before scaling: 16.586104016180137. Distance: 3.630716748896528
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.2899, Accuracy: 5028/10000 (50.2800%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.7173, Accuracy: 5745/8968 (64.0611%)
Scaling by  100
Scaled Norm after poisoning: 361.9935902402141, distance: 363.0716613149531
Total norm for 4 adversaries is: 361.9935902402141. distance: 363.0716613149531
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0221, Accuracy: 334/557 (59.9641%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   2,  Average loss: 0.0118, Accuracy: 380/557 (68.2226%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   3,  Average loss: 0.0053, Accuracy: 499/557 (89.5871%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   4,  Average loss: 0.0050, Accuracy: 503/557 (90.3052%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   5,  Average loss: 0.0046, Accuracy: 503/557 (90.3052%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   6,  Average loss: 0.0034, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   7,  Average loss: 0.0038, Accuracy: 513/557 (92.1005%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   8,  Average loss: 0.0028, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   9,  Average loss: 0.0028, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch  10,  Average loss: 0.0028, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Global model norm: 16.50632609848513.
Norm before scaling: 16.685024577926626. Distance: 3.6234335310018957
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.6952, Accuracy: 7944/10000 (79.4400%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1595, Accuracy: 8327/8968 (92.8524%)
Scaling by  100
Scaled Norm after poisoning: 361.7256384333297, distance: 362.3433928954687
Total norm for 4 adversaries is: 361.7256384333297. distance: 362.3433928954687
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  14, local model 60, internal_epoch   1,  Average loss: 0.0016, Accuracy: 329/338 (97.3373%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1108, Accuracy: 9673/10000 (96.7300%)
___Train Local_Simple,  epoch  14, local model 42, internal_epoch   1,  Average loss: 0.0013, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1023, Accuracy: 9686/10000 (96.8600%)
___Train Local_Simple,  epoch  14, local model 85, internal_epoch   1,  Average loss: 0.0008, Accuracy: 423/431 (98.1439%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1431, Accuracy: 9544/10000 (95.4400%)
___Train Local_Simple,  epoch  14, local model 56, internal_epoch   1,  Average loss: 0.0015, Accuracy: 861/880 (97.8409%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1377, Accuracy: 9560/10000 (95.6000%)
___Train Local_Simple,  epoch  14, local model 57, internal_epoch   1,  Average loss: 0.0020, Accuracy: 331/343 (96.5015%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2506, Accuracy: 9271/10000 (92.7100%)
___Train Local_Simple,  epoch  14, local model 63, internal_epoch   1,  Average loss: 0.0020, Accuracy: 848/889 (95.3881%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1228, Accuracy: 9607/10000 (96.0700%)
time spent on training: 171.91980719566345
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.42691671263099834  data num: [606, 591, 568, 557, 338, 236, 431, 880, 343, 889]
[rfa agg] considering poison per batch poison_fraction: 0.13341147269718698
[rfa agg] init. name: [41, 73, 51, 74, 60, 42, 85, 56, 57, 63], weight: tensor([0.1114, 0.1087, 0.1044, 0.1024, 0.0621, 0.0434, 0.0792, 0.1618, 0.0631,
        0.1634])
[rfa agg] iter:  0, prev_obj_val: 205.74755859375, obj_val: 186.6424560546875, abs dis: 19.1051025390625
[rfa agg] iter:  0, weight: tensor([0.0539, 0.0524, 0.0624, 0.0561, 0.0841, 0.0587, 0.1072, 0.2189, 0.0854,
        0.2211])
[rfa agg] iter:  1, prev_obj_val: 186.6424560546875, obj_val: 177.9423065185547, abs dis: 8.700149536132812
[rfa agg] iter:  1, weight: tensor([0.0288, 0.0280, 0.0328, 0.0310, 0.0954, 0.0666, 0.1215, 0.2482, 0.0969,
        0.2508])
[rfa agg] iter:  2, prev_obj_val: 177.9423065185547, obj_val: 173.5465087890625, abs dis: 4.3957977294921875
[rfa agg] iter:  2, weight: tensor([0.0156, 0.0152, 0.0174, 0.0168, 0.1016, 0.0707, 0.1291, 0.2638, 0.1031,
        0.2667])
[rfa agg] iter:  3, prev_obj_val: 173.5465087890625, obj_val: 171.2486572265625, abs dis: 2.2978515625
[rfa agg] iter:  3, weight: tensor([0.0085, 0.0082, 0.0094, 0.0091, 0.1050, 0.0730, 0.1330, 0.2721, 0.1066,
        0.2752])
[rfa agg] iter:  4, prev_obj_val: 171.2486572265625, obj_val: 170.03697204589844, abs dis: 1.2116851806640625
[rfa agg] iter:  4, weight: tensor([0.0046, 0.0045, 0.0051, 0.0049, 0.1071, 0.0741, 0.1350, 0.2764, 0.1087,
        0.2798])
[rfa agg] iter:  5, prev_obj_val: 170.03697204589844, obj_val: 169.4075469970703, abs dis: 0.629425048828125
[rfa agg] iter:  5, weight: tensor([0.0025, 0.0024, 0.0028, 0.0027, 0.1087, 0.0748, 0.1358, 0.2780, 0.1104,
        0.2820])
[rfa agg] iter:  6, prev_obj_val: 169.4075469970703, obj_val: 169.10153198242188, abs dis: 0.3060150146484375
[rfa agg] iter:  6, weight: tensor([0.0014, 0.0014, 0.0015, 0.0015, 0.1108, 0.0755, 0.1362, 0.2772, 0.1123,
        0.2823])
[rfa agg] iter:  7, prev_obj_val: 169.10153198242188, obj_val: 168.97740173339844, abs dis: 0.1241302490234375
[rfa agg] iter:  7, weight: tensor([0.0008, 0.0008, 0.0009, 0.0009, 0.1143, 0.0770, 0.1374, 0.2729, 0.1151,
        0.2799])
[rfa agg] iter:  8, prev_obj_val: 168.97740173339844, obj_val: 168.9418182373047, abs dis: 0.03558349609375
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0005, 0.0006, 0.0006, 0.1195, 0.0801, 0.1407, 0.2646, 0.1187,
        0.2741])
[rfa agg] iter:  9, prev_obj_val: 168.9418182373047, obj_val: 168.9351348876953, abs dis: 0.006683349609375
[rfa agg] iter:  9, weight: tensor([0.0005, 0.0004, 0.0005, 0.0005, 0.1245, 0.0840, 0.1455, 0.2556, 0.1215,
        0.2670])
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 0.0810, Accuracy: 9755/10000 (97.5500%)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 9.2284, Accuracy: 57/8968 (0.6356%)
Done in 209.93257522583008 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:15 choose agents : [41, 73, 51, 74, 77, 18, 43, 91, 42, 52]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   1,  Average loss: 0.0201, Accuracy: 383/606 (63.2013%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   2,  Average loss: 0.0133, Accuracy: 359/606 (59.2409%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   3,  Average loss: 0.0106, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   4,  Average loss: 0.0113, Accuracy: 392/606 (64.6865%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   5,  Average loss: 0.0110, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   6,  Average loss: 0.0109, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   7,  Average loss: 0.0104, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   8,  Average loss: 0.0103, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   9,  Average loss: 0.0101, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch  10,  Average loss: 0.0099, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Global model norm: 16.499076123815332.
Norm before scaling: 16.60450709180248. Distance: 3.404312562714858
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.1733, Accuracy: 5990/10000 (59.9000%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 1.0834, Accuracy: 4107/8968 (45.7962%)
Scaling by  100
Scaled Norm after poisoning: 339.64068789678305, distance: 340.4312866607592
Total norm for 4 adversaries is: 339.64068789678305. distance: 340.4312866607592
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 226.8736, Accuracy: 8530/8968 (95.1160%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   1,  Average loss: 0.0236, Accuracy: 329/591 (55.6684%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   2,  Average loss: 0.0211, Accuracy: 249/591 (42.1320%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   3,  Average loss: 0.0164, Accuracy: 331/591 (56.0068%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   4,  Average loss: 0.0156, Accuracy: 325/591 (54.9915%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   5,  Average loss: 0.0148, Accuracy: 332/591 (56.1760%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   6,  Average loss: 0.0143, Accuracy: 338/591 (57.1912%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   7,  Average loss: 0.0141, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   8,  Average loss: 0.0138, Accuracy: 357/591 (60.4061%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   9,  Average loss: 0.0135, Accuracy: 370/591 (62.6058%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch  10,  Average loss: 0.0132, Accuracy: 379/591 (64.1286%), train_poison_data_count: 195
Global model norm: 16.499076123815332.
Norm before scaling: 16.6028924099674. Distance: 3.5638138874579965
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.0403, Accuracy: 5895/10000 (58.9500%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.9709, Accuracy: 4551/8968 (50.7471%)
Scaling by  100
Scaled Norm after poisoning: 355.46244087807645, distance: 356.3813792834861
Total norm for 4 adversaries is: 355.46244087807645. distance: 356.3813792834861
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   1,  Average loss: 0.0204, Accuracy: 341/568 (60.0352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   2,  Average loss: 0.0134, Accuracy: 342/568 (60.2113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   3,  Average loss: 0.0117, Accuracy: 367/568 (64.6127%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   4,  Average loss: 0.0115, Accuracy: 382/568 (67.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   5,  Average loss: 0.0110, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   6,  Average loss: 0.0105, Accuracy: 378/568 (66.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   7,  Average loss: 0.0104, Accuracy: 381/568 (67.0775%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   8,  Average loss: 0.0098, Accuracy: 396/568 (69.7183%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   9,  Average loss: 0.0100, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch  10,  Average loss: 0.0099, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Global model norm: 16.499076123815332.
Norm before scaling: 16.559233721267024. Distance: 3.339410693552442
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.3308, Accuracy: 4711/10000 (47.1100%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.7628, Accuracy: 5798/8968 (64.6521%)
Scaling by  100
Scaled Norm after poisoning: 332.9754354678435, distance: 333.9410384895813
Total norm for 4 adversaries is: 332.9754354678435. distance: 333.9410384895813
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   1,  Average loss: 0.0201, Accuracy: 324/557 (58.1688%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   2,  Average loss: 0.0111, Accuracy: 393/557 (70.5566%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   3,  Average loss: 0.0061, Accuracy: 478/557 (85.8169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   4,  Average loss: 0.0047, Accuracy: 509/557 (91.3824%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   5,  Average loss: 0.0042, Accuracy: 514/557 (92.2801%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   6,  Average loss: 0.0030, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   7,  Average loss: 0.0028, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   8,  Average loss: 0.0022, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   9,  Average loss: 0.0022, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch  10,  Average loss: 0.0025, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Global model norm: 16.499076123815332.
Norm before scaling: 16.688461904627026. Distance: 3.4861765767131527
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.6796, Accuracy: 7907/10000 (79.0700%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1057, Accuracy: 8551/8968 (95.3501%)
Scaling by  100
Scaled Norm after poisoning: 348.16630140997273, distance: 348.6176832326496
Total norm for 4 adversaries is: 348.16630140997273. distance: 348.6176832326496
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  15, local model 77, internal_epoch   1,  Average loss: 0.0016, Accuracy: 574/589 (97.4533%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1714, Accuracy: 9479/10000 (94.7900%)
___Train Local_Simple,  epoch  15, local model 18, internal_epoch   1,  Average loss: 0.0020, Accuracy: 443/459 (96.5142%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2546, Accuracy: 9140/10000 (91.4000%)
___Train Local_Simple,  epoch  15, local model 43, internal_epoch   1,  Average loss: 0.0014, Accuracy: 396/408 (97.0588%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1113, Accuracy: 9655/10000 (96.5500%)
___Train Local_Simple,  epoch  15, local model 91, internal_epoch   1,  Average loss: 0.0007, Accuracy: 253/256 (98.8281%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.0853, Accuracy: 9730/10000 (97.3000%)
___Train Local_Simple,  epoch  15, local model 42, internal_epoch   1,  Average loss: 0.0013, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.0961, Accuracy: 9701/10000 (97.0100%)
___Train Local_Simple,  epoch  15, local model 52, internal_epoch   1,  Average loss: 0.0011, Accuracy: 247/253 (97.6285%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1274, Accuracy: 9617/10000 (96.1700%)
time spent on training: 165.70329594612122
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.5133760778244528  data num: [606, 591, 568, 557, 589, 459, 408, 256, 236, 253]
[rfa agg] considering poison per batch poison_fraction: 0.1604300243201415
[rfa agg] init. name: [41, 73, 51, 74, 77, 18, 43, 91, 42, 52], weight: tensor([0.1340, 0.1307, 0.1256, 0.1231, 0.1302, 0.1015, 0.0902, 0.0566, 0.0522,
        0.0559])
[rfa agg] iter:  0, prev_obj_val: 199.69915771484375, obj_val: 189.74876403808594, abs dis: 9.950393676757812
[rfa agg] iter:  0, weight: tensor([0.0871, 0.0820, 0.0882, 0.0760, 0.1783, 0.1390, 0.1236, 0.0776, 0.0715,
        0.0767])
[rfa agg] iter:  1, prev_obj_val: 189.74876403808594, obj_val: 185.13670349121094, abs dis: 4.612060546875
[rfa agg] iter:  1, weight: tensor([0.0606, 0.0566, 0.0601, 0.0533, 0.2057, 0.1604, 0.1427, 0.0895, 0.0825,
        0.0885])
[rfa agg] iter:  2, prev_obj_val: 185.13670349121094, obj_val: 182.52789306640625, abs dis: 2.6088104248046875
[rfa agg] iter:  2, weight: tensor([0.0434, 0.0404, 0.0424, 0.0384, 0.2233, 0.1742, 0.1549, 0.0972, 0.0896,
        0.0961])
[rfa agg] iter:  3, prev_obj_val: 182.52789306640625, obj_val: 180.8975372314453, abs dis: 1.6303558349609375
[rfa agg] iter:  3, weight: tensor([0.0315, 0.0294, 0.0306, 0.0281, 0.2353, 0.1836, 0.1633, 0.1025, 0.0944,
        0.1014])
[rfa agg] iter:  4, prev_obj_val: 180.8975372314453, obj_val: 179.81646728515625, abs dis: 1.0810699462890625
[rfa agg] iter:  4, weight: tensor([0.0232, 0.0216, 0.0224, 0.0207, 0.2436, 0.1901, 0.1692, 0.1062, 0.0978,
        0.1051])
[rfa agg] iter:  5, prev_obj_val: 179.81646728515625, obj_val: 179.07183837890625, abs dis: 0.74462890625
[rfa agg] iter:  5, weight: tensor([0.0172, 0.0160, 0.0166, 0.0154, 0.2495, 0.1949, 0.1735, 0.1089, 0.1003,
        0.1078])
[rfa agg] iter:  6, prev_obj_val: 179.07183837890625, obj_val: 178.5457305908203, abs dis: 0.5261077880859375
[rfa agg] iter:  6, weight: tensor([0.0128, 0.0120, 0.0123, 0.0115, 0.2536, 0.1983, 0.1767, 0.1110, 0.1021,
        0.1098])
[rfa agg] iter:  7, prev_obj_val: 178.5457305908203, obj_val: 178.16770935058594, abs dis: 0.378021240234375
[rfa agg] iter:  7, weight: tensor([0.0096, 0.0090, 0.0092, 0.0086, 0.2565, 0.2007, 0.1790, 0.1125, 0.1035,
        0.1113])
[rfa agg] iter:  8, prev_obj_val: 178.16770935058594, obj_val: 177.89306640625, abs dis: 0.2746429443359375
[rfa agg] iter:  8, weight: tensor([0.0072, 0.0067, 0.0069, 0.0065, 0.2584, 0.2025, 0.1809, 0.1137, 0.1045,
        0.1126])
[rfa agg] iter:  9, prev_obj_val: 177.89306640625, obj_val: 177.6924591064453, abs dis: 0.2006072998046875
[rfa agg] iter:  9, weight: tensor([0.0055, 0.0051, 0.0052, 0.0049, 0.2596, 0.2037, 0.1824, 0.1147, 0.1053,
        0.1137])
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 0.1148, Accuracy: 9719/10000 (97.1900%)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 5.3756, Accuracy: 112/8968 (1.2489%)
Done in 201.35687851905823 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:16 choose agents : [41, 73, 51, 74, 28, 37, 96, 99, 80, 13]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   1,  Average loss: 0.0170, Accuracy: 376/606 (62.0462%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   2,  Average loss: 0.0142, Accuracy: 341/606 (56.2706%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   3,  Average loss: 0.0110, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   4,  Average loss: 0.0102, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   5,  Average loss: 0.0103, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   6,  Average loss: 0.0105, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   8,  Average loss: 0.0099, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   9,  Average loss: 0.0096, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Global model norm: 16.455330232675557.
Norm before scaling: 16.499476568993977. Distance: 2.394825753899546
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.9649, Accuracy: 5884/10000 (58.8400%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 1.0089, Accuracy: 4244/8968 (47.3238%)
Scaling by  100
Scaled Norm after poisoning: 239.154091931332, distance: 239.48262919781885
Total norm for 4 adversaries is: 239.154091931332. distance: 239.48262919781885
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 12447.9178, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   1,  Average loss: 0.0199, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   2,  Average loss: 0.0220, Accuracy: 233/591 (39.4247%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   3,  Average loss: 0.0135, Accuracy: 358/591 (60.5753%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   4,  Average loss: 0.0138, Accuracy: 352/591 (59.5601%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   5,  Average loss: 0.0129, Accuracy: 365/591 (61.7597%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   6,  Average loss: 0.0128, Accuracy: 350/591 (59.2217%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   7,  Average loss: 0.0129, Accuracy: 369/591 (62.4365%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   8,  Average loss: 0.0126, Accuracy: 374/591 (63.2826%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   9,  Average loss: 0.0121, Accuracy: 380/591 (64.2978%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch  10,  Average loss: 0.0121, Accuracy: 385/591 (65.1438%), train_poison_data_count: 195
Global model norm: 16.455330232675557.
Norm before scaling: 16.540118832882047. Distance: 2.567852013664497
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8165, Accuracy: 6769/10000 (67.6900%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.8339, Accuracy: 4549/8968 (50.7248%)
Scaling by  100
Scaled Norm after poisoning: 256.5732716983591, distance: 256.785264131336
Total norm for 4 adversaries is: 256.5732716983591. distance: 256.785264131336
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   1,  Average loss: 0.0158, Accuracy: 342/568 (60.2113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   2,  Average loss: 0.0123, Accuracy: 339/568 (59.6831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   3,  Average loss: 0.0103, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   4,  Average loss: 0.0098, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   5,  Average loss: 0.0093, Accuracy: 404/568 (71.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   6,  Average loss: 0.0094, Accuracy: 399/568 (70.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   7,  Average loss: 0.0089, Accuracy: 409/568 (72.0070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   8,  Average loss: 0.0085, Accuracy: 416/568 (73.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   9,  Average loss: 0.0085, Accuracy: 411/568 (72.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch  10,  Average loss: 0.0086, Accuracy: 405/568 (71.3028%), train_poison_data_count: 180
Global model norm: 16.455330232675557.
Norm before scaling: 16.50918970532965. Distance: 2.228833028003114
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8083, Accuracy: 7143/10000 (71.4300%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.8908, Accuracy: 4552/8968 (50.7583%)
Scaling by  100
Scaled Norm after poisoning: 222.77465492061702, distance: 222.8832899467791
Total norm for 4 adversaries is: 222.77465492061702. distance: 222.8832899467791
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   1,  Average loss: 0.0160, Accuracy: 346/557 (62.1185%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   2,  Average loss: 0.0079, Accuracy: 455/557 (81.6876%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   3,  Average loss: 0.0037, Accuracy: 514/557 (92.2801%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   4,  Average loss: 0.0031, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   5,  Average loss: 0.0028, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   6,  Average loss: 0.0023, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   7,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   8,  Average loss: 0.0023, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Global model norm: 16.455330232675557.
Norm before scaling: 16.623507554603773. Distance: 2.5978347602256706
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.5023, Accuracy: 8418/10000 (84.1800%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1096, Accuracy: 8552/8968 (95.3613%)
Scaling by  100
Scaled Norm after poisoning: 260.07637099513676, distance: 259.78347354094717
Total norm for 4 adversaries is: 260.07637099513676. distance: 259.78347354094717
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  16, local model 28, internal_epoch   1,  Average loss: 0.0015, Accuracy: 490/501 (97.8044%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1447, Accuracy: 9516/10000 (95.1600%)
___Train Local_Simple,  epoch  16, local model 37, internal_epoch   1,  Average loss: 0.0013, Accuracy: 842/860 (97.9070%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1417, Accuracy: 9562/10000 (95.6200%)
___Train Local_Simple,  epoch  16, local model 96, internal_epoch   1,  Average loss: 0.0017, Accuracy: 654/672 (97.3214%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1830, Accuracy: 9408/10000 (94.0800%)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0011, Accuracy: 373/377 (98.9390%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1224, Accuracy: 9616/10000 (96.1600%)
___Train Local_Simple,  epoch  16, local model 80, internal_epoch   1,  Average loss: 0.0010, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2911, Accuracy: 9123/10000 (91.2300%)
___Train Local_Simple,  epoch  16, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 717/734 (97.6839%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2173, Accuracy: 9312/10000 (93.1200%)
time spent on training: 169.44686436653137
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3937595387485162  data num: [606, 591, 568, 557, 501, 860, 672, 377, 431, 734]
[rfa agg] considering poison per batch poison_fraction: 0.12304985585891132
[rfa agg] init. name: [41, 73, 51, 74, 28, 37, 96, 99, 80, 13], weight: tensor([0.1028, 0.1002, 0.0963, 0.0945, 0.0850, 0.1458, 0.1140, 0.0639, 0.0731,
        0.1245])
[rfa agg] iter:  0, prev_obj_val: 120.3226318359375, obj_val: 105.61603546142578, abs dis: 14.706596374511719
[rfa agg] iter:  0, weight: tensor([0.0422, 0.0392, 0.0443, 0.0350, 0.1175, 0.2020, 0.1577, 0.0886, 0.1012,
        0.1722])
[rfa agg] iter:  1, prev_obj_val: 105.61603546142578, obj_val: 100.15518951416016, abs dis: 5.460845947265625
[rfa agg] iter:  1, weight: tensor([0.0177, 0.0162, 0.0182, 0.0148, 0.1306, 0.2248, 0.1751, 0.0986, 0.1126,
        0.1913])
[rfa agg] iter:  2, prev_obj_val: 100.15518951416016, obj_val: 97.969482421875, abs dis: 2.1857070922851562
[rfa agg] iter:  2, weight: tensor([0.0074, 0.0068, 0.0075, 0.0063, 0.1358, 0.2349, 0.1820, 0.1030, 0.1175,
        0.1988])
[rfa agg] iter:  3, prev_obj_val: 97.969482421875, obj_val: 97.10284423828125, abs dis: 0.86663818359375
[rfa agg] iter:  3, weight: tensor([0.0031, 0.0028, 0.0032, 0.0026, 0.1377, 0.2404, 0.1839, 0.1058, 0.1201,
        0.2004])
[rfa agg] iter:  4, prev_obj_val: 97.10284423828125, obj_val: 96.8034439086914, abs dis: 0.29940032958984375
[rfa agg] iter:  4, weight: tensor([0.0014, 0.0013, 0.0014, 0.0012, 0.1386, 0.2464, 0.1819, 0.1098, 0.1225,
        0.1956])
[rfa agg] iter:  5, prev_obj_val: 96.8034439086914, obj_val: 96.73714447021484, abs dis: 0.0662994384765625
[rfa agg] iter:  5, weight: tensor([0.0007, 0.0007, 0.0007, 0.0006, 0.1417, 0.2554, 0.1752, 0.1188, 0.1258,
        0.1805])
[rfa agg] iter:  6, prev_obj_val: 96.73714447021484, obj_val: 96.73017120361328, abs dis: 0.0069732666015625
[rfa agg] iter:  6, weight: tensor([0.0005, 0.0005, 0.0005, 0.0004, 0.1472, 0.2619, 0.1683, 0.1289, 0.1273,
        0.1645])
[rfa agg] iter:  7, prev_obj_val: 96.73017120361328, obj_val: 96.72978210449219, abs dis: 0.00038909912109375
[rfa agg] iter:  7, weight: tensor([0.0005, 0.0004, 0.0005, 0.0004, 0.1508, 0.2642, 0.1657, 0.1334, 0.1271,
        0.1570])
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.1094, Accuracy: 9724/10000 (97.2400%)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 5.5170, Accuracy: 100/8968 (1.1151%)
Done in 209.16829800605774 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:17 choose agents : [41, 73, 51, 74, 98, 78, 46, 45, 62, 50]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   1,  Average loss: 0.0179, Accuracy: 370/606 (61.0561%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   2,  Average loss: 0.0135, Accuracy: 349/606 (57.5908%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   3,  Average loss: 0.0117, Accuracy: 404/606 (66.6667%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   4,  Average loss: 0.0108, Accuracy: 397/606 (65.5116%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   5,  Average loss: 0.0103, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   6,  Average loss: 0.0099, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   7,  Average loss: 0.0097, Accuracy: 433/606 (71.4521%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   9,  Average loss: 0.0100, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch  10,  Average loss: 0.0101, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Global model norm: 16.456079462299982.
Norm before scaling: 16.520915329077468. Distance: 2.5620459177516643
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9560, Accuracy: 6240/10000 (62.4000%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 1.0337, Accuracy: 4096/8968 (45.6735%)
Scaling by  100
Scaled Norm after poisoning: 255.8691147955337, distance: 256.2045996366966
Total norm for 4 adversaries is: 255.8691147955337. distance: 256.2045996366966
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 73685.5838, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   1,  Average loss: 0.0193, Accuracy: 334/591 (56.5144%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   2,  Average loss: 0.0187, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   3,  Average loss: 0.0147, Accuracy: 295/591 (49.9154%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   4,  Average loss: 0.0142, Accuracy: 348/591 (58.8832%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   5,  Average loss: 0.0135, Accuracy: 366/591 (61.9289%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   6,  Average loss: 0.0132, Accuracy: 347/591 (58.7140%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   7,  Average loss: 0.0123, Accuracy: 379/591 (64.1286%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   8,  Average loss: 0.0121, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   9,  Average loss: 0.0126, Accuracy: 367/591 (62.0981%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch  10,  Average loss: 0.0126, Accuracy: 372/591 (62.9442%), train_poison_data_count: 195
Global model norm: 16.456079462299982.
Norm before scaling: 16.488225261247038. Distance: 2.4136479586620068
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.8807, Accuracy: 5907/10000 (59.0700%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.7776, Accuracy: 5641/8968 (62.9014%)
Scaling by  100
Scaled Norm after poisoning: 240.93795395547377, distance: 241.36480429010356
Total norm for 4 adversaries is: 240.93795395547377. distance: 241.36480429010356
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   1,  Average loss: 0.0151, Accuracy: 359/568 (63.2042%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   2,  Average loss: 0.0119, Accuracy: 343/568 (60.3873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   3,  Average loss: 0.0102, Accuracy: 405/568 (71.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   4,  Average loss: 0.0095, Accuracy: 402/568 (70.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   5,  Average loss: 0.0097, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   6,  Average loss: 0.0092, Accuracy: 402/568 (70.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   7,  Average loss: 0.0091, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   8,  Average loss: 0.0087, Accuracy: 407/568 (71.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   9,  Average loss: 0.0086, Accuracy: 414/568 (72.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch  10,  Average loss: 0.0086, Accuracy: 411/568 (72.3592%), train_poison_data_count: 180
Global model norm: 16.456079462299982.
Norm before scaling: 16.48346135649353. Distance: 2.0675231568816694
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9029, Accuracy: 6587/10000 (65.8700%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.8036, Accuracy: 5090/8968 (56.7574%)
Scaling by  100
Scaled Norm after poisoning: 206.59153540259098, distance: 206.7523050052889
Total norm for 4 adversaries is: 206.59153540259098. distance: 206.7523050052889
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   1,  Average loss: 0.0157, Accuracy: 360/557 (64.6320%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   2,  Average loss: 0.0078, Accuracy: 476/557 (85.4578%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   3,  Average loss: 0.0032, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   4,  Average loss: 0.0027, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   5,  Average loss: 0.0025, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   6,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   7,  Average loss: 0.0024, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   8,  Average loss: 0.0019, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   9,  Average loss: 0.0019, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch  10,  Average loss: 0.0019, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Global model norm: 16.456081316786435.
Norm before scaling: 16.647491614377863. Distance: 2.533828269980369
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4329, Accuracy: 8657/10000 (86.5700%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1111, Accuracy: 8521/8968 (95.0156%)
Scaling by  100
Scaled Norm after poisoning: 253.90006338616774, distance: 253.3827237352618
Total norm for 4 adversaries is: 253.90006338616774. distance: 253.3827237352618
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  17, local model 98, internal_epoch   1,  Average loss: 0.0017, Accuracy: 787/818 (96.2103%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3228, Accuracy: 8982/10000 (89.8200%)
___Train Local_Simple,  epoch  17, local model 78, internal_epoch   1,  Average loss: 0.0013, Accuracy: 296/303 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1753, Accuracy: 9462/10000 (94.6200%)
___Train Local_Simple,  epoch  17, local model 46, internal_epoch   1,  Average loss: 0.0027, Accuracy: 691/710 (97.3239%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3921, Accuracy: 8786/10000 (87.8600%)
___Train Local_Simple,  epoch  17, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 614/628 (97.7707%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4587, Accuracy: 8594/10000 (85.9400%)
___Train Local_Simple,  epoch  17, local model 62, internal_epoch   1,  Average loss: 0.0011, Accuracy: 416/423 (98.3452%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1022, Accuracy: 9680/10000 (96.8000%)
___Train Local_Simple,  epoch  17, local model 50, internal_epoch   1,  Average loss: 0.0021, Accuracy: 457/474 (96.4135%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2043, Accuracy: 9344/10000 (93.4400%)
time spent on training: 163.62424635887146
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.40894681225783724  data num: [606, 591, 568, 557, 818, 303, 710, 628, 423, 474]
[rfa agg] considering poison per batch poison_fraction: 0.12779587883057414
[rfa agg] init. name: [41, 73, 51, 74, 98, 78, 46, 45, 62, 50], weight: tensor([0.1067, 0.1041, 0.1000, 0.0981, 0.1441, 0.0534, 0.1250, 0.1106, 0.0745,
        0.0835])
[rfa agg] iter:  0, prev_obj_val: 121.12586212158203, obj_val: 107.53518676757812, abs dis: 13.590675354003906
[rfa agg] iter:  0, weight: tensor([0.0428, 0.0457, 0.0522, 0.0392, 0.1996, 0.0741, 0.1734, 0.1535, 0.1035,
        0.1159])
[rfa agg] iter:  1, prev_obj_val: 107.53518676757812, obj_val: 102.22222900390625, abs dis: 5.312957763671875
[rfa agg] iter:  1, weight: tensor([0.0194, 0.0204, 0.0232, 0.0179, 0.2233, 0.0832, 0.1943, 0.1722, 0.1161,
        0.1299])
[rfa agg] iter:  2, prev_obj_val: 102.22222900390625, obj_val: 99.93956756591797, abs dis: 2.2826614379882812
[rfa agg] iter:  2, weight: tensor([0.0088, 0.0092, 0.0104, 0.0082, 0.2332, 0.0876, 0.2034, 0.1807, 0.1221,
        0.1364])
[rfa agg] iter:  3, prev_obj_val: 99.93956756591797, obj_val: 98.95249938964844, abs dis: 0.9870681762695312
[rfa agg] iter:  3, weight: tensor([0.0040, 0.0042, 0.0047, 0.0038, 0.2360, 0.0901, 0.2067, 0.1850, 0.1258,
        0.1396])
[rfa agg] iter:  4, prev_obj_val: 98.95249938964844, obj_val: 98.55931091308594, abs dis: 0.3931884765625
[rfa agg] iter:  4, weight: tensor([0.0019, 0.0020, 0.0022, 0.0018, 0.2336, 0.0928, 0.2059, 0.1878, 0.1301,
        0.1420])
[rfa agg] iter:  5, prev_obj_val: 98.55931091308594, obj_val: 98.44293975830078, abs dis: 0.11637115478515625
[rfa agg] iter:  5, weight: tensor([0.0010, 0.0010, 0.0011, 0.0009, 0.2258, 0.0967, 0.1992, 0.1901, 0.1391,
        0.1450])
[rfa agg] iter:  6, prev_obj_val: 98.44293975830078, obj_val: 98.42391967773438, abs dis: 0.01902008056640625
[rfa agg] iter:  6, weight: tensor([0.0007, 0.0007, 0.0008, 0.0006, 0.2162, 0.1005, 0.1880, 0.1909, 0.1537,
        0.1480])
[rfa agg] iter:  7, prev_obj_val: 98.42391967773438, obj_val: 98.42227172851562, abs dis: 0.00164794921875
[rfa agg] iter:  7, weight: tensor([0.0006, 0.0006, 0.0007, 0.0005, 0.2104, 0.1023, 0.1802, 0.1905, 0.1646,
        0.1496])
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.1040, Accuracy: 9730/10000 (97.3000%)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 5.6305, Accuracy: 90/8968 (1.0036%)
Done in 201.69095301628113 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:18 choose agents : [41, 73, 51, 74, 67, 14, 36, 24, 7, 4]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   1,  Average loss: 0.0167, Accuracy: 378/606 (62.3762%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   2,  Average loss: 0.0142, Accuracy: 345/606 (56.9307%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   3,  Average loss: 0.0114, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   4,  Average loss: 0.0109, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   5,  Average loss: 0.0105, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   6,  Average loss: 0.0104, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Global model norm: 16.455367324053608.
Norm before scaling: 16.522526016526555. Distance: 2.4859940153803337
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.8969, Accuracy: 6430/10000 (64.3000%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 1.1249, Accuracy: 3803/8968 (42.4063%)
Scaling by  100
Scaled Norm after poisoning: 248.34635906833827, distance: 248.5994283606662
Total norm for 4 adversaries is: 248.34635906833827. distance: 248.5994283606662
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 12881.0398, Accuracy: 3707/8968 (41.3359%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   1,  Average loss: 0.0197, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   2,  Average loss: 0.0196, Accuracy: 247/591 (41.7936%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   3,  Average loss: 0.0156, Accuracy: 322/591 (54.4839%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   4,  Average loss: 0.0135, Accuracy: 368/591 (62.2673%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   5,  Average loss: 0.0128, Accuracy: 369/591 (62.4365%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   6,  Average loss: 0.0125, Accuracy: 366/591 (61.9289%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   7,  Average loss: 0.0124, Accuracy: 379/591 (64.1286%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   8,  Average loss: 0.0125, Accuracy: 383/591 (64.8054%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   9,  Average loss: 0.0123, Accuracy: 360/591 (60.9137%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch  10,  Average loss: 0.0118, Accuracy: 385/591 (65.1438%), train_poison_data_count: 195
Global model norm: 16.455369178620316.
Norm before scaling: 16.537423897335287. Distance: 2.5387959971315675
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.8201, Accuracy: 6397/10000 (63.9700%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.8030, Accuracy: 4656/8968 (51.9179%)
Scaling by  100
Scaled Norm after poisoning: 253.67651337382418, distance: 253.87953897961134
Total norm for 4 adversaries is: 253.67651337382418. distance: 253.87953897961134
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   1,  Average loss: 0.0159, Accuracy: 335/568 (58.9789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   2,  Average loss: 0.0124, Accuracy: 341/568 (60.0352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   3,  Average loss: 0.0113, Accuracy: 398/568 (70.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   4,  Average loss: 0.0104, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   5,  Average loss: 0.0099, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   6,  Average loss: 0.0095, Accuracy: 398/568 (70.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   7,  Average loss: 0.0092, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   8,  Average loss: 0.0087, Accuracy: 407/568 (71.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   9,  Average loss: 0.0086, Accuracy: 411/568 (72.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch  10,  Average loss: 0.0084, Accuracy: 402/568 (70.7746%), train_poison_data_count: 180
Global model norm: 16.455367324053608.
Norm before scaling: 16.484053795745016. Distance: 2.207411039640059
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9986, Accuracy: 5954/10000 (59.5400%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.5676, Accuracy: 7013/8968 (78.2003%)
Scaling by  100
Scaled Norm after poisoning: 220.46467262352942, distance: 220.7412052325075
Total norm for 4 adversaries is: 220.46467262352942. distance: 220.7412052325075
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   1,  Average loss: 0.0152, Accuracy: 356/557 (63.9138%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   2,  Average loss: 0.0075, Accuracy: 456/557 (81.8671%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   3,  Average loss: 0.0040, Accuracy: 519/557 (93.1777%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   4,  Average loss: 0.0036, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   5,  Average loss: 0.0027, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   6,  Average loss: 0.0026, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   7,  Average loss: 0.0020, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   8,  Average loss: 0.0020, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   9,  Average loss: 0.0020, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch  10,  Average loss: 0.0018, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Global model norm: 16.455367324053608.
Norm before scaling: 16.60832123450518. Distance: 2.4859906587125984
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4479, Accuracy: 8589/10000 (85.8900%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1098, Accuracy: 8505/8968 (94.8372%)
Scaling by  100
Scaled Norm after poisoning: 248.91770414637043, distance: 248.599066960739
Total norm for 4 adversaries is: 248.91770414637043. distance: 248.599066960739
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  18, local model 67, internal_epoch   1,  Average loss: 0.0015, Accuracy: 970/998 (97.1944%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3705, Accuracy: 8767/10000 (87.6700%)
___Train Local_Simple,  epoch  18, local model 14, internal_epoch   1,  Average loss: 0.0014, Accuracy: 369/376 (98.1383%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1112, Accuracy: 9687/10000 (96.8700%)
___Train Local_Simple,  epoch  18, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 982/1005 (97.7114%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2067, Accuracy: 9368/10000 (93.6800%)
___Train Local_Simple,  epoch  18, local model 24, internal_epoch   1,  Average loss: 0.0017, Accuracy: 365/379 (96.3061%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1238, Accuracy: 9631/10000 (96.3100%)
___Train Local_Simple,  epoch  18, local model 7, internal_epoch   1,  Average loss: 0.0016, Accuracy: 405/418 (96.8900%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1250, Accuracy: 9613/10000 (96.1300%)
___Train Local_Simple,  epoch  18, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 642/658 (97.5684%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2075, Accuracy: 9331/10000 (93.3100%)
time spent on training: 168.20206880569458
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.37719298245614036  data num: [606, 591, 568, 557, 998, 376, 1005, 379, 418, 658]
[rfa agg] considering poison per batch poison_fraction: 0.11787280701754387
[rfa agg] init. name: [41, 73, 51, 74, 67, 14, 36, 24, 7, 4], weight: tensor([0.0984, 0.0960, 0.0923, 0.0905, 0.1621, 0.0611, 0.1633, 0.0616, 0.0679,
        0.1069])
[rfa agg] iter:  0, prev_obj_val: 116.12252807617188, obj_val: 100.8790512084961, abs dis: 15.243476867675781
[rfa agg] iter:  0, weight: tensor([0.0372, 0.0363, 0.0412, 0.0337, 0.2215, 0.0836, 0.2233, 0.0842, 0.0928,
        0.1460])
[rfa agg] iter:  1, prev_obj_val: 100.8790512084961, obj_val: 95.3286361694336, abs dis: 5.5504150390625
[rfa agg] iter:  1, weight: tensor([0.0149, 0.0144, 0.0161, 0.0137, 0.2445, 0.0927, 0.2469, 0.0932, 0.1026,
        0.1611])
[rfa agg] iter:  2, prev_obj_val: 95.3286361694336, obj_val: 93.20526885986328, abs dis: 2.1233673095703125
[rfa agg] iter:  2, weight: tensor([0.0060, 0.0057, 0.0064, 0.0055, 0.2529, 0.0969, 0.2564, 0.0971, 0.1066,
        0.1666])
[rfa agg] iter:  3, prev_obj_val: 93.20526885986328, obj_val: 92.43470764160156, abs dis: 0.7705612182617188
[rfa agg] iter:  3, weight: tensor([0.0024, 0.0023, 0.0026, 0.0022, 0.2536, 0.1006, 0.2598, 0.1000, 0.1087,
        0.1678])
[rfa agg] iter:  4, prev_obj_val: 92.43470764160156, obj_val: 92.22364044189453, abs dis: 0.21106719970703125
[rfa agg] iter:  4, weight: tensor([0.0011, 0.0010, 0.0011, 0.0010, 0.2454, 0.1083, 0.2567, 0.1061, 0.1117,
        0.1676])
[rfa agg] iter:  5, prev_obj_val: 92.22364044189453, obj_val: 92.1939926147461, abs dis: 0.0296478271484375
[rfa agg] iter:  5, weight: tensor([0.0007, 0.0006, 0.0007, 0.0006, 0.2280, 0.1216, 0.2433, 0.1183, 0.1172,
        0.1690])
[rfa agg] iter:  6, prev_obj_val: 92.1939926147461, obj_val: 92.19192504882812, abs dis: 0.00206756591796875
[rfa agg] iter:  6, weight: tensor([0.0005, 0.0005, 0.0006, 0.0005, 0.2149, 0.1304, 0.2309, 0.1282, 0.1218,
        0.1717])
[rfa agg] iter:  7, prev_obj_val: 92.19192504882812, obj_val: 92.1917953491211, abs dis: 0.00012969970703125
[rfa agg] iter:  7, weight: tensor([0.0005, 0.0005, 0.0006, 0.0005, 0.2093, 0.1338, 0.2250, 0.1325, 0.1240,
        0.1732])
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.1013, Accuracy: 9732/10000 (97.3200%)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 5.6763, Accuracy: 91/8968 (1.0147%)
Done in 205.9357442855835 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:19 choose agents : [41, 73, 51, 74, 80, 39, 26, 29, 4, 42]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   1,  Average loss: 0.0167, Accuracy: 380/606 (62.7063%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   2,  Average loss: 0.0129, Accuracy: 361/606 (59.5710%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   3,  Average loss: 0.0109, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   4,  Average loss: 0.0104, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   5,  Average loss: 0.0100, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   6,  Average loss: 0.0101, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   7,  Average loss: 0.0099, Accuracy: 435/606 (71.7822%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   9,  Average loss: 0.0099, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Global model norm: 16.454915730838138.
Norm before scaling: 16.482947583340678. Distance: 2.3615643783022753
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.0958, Accuracy: 5646/10000 (56.4600%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.9415, Accuracy: 4610/8968 (51.4050%)
Scaling by  100
Scaled Norm after poisoning: 235.744109483673, distance: 236.15643815329278
Total norm for 4 adversaries is: 235.744109483673. distance: 236.15643815329278
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1996.8847, Accuracy: 4640/8968 (51.7395%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   1,  Average loss: 0.0220, Accuracy: 334/591 (56.5144%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   2,  Average loss: 0.0227, Accuracy: 236/591 (39.9323%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   3,  Average loss: 0.0154, Accuracy: 315/591 (53.2995%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   4,  Average loss: 0.0148, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   5,  Average loss: 0.0141, Accuracy: 368/591 (62.2673%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   6,  Average loss: 0.0133, Accuracy: 376/591 (63.6210%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   7,  Average loss: 0.0134, Accuracy: 343/591 (58.0372%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   8,  Average loss: 0.0131, Accuracy: 371/591 (62.7750%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   9,  Average loss: 0.0128, Accuracy: 362/591 (61.2521%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch  10,  Average loss: 0.0127, Accuracy: 380/591 (64.2978%), train_poison_data_count: 195
Global model norm: 16.454915730838138.
Norm before scaling: 16.598376532529468. Distance: 3.186848293326454
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.9151, Accuracy: 6259/10000 (62.5900%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.8456, Accuracy: 4839/8968 (53.9585%)
Scaling by  100
Scaled Norm after poisoning: 318.2599296369243, distance: 318.6847849952991
Total norm for 4 adversaries is: 318.2599296369243. distance: 318.6847849952991
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   1,  Average loss: 0.0153, Accuracy: 355/568 (62.5000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   2,  Average loss: 0.0111, Accuracy: 372/568 (65.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   3,  Average loss: 0.0100, Accuracy: 399/568 (70.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   4,  Average loss: 0.0100, Accuracy: 387/568 (68.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   5,  Average loss: 0.0091, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   6,  Average loss: 0.0091, Accuracy: 407/568 (71.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   7,  Average loss: 0.0083, Accuracy: 421/568 (74.1197%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   8,  Average loss: 0.0081, Accuracy: 422/568 (74.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   9,  Average loss: 0.0077, Accuracy: 423/568 (74.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch  10,  Average loss: 0.0074, Accuracy: 437/568 (76.9366%), train_poison_data_count: 180
Global model norm: 16.454915730838138.
Norm before scaling: 16.49060160837833. Distance: 2.1994112787617808
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.9399, Accuracy: 6321/10000 (63.2100%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.4936, Accuracy: 7245/8968 (80.7872%)
Scaling by  100
Scaled Norm after poisoning: 219.72415234789278, distance: 219.9411231585626
Total norm for 4 adversaries is: 219.72415234789278. distance: 219.9411231585626
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   1,  Average loss: 0.0158, Accuracy: 368/557 (66.0682%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   2,  Average loss: 0.0081, Accuracy: 434/557 (77.9174%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   3,  Average loss: 0.0037, Accuracy: 520/557 (93.3573%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   4,  Average loss: 0.0032, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   5,  Average loss: 0.0027, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   6,  Average loss: 0.0030, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   7,  Average loss: 0.0021, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   8,  Average loss: 0.0021, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   9,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch  10,  Average loss: 0.0021, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Global model norm: 16.454915730838138.
Norm before scaling: 16.613255992074617. Distance: 2.5277986898244245
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.4912, Accuracy: 8443/10000 (84.4300%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1059, Accuracy: 8542/8968 (95.2498%)
Scaling by  100
Scaled Norm after poisoning: 253.0871653823046, distance: 252.7798959198496
Total norm for 4 adversaries is: 253.0871653823046. distance: 252.7798959198496
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  19, local model 80, internal_epoch   1,  Average loss: 0.0010, Accuracy: 427/431 (99.0719%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2693, Accuracy: 9208/10000 (92.0800%)
___Train Local_Simple,  epoch  19, local model 39, internal_epoch   1,  Average loss: 0.0013, Accuracy: 252/257 (98.0545%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 197690996115858938550807806338924544.0000, Accuracy: 1256/10000 (12.5600%)
___Train Local_Simple,  epoch  19, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 541/554 (97.6534%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1368, Accuracy: 9588/10000 (95.8800%)
___Train Local_Simple,  epoch  19, local model 29, internal_epoch   1,  Average loss: 0.0011, Accuracy: 984/1002 (98.2036%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2442, Accuracy: 9209/10000 (92.0900%)
___Train Local_Simple,  epoch  19, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 644/658 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2722, Accuracy: 9127/10000 (91.2700%)
___Train Local_Simple,  epoch  19, local model 42, internal_epoch   1,  Average loss: 0.0016, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1115, Accuracy: 9663/10000 (96.6300%)
time spent on training: 166.68634581565857
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.42527472527472526  data num: [606, 591, 568, 557, 431, 257, 554, 1002, 658, 236]
[rfa agg] considering poison per batch poison_fraction: 0.13289835164835165
[rfa agg] init. name: [41, 73, 51, 74, 80, 39, 26, 29, 4, 42], weight: tensor([0.1110, 0.1082, 0.1040, 0.1020, 0.0789, 0.0471, 0.1015, 0.1835, 0.1205,
        0.0432])
[rfa agg] iter:  0, prev_obj_val: inf, obj_val: nan, abs dis: nan
[rfa agg] iter:  0, weight: tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan])
[rfa agg] iter:  1, prev_obj_val: nan, obj_val: inf, abs dis: nan
[rfa agg] iter:  1, weight: tensor([0.1110, 0.1082, 0.1040, 0.1020, 0.0789, 0.0471, 0.1015, 0.1835, 0.1205,
        0.0432])
[rfa agg] iter:  2, prev_obj_val: inf, obj_val: nan, abs dis: nan
[rfa agg] iter:  2, weight: tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan])
[rfa agg] iter:  3, prev_obj_val: nan, obj_val: inf, abs dis: nan
[rfa agg] iter:  3, weight: tensor([0.1110, 0.1082, 0.1040, 0.1020, 0.0789, 0.0471, 0.1015, 0.1835, 0.1205,
        0.0432])
[rfa agg] iter:  4, prev_obj_val: inf, obj_val: nan, abs dis: nan
[rfa agg] iter:  4, weight: tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan])
[rfa agg] iter:  5, prev_obj_val: nan, obj_val: inf, abs dis: nan
[rfa agg] iter:  5, weight: tensor([0.1110, 0.1082, 0.1040, 0.1020, 0.0789, 0.0471, 0.1015, 0.1835, 0.1205,
        0.0432])
[rfa agg] iter:  6, prev_obj_val: inf, obj_val: nan, abs dis: nan
[rfa agg] iter:  6, weight: tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan])
[rfa agg] iter:  7, prev_obj_val: nan, obj_val: inf, abs dis: nan
[rfa agg] iter:  7, weight: tensor([0.1110, 0.1082, 0.1040, 0.1020, 0.0789, 0.0471, 0.1015, 0.1835, 0.1205,
        0.0432])
[rfa agg] iter:  8, prev_obj_val: inf, obj_val: nan, abs dis: nan
[rfa agg] iter:  8, weight: tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan])
[rfa agg] iter:  9, prev_obj_val: nan, obj_val: inf, abs dis: nan
[rfa agg] iter:  9, weight: tensor([0.1110, 0.1082, 0.1040, 0.1020, 0.0789, 0.0471, 0.1015, 0.1835, 0.1205,
        0.0432])
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 1132566426789581739775080332787712.0000, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 205.34899854660034 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:20 choose agents : [41, 73, 51, 74, 69, 95, 80, 8, 25, 68]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   1,  Average loss: nan, Accuracy: 59/606 (9.7360%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   2,  Average loss: nan, Accuracy: 36/606 (5.9406%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   3,  Average loss: nan, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   4,  Average loss: nan, Accuracy: 35/606 (5.7756%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   5,  Average loss: nan, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   6,  Average loss: nan, Accuracy: 42/606 (6.9307%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   7,  Average loss: nan, Accuracy: 32/606 (5.2805%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   8,  Average loss: nan, Accuracy: 30/606 (4.9505%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   9,  Average loss: nan, Accuracy: 30/606 (4.9505%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch  10,  Average loss: nan, Accuracy: 33/606 (5.4455%), train_poison_data_count: 200
Global model norm: inf.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 20: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   1,  Average loss: nan, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   2,  Average loss: nan, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   3,  Average loss: nan, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   4,  Average loss: nan, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   5,  Average loss: nan, Accuracy: 275/591 (46.5313%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   6,  Average loss: nan, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   7,  Average loss: nan, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   8,  Average loss: nan, Accuracy: 276/591 (46.7005%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   9,  Average loss: nan, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch  10,  Average loss: nan, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Global model norm: inf.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 20: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   1,  Average loss: nan, Accuracy: 59/568 (10.3873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   2,  Average loss: nan, Accuracy: 37/568 (6.5141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   3,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   4,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   5,  Average loss: nan, Accuracy: 42/568 (7.3944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   6,  Average loss: nan, Accuracy: 45/568 (7.9225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   7,  Average loss: nan, Accuracy: 37/568 (6.5141%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   8,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   9,  Average loss: nan, Accuracy: 38/568 (6.6901%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch  10,  Average loss: nan, Accuracy: 38/568 (6.6901%), train_poison_data_count: 180
Global model norm: inf.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 20: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   1,  Average loss: nan, Accuracy: 29/557 (5.2065%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   2,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   3,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   4,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   5,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   6,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   7,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   8,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   9,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch  10,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Global model norm: inf.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 20: Average loss: nan, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  20, local model 69, internal_epoch   1,  Average loss: nan, Accuracy: 1/256 (0.3906%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  20, local model 95, internal_epoch   1,  Average loss: nan, Accuracy: 47/602 (7.8073%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  20, local model 80, internal_epoch   1,  Average loss: nan, Accuracy: 33/431 (7.6566%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  20, local model 8, internal_epoch   1,  Average loss: nan, Accuracy: 41/633 (6.4771%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  20, local model 25, internal_epoch   1,  Average loss: nan, Accuracy: 38/647 (5.8733%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  20, local model 68, internal_epoch   1,  Average loss: nan, Accuracy: 5/494 (1.0121%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: nan, Accuracy: 980/10000 (9.8000%)
time spent on training: 164.3126289844513
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.43119777158774375  data num: [606, 591, 568, 557, 256, 602, 431, 633, 647, 494]
[rfa agg] considering poison per batch poison_fraction: 0.13474930362116994
[rfa agg] init. name: [41, 73, 51, 74, 69, 95, 80, 8, 25, 68], weight: tensor([0.1125, 0.1097, 0.1055, 0.1034, 0.0475, 0.1118, 0.0800, 0.1175, 0.1201,
        0.0917])
[rfa agg] iter:  0, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  0, weight: tensor([0.1125, 0.1097, 0.1055, 0.1034, 0.0475, 0.1118, 0.0800, 0.1175, 0.1201,
        0.0917])
[rfa agg] iter:  1, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  1, weight: tensor([0.1125, 0.1097, 0.1055, 0.1034, 0.0475, 0.1118, 0.0800, 0.1175, 0.1201,
        0.0917])
[rfa agg] iter:  2, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  2, weight: tensor([0.1125, 0.1097, 0.1055, 0.1034, 0.0475, 0.1118, 0.0800, 0.1175, 0.1201,
        0.0917])
[rfa agg] iter:  3, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  3, weight: tensor([0.1125, 0.1097, 0.1055, 0.1034, 0.0475, 0.1118, 0.0800, 0.1175, 0.1201,
        0.0917])
[rfa agg] iter:  4, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  4, weight: tensor([0.1125, 0.1097, 0.1055, 0.1034, 0.0475, 0.1118, 0.0800, 0.1175, 0.1201,
        0.0917])
[rfa agg] iter:  5, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  5, weight: tensor([0.1125, 0.1097, 0.1055, 0.1034, 0.0475, 0.1118, 0.0800, 0.1175, 0.1201,
        0.0917])
[rfa agg] iter:  6, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  6, weight: tensor([0.1125, 0.1097, 0.1055, 0.1034, 0.0475, 0.1118, 0.0800, 0.1175, 0.1201,
        0.0917])
[rfa agg] iter:  7, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  7, weight: tensor([0.1125, 0.1097, 0.1055, 0.1034, 0.0475, 0.1118, 0.0800, 0.1175, 0.1201,
        0.0917])
[rfa agg] iter:  8, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  8, weight: tensor([0.1125, 0.1097, 0.1055, 0.1034, 0.0475, 0.1118, 0.0800, 0.1175, 0.1201,
        0.0917])
[rfa agg] iter:  9, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  9, weight: tensor([0.1125, 0.1097, 0.1055, 0.1034, 0.0475, 0.1118, 0.0800, 0.1175, 0.1201,
        0.0917])
___Test Target_Simple poisoned: False, epoch: 20: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Done in 202.09668517112732 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:21 choose agents : [41, 73, 51, 74, 70, 61, 64, 31, 10, 23]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: nan, Accuracy: 35/606 (5.7756%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: nan, Accuracy: 45/606 (7.4257%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: nan, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: nan, Accuracy: 33/606 (5.4455%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: nan, Accuracy: 36/606 (5.9406%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: nan, Accuracy: 29/606 (4.7855%), train_poison_data_count: 200
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 21: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   1,  Average loss: nan, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   2,  Average loss: nan, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   3,  Average loss: nan, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   4,  Average loss: nan, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   5,  Average loss: nan, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   6,  Average loss: nan, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   7,  Average loss: nan, Accuracy: 260/591 (43.9932%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   8,  Average loss: nan, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   9,  Average loss: nan, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch  10,  Average loss: nan, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 21: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   1,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   2,  Average loss: nan, Accuracy: 42/568 (7.3944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   3,  Average loss: nan, Accuracy: 42/568 (7.3944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   4,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   5,  Average loss: nan, Accuracy: 38/568 (6.6901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   6,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   7,  Average loss: nan, Accuracy: 38/568 (6.6901%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   8,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   9,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch  10,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 21: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   1,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   2,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   3,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   4,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   5,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   6,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   7,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   8,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   9,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch  10,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 21: Average loss: nan, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  21, local model 70, internal_epoch   1,  Average loss: nan, Accuracy: 36/724 (4.9724%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  21, local model 61, internal_epoch   1,  Average loss: nan, Accuracy: 2/699 (0.2861%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  21, local model 64, internal_epoch   1,  Average loss: nan, Accuracy: 104/813 (12.7921%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  21, local model 31, internal_epoch   1,  Average loss: nan, Accuracy: 279/835 (33.4132%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  21, local model 10, internal_epoch   1,  Average loss: nan, Accuracy: 101/892 (11.3229%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  21, local model 23, internal_epoch   1,  Average loss: nan, Accuracy: 9/293 (3.0717%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: nan, Accuracy: 980/10000 (9.8000%)
time spent on training: 170.48461246490479
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3529948312557008  data num: [606, 591, 568, 557, 724, 699, 813, 835, 892, 293]
[rfa agg] considering poison per batch poison_fraction: 0.1103108847674065
[rfa agg] init. name: [41, 73, 51, 74, 70, 61, 64, 31, 10, 23], weight: tensor([0.0921, 0.0898, 0.0863, 0.0847, 0.1101, 0.1063, 0.1236, 0.1269, 0.1356,
        0.0445])
[rfa agg] iter:  0, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  0, weight: tensor([0.0921, 0.0898, 0.0863, 0.0847, 0.1101, 0.1063, 0.1236, 0.1269, 0.1356,
        0.0445])
[rfa agg] iter:  1, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  1, weight: tensor([0.0921, 0.0898, 0.0863, 0.0847, 0.1101, 0.1063, 0.1236, 0.1269, 0.1356,
        0.0445])
[rfa agg] iter:  2, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  2, weight: tensor([0.0921, 0.0898, 0.0863, 0.0847, 0.1101, 0.1063, 0.1236, 0.1269, 0.1356,
        0.0445])
[rfa agg] iter:  3, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  3, weight: tensor([0.0921, 0.0898, 0.0863, 0.0847, 0.1101, 0.1063, 0.1236, 0.1269, 0.1356,
        0.0445])
[rfa agg] iter:  4, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  4, weight: tensor([0.0921, 0.0898, 0.0863, 0.0847, 0.1101, 0.1063, 0.1236, 0.1269, 0.1356,
        0.0445])
[rfa agg] iter:  5, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  5, weight: tensor([0.0921, 0.0898, 0.0863, 0.0847, 0.1101, 0.1063, 0.1236, 0.1269, 0.1356,
        0.0445])
[rfa agg] iter:  6, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  6, weight: tensor([0.0921, 0.0898, 0.0863, 0.0847, 0.1101, 0.1063, 0.1236, 0.1269, 0.1356,
        0.0445])
[rfa agg] iter:  7, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  7, weight: tensor([0.0921, 0.0898, 0.0863, 0.0847, 0.1101, 0.1063, 0.1236, 0.1269, 0.1356,
        0.0445])
[rfa agg] iter:  8, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  8, weight: tensor([0.0921, 0.0898, 0.0863, 0.0847, 0.1101, 0.1063, 0.1236, 0.1269, 0.1356,
        0.0445])
[rfa agg] iter:  9, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  9, weight: tensor([0.0921, 0.0898, 0.0863, 0.0847, 0.1101, 0.1063, 0.1236, 0.1269, 0.1356,
        0.0445])
___Test Target_Simple poisoned: False, epoch: 21: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Done in 208.11361050605774 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:22 choose agents : [41, 73, 51, 74, 7, 46, 65, 57, 83, 9]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   1,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   2,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   3,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   4,  Average loss: nan, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   5,  Average loss: nan, Accuracy: 33/606 (5.4455%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   6,  Average loss: nan, Accuracy: 31/606 (5.1155%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   7,  Average loss: nan, Accuracy: 30/606 (4.9505%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   8,  Average loss: nan, Accuracy: 35/606 (5.7756%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   9,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch  10,  Average loss: nan, Accuracy: 32/606 (5.2805%), train_poison_data_count: 200
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 22: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   1,  Average loss: nan, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   2,  Average loss: nan, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   3,  Average loss: nan, Accuracy: 278/591 (47.0389%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   4,  Average loss: nan, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   5,  Average loss: nan, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   6,  Average loss: nan, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   7,  Average loss: nan, Accuracy: 276/591 (46.7005%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   8,  Average loss: nan, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   9,  Average loss: nan, Accuracy: 280/591 (47.3773%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch  10,  Average loss: nan, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 22: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   1,  Average loss: nan, Accuracy: 39/568 (6.8662%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   2,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   3,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   4,  Average loss: nan, Accuracy: 46/568 (8.0986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   5,  Average loss: nan, Accuracy: 51/568 (8.9789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   6,  Average loss: nan, Accuracy: 42/568 (7.3944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   7,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   8,  Average loss: nan, Accuracy: 42/568 (7.3944%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   9,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch  10,  Average loss: nan, Accuracy: 45/568 (7.9225%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 22: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   1,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   2,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   3,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   4,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   5,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   6,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   7,  Average loss: nan, Accuracy: 2/557 (0.3591%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   8,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   9,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch  10,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 22: Average loss: nan, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  22, local model 7, internal_epoch   1,  Average loss: nan, Accuracy: 0/418 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  22, local model 46, internal_epoch   1,  Average loss: nan, Accuracy: 0/710 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  22, local model 65, internal_epoch   1,  Average loss: nan, Accuracy: 144/371 (38.8140%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  22, local model 57, internal_epoch   1,  Average loss: nan, Accuracy: 0/343 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  22, local model 83, internal_epoch   1,  Average loss: nan, Accuracy: 46/433 (10.6236%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  22, local model 9, internal_epoch   1,  Average loss: nan, Accuracy: 2/436 (0.4587%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: nan, Accuracy: 980/10000 (9.8000%)
time spent on training: 169.2517638206482
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.46135505662626664  data num: [606, 591, 568, 557, 418, 710, 371, 343, 433, 436]
[rfa agg] considering poison per batch poison_fraction: 0.14417345519570832
[rfa agg] init. name: [41, 73, 51, 74, 7, 46, 65, 57, 83, 9], weight: tensor([0.1204, 0.1174, 0.1129, 0.1107, 0.0831, 0.1411, 0.0737, 0.0682, 0.0860,
        0.0866])
[rfa agg] iter:  0, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  0, weight: tensor([0.1204, 0.1174, 0.1129, 0.1107, 0.0831, 0.1411, 0.0737, 0.0682, 0.0860,
        0.0866])
[rfa agg] iter:  1, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  1, weight: tensor([0.1204, 0.1174, 0.1129, 0.1107, 0.0831, 0.1411, 0.0737, 0.0682, 0.0860,
        0.0866])
[rfa agg] iter:  2, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  2, weight: tensor([0.1204, 0.1174, 0.1129, 0.1107, 0.0831, 0.1411, 0.0737, 0.0682, 0.0860,
        0.0866])
[rfa agg] iter:  3, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  3, weight: tensor([0.1204, 0.1174, 0.1129, 0.1107, 0.0831, 0.1411, 0.0737, 0.0682, 0.0860,
        0.0866])
[rfa agg] iter:  4, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  4, weight: tensor([0.1204, 0.1174, 0.1129, 0.1107, 0.0831, 0.1411, 0.0737, 0.0682, 0.0860,
        0.0866])
[rfa agg] iter:  5, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  5, weight: tensor([0.1204, 0.1174, 0.1129, 0.1107, 0.0831, 0.1411, 0.0737, 0.0682, 0.0860,
        0.0866])
[rfa agg] iter:  6, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  6, weight: tensor([0.1204, 0.1174, 0.1129, 0.1107, 0.0831, 0.1411, 0.0737, 0.0682, 0.0860,
        0.0866])
[rfa agg] iter:  7, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  7, weight: tensor([0.1204, 0.1174, 0.1129, 0.1107, 0.0831, 0.1411, 0.0737, 0.0682, 0.0860,
        0.0866])
[rfa agg] iter:  8, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  8, weight: tensor([0.1204, 0.1174, 0.1129, 0.1107, 0.0831, 0.1411, 0.0737, 0.0682, 0.0860,
        0.0866])
[rfa agg] iter:  9, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  9, weight: tensor([0.1204, 0.1174, 0.1129, 0.1107, 0.0831, 0.1411, 0.0737, 0.0682, 0.0860,
        0.0866])
___Test Target_Simple poisoned: False, epoch: 22: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Done in 208.0711476802826 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:23 choose agents : [41, 73, 51, 74, 64, 58, 12, 83, 96, 90]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   1,  Average loss: nan, Accuracy: 41/606 (6.7657%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   2,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   3,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   4,  Average loss: nan, Accuracy: 35/606 (5.7756%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   5,  Average loss: nan, Accuracy: 36/606 (5.9406%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   6,  Average loss: nan, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   7,  Average loss: nan, Accuracy: 32/606 (5.2805%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   8,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   9,  Average loss: nan, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch  10,  Average loss: nan, Accuracy: 40/606 (6.6007%), train_poison_data_count: 200
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 23: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   1,  Average loss: nan, Accuracy: 275/591 (46.5313%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   2,  Average loss: nan, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   3,  Average loss: nan, Accuracy: 256/591 (43.3164%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   4,  Average loss: nan, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   5,  Average loss: nan, Accuracy: 272/591 (46.0237%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   6,  Average loss: nan, Accuracy: 275/591 (46.5313%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   7,  Average loss: nan, Accuracy: 273/591 (46.1929%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   8,  Average loss: nan, Accuracy: 278/591 (47.0389%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   9,  Average loss: nan, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch  10,  Average loss: nan, Accuracy: 276/591 (46.7005%), train_poison_data_count: 195
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 23: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   1,  Average loss: nan, Accuracy: 39/568 (6.8662%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   2,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   3,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   4,  Average loss: nan, Accuracy: 39/568 (6.8662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   5,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   6,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   7,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   8,  Average loss: nan, Accuracy: 39/568 (6.8662%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   9,  Average loss: nan, Accuracy: 37/568 (6.5141%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch  10,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 23: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   1,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   2,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   3,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   4,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   5,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   6,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   7,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   8,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   9,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch  10,  Average loss: nan, Accuracy: 2/557 (0.3591%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 23: Average loss: nan, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  23, local model 64, internal_epoch   1,  Average loss: nan, Accuracy: 104/813 (12.7921%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  23, local model 58, internal_epoch   1,  Average loss: nan, Accuracy: 0/276 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  23, local model 12, internal_epoch   1,  Average loss: nan, Accuracy: 157/1160 (13.5345%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  23, local model 83, internal_epoch   1,  Average loss: nan, Accuracy: 46/433 (10.6236%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  23, local model 96, internal_epoch   1,  Average loss: nan, Accuracy: 231/672 (34.3750%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  23, local model 90, internal_epoch   1,  Average loss: nan, Accuracy: 0/683 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: nan, Accuracy: 980/10000 (9.8000%)
time spent on training: 172.50559401512146
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3651517534203491  data num: [606, 591, 568, 557, 813, 276, 1160, 433, 672, 683]
[rfa agg] considering poison per batch poison_fraction: 0.1141099229438591
[rfa agg] init. name: [41, 73, 51, 74, 64, 58, 12, 83, 96, 90], weight: tensor([0.0953, 0.0929, 0.0893, 0.0876, 0.1279, 0.0434, 0.1824, 0.0681, 0.1057,
        0.1074])
[rfa agg] iter:  0, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  0, weight: tensor([0.0953, 0.0929, 0.0893, 0.0876, 0.1279, 0.0434, 0.1824, 0.0681, 0.1057,
        0.1074])
[rfa agg] iter:  1, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  1, weight: tensor([0.0953, 0.0929, 0.0893, 0.0876, 0.1279, 0.0434, 0.1824, 0.0681, 0.1057,
        0.1074])
[rfa agg] iter:  2, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  2, weight: tensor([0.0953, 0.0929, 0.0893, 0.0876, 0.1279, 0.0434, 0.1824, 0.0681, 0.1057,
        0.1074])
[rfa agg] iter:  3, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  3, weight: tensor([0.0953, 0.0929, 0.0893, 0.0876, 0.1279, 0.0434, 0.1824, 0.0681, 0.1057,
        0.1074])
[rfa agg] iter:  4, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  4, weight: tensor([0.0953, 0.0929, 0.0893, 0.0876, 0.1279, 0.0434, 0.1824, 0.0681, 0.1057,
        0.1074])
[rfa agg] iter:  5, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  5, weight: tensor([0.0953, 0.0929, 0.0893, 0.0876, 0.1279, 0.0434, 0.1824, 0.0681, 0.1057,
        0.1074])
[rfa agg] iter:  6, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  6, weight: tensor([0.0953, 0.0929, 0.0893, 0.0876, 0.1279, 0.0434, 0.1824, 0.0681, 0.1057,
        0.1074])
[rfa agg] iter:  7, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  7, weight: tensor([0.0953, 0.0929, 0.0893, 0.0876, 0.1279, 0.0434, 0.1824, 0.0681, 0.1057,
        0.1074])
[rfa agg] iter:  8, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  8, weight: tensor([0.0953, 0.0929, 0.0893, 0.0876, 0.1279, 0.0434, 0.1824, 0.0681, 0.1057,
        0.1074])
[rfa agg] iter:  9, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  9, weight: tensor([0.0953, 0.0929, 0.0893, 0.0876, 0.1279, 0.0434, 0.1824, 0.0681, 0.1057,
        0.1074])
___Test Target_Simple poisoned: False, epoch: 23: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Done in 211.35795783996582 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:24 choose agents : [41, 73, 51, 74, 28, 65, 33, 75, 13, 32]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   1,  Average loss: nan, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   2,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   3,  Average loss: nan, Accuracy: 29/606 (4.7855%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   4,  Average loss: nan, Accuracy: 35/606 (5.7756%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   5,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   6,  Average loss: nan, Accuracy: 36/606 (5.9406%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   7,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   8,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   9,  Average loss: nan, Accuracy: 29/606 (4.7855%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch  10,  Average loss: nan, Accuracy: 33/606 (5.4455%), train_poison_data_count: 200
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 24: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   1,  Average loss: nan, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   2,  Average loss: nan, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   3,  Average loss: nan, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   4,  Average loss: nan, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   5,  Average loss: nan, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   6,  Average loss: nan, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   7,  Average loss: nan, Accuracy: 273/591 (46.1929%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   8,  Average loss: nan, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   9,  Average loss: nan, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch  10,  Average loss: nan, Accuracy: 272/591 (46.0237%), train_poison_data_count: 195
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 24: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   1,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   2,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   3,  Average loss: nan, Accuracy: 42/568 (7.3944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   4,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   5,  Average loss: nan, Accuracy: 45/568 (7.9225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   6,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   7,  Average loss: nan, Accuracy: 38/568 (6.6901%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   8,  Average loss: nan, Accuracy: 46/568 (8.0986%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   9,  Average loss: nan, Accuracy: 36/568 (6.3380%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch  10,  Average loss: nan, Accuracy: 47/568 (8.2746%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 24: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   1,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   2,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   3,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   4,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   5,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   6,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   7,  Average loss: nan, Accuracy: 1/557 (0.1795%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   8,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   9,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch  10,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 24: Average loss: nan, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  24, local model 28, internal_epoch   1,  Average loss: nan, Accuracy: 61/501 (12.1756%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: nan, Accuracy: 144/371 (38.8140%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  24, local model 33, internal_epoch   1,  Average loss: nan, Accuracy: 2/623 (0.3210%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  24, local model 75, internal_epoch   1,  Average loss: nan, Accuracy: 44/686 (6.4140%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  24, local model 13, internal_epoch   1,  Average loss: nan, Accuracy: 1/734 (0.1362%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  24, local model 32, internal_epoch   1,  Average loss: nan, Accuracy: 191/977 (19.5496%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: nan, Accuracy: 980/10000 (9.8000%)
time spent on training: 173.0359284877777
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3736723527518507  data num: [606, 591, 568, 557, 501, 371, 623, 686, 734, 977]
[rfa agg] considering poison per batch poison_fraction: 0.11677261023495333
[rfa agg] init. name: [41, 73, 51, 74, 28, 65, 33, 75, 13, 32], weight: tensor([0.0975, 0.0951, 0.0914, 0.0896, 0.0806, 0.0597, 0.1003, 0.1104, 0.1181,
        0.1572])
[rfa agg] iter:  0, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  0, weight: tensor([0.0975, 0.0951, 0.0914, 0.0896, 0.0806, 0.0597, 0.1003, 0.1104, 0.1181,
        0.1572])
[rfa agg] iter:  1, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  1, weight: tensor([0.0975, 0.0951, 0.0914, 0.0896, 0.0806, 0.0597, 0.1003, 0.1104, 0.1181,
        0.1572])
[rfa agg] iter:  2, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  2, weight: tensor([0.0975, 0.0951, 0.0914, 0.0896, 0.0806, 0.0597, 0.1003, 0.1104, 0.1181,
        0.1572])
[rfa agg] iter:  3, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  3, weight: tensor([0.0975, 0.0951, 0.0914, 0.0896, 0.0806, 0.0597, 0.1003, 0.1104, 0.1181,
        0.1572])
[rfa agg] iter:  4, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  4, weight: tensor([0.0975, 0.0951, 0.0914, 0.0896, 0.0806, 0.0597, 0.1003, 0.1104, 0.1181,
        0.1572])
[rfa agg] iter:  5, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  5, weight: tensor([0.0975, 0.0951, 0.0914, 0.0896, 0.0806, 0.0597, 0.1003, 0.1104, 0.1181,
        0.1572])
[rfa agg] iter:  6, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  6, weight: tensor([0.0975, 0.0951, 0.0914, 0.0896, 0.0806, 0.0597, 0.1003, 0.1104, 0.1181,
        0.1572])
[rfa agg] iter:  7, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  7, weight: tensor([0.0975, 0.0951, 0.0914, 0.0896, 0.0806, 0.0597, 0.1003, 0.1104, 0.1181,
        0.1572])
[rfa agg] iter:  8, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  8, weight: tensor([0.0975, 0.0951, 0.0914, 0.0896, 0.0806, 0.0597, 0.1003, 0.1104, 0.1181,
        0.1572])
[rfa agg] iter:  9, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  9, weight: tensor([0.0975, 0.0951, 0.0914, 0.0896, 0.0806, 0.0597, 0.1003, 0.1104, 0.1181,
        0.1572])
___Test Target_Simple poisoned: False, epoch: 24: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Done in 212.06825470924377 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:25 choose agents : [41, 73, 51, 74, 80, 23, 25, 12, 58, 19]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   1,  Average loss: nan, Accuracy: 32/606 (5.2805%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   2,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   3,  Average loss: nan, Accuracy: 35/606 (5.7756%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   4,  Average loss: nan, Accuracy: 31/606 (5.1155%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   5,  Average loss: nan, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   6,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   7,  Average loss: nan, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   8,  Average loss: nan, Accuracy: 35/606 (5.7756%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   9,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch  10,  Average loss: nan, Accuracy: 32/606 (5.2805%), train_poison_data_count: 200
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 25: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   1,  Average loss: nan, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   2,  Average loss: nan, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   3,  Average loss: nan, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   4,  Average loss: nan, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   5,  Average loss: nan, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   6,  Average loss: nan, Accuracy: 274/591 (46.3621%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   7,  Average loss: nan, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   8,  Average loss: nan, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   9,  Average loss: nan, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch  10,  Average loss: nan, Accuracy: 258/591 (43.6548%), train_poison_data_count: 195
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 25: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   1,  Average loss: nan, Accuracy: 42/568 (7.3944%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   2,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   3,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   4,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   5,  Average loss: nan, Accuracy: 42/568 (7.3944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   6,  Average loss: nan, Accuracy: 39/568 (6.8662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   7,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   8,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   9,  Average loss: nan, Accuracy: 35/568 (6.1620%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch  10,  Average loss: nan, Accuracy: 42/568 (7.3944%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 25: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   1,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   2,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   3,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   4,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   5,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   6,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   7,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   8,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   9,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch  10,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 25: Average loss: nan, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  25, local model 80, internal_epoch   1,  Average loss: nan, Accuracy: 33/431 (7.6566%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  25, local model 23, internal_epoch   1,  Average loss: nan, Accuracy: 9/293 (3.0717%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  25, local model 25, internal_epoch   1,  Average loss: nan, Accuracy: 5/647 (0.7728%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  25, local model 12, internal_epoch   1,  Average loss: nan, Accuracy: 157/1160 (13.5345%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  25, local model 58, internal_epoch   1,  Average loss: nan, Accuracy: 0/276 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  25, local model 19, internal_epoch   1,  Average loss: nan, Accuracy: 0/205 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: nan, Accuracy: 980/10000 (9.8000%)
time spent on training: 173.83231496810913
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.43532058492688414  data num: [606, 591, 568, 557, 431, 293, 647, 1160, 276, 205]
[rfa agg] considering poison per batch poison_fraction: 0.13603768278965128
[rfa agg] init. name: [41, 73, 51, 74, 80, 23, 25, 12, 58, 19], weight: tensor([0.1136, 0.1108, 0.1065, 0.1044, 0.0808, 0.0549, 0.1213, 0.2175, 0.0517,
        0.0384])
[rfa agg] iter:  0, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  0, weight: tensor([0.1136, 0.1108, 0.1065, 0.1044, 0.0808, 0.0549, 0.1213, 0.2175, 0.0517,
        0.0384])
[rfa agg] iter:  1, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  1, weight: tensor([0.1136, 0.1108, 0.1065, 0.1044, 0.0808, 0.0549, 0.1213, 0.2175, 0.0517,
        0.0384])
[rfa agg] iter:  2, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  2, weight: tensor([0.1136, 0.1108, 0.1065, 0.1044, 0.0808, 0.0549, 0.1213, 0.2175, 0.0517,
        0.0384])
[rfa agg] iter:  3, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  3, weight: tensor([0.1136, 0.1108, 0.1065, 0.1044, 0.0808, 0.0549, 0.1213, 0.2175, 0.0517,
        0.0384])
[rfa agg] iter:  4, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  4, weight: tensor([0.1136, 0.1108, 0.1065, 0.1044, 0.0808, 0.0549, 0.1213, 0.2175, 0.0517,
        0.0384])
[rfa agg] iter:  5, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  5, weight: tensor([0.1136, 0.1108, 0.1065, 0.1044, 0.0808, 0.0549, 0.1213, 0.2175, 0.0517,
        0.0384])
[rfa agg] iter:  6, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  6, weight: tensor([0.1136, 0.1108, 0.1065, 0.1044, 0.0808, 0.0549, 0.1213, 0.2175, 0.0517,
        0.0384])
[rfa agg] iter:  7, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  7, weight: tensor([0.1136, 0.1108, 0.1065, 0.1044, 0.0808, 0.0549, 0.1213, 0.2175, 0.0517,
        0.0384])
[rfa agg] iter:  8, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  8, weight: tensor([0.1136, 0.1108, 0.1065, 0.1044, 0.0808, 0.0549, 0.1213, 0.2175, 0.0517,
        0.0384])
[rfa agg] iter:  9, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  9, weight: tensor([0.1136, 0.1108, 0.1065, 0.1044, 0.0808, 0.0549, 0.1213, 0.2175, 0.0517,
        0.0384])
___Test Target_Simple poisoned: False, epoch: 25: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Done in 214.6506040096283 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:26 choose agents : [41, 73, 51, 74, 11, 13, 82, 50, 34, 14]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   1,  Average loss: nan, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   2,  Average loss: nan, Accuracy: 41/606 (6.7657%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   3,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   4,  Average loss: nan, Accuracy: 33/606 (5.4455%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   5,  Average loss: nan, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   6,  Average loss: nan, Accuracy: 36/606 (5.9406%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   7,  Average loss: nan, Accuracy: 32/606 (5.2805%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   8,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   9,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch  10,  Average loss: nan, Accuracy: 40/606 (6.6007%), train_poison_data_count: 200
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 26: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   1,  Average loss: nan, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   2,  Average loss: nan, Accuracy: 259/591 (43.8240%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   3,  Average loss: nan, Accuracy: 274/591 (46.3621%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   4,  Average loss: nan, Accuracy: 274/591 (46.3621%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   5,  Average loss: nan, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   6,  Average loss: nan, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   7,  Average loss: nan, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   8,  Average loss: nan, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   9,  Average loss: nan, Accuracy: 273/591 (46.1929%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch  10,  Average loss: nan, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 26: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   1,  Average loss: nan, Accuracy: 37/568 (6.5141%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   2,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   3,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   4,  Average loss: nan, Accuracy: 36/568 (6.3380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   5,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   6,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   7,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   8,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   9,  Average loss: nan, Accuracy: 39/568 (6.8662%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch  10,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 26: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   1,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   2,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   3,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   4,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   5,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   6,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   7,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   8,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   9,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch  10,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 26: Average loss: nan, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  26, local model 11, internal_epoch   1,  Average loss: nan, Accuracy: 11/645 (1.7054%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  26, local model 13, internal_epoch   1,  Average loss: nan, Accuracy: 1/734 (0.1362%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  26, local model 82, internal_epoch   1,  Average loss: nan, Accuracy: 0/713 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  26, local model 50, internal_epoch   1,  Average loss: nan, Accuracy: 0/474 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  26, local model 34, internal_epoch   1,  Average loss: nan, Accuracy: 17/413 (4.1162%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: nan, Accuracy: 3/376 (0.7979%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: nan, Accuracy: 980/10000 (9.8000%)
time spent on training: 186.75536346435547
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4090188479830897  data num: [606, 591, 568, 557, 645, 734, 713, 474, 413, 376]
[rfa agg] considering poison per batch poison_fraction: 0.12781838999471554
[rfa agg] init. name: [41, 73, 51, 74, 11, 13, 82, 50, 34, 14], weight: tensor([0.1067, 0.1041, 0.1001, 0.0981, 0.1136, 0.1293, 0.1256, 0.0835, 0.0727,
        0.0662])
[rfa agg] iter:  0, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  0, weight: tensor([0.1067, 0.1041, 0.1001, 0.0981, 0.1136, 0.1293, 0.1256, 0.0835, 0.0727,
        0.0662])
[rfa agg] iter:  1, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  1, weight: tensor([0.1067, 0.1041, 0.1001, 0.0981, 0.1136, 0.1293, 0.1256, 0.0835, 0.0727,
        0.0662])
[rfa agg] iter:  2, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  2, weight: tensor([0.1067, 0.1041, 0.1001, 0.0981, 0.1136, 0.1293, 0.1256, 0.0835, 0.0727,
        0.0662])
[rfa agg] iter:  3, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  3, weight: tensor([0.1067, 0.1041, 0.1001, 0.0981, 0.1136, 0.1293, 0.1256, 0.0835, 0.0727,
        0.0662])
[rfa agg] iter:  4, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  4, weight: tensor([0.1067, 0.1041, 0.1001, 0.0981, 0.1136, 0.1293, 0.1256, 0.0835, 0.0727,
        0.0662])
[rfa agg] iter:  5, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  5, weight: tensor([0.1067, 0.1041, 0.1001, 0.0981, 0.1136, 0.1293, 0.1256, 0.0835, 0.0727,
        0.0662])
[rfa agg] iter:  6, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  6, weight: tensor([0.1067, 0.1041, 0.1001, 0.0981, 0.1136, 0.1293, 0.1256, 0.0835, 0.0727,
        0.0662])
[rfa agg] iter:  7, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  7, weight: tensor([0.1067, 0.1041, 0.1001, 0.0981, 0.1136, 0.1293, 0.1256, 0.0835, 0.0727,
        0.0662])
[rfa agg] iter:  8, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  8, weight: tensor([0.1067, 0.1041, 0.1001, 0.0981, 0.1136, 0.1293, 0.1256, 0.0835, 0.0727,
        0.0662])
[rfa agg] iter:  9, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  9, weight: tensor([0.1067, 0.1041, 0.1001, 0.0981, 0.1136, 0.1293, 0.1256, 0.0835, 0.0727,
        0.0662])
___Test Target_Simple poisoned: False, epoch: 26: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Done in 230.41797041893005 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:27 choose agents : [41, 73, 51, 74, 55, 58, 53, 14, 36, 6]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   1,  Average loss: nan, Accuracy: 42/606 (6.9307%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   2,  Average loss: nan, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   3,  Average loss: nan, Accuracy: 41/606 (6.7657%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   4,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   5,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   6,  Average loss: nan, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   7,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   8,  Average loss: nan, Accuracy: 33/606 (5.4455%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   9,  Average loss: nan, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch  10,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 27: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   1,  Average loss: nan, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   2,  Average loss: nan, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   3,  Average loss: nan, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   4,  Average loss: nan, Accuracy: 256/591 (43.3164%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   5,  Average loss: nan, Accuracy: 257/591 (43.4856%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   6,  Average loss: nan, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   7,  Average loss: nan, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   8,  Average loss: nan, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   9,  Average loss: nan, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch  10,  Average loss: nan, Accuracy: 258/591 (43.6548%), train_poison_data_count: 195
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 27: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   1,  Average loss: nan, Accuracy: 45/568 (7.9225%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   2,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   3,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   4,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   5,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   6,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   7,  Average loss: nan, Accuracy: 45/568 (7.9225%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   8,  Average loss: nan, Accuracy: 38/568 (6.6901%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   9,  Average loss: nan, Accuracy: 45/568 (7.9225%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch  10,  Average loss: nan, Accuracy: 36/568 (6.3380%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 27: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   1,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   2,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   3,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   4,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   5,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   6,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   7,  Average loss: nan, Accuracy: 2/557 (0.3591%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   8,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   9,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch  10,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 27: Average loss: nan, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  27, local model 55, internal_epoch   1,  Average loss: nan, Accuracy: 80/354 (22.5989%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  27, local model 58, internal_epoch   1,  Average loss: nan, Accuracy: 0/276 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  27, local model 53, internal_epoch   1,  Average loss: nan, Accuracy: 246/739 (33.2882%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  27, local model 14, internal_epoch   1,  Average loss: nan, Accuracy: 3/376 (0.7979%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  27, local model 36, internal_epoch   1,  Average loss: nan, Accuracy: 79/1005 (7.8607%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  27, local model 6, internal_epoch   1,  Average loss: nan, Accuracy: 5/615 (0.8130%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: nan, Accuracy: 980/10000 (9.8000%)
time spent on training: 183.73372864723206
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.40829963073676806  data num: [606, 591, 568, 557, 354, 276, 739, 376, 1005, 615]
[rfa agg] considering poison per batch poison_fraction: 0.12759363460524
[rfa agg] init. name: [41, 73, 51, 74, 55, 58, 53, 14, 36, 6], weight: tensor([0.1066, 0.1039, 0.0999, 0.0979, 0.0622, 0.0485, 0.1299, 0.0661, 0.1767,
        0.1081])
[rfa agg] iter:  0, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  0, weight: tensor([0.1066, 0.1039, 0.0999, 0.0979, 0.0622, 0.0485, 0.1299, 0.0661, 0.1767,
        0.1081])
[rfa agg] iter:  1, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  1, weight: tensor([0.1066, 0.1039, 0.0999, 0.0979, 0.0622, 0.0485, 0.1299, 0.0661, 0.1767,
        0.1081])
[rfa agg] iter:  2, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  2, weight: tensor([0.1066, 0.1039, 0.0999, 0.0979, 0.0622, 0.0485, 0.1299, 0.0661, 0.1767,
        0.1081])
[rfa agg] iter:  3, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  3, weight: tensor([0.1066, 0.1039, 0.0999, 0.0979, 0.0622, 0.0485, 0.1299, 0.0661, 0.1767,
        0.1081])
[rfa agg] iter:  4, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  4, weight: tensor([0.1066, 0.1039, 0.0999, 0.0979, 0.0622, 0.0485, 0.1299, 0.0661, 0.1767,
        0.1081])
[rfa agg] iter:  5, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  5, weight: tensor([0.1066, 0.1039, 0.0999, 0.0979, 0.0622, 0.0485, 0.1299, 0.0661, 0.1767,
        0.1081])
[rfa agg] iter:  6, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  6, weight: tensor([0.1066, 0.1039, 0.0999, 0.0979, 0.0622, 0.0485, 0.1299, 0.0661, 0.1767,
        0.1081])
[rfa agg] iter:  7, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  7, weight: tensor([0.1066, 0.1039, 0.0999, 0.0979, 0.0622, 0.0485, 0.1299, 0.0661, 0.1767,
        0.1081])
[rfa agg] iter:  8, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  8, weight: tensor([0.1066, 0.1039, 0.0999, 0.0979, 0.0622, 0.0485, 0.1299, 0.0661, 0.1767,
        0.1081])
[rfa agg] iter:  9, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  9, weight: tensor([0.1066, 0.1039, 0.0999, 0.0979, 0.0622, 0.0485, 0.1299, 0.0661, 0.1767,
        0.1081])
___Test Target_Simple poisoned: False, epoch: 27: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Done in 223.6838517189026 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:28 choose agents : [41, 73, 51, 74, 47, 92, 37, 43, 17, 2]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   1,  Average loss: nan, Accuracy: 41/606 (6.7657%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   2,  Average loss: nan, Accuracy: 33/606 (5.4455%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   3,  Average loss: nan, Accuracy: 36/606 (5.9406%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   4,  Average loss: nan, Accuracy: 31/606 (5.1155%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   5,  Average loss: nan, Accuracy: 40/606 (6.6007%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   6,  Average loss: nan, Accuracy: 40/606 (6.6007%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   7,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   8,  Average loss: nan, Accuracy: 35/606 (5.7756%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   9,  Average loss: nan, Accuracy: 33/606 (5.4455%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch  10,  Average loss: nan, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 28: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   1,  Average loss: nan, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   2,  Average loss: nan, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   3,  Average loss: nan, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   4,  Average loss: nan, Accuracy: 258/591 (43.6548%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   5,  Average loss: nan, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   6,  Average loss: nan, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   7,  Average loss: nan, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   8,  Average loss: nan, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   9,  Average loss: nan, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch  10,  Average loss: nan, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 28: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   1,  Average loss: nan, Accuracy: 39/568 (6.8662%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   2,  Average loss: nan, Accuracy: 47/568 (8.2746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   3,  Average loss: nan, Accuracy: 39/568 (6.8662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   4,  Average loss: nan, Accuracy: 38/568 (6.6901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   5,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   6,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   7,  Average loss: nan, Accuracy: 42/568 (7.3944%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   8,  Average loss: nan, Accuracy: 46/568 (8.0986%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   9,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch  10,  Average loss: nan, Accuracy: 45/568 (7.9225%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 28: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   1,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   2,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   3,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   4,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   5,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   6,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   7,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   8,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   9,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch  10,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 28: Average loss: nan, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  28, local model 47, internal_epoch   1,  Average loss: nan, Accuracy: 12/776 (1.5464%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  28, local model 92, internal_epoch   1,  Average loss: nan, Accuracy: 298/937 (31.8036%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  28, local model 37, internal_epoch   1,  Average loss: nan, Accuracy: 164/860 (19.0698%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  28, local model 43, internal_epoch   1,  Average loss: nan, Accuracy: 22/408 (5.3922%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  28, local model 17, internal_epoch   1,  Average loss: nan, Accuracy: 60/620 (9.6774%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  28, local model 2, internal_epoch   1,  Average loss: nan, Accuracy: 2/548 (0.3650%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: nan, Accuracy: 980/10000 (9.8000%)
time spent on training: 170.17835140228271
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3588317107093185  data num: [606, 591, 568, 557, 776, 937, 860, 408, 620, 548]
[rfa agg] considering poison per batch poison_fraction: 0.11213490959666203
[rfa agg] init. name: [41, 73, 51, 74, 47, 92, 37, 43, 17, 2], weight: tensor([0.0936, 0.0913, 0.0878, 0.0861, 0.1199, 0.1448, 0.1329, 0.0631, 0.0958,
        0.0847])
[rfa agg] iter:  0, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  0, weight: tensor([0.0936, 0.0913, 0.0878, 0.0861, 0.1199, 0.1448, 0.1329, 0.0631, 0.0958,
        0.0847])
[rfa agg] iter:  1, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  1, weight: tensor([0.0936, 0.0913, 0.0878, 0.0861, 0.1199, 0.1448, 0.1329, 0.0631, 0.0958,
        0.0847])
[rfa agg] iter:  2, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  2, weight: tensor([0.0936, 0.0913, 0.0878, 0.0861, 0.1199, 0.1448, 0.1329, 0.0631, 0.0958,
        0.0847])
[rfa agg] iter:  3, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  3, weight: tensor([0.0936, 0.0913, 0.0878, 0.0861, 0.1199, 0.1448, 0.1329, 0.0631, 0.0958,
        0.0847])
[rfa agg] iter:  4, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  4, weight: tensor([0.0936, 0.0913, 0.0878, 0.0861, 0.1199, 0.1448, 0.1329, 0.0631, 0.0958,
        0.0847])
[rfa agg] iter:  5, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  5, weight: tensor([0.0936, 0.0913, 0.0878, 0.0861, 0.1199, 0.1448, 0.1329, 0.0631, 0.0958,
        0.0847])
[rfa agg] iter:  6, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  6, weight: tensor([0.0936, 0.0913, 0.0878, 0.0861, 0.1199, 0.1448, 0.1329, 0.0631, 0.0958,
        0.0847])
[rfa agg] iter:  7, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  7, weight: tensor([0.0936, 0.0913, 0.0878, 0.0861, 0.1199, 0.1448, 0.1329, 0.0631, 0.0958,
        0.0847])
[rfa agg] iter:  8, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  8, weight: tensor([0.0936, 0.0913, 0.0878, 0.0861, 0.1199, 0.1448, 0.1329, 0.0631, 0.0958,
        0.0847])
[rfa agg] iter:  9, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  9, weight: tensor([0.0936, 0.0913, 0.0878, 0.0861, 0.1199, 0.1448, 0.1329, 0.0631, 0.0958,
        0.0847])
___Test Target_Simple poisoned: False, epoch: 28: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Done in 207.11687016487122 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:29 choose agents : [41, 73, 51, 74, 66, 6, 38, 37, 45, 81]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   1,  Average loss: nan, Accuracy: 32/606 (5.2805%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   2,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   3,  Average loss: nan, Accuracy: 36/606 (5.9406%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   4,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   5,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   6,  Average loss: nan, Accuracy: 40/606 (6.6007%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   7,  Average loss: nan, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   8,  Average loss: nan, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   9,  Average loss: nan, Accuracy: 33/606 (5.4455%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch  10,  Average loss: nan, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 29: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   1,  Average loss: nan, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   2,  Average loss: nan, Accuracy: 277/591 (46.8697%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   3,  Average loss: nan, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   4,  Average loss: nan, Accuracy: 255/591 (43.1472%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   5,  Average loss: nan, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   6,  Average loss: nan, Accuracy: 277/591 (46.8697%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   7,  Average loss: nan, Accuracy: 278/591 (47.0389%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   8,  Average loss: nan, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   9,  Average loss: nan, Accuracy: 278/591 (47.0389%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch  10,  Average loss: nan, Accuracy: 273/591 (46.1929%), train_poison_data_count: 195
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 29: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   1,  Average loss: nan, Accuracy: 49/568 (8.6268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   2,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   3,  Average loss: nan, Accuracy: 45/568 (7.9225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   4,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   5,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   6,  Average loss: nan, Accuracy: 39/568 (6.8662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   7,  Average loss: nan, Accuracy: 39/568 (6.8662%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   8,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   9,  Average loss: nan, Accuracy: 45/568 (7.9225%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch  10,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 29: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   1,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   2,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   3,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   4,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   5,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   6,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   7,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   8,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   9,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch  10,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 29: Average loss: nan, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  29, local model 66, internal_epoch   1,  Average loss: nan, Accuracy: 0/660 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   1,  Average loss: nan, Accuracy: 5/615 (0.8130%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  29, local model 38, internal_epoch   1,  Average loss: nan, Accuracy: 79/895 (8.8268%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  29, local model 37, internal_epoch   1,  Average loss: nan, Accuracy: 164/860 (19.0698%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  29, local model 45, internal_epoch   1,  Average loss: nan, Accuracy: 191/628 (30.4140%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  29, local model 81, internal_epoch   1,  Average loss: nan, Accuracy: 54/1227 (4.4010%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: nan, Accuracy: 980/10000 (9.8000%)
time spent on training: 165.67049717903137
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3221867628694325  data num: [606, 591, 568, 557, 660, 615, 895, 860, 628, 1227]
[rfa agg] considering poison per batch poison_fraction: 0.10068336339669764
[rfa agg] init. name: [41, 73, 51, 74, 66, 6, 38, 37, 45, 81], weight: tensor([0.0841, 0.0820, 0.0788, 0.0773, 0.0916, 0.0853, 0.1242, 0.1193, 0.0871,
        0.1703])
[rfa agg] iter:  0, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  0, weight: tensor([0.0841, 0.0820, 0.0788, 0.0773, 0.0916, 0.0853, 0.1242, 0.1193, 0.0871,
        0.1703])
[rfa agg] iter:  1, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  1, weight: tensor([0.0841, 0.0820, 0.0788, 0.0773, 0.0916, 0.0853, 0.1242, 0.1193, 0.0871,
        0.1703])
[rfa agg] iter:  2, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  2, weight: tensor([0.0841, 0.0820, 0.0788, 0.0773, 0.0916, 0.0853, 0.1242, 0.1193, 0.0871,
        0.1703])
[rfa agg] iter:  3, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  3, weight: tensor([0.0841, 0.0820, 0.0788, 0.0773, 0.0916, 0.0853, 0.1242, 0.1193, 0.0871,
        0.1703])
[rfa agg] iter:  4, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  4, weight: tensor([0.0841, 0.0820, 0.0788, 0.0773, 0.0916, 0.0853, 0.1242, 0.1193, 0.0871,
        0.1703])
[rfa agg] iter:  5, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  5, weight: tensor([0.0841, 0.0820, 0.0788, 0.0773, 0.0916, 0.0853, 0.1242, 0.1193, 0.0871,
        0.1703])
[rfa agg] iter:  6, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  6, weight: tensor([0.0841, 0.0820, 0.0788, 0.0773, 0.0916, 0.0853, 0.1242, 0.1193, 0.0871,
        0.1703])
[rfa agg] iter:  7, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  7, weight: tensor([0.0841, 0.0820, 0.0788, 0.0773, 0.0916, 0.0853, 0.1242, 0.1193, 0.0871,
        0.1703])
[rfa agg] iter:  8, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  8, weight: tensor([0.0841, 0.0820, 0.0788, 0.0773, 0.0916, 0.0853, 0.1242, 0.1193, 0.0871,
        0.1703])
[rfa agg] iter:  9, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  9, weight: tensor([0.0841, 0.0820, 0.0788, 0.0773, 0.0916, 0.0853, 0.1242, 0.1193, 0.0871,
        0.1703])
___Test Target_Simple poisoned: False, epoch: 29: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Done in 204.82458329200745 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:30 choose agents : [41, 73, 51, 74, 4, 24, 38, 54, 10, 11]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   1,  Average loss: nan, Accuracy: 36/606 (5.9406%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   2,  Average loss: nan, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   3,  Average loss: nan, Accuracy: 35/606 (5.7756%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   4,  Average loss: nan, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   5,  Average loss: nan, Accuracy: 41/606 (6.7657%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   6,  Average loss: nan, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   7,  Average loss: nan, Accuracy: 32/606 (5.2805%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   8,  Average loss: nan, Accuracy: 33/606 (5.4455%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   9,  Average loss: nan, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch  10,  Average loss: nan, Accuracy: 35/606 (5.7756%), train_poison_data_count: 200
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 30: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   1,  Average loss: nan, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   2,  Average loss: nan, Accuracy: 260/591 (43.9932%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   3,  Average loss: nan, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   4,  Average loss: nan, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   5,  Average loss: nan, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   6,  Average loss: nan, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   7,  Average loss: nan, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   8,  Average loss: nan, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   9,  Average loss: nan, Accuracy: 254/591 (42.9780%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch  10,  Average loss: nan, Accuracy: 258/591 (43.6548%), train_poison_data_count: 195
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 30: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   1,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   2,  Average loss: nan, Accuracy: 39/568 (6.8662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   3,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   4,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   5,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   6,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   7,  Average loss: nan, Accuracy: 39/568 (6.8662%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   8,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   9,  Average loss: nan, Accuracy: 39/568 (6.8662%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch  10,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 30: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   1,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   2,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   3,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   4,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   5,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   6,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   7,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   8,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   9,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch  10,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 30: Average loss: nan, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  30, local model 4, internal_epoch   1,  Average loss: nan, Accuracy: 17/658 (2.5836%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  30, local model 24, internal_epoch   1,  Average loss: nan, Accuracy: 0/379 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  30, local model 38, internal_epoch   1,  Average loss: nan, Accuracy: 79/895 (8.8268%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  30, local model 54, internal_epoch   1,  Average loss: nan, Accuracy: 0/519 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  30, local model 10, internal_epoch   1,  Average loss: nan, Accuracy: 101/892 (11.3229%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  30, local model 11, internal_epoch   1,  Average loss: nan, Accuracy: 11/645 (1.7054%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: nan, Accuracy: 980/10000 (9.8000%)
time spent on training: 167.13659119606018
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.36798732171156895  data num: [606, 591, 568, 557, 658, 379, 895, 519, 892, 645]
[rfa agg] considering poison per batch poison_fraction: 0.1149960380348653
[rfa agg] init. name: [41, 73, 51, 74, 4, 24, 38, 54, 10, 11], weight: tensor([0.0960, 0.0937, 0.0900, 0.0883, 0.1043, 0.0601, 0.1418, 0.0823, 0.1414,
        0.1022])
[rfa agg] iter:  0, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  0, weight: tensor([0.0960, 0.0937, 0.0900, 0.0883, 0.1043, 0.0601, 0.1418, 0.0823, 0.1414,
        0.1022])
[rfa agg] iter:  1, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  1, weight: tensor([0.0960, 0.0937, 0.0900, 0.0883, 0.1043, 0.0601, 0.1418, 0.0823, 0.1414,
        0.1022])
[rfa agg] iter:  2, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  2, weight: tensor([0.0960, 0.0937, 0.0900, 0.0883, 0.1043, 0.0601, 0.1418, 0.0823, 0.1414,
        0.1022])
[rfa agg] iter:  3, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  3, weight: tensor([0.0960, 0.0937, 0.0900, 0.0883, 0.1043, 0.0601, 0.1418, 0.0823, 0.1414,
        0.1022])
[rfa agg] iter:  4, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  4, weight: tensor([0.0960, 0.0937, 0.0900, 0.0883, 0.1043, 0.0601, 0.1418, 0.0823, 0.1414,
        0.1022])
[rfa agg] iter:  5, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  5, weight: tensor([0.0960, 0.0937, 0.0900, 0.0883, 0.1043, 0.0601, 0.1418, 0.0823, 0.1414,
        0.1022])
[rfa agg] iter:  6, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  6, weight: tensor([0.0960, 0.0937, 0.0900, 0.0883, 0.1043, 0.0601, 0.1418, 0.0823, 0.1414,
        0.1022])
[rfa agg] iter:  7, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  7, weight: tensor([0.0960, 0.0937, 0.0900, 0.0883, 0.1043, 0.0601, 0.1418, 0.0823, 0.1414,
        0.1022])
[rfa agg] iter:  8, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  8, weight: tensor([0.0960, 0.0937, 0.0900, 0.0883, 0.1043, 0.0601, 0.1418, 0.0823, 0.1414,
        0.1022])
[rfa agg] iter:  9, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  9, weight: tensor([0.0960, 0.0937, 0.0900, 0.0883, 0.1043, 0.0601, 0.1418, 0.0823, 0.1414,
        0.1022])
___Test Target_Simple poisoned: False, epoch: 30: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Done in 203.0950584411621 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:31 choose agents : [41, 73, 51, 74, 80, 7, 72, 14, 99, 12]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   1,  Average loss: nan, Accuracy: 36/606 (5.9406%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   2,  Average loss: nan, Accuracy: 33/606 (5.4455%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   3,  Average loss: nan, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   4,  Average loss: nan, Accuracy: 30/606 (4.9505%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   5,  Average loss: nan, Accuracy: 35/606 (5.7756%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   6,  Average loss: nan, Accuracy: 35/606 (5.7756%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   7,  Average loss: nan, Accuracy: 30/606 (4.9505%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   8,  Average loss: nan, Accuracy: 35/606 (5.7756%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   9,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch  10,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 31: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   1,  Average loss: nan, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   2,  Average loss: nan, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   3,  Average loss: nan, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   4,  Average loss: nan, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   5,  Average loss: nan, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   6,  Average loss: nan, Accuracy: 259/591 (43.8240%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   7,  Average loss: nan, Accuracy: 274/591 (46.3621%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   8,  Average loss: nan, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   9,  Average loss: nan, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch  10,  Average loss: nan, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 31: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   1,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   2,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   3,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   4,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   5,  Average loss: nan, Accuracy: 37/568 (6.5141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   6,  Average loss: nan, Accuracy: 42/568 (7.3944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   7,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   8,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   9,  Average loss: nan, Accuracy: 32/568 (5.6338%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch  10,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 31: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   1,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   2,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   3,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   4,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   5,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   6,  Average loss: nan, Accuracy: 1/557 (0.1795%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   7,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   8,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   9,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch  10,  Average loss: nan, Accuracy: 1/557 (0.1795%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 31: Average loss: nan, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  31, local model 80, internal_epoch   1,  Average loss: nan, Accuracy: 33/431 (7.6566%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  31, local model 7, internal_epoch   1,  Average loss: nan, Accuracy: 0/418 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  31, local model 72, internal_epoch   1,  Average loss: nan, Accuracy: 4/731 (0.5472%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  31, local model 14, internal_epoch   1,  Average loss: nan, Accuracy: 3/376 (0.7979%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: nan, Accuracy: 1/377 (0.2653%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: nan, Accuracy: 157/1160 (13.5345%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: nan, Accuracy: 980/10000 (9.8000%)
time spent on training: 165.30132150650024
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3993121238177128  data num: [606, 591, 568, 557, 431, 418, 731, 376, 377, 1160]
[rfa agg] considering poison per batch poison_fraction: 0.12478503869303526
[rfa agg] init. name: [41, 73, 51, 74, 80, 7, 72, 14, 99, 12], weight: tensor([0.1042, 0.1016, 0.0977, 0.0958, 0.0741, 0.0719, 0.1257, 0.0647, 0.0648,
        0.1995])
[rfa agg] iter:  0, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  0, weight: tensor([0.1042, 0.1016, 0.0977, 0.0958, 0.0741, 0.0719, 0.1257, 0.0647, 0.0648,
        0.1995])
[rfa agg] iter:  1, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  1, weight: tensor([0.1042, 0.1016, 0.0977, 0.0958, 0.0741, 0.0719, 0.1257, 0.0647, 0.0648,
        0.1995])
[rfa agg] iter:  2, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  2, weight: tensor([0.1042, 0.1016, 0.0977, 0.0958, 0.0741, 0.0719, 0.1257, 0.0647, 0.0648,
        0.1995])
[rfa agg] iter:  3, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  3, weight: tensor([0.1042, 0.1016, 0.0977, 0.0958, 0.0741, 0.0719, 0.1257, 0.0647, 0.0648,
        0.1995])
[rfa agg] iter:  4, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  4, weight: tensor([0.1042, 0.1016, 0.0977, 0.0958, 0.0741, 0.0719, 0.1257, 0.0647, 0.0648,
        0.1995])
[rfa agg] iter:  5, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  5, weight: tensor([0.1042, 0.1016, 0.0977, 0.0958, 0.0741, 0.0719, 0.1257, 0.0647, 0.0648,
        0.1995])
[rfa agg] iter:  6, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  6, weight: tensor([0.1042, 0.1016, 0.0977, 0.0958, 0.0741, 0.0719, 0.1257, 0.0647, 0.0648,
        0.1995])
[rfa agg] iter:  7, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  7, weight: tensor([0.1042, 0.1016, 0.0977, 0.0958, 0.0741, 0.0719, 0.1257, 0.0647, 0.0648,
        0.1995])
[rfa agg] iter:  8, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  8, weight: tensor([0.1042, 0.1016, 0.0977, 0.0958, 0.0741, 0.0719, 0.1257, 0.0647, 0.0648,
        0.1995])
[rfa agg] iter:  9, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  9, weight: tensor([0.1042, 0.1016, 0.0977, 0.0958, 0.0741, 0.0719, 0.1257, 0.0647, 0.0648,
        0.1995])
___Test Target_Simple poisoned: False, epoch: 31: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Done in 204.06198835372925 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:32 choose agents : [41, 73, 51, 74, 93, 25, 34, 57, 69, 58]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   1,  Average loss: nan, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   2,  Average loss: nan, Accuracy: 33/606 (5.4455%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   3,  Average loss: nan, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   4,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   5,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   6,  Average loss: nan, Accuracy: 36/606 (5.9406%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   7,  Average loss: nan, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   8,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   9,  Average loss: nan, Accuracy: 30/606 (4.9505%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch  10,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 32: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   1,  Average loss: nan, Accuracy: 256/591 (43.3164%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   2,  Average loss: nan, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   3,  Average loss: nan, Accuracy: 274/591 (46.3621%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   4,  Average loss: nan, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   5,  Average loss: nan, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   6,  Average loss: nan, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   7,  Average loss: nan, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   8,  Average loss: nan, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   9,  Average loss: nan, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch  10,  Average loss: nan, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 32: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   1,  Average loss: nan, Accuracy: 44/568 (7.7465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   2,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   3,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   4,  Average loss: nan, Accuracy: 37/568 (6.5141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   5,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   6,  Average loss: nan, Accuracy: 35/568 (6.1620%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   7,  Average loss: nan, Accuracy: 39/568 (6.8662%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   8,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   9,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch  10,  Average loss: nan, Accuracy: 45/568 (7.9225%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 32: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   1,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   2,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   3,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   4,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   5,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   6,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   7,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   8,  Average loss: nan, Accuracy: 1/557 (0.1795%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   9,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch  10,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 32: Average loss: nan, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: nan, Accuracy: 211/623 (33.8684%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  32, local model 25, internal_epoch   1,  Average loss: nan, Accuracy: 5/647 (0.7728%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  32, local model 34, internal_epoch   1,  Average loss: nan, Accuracy: 17/413 (4.1162%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  32, local model 57, internal_epoch   1,  Average loss: nan, Accuracy: 0/343 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  32, local model 69, internal_epoch   1,  Average loss: nan, Accuracy: 1/256 (0.3906%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  32, local model 58, internal_epoch   1,  Average loss: nan, Accuracy: 0/276 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: nan, Accuracy: 980/10000 (9.8000%)
time spent on training: 165.98541831970215
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.47581967213114756  data num: [606, 591, 568, 557, 623, 647, 413, 343, 256, 276]
[rfa agg] considering poison per batch poison_fraction: 0.1486936475409836
[rfa agg] init. name: [41, 73, 51, 74, 93, 25, 34, 57, 69, 58], weight: tensor([0.1242, 0.1211, 0.1164, 0.1141, 0.1277, 0.1326, 0.0846, 0.0703, 0.0525,
        0.0566])
[rfa agg] iter:  0, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  0, weight: tensor([0.1242, 0.1211, 0.1164, 0.1141, 0.1277, 0.1326, 0.0846, 0.0703, 0.0525,
        0.0566])
[rfa agg] iter:  1, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  1, weight: tensor([0.1242, 0.1211, 0.1164, 0.1141, 0.1277, 0.1326, 0.0846, 0.0703, 0.0525,
        0.0566])
[rfa agg] iter:  2, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  2, weight: tensor([0.1242, 0.1211, 0.1164, 0.1141, 0.1277, 0.1326, 0.0846, 0.0703, 0.0525,
        0.0566])
[rfa agg] iter:  3, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  3, weight: tensor([0.1242, 0.1211, 0.1164, 0.1141, 0.1277, 0.1326, 0.0846, 0.0703, 0.0525,
        0.0566])
[rfa agg] iter:  4, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  4, weight: tensor([0.1242, 0.1211, 0.1164, 0.1141, 0.1277, 0.1326, 0.0846, 0.0703, 0.0525,
        0.0566])
[rfa agg] iter:  5, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  5, weight: tensor([0.1242, 0.1211, 0.1164, 0.1141, 0.1277, 0.1326, 0.0846, 0.0703, 0.0525,
        0.0566])
[rfa agg] iter:  6, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  6, weight: tensor([0.1242, 0.1211, 0.1164, 0.1141, 0.1277, 0.1326, 0.0846, 0.0703, 0.0525,
        0.0566])
[rfa agg] iter:  7, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  7, weight: tensor([0.1242, 0.1211, 0.1164, 0.1141, 0.1277, 0.1326, 0.0846, 0.0703, 0.0525,
        0.0566])
[rfa agg] iter:  8, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  8, weight: tensor([0.1242, 0.1211, 0.1164, 0.1141, 0.1277, 0.1326, 0.0846, 0.0703, 0.0525,
        0.0566])
[rfa agg] iter:  9, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  9, weight: tensor([0.1242, 0.1211, 0.1164, 0.1141, 0.1277, 0.1326, 0.0846, 0.0703, 0.0525,
        0.0566])
___Test Target_Simple poisoned: False, epoch: 32: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Done in 203.08156371116638 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:33 choose agents : [41, 73, 51, 74, 2, 4, 1, 20, 49, 57]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   1,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   2,  Average loss: nan, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   3,  Average loss: nan, Accuracy: 40/606 (6.6007%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   4,  Average loss: nan, Accuracy: 36/606 (5.9406%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   5,  Average loss: nan, Accuracy: 35/606 (5.7756%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   6,  Average loss: nan, Accuracy: 32/606 (5.2805%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   7,  Average loss: nan, Accuracy: 36/606 (5.9406%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   8,  Average loss: nan, Accuracy: 32/606 (5.2805%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   9,  Average loss: nan, Accuracy: 32/606 (5.2805%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch  10,  Average loss: nan, Accuracy: 32/606 (5.2805%), train_poison_data_count: 200
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   1,  Average loss: nan, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   2,  Average loss: nan, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   3,  Average loss: nan, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   4,  Average loss: nan, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   5,  Average loss: nan, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   6,  Average loss: nan, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   7,  Average loss: nan, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   8,  Average loss: nan, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   9,  Average loss: nan, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch  10,  Average loss: nan, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   1,  Average loss: nan, Accuracy: 35/568 (6.1620%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   2,  Average loss: nan, Accuracy: 42/568 (7.3944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   3,  Average loss: nan, Accuracy: 42/568 (7.3944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   4,  Average loss: nan, Accuracy: 37/568 (6.5141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   5,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   6,  Average loss: nan, Accuracy: 43/568 (7.5704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   7,  Average loss: nan, Accuracy: 36/568 (6.3380%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   8,  Average loss: nan, Accuracy: 37/568 (6.5141%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   9,  Average loss: nan, Accuracy: 37/568 (6.5141%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch  10,  Average loss: nan, Accuracy: 39/568 (6.8662%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   1,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   2,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   3,  Average loss: nan, Accuracy: 2/557 (0.3591%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   4,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   5,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   6,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   7,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   8,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   9,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch  10,  Average loss: nan, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  33, local model 2, internal_epoch   1,  Average loss: nan, Accuracy: 2/548 (0.3650%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  33, local model 4, internal_epoch   1,  Average loss: nan, Accuracy: 17/658 (2.5836%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  33, local model 1, internal_epoch   1,  Average loss: nan, Accuracy: 0/760 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  33, local model 20, internal_epoch   1,  Average loss: nan, Accuracy: 9/429 (2.0979%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  33, local model 49, internal_epoch   1,  Average loss: nan, Accuracy: 199/506 (39.3281%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  33, local model 57, internal_epoch   1,  Average loss: nan, Accuracy: 0/343 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: nan, Accuracy: 980/10000 (9.8000%)
time spent on training: 168.425794839859
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41717570966582823  data num: [606, 591, 568, 557, 548, 658, 760, 429, 506, 343]
[rfa agg] considering poison per batch poison_fraction: 0.13036740927057133
[rfa agg] init. name: [41, 73, 51, 74, 2, 4, 1, 20, 49, 57], weight: tensor([0.1089, 0.1062, 0.1020, 0.1001, 0.0985, 0.1182, 0.1365, 0.0771, 0.0909,
        0.0616])
[rfa agg] iter:  0, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  0, weight: tensor([0.1089, 0.1062, 0.1020, 0.1001, 0.0985, 0.1182, 0.1365, 0.0771, 0.0909,
        0.0616])
[rfa agg] iter:  1, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  1, weight: tensor([0.1089, 0.1062, 0.1020, 0.1001, 0.0985, 0.1182, 0.1365, 0.0771, 0.0909,
        0.0616])
[rfa agg] iter:  2, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  2, weight: tensor([0.1089, 0.1062, 0.1020, 0.1001, 0.0985, 0.1182, 0.1365, 0.0771, 0.0909,
        0.0616])
[rfa agg] iter:  3, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  3, weight: tensor([0.1089, 0.1062, 0.1020, 0.1001, 0.0985, 0.1182, 0.1365, 0.0771, 0.0909,
        0.0616])
[rfa agg] iter:  4, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  4, weight: tensor([0.1089, 0.1062, 0.1020, 0.1001, 0.0985, 0.1182, 0.1365, 0.0771, 0.0909,
        0.0616])
[rfa agg] iter:  5, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  5, weight: tensor([0.1089, 0.1062, 0.1020, 0.1001, 0.0985, 0.1182, 0.1365, 0.0771, 0.0909,
        0.0616])
[rfa agg] iter:  6, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  6, weight: tensor([0.1089, 0.1062, 0.1020, 0.1001, 0.0985, 0.1182, 0.1365, 0.0771, 0.0909,
        0.0616])
[rfa agg] iter:  7, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  7, weight: tensor([0.1089, 0.1062, 0.1020, 0.1001, 0.0985, 0.1182, 0.1365, 0.0771, 0.0909,
        0.0616])
[rfa agg] iter:  8, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  8, weight: tensor([0.1089, 0.1062, 0.1020, 0.1001, 0.0985, 0.1182, 0.1365, 0.0771, 0.0909,
        0.0616])
[rfa agg] iter:  9, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  9, weight: tensor([0.1089, 0.1062, 0.1020, 0.1001, 0.0985, 0.1182, 0.1365, 0.0771, 0.0909,
        0.0616])
___Test Target_Simple poisoned: False, epoch: 33: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Done in 205.79150557518005 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:34 choose agents : [41, 73, 51, 74, 27, 43, 49, 0, 45, 25]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   1,  Average loss: nan, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   2,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   3,  Average loss: nan, Accuracy: 35/606 (5.7756%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   4,  Average loss: nan, Accuracy: 31/606 (5.1155%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   5,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   6,  Average loss: nan, Accuracy: 28/606 (4.6205%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   7,  Average loss: nan, Accuracy: 31/606 (5.1155%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   8,  Average loss: nan, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   9,  Average loss: nan, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch  10,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   1,  Average loss: nan, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   2,  Average loss: nan, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   3,  Average loss: nan, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   4,  Average loss: nan, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   5,  Average loss: nan, Accuracy: 257/591 (43.4856%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   6,  Average loss: nan, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   7,  Average loss: nan, Accuracy: 273/591 (46.1929%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   8,  Average loss: nan, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   9,  Average loss: nan, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch  10,  Average loss: nan, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   1,  Average loss: nan, Accuracy: 45/568 (7.9225%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   2,  Average loss: nan, Accuracy: 37/568 (6.5141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   3,  Average loss: nan, Accuracy: 42/568 (7.3944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   4,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   5,  Average loss: nan, Accuracy: 39/568 (6.8662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   6,  Average loss: nan, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   7,  Average loss: nan, Accuracy: 32/568 (5.6338%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   8,  Average loss: nan, Accuracy: 45/568 (7.9225%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   9,  Average loss: nan, Accuracy: 41/568 (7.2183%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch  10,  Average loss: nan, Accuracy: 38/568 (6.6901%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   1,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   2,  Average loss: nan, Accuracy: 6/557 (1.0772%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   3,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   4,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   5,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   6,  Average loss: nan, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   7,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   8,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   9,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch  10,  Average loss: nan, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
___Test Local_Simple poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  34, local model 27, internal_epoch   1,  Average loss: nan, Accuracy: 1/471 (0.2123%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  34, local model 43, internal_epoch   1,  Average loss: nan, Accuracy: 22/408 (5.3922%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  34, local model 49, internal_epoch   1,  Average loss: nan, Accuracy: 199/506 (39.3281%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  34, local model 0, internal_epoch   1,  Average loss: nan, Accuracy: 19/435 (4.3678%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  34, local model 45, internal_epoch   1,  Average loss: nan, Accuracy: 191/628 (30.4140%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  34, local model 25, internal_epoch   1,  Average loss: nan, Accuracy: 5/647 (0.7728%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: nan, Accuracy: 980/10000 (9.8000%)
time spent on training: 169.5586941242218
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4286505445818719  data num: [606, 591, 568, 557, 471, 408, 506, 435, 628, 647]
[rfa agg] considering poison per batch poison_fraction: 0.13395329518183496
[rfa agg] init. name: [41, 73, 51, 74, 27, 43, 49, 0, 45, 25], weight: tensor([0.1119, 0.1091, 0.1049, 0.1028, 0.0869, 0.0753, 0.0934, 0.0803, 0.1159,
        0.1194])
[rfa agg] iter:  0, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  0, weight: tensor([0.1119, 0.1091, 0.1049, 0.1028, 0.0869, 0.0753, 0.0934, 0.0803, 0.1159,
        0.1194])
[rfa agg] iter:  1, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  1, weight: tensor([0.1119, 0.1091, 0.1049, 0.1028, 0.0869, 0.0753, 0.0934, 0.0803, 0.1159,
        0.1194])
[rfa agg] iter:  2, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  2, weight: tensor([0.1119, 0.1091, 0.1049, 0.1028, 0.0869, 0.0753, 0.0934, 0.0803, 0.1159,
        0.1194])
[rfa agg] iter:  3, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  3, weight: tensor([0.1119, 0.1091, 0.1049, 0.1028, 0.0869, 0.0753, 0.0934, 0.0803, 0.1159,
        0.1194])
[rfa agg] iter:  4, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  4, weight: tensor([0.1119, 0.1091, 0.1049, 0.1028, 0.0869, 0.0753, 0.0934, 0.0803, 0.1159,
        0.1194])
[rfa agg] iter:  5, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  5, weight: tensor([0.1119, 0.1091, 0.1049, 0.1028, 0.0869, 0.0753, 0.0934, 0.0803, 0.1159,
        0.1194])
[rfa agg] iter:  6, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  6, weight: tensor([0.1119, 0.1091, 0.1049, 0.1028, 0.0869, 0.0753, 0.0934, 0.0803, 0.1159,
        0.1194])
[rfa agg] iter:  7, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  7, weight: tensor([0.1119, 0.1091, 0.1049, 0.1028, 0.0869, 0.0753, 0.0934, 0.0803, 0.1159,
        0.1194])
[rfa agg] iter:  8, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  8, weight: tensor([0.1119, 0.1091, 0.1049, 0.1028, 0.0869, 0.0753, 0.0934, 0.0803, 0.1159,
        0.1194])
[rfa agg] iter:  9, prev_obj_val: nan, obj_val: nan, abs dis: nan
[rfa agg] iter:  9, weight: tensor([0.1119, 0.1091, 0.1049, 0.1028, 0.0869, 0.0753, 0.0934, 0.0803, 0.1159,
        0.1194])
___Test Target_Simple poisoned: False, epoch: 34: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Done in 205.91635370254517 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:35 choose agents : [41, 73, 51, 74, 8, 12, 55, 26, 62, 65]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   1,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   2,  Average loss: nan, Accuracy: 36/606 (5.9406%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   3,  Average loss: nan, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   4,  Average loss: nan, Accuracy: 33/606 (5.4455%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   5,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   6,  Average loss: nan, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   7,  Average loss: nan, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   8,  Average loss: nan, Accuracy: 31/606 (5.1155%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   9,  Average loss: nan, Accuracy: 36/606 (5.9406%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch  10,  Average loss: nan, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Global model norm: nan.
Norm before scaling: nan. Distance: nan
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: nan, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: nan, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: nan, distance: nan
Total norm for 4 adversaries is: nan. distance: nan
