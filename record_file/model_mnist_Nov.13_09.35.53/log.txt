current path: saved_models/model_mnist_Nov.13_09.35.53
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [41, 73, 51, 74]
We use following environment for graphs:  mnist_DBA
----------------------------------Start one training epoch------------------------------------------
Server Epoch:11 choose agents : [41, 73, 51, 74, 23, 76, 63, 11, 75, 43]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   1,  Average loss: 0.0251, Accuracy: 337/606 (55.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   2,  Average loss: 0.0158, Accuracy: 348/606 (57.4257%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   3,  Average loss: 0.0129, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   4,  Average loss: 0.0122, Accuracy: 390/606 (64.3564%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   5,  Average loss: 0.0118, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   6,  Average loss: 0.0117, Accuracy: 393/606 (64.8515%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   7,  Average loss: 0.0112, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   8,  Average loss: 0.0113, Accuracy: 380/606 (62.7063%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   9,  Average loss: 0.0111, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch  10,  Average loss: 0.0105, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Global model norm: 16.539532092117113.
Norm before scaling: 16.771643476485654. Distance: 4.6835237041259195
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.3937, Accuracy: 4209/10000 (42.0900%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.8791, Accuracy: 5911/8968 (65.9121%)
Scaling by  100
Scaled Norm after poisoning: 467.12647176647994, distance: 468.3523813593777
Total norm for 4 adversaries is: 467.12647176647994. distance: 468.3523813593777
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 100325.6544, Accuracy: 4/8968 (0.0446%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0245, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   2,  Average loss: 0.0196, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   3,  Average loss: 0.0167, Accuracy: 307/591 (51.9459%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   4,  Average loss: 0.0153, Accuracy: 312/591 (52.7919%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   5,  Average loss: 0.0148, Accuracy: 331/591 (56.0068%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   6,  Average loss: 0.0140, Accuracy: 354/591 (59.8985%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   7,  Average loss: 0.0142, Accuracy: 348/591 (58.8832%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   8,  Average loss: 0.0138, Accuracy: 355/591 (60.0677%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   9,  Average loss: 0.0134, Accuracy: 355/591 (60.0677%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch  10,  Average loss: 0.0137, Accuracy: 342/591 (57.8680%), train_poison_data_count: 195
Global model norm: 16.539532092117113.
Norm before scaling: 16.59642383707067. Distance: 4.0138572037504785
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0769, Accuracy: 5302/10000 (53.0200%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.9480, Accuracy: 4984/8968 (55.5754%)
Scaling by  100
Scaled Norm after poisoning: 399.95183303742965, distance: 401.3857441726101
Total norm for 4 adversaries is: 399.95183303742965. distance: 401.3857441726101
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0251, Accuracy: 314/568 (55.2817%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   2,  Average loss: 0.0127, Accuracy: 356/568 (62.6761%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   3,  Average loss: 0.0113, Accuracy: 371/568 (65.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   4,  Average loss: 0.0109, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   5,  Average loss: 0.0104, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   6,  Average loss: 0.0104, Accuracy: 388/568 (68.3099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   7,  Average loss: 0.0103, Accuracy: 380/568 (66.9014%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   8,  Average loss: 0.0102, Accuracy: 377/568 (66.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   9,  Average loss: 0.0101, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch  10,  Average loss: 0.0098, Accuracy: 401/568 (70.5986%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.720025871293345. Distance: 4.641369281513058
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.3199, Accuracy: 5095/10000 (50.9500%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.7920, Accuracy: 5202/8968 (58.0062%)
Scaling by  100
Scaled Norm after poisoning: 462.7555712792662, distance: 464.1369006015359
Total norm for 4 adversaries is: 462.7555712792662. distance: 464.1369006015359
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 6192.5947, Accuracy: 8217/8968 (91.6258%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0265, Accuracy: 309/557 (55.4758%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   2,  Average loss: 0.0131, Accuracy: 376/557 (67.5045%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   3,  Average loss: 0.0077, Accuracy: 485/557 (87.0736%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   4,  Average loss: 0.0061, Accuracy: 493/557 (88.5099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   5,  Average loss: 0.0050, Accuracy: 508/557 (91.2029%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   6,  Average loss: 0.0046, Accuracy: 506/557 (90.8438%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   7,  Average loss: 0.0036, Accuracy: 514/557 (92.2801%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   8,  Average loss: 0.0037, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   9,  Average loss: 0.0030, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch  10,  Average loss: 0.0034, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.84264113928914. Distance: 4.709123910792978
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0152, Accuracy: 7199/10000 (71.9900%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1117, Accuracy: 8564/8968 (95.4951%)
Scaling by  100
Scaled Norm after poisoning: 469.921569253849, distance: 470.9123790579305
Total norm for 4 adversaries is: 469.921569253849. distance: 470.9123790579305
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1213, Accuracy: 9577/10000 (95.7700%)
___Train Local_Simple,  epoch  11, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.0957, Accuracy: 9719/10000 (97.1900%)
___Train Local_Simple,  epoch  11, local model 63, internal_epoch   1,  Average loss: 0.0020, Accuracy: 857/889 (96.4004%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1366, Accuracy: 9601/10000 (96.0100%)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0017, Accuracy: 626/645 (97.0543%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1996, Accuracy: 9381/10000 (93.8100%)
___Train Local_Simple,  epoch  11, local model 75, internal_epoch   1,  Average loss: 0.0010, Accuracy: 669/686 (97.5219%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1799, Accuracy: 9447/10000 (94.4700%)
___Train Local_Simple,  epoch  11, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 398/408 (97.5490%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3283, Accuracy: 8975/10000 (89.7500%)
time spent on training: 76.95309495925903
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.43638413831986467  data num: [606, 591, 568, 557, 293, 78, 889, 645, 686, 408]
[foolsgold agg] considering poison per batch poison_fraction: 0.13637004322495772
[foolsgold agg] wv: [0.96371085 0.96371085 1.         1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 0.0835, Accuracy: 9734/10000 (97.3400%)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 12.1470, Accuracy: 42/8968 (0.4683%)
Done in 91.26218342781067 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:12 choose agents : [41, 73, 51, 74, 46, 37, 21, 43, 35, 11]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0268, Accuracy: 319/606 (52.6403%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   2,  Average loss: 0.0148, Accuracy: 365/606 (60.2310%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   3,  Average loss: 0.0120, Accuracy: 398/606 (65.6766%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   4,  Average loss: 0.0118, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   5,  Average loss: 0.0111, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   6,  Average loss: 0.0112, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   7,  Average loss: 0.0109, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   8,  Average loss: 0.0109, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   9,  Average loss: 0.0107, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch  10,  Average loss: 0.0107, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Global model norm: 16.542870516975167.
Norm before scaling: 16.835240523566277. Distance: 5.018824997433004
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.4055, Accuracy: 4620/10000 (46.2000%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.8504, Accuracy: 5601/8968 (62.4554%)
Scaling by  100
Scaled Norm after poisoning: 500.61637008791473, distance: 501.8825030572395
Total norm for 4 adversaries is: 500.61637008791473. distance: 501.8825030572395
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   1,  Average loss: 0.0246, Accuracy: 357/591 (60.4061%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   2,  Average loss: 0.0190, Accuracy: 296/591 (50.0846%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   3,  Average loss: 0.0159, Accuracy: 344/591 (58.2064%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   4,  Average loss: 0.0144, Accuracy: 349/591 (59.0525%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   5,  Average loss: 0.0138, Accuracy: 325/591 (54.9915%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   6,  Average loss: 0.0137, Accuracy: 349/591 (59.0525%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   7,  Average loss: 0.0135, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   8,  Average loss: 0.0133, Accuracy: 360/591 (60.9137%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   9,  Average loss: 0.0127, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch  10,  Average loss: 0.0130, Accuracy: 362/591 (61.2521%), train_poison_data_count: 195
Global model norm: 16.542870516975167.
Norm before scaling: 16.659886519651213. Distance: 3.824372986906606
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.8898, Accuracy: 6286/10000 (62.8600%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 1.0016, Accuracy: 4180/8968 (46.6102%)
Scaling by  100
Scaled Norm after poisoning: 381.38942122848664, distance: 382.4372906111537
Total norm for 4 adversaries is: 381.38942122848664. distance: 382.4372906111537
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   1,  Average loss: 0.0237, Accuracy: 331/568 (58.2746%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   2,  Average loss: 0.0131, Accuracy: 359/568 (63.2042%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   3,  Average loss: 0.0114, Accuracy: 370/568 (65.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   4,  Average loss: 0.0112, Accuracy: 389/568 (68.4859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   5,  Average loss: 0.0115, Accuracy: 369/568 (64.9648%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   6,  Average loss: 0.0112, Accuracy: 375/568 (66.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   7,  Average loss: 0.0109, Accuracy: 371/568 (65.3169%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   8,  Average loss: 0.0104, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   9,  Average loss: 0.0105, Accuracy: 380/568 (66.9014%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch  10,  Average loss: 0.0104, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Global model norm: 16.542870516975167.
Norm before scaling: 16.68483435667749. Distance: 4.478497098808716
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.5675, Accuracy: 4498/10000 (44.9800%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.7172, Accuracy: 5959/8968 (66.4474%)
Scaling by  100
Scaled Norm after poisoning: 446.440400557566, distance: 447.84968879078167
Total norm for 4 adversaries is: 446.440400557566. distance: 447.84968879078167
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   1,  Average loss: 0.0237, Accuracy: 310/557 (55.6553%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   2,  Average loss: 0.0120, Accuracy: 391/557 (70.1975%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   3,  Average loss: 0.0060, Accuracy: 493/557 (88.5099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   4,  Average loss: 0.0046, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   5,  Average loss: 0.0039, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   6,  Average loss: 0.0034, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   7,  Average loss: 0.0035, Accuracy: 511/557 (91.7415%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   8,  Average loss: 0.0027, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   9,  Average loss: 0.0025, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch  10,  Average loss: 0.0028, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Global model norm: 16.542870516975167.
Norm before scaling: 16.74780896788023. Distance: 4.0061021988812096
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.7831, Accuracy: 7622/10000 (76.2200%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0837, Accuracy: 8687/8968 (96.8666%)
Scaling by  100
Scaled Norm after poisoning: 399.79942236701646, distance: 400.610198634533
Total norm for 4 adversaries is: 399.79942236701646. distance: 400.610198634533
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  12, local model 46, internal_epoch   1,  Average loss: 0.0035, Accuracy: 674/710 (94.9296%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2256, Accuracy: 9300/10000 (93.0000%)
___Train Local_Simple,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 841/860 (97.7907%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.4888, Accuracy: 8496/10000 (84.9600%)
___Train Local_Simple,  epoch  12, local model 21, internal_epoch   1,  Average loss: 0.0014, Accuracy: 303/312 (97.1154%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2535, Accuracy: 9256/10000 (92.5600%)
___Train Local_Simple,  epoch  12, local model 43, internal_epoch   1,  Average loss: 0.0017, Accuracy: 395/408 (96.8137%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2906, Accuracy: 9078/10000 (90.7800%)
___Train Local_Simple,  epoch  12, local model 35, internal_epoch   1,  Average loss: 0.0006, Accuracy: 491/499 (98.3968%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3236, Accuracy: 9033/10000 (90.3300%)
___Train Local_Simple,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 629/645 (97.5194%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2129, Accuracy: 9348/10000 (93.4800%)
time spent on training: 74.29103684425354
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4034051424600417  data num: [606, 591, 568, 557, 710, 860, 312, 408, 499, 645]
[foolsgold agg] considering poison per batch poison_fraction: 0.12606410701876303
[foolsgold agg] wv: [0.95939835 0.95939835 1.         1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 0.0831, Accuracy: 9739/10000 (97.3900%)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 12.0158, Accuracy: 43/8968 (0.4795%)
Done in 88.72406339645386 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:13 choose agents : [41, 73, 51, 74, 61, 64, 28, 67, 22, 82]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0248, Accuracy: 334/606 (55.1155%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   2,  Average loss: 0.0162, Accuracy: 316/606 (52.1452%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   3,  Average loss: 0.0124, Accuracy: 398/606 (65.6766%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   4,  Average loss: 0.0117, Accuracy: 403/606 (66.5017%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   5,  Average loss: 0.0114, Accuracy: 404/606 (66.6667%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   6,  Average loss: 0.0115, Accuracy: 400/606 (66.0066%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   7,  Average loss: 0.0111, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   8,  Average loss: 0.0109, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   9,  Average loss: 0.0110, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch  10,  Average loss: 0.0112, Accuracy: 403/606 (66.5017%), train_poison_data_count: 200
Global model norm: 16.546350285294697.
Norm before scaling: 16.78886073343163. Distance: 4.817579684902549
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.5841, Accuracy: 4667/10000 (46.6700%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.9067, Accuracy: 5231/8968 (58.3296%)
Scaling by  100
Scaled Norm after poisoning: 480.47063515890335, distance: 481.75799487398234
Total norm for 4 adversaries is: 480.47063515890335. distance: 481.75799487398234
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 15858.1935, Accuracy: 6115/8968 (68.1869%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   1,  Average loss: 0.0243, Accuracy: 348/591 (58.8832%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   2,  Average loss: 0.0228, Accuracy: 274/591 (46.3621%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   3,  Average loss: 0.0172, Accuracy: 337/591 (57.0220%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   4,  Average loss: 0.0160, Accuracy: 355/591 (60.0677%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   5,  Average loss: 0.0166, Accuracy: 299/591 (50.5922%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   6,  Average loss: 0.0155, Accuracy: 305/591 (51.6074%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   7,  Average loss: 0.0151, Accuracy: 351/591 (59.3909%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   8,  Average loss: 0.0143, Accuracy: 365/591 (61.7597%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   9,  Average loss: 0.0140, Accuracy: 362/591 (61.2521%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch  10,  Average loss: 0.0145, Accuracy: 342/591 (57.8680%), train_poison_data_count: 195
Global model norm: 16.546350285294697.
Norm before scaling: 16.54791423642786. Distance: 3.857695302809231
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.3045, Accuracy: 4728/10000 (47.2800%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.8814, Accuracy: 5490/8968 (61.2177%)
Scaling by  100
Scaled Norm after poisoning: 384.1990450925145, distance: 385.76954341290343
Total norm for 4 adversaries is: 384.1990450925145. distance: 385.76954341290343
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   1,  Average loss: 0.0253, Accuracy: 311/568 (54.7535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   2,  Average loss: 0.0134, Accuracy: 354/568 (62.3239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   3,  Average loss: 0.0127, Accuracy: 364/568 (64.0845%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   4,  Average loss: 0.0112, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   5,  Average loss: 0.0105, Accuracy: 385/568 (67.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   6,  Average loss: 0.0102, Accuracy: 383/568 (67.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   7,  Average loss: 0.0102, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   8,  Average loss: 0.0100, Accuracy: 385/568 (67.7817%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   9,  Average loss: 0.0096, Accuracy: 393/568 (69.1901%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch  10,  Average loss: 0.0097, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Global model norm: 16.546350285294697.
Norm before scaling: 16.826439279832517. Distance: 5.040736572393041
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.4194, Accuracy: 4951/10000 (49.5100%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.7000, Accuracy: 5969/8968 (66.5589%)
Scaling by  100
Scaled Norm after poisoning: 502.75034186960033, distance: 504.0736553322342
Total norm for 4 adversaries is: 502.75034186960033. distance: 504.0736553322342
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 98.6345, Accuracy: 8948/8968 (99.7770%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   1,  Average loss: 0.0254, Accuracy: 334/557 (59.9641%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   2,  Average loss: 0.0118, Accuracy: 392/557 (70.3770%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   3,  Average loss: 0.0061, Accuracy: 488/557 (87.6122%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   4,  Average loss: 0.0049, Accuracy: 508/557 (91.2029%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   5,  Average loss: 0.0046, Accuracy: 509/557 (91.3824%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   6,  Average loss: 0.0038, Accuracy: 515/557 (92.4596%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   7,  Average loss: 0.0035, Accuracy: 515/557 (92.4596%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   8,  Average loss: 0.0027, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   9,  Average loss: 0.0025, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch  10,  Average loss: 0.0025, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Global model norm: 16.546350285294697.
Norm before scaling: 16.891789427080486. Distance: 4.682163914290922
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.7872, Accuracy: 7746/10000 (77.4600%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1281, Accuracy: 8480/8968 (94.5584%)
Scaling by  100
Scaled Norm after poisoning: 467.4004406020602, distance: 468.2163629135573
Total norm for 4 adversaries is: 467.4004406020602. distance: 468.2163629135573
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  13, local model 61, internal_epoch   1,  Average loss: 0.0015, Accuracy: 680/699 (97.2818%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2859, Accuracy: 9062/10000 (90.6200%)
___Train Local_Simple,  epoch  13, local model 64, internal_epoch   1,  Average loss: 0.0019, Accuracy: 782/813 (96.1870%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.4120, Accuracy: 8469/10000 (84.6900%)
___Train Local_Simple,  epoch  13, local model 28, internal_epoch   1,  Average loss: 0.0016, Accuracy: 486/501 (97.0060%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1457, Accuracy: 9526/10000 (95.2600%)
___Train Local_Simple,  epoch  13, local model 67, internal_epoch   1,  Average loss: 0.0014, Accuracy: 972/998 (97.3948%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3165, Accuracy: 8966/10000 (89.6600%)
___Train Local_Simple,  epoch  13, local model 22, internal_epoch   1,  Average loss: 0.0016, Accuracy: 566/583 (97.0840%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2379, Accuracy: 9266/10000 (92.6600%)
___Train Local_Simple,  epoch  13, local model 82, internal_epoch   1,  Average loss: 0.0015, Accuracy: 691/713 (96.9144%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2788, Accuracy: 9036/10000 (90.3600%)
time spent on training: 76.51183223724365
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.35027907678382864  data num: [606, 591, 568, 557, 699, 813, 501, 998, 583, 713]
[foolsgold agg] considering poison per batch poison_fraction: 0.10946221149494645
[foolsgold agg] wv: [0.97778029 0.97778029 1.         1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 0.0827, Accuracy: 9738/10000 (97.3800%)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 11.8381, Accuracy: 44/8968 (0.4906%)
Done in 89.44230484962463 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:14 choose agents : [41, 73, 51, 74, 60, 42, 85, 56, 57, 63]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   1,  Average loss: 0.0244, Accuracy: 357/606 (58.9109%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   2,  Average loss: 0.0162, Accuracy: 334/606 (55.1155%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   3,  Average loss: 0.0135, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   4,  Average loss: 0.0128, Accuracy: 399/606 (65.8416%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   5,  Average loss: 0.0118, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   6,  Average loss: 0.0120, Accuracy: 393/606 (64.8515%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   7,  Average loss: 0.0112, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   8,  Average loss: 0.0109, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   9,  Average loss: 0.0111, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch  10,  Average loss: 0.0111, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Global model norm: 16.54979797424371.
Norm before scaling: 16.817774969705138. Distance: 5.053714051176577
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.5855, Accuracy: 4331/10000 (43.3100%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.8772, Accuracy: 5607/8968 (62.5223%)
Scaling by  100
Scaled Norm after poisoning: 503.9983258900767, distance: 505.37138262370974
Total norm for 4 adversaries is: 503.9983258900767. distance: 505.37138262370974
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 27764.7679, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   1,  Average loss: 0.0264, Accuracy: 343/591 (58.0372%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   2,  Average loss: 0.0218, Accuracy: 277/591 (46.8697%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   3,  Average loss: 0.0193, Accuracy: 329/591 (55.6684%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   4,  Average loss: 0.0180, Accuracy: 312/591 (52.7919%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   5,  Average loss: 0.0173, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   6,  Average loss: 0.0160, Accuracy: 327/591 (55.3299%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   7,  Average loss: 0.0159, Accuracy: 326/591 (55.1607%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   8,  Average loss: 0.0151, Accuracy: 331/591 (56.0068%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   9,  Average loss: 0.0150, Accuracy: 348/591 (58.8832%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch  10,  Average loss: 0.0151, Accuracy: 336/591 (56.8528%), train_poison_data_count: 195
Global model norm: 16.54979797424371.
Norm before scaling: 16.7419897255584. Distance: 4.712292832088384
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.4419, Accuracy: 3598/10000 (35.9800%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.8816, Accuracy: 6242/8968 (69.6030%)
Scaling by  100
Scaled Norm after poisoning: 469.84064785307794, distance: 471.2292933116531
Total norm for 4 adversaries is: 469.84064785307794. distance: 471.2292933116531
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   1,  Average loss: 0.0239, Accuracy: 322/568 (56.6901%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   2,  Average loss: 0.0123, Accuracy: 378/568 (66.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   3,  Average loss: 0.0117, Accuracy: 362/568 (63.7324%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   4,  Average loss: 0.0113, Accuracy: 370/568 (65.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   5,  Average loss: 0.0107, Accuracy: 388/568 (68.3099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   6,  Average loss: 0.0107, Accuracy: 394/568 (69.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   7,  Average loss: 0.0105, Accuracy: 389/568 (68.4859%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   8,  Average loss: 0.0102, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   9,  Average loss: 0.0099, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch  10,  Average loss: 0.0100, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Global model norm: 16.54979797424371.
Norm before scaling: 16.68018880979675. Distance: 4.370189747128072
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.4143, Accuracy: 4429/10000 (44.2900%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.6466, Accuracy: 6415/8968 (71.5321%)
Scaling by  100
Scaled Norm after poisoning: 435.6408175033648, distance: 437.01896769476724
Total norm for 4 adversaries is: 435.6408175033648. distance: 437.01896769476724
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0244, Accuracy: 323/557 (57.9892%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   2,  Average loss: 0.0127, Accuracy: 366/557 (65.7092%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   3,  Average loss: 0.0060, Accuracy: 494/557 (88.6894%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   4,  Average loss: 0.0055, Accuracy: 505/557 (90.6643%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   5,  Average loss: 0.0050, Accuracy: 504/557 (90.4847%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   6,  Average loss: 0.0037, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   7,  Average loss: 0.0041, Accuracy: 511/557 (91.7415%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   8,  Average loss: 0.0031, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   9,  Average loss: 0.0030, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch  10,  Average loss: 0.0029, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Global model norm: 16.54979797424371.
Norm before scaling: 16.77073911399517. Distance: 4.1880497358077795
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.7920, Accuracy: 7672/10000 (76.7200%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1419, Accuracy: 8400/8968 (93.6664%)
Scaling by  100
Scaled Norm after poisoning: 417.91592306347934, distance: 418.80497773426714
Total norm for 4 adversaries is: 417.91592306347934. distance: 418.80497773426714
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  14, local model 60, internal_epoch   1,  Average loss: 0.0017, Accuracy: 327/338 (96.7456%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1211, Accuracy: 9633/10000 (96.3300%)
___Train Local_Simple,  epoch  14, local model 42, internal_epoch   1,  Average loss: 0.0013, Accuracy: 232/236 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1140, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch  14, local model 85, internal_epoch   1,  Average loss: 0.0007, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1370, Accuracy: 9562/10000 (95.6200%)
___Train Local_Simple,  epoch  14, local model 56, internal_epoch   1,  Average loss: 0.0017, Accuracy: 855/880 (97.1591%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1378, Accuracy: 9573/10000 (95.7300%)
___Train Local_Simple,  epoch  14, local model 57, internal_epoch   1,  Average loss: 0.0022, Accuracy: 331/343 (96.5015%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3492, Accuracy: 9060/10000 (90.6000%)
___Train Local_Simple,  epoch  14, local model 63, internal_epoch   1,  Average loss: 0.0022, Accuracy: 844/889 (94.9381%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1413, Accuracy: 9560/10000 (95.6000%)
time spent on training: 78.45746636390686
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.42691671263099834  data num: [606, 591, 568, 557, 338, 236, 431, 880, 343, 889]
[foolsgold agg] considering poison per batch poison_fraction: 0.13341147269718698
[foolsgold agg] wv: [0.8336073 0.8336073 1.        1.        1.        1.        1.
 1.        1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 0.0822, Accuracy: 9740/10000 (97.4000%)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 11.7299, Accuracy: 47/8968 (0.5241%)
Done in 91.7105758190155 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:15 choose agents : [41, 73, 51, 74, 77, 18, 43, 91, 42, 52]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   1,  Average loss: 0.0223, Accuracy: 365/606 (60.2310%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   2,  Average loss: 0.0137, Accuracy: 347/606 (57.2607%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   3,  Average loss: 0.0110, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   4,  Average loss: 0.0116, Accuracy: 392/606 (64.6865%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   5,  Average loss: 0.0112, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   6,  Average loss: 0.0112, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   7,  Average loss: 0.0106, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   8,  Average loss: 0.0106, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   9,  Average loss: 0.0103, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch  10,  Average loss: 0.0102, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Global model norm: 16.55334542105934.
Norm before scaling: 16.708981521222725. Distance: 4.160825806227714
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.3246, Accuracy: 5641/10000 (56.4100%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 1.0257, Accuracy: 4465/8968 (49.7881%)
Scaling by  100
Scaled Norm after poisoning: 414.9519927051803, distance: 416.08256767737817
Total norm for 4 adversaries is: 414.9519927051803. distance: 416.08256767737817
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 13251.5996, Accuracy: 88/8968 (0.9813%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   1,  Average loss: 0.0233, Accuracy: 345/591 (58.3756%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   2,  Average loss: 0.0197, Accuracy: 293/591 (49.5770%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   3,  Average loss: 0.0165, Accuracy: 314/591 (53.1303%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   4,  Average loss: 0.0157, Accuracy: 320/591 (54.1455%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   5,  Average loss: 0.0152, Accuracy: 305/591 (51.6074%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   6,  Average loss: 0.0146, Accuracy: 345/591 (58.3756%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   7,  Average loss: 0.0143, Accuracy: 330/591 (55.8376%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   8,  Average loss: 0.0139, Accuracy: 362/591 (61.2521%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   9,  Average loss: 0.0136, Accuracy: 369/591 (62.4365%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch  10,  Average loss: 0.0133, Accuracy: 376/591 (63.6210%), train_poison_data_count: 195
Global model norm: 16.55334542105934.
Norm before scaling: 16.60085844095306. Distance: 3.7835086350572444
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.0984, Accuracy: 5582/10000 (55.8200%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.9505, Accuracy: 4796/8968 (53.4790%)
Scaling by  100
Scaled Norm after poisoning: 377.02708374200387, distance: 378.3508416470089
Total norm for 4 adversaries is: 377.02708374200387. distance: 378.3508416470089
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 107.2627, Accuracy: 8896/8968 (99.1971%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   1,  Average loss: 0.0230, Accuracy: 336/568 (59.1549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   2,  Average loss: 0.0137, Accuracy: 352/568 (61.9718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   3,  Average loss: 0.0126, Accuracy: 355/568 (62.5000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   4,  Average loss: 0.0118, Accuracy: 375/568 (66.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   5,  Average loss: 0.0114, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   6,  Average loss: 0.0108, Accuracy: 376/568 (66.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   7,  Average loss: 0.0108, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   8,  Average loss: 0.0099, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   9,  Average loss: 0.0102, Accuracy: 388/568 (68.3099%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch  10,  Average loss: 0.0101, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Global model norm: 16.55334542105934.
Norm before scaling: 16.659933230482668. Distance: 4.140202108416346
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.5390, Accuracy: 4124/10000 (41.2400%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.6395, Accuracy: 6638/8968 (74.0187%)
Scaling by  100
Scaled Norm after poisoning: 412.7064824121376, distance: 414.02022897438235
Total norm for 4 adversaries is: 412.7064824121376. distance: 414.02022897438235
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   1,  Average loss: 0.0224, Accuracy: 321/557 (57.6302%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   2,  Average loss: 0.0115, Accuracy: 397/557 (71.2747%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   3,  Average loss: 0.0066, Accuracy: 482/557 (86.5350%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   4,  Average loss: 0.0051, Accuracy: 498/557 (89.4075%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   5,  Average loss: 0.0045, Accuracy: 509/557 (91.3824%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   6,  Average loss: 0.0032, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   7,  Average loss: 0.0030, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   8,  Average loss: 0.0025, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   9,  Average loss: 0.0024, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch  10,  Average loss: 0.0027, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Global model norm: 16.55334542105934.
Norm before scaling: 16.78889527022345. Distance: 4.163676116938335
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.8062, Accuracy: 7609/10000 (76.0900%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0794, Accuracy: 8684/8968 (96.8332%)
Scaling by  100
Scaled Norm after poisoning: 415.55717491700227, distance: 416.36762602296545
Total norm for 4 adversaries is: 415.55717491700227. distance: 416.36762602296545
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  15, local model 77, internal_epoch   1,  Average loss: 0.0017, Accuracy: 571/589 (96.9440%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2178, Accuracy: 9349/10000 (93.4900%)
___Train Local_Simple,  epoch  15, local model 18, internal_epoch   1,  Average loss: 0.0022, Accuracy: 442/459 (96.2963%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2428, Accuracy: 9184/10000 (91.8400%)
___Train Local_Simple,  epoch  15, local model 43, internal_epoch   1,  Average loss: 0.0017, Accuracy: 393/408 (96.3235%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1197, Accuracy: 9633/10000 (96.3300%)
___Train Local_Simple,  epoch  15, local model 91, internal_epoch   1,  Average loss: 0.0007, Accuracy: 251/256 (98.0469%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.0856, Accuracy: 9726/10000 (97.2600%)
___Train Local_Simple,  epoch  15, local model 42, internal_epoch   1,  Average loss: 0.0012, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1024, Accuracy: 9687/10000 (96.8700%)
___Train Local_Simple,  epoch  15, local model 52, internal_epoch   1,  Average loss: 0.0013, Accuracy: 247/253 (97.6285%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1752, Accuracy: 9436/10000 (94.3600%)
time spent on training: 76.54961585998535
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.5133760778244528  data num: [606, 591, 568, 557, 589, 459, 408, 256, 236, 253]
[foolsgold agg] considering poison per batch poison_fraction: 0.1604300243201415
[foolsgold agg] wv: [0.84366774 0.84366774 1.         1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 0.0821, Accuracy: 9742/10000 (97.4200%)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 11.6313, Accuracy: 52/8968 (0.5798%)
Done in 90.52964234352112 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:16 choose agents : [41, 73, 51, 74, 28, 37, 96, 99, 80, 13]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   1,  Average loss: 0.0244, Accuracy: 353/606 (58.2508%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   2,  Average loss: 0.0150, Accuracy: 339/606 (55.9406%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   3,  Average loss: 0.0119, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   4,  Average loss: 0.0110, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   5,  Average loss: 0.0113, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   6,  Average loss: 0.0113, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   7,  Average loss: 0.0105, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   8,  Average loss: 0.0107, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   9,  Average loss: 0.0106, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch  10,  Average loss: 0.0103, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Global model norm: 16.55665709879592.
Norm before scaling: 16.780884467038494. Distance: 4.65800043780733
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.4544, Accuracy: 4743/10000 (47.4300%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.9130, Accuracy: 5190/8968 (57.8724%)
Scaling by  100
Scaled Norm after poisoning: 464.566060964423, distance: 465.8000509875455
Total norm for 4 adversaries is: 464.566060964423. distance: 465.8000509875455
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 70831.0803, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   1,  Average loss: 0.0242, Accuracy: 338/591 (57.1912%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   2,  Average loss: 0.0225, Accuracy: 258/591 (43.6548%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   3,  Average loss: 0.0179, Accuracy: 294/591 (49.7462%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   4,  Average loss: 0.0164, Accuracy: 341/591 (57.6988%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   5,  Average loss: 0.0152, Accuracy: 323/591 (54.6531%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   6,  Average loss: 0.0152, Accuracy: 307/591 (51.9459%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   7,  Average loss: 0.0146, Accuracy: 343/591 (58.0372%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   8,  Average loss: 0.0141, Accuracy: 343/591 (58.0372%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   9,  Average loss: 0.0135, Accuracy: 365/591 (61.7597%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch  10,  Average loss: 0.0136, Accuracy: 360/591 (60.9137%), train_poison_data_count: 195
Global model norm: 16.55665709879592.
Norm before scaling: 16.66567491759588. Distance: 3.9400559863842397
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.0395, Accuracy: 5571/10000 (55.7100%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.9798, Accuracy: 5227/8968 (58.2850%)
Scaling by  100
Scaled Norm after poisoning: 392.84131258690195, distance: 394.00559164813893
Total norm for 4 adversaries is: 392.84131258690195. distance: 394.00559164813893
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   1,  Average loss: 0.0242, Accuracy: 324/568 (57.0423%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   2,  Average loss: 0.0134, Accuracy: 349/568 (61.4437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   3,  Average loss: 0.0113, Accuracy: 389/568 (68.4859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   4,  Average loss: 0.0109, Accuracy: 374/568 (65.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   5,  Average loss: 0.0103, Accuracy: 382/568 (67.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   6,  Average loss: 0.0105, Accuracy: 375/568 (66.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   7,  Average loss: 0.0098, Accuracy: 393/568 (69.1901%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   8,  Average loss: 0.0096, Accuracy: 398/568 (70.0704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   9,  Average loss: 0.0095, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch  10,  Average loss: 0.0092, Accuracy: 403/568 (70.9507%), train_poison_data_count: 180
Global model norm: 16.55665709879592.
Norm before scaling: 16.783031177294728. Distance: 4.64272746229892
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.2318, Accuracy: 5453/10000 (54.5300%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.6846, Accuracy: 6054/8968 (67.5067%)
Scaling by  100
Scaled Norm after poisoning: 463.05780551676264, distance: 464.2727511926583
Total norm for 4 adversaries is: 463.05780551676264. distance: 464.2727511926583
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   1,  Average loss: 0.0251, Accuracy: 325/557 (58.3483%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   2,  Average loss: 0.0113, Accuracy: 400/557 (71.8133%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   3,  Average loss: 0.0063, Accuracy: 499/557 (89.5871%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   4,  Average loss: 0.0051, Accuracy: 505/557 (90.6643%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   5,  Average loss: 0.0043, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   6,  Average loss: 0.0036, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   7,  Average loss: 0.0034, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   8,  Average loss: 0.0034, Accuracy: 520/557 (93.3573%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   9,  Average loss: 0.0024, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch  10,  Average loss: 0.0028, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Global model norm: 16.55665709879592.
Norm before scaling: 16.792172306799678. Distance: 4.3110888839970185
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.9867, Accuracy: 7326/10000 (73.2600%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1208, Accuracy: 8522/8968 (95.0268%)
Scaling by  100
Scaled Norm after poisoning: 430.1812299775526, distance: 431.1089080789215
Total norm for 4 adversaries is: 430.1812299775526. distance: 431.1089080789215
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  16, local model 28, internal_epoch   1,  Average loss: 0.0013, Accuracy: 489/501 (97.6048%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1228, Accuracy: 9586/10000 (95.8600%)
___Train Local_Simple,  epoch  16, local model 37, internal_epoch   1,  Average loss: 0.0014, Accuracy: 843/860 (98.0233%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1732, Accuracy: 9473/10000 (94.7300%)
___Train Local_Simple,  epoch  16, local model 96, internal_epoch   1,  Average loss: 0.0017, Accuracy: 656/672 (97.6190%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2715, Accuracy: 9036/10000 (90.3600%)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0009, Accuracy: 372/377 (98.6737%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.0942, Accuracy: 9705/10000 (97.0500%)
___Train Local_Simple,  epoch  16, local model 80, internal_epoch   1,  Average loss: 0.0009, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2487, Accuracy: 9297/10000 (92.9700%)
___Train Local_Simple,  epoch  16, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 714/734 (97.2752%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1884, Accuracy: 9369/10000 (93.6900%)
time spent on training: 78.74690222740173
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3937595387485162  data num: [606, 591, 568, 557, 501, 860, 672, 377, 431, 734]
[foolsgold agg] considering poison per batch poison_fraction: 0.12304985585891132
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.0820, Accuracy: 9745/10000 (97.4500%)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 11.5280, Accuracy: 53/8968 (0.5910%)
Done in 92.63614988327026 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:17 choose agents : [41, 73, 51, 74, 98, 78, 46, 45, 62, 50]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   1,  Average loss: 0.0253, Accuracy: 340/606 (56.1056%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   2,  Average loss: 0.0143, Accuracy: 340/606 (56.1056%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   3,  Average loss: 0.0122, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   4,  Average loss: 0.0121, Accuracy: 392/606 (64.6865%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   5,  Average loss: 0.0108, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   6,  Average loss: 0.0109, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   7,  Average loss: 0.0103, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   8,  Average loss: 0.0106, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   9,  Average loss: 0.0104, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch  10,  Average loss: 0.0106, Accuracy: 402/606 (66.3366%), train_poison_data_count: 200
Global model norm: 16.561428510446817.
Norm before scaling: 16.82477515695325. Distance: 4.787428709450543
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.2587, Accuracy: 5517/10000 (55.1700%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 1.0076, Accuracy: 4682/8968 (52.2079%)
Scaling by  100
Scaled Norm after poisoning: 477.5523531509399, distance: 478.74286874584357
Total norm for 4 adversaries is: 477.5523531509399. distance: 478.74286874584357
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 75091.9793, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   1,  Average loss: 0.0272, Accuracy: 351/591 (59.3909%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   2,  Average loss: 0.0213, Accuracy: 249/591 (42.1320%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   3,  Average loss: 0.0167, Accuracy: 332/591 (56.1760%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   4,  Average loss: 0.0155, Accuracy: 324/591 (54.8223%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   5,  Average loss: 0.0149, Accuracy: 345/591 (58.3756%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   6,  Average loss: 0.0145, Accuracy: 347/591 (58.7140%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   7,  Average loss: 0.0133, Accuracy: 367/591 (62.0981%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   8,  Average loss: 0.0136, Accuracy: 353/591 (59.7293%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   9,  Average loss: 0.0140, Accuracy: 340/591 (57.5296%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch  10,  Average loss: 0.0138, Accuracy: 354/591 (59.8985%), train_poison_data_count: 195
Global model norm: 16.561428510446817.
Norm before scaling: 16.70743538718007. Distance: 4.345678107371809
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.2086, Accuracy: 4792/10000 (47.9200%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.8005, Accuracy: 6119/8968 (68.2315%)
Scaling by  100
Scaled Norm after poisoning: 433.2674909914198, distance: 434.56779893936
Total norm for 4 adversaries is: 433.2674909914198. distance: 434.56779893936
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   1,  Average loss: 0.0221, Accuracy: 339/568 (59.6831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   2,  Average loss: 0.0136, Accuracy: 340/568 (59.8592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   3,  Average loss: 0.0120, Accuracy: 374/568 (65.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   4,  Average loss: 0.0114, Accuracy: 374/568 (65.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   5,  Average loss: 0.0109, Accuracy: 383/568 (67.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   6,  Average loss: 0.0106, Accuracy: 385/568 (67.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   7,  Average loss: 0.0101, Accuracy: 394/568 (69.3662%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   8,  Average loss: 0.0100, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   9,  Average loss: 0.0096, Accuracy: 399/568 (70.2465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch  10,  Average loss: 0.0096, Accuracy: 409/568 (72.0070%), train_poison_data_count: 180
Global model norm: 16.561428510446817.
Norm before scaling: 16.670388581816262. Distance: 4.035123871103757
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.4012, Accuracy: 4855/10000 (48.5500%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.6627, Accuracy: 6297/8968 (70.2163%)
Scaling by  100
Scaled Norm after poisoning: 402.28148183206247, distance: 403.5123720222219
Total norm for 4 adversaries is: 402.28148183206247. distance: 403.5123720222219
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   1,  Average loss: 0.0237, Accuracy: 322/557 (57.8097%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   2,  Average loss: 0.0122, Accuracy: 377/557 (67.6840%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   3,  Average loss: 0.0053, Accuracy: 500/557 (89.7666%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   4,  Average loss: 0.0047, Accuracy: 509/557 (91.3824%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   5,  Average loss: 0.0037, Accuracy: 519/557 (93.1777%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   6,  Average loss: 0.0034, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   7,  Average loss: 0.0032, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   8,  Average loss: 0.0026, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   9,  Average loss: 0.0028, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch  10,  Average loss: 0.0029, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Global model norm: 16.561428510446817.
Norm before scaling: 16.85882471298415. Distance: 4.32622786716023
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.8078, Accuracy: 7703/10000 (77.0300%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0924, Accuracy: 8599/8968 (95.8854%)
Scaling by  100
Scaled Norm after poisoning: 431.9247981419914, distance: 432.62277881544793
Total norm for 4 adversaries is: 431.9247981419914. distance: 432.62277881544793
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  17, local model 98, internal_epoch   1,  Average loss: 0.0018, Accuracy: 788/818 (96.3325%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3846, Accuracy: 8807/10000 (88.0700%)
___Train Local_Simple,  epoch  17, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 293/303 (96.6997%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1690, Accuracy: 9490/10000 (94.9000%)
___Train Local_Simple,  epoch  17, local model 46, internal_epoch   1,  Average loss: 0.0024, Accuracy: 692/710 (97.4648%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4007, Accuracy: 8752/10000 (87.5200%)
___Train Local_Simple,  epoch  17, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 613/628 (97.6115%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3956, Accuracy: 8712/10000 (87.1200%)
___Train Local_Simple,  epoch  17, local model 62, internal_epoch   1,  Average loss: 0.0008, Accuracy: 415/423 (98.1087%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1247, Accuracy: 9616/10000 (96.1600%)
___Train Local_Simple,  epoch  17, local model 50, internal_epoch   1,  Average loss: 0.0022, Accuracy: 457/474 (96.4135%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2258, Accuracy: 9256/10000 (92.5600%)
time spent on training: 86.73425054550171
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.40894681225783724  data num: [606, 591, 568, 557, 818, 303, 710, 628, 423, 474]
[foolsgold agg] considering poison per batch poison_fraction: 0.12779587883057414
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.0821, Accuracy: 9749/10000 (97.4900%)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 11.4575, Accuracy: 54/8968 (0.6021%)
Done in 101.37783813476562 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:18 choose agents : [41, 73, 51, 74, 67, 14, 36, 24, 7, 4]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   1,  Average loss: 0.0235, Accuracy: 337/606 (55.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   2,  Average loss: 0.0149, Accuracy: 330/606 (54.4554%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   3,  Average loss: 0.0121, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   4,  Average loss: 0.0117, Accuracy: 401/606 (66.1716%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   5,  Average loss: 0.0112, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   6,  Average loss: 0.0110, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   7,  Average loss: 0.0108, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   8,  Average loss: 0.0107, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   9,  Average loss: 0.0103, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Global model norm: 16.565991303604314.
Norm before scaling: 16.814943951375234. Distance: 4.528255551853882
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.2546, Accuracy: 5160/10000 (51.6000%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 1.0083, Accuracy: 4984/8968 (55.5754%)
Scaling by  100
Scaled Norm after poisoning: 451.7808684805057, distance: 452.8255734827705
Total norm for 4 adversaries is: 451.7808684805057. distance: 452.8255734827705
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 5024.6712, Accuracy: 7099/8968 (79.1592%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   1,  Average loss: 0.0258, Accuracy: 347/591 (58.7140%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   2,  Average loss: 0.0235, Accuracy: 248/591 (41.9628%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   3,  Average loss: 0.0178, Accuracy: 275/591 (46.5313%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   4,  Average loss: 0.0157, Accuracy: 333/591 (56.3452%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   5,  Average loss: 0.0147, Accuracy: 354/591 (59.8985%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   6,  Average loss: 0.0140, Accuracy: 359/591 (60.7445%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   7,  Average loss: 0.0139, Accuracy: 359/591 (60.7445%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   8,  Average loss: 0.0136, Accuracy: 368/591 (62.2673%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   9,  Average loss: 0.0134, Accuracy: 348/591 (58.8832%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch  10,  Average loss: 0.0130, Accuracy: 369/591 (62.4365%), train_poison_data_count: 195
Global model norm: 16.565991303604314.
Norm before scaling: 16.770499822803153. Distance: 4.446665365246568
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.1536, Accuracy: 4932/10000 (49.3200%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.8160, Accuracy: 5749/8968 (64.1057%)
Scaling by  100
Scaled Norm after poisoning: 443.5168753835642, distance: 444.6665183033236
Total norm for 4 adversaries is: 443.5168753835642. distance: 444.6665183033236
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   1,  Average loss: 0.0229, Accuracy: 328/568 (57.7465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   2,  Average loss: 0.0138, Accuracy: 332/568 (58.4507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   3,  Average loss: 0.0118, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   4,  Average loss: 0.0114, Accuracy: 390/568 (68.6620%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   5,  Average loss: 0.0110, Accuracy: 376/568 (66.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   6,  Average loss: 0.0109, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   7,  Average loss: 0.0107, Accuracy: 383/568 (67.4296%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   8,  Average loss: 0.0102, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   9,  Average loss: 0.0100, Accuracy: 399/568 (70.2465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch  10,  Average loss: 0.0101, Accuracy: 390/568 (68.6620%), train_poison_data_count: 180
Global model norm: 16.565991303604314.
Norm before scaling: 16.678915380255358. Distance: 4.200784818801371
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.4960, Accuracy: 4314/10000 (43.1400%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.6892, Accuracy: 6365/8968 (70.9746%)
Scaling by  100
Scaled Norm after poisoning: 418.74945895487434, distance: 420.0784710920092
Total norm for 4 adversaries is: 418.74945895487434. distance: 420.0784710920092
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   1,  Average loss: 0.0226, Accuracy: 330/557 (59.2460%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   2,  Average loss: 0.0103, Accuracy: 420/557 (75.4039%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   3,  Average loss: 0.0055, Accuracy: 493/557 (88.5099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   4,  Average loss: 0.0046, Accuracy: 501/557 (89.9461%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   5,  Average loss: 0.0038, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   6,  Average loss: 0.0035, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   7,  Average loss: 0.0028, Accuracy: 519/557 (93.1777%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   8,  Average loss: 0.0025, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   9,  Average loss: 0.0025, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch  10,  Average loss: 0.0025, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Global model norm: 16.565991303604314.
Norm before scaling: 16.77731237264237. Distance: 4.016003542621159
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.7954, Accuracy: 7565/10000 (75.6500%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0749, Accuracy: 8671/8968 (96.6882%)
Scaling by  100
Scaled Norm after poisoning: 400.8105069730583, distance: 401.600353274247
Total norm for 4 adversaries is: 400.8105069730583. distance: 401.600353274247
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  18, local model 67, internal_epoch   1,  Average loss: 0.0017, Accuracy: 962/998 (96.3928%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3642, Accuracy: 8820/10000 (88.2000%)
___Train Local_Simple,  epoch  18, local model 14, internal_epoch   1,  Average loss: 0.0018, Accuracy: 365/376 (97.0745%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1164, Accuracy: 9637/10000 (96.3700%)
___Train Local_Simple,  epoch  18, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 975/1005 (97.0149%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2131, Accuracy: 9335/10000 (93.3500%)
___Train Local_Simple,  epoch  18, local model 24, internal_epoch   1,  Average loss: 0.0016, Accuracy: 366/379 (96.5699%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1305, Accuracy: 9583/10000 (95.8300%)
___Train Local_Simple,  epoch  18, local model 7, internal_epoch   1,  Average loss: 0.0014, Accuracy: 406/418 (97.1292%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1174, Accuracy: 9626/10000 (96.2600%)
___Train Local_Simple,  epoch  18, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 638/658 (96.9605%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1651, Accuracy: 9480/10000 (94.8000%)
time spent on training: 82.86444997787476
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.37719298245614036  data num: [606, 591, 568, 557, 998, 376, 1005, 379, 418, 658]
[foolsgold agg] considering poison per batch poison_fraction: 0.11787280701754387
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.0823, Accuracy: 9746/10000 (97.4600%)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 11.3730, Accuracy: 55/8968 (0.6133%)
Done in 100.0822765827179 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:19 choose agents : [41, 73, 51, 74, 80, 39, 26, 29, 4, 42]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   1,  Average loss: 0.0225, Accuracy: 366/606 (60.3960%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   2,  Average loss: 0.0151, Accuracy: 345/606 (56.9307%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   3,  Average loss: 0.0119, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   4,  Average loss: 0.0116, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   5,  Average loss: 0.0108, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   6,  Average loss: 0.0109, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   7,  Average loss: 0.0107, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   8,  Average loss: 0.0108, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   9,  Average loss: 0.0105, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch  10,  Average loss: 0.0105, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Global model norm: 16.57064768637888.
Norm before scaling: 16.735653327108455. Distance: 4.212573920713509
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.4354, Accuracy: 4769/10000 (47.6900%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.8409, Accuracy: 5544/8968 (61.8198%)
Scaling by  100
Scaled Norm after poisoning: 420.12780793468073, distance: 421.25739978663876
Total norm for 4 adversaries is: 420.12780793468073. distance: 421.25739978663876
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 39036.1709, Accuracy: 115/8968 (1.2823%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   1,  Average loss: 0.0236, Accuracy: 345/591 (58.3756%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   2,  Average loss: 0.0206, Accuracy: 285/591 (48.2234%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   3,  Average loss: 0.0194, Accuracy: 298/591 (50.4230%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   4,  Average loss: 0.0164, Accuracy: 334/591 (56.5144%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   5,  Average loss: 0.0150, Accuracy: 330/591 (55.8376%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   6,  Average loss: 0.0145, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   7,  Average loss: 0.0145, Accuracy: 328/591 (55.4992%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   8,  Average loss: 0.0140, Accuracy: 355/591 (60.0677%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   9,  Average loss: 0.0128, Accuracy: 365/591 (61.7597%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch  10,  Average loss: 0.0129, Accuracy: 373/591 (63.1134%), train_poison_data_count: 195
Global model norm: 16.57064768637888.
Norm before scaling: 16.611699111267374. Distance: 3.797755386574723
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.0728, Accuracy: 5140/10000 (51.4000%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.8087, Accuracy: 5849/8968 (65.2208%)
Scaling by  100
Scaled Norm after poisoning: 378.41507468651406, distance: 379.7755093472985
Total norm for 4 adversaries is: 378.41507468651406. distance: 379.7755093472985
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   1,  Average loss: 0.0230, Accuracy: 327/568 (57.5704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   2,  Average loss: 0.0123, Accuracy: 363/568 (63.9085%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   3,  Average loss: 0.0111, Accuracy: 366/568 (64.4366%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   4,  Average loss: 0.0112, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   5,  Average loss: 0.0100, Accuracy: 396/568 (69.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   6,  Average loss: 0.0103, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   7,  Average loss: 0.0093, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   8,  Average loss: 0.0092, Accuracy: 405/568 (71.3028%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   9,  Average loss: 0.0090, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch  10,  Average loss: 0.0087, Accuracy: 416/568 (73.2394%), train_poison_data_count: 180
Global model norm: 16.57064768637888.
Norm before scaling: 16.71134199925355. Distance: 4.2240038899490475
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.4560, Accuracy: 4733/10000 (47.3300%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.4709, Accuracy: 7452/8968 (83.0955%)
Scaling by  100
Scaled Norm after poisoning: 421.16588551899594, distance: 422.4003580727649
Total norm for 4 adversaries is: 421.16588551899594. distance: 422.4003580727649
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   1,  Average loss: 0.0235, Accuracy: 334/557 (59.9641%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   2,  Average loss: 0.0116, Accuracy: 409/557 (73.4291%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   3,  Average loss: 0.0066, Accuracy: 503/557 (90.3052%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   4,  Average loss: 0.0055, Accuracy: 504/557 (90.4847%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   5,  Average loss: 0.0043, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   6,  Average loss: 0.0041, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   7,  Average loss: 0.0031, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   8,  Average loss: 0.0030, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   9,  Average loss: 0.0029, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch  10,  Average loss: 0.0030, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Global model norm: 16.57064768637888.
Norm before scaling: 16.8341555756537. Distance: 4.253945482701889
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8578, Accuracy: 7197/10000 (71.9700%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0867, Accuracy: 8668/8968 (96.6548%)
Scaling by  100
Scaled Norm after poisoning: 424.6242272586434, distance: 425.3945227668076
Total norm for 4 adversaries is: 424.6242272586434. distance: 425.3945227668076
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  19, local model 80, internal_epoch   1,  Average loss: 0.0008, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2631, Accuracy: 9315/10000 (93.1500%)
___Train Local_Simple,  epoch  19, local model 39, internal_epoch   1,  Average loss: 0.0012, Accuracy: 252/257 (98.0545%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1196, Accuracy: 9615/10000 (96.1500%)
___Train Local_Simple,  epoch  19, local model 26, internal_epoch   1,  Average loss: 0.0014, Accuracy: 538/554 (97.1119%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1461, Accuracy: 9545/10000 (95.4500%)
___Train Local_Simple,  epoch  19, local model 29, internal_epoch   1,  Average loss: 0.0013, Accuracy: 980/1002 (97.8044%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2612, Accuracy: 9128/10000 (91.2800%)
___Train Local_Simple,  epoch  19, local model 4, internal_epoch   1,  Average loss: 0.0018, Accuracy: 642/658 (97.5684%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2691, Accuracy: 9129/10000 (91.2900%)
___Train Local_Simple,  epoch  19, local model 42, internal_epoch   1,  Average loss: 0.0011, Accuracy: 230/236 (97.4576%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1064, Accuracy: 9670/10000 (96.7000%)
time spent on training: 78.78058576583862
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.42527472527472526  data num: [606, 591, 568, 557, 431, 257, 554, 1002, 658, 236]
[foolsgold agg] considering poison per batch poison_fraction: 0.13289835164835165
[foolsgold agg] wv: [1.         1.         1.         1.         0.72184054 1.
 1.         1.         1.         0.72184054]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.0824, Accuracy: 9748/10000 (97.4800%)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 11.3656, Accuracy: 57/8968 (0.6356%)
Done in 92.83638525009155 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:20 choose agents : [41, 73, 51, 74, 69, 95, 80, 8, 25, 68]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   1,  Average loss: 0.0242, Accuracy: 340/606 (56.1056%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   2,  Average loss: 0.0165, Accuracy: 319/606 (52.6403%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   3,  Average loss: 0.0123, Accuracy: 404/606 (66.6667%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   4,  Average loss: 0.0118, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   5,  Average loss: 0.0112, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   6,  Average loss: 0.0105, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   7,  Average loss: 0.0103, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   8,  Average loss: 0.0102, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   9,  Average loss: 0.0106, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch  10,  Average loss: 0.0105, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Global model norm: 16.576650426291458.
Norm before scaling: 16.779219463686232. Distance: 4.44293095462098
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.3556, Accuracy: 5090/10000 (50.9000%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.8903, Accuracy: 5228/8968 (58.2962%)
Scaling by  100
Scaled Norm after poisoning: 443.1397564538754, distance: 444.2931007510695
Total norm for 4 adversaries is: 443.1397564538754. distance: 444.2931007510695
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 134.2047, Accuracy: 8763/8968 (97.7141%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   1,  Average loss: 0.0258, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   2,  Average loss: 0.0225, Accuracy: 293/591 (49.5770%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   3,  Average loss: 0.0206, Accuracy: 239/591 (40.4399%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   4,  Average loss: 0.0172, Accuracy: 327/591 (55.3299%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   5,  Average loss: 0.0151, Accuracy: 337/591 (57.0220%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   6,  Average loss: 0.0153, Accuracy: 353/591 (59.7293%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   7,  Average loss: 0.0147, Accuracy: 341/591 (57.6988%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   8,  Average loss: 0.0149, Accuracy: 336/591 (56.8528%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   9,  Average loss: 0.0137, Accuracy: 377/591 (63.7902%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch  10,  Average loss: 0.0141, Accuracy: 357/591 (60.4061%), train_poison_data_count: 195
Global model norm: 16.576650426291458.
Norm before scaling: 16.885722504877272. Distance: 4.970901503286008
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.2761, Accuracy: 4549/10000 (45.4900%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.7959, Accuracy: 5998/8968 (66.8822%)
Scaling by  100
Scaled Norm after poisoning: 495.92000993103716, distance: 497.09015781847864
Total norm for 4 adversaries is: 495.92000993103716. distance: 497.09015781847864
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   1,  Average loss: 0.0238, Accuracy: 338/568 (59.5070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   2,  Average loss: 0.0141, Accuracy: 324/568 (57.0423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   3,  Average loss: 0.0129, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   4,  Average loss: 0.0120, Accuracy: 371/568 (65.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   5,  Average loss: 0.0112, Accuracy: 381/568 (67.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   6,  Average loss: 0.0113, Accuracy: 373/568 (65.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   7,  Average loss: 0.0109, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   8,  Average loss: 0.0104, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   9,  Average loss: 0.0100, Accuracy: 410/568 (72.1831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch  10,  Average loss: 0.0096, Accuracy: 422/568 (74.2958%), train_poison_data_count: 180
Global model norm: 16.576650426291458.
Norm before scaling: 16.721749694388947. Distance: 4.470551454463625
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.7554, Accuracy: 4003/10000 (40.0300%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.4575, Accuracy: 7904/8968 (88.1356%)
Scaling by  100
Scaled Norm after poisoning: 445.6654259363183, distance: 447.0551734685552
Total norm for 4 adversaries is: 445.6654259363183. distance: 447.0551734685552
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   1,  Average loss: 0.0223, Accuracy: 309/557 (55.4758%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   2,  Average loss: 0.0109, Accuracy: 406/557 (72.8905%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   3,  Average loss: 0.0051, Accuracy: 502/557 (90.1257%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   4,  Average loss: 0.0044, Accuracy: 513/557 (92.1005%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   5,  Average loss: 0.0036, Accuracy: 520/557 (93.3573%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   6,  Average loss: 0.0030, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   7,  Average loss: 0.0026, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   8,  Average loss: 0.0020, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   9,  Average loss: 0.0025, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch  10,  Average loss: 0.0024, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Global model norm: 16.576650426291458.
Norm before scaling: 16.81049865382447. Distance: 3.823038014383826
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6414, Accuracy: 8049/10000 (80.4900%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1117, Accuracy: 8534/8968 (95.1606%)
Scaling by  100
Scaled Norm after poisoning: 381.77240847787834, distance: 382.3037895443884
Total norm for 4 adversaries is: 381.77240847787834. distance: 382.3037895443884
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  20, local model 69, internal_epoch   1,  Average loss: 0.0019, Accuracy: 249/256 (97.2656%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2081, Accuracy: 9337/10000 (93.3700%)
___Train Local_Simple,  epoch  20, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 596/602 (99.0033%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.3526, Accuracy: 7679/10000 (76.7900%)
___Train Local_Simple,  epoch  20, local model 80, internal_epoch   1,  Average loss: 0.0012, Accuracy: 422/431 (97.9118%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1798, Accuracy: 9483/10000 (94.8300%)
___Train Local_Simple,  epoch  20, local model 8, internal_epoch   1,  Average loss: 0.0018, Accuracy: 612/633 (96.6825%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1773, Accuracy: 9436/10000 (94.3600%)
___Train Local_Simple,  epoch  20, local model 25, internal_epoch   1,  Average loss: 0.0021, Accuracy: 626/647 (96.7543%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2849, Accuracy: 9045/10000 (90.4500%)
___Train Local_Simple,  epoch  20, local model 68, internal_epoch   1,  Average loss: 0.0011, Accuracy: 483/494 (97.7733%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1796, Accuracy: 9424/10000 (94.2400%)
time spent on training: 81.55499267578125
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.43119777158774375  data num: [606, 591, 568, 557, 256, 602, 431, 633, 647, 494]
[foolsgold agg] considering poison per batch poison_fraction: 0.13474930362116994
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.0825, Accuracy: 9748/10000 (97.4800%)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 11.2221, Accuracy: 60/8968 (0.6690%)
Done in 97.22447538375854 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:21 choose agents : [41, 73, 51, 74, 70, 61, 64, 31, 10, 23]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0198, Accuracy: 369/606 (60.8911%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: 0.0139, Accuracy: 360/606 (59.4059%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: 0.0121, Accuracy: 380/606 (62.7063%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: 0.0109, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: 0.0107, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: 0.0103, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: 0.0107, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: 0.0106, Accuracy: 404/606 (66.6667%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: 0.0103, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: 0.0102, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Global model norm: 16.580492143677837.
Norm before scaling: 16.701185465327473. Distance: 3.9045237885066917
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.1623, Accuracy: 6034/10000 (60.3400%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 1.0092, Accuracy: 4304/8968 (47.9929%)
Scaling by  100
Scaled Norm after poisoning: 389.36502796219384, distance: 390.45238185981145
Total norm for 4 adversaries is: 389.36502796219384. distance: 390.45238185981145
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 4936.5557, Accuracy: 330/8968 (3.6798%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   1,  Average loss: 0.0240, Accuracy: 331/591 (56.0068%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   2,  Average loss: 0.0177, Accuracy: 309/591 (52.2843%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   3,  Average loss: 0.0169, Accuracy: 256/591 (43.3164%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   4,  Average loss: 0.0145, Accuracy: 357/591 (60.4061%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   5,  Average loss: 0.0137, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   6,  Average loss: 0.0133, Accuracy: 363/591 (61.4213%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   7,  Average loss: 0.0131, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   8,  Average loss: 0.0130, Accuracy: 377/591 (63.7902%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   9,  Average loss: 0.0126, Accuracy: 382/591 (64.6362%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch  10,  Average loss: 0.0122, Accuracy: 389/591 (65.8206%), train_poison_data_count: 195
Global model norm: 16.580492143677837.
Norm before scaling: 16.679047118854506. Distance: 3.785143778399539
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.9075, Accuracy: 6499/10000 (64.9900%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.9687, Accuracy: 4388/8968 (48.9295%)
Scaling by  100
Scaled Norm after poisoning: 377.41636076752155, distance: 378.5143656454798
Total norm for 4 adversaries is: 377.41636076752155. distance: 378.5143656454798
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0242, Accuracy: 8967/8968 (99.9888%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   1,  Average loss: 0.0212, Accuracy: 345/568 (60.7394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   2,  Average loss: 0.0123, Accuracy: 363/568 (63.9085%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   3,  Average loss: 0.0104, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   4,  Average loss: 0.0103, Accuracy: 400/568 (70.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   5,  Average loss: 0.0094, Accuracy: 413/568 (72.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   6,  Average loss: 0.0094, Accuracy: 418/568 (73.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   7,  Average loss: 0.0086, Accuracy: 449/568 (79.0493%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   8,  Average loss: 0.0075, Accuracy: 468/568 (82.3944%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   9,  Average loss: 0.0070, Accuracy: 491/568 (86.4437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch  10,  Average loss: 0.0072, Accuracy: 481/568 (84.6831%), train_poison_data_count: 180
Global model norm: 16.580492143677837.
Norm before scaling: 16.697100103175664. Distance: 3.974534872420596
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.4083, Accuracy: 4565/10000 (45.6500%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1916, Accuracy: 8575/8968 (95.6178%)
Scaling by  100
Scaled Norm after poisoning: 396.2985774640126, distance: 397.4534957073595
Total norm for 4 adversaries is: 396.2985774640126. distance: 397.4534957073595
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   1,  Average loss: 0.0228, Accuracy: 299/557 (53.6804%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   2,  Average loss: 0.0098, Accuracy: 406/557 (72.8905%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   3,  Average loss: 0.0045, Accuracy: 506/557 (90.8438%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   4,  Average loss: 0.0040, Accuracy: 506/557 (90.8438%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   5,  Average loss: 0.0029, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   6,  Average loss: 0.0030, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   7,  Average loss: 0.0028, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   8,  Average loss: 0.0023, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   9,  Average loss: 0.0021, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch  10,  Average loss: 0.0022, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Global model norm: 16.580492143677837.
Norm before scaling: 16.840520149225924. Distance: 4.176465198826255
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.8223, Accuracy: 7733/10000 (77.3300%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0761, Accuracy: 8686/8968 (96.8555%)
Scaling by  100
Scaled Norm after poisoning: 416.92718938682805, distance: 417.6465498780039
Total norm for 4 adversaries is: 416.92718938682805. distance: 417.6465498780039
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  21, local model 70, internal_epoch   1,  Average loss: 0.0022, Accuracy: 694/724 (95.8564%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2138, Accuracy: 9309/10000 (93.0900%)
___Train Local_Simple,  epoch  21, local model 61, internal_epoch   1,  Average loss: 0.0018, Accuracy: 677/699 (96.8526%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1669, Accuracy: 9491/10000 (94.9100%)
___Train Local_Simple,  epoch  21, local model 64, internal_epoch   1,  Average loss: 0.0020, Accuracy: 783/813 (96.3100%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3894, Accuracy: 8631/10000 (86.3100%)
___Train Local_Simple,  epoch  21, local model 31, internal_epoch   1,  Average loss: 0.0009, Accuracy: 820/835 (98.2036%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1600, Accuracy: 9531/10000 (95.3100%)
___Train Local_Simple,  epoch  21, local model 10, internal_epoch   1,  Average loss: 0.0017, Accuracy: 862/892 (96.6368%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.9246, Accuracy: 8042/10000 (80.4200%)
___Train Local_Simple,  epoch  21, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1220, Accuracy: 9592/10000 (95.9200%)
time spent on training: 81.90552854537964
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3529948312557008  data num: [606, 591, 568, 557, 724, 699, 813, 835, 892, 293]
[foolsgold agg] considering poison per batch poison_fraction: 0.1103108847674065
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.0824, Accuracy: 9745/10000 (97.4500%)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 11.1003, Accuracy: 61/8968 (0.6802%)
Done in 96.31303524971008 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:22 choose agents : [41, 73, 51, 74, 7, 46, 65, 57, 83, 9]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   1,  Average loss: 0.0219, Accuracy: 350/606 (57.7558%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   2,  Average loss: 0.0161, Accuracy: 334/606 (55.1155%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   3,  Average loss: 0.0118, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   4,  Average loss: 0.0113, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   5,  Average loss: 0.0110, Accuracy: 403/606 (66.5017%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   6,  Average loss: 0.0112, Accuracy: 393/606 (64.8515%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   7,  Average loss: 0.0105, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   8,  Average loss: 0.0103, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   9,  Average loss: 0.0105, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch  10,  Average loss: 0.0104, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Global model norm: 16.584083629612593.
Norm before scaling: 16.742854629732165. Distance: 4.216800041250548
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.3827, Accuracy: 5424/10000 (54.2400%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 1.0059, Accuracy: 4586/8968 (51.1374%)
Scaling by  100
Scaled Norm after poisoning: 420.5235390260574, distance: 421.6800290208205
Total norm for 4 adversaries is: 420.5235390260574. distance: 421.6800290208205
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 20621.4100, Accuracy: 1911/8968 (21.3091%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   1,  Average loss: 0.0231, Accuracy: 344/591 (58.2064%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   2,  Average loss: 0.0201, Accuracy: 303/591 (51.2690%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   3,  Average loss: 0.0173, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   4,  Average loss: 0.0154, Accuracy: 328/591 (55.4992%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   5,  Average loss: 0.0144, Accuracy: 321/591 (54.3147%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   6,  Average loss: 0.0136, Accuracy: 362/591 (61.2521%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   7,  Average loss: 0.0126, Accuracy: 385/591 (65.1438%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   8,  Average loss: 0.0119, Accuracy: 393/591 (66.4975%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   9,  Average loss: 0.0117, Accuracy: 400/591 (67.6819%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch  10,  Average loss: 0.0119, Accuracy: 378/591 (63.9594%), train_poison_data_count: 195
Global model norm: 16.584083629612593.
Norm before scaling: 16.678358224256986. Distance: 3.6779918610906446
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.9633, Accuracy: 5832/10000 (58.3200%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.7479, Accuracy: 5864/8968 (65.3880%)
Scaling by  100
Scaled Norm after poisoning: 366.7588828167629, distance: 367.7991766915745
Total norm for 4 adversaries is: 366.7588828167629. distance: 367.7991766915745
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   1,  Average loss: 0.0221, Accuracy: 332/568 (58.4507%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   2,  Average loss: 0.0130, Accuracy: 331/568 (58.2746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   3,  Average loss: 0.0108, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   4,  Average loss: 0.0113, Accuracy: 362/568 (63.7324%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   5,  Average loss: 0.0103, Accuracy: 381/568 (67.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   6,  Average loss: 0.0102, Accuracy: 382/568 (67.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   7,  Average loss: 0.0100, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   8,  Average loss: 0.0093, Accuracy: 403/568 (70.9507%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   9,  Average loss: 0.0091, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch  10,  Average loss: 0.0088, Accuracy: 409/568 (72.0070%), train_poison_data_count: 180
Global model norm: 16.584083629612593.
Norm before scaling: 16.700986291690512. Distance: 3.9873057637994505
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.3765, Accuracy: 4800/10000 (48.0000%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.5219, Accuracy: 7426/8968 (82.8055%)
Scaling by  100
Scaled Norm after poisoning: 397.5680759316573, distance: 398.73058338306583
Total norm for 4 adversaries is: 397.5680759316573. distance: 398.73058338306583
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   1,  Average loss: 0.0246, Accuracy: 298/557 (53.5009%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   2,  Average loss: 0.0118, Accuracy: 377/557 (67.6840%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   3,  Average loss: 0.0050, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   4,  Average loss: 0.0043, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   5,  Average loss: 0.0033, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   6,  Average loss: 0.0029, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   7,  Average loss: 0.0030, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   8,  Average loss: 0.0025, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   9,  Average loss: 0.0023, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch  10,  Average loss: 0.0025, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Global model norm: 16.584083629612593.
Norm before scaling: 16.904274195717022. Distance: 4.488155884481755
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.8063, Accuracy: 7710/10000 (77.1000%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0687, Accuracy: 8714/8968 (97.1677%)
Scaling by  100
Scaled Norm after poisoning: 448.07182390215075, distance: 448.81555927797336
Total norm for 4 adversaries is: 448.07182390215075. distance: 448.81555927797336
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  22, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 409/418 (97.8469%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1582, Accuracy: 9472/10000 (94.7200%)
___Train Local_Simple,  epoch  22, local model 46, internal_epoch   1,  Average loss: 0.0018, Accuracy: 689/710 (97.0423%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.4634, Accuracy: 8435/10000 (84.3500%)
___Train Local_Simple,  epoch  22, local model 65, internal_epoch   1,  Average loss: 0.0010, Accuracy: 363/371 (97.8437%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1287, Accuracy: 9594/10000 (95.9400%)
___Train Local_Simple,  epoch  22, local model 57, internal_epoch   1,  Average loss: 0.0016, Accuracy: 330/343 (96.2099%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2294, Accuracy: 9331/10000 (93.3100%)
___Train Local_Simple,  epoch  22, local model 83, internal_epoch   1,  Average loss: 0.0014, Accuracy: 422/433 (97.4596%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1051, Accuracy: 9658/10000 (96.5800%)
___Train Local_Simple,  epoch  22, local model 9, internal_epoch   1,  Average loss: 0.0010, Accuracy: 430/436 (98.6239%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1110, Accuracy: 9656/10000 (96.5600%)
time spent on training: 84.80282521247864
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.46135505662626664  data num: [606, 591, 568, 557, 418, 710, 371, 343, 433, 436]
[foolsgold agg] considering poison per batch poison_fraction: 0.14417345519570832
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.0827, Accuracy: 9747/10000 (97.4700%)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 11.0619, Accuracy: 61/8968 (0.6802%)
Done in 99.27378511428833 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:23 choose agents : [41, 73, 51, 74, 64, 58, 12, 83, 96, 90]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   1,  Average loss: 0.0218, Accuracy: 349/606 (57.5908%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   2,  Average loss: 0.0134, Accuracy: 358/606 (59.0759%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   3,  Average loss: 0.0120, Accuracy: 318/606 (52.4752%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   4,  Average loss: 0.0112, Accuracy: 404/606 (66.6667%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   5,  Average loss: 0.0111, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   6,  Average loss: 0.0105, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   7,  Average loss: 0.0105, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   8,  Average loss: 0.0103, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   9,  Average loss: 0.0100, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch  10,  Average loss: 0.0102, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Global model norm: 16.589483657352876.
Norm before scaling: 16.744420275171144. Distance: 4.115435985954853
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.4252, Accuracy: 4850/10000 (48.5000%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.8337, Accuracy: 5344/8968 (59.5897%)
Scaling by  100
Scaled Norm after poisoning: 410.44625104878224, distance: 411.5436071973418
Total norm for 4 adversaries is: 410.44625104878224. distance: 411.5436071973418
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 14654.2206, Accuracy: 822/8968 (9.1659%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   1,  Average loss: 0.0240, Accuracy: 355/591 (60.0677%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   2,  Average loss: 0.0211, Accuracy: 304/591 (51.4382%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   3,  Average loss: 0.0177, Accuracy: 300/591 (50.7614%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   4,  Average loss: 0.0162, Accuracy: 326/591 (55.1607%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   5,  Average loss: 0.0144, Accuracy: 361/591 (61.0829%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   6,  Average loss: 0.0128, Accuracy: 396/591 (67.0051%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   7,  Average loss: 0.0123, Accuracy: 426/591 (72.0812%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   8,  Average loss: 0.0094, Accuracy: 482/591 (81.5567%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   9,  Average loss: 0.0080, Accuracy: 515/591 (87.1404%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch  10,  Average loss: 0.0081, Accuracy: 503/591 (85.1100%), train_poison_data_count: 195
Global model norm: 16.589483657352876.
Norm before scaling: 16.735708032223904. Distance: 4.302875559772295
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.4915, Accuracy: 4415/10000 (44.1500%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.2657, Accuracy: 8197/8968 (91.4028%)
Scaling by  100
Scaled Norm after poisoning: 429.02028652500803, distance: 430.28754920401775
Total norm for 4 adversaries is: 429.02028652500803. distance: 430.28754920401775
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   1,  Average loss: 0.0209, Accuracy: 351/568 (61.7958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   2,  Average loss: 0.0125, Accuracy: 367/568 (64.6127%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   3,  Average loss: 0.0109, Accuracy: 381/568 (67.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   4,  Average loss: 0.0104, Accuracy: 400/568 (70.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   5,  Average loss: 0.0104, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   6,  Average loss: 0.0096, Accuracy: 405/568 (71.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   7,  Average loss: 0.0092, Accuracy: 416/568 (73.2394%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   8,  Average loss: 0.0088, Accuracy: 416/568 (73.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   9,  Average loss: 0.0084, Accuracy: 439/568 (77.2887%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch  10,  Average loss: 0.0086, Accuracy: 430/568 (75.7042%), train_poison_data_count: 180
Global model norm: 16.589483657352876.
Norm before scaling: 16.631344609957317. Distance: 3.6356951034001317
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.4316, Accuracy: 4710/10000 (47.1000%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.3631, Accuracy: 8314/8968 (92.7074%)
Scaling by  100
Scaled Norm after poisoning: 362.3192437271308, distance: 363.56949988963595
Total norm for 4 adversaries is: 362.3192437271308. distance: 363.56949988963595
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   1,  Average loss: 0.0233, Accuracy: 317/557 (56.9120%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   2,  Average loss: 0.0107, Accuracy: 391/557 (70.1975%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   3,  Average loss: 0.0046, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   4,  Average loss: 0.0041, Accuracy: 509/557 (91.3824%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   5,  Average loss: 0.0036, Accuracy: 519/557 (93.1777%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   6,  Average loss: 0.0027, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   7,  Average loss: 0.0024, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   8,  Average loss: 0.0025, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   9,  Average loss: 0.0021, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch  10,  Average loss: 0.0024, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Global model norm: 16.589483657352876.
Norm before scaling: 16.893610433721033. Distance: 4.38296350773166
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.7605, Accuracy: 7587/10000 (75.8700%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0773, Accuracy: 8668/8968 (96.6548%)
Scaling by  100
Scaled Norm after poisoning: 437.5799034176501, distance: 438.2963288404319
Total norm for 4 adversaries is: 437.5799034176501. distance: 438.2963288404319
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  23, local model 64, internal_epoch   1,  Average loss: 0.0019, Accuracy: 788/813 (96.9250%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2012, Accuracy: 9315/10000 (93.1500%)
___Train Local_Simple,  epoch  23, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 268/276 (97.1014%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1181, Accuracy: 9634/10000 (96.3400%)
___Train Local_Simple,  epoch  23, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1127/1160 (97.1552%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4111, Accuracy: 8929/10000 (89.2900%)
___Train Local_Simple,  epoch  23, local model 83, internal_epoch   1,  Average loss: 0.0015, Accuracy: 423/433 (97.6905%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1099, Accuracy: 9664/10000 (96.6400%)
___Train Local_Simple,  epoch  23, local model 96, internal_epoch   1,  Average loss: 0.0015, Accuracy: 659/672 (98.0655%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1417, Accuracy: 9579/10000 (95.7900%)
___Train Local_Simple,  epoch  23, local model 90, internal_epoch   1,  Average loss: 0.0018, Accuracy: 660/683 (96.6325%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4139, Accuracy: 8677/10000 (86.7700%)
time spent on training: 79.69489622116089
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3651517534203491  data num: [606, 591, 568, 557, 813, 276, 1160, 433, 672, 683]
[foolsgold agg] considering poison per batch poison_fraction: 0.1141099229438591
[foolsgold agg] wv: [0.97487487 0.97487487 1.         1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.0830, Accuracy: 9745/10000 (97.4500%)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 10.9985, Accuracy: 62/8968 (0.6913%)
Done in 97.76902031898499 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:24 choose agents : [41, 73, 51, 74, 28, 65, 33, 75, 13, 32]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   1,  Average loss: 0.0219, Accuracy: 369/606 (60.8911%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   2,  Average loss: 0.0133, Accuracy: 365/606 (60.2310%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   3,  Average loss: 0.0124, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   4,  Average loss: 0.0121, Accuracy: 396/606 (65.3465%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   5,  Average loss: 0.0120, Accuracy: 390/606 (64.3564%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   6,  Average loss: 0.0110, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   7,  Average loss: 0.0110, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   8,  Average loss: 0.0107, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   9,  Average loss: 0.0109, Accuracy: 391/606 (64.5215%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch  10,  Average loss: 0.0104, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Global model norm: 16.594903076109507.
Norm before scaling: 16.72147411364211. Distance: 4.121621800440834
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.3597, Accuracy: 4457/10000 (44.5700%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.9008, Accuracy: 5627/8968 (62.7453%)
Scaling by  100
Scaled Norm after poisoning: 410.9452138059282, distance: 412.1621912245227
Total norm for 4 adversaries is: 410.9452138059282. distance: 412.1621912245227
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 293.7024, Accuracy: 8626/8968 (96.1864%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   1,  Average loss: 0.0220, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   2,  Average loss: 0.0198, Accuracy: 307/591 (51.9459%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   3,  Average loss: 0.0164, Accuracy: 302/591 (51.0998%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   4,  Average loss: 0.0145, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   5,  Average loss: 0.0142, Accuracy: 338/591 (57.1912%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   6,  Average loss: 0.0125, Accuracy: 379/591 (64.1286%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   7,  Average loss: 0.0113, Accuracy: 443/591 (74.9577%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   8,  Average loss: 0.0093, Accuracy: 476/591 (80.5415%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   9,  Average loss: 0.0082, Accuracy: 495/591 (83.7563%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch  10,  Average loss: 0.0077, Accuracy: 506/591 (85.6176%), train_poison_data_count: 195
Global model norm: 16.594903076109507.
Norm before scaling: 16.73562688623855. Distance: 3.861003084447775
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.9693, Accuracy: 5614/10000 (56.1400%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.3709, Accuracy: 7923/8968 (88.3475%)
Scaling by  100
Scaled Norm after poisoning: 385.1326273181746, distance: 386.1002946126822
Total norm for 4 adversaries is: 385.1326273181746. distance: 386.1002946126822
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   1,  Average loss: 0.0236, Accuracy: 324/568 (57.0423%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   2,  Average loss: 0.0128, Accuracy: 355/568 (62.5000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   3,  Average loss: 0.0114, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   4,  Average loss: 0.0110, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   5,  Average loss: 0.0106, Accuracy: 385/568 (67.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   6,  Average loss: 0.0093, Accuracy: 424/568 (74.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   7,  Average loss: 0.0089, Accuracy: 427/568 (75.1761%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   8,  Average loss: 0.0083, Accuracy: 457/568 (80.4577%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   9,  Average loss: 0.0079, Accuracy: 469/568 (82.5704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch  10,  Average loss: 0.0078, Accuracy: 473/568 (83.2746%), train_poison_data_count: 180
Global model norm: 16.594903076109507.
Norm before scaling: 16.733729416818967. Distance: 4.493777953844839
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.6108, Accuracy: 4152/10000 (41.5200%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.2386, Accuracy: 8492/8968 (94.6922%)
Scaling by  100
Scaled Norm after poisoning: 447.9498437325322, distance: 449.3777816325591
Total norm for 4 adversaries is: 447.9498437325322. distance: 449.3777816325591
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 70513.7799, Accuracy: 5013/8968 (55.8988%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   1,  Average loss: 0.0231, Accuracy: 333/557 (59.7846%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   2,  Average loss: 0.0109, Accuracy: 375/557 (67.3250%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   3,  Average loss: 0.0050, Accuracy: 511/557 (91.7415%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   4,  Average loss: 0.0042, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   5,  Average loss: 0.0038, Accuracy: 519/557 (93.1777%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   6,  Average loss: 0.0030, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   7,  Average loss: 0.0028, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   8,  Average loss: 0.0023, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   9,  Average loss: 0.0019, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch  10,  Average loss: 0.0025, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Global model norm: 16.594903076109507.
Norm before scaling: 16.86500807335867. Distance: 4.136010474068164
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.6968, Accuracy: 7838/10000 (78.3800%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0778, Accuracy: 8672/8968 (96.6994%)
Scaling by  100
Scaled Norm after poisoning: 412.95800331268555, distance: 413.60106836177295
Total norm for 4 adversaries is: 412.95800331268555. distance: 413.60106836177295
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  24, local model 28, internal_epoch   1,  Average loss: 0.0016, Accuracy: 486/501 (97.0060%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1062, Accuracy: 9638/10000 (96.3800%)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0010, Accuracy: 361/371 (97.3046%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1579, Accuracy: 9483/10000 (94.8300%)
___Train Local_Simple,  epoch  24, local model 33, internal_epoch   1,  Average loss: 0.0021, Accuracy: 602/623 (96.6292%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1873, Accuracy: 9363/10000 (93.6300%)
___Train Local_Simple,  epoch  24, local model 75, internal_epoch   1,  Average loss: 0.0011, Accuracy: 669/686 (97.5219%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1905, Accuracy: 9426/10000 (94.2600%)
___Train Local_Simple,  epoch  24, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 718/734 (97.8202%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2281, Accuracy: 9333/10000 (93.3300%)
___Train Local_Simple,  epoch  24, local model 32, internal_epoch   1,  Average loss: 0.0024, Accuracy: 939/977 (96.1105%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3081, Accuracy: 8936/10000 (89.3600%)
time spent on training: 81.68631672859192
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3736723527518507  data num: [606, 591, 568, 557, 501, 371, 623, 686, 734, 977]
[foolsgold agg] considering poison per batch poison_fraction: 0.11677261023495333
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.0832, Accuracy: 9743/10000 (97.4300%)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 10.9934, Accuracy: 62/8968 (0.6913%)
Done in 98.71909880638123 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:25 choose agents : [41, 73, 51, 74, 80, 23, 25, 12, 58, 19]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   1,  Average loss: 0.0234, Accuracy: 337/606 (55.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   2,  Average loss: 0.0146, Accuracy: 353/606 (58.2508%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   3,  Average loss: 0.0112, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   4,  Average loss: 0.0117, Accuracy: 389/606 (64.1914%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   5,  Average loss: 0.0110, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   6,  Average loss: 0.0114, Accuracy: 396/606 (65.3465%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   7,  Average loss: 0.0108, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   8,  Average loss: 0.0109, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   9,  Average loss: 0.0106, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch  10,  Average loss: 0.0106, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Global model norm: 16.601278490217723.
Norm before scaling: 16.81308719786604. Distance: 4.458755520709453
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.3485, Accuracy: 5136/10000 (51.3600%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.8524, Accuracy: 5320/8968 (59.3220%)
Scaling by  100
Scaled Norm after poisoning: 444.74745291569684, distance: 445.87554317320433
Total norm for 4 adversaries is: 444.74745291569684. distance: 445.87554317320433
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 16624.2093, Accuracy: 710/8968 (7.9170%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0232, Accuracy: 312/591 (52.7919%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   2,  Average loss: 0.0187, Accuracy: 291/591 (49.2386%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   3,  Average loss: 0.0157, Accuracy: 272/591 (46.0237%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   4,  Average loss: 0.0138, Accuracy: 361/591 (61.0829%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   5,  Average loss: 0.0138, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   6,  Average loss: 0.0131, Accuracy: 376/591 (63.6210%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   7,  Average loss: 0.0129, Accuracy: 369/591 (62.4365%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   8,  Average loss: 0.0116, Accuracy: 422/591 (71.4044%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   9,  Average loss: 0.0110, Accuracy: 411/591 (69.5431%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch  10,  Average loss: 0.0111, Accuracy: 422/591 (71.4044%), train_poison_data_count: 195
Global model norm: 16.601278490217723.
Norm before scaling: 16.639772205260766. Distance: 3.5656400528104424
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.8836, Accuracy: 6494/10000 (64.9400%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.7497, Accuracy: 5840/8968 (65.1204%)
Scaling by  100
Scaled Norm after poisoning: 355.34499081878164, distance: 356.5639953956372
Total norm for 4 adversaries is: 355.34499081878164. distance: 356.5639953956372
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.2811, Accuracy: 8966/8968 (99.9777%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   1,  Average loss: 0.0214, Accuracy: 346/568 (60.9155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   2,  Average loss: 0.0120, Accuracy: 382/568 (67.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   3,  Average loss: 0.0105, Accuracy: 396/568 (69.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   4,  Average loss: 0.0099, Accuracy: 387/568 (68.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   5,  Average loss: 0.0094, Accuracy: 421/568 (74.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   6,  Average loss: 0.0087, Accuracy: 432/568 (76.0563%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   7,  Average loss: 0.0075, Accuracy: 455/568 (80.1056%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   8,  Average loss: 0.0070, Accuracy: 493/568 (86.7958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   9,  Average loss: 0.0063, Accuracy: 504/568 (88.7324%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch  10,  Average loss: 0.0062, Accuracy: 510/568 (89.7887%), train_poison_data_count: 180
Global model norm: 16.601278490217723.
Norm before scaling: 16.696931952340638. Distance: 3.8081629113282838
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.2578, Accuracy: 5099/10000 (50.9900%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1933, Accuracy: 8577/8968 (95.6401%)
Scaling by  100
Scaled Norm after poisoning: 379.6906018391817, distance: 380.81629019121544
Total norm for 4 adversaries is: 379.6906018391817. distance: 380.81629019121544
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0233, Accuracy: 330/557 (59.2460%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   2,  Average loss: 0.0096, Accuracy: 433/557 (77.7379%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   3,  Average loss: 0.0041, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   4,  Average loss: 0.0036, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   5,  Average loss: 0.0032, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   6,  Average loss: 0.0029, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   7,  Average loss: 0.0025, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   8,  Average loss: 0.0022, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   9,  Average loss: 0.0021, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch  10,  Average loss: 0.0021, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Global model norm: 16.601278490217723.
Norm before scaling: 16.912824723762697. Distance: 4.323541631295901
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.7559, Accuracy: 7699/10000 (76.9900%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0676, Accuracy: 8732/8968 (97.3684%)
Scaling by  100
Scaled Norm after poisoning: 431.7181335952892, distance: 432.3541661647312
Total norm for 4 adversaries is: 431.7181335952892. distance: 432.3541661647312
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  25, local model 80, internal_epoch   1,  Average loss: 0.0011, Accuracy: 423/431 (98.1439%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1421, Accuracy: 9567/10000 (95.6700%)
___Train Local_Simple,  epoch  25, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1596, Accuracy: 9463/10000 (94.6300%)
___Train Local_Simple,  epoch  25, local model 25, internal_epoch   1,  Average loss: 0.0019, Accuracy: 626/647 (96.7543%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.8024, Accuracy: 7777/10000 (77.7700%)
___Train Local_Simple,  epoch  25, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1123/1160 (96.8103%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.0713, Accuracy: 7338/10000 (73.3800%)
___Train Local_Simple,  epoch  25, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 267/276 (96.7391%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1543, Accuracy: 9512/10000 (95.1200%)
___Train Local_Simple,  epoch  25, local model 19, internal_epoch   1,  Average loss: 0.0029, Accuracy: 200/205 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1411, Accuracy: 9558/10000 (95.5800%)
time spent on training: 86.39099097251892
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.43532058492688414  data num: [606, 591, 568, 557, 431, 293, 647, 1160, 276, 205]
[foolsgold agg] considering poison per batch poison_fraction: 0.13603768278965128
[foolsgold agg] wv: [1.         1.         0.99389152 0.99389152 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.0834, Accuracy: 9745/10000 (97.4500%)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 10.8857, Accuracy: 63/8968 (0.7025%)
Done in 102.97081899642944 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:26 choose agents : [41, 73, 51, 74, 11, 13, 82, 50, 34, 14]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   1,  Average loss: 0.0231, Accuracy: 357/606 (58.9109%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   2,  Average loss: 0.0158, Accuracy: 314/606 (51.8152%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   3,  Average loss: 0.0131, Accuracy: 397/606 (65.5116%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   4,  Average loss: 0.0118, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   5,  Average loss: 0.0113, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   6,  Average loss: 0.0115, Accuracy: 397/606 (65.5116%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   7,  Average loss: 0.0108, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   8,  Average loss: 0.0103, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   9,  Average loss: 0.0106, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch  10,  Average loss: 0.0104, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Global model norm: 16.60688150085963.
Norm before scaling: 16.857135726520795. Distance: 4.655265345565392
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.2322, Accuracy: 5865/10000 (58.6500%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.9389, Accuracy: 4499/8968 (50.1673%)
Scaling by  100
Scaled Norm after poisoning: 464.3931860503554, distance: 465.5265164305896
Total norm for 4 adversaries is: 464.3931860503554. distance: 465.5265164305896
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 3304.5455, Accuracy: 6151/8968 (68.5883%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   1,  Average loss: 0.0252, Accuracy: 343/591 (58.0372%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   2,  Average loss: 0.0226, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   3,  Average loss: 0.0200, Accuracy: 241/591 (40.7783%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   4,  Average loss: 0.0168, Accuracy: 353/591 (59.7293%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   5,  Average loss: 0.0152, Accuracy: 338/591 (57.1912%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   6,  Average loss: 0.0151, Accuracy: 317/591 (53.6379%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   7,  Average loss: 0.0145, Accuracy: 366/591 (61.9289%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   8,  Average loss: 0.0124, Accuracy: 413/591 (69.8816%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   9,  Average loss: 0.0119, Accuracy: 444/591 (75.1269%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch  10,  Average loss: 0.0123, Accuracy: 420/591 (71.0660%), train_poison_data_count: 195
Global model norm: 16.60688150085963.
Norm before scaling: 16.785463056452485. Distance: 4.4320989702101965
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.3159, Accuracy: 4271/10000 (42.7100%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.5832, Accuracy: 7756/8968 (86.4853%)
Scaling by  100
Scaled Norm after poisoning: 441.97596088475217, distance: 443.20986493420924
Total norm for 4 adversaries is: 441.97596088475217. distance: 443.20986493420924
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   1,  Average loss: 0.0213, Accuracy: 347/568 (61.0915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   2,  Average loss: 0.0129, Accuracy: 330/568 (58.0986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   3,  Average loss: 0.0109, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   4,  Average loss: 0.0108, Accuracy: 388/568 (68.3099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   5,  Average loss: 0.0101, Accuracy: 393/568 (69.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   6,  Average loss: 0.0097, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   7,  Average loss: 0.0090, Accuracy: 424/568 (74.6479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   8,  Average loss: 0.0079, Accuracy: 455/568 (80.1056%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   9,  Average loss: 0.0071, Accuracy: 487/568 (85.7394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch  10,  Average loss: 0.0066, Accuracy: 499/568 (87.8521%), train_poison_data_count: 180
Global model norm: 16.60688150085963.
Norm before scaling: 16.72051867104924. Distance: 3.9772743532251775
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.3627, Accuracy: 4958/10000 (49.5800%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.2845, Accuracy: 8621/8968 (96.1307%)
Scaling by  100
Scaled Norm after poisoning: 396.5598748928086, distance: 397.727431006462
Total norm for 4 adversaries is: 396.5598748928086. distance: 397.727431006462
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 2314.0585, Accuracy: 7908/8968 (88.1802%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   1,  Average loss: 0.0224, Accuracy: 331/557 (59.4255%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   2,  Average loss: 0.0096, Accuracy: 424/557 (76.1221%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   3,  Average loss: 0.0050, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   4,  Average loss: 0.0044, Accuracy: 509/557 (91.3824%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   5,  Average loss: 0.0034, Accuracy: 520/557 (93.3573%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   6,  Average loss: 0.0030, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   7,  Average loss: 0.0025, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   8,  Average loss: 0.0023, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   9,  Average loss: 0.0018, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch  10,  Average loss: 0.0023, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Global model norm: 16.60688150085963.
Norm before scaling: 16.87247431185767. Distance: 4.142036629213235
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.7080, Accuracy: 7840/10000 (78.4000%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0685, Accuracy: 8717/8968 (97.2012%)
Scaling by  100
Scaled Norm after poisoning: 413.538408887252, distance: 414.2036787620313
Total norm for 4 adversaries is: 413.538408887252. distance: 414.2036787620313
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  26, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 624/645 (96.7442%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1767, Accuracy: 9446/10000 (94.4600%)
___Train Local_Simple,  epoch  26, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 723/734 (98.5014%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3376, Accuracy: 9068/10000 (90.6800%)
___Train Local_Simple,  epoch  26, local model 82, internal_epoch   1,  Average loss: 0.0018, Accuracy: 693/713 (97.1950%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.7102, Accuracy: 7883/10000 (78.8300%)
___Train Local_Simple,  epoch  26, local model 50, internal_epoch   1,  Average loss: 0.0026, Accuracy: 454/474 (95.7806%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2904, Accuracy: 9101/10000 (91.0100%)
___Train Local_Simple,  epoch  26, local model 34, internal_epoch   1,  Average loss: 0.0007, Accuracy: 407/413 (98.5472%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1910, Accuracy: 9441/10000 (94.4100%)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0012, Accuracy: 368/376 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1073, Accuracy: 9676/10000 (96.7600%)
time spent on training: 91.24520015716553
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4090188479830897  data num: [606, 591, 568, 557, 645, 734, 713, 474, 413, 376]
[foolsgold agg] considering poison per batch poison_fraction: 0.12781838999471554
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 0.0840, Accuracy: 9743/10000 (97.4300%)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 10.8620, Accuracy: 63/8968 (0.7025%)
Done in 107.69004988670349 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:27 choose agents : [41, 73, 51, 74, 55, 58, 53, 14, 36, 6]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   1,  Average loss: 0.0225, Accuracy: 359/606 (59.2409%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   2,  Average loss: 0.0146, Accuracy: 351/606 (57.9208%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   3,  Average loss: 0.0123, Accuracy: 378/606 (62.3762%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   4,  Average loss: 0.0113, Accuracy: 399/606 (65.8416%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   5,  Average loss: 0.0111, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   6,  Average loss: 0.0109, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   7,  Average loss: 0.0104, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   8,  Average loss: 0.0108, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   9,  Average loss: 0.0102, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch  10,  Average loss: 0.0105, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Global model norm: 16.613849313559815.
Norm before scaling: 16.808415366965367. Distance: 4.353705544519954
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.1861, Accuracy: 5610/10000 (56.1000%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.8676, Accuracy: 4828/8968 (53.8359%)
Scaling by  100
Scaled Norm after poisoning: 434.25608084401074, distance: 435.3705677351192
Total norm for 4 adversaries is: 434.25608084401074. distance: 435.3705677351192
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 5475.8354, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   1,  Average loss: 0.0223, Accuracy: 326/591 (55.1607%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   2,  Average loss: 0.0175, Accuracy: 319/591 (53.9763%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   3,  Average loss: 0.0147, Accuracy: 344/591 (58.2064%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   4,  Average loss: 0.0130, Accuracy: 413/591 (69.8816%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   5,  Average loss: 0.0123, Accuracy: 460/591 (77.8342%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   6,  Average loss: 0.0094, Accuracy: 492/591 (83.2487%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   7,  Average loss: 0.0068, Accuracy: 525/591 (88.8325%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   8,  Average loss: 0.0052, Accuracy: 529/591 (89.5093%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   9,  Average loss: 0.0043, Accuracy: 540/591 (91.3706%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch  10,  Average loss: 0.0041, Accuracy: 544/591 (92.0474%), train_poison_data_count: 195
Global model norm: 16.613849313559815.
Norm before scaling: 16.718393140175078. Distance: 3.9062635497811873
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.9543, Accuracy: 6101/10000 (61.0100%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1009, Accuracy: 8715/8968 (97.1789%)
Scaling by  100
Scaled Norm after poisoning: 389.4708549750546, distance: 390.6263599976325
Total norm for 4 adversaries is: 389.4708549750546. distance: 390.6263599976325
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   1,  Average loss: 0.0212, Accuracy: 336/568 (59.1549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   2,  Average loss: 0.0125, Accuracy: 343/568 (60.3873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   3,  Average loss: 0.0107, Accuracy: 412/568 (72.5352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   4,  Average loss: 0.0097, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   5,  Average loss: 0.0084, Accuracy: 452/568 (79.5775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   6,  Average loss: 0.0075, Accuracy: 496/568 (87.3239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   7,  Average loss: 0.0058, Accuracy: 512/568 (90.1408%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   8,  Average loss: 0.0048, Accuracy: 526/568 (92.6056%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   9,  Average loss: 0.0038, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch  10,  Average loss: 0.0037, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Global model norm: 16.613849313559815.
Norm before scaling: 16.758717560058482. Distance: 3.9616728632365867
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.1650, Accuracy: 5702/10000 (57.0200%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0753, Accuracy: 8887/8968 (99.0968%)
Scaling by  100
Scaled Norm after poisoning: 395.14362499602595, distance: 396.16724293535424
Total norm for 4 adversaries is: 395.14362499602595. distance: 396.16724293535424
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 143.4967, Accuracy: 8957/8968 (99.8773%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   1,  Average loss: 0.0235, Accuracy: 327/557 (58.7074%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   2,  Average loss: 0.0103, Accuracy: 410/557 (73.6086%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   3,  Average loss: 0.0063, Accuracy: 477/557 (85.6373%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   4,  Average loss: 0.0038, Accuracy: 516/557 (92.6391%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   5,  Average loss: 0.0040, Accuracy: 516/557 (92.6391%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   6,  Average loss: 0.0030, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   7,  Average loss: 0.0025, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   8,  Average loss: 0.0025, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   9,  Average loss: 0.0023, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch  10,  Average loss: 0.0024, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Global model norm: 16.613849313559815.
Norm before scaling: 16.899450602432687. Distance: 4.342776621703072
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.8290, Accuracy: 7530/10000 (75.3000%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0770, Accuracy: 8684/8968 (96.8332%)
Scaling by  100
Scaled Norm after poisoning: 433.52541015492966, distance: 434.2776329722727
Total norm for 4 adversaries is: 433.52541015492966. distance: 434.2776329722727
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  27, local model 55, internal_epoch   1,  Average loss: 0.0022, Accuracy: 341/354 (96.3277%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2673, Accuracy: 9196/10000 (91.9600%)
___Train Local_Simple,  epoch  27, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 269/276 (97.4638%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1518, Accuracy: 9536/10000 (95.3600%)
___Train Local_Simple,  epoch  27, local model 53, internal_epoch   1,  Average loss: 0.0013, Accuracy: 718/739 (97.1583%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2357, Accuracy: 9285/10000 (92.8500%)
___Train Local_Simple,  epoch  27, local model 14, internal_epoch   1,  Average loss: 0.0015, Accuracy: 365/376 (97.0745%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3242, Accuracy: 9119/10000 (91.1900%)
___Train Local_Simple,  epoch  27, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 980/1005 (97.5124%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2483, Accuracy: 9218/10000 (92.1800%)
___Train Local_Simple,  epoch  27, local model 6, internal_epoch   1,  Average loss: 0.0016, Accuracy: 593/615 (96.4228%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1665, Accuracy: 9484/10000 (94.8400%)
time spent on training: 79.47753047943115
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.40829963073676806  data num: [606, 591, 568, 557, 354, 276, 739, 376, 1005, 615]
[foolsgold agg] considering poison per batch poison_fraction: 0.12759363460524
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 0.0843, Accuracy: 9743/10000 (97.4300%)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 10.8141, Accuracy: 63/8968 (0.7025%)
Done in 94.04381012916565 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:28 choose agents : [41, 73, 51, 74, 47, 92, 37, 43, 17, 2]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   1,  Average loss: 0.0212, Accuracy: 364/606 (60.0660%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   2,  Average loss: 0.0139, Accuracy: 364/606 (60.0660%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   3,  Average loss: 0.0111, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   4,  Average loss: 0.0109, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   5,  Average loss: 0.0105, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   6,  Average loss: 0.0106, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   8,  Average loss: 0.0103, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   9,  Average loss: 0.0097, Accuracy: 437/606 (72.1122%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 434/606 (71.6172%), train_poison_data_count: 200
Global model norm: 16.62040658464956.
Norm before scaling: 16.81096157139972. Distance: 4.30740342769753
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.2642, Accuracy: 5650/10000 (56.5000%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.9932, Accuracy: 4753/8968 (52.9996%)
Scaling by  100
Scaled Norm after poisoning: 429.64538429965705, distance: 430.74036916105274
Total norm for 4 adversaries is: 429.64538429965705. distance: 430.74036916105274
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 5273.7341, Accuracy: 1359/8968 (15.1539%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   1,  Average loss: 0.0242, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   2,  Average loss: 0.0231, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   3,  Average loss: 0.0150, Accuracy: 354/591 (59.8985%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   4,  Average loss: 0.0155, Accuracy: 325/591 (54.9915%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   5,  Average loss: 0.0142, Accuracy: 355/591 (60.0677%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   6,  Average loss: 0.0133, Accuracy: 390/591 (65.9898%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   7,  Average loss: 0.0131, Accuracy: 367/591 (62.0981%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   8,  Average loss: 0.0119, Accuracy: 427/591 (72.2504%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   9,  Average loss: 0.0107, Accuracy: 442/591 (74.7885%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch  10,  Average loss: 0.0104, Accuracy: 451/591 (76.3113%), train_poison_data_count: 195
Global model norm: 16.62040658464956.
Norm before scaling: 16.802508139714032. Distance: 4.307617740981318
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.0856, Accuracy: 5187/10000 (51.8700%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.4896, Accuracy: 7585/8968 (84.5785%)
Scaling by  100
Scaled Norm after poisoning: 429.63358298089315, distance: 430.76178886944
Total norm for 4 adversaries is: 429.63358298089315. distance: 430.76178886944
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0242, Accuracy: 329/568 (57.9225%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   2,  Average loss: 0.0127, Accuracy: 358/568 (63.0282%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   3,  Average loss: 0.0112, Accuracy: 378/568 (66.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   4,  Average loss: 0.0105, Accuracy: 389/568 (68.4859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   5,  Average loss: 0.0097, Accuracy: 423/568 (74.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   6,  Average loss: 0.0086, Accuracy: 445/568 (78.3451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   7,  Average loss: 0.0074, Accuracy: 469/568 (82.5704%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   8,  Average loss: 0.0059, Accuracy: 519/568 (91.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   9,  Average loss: 0.0054, Accuracy: 521/568 (91.7254%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch  10,  Average loss: 0.0053, Accuracy: 521/568 (91.7254%), train_poison_data_count: 180
Global model norm: 16.62040658464956.
Norm before scaling: 16.889904080937857. Distance: 4.84748469932152
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.4891, Accuracy: 4535/10000 (45.3500%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1083, Accuracy: 8912/8968 (99.3756%)
Scaling by  100
Scaled Norm after poisoning: 483.5396344923547, distance: 484.7484528082581
Total norm for 4 adversaries is: 483.5396344923547. distance: 484.7484528082581
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 4761.3520, Accuracy: 8413/8968 (93.8113%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   1,  Average loss: 0.0218, Accuracy: 331/557 (59.4255%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   2,  Average loss: 0.0091, Accuracy: 426/557 (76.4811%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   3,  Average loss: 0.0043, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   4,  Average loss: 0.0037, Accuracy: 514/557 (92.2801%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   5,  Average loss: 0.0028, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   6,  Average loss: 0.0027, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   7,  Average loss: 0.0021, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   8,  Average loss: 0.0022, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   9,  Average loss: 0.0022, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch  10,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Global model norm: 16.62040658464956.
Norm before scaling: 16.87382718001971. Distance: 3.9743797442112005
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.7099, Accuracy: 7717/10000 (77.1700%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0546, Accuracy: 8770/8968 (97.7921%)
Scaling by  100
Scaled Norm after poisoning: 396.8657282381536, distance: 397.43796685772236
Total norm for 4 adversaries is: 396.8657282381536. distance: 397.43796685772236
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  28, local model 47, internal_epoch   1,  Average loss: 0.0014, Accuracy: 757/776 (97.5515%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2449, Accuracy: 9260/10000 (92.6000%)
___Train Local_Simple,  epoch  28, local model 92, internal_epoch   1,  Average loss: 0.0015, Accuracy: 911/937 (97.2252%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.9247, Accuracy: 7681/10000 (76.8100%)
___Train Local_Simple,  epoch  28, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 839/860 (97.5581%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3829, Accuracy: 8900/10000 (89.0000%)
___Train Local_Simple,  epoch  28, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 399/408 (97.7941%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2234, Accuracy: 9311/10000 (93.1100%)
___Train Local_Simple,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 600/620 (96.7742%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1664, Accuracy: 9450/10000 (94.5000%)
___Train Local_Simple,  epoch  28, local model 2, internal_epoch   1,  Average loss: 0.0013, Accuracy: 539/548 (98.3577%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1449, Accuracy: 9556/10000 (95.5600%)
time spent on training: 79.15914058685303
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3588317107093185  data num: [606, 591, 568, 557, 776, 937, 860, 408, 620, 548]
[foolsgold agg] considering poison per batch poison_fraction: 0.11213490959666203
[foolsgold agg] wv: [1.         1.         0.92019709 0.92019709 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 0.0846, Accuracy: 9745/10000 (97.4500%)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 10.7377, Accuracy: 63/8968 (0.7025%)
Done in 93.66007161140442 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:29 choose agents : [41, 73, 51, 74, 66, 6, 38, 37, 45, 81]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   1,  Average loss: 0.0222, Accuracy: 355/606 (58.5809%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   2,  Average loss: 0.0145, Accuracy: 360/606 (59.4059%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   3,  Average loss: 0.0125, Accuracy: 371/606 (61.2211%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   4,  Average loss: 0.0113, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   5,  Average loss: 0.0108, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   6,  Average loss: 0.0107, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   7,  Average loss: 0.0099, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   8,  Average loss: 0.0104, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   9,  Average loss: 0.0102, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Global model norm: 16.62626838147901.
Norm before scaling: 16.776964944064673. Distance: 4.185019142535512
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.2539, Accuracy: 5548/10000 (55.4800%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.9382, Accuracy: 5018/8968 (55.9545%)
Scaling by  100
Scaled Norm after poisoning: 417.33941522458673, distance: 418.50188544975515
Total norm for 4 adversaries is: 417.33941522458673. distance: 418.50188544975515
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 112513.9564, Accuracy: 101/8968 (1.1262%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   1,  Average loss: 0.0234, Accuracy: 372/591 (62.9442%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   2,  Average loss: 0.0194, Accuracy: 295/591 (49.9154%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   3,  Average loss: 0.0181, Accuracy: 282/591 (47.7157%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   4,  Average loss: 0.0155, Accuracy: 332/591 (56.1760%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   5,  Average loss: 0.0132, Accuracy: 407/591 (68.8663%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   6,  Average loss: 0.0110, Accuracy: 443/591 (74.9577%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   7,  Average loss: 0.0085, Accuracy: 482/591 (81.5567%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   8,  Average loss: 0.0063, Accuracy: 525/591 (88.8325%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   9,  Average loss: 0.0051, Accuracy: 540/591 (91.3706%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch  10,  Average loss: 0.0054, Accuracy: 534/591 (90.3553%), train_poison_data_count: 195
Global model norm: 16.62626838147901.
Norm before scaling: 16.835092786233574. Distance: 4.227856788671146
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.0805, Accuracy: 5893/10000 (58.9300%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1402, Accuracy: 8754/8968 (97.6137%)
Scaling by  100
Scaled Norm after poisoning: 421.8239598754438, distance: 422.78568373940954
Total norm for 4 adversaries is: 421.8239598754438. distance: 422.78568373940954
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   1,  Average loss: 0.0221, Accuracy: 346/568 (60.9155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   2,  Average loss: 0.0116, Accuracy: 378/568 (66.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   3,  Average loss: 0.0093, Accuracy: 433/568 (76.2324%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   4,  Average loss: 0.0081, Accuracy: 434/568 (76.4085%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   5,  Average loss: 0.0071, Accuracy: 483/568 (85.0352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   6,  Average loss: 0.0054, Accuracy: 522/568 (91.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   7,  Average loss: 0.0040, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   8,  Average loss: 0.0030, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   9,  Average loss: 0.0026, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch  10,  Average loss: 0.0029, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Global model norm: 16.62626838147901.
Norm before scaling: 16.902554543549215. Distance: 4.558189132241355
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.9987, Accuracy: 6519/10000 (65.1900%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0819, Accuracy: 8736/8968 (97.4130%)
Scaling by  100
Scaled Norm after poisoning: 454.8581853171382, distance: 455.8189059264655
Total norm for 4 adversaries is: 454.8581853171382. distance: 455.8189059264655
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 612.3845, Accuracy: 8955/8968 (99.8550%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   1,  Average loss: 0.0237, Accuracy: 322/557 (57.8097%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   2,  Average loss: 0.0103, Accuracy: 418/557 (75.0449%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   3,  Average loss: 0.0050, Accuracy: 505/557 (90.6643%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   4,  Average loss: 0.0041, Accuracy: 510/557 (91.5619%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   5,  Average loss: 0.0031, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   6,  Average loss: 0.0027, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   7,  Average loss: 0.0024, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   8,  Average loss: 0.0023, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   9,  Average loss: 0.0026, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch  10,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Global model norm: 16.62626838147901.
Norm before scaling: 17.019145282661633. Distance: 4.93950370982896
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.0172, Accuracy: 7297/10000 (72.9700%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0378, Accuracy: 8837/8968 (98.5393%)
Scaling by  100
Scaled Norm after poisoning: 493.09773372020277, distance: 493.95035491939876
Total norm for 4 adversaries is: 493.09773372020277. distance: 493.95035491939876
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  29, local model 66, internal_epoch   1,  Average loss: 0.0015, Accuracy: 643/660 (97.4242%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1847, Accuracy: 9378/10000 (93.7800%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   1,  Average loss: 0.0012, Accuracy: 600/615 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.4907, Accuracy: 8825/10000 (88.2500%)
___Train Local_Simple,  epoch  29, local model 38, internal_epoch   1,  Average loss: 0.0017, Accuracy: 864/895 (96.5363%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.0161, Accuracy: 7816/10000 (78.1600%)
___Train Local_Simple,  epoch  29, local model 37, internal_epoch   1,  Average loss: 0.0015, Accuracy: 835/860 (97.0930%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3065, Accuracy: 9101/10000 (91.0100%)
___Train Local_Simple,  epoch  29, local model 45, internal_epoch   1,  Average loss: 0.0013, Accuracy: 613/628 (97.6115%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3051, Accuracy: 9026/10000 (90.2600%)
___Train Local_Simple,  epoch  29, local model 81, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1204/1227 (98.1255%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.5146, Accuracy: 8802/10000 (88.0200%)
time spent on training: 85.79095005989075
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3221867628694325  data num: [606, 591, 568, 557, 660, 615, 895, 860, 628, 1227]
[foolsgold agg] considering poison per batch poison_fraction: 0.10068336339669764
[foolsgold agg] wv: [1.         1.         0.90762204 0.90762204 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.0851, Accuracy: 9745/10000 (97.4500%)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 10.6520, Accuracy: 67/8968 (0.7471%)
Done in 100.12369132041931 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:30 choose agents : [41, 73, 51, 74, 4, 24, 38, 54, 10, 11]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   1,  Average loss: 0.0209, Accuracy: 368/606 (60.7261%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   2,  Average loss: 0.0151, Accuracy: 370/606 (61.0561%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   3,  Average loss: 0.0125, Accuracy: 376/606 (62.0462%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   4,  Average loss: 0.0113, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   5,  Average loss: 0.0113, Accuracy: 401/606 (66.1716%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   6,  Average loss: 0.0111, Accuracy: 399/606 (65.8416%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   7,  Average loss: 0.0107, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   8,  Average loss: 0.0106, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   9,  Average loss: 0.0105, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Global model norm: 16.63250517124478.
Norm before scaling: 16.796861373540985. Distance: 4.098863276632006
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.2640, Accuracy: 5327/10000 (53.2700%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.9113, Accuracy: 5236/8968 (58.3854%)
Scaling by  100
Scaled Norm after poisoning: 408.84324242305877, distance: 409.88632189303416
Total norm for 4 adversaries is: 408.84324242305877. distance: 409.88632189303416
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 4.2257, Accuracy: 8943/8968 (99.7212%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   1,  Average loss: 0.0246, Accuracy: 345/591 (58.3756%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   2,  Average loss: 0.0212, Accuracy: 305/591 (51.6074%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   3,  Average loss: 0.0180, Accuracy: 274/591 (46.3621%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   4,  Average loss: 0.0130, Accuracy: 371/591 (62.7750%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   5,  Average loss: 0.0115, Accuracy: 451/591 (76.3113%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   6,  Average loss: 0.0086, Accuracy: 500/591 (84.6024%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   7,  Average loss: 0.0068, Accuracy: 524/591 (88.6633%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   8,  Average loss: 0.0047, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   9,  Average loss: 0.0038, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch  10,  Average loss: 0.0040, Accuracy: 550/591 (93.0626%), train_poison_data_count: 195
Global model norm: 16.63250517124478.
Norm before scaling: 16.94040601511756. Distance: 4.54464866430108
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.8452, Accuracy: 7234/10000 (72.3400%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.2840, Accuracy: 8044/8968 (89.6967%)
Scaling by  100
Scaled Norm after poisoning: 453.63342166335144, distance: 454.46488106893366
Total norm for 4 adversaries is: 453.63342166335144. distance: 454.46488106893366
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   1,  Average loss: 0.0208, Accuracy: 345/568 (60.7394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   2,  Average loss: 0.0121, Accuracy: 362/568 (63.7324%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   3,  Average loss: 0.0102, Accuracy: 416/568 (73.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   4,  Average loss: 0.0094, Accuracy: 426/568 (75.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   5,  Average loss: 0.0075, Accuracy: 501/568 (88.2042%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   6,  Average loss: 0.0065, Accuracy: 521/568 (91.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   7,  Average loss: 0.0045, Accuracy: 531/568 (93.4859%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   8,  Average loss: 0.0036, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   9,  Average loss: 0.0032, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch  10,  Average loss: 0.0035, Accuracy: 531/568 (93.4859%), train_poison_data_count: 180
Global model norm: 16.63250517124478.
Norm before scaling: 16.80541389062335. Distance: 4.16604240827361
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.4028, Accuracy: 5149/10000 (51.4900%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0428, Accuracy: 8952/8968 (99.8216%)
Scaling by  100
Scaled Norm after poisoning: 415.54578192420627, distance: 416.6042411570002
Total norm for 4 adversaries is: 415.54578192420627. distance: 416.6042411570002
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 194.0119, Accuracy: 8942/8968 (99.7101%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   1,  Average loss: 0.0242, Accuracy: 328/557 (58.8869%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   2,  Average loss: 0.0093, Accuracy: 436/557 (78.2765%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   3,  Average loss: 0.0040, Accuracy: 520/557 (93.3573%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   4,  Average loss: 0.0037, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   5,  Average loss: 0.0027, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   7,  Average loss: 0.0025, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   8,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.63250517124478.
Norm before scaling: 17.005222191641877. Distance: 4.56051362574871
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.6162, Accuracy: 8008/10000 (80.0800%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0896, Accuracy: 8614/8968 (96.0526%)
Scaling by  100
Scaled Norm after poisoning: 455.448559801214, distance: 456.05136086848813
Total norm for 4 adversaries is: 455.448559801214. distance: 456.05136086848813
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  30, local model 4, internal_epoch   1,  Average loss: 0.0018, Accuracy: 635/658 (96.5046%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3088, Accuracy: 8899/10000 (88.9900%)
___Train Local_Simple,  epoch  30, local model 24, internal_epoch   1,  Average loss: 0.0019, Accuracy: 364/379 (96.0422%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1780, Accuracy: 9431/10000 (94.3100%)
___Train Local_Simple,  epoch  30, local model 38, internal_epoch   1,  Average loss: 0.0021, Accuracy: 862/895 (96.3128%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.4684, Accuracy: 8529/10000 (85.2900%)
___Train Local_Simple,  epoch  30, local model 54, internal_epoch   1,  Average loss: 0.0016, Accuracy: 501/519 (96.5318%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.8843, Accuracy: 7952/10000 (79.5200%)
___Train Local_Simple,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0017, Accuracy: 862/892 (96.6368%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2351, Accuracy: 9191/10000 (91.9100%)
___Train Local_Simple,  epoch  30, local model 11, internal_epoch   1,  Average loss: 0.0019, Accuracy: 625/645 (96.8992%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1631, Accuracy: 9470/10000 (94.7000%)
time spent on training: 82.03617334365845
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.36798732171156895  data num: [606, 591, 568, 557, 658, 379, 895, 519, 892, 645]
[foolsgold agg] considering poison per batch poison_fraction: 0.1149960380348653
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 0.0854, Accuracy: 9740/10000 (97.4000%)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 10.6758, Accuracy: 69/8968 (0.7694%)
Done in 98.42944478988647 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:31 choose agents : [41, 73, 51, 74, 80, 7, 72, 14, 99, 12]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   1,  Average loss: 0.0232, Accuracy: 346/606 (57.0957%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   2,  Average loss: 0.0160, Accuracy: 335/606 (55.2805%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   3,  Average loss: 0.0119, Accuracy: 388/606 (64.0264%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   4,  Average loss: 0.0115, Accuracy: 403/606 (66.5017%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   5,  Average loss: 0.0108, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   6,  Average loss: 0.0106, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   7,  Average loss: 0.0103, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   8,  Average loss: 0.0106, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   9,  Average loss: 0.0101, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch  10,  Average loss: 0.0101, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Global model norm: 16.63978504335505.
Norm before scaling: 16.87451713718888. Distance: 4.725070989166315
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.3386, Accuracy: 5699/10000 (56.9900%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.9062, Accuracy: 4778/8968 (53.2783%)
Scaling by  100
Scaled Norm after poisoning: 471.2683683422854, distance: 472.5071097348695
Total norm for 4 adversaries is: 471.2683683422854. distance: 472.5071097348695
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 14138.5284, Accuracy: 2150/8968 (23.9741%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   1,  Average loss: 0.0236, Accuracy: 347/591 (58.7140%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   2,  Average loss: 0.0205, Accuracy: 315/591 (53.2995%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   3,  Average loss: 0.0172, Accuracy: 291/591 (49.2386%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   4,  Average loss: 0.0128, Accuracy: 392/591 (66.3283%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   5,  Average loss: 0.0110, Accuracy: 473/591 (80.0338%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   6,  Average loss: 0.0086, Accuracy: 498/591 (84.2640%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   7,  Average loss: 0.0058, Accuracy: 525/591 (88.8325%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   8,  Average loss: 0.0044, Accuracy: 535/591 (90.5245%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   9,  Average loss: 0.0039, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch  10,  Average loss: 0.0036, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Global model norm: 16.63978504335505.
Norm before scaling: 16.92307965472006. Distance: 4.383926875513951
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.9823, Accuracy: 6777/10000 (67.7700%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.2077, Accuracy: 8399/8968 (93.6552%)
Scaling by  100
Scaled Norm after poisoning: 437.60025636989747, distance: 438.3926785713922
Total norm for 4 adversaries is: 437.60025636989747. distance: 438.3926785713922
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   1,  Average loss: 0.0222, Accuracy: 340/568 (59.8592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   2,  Average loss: 0.0122, Accuracy: 351/568 (61.7958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   3,  Average loss: 0.0103, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   4,  Average loss: 0.0090, Accuracy: 432/568 (76.0563%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   5,  Average loss: 0.0073, Accuracy: 487/568 (85.7394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   6,  Average loss: 0.0060, Accuracy: 512/568 (90.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   7,  Average loss: 0.0049, Accuracy: 526/568 (92.6056%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   8,  Average loss: 0.0034, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   9,  Average loss: 0.0033, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch  10,  Average loss: 0.0033, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Global model norm: 16.63978504335505.
Norm before scaling: 16.867281582646363. Distance: 4.485789006299026
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.4034, Accuracy: 5033/10000 (50.3300%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0792, Accuracy: 8741/8968 (97.4688%)
Scaling by  100
Scaled Norm after poisoning: 447.49298178854156, distance: 448.5789193386154
Total norm for 4 adversaries is: 447.49298178854156. distance: 448.5789193386154
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 1082.7066, Accuracy: 8817/8968 (98.3162%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0204, Accuracy: 362/557 (64.9910%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   2,  Average loss: 0.0089, Accuracy: 429/557 (77.0197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   3,  Average loss: 0.0041, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   4,  Average loss: 0.0036, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   5,  Average loss: 0.0028, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   6,  Average loss: 0.0028, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   7,  Average loss: 0.0019, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   8,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   9,  Average loss: 0.0022, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch  10,  Average loss: 0.0023, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Global model norm: 16.63978504335505.
Norm before scaling: 16.90267912265501. Distance: 3.9315338954092653
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.6321, Accuracy: 8036/10000 (80.3600%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0916, Accuracy: 8595/8968 (95.8408%)
Scaling by  100
Scaled Norm after poisoning: 392.6609343632239, distance: 393.1534170969394
Total norm for 4 adversaries is: 392.6609343632239. distance: 393.1534170969394
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  31, local model 80, internal_epoch   1,  Average loss: 0.0008, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1880, Accuracy: 9453/10000 (94.5300%)
___Train Local_Simple,  epoch  31, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 411/418 (98.3254%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1614, Accuracy: 9489/10000 (94.8900%)
___Train Local_Simple,  epoch  31, local model 72, internal_epoch   1,  Average loss: 0.0006, Accuracy: 722/731 (98.7688%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1885, Accuracy: 9396/10000 (93.9600%)
___Train Local_Simple,  epoch  31, local model 14, internal_epoch   1,  Average loss: 0.0019, Accuracy: 363/376 (96.5426%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2582, Accuracy: 9207/10000 (92.0700%)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: 0.0009, Accuracy: 373/377 (98.9390%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1017, Accuracy: 9696/10000 (96.9600%)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1123/1160 (96.8103%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3760, Accuracy: 8806/10000 (88.0600%)
time spent on training: 86.3884584903717
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3993121238177128  data num: [606, 591, 568, 557, 431, 418, 731, 376, 377, 1160]
[foolsgold agg] considering poison per batch poison_fraction: 0.12478503869303526
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.0858, Accuracy: 9737/10000 (97.3700%)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 10.6962, Accuracy: 68/8968 (0.7583%)
Done in 99.4668185710907 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:32 choose agents : [41, 73, 51, 74, 93, 25, 34, 57, 69, 58]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   1,  Average loss: 0.0207, Accuracy: 370/606 (61.0561%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   2,  Average loss: 0.0145, Accuracy: 355/606 (58.5809%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   3,  Average loss: 0.0117, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   4,  Average loss: 0.0116, Accuracy: 384/606 (63.3663%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   5,  Average loss: 0.0107, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   6,  Average loss: 0.0105, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   7,  Average loss: 0.0103, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   9,  Average loss: 0.0097, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch  10,  Average loss: 0.0101, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Global model norm: 16.64713964321743.
Norm before scaling: 16.80939213839989. Distance: 4.113642692082058
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.1645, Accuracy: 5907/10000 (59.0700%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.9453, Accuracy: 4697/8968 (52.3751%)
Scaling by  100
Scaled Norm after poisoning: 410.30270837517025, distance: 411.36426983878897
Total norm for 4 adversaries is: 410.30270837517025. distance: 411.36426983878897
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 399.7983, Accuracy: 4642/8968 (51.7618%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   1,  Average loss: 0.0224, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   2,  Average loss: 0.0213, Accuracy: 296/591 (50.0846%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   3,  Average loss: 0.0188, Accuracy: 242/591 (40.9475%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   4,  Average loss: 0.0138, Accuracy: 379/591 (64.1286%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   5,  Average loss: 0.0104, Accuracy: 457/591 (77.3266%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   6,  Average loss: 0.0079, Accuracy: 507/591 (85.7868%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   7,  Average loss: 0.0057, Accuracy: 529/591 (89.5093%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   8,  Average loss: 0.0043, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   9,  Average loss: 0.0038, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch  10,  Average loss: 0.0037, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Global model norm: 16.64713964321743.
Norm before scaling: 16.90343018882373. Distance: 4.26937734705174
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.9674, Accuracy: 6579/10000 (65.7900%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.1274, Accuracy: 8662/8968 (96.5879%)
Scaling by  100
Scaled Norm after poisoning: 426.13389181101286, distance: 426.9377516102318
Total norm for 4 adversaries is: 426.13389181101286. distance: 426.9377516102318
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   1,  Average loss: 0.0229, Accuracy: 330/568 (58.0986%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   2,  Average loss: 0.0131, Accuracy: 348/568 (61.2676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   3,  Average loss: 0.0099, Accuracy: 449/568 (79.0493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   4,  Average loss: 0.0077, Accuracy: 462/568 (81.3380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   5,  Average loss: 0.0068, Accuracy: 499/568 (87.8521%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   6,  Average loss: 0.0058, Accuracy: 519/568 (91.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   7,  Average loss: 0.0044, Accuracy: 534/568 (94.0141%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   8,  Average loss: 0.0035, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   9,  Average loss: 0.0030, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch  10,  Average loss: 0.0032, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Global model norm: 16.64713964321743.
Norm before scaling: 16.965289414621697. Distance: 4.906717460376327
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.2887, Accuracy: 5475/10000 (54.7500%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0655, Accuracy: 8890/8968 (99.1302%)
Scaling by  100
Scaled Norm after poisoning: 489.5893049281203, distance: 490.67176528714185
Total norm for 4 adversaries is: 489.5893049281203. distance: 490.67176528714185
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 6806.5624, Accuracy: 8594/8968 (95.8296%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   1,  Average loss: 0.0223, Accuracy: 334/557 (59.9641%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   2,  Average loss: 0.0084, Accuracy: 444/557 (79.7127%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   3,  Average loss: 0.0045, Accuracy: 510/557 (91.5619%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   4,  Average loss: 0.0031, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   5,  Average loss: 0.0030, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   6,  Average loss: 0.0023, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   7,  Average loss: 0.0022, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   8,  Average loss: 0.0022, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   9,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch  10,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Global model norm: 16.64713964321743.
Norm before scaling: 16.957046997372323. Distance: 4.215754597045441
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6999, Accuracy: 7832/10000 (78.3200%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0560, Accuracy: 8749/8968 (97.5580%)
Scaling by  100
Scaled Norm after poisoning: 421.0310447282955, distance: 421.57546773976304
Total norm for 4 adversaries is: 421.0310447282955. distance: 421.57546773976304
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 617/623 (99.0369%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3209, Accuracy: 8989/10000 (89.8900%)
___Train Local_Simple,  epoch  32, local model 25, internal_epoch   1,  Average loss: 0.0017, Accuracy: 620/647 (95.8269%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5634, Accuracy: 8194/10000 (81.9400%)
___Train Local_Simple,  epoch  32, local model 34, internal_epoch   1,  Average loss: 0.0006, Accuracy: 403/413 (97.5787%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3015, Accuracy: 9200/10000 (92.0000%)
___Train Local_Simple,  epoch  32, local model 57, internal_epoch   1,  Average loss: 0.0026, Accuracy: 327/343 (95.3353%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2739, Accuracy: 9235/10000 (92.3500%)
___Train Local_Simple,  epoch  32, local model 69, internal_epoch   1,  Average loss: 0.0023, Accuracy: 243/256 (94.9219%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2737, Accuracy: 9192/10000 (91.9200%)
___Train Local_Simple,  epoch  32, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 269/276 (97.4638%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1918, Accuracy: 9413/10000 (94.1300%)
time spent on training: 76.85695123672485
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.47581967213114756  data num: [606, 591, 568, 557, 623, 647, 413, 343, 256, 276]
[foolsgold agg] considering poison per batch poison_fraction: 0.1486936475409836
[foolsgold agg] wv: [1.         1.         0.88409836 0.88409836 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.0864, Accuracy: 9735/10000 (97.3500%)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 10.7177, Accuracy: 68/8968 (0.7583%)
Done in 92.81103563308716 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:33 choose agents : [41, 73, 51, 74, 2, 4, 1, 20, 49, 57]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   1,  Average loss: 0.0211, Accuracy: 373/606 (61.5512%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   2,  Average loss: 0.0139, Accuracy: 354/606 (58.4158%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   3,  Average loss: 0.0107, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   4,  Average loss: 0.0110, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   5,  Average loss: 0.0107, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   6,  Average loss: 0.0102, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   7,  Average loss: 0.0103, Accuracy: 404/606 (66.6667%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   8,  Average loss: 0.0104, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   9,  Average loss: 0.0099, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 433/606 (71.4521%), train_poison_data_count: 200
Global model norm: 16.654203307062417.
Norm before scaling: 16.84906137268854. Distance: 4.405710606668013
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.2440, Accuracy: 6074/10000 (60.7400%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.9905, Accuracy: 4325/8968 (48.2270%)
Scaling by  100
Scaled Norm after poisoning: 439.4223480889428, distance: 440.571025062929
Total norm for 4 adversaries is: 439.4223480889428. distance: 440.571025062929
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 3161.1110, Accuracy: 1376/8968 (15.3434%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   1,  Average loss: 0.0228, Accuracy: 361/591 (61.0829%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   2,  Average loss: 0.0198, Accuracy: 321/591 (54.3147%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   3,  Average loss: 0.0153, Accuracy: 307/591 (51.9459%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   4,  Average loss: 0.0098, Accuracy: 428/591 (72.4196%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   5,  Average loss: 0.0073, Accuracy: 497/591 (84.0948%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   6,  Average loss: 0.0054, Accuracy: 519/591 (87.8173%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   7,  Average loss: 0.0043, Accuracy: 540/591 (91.3706%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   8,  Average loss: 0.0036, Accuracy: 557/591 (94.2470%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   9,  Average loss: 0.0029, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch  10,  Average loss: 0.0031, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Global model norm: 16.654203307062417.
Norm before scaling: 16.880363007750677. Distance: 4.183610618692649
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.8841, Accuracy: 6951/10000 (69.5100%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.1274, Accuracy: 8580/8968 (95.6735%)
Scaling by  100
Scaled Norm after poisoning: 417.50628737780704, distance: 418.3610693826566
Total norm for 4 adversaries is: 417.50628737780704. distance: 418.3610693826566
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   1,  Average loss: 0.0210, Accuracy: 347/568 (61.0915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   2,  Average loss: 0.0120, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   3,  Average loss: 0.0081, Accuracy: 452/568 (79.5775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   4,  Average loss: 0.0066, Accuracy: 491/568 (86.4437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   5,  Average loss: 0.0047, Accuracy: 532/568 (93.6620%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   6,  Average loss: 0.0042, Accuracy: 531/568 (93.4859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   7,  Average loss: 0.0035, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   8,  Average loss: 0.0027, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   9,  Average loss: 0.0027, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch  10,  Average loss: 0.0026, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Global model norm: 16.654203307062417.
Norm before scaling: 16.852885357500266. Distance: 4.226422376301885
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.1521, Accuracy: 5956/10000 (59.5600%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0458, Accuracy: 8881/8968 (99.0299%)
Scaling by  100
Scaled Norm after poisoning: 421.6435846778651, distance: 422.642283734129
Total norm for 4 adversaries is: 421.6435846778651. distance: 422.642283734129
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 63026.6001, Accuracy: 5288/8968 (58.9652%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   1,  Average loss: 0.0211, Accuracy: 334/557 (59.9641%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   2,  Average loss: 0.0085, Accuracy: 446/557 (80.0718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   3,  Average loss: 0.0039, Accuracy: 515/557 (92.4596%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   4,  Average loss: 0.0040, Accuracy: 510/557 (91.5619%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   5,  Average loss: 0.0032, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   6,  Average loss: 0.0027, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   7,  Average loss: 0.0022, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   8,  Average loss: 0.0019, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   9,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch  10,  Average loss: 0.0021, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Global model norm: 16.654203307062417.
Norm before scaling: 16.99500964351604. Distance: 4.409195368708272
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.6709, Accuracy: 7956/10000 (79.5600%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0539, Accuracy: 8772/8968 (97.8145%)
Scaling by  100
Scaled Norm after poisoning: 440.3295108495455, distance: 440.9195646600409
Total norm for 4 adversaries is: 440.3295108495455. distance: 440.9195646600409
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  33, local model 2, internal_epoch   1,  Average loss: 0.0015, Accuracy: 537/548 (97.9927%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1567, Accuracy: 9504/10000 (95.0400%)
___Train Local_Simple,  epoch  33, local model 4, internal_epoch   1,  Average loss: 0.0019, Accuracy: 640/658 (97.2644%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2731, Accuracy: 9068/10000 (90.6800%)
___Train Local_Simple,  epoch  33, local model 1, internal_epoch   1,  Average loss: 0.0019, Accuracy: 732/760 (96.3158%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2409, Accuracy: 9117/10000 (91.1700%)
___Train Local_Simple,  epoch  33, local model 20, internal_epoch   1,  Average loss: 0.0015, Accuracy: 419/429 (97.6690%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.4955, Accuracy: 8587/10000 (85.8700%)
___Train Local_Simple,  epoch  33, local model 49, internal_epoch   1,  Average loss: 0.0010, Accuracy: 496/506 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2209, Accuracy: 9354/10000 (93.5400%)
___Train Local_Simple,  epoch  33, local model 57, internal_epoch   1,  Average loss: 0.0021, Accuracy: 328/343 (95.6268%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3906, Accuracy: 8952/10000 (89.5200%)
time spent on training: 81.8257188796997
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41717570966582823  data num: [606, 591, 568, 557, 548, 658, 760, 429, 506, 343]
[foolsgold agg] considering poison per batch poison_fraction: 0.13036740927057133
[foolsgold agg] wv: [1.         1.         0.95472873 0.95472873 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.0868, Accuracy: 9733/10000 (97.3300%)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 10.6649, Accuracy: 68/8968 (0.7583%)
Done in 95.51176333427429 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:34 choose agents : [41, 73, 51, 74, 27, 43, 49, 0, 45, 25]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0224, Accuracy: 349/606 (57.5908%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   2,  Average loss: 0.0158, Accuracy: 335/606 (55.2805%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   3,  Average loss: 0.0119, Accuracy: 398/606 (65.6766%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   4,  Average loss: 0.0116, Accuracy: 400/606 (66.0066%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   5,  Average loss: 0.0108, Accuracy: 404/606 (66.6667%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   6,  Average loss: 0.0107, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   7,  Average loss: 0.0101, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   8,  Average loss: 0.0103, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch  10,  Average loss: 0.0106, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Global model norm: 16.660415901405717.
Norm before scaling: 16.928882616711316. Distance: 4.729377753074331
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.2759, Accuracy: 5787/10000 (57.8700%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.9142, Accuracy: 4893/8968 (54.5607%)
Scaling by  100
Scaled Norm after poisoning: 471.8185562268614, distance: 472.93777669477834
Total norm for 4 adversaries is: 471.8185562268614. distance: 472.93777669477834
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 3954.9981, Accuracy: 1308/8968 (14.5852%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   1,  Average loss: 0.0245, Accuracy: 337/591 (57.0220%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   2,  Average loss: 0.0186, Accuracy: 332/591 (56.1760%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   3,  Average loss: 0.0135, Accuracy: 368/591 (62.2673%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   4,  Average loss: 0.0088, Accuracy: 481/591 (81.3875%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   5,  Average loss: 0.0070, Accuracy: 509/591 (86.1252%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   6,  Average loss: 0.0055, Accuracy: 524/591 (88.6633%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   7,  Average loss: 0.0045, Accuracy: 534/591 (90.3553%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   8,  Average loss: 0.0042, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   9,  Average loss: 0.0041, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch  10,  Average loss: 0.0039, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Global model norm: 16.660415901405717.
Norm before scaling: 16.86345724297206. Distance: 4.370723923488699
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.2068, Accuracy: 5414/10000 (54.1400%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0858, Accuracy: 8755/8968 (97.6249%)
Scaling by  100
Scaled Norm after poisoning: 435.98190186061623, distance: 437.072398179066
Total norm for 4 adversaries is: 435.98190186061623. distance: 437.072398179066
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   1,  Average loss: 0.0208, Accuracy: 352/568 (61.9718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   2,  Average loss: 0.0115, Accuracy: 372/568 (65.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   3,  Average loss: 0.0076, Accuracy: 489/568 (86.0915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   4,  Average loss: 0.0054, Accuracy: 522/568 (91.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   5,  Average loss: 0.0045, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   6,  Average loss: 0.0037, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   7,  Average loss: 0.0033, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   8,  Average loss: 0.0025, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   9,  Average loss: 0.0027, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch  10,  Average loss: 0.0026, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Global model norm: 16.660415901405717.
Norm before scaling: 16.87655519454059. Distance: 4.228078517390465
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.2025, Accuracy: 5572/10000 (55.7200%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0350, Accuracy: 8940/8968 (99.6878%)
Scaling by  100
Scaled Norm after poisoning: 421.8782407282935, distance: 422.80785751331535
Total norm for 4 adversaries is: 421.8782407282935. distance: 422.80785751331535
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 8157.3524, Accuracy: 6895/8968 (76.8845%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   1,  Average loss: 0.0187, Accuracy: 378/557 (67.8636%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   2,  Average loss: 0.0062, Accuracy: 475/557 (85.2783%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   3,  Average loss: 0.0045, Accuracy: 504/557 (90.4847%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   4,  Average loss: 0.0026, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   5,  Average loss: 0.0028, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   6,  Average loss: 0.0022, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   7,  Average loss: 0.0022, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   8,  Average loss: 0.0019, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch  10,  Average loss: 0.0020, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Global model norm: 16.660415901405717.
Norm before scaling: 16.90830498861109. Distance: 3.7464067409897055
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.5663, Accuracy: 8175/10000 (81.7500%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0502, Accuracy: 8788/8968 (97.9929%)
Scaling by  100
Scaled Norm after poisoning: 374.2482882392383, distance: 374.64066116747125
Total norm for 4 adversaries is: 374.2482882392383. distance: 374.64066116747125
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  34, local model 27, internal_epoch   1,  Average loss: 0.0015, Accuracy: 452/471 (95.9660%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2749, Accuracy: 9256/10000 (92.5600%)
___Train Local_Simple,  epoch  34, local model 43, internal_epoch   1,  Average loss: 0.0014, Accuracy: 397/408 (97.3039%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2085, Accuracy: 9367/10000 (93.6700%)
___Train Local_Simple,  epoch  34, local model 49, internal_epoch   1,  Average loss: 0.0011, Accuracy: 491/506 (97.0356%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1765, Accuracy: 9484/10000 (94.8400%)
___Train Local_Simple,  epoch  34, local model 0, internal_epoch   1,  Average loss: 0.0021, Accuracy: 419/435 (96.3218%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2541, Accuracy: 9244/10000 (92.4400%)
___Train Local_Simple,  epoch  34, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 612/628 (97.4522%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.4797, Accuracy: 8523/10000 (85.2300%)
___Train Local_Simple,  epoch  34, local model 25, internal_epoch   1,  Average loss: 0.0018, Accuracy: 624/647 (96.4451%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.6373, Accuracy: 8221/10000 (82.2100%)
time spent on training: 76.94763159751892
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4286505445818719  data num: [606, 591, 568, 557, 471, 408, 506, 435, 628, 647]
[foolsgold agg] considering poison per batch poison_fraction: 0.13395329518183496
[foolsgold agg] wv: [1.         1.         0.89497058 0.89497058 0.65055971 1.
 0.65055971 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.0871, Accuracy: 9733/10000 (97.3300%)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 10.6421, Accuracy: 69/8968 (0.7694%)
Done in 90.72096657752991 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:35 choose agents : [41, 73, 51, 74, 8, 12, 55, 26, 62, 65]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   1,  Average loss: 0.0195, Accuracy: 381/606 (62.8713%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   2,  Average loss: 0.0147, Accuracy: 371/606 (61.2211%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   3,  Average loss: 0.0118, Accuracy: 392/606 (64.6865%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   4,  Average loss: 0.0115, Accuracy: 388/606 (64.0264%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   5,  Average loss: 0.0111, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   6,  Average loss: 0.0103, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 435/606 (71.7822%), train_poison_data_count: 200
Global model norm: 16.665959661111064.
Norm before scaling: 16.777326924467697. Distance: 3.97110696325481
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.3377, Accuracy: 5640/10000 (56.4000%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.8480, Accuracy: 4912/8968 (54.7725%)
Scaling by  100
Scaled Norm after poisoning: 395.94207278338075, distance: 397.1106977279761
Total norm for 4 adversaries is: 395.94207278338075. distance: 397.1106977279761
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 52890.2452, Accuracy: 184/8968 (2.0517%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   1,  Average loss: 0.0241, Accuracy: 336/591 (56.8528%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   2,  Average loss: 0.0211, Accuracy: 282/591 (47.7157%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   3,  Average loss: 0.0157, Accuracy: 260/591 (43.9932%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   4,  Average loss: 0.0111, Accuracy: 443/591 (74.9577%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   5,  Average loss: 0.0078, Accuracy: 482/591 (81.5567%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   6,  Average loss: 0.0063, Accuracy: 516/591 (87.3096%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   7,  Average loss: 0.0046, Accuracy: 548/591 (92.7242%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   8,  Average loss: 0.0043, Accuracy: 550/591 (93.0626%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   9,  Average loss: 0.0035, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch  10,  Average loss: 0.0034, Accuracy: 564/591 (95.4315%), train_poison_data_count: 195
Global model norm: 16.665959661111064.
Norm before scaling: 16.85271785561883. Distance: 4.262708400430939
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.9542, Accuracy: 7008/10000 (70.0800%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1409, Accuracy: 8587/8968 (95.7516%)
Scaling by  100
Scaled Norm after poisoning: 425.1982074574163, distance: 426.270838933418
Total norm for 4 adversaries is: 425.1982074574163. distance: 426.270838933418
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 90.2738, Accuracy: 8963/8968 (99.9442%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   1,  Average loss: 0.0205, Accuracy: 353/568 (62.1479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   2,  Average loss: 0.0103, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   3,  Average loss: 0.0070, Accuracy: 480/568 (84.5070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   4,  Average loss: 0.0054, Accuracy: 513/568 (90.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   5,  Average loss: 0.0045, Accuracy: 527/568 (92.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   6,  Average loss: 0.0029, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   7,  Average loss: 0.0027, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   8,  Average loss: 0.0022, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   9,  Average loss: 0.0020, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch  10,  Average loss: 0.0021, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Global model norm: 16.665959661111064.
Norm before scaling: 16.90528424055349. Distance: 4.168511681557606
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.0575, Accuracy: 6511/10000 (65.1100%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0625, Accuracy: 8767/8968 (97.7587%)
Scaling by  100
Scaled Norm after poisoning: 416.0630398449254, distance: 416.85116123743734
Total norm for 4 adversaries is: 416.0630398449254. distance: 416.85116123743734
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   1,  Average loss: 0.0219, Accuracy: 328/557 (58.8869%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   2,  Average loss: 0.0087, Accuracy: 452/557 (81.1490%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   3,  Average loss: 0.0043, Accuracy: 506/557 (90.8438%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   4,  Average loss: 0.0030, Accuracy: 515/557 (92.4596%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   5,  Average loss: 0.0029, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   6,  Average loss: 0.0024, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   7,  Average loss: 0.0021, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   9,  Average loss: 0.0019, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Global model norm: 16.665959661111064.
Norm before scaling: 16.975373326102343. Distance: 4.2873542872099595
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.5980, Accuracy: 8070/10000 (80.7000%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0554, Accuracy: 8742/8968 (97.4799%)
Scaling by  100
Scaled Norm after poisoning: 428.1291788117227, distance: 428.735422492707
Total norm for 4 adversaries is: 428.1291788117227. distance: 428.735422492707
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.0024, Accuracy: 605/633 (95.5766%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2309, Accuracy: 9294/10000 (92.9400%)
___Train Local_Simple,  epoch  35, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1135/1160 (97.8448%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3309, Accuracy: 8904/10000 (89.0400%)
___Train Local_Simple,  epoch  35, local model 55, internal_epoch   1,  Average loss: 0.0018, Accuracy: 344/354 (97.1751%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3346, Accuracy: 9013/10000 (90.1300%)
___Train Local_Simple,  epoch  35, local model 26, internal_epoch   1,  Average loss: 0.0014, Accuracy: 541/554 (97.6534%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1241, Accuracy: 9628/10000 (96.2800%)
___Train Local_Simple,  epoch  35, local model 62, internal_epoch   1,  Average loss: 0.0008, Accuracy: 416/423 (98.3452%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1459, Accuracy: 9563/10000 (95.6300%)
___Train Local_Simple,  epoch  35, local model 65, internal_epoch   1,  Average loss: 0.0011, Accuracy: 361/371 (97.3046%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1767, Accuracy: 9415/10000 (94.1500%)
time spent on training: 85.6412444114685
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3991748323878288  data num: [606, 591, 568, 557, 633, 1160, 354, 554, 423, 371]
[foolsgold agg] considering poison per batch poison_fraction: 0.1247421351211965
[foolsgold agg] wv: [1.         1.         0.87958695 0.87958695 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.0877, Accuracy: 9731/10000 (97.3100%)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 10.6763, Accuracy: 68/8968 (0.7583%)
Done in 99.11778926849365 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:36 choose agents : [41, 73, 51, 74, 54, 94, 68, 33, 58, 10]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   1,  Average loss: 0.0202, Accuracy: 376/606 (62.0462%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   2,  Average loss: 0.0138, Accuracy: 366/606 (60.3960%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   3,  Average loss: 0.0121, Accuracy: 390/606 (64.3564%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   4,  Average loss: 0.0111, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   5,  Average loss: 0.0105, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   6,  Average loss: 0.0102, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   8,  Average loss: 0.0104, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   9,  Average loss: 0.0102, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Global model norm: 16.672591618560592.
Norm before scaling: 16.77119221115761. Distance: 3.9215582609507105
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.2108, Accuracy: 6083/10000 (60.8300%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.9092, Accuracy: 4798/8968 (53.5013%)
Scaling by  100
Scaled Norm after poisoning: 390.9681093132789, distance: 392.15582043366385
Total norm for 4 adversaries is: 390.9681093132789. distance: 392.15582043366385
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 74.0453, Accuracy: 8813/8968 (98.2716%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   1,  Average loss: 0.0224, Accuracy: 341/591 (57.6988%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   2,  Average loss: 0.0165, Accuracy: 349/591 (59.0525%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   3,  Average loss: 0.0115, Accuracy: 389/591 (65.8206%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   4,  Average loss: 0.0059, Accuracy: 520/591 (87.9865%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   5,  Average loss: 0.0050, Accuracy: 537/591 (90.8629%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   6,  Average loss: 0.0041, Accuracy: 543/591 (91.8782%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   7,  Average loss: 0.0034, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   8,  Average loss: 0.0027, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   9,  Average loss: 0.0025, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch  10,  Average loss: 0.0023, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Global model norm: 16.672591618560592.
Norm before scaling: 16.91019279491893. Distance: 4.064733038250017
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.7212, Accuracy: 7807/10000 (78.0700%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.1150, Accuracy: 8562/8968 (95.4728%)
Scaling by  100
Scaled Norm after poisoning: 405.76380521801104, distance: 406.47332323290294
Total norm for 4 adversaries is: 405.76380521801104. distance: 406.47332323290294
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   1,  Average loss: 0.0200, Accuracy: 352/568 (61.9718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   2,  Average loss: 0.0105, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   3,  Average loss: 0.0077, Accuracy: 473/568 (83.2746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   4,  Average loss: 0.0064, Accuracy: 487/568 (85.7394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   5,  Average loss: 0.0040, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   6,  Average loss: 0.0031, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   7,  Average loss: 0.0032, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   8,  Average loss: 0.0024, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   9,  Average loss: 0.0023, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch  10,  Average loss: 0.0024, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Global model norm: 16.672591618560592.
Norm before scaling: 16.880917112195892. Distance: 4.096335490047353
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.2345, Accuracy: 5945/10000 (59.4500%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0608, Accuracy: 8778/8968 (97.8814%)
Scaling by  100
Scaled Norm after poisoning: 408.7769868767076, distance: 409.6335443112539
Total norm for 4 adversaries is: 408.7769868767076. distance: 409.6335443112539
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 49.3242, Accuracy: 8957/8968 (99.8773%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   1,  Average loss: 0.0194, Accuracy: 373/557 (66.9659%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   2,  Average loss: 0.0060, Accuracy: 485/557 (87.0736%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   3,  Average loss: 0.0030, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   4,  Average loss: 0.0022, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   5,  Average loss: 0.0023, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   6,  Average loss: 0.0018, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   7,  Average loss: 0.0021, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch  10,  Average loss: 0.0019, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Global model norm: 16.672591618560592.
Norm before scaling: 16.97478634864166. Distance: 4.005446778712049
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.5603, Accuracy: 8234/10000 (82.3400%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0569, Accuracy: 8744/8968 (97.5022%)
Scaling by  100
Scaled Norm after poisoning: 400.15803518734947, distance: 400.54466823314476
Total norm for 4 adversaries is: 400.15803518734947. distance: 400.54466823314476
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  36, local model 54, internal_epoch   1,  Average loss: 0.0024, Accuracy: 500/519 (96.3391%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2853, Accuracy: 9111/10000 (91.1100%)
___Train Local_Simple,  epoch  36, local model 94, internal_epoch   1,  Average loss: 0.0025, Accuracy: 143/150 (95.3333%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1351, Accuracy: 9602/10000 (96.0200%)
___Train Local_Simple,  epoch  36, local model 68, internal_epoch   1,  Average loss: 0.0017, Accuracy: 477/494 (96.5587%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1624, Accuracy: 9475/10000 (94.7500%)
___Train Local_Simple,  epoch  36, local model 33, internal_epoch   1,  Average loss: 0.0017, Accuracy: 605/623 (97.1108%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1439, Accuracy: 9539/10000 (95.3900%)
___Train Local_Simple,  epoch  36, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 263/276 (95.2899%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1308, Accuracy: 9594/10000 (95.9400%)
___Train Local_Simple,  epoch  36, local model 10, internal_epoch   1,  Average loss: 0.0015, Accuracy: 869/892 (97.4215%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6622, Accuracy: 8174/10000 (81.7400%)
time spent on training: 80.16524267196655
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.44010614101592116  data num: [606, 591, 568, 557, 519, 150, 494, 623, 276, 892]
[foolsgold agg] considering poison per batch poison_fraction: 0.13753316906747537
[foolsgold agg] wv: [1.         1.         0.98418427 0.98418427 0.98983641 1.
 0.98983641 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.0878, Accuracy: 9732/10000 (97.3200%)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 10.6836, Accuracy: 70/8968 (0.7806%)
Done in 97.60394215583801 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:37 choose agents : [41, 73, 51, 74, 13, 81, 37, 94, 61, 57]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   1,  Average loss: 0.0221, Accuracy: 360/606 (59.4059%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   2,  Average loss: 0.0129, Accuracy: 366/606 (60.3960%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   3,  Average loss: 0.0120, Accuracy: 355/606 (58.5809%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   4,  Average loss: 0.0108, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   5,  Average loss: 0.0109, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   6,  Average loss: 0.0104, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   9,  Average loss: 0.0106, Accuracy: 404/606 (66.6667%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch  10,  Average loss: 0.0103, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Global model norm: 16.67862079434515.
Norm before scaling: 16.98853229364407. Distance: 4.885565434883691
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.1373, Accuracy: 5933/10000 (59.3300%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.9329, Accuracy: 5173/8968 (57.6829%)
Scaling by  100
Scaled Norm after poisoning: 487.46506285066215, distance: 488.55653140143363
Total norm for 4 adversaries is: 487.46506285066215. distance: 488.55653140143363
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 3923.1212, Accuracy: 5397/8968 (60.1806%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   1,  Average loss: 0.0236, Accuracy: 352/591 (59.5601%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   2,  Average loss: 0.0189, Accuracy: 349/591 (59.0525%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   3,  Average loss: 0.0120, Accuracy: 378/591 (63.9594%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   4,  Average loss: 0.0072, Accuracy: 506/591 (85.6176%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   5,  Average loss: 0.0056, Accuracy: 528/591 (89.3401%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   6,  Average loss: 0.0051, Accuracy: 534/591 (90.3553%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   7,  Average loss: 0.0045, Accuracy: 545/591 (92.2166%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   8,  Average loss: 0.0041, Accuracy: 547/591 (92.5550%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   9,  Average loss: 0.0038, Accuracy: 547/591 (92.5550%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch  10,  Average loss: 0.0038, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Global model norm: 16.67862079434515.
Norm before scaling: 16.948869893707606. Distance: 4.599557954861201
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.1478, Accuracy: 6290/10000 (62.9000%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.1313, Accuracy: 8565/8968 (95.5062%)
Scaling by  100
Scaled Norm after poisoning: 458.9451900826503, distance: 459.9557723303405
Total norm for 4 adversaries is: 458.9451900826503. distance: 459.9557723303405
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   1,  Average loss: 0.0207, Accuracy: 354/568 (62.3239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   2,  Average loss: 0.0100, Accuracy: 428/568 (75.3521%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   3,  Average loss: 0.0063, Accuracy: 505/568 (88.9085%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   4,  Average loss: 0.0045, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   5,  Average loss: 0.0035, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   6,  Average loss: 0.0033, Accuracy: 533/568 (93.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   7,  Average loss: 0.0027, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   8,  Average loss: 0.0023, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   9,  Average loss: 0.0016, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch  10,  Average loss: 0.0016, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Global model norm: 16.67862079434515.
Norm before scaling: 16.96051826117056. Distance: 4.451653916828536
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.9188, Accuracy: 6685/10000 (66.8500%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0480, Accuracy: 8820/8968 (98.3497%)
Scaling by  100
Scaled Norm after poisoning: 444.31625842410944, distance: 445.1653660439006
Total norm for 4 adversaries is: 444.31625842410944. distance: 445.1653660439006
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   1,  Average loss: 0.0182, Accuracy: 394/557 (70.7361%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   2,  Average loss: 0.0063, Accuracy: 479/557 (85.9964%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   3,  Average loss: 0.0032, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   4,  Average loss: 0.0030, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   5,  Average loss: 0.0022, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   7,  Average loss: 0.0016, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   8,  Average loss: 0.0018, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   9,  Average loss: 0.0018, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Global model norm: 16.67862079434515.
Norm before scaling: 16.94363483655763. Distance: 3.7160113853222687
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6044, Accuracy: 8164/10000 (81.6400%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0375, Accuracy: 8840/8968 (98.5727%)
Scaling by  100
Scaled Norm after poisoning: 371.31623988185595, distance: 371.6011386554137
Total norm for 4 adversaries is: 371.31623988185595. distance: 371.6011386554137
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  37, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 709/734 (96.5940%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.3894, Accuracy: 8887/10000 (88.8700%)
___Train Local_Simple,  epoch  37, local model 81, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1192/1227 (97.1475%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4033, Accuracy: 8802/10000 (88.0200%)
___Train Local_Simple,  epoch  37, local model 37, internal_epoch   1,  Average loss: 0.0015, Accuracy: 834/860 (96.9767%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4206, Accuracy: 8885/10000 (88.8500%)
___Train Local_Simple,  epoch  37, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 144/150 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1645, Accuracy: 9513/10000 (95.1300%)
___Train Local_Simple,  epoch  37, local model 61, internal_epoch   1,  Average loss: 0.0016, Accuracy: 679/699 (97.1388%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6219, Accuracy: 8562/10000 (85.6200%)
___Train Local_Simple,  epoch  37, local model 57, internal_epoch   1,  Average loss: 0.0024, Accuracy: 326/343 (95.0437%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.3063, Accuracy: 9164/10000 (91.6400%)
time spent on training: 85.76720333099365
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3665351223362273  data num: [606, 591, 568, 557, 734, 1227, 860, 150, 699, 343]
[foolsgold agg] considering poison per batch poison_fraction: 0.11454222573007103
[foolsgold agg] wv: [1.         1.         0.95874772 0.95874772 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.0882, Accuracy: 9727/10000 (97.2700%)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 10.6224, Accuracy: 70/8968 (0.7806%)
Done in 99.51078248023987 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:38 choose agents : [41, 73, 51, 74, 60, 92, 23, 39, 79, 86]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   1,  Average loss: 0.0209, Accuracy: 369/606 (60.8911%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   2,  Average loss: 0.0159, Accuracy: 330/606 (54.4554%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   3,  Average loss: 0.0108, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   4,  Average loss: 0.0107, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   5,  Average loss: 0.0105, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   6,  Average loss: 0.0105, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   8,  Average loss: 0.0103, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   9,  Average loss: 0.0099, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Global model norm: 16.684235328479808.
Norm before scaling: 16.852275099386155. Distance: 4.2439635547507635
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.2470, Accuracy: 5596/10000 (55.9600%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.8723, Accuracy: 5022/8968 (55.9991%)
Scaling by  100
Scaled Norm after poisoning: 423.26476642876855, distance: 424.39637280495225
Total norm for 4 adversaries is: 423.26476642876855. distance: 424.39637280495225
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   1,  Average loss: 0.0303, Accuracy: 299/591 (50.5922%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   2,  Average loss: 0.0224, Accuracy: 255/591 (43.1472%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   3,  Average loss: 0.0224, Accuracy: 289/591 (48.9002%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   4,  Average loss: 0.0125, Accuracy: 410/591 (69.3739%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   5,  Average loss: 0.0090, Accuracy: 475/591 (80.3723%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   6,  Average loss: 0.0069, Accuracy: 511/591 (86.4636%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   7,  Average loss: 0.0061, Accuracy: 524/591 (88.6633%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   8,  Average loss: 0.0047, Accuracy: 550/591 (93.0626%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   9,  Average loss: 0.0042, Accuracy: 549/591 (92.8934%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch  10,  Average loss: 0.0046, Accuracy: 544/591 (92.0474%), train_poison_data_count: 195
Global model norm: 16.684235328479808.
Norm before scaling: 17.229761607712213. Distance: 5.9178859188716455
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.2532, Accuracy: 5810/10000 (58.1000%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.1851, Accuracy: 8319/8968 (92.7632%)
Scaling by  100
Scaled Norm after poisoning: 590.6268386214768, distance: 591.788602458682
Total norm for 4 adversaries is: 590.6268386214768. distance: 591.788602458682
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   1,  Average loss: 0.0211, Accuracy: 349/568 (61.4437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   2,  Average loss: 0.0105, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   3,  Average loss: 0.0062, Accuracy: 510/568 (89.7887%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   4,  Average loss: 0.0048, Accuracy: 529/568 (93.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   5,  Average loss: 0.0033, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   6,  Average loss: 0.0034, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   7,  Average loss: 0.0027, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   8,  Average loss: 0.0022, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   9,  Average loss: 0.0022, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch  10,  Average loss: 0.0022, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Global model norm: 16.684235328479808.
Norm before scaling: 16.944148148966963. Distance: 4.4070202309819475
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.0502, Accuracy: 6163/10000 (61.6300%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0870, Accuracy: 8713/8968 (97.1566%)
Scaling by  100
Scaled Norm after poisoning: 439.8050704573561, distance: 440.70201454611026
Total norm for 4 adversaries is: 439.8050704573561. distance: 440.70201454611026
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 35411.1743, Accuracy: 6270/8968 (69.9153%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   1,  Average loss: 0.0201, Accuracy: 358/557 (64.2729%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   2,  Average loss: 0.0059, Accuracy: 481/557 (86.3555%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   3,  Average loss: 0.0034, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   4,  Average loss: 0.0026, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   5,  Average loss: 0.0022, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   7,  Average loss: 0.0021, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   8,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   9,  Average loss: 0.0019, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Global model norm: 16.684235328479808.
Norm before scaling: 17.022116243471316. Distance: 4.244351391884627
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6215, Accuracy: 8078/10000 (80.7800%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0496, Accuracy: 8778/8968 (97.8814%)
Scaling by  100
Scaled Norm after poisoning: 423.98227409881184, distance: 424.43510251863006
Total norm for 4 adversaries is: 423.98227409881184. distance: 424.43510251863006
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  38, local model 60, internal_epoch   1,  Average loss: 0.0024, Accuracy: 326/338 (96.4497%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1737, Accuracy: 9475/10000 (94.7500%)
___Train Local_Simple,  epoch  38, local model 92, internal_epoch   1,  Average loss: 0.0015, Accuracy: 907/937 (96.7983%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3794, Accuracy: 8675/10000 (86.7500%)
___Train Local_Simple,  epoch  38, local model 23, internal_epoch   1,  Average loss: 0.0014, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1610, Accuracy: 9455/10000 (94.5500%)
___Train Local_Simple,  epoch  38, local model 39, internal_epoch   1,  Average loss: 0.0012, Accuracy: 253/257 (98.4436%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2010, Accuracy: 9344/10000 (93.4400%)
___Train Local_Simple,  epoch  38, local model 79, internal_epoch   1,  Average loss: 0.0020, Accuracy: 175/182 (96.1538%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1121, Accuracy: 9674/10000 (96.7400%)
___Train Local_Simple,  epoch  38, local model 86, internal_epoch   1,  Average loss: 0.0011, Accuracy: 244/250 (97.6000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1209, Accuracy: 9627/10000 (96.2700%)
time spent on training: 78.23507785797119
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.5070976195675911  data num: [606, 591, 568, 557, 338, 937, 293, 257, 182, 250]
[foolsgold agg] considering poison per batch poison_fraction: 0.15846800611487222
[foolsgold agg] wv: [1.        1.        0.9950018 0.9950018 1.        1.        1.
 1.        1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.0886, Accuracy: 9729/10000 (97.2900%)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 10.5237, Accuracy: 70/8968 (0.7806%)
Done in 95.03151059150696 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:39 choose agents : [41, 73, 51, 74, 63, 99, 97, 37, 44, 52]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   1,  Average loss: 0.0211, Accuracy: 372/606 (61.3861%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   2,  Average loss: 0.0137, Accuracy: 356/606 (58.7459%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   3,  Average loss: 0.0116, Accuracy: 366/606 (60.3960%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   4,  Average loss: 0.0111, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   5,  Average loss: 0.0106, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   6,  Average loss: 0.0104, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   8,  Average loss: 0.0103, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch  10,  Average loss: 0.0103, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Global model norm: 16.689373468395335.
Norm before scaling: 16.817702385444647. Distance: 4.116759420938126
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.1462, Accuracy: 5898/10000 (58.9800%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.9643, Accuracy: 4909/8968 (54.7391%)
Scaling by  100
Scaled Norm after poisoning: 410.4763619868993, distance: 411.6759192617416
Total norm for 4 adversaries is: 410.4763619868993. distance: 411.6759192617416
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 62.8663, Accuracy: 8778/8968 (97.8814%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   1,  Average loss: 0.0233, Accuracy: 337/591 (57.0220%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   2,  Average loss: 0.0151, Accuracy: 370/591 (62.6058%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   3,  Average loss: 0.0067, Accuracy: 495/591 (83.7563%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   4,  Average loss: 0.0056, Accuracy: 535/591 (90.5245%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   5,  Average loss: 0.0043, Accuracy: 551/591 (93.2318%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   6,  Average loss: 0.0040, Accuracy: 553/591 (93.5702%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   7,  Average loss: 0.0035, Accuracy: 553/591 (93.5702%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   8,  Average loss: 0.0030, Accuracy: 557/591 (94.2470%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   9,  Average loss: 0.0029, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch  10,  Average loss: 0.0028, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Global model norm: 16.689373468395335.
Norm before scaling: 16.90993111351054. Distance: 4.254036725357852
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.9208, Accuracy: 6891/10000 (68.9100%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1133, Accuracy: 8611/8968 (96.0192%)
Scaling by  100
Scaled Norm after poisoning: 424.4740127498973, distance: 425.4036685901992
Total norm for 4 adversaries is: 424.4740127498973. distance: 425.4036685901992
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   1,  Average loss: 0.0213, Accuracy: 349/568 (61.4437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   2,  Average loss: 0.0092, Accuracy: 432/568 (76.0563%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   3,  Average loss: 0.0053, Accuracy: 512/568 (90.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   4,  Average loss: 0.0038, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   5,  Average loss: 0.0037, Accuracy: 532/568 (93.6620%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   6,  Average loss: 0.0028, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   7,  Average loss: 0.0026, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   8,  Average loss: 0.0021, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   9,  Average loss: 0.0017, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch  10,  Average loss: 0.0020, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Global model norm: 16.689373468395335.
Norm before scaling: 16.968185274903075. Distance: 4.369082563455292
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.0198, Accuracy: 6366/10000 (63.6600%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0774, Accuracy: 8732/8968 (97.3684%)
Scaling by  100
Scaled Norm after poisoning: 436.11566699672693, distance: 436.9082605364655
Total norm for 4 adversaries is: 436.11566699672693. distance: 436.9082605364655
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 28111.9316, Accuracy: 6687/8968 (74.5651%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   1,  Average loss: 0.0204, Accuracy: 366/557 (65.7092%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   2,  Average loss: 0.0075, Accuracy: 454/557 (81.5081%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   3,  Average loss: 0.0047, Accuracy: 510/557 (91.5619%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   4,  Average loss: 0.0039, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   5,  Average loss: 0.0035, Accuracy: 519/557 (93.1777%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   6,  Average loss: 0.0026, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   7,  Average loss: 0.0025, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   8,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   9,  Average loss: 0.0018, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch  10,  Average loss: 0.0020, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Global model norm: 16.689373468395335.
Norm before scaling: 17.012757843552567. Distance: 4.177266384055412
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6412, Accuracy: 7952/10000 (79.5200%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0629, Accuracy: 8719/8968 (97.2235%)
Scaling by  100
Scaled Norm after poisoning: 417.27566952196, distance: 417.72664132779465
Total norm for 4 adversaries is: 417.27566952196. distance: 417.72664132779465
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  39, local model 63, internal_epoch   1,  Average loss: 0.0024, Accuracy: 847/889 (95.2756%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2132, Accuracy: 9367/10000 (93.6700%)
___Train Local_Simple,  epoch  39, local model 99, internal_epoch   1,  Average loss: 0.0009, Accuracy: 372/377 (98.6737%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1066, Accuracy: 9665/10000 (96.6500%)
___Train Local_Simple,  epoch  39, local model 97, internal_epoch   1,  Average loss: 0.0009, Accuracy: 477/487 (97.9466%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3679, Accuracy: 8960/10000 (89.6000%)
___Train Local_Simple,  epoch  39, local model 37, internal_epoch   1,  Average loss: 0.0019, Accuracy: 832/860 (96.7442%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4287, Accuracy: 8791/10000 (87.9100%)
___Train Local_Simple,  epoch  39, local model 44, internal_epoch   1,  Average loss: 0.0032, Accuracy: 502/517 (97.0986%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1336, Accuracy: 9605/10000 (96.0500%)
___Train Local_Simple,  epoch  39, local model 52, internal_epoch   1,  Average loss: 0.0011, Accuracy: 250/253 (98.8142%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1458, Accuracy: 9557/10000 (95.5700%)
time spent on training: 77.43640875816345
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.407011393514461  data num: [606, 591, 568, 557, 889, 377, 487, 860, 517, 253]
[foolsgold agg] considering poison per batch poison_fraction: 0.12719106047326906
[foolsgold agg] wv: [1.        1.        0.9040845 0.9040845 1.        1.        1.
 1.        1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.0889, Accuracy: 9731/10000 (97.3100%)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 10.5339, Accuracy: 68/8968 (0.7583%)
Done in 94.05374717712402 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:40 choose agents : [41, 73, 51, 74, 88, 25, 28, 8, 16, 6]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   1,  Average loss: 0.0225, Accuracy: 379/606 (62.5413%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   2,  Average loss: 0.0133, Accuracy: 377/606 (62.2112%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   3,  Average loss: 0.0111, Accuracy: 399/606 (65.8416%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   4,  Average loss: 0.0110, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   5,  Average loss: 0.0104, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   6,  Average loss: 0.0106, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   7,  Average loss: 0.0099, Accuracy: 436/606 (71.9472%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   9,  Average loss: 0.0101, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch  10,  Average loss: 0.0101, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Global model norm: 16.694816214254484.
Norm before scaling: 16.927544965660353. Distance: 4.756031222832091
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.2773, Accuracy: 5676/10000 (56.7600%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.7176, Accuracy: 5797/8968 (64.6409%)
Scaling by  100
Scaled Norm after poisoning: 474.3390631974137, distance: 475.6031203903103
Total norm for 4 adversaries is: 474.3390631974137. distance: 475.6031203903103
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 3946.6937, Accuracy: 2045/8968 (22.8033%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   1,  Average loss: 0.0230, Accuracy: 335/591 (56.6836%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   2,  Average loss: 0.0159, Accuracy: 366/591 (61.9289%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   3,  Average loss: 0.0070, Accuracy: 495/591 (83.7563%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   4,  Average loss: 0.0058, Accuracy: 520/591 (87.9865%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   5,  Average loss: 0.0045, Accuracy: 548/591 (92.7242%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   6,  Average loss: 0.0039, Accuracy: 550/591 (93.0626%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   7,  Average loss: 0.0034, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   8,  Average loss: 0.0030, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   9,  Average loss: 0.0026, Accuracy: 557/591 (94.2470%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch  10,  Average loss: 0.0028, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Global model norm: 16.694816214254484.
Norm before scaling: 16.91388658251473. Distance: 4.198710679656311
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.9312, Accuracy: 6494/10000 (64.9400%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.1153, Accuracy: 8547/8968 (95.3055%)
Scaling by  100
Scaled Norm after poisoning: 418.97945206179264, distance: 419.8710739619961
Total norm for 4 adversaries is: 418.97945206179264. distance: 419.8710739619961
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0215, Accuracy: 350/568 (61.6197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   2,  Average loss: 0.0096, Accuracy: 434/568 (76.4085%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   3,  Average loss: 0.0052, Accuracy: 508/568 (89.4366%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   4,  Average loss: 0.0038, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   5,  Average loss: 0.0032, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   6,  Average loss: 0.0026, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   7,  Average loss: 0.0025, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   8,  Average loss: 0.0024, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   9,  Average loss: 0.0021, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch  10,  Average loss: 0.0022, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Global model norm: 16.694816214254484.
Norm before scaling: 17.028968812250312. Distance: 4.746576782261332
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.0992, Accuracy: 6501/10000 (65.0100%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0775, Accuracy: 8718/8968 (97.2123%)
Scaling by  100
Scaled Norm after poisoning: 473.76419833604984, distance: 474.6576726968606
Total norm for 4 adversaries is: 473.76419833604984. distance: 474.6576726968606
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 24084.9806, Accuracy: 7746/8968 (86.3738%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   1,  Average loss: 0.0188, Accuracy: 353/557 (63.3752%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   2,  Average loss: 0.0064, Accuracy: 477/557 (85.6373%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   3,  Average loss: 0.0039, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   4,  Average loss: 0.0029, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   5,  Average loss: 0.0022, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   6,  Average loss: 0.0019, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   7,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   8,  Average loss: 0.0018, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch  10,  Average loss: 0.0015, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Global model norm: 16.694816214254484.
Norm before scaling: 17.088510215828773. Distance: 4.316151054744049
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.6148, Accuracy: 8090/10000 (80.9000%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0513, Accuracy: 8783/8968 (97.9371%)
Scaling by  100
Scaled Norm after poisoning: 431.32057393544306, distance: 431.6151171761712
Total norm for 4 adversaries is: 431.32057393544306. distance: 431.6151171761712
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  40, local model 88, internal_epoch   1,  Average loss: 0.0009, Accuracy: 524/530 (98.8679%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2642, Accuracy: 9226/10000 (92.2600%)
___Train Local_Simple,  epoch  40, local model 25, internal_epoch   1,  Average loss: 0.0026, Accuracy: 625/647 (96.5997%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3045, Accuracy: 8979/10000 (89.7900%)
___Train Local_Simple,  epoch  40, local model 28, internal_epoch   1,  Average loss: 0.0015, Accuracy: 489/501 (97.6048%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1604, Accuracy: 9482/10000 (94.8200%)
___Train Local_Simple,  epoch  40, local model 8, internal_epoch   1,  Average loss: 0.0020, Accuracy: 608/633 (96.0506%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1554, Accuracy: 9542/10000 (95.4200%)
___Train Local_Simple,  epoch  40, local model 16, internal_epoch   1,  Average loss: 0.0013, Accuracy: 891/915 (97.3770%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1537, Accuracy: 9524/10000 (95.2400%)
___Train Local_Simple,  epoch  40, local model 6, internal_epoch   1,  Average loss: 0.0021, Accuracy: 590/615 (95.9350%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2716, Accuracy: 9254/10000 (92.5400%)
time spent on training: 76.81629872322083
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3767645627129645  data num: [606, 591, 568, 557, 530, 647, 501, 633, 915, 615]
[foolsgold agg] considering poison per batch poison_fraction: 0.1177389258478014
[foolsgold agg] wv: [1.         1.         0.97392682 0.97392682 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.0893, Accuracy: 9733/10000 (97.3300%)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 10.4963, Accuracy: 69/8968 (0.7694%)
Done in 90.65817141532898 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:41 choose agents : [41, 73, 51, 74, 3, 23, 44, 27, 86, 37]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   1,  Average loss: 0.0218, Accuracy: 359/606 (59.2409%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   2,  Average loss: 0.0141, Accuracy: 351/606 (57.9208%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   3,  Average loss: 0.0129, Accuracy: 357/606 (58.9109%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   4,  Average loss: 0.0112, Accuracy: 403/606 (66.5017%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   5,  Average loss: 0.0106, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   6,  Average loss: 0.0109, Accuracy: 392/606 (64.6865%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   7,  Average loss: 0.0103, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   8,  Average loss: 0.0098, Accuracy: 434/606 (71.6172%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch  10,  Average loss: 0.0101, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Global model norm: 16.6996705896474.
Norm before scaling: 16.892727053229798. Distance: 4.40069207904122
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.1941, Accuracy: 5747/10000 (57.4700%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.8197, Accuracy: 5382/8968 (60.0134%)
Scaling by  100
Scaled Norm after poisoning: 438.92106707812513, distance: 440.069206205115
Total norm for 4 adversaries is: 438.92106707812513. distance: 440.069206205115
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 231.2142, Accuracy: 8255/8968 (92.0495%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   1,  Average loss: 0.0230, Accuracy: 348/591 (58.8832%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   2,  Average loss: 0.0148, Accuracy: 381/591 (64.4670%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   3,  Average loss: 0.0065, Accuracy: 495/591 (83.7563%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   4,  Average loss: 0.0047, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   5,  Average loss: 0.0036, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   6,  Average loss: 0.0033, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   7,  Average loss: 0.0026, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   8,  Average loss: 0.0022, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   9,  Average loss: 0.0024, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch  10,  Average loss: 0.0023, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Global model norm: 16.6996705896474.
Norm before scaling: 16.999529663760185. Distance: 4.382118102090466
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.7158, Accuracy: 7740/10000 (77.4000%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.1869, Accuracy: 8399/8968 (93.6552%)
Scaling by  100
Scaled Norm after poisoning: 437.4913570574852, distance: 438.21183162370227
Total norm for 4 adversaries is: 437.4913570574852. distance: 438.21183162370227
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0191, Accuracy: 358/568 (63.0282%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   2,  Average loss: 0.0095, Accuracy: 423/568 (74.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   3,  Average loss: 0.0048, Accuracy: 523/568 (92.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   4,  Average loss: 0.0039, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   5,  Average loss: 0.0030, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   6,  Average loss: 0.0024, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   7,  Average loss: 0.0022, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   8,  Average loss: 0.0020, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   9,  Average loss: 0.0019, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch  10,  Average loss: 0.0016, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Global model norm: 16.6996705896474.
Norm before scaling: 16.917494780217073. Distance: 4.097519165887981
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.1873, Accuracy: 5824/10000 (58.2400%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0440, Accuracy: 8859/8968 (98.7846%)
Scaling by  100
Scaled Norm after poisoning: 408.93617701910404, distance: 409.7519257123754
Total norm for 4 adversaries is: 408.93617701910404. distance: 409.7519257123754
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 6092.8565, Accuracy: 8381/8968 (93.4545%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   1,  Average loss: 0.0186, Accuracy: 365/557 (65.5296%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   2,  Average loss: 0.0063, Accuracy: 485/557 (87.0736%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   3,  Average loss: 0.0037, Accuracy: 519/557 (93.1777%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   4,  Average loss: 0.0028, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   5,  Average loss: 0.0022, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   6,  Average loss: 0.0025, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   7,  Average loss: 0.0017, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   8,  Average loss: 0.0020, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   9,  Average loss: 0.0018, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Global model norm: 16.6996705896474.
Norm before scaling: 16.989686417944213. Distance: 4.0086423970201555
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.5631, Accuracy: 8254/10000 (82.5400%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0591, Accuracy: 8740/8968 (97.4576%)
Scaling by  100
Scaled Norm after poisoning: 400.42619872455896, distance: 400.86426162729947
Total norm for 4 adversaries is: 400.42619872455896. distance: 400.86426162729947
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  41, local model 3, internal_epoch   1,  Average loss: 0.0020, Accuracy: 884/923 (95.7746%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.3774, Accuracy: 8766/10000 (87.6600%)
___Train Local_Simple,  epoch  41, local model 23, internal_epoch   1,  Average loss: 0.0011, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1334, Accuracy: 9559/10000 (95.5900%)
___Train Local_Simple,  epoch  41, local model 44, internal_epoch   1,  Average loss: 0.0019, Accuracy: 501/517 (96.9052%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1429, Accuracy: 9582/10000 (95.8200%)
___Train Local_Simple,  epoch  41, local model 27, internal_epoch   1,  Average loss: 0.0023, Accuracy: 450/471 (95.5414%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2630, Accuracy: 9100/10000 (91.0000%)
___Train Local_Simple,  epoch  41, local model 86, internal_epoch   1,  Average loss: 0.0010, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1233, Accuracy: 9629/10000 (96.2900%)
___Train Local_Simple,  epoch  41, local model 37, internal_epoch   1,  Average loss: 0.0017, Accuracy: 833/860 (96.8605%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.3526, Accuracy: 8961/10000 (89.6100%)
time spent on training: 83.79325842857361
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4119943222143364  data num: [606, 591, 568, 557, 923, 293, 517, 471, 250, 860]
[foolsgold agg] considering poison per batch poison_fraction: 0.12874822569198013
[foolsgold agg] wv: [1.         1.         0.92365423 0.92365423 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.0899, Accuracy: 9730/10000 (97.3000%)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 10.4840, Accuracy: 69/8968 (0.7694%)
Done in 97.76170825958252 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:42 choose agents : [41, 73, 51, 74, 23, 35, 29, 48, 11, 43]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   1,  Average loss: 0.0215, Accuracy: 362/606 (59.7360%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   2,  Average loss: 0.0130, Accuracy: 379/606 (62.5413%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   3,  Average loss: 0.0121, Accuracy: 336/606 (55.4455%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   4,  Average loss: 0.0107, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   5,  Average loss: 0.0109, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   6,  Average loss: 0.0108, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   7,  Average loss: 0.0105, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   8,  Average loss: 0.0107, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch  10,  Average loss: 0.0105, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Global model norm: 16.70484417310309.
Norm before scaling: 16.88790558300433. Distance: 4.493158225619714
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.3461, Accuracy: 5767/10000 (57.6700%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.9052, Accuracy: 4813/8968 (53.6686%)
Scaling by  100
Scaled Norm after poisoning: 448.062338715273, distance: 449.31583407442923
Total norm for 4 adversaries is: 448.062338715273. distance: 449.31583407442923
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 9668.9540, Accuracy: 3155/8968 (35.1806%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   1,  Average loss: 0.0269, Accuracy: 317/591 (53.6379%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   2,  Average loss: 0.0185, Accuracy: 298/591 (50.4230%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   3,  Average loss: 0.0118, Accuracy: 382/591 (64.6362%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   4,  Average loss: 0.0075, Accuracy: 492/591 (83.2487%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   5,  Average loss: 0.0062, Accuracy: 507/591 (85.7868%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   6,  Average loss: 0.0052, Accuracy: 524/591 (88.6633%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   7,  Average loss: 0.0046, Accuracy: 538/591 (91.0321%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   8,  Average loss: 0.0041, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   9,  Average loss: 0.0036, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch  10,  Average loss: 0.0036, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Global model norm: 16.70484417310309.
Norm before scaling: 17.141537442954267. Distance: 5.211873898307628
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.0640, Accuracy: 6544/10000 (65.4400%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.1441, Accuracy: 8453/8968 (94.2574%)
Scaling by  100
Scaled Norm after poisoning: 520.266338042353, distance: 521.1874063136983
Total norm for 4 adversaries is: 520.266338042353. distance: 521.1874063136983
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   1,  Average loss: 0.0199, Accuracy: 366/568 (64.4366%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   2,  Average loss: 0.0098, Accuracy: 413/568 (72.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   3,  Average loss: 0.0050, Accuracy: 514/568 (90.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   4,  Average loss: 0.0037, Accuracy: 530/568 (93.3099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   5,  Average loss: 0.0034, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   6,  Average loss: 0.0029, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   7,  Average loss: 0.0022, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   8,  Average loss: 0.0022, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   9,  Average loss: 0.0018, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch  10,  Average loss: 0.0020, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Global model norm: 16.70484417310309.
Norm before scaling: 16.947220493954255. Distance: 4.254960699202498
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.0645, Accuracy: 6190/10000 (61.9000%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0616, Accuracy: 8820/8968 (98.3497%)
Scaling by  100
Scaled Norm after poisoning: 424.6541607590817, distance: 425.49607078091805
Total norm for 4 adversaries is: 424.6541607590817. distance: 425.49607078091805
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 4188.8747, Accuracy: 8679/8968 (96.7774%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   1,  Average loss: 0.0219, Accuracy: 372/557 (66.7864%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   2,  Average loss: 0.0073, Accuracy: 468/557 (84.0215%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   3,  Average loss: 0.0046, Accuracy: 511/557 (91.7415%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   4,  Average loss: 0.0039, Accuracy: 511/557 (91.7415%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   5,  Average loss: 0.0030, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   6,  Average loss: 0.0026, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   7,  Average loss: 0.0021, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   8,  Average loss: 0.0018, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   9,  Average loss: 0.0018, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch  10,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Global model norm: 16.70484417310309.
Norm before scaling: 17.09655894853872. Distance: 4.571129359092096
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.5729, Accuracy: 8177/10000 (81.7700%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0558, Accuracy: 8751/8968 (97.5803%)
Scaling by  100
Scaled Norm after poisoning: 456.5805651799034, distance: 457.1129339397432
Total norm for 4 adversaries is: 456.5805651799034. distance: 457.1129339397432
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  42, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1652, Accuracy: 9467/10000 (94.6700%)
___Train Local_Simple,  epoch  42, local model 35, internal_epoch   1,  Average loss: 0.0011, Accuracy: 491/499 (98.3968%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1511, Accuracy: 9544/10000 (95.4400%)
___Train Local_Simple,  epoch  42, local model 29, internal_epoch   1,  Average loss: 0.0014, Accuracy: 973/1002 (97.1058%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6304, Accuracy: 8489/10000 (84.8900%)
___Train Local_Simple,  epoch  42, local model 48, internal_epoch   1,  Average loss: 0.0010, Accuracy: 438/448 (97.7679%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1554, Accuracy: 9559/10000 (95.5900%)
___Train Local_Simple,  epoch  42, local model 11, internal_epoch   1,  Average loss: 0.0016, Accuracy: 629/645 (97.5194%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2660, Accuracy: 9118/10000 (91.1800%)
___Train Local_Simple,  epoch  42, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 397/408 (97.3039%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1801, Accuracy: 9466/10000 (94.6600%)
time spent on training: 91.20231533050537
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41338792949973296  data num: [606, 591, 568, 557, 293, 499, 1002, 448, 645, 408]
[foolsgold agg] considering poison per batch poison_fraction: 0.12918372796866656
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.0905, Accuracy: 9731/10000 (97.3100%)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 10.4693, Accuracy: 71/8968 (0.7917%)
Done in 106.9101984500885 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:43 choose agents : [41, 73, 51, 74, 33, 12, 97, 15, 42, 20]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   1,  Average loss: 0.0208, Accuracy: 364/606 (60.0660%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   2,  Average loss: 0.0136, Accuracy: 368/606 (60.7261%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   3,  Average loss: 0.0109, Accuracy: 402/606 (66.3366%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   4,  Average loss: 0.0107, Accuracy: 402/606 (66.3366%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   5,  Average loss: 0.0102, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   6,  Average loss: 0.0100, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   9,  Average loss: 0.0099, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch  10,  Average loss: 0.0099, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Global model norm: 16.710923803465636.
Norm before scaling: 16.899233901136242. Distance: 4.371799497245523
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.1129, Accuracy: 6342/10000 (63.4200%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 1.0286, Accuracy: 4246/8968 (47.3461%)
Scaling by  100
Scaled Norm after poisoning: 436.0357819319419, distance: 437.1799364964042
Total norm for 4 adversaries is: 436.0357819319419. distance: 437.1799364964042
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 9356.7354, Accuracy: 1118/8968 (12.4665%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   1,  Average loss: 0.0241, Accuracy: 354/591 (59.8985%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   2,  Average loss: 0.0187, Accuracy: 355/591 (60.0677%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   3,  Average loss: 0.0120, Accuracy: 389/591 (65.8206%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   4,  Average loss: 0.0081, Accuracy: 468/591 (79.1878%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   5,  Average loss: 0.0068, Accuracy: 501/591 (84.7716%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   6,  Average loss: 0.0057, Accuracy: 533/591 (90.1861%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   7,  Average loss: 0.0047, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   8,  Average loss: 0.0038, Accuracy: 557/591 (94.2470%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   9,  Average loss: 0.0038, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch  10,  Average loss: 0.0036, Accuracy: 559/591 (94.5854%), train_poison_data_count: 195
Global model norm: 16.710923803465636.
Norm before scaling: 17.00185698296338. Distance: 4.635998201503191
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.0293, Accuracy: 6879/10000 (68.7900%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.1519, Accuracy: 8525/8968 (95.0602%)
Scaling by  100
Scaled Norm after poisoning: 462.63986060974037, distance: 463.5998409188683
Total norm for 4 adversaries is: 462.63986060974037. distance: 463.5998409188683
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 339.9054, Accuracy: 8887/8968 (99.0968%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   1,  Average loss: 0.0203, Accuracy: 360/568 (63.3803%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   2,  Average loss: 0.0083, Accuracy: 449/568 (79.0493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   3,  Average loss: 0.0035, Accuracy: 525/568 (92.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   4,  Average loss: 0.0036, Accuracy: 523/568 (92.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   5,  Average loss: 0.0029, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   6,  Average loss: 0.0022, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   7,  Average loss: 0.0022, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   8,  Average loss: 0.0017, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   9,  Average loss: 0.0020, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch  10,  Average loss: 0.0018, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Global model norm: 16.710923803465636.
Norm before scaling: 16.918078333892378. Distance: 4.1101426252506545
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.9273, Accuracy: 6913/10000 (69.1300%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0718, Accuracy: 8725/8968 (97.2904%)
Scaling by  100
Scaled Norm after poisoning: 410.14545819135924, distance: 411.014294155325
Total norm for 4 adversaries is: 410.14545819135924. distance: 411.014294155325
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 75007.7971, Accuracy: 4437/8968 (49.4759%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   1,  Average loss: 0.0217, Accuracy: 372/557 (66.7864%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   2,  Average loss: 0.0064, Accuracy: 487/557 (87.4327%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   3,  Average loss: 0.0027, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   4,  Average loss: 0.0022, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   5,  Average loss: 0.0021, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   7,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   8,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Global model norm: 16.710923803465636.
Norm before scaling: 17.125847343030852. Distance: 4.5423017751873465
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.7147, Accuracy: 7820/10000 (78.2000%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0434, Accuracy: 8806/8968 (98.1936%)
Scaling by  100
Scaled Norm after poisoning: 453.8116693629638, distance: 454.2301866895242
Total norm for 4 adversaries is: 453.8116693629638. distance: 454.2301866895242
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  43, local model 33, internal_epoch   1,  Average loss: 0.0018, Accuracy: 601/623 (96.4687%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1741, Accuracy: 9448/10000 (94.4800%)
___Train Local_Simple,  epoch  43, local model 12, internal_epoch   1,  Average loss: 0.0018, Accuracy: 1122/1160 (96.7241%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3704, Accuracy: 8747/10000 (87.4700%)
___Train Local_Simple,  epoch  43, local model 97, internal_epoch   1,  Average loss: 0.0011, Accuracy: 476/487 (97.7413%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.4806, Accuracy: 8858/10000 (88.5800%)
___Train Local_Simple,  epoch  43, local model 15, internal_epoch   1,  Average loss: 0.0013, Accuracy: 392/401 (97.7556%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1421, Accuracy: 9535/10000 (95.3500%)
___Train Local_Simple,  epoch  43, local model 42, internal_epoch   1,  Average loss: 0.0012, Accuracy: 229/236 (97.0339%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1311, Accuracy: 9602/10000 (96.0200%)
___Train Local_Simple,  epoch  43, local model 20, internal_epoch   1,  Average loss: 0.0017, Accuracy: 421/429 (98.1352%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3061, Accuracy: 9076/10000 (90.7600%)
time spent on training: 91.46246004104614
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41039236479321317  data num: [606, 591, 568, 557, 623, 1160, 487, 401, 236, 429]
[foolsgold agg] considering poison per batch poison_fraction: 0.12824761399787912
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.0910, Accuracy: 9733/10000 (97.3300%)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 10.4461, Accuracy: 72/8968 (0.8029%)
Done in 106.27179479598999 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:44 choose agents : [41, 73, 51, 74, 90, 56, 54, 24, 38, 43]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   1,  Average loss: 0.0208, Accuracy: 380/606 (62.7063%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   2,  Average loss: 0.0139, Accuracy: 378/606 (62.3762%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   3,  Average loss: 0.0130, Accuracy: 347/606 (57.2607%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   4,  Average loss: 0.0113, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   5,  Average loss: 0.0107, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   6,  Average loss: 0.0108, Accuracy: 399/606 (65.8416%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   7,  Average loss: 0.0105, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   8,  Average loss: 0.0105, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   9,  Average loss: 0.0102, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch  10,  Average loss: 0.0101, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Global model norm: 16.71650466815095.
Norm before scaling: 16.86175967119044. Distance: 4.1927200348811215
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.2129, Accuracy: 5680/10000 (56.8000%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 1.0598, Accuracy: 4449/8968 (49.6097%)
Scaling by  100
Scaled Norm after poisoning: 418.08889978687546, distance: 419.2720253606243
Total norm for 4 adversaries is: 418.08889978687546. distance: 419.2720253606243
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 5059.2617, Accuracy: 6879/8968 (76.7061%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   1,  Average loss: 0.0222, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   2,  Average loss: 0.0140, Accuracy: 382/591 (64.6362%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   3,  Average loss: 0.0054, Accuracy: 523/591 (88.4941%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   4,  Average loss: 0.0038, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   5,  Average loss: 0.0033, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   6,  Average loss: 0.0030, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   7,  Average loss: 0.0022, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   8,  Average loss: 0.0019, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   9,  Average loss: 0.0020, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch  10,  Average loss: 0.0019, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Global model norm: 16.71650466815095.
Norm before scaling: 16.99964186347254. Distance: 4.357855638008073
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.6700, Accuracy: 7988/10000 (79.8800%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.1170, Accuracy: 8620/8968 (96.1195%)
Scaling by  100
Scaled Norm after poisoning: 435.0218744500097, distance: 435.78555147572297
Total norm for 4 adversaries is: 435.0218744500097. distance: 435.78555147572297
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   1,  Average loss: 0.0214, Accuracy: 349/568 (61.4437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   2,  Average loss: 0.0095, Accuracy: 432/568 (76.0563%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   3,  Average loss: 0.0052, Accuracy: 503/568 (88.5563%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   4,  Average loss: 0.0038, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   5,  Average loss: 0.0037, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   6,  Average loss: 0.0034, Accuracy: 534/568 (94.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   7,  Average loss: 0.0032, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   8,  Average loss: 0.0025, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   9,  Average loss: 0.0023, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch  10,  Average loss: 0.0026, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Global model norm: 16.71650466815095.
Norm before scaling: 16.986929861891245. Distance: 4.790858568244616
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.3263, Accuracy: 5707/10000 (57.0700%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0483, Accuracy: 8824/8968 (98.3943%)
Scaling by  100
Scaled Norm after poisoning: 477.93188910659643, distance: 479.0858319497666
Total norm for 4 adversaries is: 477.93188910659643. distance: 479.0858319497666
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 1309963.8399, Accuracy: 11/8968 (0.1227%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   1,  Average loss: 0.0209, Accuracy: 375/557 (67.3250%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   2,  Average loss: 0.0069, Accuracy: 463/557 (83.1239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   3,  Average loss: 0.0042, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   4,  Average loss: 0.0034, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   5,  Average loss: 0.0026, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   6,  Average loss: 0.0023, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   7,  Average loss: 0.0018, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   9,  Average loss: 0.0015, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch  10,  Average loss: 0.0015, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.71650466815095.
Norm before scaling: 17.10537107117007. Distance: 4.534863524144601
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.6259, Accuracy: 8104/10000 (81.0400%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0460, Accuracy: 8792/8968 (98.0375%)
Scaling by  100
Scaled Norm after poisoning: 452.97685509306103, distance: 453.48633868618356
Total norm for 4 adversaries is: 452.97685509306103. distance: 453.48633868618356
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 45.5456, Accuracy: 8965/8968 (99.9665%)
___Train Local_Simple,  epoch  44, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 651/683 (95.3148%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.7209, Accuracy: 7661/10000 (76.6100%)
___Train Local_Simple,  epoch  44, local model 56, internal_epoch   1,  Average loss: 0.0017, Accuracy: 853/880 (96.9318%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1951, Accuracy: 9355/10000 (93.5500%)
___Train Local_Simple,  epoch  44, local model 54, internal_epoch   1,  Average loss: 0.0024, Accuracy: 498/519 (95.9538%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3946, Accuracy: 8858/10000 (88.5800%)
___Train Local_Simple,  epoch  44, local model 24, internal_epoch   1,  Average loss: 0.0020, Accuracy: 364/379 (96.0422%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1486, Accuracy: 9520/10000 (95.2000%)
___Train Local_Simple,  epoch  44, local model 38, internal_epoch   1,  Average loss: 0.0017, Accuracy: 868/895 (96.9832%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1891, Accuracy: 9367/10000 (93.6700%)
___Train Local_Simple,  epoch  44, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2437, Accuracy: 9288/10000 (92.8800%)
time spent on training: 78.79287815093994
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.38153138350312193  data num: [606, 591, 568, 557, 683, 880, 519, 379, 895, 408]
[foolsgold agg] considering poison per batch poison_fraction: 0.11922855734472561
[foolsgold agg] wv: [1.        1.        0.9362463 0.9362463 1.        1.        1.
 1.        1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.0913, Accuracy: 9731/10000 (97.3100%)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 10.4096, Accuracy: 73/8968 (0.8140%)
Done in 94.03349709510803 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:45 choose agents : [41, 73, 51, 74, 32, 62, 8, 35, 96, 27]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   1,  Average loss: 0.0207, Accuracy: 382/606 (63.0363%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   2,  Average loss: 0.0126, Accuracy: 363/606 (59.9010%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   3,  Average loss: 0.0128, Accuracy: 307/606 (50.6601%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   4,  Average loss: 0.0107, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   5,  Average loss: 0.0112, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   6,  Average loss: 0.0103, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   9,  Average loss: 0.0099, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch  10,  Average loss: 0.0101, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Global model norm: 16.72127153152114.
Norm before scaling: 16.845788156488293. Distance: 4.068050173154666
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.1807, Accuracy: 5675/10000 (56.7500%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.8429, Accuracy: 5283/8968 (58.9095%)
Scaling by  100
Scaled Norm after poisoning: 405.62665639107104, distance: 406.8050439092416
Total norm for 4 adversaries is: 405.62665639107104. distance: 406.8050439092416
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 2.0313, Accuracy: 8948/8968 (99.7770%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   1,  Average loss: 0.0237, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   2,  Average loss: 0.0123, Accuracy: 429/591 (72.5888%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   3,  Average loss: 0.0046, Accuracy: 526/591 (89.0017%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   4,  Average loss: 0.0036, Accuracy: 545/591 (92.2166%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   5,  Average loss: 0.0029, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   6,  Average loss: 0.0025, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   7,  Average loss: 0.0022, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   8,  Average loss: 0.0023, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   9,  Average loss: 0.0018, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch  10,  Average loss: 0.0017, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Global model norm: 16.72127153152114.
Norm before scaling: 16.99894531568659. Distance: 4.349946357133215
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.6868, Accuracy: 7834/10000 (78.3400%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1205, Accuracy: 8503/8968 (94.8149%)
Scaling by  100
Scaled Norm after poisoning: 434.2166078122761, distance: 434.9946299955897
Total norm for 4 adversaries is: 434.2166078122761. distance: 434.9946299955897
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0225, Accuracy: 329/568 (57.9225%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   2,  Average loss: 0.0098, Accuracy: 447/568 (78.6972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   3,  Average loss: 0.0046, Accuracy: 527/568 (92.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   4,  Average loss: 0.0039, Accuracy: 531/568 (93.4859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   5,  Average loss: 0.0032, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   6,  Average loss: 0.0027, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   7,  Average loss: 0.0025, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   8,  Average loss: 0.0024, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   9,  Average loss: 0.0017, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch  10,  Average loss: 0.0017, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Global model norm: 16.72127153152114.
Norm before scaling: 17.03363121254996. Distance: 4.646084743020843
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.0179, Accuracy: 6485/10000 (64.8500%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0618, Accuracy: 8756/8968 (97.6360%)
Scaling by  100
Scaled Norm after poisoning: 463.72014728713265, distance: 464.60847091933226
Total norm for 4 adversaries is: 463.72014728713265. distance: 464.60847091933226
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 569083.3850, Accuracy: 833/8968 (9.2886%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   1,  Average loss: 0.0181, Accuracy: 395/557 (70.9156%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 487/557 (87.4327%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   3,  Average loss: 0.0031, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   4,  Average loss: 0.0026, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   5,  Average loss: 0.0025, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   6,  Average loss: 0.0020, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   7,  Average loss: 0.0017, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Global model norm: 16.72127153152114.
Norm before scaling: 16.971046475012415. Distance: 3.746044488767934
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5685, Accuracy: 8224/10000 (82.2400%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0383, Accuracy: 8818/8968 (98.3274%)
Scaling by  100
Scaled Norm after poisoning: 374.2276838703946, distance: 374.6044580621005
Total norm for 4 adversaries is: 374.2276838703946. distance: 374.6044580621005
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  45, local model 32, internal_epoch   1,  Average loss: 0.0023, Accuracy: 943/977 (96.5200%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3153, Accuracy: 8942/10000 (89.4200%)
___Train Local_Simple,  epoch  45, local model 62, internal_epoch   1,  Average loss: 0.0014, Accuracy: 413/423 (97.6359%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1303, Accuracy: 9602/10000 (96.0200%)
___Train Local_Simple,  epoch  45, local model 8, internal_epoch   1,  Average loss: 0.0023, Accuracy: 604/633 (95.4186%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1378, Accuracy: 9605/10000 (96.0500%)
___Train Local_Simple,  epoch  45, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 491/499 (98.3968%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2334, Accuracy: 9323/10000 (93.2300%)
___Train Local_Simple,  epoch  45, local model 96, internal_epoch   1,  Average loss: 0.0016, Accuracy: 653/672 (97.1726%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2124, Accuracy: 9290/10000 (92.9000%)
___Train Local_Simple,  epoch  45, local model 27, internal_epoch   1,  Average loss: 0.0018, Accuracy: 453/471 (96.1783%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3364, Accuracy: 8970/10000 (89.7000%)
time spent on training: 77.25942921638489
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3871935967983992  data num: [606, 591, 568, 557, 977, 423, 633, 499, 672, 471]
[foolsgold agg] considering poison per batch poison_fraction: 0.12099799899949976
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.0915, Accuracy: 9730/10000 (97.3000%)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 10.3125, Accuracy: 74/8968 (0.8252%)
Done in 90.37847423553467 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:46 choose agents : [41, 73, 51, 74, 58, 86, 89, 17, 80, 63]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   1,  Average loss: 0.0209, Accuracy: 371/606 (61.2211%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   2,  Average loss: 0.0157, Accuracy: 354/606 (58.4158%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   3,  Average loss: 0.0120, Accuracy: 386/606 (63.6964%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   4,  Average loss: 0.0109, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   5,  Average loss: 0.0106, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   6,  Average loss: 0.0104, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   7,  Average loss: 0.0103, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   8,  Average loss: 0.0099, Accuracy: 433/606 (71.4521%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   9,  Average loss: 0.0100, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch  10,  Average loss: 0.0101, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Global model norm: 16.725891071297404.
Norm before scaling: 16.83299169414041. Distance: 4.063836450094324
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.3295, Accuracy: 5052/10000 (50.5200%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.8608, Accuracy: 5338/8968 (59.5227%)
Scaling by  100
Scaled Norm after poisoning: 405.1362425160208, distance: 406.3836510921669
Total norm for 4 adversaries is: 405.1362425160208. distance: 406.3836510921669
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 98.2990, Accuracy: 8849/8968 (98.6731%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   1,  Average loss: 0.0282, Accuracy: 326/591 (55.1607%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   2,  Average loss: 0.0220, Accuracy: 293/591 (49.5770%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   3,  Average loss: 0.0116, Accuracy: 444/591 (75.1269%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   4,  Average loss: 0.0086, Accuracy: 487/591 (82.4027%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   5,  Average loss: 0.0073, Accuracy: 508/591 (85.9560%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   6,  Average loss: 0.0060, Accuracy: 528/591 (89.3401%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   7,  Average loss: 0.0045, Accuracy: 551/591 (93.2318%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   8,  Average loss: 0.0044, Accuracy: 549/591 (92.8934%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   9,  Average loss: 0.0035, Accuracy: 559/591 (94.5854%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch  10,  Average loss: 0.0036, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Global model norm: 16.725891071297404.
Norm before scaling: 17.171480460663183. Distance: 5.673401177998404
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.1279, Accuracy: 6358/10000 (63.5800%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.1080, Accuracy: 8761/8968 (97.6918%)
Scaling by  100
Scaled Norm after poisoning: 566.0797481362498, distance: 567.3401481915413
Total norm for 4 adversaries is: 566.0797481362498. distance: 567.3401481915413
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 5846.7693, Accuracy: 8616/8968 (96.0749%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   1,  Average loss: 0.0199, Accuracy: 359/568 (63.2042%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   2,  Average loss: 0.0081, Accuracy: 467/568 (82.2183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   3,  Average loss: 0.0036, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   4,  Average loss: 0.0029, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   5,  Average loss: 0.0028, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   6,  Average loss: 0.0025, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   7,  Average loss: 0.0017, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   8,  Average loss: 0.0016, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   9,  Average loss: 0.0014, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch  10,  Average loss: 0.0018, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Global model norm: 16.725891071297404.
Norm before scaling: 16.971455563830645. Distance: 4.2248084752840604
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.9779, Accuracy: 6580/10000 (65.8000%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0325, Accuracy: 8859/8968 (98.7846%)
Scaling by  100
Scaled Norm after poisoning: 421.67804661850727, distance: 422.480842760947
Total norm for 4 adversaries is: 421.67804661850727. distance: 422.480842760947
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 238.2969, Accuracy: 8956/8968 (99.8662%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   1,  Average loss: 0.0210, Accuracy: 377/557 (67.6840%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   2,  Average loss: 0.0063, Accuracy: 485/557 (87.0736%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   3,  Average loss: 0.0027, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   4,  Average loss: 0.0026, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   5,  Average loss: 0.0025, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   6,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   7,  Average loss: 0.0022, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   9,  Average loss: 0.0018, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch  10,  Average loss: 0.0018, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Global model norm: 16.725891071297404.
Norm before scaling: 17.093967805970692. Distance: 4.4533021055105095
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6704, Accuracy: 7886/10000 (78.8600%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0359, Accuracy: 8836/8968 (98.5281%)
Scaling by  100
Scaled Norm after poisoning: 444.8149896305204, distance: 445.3301794736126
Total norm for 4 adversaries is: 444.8149896305204. distance: 445.3301794736126
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  46, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 263/276 (95.2899%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2030, Accuracy: 9350/10000 (93.5000%)
___Train Local_Simple,  epoch  46, local model 86, internal_epoch   1,  Average loss: 0.0009, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1146, Accuracy: 9652/10000 (96.5200%)
___Train Local_Simple,  epoch  46, local model 89, internal_epoch   1,  Average loss: 0.0008, Accuracy: 481/492 (97.7642%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2296, Accuracy: 9311/10000 (93.1100%)
___Train Local_Simple,  epoch  46, local model 17, internal_epoch   1,  Average loss: 0.0017, Accuracy: 603/620 (97.2581%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1712, Accuracy: 9468/10000 (94.6800%)
___Train Local_Simple,  epoch  46, local model 80, internal_epoch   1,  Average loss: 0.0008, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1770, Accuracy: 9470/10000 (94.7000%)
___Train Local_Simple,  epoch  46, local model 63, internal_epoch   1,  Average loss: 0.0023, Accuracy: 849/889 (95.5006%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2512, Accuracy: 9204/10000 (92.0400%)
time spent on training: 78.38221383094788
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.43977272727272726  data num: [606, 591, 568, 557, 276, 250, 492, 620, 431, 889]
[foolsgold agg] considering poison per batch poison_fraction: 0.13742897727272727
[foolsgold agg] wv: [1.         1.         0.92574443 0.92574443 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.0916, Accuracy: 9730/10000 (97.3000%)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 10.2865, Accuracy: 73/8968 (0.8140%)
Done in 92.32526898384094 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:47 choose agents : [41, 73, 51, 74, 58, 26, 90, 89, 93, 79]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   1,  Average loss: 0.0193, Accuracy: 379/606 (62.5413%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   2,  Average loss: 0.0132, Accuracy: 370/606 (61.0561%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   3,  Average loss: 0.0117, Accuracy: 374/606 (61.7162%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   4,  Average loss: 0.0107, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   5,  Average loss: 0.0099, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   6,  Average loss: 0.0100, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   7,  Average loss: 0.0100, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   8,  Average loss: 0.0099, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   9,  Average loss: 0.0101, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch  10,  Average loss: 0.0101, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Global model norm: 16.731081170935653.
Norm before scaling: 16.887249604916427. Distance: 4.10677217504866
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.1319, Accuracy: 6599/10000 (65.9900%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 1.0377, Accuracy: 4237/8968 (47.2458%)
Scaling by  100
Scaled Norm after poisoning: 409.60241774799135, distance: 410.6771846596789
Total norm for 4 adversaries is: 409.60241774799135. distance: 410.6771846596789
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 5393.4445, Accuracy: 584/8968 (6.5120%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   1,  Average loss: 0.0245, Accuracy: 318/591 (53.8071%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   2,  Average loss: 0.0144, Accuracy: 389/591 (65.8206%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   3,  Average loss: 0.0066, Accuracy: 491/591 (83.0795%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   4,  Average loss: 0.0046, Accuracy: 549/591 (92.8934%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   5,  Average loss: 0.0039, Accuracy: 551/591 (93.2318%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   6,  Average loss: 0.0034, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   7,  Average loss: 0.0028, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   8,  Average loss: 0.0027, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   9,  Average loss: 0.0022, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch  10,  Average loss: 0.0022, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Global model norm: 16.731081170935653.
Norm before scaling: 17.04507305296341. Distance: 4.584523595522264
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.7929, Accuracy: 7684/10000 (76.8400%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.1685, Accuracy: 8406/8968 (93.7333%)
Scaling by  100
Scaled Norm after poisoning: 457.62131246807115, distance: 458.4523727989637
Total norm for 4 adversaries is: 457.62131246807115. distance: 458.4523727989637
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 595.3935, Accuracy: 8907/8968 (99.3198%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   1,  Average loss: 0.0201, Accuracy: 369/568 (64.9648%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   2,  Average loss: 0.0077, Accuracy: 478/568 (84.1549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   3,  Average loss: 0.0035, Accuracy: 534/568 (94.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   4,  Average loss: 0.0033, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   5,  Average loss: 0.0024, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   6,  Average loss: 0.0023, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   7,  Average loss: 0.0022, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   8,  Average loss: 0.0021, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   9,  Average loss: 0.0017, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch  10,  Average loss: 0.0017, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Global model norm: 16.731081170935653.
Norm before scaling: 16.957977416156535. Distance: 4.276663223546684
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.1080, Accuracy: 6606/10000 (66.0600%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0405, Accuracy: 8835/8968 (98.5169%)
Scaling by  100
Scaled Norm after poisoning: 426.74798622840626, distance: 427.6663419068655
Total norm for 4 adversaries is: 426.74798622840626. distance: 427.6663419068655
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 85.1845, Accuracy: 8959/8968 (99.8996%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   1,  Average loss: 0.0171, Accuracy: 397/557 (71.2747%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   2,  Average loss: 0.0062, Accuracy: 479/557 (85.9964%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   3,  Average loss: 0.0032, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   4,  Average loss: 0.0023, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   5,  Average loss: 0.0025, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   6,  Average loss: 0.0020, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   7,  Average loss: 0.0016, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   9,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Global model norm: 16.731081170935653.
Norm before scaling: 17.01828276419767. Distance: 3.757925178599119
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.4680, Accuracy: 8538/10000 (85.3800%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0606, Accuracy: 8726/8968 (97.3015%)
Scaling by  100
Scaled Norm after poisoning: 375.57555831017544, distance: 375.79249593359367
Total norm for 4 adversaries is: 375.57555831017544. distance: 375.79249593359367
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  47, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 263/276 (95.2899%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3198, Accuracy: 9015/10000 (90.1500%)
___Train Local_Simple,  epoch  47, local model 26, internal_epoch   1,  Average loss: 0.0017, Accuracy: 536/554 (96.7509%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1049, Accuracy: 9679/10000 (96.7900%)
___Train Local_Simple,  epoch  47, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 659/683 (96.4861%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.8685, Accuracy: 7881/10000 (78.8100%)
___Train Local_Simple,  epoch  47, local model 89, internal_epoch   1,  Average loss: 0.0009, Accuracy: 483/492 (98.1707%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1858, Accuracy: 9425/10000 (94.2500%)
___Train Local_Simple,  epoch  47, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 619/623 (99.3579%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1946, Accuracy: 9435/10000 (94.3500%)
___Train Local_Simple,  epoch  47, local model 79, internal_epoch   1,  Average loss: 0.0019, Accuracy: 175/182 (96.1538%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1273, Accuracy: 9618/10000 (96.1800%)
time spent on training: 72.0191023349762
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4524551831644583  data num: [606, 591, 568, 557, 276, 554, 683, 492, 623, 182]
[foolsgold agg] considering poison per batch poison_fraction: 0.14139224473889322
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.0922, Accuracy: 9729/10000 (97.2900%)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 10.2654, Accuracy: 74/8968 (0.8252%)
Done in 86.48525309562683 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:48 choose agents : [41, 73, 51, 74, 36, 67, 87, 65, 30, 98]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   1,  Average loss: 0.0196, Accuracy: 381/606 (62.8713%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   2,  Average loss: 0.0139, Accuracy: 364/606 (60.0660%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   3,  Average loss: 0.0119, Accuracy: 320/606 (52.8053%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   4,  Average loss: 0.0106, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   5,  Average loss: 0.0103, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   6,  Average loss: 0.0098, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   7,  Average loss: 0.0099, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   8,  Average loss: 0.0099, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   9,  Average loss: 0.0101, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch  10,  Average loss: 0.0097, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Global model norm: 16.735895851759402.
Norm before scaling: 16.844502787851052. Distance: 3.9127233959441785
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.9654, Accuracy: 6695/10000 (66.9500%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.9388, Accuracy: 4854/8968 (54.1258%)
Scaling by  100
Scaled Norm after poisoning: 390.13829679358577, distance: 391.27232364428744
Total norm for 4 adversaries is: 390.13829679358577. distance: 391.27232364428744
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   1,  Average loss: 0.0295, Accuracy: 309/591 (52.2843%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   2,  Average loss: 0.0154, Accuracy: 373/591 (63.1134%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   3,  Average loss: 0.0069, Accuracy: 505/591 (85.4484%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   4,  Average loss: 0.0054, Accuracy: 531/591 (89.8477%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   5,  Average loss: 0.0052, Accuracy: 535/591 (90.5245%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   6,  Average loss: 0.0050, Accuracy: 534/591 (90.3553%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   7,  Average loss: 0.0046, Accuracy: 539/591 (91.2014%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   8,  Average loss: 0.0037, Accuracy: 553/591 (93.5702%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   9,  Average loss: 0.0034, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch  10,  Average loss: 0.0033, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Global model norm: 16.735895851759402.
Norm before scaling: 17.223162575484285. Distance: 5.735994281867035
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.0964, Accuracy: 6269/10000 (62.6900%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.1437, Accuracy: 8442/8968 (94.1347%)
Scaling by  100
Scaled Norm after poisoning: 572.4167515892594, distance: 573.5994355820096
Total norm for 4 adversaries is: 572.4167515892594. distance: 573.5994355820096
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 78.8032, Accuracy: 8957/8968 (99.8773%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   1,  Average loss: 0.0201, Accuracy: 337/568 (59.3310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   2,  Average loss: 0.0079, Accuracy: 486/568 (85.5634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   3,  Average loss: 0.0031, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   4,  Average loss: 0.0032, Accuracy: 529/568 (93.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   5,  Average loss: 0.0026, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   6,  Average loss: 0.0021, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   7,  Average loss: 0.0022, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   8,  Average loss: 0.0019, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   9,  Average loss: 0.0017, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch  10,  Average loss: 0.0016, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Global model norm: 16.735895851759402.
Norm before scaling: 16.986588517213367. Distance: 4.240870374918955
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.9334, Accuracy: 6513/10000 (65.1300%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0250, Accuracy: 8909/8968 (99.3421%)
Scaling by  100
Scaled Norm after poisoning: 423.29280276777683, distance: 424.0870525316707
Total norm for 4 adversaries is: 423.29280276777683. distance: 424.0870525316707
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 1353.8710, Accuracy: 8876/8968 (98.9741%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0206, Accuracy: 378/557 (67.8636%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   2,  Average loss: 0.0072, Accuracy: 469/557 (84.2011%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   3,  Average loss: 0.0036, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   4,  Average loss: 0.0032, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   5,  Average loss: 0.0023, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   7,  Average loss: 0.0016, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   8,  Average loss: 0.0018, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.735895851759402.
Norm before scaling: 17.17931800989656. Distance: 4.631707765759038
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.6588, Accuracy: 7952/10000 (79.5200%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0326, Accuracy: 8855/8968 (98.7400%)
Scaling by  100
Scaled Norm after poisoning: 462.78059056101307, distance: 463.170780463319
Total norm for 4 adversaries is: 462.78059056101307. distance: 463.170780463319
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  48, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 981/1005 (97.6119%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4366, Accuracy: 8845/10000 (88.4500%)
___Train Local_Simple,  epoch  48, local model 67, internal_epoch   1,  Average loss: 0.0015, Accuracy: 972/998 (97.3948%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3441, Accuracy: 8990/10000 (89.9000%)
___Train Local_Simple,  epoch  48, local model 87, internal_epoch   1,  Average loss: 0.0011, Accuracy: 459/470 (97.6596%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3261, Accuracy: 9030/10000 (90.3000%)
___Train Local_Simple,  epoch  48, local model 65, internal_epoch   1,  Average loss: 0.0010, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1650, Accuracy: 9467/10000 (94.6700%)
___Train Local_Simple,  epoch  48, local model 30, internal_epoch   1,  Average loss: 0.0015, Accuracy: 388/400 (97.0000%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1905, Accuracy: 9457/10000 (94.5700%)
___Train Local_Simple,  epoch  48, local model 98, internal_epoch   1,  Average loss: 0.0015, Accuracy: 789/818 (96.4548%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3730, Accuracy: 8776/10000 (87.7600%)
time spent on training: 77.22378087043762
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.36372180451127817  data num: [606, 591, 568, 557, 1005, 998, 470, 371, 400, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.11366306390977443
[foolsgold agg] wv: [1.        1.        0.9675954 0.9675954 1.        1.        1.
 1.        1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.0925, Accuracy: 9729/10000 (97.2900%)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 10.1940, Accuracy: 74/8968 (0.8252%)
Done in 93.73015093803406 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:49 choose agents : [41, 73, 51, 74, 25, 54, 52, 46, 6, 35]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   1,  Average loss: 0.0203, Accuracy: 386/606 (63.6964%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   2,  Average loss: 0.0134, Accuracy: 367/606 (60.5611%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   3,  Average loss: 0.0119, Accuracy: 364/606 (60.0660%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   4,  Average loss: 0.0108, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   5,  Average loss: 0.0104, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   6,  Average loss: 0.0100, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   8,  Average loss: 0.0098, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   9,  Average loss: 0.0099, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Global model norm: 16.740573337084275.
Norm before scaling: 16.834751988423196. Distance: 3.779380903862363
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.1821, Accuracy: 6139/10000 (61.3900%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.9360, Accuracy: 4630/8968 (51.6280%)
Scaling by  100
Scaled Norm after poisoning: 376.8358810543391, distance: 377.93809430249286
Total norm for 4 adversaries is: 376.8358810543391. distance: 377.93809430249286
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 4.9944, Accuracy: 8943/8968 (99.7212%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   1,  Average loss: 0.0270, Accuracy: 335/591 (56.6836%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   2,  Average loss: 0.0177, Accuracy: 363/591 (61.4213%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   3,  Average loss: 0.0096, Accuracy: 460/591 (77.8342%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   4,  Average loss: 0.0058, Accuracy: 535/591 (90.5245%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   5,  Average loss: 0.0048, Accuracy: 548/591 (92.7242%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   6,  Average loss: 0.0043, Accuracy: 544/591 (92.0474%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   7,  Average loss: 0.0039, Accuracy: 549/591 (92.8934%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   8,  Average loss: 0.0034, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   9,  Average loss: 0.0033, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch  10,  Average loss: 0.0035, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Global model norm: 16.740573337084275.
Norm before scaling: 17.269005077796262. Distance: 5.630605151378273
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.1062, Accuracy: 6216/10000 (62.1600%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.1484, Accuracy: 8475/8968 (94.5027%)
Scaling by  100
Scaled Norm after poisoning: 562.0891277190833, distance: 563.060526275817
Total norm for 4 adversaries is: 562.0891277190833. distance: 563.060526275817
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 2042.1576, Accuracy: 8840/8968 (98.5727%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   1,  Average loss: 0.0206, Accuracy: 348/568 (61.2676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   2,  Average loss: 0.0100, Accuracy: 418/568 (73.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   3,  Average loss: 0.0050, Accuracy: 520/568 (91.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   4,  Average loss: 0.0038, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   5,  Average loss: 0.0031, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   6,  Average loss: 0.0025, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   7,  Average loss: 0.0025, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   8,  Average loss: 0.0018, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   9,  Average loss: 0.0020, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch  10,  Average loss: 0.0017, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Global model norm: 16.740573337084275.
Norm before scaling: 17.03447414293062. Distance: 4.429997508993374
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.9112, Accuracy: 6744/10000 (67.4400%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0800, Accuracy: 8733/8968 (97.3796%)
Scaling by  100
Scaled Norm after poisoning: 442.2207628832007, distance: 442.9997354683183
Total norm for 4 adversaries is: 442.2207628832007. distance: 442.9997354683183
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 9522.1693, Accuracy: 6914/8968 (77.0963%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0196, Accuracy: 399/557 (71.6338%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   2,  Average loss: 0.0058, Accuracy: 490/557 (87.9713%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   3,  Average loss: 0.0026, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   4,  Average loss: 0.0019, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   5,  Average loss: 0.0019, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   6,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   7,  Average loss: 0.0016, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.740573337084275.
Norm before scaling: 17.117228505770143. Distance: 4.444345271805458
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6264, Accuracy: 7974/10000 (79.7400%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0312, Accuracy: 8858/8968 (98.7734%)
Scaling by  100
Scaled Norm after poisoning: 443.9620971997497, distance: 444.434524845899
Total norm for 4 adversaries is: 443.9620971997497. distance: 444.434524845899
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  49, local model 25, internal_epoch   1,  Average loss: 0.0025, Accuracy: 618/647 (95.5178%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6787, Accuracy: 7969/10000 (79.6900%)
___Train Local_Simple,  epoch  49, local model 54, internal_epoch   1,  Average loss: 0.0019, Accuracy: 501/519 (96.5318%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5114, Accuracy: 8452/10000 (84.5200%)
___Train Local_Simple,  epoch  49, local model 52, internal_epoch   1,  Average loss: 0.0011, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1460, Accuracy: 9562/10000 (95.6200%)
___Train Local_Simple,  epoch  49, local model 46, internal_epoch   1,  Average loss: 0.0017, Accuracy: 695/710 (97.8873%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3029, Accuracy: 9131/10000 (91.3100%)
___Train Local_Simple,  epoch  49, local model 6, internal_epoch   1,  Average loss: 0.0017, Accuracy: 592/615 (96.2602%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3188, Accuracy: 9016/10000 (90.1600%)
___Train Local_Simple,  epoch  49, local model 35, internal_epoch   1,  Average loss: 0.0009, Accuracy: 489/499 (97.9960%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2167, Accuracy: 9389/10000 (93.8900%)
time spent on training: 77.2010269165039
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4172506738544474  data num: [606, 591, 568, 557, 647, 519, 253, 710, 615, 499]
[foolsgold agg] considering poison per batch poison_fraction: 0.1303908355795148
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.0928, Accuracy: 9725/10000 (97.2500%)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 10.1281, Accuracy: 76/8968 (0.8475%)
Done in 93.9885139465332 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:50 choose agents : [41, 73, 51, 74, 17, 20, 77, 44, 8, 78]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   1,  Average loss: 0.0204, Accuracy: 387/606 (63.8614%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   2,  Average loss: 0.0139, Accuracy: 366/606 (60.3960%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   3,  Average loss: 0.0116, Accuracy: 363/606 (59.9010%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   4,  Average loss: 0.0110, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   5,  Average loss: 0.0106, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   6,  Average loss: 0.0101, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   7,  Average loss: 0.0103, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 441/606 (72.7723%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Global model norm: 16.745811735874717.
Norm before scaling: 16.856104691798144. Distance: 4.01138687618262
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.1073, Accuracy: 6205/10000 (62.0500%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.9315, Accuracy: 4809/8968 (53.6240%)
Scaling by  100
Scaled Norm after poisoning: 399.9426716730787, distance: 401.13867225063206
Total norm for 4 adversaries is: 399.9426716730787. distance: 401.13867225063206
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 85.4909, Accuracy: 8914/8968 (99.3979%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   1,  Average loss: 0.0263, Accuracy: 318/591 (53.8071%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   2,  Average loss: 0.0130, Accuracy: 423/591 (71.5736%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   3,  Average loss: 0.0058, Accuracy: 522/591 (88.3249%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   4,  Average loss: 0.0046, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   5,  Average loss: 0.0043, Accuracy: 547/591 (92.5550%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   6,  Average loss: 0.0033, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   7,  Average loss: 0.0028, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   8,  Average loss: 0.0026, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   9,  Average loss: 0.0022, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch  10,  Average loss: 0.0024, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Global model norm: 16.745811735874717.
Norm before scaling: 17.082817752160082. Distance: 4.965522341570299
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.9279, Accuracy: 6886/10000 (68.8600%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0667, Accuracy: 8732/8968 (97.3684%)
Scaling by  100
Scaled Norm after poisoning: 495.498675578452, distance: 496.55222220326436
Total norm for 4 adversaries is: 495.498675578452. distance: 496.55222220326436
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0187, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   2,  Average loss: 0.0069, Accuracy: 498/568 (87.6761%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   3,  Average loss: 0.0042, Accuracy: 511/568 (89.9648%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   4,  Average loss: 0.0033, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   5,  Average loss: 0.0027, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   6,  Average loss: 0.0026, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   7,  Average loss: 0.0022, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   8,  Average loss: 0.0019, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   9,  Average loss: 0.0019, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch  10,  Average loss: 0.0017, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Global model norm: 16.745811735874717.
Norm before scaling: 16.97106445714569. Distance: 4.23073610146096
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.1233, Accuracy: 5957/10000 (59.5700%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0377, Accuracy: 8838/8968 (98.5504%)
Scaling by  100
Scaled Norm after poisoning: 422.18631106420304, distance: 423.07361209368753
Total norm for 4 adversaries is: 422.18631106420304. distance: 423.07361209368753
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 15602.0346, Accuracy: 8173/8968 (91.1351%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   1,  Average loss: 0.0193, Accuracy: 387/557 (69.4794%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 493/557 (88.5099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   3,  Average loss: 0.0035, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   4,  Average loss: 0.0024, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   5,  Average loss: 0.0025, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   6,  Average loss: 0.0020, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   7,  Average loss: 0.0018, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.745811735874717.
Norm before scaling: 17.103442357564035. Distance: 4.264690366643262
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6206, Accuracy: 8070/10000 (80.7000%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0319, Accuracy: 8850/8968 (98.6842%)
Scaling by  100
Scaled Norm after poisoning: 426.0845536686351, distance: 426.4690419596714
Total norm for 4 adversaries is: 426.0845536686351. distance: 426.4690419596714
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 602/620 (97.0968%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1616, Accuracy: 9489/10000 (94.8900%)
___Train Local_Simple,  epoch  50, local model 20, internal_epoch   1,  Average loss: 0.0018, Accuracy: 416/429 (96.9697%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.3256, Accuracy: 9032/10000 (90.3200%)
___Train Local_Simple,  epoch  50, local model 77, internal_epoch   1,  Average loss: 0.0019, Accuracy: 567/589 (96.2649%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1632, Accuracy: 9517/10000 (95.1700%)
___Train Local_Simple,  epoch  50, local model 44, internal_epoch   1,  Average loss: 0.0023, Accuracy: 497/517 (96.1315%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1518, Accuracy: 9561/10000 (95.6100%)
___Train Local_Simple,  epoch  50, local model 8, internal_epoch   1,  Average loss: 0.0025, Accuracy: 611/633 (96.5245%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2735, Accuracy: 9199/10000 (91.9900%)
___Train Local_Simple,  epoch  50, local model 78, internal_epoch   1,  Average loss: 0.0009, Accuracy: 296/303 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2176, Accuracy: 9351/10000 (93.5100%)
time spent on training: 75.8591616153717
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4289673009421762  data num: [606, 591, 568, 557, 620, 429, 589, 517, 633, 303]
[foolsgold agg] considering poison per batch poison_fraction: 0.13405228154443008
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.0929, Accuracy: 9727/10000 (97.2700%)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 10.0553, Accuracy: 77/8968 (0.8586%)
Done in 91.39032363891602 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:51 choose agents : [41, 73, 51, 74, 3, 39, 14, 32, 4, 30]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   1,  Average loss: 0.0213, Accuracy: 373/606 (61.5512%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   2,  Average loss: 0.0132, Accuracy: 372/606 (61.3861%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   3,  Average loss: 0.0126, Accuracy: 300/606 (49.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   4,  Average loss: 0.0112, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   5,  Average loss: 0.0099, Accuracy: 435/606 (71.7822%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   6,  Average loss: 0.0100, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   7,  Average loss: 0.0101, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   8,  Average loss: 0.0102, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch  10,  Average loss: 0.0097, Accuracy: 437/606 (72.1122%), train_poison_data_count: 200
Global model norm: 16.749910724458914.
Norm before scaling: 16.990923983195685. Distance: 4.530072078847176
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.2474, Accuracy: 6027/10000 (60.2700%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.7976, Accuracy: 5105/8968 (56.9246%)
Scaling by  100
Scaled Norm after poisoning: 451.9481441493039, distance: 453.0071743361246
Total norm for 4 adversaries is: 451.9481441493039. distance: 453.0071743361246
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 11.3669, Accuracy: 8955/8968 (99.8550%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   1,  Average loss: 0.0243, Accuracy: 343/591 (58.0372%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   2,  Average loss: 0.0164, Accuracy: 376/591 (63.6210%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   3,  Average loss: 0.0069, Accuracy: 489/591 (82.7411%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   4,  Average loss: 0.0049, Accuracy: 545/591 (92.2166%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   5,  Average loss: 0.0040, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   6,  Average loss: 0.0032, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   7,  Average loss: 0.0030, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   8,  Average loss: 0.0023, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   9,  Average loss: 0.0025, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch  10,  Average loss: 0.0025, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Global model norm: 16.749910724458914.
Norm before scaling: 17.148166996727557. Distance: 4.937633078025139
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.7828, Accuracy: 7576/10000 (75.7600%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.2375, Accuracy: 8082/8968 (90.1204%)
Scaling by  100
Scaled Norm after poisoning: 492.9449607968419, distance: 493.76330678271347
Total norm for 4 adversaries is: 492.9449607968419. distance: 493.76330678271347
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 4171.3799, Accuracy: 8404/8968 (93.7110%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   1,  Average loss: 0.0184, Accuracy: 381/568 (67.0775%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   2,  Average loss: 0.0055, Accuracy: 513/568 (90.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   3,  Average loss: 0.0027, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   4,  Average loss: 0.0025, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   5,  Average loss: 0.0020, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   6,  Average loss: 0.0018, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   7,  Average loss: 0.0017, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   8,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch  10,  Average loss: 0.0015, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Global model norm: 16.749910724458914.
Norm before scaling: 16.94820817236755. Distance: 3.8708595797850345
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.8957, Accuracy: 6847/10000 (68.4700%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0224, Accuracy: 8896/8968 (99.1971%)
Scaling by  100
Scaled Norm after poisoning: 386.3754246196308, distance: 387.08596832615876
Total norm for 4 adversaries is: 386.3754246196308. distance: 387.08596832615876
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 129204.7037, Accuracy: 4256/8968 (47.4576%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   1,  Average loss: 0.0189, Accuracy: 352/557 (63.1957%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   2,  Average loss: 0.0059, Accuracy: 489/557 (87.7917%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   3,  Average loss: 0.0029, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   4,  Average loss: 0.0025, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   5,  Average loss: 0.0019, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   8,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Global model norm: 16.749910724458914.
Norm before scaling: 17.11082506697606. Distance: 4.420585309452744
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.7669, Accuracy: 7854/10000 (78.5400%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0244, Accuracy: 8882/8968 (99.0410%)
Scaling by  100
Scaled Norm after poisoning: 441.5475271700658, distance: 442.0585368477799
Total norm for 4 adversaries is: 441.5475271700658. distance: 442.0585368477799
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  51, local model 3, internal_epoch   1,  Average loss: 0.0016, Accuracy: 895/923 (96.9664%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2491, Accuracy: 9147/10000 (91.4700%)
___Train Local_Simple,  epoch  51, local model 39, internal_epoch   1,  Average loss: 0.0011, Accuracy: 252/257 (98.0545%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1260, Accuracy: 9604/10000 (96.0400%)
___Train Local_Simple,  epoch  51, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 364/376 (96.8085%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1256, Accuracy: 9609/10000 (96.0900%)
___Train Local_Simple,  epoch  51, local model 32, internal_epoch   1,  Average loss: 0.0023, Accuracy: 945/977 (96.7247%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2812, Accuracy: 9097/10000 (90.9700%)
___Train Local_Simple,  epoch  51, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 642/658 (97.5684%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.6344, Accuracy: 8080/10000 (80.8000%)
___Train Local_Simple,  epoch  51, local model 30, internal_epoch   1,  Average loss: 0.0023, Accuracy: 388/400 (97.0000%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.3216, Accuracy: 9093/10000 (90.9300%)
time spent on training: 76.39169526100159
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3926940639269406  data num: [606, 591, 568, 557, 923, 257, 376, 977, 658, 400]
[foolsgold agg] considering poison per batch poison_fraction: 0.12271689497716895
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 51: Average loss: 0.0930, Accuracy: 9726/10000 (97.2600%)
___Test Target_Simple poisoned: True, epoch: 51: Average loss: 10.0274, Accuracy: 74/8968 (0.8252%)
Done in 91.26480484008789 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:52 choose agents : [41, 73, 51, 74, 30, 65, 23, 3, 98, 88]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   1,  Average loss: 0.0211, Accuracy: 384/606 (63.3663%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   2,  Average loss: 0.0135, Accuracy: 360/606 (59.4059%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   3,  Average loss: 0.0131, Accuracy: 333/606 (54.9505%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   4,  Average loss: 0.0110, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   5,  Average loss: 0.0106, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   6,  Average loss: 0.0106, Accuracy: 399/606 (65.8416%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   7,  Average loss: 0.0103, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   8,  Average loss: 0.0104, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   9,  Average loss: 0.0101, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch  10,  Average loss: 0.0101, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Global model norm: 16.75371180159368.
Norm before scaling: 16.94794437693007. Distance: 4.570461485953041
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.2721, Accuracy: 5684/10000 (56.8400%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.8378, Accuracy: 5173/8968 (57.6829%)
Scaling by  100
Scaled Norm after poisoning: 455.78234594485997, distance: 457.0461375780349
Total norm for 4 adversaries is: 455.78234594485997. distance: 457.0461375780349
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 73.2320, Accuracy: 8579/8968 (95.6624%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   1,  Average loss: 0.0249, Accuracy: 342/591 (57.8680%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   2,  Average loss: 0.0114, Accuracy: 447/591 (75.6345%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   3,  Average loss: 0.0051, Accuracy: 527/591 (89.1709%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   4,  Average loss: 0.0043, Accuracy: 538/591 (91.0321%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   5,  Average loss: 0.0033, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   6,  Average loss: 0.0031, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   7,  Average loss: 0.0028, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   8,  Average loss: 0.0020, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   9,  Average loss: 0.0022, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch  10,  Average loss: 0.0020, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Global model norm: 16.75371180159368.
Norm before scaling: 17.111158582833454. Distance: 4.999980354270487
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.8877, Accuracy: 7063/10000 (70.6300%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.1786, Accuracy: 8364/8968 (93.2649%)
Scaling by  100
Scaled Norm after poisoning: 498.98819500064326, distance: 499.9980156210622
Total norm for 4 adversaries is: 498.98819500064326. distance: 499.9980156210622
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 555.9618, Accuracy: 8941/8968 (99.6989%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   1,  Average loss: 0.0190, Accuracy: 377/568 (66.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   2,  Average loss: 0.0070, Accuracy: 474/568 (83.4507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   3,  Average loss: 0.0026, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   4,  Average loss: 0.0020, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   5,  Average loss: 0.0018, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   6,  Average loss: 0.0017, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   7,  Average loss: 0.0013, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   8,  Average loss: 0.0012, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   9,  Average loss: 0.0010, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch  10,  Average loss: 0.0010, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Global model norm: 16.75371180159368.
Norm before scaling: 16.989056823667774. Distance: 3.988902433107334
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.7709, Accuracy: 7343/10000 (73.4300%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0442, Accuracy: 8807/8968 (98.2047%)
Scaling by  100
Scaled Norm after poisoning: 398.24250620695926, distance: 398.8902378787929
Total norm for 4 adversaries is: 398.24250620695926. distance: 398.8902378787929
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 5377.1642, Accuracy: 8701/8968 (97.0227%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   1,  Average loss: 0.0161, Accuracy: 395/557 (70.9156%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 490/557 (87.9713%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   3,  Average loss: 0.0032, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   4,  Average loss: 0.0018, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   5,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   7,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch  10,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.75371180159368.
Norm before scaling: 17.01350584399099. Distance: 3.6567096910289902
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.4728, Accuracy: 8502/10000 (85.0200%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0454, Accuracy: 8795/8968 (98.0709%)
Scaling by  100
Scaled Norm after poisoning: 365.4258431953055, distance: 365.6709586499863
Total norm for 4 adversaries is: 365.4258431953055. distance: 365.6709586499863
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  52, local model 30, internal_epoch   1,  Average loss: 0.0019, Accuracy: 385/400 (96.2500%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.3203, Accuracy: 9105/10000 (91.0500%)
___Train Local_Simple,  epoch  52, local model 65, internal_epoch   1,  Average loss: 0.0010, Accuracy: 363/371 (97.8437%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1457, Accuracy: 9549/10000 (95.4900%)
___Train Local_Simple,  epoch  52, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2058, Accuracy: 9361/10000 (93.6100%)
___Train Local_Simple,  epoch  52, local model 3, internal_epoch   1,  Average loss: 0.0018, Accuracy: 895/923 (96.9664%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1945, Accuracy: 9425/10000 (94.2500%)
___Train Local_Simple,  epoch  52, local model 98, internal_epoch   1,  Average loss: 0.0016, Accuracy: 797/818 (97.4328%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.3539, Accuracy: 8863/10000 (88.6300%)
___Train Local_Simple,  epoch  52, local model 88, internal_epoch   1,  Average loss: 0.0011, Accuracy: 520/530 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2435, Accuracy: 9305/10000 (93.0500%)
time spent on training: 76.04836964607239
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41046491073006897  data num: [606, 591, 568, 557, 400, 371, 293, 923, 818, 530]
[foolsgold agg] considering poison per batch poison_fraction: 0.12827028460314654
[foolsgold agg] wv: [1.         1.         0.95051081 0.95051081 0.45017095 1.
 0.45017095 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 52: Average loss: 0.0934, Accuracy: 9727/10000 (97.2700%)
___Test Target_Simple poisoned: True, epoch: 52: Average loss: 10.0048, Accuracy: 74/8968 (0.8252%)
Done in 92.28778600692749 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:53 choose agents : [41, 73, 51, 74, 71, 2, 43, 25, 17, 37]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   1,  Average loss: 0.0193, Accuracy: 374/606 (61.7162%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   2,  Average loss: 0.0146, Accuracy: 365/606 (60.2310%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   3,  Average loss: 0.0110, Accuracy: 375/606 (61.8812%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   4,  Average loss: 0.0106, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   5,  Average loss: 0.0104, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   6,  Average loss: 0.0102, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   7,  Average loss: 0.0100, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   9,  Average loss: 0.0097, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Global model norm: 16.757773346399482.
Norm before scaling: 16.885815580606867. Distance: 3.895869752982272
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.0959, Accuracy: 6451/10000 (64.5100%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 1.0623, Accuracy: 3823/8968 (42.6293%)
Scaling by  100
Scaled Norm after poisoning: 388.55093375901185, distance: 389.5869808207148
Total norm for 4 adversaries is: 388.55093375901185. distance: 389.5869808207148
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   1,  Average loss: 0.0253, Accuracy: 330/591 (55.8376%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   2,  Average loss: 0.0153, Accuracy: 360/591 (60.9137%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   3,  Average loss: 0.0074, Accuracy: 480/591 (81.2183%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   4,  Average loss: 0.0057, Accuracy: 531/591 (89.8477%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   5,  Average loss: 0.0044, Accuracy: 551/591 (93.2318%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   6,  Average loss: 0.0034, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   7,  Average loss: 0.0032, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   8,  Average loss: 0.0025, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   9,  Average loss: 0.0021, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch  10,  Average loss: 0.0023, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Global model norm: 16.757773346399482.
Norm before scaling: 17.099453994332592. Distance: 4.797095874584544
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.8079, Accuracy: 7384/10000 (73.8400%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.1454, Accuracy: 8410/8968 (93.7779%)
Scaling by  100
Scaled Norm after poisoning: 478.8086452331453, distance: 479.70959639661163
Total norm for 4 adversaries is: 478.8086452331453. distance: 479.70959639661163
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 36.7961, Accuracy: 8967/8968 (99.9888%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   1,  Average loss: 0.0198, Accuracy: 372/568 (65.4930%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   2,  Average loss: 0.0079, Accuracy: 493/568 (86.7958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   3,  Average loss: 0.0035, Accuracy: 533/568 (93.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   4,  Average loss: 0.0028, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   5,  Average loss: 0.0028, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   6,  Average loss: 0.0025, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   7,  Average loss: 0.0019, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   8,  Average loss: 0.0017, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   9,  Average loss: 0.0018, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch  10,  Average loss: 0.0015, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Global model norm: 16.757773346399482.
Norm before scaling: 16.987760738030723. Distance: 4.221177144685639
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.9423, Accuracy: 6503/10000 (65.0300%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0333, Accuracy: 8905/8968 (99.2975%)
Scaling by  100
Scaled Norm after poisoning: 421.2581601583523, distance: 422.11770796189063
Total norm for 4 adversaries is: 421.2581601583523. distance: 422.11770796189063
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 63643.2175, Accuracy: 3911/8968 (43.6106%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   1,  Average loss: 0.0197, Accuracy: 375/557 (67.3250%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   2,  Average loss: 0.0064, Accuracy: 471/557 (84.5601%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   3,  Average loss: 0.0028, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   4,  Average loss: 0.0028, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   5,  Average loss: 0.0023, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   6,  Average loss: 0.0018, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   7,  Average loss: 0.0016, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   9,  Average loss: 0.0014, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Global model norm: 16.757773346399482.
Norm before scaling: 17.061112902924243. Distance: 3.9824460614916593
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.5599, Accuracy: 8313/10000 (83.1300%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0365, Accuracy: 8828/8968 (98.4389%)
Scaling by  100
Scaled Norm after poisoning: 397.8937907909597, distance: 398.2446248852582
Total norm for 4 adversaries is: 397.8937907909597. distance: 398.2446248852582
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  53, local model 71, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1356/1384 (97.9769%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6370, Accuracy: 8403/10000 (84.0300%)
___Train Local_Simple,  epoch  53, local model 2, internal_epoch   1,  Average loss: 0.0018, Accuracy: 532/548 (97.0803%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1669, Accuracy: 9475/10000 (94.7500%)
___Train Local_Simple,  epoch  53, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1704, Accuracy: 9485/10000 (94.8500%)
___Train Local_Simple,  epoch  53, local model 25, internal_epoch   1,  Average loss: 0.0017, Accuracy: 620/647 (95.8269%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.5515, Accuracy: 8411/10000 (84.1100%)
___Train Local_Simple,  epoch  53, local model 17, internal_epoch   1,  Average loss: 0.0018, Accuracy: 605/620 (97.5806%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2123, Accuracy: 9315/10000 (93.1500%)
___Train Local_Simple,  epoch  53, local model 37, internal_epoch   1,  Average loss: 0.0015, Accuracy: 835/860 (97.0930%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.3695, Accuracy: 9033/10000 (90.3300%)
time spent on training: 87.7045030593872
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.34202386212991603  data num: [606, 591, 568, 557, 1384, 548, 408, 647, 620, 860]
[foolsgold agg] considering poison per batch poison_fraction: 0.10688245691559876
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 53: Average loss: 0.0936, Accuracy: 9727/10000 (97.2700%)
___Test Target_Simple poisoned: True, epoch: 53: Average loss: 10.0154, Accuracy: 74/8968 (0.8252%)
Done in 101.1331684589386 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:54 choose agents : [41, 73, 51, 74, 46, 56, 30, 0, 33, 53]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   1,  Average loss: 0.0209, Accuracy: 375/606 (61.8812%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   2,  Average loss: 0.0131, Accuracy: 361/606 (59.5710%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   3,  Average loss: 0.0125, Accuracy: 338/606 (55.7756%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   4,  Average loss: 0.0111, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   5,  Average loss: 0.0103, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   6,  Average loss: 0.0102, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   7,  Average loss: 0.0103, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   8,  Average loss: 0.0099, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   9,  Average loss: 0.0095, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch  10,  Average loss: 0.0099, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Global model norm: 16.763140178747648.
Norm before scaling: 16.935324215934813. Distance: 4.349629327174153
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.0244, Accuracy: 6359/10000 (63.5900%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.7729, Accuracy: 5499/8968 (61.3180%)
Scaling by  100
Scaled Norm after poisoning: 433.7765301684728, distance: 434.9629294549134
Total norm for 4 adversaries is: 433.7765301684728. distance: 434.9629294549134
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 3782.3949, Accuracy: 3164/8968 (35.2810%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   1,  Average loss: 0.0252, Accuracy: 331/591 (56.0068%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   2,  Average loss: 0.0116, Accuracy: 429/591 (72.5888%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   3,  Average loss: 0.0050, Accuracy: 538/591 (91.0321%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   4,  Average loss: 0.0048, Accuracy: 540/591 (91.3706%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   5,  Average loss: 0.0041, Accuracy: 549/591 (92.8934%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   6,  Average loss: 0.0034, Accuracy: 559/591 (94.5854%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   7,  Average loss: 0.0029, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   8,  Average loss: 0.0030, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   9,  Average loss: 0.0028, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch  10,  Average loss: 0.0026, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Global model norm: 16.763140178747648.
Norm before scaling: 17.14158195112427. Distance: 5.005114419183751
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.7943, Accuracy: 7564/10000 (75.6400%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.2401, Accuracy: 8073/8968 (90.0201%)
Scaling by  100
Scaled Norm after poisoning: 499.5705030323548, distance: 500.5114415525383
Total norm for 4 adversaries is: 499.5705030323548. distance: 500.5114415525383
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 21200.7913, Accuracy: 8481/8968 (94.5696%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   1,  Average loss: 0.0199, Accuracy: 355/568 (62.5000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   2,  Average loss: 0.0062, Accuracy: 495/568 (87.1479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   3,  Average loss: 0.0029, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   4,  Average loss: 0.0022, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   5,  Average loss: 0.0022, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   6,  Average loss: 0.0019, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   7,  Average loss: 0.0021, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   8,  Average loss: 0.0020, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   9,  Average loss: 0.0019, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch  10,  Average loss: 0.0019, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Global model norm: 16.763140178747648.
Norm before scaling: 17.03191207858749. Distance: 4.3497909144872535
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.9428, Accuracy: 6508/10000 (65.0800%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0157, Accuracy: 8939/8968 (99.6766%)
Scaling by  100
Scaled Norm after poisoning: 434.17054540813797, distance: 434.9790763645994
Total norm for 4 adversaries is: 434.17054540813797. distance: 434.9790763645994
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 75510.9948, Accuracy: 5069/8968 (56.5232%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   1,  Average loss: 0.0181, Accuracy: 392/557 (70.3770%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 482/557 (86.5350%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   3,  Average loss: 0.0034, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   4,  Average loss: 0.0029, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   5,  Average loss: 0.0021, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   6,  Average loss: 0.0019, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   7,  Average loss: 0.0020, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   9,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Global model norm: 16.763140178747648.
Norm before scaling: 17.116035732587694. Distance: 4.1728912144514965
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.6194, Accuracy: 8086/10000 (80.8600%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0335, Accuracy: 8840/8968 (98.5727%)
Scaling by  100
Scaled Norm after poisoning: 416.97180285362225, distance: 417.28909343523463
Total norm for 4 adversaries is: 416.97180285362225. distance: 417.28909343523463
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  54, local model 46, internal_epoch   1,  Average loss: 0.0023, Accuracy: 682/710 (96.0563%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.5688, Accuracy: 8201/10000 (82.0100%)
___Train Local_Simple,  epoch  54, local model 56, internal_epoch   1,  Average loss: 0.0024, Accuracy: 840/880 (95.4545%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1193, Accuracy: 9641/10000 (96.4100%)
___Train Local_Simple,  epoch  54, local model 30, internal_epoch   1,  Average loss: 0.0014, Accuracy: 388/400 (97.0000%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.4287, Accuracy: 8852/10000 (88.5200%)
___Train Local_Simple,  epoch  54, local model 0, internal_epoch   1,  Average loss: 0.0018, Accuracy: 417/435 (95.8621%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1942, Accuracy: 9440/10000 (94.4000%)
___Train Local_Simple,  epoch  54, local model 33, internal_epoch   1,  Average loss: 0.0016, Accuracy: 606/623 (97.2713%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1964, Accuracy: 9380/10000 (93.8000%)
___Train Local_Simple,  epoch  54, local model 53, internal_epoch   1,  Average loss: 0.0013, Accuracy: 723/739 (97.8349%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2721, Accuracy: 9208/10000 (92.0800%)
time spent on training: 80.06349992752075
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3800949418890162  data num: [606, 591, 568, 557, 710, 880, 400, 435, 623, 739]
[foolsgold agg] considering poison per batch poison_fraction: 0.11877966934031757
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 54: Average loss: 0.0936, Accuracy: 9728/10000 (97.2800%)
___Test Target_Simple poisoned: True, epoch: 54: Average loss: 9.9102, Accuracy: 78/8968 (0.8698%)
Done in 94.80643200874329 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:55 choose agents : [41, 73, 51, 74, 17, 65, 6, 24, 86, 35]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   1,  Average loss: 0.0203, Accuracy: 370/606 (61.0561%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   2,  Average loss: 0.0138, Accuracy: 385/606 (63.5314%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   3,  Average loss: 0.0131, Accuracy: 294/606 (48.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   4,  Average loss: 0.0119, Accuracy: 399/606 (65.8416%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   5,  Average loss: 0.0112, Accuracy: 396/606 (65.3465%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   6,  Average loss: 0.0110, Accuracy: 401/606 (66.1716%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   7,  Average loss: 0.0108, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 444/606 (73.2673%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 434/606 (71.6172%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch  10,  Average loss: 0.0102, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Global model norm: 16.7671939794741.
Norm before scaling: 16.872158687302917. Distance: 4.192188655641264
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.3387, Accuracy: 5251/10000 (52.5100%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.6842, Accuracy: 6006/8968 (66.9715%)
Scaling by  100
Scaled Norm after poisoning: 417.87703783529435, distance: 419.2188420145259
Total norm for 4 adversaries is: 417.87703783529435. distance: 419.2188420145259
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 3670.5432, Accuracy: 6694/8968 (74.6432%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   1,  Average loss: 0.0241, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   2,  Average loss: 0.0099, Accuracy: 450/591 (76.1421%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   3,  Average loss: 0.0035, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   4,  Average loss: 0.0030, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   5,  Average loss: 0.0028, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   6,  Average loss: 0.0019, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   7,  Average loss: 0.0019, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   8,  Average loss: 0.0015, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   9,  Average loss: 0.0015, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch  10,  Average loss: 0.0015, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Global model norm: 16.7671939794741.
Norm before scaling: 17.11634329416397. Distance: 4.619431313527715
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.5914, Accuracy: 8213/10000 (82.1300%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0923, Accuracy: 8609/8968 (95.9969%)
Scaling by  100
Scaled Norm after poisoning: 461.21764791690265, distance: 461.94311067489684
Total norm for 4 adversaries is: 461.21764791690265. distance: 461.94311067489684
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 650.9285, Accuracy: 8928/8968 (99.5540%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   1,  Average loss: 0.0222, Accuracy: 323/568 (56.8662%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   2,  Average loss: 0.0102, Accuracy: 419/568 (73.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   3,  Average loss: 0.0045, Accuracy: 521/568 (91.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   4,  Average loss: 0.0048, Accuracy: 511/568 (89.9648%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   5,  Average loss: 0.0035, Accuracy: 531/568 (93.4859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   6,  Average loss: 0.0034, Accuracy: 529/568 (93.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   7,  Average loss: 0.0031, Accuracy: 533/568 (93.8380%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   8,  Average loss: 0.0026, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   9,  Average loss: 0.0021, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch  10,  Average loss: 0.0026, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Global model norm: 16.7671939794741.
Norm before scaling: 17.00903170153516. Distance: 4.530185548127568
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.2000, Accuracy: 5846/10000 (58.4600%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0505, Accuracy: 8807/8968 (98.2047%)
Scaling by  100
Scaled Norm after poisoning: 451.96408181403086, distance: 453.0185737086284
Total norm for 4 adversaries is: 451.96408181403086. distance: 453.0185737086284
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 14391.0713, Accuracy: 8107/8968 (90.3992%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   1,  Average loss: 0.0190, Accuracy: 382/557 (68.5817%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   2,  Average loss: 0.0068, Accuracy: 472/557 (84.7397%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   3,  Average loss: 0.0039, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   4,  Average loss: 0.0026, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   5,  Average loss: 0.0024, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   6,  Average loss: 0.0022, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   7,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   9,  Average loss: 0.0015, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch  10,  Average loss: 0.0015, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Global model norm: 16.7671939794741.
Norm before scaling: 17.164189626008508. Distance: 4.251785352110325
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.4627, Accuracy: 8586/10000 (85.8600%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0520, Accuracy: 8751/8968 (97.5803%)
Scaling by  100
Scaled Norm after poisoning: 424.9673333033964, distance: 425.17854705405824
Total norm for 4 adversaries is: 424.9673333033964. distance: 425.17854705405824
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  55, local model 17, internal_epoch   1,  Average loss: 0.0018, Accuracy: 605/620 (97.5806%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1357, Accuracy: 9560/10000 (95.6000%)
___Train Local_Simple,  epoch  55, local model 65, internal_epoch   1,  Average loss: 0.0009, Accuracy: 365/371 (98.3827%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1727, Accuracy: 9481/10000 (94.8100%)
___Train Local_Simple,  epoch  55, local model 6, internal_epoch   1,  Average loss: 0.0018, Accuracy: 594/615 (96.5854%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.5749, Accuracy: 8514/10000 (85.1400%)
___Train Local_Simple,  epoch  55, local model 24, internal_epoch   1,  Average loss: 0.0021, Accuracy: 363/379 (95.7784%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1381, Accuracy: 9556/10000 (95.5600%)
___Train Local_Simple,  epoch  55, local model 86, internal_epoch   1,  Average loss: 0.0009, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1137, Accuracy: 9652/10000 (96.5200%)
___Train Local_Simple,  epoch  55, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 490/499 (98.1964%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.2341, Accuracy: 9376/10000 (93.7600%)
time spent on training: 83.03859806060791
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.45925632911392406  data num: [606, 591, 568, 557, 620, 371, 615, 379, 250, 499]
[foolsgold agg] considering poison per batch poison_fraction: 0.14351760284810128
[foolsgold agg] wv: [1.         1.         0.99101548 0.99101548 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 55: Average loss: 0.0941, Accuracy: 9729/10000 (97.2900%)
___Test Target_Simple poisoned: True, epoch: 55: Average loss: 9.8951, Accuracy: 81/8968 (0.9032%)
Done in 99.72471332550049 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:56 choose agents : [41, 73, 51, 74, 84, 85, 60, 94, 30, 76]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   1,  Average loss: 0.0191, Accuracy: 385/606 (63.5314%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   2,  Average loss: 0.0138, Accuracy: 377/606 (62.2112%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   3,  Average loss: 0.0127, Accuracy: 327/606 (53.9604%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   4,  Average loss: 0.0113, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   5,  Average loss: 0.0106, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   6,  Average loss: 0.0103, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   9,  Average loss: 0.0094, Accuracy: 435/606 (71.7822%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch  10,  Average loss: 0.0097, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Global model norm: 16.772784322983245.
Norm before scaling: 16.866670940735368. Distance: 3.724510027516151
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.2005, Accuracy: 5680/10000 (56.8000%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.6797, Accuracy: 5697/8968 (63.5259%)
Scaling by  100
Scaled Norm after poisoning: 371.3889049904426, distance: 372.4510034890495
Total norm for 4 adversaries is: 371.3889049904426. distance: 372.4510034890495
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 93.3170, Accuracy: 5777/8968 (64.4179%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   1,  Average loss: 0.0243, Accuracy: 330/591 (55.8376%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   2,  Average loss: 0.0239, Accuracy: 283/591 (47.8849%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   3,  Average loss: 0.0094, Accuracy: 479/591 (81.0491%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   4,  Average loss: 0.0066, Accuracy: 516/591 (87.3096%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   5,  Average loss: 0.0056, Accuracy: 536/591 (90.6937%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   6,  Average loss: 0.0050, Accuracy: 533/591 (90.1861%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   7,  Average loss: 0.0040, Accuracy: 547/591 (92.5550%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   8,  Average loss: 0.0032, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   9,  Average loss: 0.0030, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch  10,  Average loss: 0.0030, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Global model norm: 16.772784322983245.
Norm before scaling: 17.24030329957475. Distance: 5.564732478618693
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.9044, Accuracy: 7208/10000 (72.0800%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.1955, Accuracy: 8201/8968 (91.4474%)
Scaling by  100
Scaled Norm after poisoning: 555.3713284821247, distance: 556.4732417196716
Total norm for 4 adversaries is: 555.3713284821247. distance: 556.4732417196716
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 238987.2277, Accuracy: 4734/8968 (52.7877%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   1,  Average loss: 0.0191, Accuracy: 388/568 (68.3099%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   2,  Average loss: 0.0061, Accuracy: 508/568 (89.4366%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   3,  Average loss: 0.0024, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   4,  Average loss: 0.0027, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   5,  Average loss: 0.0019, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   6,  Average loss: 0.0016, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   7,  Average loss: 0.0016, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   8,  Average loss: 0.0013, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   9,  Average loss: 0.0014, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch  10,  Average loss: 0.0011, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Global model norm: 16.772784322983245.
Norm before scaling: 16.9830093747214. Distance: 3.9579937170132062
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.8330, Accuracy: 7123/10000 (71.2300%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0455, Accuracy: 8813/8968 (98.2716%)
Scaling by  100
Scaled Norm after poisoning: 395.0715322887743, distance: 395.7993691569
Total norm for 4 adversaries is: 395.0715322887743. distance: 395.7993691569
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 1356.3266, Accuracy: 8883/8968 (99.0522%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   1,  Average loss: 0.0158, Accuracy: 417/557 (74.8654%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 509/557 (91.3824%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   3,  Average loss: 0.0027, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   4,  Average loss: 0.0021, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   5,  Average loss: 0.0019, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   8,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Global model norm: 16.772784322983245.
Norm before scaling: 17.038574435639507. Distance: 3.5021832332549354
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.4761, Accuracy: 8533/10000 (85.3300%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0274, Accuracy: 8865/8968 (98.8515%)
Scaling by  100
Scaled Norm after poisoning: 350.15188668633505, distance: 350.2183247632825
Total norm for 4 adversaries is: 350.15188668633505. distance: 350.2183247632825
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  56, local model 84, internal_epoch   1,  Average loss: 0.0018, Accuracy: 1207/1246 (96.8700%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1993, Accuracy: 9376/10000 (93.7600%)
___Train Local_Simple,  epoch  56, local model 85, internal_epoch   1,  Average loss: 0.0010, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.2177, Accuracy: 9351/10000 (93.5100%)
___Train Local_Simple,  epoch  56, local model 60, internal_epoch   1,  Average loss: 0.0021, Accuracy: 323/338 (95.5621%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1876, Accuracy: 9420/10000 (94.2000%)
___Train Local_Simple,  epoch  56, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 144/150 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1335, Accuracy: 9617/10000 (96.1700%)
___Train Local_Simple,  epoch  56, local model 30, internal_epoch   1,  Average loss: 0.0017, Accuracy: 388/400 (97.0000%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.4632, Accuracy: 8735/10000 (87.3500%)
___Train Local_Simple,  epoch  56, local model 76, internal_epoch   1,  Average loss: 0.0012, Accuracy: 77/78 (98.7179%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1025, Accuracy: 9711/10000 (97.1100%)
time spent on training: 79.59926056861877
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4676737160120846  data num: [606, 591, 568, 557, 1246, 431, 338, 150, 400, 78]
[foolsgold agg] considering poison per batch poison_fraction: 0.14614803625377643
[foolsgold agg] wv: [1.         1.         0.96270541 0.96270541 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 56: Average loss: 0.0944, Accuracy: 9727/10000 (97.2700%)
___Test Target_Simple poisoned: True, epoch: 56: Average loss: 9.8733, Accuracy: 80/8968 (0.8921%)
Done in 93.18995451927185 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:57 choose agents : [41, 73, 51, 74, 42, 25, 16, 95, 52, 59]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   1,  Average loss: 0.0187, Accuracy: 387/606 (63.8614%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   2,  Average loss: 0.0136, Accuracy: 391/606 (64.5215%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   3,  Average loss: 0.0124, Accuracy: 317/606 (52.3102%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   4,  Average loss: 0.0110, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   5,  Average loss: 0.0109, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   6,  Average loss: 0.0101, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   7,  Average loss: 0.0097, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   9,  Average loss: 0.0099, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch  10,  Average loss: 0.0099, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Global model norm: 16.77812452708837.
Norm before scaling: 16.867384711098147. Distance: 3.935457093229935
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.1722, Accuracy: 6168/10000 (61.6800%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.7483, Accuracy: 5589/8968 (62.3216%)
Scaling by  100
Scaled Norm after poisoning: 392.3152829676662, distance: 393.54572081906826
Total norm for 4 adversaries is: 392.3152829676662. distance: 393.54572081906826
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 24810.0400, Accuracy: 178/8968 (1.9848%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   1,  Average loss: 0.0257, Accuracy: 329/591 (55.6684%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   2,  Average loss: 0.0114, Accuracy: 421/591 (71.2352%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   3,  Average loss: 0.0050, Accuracy: 531/591 (89.8477%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   4,  Average loss: 0.0044, Accuracy: 544/591 (92.0474%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   5,  Average loss: 0.0038, Accuracy: 546/591 (92.3858%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   6,  Average loss: 0.0031, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   7,  Average loss: 0.0030, Accuracy: 557/591 (94.2470%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   8,  Average loss: 0.0026, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   9,  Average loss: 0.0020, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch  10,  Average loss: 0.0020, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Global model norm: 16.77812452708837.
Norm before scaling: 17.1604536843959. Distance: 5.049967004649325
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.8070, Accuracy: 7539/10000 (75.3900%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0740, Accuracy: 8701/8968 (97.0227%)
Scaling by  100
Scaled Norm after poisoning: 504.03424052835936, distance: 504.996673875185
Total norm for 4 adversaries is: 504.03424052835936. distance: 504.996673875185
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 2.2037, Accuracy: 8967/8968 (99.9888%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   1,  Average loss: 0.0216, Accuracy: 329/568 (57.9225%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   2,  Average loss: 0.0090, Accuracy: 472/568 (83.0986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   3,  Average loss: 0.0043, Accuracy: 519/568 (91.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   4,  Average loss: 0.0040, Accuracy: 514/568 (90.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   5,  Average loss: 0.0031, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   6,  Average loss: 0.0026, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   7,  Average loss: 0.0022, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   8,  Average loss: 0.0020, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   9,  Average loss: 0.0017, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch  10,  Average loss: 0.0018, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Global model norm: 16.77812452708837.
Norm before scaling: 17.042365746122496. Distance: 4.415897926270405
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.1443, Accuracy: 6197/10000 (61.9700%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0735, Accuracy: 8739/8968 (97.4465%)
Scaling by  100
Scaled Norm after poisoning: 440.7115872370501, distance: 441.5897771121972
Total norm for 4 adversaries is: 440.7115872370501. distance: 441.5897771121972
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 799.9203, Accuracy: 8819/8968 (98.3385%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   1,  Average loss: 0.0169, Accuracy: 405/557 (72.7110%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   2,  Average loss: 0.0060, Accuracy: 476/557 (85.4578%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   3,  Average loss: 0.0025, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   4,  Average loss: 0.0021, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   5,  Average loss: 0.0018, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   6,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   7,  Average loss: 0.0016, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   8,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Global model norm: 16.77812452708837.
Norm before scaling: 17.062995428361376. Distance: 3.709023329302744
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.4146, Accuracy: 8768/10000 (87.6800%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0263, Accuracy: 8868/8968 (98.8849%)
Scaling by  100
Scaled Norm after poisoning: 370.72684098268365, distance: 370.9023414256103
Total norm for 4 adversaries is: 370.72684098268365. distance: 370.9023414256103
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  57, local model 42, internal_epoch   1,  Average loss: 0.0020, Accuracy: 228/236 (96.6102%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1802, Accuracy: 9448/10000 (94.4800%)
___Train Local_Simple,  epoch  57, local model 25, internal_epoch   1,  Average loss: 0.0020, Accuracy: 620/647 (95.8269%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.7120, Accuracy: 8016/10000 (80.1600%)
___Train Local_Simple,  epoch  57, local model 16, internal_epoch   1,  Average loss: 0.0016, Accuracy: 887/915 (96.9399%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1478, Accuracy: 9573/10000 (95.7300%)
___Train Local_Simple,  epoch  57, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 597/602 (99.1694%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.2939, Accuracy: 7733/10000 (77.3300%)
___Train Local_Simple,  epoch  57, local model 52, internal_epoch   1,  Average loss: 0.0011, Accuracy: 248/253 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1922, Accuracy: 9421/10000 (94.2100%)
___Train Local_Simple,  epoch  57, local model 59, internal_epoch   1,  Average loss: 0.0019, Accuracy: 734/760 (96.5789%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.0590, Accuracy: 7461/10000 (74.6100%)
time spent on training: 79.92706632614136
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4048823016564952  data num: [606, 591, 568, 557, 236, 647, 915, 602, 253, 760]
[foolsgold agg] considering poison per batch poison_fraction: 0.12652571926765474
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 57: Average loss: 0.0949, Accuracy: 9724/10000 (97.2400%)
___Test Target_Simple poisoned: True, epoch: 57: Average loss: 9.8347, Accuracy: 82/8968 (0.9144%)
Done in 92.77218413352966 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:58 choose agents : [41, 73, 51, 74, 52, 81, 77, 21, 10, 8]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   1,  Average loss: 0.0218, Accuracy: 365/606 (60.2310%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   2,  Average loss: 0.0131, Accuracy: 368/606 (60.7261%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   3,  Average loss: 0.0117, Accuracy: 374/606 (61.7162%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   4,  Average loss: 0.0106, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   5,  Average loss: 0.0103, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   6,  Average loss: 0.0102, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   9,  Average loss: 0.0095, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch  10,  Average loss: 0.0099, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Global model norm: 16.78267568431804.
Norm before scaling: 16.95851998691172. Distance: 4.393565649123634
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.1931, Accuracy: 6007/10000 (60.0700%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.6957, Accuracy: 5578/8968 (62.1989%)
Scaling by  100
Scaled Norm after poisoning: 438.15386852109384, distance: 439.3565429978254
Total norm for 4 adversaries is: 438.15386852109384. distance: 439.3565429978254
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 110.7485, Accuracy: 8857/8968 (98.7623%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   1,  Average loss: 0.0254, Accuracy: 324/591 (54.8223%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   2,  Average loss: 0.0106, Accuracy: 437/591 (73.9425%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   3,  Average loss: 0.0045, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   4,  Average loss: 0.0039, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   5,  Average loss: 0.0037, Accuracy: 551/591 (93.2318%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   6,  Average loss: 0.0031, Accuracy: 557/591 (94.2470%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   7,  Average loss: 0.0026, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   8,  Average loss: 0.0025, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   9,  Average loss: 0.0020, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch  10,  Average loss: 0.0023, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Global model norm: 16.78267568431804.
Norm before scaling: 17.066270795840346. Distance: 4.53121821951409
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.8493, Accuracy: 6806/10000 (68.0600%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0985, Accuracy: 8601/8968 (95.9077%)
Scaling by  100
Scaled Norm after poisoning: 452.2254001048592, distance: 453.12182757510146
Total norm for 4 adversaries is: 452.2254001048592. distance: 453.12182757510146
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 26.9504, Accuracy: 8966/8968 (99.9777%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   1,  Average loss: 0.0206, Accuracy: 345/568 (60.7394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   2,  Average loss: 0.0070, Accuracy: 468/568 (82.3944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   3,  Average loss: 0.0029, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   4,  Average loss: 0.0029, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   5,  Average loss: 0.0022, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   6,  Average loss: 0.0023, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   7,  Average loss: 0.0021, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   8,  Average loss: 0.0018, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   9,  Average loss: 0.0015, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch  10,  Average loss: 0.0017, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Global model norm: 16.78267568431804.
Norm before scaling: 17.05309307423253. Distance: 4.316787578602785
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.9737, Accuracy: 6456/10000 (64.5600%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0438, Accuracy: 8852/8968 (98.7065%)
Scaling by  100
Scaled Norm after poisoning: 430.90573215031617, distance: 431.67875425482777
Total norm for 4 adversaries is: 430.90573215031617. distance: 431.67875425482777
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 20920.5423, Accuracy: 7248/8968 (80.8207%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   1,  Average loss: 0.0213, Accuracy: 376/557 (67.5045%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   2,  Average loss: 0.0062, Accuracy: 488/557 (87.6122%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   3,  Average loss: 0.0032, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   4,  Average loss: 0.0029, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   5,  Average loss: 0.0024, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   6,  Average loss: 0.0024, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   7,  Average loss: 0.0019, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   9,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Global model norm: 16.78267568431804.
Norm before scaling: 17.29263388751344. Distance: 4.842085817001192
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.7293, Accuracy: 7711/10000 (77.1100%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0334, Accuracy: 8840/8968 (98.5727%)
Scaling by  100
Scaled Norm after poisoning: 483.87264272223535, distance: 484.20856818110934
Total norm for 4 adversaries is: 483.87264272223535. distance: 484.20856818110934
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  58, local model 52, internal_epoch   1,  Average loss: 0.0009, Accuracy: 247/253 (97.6285%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1541, Accuracy: 9542/10000 (95.4200%)
___Train Local_Simple,  epoch  58, local model 81, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1207/1227 (98.3700%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.4807, Accuracy: 8805/10000 (88.0500%)
___Train Local_Simple,  epoch  58, local model 77, internal_epoch   1,  Average loss: 0.0021, Accuracy: 565/589 (95.9253%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1572, Accuracy: 9514/10000 (95.1400%)
___Train Local_Simple,  epoch  58, local model 21, internal_epoch   1,  Average loss: 0.0016, Accuracy: 302/312 (96.7949%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.2298, Accuracy: 9328/10000 (93.2800%)
___Train Local_Simple,  epoch  58, local model 10, internal_epoch   1,  Average loss: 0.0017, Accuracy: 863/892 (96.7489%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.4038, Accuracy: 8705/10000 (87.0500%)
___Train Local_Simple,  epoch  58, local model 8, internal_epoch   1,  Average loss: 0.0020, Accuracy: 612/633 (96.6825%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.2152, Accuracy: 9335/10000 (93.3500%)
time spent on training: 78.52311158180237
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.37283236994219654  data num: [606, 591, 568, 557, 253, 1227, 589, 312, 892, 633]
[foolsgold agg] considering poison per batch poison_fraction: 0.11651011560693642
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 58: Average loss: 0.0952, Accuracy: 9724/10000 (97.2400%)
___Test Target_Simple poisoned: True, epoch: 58: Average loss: 9.8048, Accuracy: 84/8968 (0.9367%)
Done in 91.52675604820251 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:59 choose agents : [41, 73, 51, 74, 40, 54, 46, 30, 78, 9]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   1,  Average loss: 0.0207, Accuracy: 368/606 (60.7261%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   2,  Average loss: 0.0148, Accuracy: 366/606 (60.3960%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   3,  Average loss: 0.0133, Accuracy: 330/606 (54.4554%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   4,  Average loss: 0.0111, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   5,  Average loss: 0.0104, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   6,  Average loss: 0.0103, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   9,  Average loss: 0.0101, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch  10,  Average loss: 0.0097, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Global model norm: 16.78793821125053.
Norm before scaling: 16.930970006509614. Distance: 4.123765702970775
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.2259, Accuracy: 5701/10000 (57.0100%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.8914, Accuracy: 4819/8968 (53.7355%)
Scaling by  100
Scaled Norm after poisoning: 411.23960853132814, distance: 412.37657244319786
Total norm for 4 adversaries is: 411.23960853132814. distance: 412.37657244319786
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   1,  Average loss: 0.0247, Accuracy: 335/591 (56.6836%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   2,  Average loss: 0.0113, Accuracy: 430/591 (72.7580%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   3,  Average loss: 0.0046, Accuracy: 539/591 (91.2014%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   4,  Average loss: 0.0037, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   5,  Average loss: 0.0032, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   6,  Average loss: 0.0030, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   7,  Average loss: 0.0027, Accuracy: 564/591 (95.4315%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   8,  Average loss: 0.0019, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   9,  Average loss: 0.0019, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch  10,  Average loss: 0.0017, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Global model norm: 16.78793821125053.
Norm before scaling: 17.17102370785683. Distance: 4.894858578440207
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.7329, Accuracy: 7652/10000 (76.5200%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.1642, Accuracy: 8328/8968 (92.8635%)
Scaling by  100
Scaled Norm after poisoning: 488.6544503787927, distance: 489.4858431303198
Total norm for 4 adversaries is: 488.6544503787927. distance: 489.4858431303198
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 843.1517, Accuracy: 8950/8968 (99.7993%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   1,  Average loss: 0.0181, Accuracy: 374/568 (65.8451%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   2,  Average loss: 0.0056, Accuracy: 510/568 (89.7887%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   3,  Average loss: 0.0032, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   4,  Average loss: 0.0027, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   5,  Average loss: 0.0021, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   6,  Average loss: 0.0020, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   7,  Average loss: 0.0017, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   8,  Average loss: 0.0013, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   9,  Average loss: 0.0015, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch  10,  Average loss: 0.0013, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Global model norm: 16.78793821125053.
Norm before scaling: 17.018894242296376. Distance: 4.058657428142778
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.7656, Accuracy: 7440/10000 (74.4000%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0560, Accuracy: 8786/8968 (97.9706%)
Scaling by  100
Scaled Norm after poisoning: 405.1448814930284, distance: 405.86574134804727
Total norm for 4 adversaries is: 405.1448814930284. distance: 405.86574134804727
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 208954.1815, Accuracy: 3317/8968 (36.9871%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   1,  Average loss: 0.0167, Accuracy: 401/557 (71.9928%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 495/557 (88.8689%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   3,  Average loss: 0.0026, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   4,  Average loss: 0.0019, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   5,  Average loss: 0.0016, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   9,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Global model norm: 16.78793821125053.
Norm before scaling: 17.077637158517238. Distance: 3.7892735373333584
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.5492, Accuracy: 8289/10000 (82.8900%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0284, Accuracy: 8861/8968 (98.8069%)
Scaling by  100
Scaled Norm after poisoning: 378.69906835771326, distance: 378.92735121656233
Total norm for 4 adversaries is: 378.69906835771326. distance: 378.92735121656233
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  59, local model 40, internal_epoch   1,  Average loss: 0.0016, Accuracy: 745/772 (96.5026%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1348, Accuracy: 9597/10000 (95.9700%)
___Train Local_Simple,  epoch  59, local model 54, internal_epoch   1,  Average loss: 0.0014, Accuracy: 503/519 (96.9171%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.3858, Accuracy: 8807/10000 (88.0700%)
___Train Local_Simple,  epoch  59, local model 46, internal_epoch   1,  Average loss: 0.0021, Accuracy: 681/710 (95.9155%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2531, Accuracy: 9227/10000 (92.2700%)
___Train Local_Simple,  epoch  59, local model 30, internal_epoch   1,  Average loss: 0.0019, Accuracy: 386/400 (96.5000%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2785, Accuracy: 9226/10000 (92.2600%)
___Train Local_Simple,  epoch  59, local model 78, internal_epoch   1,  Average loss: 0.0009, Accuracy: 299/303 (98.6799%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1790, Accuracy: 9487/10000 (94.8700%)
___Train Local_Simple,  epoch  59, local model 9, internal_epoch   1,  Average loss: 0.0016, Accuracy: 419/436 (96.1009%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2525, Accuracy: 9229/10000 (92.2900%)
time spent on training: 74.77891850471497
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.42511900402782865  data num: [606, 591, 568, 557, 772, 519, 710, 400, 303, 436]
[foolsgold agg] considering poison per batch poison_fraction: 0.13284968875869646
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.83311337
 1.         1.         0.83311337 0.87552077]
___Test Target_Simple poisoned: False, epoch: 59: Average loss: 0.0957, Accuracy: 9725/10000 (97.2500%)
___Test Target_Simple poisoned: True, epoch: 59: Average loss: 9.8104, Accuracy: 85/8968 (0.9478%)
Done in 89.90963673591614 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:60 choose agents : [41, 73, 51, 74, 89, 4, 11, 24, 43, 23]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   1,  Average loss: 0.0209, Accuracy: 379/606 (62.5413%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   2,  Average loss: 0.0134, Accuracy: 379/606 (62.5413%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   3,  Average loss: 0.0113, Accuracy: 401/606 (66.1716%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   4,  Average loss: 0.0113, Accuracy: 393/606 (64.8515%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   5,  Average loss: 0.0102, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   6,  Average loss: 0.0103, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   7,  Average loss: 0.0104, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   8,  Average loss: 0.0103, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Global model norm: 16.793219078879726.
Norm before scaling: 16.939512464044864. Distance: 4.325027183491389
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.1161, Accuracy: 5690/10000 (56.9000%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.7949, Accuracy: 5673/8968 (63.2583%)
Scaling by  100
Scaled Norm after poisoning: 431.23489103967455, distance: 432.5027637194935
Total norm for 4 adversaries is: 431.23489103967455. distance: 432.5027637194935
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 401.7958, Accuracy: 8074/8968 (90.0312%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   1,  Average loss: 0.0252, Accuracy: 334/591 (56.5144%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   2,  Average loss: 0.0116, Accuracy: 431/591 (72.9272%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   3,  Average loss: 0.0053, Accuracy: 518/591 (87.6481%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   4,  Average loss: 0.0054, Accuracy: 527/591 (89.1709%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   5,  Average loss: 0.0042, Accuracy: 549/591 (92.8934%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   6,  Average loss: 0.0036, Accuracy: 551/591 (93.2318%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   7,  Average loss: 0.0033, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   8,  Average loss: 0.0027, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   9,  Average loss: 0.0025, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch  10,  Average loss: 0.0030, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Global model norm: 16.793219078879726.
Norm before scaling: 17.179886452918023. Distance: 5.141960364825133
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.0809, Accuracy: 6261/10000 (62.6100%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0496, Accuracy: 8811/8968 (98.2493%)
Scaling by  100
Scaled Norm after poisoning: 513.1756521893843, distance: 514.1960350877863
Total norm for 4 adversaries is: 513.1756521893843. distance: 514.1960350877863
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 27.2518, Accuracy: 8965/8968 (99.9665%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   1,  Average loss: 0.0179, Accuracy: 374/568 (65.8451%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   2,  Average loss: 0.0057, Accuracy: 506/568 (89.0845%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   3,  Average loss: 0.0024, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   4,  Average loss: 0.0022, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   5,  Average loss: 0.0018, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   6,  Average loss: 0.0016, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   7,  Average loss: 0.0012, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   8,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   9,  Average loss: 0.0010, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch  10,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Global model norm: 16.793219078879726.
Norm before scaling: 17.059765942523125. Distance: 4.092342455050552
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.7725, Accuracy: 7366/10000 (73.6600%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0285, Accuracy: 8875/8968 (98.9630%)
Scaling by  100
Scaled Norm after poisoning: 408.6346549792369, distance: 409.23423152273074
Total norm for 4 adversaries is: 408.6346549792369. distance: 409.23423152273074
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 10676.7190, Accuracy: 7676/8968 (85.5932%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   1,  Average loss: 0.0166, Accuracy: 403/557 (72.3519%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   2,  Average loss: 0.0064, Accuracy: 479/557 (85.9964%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   3,  Average loss: 0.0028, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   4,  Average loss: 0.0023, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   5,  Average loss: 0.0021, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   7,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   9,  Average loss: 0.0014, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch  10,  Average loss: 0.0015, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.793219078879726.
Norm before scaling: 17.10576981137779. Distance: 3.9578181818316276
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.5475, Accuracy: 8322/10000 (83.2200%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0256, Accuracy: 8870/8968 (98.9072%)
Scaling by  100
Scaled Norm after poisoning: 395.49759006851104, distance: 395.781801470204
Total norm for 4 adversaries is: 395.49759006851104. distance: 395.781801470204
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 161.5564, Accuracy: 8954/8968 (99.8439%)
___Train Local_Simple,  epoch  60, local model 89, internal_epoch   1,  Average loss: 0.0011, Accuracy: 482/492 (97.9675%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1944, Accuracy: 9397/10000 (93.9700%)
___Train Local_Simple,  epoch  60, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 638/658 (96.9605%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1581, Accuracy: 9506/10000 (95.0600%)
___Train Local_Simple,  epoch  60, local model 11, internal_epoch   1,  Average loss: 0.0016, Accuracy: 626/645 (97.0543%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2784, Accuracy: 9116/10000 (91.1600%)
___Train Local_Simple,  epoch  60, local model 24, internal_epoch   1,  Average loss: 0.0022, Accuracy: 367/379 (96.8338%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1486, Accuracy: 9534/10000 (95.3400%)
___Train Local_Simple,  epoch  60, local model 43, internal_epoch   1,  Average loss: 0.0010, Accuracy: 399/408 (97.7941%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2648, Accuracy: 9187/10000 (91.8700%)
___Train Local_Simple,  epoch  60, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1892, Accuracy: 9406/10000 (94.0600%)
time spent on training: 77.20315074920654
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4467962285934193  data num: [606, 591, 568, 557, 492, 658, 645, 379, 408, 293]
[foolsgold agg] considering poison per batch poison_fraction: 0.13962382143544352
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 60: Average loss: 0.0962, Accuracy: 9723/10000 (97.2300%)
___Test Target_Simple poisoned: True, epoch: 60: Average loss: 9.7718, Accuracy: 88/8968 (0.9813%)
Done in 90.07168197631836 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:61 choose agents : [41, 73, 51, 74, 25, 97, 91, 57, 72, 15]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   1,  Average loss: 0.0198, Accuracy: 372/606 (61.3861%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   2,  Average loss: 0.0133, Accuracy: 363/606 (59.9010%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   3,  Average loss: 0.0131, Accuracy: 318/606 (52.4752%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   4,  Average loss: 0.0105, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   5,  Average loss: 0.0109, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   6,  Average loss: 0.0099, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   7,  Average loss: 0.0099, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   8,  Average loss: 0.0098, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   9,  Average loss: 0.0095, Accuracy: 433/606 (71.4521%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 434/606 (71.6172%), train_poison_data_count: 200
Global model norm: 16.79806954327965.
Norm before scaling: 16.912002797511796. Distance: 4.061082093679768
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 1.1416, Accuracy: 6234/10000 (62.3400%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.6359, Accuracy: 6259/8968 (69.7926%)
Scaling by  100
Scaled Norm after poisoning: 404.8961286552392, distance: 406.1081867864769
Total norm for 4 adversaries is: 404.8961286552392. distance: 406.1081867864769
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   1,  Average loss: 0.0241, Accuracy: 326/591 (55.1607%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   2,  Average loss: 0.0113, Accuracy: 432/591 (73.0964%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   3,  Average loss: 0.0052, Accuracy: 517/591 (87.4788%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   4,  Average loss: 0.0043, Accuracy: 545/591 (92.2166%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   5,  Average loss: 0.0033, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   6,  Average loss: 0.0025, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   7,  Average loss: 0.0021, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   8,  Average loss: 0.0020, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   9,  Average loss: 0.0020, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch  10,  Average loss: 0.0015, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Global model norm: 16.79806954327965.
Norm before scaling: 17.216649642202277. Distance: 4.863191632896689
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.6944, Accuracy: 7835/10000 (78.3500%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0691, Accuracy: 8706/8968 (97.0785%)
Scaling by  100
Scaled Norm after poisoning: 485.64103898867523, distance: 486.3191467544744
Total norm for 4 adversaries is: 485.64103898867523. distance: 486.3191467544744
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   1,  Average loss: 0.0192, Accuracy: 383/568 (67.4296%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   2,  Average loss: 0.0059, Accuracy: 521/568 (91.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   3,  Average loss: 0.0027, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   4,  Average loss: 0.0018, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   5,  Average loss: 0.0016, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   6,  Average loss: 0.0014, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   7,  Average loss: 0.0016, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   8,  Average loss: 0.0012, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   9,  Average loss: 0.0010, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch  10,  Average loss: 0.0010, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Global model norm: 16.79806954327965.
Norm before scaling: 17.12360370818824. Distance: 4.274393870789925
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.6566, Accuracy: 7797/10000 (77.9700%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0386, Accuracy: 8830/8968 (98.4612%)
Scaling by  100
Scaled Norm after poisoning: 426.9236978079338, distance: 427.43941456655585
Total norm for 4 adversaries is: 426.9236978079338. distance: 427.43941456655585
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 380.0060, Accuracy: 8862/8968 (98.8180%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   1,  Average loss: 0.0193, Accuracy: 382/557 (68.5817%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 504/557 (90.4847%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   3,  Average loss: 0.0033, Accuracy: 519/557 (93.1777%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   4,  Average loss: 0.0022, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   5,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   7,  Average loss: 0.0018, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch  10,  Average loss: 0.0013, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Global model norm: 16.79806954327965.
Norm before scaling: 17.175009666118093. Distance: 4.43481643554912
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.6088, Accuracy: 8148/10000 (81.4800%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0393, Accuracy: 8822/8968 (98.3720%)
Scaling by  100
Scaled Norm after poisoning: 443.0259233385785, distance: 443.4816265923539
Total norm for 4 adversaries is: 443.0259233385785. distance: 443.4816265923539
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 174.0507, Accuracy: 8966/8968 (99.9777%)
___Train Local_Simple,  epoch  61, local model 25, internal_epoch   1,  Average loss: 0.0024, Accuracy: 614/647 (94.8995%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.5815, Accuracy: 8233/10000 (82.3300%)
___Train Local_Simple,  epoch  61, local model 97, internal_epoch   1,  Average loss: 0.0009, Accuracy: 478/487 (98.1520%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.5607, Accuracy: 8704/10000 (87.0400%)
___Train Local_Simple,  epoch  61, local model 91, internal_epoch   1,  Average loss: 0.0009, Accuracy: 252/256 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1094, Accuracy: 9674/10000 (96.7400%)
___Train Local_Simple,  epoch  61, local model 57, internal_epoch   1,  Average loss: 0.0022, Accuracy: 329/343 (95.9184%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.3564, Accuracy: 9081/10000 (90.8100%)
___Train Local_Simple,  epoch  61, local model 72, internal_epoch   1,  Average loss: 0.0006, Accuracy: 722/731 (98.7688%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2639, Accuracy: 9252/10000 (92.5200%)
___Train Local_Simple,  epoch  61, local model 15, internal_epoch   1,  Average loss: 0.0018, Accuracy: 391/401 (97.5062%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1515, Accuracy: 9522/10000 (95.2200%)
time spent on training: 81.71931743621826
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4476576055523424  data num: [606, 591, 568, 557, 647, 487, 256, 343, 731, 401]
[foolsgold agg] considering poison per batch poison_fraction: 0.139893001735107
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 61: Average loss: 0.0964, Accuracy: 9722/10000 (97.2200%)
___Test Target_Simple poisoned: True, epoch: 61: Average loss: 9.7334, Accuracy: 92/8968 (1.0259%)
Done in 98.1347234249115 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:62 choose agents : [41, 73, 51, 74, 94, 95, 90, 69, 20, 81]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   1,  Average loss: 0.0197, Accuracy: 384/606 (63.3663%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   2,  Average loss: 0.0123, Accuracy: 371/606 (61.2211%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   3,  Average loss: 0.0117, Accuracy: 357/606 (58.9109%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   4,  Average loss: 0.0109, Accuracy: 400/606 (66.0066%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   5,  Average loss: 0.0101, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   6,  Average loss: 0.0102, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   7,  Average loss: 0.0097, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   9,  Average loss: 0.0096, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Global model norm: 16.803123837641767.
Norm before scaling: 16.903778628862653. Distance: 3.9681654371952138
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 1.1505, Accuracy: 6357/10000 (63.5700%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.8402, Accuracy: 5302/8968 (59.1213%)
Scaling by  100
Scaled Norm after poisoning: 395.6138821502602, distance: 396.81651143822126
Total norm for 4 adversaries is: 395.6138821502602. distance: 396.81651143822126
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 14147.7685, Accuracy: 137/8968 (1.5277%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   1,  Average loss: 0.0255, Accuracy: 317/591 (53.6379%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   2,  Average loss: 0.0106, Accuracy: 447/591 (75.6345%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   3,  Average loss: 0.0055, Accuracy: 515/591 (87.1404%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   4,  Average loss: 0.0045, Accuracy: 540/591 (91.3706%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   5,  Average loss: 0.0038, Accuracy: 557/591 (94.2470%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   6,  Average loss: 0.0032, Accuracy: 561/591 (94.9239%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   7,  Average loss: 0.0027, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   8,  Average loss: 0.0025, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   9,  Average loss: 0.0021, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch  10,  Average loss: 0.0021, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Global model norm: 16.803123837641767.
Norm before scaling: 17.172323733047257. Distance: 5.053743300771979
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.8306, Accuracy: 7439/10000 (74.3900%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.1157, Accuracy: 8525/8968 (95.0602%)
Scaling by  100
Scaled Norm after poisoning: 504.36683698474866, distance: 505.37431981156305
Total norm for 4 adversaries is: 504.36683698474866. distance: 505.37431981156305
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 82.6126, Accuracy: 8966/8968 (99.9777%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   1,  Average loss: 0.0187, Accuracy: 393/568 (69.1901%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   2,  Average loss: 0.0058, Accuracy: 524/568 (92.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   3,  Average loss: 0.0023, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   4,  Average loss: 0.0023, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   5,  Average loss: 0.0015, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   6,  Average loss: 0.0017, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   7,  Average loss: 0.0014, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   8,  Average loss: 0.0011, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   9,  Average loss: 0.0011, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch  10,  Average loss: 0.0010, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Global model norm: 16.803123837641767.
Norm before scaling: 17.04748545252074. Distance: 4.08401449840935
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.8216, Accuracy: 7307/10000 (73.0700%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0151, Accuracy: 8910/8968 (99.3533%)
Scaling by  100
Scaled Norm after poisoning: 407.7172350416401, distance: 408.4014377729344
Total norm for 4 adversaries is: 407.7172350416401. distance: 408.4014377729344
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 197.4080, Accuracy: 8956/8968 (99.8662%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   1,  Average loss: 0.0159, Accuracy: 412/557 (73.9677%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 499/557 (89.5871%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   3,  Average loss: 0.0018, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   4,  Average loss: 0.0016, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   5,  Average loss: 0.0017, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   6,  Average loss: 0.0013, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   7,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Global model norm: 16.803123837641767.
Norm before scaling: 17.060290071228366. Distance: 3.602954123978632
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.4389, Accuracy: 8634/10000 (86.3400%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0331, Accuracy: 8853/8968 (98.7177%)
Scaling by  100
Scaled Norm after poisoning: 360.0942476456685, distance: 360.2954083110136
Total norm for 4 adversaries is: 360.0942476456685. distance: 360.2954083110136
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  62, local model 94, internal_epoch   1,  Average loss: 0.0026, Accuracy: 142/150 (94.6667%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.2024, Accuracy: 9416/10000 (94.1600%)
___Train Local_Simple,  epoch  62, local model 95, internal_epoch   1,  Average loss: 0.0006, Accuracy: 596/602 (99.0033%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.9828, Accuracy: 8019/10000 (80.1900%)
___Train Local_Simple,  epoch  62, local model 90, internal_epoch   1,  Average loss: 0.0022, Accuracy: 657/683 (96.1933%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.7766, Accuracy: 8090/10000 (80.9000%)
___Train Local_Simple,  epoch  62, local model 69, internal_epoch   1,  Average loss: 0.0023, Accuracy: 244/256 (95.3125%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.2292, Accuracy: 9322/10000 (93.2200%)
___Train Local_Simple,  epoch  62, local model 20, internal_epoch   1,  Average loss: 0.0018, Accuracy: 415/429 (96.7366%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.4306, Accuracy: 8796/10000 (87.9600%)
___Train Local_Simple,  epoch  62, local model 81, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1202/1227 (97.9625%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.6508, Accuracy: 8547/10000 (85.4700%)
time spent on training: 76.90546321868896
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.40959604868583527  data num: [606, 591, 568, 557, 150, 602, 683, 256, 429, 1227]
[foolsgold agg] considering poison per batch poison_fraction: 0.12799876521432352
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 62: Average loss: 0.0964, Accuracy: 9720/10000 (97.2000%)
___Test Target_Simple poisoned: True, epoch: 62: Average loss: 9.6412, Accuracy: 98/8968 (1.0928%)
Done in 89.90656805038452 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:63 choose agents : [41, 73, 51, 74, 59, 21, 69, 14, 28, 22]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   1,  Average loss: 0.0206, Accuracy: 379/606 (62.5413%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   2,  Average loss: 0.0130, Accuracy: 372/606 (61.3861%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   3,  Average loss: 0.0113, Accuracy: 361/606 (59.5710%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   4,  Average loss: 0.0106, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   5,  Average loss: 0.0103, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   6,  Average loss: 0.0099, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Global model norm: 16.807536587281685.
Norm before scaling: 16.945061266291113. Distance: 4.115933945862603
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 1.2633, Accuracy: 5566/10000 (55.6600%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.6687, Accuracy: 6117/8968 (68.2092%)
Scaling by  100
Scaled Norm after poisoning: 410.44090241470815, distance: 411.59341664438705
Total norm for 4 adversaries is: 410.44090241470815. distance: 411.59341664438705
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 38.2336, Accuracy: 8913/8968 (99.3867%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   1,  Average loss: 0.0240, Accuracy: 330/591 (55.8376%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   2,  Average loss: 0.0106, Accuracy: 442/591 (74.7885%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   3,  Average loss: 0.0044, Accuracy: 535/591 (90.5245%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   4,  Average loss: 0.0033, Accuracy: 553/591 (93.5702%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   5,  Average loss: 0.0028, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   6,  Average loss: 0.0022, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   7,  Average loss: 0.0019, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   8,  Average loss: 0.0018, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   9,  Average loss: 0.0016, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch  10,  Average loss: 0.0019, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Global model norm: 16.807536587281685.
Norm before scaling: 17.152176058876247. Distance: 4.667720312426513
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.5962, Accuracy: 8061/10000 (80.6100%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0831, Accuracy: 8666/8968 (96.6325%)
Scaling by  100
Scaled Norm after poisoning: 465.9937969007742, distance: 466.77202679680795
Total norm for 4 adversaries is: 465.9937969007742. distance: 466.77202679680795
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 19375.8290, Accuracy: 1379/8968 (15.3769%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   1,  Average loss: 0.0177, Accuracy: 411/568 (72.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   2,  Average loss: 0.0072, Accuracy: 487/568 (85.7394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   3,  Average loss: 0.0032, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   4,  Average loss: 0.0024, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   5,  Average loss: 0.0027, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   6,  Average loss: 0.0020, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   7,  Average loss: 0.0017, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   8,  Average loss: 0.0016, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   9,  Average loss: 0.0015, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch  10,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Global model norm: 16.807536587281685.
Norm before scaling: 16.989483441453476. Distance: 3.808315169098411
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.8011, Accuracy: 7156/10000 (71.5600%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0408, Accuracy: 8871/8968 (98.9184%)
Scaling by  100
Scaled Norm after poisoning: 380.10489917258366, distance: 380.83153263615134
Total norm for 4 adversaries is: 380.10489917258366. distance: 380.83153263615134
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 14905.5094, Accuracy: 6464/8968 (72.0785%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   1,  Average loss: 0.0169, Accuracy: 416/557 (74.6858%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 486/557 (87.2531%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   3,  Average loss: 0.0029, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   4,  Average loss: 0.0019, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   5,  Average loss: 0.0020, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   8,  Average loss: 0.0014, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch  10,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Global model norm: 16.807536587281685.
Norm before scaling: 17.109369648971764. Distance: 3.9005777909133292
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.4333, Accuracy: 8649/10000 (86.4900%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0268, Accuracy: 8876/8968 (98.9741%)
Scaling by  100
Scaled Norm after poisoning: 389.7817899158451, distance: 390.0578082156541
Total norm for 4 adversaries is: 389.7817899158451. distance: 390.0578082156541
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  63, local model 59, internal_epoch   1,  Average loss: 0.0016, Accuracy: 735/760 (96.7105%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.4592, Accuracy: 8557/10000 (85.5700%)
___Train Local_Simple,  epoch  63, local model 21, internal_epoch   1,  Average loss: 0.0018, Accuracy: 299/312 (95.8333%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.4079, Accuracy: 8797/10000 (87.9700%)
___Train Local_Simple,  epoch  63, local model 69, internal_epoch   1,  Average loss: 0.0030, Accuracy: 242/256 (94.5312%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2776, Accuracy: 9162/10000 (91.6200%)
___Train Local_Simple,  epoch  63, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 364/376 (96.8085%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2554, Accuracy: 9289/10000 (92.8900%)
___Train Local_Simple,  epoch  63, local model 28, internal_epoch   1,  Average loss: 0.0016, Accuracy: 486/501 (97.0060%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2362, Accuracy: 9258/10000 (92.5800%)
___Train Local_Simple,  epoch  63, local model 22, internal_epoch   1,  Average loss: 0.0016, Accuracy: 564/583 (96.7410%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1693, Accuracy: 9528/10000 (95.2800%)
time spent on training: 75.89666175842285
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4544031311154599  data num: [606, 591, 568, 557, 760, 312, 256, 376, 501, 583]
[foolsgold agg] considering poison per batch poison_fraction: 0.1420009784735812
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.99347093
 0.99347093 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 63: Average loss: 0.0964, Accuracy: 9718/10000 (97.1800%)
___Test Target_Simple poisoned: True, epoch: 63: Average loss: 9.6310, Accuracy: 101/8968 (1.1262%)
Done in 89.063556432724 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:64 choose agents : [41, 73, 51, 74, 72, 97, 37, 50, 42, 52]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   1,  Average loss: 0.0199, Accuracy: 382/606 (63.0363%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   2,  Average loss: 0.0144, Accuracy: 380/606 (62.7063%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   3,  Average loss: 0.0124, Accuracy: 378/606 (62.3762%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   4,  Average loss: 0.0111, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   5,  Average loss: 0.0103, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   6,  Average loss: 0.0104, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 435/606 (71.7822%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   9,  Average loss: 0.0101, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Global model norm: 16.813173415300536.
Norm before scaling: 16.94825138761094. Distance: 4.192787817286505
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 1.2448, Accuracy: 5558/10000 (55.5800%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.7373, Accuracy: 5495/8968 (61.2734%)
Scaling by  100
Scaled Norm after poisoning: 418.0615796446739, distance: 419.27877062880253
Total norm for 4 adversaries is: 418.0615796446739. distance: 419.27877062880253
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   1,  Average loss: 0.0234, Accuracy: 338/591 (57.1912%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   2,  Average loss: 0.0091, Accuracy: 462/591 (78.1726%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   3,  Average loss: 0.0045, Accuracy: 543/591 (91.8782%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   4,  Average loss: 0.0040, Accuracy: 551/591 (93.2318%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   5,  Average loss: 0.0037, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   6,  Average loss: 0.0031, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   7,  Average loss: 0.0026, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   8,  Average loss: 0.0020, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   9,  Average loss: 0.0020, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch  10,  Average loss: 0.0020, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Global model norm: 16.813173415300536.
Norm before scaling: 17.17127874448211. Distance: 4.6937935858885735
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.7569, Accuracy: 7711/10000 (77.1100%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.1235, Accuracy: 8475/8968 (94.5027%)
Scaling by  100
Scaled Norm after poisoning: 468.6293678110667, distance: 469.3793441876197
Total norm for 4 adversaries is: 468.6293678110667. distance: 469.3793441876197
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   1,  Average loss: 0.0186, Accuracy: 390/568 (68.6620%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   2,  Average loss: 0.0056, Accuracy: 528/568 (92.9577%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   3,  Average loss: 0.0032, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   4,  Average loss: 0.0028, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   5,  Average loss: 0.0027, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   6,  Average loss: 0.0022, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   7,  Average loss: 0.0018, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   8,  Average loss: 0.0018, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   9,  Average loss: 0.0017, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch  10,  Average loss: 0.0017, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Global model norm: 16.813173415300536.
Norm before scaling: 17.047193655362676. Distance: 4.259376280708149
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 1.0384, Accuracy: 6555/10000 (65.5500%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0525, Accuracy: 8789/8968 (98.0040%)
Scaling by  100
Scaled Norm after poisoning: 425.0690568895835, distance: 425.937623807759
Total norm for 4 adversaries is: 425.0690568895835. distance: 425.937623807759
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 58500.4185, Accuracy: 2921/8968 (32.5714%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   1,  Average loss: 0.0212, Accuracy: 382/557 (68.5817%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 489/557 (87.7917%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   3,  Average loss: 0.0030, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   4,  Average loss: 0.0024, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   5,  Average loss: 0.0020, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   6,  Average loss: 0.0018, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Global model norm: 16.813173415300536.
Norm before scaling: 17.2364333610456. Distance: 4.6523017272845
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.5263, Accuracy: 8406/10000 (84.0600%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0366, Accuracy: 8817/8968 (98.3162%)
Scaling by  100
Scaled Norm after poisoning: 464.756505468186, distance: 465.23021854776374
Total norm for 4 adversaries is: 464.756505468186. distance: 465.23021854776374
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  64, local model 72, internal_epoch   1,  Average loss: 0.0010, Accuracy: 718/731 (98.2216%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.4736, Accuracy: 8821/10000 (88.2100%)
___Train Local_Simple,  epoch  64, local model 97, internal_epoch   1,  Average loss: 0.0009, Accuracy: 479/487 (98.3573%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.2457, Accuracy: 9266/10000 (92.6600%)
___Train Local_Simple,  epoch  64, local model 37, internal_epoch   1,  Average loss: 0.0017, Accuracy: 838/860 (97.4419%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.3215, Accuracy: 9055/10000 (90.5500%)
___Train Local_Simple,  epoch  64, local model 50, internal_epoch   1,  Average loss: 0.0027, Accuracy: 451/474 (95.1477%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.3945, Accuracy: 8870/10000 (88.7000%)
___Train Local_Simple,  epoch  64, local model 42, internal_epoch   1,  Average loss: 0.0019, Accuracy: 226/236 (95.7627%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1673, Accuracy: 9500/10000 (95.0000%)
___Train Local_Simple,  epoch  64, local model 52, internal_epoch   1,  Average loss: 0.0010, Accuracy: 248/253 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1386, Accuracy: 9574/10000 (95.7400%)
time spent on training: 78.18855476379395
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.43296662315867984  data num: [606, 591, 568, 557, 731, 487, 860, 474, 236, 253]
[foolsgold agg] considering poison per batch poison_fraction: 0.13530206973708744
[foolsgold agg] wv: [1.         1.         0.99337624 0.99337624 0.         1.
 1.         0.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 64: Average loss: 0.0964, Accuracy: 9718/10000 (97.1800%)
___Test Target_Simple poisoned: True, epoch: 64: Average loss: 9.5576, Accuracy: 106/8968 (1.1820%)
Done in 91.73473787307739 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:65 choose agents : [41, 73, 51, 74, 75, 62, 42, 43, 87, 26]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   1,  Average loss: 0.0196, Accuracy: 370/606 (61.0561%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   2,  Average loss: 0.0127, Accuracy: 377/606 (62.2112%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   3,  Average loss: 0.0113, Accuracy: 354/606 (58.4158%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   4,  Average loss: 0.0106, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   5,  Average loss: 0.0099, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   6,  Average loss: 0.0104, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   8,  Average loss: 0.0099, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   9,  Average loss: 0.0100, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Global model norm: 16.817872957959878.
Norm before scaling: 16.946992698512545. Distance: 4.216901360012838
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 1.2028, Accuracy: 6168/10000 (61.6800%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.5759, Accuracy: 6351/8968 (70.8185%)
Scaling by  100
Scaled Norm after poisoning: 420.43210658797216, distance: 421.6901446856447
Total norm for 4 adversaries is: 420.43210658797216. distance: 421.6901446856447
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 1.1583, Accuracy: 8954/8968 (99.8439%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   1,  Average loss: 0.0246, Accuracy: 309/591 (52.2843%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   2,  Average loss: 0.0093, Accuracy: 479/591 (81.0491%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   3,  Average loss: 0.0049, Accuracy: 532/591 (90.0169%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   4,  Average loss: 0.0045, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   5,  Average loss: 0.0039, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   6,  Average loss: 0.0032, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   7,  Average loss: 0.0032, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   8,  Average loss: 0.0025, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   9,  Average loss: 0.0026, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch  10,  Average loss: 0.0024, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Global model norm: 16.817872957959878.
Norm before scaling: 17.208107319502957. Distance: 5.07171131934647
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.8797, Accuracy: 7360/10000 (73.6000%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.1436, Accuracy: 8470/8968 (94.4469%)
Scaling by  100
Scaled Norm after poisoning: 506.22228319188, distance: 507.17113728996844
Total norm for 4 adversaries is: 506.22228319188. distance: 507.17113728996844
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 834713.8678, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   1,  Average loss: 0.0193, Accuracy: 359/568 (63.2042%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   2,  Average loss: 0.0058, Accuracy: 507/568 (89.2606%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   3,  Average loss: 0.0023, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   4,  Average loss: 0.0021, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   5,  Average loss: 0.0017, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   6,  Average loss: 0.0014, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   7,  Average loss: 0.0013, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   8,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   9,  Average loss: 0.0009, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch  10,  Average loss: 0.0008, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Global model norm: 16.817872957959878.
Norm before scaling: 17.103975853298973. Distance: 4.2471142115531295
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.7717, Accuracy: 7539/10000 (75.3900%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0246, Accuracy: 8879/8968 (99.0076%)
Scaling by  100
Scaled Norm after poisoning: 424.0629191228585, distance: 424.7114461608022
Total norm for 4 adversaries is: 424.0629191228585. distance: 424.7114461608022
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 6314.6380, Accuracy: 8844/8968 (98.6173%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   1,  Average loss: 0.0171, Accuracy: 390/557 (70.0180%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 478/557 (85.8169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   3,  Average loss: 0.0036, Accuracy: 520/557 (93.3573%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   4,  Average loss: 0.0029, Accuracy: 519/557 (93.1777%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   5,  Average loss: 0.0023, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   6,  Average loss: 0.0022, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   7,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   9,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Global model norm: 16.817872957959878.
Norm before scaling: 17.18265112710665. Distance: 4.209648656976678
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.5648, Accuracy: 8192/10000 (81.9200%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0345, Accuracy: 8841/8968 (98.5839%)
Scaling by  100
Scaled Norm after poisoning: 420.66903558498336, distance: 420.964888678379
Total norm for 4 adversaries is: 420.66903558498336. distance: 420.964888678379
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  65, local model 75, internal_epoch   1,  Average loss: 0.0012, Accuracy: 668/686 (97.3761%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1246, Accuracy: 9617/10000 (96.1700%)
___Train Local_Simple,  epoch  65, local model 62, internal_epoch   1,  Average loss: 0.0019, Accuracy: 411/423 (97.1631%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1607, Accuracy: 9539/10000 (95.3900%)
___Train Local_Simple,  epoch  65, local model 42, internal_epoch   1,  Average loss: 0.0017, Accuracy: 228/236 (96.6102%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.2259, Accuracy: 9306/10000 (93.0600%)
___Train Local_Simple,  epoch  65, local model 43, internal_epoch   1,  Average loss: 0.0015, Accuracy: 398/408 (97.5490%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1670, Accuracy: 9511/10000 (95.1100%)
___Train Local_Simple,  epoch  65, local model 87, internal_epoch   1,  Average loss: 0.0017, Accuracy: 454/470 (96.5957%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.2851, Accuracy: 9165/10000 (91.6500%)
___Train Local_Simple,  epoch  65, local model 26, internal_epoch   1,  Average loss: 0.0018, Accuracy: 535/554 (96.5704%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.2135, Accuracy: 9341/10000 (93.4100%)
time spent on training: 73.8413314819336
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.45538340851147285  data num: [606, 591, 568, 557, 686, 423, 236, 408, 470, 554]
[foolsgold agg] considering poison per batch poison_fraction: 0.14230731515983527
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 65: Average loss: 0.0963, Accuracy: 9717/10000 (97.1700%)
___Test Target_Simple poisoned: True, epoch: 65: Average loss: 9.4456, Accuracy: 114/8968 (1.2712%)
Done in 89.84785962104797 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:66 choose agents : [41, 73, 51, 74, 49, 52, 36, 55, 83, 33]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   1,  Average loss: 0.0218, Accuracy: 357/606 (58.9109%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   2,  Average loss: 0.0124, Accuracy: 376/606 (62.0462%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   3,  Average loss: 0.0121, Accuracy: 331/606 (54.6205%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   4,  Average loss: 0.0100, Accuracy: 439/606 (72.4422%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   5,  Average loss: 0.0102, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   6,  Average loss: 0.0100, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   7,  Average loss: 0.0100, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   8,  Average loss: 0.0099, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   9,  Average loss: 0.0100, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch  10,  Average loss: 0.0097, Accuracy: 433/606 (71.4521%), train_poison_data_count: 200
Global model norm: 16.822590235642313.
Norm before scaling: 16.991815728691638. Distance: 4.307729985522982
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 1.1758, Accuracy: 6269/10000 (62.6900%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.7239, Accuracy: 5435/8968 (60.6044%)
Scaling by  100
Scaled Norm after poisoning: 429.610215777046, distance: 430.7729970645793
Total norm for 4 adversaries is: 429.610215777046. distance: 430.7729970645793
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 562.9949, Accuracy: 8070/8968 (89.9866%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   1,  Average loss: 0.0236, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   2,  Average loss: 0.0141, Accuracy: 442/591 (74.7885%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   3,  Average loss: 0.0058, Accuracy: 532/591 (90.0169%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   4,  Average loss: 0.0050, Accuracy: 546/591 (92.3858%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   5,  Average loss: 0.0045, Accuracy: 547/591 (92.5550%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   6,  Average loss: 0.0041, Accuracy: 547/591 (92.5550%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   7,  Average loss: 0.0035, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   8,  Average loss: 0.0034, Accuracy: 549/591 (92.8934%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   9,  Average loss: 0.0029, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch  10,  Average loss: 0.0020, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Global model norm: 16.822590235642313.
Norm before scaling: 17.311268676597894. Distance: 5.320935721172784
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.8820, Accuracy: 7215/10000 (72.1500%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.1861, Accuracy: 8340/8968 (92.9973%)
Scaling by  100
Scaled Norm after poisoning: 531.2658232937632, distance: 532.0935949154058
Total norm for 4 adversaries is: 531.2658232937632. distance: 532.0935949154058
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 44408.7611, Accuracy: 7673/8968 (85.5598%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   1,  Average loss: 0.0202, Accuracy: 349/568 (61.4437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   2,  Average loss: 0.0063, Accuracy: 503/568 (88.5563%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   3,  Average loss: 0.0034, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   4,  Average loss: 0.0027, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   5,  Average loss: 0.0026, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   6,  Average loss: 0.0024, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   7,  Average loss: 0.0015, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   8,  Average loss: 0.0018, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   9,  Average loss: 0.0016, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch  10,  Average loss: 0.0015, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Global model norm: 16.822590235642313.
Norm before scaling: 17.122940719308502. Distance: 4.467391868098143
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.9014, Accuracy: 6712/10000 (67.1200%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0456, Accuracy: 8817/8968 (98.3162%)
Scaling by  100
Scaled Norm after poisoning: 445.9626701025547, distance: 446.739192650477
Total norm for 4 adversaries is: 445.9626701025547. distance: 446.739192650477
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 31669.9339, Accuracy: 5270/8968 (58.7645%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   1,  Average loss: 0.0191, Accuracy: 378/557 (67.8636%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 484/557 (86.8941%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   3,  Average loss: 0.0031, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   4,  Average loss: 0.0023, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   5,  Average loss: 0.0023, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   6,  Average loss: 0.0018, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   7,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   9,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.822590235642313.
Norm before scaling: 17.33806741084394. Distance: 4.638213587558628
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.5532, Accuracy: 8260/10000 (82.6000%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0215, Accuracy: 8878/8968 (98.9964%)
Scaling by  100
Scaled Norm after poisoning: 463.70555716963327, distance: 463.8213388525802
Total norm for 4 adversaries is: 463.70555716963327. distance: 463.8213388525802
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  66, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 499/506 (98.6166%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.3627, Accuracy: 9124/10000 (91.2400%)
___Train Local_Simple,  epoch  66, local model 52, internal_epoch   1,  Average loss: 0.0011, Accuracy: 247/253 (97.6285%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1723, Accuracy: 9491/10000 (94.9100%)
___Train Local_Simple,  epoch  66, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 983/1005 (97.8109%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1859, Accuracy: 9411/10000 (94.1100%)
___Train Local_Simple,  epoch  66, local model 55, internal_epoch   1,  Average loss: 0.0018, Accuracy: 343/354 (96.8927%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.3960, Accuracy: 8898/10000 (88.9800%)
___Train Local_Simple,  epoch  66, local model 83, internal_epoch   1,  Average loss: 0.0020, Accuracy: 418/433 (96.5358%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1241, Accuracy: 9641/10000 (96.4100%)
___Train Local_Simple,  epoch  66, local model 33, internal_epoch   1,  Average loss: 0.0022, Accuracy: 597/623 (95.8266%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2843, Accuracy: 9115/10000 (91.1500%)
time spent on training: 76.1458830833435
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.42248908296943233  data num: [606, 591, 568, 557, 506, 253, 1005, 354, 433, 623]
[foolsgold agg] considering poison per batch poison_fraction: 0.1320278384279476
[foolsgold agg] wv: [1.         1.         1.         1.         0.72886602 1.
 1.         1.         0.72886602 1.        ]
___Test Target_Simple poisoned: False, epoch: 66: Average loss: 0.0968, Accuracy: 9713/10000 (97.1300%)
___Test Target_Simple poisoned: True, epoch: 66: Average loss: 9.4058, Accuracy: 118/8968 (1.3158%)
Done in 89.26858568191528 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:67 choose agents : [41, 73, 51, 74, 25, 15, 1, 67, 86, 4]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   1,  Average loss: 0.0206, Accuracy: 364/606 (60.0660%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   2,  Average loss: 0.0130, Accuracy: 390/606 (64.3564%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   3,  Average loss: 0.0119, Accuracy: 345/606 (56.9307%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   4,  Average loss: 0.0107, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   5,  Average loss: 0.0104, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   6,  Average loss: 0.0100, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   7,  Average loss: 0.0101, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   9,  Average loss: 0.0101, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Global model norm: 16.827815797704833.
Norm before scaling: 16.965724724564154. Distance: 4.193107608083039
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 1.0730, Accuracy: 6067/10000 (60.6700%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.7371, Accuracy: 5510/8968 (61.4407%)
Scaling by  100
Scaled Norm after poisoning: 418.10584784238546, distance: 419.3107625914222
Total norm for 4 adversaries is: 418.10584784238546. distance: 419.3107625914222
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 60.5378, Accuracy: 8821/8968 (98.3608%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   1,  Average loss: 0.0232, Accuracy: 357/591 (60.4061%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   2,  Average loss: 0.0075, Accuracy: 496/591 (83.9255%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   3,  Average loss: 0.0040, Accuracy: 549/591 (92.8934%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   4,  Average loss: 0.0036, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   5,  Average loss: 0.0032, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   6,  Average loss: 0.0026, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   7,  Average loss: 0.0026, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   8,  Average loss: 0.0021, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   9,  Average loss: 0.0018, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch  10,  Average loss: 0.0019, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Global model norm: 16.827815797704833.
Norm before scaling: 17.177174632899924. Distance: 4.828668557590436
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.7531, Accuracy: 7612/10000 (76.1200%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.1160, Accuracy: 8547/8968 (95.3055%)
Scaling by  100
Scaled Norm after poisoning: 481.9750544634027, distance: 482.8668456469133
Total norm for 4 adversaries is: 481.9750544634027. distance: 482.8668456469133
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 814.6126, Accuracy: 8953/8968 (99.8327%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   1,  Average loss: 0.0173, Accuracy: 412/568 (72.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   2,  Average loss: 0.0053, Accuracy: 518/568 (91.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   3,  Average loss: 0.0027, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   4,  Average loss: 0.0025, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   5,  Average loss: 0.0020, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   6,  Average loss: 0.0018, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   7,  Average loss: 0.0013, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   8,  Average loss: 0.0013, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch  10,  Average loss: 0.0011, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Global model norm: 16.827815797704833.
Norm before scaling: 16.998875300284116. Distance: 3.727186874449725
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.9017, Accuracy: 6740/10000 (67.4000%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0224, Accuracy: 8895/8968 (99.1860%)
Scaling by  100
Scaled Norm after poisoning: 372.01052152459346, distance: 372.71868580740625
Total norm for 4 adversaries is: 372.01052152459346. distance: 372.71868580740625
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 86.0221, Accuracy: 8962/8968 (99.9331%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   1,  Average loss: 0.0151, Accuracy: 409/557 (73.4291%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 502/557 (90.1257%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   3,  Average loss: 0.0024, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   4,  Average loss: 0.0017, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   5,  Average loss: 0.0019, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   6,  Average loss: 0.0016, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   7,  Average loss: 0.0016, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch  10,  Average loss: 0.0012, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Global model norm: 16.827815797704833.
Norm before scaling: 17.119693128741112. Distance: 3.775713942764718
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.4686, Accuracy: 8579/10000 (85.7900%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0158, Accuracy: 8912/8968 (99.3756%)
Scaling by  100
Scaled Norm after poisoning: 377.3706111039915, distance: 377.5713922558223
Total norm for 4 adversaries is: 377.3706111039915. distance: 377.5713922558223
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  67, local model 25, internal_epoch   1,  Average loss: 0.0017, Accuracy: 627/647 (96.9088%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.6459, Accuracy: 8167/10000 (81.6700%)
___Train Local_Simple,  epoch  67, local model 15, internal_epoch   1,  Average loss: 0.0014, Accuracy: 390/401 (97.2569%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1593, Accuracy: 9515/10000 (95.1500%)
___Train Local_Simple,  epoch  67, local model 1, internal_epoch   1,  Average loss: 0.0025, Accuracy: 723/760 (95.1316%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1862, Accuracy: 9394/10000 (93.9400%)
___Train Local_Simple,  epoch  67, local model 67, internal_epoch   1,  Average loss: 0.0019, Accuracy: 966/998 (96.7936%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.4259, Accuracy: 8718/10000 (87.1800%)
___Train Local_Simple,  epoch  67, local model 86, internal_epoch   1,  Average loss: 0.0010, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1146, Accuracy: 9652/10000 (96.5200%)
___Train Local_Simple,  epoch  67, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 639/658 (97.1125%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.3114, Accuracy: 9026/10000 (90.2600%)
time spent on training: 71.35301303863525
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.38469184890656066  data num: [606, 591, 568, 557, 647, 401, 760, 998, 250, 658]
[foolsgold agg] considering poison per batch poison_fraction: 0.12021620278330021
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 67: Average loss: 0.0968, Accuracy: 9714/10000 (97.1400%)
___Test Target_Simple poisoned: True, epoch: 67: Average loss: 9.3478, Accuracy: 123/8968 (1.3715%)
Done in 84.01790189743042 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:68 choose agents : [41, 73, 51, 74, 83, 32, 48, 45, 93, 49]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   1,  Average loss: 0.0190, Accuracy: 382/606 (63.0363%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   2,  Average loss: 0.0123, Accuracy: 390/606 (64.3564%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   3,  Average loss: 0.0119, Accuracy: 326/606 (53.7954%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   4,  Average loss: 0.0103, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   5,  Average loss: 0.0101, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   6,  Average loss: 0.0097, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   8,  Average loss: 0.0094, Accuracy: 436/606 (71.9472%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   9,  Average loss: 0.0097, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch  10,  Average loss: 0.0095, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Global model norm: 16.83265357328901.
Norm before scaling: 16.96120199298608. Distance: 4.139598330486734
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 1.2338, Accuracy: 6038/10000 (60.3800%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.5642, Accuracy: 6318/8968 (70.4505%)
Scaling by  100
Scaled Norm after poisoning: 412.75526192890624, distance: 413.95985992001687
Total norm for 4 adversaries is: 412.75526192890624. distance: 413.95985992001687
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 1663.9947, Accuracy: 7876/8968 (87.8234%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   1,  Average loss: 0.0258, Accuracy: 331/591 (56.0068%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   2,  Average loss: 0.0105, Accuracy: 464/591 (78.5110%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   3,  Average loss: 0.0054, Accuracy: 539/591 (91.2014%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   4,  Average loss: 0.0049, Accuracy: 540/591 (91.3706%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   5,  Average loss: 0.0040, Accuracy: 549/591 (92.8934%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   6,  Average loss: 0.0033, Accuracy: 557/591 (94.2470%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   7,  Average loss: 0.0027, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   8,  Average loss: 0.0027, Accuracy: 561/591 (94.9239%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   9,  Average loss: 0.0024, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch  10,  Average loss: 0.0021, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Global model norm: 16.83265357328901.
Norm before scaling: 17.379638052838047. Distance: 5.706807324705172
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.9887, Accuracy: 6580/10000 (65.8000%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.1040, Accuracy: 8570/8968 (95.5620%)
Scaling by  100
Scaled Norm after poisoning: 569.7143472829168, distance: 570.6807064813038
Total norm for 4 adversaries is: 569.7143472829168. distance: 570.6807064813038
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   1,  Average loss: 0.0177, Accuracy: 394/568 (69.3662%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   2,  Average loss: 0.0055, Accuracy: 515/568 (90.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   3,  Average loss: 0.0025, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   4,  Average loss: 0.0016, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   5,  Average loss: 0.0017, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   6,  Average loss: 0.0013, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   7,  Average loss: 0.0011, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   8,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   9,  Average loss: 0.0009, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch  10,  Average loss: 0.0008, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Global model norm: 16.83265357328901.
Norm before scaling: 17.05869527462919. Distance: 3.7343161350862
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.6608, Accuracy: 7739/10000 (77.3900%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0614, Accuracy: 8743/8968 (97.4911%)
Scaling by  100
Scaled Norm after poisoning: 372.9692933071032, distance: 373.4316369832637
Total norm for 4 adversaries is: 372.9692933071032. distance: 373.4316369832637
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 1990.8959, Accuracy: 8563/8968 (95.4839%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   1,  Average loss: 0.0144, Accuracy: 432/557 (77.5583%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   3,  Average loss: 0.0019, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   4,  Average loss: 0.0010, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   5,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   6,  Average loss: 0.0016, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   8,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.83265357328901.
Norm before scaling: 17.09365359319249. Distance: 3.49944628013892
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.5431, Accuracy: 8359/10000 (83.5900%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0224, Accuracy: 8884/8968 (99.0633%)
Scaling by  100
Scaled Norm after poisoning: 349.8648957990784, distance: 349.94461615375656
Total norm for 4 adversaries is: 349.8648957990784. distance: 349.94461615375656
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  68, local model 83, internal_epoch   1,  Average loss: 0.0020, Accuracy: 415/433 (95.8430%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1361, Accuracy: 9581/10000 (95.8100%)
___Train Local_Simple,  epoch  68, local model 32, internal_epoch   1,  Average loss: 0.0025, Accuracy: 936/977 (95.8035%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.3260, Accuracy: 9060/10000 (90.6000%)
___Train Local_Simple,  epoch  68, local model 48, internal_epoch   1,  Average loss: 0.0009, Accuracy: 438/448 (97.7679%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1697, Accuracy: 9560/10000 (95.6000%)
___Train Local_Simple,  epoch  68, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 608/628 (96.8153%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1861, Accuracy: 9491/10000 (94.9100%)
___Train Local_Simple,  epoch  68, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 617/623 (99.0369%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2258, Accuracy: 9346/10000 (93.4600%)
___Train Local_Simple,  epoch  68, local model 49, internal_epoch   1,  Average loss: 0.0011, Accuracy: 494/506 (97.6285%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2735, Accuracy: 9239/10000 (92.3900%)
time spent on training: 75.68346667289734
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3911066195048004  data num: [606, 591, 568, 557, 433, 977, 448, 628, 623, 506]
[foolsgold agg] considering poison per batch poison_fraction: 0.12222081859525014
[foolsgold agg] wv: [1.        1.        1.        1.        0.8961617 1.        1.
 1.        1.        0.8961617]
___Test Target_Simple poisoned: False, epoch: 68: Average loss: 0.0967, Accuracy: 9716/10000 (97.1600%)
___Test Target_Simple poisoned: True, epoch: 68: Average loss: 9.2573, Accuracy: 133/8968 (1.4831%)
Done in 88.27939677238464 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:69 choose agents : [41, 73, 51, 74, 72, 81, 27, 30, 33, 42]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   1,  Average loss: 0.0191, Accuracy: 380/606 (62.7063%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   2,  Average loss: 0.0136, Accuracy: 377/606 (62.2112%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   3,  Average loss: 0.0115, Accuracy: 402/606 (66.3366%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   4,  Average loss: 0.0108, Accuracy: 397/606 (65.5116%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   5,  Average loss: 0.0103, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   6,  Average loss: 0.0103, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   7,  Average loss: 0.0096, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   8,  Average loss: 0.0095, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   9,  Average loss: 0.0096, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch  10,  Average loss: 0.0093, Accuracy: 436/606 (71.9472%), train_poison_data_count: 200
Global model norm: 16.83711386551485.
Norm before scaling: 16.94507207211869. Distance: 4.018725433986444
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 1.0038, Accuracy: 6136/10000 (61.3600%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.5683, Accuracy: 7240/8968 (80.7315%)
Scaling by  100
Scaled Norm after poisoning: 400.6678604218212, distance: 401.8725505368586
Total norm for 4 adversaries is: 400.6678604218212. distance: 401.8725505368586
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 11986.9899, Accuracy: 3251/8968 (36.2511%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   1,  Average loss: 0.0230, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   2,  Average loss: 0.0159, Accuracy: 451/591 (76.3113%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   3,  Average loss: 0.0054, Accuracy: 538/591 (91.0321%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   4,  Average loss: 0.0044, Accuracy: 547/591 (92.5550%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   5,  Average loss: 0.0042, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   6,  Average loss: 0.0033, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   7,  Average loss: 0.0032, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   8,  Average loss: 0.0024, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   9,  Average loss: 0.0020, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch  10,  Average loss: 0.0021, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Global model norm: 16.83711386551485.
Norm before scaling: 17.412680624567923. Distance: 5.697520389294432
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.8118, Accuracy: 7558/10000 (75.5800%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.2875, Accuracy: 7915/8968 (88.2583%)
Scaling by  100
Scaled Norm after poisoning: 568.8813309909194, distance: 569.752001971033
Total norm for 4 adversaries is: 568.8813309909194. distance: 569.752001971033
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 139755.3117, Accuracy: 4095/8968 (45.6624%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   1,  Average loss: 0.0172, Accuracy: 393/568 (69.1901%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   2,  Average loss: 0.0056, Accuracy: 489/568 (86.0915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   3,  Average loss: 0.0027, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   4,  Average loss: 0.0022, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   5,  Average loss: 0.0019, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   6,  Average loss: 0.0018, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   7,  Average loss: 0.0014, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   8,  Average loss: 0.0014, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   9,  Average loss: 0.0014, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch  10,  Average loss: 0.0014, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Global model norm: 16.83711386551485.
Norm before scaling: 17.069906674237778. Distance: 3.9798533195035195
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.7976, Accuracy: 7343/10000 (73.4300%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0499, Accuracy: 8793/8968 (98.0486%)
Scaling by  100
Scaled Norm after poisoning: 397.3426968625446, distance: 397.98533657033147
Total norm for 4 adversaries is: 397.3426968625446. distance: 397.98533657033147
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 48191.1310, Accuracy: 1951/8968 (21.7551%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   1,  Average loss: 0.0137, Accuracy: 439/557 (78.8151%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   2,  Average loss: 0.0038, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   3,  Average loss: 0.0020, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   4,  Average loss: 0.0016, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   5,  Average loss: 0.0018, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   6,  Average loss: 0.0015, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   8,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch  10,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.83711386551485.
Norm before scaling: 17.057345439641704. Distance: 3.436625282662493
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.6023, Accuracy: 8062/10000 (80.6200%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0248, Accuracy: 8885/8968 (99.0745%)
Scaling by  100
Scaled Norm after poisoning: 343.44265805953694, distance: 343.6625456934462
Total norm for 4 adversaries is: 343.44265805953694. distance: 343.6625456934462
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  69, local model 72, internal_epoch   1,  Average loss: 0.0013, Accuracy: 718/731 (98.2216%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2927, Accuracy: 9167/10000 (91.6700%)
___Train Local_Simple,  epoch  69, local model 81, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1193/1227 (97.2290%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.4079, Accuracy: 8880/10000 (88.8000%)
___Train Local_Simple,  epoch  69, local model 27, internal_epoch   1,  Average loss: 0.0016, Accuracy: 457/471 (97.0276%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2261, Accuracy: 9321/10000 (93.2100%)
___Train Local_Simple,  epoch  69, local model 30, internal_epoch   1,  Average loss: 0.0015, Accuracy: 385/400 (96.2500%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2857, Accuracy: 9216/10000 (92.1600%)
___Train Local_Simple,  epoch  69, local model 33, internal_epoch   1,  Average loss: 0.0022, Accuracy: 594/623 (95.3451%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1688, Accuracy: 9440/10000 (94.4000%)
___Train Local_Simple,  epoch  69, local model 42, internal_epoch   1,  Average loss: 0.0016, Accuracy: 229/236 (97.0339%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1667, Accuracy: 9519/10000 (95.1900%)
time spent on training: 71.16835761070251
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3863560732113145  data num: [606, 591, 568, 557, 731, 1227, 471, 400, 623, 236]
[foolsgold agg] considering poison per batch poison_fraction: 0.12073627287853578
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 69: Average loss: 0.0971, Accuracy: 9716/10000 (97.1600%)
___Test Target_Simple poisoned: True, epoch: 69: Average loss: 9.2278, Accuracy: 142/8968 (1.5834%)
Done in 84.02005338668823 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:70 choose agents : [41, 73, 51, 74, 5, 54, 88, 44, 64, 18]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   1,  Average loss: 0.0188, Accuracy: 385/606 (63.5314%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   2,  Average loss: 0.0132, Accuracy: 374/606 (61.7162%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   3,  Average loss: 0.0120, Accuracy: 339/606 (55.9406%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   4,  Average loss: 0.0109, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   5,  Average loss: 0.0102, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   6,  Average loss: 0.0102, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 437/606 (72.1122%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   8,  Average loss: 0.0095, Accuracy: 439/606 (72.4422%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   9,  Average loss: 0.0096, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Global model norm: 16.842441826519323.
Norm before scaling: 16.886549324705243. Distance: 3.681670543437786
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 1.0851, Accuracy: 5507/10000 (55.0700%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.3342, Accuracy: 7865/8968 (87.7007%)
Scaling by  100
Scaled Norm after poisoning: 366.9113482845686, distance: 368.167060415513
Total norm for 4 adversaries is: 366.9113482845686. distance: 368.167060415513
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 7523.4368, Accuracy: 4872/8968 (54.3265%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   1,  Average loss: 0.0239, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   2,  Average loss: 0.0103, Accuracy: 462/591 (78.1726%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   3,  Average loss: 0.0057, Accuracy: 532/591 (90.0169%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   4,  Average loss: 0.0049, Accuracy: 536/591 (90.6937%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   5,  Average loss: 0.0037, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   6,  Average loss: 0.0030, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   7,  Average loss: 0.0027, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   8,  Average loss: 0.0024, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   9,  Average loss: 0.0024, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch  10,  Average loss: 0.0022, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Global model norm: 16.842441826519323.
Norm before scaling: 17.331491127909246. Distance: 5.190632804850958
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.8143, Accuracy: 7490/10000 (74.9000%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0687, Accuracy: 8731/8968 (97.3573%)
Scaling by  100
Scaled Norm after poisoning: 518.3505992569122, distance: 519.0632788976696
Total norm for 4 adversaries is: 518.3505992569122. distance: 519.0632788976696
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 132.0309, Accuracy: 8966/8968 (99.9777%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   1,  Average loss: 0.0208, Accuracy: 366/568 (64.4366%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   2,  Average loss: 0.0056, Accuracy: 518/568 (91.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   3,  Average loss: 0.0031, Accuracy: 531/568 (93.4859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   4,  Average loss: 0.0020, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   5,  Average loss: 0.0018, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   6,  Average loss: 0.0017, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   7,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   8,  Average loss: 0.0011, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   9,  Average loss: 0.0010, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch  10,  Average loss: 0.0009, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Global model norm: 16.842441826519323.
Norm before scaling: 17.176821967134227. Distance: 4.592540763462258
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 1.0065, Accuracy: 7008/10000 (70.0800%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0192, Accuracy: 8905/8968 (99.2975%)
Scaling by  100
Scaled Norm after poisoning: 458.50451538125554, distance: 459.25408272545604
Total norm for 4 adversaries is: 458.50451538125554. distance: 459.25408272545604
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 573634.6790, Accuracy: 5145/8968 (57.3707%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   1,  Average loss: 0.0162, Accuracy: 407/557 (73.0700%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 500/557 (89.7666%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   3,  Average loss: 0.0024, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   4,  Average loss: 0.0019, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   5,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   6,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   7,  Average loss: 0.0012, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   8,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Global model norm: 16.842441826519323.
Norm before scaling: 17.14780661567291. Distance: 3.795060717231431
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.5004, Accuracy: 8485/10000 (84.8500%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0264, Accuracy: 8876/8968 (98.9741%)
Scaling by  100
Scaled Norm after poisoning: 379.3497314484353, distance: 379.5060934952165
Total norm for 4 adversaries is: 379.3497314484353. distance: 379.5060934952165
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  70, local model 5, internal_epoch   1,  Average loss: 0.0021, Accuracy: 422/434 (97.2350%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.3540, Accuracy: 8837/10000 (88.3700%)
___Train Local_Simple,  epoch  70, local model 54, internal_epoch   1,  Average loss: 0.0018, Accuracy: 498/519 (95.9538%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2412, Accuracy: 9234/10000 (92.3400%)
___Train Local_Simple,  epoch  70, local model 88, internal_epoch   1,  Average loss: 0.0013, Accuracy: 517/530 (97.5472%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.3351, Accuracy: 9042/10000 (90.4200%)
___Train Local_Simple,  epoch  70, local model 44, internal_epoch   1,  Average loss: 0.0020, Accuracy: 499/517 (96.5184%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2566, Accuracy: 9246/10000 (92.4600%)
___Train Local_Simple,  epoch  70, local model 64, internal_epoch   1,  Average loss: 0.0020, Accuracy: 785/813 (96.5560%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1737, Accuracy: 9447/10000 (94.4700%)
___Train Local_Simple,  epoch  70, local model 18, internal_epoch   1,  Average loss: 0.0026, Accuracy: 442/459 (96.2963%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2656, Accuracy: 9128/10000 (91.2800%)
time spent on training: 78.83855152130127
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41508759385055416  data num: [606, 591, 568, 557, 434, 519, 530, 517, 813, 459]
[foolsgold agg] considering poison per batch poison_fraction: 0.12971487307829818
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 70: Average loss: 0.0972, Accuracy: 9715/10000 (97.1500%)
___Test Target_Simple poisoned: True, epoch: 70: Average loss: 9.1715, Accuracy: 145/8968 (1.6169%)
Done in 94.29359698295593 sec.
Saving all the graphs.
This run has a label: Nov.13_09.35.53. Visdom environment: mnist_DBA
