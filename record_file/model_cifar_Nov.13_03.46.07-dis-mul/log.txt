current path: saved_models/model_cifar_Nov.13_03.46.07
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 201
create model done
Poisoned following participants: [17, 33, 77, 11]
We use following environment for graphs:  cifar
----------------------------------Start one training epoch------------------------------------------
Server Epoch:201 choose agents : [17, 33, 77, 11, 37, 53, 39, 57, 63, 48]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   1,  Average loss: 0.0159, Accuracy: 447/526 (84.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   2,  Average loss: 0.0178, Accuracy: 404/526 (76.8061%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   3,  Average loss: 0.0108, Accuracy: 434/526 (82.5095%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   4,  Average loss: 0.0067, Accuracy: 478/526 (90.8745%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   5,  Average loss: 0.0041, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   6,  Average loss: 0.0024, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 39.686423459808644. Distance: 13.588110584903927
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.1347, Accuracy: 4149/10000 (41.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.1549, Accuracy: 8486/9000 (94.2889%)
Scaling by  100
Scaled Norm after poisoning: 1358.2978318469038, distance: 1358.8111071815686
Total norm for 4 adversaries is: 1358.2978318469038. distance: 1358.8111071815686
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   1,  Average loss: 0.0159, Accuracy: 433/527 (82.1632%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   2,  Average loss: 0.0165, Accuracy: 429/527 (81.4042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   3,  Average loss: 0.0098, Accuracy: 454/527 (86.1480%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   4,  Average loss: 0.0059, Accuracy: 487/527 (92.4099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   5,  Average loss: 0.0041, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   6,  Average loss: 0.0035, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 39.01693123313983. Distance: 11.573930029304748
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.2751, Accuracy: 4079/10000 (40.7900%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.2791, Accuracy: 8153/9000 (90.5889%)
Scaling by  100
Scaled Norm after poisoning: 1156.7036137230662, distance: 1157.3930836150698
Total norm for 4 adversaries is: 1156.7036137230662. distance: 1157.3930836150698
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   1,  Average loss: 0.0098, Accuracy: 428/496 (86.2903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   2,  Average loss: 0.0062, Accuracy: 457/496 (92.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   3,  Average loss: 0.0035, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   4,  Average loss: 0.0020, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.66304237236004.
Norm before scaling: 37.93085332271161. Distance: 6.73353121753146
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.1864, Accuracy: 6202/10000 (62.0200%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.1863, Accuracy: 8586/9000 (95.4000%)
Scaling by  100
Scaled Norm after poisoning: 672.5425172433338, distance: 673.3531298657488
Total norm for 4 adversaries is: 672.5425172433338. distance: 673.3531298657488
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   1,  Average loss: 0.0076, Accuracy: 485/546 (88.8278%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 498/546 (91.2088%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   3,  Average loss: 0.0027, Accuracy: 520/546 (95.2381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   4,  Average loss: 0.0019, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 37.97096186973014. Distance: 7.092247892140701
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.4287, Accuracy: 5798/10000 (57.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.1990, Accuracy: 8543/9000 (94.9222%)
Scaling by  100
Scaled Norm after poisoning: 708.3199533050018, distance: 709.2247748422217
Total norm for 4 adversaries is: 708.3199533050018. distance: 709.2247748422217
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   1,  Average loss: 0.0112, Accuracy: 583/725 (80.4138%)
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   2,  Average loss: 0.0180, Accuracy: 509/725 (70.2069%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 26.4263, Accuracy: 1550/10000 (15.5000%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   1,  Average loss: 0.0049, Accuracy: 558/625 (89.2800%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   2,  Average loss: 0.0041, Accuracy: 571/625 (91.3600%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.7018, Accuracy: 4204/10000 (42.0400%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   1,  Average loss: 0.0074, Accuracy: 186/217 (85.7143%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   2,  Average loss: 0.0012, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.1462, Accuracy: 3165/10000 (31.6500%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   1,  Average loss: 0.0074, Accuracy: 245/290 (84.4828%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   2,  Average loss: 0.0019, Accuracy: 280/290 (96.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.7057, Accuracy: 3028/10000 (30.2800%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 704/752 (93.6170%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   2,  Average loss: 0.0029, Accuracy: 709/752 (94.2819%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.7694, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   1,  Average loss: 0.0059, Accuracy: 332/378 (87.8307%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   2,  Average loss: 0.0019, Accuracy: 363/378 (96.0317%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 3.8983, Accuracy: 3121/10000 (31.2100%)
time spent on training: 174.58638548851013
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 201: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 223.7737147808075 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:202 choose agents : [17, 33, 77, 11, 63, 50, 39, 72, 88, 71]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   1,  Average loss: 0.0383, Accuracy: 216/526 (41.0646%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   2,  Average loss: 0.0157, Accuracy: 369/526 (70.1521%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   3,  Average loss: 0.0118, Accuracy: 426/526 (80.9886%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   4,  Average loss: 0.0063, Accuracy: 483/526 (91.8251%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   5,  Average loss: 0.0039, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   6,  Average loss: 0.0026, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Global model norm: 42.134854304549634.
Norm before scaling: 42.5675388215965. Distance: 8.195498687112869
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.5144, Accuracy: 4157/10000 (41.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.3066, Accuracy: 8008/9000 (88.9778%)
Scaling by  100
Scaled Norm after poisoning: 818.7708394294463, distance: 819.5498764565828
Total norm for 4 adversaries is: 818.7708394294463. distance: 819.5498764565828
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   1,  Average loss: 0.0345, Accuracy: 223/527 (42.3150%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   2,  Average loss: 0.0152, Accuracy: 370/527 (70.2087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   3,  Average loss: 0.0088, Accuracy: 441/527 (83.6812%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   4,  Average loss: 0.0057, Accuracy: 492/527 (93.3586%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   5,  Average loss: 0.0052, Accuracy: 497/527 (94.3074%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   6,  Average loss: 0.0030, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Global model norm: 42.134854304549634.
Norm before scaling: 42.50945293540235. Distance: 8.074730401513657
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 3.0389, Accuracy: 3155/10000 (31.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.5574, Accuracy: 7398/9000 (82.2000%)
Scaling by  100
Scaled Norm after poisoning: 806.4977526317107, distance: 807.4732193701535
Total norm for 4 adversaries is: 806.4977526317107. distance: 807.4732193701535
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   1,  Average loss: 0.0358, Accuracy: 185/496 (37.2984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   2,  Average loss: 0.0212, Accuracy: 274/496 (55.2419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   3,  Average loss: 0.0146, Accuracy: 352/496 (70.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   4,  Average loss: 0.0093, Accuracy: 405/496 (81.6532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   5,  Average loss: 0.0051, Accuracy: 464/496 (93.5484%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   6,  Average loss: 0.0030, Accuracy: 477/496 (96.1694%), train_poison_data_count: 40
Global model norm: 42.134854304549634.
Norm before scaling: 42.35525241604118. Distance: 7.063222932527338
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.8996, Accuracy: 4458/10000 (44.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.9278, Accuracy: 5988/9000 (66.5333%)
Scaling by  100
Scaled Norm after poisoning: 705.365109358267, distance: 706.3223193061366
Total norm for 4 adversaries is: 705.365109358267. distance: 706.3223193061366
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   1,  Average loss: 0.0406, Accuracy: 151/546 (27.6557%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   2,  Average loss: 0.0230, Accuracy: 294/546 (53.8462%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   3,  Average loss: 0.0168, Accuracy: 365/546 (66.8498%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   4,  Average loss: 0.0110, Accuracy: 440/546 (80.5861%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   5,  Average loss: 0.0060, Accuracy: 493/546 (90.2930%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   6,  Average loss: 0.0030, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Global model norm: 42.134854304549634.
Norm before scaling: 42.43337637596215. Distance: 8.014548424596068
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 3.0328, Accuracy: 3196/10000 (31.9600%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.6127, Accuracy: 7672/9000 (85.2444%)
Scaling by  100
Scaled Norm after poisoning: 800.1291302033691, distance: 801.4548490089757
Total norm for 4 adversaries is: 800.1291302033691. distance: 801.4548490089757
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 202, local model 63, internal_epoch   1,  Average loss: 0.0455, Accuracy: 224/752 (29.7872%)
___Train Local_ResNet_18,  epoch 202, local model 63, internal_epoch   2,  Average loss: 0.0233, Accuracy: 389/752 (51.7287%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 3.7367, Accuracy: 2506/10000 (25.0600%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   1,  Average loss: 0.0499, Accuracy: 140/401 (34.9127%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   2,  Average loss: 0.0240, Accuracy: 250/401 (62.3441%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 67.1298, Accuracy: 1749/10000 (17.4900%)
___Train Local_ResNet_18,  epoch 202, local model 39, internal_epoch   1,  Average loss: 0.0898, Accuracy: 31/217 (14.2857%)
___Train Local_ResNet_18,  epoch 202, local model 39, internal_epoch   2,  Average loss: 0.0268, Accuracy: 130/217 (59.9078%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 202, local model 72, internal_epoch   1,  Average loss: 0.0349, Accuracy: 295/618 (47.7346%)
___Train Local_ResNet_18,  epoch 202, local model 72, internal_epoch   2,  Average loss: 0.0138, Accuracy: 448/618 (72.4919%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 3.4355, Accuracy: 2290/10000 (22.9000%)
___Train Local_ResNet_18,  epoch 202, local model 88, internal_epoch   1,  Average loss: 0.0496, Accuracy: 168/447 (37.5839%)
___Train Local_ResNet_18,  epoch 202, local model 88, internal_epoch   2,  Average loss: 0.0229, Accuracy: 284/447 (63.5347%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 17.1338, Accuracy: 1016/10000 (10.1600%)
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   1,  Average loss: 0.0325, Accuracy: 581/1166 (49.8285%)
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   2,  Average loss: 0.0178, Accuracy: 808/1166 (69.2967%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.8428, Accuracy: 3289/10000 (32.8900%)
time spent on training: 191.9293885231018
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 202: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 241.1093339920044 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:203 choose agents : [17, 33, 77, 11, 92, 23, 26, 50, 14, 76]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   1,  Average loss: 0.0677, Accuracy: 245/526 (46.5779%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   2,  Average loss: 0.0311, Accuracy: 320/526 (60.8365%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   3,  Average loss: 0.0193, Accuracy: 375/526 (71.2928%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   4,  Average loss: 0.0133, Accuracy: 421/526 (80.0380%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   5,  Average loss: 0.0081, Accuracy: 469/526 (89.1635%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   6,  Average loss: 0.0047, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Global model norm: 46.14910870618196.
Norm before scaling: 46.74482706591046. Distance: 11.979055564475727
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.1872, Accuracy: 3712/10000 (37.1200%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.3042, Accuracy: 7953/9000 (88.3667%)
Scaling by  100
Scaled Norm after poisoning: 1195.1116579633888, distance: 1197.905568064528
Total norm for 4 adversaries is: 1195.1116579633888. distance: 1197.905568064528
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   1,  Average loss: 0.0776, Accuracy: 189/527 (35.8634%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   2,  Average loss: 0.0317, Accuracy: 322/527 (61.1006%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   3,  Average loss: 0.0185, Accuracy: 362/527 (68.6907%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   4,  Average loss: 0.0117, Accuracy: 441/527 (83.6812%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   5,  Average loss: 0.0068, Accuracy: 472/527 (89.5636%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   6,  Average loss: 0.0049, Accuracy: 494/527 (93.7381%), train_poison_data_count: 45
Global model norm: 46.14910870618196.
Norm before scaling: 46.8821531000537. Distance: 12.676879045297449
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.6268, Accuracy: 3446/10000 (34.4600%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.5177, Accuracy: 7463/9000 (82.9222%)
Scaling by  100
Scaled Norm after poisoning: 1264.8760314750216, distance: 1267.687855901444
Total norm for 4 adversaries is: 1264.8760314750216. distance: 1267.687855901444
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   1,  Average loss: 0.0833, Accuracy: 164/496 (33.0645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   2,  Average loss: 0.0324, Accuracy: 260/496 (52.4194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   3,  Average loss: 0.0191, Accuracy: 305/496 (61.4919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   4,  Average loss: 0.0140, Accuracy: 356/496 (71.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   5,  Average loss: 0.0084, Accuracy: 433/496 (87.2984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   6,  Average loss: 0.0052, Accuracy: 457/496 (92.1371%), train_poison_data_count: 40
Global model norm: 46.14910870618196.
Norm before scaling: 46.670724165590414. Distance: 11.680891973847181
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.9271, Accuracy: 3660/10000 (36.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.1751, Accuracy: 8550/9000 (95.0000%)
Scaling by  100
Scaled Norm after poisoning: 1165.229269285663, distance: 1168.089251726939
Total norm for 4 adversaries is: 1165.229269285663. distance: 1168.089251726939
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   1,  Average loss: 0.0563, Accuracy: 261/546 (47.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   2,  Average loss: 0.0271, Accuracy: 331/546 (60.6227%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   3,  Average loss: 0.0140, Accuracy: 410/546 (75.0916%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   4,  Average loss: 0.0067, Accuracy: 488/546 (89.3773%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   5,  Average loss: 0.0044, Accuracy: 515/546 (94.3223%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   6,  Average loss: 0.0027, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Global model norm: 46.14910870618196.
Norm before scaling: 46.9291145971773. Distance: 11.860453158336478
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.3866, Accuracy: 3762/10000 (37.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.3705, Accuracy: 8035/9000 (89.2778%)
Scaling by  100
Scaled Norm after poisoning: 1184.071893932121, distance: 1186.0453195388445
Total norm for 4 adversaries is: 1184.071893932121. distance: 1186.0453195388445
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 203, local model 92, internal_epoch   1,  Average loss: 0.0376, Accuracy: 373/796 (46.8593%)
___Train Local_ResNet_18,  epoch 203, local model 92, internal_epoch   2,  Average loss: 0.0174, Accuracy: 517/796 (64.9497%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 3.5883, Accuracy: 2538/10000 (25.3800%)
___Train Local_ResNet_18,  epoch 203, local model 23, internal_epoch   1,  Average loss: 0.0756, Accuracy: 81/248 (32.6613%)
___Train Local_ResNet_18,  epoch 203, local model 23, internal_epoch   2,  Average loss: 0.0276, Accuracy: 156/248 (62.9032%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 203, local model 26, internal_epoch   1,  Average loss: 0.0949, Accuracy: 108/468 (23.0769%)
___Train Local_ResNet_18,  epoch 203, local model 26, internal_epoch   2,  Average loss: 0.0336, Accuracy: 191/468 (40.8120%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 203, local model 50, internal_epoch   1,  Average loss: 0.0544, Accuracy: 200/401 (49.8753%)
___Train Local_ResNet_18,  epoch 203, local model 50, internal_epoch   2,  Average loss: 0.0238, Accuracy: 254/401 (63.3416%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 203, local model 14, internal_epoch   1,  Average loss: 0.1227, Accuracy: 68/318 (21.3836%)
___Train Local_ResNet_18,  epoch 203, local model 14, internal_epoch   2,  Average loss: 0.0323, Accuracy: 149/318 (46.8553%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 203, local model 76, internal_epoch   1,  Average loss: 0.1936, Accuracy: 12/65 (18.4615%)
___Train Local_ResNet_18,  epoch 203, local model 76, internal_epoch   2,  Average loss: 0.1281, Accuracy: 30/65 (46.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 191.6933524608612
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 203: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 238.6112096309662 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:204 choose agents : [17, 33, 77, 11, 49, 86, 26, 58, 6, 94]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   1,  Average loss: 0.1008, Accuracy: 71/526 (13.4981%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   2,  Average loss: 0.0324, Accuracy: 182/526 (34.6008%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   3,  Average loss: 0.0279, Accuracy: 251/526 (47.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   4,  Average loss: 0.0249, Accuracy: 272/526 (51.7110%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   5,  Average loss: 0.0233, Accuracy: 289/526 (54.9430%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   6,  Average loss: 0.0220, Accuracy: 298/526 (56.6540%), train_poison_data_count: 45
Global model norm: 55.12691101775407.
Norm before scaling: 55.52170007922578. Distance: 14.066501709270648
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 2.5707, Accuracy: 1850/10000 (18.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 1.5002, Accuracy: 4362/9000 (48.4667%)
Scaling by  100
Scaled Norm after poisoning: 1402.2429354430708, distance: 1406.6500097749972
Total norm for 4 adversaries is: 1402.2429354430708. distance: 1406.6500097749972
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   1,  Average loss: 0.0795, Accuracy: 135/527 (25.6167%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   2,  Average loss: 0.0303, Accuracy: 196/527 (37.1917%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   3,  Average loss: 0.0287, Accuracy: 203/527 (38.5199%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   4,  Average loss: 0.0264, Accuracy: 216/527 (40.9867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   5,  Average loss: 0.0248, Accuracy: 237/527 (44.9715%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   6,  Average loss: 0.0222, Accuracy: 269/527 (51.0436%), train_poison_data_count: 45
Global model norm: 55.12691101775407.
Norm before scaling: 55.44249598753762. Distance: 12.888057272671931
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 2.8885, Accuracy: 1726/10000 (17.2600%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.7054, Accuracy: 7033/9000 (78.1444%)
Scaling by  100
Scaled Norm after poisoning: 1284.8884679224107, distance: 1288.8056486530465
Total norm for 4 adversaries is: 1284.8884679224107. distance: 1288.8056486530465
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   1,  Average loss: 0.0847, Accuracy: 128/496 (25.8065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   2,  Average loss: 0.0320, Accuracy: 131/496 (26.4113%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   3,  Average loss: 0.0301, Accuracy: 160/496 (32.2581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   4,  Average loss: 0.0283, Accuracy: 213/496 (42.9435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   5,  Average loss: 0.0265, Accuracy: 214/496 (43.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   6,  Average loss: 0.0243, Accuracy: 229/496 (46.1694%), train_poison_data_count: 40
Global model norm: 55.12691101775407.
Norm before scaling: 55.4879940209479. Distance: 12.95164829206867
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 2.6273, Accuracy: 1936/10000 (19.3600%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.1030, Accuracy: 8659/9000 (96.2111%)
Scaling by  100
Scaled Norm after poisoning: 1291.3986603678975, distance: 1295.1648061154226
Total norm for 4 adversaries is: 1291.3986603678975. distance: 1295.1648061154226
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   1,  Average loss: 0.0837, Accuracy: 74/546 (13.5531%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   2,  Average loss: 0.0327, Accuracy: 139/546 (25.4579%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   3,  Average loss: 0.0312, Accuracy: 187/546 (34.2491%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   4,  Average loss: 0.0304, Accuracy: 185/546 (33.8828%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   5,  Average loss: 0.0303, Accuracy: 182/546 (33.3333%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   6,  Average loss: 0.0295, Accuracy: 189/546 (34.6154%), train_poison_data_count: 45
Global model norm: 55.12691101775407.
Norm before scaling: 55.376781150812654. Distance: 13.21465265066526
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 2.8888, Accuracy: 1017/10000 (10.1700%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.0233, Accuracy: 8947/9000 (99.4111%)
Scaling by  100
Scaled Norm after poisoning: 1317.0452251156753, distance: 1321.4653325002514
Total norm for 4 adversaries is: 1317.0452251156753. distance: 1321.4653325002514
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 204, local model 49, internal_epoch   1,  Average loss: 0.1518, Accuracy: 37/426 (8.6854%)
___Train Local_ResNet_18,  epoch 204, local model 49, internal_epoch   2,  Average loss: 0.0268, Accuracy: 183/426 (42.9577%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 204, local model 86, internal_epoch   1,  Average loss: 0.2264, Accuracy: 14/212 (6.6038%)
___Train Local_ResNet_18,  epoch 204, local model 86, internal_epoch   2,  Average loss: 0.0375, Accuracy: 75/212 (35.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 204, local model 26, internal_epoch   1,  Average loss: 0.1025, Accuracy: 133/468 (28.4188%)
___Train Local_ResNet_18,  epoch 204, local model 26, internal_epoch   2,  Average loss: 0.0390, Accuracy: 86/468 (18.3761%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 204, local model 58, internal_epoch   1,  Average loss: 0.2265, Accuracy: 45/234 (19.2308%)
___Train Local_ResNet_18,  epoch 204, local model 58, internal_epoch   2,  Average loss: 0.0520, Accuracy: 17/234 (7.2650%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 204, local model 6, internal_epoch   1,  Average loss: 0.1063, Accuracy: 104/520 (20.0000%)
___Train Local_ResNet_18,  epoch 204, local model 6, internal_epoch   2,  Average loss: 0.0360, Accuracy: 100/520 (19.2308%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 204, local model 94, internal_epoch   1,  Average loss: 0.2176, Accuracy: 26/203 (12.8079%)
___Train Local_ResNet_18,  epoch 204, local model 94, internal_epoch   2,  Average loss: 0.0743, Accuracy: 76/203 (37.4384%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 194.35611939430237
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 243.1196072101593 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:205 choose agents : [17, 33, 77, 11, 61, 71, 8, 69, 89, 64]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   1,  Average loss: 0.0606, Accuracy: 98/526 (18.6312%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   2,  Average loss: 0.0485, Accuracy: 161/526 (30.6084%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   3,  Average loss: 0.0442, Accuracy: 157/526 (29.8479%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   4,  Average loss: 0.0404, Accuracy: 157/526 (29.8479%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   5,  Average loss: 0.0342, Accuracy: 169/526 (32.1293%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   6,  Average loss: 0.0283, Accuracy: 209/526 (39.7338%), train_poison_data_count: 45
Global model norm: 67.68834039759913.
Norm before scaling: 66.81264616447997. Distance: 6.234836341404765
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.6800, Accuracy: 1458/10000 (14.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.2484, Accuracy: 8180/9000 (90.8889%)
Scaling by  100
Scaled Norm after poisoning: 614.5308169652682, distance: 623.4836355109892
Total norm for 4 adversaries is: 614.5308169652682. distance: 623.4836355109892
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   1,  Average loss: 0.0700, Accuracy: 54/527 (10.2467%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   2,  Average loss: 0.0504, Accuracy: 119/527 (22.5806%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   3,  Average loss: 0.0462, Accuracy: 163/527 (30.9298%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   4,  Average loss: 0.0424, Accuracy: 157/527 (29.7913%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   5,  Average loss: 0.0365, Accuracy: 159/527 (30.1708%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   6,  Average loss: 0.0341, Accuracy: 161/527 (30.5503%), train_poison_data_count: 45
Global model norm: 67.68834039759913.
Norm before scaling: 66.81254750349106. Distance: 7.148501803416382
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.9211, Accuracy: 1103/10000 (11.0300%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 2.1627, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 706.1890460422053, distance: 714.8502028397278
Total norm for 4 adversaries is: 706.1890460422053. distance: 714.8502028397278
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   1,  Average loss: 0.0726, Accuracy: 53/496 (10.6855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   2,  Average loss: 0.0588, Accuracy: 96/496 (19.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   3,  Average loss: 0.0471, Accuracy: 109/496 (21.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   4,  Average loss: 0.0388, Accuracy: 110/496 (22.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   5,  Average loss: 0.0350, Accuracy: 111/496 (22.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   6,  Average loss: 0.0331, Accuracy: 139/496 (28.0242%), train_poison_data_count: 40
Global model norm: 67.68834039759913.
Norm before scaling: 66.84975063645525. Distance: 6.253911434745665
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.4567, Accuracy: 1550/10000 (15.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 1.6779, Accuracy: 66/9000 (0.7333%)
Scaling by  100
Scaled Norm after poisoning: 616.84877097227, distance: 625.3911276153508
Total norm for 4 adversaries is: 616.84877097227. distance: 625.3911276153508
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   1,  Average loss: 0.0607, Accuracy: 76/546 (13.9194%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   2,  Average loss: 0.0412, Accuracy: 145/546 (26.5568%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   3,  Average loss: 0.0312, Accuracy: 180/546 (32.9670%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   4,  Average loss: 0.0305, Accuracy: 187/546 (34.2491%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   5,  Average loss: 0.0295, Accuracy: 204/546 (37.3626%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   6,  Average loss: 0.0297, Accuracy: 200/546 (36.6300%), train_poison_data_count: 45
Global model norm: 67.68834039759913.
Norm before scaling: 66.97292771616752. Distance: 6.434126182810539
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 3.1461, Accuracy: 1303/10000 (13.0300%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.5080, Accuracy: 8313/9000 (92.3667%)
Scaling by  100
Scaled Norm after poisoning: 636.2293464231275, distance: 643.4126057593214
Total norm for 4 adversaries is: 636.2293464231275. distance: 643.4126057593214
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 205, local model 61, internal_epoch   1,  Average loss: 0.0632, Accuracy: 209/590 (35.4237%)
___Train Local_ResNet_18,  epoch 205, local model 61, internal_epoch   2,  Average loss: 0.0447, Accuracy: 241/590 (40.8475%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 71, internal_epoch   1,  Average loss: 0.0421, Accuracy: 312/1166 (26.7581%)
___Train Local_ResNet_18,  epoch 205, local model 71, internal_epoch   2,  Average loss: 0.0316, Accuracy: 386/1166 (33.1046%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 8, internal_epoch   1,  Average loss: 0.0862, Accuracy: 49/534 (9.1760%)
___Train Local_ResNet_18,  epoch 205, local model 8, internal_epoch   2,  Average loss: 0.0582, Accuracy: 97/534 (18.1648%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 69, internal_epoch   1,  Average loss: 0.0480, Accuracy: 113/216 (52.3148%)
___Train Local_ResNet_18,  epoch 205, local model 69, internal_epoch   2,  Average loss: 0.0342, Accuracy: 115/216 (53.2407%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 89, internal_epoch   1,  Average loss: 0.0801, Accuracy: 61/413 (14.7700%)
___Train Local_ResNet_18,  epoch 205, local model 89, internal_epoch   2,  Average loss: 0.0545, Accuracy: 146/413 (35.3511%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 64, internal_epoch   1,  Average loss: 0.0527, Accuracy: 214/686 (31.1953%)
___Train Local_ResNet_18,  epoch 205, local model 64, internal_epoch   2,  Average loss: 0.0373, Accuracy: 268/686 (39.0671%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 193.68039798736572
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 240.36194777488708 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:206 choose agents : [17, 33, 77, 11, 38, 64, 29, 23, 83, 43]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   1,  Average loss: 0.3077, Accuracy: 54/526 (10.2662%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   2,  Average loss: 0.0381, Accuracy: 52/526 (9.8859%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   3,  Average loss: 0.0316, Accuracy: 207/526 (39.3536%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   4,  Average loss: 0.0311, Accuracy: 212/526 (40.3042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   5,  Average loss: 0.0289, Accuracy: 220/526 (41.8251%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   6,  Average loss: 0.0274, Accuracy: 227/526 (43.1559%), train_poison_data_count: 45
Global model norm: 66.41479356805606.
Norm before scaling: 66.67584246749342. Distance: 22.649466926415315
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2255.342324349011, distance: 2264.946688114314
Total norm for 4 adversaries is: 2255.342324349011. distance: 2264.946688114314
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   1,  Average loss: 0.2659, Accuracy: 96/527 (18.2163%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   2,  Average loss: 0.0338, Accuracy: 117/527 (22.2011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   3,  Average loss: 0.0307, Accuracy: 190/527 (36.0531%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   4,  Average loss: 0.0302, Accuracy: 188/527 (35.6736%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   5,  Average loss: 0.0299, Accuracy: 199/527 (37.7609%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   6,  Average loss: 0.0292, Accuracy: 194/527 (36.8121%), train_poison_data_count: 45
Global model norm: 66.41479356805606.
Norm before scaling: 66.45716430528766. Distance: 20.891657778790407
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2079.8897807335848, distance: 2089.165862252205
Total norm for 4 adversaries is: 2079.8897807335848. distance: 2089.165862252205
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   1,  Average loss: 0.2870, Accuracy: 95/496 (19.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   2,  Average loss: 0.0396, Accuracy: 55/496 (11.0887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   3,  Average loss: 0.0354, Accuracy: 94/496 (18.9516%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   4,  Average loss: 0.0332, Accuracy: 144/496 (29.0323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   5,  Average loss: 0.0312, Accuracy: 188/496 (37.9032%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   6,  Average loss: 0.0307, Accuracy: 189/496 (38.1048%), train_poison_data_count: 40
Global model norm: 66.41479356805606.
Norm before scaling: 66.34315752797157. Distance: 20.470269206503335
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2037.615211466581, distance: 2047.026746283497
Total norm for 4 adversaries is: 2037.615211466581. distance: 2047.026746283497
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   1,  Average loss: 0.2729, Accuracy: 64/546 (11.7216%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   2,  Average loss: 0.0321, Accuracy: 182/546 (33.3333%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   3,  Average loss: 0.0290, Accuracy: 214/546 (39.1941%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   4,  Average loss: 0.0278, Accuracy: 224/546 (41.0256%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   5,  Average loss: 0.0273, Accuracy: 230/546 (42.1245%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   6,  Average loss: 0.0275, Accuracy: 225/546 (41.2088%), train_poison_data_count: 45
Global model norm: 66.41479356805606.
Norm before scaling: 66.57520418669401. Distance: 21.6342238671505
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.6808, Accuracy: 1577/10000 (15.7700%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.3178, Accuracy: 8348/9000 (92.7556%)
Scaling by  100
Scaled Norm after poisoning: 2154.0976068878585, distance: 2163.4224044323846
Total norm for 4 adversaries is: 2154.0976068878585. distance: 2163.4224044323846
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 206, local model 38, internal_epoch   1,  Average loss: 0.1692, Accuracy: 127/756 (16.7989%)
___Train Local_ResNet_18,  epoch 206, local model 38, internal_epoch   2,  Average loss: 0.0258, Accuracy: 302/756 (39.9471%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 64, internal_epoch   1,  Average loss: 0.1857, Accuracy: 60/686 (8.7464%)
___Train Local_ResNet_18,  epoch 206, local model 64, internal_epoch   2,  Average loss: 0.0323, Accuracy: 280/686 (40.8163%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 29, internal_epoch   1,  Average loss: 0.1486, Accuracy: 223/848 (26.2972%)
___Train Local_ResNet_18,  epoch 206, local model 29, internal_epoch   2,  Average loss: 0.0209, Accuracy: 532/848 (62.7358%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 23, internal_epoch   1,  Average loss: 0.3869, Accuracy: 16/248 (6.4516%)
___Train Local_ResNet_18,  epoch 206, local model 23, internal_epoch   2,  Average loss: 0.0348, Accuracy: 73/248 (29.4355%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 83, internal_epoch   1,  Average loss: 0.2916, Accuracy: 55/366 (15.0273%)
___Train Local_ResNet_18,  epoch 206, local model 83, internal_epoch   2,  Average loss: 0.0450, Accuracy: 39/366 (10.6557%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 43, internal_epoch   1,  Average loss: 0.3489, Accuracy: 2/345 (0.5797%)
___Train Local_ResNet_18,  epoch 206, local model 43, internal_epoch   2,  Average loss: 0.0376, Accuracy: 69/345 (20.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 197.73689937591553
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 245.32406330108643 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:207 choose agents : [17, 33, 77, 11, 56, 45, 1, 50, 16, 12]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   1,  Average loss: 0.0460, Accuracy: 138/526 (26.2357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   2,  Average loss: 0.0342, Accuracy: 195/526 (37.0722%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   3,  Average loss: 0.0314, Accuracy: 230/526 (43.7262%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   4,  Average loss: 0.0282, Accuracy: 230/526 (43.7262%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   5,  Average loss: 0.0262, Accuracy: 243/526 (46.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   6,  Average loss: 0.0275, Accuracy: 244/526 (46.3878%), train_poison_data_count: 45
Global model norm: 99.64706272326846.
Norm before scaling: 98.59342313733457. Distance: 5.886778043310379
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 576.2969612101039, distance: 588.677808737513
Total norm for 4 adversaries is: 576.2969612101039. distance: 588.677808737513
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   1,  Average loss: 0.0742, Accuracy: 71/527 (13.4725%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   2,  Average loss: 0.0501, Accuracy: 95/527 (18.0266%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   3,  Average loss: 0.0421, Accuracy: 124/527 (23.5294%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   4,  Average loss: 0.0344, Accuracy: 196/527 (37.1917%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   5,  Average loss: 0.0306, Accuracy: 209/527 (39.6584%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   6,  Average loss: 0.0300, Accuracy: 204/527 (38.7097%), train_poison_data_count: 45
Global model norm: 99.64706272326846.
Norm before scaling: 98.51070690539176. Distance: 8.280184004208765
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 816.1923792832177, distance: 828.0183799288516
Total norm for 4 adversaries is: 816.1923792832177. distance: 828.0183799288516
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   1,  Average loss: 0.0657, Accuracy: 81/496 (16.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   2,  Average loss: 0.0485, Accuracy: 153/496 (30.8468%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   3,  Average loss: 0.0455, Accuracy: 159/496 (32.0565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   4,  Average loss: 0.0395, Accuracy: 180/496 (36.2903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   5,  Average loss: 0.0364, Accuracy: 177/496 (35.6855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   6,  Average loss: 0.0356, Accuracy: 179/496 (36.0887%), train_poison_data_count: 40
Global model norm: 99.64706272326846.
Norm before scaling: 98.5926356910089. Distance: 6.872287839498997
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 675.7122630972447, distance: 687.228787413624
Total norm for 4 adversaries is: 675.7122630972447. distance: 687.228787413624
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   1,  Average loss: 0.0754, Accuracy: 67/546 (12.2711%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   2,  Average loss: 0.0591, Accuracy: 80/546 (14.6520%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   3,  Average loss: 0.0521, Accuracy: 107/546 (19.5971%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   4,  Average loss: 0.0415, Accuracy: 114/546 (20.8791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   5,  Average loss: 0.0388, Accuracy: 135/546 (24.7253%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   6,  Average loss: 0.0380, Accuracy: 148/546 (27.1062%), train_poison_data_count: 45
Global model norm: 99.64706272326846.
Norm before scaling: 98.37820138532977. Distance: 8.077855354693327
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 794.2261563937567, distance: 807.785553225607
Total norm for 4 adversaries is: 794.2261563937567. distance: 807.785553225607
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 207, local model 56, internal_epoch   1,  Average loss: 0.0505, Accuracy: 165/743 (22.2073%)
___Train Local_ResNet_18,  epoch 207, local model 56, internal_epoch   2,  Average loss: 0.0370, Accuracy: 188/743 (25.3028%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 45, internal_epoch   1,  Average loss: 0.0482, Accuracy: 162/529 (30.6238%)
___Train Local_ResNet_18,  epoch 207, local model 45, internal_epoch   2,  Average loss: 0.0396, Accuracy: 213/529 (40.2647%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   1,  Average loss: 0.0648, Accuracy: 208/641 (32.4493%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   2,  Average loss: 0.0475, Accuracy: 224/641 (34.9454%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 50, internal_epoch   1,  Average loss: 0.0450, Accuracy: 180/401 (44.8878%)
___Train Local_ResNet_18,  epoch 207, local model 50, internal_epoch   2,  Average loss: 0.0395, Accuracy: 180/401 (44.8878%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 16, internal_epoch   1,  Average loss: 0.0522, Accuracy: 210/773 (27.1669%)
___Train Local_ResNet_18,  epoch 207, local model 16, internal_epoch   2,  Average loss: 0.0351, Accuracy: 368/773 (47.6067%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 12, internal_epoch   1,  Average loss: 0.0516, Accuracy: 151/977 (15.4555%)
___Train Local_ResNet_18,  epoch 207, local model 12, internal_epoch   2,  Average loss: 0.0338, Accuracy: 429/977 (43.9099%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 197.47892260551453
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 244.99317169189453 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:208 choose agents : [17, 33, 77, 11, 44, 86, 20, 50, 49, 43]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   1,  Average loss: 0.1636, Accuracy: 60/526 (11.4068%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   2,  Average loss: 0.0980, Accuracy: 89/526 (16.9202%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   3,  Average loss: 0.0460, Accuracy: 166/526 (31.5589%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   4,  Average loss: 0.0343, Accuracy: 224/526 (42.5856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   5,  Average loss: 0.0290, Accuracy: 183/526 (34.7909%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   6,  Average loss: 0.0263, Accuracy: 237/526 (45.0570%), train_poison_data_count: 45
Global model norm: 97.10415437495452.
Norm before scaling: 95.77130861947904. Distance: 11.838999578120703
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1171.0358128597093, distance: 1183.8999113100735
Total norm for 4 adversaries is: 1171.0358128597093. distance: 1183.8999113100735
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   1,  Average loss: 0.1112, Accuracy: 123/527 (23.3397%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   2,  Average loss: 0.0705, Accuracy: 192/527 (36.4326%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   3,  Average loss: 0.0603, Accuracy: 189/527 (35.8634%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   4,  Average loss: 0.0391, Accuracy: 117/527 (22.2011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   5,  Average loss: 0.0301, Accuracy: 189/527 (35.8634%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   6,  Average loss: 0.0307, Accuracy: 200/527 (37.9507%), train_poison_data_count: 45
Global model norm: 97.10415437495452.
Norm before scaling: 95.70972553769026. Distance: 9.93153480615947
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 979.3023664834064, distance: 993.1535002203839
Total norm for 4 adversaries is: 979.3023664834064. distance: 993.1535002203839
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   1,  Average loss: 0.1626, Accuracy: 78/496 (15.7258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   2,  Average loss: 0.0993, Accuracy: 97/496 (19.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   3,  Average loss: 0.0547, Accuracy: 119/496 (23.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   4,  Average loss: 0.0401, Accuracy: 169/496 (34.0726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   5,  Average loss: 0.0314, Accuracy: 164/496 (33.0645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   6,  Average loss: 0.0286, Accuracy: 209/496 (42.1371%), train_poison_data_count: 40
Global model norm: 97.10415437495452.
Norm before scaling: 95.83234770779384. Distance: 11.578559239284358
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1145.4762110144409, distance: 1157.8558848146863
Total norm for 4 adversaries is: 1145.4762110144409. distance: 1157.8558848146863
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   1,  Average loss: 0.1256, Accuracy: 141/546 (25.8242%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   2,  Average loss: 0.0750, Accuracy: 126/546 (23.0769%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   3,  Average loss: 0.0534, Accuracy: 157/546 (28.7546%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   4,  Average loss: 0.0330, Accuracy: 161/546 (29.4872%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   5,  Average loss: 0.0290, Accuracy: 197/546 (36.0806%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   6,  Average loss: 0.0269, Accuracy: 214/546 (39.1941%), train_poison_data_count: 45
Global model norm: 97.10415437495452.
Norm before scaling: 95.71544436015799. Distance: 10.774718144175548
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1063.9493643966332, distance: 1077.471809376004
Total norm for 4 adversaries is: 1063.9493643966332. distance: 1077.471809376004
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 208, local model 44, internal_epoch   1,  Average loss: 0.1243, Accuracy: 48/436 (11.0092%)
___Train Local_ResNet_18,  epoch 208, local model 44, internal_epoch   2,  Average loss: 0.0587, Accuracy: 161/436 (36.9266%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 86, internal_epoch   1,  Average loss: 0.2114, Accuracy: 24/212 (11.3208%)
___Train Local_ResNet_18,  epoch 208, local model 86, internal_epoch   2,  Average loss: 0.1212, Accuracy: 39/212 (18.3962%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 20, internal_epoch   1,  Average loss: 0.1186, Accuracy: 74/362 (20.4420%)
___Train Local_ResNet_18,  epoch 208, local model 20, internal_epoch   2,  Average loss: 0.0648, Accuracy: 187/362 (51.6575%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 50, internal_epoch   1,  Average loss: 0.1863, Accuracy: 18/401 (4.4888%)
___Train Local_ResNet_18,  epoch 208, local model 50, internal_epoch   2,  Average loss: 0.0698, Accuracy: 65/401 (16.2095%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 49, internal_epoch   1,  Average loss: 0.1645, Accuracy: 13/426 (3.0516%)
___Train Local_ResNet_18,  epoch 208, local model 49, internal_epoch   2,  Average loss: 0.0591, Accuracy: 87/426 (20.4225%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 43, internal_epoch   1,  Average loss: 0.2228, Accuracy: 8/345 (2.3188%)
___Train Local_ResNet_18,  epoch 208, local model 43, internal_epoch   2,  Average loss: 0.0976, Accuracy: 17/345 (4.9275%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 194.36399388313293
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 243.13948798179626 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:209 choose agents : [17, 33, 77, 11, 28, 51, 4, 97, 85, 59]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   1,  Average loss: 0.2283, Accuracy: 121/526 (23.0038%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   2,  Average loss: 0.0474, Accuracy: 170/526 (32.3194%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   3,  Average loss: 0.0413, Accuracy: 179/526 (34.0304%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   4,  Average loss: 0.0408, Accuracy: 191/526 (36.3118%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   5,  Average loss: 0.0354, Accuracy: 207/526 (39.3536%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   6,  Average loss: 0.0353, Accuracy: 214/526 (40.6844%), train_poison_data_count: 45
Global model norm: 97.94392628087002.
Norm before scaling: 96.90474845660299. Distance: 17.488270343558135
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1736.99640183853, distance: 1748.8269639961525
Total norm for 4 adversaries is: 1736.99640183853. distance: 1748.8269639961525
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   1,  Average loss: 0.3467, Accuracy: 80/527 (15.1803%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   2,  Average loss: 0.0784, Accuracy: 99/527 (18.7856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   3,  Average loss: 0.0601, Accuracy: 87/527 (16.5085%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   4,  Average loss: 0.0374, Accuracy: 183/527 (34.7249%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   5,  Average loss: 0.0326, Accuracy: 101/527 (19.1651%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   6,  Average loss: 0.0292, Accuracy: 200/527 (37.9507%), train_poison_data_count: 45
Global model norm: 97.94392628087002.
Norm before scaling: 97.27219480824158. Distance: 22.97669000729666
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2285.381696785025, distance: 2297.6690362190984
Total norm for 4 adversaries is: 2285.381696785025. distance: 2297.6690362190984
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   1,  Average loss: 0.2500, Accuracy: 113/496 (22.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   2,  Average loss: 0.0599, Accuracy: 58/496 (11.6935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   3,  Average loss: 0.0541, Accuracy: 107/496 (21.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   4,  Average loss: 0.0470, Accuracy: 137/496 (27.6210%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   5,  Average loss: 0.0378, Accuracy: 142/496 (28.6290%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   6,  Average loss: 0.0344, Accuracy: 115/496 (23.1855%), train_poison_data_count: 40
Global model norm: 97.94392628087002.
Norm before scaling: 97.04245104431101. Distance: 18.21541631699815
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1810.2068942526985, distance: 1821.5416547529182
Total norm for 4 adversaries is: 1810.2068942526985. distance: 1821.5416547529182
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   1,  Average loss: 0.3073, Accuracy: 83/546 (15.2015%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   2,  Average loss: 0.0688, Accuracy: 97/546 (17.7656%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   3,  Average loss: 0.0587, Accuracy: 118/546 (21.6117%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   4,  Average loss: 0.0385, Accuracy: 168/546 (30.7692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   5,  Average loss: 0.0343, Accuracy: 154/546 (28.2051%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   6,  Average loss: 0.0302, Accuracy: 173/546 (31.6850%), train_poison_data_count: 45
Global model norm: 97.94392628087002.
Norm before scaling: 97.20210400725645. Distance: 21.831322186664938
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2171.064830906714, distance: 2183.1322680955454
Total norm for 4 adversaries is: 2171.064830906714. distance: 2183.1322680955454
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 209, local model 28, internal_epoch   1,  Average loss: 0.3624, Accuracy: 35/423 (8.2742%)
___Train Local_ResNet_18,  epoch 209, local model 28, internal_epoch   2,  Average loss: 0.0737, Accuracy: 51/423 (12.0567%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 51, internal_epoch   1,  Average loss: 0.2259, Accuracy: 169/479 (35.2818%)
___Train Local_ResNet_18,  epoch 209, local model 51, internal_epoch   2,  Average loss: 0.0341, Accuracy: 295/479 (61.5866%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   1,  Average loss: 0.2418, Accuracy: 95/557 (17.0557%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   2,  Average loss: 0.0467, Accuracy: 154/557 (27.6481%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 97, internal_epoch   1,  Average loss: 0.2012, Accuracy: 130/418 (31.1005%)
___Train Local_ResNet_18,  epoch 209, local model 97, internal_epoch   2,  Average loss: 0.0454, Accuracy: 137/418 (32.7751%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 85, internal_epoch   1,  Average loss: 0.4206, Accuracy: 33/364 (9.0659%)
___Train Local_ResNet_18,  epoch 209, local model 85, internal_epoch   2,  Average loss: 0.0971, Accuracy: 26/364 (7.1429%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 59, internal_epoch   1,  Average loss: 0.2248, Accuracy: 105/642 (16.3551%)
___Train Local_ResNet_18,  epoch 209, local model 59, internal_epoch   2,  Average loss: 0.0406, Accuracy: 163/642 (25.3894%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 197.66332077980042
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 244.31184911727905 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:210 choose agents : [17, 33, 77, 11, 51, 13, 57, 76, 80, 85]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   1,  Average loss: 0.2570, Accuracy: 80/526 (15.2091%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   2,  Average loss: 0.0854, Accuracy: 89/526 (16.9202%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   3,  Average loss: 0.0578, Accuracy: 79/526 (15.0190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   4,  Average loss: 0.0440, Accuracy: 65/526 (12.3574%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   5,  Average loss: 0.0344, Accuracy: 125/526 (23.7643%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   6,  Average loss: 0.0321, Accuracy: 168/526 (31.9392%), train_poison_data_count: 45
Global model norm: 116.24332558124574.
Norm before scaling: 115.1980716120066. Distance: 20.77958463721815
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2064.9583530909285, distance: 2077.9583730190557
Total norm for 4 adversaries is: 2064.9583530909285. distance: 2077.9583730190557
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   1,  Average loss: 0.1788, Accuracy: 180/527 (34.1556%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   2,  Average loss: 0.0521, Accuracy: 199/527 (37.7609%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   3,  Average loss: 0.0459, Accuracy: 150/527 (28.4630%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   4,  Average loss: 0.0395, Accuracy: 166/527 (31.4991%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   5,  Average loss: 0.0343, Accuracy: 143/527 (27.1347%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   6,  Average loss: 0.0291, Accuracy: 203/527 (38.5199%), train_poison_data_count: 45
Global model norm: 116.24332558124574.
Norm before scaling: 114.8908746852312. Distance: 14.773221632148424
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1463.867821901964, distance: 1477.3222397297077
Total norm for 4 adversaries is: 1463.867821901964. distance: 1477.3222397297077
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   1,  Average loss: 0.2102, Accuracy: 98/496 (19.7581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   2,  Average loss: 0.0572, Accuracy: 95/496 (19.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   3,  Average loss: 0.0435, Accuracy: 123/496 (24.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   4,  Average loss: 0.0363, Accuracy: 125/496 (25.2016%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   5,  Average loss: 0.0344, Accuracy: 132/496 (26.6129%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   6,  Average loss: 0.0347, Accuracy: 131/496 (26.4113%), train_poison_data_count: 40
Global model norm: 116.24332558124574.
Norm before scaling: 115.26842823112928. Distance: 16.96074677460706
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1684.887310771851, distance: 1696.0748804224418
Total norm for 4 adversaries is: 1684.887310771851. distance: 1696.0748804224418
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   1,  Average loss: 0.1966, Accuracy: 109/546 (19.9634%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   2,  Average loss: 0.0616, Accuracy: 131/546 (23.9927%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   3,  Average loss: 0.0467, Accuracy: 179/546 (32.7839%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   4,  Average loss: 0.0384, Accuracy: 170/546 (31.1355%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   5,  Average loss: 0.0332, Accuracy: 172/546 (31.5018%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   6,  Average loss: 0.0313, Accuracy: 160/546 (29.3040%), train_poison_data_count: 45
Global model norm: 116.24332558124574.
Norm before scaling: 114.88800167853691. Distance: 15.735953228165856
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1560.0084935666216, distance: 1573.5952465611988
Total norm for 4 adversaries is: 1560.0084935666216. distance: 1573.5952465611988
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 210, local model 51, internal_epoch   1,  Average loss: 0.2187, Accuracy: 142/479 (29.6451%)
___Train Local_ResNet_18,  epoch 210, local model 51, internal_epoch   2,  Average loss: 0.0375, Accuracy: 226/479 (47.1816%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 13, internal_epoch   1,  Average loss: 0.2176, Accuracy: 150/620 (24.1935%)
___Train Local_ResNet_18,  epoch 210, local model 13, internal_epoch   2,  Average loss: 0.0483, Accuracy: 271/620 (43.7097%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   1,  Average loss: 0.3706, Accuracy: 32/290 (11.0345%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   2,  Average loss: 0.0741, Accuracy: 25/290 (8.6207%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 76, internal_epoch   1,  Average loss: 1.0501, Accuracy: 2/65 (3.0769%)
___Train Local_ResNet_18,  epoch 210, local model 76, internal_epoch   2,  Average loss: 0.4813, Accuracy: 1/65 (1.5385%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 80, internal_epoch   1,  Average loss: 0.3857, Accuracy: 2/363 (0.5510%)
___Train Local_ResNet_18,  epoch 210, local model 80, internal_epoch   2,  Average loss: 0.0869, Accuracy: 29/363 (7.9890%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 85, internal_epoch   1,  Average loss: 0.2466, Accuracy: 82/364 (22.5275%)
___Train Local_ResNet_18,  epoch 210, local model 85, internal_epoch   2,  Average loss: 0.0589, Accuracy: 95/364 (26.0989%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 196.99130034446716
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 241.29819774627686 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:211 choose agents : [17, 33, 77, 11, 90, 24, 63, 1, 52, 31]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   1,  Average loss: 0.0985, Accuracy: 132/526 (25.0951%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   2,  Average loss: 0.0813, Accuracy: 151/526 (28.7072%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   3,  Average loss: 0.0688, Accuracy: 134/526 (25.4753%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   4,  Average loss: 0.0607, Accuracy: 133/526 (25.2852%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   5,  Average loss: 0.0556, Accuracy: 166/526 (31.5589%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   6,  Average loss: 0.0500, Accuracy: 167/526 (31.7490%), train_poison_data_count: 45
Global model norm: 125.11951708141899.
Norm before scaling: 124.06932049891505. Distance: 16.293808323939054
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1617.9671659214844, distance: 1629.3806338606091
Total norm for 4 adversaries is: 1617.9671659214844. distance: 1629.3806338606091
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   1,  Average loss: 0.1874, Accuracy: 62/527 (11.7647%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   2,  Average loss: 0.1329, Accuracy: 60/527 (11.3852%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   3,  Average loss: 0.1037, Accuracy: 54/527 (10.2467%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   4,  Average loss: 0.0763, Accuracy: 64/527 (12.1442%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   5,  Average loss: 0.0471, Accuracy: 99/527 (18.7856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   6,  Average loss: 0.0369, Accuracy: 151/527 (28.6528%), train_poison_data_count: 45
Global model norm: 125.11951708141899.
Norm before scaling: 126.02072312223098. Distance: 29.954103074798034
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2986.812180234974, distance: 2995.4106563207656
Total norm for 4 adversaries is: 2986.812180234974. distance: 2995.4106563207656
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   1,  Average loss: 0.1292, Accuracy: 26/496 (5.2419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   2,  Average loss: 0.1030, Accuracy: 25/496 (5.0403%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   3,  Average loss: 0.0815, Accuracy: 105/496 (21.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   4,  Average loss: 0.0655, Accuracy: 110/496 (22.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   5,  Average loss: 0.0528, Accuracy: 125/496 (25.2016%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   6,  Average loss: 0.0445, Accuracy: 124/496 (25.0000%), train_poison_data_count: 40
Global model norm: 125.11951708141899.
Norm before scaling: 124.52944242728303. Distance: 18.889561978982268
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1879.7332922518556, distance: 1888.9561932453596
Total norm for 4 adversaries is: 1879.7332922518556. distance: 1888.9561932453596
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   1,  Average loss: 0.1225, Accuracy: 71/546 (13.0037%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   2,  Average loss: 0.0867, Accuracy: 63/546 (11.5385%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   3,  Average loss: 0.0614, Accuracy: 95/546 (17.3993%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   4,  Average loss: 0.0461, Accuracy: 140/546 (25.6410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   5,  Average loss: 0.0406, Accuracy: 170/546 (31.1355%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   6,  Average loss: 0.0355, Accuracy: 189/546 (34.6154%), train_poison_data_count: 45
Global model norm: 125.11951708141899.
Norm before scaling: 124.42858848678024. Distance: 18.6100957236065
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1851.2526839953534, distance: 1861.009605026261
Total norm for 4 adversaries is: 1851.2526839953534. distance: 1861.009605026261
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 211, local model 90, internal_epoch   1,  Average loss: 0.1138, Accuracy: 15/578 (2.5952%)
___Train Local_ResNet_18,  epoch 211, local model 90, internal_epoch   2,  Average loss: 0.0423, Accuracy: 256/578 (44.2907%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 24, internal_epoch   1,  Average loss: 0.1195, Accuracy: 21/320 (6.5625%)
___Train Local_ResNet_18,  epoch 211, local model 24, internal_epoch   2,  Average loss: 0.0811, Accuracy: 38/320 (11.8750%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 63, internal_epoch   1,  Average loss: 0.0825, Accuracy: 68/752 (9.0426%)
___Train Local_ResNet_18,  epoch 211, local model 63, internal_epoch   2,  Average loss: 0.0504, Accuracy: 153/752 (20.3457%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 1, internal_epoch   1,  Average loss: 0.1169, Accuracy: 31/641 (4.8362%)
___Train Local_ResNet_18,  epoch 211, local model 1, internal_epoch   2,  Average loss: 0.0492, Accuracy: 153/641 (23.8690%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 52, internal_epoch   1,  Average loss: 0.0684, Accuracy: 39/214 (18.2243%)
___Train Local_ResNet_18,  epoch 211, local model 52, internal_epoch   2,  Average loss: 0.0432, Accuracy: 53/214 (24.7664%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 31, internal_epoch   1,  Average loss: 0.1100, Accuracy: 65/706 (9.2068%)
___Train Local_ResNet_18,  epoch 211, local model 31, internal_epoch   2,  Average loss: 0.0578, Accuracy: 183/706 (25.9207%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 203.2474000453949
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 250.77065253257751 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:212 choose agents : [17, 33, 77, 11, 59, 67, 71, 66, 76, 96]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   1,  Average loss: 0.3476, Accuracy: 38/526 (7.2243%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   2,  Average loss: 0.1046, Accuracy: 39/526 (7.4144%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   3,  Average loss: 0.0572, Accuracy: 83/526 (15.7795%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   4,  Average loss: 0.0429, Accuracy: 146/526 (27.7567%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   5,  Average loss: 0.0368, Accuracy: 107/526 (20.3422%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   6,  Average loss: 0.0332, Accuracy: 146/526 (27.7567%), train_poison_data_count: 45
Global model norm: 128.048834068296.
Norm before scaling: 126.71930101606463. Distance: 20.549951498526628
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2040.4163790756043, distance: 2054.995012159397
Total norm for 4 adversaries is: 2040.4163790756043. distance: 2054.995012159397
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   1,  Average loss: 0.2333, Accuracy: 131/527 (24.8577%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   2,  Average loss: 0.0737, Accuracy: 76/527 (14.4213%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   3,  Average loss: 0.0603, Accuracy: 146/527 (27.7040%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   4,  Average loss: 0.0515, Accuracy: 166/527 (31.4991%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   5,  Average loss: 0.0447, Accuracy: 130/527 (24.6679%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   6,  Average loss: 0.0369, Accuracy: 163/527 (30.9298%), train_poison_data_count: 45
Global model norm: 128.048834068296.
Norm before scaling: 126.47033295278186. Distance: 15.975218177702466
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1582.0165138202572, distance: 1597.5218308367496
Total norm for 4 adversaries is: 1582.0165138202572. distance: 1597.5218308367496
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   1,  Average loss: 0.2679, Accuracy: 53/496 (10.6855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   2,  Average loss: 0.0693, Accuracy: 87/496 (17.5403%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   3,  Average loss: 0.0550, Accuracy: 97/496 (19.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   4,  Average loss: 0.0479, Accuracy: 106/496 (21.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   5,  Average loss: 0.0456, Accuracy: 106/496 (21.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   6,  Average loss: 0.0427, Accuracy: 114/496 (22.9839%), train_poison_data_count: 40
Global model norm: 128.048834068296.
Norm before scaling: 126.83952321117224. Distance: 18.46563332945319
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1833.376938875364, distance: 1846.5632943389728
Total norm for 4 adversaries is: 1833.376938875364. distance: 1846.5632943389728
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   1,  Average loss: 0.2677, Accuracy: 117/546 (21.4286%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   2,  Average loss: 0.0805, Accuracy: 135/546 (24.7253%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   3,  Average loss: 0.0707, Accuracy: 101/546 (18.4982%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   4,  Average loss: 0.0641, Accuracy: 107/546 (19.5971%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   5,  Average loss: 0.0533, Accuracy: 107/546 (19.5971%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   6,  Average loss: 0.0451, Accuracy: 113/546 (20.6960%), train_poison_data_count: 45
Global model norm: 128.048834068296.
Norm before scaling: 126.49100604143759. Distance: 18.507261758373893
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1835.1237696678663, distance: 1850.7262088164202
Total norm for 4 adversaries is: 1835.1237696678663. distance: 1850.7262088164202
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 212, local model 59, internal_epoch   1,  Average loss: 0.1733, Accuracy: 77/642 (11.9938%)
___Train Local_ResNet_18,  epoch 212, local model 59, internal_epoch   2,  Average loss: 0.0478, Accuracy: 104/642 (16.1994%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 67, internal_epoch   1,  Average loss: 0.1789, Accuracy: 132/842 (15.6770%)
___Train Local_ResNet_18,  epoch 212, local model 67, internal_epoch   2,  Average loss: 0.0429, Accuracy: 164/842 (19.4774%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 71, internal_epoch   1,  Average loss: 0.1575, Accuracy: 230/1166 (19.7256%)
___Train Local_ResNet_18,  epoch 212, local model 71, internal_epoch   2,  Average loss: 0.0389, Accuracy: 336/1166 (28.8165%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 66, internal_epoch   1,  Average loss: 0.2500, Accuracy: 97/555 (17.4775%)
___Train Local_ResNet_18,  epoch 212, local model 66, internal_epoch   2,  Average loss: 0.0615, Accuracy: 184/555 (33.1532%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 76, internal_epoch   1,  Average loss: 0.8299, Accuracy: 1/65 (1.5385%)
___Train Local_ResNet_18,  epoch 212, local model 76, internal_epoch   2,  Average loss: 0.6352, Accuracy: 1/65 (1.5385%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 96, internal_epoch   1,  Average loss: 0.1421, Accuracy: 137/708 (19.3503%)
___Train Local_ResNet_18,  epoch 212, local model 96, internal_epoch   2,  Average loss: 0.0520, Accuracy: 110/708 (15.5367%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 198.03142619132996
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 247.8628966808319 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:213 choose agents : [17, 33, 77, 11, 80, 81, 22, 72, 64, 45]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   1,  Average loss: 0.0602, Accuracy: 15/526 (2.8517%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   2,  Average loss: 0.0411, Accuracy: 128/526 (24.3346%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   3,  Average loss: 0.0341, Accuracy: 166/526 (31.5589%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   4,  Average loss: 0.0334, Accuracy: 164/526 (31.1787%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   5,  Average loss: 0.0321, Accuracy: 163/526 (30.9886%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   6,  Average loss: 0.0311, Accuracy: 184/526 (34.9810%), train_poison_data_count: 45
Global model norm: 137.23334939984522.
Norm before scaling: 135.66905246545727. Distance: 5.731532085968833
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 548.9650489785301, distance: 573.1532299481527
Total norm for 4 adversaries is: 548.9650489785301. distance: 573.1532299481527
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   1,  Average loss: 0.0746, Accuracy: 59/527 (11.1954%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   2,  Average loss: 0.0453, Accuracy: 106/527 (20.1139%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   3,  Average loss: 0.0377, Accuracy: 160/527 (30.3605%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   4,  Average loss: 0.0347, Accuracy: 159/527 (30.1708%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   5,  Average loss: 0.0334, Accuracy: 128/527 (24.2884%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   6,  Average loss: 0.0328, Accuracy: 164/527 (31.1195%), train_poison_data_count: 45
Global model norm: 137.23334939984522.
Norm before scaling: 135.64506619989908. Distance: 6.345046639056851
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 611.6065166837253, distance: 634.5046296127397
Total norm for 4 adversaries is: 611.6065166837253. distance: 634.5046296127397
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   1,  Average loss: 0.0604, Accuracy: 102/496 (20.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   2,  Average loss: 0.0428, Accuracy: 104/496 (20.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   3,  Average loss: 0.0359, Accuracy: 91/496 (18.3468%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   4,  Average loss: 0.0339, Accuracy: 109/496 (21.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   5,  Average loss: 0.0323, Accuracy: 146/496 (29.4355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   6,  Average loss: 0.0308, Accuracy: 161/496 (32.4597%), train_poison_data_count: 40
Global model norm: 137.23334939984522.
Norm before scaling: 135.84710356454053. Distance: 5.250269565019599
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 503.8592313335144, distance: 525.0269635932997
Total norm for 4 adversaries is: 503.8592313335144. distance: 525.0269635932997
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   1,  Average loss: 0.0661, Accuracy: 62/546 (11.3553%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   2,  Average loss: 0.0453, Accuracy: 66/546 (12.0879%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   3,  Average loss: 0.0374, Accuracy: 85/546 (15.5678%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   4,  Average loss: 0.0347, Accuracy: 152/546 (27.8388%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   5,  Average loss: 0.0337, Accuracy: 149/546 (27.2894%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   6,  Average loss: 0.0334, Accuracy: 159/546 (29.1209%), train_poison_data_count: 45
Global model norm: 137.23334939984522.
Norm before scaling: 135.63886737860207. Distance: 5.754249992384196
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 550.56964818268, distance: 575.4250059738454
Total norm for 4 adversaries is: 550.56964818268. distance: 575.4250059738454
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 213, local model 80, internal_epoch   1,  Average loss: 0.0458, Accuracy: 23/363 (6.3361%)
___Train Local_ResNet_18,  epoch 213, local model 80, internal_epoch   2,  Average loss: 0.0288, Accuracy: 183/363 (50.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 81, internal_epoch   1,  Average loss: 0.0416, Accuracy: 328/1034 (31.7215%)
___Train Local_ResNet_18,  epoch 213, local model 81, internal_epoch   2,  Average loss: 0.0264, Accuracy: 513/1034 (49.6132%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 22, internal_epoch   1,  Average loss: 0.0682, Accuracy: 28/494 (5.6680%)
___Train Local_ResNet_18,  epoch 213, local model 22, internal_epoch   2,  Average loss: 0.0351, Accuracy: 156/494 (31.5789%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 72, internal_epoch   1,  Average loss: 0.0401, Accuracy: 228/618 (36.8932%)
___Train Local_ResNet_18,  epoch 213, local model 72, internal_epoch   2,  Average loss: 0.0272, Accuracy: 315/618 (50.9709%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 64, internal_epoch   1,  Average loss: 0.0523, Accuracy: 129/686 (18.8047%)
___Train Local_ResNet_18,  epoch 213, local model 64, internal_epoch   2,  Average loss: 0.0301, Accuracy: 267/686 (38.9213%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 45, internal_epoch   1,  Average loss: 0.0535, Accuracy: 160/529 (30.2457%)
___Train Local_ResNet_18,  epoch 213, local model 45, internal_epoch   2,  Average loss: 0.0342, Accuracy: 232/529 (43.8563%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 195.56289172172546
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 242.53153109550476 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:214 choose agents : [17, 33, 77, 11, 80, 54, 44, 35, 68, 25]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   1,  Average loss: 0.1279, Accuracy: 113/526 (21.4829%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   2,  Average loss: 0.0625, Accuracy: 95/526 (18.0608%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   3,  Average loss: 0.0439, Accuracy: 139/526 (26.4259%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   4,  Average loss: 0.0375, Accuracy: 135/526 (25.6654%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   5,  Average loss: 0.0364, Accuracy: 143/526 (27.1863%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   6,  Average loss: 0.0357, Accuracy: 188/526 (35.7414%), train_poison_data_count: 45
Global model norm: 132.18424936901522.
Norm before scaling: 130.45125256920687. Distance: 10.586690615507594
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1039.9665259035985, distance: 1058.6690346845892
Total norm for 4 adversaries is: 1039.9665259035985. distance: 1058.6690346845892
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   1,  Average loss: 0.1078, Accuracy: 98/527 (18.5958%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   2,  Average loss: 0.0715, Accuracy: 160/527 (30.3605%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   3,  Average loss: 0.0513, Accuracy: 93/527 (17.6471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   4,  Average loss: 0.0494, Accuracy: 109/527 (20.6831%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   5,  Average loss: 0.0445, Accuracy: 162/527 (30.7400%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   6,  Average loss: 0.0437, Accuracy: 157/527 (29.7913%), train_poison_data_count: 45
Global model norm: 132.18424936901522.
Norm before scaling: 130.34189566530404. Distance: 9.099463277226507
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 888.1601769951184, distance: 909.9462896237338
Total norm for 4 adversaries is: 888.1601769951184. distance: 909.9462896237338
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   1,  Average loss: 0.1568, Accuracy: 54/496 (10.8871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   2,  Average loss: 0.0799, Accuracy: 118/496 (23.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   3,  Average loss: 0.0621, Accuracy: 82/496 (16.5323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   4,  Average loss: 0.0541, Accuracy: 89/496 (17.9435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   5,  Average loss: 0.0426, Accuracy: 136/496 (27.4194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   6,  Average loss: 0.0358, Accuracy: 158/496 (31.8548%), train_poison_data_count: 40
Global model norm: 132.18424936901522.
Norm before scaling: 130.55160916760084. Distance: 11.63077065588539
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1146.2103864474445, distance: 1163.0770610754903
Total norm for 4 adversaries is: 1146.2103864474445. distance: 1163.0770610754903
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   1,  Average loss: 0.1323, Accuracy: 133/546 (24.3590%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   2,  Average loss: 0.0740, Accuracy: 98/546 (17.9487%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   3,  Average loss: 0.0548, Accuracy: 110/546 (20.1465%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   4,  Average loss: 0.0478, Accuracy: 150/546 (27.4725%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   5,  Average loss: 0.0445, Accuracy: 148/546 (27.1062%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   6,  Average loss: 0.0403, Accuracy: 157/546 (28.7546%), train_poison_data_count: 45
Global model norm: 132.18424936901522.
Norm before scaling: 130.32706003791. Distance: 10.828681612227056
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1062.8248326982202, distance: 1082.868124473151
Total norm for 4 adversaries is: 1062.8248326982202. distance: 1082.868124473151
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 214, local model 80, internal_epoch   1,  Average loss: 0.1444, Accuracy: 74/363 (20.3857%)
___Train Local_ResNet_18,  epoch 214, local model 80, internal_epoch   2,  Average loss: 0.0499, Accuracy: 90/363 (24.7934%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   1,  Average loss: 0.1306, Accuracy: 77/440 (17.5000%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   2,  Average loss: 0.0415, Accuracy: 89/440 (20.2273%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 44, internal_epoch   1,  Average loss: 0.1515, Accuracy: 39/436 (8.9450%)
___Train Local_ResNet_18,  epoch 214, local model 44, internal_epoch   2,  Average loss: 0.0574, Accuracy: 32/436 (7.3394%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 35, internal_epoch   1,  Average loss: 0.1072, Accuracy: 64/419 (15.2745%)
___Train Local_ResNet_18,  epoch 214, local model 35, internal_epoch   2,  Average loss: 0.0441, Accuracy: 192/419 (45.8234%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 68, internal_epoch   1,  Average loss: 0.1762, Accuracy: 60/416 (14.4231%)
___Train Local_ResNet_18,  epoch 214, local model 68, internal_epoch   2,  Average loss: 0.0812, Accuracy: 73/416 (17.5481%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 25, internal_epoch   1,  Average loss: 0.1157, Accuracy: 87/545 (15.9633%)
___Train Local_ResNet_18,  epoch 214, local model 25, internal_epoch   2,  Average loss: 0.0381, Accuracy: 208/545 (38.1651%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 194.2380850315094
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 243.00568985939026 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:215 choose agents : [17, 33, 77, 11, 4, 79, 43, 63, 35, 49]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   1,  Average loss: 0.1154, Accuracy: 130/526 (24.7148%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   2,  Average loss: 0.0765, Accuracy: 136/526 (25.8555%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   3,  Average loss: 0.0585, Accuracy: 140/526 (26.6160%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   4,  Average loss: 0.0409, Accuracy: 183/526 (34.7909%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   5,  Average loss: 0.0354, Accuracy: 183/526 (34.7909%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   6,  Average loss: 0.0335, Accuracy: 178/526 (33.8403%), train_poison_data_count: 45
Global model norm: 129.3342025045966.
Norm before scaling: 127.67649395787386. Distance: 9.87008892541034
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 968.7967408078952, distance: 987.0088652084135
Total norm for 4 adversaries is: 968.7967408078952. distance: 987.0088652084135
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   1,  Average loss: 0.1446, Accuracy: 21/527 (3.9848%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   2,  Average loss: 0.0897, Accuracy: 22/527 (4.1746%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   3,  Average loss: 0.0624, Accuracy: 59/527 (11.1954%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   4,  Average loss: 0.0488, Accuracy: 164/527 (31.1195%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   5,  Average loss: 0.0371, Accuracy: 163/527 (30.9298%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   6,  Average loss: 0.0349, Accuracy: 135/527 (25.6167%), train_poison_data_count: 45
Global model norm: 129.3342025045966.
Norm before scaling: 127.63436929981869. Distance: 11.460147968288984
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1128.3896711686084, distance: 1146.0147795731084
Total norm for 4 adversaries is: 1128.3896711686084. distance: 1146.0147795731084
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   1,  Average loss: 0.1043, Accuracy: 88/496 (17.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   2,  Average loss: 0.0702, Accuracy: 57/496 (11.4919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   3,  Average loss: 0.0550, Accuracy: 76/496 (15.3226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   4,  Average loss: 0.0440, Accuracy: 108/496 (21.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   5,  Average loss: 0.0386, Accuracy: 92/496 (18.5484%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   6,  Average loss: 0.0361, Accuracy: 107/496 (21.5726%), train_poison_data_count: 40
Global model norm: 129.3342025045966.
Norm before scaling: 127.86445307189562. Distance: 9.142542033214918
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 898.0131889343274, distance: 914.2542042561248
Total norm for 4 adversaries is: 898.0131889343274. distance: 914.2542042561248
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   1,  Average loss: 0.1249, Accuracy: 78/546 (14.2857%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   2,  Average loss: 0.0835, Accuracy: 91/546 (16.6667%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   3,  Average loss: 0.0650, Accuracy: 107/546 (19.5971%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   4,  Average loss: 0.0448, Accuracy: 86/546 (15.7509%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   5,  Average loss: 0.0357, Accuracy: 122/546 (22.3443%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   6,  Average loss: 0.0321, Accuracy: 183/546 (33.5165%), train_poison_data_count: 45
Global model norm: 129.3342025045966.
Norm before scaling: 127.64765500441048. Distance: 10.810527996539523
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1063.1906578784447, distance: 1081.0528432967558
Total norm for 4 adversaries is: 1063.1906578784447. distance: 1081.0528432967558
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 215, local model 4, internal_epoch   1,  Average loss: 0.1151, Accuracy: 101/557 (18.1329%)
___Train Local_ResNet_18,  epoch 215, local model 4, internal_epoch   2,  Average loss: 0.0559, Accuracy: 154/557 (27.6481%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 79, internal_epoch   1,  Average loss: 0.1074, Accuracy: 32/154 (20.7792%)
___Train Local_ResNet_18,  epoch 215, local model 79, internal_epoch   2,  Average loss: 0.0833, Accuracy: 34/154 (22.0779%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 43, internal_epoch   1,  Average loss: 0.0669, Accuracy: 135/345 (39.1304%)
___Train Local_ResNet_18,  epoch 215, local model 43, internal_epoch   2,  Average loss: 0.0490, Accuracy: 133/345 (38.5507%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 63, internal_epoch   1,  Average loss: 0.0623, Accuracy: 152/752 (20.2128%)
___Train Local_ResNet_18,  epoch 215, local model 63, internal_epoch   2,  Average loss: 0.0412, Accuracy: 184/752 (24.4681%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 35, internal_epoch   1,  Average loss: 0.0947, Accuracy: 17/419 (4.0573%)
___Train Local_ResNet_18,  epoch 215, local model 35, internal_epoch   2,  Average loss: 0.0517, Accuracy: 122/419 (29.1169%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 49, internal_epoch   1,  Average loss: 0.0623, Accuracy: 49/426 (11.5023%)
___Train Local_ResNet_18,  epoch 215, local model 49, internal_epoch   2,  Average loss: 0.0377, Accuracy: 120/426 (28.1690%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 196.38269233703613
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 243.97753739356995 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:216 choose agents : [17, 33, 77, 11, 8, 12, 18, 94, 57, 83]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   1,  Average loss: 0.2691, Accuracy: 70/526 (13.3080%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   2,  Average loss: 0.1287, Accuracy: 81/526 (15.3992%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   3,  Average loss: 0.0940, Accuracy: 138/526 (26.2357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   4,  Average loss: 0.0870, Accuracy: 137/526 (26.0456%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   5,  Average loss: 0.0672, Accuracy: 145/526 (27.5665%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   6,  Average loss: 0.0508, Accuracy: 145/526 (27.5665%), train_poison_data_count: 45
Global model norm: 127.08710334230418.
Norm before scaling: 124.97231334004545. Distance: 17.094998776083514
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1689.9739642964917, distance: 1709.4998537584027
Total norm for 4 adversaries is: 1689.9739642964917. distance: 1709.4998537584027
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   1,  Average loss: 0.1778, Accuracy: 100/527 (18.9753%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   2,  Average loss: 0.0787, Accuracy: 165/527 (31.3093%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   3,  Average loss: 0.0574, Accuracy: 166/527 (31.4991%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   4,  Average loss: 0.0528, Accuracy: 164/527 (31.1195%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   5,  Average loss: 0.0469, Accuracy: 158/527 (29.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   6,  Average loss: 0.0461, Accuracy: 134/527 (25.4269%), train_poison_data_count: 45
Global model norm: 127.08710334230418.
Norm before scaling: 125.2619988638813. Distance: 13.458451371910444
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1327.8859137742218, distance: 1345.84513410719
Total norm for 4 adversaries is: 1327.8859137742218. distance: 1345.84513410719
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   1,  Average loss: 0.2514, Accuracy: 41/496 (8.2661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   2,  Average loss: 0.1136, Accuracy: 73/496 (14.7177%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   3,  Average loss: 0.0856, Accuracy: 69/496 (13.9113%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   4,  Average loss: 0.0778, Accuracy: 84/496 (16.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   5,  Average loss: 0.0681, Accuracy: 95/496 (19.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   6,  Average loss: 0.0544, Accuracy: 124/496 (25.0000%), train_poison_data_count: 40
Global model norm: 127.08710334230418.
Norm before scaling: 125.36053864130251. Distance: 16.967393908750026
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1680.0892089410015, distance: 1696.7393730328768
Total norm for 4 adversaries is: 1680.0892089410015. distance: 1696.7393730328768
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   1,  Average loss: 0.2399, Accuracy: 119/546 (21.7949%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   2,  Average loss: 0.1169, Accuracy: 77/546 (14.1026%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   3,  Average loss: 0.0904, Accuracy: 86/546 (15.7509%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   4,  Average loss: 0.0782, Accuracy: 68/546 (12.4542%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   5,  Average loss: 0.0657, Accuracy: 102/546 (18.6813%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   6,  Average loss: 0.0555, Accuracy: 154/546 (28.2051%), train_poison_data_count: 45
Global model norm: 127.08710334230418.
Norm before scaling: 124.95817268940435. Distance: 15.935264280992586
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1573.6662606791822, distance: 1593.5264353000234
Total norm for 4 adversaries is: 1573.6662606791822. distance: 1593.5264353000234
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 216, local model 8, internal_epoch   1,  Average loss: 0.1542, Accuracy: 105/534 (19.6629%)
___Train Local_ResNet_18,  epoch 216, local model 8, internal_epoch   2,  Average loss: 0.0599, Accuracy: 44/534 (8.2397%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 216, local model 12, internal_epoch   1,  Average loss: 0.1485, Accuracy: 308/977 (31.5251%)
___Train Local_ResNet_18,  epoch 216, local model 12, internal_epoch   2,  Average loss: 0.0662, Accuracy: 398/977 (40.7369%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 216, local model 18, internal_epoch   1,  Average loss: 0.3053, Accuracy: 56/386 (14.5078%)
___Train Local_ResNet_18,  epoch 216, local model 18, internal_epoch   2,  Average loss: 0.1343, Accuracy: 43/386 (11.1399%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 216, local model 94, internal_epoch   1,  Average loss: 0.2699, Accuracy: 0/203 (0.0000%)
___Train Local_ResNet_18,  epoch 216, local model 94, internal_epoch   2,  Average loss: 0.0833, Accuracy: 76/203 (37.4384%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 216, local model 57, internal_epoch   1,  Average loss: 0.2855, Accuracy: 29/290 (10.0000%)
___Train Local_ResNet_18,  epoch 216, local model 57, internal_epoch   2,  Average loss: 0.1273, Accuracy: 87/290 (30.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 216, local model 83, internal_epoch   1,  Average loss: 0.2924, Accuracy: 35/366 (9.5628%)
___Train Local_ResNet_18,  epoch 216, local model 83, internal_epoch   2,  Average loss: 0.1259, Accuracy: 32/366 (8.7432%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 197.30808806419373
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 244.48488068580627 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:217 choose agents : [17, 33, 77, 11, 37, 22, 38, 65, 29, 18]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   1,  Average loss: 0.3527, Accuracy: 62/526 (11.7871%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   2,  Average loss: 0.0842, Accuracy: 62/526 (11.7871%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   3,  Average loss: 0.0605, Accuracy: 61/526 (11.5970%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   4,  Average loss: 0.0398, Accuracy: 137/526 (26.0456%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   5,  Average loss: 0.0351, Accuracy: 143/526 (27.1863%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   6,  Average loss: 0.0329, Accuracy: 172/526 (32.6996%), train_poison_data_count: 45
Global model norm: 130.17374957388682.
Norm before scaling: 128.5080326404735. Distance: 20.045121982248027
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1987.8996453543625, distance: 2004.5122848214226
Total norm for 4 adversaries is: 1987.8996453543625. distance: 2004.5122848214226
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   1,  Average loss: 0.3697, Accuracy: 49/527 (9.2979%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   2,  Average loss: 0.0659, Accuracy: 43/527 (8.1594%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   3,  Average loss: 0.0512, Accuracy: 147/527 (27.8937%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   4,  Average loss: 0.0433, Accuracy: 162/527 (30.7400%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   5,  Average loss: 0.0379, Accuracy: 163/527 (30.9298%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   6,  Average loss: 0.0340, Accuracy: 162/527 (30.7400%), train_poison_data_count: 45
Global model norm: 130.17374957388682.
Norm before scaling: 128.6574151331745. Distance: 21.682347106007473
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2152.191325138172, distance: 2168.234765886757
Total norm for 4 adversaries is: 2152.191325138172. distance: 2168.234765886757
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   1,  Average loss: 0.3047, Accuracy: 88/496 (17.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   2,  Average loss: 0.0732, Accuracy: 45/496 (9.0726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   3,  Average loss: 0.0453, Accuracy: 112/496 (22.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   4,  Average loss: 0.0388, Accuracy: 145/496 (29.2339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   5,  Average loss: 0.0368, Accuracy: 128/496 (25.8065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   6,  Average loss: 0.0360, Accuracy: 121/496 (24.3952%), train_poison_data_count: 40
Global model norm: 130.17374957388682.
Norm before scaling: 128.71590871469618. Distance: 18.610568811413987
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1846.104208867961, distance: 1861.0568905866364
Total norm for 4 adversaries is: 1846.104208867961. distance: 1861.0568905866364
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   1,  Average loss: 0.3288, Accuracy: 56/546 (10.2564%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   2,  Average loss: 0.0631, Accuracy: 54/546 (9.8901%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   3,  Average loss: 0.0532, Accuracy: 142/546 (26.0073%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   4,  Average loss: 0.0452, Accuracy: 139/546 (25.4579%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   5,  Average loss: 0.0399, Accuracy: 143/546 (26.1905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   6,  Average loss: 0.0359, Accuracy: 146/546 (26.7399%), train_poison_data_count: 45
Global model norm: 130.17374957388682.
Norm before scaling: 128.5553519524761. Distance: 20.19294821145994
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2002.9600595119214, distance: 2019.2949264532906
Total norm for 4 adversaries is: 2002.9600595119214. distance: 2019.2949264532906
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 217, local model 37, internal_epoch   1,  Average loss: 0.1852, Accuracy: 80/725 (11.0345%)
___Train Local_ResNet_18,  epoch 217, local model 37, internal_epoch   2,  Average loss: 0.0287, Accuracy: 355/725 (48.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 217, local model 22, internal_epoch   1,  Average loss: 0.2344, Accuracy: 86/494 (17.4089%)
___Train Local_ResNet_18,  epoch 217, local model 22, internal_epoch   2,  Average loss: 0.0366, Accuracy: 120/494 (24.2915%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 217, local model 38, internal_epoch   1,  Average loss: 0.2226, Accuracy: 57/756 (7.5397%)
___Train Local_ResNet_18,  epoch 217, local model 38, internal_epoch   2,  Average loss: 0.0411, Accuracy: 230/756 (30.4233%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 217, local model 65, internal_epoch   1,  Average loss: 0.3280, Accuracy: 10/314 (3.1847%)
___Train Local_ResNet_18,  epoch 217, local model 65, internal_epoch   2,  Average loss: 0.0557, Accuracy: 122/314 (38.8535%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 217, local model 29, internal_epoch   1,  Average loss: 0.1954, Accuracy: 237/848 (27.9481%)
___Train Local_ResNet_18,  epoch 217, local model 29, internal_epoch   2,  Average loss: 0.0361, Accuracy: 341/848 (40.2123%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 217, local model 18, internal_epoch   1,  Average loss: 0.2932, Accuracy: 39/386 (10.1036%)
___Train Local_ResNet_18,  epoch 217, local model 18, internal_epoch   2,  Average loss: 0.0455, Accuracy: 68/386 (17.6166%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 196.84127497673035
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 245.29813694953918 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:218 choose agents : [17, 33, 77, 11, 53, 15, 7, 29, 86, 60]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   1,  Average loss: 0.2973, Accuracy: 128/526 (24.3346%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   2,  Average loss: 0.0498, Accuracy: 90/526 (17.1103%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   3,  Average loss: 0.0471, Accuracy: 82/526 (15.5894%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   4,  Average loss: 0.0433, Accuracy: 100/526 (19.0114%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   5,  Average loss: 0.0397, Accuracy: 135/526 (25.6654%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   6,  Average loss: 0.0377, Accuracy: 137/526 (26.0456%), train_poison_data_count: 45
Global model norm: 141.47604285929472.
Norm before scaling: 139.92932088647467. Distance: 19.28609105302235
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1912.8061846407754, distance: 1928.6090194749167
Total norm for 4 adversaries is: 1912.8061846407754. distance: 1928.6090194749167
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   1,  Average loss: 0.3723, Accuracy: 71/527 (13.4725%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   2,  Average loss: 0.0608, Accuracy: 105/527 (19.9241%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   3,  Average loss: 0.0574, Accuracy: 162/527 (30.7400%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   4,  Average loss: 0.0506, Accuracy: 155/527 (29.4118%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   5,  Average loss: 0.0474, Accuracy: 161/527 (30.5503%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   6,  Average loss: 0.0440, Accuracy: 164/527 (31.1195%), train_poison_data_count: 45
Global model norm: 141.47604285929472.
Norm before scaling: 140.02536740042856. Distance: 23.130879742375775
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2296.965607056405, distance: 2313.087979303857
Total norm for 4 adversaries is: 2296.965607056405. distance: 2313.087979303857
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   1,  Average loss: 0.4257, Accuracy: 20/496 (4.0323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   2,  Average loss: 0.0751, Accuracy: 84/496 (16.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   3,  Average loss: 0.0606, Accuracy: 97/496 (19.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   4,  Average loss: 0.0540, Accuracy: 118/496 (23.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   5,  Average loss: 0.0465, Accuracy: 114/496 (22.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   6,  Average loss: 0.0366, Accuracy: 130/496 (26.2097%), train_poison_data_count: 40
Global model norm: 141.47604285929472.
Norm before scaling: 140.4022054558795. Distance: 24.866141884237514
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2472.0767585170165, distance: 2486.614163878264
Total norm for 4 adversaries is: 2472.0767585170165. distance: 2486.614163878264
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   1,  Average loss: 0.3404, Accuracy: 68/546 (12.4542%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   2,  Average loss: 0.0574, Accuracy: 64/546 (11.7216%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   3,  Average loss: 0.0558, Accuracy: 127/546 (23.2601%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   4,  Average loss: 0.0509, Accuracy: 129/546 (23.6264%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   5,  Average loss: 0.0474, Accuracy: 99/546 (18.1319%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   6,  Average loss: 0.0436, Accuracy: 131/546 (23.9927%), train_poison_data_count: 45
Global model norm: 141.47604285929472.
Norm before scaling: 140.0285754877375. Distance: 22.331758282287485
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2217.311998794937, distance: 2233.175765585862
Total norm for 4 adversaries is: 2217.311998794937. distance: 2233.175765585862
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 218, local model 53, internal_epoch   1,  Average loss: 0.2398, Accuracy: 102/625 (16.3200%)
___Train Local_ResNet_18,  epoch 218, local model 53, internal_epoch   2,  Average loss: 0.0397, Accuracy: 195/625 (31.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 218, local model 15, internal_epoch   1,  Average loss: 0.2621, Accuracy: 185/341 (54.2522%)
___Train Local_ResNet_18,  epoch 218, local model 15, internal_epoch   2,  Average loss: 0.0763, Accuracy: 154/341 (45.1613%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 218, local model 7, internal_epoch   1,  Average loss: 0.3830, Accuracy: 32/352 (9.0909%)
___Train Local_ResNet_18,  epoch 218, local model 7, internal_epoch   2,  Average loss: 0.0617, Accuracy: 47/352 (13.3523%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   1,  Average loss: 0.1783, Accuracy: 226/848 (26.6509%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   2,  Average loss: 0.0276, Accuracy: 352/848 (41.5094%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 218, local model 86, internal_epoch   1,  Average loss: 0.6434, Accuracy: 48/212 (22.6415%)
___Train Local_ResNet_18,  epoch 218, local model 86, internal_epoch   2,  Average loss: 0.1015, Accuracy: 39/212 (18.3962%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 218, local model 60, internal_epoch   1,  Average loss: 0.4795, Accuracy: 6/284 (2.1127%)
___Train Local_ResNet_18,  epoch 218, local model 60, internal_epoch   2,  Average loss: 0.0755, Accuracy: 33/284 (11.6197%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 197.17855763435364
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 245.38450694084167 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:219 choose agents : [17, 33, 77, 11, 81, 8, 28, 1, 93, 53]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   1,  Average loss: 0.1244, Accuracy: 18/526 (3.4221%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   2,  Average loss: 0.0683, Accuracy: 22/526 (4.1825%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   3,  Average loss: 0.0542, Accuracy: 52/526 (9.8859%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   4,  Average loss: 0.0458, Accuracy: 137/526 (26.0456%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   5,  Average loss: 0.0406, Accuracy: 135/526 (25.6654%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   6,  Average loss: 0.0369, Accuracy: 146/526 (27.7567%), train_poison_data_count: 45
Global model norm: 155.8942324742965.
Norm before scaling: 154.04008457622322. Distance: 11.582710377433255
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1137.986269688699, distance: 1158.2709635486854
Total norm for 4 adversaries is: 1137.986269688699. distance: 1158.2709635486854
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   1,  Average loss: 0.1014, Accuracy: 57/527 (10.8159%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   2,  Average loss: 0.0551, Accuracy: 82/527 (15.5598%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   3,  Average loss: 0.0486, Accuracy: 161/527 (30.5503%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   4,  Average loss: 0.0449, Accuracy: 160/527 (30.3605%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   5,  Average loss: 0.0414, Accuracy: 161/527 (30.5503%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   6,  Average loss: 0.0386, Accuracy: 159/527 (30.1708%), train_poison_data_count: 45
Global model norm: 155.8942324742965.
Norm before scaling: 154.04253800695767. Distance: 9.99549115575739
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 977.7626565276463, distance: 999.5490858382093
Total norm for 4 adversaries is: 977.7626565276463. distance: 999.5490858382093
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   1,  Average loss: 0.0955, Accuracy: 105/496 (21.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   2,  Average loss: 0.0519, Accuracy: 101/496 (20.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   3,  Average loss: 0.0473, Accuracy: 94/496 (18.9516%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   4,  Average loss: 0.0442, Accuracy: 94/496 (18.9516%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   5,  Average loss: 0.0408, Accuracy: 91/496 (18.3468%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   6,  Average loss: 0.0380, Accuracy: 97/496 (19.5565%), train_poison_data_count: 40
Global model norm: 155.8942324742965.
Norm before scaling: 154.26935909716485. Distance: 9.181495001570669
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 899.151961572681, distance: 918.1495657026692
Total norm for 4 adversaries is: 899.151961572681. distance: 918.1495657026692
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   1,  Average loss: 0.1030, Accuracy: 62/546 (11.3553%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   2,  Average loss: 0.0569, Accuracy: 86/546 (15.7509%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   3,  Average loss: 0.0501, Accuracy: 142/546 (26.0073%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   4,  Average loss: 0.0449, Accuracy: 141/546 (25.8242%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   5,  Average loss: 0.0408, Accuracy: 147/546 (26.9231%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   6,  Average loss: 0.0388, Accuracy: 140/546 (25.6410%), train_poison_data_count: 45
Global model norm: 155.8942324742965.
Norm before scaling: 154.03240071085693. Distance: 10.205074200059054
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 998.8098855638144, distance: 1020.5073799341188
Total norm for 4 adversaries is: 998.8098855638144. distance: 1020.5073799341188
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 219, local model 81, internal_epoch   1,  Average loss: 0.0446, Accuracy: 389/1034 (37.6209%)
___Train Local_ResNet_18,  epoch 219, local model 81, internal_epoch   2,  Average loss: 0.0258, Accuracy: 510/1034 (49.3230%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 219, local model 8, internal_epoch   1,  Average loss: 0.1013, Accuracy: 39/534 (7.3034%)
___Train Local_ResNet_18,  epoch 219, local model 8, internal_epoch   2,  Average loss: 0.0522, Accuracy: 92/534 (17.2285%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 219, local model 28, internal_epoch   1,  Average loss: 0.0892, Accuracy: 17/423 (4.0189%)
___Train Local_ResNet_18,  epoch 219, local model 28, internal_epoch   2,  Average loss: 0.0440, Accuracy: 82/423 (19.3853%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 219, local model 1, internal_epoch   1,  Average loss: 0.0839, Accuracy: 73/641 (11.3885%)
___Train Local_ResNet_18,  epoch 219, local model 1, internal_epoch   2,  Average loss: 0.0410, Accuracy: 225/641 (35.1014%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 219, local model 93, internal_epoch   1,  Average loss: 0.0897, Accuracy: 42/584 (7.1918%)
___Train Local_ResNet_18,  epoch 219, local model 93, internal_epoch   2,  Average loss: 0.0454, Accuracy: 150/584 (25.6849%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 219, local model 53, internal_epoch   1,  Average loss: 0.0932, Accuracy: 22/625 (3.5200%)
___Train Local_ResNet_18,  epoch 219, local model 53, internal_epoch   2,  Average loss: 0.0416, Accuracy: 188/625 (30.0800%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 198.37096238136292
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 243.97991609573364 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:220 choose agents : [17, 33, 77, 11, 12, 50, 10, 18, 39, 62]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   1,  Average loss: 0.0865, Accuracy: 148/526 (28.1369%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   2,  Average loss: 0.0696, Accuracy: 153/526 (29.0875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   3,  Average loss: 0.0565, Accuracy: 153/526 (29.0875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   4,  Average loss: 0.0534, Accuracy: 160/526 (30.4183%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   5,  Average loss: 0.0471, Accuracy: 175/526 (33.2700%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   6,  Average loss: 0.0450, Accuracy: 177/526 (33.6502%), train_poison_data_count: 45
Global model norm: 152.50846544126657.
Norm before scaling: 150.50981721510726. Distance: 6.690902272322727
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 637.1034796247781, distance: 669.0902171979501
Total norm for 4 adversaries is: 637.1034796247781. distance: 669.0902171979501
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   1,  Average loss: 0.1305, Accuracy: 76/527 (14.4213%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   2,  Average loss: 0.1128, Accuracy: 69/527 (13.0930%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   3,  Average loss: 0.0879, Accuracy: 44/527 (8.3491%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   4,  Average loss: 0.0736, Accuracy: 104/527 (19.7343%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   5,  Average loss: 0.0657, Accuracy: 158/527 (29.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   6,  Average loss: 0.0596, Accuracy: 154/527 (29.2220%), train_poison_data_count: 45
Global model norm: 152.50846544126657.
Norm before scaling: 150.3148258655812. Distance: 9.454292364000803
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 917.457696572436, distance: 945.4292345278942
Total norm for 4 adversaries is: 917.457696572436. distance: 945.4292345278942
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   1,  Average loss: 0.1600, Accuracy: 20/496 (4.0323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   2,  Average loss: 0.1396, Accuracy: 53/496 (10.6855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   3,  Average loss: 0.1210, Accuracy: 84/496 (16.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   4,  Average loss: 0.1005, Accuracy: 88/496 (17.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   5,  Average loss: 0.0830, Accuracy: 72/496 (14.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   6,  Average loss: 0.0686, Accuracy: 116/496 (23.3871%), train_poison_data_count: 40
Global model norm: 152.50846544126657.
Norm before scaling: 150.3891826229533. Distance: 10.3071175140169
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1005.3899430071896, distance: 1030.711768633695
Total norm for 4 adversaries is: 1005.3899430071896. distance: 1030.711768633695
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   1,  Average loss: 0.1217, Accuracy: 69/546 (12.6374%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   2,  Average loss: 0.1006, Accuracy: 63/546 (11.5385%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   3,  Average loss: 0.0793, Accuracy: 88/546 (16.1172%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   4,  Average loss: 0.0680, Accuracy: 88/546 (16.1172%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   5,  Average loss: 0.0612, Accuracy: 94/546 (17.2161%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   6,  Average loss: 0.0558, Accuracy: 146/546 (26.7399%), train_poison_data_count: 45
Global model norm: 152.50846544126657.
Norm before scaling: 150.343318046563. Distance: 8.89393637187785
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 860.6960119577643, distance: 889.3935785129102
Total norm for 4 adversaries is: 860.6960119577643. distance: 889.3935785129102
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 220, local model 12, internal_epoch   1,  Average loss: 0.0928, Accuracy: 71/977 (7.2671%)
___Train Local_ResNet_18,  epoch 220, local model 12, internal_epoch   2,  Average loss: 0.0443, Accuracy: 390/977 (39.9181%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 220, local model 50, internal_epoch   1,  Average loss: 0.1000, Accuracy: 149/401 (37.1571%)
___Train Local_ResNet_18,  epoch 220, local model 50, internal_epoch   2,  Average loss: 0.0796, Accuracy: 147/401 (36.6584%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 220, local model 10, internal_epoch   1,  Average loss: 0.1264, Accuracy: 97/752 (12.8989%)
___Train Local_ResNet_18,  epoch 220, local model 10, internal_epoch   2,  Average loss: 0.0888, Accuracy: 414/752 (55.0532%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   1,  Average loss: 0.1230, Accuracy: 0/386 (0.0000%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   2,  Average loss: 0.0885, Accuracy: 13/386 (3.3679%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 220, local model 39, internal_epoch   1,  Average loss: 0.1404, Accuracy: 0/217 (0.0000%)
___Train Local_ResNet_18,  epoch 220, local model 39, internal_epoch   2,  Average loss: 0.1171, Accuracy: 1/217 (0.4608%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 220, local model 62, internal_epoch   1,  Average loss: 0.1045, Accuracy: 34/358 (9.4972%)
___Train Local_ResNet_18,  epoch 220, local model 62, internal_epoch   2,  Average loss: 0.0848, Accuracy: 57/358 (15.9218%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 196.65847063064575
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 245.18023896217346 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:221 choose agents : [17, 33, 77, 11, 65, 87, 12, 74, 4, 7]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   1,  Average loss: 0.2714, Accuracy: 27/526 (5.1331%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   2,  Average loss: 0.1787, Accuracy: 53/526 (10.0760%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   3,  Average loss: 0.1421, Accuracy: 34/526 (6.4639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   4,  Average loss: 0.1154, Accuracy: 121/526 (23.0038%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   5,  Average loss: 0.0977, Accuracy: 142/526 (26.9962%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   6,  Average loss: 0.0801, Accuracy: 144/526 (27.3764%), train_poison_data_count: 45
Global model norm: 146.59941566007348.
Norm before scaling: 144.19636540799146. Distance: 16.84198339819738
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1661.2556997644883, distance: 1684.1983256137028
Total norm for 4 adversaries is: 1661.2556997644883. distance: 1684.1983256137028
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   1,  Average loss: 0.1732, Accuracy: 124/527 (23.5294%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   2,  Average loss: 0.1271, Accuracy: 152/527 (28.8425%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   3,  Average loss: 0.1096, Accuracy: 121/527 (22.9602%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   4,  Average loss: 0.0952, Accuracy: 111/527 (21.0626%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   5,  Average loss: 0.0851, Accuracy: 169/527 (32.0683%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   6,  Average loss: 0.0728, Accuracy: 90/527 (17.0778%), train_poison_data_count: 45
Global model norm: 146.59941566007348.
Norm before scaling: 144.2846240400376. Distance: 12.487930574525937
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1223.9472006585904, distance: 1248.7930172770825
Total norm for 4 adversaries is: 1223.9472006585904. distance: 1248.7930172770825
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   1,  Average loss: 0.1791, Accuracy: 78/496 (15.7258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   2,  Average loss: 0.1257, Accuracy: 69/496 (13.9113%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   3,  Average loss: 0.0876, Accuracy: 85/496 (17.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   4,  Average loss: 0.0696, Accuracy: 98/496 (19.7581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   5,  Average loss: 0.0585, Accuracy: 140/496 (28.2258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   6,  Average loss: 0.0525, Accuracy: 143/496 (28.8306%), train_poison_data_count: 40
Global model norm: 146.59941566007348.
Norm before scaling: 144.75422327604124. Distance: 12.302630656462703
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1210.843868960817, distance: 1230.263132423304
Total norm for 4 adversaries is: 1210.843868960817. distance: 1230.263132423304
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   1,  Average loss: 0.1927, Accuracy: 79/546 (14.4689%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   2,  Average loss: 0.1349, Accuracy: 57/546 (10.4396%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   3,  Average loss: 0.1107, Accuracy: 146/546 (26.7399%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   4,  Average loss: 0.0947, Accuracy: 143/546 (26.1905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   5,  Average loss: 0.0783, Accuracy: 136/546 (24.9084%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   6,  Average loss: 0.0683, Accuracy: 66/546 (12.0879%), train_poison_data_count: 45
Global model norm: 146.59941566007348.
Norm before scaling: 144.31421204051594. Distance: 14.287839742310702
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1405.7101852800242, distance: 1428.7839672252765
Total norm for 4 adversaries is: 1405.7101852800242. distance: 1428.7839672252765
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 221, local model 65, internal_epoch   1,  Average loss: 0.1063, Accuracy: 54/314 (17.1975%)
___Train Local_ResNet_18,  epoch 221, local model 65, internal_epoch   2,  Average loss: 0.0726, Accuracy: 96/314 (30.5732%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 221, local model 87, internal_epoch   1,  Average loss: 0.2987, Accuracy: 24/397 (6.0453%)
___Train Local_ResNet_18,  epoch 221, local model 87, internal_epoch   2,  Average loss: 0.1744, Accuracy: 43/397 (10.8312%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 221, local model 12, internal_epoch   1,  Average loss: 0.1036, Accuracy: 355/977 (36.3357%)
___Train Local_ResNet_18,  epoch 221, local model 12, internal_epoch   2,  Average loss: 0.0583, Accuracy: 351/977 (35.9263%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 221, local model 74, internal_epoch   1,  Average loss: 0.1492, Accuracy: 26/469 (5.5437%)
___Train Local_ResNet_18,  epoch 221, local model 74, internal_epoch   2,  Average loss: 0.0727, Accuracy: 161/469 (34.3284%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 221, local model 4, internal_epoch   1,  Average loss: 0.1111, Accuracy: 179/557 (32.1364%)
___Train Local_ResNet_18,  epoch 221, local model 4, internal_epoch   2,  Average loss: 0.0672, Accuracy: 200/557 (35.9066%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 221, local model 7, internal_epoch   1,  Average loss: 0.1866, Accuracy: 89/352 (25.2841%)
___Train Local_ResNet_18,  epoch 221, local model 7, internal_epoch   2,  Average loss: 0.1192, Accuracy: 118/352 (33.5227%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 194.12977576255798
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 244.02816081047058 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:222 choose agents : [17, 33, 77, 11, 35, 30, 72, 51, 63, 46]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   1,  Average loss: 0.0874, Accuracy: 34/526 (6.4639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   2,  Average loss: 0.0698, Accuracy: 117/526 (22.2433%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   3,  Average loss: 0.0593, Accuracy: 134/526 (25.4753%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   4,  Average loss: 0.0576, Accuracy: 132/526 (25.0951%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   5,  Average loss: 0.0540, Accuracy: 143/526 (27.1863%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   6,  Average loss: 0.0523, Accuracy: 141/526 (26.8061%), train_poison_data_count: 45
Global model norm: 144.67825294424867.
Norm before scaling: 142.7784833667174. Distance: 6.819555146595776
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 653.2489475689953, distance: 681.9555062465586
Total norm for 4 adversaries is: 653.2489475689953. distance: 681.9555062465586
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   1,  Average loss: 0.1656, Accuracy: 18/527 (3.4156%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   2,  Average loss: 0.1279, Accuracy: 22/527 (4.1746%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   3,  Average loss: 0.1153, Accuracy: 59/527 (11.1954%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   4,  Average loss: 0.1014, Accuracy: 64/527 (12.1442%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   5,  Average loss: 0.0893, Accuracy: 41/527 (7.7799%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   6,  Average loss: 0.0756, Accuracy: 71/527 (13.4725%), train_poison_data_count: 45
Global model norm: 144.67825294424867.
Norm before scaling: 142.4320424579736. Distance: 11.804110984433029
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1155.8015076127908, distance: 1180.4110512867965
Total norm for 4 adversaries is: 1155.8015076127908. distance: 1180.4110512867965
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   1,  Average loss: 0.0942, Accuracy: 27/496 (5.4435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   2,  Average loss: 0.0769, Accuracy: 26/496 (5.2419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   3,  Average loss: 0.0664, Accuracy: 90/496 (18.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   4,  Average loss: 0.0623, Accuracy: 104/496 (20.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   5,  Average loss: 0.0593, Accuracy: 98/496 (19.7581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   6,  Average loss: 0.0581, Accuracy: 95/496 (19.1532%), train_poison_data_count: 40
Global model norm: 144.67825294424867.
Norm before scaling: 142.9635279100932. Distance: 7.134923081601587
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 689.6300185606772, distance: 713.492291479032
Total norm for 4 adversaries is: 689.6300185606772. distance: 713.492291479032
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   1,  Average loss: 0.1214, Accuracy: 87/546 (15.9341%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   2,  Average loss: 0.1033, Accuracy: 84/546 (15.3846%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   3,  Average loss: 0.0897, Accuracy: 48/546 (8.7912%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   4,  Average loss: 0.0833, Accuracy: 61/546 (11.1722%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   5,  Average loss: 0.0751, Accuracy: 72/546 (13.1868%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   6,  Average loss: 0.0677, Accuracy: 71/546 (13.0037%), train_poison_data_count: 45
Global model norm: 144.67825294424867.
Norm before scaling: 142.5471139220293. Distance: 9.498662754104439
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 923.5493692813611, distance: 949.8662734827466
Total norm for 4 adversaries is: 923.5493692813611. distance: 949.8662734827466
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 222, local model 35, internal_epoch   1,  Average loss: 0.0848, Accuracy: 1/419 (0.2387%)
___Train Local_ResNet_18,  epoch 222, local model 35, internal_epoch   2,  Average loss: 0.0480, Accuracy: 47/419 (11.2172%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 222, local model 30, internal_epoch   1,  Average loss: 0.1557, Accuracy: 0/337 (0.0000%)
___Train Local_ResNet_18,  epoch 222, local model 30, internal_epoch   2,  Average loss: 0.1182, Accuracy: 7/337 (2.0772%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 222, local model 72, internal_epoch   1,  Average loss: 0.0683, Accuracy: 130/618 (21.0356%)
___Train Local_ResNet_18,  epoch 222, local model 72, internal_epoch   2,  Average loss: 0.0480, Accuracy: 313/618 (50.6472%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 222, local model 51, internal_epoch   1,  Average loss: 0.0437, Accuracy: 289/479 (60.3340%)
___Train Local_ResNet_18,  epoch 222, local model 51, internal_epoch   2,  Average loss: 0.0356, Accuracy: 289/479 (60.3340%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 222, local model 63, internal_epoch   1,  Average loss: 0.0520, Accuracy: 145/752 (19.2819%)
___Train Local_ResNet_18,  epoch 222, local model 63, internal_epoch   2,  Average loss: 0.0417, Accuracy: 149/752 (19.8138%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 222, local model 46, internal_epoch   1,  Average loss: 0.0744, Accuracy: 126/601 (20.9651%)
___Train Local_ResNet_18,  epoch 222, local model 46, internal_epoch   2,  Average loss: 0.0573, Accuracy: 112/601 (18.6356%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 194.51279711723328
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 222: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 242.1299867630005 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:223 choose agents : [17, 33, 77, 11, 54, 95, 26, 2, 82, 45]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   1,  Average loss: 0.1432, Accuracy: 147/526 (27.9468%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   2,  Average loss: 0.0898, Accuracy: 73/526 (13.8783%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   3,  Average loss: 0.0777, Accuracy: 55/526 (10.4563%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   4,  Average loss: 0.0682, Accuracy: 135/526 (25.6654%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   5,  Average loss: 0.0605, Accuracy: 140/526 (26.6160%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   6,  Average loss: 0.0544, Accuracy: 147/526 (27.9468%), train_poison_data_count: 45
Global model norm: 139.32225739719408.
Norm before scaling: 137.3177129756937. Distance: 10.833861665802734
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1061.1057911443138, distance: 1083.3861269187455
Total norm for 4 adversaries is: 1061.1057911443138. distance: 1083.3861269187455
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   1,  Average loss: 0.1288, Accuracy: 84/527 (15.9393%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   2,  Average loss: 0.0570, Accuracy: 166/527 (31.4991%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   3,  Average loss: 0.0542, Accuracy: 157/527 (29.7913%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   4,  Average loss: 0.0527, Accuracy: 161/527 (30.5503%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   5,  Average loss: 0.0481, Accuracy: 155/527 (29.4118%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   6,  Average loss: 0.0468, Accuracy: 160/527 (30.3605%), train_poison_data_count: 45
Global model norm: 139.32225739719408.
Norm before scaling: 137.57920304092113. Distance: 11.643503209609532
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1145.9929646380906, distance: 1164.3503553484234
Total norm for 4 adversaries is: 1145.9929646380906. distance: 1164.3503553484234
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   1,  Average loss: 0.1445, Accuracy: 17/496 (3.4274%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   2,  Average loss: 0.0816, Accuracy: 65/496 (13.1048%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   3,  Average loss: 0.0747, Accuracy: 72/496 (14.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   4,  Average loss: 0.0673, Accuracy: 96/496 (19.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   5,  Average loss: 0.0608, Accuracy: 95/496 (19.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   6,  Average loss: 0.0562, Accuracy: 108/496 (21.7742%), train_poison_data_count: 40
Global model norm: 139.32225739719408.
Norm before scaling: 137.59739448387094. Distance: 11.016373672475057
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1083.1042193621074, distance: 1101.6373609314455
Total norm for 4 adversaries is: 1083.1042193621074. distance: 1101.6373609314455
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   1,  Average loss: 0.1591, Accuracy: 64/546 (11.7216%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   2,  Average loss: 0.0934, Accuracy: 68/546 (12.4542%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   3,  Average loss: 0.0890, Accuracy: 143/546 (26.1905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   4,  Average loss: 0.0798, Accuracy: 144/546 (26.3736%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   5,  Average loss: 0.0745, Accuracy: 146/546 (26.7399%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   6,  Average loss: 0.0686, Accuracy: 142/546 (26.0073%), train_poison_data_count: 45
Global model norm: 139.32225739719408.
Norm before scaling: 137.2373699220624. Distance: 11.94936879298573
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1172.7517320387976, distance: 1194.9368184134255
Total norm for 4 adversaries is: 1172.7517320387976. distance: 1194.9368184134255
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 223, local model 54, internal_epoch   1,  Average loss: 0.1753, Accuracy: 6/440 (1.3636%)
___Train Local_ResNet_18,  epoch 223, local model 54, internal_epoch   2,  Average loss: 0.1026, Accuracy: 77/440 (17.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 223, local model 95, internal_epoch   1,  Average loss: 0.1143, Accuracy: 88/569 (15.4657%)
___Train Local_ResNet_18,  epoch 223, local model 95, internal_epoch   2,  Average loss: 0.0632, Accuracy: 61/569 (10.7206%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 223, local model 26, internal_epoch   1,  Average loss: 0.1026, Accuracy: 75/468 (16.0256%)
___Train Local_ResNet_18,  epoch 223, local model 26, internal_epoch   2,  Average loss: 0.0578, Accuracy: 40/468 (8.5470%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 223, local model 2, internal_epoch   1,  Average loss: 0.1214, Accuracy: 34/461 (7.3753%)
___Train Local_ResNet_18,  epoch 223, local model 2, internal_epoch   2,  Average loss: 0.0657, Accuracy: 99/461 (21.4751%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 223, local model 82, internal_epoch   1,  Average loss: 0.1094, Accuracy: 159/601 (26.4559%)
___Train Local_ResNet_18,  epoch 223, local model 82, internal_epoch   2,  Average loss: 0.0754, Accuracy: 84/601 (13.9767%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 223, local model 45, internal_epoch   1,  Average loss: 0.1339, Accuracy: 1/529 (0.1890%)
___Train Local_ResNet_18,  epoch 223, local model 45, internal_epoch   2,  Average loss: 0.0710, Accuracy: 85/529 (16.0681%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 195.3904950618744
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 223: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 246.5722405910492 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:224 choose agents : [17, 33, 77, 11, 0, 34, 62, 66, 95, 10]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   1,  Average loss: 0.1832, Accuracy: 45/526 (8.5551%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   2,  Average loss: 0.1120, Accuracy: 93/526 (17.6806%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   3,  Average loss: 0.1004, Accuracy: 138/526 (26.2357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   4,  Average loss: 0.0866, Accuracy: 137/526 (26.0456%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   5,  Average loss: 0.0704, Accuracy: 144/526 (27.3764%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   6,  Average loss: 0.0598, Accuracy: 140/526 (26.6160%), train_poison_data_count: 45
Global model norm: 136.83568213828585.
Norm before scaling: 134.75192049883742. Distance: 13.88584792012852
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1367.8514173695914, distance: 1388.5848011554785
Total norm for 4 adversaries is: 1367.8514173695914. distance: 1388.5848011554785
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   1,  Average loss: 0.2012, Accuracy: 45/527 (8.5389%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   2,  Average loss: 0.1216, Accuracy: 48/527 (9.1082%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   3,  Average loss: 0.1000, Accuracy: 60/527 (11.3852%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   4,  Average loss: 0.0786, Accuracy: 59/527 (11.1954%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   5,  Average loss: 0.0604, Accuracy: 62/527 (11.7647%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   6,  Average loss: 0.0493, Accuracy: 91/527 (17.2676%), train_poison_data_count: 45
Global model norm: 136.83568213828585.
Norm before scaling: 134.82029416504773. Distance: 15.24486517836877
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1504.92300467499, distance: 1524.4864709140584
Total norm for 4 adversaries is: 1504.92300467499. distance: 1524.4864709140584
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   1,  Average loss: 0.1422, Accuracy: 93/496 (18.7500%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   2,  Average loss: 0.0856, Accuracy: 102/496 (20.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   3,  Average loss: 0.0740, Accuracy: 101/496 (20.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   4,  Average loss: 0.0634, Accuracy: 107/496 (21.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   5,  Average loss: 0.0534, Accuracy: 102/496 (20.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   6,  Average loss: 0.0472, Accuracy: 149/496 (30.0403%), train_poison_data_count: 40
Global model norm: 136.83568213828585.
Norm before scaling: 135.15271310401062. Distance: 11.579191130486107
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1140.3148687972107, distance: 1157.919092596715
Total norm for 4 adversaries is: 1140.3148687972107. distance: 1157.919092596715
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   1,  Average loss: 0.1821, Accuracy: 47/546 (8.6081%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   2,  Average loss: 0.1082, Accuracy: 57/546 (10.4396%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   3,  Average loss: 0.0883, Accuracy: 51/546 (9.3407%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   4,  Average loss: 0.0696, Accuracy: 49/546 (8.9744%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   5,  Average loss: 0.0580, Accuracy: 130/546 (23.8095%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   6,  Average loss: 0.0514, Accuracy: 146/546 (26.7399%), train_poison_data_count: 45
Global model norm: 136.83568213828585.
Norm before scaling: 134.86019236370308. Distance: 14.275928131769138
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1408.0808304213222, distance: 1427.5928165972257
Total norm for 4 adversaries is: 1408.0808304213222. distance: 1427.5928165972257
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 224, local model 0, internal_epoch   1,  Average loss: 0.1452, Accuracy: 84/367 (22.8883%)
___Train Local_ResNet_18,  epoch 224, local model 0, internal_epoch   2,  Average loss: 0.0849, Accuracy: 66/367 (17.9837%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 224, local model 34, internal_epoch   1,  Average loss: 0.1885, Accuracy: 43/349 (12.3209%)
___Train Local_ResNet_18,  epoch 224, local model 34, internal_epoch   2,  Average loss: 0.0979, Accuracy: 59/349 (16.9054%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 224, local model 62, internal_epoch   1,  Average loss: 0.1593, Accuracy: 63/358 (17.5978%)
___Train Local_ResNet_18,  epoch 224, local model 62, internal_epoch   2,  Average loss: 0.0978, Accuracy: 63/358 (17.5978%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 224, local model 66, internal_epoch   1,  Average loss: 0.2044, Accuracy: 8/555 (1.4414%)
___Train Local_ResNet_18,  epoch 224, local model 66, internal_epoch   2,  Average loss: 0.1115, Accuracy: 28/555 (5.0450%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 224, local model 95, internal_epoch   1,  Average loss: 0.0940, Accuracy: 209/569 (36.7311%)
___Train Local_ResNet_18,  epoch 224, local model 95, internal_epoch   2,  Average loss: 0.0629, Accuracy: 301/569 (52.8998%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 224, local model 10, internal_epoch   1,  Average loss: 0.1208, Accuracy: 108/752 (14.3617%)
___Train Local_ResNet_18,  epoch 224, local model 10, internal_epoch   2,  Average loss: 0.0353, Accuracy: 343/752 (45.6117%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 203.36494612693787
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 224: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 250.7935094833374 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:225 choose agents : [17, 33, 77, 11, 12, 38, 41, 4, 68, 55]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   1,  Average loss: 0.2148, Accuracy: 61/526 (11.5970%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   2,  Average loss: 0.1420, Accuracy: 53/526 (10.0760%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   3,  Average loss: 0.1218, Accuracy: 90/526 (17.1103%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   4,  Average loss: 0.1069, Accuracy: 142/526 (26.9962%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   5,  Average loss: 0.0960, Accuracy: 145/526 (27.5665%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   6,  Average loss: 0.0879, Accuracy: 144/526 (27.3764%), train_poison_data_count: 45
Global model norm: 136.54817573616646.
Norm before scaling: 134.1767214464752. Distance: 13.571075962620029
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1333.329666661625, distance: 1357.1075860078302
Total norm for 4 adversaries is: 1333.329666661625. distance: 1357.1075860078302
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   1,  Average loss: 0.1633, Accuracy: 160/527 (30.3605%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   2,  Average loss: 0.1100, Accuracy: 157/527 (29.7913%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   3,  Average loss: 0.0974, Accuracy: 124/527 (23.5294%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   4,  Average loss: 0.0956, Accuracy: 133/527 (25.2372%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   5,  Average loss: 0.0846, Accuracy: 167/527 (31.6888%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   6,  Average loss: 0.0774, Accuracy: 165/527 (31.3093%), train_poison_data_count: 45
Global model norm: 136.54817573616646.
Norm before scaling: 134.3039419679296. Distance: 10.770797483481703
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1051.8363703542486, distance: 1077.0797324246705
Total norm for 4 adversaries is: 1051.8363703542486. distance: 1077.0797324246705
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   1,  Average loss: 0.2370, Accuracy: 102/496 (20.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   2,  Average loss: 0.1643, Accuracy: 98/496 (19.7581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   3,  Average loss: 0.1450, Accuracy: 57/496 (11.4919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   4,  Average loss: 0.1344, Accuracy: 62/496 (12.5000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   5,  Average loss: 0.1237, Accuracy: 96/496 (19.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   6,  Average loss: 0.1143, Accuracy: 91/496 (18.3468%), train_poison_data_count: 40
Global model norm: 136.54817573616646.
Norm before scaling: 134.2651367746855. Distance: 13.605289305807744
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1337.664569314744, distance: 1360.5290331338026
Total norm for 4 adversaries is: 1337.664569314744. distance: 1360.5290331338026
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   1,  Average loss: 0.1853, Accuracy: 77/546 (14.1026%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   2,  Average loss: 0.1157, Accuracy: 98/546 (17.9487%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   3,  Average loss: 0.1062, Accuracy: 146/546 (26.7399%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   4,  Average loss: 0.0974, Accuracy: 145/546 (26.5568%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   5,  Average loss: 0.0926, Accuracy: 145/546 (26.5568%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   6,  Average loss: 0.0875, Accuracy: 127/546 (23.2601%), train_poison_data_count: 45
Global model norm: 136.54817573616646.
Norm before scaling: 134.23280266946676. Distance: 11.940586509932077
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1169.38798095414, distance: 1194.058729711399
Total norm for 4 adversaries is: 1169.38798095414. distance: 1194.058729711399
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 225, local model 12, internal_epoch   1,  Average loss: 0.1238, Accuracy: 426/977 (43.6029%)
___Train Local_ResNet_18,  epoch 225, local model 12, internal_epoch   2,  Average loss: 0.0816, Accuracy: 438/977 (44.8311%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 225, local model 38, internal_epoch   1,  Average loss: 0.0934, Accuracy: 122/756 (16.1376%)
___Train Local_ResNet_18,  epoch 225, local model 38, internal_epoch   2,  Average loss: 0.0519, Accuracy: 289/756 (38.2275%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 225, local model 41, internal_epoch   1,  Average loss: 0.1172, Accuracy: 319/513 (62.1832%)
___Train Local_ResNet_18,  epoch 225, local model 41, internal_epoch   2,  Average loss: 0.0799, Accuracy: 317/513 (61.7934%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 225, local model 4, internal_epoch   1,  Average loss: 0.1703, Accuracy: 68/557 (12.2083%)
___Train Local_ResNet_18,  epoch 225, local model 4, internal_epoch   2,  Average loss: 0.1045, Accuracy: 216/557 (38.7792%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 225, local model 68, internal_epoch   1,  Average loss: 0.2057, Accuracy: 81/416 (19.4712%)
___Train Local_ResNet_18,  epoch 225, local model 68, internal_epoch   2,  Average loss: 0.1240, Accuracy: 74/416 (17.7885%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 225, local model 55, internal_epoch   1,  Average loss: 0.1214, Accuracy: 31/299 (10.3679%)
___Train Local_ResNet_18,  epoch 225, local model 55, internal_epoch   2,  Average loss: 0.0554, Accuracy: 129/299 (43.1438%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 196.6472282409668
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 225: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 244.685893535614 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:226 choose agents : [17, 33, 77, 11, 30, 39, 10, 64, 23, 60]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   1,  Average loss: 0.0802, Accuracy: 46/526 (8.7452%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   2,  Average loss: 0.0705, Accuracy: 92/526 (17.4905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   3,  Average loss: 0.0630, Accuracy: 160/526 (30.4183%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   4,  Average loss: 0.0577, Accuracy: 155/526 (29.4677%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   5,  Average loss: 0.0600, Accuracy: 160/526 (30.4183%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   6,  Average loss: 0.0533, Accuracy: 174/526 (33.0798%), train_poison_data_count: 45
Global model norm: 133.47505326370916.
Norm before scaling: 131.70013584370366. Distance: 6.877285109407215
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 662.5633224454853, distance: 687.7285074795141
Total norm for 4 adversaries is: 662.5633224454853. distance: 687.7285074795141
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   1,  Average loss: 0.1544, Accuracy: 2/527 (0.3795%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   2,  Average loss: 0.1366, Accuracy: 18/527 (3.4156%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   3,  Average loss: 0.1187, Accuracy: 65/527 (12.3340%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   4,  Average loss: 0.1009, Accuracy: 84/527 (15.9393%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   5,  Average loss: 0.0799, Accuracy: 73/527 (13.8520%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   6,  Average loss: 0.0463, Accuracy: 116/527 (22.0114%), train_poison_data_count: 45
Global model norm: 133.47505326370916.
Norm before scaling: 131.42191865562228. Distance: 11.993230817807966
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1177.8882587070814, distance: 1199.3230382178106
Total norm for 4 adversaries is: 1177.8882587070814. distance: 1199.3230382178106
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   1,  Average loss: 0.0970, Accuracy: 27/496 (5.4435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   2,  Average loss: 0.0872, Accuracy: 50/496 (10.0806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   3,  Average loss: 0.0773, Accuracy: 93/496 (18.7500%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   4,  Average loss: 0.0710, Accuracy: 90/496 (18.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   5,  Average loss: 0.0628, Accuracy: 81/496 (16.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   6,  Average loss: 0.0566, Accuracy: 119/496 (23.9919%), train_poison_data_count: 40
Global model norm: 133.47505326370916.
Norm before scaling: 131.81691552585352. Distance: 7.5347188345046465
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 732.0310358857745, distance: 753.4718806962871
Total norm for 4 adversaries is: 732.0310358857745. distance: 753.4718806962871
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   1,  Average loss: 0.1083, Accuracy: 30/546 (5.4945%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   2,  Average loss: 0.0974, Accuracy: 83/546 (15.2015%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   3,  Average loss: 0.0844, Accuracy: 87/546 (15.9341%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   4,  Average loss: 0.0732, Accuracy: 95/546 (17.3993%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   5,  Average loss: 0.0645, Accuracy: 88/546 (16.1172%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   6,  Average loss: 0.0511, Accuracy: 120/546 (21.9780%), train_poison_data_count: 45
Global model norm: 133.47505326370916.
Norm before scaling: 131.554111965381. Distance: 9.260074799402396
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 903.227649875711, distance: 926.0075256173677
Total norm for 4 adversaries is: 903.227649875711. distance: 926.0075256173677
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 226, local model 30, internal_epoch   1,  Average loss: 0.1269, Accuracy: 42/337 (12.4629%)
___Train Local_ResNet_18,  epoch 226, local model 30, internal_epoch   2,  Average loss: 0.1063, Accuracy: 45/337 (13.3531%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 226, local model 39, internal_epoch   1,  Average loss: 0.1443, Accuracy: 6/217 (2.7650%)
___Train Local_ResNet_18,  epoch 226, local model 39, internal_epoch   2,  Average loss: 0.1168, Accuracy: 10/217 (4.6083%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 226, local model 10, internal_epoch   1,  Average loss: 0.0329, Accuracy: 346/752 (46.0106%)
___Train Local_ResNet_18,  epoch 226, local model 10, internal_epoch   2,  Average loss: 0.0248, Accuracy: 411/752 (54.6543%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 226, local model 64, internal_epoch   1,  Average loss: 0.0522, Accuracy: 123/686 (17.9300%)
___Train Local_ResNet_18,  epoch 226, local model 64, internal_epoch   2,  Average loss: 0.0400, Accuracy: 245/686 (35.7143%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 226, local model 23, internal_epoch   1,  Average loss: 0.1366, Accuracy: 6/248 (2.4194%)
___Train Local_ResNet_18,  epoch 226, local model 23, internal_epoch   2,  Average loss: 0.1198, Accuracy: 14/248 (5.6452%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 226, local model 60, internal_epoch   1,  Average loss: 0.0956, Accuracy: 23/284 (8.0986%)
___Train Local_ResNet_18,  epoch 226, local model 60, internal_epoch   2,  Average loss: 0.0823, Accuracy: 28/284 (9.8592%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 197.93172907829285
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 226: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 243.90483570098877 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:227 choose agents : [17, 33, 77, 11, 23, 34, 52, 92, 57, 74]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   1,  Average loss: 0.3150, Accuracy: 44/526 (8.3650%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   2,  Average loss: 0.0926, Accuracy: 67/526 (12.7376%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   3,  Average loss: 0.0713, Accuracy: 122/526 (23.1939%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   4,  Average loss: 0.0584, Accuracy: 141/526 (26.8061%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   5,  Average loss: 0.0536, Accuracy: 126/526 (23.9544%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   6,  Average loss: 0.0480, Accuracy: 118/526 (22.4335%), train_poison_data_count: 45
Global model norm: 128.7761502569478.
Norm before scaling: 127.2810198254732. Distance: 20.072098286892476
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1991.708311977434, distance: 2007.2098794097244
Total norm for 4 adversaries is: 1991.708311977434. distance: 2007.2098794097244
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   1,  Average loss: 0.2056, Accuracy: 95/527 (18.0266%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   2,  Average loss: 0.0623, Accuracy: 75/527 (14.2315%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   3,  Average loss: 0.0534, Accuracy: 98/527 (18.5958%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   4,  Average loss: 0.0451, Accuracy: 105/527 (19.9241%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   5,  Average loss: 0.0430, Accuracy: 164/527 (31.1195%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   6,  Average loss: 0.0397, Accuracy: 163/527 (30.9298%), train_poison_data_count: 45
Global model norm: 128.7761502569478.
Norm before scaling: 127.06510926366647. Distance: 13.6935074395165
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1352.4711179910646, distance: 1369.350804213442
Total norm for 4 adversaries is: 1352.4711179910646. distance: 1369.350804213442
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   1,  Average loss: 0.2887, Accuracy: 65/496 (13.1048%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   2,  Average loss: 0.0882, Accuracy: 100/496 (20.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   3,  Average loss: 0.0747, Accuracy: 85/496 (17.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   4,  Average loss: 0.0642, Accuracy: 127/496 (25.6048%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   5,  Average loss: 0.0569, Accuracy: 129/496 (26.0081%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   6,  Average loss: 0.0496, Accuracy: 141/496 (28.4274%), train_poison_data_count: 40
Global model norm: 128.7761502569478.
Norm before scaling: 127.233433812373. Distance: 18.065083144118276
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1791.06846602803, distance: 1806.5084417184437
Total norm for 4 adversaries is: 1791.06846602803. distance: 1806.5084417184437
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   1,  Average loss: 0.2498, Accuracy: 75/546 (13.7363%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   2,  Average loss: 0.0756, Accuracy: 75/546 (13.7363%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   3,  Average loss: 0.0666, Accuracy: 96/546 (17.5824%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   4,  Average loss: 0.0569, Accuracy: 101/546 (18.4982%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   5,  Average loss: 0.0494, Accuracy: 143/546 (26.1905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   6,  Average loss: 0.0428, Accuracy: 77/546 (14.1026%), train_poison_data_count: 45
Global model norm: 128.7761502569478.
Norm before scaling: 127.04126651776383. Distance: 16.487018449184497
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1631.9429371151432, distance: 1648.701761993357
Total norm for 4 adversaries is: 1631.9429371151432. distance: 1648.701761993357
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 227, local model 23, internal_epoch   1,  Average loss: 0.2719, Accuracy: 60/248 (24.1935%)
___Train Local_ResNet_18,  epoch 227, local model 23, internal_epoch   2,  Average loss: 0.0737, Accuracy: 43/248 (17.3387%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 227, local model 34, internal_epoch   1,  Average loss: 0.2297, Accuracy: 122/349 (34.9570%)
___Train Local_ResNet_18,  epoch 227, local model 34, internal_epoch   2,  Average loss: 0.0630, Accuracy: 77/349 (22.0630%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 227, local model 52, internal_epoch   1,  Average loss: 0.4629, Accuracy: 3/214 (1.4019%)
___Train Local_ResNet_18,  epoch 227, local model 52, internal_epoch   2,  Average loss: 0.0962, Accuracy: 68/214 (31.7757%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 227, local model 92, internal_epoch   1,  Average loss: 0.2165, Accuracy: 40/796 (5.0251%)
___Train Local_ResNet_18,  epoch 227, local model 92, internal_epoch   2,  Average loss: 0.0471, Accuracy: 176/796 (22.1106%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 227, local model 57, internal_epoch   1,  Average loss: 0.2980, Accuracy: 53/290 (18.2759%)
___Train Local_ResNet_18,  epoch 227, local model 57, internal_epoch   2,  Average loss: 0.0714, Accuracy: 108/290 (37.2414%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 227, local model 74, internal_epoch   1,  Average loss: 0.2294, Accuracy: 89/469 (18.9765%)
___Train Local_ResNet_18,  epoch 227, local model 74, internal_epoch   2,  Average loss: 0.0660, Accuracy: 103/469 (21.9616%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 195.86618876457214
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 227: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 244.73412156105042 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:228 choose agents : [17, 33, 77, 11, 67, 16, 64, 30, 35, 81]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   1,  Average loss: 0.0724, Accuracy: 143/526 (27.1863%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   2,  Average loss: 0.0550, Accuracy: 138/526 (26.2357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   3,  Average loss: 0.0480, Accuracy: 146/526 (27.7567%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   4,  Average loss: 0.0438, Accuracy: 161/526 (30.6084%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   5,  Average loss: 0.0398, Accuracy: 165/526 (31.3688%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   6,  Average loss: 0.0370, Accuracy: 163/526 (30.9886%), train_poison_data_count: 45
Global model norm: 134.23788062149222.
Norm before scaling: 132.52431233315266. Distance: 6.385516001523517
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 613.1712138546623, distance: 638.5516081335948
Total norm for 4 adversaries is: 613.1712138546623. distance: 638.5516081335948
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   1,  Average loss: 0.0934, Accuracy: 31/527 (5.8824%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   2,  Average loss: 0.0742, Accuracy: 155/527 (29.4118%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   3,  Average loss: 0.0635, Accuracy: 170/527 (32.2581%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   4,  Average loss: 0.0530, Accuracy: 164/527 (31.1195%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   5,  Average loss: 0.0453, Accuracy: 166/527 (31.4991%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   6,  Average loss: 0.0376, Accuracy: 172/527 (32.6376%), train_poison_data_count: 45
Global model norm: 134.23788062149222.
Norm before scaling: 132.4489951948485. Distance: 8.998952168820477
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 878.6501010072212, distance: 899.8952716844333
Total norm for 4 adversaries is: 878.6501010072212. distance: 899.8952716844333
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   1,  Average loss: 0.0932, Accuracy: 84/496 (16.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   2,  Average loss: 0.0788, Accuracy: 89/496 (17.9435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   3,  Average loss: 0.0666, Accuracy: 121/496 (24.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   4,  Average loss: 0.0560, Accuracy: 121/496 (24.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   5,  Average loss: 0.0446, Accuracy: 101/496 (20.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   6,  Average loss: 0.0356, Accuracy: 123/496 (24.7984%), train_poison_data_count: 40
Global model norm: 134.23788062149222.
Norm before scaling: 132.64258248202196. Distance: 8.430857212200877
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 824.0934413038366, distance: 843.0857014562636
Total norm for 4 adversaries is: 824.0934413038366. distance: 843.0857014562636
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   1,  Average loss: 0.1047, Accuracy: 46/546 (8.4249%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   2,  Average loss: 0.0802, Accuracy: 77/546 (14.1026%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   3,  Average loss: 0.0643, Accuracy: 93/546 (17.0330%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   4,  Average loss: 0.0514, Accuracy: 85/546 (15.5678%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   5,  Average loss: 0.0418, Accuracy: 113/546 (20.6960%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   6,  Average loss: 0.0376, Accuracy: 155/546 (28.3883%), train_poison_data_count: 45
Global model norm: 134.23788062149222.
Norm before scaling: 132.4417545918771. Distance: 9.436248898472622
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 922.845903983975, distance: 943.6249254868166
Total norm for 4 adversaries is: 922.845903983975. distance: 943.6249254868166
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 228, local model 67, internal_epoch   1,  Average loss: 0.0956, Accuracy: 36/842 (4.2755%)
___Train Local_ResNet_18,  epoch 228, local model 67, internal_epoch   2,  Average loss: 0.0483, Accuracy: 267/842 (31.7102%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 228, local model 16, internal_epoch   1,  Average loss: 0.0964, Accuracy: 97/773 (12.5485%)
___Train Local_ResNet_18,  epoch 228, local model 16, internal_epoch   2,  Average loss: 0.0542, Accuracy: 207/773 (26.7788%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 228, local model 64, internal_epoch   1,  Average loss: 0.0761, Accuracy: 179/686 (26.0933%)
___Train Local_ResNet_18,  epoch 228, local model 64, internal_epoch   2,  Average loss: 0.0532, Accuracy: 203/686 (29.5918%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 228, local model 30, internal_epoch   1,  Average loss: 0.1255, Accuracy: 24/337 (7.1217%)
___Train Local_ResNet_18,  epoch 228, local model 30, internal_epoch   2,  Average loss: 0.0928, Accuracy: 38/337 (11.2760%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 228, local model 35, internal_epoch   1,  Average loss: 0.0839, Accuracy: 69/419 (16.4678%)
___Train Local_ResNet_18,  epoch 228, local model 35, internal_epoch   2,  Average loss: 0.0588, Accuracy: 133/419 (31.7422%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 228, local model 81, internal_epoch   1,  Average loss: 0.0459, Accuracy: 423/1034 (40.9091%)
___Train Local_ResNet_18,  epoch 228, local model 81, internal_epoch   2,  Average loss: 0.0344, Accuracy: 545/1034 (52.7079%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 199.33675456047058
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 228: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 245.96419668197632 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:229 choose agents : [17, 33, 77, 11, 62, 68, 2, 74, 39, 1]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   1,  Average loss: 0.2664, Accuracy: 30/526 (5.7034%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   2,  Average loss: 0.1296, Accuracy: 51/526 (9.6958%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   3,  Average loss: 0.1034, Accuracy: 50/526 (9.5057%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   4,  Average loss: 0.0897, Accuracy: 147/526 (27.9468%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   5,  Average loss: 0.0780, Accuracy: 169/526 (32.1293%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   6,  Average loss: 0.0674, Accuracy: 179/526 (34.0304%), train_poison_data_count: 45
Global model norm: 129.9083511076174.
Norm before scaling: 127.73815074694795. Distance: 16.18073994645621
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1597.7933220538882, distance: 1618.0740094322014
Total norm for 4 adversaries is: 1597.7933220538882. distance: 1618.0740094322014
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   1,  Average loss: 0.2097, Accuracy: 80/527 (15.1803%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   2,  Average loss: 0.1040, Accuracy: 99/527 (18.7856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   3,  Average loss: 0.0843, Accuracy: 98/527 (18.5958%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   4,  Average loss: 0.0603, Accuracy: 99/527 (18.7856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   5,  Average loss: 0.0461, Accuracy: 107/527 (20.3036%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   6,  Average loss: 0.0389, Accuracy: 117/527 (22.2011%), train_poison_data_count: 45
Global model norm: 129.9083511076174.
Norm before scaling: 127.9423393075959. Distance: 13.373261240659943
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1317.85398470392, distance: 1337.3261569265742
Total norm for 4 adversaries is: 1317.85398470392. distance: 1337.3261569265742
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   1,  Average loss: 0.1985, Accuracy: 85/496 (17.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   2,  Average loss: 0.1097, Accuracy: 54/496 (10.8871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   3,  Average loss: 0.0824, Accuracy: 68/496 (13.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   4,  Average loss: 0.0693, Accuracy: 118/496 (23.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   5,  Average loss: 0.0620, Accuracy: 156/496 (31.4516%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   6,  Average loss: 0.0577, Accuracy: 152/496 (30.6452%), train_poison_data_count: 40
Global model norm: 129.9083511076174.
Norm before scaling: 128.0784366608993. Distance: 12.87099357415493
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1268.7494334974106, distance: 1287.0993551392992
Total norm for 4 adversaries is: 1268.7494334974106. distance: 1287.0993551392992
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   1,  Average loss: 0.1782, Accuracy: 88/546 (16.1172%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   2,  Average loss: 0.0934, Accuracy: 156/546 (28.5714%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   3,  Average loss: 0.0710, Accuracy: 147/546 (26.9231%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   4,  Average loss: 0.0660, Accuracy: 163/546 (29.8535%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   5,  Average loss: 0.0597, Accuracy: 159/546 (29.1209%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   6,  Average loss: 0.0577, Accuracy: 164/546 (30.0366%), train_poison_data_count: 45
Global model norm: 129.9083511076174.
Norm before scaling: 127.85898069870767. Distance: 12.690103498657551
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1248.3322374272002, distance: 1269.0103427474498
Total norm for 4 adversaries is: 1248.3322374272002. distance: 1269.0103427474498
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 229, local model 62, internal_epoch   1,  Average loss: 0.1827, Accuracy: 49/358 (13.6872%)
___Train Local_ResNet_18,  epoch 229, local model 62, internal_epoch   2,  Average loss: 0.0800, Accuracy: 58/358 (16.2011%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 229, local model 68, internal_epoch   1,  Average loss: 0.1942, Accuracy: 61/416 (14.6635%)
___Train Local_ResNet_18,  epoch 229, local model 68, internal_epoch   2,  Average loss: 0.0983, Accuracy: 85/416 (20.4327%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 229, local model 2, internal_epoch   1,  Average loss: 0.1393, Accuracy: 236/461 (51.1931%)
___Train Local_ResNet_18,  epoch 229, local model 2, internal_epoch   2,  Average loss: 0.0697, Accuracy: 232/461 (50.3254%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 229, local model 74, internal_epoch   1,  Average loss: 0.1459, Accuracy: 78/469 (16.6311%)
___Train Local_ResNet_18,  epoch 229, local model 74, internal_epoch   2,  Average loss: 0.0668, Accuracy: 89/469 (18.9765%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 229, local model 39, internal_epoch   1,  Average loss: 0.3172, Accuracy: 16/217 (7.3733%)
___Train Local_ResNet_18,  epoch 229, local model 39, internal_epoch   2,  Average loss: 0.1614, Accuracy: 24/217 (11.0599%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 229, local model 1, internal_epoch   1,  Average loss: 0.1622, Accuracy: 113/641 (17.6287%)
___Train Local_ResNet_18,  epoch 229, local model 1, internal_epoch   2,  Average loss: 0.0610, Accuracy: 220/641 (34.3214%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 197.47887229919434
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 229: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 246.148339509964 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:230 choose agents : [17, 33, 77, 11, 64, 29, 21, 39, 95, 90]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   1,  Average loss: 0.1203, Accuracy: 57/526 (10.8365%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   2,  Average loss: 0.0760, Accuracy: 139/526 (26.4259%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   3,  Average loss: 0.0564, Accuracy: 145/526 (27.5665%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   4,  Average loss: 0.0457, Accuracy: 183/526 (34.7909%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   5,  Average loss: 0.0403, Accuracy: 208/526 (39.5437%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   6,  Average loss: 0.0361, Accuracy: 177/526 (33.6502%), train_poison_data_count: 45
Global model norm: 129.1800690291463.
Norm before scaling: 127.39974229148778. Distance: 9.418207723274636
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 921.5009495383063, distance: 941.8208096554248
Total norm for 4 adversaries is: 921.5009495383063. distance: 941.8208096554248
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   1,  Average loss: 0.1433, Accuracy: 138/527 (26.1860%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   2,  Average loss: 0.0885, Accuracy: 153/527 (29.0323%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   3,  Average loss: 0.0737, Accuracy: 118/527 (22.3909%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   4,  Average loss: 0.0552, Accuracy: 105/527 (19.9241%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   5,  Average loss: 0.0405, Accuracy: 125/527 (23.7192%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   6,  Average loss: 0.0353, Accuracy: 151/527 (28.6528%), train_poison_data_count: 45
Global model norm: 129.1800690291463.
Norm before scaling: 127.32138607304941. Distance: 10.870005195005803
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1067.1299124286602, distance: 1087.0005174791777
Total norm for 4 adversaries is: 1067.1299124286602. distance: 1087.0005174791777
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   1,  Average loss: 0.1477, Accuracy: 122/496 (24.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   2,  Average loss: 0.1025, Accuracy: 51/496 (10.2823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   3,  Average loss: 0.0785, Accuracy: 36/496 (7.2581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   4,  Average loss: 0.0605, Accuracy: 61/496 (12.2984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   5,  Average loss: 0.0504, Accuracy: 101/496 (20.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   6,  Average loss: 0.0423, Accuracy: 56/496 (11.2903%), train_poison_data_count: 40
Global model norm: 129.1800690291463.
Norm before scaling: 127.45493995428345. Distance: 10.523702118285849
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1033.8389623147311, distance: 1052.3701820177157
Total norm for 4 adversaries is: 1033.8389623147311. distance: 1052.3701820177157
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   1,  Average loss: 0.1708, Accuracy: 54/546 (9.8901%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   2,  Average loss: 0.0992, Accuracy: 62/546 (11.3553%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   3,  Average loss: 0.0709, Accuracy: 101/546 (18.4982%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   4,  Average loss: 0.0486, Accuracy: 103/546 (18.8645%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   5,  Average loss: 0.0382, Accuracy: 93/546 (17.0330%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   6,  Average loss: 0.0348, Accuracy: 100/546 (18.3150%), train_poison_data_count: 45
Global model norm: 129.1800690291463.
Norm before scaling: 127.32765235677402. Distance: 11.991373140101857
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1180.1367505505452, distance: 1199.1372940576905
Total norm for 4 adversaries is: 1180.1367505505452. distance: 1199.1372940576905
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 230, local model 64, internal_epoch   1,  Average loss: 0.0995, Accuracy: 135/686 (19.6793%)
___Train Local_ResNet_18,  epoch 230, local model 64, internal_epoch   2,  Average loss: 0.0602, Accuracy: 135/686 (19.6793%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 230, local model 29, internal_epoch   1,  Average loss: 0.0661, Accuracy: 191/848 (22.5236%)
___Train Local_ResNet_18,  epoch 230, local model 29, internal_epoch   2,  Average loss: 0.0353, Accuracy: 422/848 (49.7642%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 230, local model 21, internal_epoch   1,  Average loss: 0.1510, Accuracy: 61/262 (23.2824%)
___Train Local_ResNet_18,  epoch 230, local model 21, internal_epoch   2,  Average loss: 0.0843, Accuracy: 38/262 (14.5038%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 230, local model 39, internal_epoch   1,  Average loss: 0.1591, Accuracy: 33/217 (15.2074%)
___Train Local_ResNet_18,  epoch 230, local model 39, internal_epoch   2,  Average loss: 0.0953, Accuracy: 47/217 (21.6590%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 230, local model 95, internal_epoch   1,  Average loss: 0.1496, Accuracy: 59/569 (10.3691%)
___Train Local_ResNet_18,  epoch 230, local model 95, internal_epoch   2,  Average loss: 0.0556, Accuracy: 149/569 (26.1863%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 230, local model 90, internal_epoch   1,  Average loss: 0.0721, Accuracy: 228/578 (39.4464%)
___Train Local_ResNet_18,  epoch 230, local model 90, internal_epoch   2,  Average loss: 0.0400, Accuracy: 230/578 (39.7924%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 191.85672044754028
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 230: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 239.7199969291687 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:231 choose agents : [17, 33, 77, 11, 68, 38, 97, 3, 98, 90]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   1,  Average loss: 0.4828, Accuracy: 71/526 (13.4981%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   2,  Average loss: 0.1057, Accuracy: 144/526 (27.3764%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   3,  Average loss: 0.0744, Accuracy: 105/526 (19.9620%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   4,  Average loss: 0.0636, Accuracy: 142/526 (26.9962%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   5,  Average loss: 0.0501, Accuracy: 136/526 (25.8555%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   6,  Average loss: 0.0453, Accuracy: 125/526 (23.7643%), train_poison_data_count: 45
Global model norm: 126.77802251252974.
Norm before scaling: 125.62813273457104. Distance: 27.72292347209875
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2756.0473508269047, distance: 2772.2922825705086
Total norm for 4 adversaries is: 2756.0473508269047. distance: 2772.2922825705086
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   1,  Average loss: 0.4923, Accuracy: 37/527 (7.0209%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   2,  Average loss: 0.1144, Accuracy: 33/527 (6.2619%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   3,  Average loss: 0.0829, Accuracy: 78/527 (14.8008%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   4,  Average loss: 0.0574, Accuracy: 75/527 (14.2315%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   5,  Average loss: 0.0400, Accuracy: 162/527 (30.7400%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   6,  Average loss: 0.0371, Accuracy: 110/527 (20.8729%), train_poison_data_count: 45
Global model norm: 126.77802251252974.
Norm before scaling: 125.59994697326707. Distance: 27.461297561650856
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2729.8640076018437, distance: 2746.129822131503
Total norm for 4 adversaries is: 2729.8640076018437. distance: 2746.129822131503
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   1,  Average loss: 0.4182, Accuracy: 89/496 (17.9435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   2,  Average loss: 0.0960, Accuracy: 65/496 (13.1048%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   3,  Average loss: 0.0722, Accuracy: 101/496 (20.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   4,  Average loss: 0.0561, Accuracy: 101/496 (20.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   5,  Average loss: 0.0470, Accuracy: 105/496 (21.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   6,  Average loss: 0.0435, Accuracy: 116/496 (23.3871%), train_poison_data_count: 40
Global model norm: 126.77802251252974.
Norm before scaling: 125.58251769255146. Distance: 24.0611023335967
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2391.103615488045, distance: 2406.1102426946277
Total norm for 4 adversaries is: 2391.103615488045. distance: 2406.1102426946277
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   1,  Average loss: 0.3900, Accuracy: 61/546 (11.1722%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   2,  Average loss: 0.0801, Accuracy: 58/546 (10.6227%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   3,  Average loss: 0.0652, Accuracy: 144/546 (26.3736%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   4,  Average loss: 0.0560, Accuracy: 119/546 (21.7949%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   5,  Average loss: 0.0511, Accuracy: 141/546 (25.8242%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   6,  Average loss: 0.0475, Accuracy: 146/546 (26.7399%), train_poison_data_count: 45
Global model norm: 126.77802251252974.
Norm before scaling: 125.48182917508414. Distance: 24.83321686105062
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2467.5073454804547, distance: 2483.321666639262
Total norm for 4 adversaries is: 2467.5073454804547. distance: 2483.321666639262
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 231, local model 68, internal_epoch   1,  Average loss: 0.3875, Accuracy: 29/416 (6.9712%)
___Train Local_ResNet_18,  epoch 231, local model 68, internal_epoch   2,  Average loss: 0.0726, Accuracy: 70/416 (16.8269%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 231, local model 38, internal_epoch   1,  Average loss: 0.2650, Accuracy: 77/756 (10.1852%)
___Train Local_ResNet_18,  epoch 231, local model 38, internal_epoch   2,  Average loss: 0.0394, Accuracy: 242/756 (32.0106%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 231, local model 97, internal_epoch   1,  Average loss: 0.4521, Accuracy: 45/418 (10.7656%)
___Train Local_ResNet_18,  epoch 231, local model 97, internal_epoch   2,  Average loss: 0.0830, Accuracy: 83/418 (19.8565%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 231, local model 3, internal_epoch   1,  Average loss: 0.1984, Accuracy: 263/780 (33.7179%)
___Train Local_ResNet_18,  epoch 231, local model 3, internal_epoch   2,  Average loss: 0.0334, Accuracy: 271/780 (34.7436%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 231, local model 98, internal_epoch   1,  Average loss: 0.2151, Accuracy: 188/802 (23.4414%)
___Train Local_ResNet_18,  epoch 231, local model 98, internal_epoch   2,  Average loss: 0.0482, Accuracy: 239/802 (29.8005%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 231, local model 90, internal_epoch   1,  Average loss: 0.3214, Accuracy: 5/578 (0.8651%)
___Train Local_ResNet_18,  epoch 231, local model 90, internal_epoch   2,  Average loss: 0.0306, Accuracy: 301/578 (52.0761%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 194.71196508407593
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 231: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 242.11722874641418 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:232 choose agents : [17, 33, 77, 11, 88, 25, 27, 56, 93, 42]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   1,  Average loss: 0.1598, Accuracy: 103/526 (19.5817%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   2,  Average loss: 0.1016, Accuracy: 141/526 (26.8061%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   3,  Average loss: 0.0787, Accuracy: 144/526 (27.3764%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   4,  Average loss: 0.0670, Accuracy: 141/526 (26.8061%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   5,  Average loss: 0.0549, Accuracy: 143/526 (27.1863%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   6,  Average loss: 0.0462, Accuracy: 144/526 (27.3764%), train_poison_data_count: 45
Global model norm: 151.27502375640202.
Norm before scaling: 149.1294791867121. Distance: 12.578845573304065
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1234.8610245691618, distance: 1257.8845336516385
Total norm for 4 adversaries is: 1234.8610245691618. distance: 1257.8845336516385
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   1,  Average loss: 0.1171, Accuracy: 128/527 (24.2884%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   2,  Average loss: 0.0734, Accuracy: 71/527 (13.4725%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   3,  Average loss: 0.0529, Accuracy: 115/527 (21.8216%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   4,  Average loss: 0.0444, Accuracy: 162/527 (30.7400%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   5,  Average loss: 0.0394, Accuracy: 161/527 (30.5503%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   6,  Average loss: 0.0352, Accuracy: 158/527 (29.9810%), train_poison_data_count: 45
Global model norm: 151.27502375640202.
Norm before scaling: 149.29772452008436. Distance: 10.156603434355105
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 992.3217094269378, distance: 1015.6603147706422
Total norm for 4 adversaries is: 992.3217094269378. distance: 1015.6603147706422
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   1,  Average loss: 0.1498, Accuracy: 40/496 (8.0645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   2,  Average loss: 0.0875, Accuracy: 18/496 (3.6290%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   3,  Average loss: 0.0666, Accuracy: 84/496 (16.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   4,  Average loss: 0.0546, Accuracy: 93/496 (18.7500%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   5,  Average loss: 0.0451, Accuracy: 81/496 (16.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   6,  Average loss: 0.0423, Accuracy: 76/496 (15.3226%), train_poison_data_count: 40
Global model norm: 151.27502375640202.
Norm before scaling: 149.47989256502026. Distance: 11.770277342141837
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1157.7716203984273, distance: 1177.0277715500174
Total norm for 4 adversaries is: 1157.7716203984273. distance: 1177.0277715500174
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   1,  Average loss: 0.1612, Accuracy: 47/546 (8.6081%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   2,  Average loss: 0.0868, Accuracy: 72/546 (13.1868%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   3,  Average loss: 0.0651, Accuracy: 49/546 (8.9744%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   4,  Average loss: 0.0513, Accuracy: 94/546 (17.2161%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   5,  Average loss: 0.0462, Accuracy: 140/546 (25.6410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   6,  Average loss: 0.0438, Accuracy: 138/546 (25.2747%), train_poison_data_count: 45
Global model norm: 151.27502375640202.
Norm before scaling: 149.23468174112546. Distance: 12.410598876667438
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1219.1789757865743, distance: 1241.059829339424
Total norm for 4 adversaries is: 1219.1789757865743. distance: 1241.059829339424
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 232, local model 88, internal_epoch   1,  Average loss: 0.1535, Accuracy: 7/447 (1.5660%)
___Train Local_ResNet_18,  epoch 232, local model 88, internal_epoch   2,  Average loss: 0.0624, Accuracy: 2/447 (0.4474%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 232, local model 25, internal_epoch   1,  Average loss: 0.1475, Accuracy: 2/545 (0.3670%)
___Train Local_ResNet_18,  epoch 232, local model 25, internal_epoch   2,  Average loss: 0.0575, Accuracy: 61/545 (11.1927%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 232, local model 27, internal_epoch   1,  Average loss: 0.1865, Accuracy: 53/397 (13.3501%)
___Train Local_ResNet_18,  epoch 232, local model 27, internal_epoch   2,  Average loss: 0.1034, Accuracy: 83/397 (20.9068%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 232, local model 56, internal_epoch   1,  Average loss: 0.0870, Accuracy: 128/743 (17.2275%)
___Train Local_ResNet_18,  epoch 232, local model 56, internal_epoch   2,  Average loss: 0.0472, Accuracy: 130/743 (17.4966%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 232, local model 93, internal_epoch   1,  Average loss: 0.1257, Accuracy: 107/584 (18.3219%)
___Train Local_ResNet_18,  epoch 232, local model 93, internal_epoch   2,  Average loss: 0.0600, Accuracy: 84/584 (14.3836%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 232, local model 42, internal_epoch   1,  Average loss: 0.2048, Accuracy: 5/198 (2.5253%)
___Train Local_ResNet_18,  epoch 232, local model 42, internal_epoch   2,  Average loss: 0.1172, Accuracy: 12/198 (6.0606%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 193.16708207130432
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 232: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 241.97479557991028 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:233 choose agents : [17, 33, 77, 11, 18, 66, 27, 82, 86, 67]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   1,  Average loss: 0.2185, Accuracy: 44/526 (8.3650%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   2,  Average loss: 0.1671, Accuracy: 46/526 (8.7452%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   3,  Average loss: 0.1311, Accuracy: 62/526 (11.7871%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   4,  Average loss: 0.0899, Accuracy: 124/526 (23.5741%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   5,  Average loss: 0.0470, Accuracy: 104/526 (19.7719%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   6,  Average loss: 0.0348, Accuracy: 164/526 (31.1787%), train_poison_data_count: 45
Global model norm: 148.33924379610406.
Norm before scaling: 146.10226913663936. Distance: 12.630220146042586
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1239.1170243362812, distance: 1263.0219713053293
Total norm for 4 adversaries is: 1239.1170243362812. distance: 1263.0219713053293
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   1,  Average loss: 0.1984, Accuracy: 48/527 (9.1082%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   2,  Average loss: 0.1507, Accuracy: 45/527 (8.5389%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   3,  Average loss: 0.1318, Accuracy: 74/527 (14.0417%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   4,  Average loss: 0.1024, Accuracy: 61/527 (11.5750%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   5,  Average loss: 0.0711, Accuracy: 119/527 (22.5806%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   6,  Average loss: 0.0448, Accuracy: 129/527 (24.4782%), train_poison_data_count: 45
Global model norm: 148.33924379610406.
Norm before scaling: 146.01014653312626. Distance: 12.436502541268762
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1218.4609144326296, distance: 1243.6502221283924
Total norm for 4 adversaries is: 1218.4609144326296. distance: 1243.6502221283924
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   1,  Average loss: 0.1329, Accuracy: 90/496 (18.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   2,  Average loss: 0.1159, Accuracy: 81/496 (16.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   3,  Average loss: 0.1029, Accuracy: 87/496 (17.5403%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   4,  Average loss: 0.0881, Accuracy: 85/496 (17.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   5,  Average loss: 0.0736, Accuracy: 95/496 (19.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   6,  Average loss: 0.0617, Accuracy: 143/496 (28.8306%), train_poison_data_count: 40
Global model norm: 148.33924379610406.
Norm before scaling: 146.3668470188861. Distance: 9.408815965417421
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 916.6693787838667, distance: 940.8815679988635
Total norm for 4 adversaries is: 916.6693787838667. distance: 940.8815679988635
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   1,  Average loss: 0.1367, Accuracy: 54/546 (9.8901%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   2,  Average loss: 0.1077, Accuracy: 106/546 (19.4139%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   3,  Average loss: 0.0912, Accuracy: 109/546 (19.9634%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   4,  Average loss: 0.0871, Accuracy: 127/546 (23.2601%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   5,  Average loss: 0.0792, Accuracy: 128/546 (23.4432%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   6,  Average loss: 0.0585, Accuracy: 103/546 (18.8645%), train_poison_data_count: 45
Global model norm: 148.33924379610406.
Norm before scaling: 146.08237589413378. Distance: 9.61766347319315
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 933.4356565934258, distance: 961.7663762577688
Total norm for 4 adversaries is: 933.4356565934258. distance: 961.7663762577688
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 233, local model 18, internal_epoch   1,  Average loss: 0.1245, Accuracy: 21/386 (5.4404%)
___Train Local_ResNet_18,  epoch 233, local model 18, internal_epoch   2,  Average loss: 0.0842, Accuracy: 81/386 (20.9845%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 233, local model 66, internal_epoch   1,  Average loss: 0.2854, Accuracy: 7/555 (1.2613%)
___Train Local_ResNet_18,  epoch 233, local model 66, internal_epoch   2,  Average loss: 0.1834, Accuracy: 11/555 (1.9820%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 233, local model 27, internal_epoch   1,  Average loss: 0.2013, Accuracy: 1/397 (0.2519%)
___Train Local_ResNet_18,  epoch 233, local model 27, internal_epoch   2,  Average loss: 0.1386, Accuracy: 34/397 (8.5642%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 233, local model 82, internal_epoch   1,  Average loss: 0.2196, Accuracy: 3/601 (0.4992%)
___Train Local_ResNet_18,  epoch 233, local model 82, internal_epoch   2,  Average loss: 0.1440, Accuracy: 69/601 (11.4809%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 233, local model 86, internal_epoch   1,  Average loss: 0.2217, Accuracy: 9/212 (4.2453%)
___Train Local_ResNet_18,  epoch 233, local model 86, internal_epoch   2,  Average loss: 0.1895, Accuracy: 45/212 (21.2264%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 233, local model 67, internal_epoch   1,  Average loss: 0.1567, Accuracy: 142/842 (16.8646%)
___Train Local_ResNet_18,  epoch 233, local model 67, internal_epoch   2,  Average loss: 0.1001, Accuracy: 216/842 (25.6532%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 195.3677773475647
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 233: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 242.5440707206726 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:234 choose agents : [17, 33, 77, 11, 38, 29, 30, 96, 0, 3]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   1,  Average loss: 0.6549, Accuracy: 101/526 (19.2015%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   2,  Average loss: 0.0954, Accuracy: 139/526 (26.4259%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   3,  Average loss: 0.0840, Accuracy: 138/526 (26.2357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   4,  Average loss: 0.0702, Accuracy: 155/526 (29.4677%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   5,  Average loss: 0.0623, Accuracy: 154/526 (29.2776%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   6,  Average loss: 0.0537, Accuracy: 156/526 (29.6578%), train_poison_data_count: 45
Global model norm: 143.0301883017183.
Norm before scaling: 141.94089879241994. Distance: 33.24337082940842
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 3306.0731994316156, distance: 3324.3369263659183
Total norm for 4 adversaries is: 3306.0731994316156. distance: 3324.3369263659183
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   1,  Average loss: 0.6540, Accuracy: 125/527 (23.7192%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   2,  Average loss: 0.0953, Accuracy: 18/527 (3.4156%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   3,  Average loss: 0.0820, Accuracy: 106/527 (20.1139%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   4,  Average loss: 0.0705, Accuracy: 155/527 (29.4118%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   5,  Average loss: 0.0602, Accuracy: 153/527 (29.0323%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   6,  Average loss: 0.0518, Accuracy: 125/527 (23.7192%), train_poison_data_count: 45
Global model norm: 143.0301883017183.
Norm before scaling: 141.72548564478444. Distance: 31.71883274311868
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 3153.3377554584918, distance: 3171.8830369356306
Total norm for 4 adversaries is: 3153.3377554584918. distance: 3171.8830369356306
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   1,  Average loss: 0.7463, Accuracy: 46/496 (9.2742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   2,  Average loss: 0.1044, Accuracy: 44/496 (8.8710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   3,  Average loss: 0.0893, Accuracy: 38/496 (7.6613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   4,  Average loss: 0.0758, Accuracy: 64/496 (12.9032%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   5,  Average loss: 0.0652, Accuracy: 68/496 (13.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   6,  Average loss: 0.0559, Accuracy: 92/496 (18.5484%), train_poison_data_count: 40
Global model norm: 143.0301883017183.
Norm before scaling: 142.4775612815927. Distance: 35.50080462336382
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 3532.9476361814363, distance: 3550.0805624661534
Total norm for 4 adversaries is: 3532.9476361814363. distance: 3550.0805624661534
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   1,  Average loss: 0.7392, Accuracy: 57/546 (10.4396%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   2,  Average loss: 0.0951, Accuracy: 48/546 (8.7912%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   3,  Average loss: 0.0766, Accuracy: 48/546 (8.7912%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   4,  Average loss: 0.0640, Accuracy: 99/546 (18.1319%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   5,  Average loss: 0.0538, Accuracy: 147/546 (26.9231%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   6,  Average loss: 0.0378, Accuracy: 119/546 (21.7949%), train_poison_data_count: 45
Global model norm: 143.0301883017183.
Norm before scaling: 142.52770426964366. Distance: 37.32752164382619
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 3714.8639275214373, distance: 3732.7523357436935
Total norm for 4 adversaries is: 3714.8639275214373. distance: 3732.7523357436935
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 234, local model 38, internal_epoch   1,  Average loss: 0.3628, Accuracy: 103/756 (13.6243%)
___Train Local_ResNet_18,  epoch 234, local model 38, internal_epoch   2,  Average loss: 0.0607, Accuracy: 124/756 (16.4021%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 234, local model 29, internal_epoch   1,  Average loss: 0.2954, Accuracy: 100/848 (11.7925%)
___Train Local_ResNet_18,  epoch 234, local model 29, internal_epoch   2,  Average loss: 0.0473, Accuracy: 452/848 (53.3019%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 234, local model 30, internal_epoch   1,  Average loss: 0.8230, Accuracy: 18/337 (5.3412%)
___Train Local_ResNet_18,  epoch 234, local model 30, internal_epoch   2,  Average loss: 0.1101, Accuracy: 2/337 (0.5935%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 234, local model 96, internal_epoch   1,  Average loss: 0.3754, Accuracy: 80/708 (11.2994%)
___Train Local_ResNet_18,  epoch 234, local model 96, internal_epoch   2,  Average loss: 0.0573, Accuracy: 179/708 (25.2825%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 234, local model 0, internal_epoch   1,  Average loss: 0.7373, Accuracy: 56/367 (15.2589%)
___Train Local_ResNet_18,  epoch 234, local model 0, internal_epoch   2,  Average loss: 0.0931, Accuracy: 28/367 (7.6294%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 234, local model 3, internal_epoch   1,  Average loss: 0.3864, Accuracy: 251/780 (32.1795%)
___Train Local_ResNet_18,  epoch 234, local model 3, internal_epoch   2,  Average loss: 0.0575, Accuracy: 375/780 (48.0769%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 193.58229088783264
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 234: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 241.32625722885132 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:235 choose agents : [17, 33, 77, 11, 8, 68, 79, 90, 21, 25]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   1,  Average loss: 0.2015, Accuracy: 91/526 (17.3004%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   2,  Average loss: 0.1404, Accuracy: 21/526 (3.9924%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   3,  Average loss: 0.1098, Accuracy: 29/526 (5.5133%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   4,  Average loss: 0.0667, Accuracy: 132/526 (25.0951%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   5,  Average loss: 0.0373, Accuracy: 151/526 (28.7072%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   6,  Average loss: 0.0347, Accuracy: 144/526 (27.3764%), train_poison_data_count: 45
Global model norm: 182.95145360176835.
Norm before scaling: 180.5556527777516. Distance: 12.98437911307847
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1271.0087037467524, distance: 1298.437907641332
Total norm for 4 adversaries is: 1271.0087037467524. distance: 1298.437907641332
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   1,  Average loss: 0.1671, Accuracy: 72/527 (13.6622%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   2,  Average loss: 0.0951, Accuracy: 98/527 (18.5958%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   3,  Average loss: 0.0716, Accuracy: 76/527 (14.4213%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   4,  Average loss: 0.0423, Accuracy: 119/527 (22.5806%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   5,  Average loss: 0.0399, Accuracy: 117/527 (22.2011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   6,  Average loss: 0.0358, Accuracy: 119/527 (22.5806%), train_poison_data_count: 45
Global model norm: 182.95145360176835.
Norm before scaling: 180.99034742044947. Distance: 15.830313197090218
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1563.0182340587073, distance: 1583.0311904697267
Total norm for 4 adversaries is: 1563.0182340587073. distance: 1583.0311904697267
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   1,  Average loss: 0.1444, Accuracy: 95/496 (19.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   2,  Average loss: 0.0877, Accuracy: 70/496 (14.1129%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   3,  Average loss: 0.0774, Accuracy: 81/496 (16.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   4,  Average loss: 0.0704, Accuracy: 158/496 (31.8548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   5,  Average loss: 0.0651, Accuracy: 146/496 (29.4355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   6,  Average loss: 0.0571, Accuracy: 145/496 (29.2339%), train_poison_data_count: 40
Global model norm: 182.95145360176835.
Norm before scaling: 180.86166912691866. Distance: 11.120551773762383
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1087.0794014238334, distance: 1112.0552481778952
Total norm for 4 adversaries is: 1087.0794014238334. distance: 1112.0552481778952
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   1,  Average loss: 0.1489, Accuracy: 91/546 (16.6667%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   2,  Average loss: 0.0854, Accuracy: 143/546 (26.1905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   3,  Average loss: 0.0729, Accuracy: 141/546 (25.8242%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   4,  Average loss: 0.0651, Accuracy: 99/546 (18.1319%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   5,  Average loss: 0.0562, Accuracy: 114/546 (20.8791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   6,  Average loss: 0.0431, Accuracy: 116/546 (21.2454%), train_poison_data_count: 45
Global model norm: 182.95145360176835.
Norm before scaling: 180.64517620877675. Distance: 12.444357357023177
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1217.682224556144, distance: 1244.4357657187454
Total norm for 4 adversaries is: 1217.682224556144. distance: 1244.4357657187454
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 235, local model 8, internal_epoch   1,  Average loss: 0.1090, Accuracy: 114/534 (21.3483%)
___Train Local_ResNet_18,  epoch 235, local model 8, internal_epoch   2,  Average loss: 0.0620, Accuracy: 108/534 (20.2247%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 235, local model 68, internal_epoch   1,  Average loss: 0.1815, Accuracy: 90/416 (21.6346%)
___Train Local_ResNet_18,  epoch 235, local model 68, internal_epoch   2,  Average loss: 0.1005, Accuracy: 76/416 (18.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 235, local model 79, internal_epoch   1,  Average loss: 0.2402, Accuracy: 46/154 (29.8701%)
___Train Local_ResNet_18,  epoch 235, local model 79, internal_epoch   2,  Average loss: 0.1187, Accuracy: 45/154 (29.2208%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 235, local model 90, internal_epoch   1,  Average loss: 0.1083, Accuracy: 137/578 (23.7024%)
___Train Local_ResNet_18,  epoch 235, local model 90, internal_epoch   2,  Average loss: 0.0403, Accuracy: 294/578 (50.8651%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 235, local model 21, internal_epoch   1,  Average loss: 0.1488, Accuracy: 44/262 (16.7939%)
___Train Local_ResNet_18,  epoch 235, local model 21, internal_epoch   2,  Average loss: 0.0772, Accuracy: 47/262 (17.9389%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 235, local model 25, internal_epoch   1,  Average loss: 0.1057, Accuracy: 108/545 (19.8165%)
___Train Local_ResNet_18,  epoch 235, local model 25, internal_epoch   2,  Average loss: 0.0436, Accuracy: 135/545 (24.7706%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 196.77585744857788
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 235: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 244.7549183368683 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:236 choose agents : [17, 33, 77, 11, 53, 14, 6, 12, 7, 58]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   1,  Average loss: 0.4133, Accuracy: 78/526 (14.8289%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   2,  Average loss: 0.0713, Accuracy: 33/526 (6.2738%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   3,  Average loss: 0.0591, Accuracy: 110/526 (20.9125%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   4,  Average loss: 0.0472, Accuracy: 133/526 (25.2852%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   5,  Average loss: 0.0388, Accuracy: 176/526 (33.4601%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   6,  Average loss: 0.0370, Accuracy: 179/526 (34.0304%), train_poison_data_count: 45
Global model norm: 178.34561995252363.
Norm before scaling: 176.43174915353245. Distance: 24.445061569900986
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2424.821952226596, distance: 2444.506187351548
Total norm for 4 adversaries is: 2424.821952226596. distance: 2444.506187351548
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   1,  Average loss: 0.4632, Accuracy: 112/527 (21.2524%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   2,  Average loss: 0.0692, Accuracy: 57/527 (10.8159%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   3,  Average loss: 0.0600, Accuracy: 158/527 (29.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   4,  Average loss: 0.0522, Accuracy: 161/527 (30.5503%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   5,  Average loss: 0.0477, Accuracy: 157/527 (29.7913%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   6,  Average loss: 0.0431, Accuracy: 157/527 (29.7913%), train_poison_data_count: 45
Global model norm: 178.34561995252363.
Norm before scaling: 176.5095993759971. Distance: 26.904024570423243
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2670.6811865140326, distance: 2690.4023862612075
Total norm for 4 adversaries is: 2670.6811865140326. distance: 2690.4023862612075
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   1,  Average loss: 0.5410, Accuracy: 63/496 (12.7016%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   2,  Average loss: 0.0690, Accuracy: 36/496 (7.2581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   3,  Average loss: 0.0564, Accuracy: 31/496 (6.2500%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   4,  Average loss: 0.0477, Accuracy: 76/496 (15.3226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   5,  Average loss: 0.0408, Accuracy: 109/496 (21.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   6,  Average loss: 0.0391, Accuracy: 124/496 (25.0000%), train_poison_data_count: 40
Global model norm: 178.34561995252363.
Norm before scaling: 177.01935363823924. Distance: 29.14555190420626
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2897.302538569281, distance: 2914.5550260717328
Total norm for 4 adversaries is: 2897.302538569281. distance: 2914.5550260717328
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   1,  Average loss: 0.5032, Accuracy: 53/546 (9.7070%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   2,  Average loss: 0.0820, Accuracy: 89/546 (16.3004%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   3,  Average loss: 0.0705, Accuracy: 79/546 (14.4689%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   4,  Average loss: 0.0592, Accuracy: 74/546 (13.5531%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   5,  Average loss: 0.0498, Accuracy: 66/546 (12.0879%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   6,  Average loss: 0.0417, Accuracy: 71/546 (13.0037%), train_poison_data_count: 45
Global model norm: 178.34561995252363.
Norm before scaling: 176.63687039906193. Distance: 29.133416920184843
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2893.757937354125, distance: 2913.3418954870367
Total norm for 4 adversaries is: 2893.757937354125. distance: 2913.3418954870367
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 236, local model 53, internal_epoch   1,  Average loss: 0.2939, Accuracy: 137/625 (21.9200%)
___Train Local_ResNet_18,  epoch 236, local model 53, internal_epoch   2,  Average loss: 0.0432, Accuracy: 220/625 (35.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 236, local model 14, internal_epoch   1,  Average loss: 0.5428, Accuracy: 7/318 (2.2013%)
___Train Local_ResNet_18,  epoch 236, local model 14, internal_epoch   2,  Average loss: 0.0609, Accuracy: 12/318 (3.7736%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 236, local model 6, internal_epoch   1,  Average loss: 0.4033, Accuracy: 10/520 (1.9231%)
___Train Local_ResNet_18,  epoch 236, local model 6, internal_epoch   2,  Average loss: 0.0545, Accuracy: 95/520 (18.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 236, local model 12, internal_epoch   1,  Average loss: 0.1599, Accuracy: 350/977 (35.8240%)
___Train Local_ResNet_18,  epoch 236, local model 12, internal_epoch   2,  Average loss: 0.0343, Accuracy: 410/977 (41.9652%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 236, local model 7, internal_epoch   1,  Average loss: 0.5722, Accuracy: 23/352 (6.5341%)
___Train Local_ResNet_18,  epoch 236, local model 7, internal_epoch   2,  Average loss: 0.0707, Accuracy: 10/352 (2.8409%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 236, local model 58, internal_epoch   1,  Average loss: 0.6803, Accuracy: 18/234 (7.6923%)
___Train Local_ResNet_18,  epoch 236, local model 58, internal_epoch   2,  Average loss: 0.0703, Accuracy: 24/234 (10.2564%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 196.13848090171814
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 236: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 242.5215241909027 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:237 choose agents : [17, 33, 77, 11, 65, 0, 98, 20, 45, 82]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   1,  Average loss: 0.1313, Accuracy: 53/526 (10.0760%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   2,  Average loss: 0.1000, Accuracy: 75/526 (14.2586%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   3,  Average loss: 0.0678, Accuracy: 115/526 (21.8631%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   4,  Average loss: 0.0559, Accuracy: 191/526 (36.3118%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   5,  Average loss: 0.0542, Accuracy: 183/526 (34.7909%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   6,  Average loss: 0.0488, Accuracy: 200/526 (38.0228%), train_poison_data_count: 45
Global model norm: 195.1847682325647.
Norm before scaling: 192.7058761104601. Distance: 9.526178930818624
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 916.7057188651111, distance: 952.6178404795912
Total norm for 4 adversaries is: 916.7057188651111. distance: 952.6178404795912
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   1,  Average loss: 0.1570, Accuracy: 52/527 (9.8672%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   2,  Average loss: 0.1173, Accuracy: 95/527 (18.0266%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   3,  Average loss: 0.0929, Accuracy: 96/527 (18.2163%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   4,  Average loss: 0.0735, Accuracy: 59/527 (11.1954%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   5,  Average loss: 0.0568, Accuracy: 93/527 (17.6471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   6,  Average loss: 0.0435, Accuracy: 121/527 (22.9602%), train_poison_data_count: 45
Global model norm: 195.1847682325647.
Norm before scaling: 192.6341152126227. Distance: 11.546086058551806
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1122.0370983171636, distance: 1154.6085916881098
Total norm for 4 adversaries is: 1122.0370983171636. distance: 1154.6085916881098
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   1,  Average loss: 0.1089, Accuracy: 104/496 (20.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   2,  Average loss: 0.0823, Accuracy: 141/496 (28.4274%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   3,  Average loss: 0.0679, Accuracy: 146/496 (29.4355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   4,  Average loss: 0.0615, Accuracy: 133/496 (26.8145%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   5,  Average loss: 0.0574, Accuracy: 152/496 (30.6452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   6,  Average loss: 0.0518, Accuracy: 168/496 (33.8710%), train_poison_data_count: 40
Global model norm: 195.1847682325647.
Norm before scaling: 193.0073468485073. Distance: 8.050971253368044
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 771.5383982667356, distance: 805.0971214704472
Total norm for 4 adversaries is: 771.5383982667356. distance: 805.0971214704472
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   1,  Average loss: 0.1291, Accuracy: 83/546 (15.2015%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   2,  Average loss: 0.1013, Accuracy: 141/546 (25.8242%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   3,  Average loss: 0.0851, Accuracy: 146/546 (26.7399%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   4,  Average loss: 0.0728, Accuracy: 133/546 (24.3590%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   5,  Average loss: 0.0645, Accuracy: 112/546 (20.5128%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   6,  Average loss: 0.0511, Accuracy: 125/546 (22.8938%), train_poison_data_count: 45
Global model norm: 195.1847682325647.
Norm before scaling: 192.61560043581622. Distance: 9.745839723017113
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 937.4326642484782, distance: 974.5839496934063
Total norm for 4 adversaries is: 937.4326642484782. distance: 974.5839496934063
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 237, local model 65, internal_epoch   1,  Average loss: 0.1197, Accuracy: 16/314 (5.0955%)
___Train Local_ResNet_18,  epoch 237, local model 65, internal_epoch   2,  Average loss: 0.0811, Accuracy: 71/314 (22.6115%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 237, local model 0, internal_epoch   1,  Average loss: 0.1277, Accuracy: 48/367 (13.0790%)
___Train Local_ResNet_18,  epoch 237, local model 0, internal_epoch   2,  Average loss: 0.0960, Accuracy: 55/367 (14.9864%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 237, local model 98, internal_epoch   1,  Average loss: 0.0728, Accuracy: 232/802 (28.9277%)
___Train Local_ResNet_18,  epoch 237, local model 98, internal_epoch   2,  Average loss: 0.0542, Accuracy: 290/802 (36.1596%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 237, local model 20, internal_epoch   1,  Average loss: 0.1971, Accuracy: 33/362 (9.1160%)
___Train Local_ResNet_18,  epoch 237, local model 20, internal_epoch   2,  Average loss: 0.1442, Accuracy: 32/362 (8.8398%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 237, local model 45, internal_epoch   1,  Average loss: 0.0491, Accuracy: 156/529 (29.4896%)
___Train Local_ResNet_18,  epoch 237, local model 45, internal_epoch   2,  Average loss: 0.0299, Accuracy: 226/529 (42.7221%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 237, local model 82, internal_epoch   1,  Average loss: 0.1231, Accuracy: 81/601 (13.4775%)
___Train Local_ResNet_18,  epoch 237, local model 82, internal_epoch   2,  Average loss: 0.0666, Accuracy: 173/601 (28.7854%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 194.18771028518677
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 237: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 239.73340153694153 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:238 choose agents : [17, 33, 77, 11, 88, 46, 85, 42, 29, 8]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   1,  Average loss: 0.2639, Accuracy: 59/526 (11.2167%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   2,  Average loss: 0.0870, Accuracy: 146/526 (27.7567%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   3,  Average loss: 0.0497, Accuracy: 147/526 (27.9468%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   4,  Average loss: 0.0457, Accuracy: 140/526 (26.6160%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   5,  Average loss: 0.0453, Accuracy: 137/526 (26.0456%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   6,  Average loss: 0.0427, Accuracy: 138/526 (26.2357%), train_poison_data_count: 45
Global model norm: 187.78778955579088.
Norm before scaling: 185.42283814635672. Distance: 17.642081566305816
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1740.203292721859, distance: 1764.208108472467
Total norm for 4 adversaries is: 1740.203292721859. distance: 1764.208108472467
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   1,  Average loss: 0.3002, Accuracy: 146/527 (27.7040%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   2,  Average loss: 0.1106, Accuracy: 67/527 (12.7135%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   3,  Average loss: 0.0752, Accuracy: 107/527 (20.3036%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   4,  Average loss: 0.0689, Accuracy: 155/527 (29.4118%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   5,  Average loss: 0.0613, Accuracy: 162/527 (30.7400%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   6,  Average loss: 0.0543, Accuracy: 162/527 (30.7400%), train_poison_data_count: 45
Global model norm: 187.78778955579088.
Norm before scaling: 185.24302028011743. Distance: 18.38045332556096
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1812.4465509360546, distance: 1838.0452932395328
Total norm for 4 adversaries is: 1812.4465509360546. distance: 1838.0452932395328
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   1,  Average loss: 0.3622, Accuracy: 56/496 (11.2903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   2,  Average loss: 0.1299, Accuracy: 25/496 (5.0403%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   3,  Average loss: 0.0838, Accuracy: 48/496 (9.6774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   4,  Average loss: 0.0700, Accuracy: 90/496 (18.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   5,  Average loss: 0.0627, Accuracy: 88/496 (17.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   6,  Average loss: 0.0560, Accuracy: 86/496 (17.3387%), train_poison_data_count: 40
Global model norm: 187.78778955579088.
Norm before scaling: 185.56132114815847. Distance: 20.47934706004709
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2025.8914087383855, distance: 2047.9348134157005
Total norm for 4 adversaries is: 2025.8914087383855. distance: 2047.9348134157005
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   1,  Average loss: 0.3402, Accuracy: 55/546 (10.0733%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   2,  Average loss: 0.1289, Accuracy: 63/546 (11.5385%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   3,  Average loss: 0.0827, Accuracy: 74/546 (13.5531%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   4,  Average loss: 0.0695, Accuracy: 46/546 (8.4249%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   5,  Average loss: 0.0592, Accuracy: 49/546 (8.9744%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   6,  Average loss: 0.0504, Accuracy: 46/546 (8.4249%), train_poison_data_count: 45
Global model norm: 187.78778955579088.
Norm before scaling: 185.24163906570791. Distance: 20.681751939360698
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2043.2475376223997, distance: 2068.17516182745
Total norm for 4 adversaries is: 2043.2475376223997. distance: 2068.17516182745
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 238, local model 88, internal_epoch   1,  Average loss: 0.3627, Accuracy: 7/447 (1.5660%)
___Train Local_ResNet_18,  epoch 238, local model 88, internal_epoch   2,  Average loss: 0.0965, Accuracy: 3/447 (0.6711%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 238, local model 46, internal_epoch   1,  Average loss: 0.2734, Accuracy: 57/601 (9.4842%)
___Train Local_ResNet_18,  epoch 238, local model 46, internal_epoch   2,  Average loss: 0.0901, Accuracy: 84/601 (13.9767%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 238, local model 85, internal_epoch   1,  Average loss: 0.3527, Accuracy: 74/364 (20.3297%)
___Train Local_ResNet_18,  epoch 238, local model 85, internal_epoch   2,  Average loss: 0.1169, Accuracy: 28/364 (7.6923%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 238, local model 42, internal_epoch   1,  Average loss: 0.5201, Accuracy: 4/198 (2.0202%)
___Train Local_ResNet_18,  epoch 238, local model 42, internal_epoch   2,  Average loss: 0.1844, Accuracy: 3/198 (1.5152%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 238, local model 29, internal_epoch   1,  Average loss: 0.1500, Accuracy: 179/848 (21.1085%)
___Train Local_ResNet_18,  epoch 238, local model 29, internal_epoch   2,  Average loss: 0.0351, Accuracy: 381/848 (44.9292%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 238, local model 8, internal_epoch   1,  Average loss: 0.2791, Accuracy: 31/534 (5.8052%)
___Train Local_ResNet_18,  epoch 238, local model 8, internal_epoch   2,  Average loss: 0.0733, Accuracy: 97/534 (18.1648%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 186.53468704223633
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 238: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 233.32840037345886 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:239 choose agents : [17, 33, 77, 11, 63, 48, 69, 96, 88, 20]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   1,  Average loss: 0.3805, Accuracy: 55/526 (10.4563%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   2,  Average loss: 0.1708, Accuracy: 20/526 (3.8023%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   3,  Average loss: 0.1393, Accuracy: 80/526 (15.2091%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   4,  Average loss: 0.1117, Accuracy: 89/526 (16.9202%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   5,  Average loss: 0.1030, Accuracy: 97/526 (18.4411%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   6,  Average loss: 0.0930, Accuracy: 121/526 (23.0038%), train_poison_data_count: 45
Global model norm: 189.54754927853855.
Norm before scaling: 186.73294140630355. Distance: 20.12909538347492
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1985.2726513000675, distance: 2012.909585649589
Total norm for 4 adversaries is: 1985.2726513000675. distance: 2012.909585649589
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   1,  Average loss: 0.6491, Accuracy: 76/527 (14.4213%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   2,  Average loss: 0.1598, Accuracy: 105/527 (19.9241%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   3,  Average loss: 0.1267, Accuracy: 104/527 (19.7343%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   4,  Average loss: 0.1043, Accuracy: 66/527 (12.5237%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   5,  Average loss: 0.0909, Accuracy: 82/527 (15.5598%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   6,  Average loss: 0.0807, Accuracy: 58/527 (11.0057%), train_poison_data_count: 45
Global model norm: 189.54754927853855.
Norm before scaling: 188.3184429032377. Distance: 36.2565356446686
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 3606.022323835503, distance: 3625.653596249923
Total norm for 4 adversaries is: 3606.022323835503. distance: 3625.653596249923
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   1,  Average loss: 0.3506, Accuracy: 37/496 (7.4597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   2,  Average loss: 0.1277, Accuracy: 33/496 (6.6532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   3,  Average loss: 0.0840, Accuracy: 95/496 (19.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   4,  Average loss: 0.0732, Accuracy: 88/496 (17.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   5,  Average loss: 0.0658, Accuracy: 91/496 (18.3468%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   6,  Average loss: 0.0607, Accuracy: 102/496 (20.5645%), train_poison_data_count: 40
Global model norm: 189.54754927853855.
Norm before scaling: 187.58678200035843. Distance: 21.46981182554283
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2127.3021647147357, distance: 2146.9811363866243
Total norm for 4 adversaries is: 2127.3021647147357. distance: 2146.9811363866243
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   1,  Average loss: 0.2831, Accuracy: 114/546 (20.8791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   2,  Average loss: 0.1740, Accuracy: 150/546 (27.4725%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   3,  Average loss: 0.0909, Accuracy: 143/546 (26.1905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   4,  Average loss: 0.0826, Accuracy: 101/546 (18.4982%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   5,  Average loss: 0.0768, Accuracy: 115/546 (21.0623%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   6,  Average loss: 0.0753, Accuracy: 147/546 (26.9231%), train_poison_data_count: 45
Global model norm: 189.54754927853855.
Norm before scaling: 187.20569611058846. Distance: 20.794446291787413
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2056.3431133932877, distance: 2079.4445171727953
Total norm for 4 adversaries is: 2056.3431133932877. distance: 2079.4445171727953
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 239, local model 63, internal_epoch   1,  Average loss: 0.1511, Accuracy: 66/752 (8.7766%)
___Train Local_ResNet_18,  epoch 239, local model 63, internal_epoch   2,  Average loss: 0.0640, Accuracy: 89/752 (11.8351%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 239, local model 48, internal_epoch   1,  Average loss: 0.2939, Accuracy: 27/378 (7.1429%)
___Train Local_ResNet_18,  epoch 239, local model 48, internal_epoch   2,  Average loss: 0.1052, Accuracy: 77/378 (20.3704%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 239, local model 69, internal_epoch   1,  Average loss: 0.4508, Accuracy: 19/216 (8.7963%)
___Train Local_ResNet_18,  epoch 239, local model 69, internal_epoch   2,  Average loss: 0.1710, Accuracy: 38/216 (17.5926%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 239, local model 96, internal_epoch   1,  Average loss: 0.2860, Accuracy: 57/708 (8.0508%)
___Train Local_ResNet_18,  epoch 239, local model 96, internal_epoch   2,  Average loss: 0.0849, Accuracy: 157/708 (22.1751%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 239, local model 88, internal_epoch   1,  Average loss: 0.1700, Accuracy: 182/447 (40.7159%)
___Train Local_ResNet_18,  epoch 239, local model 88, internal_epoch   2,  Average loss: 0.0713, Accuracy: 193/447 (43.1767%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 239, local model 20, internal_epoch   1,  Average loss: 0.8248, Accuracy: 20/362 (5.5249%)
___Train Local_ResNet_18,  epoch 239, local model 20, internal_epoch   2,  Average loss: 0.1752, Accuracy: 7/362 (1.9337%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 185.2539768218994
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 239: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 232.94225645065308 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:240 choose agents : [17, 33, 77, 11, 71, 51, 95, 80, 24, 55]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   1,  Average loss: 0.1114, Accuracy: 45/526 (8.5551%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   2,  Average loss: 0.0911, Accuracy: 49/526 (9.3156%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   3,  Average loss: 0.0654, Accuracy: 51/526 (9.6958%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   4,  Average loss: 0.0516, Accuracy: 119/526 (22.6236%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   5,  Average loss: 0.0494, Accuracy: 133/526 (25.2852%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   6,  Average loss: 0.0498, Accuracy: 157/526 (29.8479%), train_poison_data_count: 45
Global model norm: 195.8071935125214.
Norm before scaling: 193.36861657207976. Distance: 8.70980014646195
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 833.341091630552, distance: 870.9800514363116
Total norm for 4 adversaries is: 833.341091630552. distance: 870.9800514363116
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   1,  Average loss: 0.1157, Accuracy: 46/527 (8.7287%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   2,  Average loss: 0.1005, Accuracy: 148/527 (28.0835%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   3,  Average loss: 0.0889, Accuracy: 164/527 (31.1195%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   4,  Average loss: 0.0786, Accuracy: 157/527 (29.7913%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   5,  Average loss: 0.0709, Accuracy: 159/527 (30.1708%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   6,  Average loss: 0.0673, Accuracy: 159/527 (30.1708%), train_poison_data_count: 45
Global model norm: 195.8071935125214.
Norm before scaling: 193.22121389743933. Distance: 8.562377483298894
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 814.5857843100382, distance: 856.2377371384655
Total norm for 4 adversaries is: 814.5857843100382. distance: 856.2377371384655
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   1,  Average loss: 0.0992, Accuracy: 91/496 (18.3468%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   2,  Average loss: 0.0880, Accuracy: 85/496 (17.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   3,  Average loss: 0.0755, Accuracy: 66/496 (13.3065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   4,  Average loss: 0.0666, Accuracy: 100/496 (20.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   5,  Average loss: 0.0612, Accuracy: 100/496 (20.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   6,  Average loss: 0.0546, Accuracy: 104/496 (20.9677%), train_poison_data_count: 40
Global model norm: 195.8071935125214.
Norm before scaling: 193.6040680260877. Distance: 7.599580512265288
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 724.0918450031046, distance: 759.958058053206
Total norm for 4 adversaries is: 724.0918450031046. distance: 759.958058053206
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   1,  Average loss: 0.1518, Accuracy: 46/546 (8.4249%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   2,  Average loss: 0.1316, Accuracy: 47/546 (8.6081%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   3,  Average loss: 0.1087, Accuracy: 55/546 (10.0733%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   4,  Average loss: 0.0915, Accuracy: 65/546 (11.9048%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   5,  Average loss: 0.0799, Accuracy: 63/546 (11.5385%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   6,  Average loss: 0.0674, Accuracy: 58/546 (10.6227%), train_poison_data_count: 45
Global model norm: 195.8071935125214.
Norm before scaling: 193.1070177712348. Distance: 10.966034555818002
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1060.1133783704458, distance: 1096.6034492924048
Total norm for 4 adversaries is: 1060.1133783704458. distance: 1096.6034492924048
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 240, local model 71, internal_epoch   1,  Average loss: 0.0729, Accuracy: 102/1166 (8.7479%)
___Train Local_ResNet_18,  epoch 240, local model 71, internal_epoch   2,  Average loss: 0.0405, Accuracy: 366/1166 (31.3894%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 240, local model 51, internal_epoch   1,  Average loss: 0.1401, Accuracy: 70/479 (14.6138%)
___Train Local_ResNet_18,  epoch 240, local model 51, internal_epoch   2,  Average loss: 0.0911, Accuracy: 33/479 (6.8894%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 240, local model 95, internal_epoch   1,  Average loss: 0.0590, Accuracy: 75/569 (13.1810%)
___Train Local_ResNet_18,  epoch 240, local model 95, internal_epoch   2,  Average loss: 0.0329, Accuracy: 238/569 (41.8278%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 240, local model 80, internal_epoch   1,  Average loss: 0.1124, Accuracy: 17/363 (4.6832%)
___Train Local_ResNet_18,  epoch 240, local model 80, internal_epoch   2,  Average loss: 0.0762, Accuracy: 11/363 (3.0303%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 240, local model 24, internal_epoch   1,  Average loss: 0.1356, Accuracy: 12/320 (3.7500%)
___Train Local_ResNet_18,  epoch 240, local model 24, internal_epoch   2,  Average loss: 0.1127, Accuracy: 10/320 (3.1250%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 240, local model 55, internal_epoch   1,  Average loss: 0.1485, Accuracy: 18/299 (6.0201%)
___Train Local_ResNet_18,  epoch 240, local model 55, internal_epoch   2,  Average loss: 0.1209, Accuracy: 18/299 (6.0201%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 200.33652019500732
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 240: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 249.5242657661438 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:241 choose agents : [17, 33, 77, 11, 13, 63, 61, 41, 90, 74]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   1,  Average loss: 0.1060, Accuracy: 153/526 (29.0875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   2,  Average loss: 0.0858, Accuracy: 154/526 (29.2776%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   3,  Average loss: 0.0763, Accuracy: 155/526 (29.4677%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   4,  Average loss: 0.0708, Accuracy: 175/526 (33.2700%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   5,  Average loss: 0.0605, Accuracy: 140/526 (26.6160%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   6,  Average loss: 0.0457, Accuracy: 144/526 (27.3764%), train_poison_data_count: 45
Global model norm: 187.71441906523856.
Norm before scaling: 185.33728754961857. Distance: 8.199176412021467
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 782.367920162886, distance: 819.9176406810626
Total norm for 4 adversaries is: 782.367920162886. distance: 819.9176406810626
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   1,  Average loss: 0.1699, Accuracy: 64/527 (12.1442%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   2,  Average loss: 0.1082, Accuracy: 79/527 (14.9905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   3,  Average loss: 0.0654, Accuracy: 135/527 (25.6167%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   4,  Average loss: 0.0539, Accuracy: 125/527 (23.7192%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   5,  Average loss: 0.0461, Accuracy: 140/527 (26.5655%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   6,  Average loss: 0.0399, Accuracy: 146/527 (27.7040%), train_poison_data_count: 45
Global model norm: 187.71441906523856.
Norm before scaling: 185.3907823692969. Distance: 10.318331462613676
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1001.2857671514162, distance: 1031.833138157522
Total norm for 4 adversaries is: 1001.2857671514162. distance: 1031.833138157522
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   1,  Average loss: 0.1577, Accuracy: 29/496 (5.8468%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   2,  Average loss: 0.1096, Accuracy: 85/496 (17.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   3,  Average loss: 0.0893, Accuracy: 108/496 (21.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   4,  Average loss: 0.0797, Accuracy: 116/496 (23.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   5,  Average loss: 0.0557, Accuracy: 109/496 (21.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   6,  Average loss: 0.0423, Accuracy: 118/496 (23.7903%), train_poison_data_count: 40
Global model norm: 187.71441906523856.
Norm before scaling: 185.60296586396458. Distance: 10.016018816604246
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 974.4672903694614, distance: 1001.6018420510218
Total norm for 4 adversaries is: 974.4672903694614. distance: 1001.6018420510218
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   1,  Average loss: 0.1097, Accuracy: 96/546 (17.5824%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   2,  Average loss: 0.0793, Accuracy: 96/546 (17.5824%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   3,  Average loss: 0.0685, Accuracy: 145/546 (26.5568%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   4,  Average loss: 0.0619, Accuracy: 150/546 (27.4725%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   5,  Average loss: 0.0549, Accuracy: 145/546 (26.5568%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   6,  Average loss: 0.0437, Accuracy: 135/546 (24.7253%), train_poison_data_count: 45
Global model norm: 187.71441906523856.
Norm before scaling: 185.379646351076. Distance: 8.446015306672543
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 808.9165979877035, distance: 844.6015332687954
Total norm for 4 adversaries is: 808.9165979877035. distance: 844.6015332687954
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 241, local model 13, internal_epoch   1,  Average loss: 0.0844, Accuracy: 257/620 (41.4516%)
___Train Local_ResNet_18,  epoch 241, local model 13, internal_epoch   2,  Average loss: 0.0604, Accuracy: 297/620 (47.9032%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 241, local model 63, internal_epoch   1,  Average loss: 0.0884, Accuracy: 104/752 (13.8298%)
___Train Local_ResNet_18,  epoch 241, local model 63, internal_epoch   2,  Average loss: 0.0579, Accuracy: 176/752 (23.4043%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 241, local model 61, internal_epoch   1,  Average loss: 0.1077, Accuracy: 162/590 (27.4576%)
___Train Local_ResNet_18,  epoch 241, local model 61, internal_epoch   2,  Average loss: 0.0627, Accuracy: 239/590 (40.5085%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 241, local model 41, internal_epoch   1,  Average loss: 0.2043, Accuracy: 4/513 (0.7797%)
___Train Local_ResNet_18,  epoch 241, local model 41, internal_epoch   2,  Average loss: 0.0932, Accuracy: 282/513 (54.9708%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 241, local model 90, internal_epoch   1,  Average loss: 0.0632, Accuracy: 223/578 (38.5813%)
___Train Local_ResNet_18,  epoch 241, local model 90, internal_epoch   2,  Average loss: 0.0350, Accuracy: 290/578 (50.1730%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 241, local model 74, internal_epoch   1,  Average loss: 0.1296, Accuracy: 17/469 (3.6247%)
___Train Local_ResNet_18,  epoch 241, local model 74, internal_epoch   2,  Average loss: 0.0706, Accuracy: 149/469 (31.7697%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 200.03041243553162
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 241: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 248.13373351097107 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:242 choose agents : [17, 33, 77, 11, 85, 14, 21, 78, 1, 2]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   1,  Average loss: 0.1022, Accuracy: 94/526 (17.8707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   2,  Average loss: 0.0447, Accuracy: 148/526 (28.1369%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   3,  Average loss: 0.0418, Accuracy: 141/526 (26.8061%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   4,  Average loss: 0.0375, Accuracy: 140/526 (26.6160%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   5,  Average loss: 0.0357, Accuracy: 135/526 (25.6654%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   6,  Average loss: 0.0328, Accuracy: 159/526 (30.2281%), train_poison_data_count: 45
Global model norm: 181.05141060276222.
Norm before scaling: 179.2079579357457. Distance: 13.546521315307992
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1335.3271602869463, distance: 1354.6521693778075
Total norm for 4 adversaries is: 1335.3271602869463. distance: 1354.6521693778075
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   1,  Average loss: 0.0914, Accuracy: 112/527 (21.2524%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   2,  Average loss: 0.0501, Accuracy: 70/527 (13.2827%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   3,  Average loss: 0.0410, Accuracy: 119/527 (22.5806%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   4,  Average loss: 0.0359, Accuracy: 161/527 (30.5503%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   5,  Average loss: 0.0334, Accuracy: 162/527 (30.7400%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   6,  Average loss: 0.0336, Accuracy: 150/527 (28.4630%), train_poison_data_count: 45
Global model norm: 181.05141060276222.
Norm before scaling: 179.09344191650345. Distance: 11.018041553972221
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1078.9331536290838, distance: 1101.8042022065445
Total norm for 4 adversaries is: 1078.9331536290838. distance: 1101.8042022065445
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   1,  Average loss: 0.1016, Accuracy: 45/496 (9.0726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   2,  Average loss: 0.0536, Accuracy: 46/496 (9.2742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   3,  Average loss: 0.0438, Accuracy: 110/496 (22.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   4,  Average loss: 0.0370, Accuracy: 101/496 (20.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   5,  Average loss: 0.0339, Accuracy: 93/496 (18.7500%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   6,  Average loss: 0.0334, Accuracy: 109/496 (21.9758%), train_poison_data_count: 40
Global model norm: 181.05141060276222.
Norm before scaling: 179.39274193616362. Distance: 11.871478713114787
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1169.709472475965, distance: 1187.1478951672366
Total norm for 4 adversaries is: 1169.709472475965. distance: 1187.1478951672366
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   1,  Average loss: 0.1035, Accuracy: 70/546 (12.8205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   2,  Average loss: 0.0505, Accuracy: 66/546 (12.0879%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   3,  Average loss: 0.0409, Accuracy: 84/546 (15.3846%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   4,  Average loss: 0.0371, Accuracy: 142/546 (26.0073%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   5,  Average loss: 0.0356, Accuracy: 144/546 (26.3736%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   6,  Average loss: 0.0344, Accuracy: 145/546 (26.5568%), train_poison_data_count: 45
Global model norm: 181.05141060276222.
Norm before scaling: 179.15406145096182. Distance: 12.893191624217375
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1268.919274422136, distance: 1289.31915172311
Total norm for 4 adversaries is: 1268.919274422136. distance: 1289.31915172311
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 242, local model 85, internal_epoch   1,  Average loss: 0.1004, Accuracy: 59/364 (16.2088%)
___Train Local_ResNet_18,  epoch 242, local model 85, internal_epoch   2,  Average loss: 0.0497, Accuracy: 29/364 (7.9670%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 242, local model 14, internal_epoch   1,  Average loss: 0.0826, Accuracy: 47/318 (14.7799%)
___Train Local_ResNet_18,  epoch 242, local model 14, internal_epoch   2,  Average loss: 0.0318, Accuracy: 131/318 (41.1950%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 242, local model 21, internal_epoch   1,  Average loss: 0.1584, Accuracy: 18/262 (6.8702%)
___Train Local_ResNet_18,  epoch 242, local model 21, internal_epoch   2,  Average loss: 0.0643, Accuracy: 48/262 (18.3206%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 242, local model 78, internal_epoch   1,  Average loss: 0.1107, Accuracy: 40/255 (15.6863%)
___Train Local_ResNet_18,  epoch 242, local model 78, internal_epoch   2,  Average loss: 0.0389, Accuracy: 6/255 (2.3529%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 242, local model 1, internal_epoch   1,  Average loss: 0.1003, Accuracy: 21/641 (3.2761%)
___Train Local_ResNet_18,  epoch 242, local model 1, internal_epoch   2,  Average loss: 0.0369, Accuracy: 197/641 (30.7332%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 242, local model 2, internal_epoch   1,  Average loss: 0.0656, Accuracy: 76/461 (16.4859%)
___Train Local_ResNet_18,  epoch 242, local model 2, internal_epoch   2,  Average loss: 0.0369, Accuracy: 196/461 (42.5163%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 197.8884241580963
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 242: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 248.46866393089294 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:243 choose agents : [17, 33, 77, 11, 9, 5, 16, 36, 94, 57]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   1,  Average loss: 0.2571, Accuracy: 30/526 (5.7034%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   2,  Average loss: 0.0701, Accuracy: 17/526 (3.2319%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   3,  Average loss: 0.0482, Accuracy: 100/526 (19.0114%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   4,  Average loss: 0.0386, Accuracy: 177/526 (33.6502%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   5,  Average loss: 0.0342, Accuracy: 167/526 (31.7490%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   6,  Average loss: 0.0336, Accuracy: 165/526 (31.3688%), train_poison_data_count: 45
Global model norm: 178.56571028790773.
Norm before scaling: 176.8942569022522. Distance: 20.83566873303409
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2066.472961352265, distance: 2083.566773588022
Total norm for 4 adversaries is: 2066.472961352265. distance: 2083.566773588022
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   1,  Average loss: 0.2130, Accuracy: 70/527 (13.2827%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   2,  Average loss: 0.0687, Accuracy: 90/527 (17.0778%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   3,  Average loss: 0.0520, Accuracy: 113/527 (21.4421%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   4,  Average loss: 0.0458, Accuracy: 160/527 (30.3605%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   5,  Average loss: 0.0427, Accuracy: 160/527 (30.3605%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   6,  Average loss: 0.0389, Accuracy: 162/527 (30.7400%), train_poison_data_count: 45
Global model norm: 178.56571028790773.
Norm before scaling: 176.58636453765337. Distance: 17.417998973258147
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1721.951509189501, distance: 1741.7997875760577
Total norm for 4 adversaries is: 1721.951509189501. distance: 1741.7997875760577
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   1,  Average loss: 0.2073, Accuracy: 79/496 (15.9274%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   2,  Average loss: 0.0664, Accuracy: 45/496 (9.0726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   3,  Average loss: 0.0485, Accuracy: 44/496 (8.8710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   4,  Average loss: 0.0408, Accuracy: 104/496 (20.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   5,  Average loss: 0.0360, Accuracy: 119/496 (23.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   6,  Average loss: 0.0340, Accuracy: 146/496 (29.4355%), train_poison_data_count: 40
Global model norm: 178.56571028790773.
Norm before scaling: 176.9212064204006. Distance: 17.410161070366172
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1724.6018381064077, distance: 1741.0161544339558
Total norm for 4 adversaries is: 1724.6018381064077. distance: 1741.0161544339558
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   1,  Average loss: 0.2005, Accuracy: 83/546 (15.2015%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   2,  Average loss: 0.0615, Accuracy: 141/546 (25.8242%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   3,  Average loss: 0.0501, Accuracy: 132/546 (24.1758%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   4,  Average loss: 0.0448, Accuracy: 120/546 (21.9780%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   5,  Average loss: 0.0407, Accuracy: 147/546 (26.9231%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   6,  Average loss: 0.0386, Accuracy: 144/546 (26.3736%), train_poison_data_count: 45
Global model norm: 178.56571028790773.
Norm before scaling: 176.66809895252737. Distance: 18.249168899633315
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1805.9608938180252, distance: 1824.9168474207256
Total norm for 4 adversaries is: 1805.9608938180252. distance: 1824.9168474207256
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 243, local model 9, internal_epoch   1,  Average loss: 0.1907, Accuracy: 101/368 (27.4457%)
___Train Local_ResNet_18,  epoch 243, local model 9, internal_epoch   2,  Average loss: 0.0474, Accuracy: 111/368 (30.1630%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 243, local model 5, internal_epoch   1,  Average loss: 0.2025, Accuracy: 31/365 (8.4932%)
___Train Local_ResNet_18,  epoch 243, local model 5, internal_epoch   2,  Average loss: 0.0542, Accuracy: 63/365 (17.2603%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 243, local model 16, internal_epoch   1,  Average loss: 0.1502, Accuracy: 58/773 (7.5032%)
___Train Local_ResNet_18,  epoch 243, local model 16, internal_epoch   2,  Average loss: 0.0415, Accuracy: 260/773 (33.6352%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 243, local model 36, internal_epoch   1,  Average loss: 0.1378, Accuracy: 110/849 (12.9564%)
___Train Local_ResNet_18,  epoch 243, local model 36, internal_epoch   2,  Average loss: 0.0418, Accuracy: 181/849 (21.3192%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 243, local model 94, internal_epoch   1,  Average loss: 0.2775, Accuracy: 22/203 (10.8374%)
___Train Local_ResNet_18,  epoch 243, local model 94, internal_epoch   2,  Average loss: 0.0576, Accuracy: 74/203 (36.4532%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 243, local model 57, internal_epoch   1,  Average loss: 0.2233, Accuracy: 85/290 (29.3103%)
___Train Local_ResNet_18,  epoch 243, local model 57, internal_epoch   2,  Average loss: 0.0780, Accuracy: 12/290 (4.1379%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 198.19015836715698
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 243: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 245.11051988601685 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:244 choose agents : [17, 33, 77, 11, 63, 92, 28, 56, 44, 40]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   1,  Average loss: 0.0932, Accuracy: 92/526 (17.4905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   2,  Average loss: 0.0678, Accuracy: 153/526 (29.0875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   3,  Average loss: 0.0602, Accuracy: 149/526 (28.3270%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   4,  Average loss: 0.0501, Accuracy: 159/526 (30.2281%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   5,  Average loss: 0.0413, Accuracy: 156/526 (29.6578%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   6,  Average loss: 0.0364, Accuracy: 155/526 (29.4677%), train_poison_data_count: 45
Global model norm: 181.98544756380934.
Norm before scaling: 179.76871534175515. Distance: 7.693224256635876
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 734.0749280557128, distance: 769.3224291543826
Total norm for 4 adversaries is: 734.0749280557128. distance: 769.3224291543826
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   1,  Average loss: 0.1160, Accuracy: 72/527 (13.6622%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   2,  Average loss: 0.0973, Accuracy: 136/527 (25.8065%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   3,  Average loss: 0.0843, Accuracy: 164/527 (31.1195%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   4,  Average loss: 0.0736, Accuracy: 157/527 (29.7913%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   5,  Average loss: 0.0558, Accuracy: 130/527 (24.6679%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   6,  Average loss: 0.0379, Accuracy: 140/527 (26.5655%), train_poison_data_count: 45
Global model norm: 181.98544756380934.
Norm before scaling: 179.60603044406665. Distance: 8.727814805650855
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 837.3833500852521, distance: 872.7814732222494
Total norm for 4 adversaries is: 837.3833500852521. distance: 872.7814732222494
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   1,  Average loss: 0.1120, Accuracy: 64/496 (12.9032%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   2,  Average loss: 0.0852, Accuracy: 72/496 (14.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   3,  Average loss: 0.0636, Accuracy: 100/496 (20.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   4,  Average loss: 0.0449, Accuracy: 112/496 (22.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   5,  Average loss: 0.0425, Accuracy: 101/496 (20.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   6,  Average loss: 0.0383, Accuracy: 137/496 (27.6210%), train_poison_data_count: 40
Global model norm: 181.98544756380934.
Norm before scaling: 180.0185320321216. Distance: 7.687334012356254
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 739.5654129284305, distance: 768.7333738039478
Total norm for 4 adversaries is: 739.5654129284305. distance: 768.7333738039478
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   1,  Average loss: 0.1455, Accuracy: 62/546 (11.3553%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   2,  Average loss: 0.1177, Accuracy: 72/546 (13.1868%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   3,  Average loss: 0.0991, Accuracy: 72/546 (13.1868%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   4,  Average loss: 0.0714, Accuracy: 58/546 (10.6227%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   5,  Average loss: 0.0427, Accuracy: 112/546 (20.5128%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   6,  Average loss: 0.0383, Accuracy: 76/546 (13.9194%), train_poison_data_count: 45
Global model norm: 181.98544756380934.
Norm before scaling: 179.56596977155777. Distance: 9.84771086917122
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 951.6925711594055, distance: 984.7710711124693
Total norm for 4 adversaries is: 951.6925711594055. distance: 984.7710711124693
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 244, local model 63, internal_epoch   1,  Average loss: 0.0896, Accuracy: 108/752 (14.3617%)
___Train Local_ResNet_18,  epoch 244, local model 63, internal_epoch   2,  Average loss: 0.0493, Accuracy: 146/752 (19.4149%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 244, local model 92, internal_epoch   1,  Average loss: 0.1056, Accuracy: 109/796 (13.6935%)
___Train Local_ResNet_18,  epoch 244, local model 92, internal_epoch   2,  Average loss: 0.0488, Accuracy: 201/796 (25.2513%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 244, local model 28, internal_epoch   1,  Average loss: 0.1384, Accuracy: 14/423 (3.3097%)
___Train Local_ResNet_18,  epoch 244, local model 28, internal_epoch   2,  Average loss: 0.1051, Accuracy: 51/423 (12.0567%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 244, local model 56, internal_epoch   1,  Average loss: 0.0823, Accuracy: 140/743 (18.8425%)
___Train Local_ResNet_18,  epoch 244, local model 56, internal_epoch   2,  Average loss: 0.0481, Accuracy: 165/743 (22.2073%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 244, local model 44, internal_epoch   1,  Average loss: 0.1174, Accuracy: 22/436 (5.0459%)
___Train Local_ResNet_18,  epoch 244, local model 44, internal_epoch   2,  Average loss: 0.0741, Accuracy: 152/436 (34.8624%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 244, local model 40, internal_epoch   1,  Average loss: 0.1206, Accuracy: 43/652 (6.5951%)
___Train Local_ResNet_18,  epoch 244, local model 40, internal_epoch   2,  Average loss: 0.0482, Accuracy: 227/652 (34.8160%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 199.94890475273132
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 244: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 247.2736599445343 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:245 choose agents : [17, 33, 77, 11, 74, 85, 2, 99, 35, 70]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   1,  Average loss: 0.2580, Accuracy: 36/526 (6.8441%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   2,  Average loss: 0.0589, Accuracy: 143/526 (27.1863%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   3,  Average loss: 0.0486, Accuracy: 138/526 (26.2357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   4,  Average loss: 0.0374, Accuracy: 161/526 (30.6084%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   5,  Average loss: 0.0356, Accuracy: 169/526 (32.1293%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   6,  Average loss: 0.0336, Accuracy: 173/526 (32.8897%), train_poison_data_count: 45
Global model norm: 174.80408676572753.
Norm before scaling: 173.08807142246977. Distance: 20.258275731061197
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2008.431166358459, distance: 2025.8276086577555
Total norm for 4 adversaries is: 2008.431166358459. distance: 2025.8276086577555
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   1,  Average loss: 0.2408, Accuracy: 73/527 (13.8520%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   2,  Average loss: 0.0640, Accuracy: 19/527 (3.6053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   3,  Average loss: 0.0488, Accuracy: 82/527 (15.5598%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   4,  Average loss: 0.0404, Accuracy: 162/527 (30.7400%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   5,  Average loss: 0.0353, Accuracy: 160/527 (30.3605%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   6,  Average loss: 0.0328, Accuracy: 156/527 (29.6015%), train_poison_data_count: 45
Global model norm: 174.80408676572753.
Norm before scaling: 172.97324689276374. Distance: 18.6892399312809
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1850.6302304890623, distance: 1868.9240888810866
Total norm for 4 adversaries is: 1850.6302304890623. distance: 1868.9240888810866
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   1,  Average loss: 0.2345, Accuracy: 75/496 (15.1210%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   2,  Average loss: 0.0570, Accuracy: 74/496 (14.9194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   3,  Average loss: 0.0492, Accuracy: 43/496 (8.6694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   4,  Average loss: 0.0411, Accuracy: 99/496 (19.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   5,  Average loss: 0.0347, Accuracy: 118/496 (23.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   6,  Average loss: 0.0336, Accuracy: 164/496 (33.0645%), train_poison_data_count: 40
Global model norm: 174.80408676572753.
Norm before scaling: 173.2205061475113. Distance: 18.072173488262106
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1791.3175318742346, distance: 1807.217474461776
Total norm for 4 adversaries is: 1791.3175318742346. distance: 1807.217474461776
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   1,  Average loss: 0.2042, Accuracy: 86/546 (15.7509%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   2,  Average loss: 0.0542, Accuracy: 57/546 (10.4396%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   3,  Average loss: 0.0476, Accuracy: 133/546 (24.3590%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   4,  Average loss: 0.0432, Accuracy: 146/546 (26.7399%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   5,  Average loss: 0.0375, Accuracy: 143/546 (26.1905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   6,  Average loss: 0.0334, Accuracy: 154/546 (28.2051%), train_poison_data_count: 45
Global model norm: 174.80408676572753.
Norm before scaling: 172.86227809299518. Distance: 16.79003948850004
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1659.4908857839503, distance: 1679.0038713475321
Total norm for 4 adversaries is: 1659.4908857839503. distance: 1679.0038713475321
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 245, local model 74, internal_epoch   1,  Average loss: 0.2095, Accuracy: 53/469 (11.3006%)
___Train Local_ResNet_18,  epoch 245, local model 74, internal_epoch   2,  Average loss: 0.0494, Accuracy: 72/469 (15.3518%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 245, local model 85, internal_epoch   1,  Average loss: 0.2139, Accuracy: 74/364 (20.3297%)
___Train Local_ResNet_18,  epoch 245, local model 85, internal_epoch   2,  Average loss: 0.0511, Accuracy: 35/364 (9.6154%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 245, local model 2, internal_epoch   1,  Average loss: 0.1332, Accuracy: 217/461 (47.0716%)
___Train Local_ResNet_18,  epoch 245, local model 2, internal_epoch   2,  Average loss: 0.0422, Accuracy: 245/461 (53.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 245, local model 99, internal_epoch   1,  Average loss: 0.2529, Accuracy: 35/391 (8.9514%)
___Train Local_ResNet_18,  epoch 245, local model 99, internal_epoch   2,  Average loss: 0.0644, Accuracy: 50/391 (12.7877%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 245, local model 35, internal_epoch   1,  Average loss: 0.2185, Accuracy: 19/419 (4.5346%)
___Train Local_ResNet_18,  epoch 245, local model 35, internal_epoch   2,  Average loss: 0.0440, Accuracy: 70/419 (16.7064%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 245, local model 70, internal_epoch   1,  Average loss: 0.1373, Accuracy: 17/610 (2.7869%)
___Train Local_ResNet_18,  epoch 245, local model 70, internal_epoch   2,  Average loss: 0.0340, Accuracy: 215/610 (35.2459%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 198.55840516090393
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 245: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 247.47766661643982 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:246 choose agents : [17, 33, 77, 11, 88, 50, 86, 60, 41, 79]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   1,  Average loss: 0.2069, Accuracy: 101/526 (19.2015%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   2,  Average loss: 0.0800, Accuracy: 110/526 (20.9125%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   3,  Average loss: 0.0488, Accuracy: 112/526 (21.2928%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   4,  Average loss: 0.0385, Accuracy: 128/526 (24.3346%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   5,  Average loss: 0.0339, Accuracy: 168/526 (31.9392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   6,  Average loss: 0.0327, Accuracy: 165/526 (31.3688%), train_poison_data_count: 45
Global model norm: 179.19732053660846.
Norm before scaling: 176.8962884715222. Distance: 11.247121824209662
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1096.586122928792, distance: 1124.7122409754418
Total norm for 4 adversaries is: 1096.586122928792. distance: 1124.7122409754418
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   1,  Average loss: 0.1460, Accuracy: 112/527 (21.2524%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   2,  Average loss: 0.0851, Accuracy: 108/527 (20.4934%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   3,  Average loss: 0.0460, Accuracy: 145/527 (27.5142%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   4,  Average loss: 0.0366, Accuracy: 152/527 (28.8425%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   5,  Average loss: 0.0343, Accuracy: 129/527 (24.4782%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   6,  Average loss: 0.0326, Accuracy: 159/527 (30.1708%), train_poison_data_count: 45
Global model norm: 179.19732053660846.
Norm before scaling: 176.92524131854393. Distance: 8.691608582616798
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 836.1123952555661, distance: 869.1608021534336
Total norm for 4 adversaries is: 836.1123952555661. distance: 869.1608021534336
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   1,  Average loss: 0.1745, Accuracy: 81/496 (16.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   2,  Average loss: 0.0948, Accuracy: 138/496 (27.8226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   3,  Average loss: 0.0537, Accuracy: 92/496 (18.5484%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   4,  Average loss: 0.0428, Accuracy: 96/496 (19.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   5,  Average loss: 0.0368, Accuracy: 164/496 (33.0645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   6,  Average loss: 0.0348, Accuracy: 130/496 (26.2097%), train_poison_data_count: 40
Global model norm: 179.19732053660846.
Norm before scaling: 177.1628124335776. Distance: 10.695370637054372
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1045.026494879436, distance: 1069.5370493816472
Total norm for 4 adversaries is: 1045.026494879436. distance: 1069.5370493816472
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   1,  Average loss: 0.1801, Accuracy: 90/546 (16.4835%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   2,  Average loss: 0.1053, Accuracy: 128/546 (23.4432%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   3,  Average loss: 0.0586, Accuracy: 86/546 (15.7509%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   4,  Average loss: 0.0431, Accuracy: 108/546 (19.7802%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   5,  Average loss: 0.0359, Accuracy: 142/546 (26.0073%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   6,  Average loss: 0.0335, Accuracy: 137/546 (25.0916%), train_poison_data_count: 45
Global model norm: 179.19732053660846.
Norm before scaling: 176.8369382634041. Distance: 11.131986674414227
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1083.9248705514603, distance: 1113.198713168498
Total norm for 4 adversaries is: 1083.9248705514603. distance: 1113.198713168498
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 246, local model 88, internal_epoch   1,  Average loss: 0.1692, Accuracy: 136/447 (30.4251%)
___Train Local_ResNet_18,  epoch 246, local model 88, internal_epoch   2,  Average loss: 0.0867, Accuracy: 168/447 (37.5839%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 246, local model 50, internal_epoch   1,  Average loss: 0.1394, Accuracy: 126/401 (31.4214%)
___Train Local_ResNet_18,  epoch 246, local model 50, internal_epoch   2,  Average loss: 0.0772, Accuracy: 162/401 (40.3990%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 246, local model 86, internal_epoch   1,  Average loss: 0.1858, Accuracy: 37/212 (17.4528%)
___Train Local_ResNet_18,  epoch 246, local model 86, internal_epoch   2,  Average loss: 0.0997, Accuracy: 42/212 (19.8113%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 246, local model 60, internal_epoch   1,  Average loss: 0.2930, Accuracy: 12/284 (4.2254%)
___Train Local_ResNet_18,  epoch 246, local model 60, internal_epoch   2,  Average loss: 0.1410, Accuracy: 30/284 (10.5634%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 246, local model 41, internal_epoch   1,  Average loss: 0.1105, Accuracy: 184/513 (35.8674%)
___Train Local_ResNet_18,  epoch 246, local model 41, internal_epoch   2,  Average loss: 0.0554, Accuracy: 280/513 (54.5809%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 246, local model 79, internal_epoch   1,  Average loss: 0.2663, Accuracy: 31/154 (20.1299%)
___Train Local_ResNet_18,  epoch 246, local model 79, internal_epoch   2,  Average loss: 0.1147, Accuracy: 37/154 (24.0260%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 197.71768260002136
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 246: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 248.1141917705536 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:247 choose agents : [17, 33, 77, 11, 76, 67, 9, 40, 72, 44]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   1,  Average loss: 0.0699, Accuracy: 115/526 (21.8631%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   2,  Average loss: 0.0472, Accuracy: 64/526 (12.1673%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   3,  Average loss: 0.0393, Accuracy: 140/526 (26.6160%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   4,  Average loss: 0.0360, Accuracy: 139/526 (26.4259%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   5,  Average loss: 0.0348, Accuracy: 149/526 (28.3270%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   6,  Average loss: 0.0335, Accuracy: 162/526 (30.7985%), train_poison_data_count: 45
Global model norm: 173.4466326424356.
Norm before scaling: 171.4416753501756. Distance: 6.195884187545674
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 583.9402259649527, distance: 619.588421857607
Total norm for 4 adversaries is: 583.9402259649527. distance: 619.588421857607
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   1,  Average loss: 0.0912, Accuracy: 16/527 (3.0361%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   2,  Average loss: 0.0586, Accuracy: 58/527 (11.0057%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   3,  Average loss: 0.0465, Accuracy: 158/527 (29.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   4,  Average loss: 0.0385, Accuracy: 151/527 (28.6528%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   5,  Average loss: 0.0361, Accuracy: 155/527 (29.4118%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   6,  Average loss: 0.0344, Accuracy: 156/527 (29.6015%), train_poison_data_count: 45
Global model norm: 173.4466326424356.
Norm before scaling: 171.41450811920794. Distance: 7.807721194683264
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 750.6747797814977, distance: 780.7721338521246
Total norm for 4 adversaries is: 750.6747797814977. distance: 780.7721338521246
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   1,  Average loss: 0.0813, Accuracy: 52/496 (10.4839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   2,  Average loss: 0.0555, Accuracy: 106/496 (21.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   3,  Average loss: 0.0425, Accuracy: 78/496 (15.7258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   4,  Average loss: 0.0382, Accuracy: 73/496 (14.7177%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   5,  Average loss: 0.0348, Accuracy: 94/496 (18.9516%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   6,  Average loss: 0.0338, Accuracy: 118/496 (23.7903%), train_poison_data_count: 40
Global model norm: 173.4466326424356.
Norm before scaling: 171.68547505176434. Distance: 7.131542748770357
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 687.6073098069857, distance: 713.1542610123003
Total norm for 4 adversaries is: 687.6073098069857. distance: 713.1542610123003
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   1,  Average loss: 0.0782, Accuracy: 59/546 (10.8059%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   2,  Average loss: 0.0486, Accuracy: 63/546 (11.5385%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   3,  Average loss: 0.0387, Accuracy: 105/546 (19.2308%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   4,  Average loss: 0.0357, Accuracy: 137/546 (25.0916%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   5,  Average loss: 0.0350, Accuracy: 107/546 (19.5971%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   6,  Average loss: 0.0339, Accuracy: 144/546 (26.3736%), train_poison_data_count: 45
Global model norm: 173.4466326424356.
Norm before scaling: 171.44819735126993. Distance: 6.915650473098279
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 659.2713307129319, distance: 691.5650276727417
Total norm for 4 adversaries is: 659.2713307129319. distance: 691.5650276727417
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 247, local model 76, internal_epoch   1,  Average loss: 0.1298, Accuracy: 16/65 (24.6154%)
___Train Local_ResNet_18,  epoch 247, local model 76, internal_epoch   2,  Average loss: 0.1241, Accuracy: 16/65 (24.6154%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 247, local model 67, internal_epoch   1,  Average loss: 0.0654, Accuracy: 117/842 (13.8955%)
___Train Local_ResNet_18,  epoch 247, local model 67, internal_epoch   2,  Average loss: 0.0333, Accuracy: 215/842 (25.5344%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 247, local model 9, internal_epoch   1,  Average loss: 0.0727, Accuracy: 42/368 (11.4130%)
___Train Local_ResNet_18,  epoch 247, local model 9, internal_epoch   2,  Average loss: 0.0391, Accuracy: 121/368 (32.8804%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 247, local model 40, internal_epoch   1,  Average loss: 0.0578, Accuracy: 68/652 (10.4294%)
___Train Local_ResNet_18,  epoch 247, local model 40, internal_epoch   2,  Average loss: 0.0338, Accuracy: 329/652 (50.4601%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 247, local model 72, internal_epoch   1,  Average loss: 0.0544, Accuracy: 136/618 (22.0065%)
___Train Local_ResNet_18,  epoch 247, local model 72, internal_epoch   2,  Average loss: 0.0289, Accuracy: 310/618 (50.1618%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 247, local model 44, internal_epoch   1,  Average loss: 0.0596, Accuracy: 38/436 (8.7156%)
___Train Local_ResNet_18,  epoch 247, local model 44, internal_epoch   2,  Average loss: 0.0371, Accuracy: 163/436 (37.3853%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 206.98695707321167
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 247: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 256.57457089424133 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:248 choose agents : [17, 33, 77, 11, 46, 96, 54, 39, 67, 82]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   1,  Average loss: 0.1154, Accuracy: 50/526 (9.5057%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   2,  Average loss: 0.0835, Accuracy: 72/526 (13.6882%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   3,  Average loss: 0.0666, Accuracy: 142/526 (26.9962%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   4,  Average loss: 0.0474, Accuracy: 145/526 (27.5665%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   5,  Average loss: 0.0383, Accuracy: 156/526 (29.6578%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   6,  Average loss: 0.0342, Accuracy: 151/526 (28.7072%), train_poison_data_count: 45
Global model norm: 166.9965498333723.
Norm before scaling: 164.937109226517. Distance: 7.864553637585354
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 756.2109080805434, distance: 786.4553388463963
Total norm for 4 adversaries is: 756.2109080805434. distance: 786.4553388463963
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   1,  Average loss: 0.0612, Accuracy: 162/527 (30.7400%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   2,  Average loss: 0.0479, Accuracy: 156/527 (29.6015%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   3,  Average loss: 0.0461, Accuracy: 94/527 (17.8368%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   4,  Average loss: 0.0411, Accuracy: 134/527 (25.4269%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   5,  Average loss: 0.0368, Accuracy: 162/527 (30.7400%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   6,  Average loss: 0.0346, Accuracy: 148/527 (28.0835%), train_poison_data_count: 45
Global model norm: 166.9965498333723.
Norm before scaling: 165.02067815504213. Distance: 5.03042785371975
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 461.30988771106996, distance: 503.04277278378623
Total norm for 4 adversaries is: 461.30988771106996. distance: 503.04277278378623
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   1,  Average loss: 0.0832, Accuracy: 65/496 (13.1048%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   2,  Average loss: 0.0606, Accuracy: 96/496 (19.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   3,  Average loss: 0.0539, Accuracy: 95/496 (19.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   4,  Average loss: 0.0474, Accuracy: 81/496 (16.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   5,  Average loss: 0.0441, Accuracy: 106/496 (21.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   6,  Average loss: 0.0410, Accuracy: 54/496 (10.8871%), train_poison_data_count: 40
Global model norm: 166.9965498333723.
Norm before scaling: 165.2134568614948. Distance: 5.572031491532236
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 525.3783458137574, distance: 557.2031721015235
Total norm for 4 adversaries is: 525.3783458137574. distance: 557.2031721015235
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   1,  Average loss: 0.0809, Accuracy: 56/546 (10.2564%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   2,  Average loss: 0.0575, Accuracy: 115/546 (21.0623%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   3,  Average loss: 0.0532, Accuracy: 160/546 (29.3040%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   4,  Average loss: 0.0485, Accuracy: 169/546 (30.9524%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   5,  Average loss: 0.0438, Accuracy: 155/546 (28.3883%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   6,  Average loss: 0.0412, Accuracy: 133/546 (24.3590%), train_poison_data_count: 45
Global model norm: 166.9965498333723.
Norm before scaling: 164.95104032143902. Distance: 5.886246974293791
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 550.4559757600965, distance: 588.6246947334099
Total norm for 4 adversaries is: 550.4559757600965. distance: 588.6246947334099
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 248, local model 46, internal_epoch   1,  Average loss: 0.0658, Accuracy: 25/601 (4.1597%)
___Train Local_ResNet_18,  epoch 248, local model 46, internal_epoch   2,  Average loss: 0.0383, Accuracy: 125/601 (20.7987%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 248, local model 96, internal_epoch   1,  Average loss: 0.0701, Accuracy: 152/708 (21.4689%)
___Train Local_ResNet_18,  epoch 248, local model 96, internal_epoch   2,  Average loss: 0.0491, Accuracy: 172/708 (24.2938%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 248, local model 54, internal_epoch   1,  Average loss: 0.1188, Accuracy: 14/440 (3.1818%)
___Train Local_ResNet_18,  epoch 248, local model 54, internal_epoch   2,  Average loss: 0.0795, Accuracy: 120/440 (27.2727%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 248, local model 39, internal_epoch   1,  Average loss: 0.1232, Accuracy: 47/217 (21.6590%)
___Train Local_ResNet_18,  epoch 248, local model 39, internal_epoch   2,  Average loss: 0.0959, Accuracy: 47/217 (21.6590%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 248, local model 67, internal_epoch   1,  Average loss: 0.0621, Accuracy: 104/842 (12.3515%)
___Train Local_ResNet_18,  epoch 248, local model 67, internal_epoch   2,  Average loss: 0.0367, Accuracy: 167/842 (19.8337%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 248, local model 82, internal_epoch   1,  Average loss: 0.0717, Accuracy: 45/601 (7.4875%)
___Train Local_ResNet_18,  epoch 248, local model 82, internal_epoch   2,  Average loss: 0.0476, Accuracy: 226/601 (37.6040%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 204.68926858901978
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 248: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 257.18269634246826 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:249 choose agents : [17, 33, 77, 11, 21, 80, 91, 23, 65, 69]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   1,  Average loss: 0.1973, Accuracy: 82/526 (15.5894%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   2,  Average loss: 0.0627, Accuracy: 149/526 (28.3270%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   3,  Average loss: 0.0527, Accuracy: 146/526 (27.7567%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   4,  Average loss: 0.0456, Accuracy: 136/526 (25.8555%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   5,  Average loss: 0.0405, Accuracy: 135/526 (25.6654%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   6,  Average loss: 0.0375, Accuracy: 143/526 (27.1863%), train_poison_data_count: 45
Global model norm: 160.0364155336997.
Norm before scaling: 158.12520380421648. Distance: 15.956084063840468
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1576.4867585869538, distance: 1595.6084262750683
Total norm for 4 adversaries is: 1576.4867585869538. distance: 1595.6084262750683
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   1,  Average loss: 0.2639, Accuracy: 33/527 (6.2619%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   2,  Average loss: 0.0705, Accuracy: 69/527 (13.0930%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   3,  Average loss: 0.0557, Accuracy: 68/527 (12.9032%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   4,  Average loss: 0.0465, Accuracy: 92/527 (17.4573%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   5,  Average loss: 0.0392, Accuracy: 100/527 (18.9753%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   6,  Average loss: 0.0343, Accuracy: 124/527 (23.5294%), train_poison_data_count: 45
Global model norm: 160.0364155336997.
Norm before scaling: 158.45362343995166. Distance: 21.409555800853127
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2124.3952080533413, distance: 2140.95551098102
Total norm for 4 adversaries is: 2124.3952080533413. distance: 2140.95551098102
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   1,  Average loss: 0.2353, Accuracy: 73/496 (14.7177%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   2,  Average loss: 0.0644, Accuracy: 52/496 (10.4839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   3,  Average loss: 0.0537, Accuracy: 70/496 (14.1129%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   4,  Average loss: 0.0459, Accuracy: 94/496 (18.9516%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   5,  Average loss: 0.0421, Accuracy: 86/496 (17.3387%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   6,  Average loss: 0.0388, Accuracy: 87/496 (17.5403%), train_poison_data_count: 40
Global model norm: 160.0364155336997.
Norm before scaling: 158.46623876436584. Distance: 17.908866757696362
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1775.0502809779784, distance: 1790.8867915086091
Total norm for 4 adversaries is: 1775.0502809779784. distance: 1790.8867915086091
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   1,  Average loss: 0.2186, Accuracy: 41/546 (7.5092%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   2,  Average loss: 0.0561, Accuracy: 69/546 (12.6374%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   3,  Average loss: 0.0457, Accuracy: 77/546 (14.1026%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   4,  Average loss: 0.0411, Accuracy: 145/546 (26.5568%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   5,  Average loss: 0.0407, Accuracy: 148/546 (27.1062%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   6,  Average loss: 0.0395, Accuracy: 141/546 (25.8242%), train_poison_data_count: 45
Global model norm: 160.0364155336997.
Norm before scaling: 158.28004997077176. Distance: 18.072051060712937
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1789.7022098662112, distance: 1807.2051626752288
Total norm for 4 adversaries is: 1789.7022098662112. distance: 1807.2051626752288
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 249, local model 21, internal_epoch   1,  Average loss: 0.3113, Accuracy: 3/262 (1.1450%)
___Train Local_ResNet_18,  epoch 249, local model 21, internal_epoch   2,  Average loss: 0.0615, Accuracy: 50/262 (19.0840%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 249, local model 80, internal_epoch   1,  Average loss: 0.1377, Accuracy: 125/363 (34.4353%)
___Train Local_ResNet_18,  epoch 249, local model 80, internal_epoch   2,  Average loss: 0.0617, Accuracy: 75/363 (20.6612%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 249, local model 91, internal_epoch   1,  Average loss: 0.2349, Accuracy: 20/234 (8.5470%)
___Train Local_ResNet_18,  epoch 249, local model 91, internal_epoch   2,  Average loss: 0.0816, Accuracy: 39/234 (16.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 249, local model 23, internal_epoch   1,  Average loss: 0.3387, Accuracy: 0/248 (0.0000%)
___Train Local_ResNet_18,  epoch 249, local model 23, internal_epoch   2,  Average loss: 0.0773, Accuracy: 3/248 (1.2097%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 249, local model 65, internal_epoch   1,  Average loss: 0.2482, Accuracy: 5/314 (1.5924%)
___Train Local_ResNet_18,  epoch 249, local model 65, internal_epoch   2,  Average loss: 0.0640, Accuracy: 6/314 (1.9108%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 249, local model 69, internal_epoch   1,  Average loss: 0.3904, Accuracy: 6/216 (2.7778%)
___Train Local_ResNet_18,  epoch 249, local model 69, internal_epoch   2,  Average loss: 0.0812, Accuracy: 21/216 (9.7222%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 202.85783553123474
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 249: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 252.73219847679138 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:250 choose agents : [17, 33, 77, 11, 44, 38, 93, 2, 16, 36]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   1,  Average loss: 0.1566, Accuracy: 51/526 (9.6958%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   2,  Average loss: 0.1169, Accuracy: 55/526 (10.4563%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   3,  Average loss: 0.0823, Accuracy: 47/526 (8.9354%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   4,  Average loss: 0.0699, Accuracy: 67/526 (12.7376%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   5,  Average loss: 0.0623, Accuracy: 137/526 (26.0456%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   6,  Average loss: 0.0557, Accuracy: 149/526 (28.3270%), train_poison_data_count: 45
Global model norm: 165.49904998783225.
Norm before scaling: 163.21026267900558. Distance: 10.975419758131691
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1069.9101013636614, distance: 1097.5419695847627
Total norm for 4 adversaries is: 1069.9101013636614. distance: 1097.5419695847627
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   1,  Average loss: 0.1188, Accuracy: 160/527 (30.3605%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   2,  Average loss: 0.0933, Accuracy: 164/527 (31.1195%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   3,  Average loss: 0.0786, Accuracy: 160/527 (30.3605%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   4,  Average loss: 0.0705, Accuracy: 98/527 (18.5958%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   5,  Average loss: 0.0657, Accuracy: 92/527 (17.4573%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   6,  Average loss: 0.0614, Accuracy: 163/527 (30.9298%), train_poison_data_count: 45
Global model norm: 165.49904998783225.
Norm before scaling: 163.21081315663494. Distance: 7.881408989896135
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 753.0789301261854, distance: 788.1408900063491
Total norm for 4 adversaries is: 753.0789301261854. distance: 788.1408900063491
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   1,  Average loss: 0.1335, Accuracy: 69/496 (13.9113%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   2,  Average loss: 0.1080, Accuracy: 66/496 (13.3065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   3,  Average loss: 0.0819, Accuracy: 82/496 (16.5323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   4,  Average loss: 0.0725, Accuracy: 93/496 (18.7500%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   5,  Average loss: 0.0654, Accuracy: 97/496 (19.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   6,  Average loss: 0.0617, Accuracy: 89/496 (17.9435%), train_poison_data_count: 40
Global model norm: 165.49904998783225.
Norm before scaling: 163.46752233815437. Distance: 9.038241626917426
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 877.0909659208673, distance: 903.8242016564947
Total norm for 4 adversaries is: 877.0909659208673. distance: 903.8242016564947
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   1,  Average loss: 0.1388, Accuracy: 53/546 (9.7070%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   2,  Average loss: 0.1016, Accuracy: 57/546 (10.4396%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   3,  Average loss: 0.0774, Accuracy: 120/546 (21.9780%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   4,  Average loss: 0.0699, Accuracy: 144/546 (26.3736%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   5,  Average loss: 0.0648, Accuracy: 144/546 (26.3736%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   6,  Average loss: 0.0600, Accuracy: 120/546 (21.9780%), train_poison_data_count: 45
Global model norm: 165.49904998783225.
Norm before scaling: 163.19572820121547. Distance: 9.325774901564397
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 901.49032856709, distance: 932.5775436927483
Total norm for 4 adversaries is: 901.49032856709. distance: 932.5775436927483
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 250, local model 44, internal_epoch   1,  Average loss: 0.1218, Accuracy: 16/436 (3.6697%)
___Train Local_ResNet_18,  epoch 250, local model 44, internal_epoch   2,  Average loss: 0.0700, Accuracy: 14/436 (3.2110%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 250, local model 38, internal_epoch   1,  Average loss: 0.1392, Accuracy: 13/756 (1.7196%)
___Train Local_ResNet_18,  epoch 250, local model 38, internal_epoch   2,  Average loss: 0.0738, Accuracy: 204/756 (26.9841%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 250, local model 93, internal_epoch   1,  Average loss: 0.1394, Accuracy: 59/584 (10.1027%)
___Train Local_ResNet_18,  epoch 250, local model 93, internal_epoch   2,  Average loss: 0.0833, Accuracy: 89/584 (15.2397%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 250, local model 2, internal_epoch   1,  Average loss: 0.1167, Accuracy: 67/461 (14.5336%)
___Train Local_ResNet_18,  epoch 250, local model 2, internal_epoch   2,  Average loss: 0.0603, Accuracy: 114/461 (24.7289%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 250, local model 16, internal_epoch   1,  Average loss: 0.1342, Accuracy: 25/773 (3.2342%)
___Train Local_ResNet_18,  epoch 250, local model 16, internal_epoch   2,  Average loss: 0.0813, Accuracy: 249/773 (32.2122%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 250, local model 36, internal_epoch   1,  Average loss: 0.1386, Accuracy: 155/849 (18.2568%)
___Train Local_ResNet_18,  epoch 250, local model 36, internal_epoch   2,  Average loss: 0.0840, Accuracy: 124/849 (14.6054%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 206.28225564956665
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 250: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 256.9506690502167 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:251 choose agents : [17, 33, 77, 11, 36, 26, 95, 49, 48, 27]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   1,  Average loss: 0.0837, Accuracy: 62/526 (11.7871%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   2,  Average loss: 0.0850, Accuracy: 144/526 (27.3764%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   3,  Average loss: 0.0714, Accuracy: 146/526 (27.7567%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   4,  Average loss: 0.0671, Accuracy: 142/526 (26.9962%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   5,  Average loss: 0.0582, Accuracy: 142/526 (26.9962%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   6,  Average loss: 0.0415, Accuracy: 144/526 (27.3764%), train_poison_data_count: 45
Global model norm: 159.32091606840265.
Norm before scaling: 157.25332245098988. Distance: 6.254340838760914
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 589.2240130035435, distance: 625.4340742636269
Total norm for 4 adversaries is: 589.2240130035435. distance: 625.4340742636269
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   1,  Average loss: 0.1837, Accuracy: 42/527 (7.9696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   2,  Average loss: 0.1474, Accuracy: 68/527 (12.9032%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   3,  Average loss: 0.0799, Accuracy: 105/527 (19.9241%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   4,  Average loss: 0.0514, Accuracy: 84/527 (15.9393%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   5,  Average loss: 0.0433, Accuracy: 121/527 (22.9602%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   6,  Average loss: 0.0411, Accuracy: 107/527 (20.3036%), train_poison_data_count: 45
Global model norm: 159.32091606840265.
Norm before scaling: 157.13749204518317. Distance: 8.127655064990686
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 781.1969181966862, distance: 812.7654950845293
Total norm for 4 adversaries is: 781.1969181966862. distance: 812.7654950845293
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   1,  Average loss: 0.1293, Accuracy: 89/496 (17.9435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   2,  Average loss: 0.1093, Accuracy: 74/496 (14.9194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   3,  Average loss: 0.0851, Accuracy: 92/496 (18.5484%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   4,  Average loss: 0.0667, Accuracy: 91/496 (18.3468%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   5,  Average loss: 0.0539, Accuracy: 106/496 (21.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   6,  Average loss: 0.0383, Accuracy: 87/496 (17.5403%), train_poison_data_count: 40
Global model norm: 159.32091606840265.
Norm before scaling: 157.44824918643903. Distance: 7.254587234964305
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 697.9188706432861, distance: 725.4587341813454
Total norm for 4 adversaries is: 697.9188706432861. distance: 725.4587341813454
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   1,  Average loss: 0.1022, Accuracy: 47/546 (8.6081%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   2,  Average loss: 0.0816, Accuracy: 72/546 (13.1868%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   3,  Average loss: 0.0711, Accuracy: 140/546 (25.6410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   4,  Average loss: 0.0641, Accuracy: 116/546 (21.2454%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   5,  Average loss: 0.0561, Accuracy: 148/546 (27.1062%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   6,  Average loss: 0.0409, Accuracy: 123/546 (22.5275%), train_poison_data_count: 45
Global model norm: 159.32091606840265.
Norm before scaling: 157.247335778305. Distance: 6.525608089948669
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 617.509083941281, distance: 652.5607730319069
Total norm for 4 adversaries is: 617.509083941281. distance: 652.5607730319069
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 251, local model 36, internal_epoch   1,  Average loss: 0.1133, Accuracy: 149/849 (17.5501%)
___Train Local_ResNet_18,  epoch 251, local model 36, internal_epoch   2,  Average loss: 0.0626, Accuracy: 149/849 (17.5501%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 251, local model 26, internal_epoch   1,  Average loss: 0.0851, Accuracy: 178/468 (38.0342%)
___Train Local_ResNet_18,  epoch 251, local model 26, internal_epoch   2,  Average loss: 0.0741, Accuracy: 178/468 (38.0342%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 251, local model 95, internal_epoch   1,  Average loss: 0.0858, Accuracy: 146/569 (25.6591%)
___Train Local_ResNet_18,  epoch 251, local model 95, internal_epoch   2,  Average loss: 0.0610, Accuracy: 223/569 (39.1916%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 251, local model 49, internal_epoch   1,  Average loss: 0.0923, Accuracy: 27/426 (6.3380%)
___Train Local_ResNet_18,  epoch 251, local model 49, internal_epoch   2,  Average loss: 0.0644, Accuracy: 157/426 (36.8545%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 251, local model 48, internal_epoch   1,  Average loss: 0.0912, Accuracy: 65/378 (17.1958%)
___Train Local_ResNet_18,  epoch 251, local model 48, internal_epoch   2,  Average loss: 0.0663, Accuracy: 118/378 (31.2169%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 251, local model 27, internal_epoch   1,  Average loss: 0.0684, Accuracy: 49/397 (12.3426%)
___Train Local_ResNet_18,  epoch 251, local model 27, internal_epoch   2,  Average loss: 0.0548, Accuracy: 123/397 (30.9824%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 210.71759223937988
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 251: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 261.66969776153564 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:252 choose agents : [17, 33, 77, 11, 49, 74, 94, 29, 76, 70]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   1,  Average loss: 1.0439, Accuracy: 41/526 (7.7947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   2,  Average loss: 0.0591, Accuracy: 18/526 (3.4221%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   3,  Average loss: 0.0532, Accuracy: 146/526 (27.7567%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   4,  Average loss: 0.0515, Accuracy: 145/526 (27.5665%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   5,  Average loss: 0.0507, Accuracy: 139/526 (26.4259%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   6,  Average loss: 0.0497, Accuracy: 134/526 (25.4753%), train_poison_data_count: 45
Global model norm: 152.76371281533125.
Norm before scaling: 155.0199331940896. Distance: 51.273434524036176
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 5110.727345495942, distance: 5127.343366695856
Total norm for 4 adversaries is: 5110.727345495942. distance: 5127.343366695856
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   1,  Average loss: 0.8977, Accuracy: 138/527 (26.1860%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   2,  Average loss: 0.0986, Accuracy: 97/527 (18.4061%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   3,  Average loss: 0.0887, Accuracy: 103/527 (19.5446%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   4,  Average loss: 0.0803, Accuracy: 98/527 (18.5958%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   5,  Average loss: 0.0738, Accuracy: 100/527 (18.9753%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   6,  Average loss: 0.0681, Accuracy: 102/527 (19.3548%), train_poison_data_count: 45
Global model norm: 152.76371281533125.
Norm before scaling: 152.97407740978534. Distance: 42.961223772686864
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 4278.068021899605, distance: 4296.122204965776
Total norm for 4 adversaries is: 4278.068021899605. distance: 4296.122204965776
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   1,  Average loss: 1.0413, Accuracy: 36/496 (7.2581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   2,  Average loss: 0.0712, Accuracy: 21/496 (4.2339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   3,  Average loss: 0.0645, Accuracy: 84/496 (16.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   4,  Average loss: 0.0594, Accuracy: 105/496 (21.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   5,  Average loss: 0.0565, Accuracy: 103/496 (20.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   6,  Average loss: 0.0536, Accuracy: 103/496 (20.7661%), train_poison_data_count: 40
Global model norm: 152.76371281533125.
Norm before scaling: 154.66726509066163. Distance: 48.88364593444059
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 4872.269286482429, distance: 4888.364757257788
Total norm for 4 adversaries is: 4872.269286482429. distance: 4888.364757257788
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   1,  Average loss: 0.9890, Accuracy: 100/546 (18.3150%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   2,  Average loss: 0.0544, Accuracy: 145/546 (26.5568%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   3,  Average loss: 0.0533, Accuracy: 148/546 (27.1062%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   4,  Average loss: 0.0511, Accuracy: 148/546 (27.1062%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   5,  Average loss: 0.0509, Accuracy: 146/546 (26.7399%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   6,  Average loss: 0.0498, Accuracy: 146/546 (26.7399%), train_poison_data_count: 45
Global model norm: 152.76371281533125.
Norm before scaling: 155.24434495537994. Distance: 51.95394031315142
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 5178.990442161484, distance: 5195.39411402061
Total norm for 4 adversaries is: 5178.990442161484. distance: 5195.39411402061
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 252, local model 49, internal_epoch   1,  Average loss: 0.9265, Accuracy: 21/426 (4.9296%)
___Train Local_ResNet_18,  epoch 252, local model 49, internal_epoch   2,  Average loss: 0.0490, Accuracy: 134/426 (31.4554%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 252, local model 74, internal_epoch   1,  Average loss: 0.8640, Accuracy: 29/469 (6.1834%)
___Train Local_ResNet_18,  epoch 252, local model 74, internal_epoch   2,  Average loss: 0.0406, Accuracy: 116/469 (24.7335%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 252, local model 94, internal_epoch   1,  Average loss: 1.4109, Accuracy: 69/203 (33.9901%)
___Train Local_ResNet_18,  epoch 252, local model 94, internal_epoch   2,  Average loss: 0.1382, Accuracy: 0/203 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 252, local model 29, internal_epoch   1,  Average loss: 0.4982, Accuracy: 131/848 (15.4481%)
___Train Local_ResNet_18,  epoch 252, local model 29, internal_epoch   2,  Average loss: 0.0300, Accuracy: 386/848 (45.5189%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 252, local model 76, internal_epoch   1,  Average loss: 6.2012, Accuracy: 1/65 (1.5385%)
___Train Local_ResNet_18,  epoch 252, local model 76, internal_epoch   2,  Average loss: 0.1034, Accuracy: 3/65 (4.6154%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 252, local model 70, internal_epoch   1,  Average loss: 0.6155, Accuracy: 53/610 (8.6885%)
___Train Local_ResNet_18,  epoch 252, local model 70, internal_epoch   2,  Average loss: 0.0494, Accuracy: 127/610 (20.8197%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 214.3614330291748
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 252: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 264.674437046051 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:253 choose agents : [17, 33, 77, 11, 99, 76, 10, 58, 65, 75]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   1,  Average loss: 0.0614, Accuracy: 34/526 (6.4639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   2,  Average loss: 0.0536, Accuracy: 88/526 (16.7300%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   3,  Average loss: 0.0486, Accuracy: 146/526 (27.7567%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   4,  Average loss: 0.0480, Accuracy: 140/526 (26.6160%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   5,  Average loss: 0.0444, Accuracy: 143/526 (27.1863%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 17, internal_epoch   6,  Average loss: 0.0409, Accuracy: 136/526 (25.8555%), train_poison_data_count: 45
Global model norm: 233.55116877785048.
Norm before scaling: 230.8124069184757. Distance: 5.635783392161144
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 491.7443123717853, distance: 563.5783275197867
Total norm for 4 adversaries is: 491.7443123717853. distance: 563.5783275197867
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   1,  Average loss: 0.0957, Accuracy: 33/527 (6.2619%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   2,  Average loss: 0.0811, Accuracy: 45/527 (8.5389%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   3,  Average loss: 0.0662, Accuracy: 70/527 (13.2827%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   4,  Average loss: 0.0488, Accuracy: 68/527 (12.9032%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   5,  Average loss: 0.0375, Accuracy: 166/527 (31.4991%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 33, internal_epoch   6,  Average loss: 0.0346, Accuracy: 138/527 (26.1860%), train_poison_data_count: 45
Global model norm: 233.55116877785048.
Norm before scaling: 230.78983777183518. Distance: 8.474711329402272
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 798.3432845587166, distance: 847.4711278267832
Total norm for 4 adversaries is: 798.3432845587166. distance: 847.4711278267832
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   1,  Average loss: 0.0609, Accuracy: 95/496 (19.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   2,  Average loss: 0.0567, Accuracy: 94/496 (18.9516%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   3,  Average loss: 0.0509, Accuracy: 97/496 (19.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   4,  Average loss: 0.0480, Accuracy: 97/496 (19.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   5,  Average loss: 0.0444, Accuracy: 105/496 (21.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 77, internal_epoch   6,  Average loss: 0.0410, Accuracy: 108/496 (21.7742%), train_poison_data_count: 40
Global model norm: 233.55116877785048.
Norm before scaling: 231.1596529592697. Distance: 5.4147614087124145
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 483.3986611741907, distance: 541.4761652187472
Total norm for 4 adversaries is: 483.3986611741907. distance: 541.4761652187472
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   1,  Average loss: 0.0937, Accuracy: 20/546 (3.6630%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   2,  Average loss: 0.0813, Accuracy: 47/546 (8.6081%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   3,  Average loss: 0.0685, Accuracy: 64/546 (11.7216%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   4,  Average loss: 0.0560, Accuracy: 67/546 (12.2711%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   5,  Average loss: 0.0412, Accuracy: 84/546 (15.3846%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 253, local model 11, internal_epoch   6,  Average loss: 0.0352, Accuracy: 148/546 (27.1062%), train_poison_data_count: 45
Global model norm: 233.55116877785048.
Norm before scaling: 230.76726641792158. Distance: 9.0602751006745
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 859.0470374199541, distance: 906.0275244163391
Total norm for 4 adversaries is: 859.0470374199541. distance: 906.0275244163391
___Test Local_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 253, local model 99, internal_epoch   1,  Average loss: 0.0856, Accuracy: 3/391 (0.7673%)
___Train Local_ResNet_18,  epoch 253, local model 99, internal_epoch   2,  Average loss: 0.0690, Accuracy: 62/391 (15.8568%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 253, local model 76, internal_epoch   1,  Average loss: 0.0960, Accuracy: 2/65 (3.0769%)
___Train Local_ResNet_18,  epoch 253, local model 76, internal_epoch   2,  Average loss: 0.1908, Accuracy: 2/65 (3.0769%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 253, local model 10, internal_epoch   1,  Average loss: 0.0868, Accuracy: 77/752 (10.2394%)
___Train Local_ResNet_18,  epoch 253, local model 10, internal_epoch   2,  Average loss: 0.0356, Accuracy: 208/752 (27.6596%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 253, local model 58, internal_epoch   1,  Average loss: 0.0798, Accuracy: 33/234 (14.1026%)
___Train Local_ResNet_18,  epoch 253, local model 58, internal_epoch   2,  Average loss: 0.0727, Accuracy: 45/234 (19.2308%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 253, local model 65, internal_epoch   1,  Average loss: 0.0934, Accuracy: 56/314 (17.8344%)
___Train Local_ResNet_18,  epoch 253, local model 65, internal_epoch   2,  Average loss: 0.0820, Accuracy: 56/314 (17.8344%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 253, local model 75, internal_epoch   1,  Average loss: 0.0629, Accuracy: 72/578 (12.4567%)
___Train Local_ResNet_18,  epoch 253, local model 75, internal_epoch   2,  Average loss: 0.0514, Accuracy: 236/578 (40.8304%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 220.1216380596161
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 253: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 253: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 274.8016719818115 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:254 choose agents : [17, 33, 77, 11, 48, 64, 16, 97, 52, 24]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   1,  Average loss: 0.2102, Accuracy: 42/526 (7.9848%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   2,  Average loss: 0.1243, Accuracy: 54/526 (10.2662%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   3,  Average loss: 0.0939, Accuracy: 31/526 (5.8935%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   4,  Average loss: 0.0737, Accuracy: 32/526 (6.0837%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   5,  Average loss: 0.0582, Accuracy: 40/526 (7.6046%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 17, internal_epoch   6,  Average loss: 0.0527, Accuracy: 133/526 (25.2852%), train_poison_data_count: 45
Global model norm: 223.79297771601324.
Norm before scaling: 221.01370680061905. Distance: 15.39257899239466
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1507.342031524365, distance: 1539.2578568907809
Total norm for 4 adversaries is: 1507.342031524365. distance: 1539.2578568907809
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   1,  Average loss: 0.1345, Accuracy: 142/527 (26.9450%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   2,  Average loss: 0.0872, Accuracy: 161/527 (30.5503%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   3,  Average loss: 0.0710, Accuracy: 128/527 (24.2884%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   4,  Average loss: 0.0637, Accuracy: 113/527 (21.4421%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   5,  Average loss: 0.0603, Accuracy: 158/527 (29.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 33, internal_epoch   6,  Average loss: 0.0538, Accuracy: 158/527 (29.9810%), train_poison_data_count: 45
Global model norm: 223.79297771601324.
Norm before scaling: 221.0161811808131. Distance: 10.84210526803104
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1044.1865254828756, distance: 1084.2105422841082
Total norm for 4 adversaries is: 1044.1865254828756. distance: 1084.2105422841082
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   1,  Average loss: 0.2015, Accuracy: 55/496 (11.0887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   2,  Average loss: 0.1264, Accuracy: 68/496 (13.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   3,  Average loss: 0.1040, Accuracy: 49/496 (9.8790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   4,  Average loss: 0.0875, Accuracy: 74/496 (14.9194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   5,  Average loss: 0.0802, Accuracy: 104/496 (20.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 77, internal_epoch   6,  Average loss: 0.0719, Accuracy: 101/496 (20.3629%), train_poison_data_count: 40
Global model norm: 223.79297771601324.
Norm before scaling: 221.27200632084032. Distance: 13.577151773953503
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1327.7197087488007, distance: 1357.7150842500057
Total norm for 4 adversaries is: 1327.7197087488007. distance: 1357.7150842500057
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 11, internal_epoch   1,  Average loss: 0.1301, Accuracy: 94/546 (17.2161%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 11, internal_epoch   2,  Average loss: 0.0803, Accuracy: 100/546 (18.3150%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 11, internal_epoch   3,  Average loss: 0.0688, Accuracy: 159/546 (29.1209%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 11, internal_epoch   4,  Average loss: 0.0588, Accuracy: 173/546 (31.6850%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 11, internal_epoch   5,  Average loss: 0.0518, Accuracy: 162/546 (29.6703%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 254, local model 11, internal_epoch   6,  Average loss: 0.0424, Accuracy: 165/546 (30.2198%), train_poison_data_count: 45
Global model norm: 223.79297771601324.
Norm before scaling: 221.06363089900157. Distance: 11.31875016177181
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1094.0731236987772, distance: 1131.8750483158465
Total norm for 4 adversaries is: 1094.0731236987772. distance: 1131.8750483158465
___Test Local_ResNet_18 poisoned: True, epoch: 254: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 254, local model 48, internal_epoch   1,  Average loss: 0.1592, Accuracy: 21/378 (5.5556%)
___Train Local_ResNet_18,  epoch 254, local model 48, internal_epoch   2,  Average loss: 0.0851, Accuracy: 64/378 (16.9312%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 254, local model 64, internal_epoch   1,  Average loss: 0.1934, Accuracy: 8/686 (1.1662%)
___Train Local_ResNet_18,  epoch 254, local model 64, internal_epoch   2,  Average loss: 0.0931, Accuracy: 69/686 (10.0583%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 254, local model 16, internal_epoch   1,  Average loss: 0.1108, Accuracy: 92/773 (11.9017%)
___Train Local_ResNet_18,  epoch 254, local model 16, internal_epoch   2,  Average loss: 0.0502, Accuracy: 320/773 (41.3972%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 254, local model 97, internal_epoch   1,  Average loss: 0.1900, Accuracy: 14/418 (3.3493%)
___Train Local_ResNet_18,  epoch 254, local model 97, internal_epoch   2,  Average loss: 0.1025, Accuracy: 33/418 (7.8947%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 254, local model 52, internal_epoch   1,  Average loss: 0.2474, Accuracy: 4/214 (1.8692%)
___Train Local_ResNet_18,  epoch 254, local model 52, internal_epoch   2,  Average loss: 0.1309, Accuracy: 0/214 (0.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 254, local model 24, internal_epoch   1,  Average loss: 0.1569, Accuracy: 10/320 (3.1250%)
___Train Local_ResNet_18,  epoch 254, local model 24, internal_epoch   2,  Average loss: 0.0798, Accuracy: 57/320 (17.8125%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 210.8130078315735
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 254: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 254: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 267.5068197250366 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:255 choose agents : [17, 33, 77, 11, 10, 34, 27, 49, 56, 48]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 17, internal_epoch   1,  Average loss: 0.1360, Accuracy: 141/526 (26.8061%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 17, internal_epoch   2,  Average loss: 0.0894, Accuracy: 141/526 (26.8061%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 17, internal_epoch   3,  Average loss: 0.0771, Accuracy: 134/526 (25.4753%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 17, internal_epoch   4,  Average loss: 0.0717, Accuracy: 145/526 (27.5665%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 17, internal_epoch   5,  Average loss: 0.0657, Accuracy: 156/526 (29.6578%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 17, internal_epoch   6,  Average loss: 0.0607, Accuracy: 154/526 (29.2776%), train_poison_data_count: 45
Global model norm: 216.83874877140846.
Norm before scaling: 214.11476551723376. Distance: 10.028050182678017
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 255: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 961.8679093305899, distance: 1002.805096965507
Total norm for 4 adversaries is: 961.8679093305899. distance: 1002.805096965507
___Test Local_ResNet_18 poisoned: True, epoch: 255: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 33, internal_epoch   1,  Average loss: 0.2588, Accuracy: 52/527 (9.8672%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 33, internal_epoch   2,  Average loss: 0.1618, Accuracy: 51/527 (9.6774%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 33, internal_epoch   3,  Average loss: 0.1315, Accuracy: 46/527 (8.7287%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 33, internal_epoch   4,  Average loss: 0.0732, Accuracy: 84/527 (15.9393%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 33, internal_epoch   5,  Average loss: 0.0420, Accuracy: 114/527 (21.6319%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 33, internal_epoch   6,  Average loss: 0.0373, Accuracy: 103/527 (19.5446%), train_poison_data_count: 45
Global model norm: 216.83874877140846.
Norm before scaling: 214.07835707691237. Distance: 14.637920703917606
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 255: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1431.5478511038323, distance: 1463.7920788144743
Total norm for 4 adversaries is: 1431.5478511038323. distance: 1463.7920788144743
___Test Local_ResNet_18 poisoned: True, epoch: 255: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 77, internal_epoch   1,  Average loss: 0.1759, Accuracy: 42/496 (8.4677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 77, internal_epoch   2,  Average loss: 0.1004, Accuracy: 45/496 (9.0726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 77, internal_epoch   3,  Average loss: 0.0855, Accuracy: 103/496 (20.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 77, internal_epoch   4,  Average loss: 0.0747, Accuracy: 100/496 (20.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 77, internal_epoch   5,  Average loss: 0.0690, Accuracy: 99/496 (19.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 77, internal_epoch   6,  Average loss: 0.0651, Accuracy: 109/496 (21.9758%), train_poison_data_count: 40
Global model norm: 216.83874877140846.
Norm before scaling: 214.50058274979114. Distance: 12.254898026289963
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 255: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1197.0679805257512, distance: 1225.4898000391518
Total norm for 4 adversaries is: 1197.0679805257512. distance: 1225.4898000391518
___Test Local_ResNet_18 poisoned: True, epoch: 255: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 11, internal_epoch   1,  Average loss: 0.2141, Accuracy: 49/546 (8.9744%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 11, internal_epoch   2,  Average loss: 0.1389, Accuracy: 67/546 (12.2711%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 11, internal_epoch   3,  Average loss: 0.1187, Accuracy: 50/546 (9.1575%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 11, internal_epoch   4,  Average loss: 0.0987, Accuracy: 63/546 (11.5385%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 11, internal_epoch   5,  Average loss: 0.0764, Accuracy: 47/546 (8.6081%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 255, local model 11, internal_epoch   6,  Average loss: 0.0589, Accuracy: 85/546 (15.5678%), train_poison_data_count: 45
Global model norm: 216.83874877140846.
Norm before scaling: 214.01588908595082. Distance: 14.708738903185083
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 255: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1437.7864062509425, distance: 1470.8738899035498
Total norm for 4 adversaries is: 1437.7864062509425. distance: 1470.8738899035498
___Test Local_ResNet_18 poisoned: True, epoch: 255: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 255, local model 10, internal_epoch   1,  Average loss: 0.1299, Accuracy: 49/752 (6.5160%)
___Train Local_ResNet_18,  epoch 255, local model 10, internal_epoch   2,  Average loss: 0.0368, Accuracy: 316/752 (42.0213%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 255, local model 34, internal_epoch   1,  Average loss: 0.2533, Accuracy: 50/349 (14.3266%)
___Train Local_ResNet_18,  epoch 255, local model 34, internal_epoch   2,  Average loss: 0.1617, Accuracy: 74/349 (21.2034%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 255, local model 27, internal_epoch   1,  Average loss: 0.1418, Accuracy: 104/397 (26.1965%)
___Train Local_ResNet_18,  epoch 255, local model 27, internal_epoch   2,  Average loss: 0.0878, Accuracy: 85/397 (21.4106%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 255, local model 49, internal_epoch   1,  Average loss: 0.1762, Accuracy: 31/426 (7.2770%)
___Train Local_ResNet_18,  epoch 255, local model 49, internal_epoch   2,  Average loss: 0.0842, Accuracy: 88/426 (20.6573%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 255, local model 56, internal_epoch   1,  Average loss: 0.1674, Accuracy: 97/743 (13.0552%)
___Train Local_ResNet_18,  epoch 255, local model 56, internal_epoch   2,  Average loss: 0.0926, Accuracy: 86/743 (11.5747%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 255, local model 48, internal_epoch   1,  Average loss: 0.1739, Accuracy: 16/378 (4.2328%)
___Train Local_ResNet_18,  epoch 255, local model 48, internal_epoch   2,  Average loss: 0.0859, Accuracy: 44/378 (11.6402%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 212.55143690109253
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 255: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 255: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 266.2684988975525 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:256 choose agents : [17, 33, 77, 11, 14, 45, 65, 37, 38, 24]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 17, internal_epoch   1,  Average loss: 0.1238, Accuracy: 28/526 (5.3232%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 17, internal_epoch   2,  Average loss: 0.0766, Accuracy: 47/526 (8.9354%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 17, internal_epoch   3,  Average loss: 0.0494, Accuracy: 122/526 (23.1939%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 17, internal_epoch   4,  Average loss: 0.0356, Accuracy: 136/526 (25.8555%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 17, internal_epoch   5,  Average loss: 0.0344, Accuracy: 145/526 (27.5665%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 17, internal_epoch   6,  Average loss: 0.0326, Accuracy: 133/526 (25.2852%), train_poison_data_count: 45
Global model norm: 209.88250061046062.
Norm before scaling: 207.75333744310825. Distance: 14.910414651775806
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 256: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1468.3666946645174, distance: 1491.0414984164593
Total norm for 4 adversaries is: 1468.3666946645174. distance: 1491.0414984164593
___Test Local_ResNet_18 poisoned: True, epoch: 256: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 33, internal_epoch   1,  Average loss: 0.0898, Accuracy: 34/527 (6.4516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 33, internal_epoch   2,  Average loss: 0.0523, Accuracy: 79/527 (14.9905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 33, internal_epoch   3,  Average loss: 0.0386, Accuracy: 166/527 (31.4991%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 33, internal_epoch   4,  Average loss: 0.0354, Accuracy: 84/527 (15.9393%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 33, internal_epoch   5,  Average loss: 0.0333, Accuracy: 164/527 (31.1195%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 33, internal_epoch   6,  Average loss: 0.0334, Accuracy: 161/527 (30.5503%), train_poison_data_count: 45
Global model norm: 209.88250061046062.
Norm before scaling: 207.57067696931568. Distance: 9.747954325159235
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 256: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 942.4786801302192, distance: 974.7954593144143
Total norm for 4 adversaries is: 942.4786801302192. distance: 974.7954593144143
___Test Local_ResNet_18 poisoned: True, epoch: 256: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 77, internal_epoch   1,  Average loss: 0.0926, Accuracy: 28/496 (5.6452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 77, internal_epoch   2,  Average loss: 0.0652, Accuracy: 29/496 (5.8468%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 77, internal_epoch   3,  Average loss: 0.0523, Accuracy: 89/496 (17.9435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 77, internal_epoch   4,  Average loss: 0.0447, Accuracy: 88/496 (17.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 77, internal_epoch   5,  Average loss: 0.0398, Accuracy: 102/496 (20.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 77, internal_epoch   6,  Average loss: 0.0368, Accuracy: 96/496 (19.3548%), train_poison_data_count: 40
Global model norm: 209.88250061046062.
Norm before scaling: 207.82896551311129. Distance: 10.450886987158524
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 256: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1019.5882134469779, distance: 1045.088752211983
Total norm for 4 adversaries is: 1019.5882134469779. distance: 1045.088752211983
___Test Local_ResNet_18 poisoned: True, epoch: 256: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 11, internal_epoch   1,  Average loss: 0.0881, Accuracy: 111/546 (20.3297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 11, internal_epoch   2,  Average loss: 0.0580, Accuracy: 123/546 (22.5275%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 11, internal_epoch   3,  Average loss: 0.0462, Accuracy: 145/546 (26.5568%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 11, internal_epoch   4,  Average loss: 0.0393, Accuracy: 91/546 (16.6667%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 11, internal_epoch   5,  Average loss: 0.0354, Accuracy: 135/546 (24.7253%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 256, local model 11, internal_epoch   6,  Average loss: 0.0341, Accuracy: 149/546 (27.2894%), train_poison_data_count: 45
Global model norm: 209.88250061046062.
Norm before scaling: 207.57225775016275. Distance: 10.75939530839646
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 256: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1045.7902514366826, distance: 1075.9395893822293
Total norm for 4 adversaries is: 1045.7902514366826. distance: 1075.9395893822293
___Test Local_ResNet_18 poisoned: True, epoch: 256: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 256, local model 14, internal_epoch   1,  Average loss: 0.1143, Accuracy: 14/318 (4.4025%)
___Train Local_ResNet_18,  epoch 256, local model 14, internal_epoch   2,  Average loss: 0.0662, Accuracy: 12/318 (3.7736%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 256, local model 45, internal_epoch   1,  Average loss: 0.0737, Accuracy: 67/529 (12.6654%)
___Train Local_ResNet_18,  epoch 256, local model 45, internal_epoch   2,  Average loss: 0.0453, Accuracy: 161/529 (30.4348%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 256, local model 65, internal_epoch   1,  Average loss: 0.0507, Accuracy: 52/314 (16.5605%)
___Train Local_ResNet_18,  epoch 256, local model 65, internal_epoch   2,  Average loss: 0.0331, Accuracy: 122/314 (38.8535%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 256, local model 37, internal_epoch   1,  Average loss: 0.0803, Accuracy: 56/725 (7.7241%)
___Train Local_ResNet_18,  epoch 256, local model 37, internal_epoch   2,  Average loss: 0.0314, Accuracy: 320/725 (44.1379%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 256, local model 38, internal_epoch   1,  Average loss: 0.0737, Accuracy: 120/756 (15.8730%)
___Train Local_ResNet_18,  epoch 256, local model 38, internal_epoch   2,  Average loss: 0.0343, Accuracy: 251/756 (33.2011%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 256, local model 24, internal_epoch   1,  Average loss: 0.0800, Accuracy: 41/320 (12.8125%)
___Train Local_ResNet_18,  epoch 256, local model 24, internal_epoch   2,  Average loss: 0.0461, Accuracy: 34/320 (10.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 216.0646595954895
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 256: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 256: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 269.4390902519226 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:257 choose agents : [17, 33, 77, 11, 99, 56, 20, 0, 86, 37]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 17, internal_epoch   1,  Average loss: 0.1466, Accuracy: 37/526 (7.0342%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 17, internal_epoch   2,  Average loss: 0.0546, Accuracy: 140/526 (26.6160%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 17, internal_epoch   3,  Average loss: 0.0482, Accuracy: 144/526 (27.3764%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 17, internal_epoch   4,  Average loss: 0.0457, Accuracy: 142/526 (26.9962%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 17, internal_epoch   5,  Average loss: 0.0466, Accuracy: 137/526 (26.0456%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 17, internal_epoch   6,  Average loss: 0.0418, Accuracy: 137/526 (26.0456%), train_poison_data_count: 45
Global model norm: 204.57291640146306.
Norm before scaling: 202.26707282699277. Distance: 13.343436672989974
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 257: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1307.9402222578829, distance: 1334.3437057220303
Total norm for 4 adversaries is: 1307.9402222578829. distance: 1334.3437057220303
___Test Local_ResNet_18 poisoned: True, epoch: 257: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 33, internal_epoch   1,  Average loss: 0.1789, Accuracy: 66/527 (12.5237%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 33, internal_epoch   2,  Average loss: 0.0526, Accuracy: 133/527 (25.2372%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 33, internal_epoch   3,  Average loss: 0.0453, Accuracy: 101/527 (19.1651%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 33, internal_epoch   4,  Average loss: 0.0386, Accuracy: 158/527 (29.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 33, internal_epoch   5,  Average loss: 0.0391, Accuracy: 154/527 (29.2220%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 33, internal_epoch   6,  Average loss: 0.0375, Accuracy: 139/527 (26.3757%), train_poison_data_count: 45
Global model norm: 204.57291640146306.
Norm before scaling: 202.7457806281058. Distance: 20.969086918632673
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 257: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2078.576917027609, distance: 2096.908677076806
Total norm for 4 adversaries is: 2078.576917027609. distance: 2096.908677076806
___Test Local_ResNet_18 poisoned: True, epoch: 257: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 77, internal_epoch   1,  Average loss: 0.1724, Accuracy: 83/496 (16.7339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 77, internal_epoch   2,  Average loss: 0.0613, Accuracy: 85/496 (17.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 77, internal_epoch   3,  Average loss: 0.0519, Accuracy: 104/496 (20.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 77, internal_epoch   4,  Average loss: 0.0461, Accuracy: 102/496 (20.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 77, internal_epoch   5,  Average loss: 0.0425, Accuracy: 98/496 (19.7581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 77, internal_epoch   6,  Average loss: 0.0406, Accuracy: 90/496 (18.1452%), train_poison_data_count: 40
Global model norm: 204.57291640146306.
Norm before scaling: 202.59164592845383. Distance: 13.8468887525321
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 257: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1363.5866767462933, distance: 1384.6887736960966
Total norm for 4 adversaries is: 1363.5866767462933. distance: 1384.6887736960966
___Test Local_ResNet_18 poisoned: True, epoch: 257: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 11, internal_epoch   1,  Average loss: 0.1850, Accuracy: 48/546 (8.7912%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 11, internal_epoch   2,  Average loss: 0.0645, Accuracy: 64/546 (11.7216%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 11, internal_epoch   3,  Average loss: 0.0580, Accuracy: 63/546 (11.5385%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 11, internal_epoch   4,  Average loss: 0.0489, Accuracy: 67/546 (12.2711%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 11, internal_epoch   5,  Average loss: 0.0442, Accuracy: 143/546 (26.1905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 257, local model 11, internal_epoch   6,  Average loss: 0.0421, Accuracy: 143/546 (26.1905%), train_poison_data_count: 45
Global model norm: 204.57291640146306.
Norm before scaling: 202.5344588736692. Distance: 18.490179806253323
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 257: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1828.5354111966221, distance: 1849.017982605902
Total norm for 4 adversaries is: 1828.5354111966221. distance: 1849.017982605902
___Test Local_ResNet_18 poisoned: True, epoch: 257: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 257, local model 99, internal_epoch   1,  Average loss: 0.1638, Accuracy: 27/391 (6.9054%)
___Train Local_ResNet_18,  epoch 257, local model 99, internal_epoch   2,  Average loss: 0.0533, Accuracy: 141/391 (36.0614%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 257, local model 56, internal_epoch   1,  Average loss: 0.1355, Accuracy: 68/743 (9.1521%)
___Train Local_ResNet_18,  epoch 257, local model 56, internal_epoch   2,  Average loss: 0.0526, Accuracy: 135/743 (18.1696%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 257, local model 20, internal_epoch   1,  Average loss: 0.1599, Accuracy: 82/362 (22.6519%)
___Train Local_ResNet_18,  epoch 257, local model 20, internal_epoch   2,  Average loss: 0.0804, Accuracy: 110/362 (30.3867%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 257, local model 0, internal_epoch   1,  Average loss: 0.1552, Accuracy: 81/367 (22.0708%)
___Train Local_ResNet_18,  epoch 257, local model 0, internal_epoch   2,  Average loss: 0.0470, Accuracy: 99/367 (26.9755%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 257, local model 86, internal_epoch   1,  Average loss: 0.2427, Accuracy: 10/212 (4.7170%)
___Train Local_ResNet_18,  epoch 257, local model 86, internal_epoch   2,  Average loss: 0.0824, Accuracy: 31/212 (14.6226%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 257, local model 37, internal_epoch   1,  Average loss: 0.0975, Accuracy: 306/725 (42.2069%)
___Train Local_ResNet_18,  epoch 257, local model 37, internal_epoch   2,  Average loss: 0.0407, Accuracy: 342/725 (47.1724%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 217.26005220413208
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 257: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 257: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 269.8100550174713 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:258 choose agents : [17, 33, 77, 11, 20, 36, 50, 78, 63, 37]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 17, internal_epoch   1,  Average loss: 0.1036, Accuracy: 24/526 (4.5627%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 17, internal_epoch   2,  Average loss: 0.0748, Accuracy: 91/526 (17.3004%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 17, internal_epoch   3,  Average loss: 0.0615, Accuracy: 95/526 (18.0608%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 17, internal_epoch   4,  Average loss: 0.0527, Accuracy: 104/526 (19.7719%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 17, internal_epoch   5,  Average loss: 0.0491, Accuracy: 47/526 (8.9354%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 17, internal_epoch   6,  Average loss: 0.0455, Accuracy: 147/526 (27.9468%), train_poison_data_count: 45
Global model norm: 201.26290719479334.
Norm before scaling: 198.96019741709648. Distance: 12.085734231887946
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 258: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1180.8429722024855, distance: 1208.5733324875243
Total norm for 4 adversaries is: 1180.8429722024855. distance: 1208.5733324875243
___Test Local_ResNet_18 poisoned: True, epoch: 258: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 33, internal_epoch   1,  Average loss: 0.0974, Accuracy: 101/527 (19.1651%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 33, internal_epoch   2,  Average loss: 0.0791, Accuracy: 88/527 (16.6983%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 33, internal_epoch   3,  Average loss: 0.0629, Accuracy: 48/527 (9.1082%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 33, internal_epoch   4,  Average loss: 0.0547, Accuracy: 156/527 (29.6015%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 33, internal_epoch   5,  Average loss: 0.0505, Accuracy: 169/527 (32.0683%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 33, internal_epoch   6,  Average loss: 0.0467, Accuracy: 163/527 (30.9298%), train_poison_data_count: 45
Global model norm: 201.26290719479334.
Norm before scaling: 198.8049059379572. Distance: 8.255637352482431
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 258: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 785.4362243365148, distance: 825.5637467815553
Total norm for 4 adversaries is: 785.4362243365148. distance: 825.5637467815553
___Test Local_ResNet_18 poisoned: True, epoch: 258: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 77, internal_epoch   1,  Average loss: 0.1097, Accuracy: 23/496 (4.6371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 77, internal_epoch   2,  Average loss: 0.0913, Accuracy: 56/496 (11.2903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 77, internal_epoch   3,  Average loss: 0.0764, Accuracy: 95/496 (19.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 77, internal_epoch   4,  Average loss: 0.0641, Accuracy: 98/496 (19.7581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 77, internal_epoch   5,  Average loss: 0.0564, Accuracy: 92/496 (18.5484%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 77, internal_epoch   6,  Average loss: 0.0501, Accuracy: 67/496 (13.5081%), train_poison_data_count: 40
Global model norm: 201.26290719479334.
Norm before scaling: 199.05188354735557. Distance: 9.023719895472881
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 258: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 870.7059994625051, distance: 902.3720130855123
Total norm for 4 adversaries is: 870.7059994625051. distance: 902.3720130855123
___Test Local_ResNet_18 poisoned: True, epoch: 258: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 11, internal_epoch   1,  Average loss: 0.0844, Accuracy: 147/546 (26.9231%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 11, internal_epoch   2,  Average loss: 0.0726, Accuracy: 128/546 (23.4432%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 11, internal_epoch   3,  Average loss: 0.0601, Accuracy: 130/546 (23.8095%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 11, internal_epoch   4,  Average loss: 0.0532, Accuracy: 101/546 (18.4982%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 11, internal_epoch   5,  Average loss: 0.0499, Accuracy: 120/546 (21.9780%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 258, local model 11, internal_epoch   6,  Average loss: 0.0466, Accuracy: 131/546 (23.9927%), train_poison_data_count: 45
Global model norm: 201.26290719479334.
Norm before scaling: 198.8444056448408. Distance: 8.595848909167627
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 258: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 821.7287417390243, distance: 859.5848561951286
Total norm for 4 adversaries is: 821.7287417390243. distance: 859.5848561951286
___Test Local_ResNet_18 poisoned: True, epoch: 258: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 258, local model 20, internal_epoch   1,  Average loss: 0.0923, Accuracy: 7/362 (1.9337%)
___Train Local_ResNet_18,  epoch 258, local model 20, internal_epoch   2,  Average loss: 0.0599, Accuracy: 45/362 (12.4309%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 258, local model 36, internal_epoch   1,  Average loss: 0.1011, Accuracy: 96/849 (11.3074%)
___Train Local_ResNet_18,  epoch 258, local model 36, internal_epoch   2,  Average loss: 0.0562, Accuracy: 112/849 (13.1920%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 258, local model 50, internal_epoch   1,  Average loss: 0.0897, Accuracy: 16/401 (3.9900%)
___Train Local_ResNet_18,  epoch 258, local model 50, internal_epoch   2,  Average loss: 0.0600, Accuracy: 90/401 (22.4439%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 258, local model 78, internal_epoch   1,  Average loss: 0.0779, Accuracy: 3/255 (1.1765%)
___Train Local_ResNet_18,  epoch 258, local model 78, internal_epoch   2,  Average loss: 0.0597, Accuracy: 33/255 (12.9412%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 258, local model 63, internal_epoch   1,  Average loss: 0.0943, Accuracy: 21/752 (2.7926%)
___Train Local_ResNet_18,  epoch 258, local model 63, internal_epoch   2,  Average loss: 0.0584, Accuracy: 105/752 (13.9628%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 258, local model 37, internal_epoch   1,  Average loss: 0.1313, Accuracy: 8/725 (1.1034%)
___Train Local_ResNet_18,  epoch 258, local model 37, internal_epoch   2,  Average loss: 0.0586, Accuracy: 77/725 (10.6207%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 217.69425678253174
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 258: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 258: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 268.73092913627625 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:259 choose agents : [17, 33, 77, 11, 83, 4, 1, 0, 37, 91]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 17, internal_epoch   1,  Average loss: 0.0893, Accuracy: 141/526 (26.8061%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 17, internal_epoch   2,  Average loss: 0.0761, Accuracy: 100/526 (19.0114%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 17, internal_epoch   3,  Average loss: 0.0595, Accuracy: 116/526 (22.0532%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 17, internal_epoch   4,  Average loss: 0.0516, Accuracy: 174/526 (33.0798%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 17, internal_epoch   5,  Average loss: 0.0503, Accuracy: 173/526 (32.8897%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 17, internal_epoch   6,  Average loss: 0.0508, Accuracy: 178/526 (33.8403%), train_poison_data_count: 45
Global model norm: 193.40748959450872.
Norm before scaling: 191.0282415311935. Distance: 6.5533668542562795
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 259: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 609.1892152689508, distance: 655.3366501272457
Total norm for 4 adversaries is: 609.1892152689508. distance: 655.3366501272457
___Test Local_ResNet_18 poisoned: True, epoch: 259: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 33, internal_epoch   1,  Average loss: 0.1179, Accuracy: 64/527 (12.1442%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 33, internal_epoch   2,  Average loss: 0.0975, Accuracy: 156/527 (29.6015%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 33, internal_epoch   3,  Average loss: 0.0955, Accuracy: 158/527 (29.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 33, internal_epoch   4,  Average loss: 0.0675, Accuracy: 48/527 (9.1082%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 33, internal_epoch   5,  Average loss: 0.0418, Accuracy: 156/527 (29.6015%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 33, internal_epoch   6,  Average loss: 0.0385, Accuracy: 142/527 (26.9450%), train_poison_data_count: 45
Global model norm: 193.40748959450872.
Norm before scaling: 190.9925043522651. Distance: 8.77344750041171
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 259: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 840.6016446569683, distance: 877.3447868426642
Total norm for 4 adversaries is: 840.6016446569683. distance: 877.3447868426642
___Test Local_ResNet_18 poisoned: True, epoch: 259: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 77, internal_epoch   1,  Average loss: 0.1105, Accuracy: 52/496 (10.4839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 77, internal_epoch   2,  Average loss: 0.0960, Accuracy: 85/496 (17.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 77, internal_epoch   3,  Average loss: 0.0832, Accuracy: 83/496 (16.7339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 77, internal_epoch   4,  Average loss: 0.0660, Accuracy: 95/496 (19.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 77, internal_epoch   5,  Average loss: 0.0473, Accuracy: 112/496 (22.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 77, internal_epoch   6,  Average loss: 0.0411, Accuracy: 112/496 (22.5806%), train_poison_data_count: 40
Global model norm: 193.40748959450872.
Norm before scaling: 191.26807512624788. Distance: 7.593522433415032
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 259: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 725.2300497083667, distance: 759.3522321689718
Total norm for 4 adversaries is: 725.2300497083667. distance: 759.3522321689718
___Test Local_ResNet_18 poisoned: True, epoch: 259: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 11, internal_epoch   1,  Average loss: 0.1450, Accuracy: 67/546 (12.2711%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 11, internal_epoch   2,  Average loss: 0.1226, Accuracy: 50/546 (9.1575%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 11, internal_epoch   3,  Average loss: 0.0793, Accuracy: 45/546 (8.2418%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 11, internal_epoch   4,  Average loss: 0.0462, Accuracy: 98/546 (17.9487%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 11, internal_epoch   5,  Average loss: 0.0424, Accuracy: 96/546 (17.5824%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 259, local model 11, internal_epoch   6,  Average loss: 0.0382, Accuracy: 112/546 (20.5128%), train_poison_data_count: 45
Global model norm: 193.40748959450872.
Norm before scaling: 190.96079031439936. Distance: 8.563538871170428
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 259: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 818.1515751986303, distance: 856.3538988058617
Total norm for 4 adversaries is: 818.1515751986303. distance: 856.3538988058617
___Test Local_ResNet_18 poisoned: True, epoch: 259: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 259, local model 83, internal_epoch   1,  Average loss: 0.1303, Accuracy: 14/366 (3.8251%)
___Train Local_ResNet_18,  epoch 259, local model 83, internal_epoch   2,  Average loss: 0.1016, Accuracy: 51/366 (13.9344%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 259, local model 4, internal_epoch   1,  Average loss: 0.1672, Accuracy: 107/557 (19.2101%)
___Train Local_ResNet_18,  epoch 259, local model 4, internal_epoch   2,  Average loss: 0.0811, Accuracy: 198/557 (35.5476%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 259, local model 1, internal_epoch   1,  Average loss: 0.2005, Accuracy: 38/641 (5.9282%)
___Train Local_ResNet_18,  epoch 259, local model 1, internal_epoch   2,  Average loss: 0.0820, Accuracy: 115/641 (17.9407%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 259, local model 0, internal_epoch   1,  Average loss: 0.1046, Accuracy: 35/367 (9.5368%)
___Train Local_ResNet_18,  epoch 259, local model 0, internal_epoch   2,  Average loss: 0.0879, Accuracy: 114/367 (31.0627%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 259, local model 37, internal_epoch   1,  Average loss: 0.0474, Accuracy: 243/725 (33.5172%)
___Train Local_ResNet_18,  epoch 259, local model 37, internal_epoch   2,  Average loss: 0.0326, Accuracy: 340/725 (46.8966%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 259, local model 91, internal_epoch   1,  Average loss: 0.1213, Accuracy: 12/234 (5.1282%)
___Train Local_ResNet_18,  epoch 259, local model 91, internal_epoch   2,  Average loss: 0.1011, Accuracy: 31/234 (13.2479%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 215.5469834804535
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 259: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 259: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 270.88458704948425 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:260 choose agents : [17, 33, 77, 11, 21, 13, 70, 54, 57, 41]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 17, internal_epoch   1,  Average loss: 0.4169, Accuracy: 29/526 (5.5133%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 17, internal_epoch   2,  Average loss: 0.0504, Accuracy: 128/526 (24.3346%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 17, internal_epoch   3,  Average loss: 0.0413, Accuracy: 163/526 (30.9886%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 17, internal_epoch   4,  Average loss: 0.0384, Accuracy: 177/526 (33.6502%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 17, internal_epoch   5,  Average loss: 0.0362, Accuracy: 173/526 (32.8897%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 17, internal_epoch   6,  Average loss: 0.0352, Accuracy: 175/526 (33.2700%), train_poison_data_count: 45
Global model norm: 185.22037128107695.
Norm before scaling: 183.51601811899147. Distance: 26.50892920577364
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 260: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2632.189582837832, distance: 2650.8927741423267
Total norm for 4 adversaries is: 2632.189582837832. distance: 2650.8927741423267
___Test Local_ResNet_18 poisoned: True, epoch: 260: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 33, internal_epoch   1,  Average loss: 0.4253, Accuracy: 57/527 (10.8159%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 33, internal_epoch   2,  Average loss: 0.0781, Accuracy: 51/527 (9.6774%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 33, internal_epoch   3,  Average loss: 0.0542, Accuracy: 161/527 (30.5503%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 33, internal_epoch   4,  Average loss: 0.0388, Accuracy: 105/527 (19.9241%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 33, internal_epoch   5,  Average loss: 0.0384, Accuracy: 163/527 (30.9298%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 33, internal_epoch   6,  Average loss: 0.0344, Accuracy: 124/527 (23.5294%), train_poison_data_count: 45
Global model norm: 185.22037128107695.
Norm before scaling: 183.40243489386938. Distance: 26.017120593271727
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 260: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2582.3459295764383, distance: 2601.712320761079
Total norm for 4 adversaries is: 2582.3459295764383. distance: 2601.712320761079
___Test Local_ResNet_18 poisoned: True, epoch: 260: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 77, internal_epoch   1,  Average loss: 0.4177, Accuracy: 48/496 (9.6774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 77, internal_epoch   2,  Average loss: 0.0617, Accuracy: 31/496 (6.2500%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 77, internal_epoch   3,  Average loss: 0.0504, Accuracy: 101/496 (20.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 77, internal_epoch   4,  Average loss: 0.0439, Accuracy: 103/496 (20.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 77, internal_epoch   5,  Average loss: 0.0381, Accuracy: 97/496 (19.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 77, internal_epoch   6,  Average loss: 0.0365, Accuracy: 123/496 (24.7984%), train_poison_data_count: 40
Global model norm: 185.22037128107695.
Norm before scaling: 183.6694445022089. Distance: 25.215472796665445
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 260: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2504.338834902338, distance: 2521.547144116088
Total norm for 4 adversaries is: 2504.338834902338. distance: 2521.547144116088
___Test Local_ResNet_18 poisoned: True, epoch: 260: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 11, internal_epoch   1,  Average loss: 0.3713, Accuracy: 95/546 (17.3993%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 11, internal_epoch   2,  Average loss: 0.0806, Accuracy: 83/546 (15.2015%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 11, internal_epoch   3,  Average loss: 0.0612, Accuracy: 56/546 (10.2564%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 11, internal_epoch   4,  Average loss: 0.0408, Accuracy: 112/546 (20.5128%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 11, internal_epoch   5,  Average loss: 0.0363, Accuracy: 92/546 (16.8498%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 260, local model 11, internal_epoch   6,  Average loss: 0.0334, Accuracy: 147/546 (26.9231%), train_poison_data_count: 45
Global model norm: 185.22037128107695.
Norm before scaling: 183.27160300698523. Distance: 24.25270804789127
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 260: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2405.330434680441, distance: 2425.2707065397876
Total norm for 4 adversaries is: 2405.330434680441. distance: 2425.2707065397876
___Test Local_ResNet_18 poisoned: True, epoch: 260: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 260, local model 21, internal_epoch   1,  Average loss: 0.4302, Accuracy: 38/262 (14.5038%)
___Train Local_ResNet_18,  epoch 260, local model 21, internal_epoch   2,  Average loss: 0.0583, Accuracy: 91/262 (34.7328%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 260, local model 13, internal_epoch   1,  Average loss: 0.2231, Accuracy: 180/620 (29.0323%)
___Train Local_ResNet_18,  epoch 260, local model 13, internal_epoch   2,  Average loss: 0.0284, Accuracy: 310/620 (50.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 260, local model 70, internal_epoch   1,  Average loss: 0.2076, Accuracy: 106/610 (17.3770%)
___Train Local_ResNet_18,  epoch 260, local model 70, internal_epoch   2,  Average loss: 0.0544, Accuracy: 164/610 (26.8852%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 260, local model 54, internal_epoch   1,  Average loss: 0.2290, Accuracy: 125/440 (28.4091%)
___Train Local_ResNet_18,  epoch 260, local model 54, internal_epoch   2,  Average loss: 0.0662, Accuracy: 145/440 (32.9545%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 260, local model 57, internal_epoch   1,  Average loss: 0.5435, Accuracy: 16/290 (5.5172%)
___Train Local_ResNet_18,  epoch 260, local model 57, internal_epoch   2,  Average loss: 0.0572, Accuracy: 42/290 (14.4828%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 260, local model 41, internal_epoch   1,  Average loss: 0.3363, Accuracy: 13/513 (2.5341%)
___Train Local_ResNet_18,  epoch 260, local model 41, internal_epoch   2,  Average loss: 0.0290, Accuracy: 318/513 (61.9883%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 203.40056943893433
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 260: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 260: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 252.16514825820923 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:261 choose agents : [17, 33, 77, 11, 28, 85, 59, 89, 31, 42]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 17, internal_epoch   1,  Average loss: 0.3224, Accuracy: 91/526 (17.3004%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 17, internal_epoch   2,  Average loss: 0.0568, Accuracy: 57/526 (10.8365%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 17, internal_epoch   3,  Average loss: 0.0496, Accuracy: 139/526 (26.4259%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 17, internal_epoch   4,  Average loss: 0.0422, Accuracy: 146/526 (27.7567%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 17, internal_epoch   5,  Average loss: 0.0396, Accuracy: 135/526 (25.6654%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 17, internal_epoch   6,  Average loss: 0.0376, Accuracy: 139/526 (26.4259%), train_poison_data_count: 45
Global model norm: 198.3649178282289.
Norm before scaling: 196.54252680717727. Distance: 24.865551558267814
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 261: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2467.4901215607733, distance: 2486.555147186565
Total norm for 4 adversaries is: 2467.4901215607733. distance: 2486.555147186565
___Test Local_ResNet_18 poisoned: True, epoch: 261: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 33, internal_epoch   1,  Average loss: 0.2695, Accuracy: 75/527 (14.2315%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 33, internal_epoch   2,  Average loss: 0.0626, Accuracy: 162/527 (30.7400%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 33, internal_epoch   3,  Average loss: 0.0584, Accuracy: 165/527 (31.3093%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 33, internal_epoch   4,  Average loss: 0.0532, Accuracy: 161/527 (30.5503%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 33, internal_epoch   5,  Average loss: 0.0495, Accuracy: 167/527 (31.6888%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 33, internal_epoch   6,  Average loss: 0.0471, Accuracy: 161/527 (30.5503%), train_poison_data_count: 45
Global model norm: 198.3649178282289.
Norm before scaling: 196.24611859219024. Distance: 21.041425989367156
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 261: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2082.997839653224, distance: 2104.142461906988
Total norm for 4 adversaries is: 2082.997839653224. distance: 2104.142461906988
___Test Local_ResNet_18 poisoned: True, epoch: 261: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 77, internal_epoch   1,  Average loss: 0.3062, Accuracy: 56/496 (11.2903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 77, internal_epoch   2,  Average loss: 0.0525, Accuracy: 68/496 (13.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 77, internal_epoch   3,  Average loss: 0.0494, Accuracy: 87/496 (17.5403%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 77, internal_epoch   4,  Average loss: 0.0455, Accuracy: 99/496 (19.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 77, internal_epoch   5,  Average loss: 0.0418, Accuracy: 104/496 (20.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 77, internal_epoch   6,  Average loss: 0.0397, Accuracy: 106/496 (21.3710%), train_poison_data_count: 40
Global model norm: 198.3649178282289.
Norm before scaling: 196.75832852448713. Distance: 23.367665491600647
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 261: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2319.858077555608, distance: 2336.7665694287907
Total norm for 4 adversaries is: 2319.858077555608. distance: 2336.7665694287907
___Test Local_ResNet_18 poisoned: True, epoch: 261: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 11, internal_epoch   1,  Average loss: 0.3010, Accuracy: 93/546 (17.0330%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 11, internal_epoch   2,  Average loss: 0.0832, Accuracy: 56/546 (10.2564%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 11, internal_epoch   3,  Average loss: 0.0752, Accuracy: 63/546 (11.5385%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 11, internal_epoch   4,  Average loss: 0.0630, Accuracy: 62/546 (11.3553%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 11, internal_epoch   5,  Average loss: 0.0543, Accuracy: 63/546 (11.5385%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 261, local model 11, internal_epoch   6,  Average loss: 0.0448, Accuracy: 69/546 (12.6374%), train_poison_data_count: 45
Global model norm: 198.3649178282289.
Norm before scaling: 196.22396324098645. Distance: 22.77750285326442
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 261: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2256.353917274504, distance: 2277.7502057951833
Total norm for 4 adversaries is: 2256.353917274504. distance: 2277.7502057951833
___Test Local_ResNet_18 poisoned: True, epoch: 261: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 261, local model 28, internal_epoch   1,  Average loss: 0.3097, Accuracy: 65/423 (15.3664%)
___Train Local_ResNet_18,  epoch 261, local model 28, internal_epoch   2,  Average loss: 0.0846, Accuracy: 70/423 (16.5485%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 261, local model 85, internal_epoch   1,  Average loss: 0.2541, Accuracy: 90/364 (24.7253%)
___Train Local_ResNet_18,  epoch 261, local model 85, internal_epoch   2,  Average loss: 0.0802, Accuracy: 90/364 (24.7253%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 261, local model 59, internal_epoch   1,  Average loss: 0.2616, Accuracy: 109/642 (16.9782%)
___Train Local_ResNet_18,  epoch 261, local model 59, internal_epoch   2,  Average loss: 0.0446, Accuracy: 158/642 (24.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 261, local model 89, internal_epoch   1,  Average loss: 0.3420, Accuracy: 47/413 (11.3801%)
___Train Local_ResNet_18,  epoch 261, local model 89, internal_epoch   2,  Average loss: 0.0397, Accuracy: 95/413 (23.0024%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 261, local model 31, internal_epoch   1,  Average loss: 0.2354, Accuracy: 48/706 (6.7989%)
___Train Local_ResNet_18,  epoch 261, local model 31, internal_epoch   2,  Average loss: 0.0524, Accuracy: 202/706 (28.6119%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 261, local model 42, internal_epoch   1,  Average loss: 0.4999, Accuracy: 27/198 (13.6364%)
___Train Local_ResNet_18,  epoch 261, local model 42, internal_epoch   2,  Average loss: 0.0865, Accuracy: 14/198 (7.0707%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 193.89951491355896
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 261: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 261: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 241.09512734413147 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:262 choose agents : [17, 33, 77, 11, 82, 68, 37, 47, 73, 15]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 17, internal_epoch   1,  Average loss: 0.0924, Accuracy: 139/526 (26.4259%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 17, internal_epoch   2,  Average loss: 0.0787, Accuracy: 134/526 (25.4753%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 17, internal_epoch   3,  Average loss: 0.0656, Accuracy: 132/526 (25.0951%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 17, internal_epoch   4,  Average loss: 0.0542, Accuracy: 148/526 (28.1369%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 17, internal_epoch   5,  Average loss: 0.0462, Accuracy: 156/526 (29.6578%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 17, internal_epoch   6,  Average loss: 0.0393, Accuracy: 149/526 (28.3270%), train_poison_data_count: 45
Global model norm: 206.2077039964802.
Norm before scaling: 203.696244826089. Distance: 8.85161162966286
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 262: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 845.7248000975258, distance: 885.1611435213365
Total norm for 4 adversaries is: 845.7248000975258. distance: 885.1611435213365
___Test Local_ResNet_18 poisoned: True, epoch: 262: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 33, internal_epoch   1,  Average loss: 0.1240, Accuracy: 3/527 (0.5693%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 33, internal_epoch   2,  Average loss: 0.0959, Accuracy: 6/527 (1.1385%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 33, internal_epoch   3,  Average loss: 0.0747, Accuracy: 25/527 (4.7438%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 33, internal_epoch   4,  Average loss: 0.0577, Accuracy: 79/527 (14.9905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 33, internal_epoch   5,  Average loss: 0.0454, Accuracy: 98/527 (18.5958%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 33, internal_epoch   6,  Average loss: 0.0397, Accuracy: 130/527 (24.6679%), train_poison_data_count: 45
Global model norm: 206.2077039964802.
Norm before scaling: 203.6782082108933. Distance: 10.97179333670834
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 262: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1063.2991112570348, distance: 1097.179338121166
Total norm for 4 adversaries is: 1063.2991112570348. distance: 1097.179338121166
___Test Local_ResNet_18 poisoned: True, epoch: 262: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 77, internal_epoch   1,  Average loss: 0.0961, Accuracy: 40/496 (8.0645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 77, internal_epoch   2,  Average loss: 0.0784, Accuracy: 72/496 (14.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 77, internal_epoch   3,  Average loss: 0.0667, Accuracy: 87/496 (17.5403%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 77, internal_epoch   4,  Average loss: 0.0560, Accuracy: 93/496 (18.7500%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 77, internal_epoch   5,  Average loss: 0.0470, Accuracy: 94/496 (18.9516%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 77, internal_epoch   6,  Average loss: 0.0409, Accuracy: 94/496 (18.9516%), train_poison_data_count: 40
Global model norm: 206.2077039964802.
Norm before scaling: 204.00897077395885. Distance: 8.617784218346639
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 262: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 829.1929811569802, distance: 861.7783937881014
Total norm for 4 adversaries is: 829.1929811569802. distance: 861.7783937881014
___Test Local_ResNet_18 poisoned: True, epoch: 262: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 11, internal_epoch   1,  Average loss: 0.0938, Accuracy: 48/546 (8.7912%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 11, internal_epoch   2,  Average loss: 0.0762, Accuracy: 76/546 (13.9194%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 11, internal_epoch   3,  Average loss: 0.0613, Accuracy: 78/546 (14.2857%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 11, internal_epoch   4,  Average loss: 0.0551, Accuracy: 132/546 (24.1758%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 11, internal_epoch   5,  Average loss: 0.0478, Accuracy: 148/546 (27.1062%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 262, local model 11, internal_epoch   6,  Average loss: 0.0436, Accuracy: 140/546 (25.6410%), train_poison_data_count: 45
Global model norm: 206.2077039964802.
Norm before scaling: 203.68380826663665. Distance: 8.268132945224233
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 262: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 784.7629419130341, distance: 826.8132724503157
Total norm for 4 adversaries is: 784.7629419130341. distance: 826.8132724503157
___Test Local_ResNet_18 poisoned: True, epoch: 262: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 262, local model 82, internal_epoch   1,  Average loss: 0.0791, Accuracy: 81/601 (13.4775%)
___Train Local_ResNet_18,  epoch 262, local model 82, internal_epoch   2,  Average loss: 0.0527, Accuracy: 107/601 (17.8037%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 262, local model 68, internal_epoch   1,  Average loss: 0.0979, Accuracy: 35/416 (8.4135%)
___Train Local_ResNet_18,  epoch 262, local model 68, internal_epoch   2,  Average loss: 0.0729, Accuracy: 36/416 (8.6538%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 262, local model 37, internal_epoch   1,  Average loss: 0.0969, Accuracy: 4/725 (0.5517%)
___Train Local_ResNet_18,  epoch 262, local model 37, internal_epoch   2,  Average loss: 0.0420, Accuracy: 237/725 (32.6897%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 262, local model 47, internal_epoch   1,  Average loss: 0.0697, Accuracy: 261/654 (39.9083%)
___Train Local_ResNet_18,  epoch 262, local model 47, internal_epoch   2,  Average loss: 0.0507, Accuracy: 261/654 (39.9083%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 262, local model 73, internal_epoch   1,  Average loss: 0.0557, Accuracy: 28/500 (5.6000%)
___Train Local_ResNet_18,  epoch 262, local model 73, internal_epoch   2,  Average loss: 0.0272, Accuracy: 303/500 (60.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 262, local model 15, internal_epoch   1,  Average loss: 0.1288, Accuracy: 9/341 (2.6393%)
___Train Local_ResNet_18,  epoch 262, local model 15, internal_epoch   2,  Average loss: 0.0943, Accuracy: 45/341 (13.1965%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 196.20295405387878
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 262: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 262: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 242.94556975364685 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:263 choose agents : [17, 33, 77, 11, 90, 9, 71, 78, 69, 28]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 17, internal_epoch   1,  Average loss: 0.1718, Accuracy: 53/526 (10.0760%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 17, internal_epoch   2,  Average loss: 0.1668, Accuracy: 133/526 (25.2852%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 17, internal_epoch   3,  Average loss: 0.1526, Accuracy: 141/526 (26.8061%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 17, internal_epoch   4,  Average loss: 0.1414, Accuracy: 140/526 (26.6160%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 17, internal_epoch   5,  Average loss: 0.1347, Accuracy: 138/526 (26.2357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 17, internal_epoch   6,  Average loss: 0.1183, Accuracy: 143/526 (27.1863%), train_poison_data_count: 45
Global model norm: 198.48752322249376.
Norm before scaling: 195.46368148904287. Distance: 9.331220205965915
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 263: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 884.4669298509696, distance: 933.122011046787
Total norm for 4 adversaries is: 884.4669298509696. distance: 933.122011046787
___Test Local_ResNet_18 poisoned: True, epoch: 263: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 33, internal_epoch   1,  Average loss: 0.0775, Accuracy: 160/527 (30.3605%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 33, internal_epoch   2,  Average loss: 0.0735, Accuracy: 157/527 (29.7913%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 33, internal_epoch   3,  Average loss: 0.0637, Accuracy: 164/527 (31.1195%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 33, internal_epoch   4,  Average loss: 0.0612, Accuracy: 166/527 (31.4991%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 33, internal_epoch   5,  Average loss: 0.0591, Accuracy: 158/527 (29.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 33, internal_epoch   6,  Average loss: 0.0523, Accuracy: 166/527 (31.4991%), train_poison_data_count: 45
Global model norm: 198.48752322249376.
Norm before scaling: 196.00487278700496. Distance: 6.247226252181624
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 263: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 572.5670266440428, distance: 624.7225884342586
Total norm for 4 adversaries is: 572.5670266440428. distance: 624.7225884342586
___Test Local_ResNet_18 poisoned: True, epoch: 263: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 77, internal_epoch   1,  Average loss: 0.1331, Accuracy: 68/496 (13.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 77, internal_epoch   2,  Average loss: 0.1206, Accuracy: 68/496 (13.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 77, internal_epoch   3,  Average loss: 0.1093, Accuracy: 85/496 (17.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 77, internal_epoch   4,  Average loss: 0.1079, Accuracy: 100/496 (20.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 77, internal_epoch   5,  Average loss: 0.0989, Accuracy: 109/496 (21.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 77, internal_epoch   6,  Average loss: 0.0927, Accuracy: 102/496 (20.5645%), train_poison_data_count: 40
Global model norm: 198.48752322249376.
Norm before scaling: 196.03780327401142. Distance: 7.073900321985097
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 263: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 661.9261901828633, distance: 707.390075382741
Total norm for 4 adversaries is: 661.9261901828633. distance: 707.390075382741
___Test Local_ResNet_18 poisoned: True, epoch: 263: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 11, internal_epoch   1,  Average loss: 0.1338, Accuracy: 58/546 (10.6227%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 11, internal_epoch   2,  Average loss: 0.1164, Accuracy: 65/546 (11.9048%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 11, internal_epoch   3,  Average loss: 0.1110, Accuracy: 68/546 (12.4542%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 11, internal_epoch   4,  Average loss: 0.0979, Accuracy: 70/546 (12.8205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 11, internal_epoch   5,  Average loss: 0.0921, Accuracy: 143/546 (26.1905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 263, local model 11, internal_epoch   6,  Average loss: 0.0877, Accuracy: 144/546 (26.3736%), train_poison_data_count: 45
Global model norm: 198.48752322249376.
Norm before scaling: 195.72898594102. Distance: 8.279355159841433
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 263: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 780.559695026588, distance: 827.9354971856201
Total norm for 4 adversaries is: 780.559695026588. distance: 827.9354971856201
___Test Local_ResNet_18 poisoned: True, epoch: 263: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 263, local model 90, internal_epoch   1,  Average loss: 0.2307, Accuracy: 17/578 (2.9412%)
___Train Local_ResNet_18,  epoch 263, local model 90, internal_epoch   2,  Average loss: 0.1541, Accuracy: 8/578 (1.3841%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 263, local model 9, internal_epoch   1,  Average loss: 0.2344, Accuracy: 10/368 (2.7174%)
___Train Local_ResNet_18,  epoch 263, local model 9, internal_epoch   2,  Average loss: 0.2076, Accuracy: 7/368 (1.9022%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 263, local model 71, internal_epoch   1,  Average loss: 0.1011, Accuracy: 159/1166 (13.6364%)
___Train Local_ResNet_18,  epoch 263, local model 71, internal_epoch   2,  Average loss: 0.0620, Accuracy: 339/1166 (29.0738%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 263, local model 78, internal_epoch   1,  Average loss: 0.2088, Accuracy: 56/255 (21.9608%)
___Train Local_ResNet_18,  epoch 263, local model 78, internal_epoch   2,  Average loss: 0.1994, Accuracy: 56/255 (21.9608%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 263, local model 69, internal_epoch   1,  Average loss: 0.2430, Accuracy: 6/216 (2.7778%)
___Train Local_ResNet_18,  epoch 263, local model 69, internal_epoch   2,  Average loss: 0.2302, Accuracy: 6/216 (2.7778%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 263, local model 28, internal_epoch   1,  Average loss: 0.1608, Accuracy: 70/423 (16.5485%)
___Train Local_ResNet_18,  epoch 263, local model 28, internal_epoch   2,  Average loss: 0.1435, Accuracy: 70/423 (16.5485%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 199.52333855628967
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 263: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 263: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 248.57806181907654 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:264 choose agents : [17, 33, 77, 11, 87, 46, 26, 67, 13, 69]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 17, internal_epoch   1,  Average loss: 0.2111, Accuracy: 18/526 (3.4221%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 17, internal_epoch   2,  Average loss: 0.1615, Accuracy: 19/526 (3.6122%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 17, internal_epoch   3,  Average loss: 0.1007, Accuracy: 18/526 (3.4221%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 17, internal_epoch   4,  Average loss: 0.0698, Accuracy: 47/526 (8.9354%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 17, internal_epoch   5,  Average loss: 0.0543, Accuracy: 48/526 (9.1255%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 17, internal_epoch   6,  Average loss: 0.0444, Accuracy: 102/526 (19.3916%), train_poison_data_count: 45
Global model norm: 188.9729229942745.
Norm before scaling: 186.39523490086864. Distance: 14.65988198767569
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 264: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1437.5611726114475, distance: 1465.9882332406355
Total norm for 4 adversaries is: 1437.5611726114475. distance: 1465.9882332406355
___Test Local_ResNet_18 poisoned: True, epoch: 264: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 33, internal_epoch   1,  Average loss: 0.1797, Accuracy: 95/527 (18.0266%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 33, internal_epoch   2,  Average loss: 0.1423, Accuracy: 101/527 (19.1651%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 33, internal_epoch   3,  Average loss: 0.0932, Accuracy: 99/527 (18.7856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 33, internal_epoch   4,  Average loss: 0.0682, Accuracy: 78/527 (14.8008%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 33, internal_epoch   5,  Average loss: 0.0566, Accuracy: 59/527 (11.1954%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 33, internal_epoch   6,  Average loss: 0.0470, Accuracy: 60/527 (11.3852%), train_poison_data_count: 45
Global model norm: 188.9729229942745.
Norm before scaling: 186.4013227554998. Distance: 12.688528235350894
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 264: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1238.170626367788, distance: 1268.8528283453522
Total norm for 4 adversaries is: 1238.170626367788. distance: 1268.8528283453522
___Test Local_ResNet_18 poisoned: True, epoch: 264: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 77, internal_epoch   1,  Average loss: 0.1707, Accuracy: 25/496 (5.0403%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 77, internal_epoch   2,  Average loss: 0.1351, Accuracy: 22/496 (4.4355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 77, internal_epoch   3,  Average loss: 0.0848, Accuracy: 22/496 (4.4355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 77, internal_epoch   4,  Average loss: 0.0609, Accuracy: 92/496 (18.5484%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 77, internal_epoch   5,  Average loss: 0.0551, Accuracy: 101/496 (20.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 77, internal_epoch   6,  Average loss: 0.0508, Accuracy: 93/496 (18.7500%), train_poison_data_count: 40
Global model norm: 188.9729229942745.
Norm before scaling: 186.7523008559734. Distance: 11.962020535960235
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 264: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1169.9854699952475, distance: 1196.202062780365
Total norm for 4 adversaries is: 1169.9854699952475. distance: 1196.202062780365
___Test Local_ResNet_18 poisoned: True, epoch: 264: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 11, internal_epoch   1,  Average loss: 0.1515, Accuracy: 139/546 (25.4579%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 11, internal_epoch   2,  Average loss: 0.1176, Accuracy: 152/546 (27.8388%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 11, internal_epoch   3,  Average loss: 0.0855, Accuracy: 144/546 (26.3736%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 11, internal_epoch   4,  Average loss: 0.0618, Accuracy: 134/546 (24.5421%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 11, internal_epoch   5,  Average loss: 0.0561, Accuracy: 61/546 (11.1722%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 264, local model 11, internal_epoch   6,  Average loss: 0.0510, Accuracy: 75/546 (13.7363%), train_poison_data_count: 45
Global model norm: 188.9729229942745.
Norm before scaling: 186.4189879344376. Distance: 10.913565119862907
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 264: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1057.8213459748295, distance: 1091.35655264446
Total norm for 4 adversaries is: 1057.8213459748295. distance: 1091.35655264446
___Test Local_ResNet_18 poisoned: True, epoch: 264: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 264, local model 87, internal_epoch   1,  Average loss: 0.1826, Accuracy: 21/397 (5.2897%)
___Train Local_ResNet_18,  epoch 264, local model 87, internal_epoch   2,  Average loss: 0.1100, Accuracy: 21/397 (5.2897%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 264, local model 46, internal_epoch   1,  Average loss: 0.1464, Accuracy: 83/601 (13.8103%)
___Train Local_ResNet_18,  epoch 264, local model 46, internal_epoch   2,  Average loss: 0.0698, Accuracy: 87/601 (14.4759%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 264, local model 26, internal_epoch   1,  Average loss: 0.1778, Accuracy: 36/468 (7.6923%)
___Train Local_ResNet_18,  epoch 264, local model 26, internal_epoch   2,  Average loss: 0.1035, Accuracy: 36/468 (7.6923%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 264, local model 67, internal_epoch   1,  Average loss: 0.1129, Accuracy: 226/842 (26.8409%)
___Train Local_ResNet_18,  epoch 264, local model 67, internal_epoch   2,  Average loss: 0.0478, Accuracy: 179/842 (21.2589%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 264, local model 13, internal_epoch   1,  Average loss: 0.2008, Accuracy: 9/620 (1.4516%)
___Train Local_ResNet_18,  epoch 264, local model 13, internal_epoch   2,  Average loss: 0.0894, Accuracy: 21/620 (3.3871%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 264, local model 69, internal_epoch   1,  Average loss: 0.1951, Accuracy: 11/216 (5.0926%)
___Train Local_ResNet_18,  epoch 264, local model 69, internal_epoch   2,  Average loss: 0.1641, Accuracy: 11/216 (5.0926%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 200.21373581886292
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 264: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 264: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 249.10731482505798 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:265 choose agents : [17, 33, 77, 11, 54, 34, 78, 91, 57, 30]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 17, internal_epoch   1,  Average loss: 0.0756, Accuracy: 143/526 (27.1863%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 17, internal_epoch   2,  Average loss: 0.0683, Accuracy: 143/526 (27.1863%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 17, internal_epoch   3,  Average loss: 0.0656, Accuracy: 148/526 (28.1369%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 17, internal_epoch   4,  Average loss: 0.0654, Accuracy: 141/526 (26.8061%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 17, internal_epoch   5,  Average loss: 0.0705, Accuracy: 137/526 (26.0456%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 17, internal_epoch   6,  Average loss: 0.0664, Accuracy: 149/526 (28.3270%), train_poison_data_count: 45
Global model norm: 183.5720013713965.
Norm before scaling: 181.2257742430695. Distance: 5.070296888518436
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 265: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 450.13020685686047, distance: 507.0297082025865
Total norm for 4 adversaries is: 450.13020685686047. distance: 507.0297082025865
___Test Local_ResNet_18 poisoned: True, epoch: 265: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 33, internal_epoch   1,  Average loss: 0.1752, Accuracy: 74/527 (14.0417%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 33, internal_epoch   2,  Average loss: 0.1674, Accuracy: 161/527 (30.5503%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 33, internal_epoch   3,  Average loss: 0.1589, Accuracy: 162/527 (30.7400%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 33, internal_epoch   4,  Average loss: 0.1494, Accuracy: 159/527 (30.1708%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 33, internal_epoch   5,  Average loss: 0.1486, Accuracy: 161/527 (30.5503%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 33, internal_epoch   6,  Average loss: 0.1341, Accuracy: 164/527 (31.1195%), train_poison_data_count: 45
Global model norm: 183.5720013713965.
Norm before scaling: 180.57957906418986. Distance: 7.571892068664986
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 265: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 701.6634699056236, distance: 757.1892101714076
Total norm for 4 adversaries is: 701.6634699056236. distance: 757.1892101714076
___Test Local_ResNet_18 poisoned: True, epoch: 265: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 77, internal_epoch   1,  Average loss: 0.1035, Accuracy: 18/496 (3.6290%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 77, internal_epoch   2,  Average loss: 0.0939, Accuracy: 58/496 (11.6935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 77, internal_epoch   3,  Average loss: 0.0831, Accuracy: 83/496 (16.7339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 77, internal_epoch   4,  Average loss: 0.0762, Accuracy: 88/496 (17.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 77, internal_epoch   5,  Average loss: 0.0690, Accuracy: 88/496 (17.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 77, internal_epoch   6,  Average loss: 0.0655, Accuracy: 86/496 (17.3387%), train_poison_data_count: 40
Global model norm: 183.5720013713965.
Norm before scaling: 181.4390178200378. Distance: 7.498309389940868
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 265: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 715.8678299798084, distance: 749.8309392789818
Total norm for 4 adversaries is: 715.8678299798084. distance: 749.8309392789818
___Test Local_ResNet_18 poisoned: True, epoch: 265: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 11, internal_epoch   1,  Average loss: 0.2205, Accuracy: 69/546 (12.6374%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 11, internal_epoch   2,  Average loss: 0.2055, Accuracy: 63/546 (11.5385%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 11, internal_epoch   3,  Average loss: 0.1957, Accuracy: 52/546 (9.5238%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 11, internal_epoch   4,  Average loss: 0.1876, Accuracy: 64/546 (11.7216%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 11, internal_epoch   5,  Average loss: 0.1728, Accuracy: 88/546 (16.1172%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 265, local model 11, internal_epoch   6,  Average loss: 0.1665, Accuracy: 86/546 (15.7509%), train_poison_data_count: 45
Global model norm: 183.5720013713965.
Norm before scaling: 180.3119096610787. Distance: 9.0293600355378
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 265: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 849.8292107829667, distance: 902.9359750281301
Total norm for 4 adversaries is: 849.8292107829667. distance: 902.9359750281301
___Test Local_ResNet_18 poisoned: True, epoch: 265: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 265, local model 54, internal_epoch   1,  Average loss: 0.2126, Accuracy: 3/440 (0.6818%)
___Train Local_ResNet_18,  epoch 265, local model 54, internal_epoch   2,  Average loss: 0.1882, Accuracy: 86/440 (19.5455%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 265, local model 34, internal_epoch   1,  Average loss: 0.0645, Accuracy: 43/349 (12.3209%)
___Train Local_ResNet_18,  epoch 265, local model 34, internal_epoch   2,  Average loss: 0.0577, Accuracy: 149/349 (42.6934%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 265, local model 78, internal_epoch   1,  Average loss: 0.0900, Accuracy: 6/255 (2.3529%)
___Train Local_ResNet_18,  epoch 265, local model 78, internal_epoch   2,  Average loss: 0.0811, Accuracy: 44/255 (17.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 265, local model 91, internal_epoch   1,  Average loss: 0.1769, Accuracy: 1/234 (0.4274%)
___Train Local_ResNet_18,  epoch 265, local model 91, internal_epoch   2,  Average loss: 0.1638, Accuracy: 6/234 (2.5641%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 265, local model 57, internal_epoch   1,  Average loss: 0.1012, Accuracy: 25/290 (8.6207%)
___Train Local_ResNet_18,  epoch 265, local model 57, internal_epoch   2,  Average loss: 0.0890, Accuracy: 46/290 (15.8621%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 265, local model 30, internal_epoch   1,  Average loss: 0.2936, Accuracy: 25/337 (7.4184%)
___Train Local_ResNet_18,  epoch 265, local model 30, internal_epoch   2,  Average loss: 0.2613, Accuracy: 58/337 (17.2107%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 196.98461318016052
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 265: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 265: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 246.76201248168945 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:266 choose agents : [17, 33, 77, 11, 75, 28, 31, 85, 45, 96]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 17, internal_epoch   1,  Average loss: 0.1660, Accuracy: 17/526 (3.2319%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 17, internal_epoch   2,  Average loss: 0.1344, Accuracy: 24/526 (4.5627%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 17, internal_epoch   3,  Average loss: 0.1084, Accuracy: 66/526 (12.5475%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 17, internal_epoch   4,  Average loss: 0.0973, Accuracy: 142/526 (26.9962%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 17, internal_epoch   5,  Average loss: 0.0829, Accuracy: 141/526 (26.8061%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 17, internal_epoch   6,  Average loss: 0.0725, Accuracy: 138/526 (26.2357%), train_poison_data_count: 45
Global model norm: 174.0597172129439.
Norm before scaling: 171.5177138719934. Distance: 10.881200316357889
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 266: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1055.7538775680628, distance: 1088.12005311914
Total norm for 4 adversaries is: 1055.7538775680628. distance: 1088.12005311914
___Test Local_ResNet_18 poisoned: True, epoch: 266: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 33, internal_epoch   1,  Average loss: 0.2180, Accuracy: 62/527 (11.7647%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 33, internal_epoch   2,  Average loss: 0.2012, Accuracy: 47/527 (8.9184%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 33, internal_epoch   3,  Average loss: 0.1675, Accuracy: 31/527 (5.8824%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 33, internal_epoch   4,  Average loss: 0.1414, Accuracy: 23/527 (4.3643%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 33, internal_epoch   5,  Average loss: 0.1187, Accuracy: 16/527 (3.0361%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 33, internal_epoch   6,  Average loss: 0.1050, Accuracy: 50/527 (9.4877%), train_poison_data_count: 45
Global model norm: 174.0597172129439.
Norm before scaling: 171.16200407983368. Distance: 13.020369197456958
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 266: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1268.3095048133953, distance: 1302.0370098426542
Total norm for 4 adversaries is: 1268.3095048133953. distance: 1302.0370098426542
___Test Local_ResNet_18 poisoned: True, epoch: 266: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 77, internal_epoch   1,  Average loss: 0.1200, Accuracy: 107/496 (21.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 77, internal_epoch   2,  Average loss: 0.1012, Accuracy: 106/496 (21.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 77, internal_epoch   3,  Average loss: 0.0921, Accuracy: 94/496 (18.9516%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 77, internal_epoch   4,  Average loss: 0.0821, Accuracy: 98/496 (19.7581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 77, internal_epoch   5,  Average loss: 0.0740, Accuracy: 98/496 (19.7581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 77, internal_epoch   6,  Average loss: 0.0704, Accuracy: 98/496 (19.7581%), train_poison_data_count: 40
Global model norm: 174.0597172129439.
Norm before scaling: 171.90574724976474. Distance: 7.831821566317179
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 266: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 750.3451289240172, distance: 783.1821307971729
Total norm for 4 adversaries is: 750.3451289240172. distance: 783.1821307971729
___Test Local_ResNet_18 poisoned: True, epoch: 266: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 11, internal_epoch   1,  Average loss: 0.2111, Accuracy: 59/546 (10.8059%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 11, internal_epoch   2,  Average loss: 0.1891, Accuracy: 57/546 (10.4396%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 11, internal_epoch   3,  Average loss: 0.1700, Accuracy: 39/546 (7.1429%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 11, internal_epoch   4,  Average loss: 0.1531, Accuracy: 86/546 (15.7509%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 11, internal_epoch   5,  Average loss: 0.1381, Accuracy: 88/546 (16.1172%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 266, local model 11, internal_epoch   6,  Average loss: 0.1203, Accuracy: 90/546 (16.4835%), train_poison_data_count: 45
Global model norm: 174.0597172129439.
Norm before scaling: 171.05309733932035. Distance: 11.217344233173367
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 266: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1082.700327883944, distance: 1121.7343714088465
Total norm for 4 adversaries is: 1082.700327883944. distance: 1121.7343714088465
___Test Local_ResNet_18 poisoned: True, epoch: 266: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 266, local model 75, internal_epoch   1,  Average loss: 0.1090, Accuracy: 43/578 (7.4394%)
___Train Local_ResNet_18,  epoch 266, local model 75, internal_epoch   2,  Average loss: 0.0817, Accuracy: 176/578 (30.4498%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 266, local model 28, internal_epoch   1,  Average loss: 0.2088, Accuracy: 16/423 (3.7825%)
___Train Local_ResNet_18,  epoch 266, local model 28, internal_epoch   2,  Average loss: 0.1731, Accuracy: 25/423 (5.9102%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 266, local model 31, internal_epoch   1,  Average loss: 0.1366, Accuracy: 50/706 (7.0822%)
___Train Local_ResNet_18,  epoch 266, local model 31, internal_epoch   2,  Average loss: 0.0842, Accuracy: 165/706 (23.3711%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 266, local model 85, internal_epoch   1,  Average loss: 0.2527, Accuracy: 42/364 (11.5385%)
___Train Local_ResNet_18,  epoch 266, local model 85, internal_epoch   2,  Average loss: 0.2232, Accuracy: 36/364 (9.8901%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 266, local model 45, internal_epoch   1,  Average loss: 0.1305, Accuracy: 160/529 (30.2457%)
___Train Local_ResNet_18,  epoch 266, local model 45, internal_epoch   2,  Average loss: 0.1055, Accuracy: 83/529 (15.6900%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 266, local model 96, internal_epoch   1,  Average loss: 0.1448, Accuracy: 36/708 (5.0847%)
___Train Local_ResNet_18,  epoch 266, local model 96, internal_epoch   2,  Average loss: 0.1065, Accuracy: 149/708 (21.0452%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 202.58759951591492
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 266: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 266: Average loss: nan, Accuracy: 0/9000 (0.0000%)
