current path: saved_models/model_cifar_Nov.13_08.00.50
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 201
create model done
Poisoned following participants: [17, 33, 77, 11]
We use following environment for graphs:  cifar
----------------------------------Start one training epoch------------------------------------------
Server Epoch:201 choose agents : [37, 53, 39, 11, 57, 63, 48, 50, 72, 88]. Adversary List: []
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   1,  Average loss: 0.0088, Accuracy: 602/725 (83.0345%)
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   2,  Average loss: 0.0163, Accuracy: 522/725 (72.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 25.7387, Accuracy: 2090/10000 (20.9000%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   1,  Average loss: 0.0048, Accuracy: 563/625 (90.0800%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   2,  Average loss: 0.0037, Accuracy: 580/625 (92.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.8809, Accuracy: 2809/10000 (28.0900%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   1,  Average loss: 0.0081, Accuracy: 182/217 (83.8710%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   2,  Average loss: 0.0008, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.2981, Accuracy: 3028/10000 (30.2800%)
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 201, local model 11, internal_epoch   1,  Average loss: 0.0036, Accuracy: 509/546 (93.2234%)
___Train Local_ResNet_18,  epoch 201, local model 11, internal_epoch   2,  Average loss: 0.0023, Accuracy: 519/546 (95.0549%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.1886, Accuracy: 5069/10000 (50.6900%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   1,  Average loss: 0.0064, Accuracy: 251/290 (86.5517%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   2,  Average loss: 0.0012, Accuracy: 285/290 (98.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 3.9085, Accuracy: 3812/10000 (38.1200%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   1,  Average loss: 0.0030, Accuracy: 703/752 (93.4840%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   2,  Average loss: 0.0029, Accuracy: 710/752 (94.4149%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.3964, Accuracy: 4939/10000 (49.3900%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   1,  Average loss: 0.0063, Accuracy: 327/378 (86.5079%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   2,  Average loss: 0.0024, Accuracy: 358/378 (94.7090%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 3.0938, Accuracy: 4023/10000 (40.2300%)
___Train Local_ResNet_18,  epoch 201, local model 50, internal_epoch   1,  Average loss: 0.0027, Accuracy: 384/401 (95.7606%)
___Train Local_ResNet_18,  epoch 201, local model 50, internal_epoch   2,  Average loss: 0.0022, Accuracy: 391/401 (97.5062%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 3.6215, Accuracy: 3822/10000 (38.2200%)
___Train Local_ResNet_18,  epoch 201, local model 72, internal_epoch   1,  Average loss: 0.0081, Accuracy: 527/618 (85.2751%)
___Train Local_ResNet_18,  epoch 201, local model 72, internal_epoch   2,  Average loss: 0.0084, Accuracy: 541/618 (87.5405%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 9.3000, Accuracy: 2923/10000 (29.2300%)
___Train Local_ResNet_18,  epoch 201, local model 88, internal_epoch   1,  Average loss: 0.0086, Accuracy: 372/447 (83.2215%)
___Train Local_ResNet_18,  epoch 201, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 402/447 (89.9329%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.3054, Accuracy: 3033/10000 (30.3300%)
time spent on training: 57.36974859237671
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10922184436887378  data num: [725, 625, 217, 546, 290, 752, 378, 401, 618, 447]
[rfa agg] considering poison per batch poison_fraction: 0.008532956591318263
[rfa agg] init. name: [37, 53, 39, 11, 57, 63, 48, 50, 72, 88], weight: tensor([0.1450, 0.1250, 0.0434, 0.1092, 0.0580, 0.1504, 0.0756, 0.0802, 0.1236,
        0.0894])
[rfa agg] iter:  0, prev_obj_val: 29.966033935546875, obj_val: 35.79195785522461, abs dis: 5.825923919677734
[rfa agg] iter:  0, weight: tensor([0.0546, 0.0747, 0.0366, 0.0898, 0.0761, 0.0588, 0.1732, 0.1961, 0.0714,
        0.1687])
[rfa agg] iter:  1, prev_obj_val: 35.79195785522461, obj_val: 39.277706146240234, abs dis: 3.485748291015625
[rfa agg] iter:  1, weight: tensor([0.0513, 0.0651, 0.0645, 0.0730, 0.1707, 0.0551, 0.2153, 0.1194, 0.0628,
        0.1228])
[rfa agg] iter:  2, prev_obj_val: 39.277706146240234, obj_val: 39.26681900024414, abs dis: 0.01088714599609375
[rfa agg] iter:  2, weight: tensor([0.0503, 0.0617, 0.0945, 0.0674, 0.2531, 0.0537, 0.1611, 0.0964, 0.0598,
        0.1019])
[rfa agg] iter:  3, prev_obj_val: 39.26681900024414, obj_val: 39.26624298095703, abs dis: 0.000576019287109375
[rfa agg] iter:  3, weight: tensor([0.0489, 0.0601, 0.0928, 0.0656, 0.2755, 0.0523, 0.1540, 0.0937, 0.0582,
        0.0988])
[rfa agg] iter:  4, prev_obj_val: 39.26624298095703, obj_val: 39.266197204589844, abs dis: 4.57763671875e-05
[rfa agg] iter:  4, weight: tensor([0.0485, 0.0596, 0.0920, 0.0651, 0.2819, 0.0519, 0.1523, 0.0930, 0.0577,
        0.0980])
___Test Target_ResNet_18 poisoned: False, epoch: 201: Average loss: 0.7028, Accuracy: 7698/10000 (76.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 201: Average loss: 6.3640, Accuracy: 255/9000 (2.8333%)
Done in 124.73999691009521 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:202 choose agents : [71, 92, 23, 26, 50, 14, 76, 49, 86, 58]. Adversary List: []
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 1056/1166 (90.5660%)
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   2,  Average loss: 0.0109, Accuracy: 909/1166 (77.9588%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 37.3508, Accuracy: 1162/10000 (11.6200%)
___Train Local_ResNet_18,  epoch 202, local model 92, internal_epoch   1,  Average loss: 0.0078, Accuracy: 688/796 (86.4322%)
___Train Local_ResNet_18,  epoch 202, local model 92, internal_epoch   2,  Average loss: 0.0075, Accuracy: 677/796 (85.0503%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 3.4305, Accuracy: 3534/10000 (35.3400%)
___Train Local_ResNet_18,  epoch 202, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 221/248 (89.1129%)
___Train Local_ResNet_18,  epoch 202, local model 23, internal_epoch   2,  Average loss: 0.0012, Accuracy: 243/248 (97.9839%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 3.3711, Accuracy: 3487/10000 (34.8700%)
___Train Local_ResNet_18,  epoch 202, local model 26, internal_epoch   1,  Average loss: 0.0050, Accuracy: 426/468 (91.0256%)
___Train Local_ResNet_18,  epoch 202, local model 26, internal_epoch   2,  Average loss: 0.0068, Accuracy: 421/468 (89.9573%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 3.8503, Accuracy: 3622/10000 (36.2200%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   1,  Average loss: 0.0020, Accuracy: 388/401 (96.7581%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   2,  Average loss: 0.0008, Accuracy: 396/401 (98.7531%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.6244, Accuracy: 4817/10000 (48.1700%)
___Train Local_ResNet_18,  epoch 202, local model 14, internal_epoch   1,  Average loss: 0.0082, Accuracy: 265/318 (83.3333%)
___Train Local_ResNet_18,  epoch 202, local model 14, internal_epoch   2,  Average loss: 0.0023, Accuracy: 303/318 (95.2830%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 8.3830, Accuracy: 2077/10000 (20.7700%)
___Train Local_ResNet_18,  epoch 202, local model 76, internal_epoch   1,  Average loss: 0.0429, Accuracy: 59/65 (90.7692%)
___Train Local_ResNet_18,  epoch 202, local model 76, internal_epoch   2,  Average loss: 0.0026, Accuracy: 65/65 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.9832, Accuracy: 4754/10000 (47.5400%)
___Train Local_ResNet_18,  epoch 202, local model 49, internal_epoch   1,  Average loss: 0.0038, Accuracy: 395/426 (92.7230%)
___Train Local_ResNet_18,  epoch 202, local model 49, internal_epoch   2,  Average loss: 0.0016, Accuracy: 414/426 (97.1831%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.0342, Accuracy: 5067/10000 (50.6700%)
___Train Local_ResNet_18,  epoch 202, local model 86, internal_epoch   1,  Average loss: 0.0056, Accuracy: 190/212 (89.6226%)
___Train Local_ResNet_18,  epoch 202, local model 86, internal_epoch   2,  Average loss: 0.0020, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.4992, Accuracy: 6016/10000 (60.1600%)
___Train Local_ResNet_18,  epoch 202, local model 58, internal_epoch   1,  Average loss: 0.0093, Accuracy: 198/234 (84.6154%)
___Train Local_ResNet_18,  epoch 202, local model 58, internal_epoch   2,  Average loss: 0.0006, Accuracy: 233/234 (99.5726%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 7.4654, Accuracy: 1700/10000 (17.0000%)
time spent on training: 65.57296466827393
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [1166, 796, 248, 468, 401, 318, 65, 426, 212, 234]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [71, 92, 23, 26, 50, 14, 76, 49, 86, 58], weight: tensor([0.2690, 0.1837, 0.0572, 0.1080, 0.0925, 0.0734, 0.0150, 0.0983, 0.0489,
        0.0540])
[rfa agg] iter:  0, prev_obj_val: 47.445350646972656, obj_val: 48.35633087158203, abs dis: 0.910980224609375
[rfa agg] iter:  0, weight: tensor([0.0808, 0.1234, 0.0399, 0.2630, 0.1708, 0.0646, 0.0073, 0.1785, 0.0341,
        0.0377])
[rfa agg] iter:  1, prev_obj_val: 48.35633087158203, obj_val: 54.16328430175781, abs dis: 5.806953430175781
[rfa agg] iter:  1, weight: tensor([0.0426, 0.0572, 0.0360, 0.1565, 0.2912, 0.0661, 0.0058, 0.2800, 0.0307,
        0.0340])
[rfa agg] iter:  2, prev_obj_val: 54.16328430175781, obj_val: 59.275390625, abs dis: 5.1121063232421875
[rfa agg] iter:  2, weight: tensor([0.0502, 0.0610, 0.0912, 0.1026, 0.1499, 0.2140, 0.0108, 0.1572, 0.0773,
        0.0857])
[rfa agg] iter:  3, prev_obj_val: 59.275390625, obj_val: 56.5166015625, abs dis: 2.7587890625
[rfa agg] iter:  3, weight: tensor([0.0394, 0.0456, 0.1726, 0.0636, 0.0777, 0.2043, 0.0127, 0.0820, 0.1407,
        0.1614])
[rfa agg] iter:  4, prev_obj_val: 56.5166015625, obj_val: 66.30252075195312, abs dis: 9.785919189453125
[rfa agg] iter:  4, weight: tensor([0.0427, 0.0506, 0.1176, 0.0764, 0.1004, 0.2872, 0.0112, 0.1053, 0.0982,
        0.1105])
[rfa agg] iter:  5, prev_obj_val: 66.30252075195312, obj_val: 70.43465423583984, abs dis: 4.132133483886719
[rfa agg] iter:  5, weight: tensor([0.0437, 0.0484, 0.2074, 0.0594, 0.0664, 0.1175, 0.0245, 0.0702, 0.1679,
        0.1945])
[rfa agg] iter:  6, prev_obj_val: 70.43465423583984, obj_val: 56.53618240356445, abs dis: 13.89847183227539
[rfa agg] iter:  6, weight: tensor([0.0559, 0.0608, 0.1767, 0.0709, 0.0769, 0.1173, 0.0467, 0.0814, 0.1475,
        0.1658])
[rfa agg] iter:  7, prev_obj_val: 56.53618240356445, obj_val: 66.296875, abs dis: 9.760692596435547
[rfa agg] iter:  7, weight: tensor([0.0441, 0.0522, 0.1211, 0.0788, 0.1035, 0.2653, 0.0115, 0.1086, 0.1013,
        0.1137])
[rfa agg] iter:  8, prev_obj_val: 66.296875, obj_val: 70.4347152709961, abs dis: 4.137840270996094
[rfa agg] iter:  8, weight: tensor([0.0436, 0.0483, 0.2080, 0.0593, 0.0663, 0.1168, 0.0244, 0.0701, 0.1684,
        0.1948])
[rfa agg] iter:  9, prev_obj_val: 70.4347152709961, obj_val: 56.536190032958984, abs dis: 13.89852523803711
[rfa agg] iter:  9, weight: tensor([0.0559, 0.0608, 0.1768, 0.0709, 0.0769, 0.1173, 0.0467, 0.0814, 0.1475,
        0.1658])
___Test Target_ResNet_18 poisoned: False, epoch: 202: Average loss: 0.6815, Accuracy: 7741/10000 (77.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 202: Average loss: 6.1785, Accuracy: 309/9000 (3.4333%)
Done in 141.69818472862244 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:203 choose agents : [17, 6, 94, 61, 33, 71, 8, 69, 89, 64]. Adversary List: [17]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   1,  Average loss: 0.0174, Accuracy: 442/526 (84.0304%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   2,  Average loss: 0.0168, Accuracy: 419/526 (79.6578%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   3,  Average loss: 0.0085, Accuracy: 459/526 (87.2624%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   4,  Average loss: 0.0053, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   5,  Average loss: 0.0052, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   6,  Average loss: 0.0023, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Global model norm: 37.65015186618608.
Norm before scaling: 39.04489915969338. Distance: 11.892060242100937
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.7340, Accuracy: 4701/10000 (47.0100%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.3767, Accuracy: 7784/9000 (86.4889%)
Scaling by  100
Scaled Norm after poisoning: 1188.3532197962018, distance: 1189.2060902131304
Total norm for 2 adversaries is: 1188.3532197962018. distance: 1189.2060902131304
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 203, local model 6, internal_epoch   1,  Average loss: 0.0028, Accuracy: 488/520 (93.8462%)
___Train Local_ResNet_18,  epoch 203, local model 6, internal_epoch   2,  Average loss: 0.0031, Accuracy: 492/520 (94.6154%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.3596, Accuracy: 4823/10000 (48.2300%)
___Train Local_ResNet_18,  epoch 203, local model 94, internal_epoch   1,  Average loss: 0.0075, Accuracy: 171/203 (84.2365%)
___Train Local_ResNet_18,  epoch 203, local model 94, internal_epoch   2,  Average loss: 0.0046, Accuracy: 191/203 (94.0887%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 4.3733, Accuracy: 2773/10000 (27.7300%)
___Train Local_ResNet_18,  epoch 203, local model 61, internal_epoch   1,  Average loss: 0.0039, Accuracy: 554/590 (93.8983%)
___Train Local_ResNet_18,  epoch 203, local model 61, internal_epoch   2,  Average loss: 0.0055, Accuracy: 526/590 (89.1525%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 5.5918, Accuracy: 2795/10000 (27.9500%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 203, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 481/527 (91.2713%)
___Train Local_ResNet_18,  epoch 203, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 474/527 (89.9431%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 3.4217, Accuracy: 3704/10000 (37.0400%)
___Train Local_ResNet_18,  epoch 203, local model 71, internal_epoch   1,  Average loss: 0.0041, Accuracy: 1074/1166 (92.1098%)
___Train Local_ResNet_18,  epoch 203, local model 71, internal_epoch   2,  Average loss: 0.0068, Accuracy: 1008/1166 (86.4494%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 4.5360, Accuracy: 3317/10000 (33.1700%)
___Train Local_ResNet_18,  epoch 203, local model 8, internal_epoch   1,  Average loss: 0.0035, Accuracy: 506/534 (94.7566%)
___Train Local_ResNet_18,  epoch 203, local model 8, internal_epoch   2,  Average loss: 0.0041, Accuracy: 499/534 (93.4457%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.4495, Accuracy: 4336/10000 (43.3600%)
___Train Local_ResNet_18,  epoch 203, local model 69, internal_epoch   1,  Average loss: 0.0074, Accuracy: 184/216 (85.1852%)
___Train Local_ResNet_18,  epoch 203, local model 69, internal_epoch   2,  Average loss: 0.0005, Accuracy: 215/216 (99.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 8.7849, Accuracy: 1253/10000 (12.5300%)
___Train Local_ResNet_18,  epoch 203, local model 89, internal_epoch   1,  Average loss: 0.0075, Accuracy: 353/413 (85.4722%)
___Train Local_ResNet_18,  epoch 203, local model 89, internal_epoch   2,  Average loss: 0.0029, Accuracy: 392/413 (94.9153%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 6.6702, Accuracy: 2179/10000 (21.7900%)
___Train Local_ResNet_18,  epoch 203, local model 64, internal_epoch   1,  Average loss: 0.0046, Accuracy: 615/686 (89.6501%)
___Train Local_ResNet_18,  epoch 203, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 615/686 (89.6501%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 3.0297, Accuracy: 4396/10000 (43.9600%)
time spent on training: 107.47256684303284
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.19568853372979  data num: [526, 520, 203, 590, 527, 1166, 534, 216, 413, 686]
[rfa agg] considering poison per batch poison_fraction: 0.015288166697639844
[rfa agg] init. name: [17, 6, 94, 61, 33, 71, 8, 69, 89, 64], weight: tensor([0.0978, 0.0966, 0.0377, 0.1096, 0.0979, 0.2167, 0.0992, 0.0401, 0.0768,
        0.1275])
[rfa agg] iter:  0, prev_obj_val: 4230.134765625, obj_val: 2558.466796875, abs dis: 1671.66796875
[rfa agg] iter:  0, weight: tensor([0.0115, 0.1050, 0.0402, 0.1195, 0.1064, 0.2446, 0.1078, 0.0428, 0.0827,
        0.1395])
[rfa agg] iter:  1, prev_obj_val: 2558.466796875, obj_val: 2391.738037109375, abs dis: 166.728759765625
[rfa agg] iter:  1, weight: tensor([0.0011, 0.0962, 0.0323, 0.1128, 0.0974, 0.3198, 0.0988, 0.0343, 0.0717,
        0.1357])
[rfa agg] iter:  2, prev_obj_val: 2391.738037109375, obj_val: 2387.321533203125, abs dis: 4.41650390625
[rfa agg] iter:  2, weight: tensor([1.6772e-04, 1.0857e-01, 1.9272e-02, 1.5615e-01, 1.0878e-01, 1.6366e-01,
        1.1119e-01, 2.0517e-02, 5.8141e-02, 2.5356e-01])
[rfa agg] iter:  3, prev_obj_val: 2387.321533203125, obj_val: 2397.780517578125, abs dis: 10.458984375
[rfa agg] iter:  3, weight: tensor([6.9899e-05, 2.1936e-01, 1.4387e-02, 1.4146e-01, 1.7902e-01, 4.1331e-02,
        2.1227e-01, 1.5334e-02, 6.6064e-02, 1.1070e-01])
[rfa agg] iter:  4, prev_obj_val: 2397.780517578125, obj_val: 2394.576904296875, abs dis: 3.20361328125
[rfa agg] iter:  4, weight: tensor([1.1153e-04, 1.4018e-01, 3.7767e-02, 1.0575e-01, 1.3652e-01, 5.5056e-02,
        1.4273e-01, 4.0346e-02, 2.4712e-01, 9.4413e-02])
[rfa agg] iter:  5, prev_obj_val: 2394.576904296875, obj_val: 2397.711181640625, abs dis: 3.13427734375
[rfa agg] iter:  5, weight: tensor([9.8091e-05, 1.5520e-01, 2.8690e-02, 1.0817e-01, 1.4810e-01, 5.0490e-02,
        1.5729e-01, 3.0594e-02, 2.2761e-01, 9.3757e-02])
[rfa agg] iter:  6, prev_obj_val: 2397.711181640625, obj_val: 2397.703125, abs dis: 0.008056640625
[rfa agg] iter:  6, weight: tensor([1.0619e-04, 1.3244e-01, 3.6020e-02, 1.0027e-01, 1.2927e-01, 5.2428e-02,
        1.3493e-01, 3.8444e-02, 2.8626e-01, 8.9824e-02])
[rfa agg] iter:  7, prev_obj_val: 2397.703125, obj_val: 2401.106201171875, abs dis: 3.403076171875
[rfa agg] iter:  7, weight: tensor([1.0386e-04, 1.2899e-01, 3.5226e-02, 9.7904e-02, 1.2579e-01, 5.1275e-02,
        1.3138e-01, 3.7584e-02, 3.0395e-01, 8.7805e-02])
[rfa agg] iter:  8, prev_obj_val: 2401.106201171875, obj_val: 2397.703369140625, abs dis: 3.40283203125
[rfa agg] iter:  8, weight: tensor([1.1907e-04, 1.2116e-01, 4.7991e-02, 9.7838e-02, 1.1960e-01, 5.6484e-02,
        1.2373e-01, 5.1256e-02, 2.9162e-01, 9.0198e-02])
[rfa agg] iter:  9, prev_obj_val: 2397.703369140625, obj_val: 2401.1064453125, abs dis: 3.403076171875
[rfa agg] iter:  9, weight: tensor([1.0355e-04, 1.2844e-01, 3.5139e-02, 9.7589e-02, 1.2518e-01, 5.1126e-02,
        1.3079e-01, 3.7489e-02, 3.0660e-01, 8.7556e-02])
___Test Target_ResNet_18 poisoned: False, epoch: 203: Average loss: 0.6597, Accuracy: 7810/10000 (78.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 203: Average loss: 5.9027, Accuracy: 382/9000 (4.2444%)
Done in 179.4913079738617 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:204 choose agents : [38, 77, 64, 29, 23, 83, 43, 56, 45, 1]. Adversary List: []
___Train Local_ResNet_18,  epoch 204, local model 38, internal_epoch   1,  Average loss: 0.0036, Accuracy: 712/756 (94.1799%)
___Train Local_ResNet_18,  epoch 204, local model 38, internal_epoch   2,  Average loss: 0.0042, Accuracy: 699/756 (92.4603%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 2.7649, Accuracy: 4612/10000 (46.1200%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 204, local model 77, internal_epoch   1,  Average loss: 0.0028, Accuracy: 468/496 (94.3548%)
___Train Local_ResNet_18,  epoch 204, local model 77, internal_epoch   2,  Average loss: 0.0017, Accuracy: 479/496 (96.5726%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.1838, Accuracy: 6302/10000 (63.0200%)
___Train Local_ResNet_18,  epoch 204, local model 64, internal_epoch   1,  Average loss: 0.0030, Accuracy: 645/686 (94.0233%)
___Train Local_ResNet_18,  epoch 204, local model 64, internal_epoch   2,  Average loss: 0.0034, Accuracy: 638/686 (93.0029%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 3.0058, Accuracy: 4214/10000 (42.1400%)
___Train Local_ResNet_18,  epoch 204, local model 29, internal_epoch   1,  Average loss: 0.0059, Accuracy: 752/848 (88.6792%)
___Train Local_ResNet_18,  epoch 204, local model 29, internal_epoch   2,  Average loss: 0.0064, Accuracy: 753/848 (88.7972%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 9.6527, Accuracy: 1838/10000 (18.3800%)
___Train Local_ResNet_18,  epoch 204, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 232/248 (93.5484%)
___Train Local_ResNet_18,  epoch 204, local model 23, internal_epoch   2,  Average loss: 0.0008, Accuracy: 245/248 (98.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.6504, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 204, local model 83, internal_epoch   1,  Average loss: 0.0022, Accuracy: 348/366 (95.0820%)
___Train Local_ResNet_18,  epoch 204, local model 83, internal_epoch   2,  Average loss: 0.0005, Accuracy: 364/366 (99.4536%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.2667, Accuracy: 6357/10000 (63.5700%)
___Train Local_ResNet_18,  epoch 204, local model 43, internal_epoch   1,  Average loss: 0.0067, Accuracy: 305/345 (88.4058%)
___Train Local_ResNet_18,  epoch 204, local model 43, internal_epoch   2,  Average loss: 0.0020, Accuracy: 330/345 (95.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 8.0981, Accuracy: 2365/10000 (23.6500%)
___Train Local_ResNet_18,  epoch 204, local model 56, internal_epoch   1,  Average loss: 0.0016, Accuracy: 721/743 (97.0390%)
___Train Local_ResNet_18,  epoch 204, local model 56, internal_epoch   2,  Average loss: 0.0011, Accuracy: 730/743 (98.2503%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.3042, Accuracy: 6380/10000 (63.8000%)
___Train Local_ResNet_18,  epoch 204, local model 45, internal_epoch   1,  Average loss: 0.0078, Accuracy: 460/529 (86.9565%)
___Train Local_ResNet_18,  epoch 204, local model 45, internal_epoch   2,  Average loss: 0.0083, Accuracy: 440/529 (83.1758%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 5.1739, Accuracy: 3049/10000 (30.4900%)
___Train Local_ResNet_18,  epoch 204, local model 1, internal_epoch   1,  Average loss: 0.0073, Accuracy: 597/641 (93.1357%)
___Train Local_ResNet_18,  epoch 204, local model 1, internal_epoch   2,  Average loss: 0.0113, Accuracy: 535/641 (83.4633%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 7.4444, Accuracy: 3393/10000 (33.9300%)
time spent on training: 73.9764232635498
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.08766348533050548  data num: [756, 496, 686, 848, 248, 366, 345, 743, 529, 641]
[rfa agg] considering poison per batch poison_fraction: 0.006848709791445741
[rfa agg] init. name: [38, 77, 64, 29, 23, 83, 43, 56, 45, 1], weight: tensor([0.1336, 0.0877, 0.1212, 0.1499, 0.0438, 0.0647, 0.0610, 0.1313, 0.0935,
        0.1133])
[rfa agg] iter:  0, prev_obj_val: 30.61412811279297, obj_val: 41.945762634277344, abs dis: 11.331634521484375
[rfa agg] iter:  0, weight: tensor([0.0787, 0.2983, 0.0939, 0.0591, 0.0265, 0.0759, 0.0691, 0.0788, 0.1335,
        0.0863])
[rfa agg] iter:  1, prev_obj_val: 41.945762634277344, obj_val: 41.84667205810547, abs dis: 0.099090576171875
[rfa agg] iter:  1, weight: tensor([0.0541, 0.1046, 0.0589, 0.0453, 0.0526, 0.3059, 0.1998, 0.0537, 0.0707,
        0.0546])
[rfa agg] iter:  2, prev_obj_val: 41.84667205810547, obj_val: 38.69449996948242, abs dis: 3.152172088623047
[rfa agg] iter:  2, weight: tensor([0.0470, 0.0897, 0.0511, 0.0394, 0.0460, 0.3637, 0.2084, 0.0467, 0.0607,
        0.0474])
[rfa agg] iter:  3, prev_obj_val: 38.69449996948242, obj_val: 38.68565368652344, abs dis: 0.008846282958984375
[rfa agg] iter:  3, weight: tensor([0.0590, 0.1332, 0.0653, 0.0483, 0.0428, 0.2619, 0.1895, 0.0587, 0.0809,
        0.0604])
[rfa agg] iter:  4, prev_obj_val: 38.68565368652344, obj_val: 38.68559646606445, abs dis: 5.7220458984375e-05
[rfa agg] iter:  4, weight: tensor([0.0599, 0.1360, 0.0663, 0.0491, 0.0434, 0.2527, 0.1893, 0.0596, 0.0825,
        0.0613])
___Test Target_ResNet_18 poisoned: False, epoch: 204: Average loss: 0.6531, Accuracy: 7801/10000 (78.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 204: Average loss: 5.8346, Accuracy: 402/9000 (4.4667%)
Done in 143.96285438537598 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:205 choose agents : [33, 50, 16, 12, 44, 86, 20, 49, 43, 28]. Adversary List: [33]
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   1,  Average loss: 0.0121, Accuracy: 457/527 (86.7173%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   2,  Average loss: 0.0117, Accuracy: 455/527 (86.3378%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   3,  Average loss: 0.0075, Accuracy: 471/527 (89.3738%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   4,  Average loss: 0.0055, Accuracy: 486/527 (92.2201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   5,  Average loss: 0.0038, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   6,  Average loss: 0.0038, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Global model norm: 37.63286521041565.
Norm before scaling: 38.871533205547735. Distance: 11.05974134973981
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.7942, Accuracy: 4645/10000 (46.4500%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.1721, Accuracy: 8467/9000 (94.0778%)
Scaling by  100
Scaled Norm after poisoning: 1105.3684905948785, distance: 1105.974061630742
Total norm for 1 adversaries is: 1105.3684905948785. distance: 1105.974061630742
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 205, local model 50, internal_epoch   1,  Average loss: 0.0018, Accuracy: 391/401 (97.5062%)
___Train Local_ResNet_18,  epoch 205, local model 50, internal_epoch   2,  Average loss: 0.0006, Accuracy: 397/401 (99.0025%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.3817, Accuracy: 4824/10000 (48.2400%)
___Train Local_ResNet_18,  epoch 205, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 726/773 (93.9198%)
___Train Local_ResNet_18,  epoch 205, local model 16, internal_epoch   2,  Average loss: 0.0220, Accuracy: 506/773 (65.4592%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 329.1856, Accuracy: 1207/10000 (12.0700%)
___Train Local_ResNet_18,  epoch 205, local model 12, internal_epoch   1,  Average loss: 0.0057, Accuracy: 876/977 (89.6622%)
___Train Local_ResNet_18,  epoch 205, local model 12, internal_epoch   2,  Average loss: 0.0069, Accuracy: 846/977 (86.5916%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 11.0278, Accuracy: 3264/10000 (32.6400%)
___Train Local_ResNet_18,  epoch 205, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 402/436 (92.2018%)
___Train Local_ResNet_18,  epoch 205, local model 44, internal_epoch   2,  Average loss: 0.0018, Accuracy: 421/436 (96.5596%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.6492, Accuracy: 4213/10000 (42.1300%)
___Train Local_ResNet_18,  epoch 205, local model 86, internal_epoch   1,  Average loss: 0.0036, Accuracy: 199/212 (93.8679%)
___Train Local_ResNet_18,  epoch 205, local model 86, internal_epoch   2,  Average loss: 0.0028, Accuracy: 209/212 (98.5849%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.4537, Accuracy: 6091/10000 (60.9100%)
___Train Local_ResNet_18,  epoch 205, local model 20, internal_epoch   1,  Average loss: 0.0074, Accuracy: 314/362 (86.7403%)
___Train Local_ResNet_18,  epoch 205, local model 20, internal_epoch   2,  Average loss: 0.0018, Accuracy: 349/362 (96.4088%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 5.1976, Accuracy: 3213/10000 (32.1300%)
___Train Local_ResNet_18,  epoch 205, local model 49, internal_epoch   1,  Average loss: 0.0030, Accuracy: 406/426 (95.3052%)
___Train Local_ResNet_18,  epoch 205, local model 49, internal_epoch   2,  Average loss: 0.0006, Accuracy: 423/426 (99.2958%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.5863, Accuracy: 4468/10000 (44.6800%)
___Train Local_ResNet_18,  epoch 205, local model 43, internal_epoch   1,  Average loss: 0.0057, Accuracy: 305/345 (88.4058%)
___Train Local_ResNet_18,  epoch 205, local model 43, internal_epoch   2,  Average loss: 0.0034, Accuracy: 330/345 (95.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 3.3532, Accuracy: 4067/10000 (40.6700%)
___Train Local_ResNet_18,  epoch 205, local model 28, internal_epoch   1,  Average loss: 0.0026, Accuracy: 397/423 (93.8534%)
___Train Local_ResNet_18,  epoch 205, local model 28, internal_epoch   2,  Average loss: 0.0017, Accuracy: 411/423 (97.1631%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.6186, Accuracy: 5816/10000 (58.1600%)
time spent on training: 99.17138624191284
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10794756247439574  data num: [527, 401, 773, 977, 436, 212, 362, 426, 345, 423]
[rfa agg] considering poison per batch poison_fraction: 0.008433403318312167
[rfa agg] init. name: [33, 50, 16, 12, 44, 86, 20, 49, 43, 28], weight: tensor([0.1079, 0.0821, 0.1583, 0.2001, 0.0893, 0.0434, 0.0741, 0.0873, 0.0707,
        0.0866])
[rfa agg] iter:  0, prev_obj_val: 4624.88525390625, obj_val: 2855.454345703125, abs dis: 1769.430908203125
[rfa agg] iter:  0, weight: tensor([0.0143, 0.0899, 0.1769, 0.2259, 0.0977, 0.0470, 0.0809, 0.0955, 0.0771,
        0.0948])
[rfa agg] iter:  1, prev_obj_val: 2855.454345703125, obj_val: 2636.447998046875, abs dis: 219.00634765625
[rfa agg] iter:  1, weight: tensor([0.0016, 0.0843, 0.1915, 0.2664, 0.0916, 0.0414, 0.0742, 0.0895, 0.0707,
        0.0889])
[rfa agg] iter:  2, prev_obj_val: 2636.447998046875, obj_val: 2634.06396484375, abs dis: 2.384033203125
[rfa agg] iter:  2, weight: tensor([1.9244e-04, 7.7629e-02, 3.0709e-01, 2.2659e-01, 8.4144e-02, 2.5901e-02,
        5.8524e-02, 8.2382e-02, 5.5751e-02, 8.1796e-02])
[rfa agg] iter:  3, prev_obj_val: 2634.06396484375, obj_val: 2642.08984375, abs dis: 8.02587890625
[rfa agg] iter:  3, weight: tensor([0.0002, 0.1245, 0.1627, 0.1228, 0.1339, 0.0319, 0.0827, 0.1318, 0.0788,
        0.1307])
[rfa agg] iter:  4, prev_obj_val: 2642.08984375, obj_val: 2645.63720703125, abs dis: 3.54736328125
[rfa agg] iter:  4, weight: tensor([9.4785e-05, 1.1821e-01, 4.7821e-02, 4.4637e-02, 1.2529e-01, 6.2965e-02,
        1.8085e-01, 1.2440e-01, 1.7233e-01, 1.2340e-01])
[rfa agg] iter:  5, prev_obj_val: 2645.63720703125, obj_val: 2649.58251953125, abs dis: 3.9453125
[rfa agg] iter:  5, weight: tensor([1.0968e-04, 1.0916e-01, 5.1597e-02, 4.9309e-02, 1.1660e-01, 1.0856e-01,
        1.7166e-01, 1.1506e-01, 1.6364e-01, 1.1430e-01])
[rfa agg] iter:  6, prev_obj_val: 2649.58251953125, obj_val: 2649.579345703125, abs dis: 0.003173828125
[rfa agg] iter:  6, weight: tensor([1.2346e-04, 9.9380e-02, 5.4994e-02, 5.3157e-02, 1.0677e-01, 2.0218e-01,
        1.4033e-01, 1.0501e-01, 1.3377e-01, 1.0430e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 205: Average loss: 0.6495, Accuracy: 7814/10000 (78.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 205: Average loss: 5.8805, Accuracy: 368/9000 (4.0889%)
Done in 168.43752932548523 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:206 choose agents : [51, 4, 97, 85, 17, 59, 13, 57, 76, 80]. Adversary List: []
___Train Local_ResNet_18,  epoch 206, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 438/479 (91.4405%)
___Train Local_ResNet_18,  epoch 206, local model 51, internal_epoch   2,  Average loss: 0.0024, Accuracy: 457/479 (95.4071%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.9322, Accuracy: 3800/10000 (38.0000%)
___Train Local_ResNet_18,  epoch 206, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 485/557 (87.0736%)
___Train Local_ResNet_18,  epoch 206, local model 4, internal_epoch   2,  Average loss: 0.0051, Accuracy: 494/557 (88.6894%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 6.7303, Accuracy: 2627/10000 (26.2700%)
___Train Local_ResNet_18,  epoch 206, local model 97, internal_epoch   1,  Average loss: 0.0028, Accuracy: 395/418 (94.4976%)
___Train Local_ResNet_18,  epoch 206, local model 97, internal_epoch   2,  Average loss: 0.0014, Accuracy: 405/418 (96.8900%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.2322, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 206, local model 85, internal_epoch   1,  Average loss: 0.0077, Accuracy: 302/364 (82.9670%)
___Train Local_ResNet_18,  epoch 206, local model 85, internal_epoch   2,  Average loss: 0.0036, Accuracy: 336/364 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 7.0108, Accuracy: 2076/10000 (20.7600%)
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 206, local model 17, internal_epoch   1,  Average loss: 0.0027, Accuracy: 499/526 (94.8669%)
___Train Local_ResNet_18,  epoch 206, local model 17, internal_epoch   2,  Average loss: 0.0020, Accuracy: 511/526 (97.1483%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.4426, Accuracy: 4846/10000 (48.4600%)
___Train Local_ResNet_18,  epoch 206, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 602/642 (93.7695%)
___Train Local_ResNet_18,  epoch 206, local model 59, internal_epoch   2,  Average loss: 0.0055, Accuracy: 567/642 (88.3178%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 5.7437, Accuracy: 3034/10000 (30.3400%)
___Train Local_ResNet_18,  epoch 206, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 564/620 (90.9677%)
___Train Local_ResNet_18,  epoch 206, local model 13, internal_epoch   2,  Average loss: 0.0039, Accuracy: 576/620 (92.9032%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.9059, Accuracy: 3959/10000 (39.5900%)
___Train Local_ResNet_18,  epoch 206, local model 57, internal_epoch   1,  Average loss: 0.0036, Accuracy: 272/290 (93.7931%)
___Train Local_ResNet_18,  epoch 206, local model 57, internal_epoch   2,  Average loss: 0.0004, Accuracy: 289/290 (99.6552%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.5181, Accuracy: 4922/10000 (49.2200%)
___Train Local_ResNet_18,  epoch 206, local model 76, internal_epoch   1,  Average loss: 0.0271, Accuracy: 65/65 (100.0000%)
___Train Local_ResNet_18,  epoch 206, local model 76, internal_epoch   2,  Average loss: 0.0479, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 0.9329, Accuracy: 7068/10000 (70.6800%)
___Train Local_ResNet_18,  epoch 206, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 320/363 (88.1543%)
___Train Local_ResNet_18,  epoch 206, local model 80, internal_epoch   2,  Average loss: 0.0015, Accuracy: 353/363 (97.2452%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 4.5347, Accuracy: 3243/10000 (32.4300%)
time spent on training: 72.91242408752441
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.12164662349676225  data num: [479, 557, 418, 364, 526, 642, 620, 290, 65, 363]
[rfa agg] considering poison per batch poison_fraction: 0.009503642460684551
[rfa agg] init. name: [51, 4, 97, 85, 17, 59, 13, 57, 76, 80], weight: tensor([0.1108, 0.1288, 0.0967, 0.0842, 0.1216, 0.1485, 0.1434, 0.0671, 0.0150,
        0.0840])
[rfa agg] iter:  0, prev_obj_val: 22.12082862854004, obj_val: 31.296098709106445, abs dis: 9.175270080566406
[rfa agg] iter:  0, weight: tensor([0.1125, 0.0823, 0.2043, 0.1456, 0.0814, 0.0558, 0.0687, 0.0731, 0.0058,
        0.1705])
[rfa agg] iter:  1, prev_obj_val: 31.296098709106445, obj_val: 31.256601333618164, abs dis: 0.03949737548828125
[rfa agg] iter:  1, weight: tensor([0.0758, 0.0659, 0.0990, 0.1396, 0.0636, 0.0516, 0.0597, 0.2823, 0.0106,
        0.1519])
[rfa agg] iter:  2, prev_obj_val: 31.256601333618164, obj_val: 27.69310188293457, abs dis: 3.5634994506835938
[rfa agg] iter:  2, weight: tensor([0.0702, 0.0611, 0.0911, 0.1300, 0.0590, 0.0479, 0.0554, 0.3352, 0.0098,
        0.1404])
[rfa agg] iter:  3, prev_obj_val: 27.69310188293457, obj_val: 24.554075241088867, abs dis: 3.139026641845703
[rfa agg] iter:  3, weight: tensor([0.0788, 0.0657, 0.1115, 0.1669, 0.0638, 0.0495, 0.0582, 0.2029, 0.0080,
        0.1948])
[rfa agg] iter:  4, prev_obj_val: 24.554075241088867, obj_val: 27.681533813476562, abs dis: 3.1274585723876953
[rfa agg] iter:  4, weight: tensor([0.0864, 0.0680, 0.1394, 0.1842, 0.0667, 0.0489, 0.0587, 0.1038, 0.0063,
        0.2376])
[rfa agg] iter:  5, prev_obj_val: 27.681533813476562, obj_val: 27.67632293701172, abs dis: 0.00521087646484375
[rfa agg] iter:  5, weight: tensor([0.0792, 0.0660, 0.1128, 0.1735, 0.0642, 0.0498, 0.0586, 0.1795, 0.0080,
        0.2085])
[rfa agg] iter:  6, prev_obj_val: 27.67632293701172, obj_val: 27.67626953125, abs dis: 5.340576171875e-05
[rfa agg] iter:  6, weight: tensor([0.0790, 0.0658, 0.1121, 0.1725, 0.0640, 0.0496, 0.0584, 0.1865, 0.0080,
        0.2042])
___Test Target_ResNet_18 poisoned: False, epoch: 206: Average loss: 0.6480, Accuracy: 7835/10000 (78.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 206: Average loss: 5.8093, Accuracy: 391/9000 (4.3444%)
Done in 145.51355576515198 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:207 choose agents : [77, 85, 90, 24, 63, 1, 52, 31, 59, 67]. Adversary List: [77]
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   1,  Average loss: 0.0087, Accuracy: 454/496 (91.5323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   2,  Average loss: 0.0076, Accuracy: 442/496 (89.1129%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   3,  Average loss: 0.0038, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   4,  Average loss: 0.0019, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   5,  Average loss: 0.0007, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.6176523530468.
Norm before scaling: 37.763595053015344. Distance: 5.945742698073089
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 0.9431, Accuracy: 6876/10000 (68.7600%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.1843, Accuracy: 8574/9000 (95.2667%)
Scaling by  100
Scaled Norm after poisoning: 593.7159463918751, distance: 594.5742174026722
Total norm for 1 adversaries is: 593.7159463918751. distance: 594.5742174026722
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 207, local model 85, internal_epoch   1,  Average loss: 0.0052, Accuracy: 324/364 (89.0110%)
___Train Local_ResNet_18,  epoch 207, local model 85, internal_epoch   2,  Average loss: 0.0032, Accuracy: 347/364 (95.3297%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 4.3419, Accuracy: 2882/10000 (28.8200%)
___Train Local_ResNet_18,  epoch 207, local model 90, internal_epoch   1,  Average loss: 0.0085, Accuracy: 530/578 (91.6955%)
___Train Local_ResNet_18,  epoch 207, local model 90, internal_epoch   2,  Average loss: 0.0252, Accuracy: 416/578 (71.9723%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 99.6863, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 24, internal_epoch   1,  Average loss: 0.0037, Accuracy: 293/320 (91.5625%)
___Train Local_ResNet_18,  epoch 207, local model 24, internal_epoch   2,  Average loss: 0.0006, Accuracy: 317/320 (99.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 3.5323, Accuracy: 3186/10000 (31.8600%)
___Train Local_ResNet_18,  epoch 207, local model 63, internal_epoch   1,  Average loss: 0.0018, Accuracy: 723/752 (96.1436%)
___Train Local_ResNet_18,  epoch 207, local model 63, internal_epoch   2,  Average loss: 0.0018, Accuracy: 725/752 (96.4096%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 1.6084, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   1,  Average loss: 0.0047, Accuracy: 596/641 (92.9797%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   2,  Average loss: 0.0112, Accuracy: 575/641 (89.7036%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 3.7363, Accuracy: 3649/10000 (36.4900%)
___Train Local_ResNet_18,  epoch 207, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 187/214 (87.3832%)
___Train Local_ResNet_18,  epoch 207, local model 52, internal_epoch   2,  Average loss: 0.0031, Accuracy: 205/214 (95.7944%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 3.3709, Accuracy: 4046/10000 (40.4600%)
___Train Local_ResNet_18,  epoch 207, local model 31, internal_epoch   1,  Average loss: 0.0048, Accuracy: 661/706 (93.6261%)
___Train Local_ResNet_18,  epoch 207, local model 31, internal_epoch   2,  Average loss: 0.0215, Accuracy: 456/706 (64.5892%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 533.7864, Accuracy: 1030/10000 (10.3000%)
___Train Local_ResNet_18,  epoch 207, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 600/642 (93.4579%)
___Train Local_ResNet_18,  epoch 207, local model 59, internal_epoch   2,  Average loss: 0.0284, Accuracy: 434/642 (67.6012%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 26.1569, Accuracy: 1610/10000 (16.1000%)
___Train Local_ResNet_18,  epoch 207, local model 67, internal_epoch   1,  Average loss: 0.0039, Accuracy: 769/842 (91.3302%)
___Train Local_ResNet_18,  epoch 207, local model 67, internal_epoch   2,  Average loss: 0.0089, Accuracy: 720/842 (85.5107%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 25.5510, Accuracy: 1700/10000 (17.0000%)
time spent on training: 100.95280933380127
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0892889288928893  data num: [496, 364, 578, 320, 752, 641, 214, 706, 642, 842]
[rfa agg] considering poison per batch poison_fraction: 0.006975697569756976
[rfa agg] init. name: [77, 85, 90, 24, 63, 1, 52, 31, 59, 67], weight: tensor([0.0893, 0.0655, 0.1041, 0.0576, 0.1354, 0.1154, 0.0385, 0.1271, 0.1156,
        0.1516])
[rfa agg] iter:  0, prev_obj_val: 3462.872802734375, obj_val: 2055.734130859375, abs dis: 1407.138671875
[rfa agg] iter:  0, weight: tensor([0.0094, 0.0697, 0.1128, 0.0610, 0.1482, 0.1257, 0.0406, 0.1391, 0.1259,
        0.1675])
[rfa agg] iter:  1, prev_obj_val: 2055.734130859375, obj_val: 1934.697998046875, abs dis: 121.0361328125
[rfa agg] iter:  1, weight: tensor([0.0008, 0.0574, 0.1085, 0.0485, 0.1570, 0.1269, 0.0312, 0.1464, 0.1266,
        0.1966])
[rfa agg] iter:  2, prev_obj_val: 1934.697998046875, obj_val: 1941.35009765625, abs dis: 6.652099609375
[rfa agg] iter:  2, weight: tensor([1.0832e-04, 4.6186e-02, 1.4116e-01, 3.3019e-02, 1.7727e-01, 2.1666e-01,
        1.8436e-02, 1.1974e-01, 1.4381e-01, 1.0361e-01])
[rfa agg] iter:  3, prev_obj_val: 1941.35009765625, obj_val: 1943.962646484375, abs dis: 2.612548828125
[rfa agg] iter:  3, weight: tensor([1.4256e-04, 9.3381e-02, 1.5642e-01, 6.1386e-02, 1.4276e-01, 1.6209e-01,
        3.2121e-02, 1.1418e-01, 1.3629e-01, 1.0123e-01])
[rfa agg] iter:  4, prev_obj_val: 1943.962646484375, obj_val: 1946.6920166015625, abs dis: 2.7293701171875
[rfa agg] iter:  4, weight: tensor([0.0002, 0.1204, 0.1488, 0.0755, 0.1335, 0.1460, 0.0382, 0.1101, 0.1284,
        0.0990])
[rfa agg] iter:  5, prev_obj_val: 1946.6920166015625, obj_val: 1952.4422607421875, abs dis: 5.750244140625
[rfa agg] iter:  5, weight: tensor([1.5568e-04, 1.5683e-01, 1.3516e-01, 9.2383e-02, 1.2296e-01, 1.3104e-01,
        4.4747e-02, 1.0370e-01, 1.1839e-01, 9.4645e-02])
[rfa agg] iter:  6, prev_obj_val: 1952.4422607421875, obj_val: 1946.7120361328125, abs dis: 5.730224609375
[rfa agg] iter:  6, weight: tensor([1.4571e-04, 2.6246e-01, 1.0033e-01, 1.3656e-01, 9.4904e-02, 9.7262e-02,
        5.7508e-02, 8.2533e-02, 9.0947e-02, 7.7349e-02])
[rfa agg] iter:  7, prev_obj_val: 1946.7120361328125, obj_val: 1952.4384765625, abs dis: 5.7264404296875
[rfa agg] iter:  7, weight: tensor([1.5465e-04, 1.6433e-01, 1.3182e-01, 9.2970e-02, 1.2247e-01, 1.3031e-01,
        4.4761e-02, 1.0247e-01, 1.1665e-01, 9.4065e-02])
[rfa agg] iter:  8, prev_obj_val: 1952.4384765625, obj_val: 1952.409912109375, abs dis: 0.028564453125
[rfa agg] iter:  8, weight: tensor([1.4535e-04, 2.6412e-01, 9.9997e-02, 1.3644e-01, 9.4681e-02, 9.7035e-02,
        5.7404e-02, 8.2316e-02, 9.0700e-02, 7.7160e-02])
___Test Target_ResNet_18 poisoned: False, epoch: 207: Average loss: 0.6566, Accuracy: 7809/10000 (78.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 207: Average loss: 5.6960, Accuracy: 374/9000 (4.1556%)
Done in 176.5257751941681 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:208 choose agents : [71, 66, 76, 96, 80, 81, 22, 72, 64, 45]. Adversary List: []
___Train Local_ResNet_18,  epoch 208, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 1106/1166 (94.8542%)
___Train Local_ResNet_18,  epoch 208, local model 71, internal_epoch   2,  Average loss: 0.0109, Accuracy: 927/1166 (79.5026%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 6.3690, Accuracy: 2618/10000 (26.1800%)
___Train Local_ResNet_18,  epoch 208, local model 66, internal_epoch   1,  Average loss: 0.0043, Accuracy: 509/555 (91.7117%)
___Train Local_ResNet_18,  epoch 208, local model 66, internal_epoch   2,  Average loss: 0.0024, Accuracy: 533/555 (96.0360%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 6.4664, Accuracy: 2872/10000 (28.7200%)
___Train Local_ResNet_18,  epoch 208, local model 76, internal_epoch   1,  Average loss: 0.0317, Accuracy: 64/65 (98.4615%)
___Train Local_ResNet_18,  epoch 208, local model 76, internal_epoch   2,  Average loss: 0.0024, Accuracy: 65/65 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.6419, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 208, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 660/708 (93.2203%)
___Train Local_ResNet_18,  epoch 208, local model 96, internal_epoch   2,  Average loss: 0.0216, Accuracy: 494/708 (69.7740%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 110.0009, Accuracy: 997/10000 (9.9700%)
___Train Local_ResNet_18,  epoch 208, local model 80, internal_epoch   1,  Average loss: 0.0045, Accuracy: 329/363 (90.6336%)
___Train Local_ResNet_18,  epoch 208, local model 80, internal_epoch   2,  Average loss: 0.0017, Accuracy: 354/363 (97.5207%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 3.7735, Accuracy: 3992/10000 (39.9200%)
___Train Local_ResNet_18,  epoch 208, local model 81, internal_epoch   1,  Average loss: 0.0059, Accuracy: 935/1034 (90.4255%)
___Train Local_ResNet_18,  epoch 208, local model 81, internal_epoch   2,  Average loss: 0.0150, Accuracy: 734/1034 (70.9865%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 90.2998, Accuracy: 1178/10000 (11.7800%)
___Train Local_ResNet_18,  epoch 208, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 437/494 (88.4615%)
___Train Local_ResNet_18,  epoch 208, local model 22, internal_epoch   2,  Average loss: 0.0021, Accuracy: 471/494 (95.3441%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 3.0291, Accuracy: 3896/10000 (38.9600%)
___Train Local_ResNet_18,  epoch 208, local model 72, internal_epoch   1,  Average loss: 0.0097, Accuracy: 508/618 (82.2006%)
___Train Local_ResNet_18,  epoch 208, local model 72, internal_epoch   2,  Average loss: 0.0090, Accuracy: 521/618 (84.3042%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 6.1955, Accuracy: 2746/10000 (27.4600%)
___Train Local_ResNet_18,  epoch 208, local model 64, internal_epoch   1,  Average loss: 0.0029, Accuracy: 645/686 (94.0233%)
___Train Local_ResNet_18,  epoch 208, local model 64, internal_epoch   2,  Average loss: 0.0025, Accuracy: 654/686 (95.3353%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.0559, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 208, local model 45, internal_epoch   1,  Average loss: 0.0050, Accuracy: 477/529 (90.1701%)
___Train Local_ResNet_18,  epoch 208, local model 45, internal_epoch   2,  Average loss: 0.0053, Accuracy: 479/529 (90.5482%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 6.5977, Accuracy: 2044/10000 (20.4400%)
time spent on training: 66.10348534584045
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [1166, 555, 65, 708, 363, 1034, 494, 618, 686, 529]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [71, 66, 76, 96, 80, 81, 22, 72, 64, 45], weight: tensor([0.1875, 0.0893, 0.0105, 0.1139, 0.0584, 0.1663, 0.0794, 0.0994, 0.1103,
        0.0851])
[rfa agg] iter:  0, prev_obj_val: 39.2066650390625, obj_val: 41.936466217041016, abs dis: 2.7298011779785156
[rfa agg] iter:  0, weight: tensor([0.0536, 0.1557, 0.0034, 0.1023, 0.0374, 0.0594, 0.0914, 0.1604, 0.1972,
        0.1393])
[rfa agg] iter:  1, prev_obj_val: 41.936466217041016, obj_val: 47.13957977294922, abs dis: 5.203113555908203
[rfa agg] iter:  1, weight: tensor([0.0428, 0.2225, 0.0035, 0.0726, 0.0440, 0.0463, 0.1338, 0.1324, 0.1184,
        0.1838])
[rfa agg] iter:  2, prev_obj_val: 47.13957977294922, obj_val: 50.37749099731445, abs dis: 3.2379112243652344
[rfa agg] iter:  2, weight: tensor([0.0441, 0.1791, 0.0046, 0.0659, 0.0720, 0.0469, 0.2315, 0.1054, 0.0928,
        0.1578])
[rfa agg] iter:  3, prev_obj_val: 50.37749099731445, obj_val: 53.89714431762695, abs dis: 3.5196533203125
[rfa agg] iter:  3, weight: tensor([0.0472, 0.1508, 0.0056, 0.0671, 0.1032, 0.0498, 0.2486, 0.1000, 0.0898,
        0.1379])
[rfa agg] iter:  4, prev_obj_val: 53.89714431762695, obj_val: 57.5655632019043, abs dis: 3.6684188842773438
[rfa agg] iter:  4, weight: tensor([0.0513, 0.1355, 0.0069, 0.0697, 0.1593, 0.0538, 0.2095, 0.0985, 0.0897,
        0.1258])
[rfa agg] iter:  5, prev_obj_val: 57.5655632019043, obj_val: 61.39069366455078, abs dis: 3.8251304626464844
[rfa agg] iter:  5, weight: tensor([0.0521, 0.1182, 0.0081, 0.0680, 0.2476, 0.0543, 0.1644, 0.0918, 0.0848,
        0.1106])
[rfa agg] iter:  6, prev_obj_val: 61.39069366455078, obj_val: 57.56220245361328, abs dis: 3.8284912109375
[rfa agg] iter:  6, weight: tensor([0.0502, 0.1004, 0.0092, 0.0630, 0.3433, 0.0520, 0.1291, 0.0819, 0.0766,
        0.0943])
[rfa agg] iter:  7, prev_obj_val: 57.56220245361328, obj_val: 57.55770492553711, abs dis: 0.004497528076171875
[rfa agg] iter:  7, weight: tensor([0.0506, 0.1144, 0.0079, 0.0658, 0.2745, 0.0527, 0.1563, 0.0888, 0.0822,
        0.1068])
[rfa agg] iter:  8, prev_obj_val: 57.55770492553711, obj_val: 57.557613372802734, abs dis: 9.1552734375e-05
[rfa agg] iter:  8, weight: tensor([0.0512, 0.1159, 0.0080, 0.0667, 0.2642, 0.0533, 0.1593, 0.0900, 0.0832,
        0.1083])
___Test Target_ResNet_18 poisoned: False, epoch: 208: Average loss: 0.6564, Accuracy: 7804/10000 (78.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 208: Average loss: 5.6341, Accuracy: 344/9000 (3.8222%)
Done in 140.3050103187561 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:209 choose agents : [11, 80, 54, 44, 35, 68, 25, 4, 79, 43]. Adversary List: [11]
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   1,  Average loss: 0.0091, Accuracy: 481/546 (88.0952%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   2,  Average loss: 0.0071, Accuracy: 497/546 (91.0256%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   3,  Average loss: 0.0027, Accuracy: 526/546 (96.3370%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   4,  Average loss: 0.0017, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.60338288368315.
Norm before scaling: 37.909011325124766. Distance: 7.130601788948714
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.2213, Accuracy: 6225/10000 (62.2500%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.3058, Accuracy: 8291/9000 (92.1222%)
Scaling by  100
Scaled Norm after poisoning: 712.1040347098168, distance: 713.0601964420675
Total norm for 1 adversaries is: 712.1040347098168. distance: 713.0601964420675
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 209, local model 80, internal_epoch   1,  Average loss: 0.0031, Accuracy: 346/363 (95.3168%)
___Train Local_ResNet_18,  epoch 209, local model 80, internal_epoch   2,  Average loss: 0.0008, Accuracy: 360/363 (99.1736%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 3.2163, Accuracy: 4464/10000 (44.6400%)
___Train Local_ResNet_18,  epoch 209, local model 54, internal_epoch   1,  Average loss: 0.0032, Accuracy: 412/440 (93.6364%)
___Train Local_ResNet_18,  epoch 209, local model 54, internal_epoch   2,  Average loss: 0.0017, Accuracy: 429/440 (97.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 3.3067, Accuracy: 4025/10000 (40.2500%)
___Train Local_ResNet_18,  epoch 209, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 405/436 (92.8899%)
___Train Local_ResNet_18,  epoch 209, local model 44, internal_epoch   2,  Average loss: 0.0020, Accuracy: 424/436 (97.2477%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 2.5652, Accuracy: 4379/10000 (43.7900%)
___Train Local_ResNet_18,  epoch 209, local model 35, internal_epoch   1,  Average loss: 0.0053, Accuracy: 377/419 (89.9761%)
___Train Local_ResNet_18,  epoch 209, local model 35, internal_epoch   2,  Average loss: 0.0024, Accuracy: 404/419 (96.4200%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 4.1815, Accuracy: 3225/10000 (32.2500%)
___Train Local_ResNet_18,  epoch 209, local model 68, internal_epoch   1,  Average loss: 0.0023, Accuracy: 402/416 (96.6346%)
___Train Local_ResNet_18,  epoch 209, local model 68, internal_epoch   2,  Average loss: 0.0012, Accuracy: 410/416 (98.5577%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.3872, Accuracy: 6249/10000 (62.4900%)
___Train Local_ResNet_18,  epoch 209, local model 25, internal_epoch   1,  Average loss: 0.0035, Accuracy: 512/545 (93.9450%)
___Train Local_ResNet_18,  epoch 209, local model 25, internal_epoch   2,  Average loss: 0.0020, Accuracy: 526/545 (96.5138%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 3.5439, Accuracy: 3967/10000 (39.6700%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 507/557 (91.0233%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 511/557 (91.7415%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 3.1598, Accuracy: 4612/10000 (46.1200%)
___Train Local_ResNet_18,  epoch 209, local model 79, internal_epoch   1,  Average loss: 0.0063, Accuracy: 136/154 (88.3117%)
___Train Local_ResNet_18,  epoch 209, local model 79, internal_epoch   2,  Average loss: 0.0005, Accuracy: 154/154 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.0629, Accuracy: 6819/10000 (68.1900%)
___Train Local_ResNet_18,  epoch 209, local model 43, internal_epoch   1,  Average loss: 0.0036, Accuracy: 324/345 (93.9130%)
___Train Local_ResNet_18,  epoch 209, local model 43, internal_epoch   2,  Average loss: 0.0009, Accuracy: 337/345 (97.6812%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 3.9511, Accuracy: 3962/10000 (39.6200%)
time spent on training: 93.41478729248047
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.12935323383084577  data num: [546, 363, 440, 436, 419, 416, 545, 557, 154, 345]
[rfa agg] considering poison per batch poison_fraction: 0.010105721393034825
[rfa agg] init. name: [11, 80, 54, 44, 35, 68, 25, 4, 79, 43], weight: tensor([0.1294, 0.0860, 0.1042, 0.1033, 0.0993, 0.0986, 0.1291, 0.1320, 0.0365,
        0.0817])
[rfa agg] iter:  0, prev_obj_val: 5414.3310546875, obj_val: 3483.8486328125, abs dis: 1930.482421875
[rfa agg] iter:  0, weight: tensor([0.0215, 0.0963, 0.1171, 0.1160, 0.1115, 0.1107, 0.1459, 0.1491, 0.0405,
        0.0915])
[rfa agg] iter:  1, prev_obj_val: 3483.8486328125, obj_val: 3155.760498046875, abs dis: 328.088134765625
[rfa agg] iter:  1, weight: tensor([0.0031, 0.0963, 0.1188, 0.1177, 0.1131, 0.1123, 0.1526, 0.1560, 0.0388,
        0.0915])
[rfa agg] iter:  2, prev_obj_val: 3155.760498046875, obj_val: 3135.412109375, abs dis: 20.348388671875
[rfa agg] iter:  2, weight: tensor([0.0003, 0.0772, 0.1089, 0.1079, 0.1034, 0.1031, 0.2000, 0.2029, 0.0230,
        0.0733])
[rfa agg] iter:  3, prev_obj_val: 3135.412109375, obj_val: 3139.21630859375, abs dis: 3.80419921875
[rfa agg] iter:  3, weight: tensor([8.5442e-05, 2.1036e-01, 1.1413e-01, 1.1421e-01, 1.0507e-01, 1.1037e-01,
        6.4500e-02, 6.5381e-02, 2.5666e-02, 1.9023e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 209: Average loss: 0.6576, Accuracy: 7787/10000 (77.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 209: Average loss: 5.6237, Accuracy: 335/9000 (3.7222%)
Done in 152.20386695861816 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:210 choose agents : [63, 35, 49, 8, 12, 18, 94, 57, 83, 37]. Adversary List: []
___Train Local_ResNet_18,  epoch 210, local model 63, internal_epoch   1,  Average loss: 0.0015, Accuracy: 731/752 (97.2074%)
___Train Local_ResNet_18,  epoch 210, local model 63, internal_epoch   2,  Average loss: 0.0010, Accuracy: 737/752 (98.0053%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.6808, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 210, local model 35, internal_epoch   1,  Average loss: 0.0053, Accuracy: 373/419 (89.0215%)
___Train Local_ResNet_18,  epoch 210, local model 35, internal_epoch   2,  Average loss: 0.0032, Accuracy: 405/419 (96.6587%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 3.2687, Accuracy: 3609/10000 (36.0900%)
___Train Local_ResNet_18,  epoch 210, local model 49, internal_epoch   1,  Average loss: 0.0025, Accuracy: 405/426 (95.0704%)
___Train Local_ResNet_18,  epoch 210, local model 49, internal_epoch   2,  Average loss: 0.0007, Accuracy: 422/426 (99.0610%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 2.0906, Accuracy: 4803/10000 (48.0300%)
___Train Local_ResNet_18,  epoch 210, local model 8, internal_epoch   1,  Average loss: 0.0024, Accuracy: 511/534 (95.6929%)
___Train Local_ResNet_18,  epoch 210, local model 8, internal_epoch   2,  Average loss: 0.0018, Accuracy: 520/534 (97.3783%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.6394, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 210, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 877/977 (89.7646%)
___Train Local_ResNet_18,  epoch 210, local model 12, internal_epoch   2,  Average loss: 0.0084, Accuracy: 828/977 (84.7492%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 7.5599, Accuracy: 3058/10000 (30.5800%)
___Train Local_ResNet_18,  epoch 210, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 363/386 (94.0415%)
___Train Local_ResNet_18,  epoch 210, local model 18, internal_epoch   2,  Average loss: 0.0114, Accuracy: 373/386 (96.6321%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 3.0196, Accuracy: 3999/10000 (39.9900%)
___Train Local_ResNet_18,  epoch 210, local model 94, internal_epoch   1,  Average loss: 0.0107, Accuracy: 176/203 (86.6995%)
___Train Local_ResNet_18,  epoch 210, local model 94, internal_epoch   2,  Average loss: 0.0103, Accuracy: 193/203 (95.0739%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 21.9291, Accuracy: 1033/10000 (10.3300%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   1,  Average loss: 0.0026, Accuracy: 278/290 (95.8621%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   2,  Average loss: 0.0006, Accuracy: 288/290 (99.3103%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.6916, Accuracy: 5905/10000 (59.0500%)
___Train Local_ResNet_18,  epoch 210, local model 83, internal_epoch   1,  Average loss: 0.0018, Accuracy: 359/366 (98.0874%)
___Train Local_ResNet_18,  epoch 210, local model 83, internal_epoch   2,  Average loss: 0.0006, Accuracy: 364/366 (99.4536%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.2238, Accuracy: 6477/10000 (64.7700%)
___Train Local_ResNet_18,  epoch 210, local model 37, internal_epoch   1,  Average loss: 0.0052, Accuracy: 657/725 (90.6207%)
___Train Local_ResNet_18,  epoch 210, local model 37, internal_epoch   2,  Average loss: 0.0072, Accuracy: 632/725 (87.1724%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 4.6464, Accuracy: 2497/10000 (24.9700%)
time spent on training: 63.01345777511597
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [752, 419, 426, 534, 977, 386, 203, 290, 366, 725]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [63, 35, 49, 8, 12, 18, 94, 57, 83, 37], weight: tensor([0.1481, 0.0825, 0.0839, 0.1052, 0.1924, 0.0760, 0.0400, 0.0571, 0.0721,
        0.1428])
[rfa agg] iter:  0, prev_obj_val: 32.915283203125, obj_val: 40.28940963745117, abs dis: 7.374126434326172
[rfa agg] iter:  0, weight: tensor([0.0834, 0.1483, 0.1629, 0.1900, 0.0542, 0.1380, 0.0223, 0.0429, 0.0798,
        0.0782])
[rfa agg] iter:  1, prev_obj_val: 40.28940963745117, obj_val: 47.238243103027344, abs dis: 6.948833465576172
[rfa agg] iter:  1, weight: tensor([0.0444, 0.1242, 0.1361, 0.0620, 0.0344, 0.1149, 0.0333, 0.0947, 0.3139,
        0.0422])
[rfa agg] iter:  2, prev_obj_val: 47.238243103027344, obj_val: 43.59429931640625, abs dis: 3.6439437866210938
[rfa agg] iter:  2, weight: tensor([0.0472, 0.0876, 0.0914, 0.0579, 0.0387, 0.0810, 0.0689, 0.3276, 0.1548,
        0.0449])
[rfa agg] iter:  3, prev_obj_val: 43.59429931640625, obj_val: 43.58592987060547, abs dis: 0.00836944580078125
[rfa agg] iter:  3, weight: tensor([0.0471, 0.1037, 0.1102, 0.0612, 0.0377, 0.0961, 0.0489, 0.2045, 0.2457,
        0.0448])
[rfa agg] iter:  4, prev_obj_val: 43.58592987060547, obj_val: 43.58588409423828, abs dis: 4.57763671875e-05
[rfa agg] iter:  4, weight: tensor([0.0471, 0.1041, 0.1105, 0.0612, 0.0376, 0.0964, 0.0487, 0.1957, 0.2537,
        0.0448])
___Test Target_ResNet_18 poisoned: False, epoch: 210: Average loss: 0.6489, Accuracy: 7813/10000 (78.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 210: Average loss: 5.5693, Accuracy: 382/9000 (4.2444%)
Done in 124.17432570457458 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:211 choose agents : [22, 38, 65, 29, 18, 53, 15, 7, 86, 60]. Adversary List: []
___Train Local_ResNet_18,  epoch 211, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 442/494 (89.4737%)
___Train Local_ResNet_18,  epoch 211, local model 22, internal_epoch   2,  Average loss: 0.0022, Accuracy: 473/494 (95.7490%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 3.8781, Accuracy: 3426/10000 (34.2600%)
___Train Local_ResNet_18,  epoch 211, local model 38, internal_epoch   1,  Average loss: 0.0033, Accuracy: 710/756 (93.9153%)
___Train Local_ResNet_18,  epoch 211, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 695/756 (91.9312%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 5.2796, Accuracy: 3052/10000 (30.5200%)
___Train Local_ResNet_18,  epoch 211, local model 65, internal_epoch   1,  Average loss: 0.0035, Accuracy: 291/314 (92.6752%)
___Train Local_ResNet_18,  epoch 211, local model 65, internal_epoch   2,  Average loss: 0.0008, Accuracy: 313/314 (99.6815%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.6108, Accuracy: 4256/10000 (42.5600%)
___Train Local_ResNet_18,  epoch 211, local model 29, internal_epoch   1,  Average loss: 0.0051, Accuracy: 769/848 (90.6840%)
___Train Local_ResNet_18,  epoch 211, local model 29, internal_epoch   2,  Average loss: 0.0046, Accuracy: 779/848 (91.8632%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 6.8458, Accuracy: 1973/10000 (19.7300%)
___Train Local_ResNet_18,  epoch 211, local model 18, internal_epoch   1,  Average loss: 0.0023, Accuracy: 366/386 (94.8187%)
___Train Local_ResNet_18,  epoch 211, local model 18, internal_epoch   2,  Average loss: 0.0084, Accuracy: 380/386 (98.4456%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 4.3013, Accuracy: 2815/10000 (28.1500%)
___Train Local_ResNet_18,  epoch 211, local model 53, internal_epoch   1,  Average loss: 0.0031, Accuracy: 580/625 (92.8000%)
___Train Local_ResNet_18,  epoch 211, local model 53, internal_epoch   2,  Average loss: 0.0020, Accuracy: 602/625 (96.3200%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.1539, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch 211, local model 15, internal_epoch   1,  Average loss: 0.0082, Accuracy: 290/341 (85.0440%)
___Train Local_ResNet_18,  epoch 211, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 321/341 (94.1349%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 4.9605, Accuracy: 3053/10000 (30.5300%)
___Train Local_ResNet_18,  epoch 211, local model 7, internal_epoch   1,  Average loss: 0.0018, Accuracy: 343/352 (97.4432%)
___Train Local_ResNet_18,  epoch 211, local model 7, internal_epoch   2,  Average loss: 0.0005, Accuracy: 350/352 (99.4318%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.2146, Accuracy: 4619/10000 (46.1900%)
___Train Local_ResNet_18,  epoch 211, local model 86, internal_epoch   1,  Average loss: 0.0031, Accuracy: 203/212 (95.7547%)
___Train Local_ResNet_18,  epoch 211, local model 86, internal_epoch   2,  Average loss: 0.0007, Accuracy: 212/212 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.2940, Accuracy: 6418/10000 (64.1800%)
___Train Local_ResNet_18,  epoch 211, local model 60, internal_epoch   1,  Average loss: 0.0032, Accuracy: 266/284 (93.6620%)
___Train Local_ResNet_18,  epoch 211, local model 60, internal_epoch   2,  Average loss: 0.0008, Accuracy: 281/284 (98.9437%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.8484, Accuracy: 5141/10000 (51.4100%)
time spent on training: 61.80274677276611
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [494, 756, 314, 848, 386, 625, 341, 352, 212, 284]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [22, 38, 65, 29, 18, 53, 15, 7, 86, 60], weight: tensor([0.1071, 0.1639, 0.0681, 0.1839, 0.0837, 0.1355, 0.0739, 0.0763, 0.0460,
        0.0616])
[rfa agg] iter:  0, prev_obj_val: 33.356510162353516, obj_val: 38.63664627075195, abs dis: 5.2801361083984375
[rfa agg] iter:  0, weight: tensor([0.0884, 0.0480, 0.1057, 0.0405, 0.1167, 0.0591, 0.1481, 0.2576, 0.0396,
        0.0962])
[rfa agg] iter:  1, prev_obj_val: 38.63664627075195, obj_val: 54.92356872558594, abs dis: 16.286922454833984
[rfa agg] iter:  1, weight: tensor([0.0575, 0.0384, 0.2453, 0.0336, 0.0656, 0.0444, 0.0974, 0.1197, 0.0701,
        0.2280])
[rfa agg] iter:  2, prev_obj_val: 54.92356872558594, obj_val: 38.62761688232422, abs dis: 16.29595184326172
[rfa agg] iter:  2, weight: tensor([0.0844, 0.0721, 0.1334, 0.0661, 0.0821, 0.0766, 0.0948, 0.1006, 0.1693,
        0.1207])
[rfa agg] iter:  3, prev_obj_val: 38.62761688232422, obj_val: 54.924293518066406, abs dis: 16.296676635742188
[rfa agg] iter:  3, weight: tensor([0.0567, 0.0379, 0.2508, 0.0331, 0.0645, 0.0438, 0.0938, 0.1157, 0.0704,
        0.2333])
[rfa agg] iter:  4, prev_obj_val: 54.924293518066406, obj_val: 38.62761306762695, abs dis: 16.296680450439453
[rfa agg] iter:  4, weight: tensor([0.0844, 0.0720, 0.1334, 0.0661, 0.0821, 0.0766, 0.0948, 0.1006, 0.1693,
        0.1207])
[rfa agg] iter:  5, prev_obj_val: 38.62761306762695, obj_val: 54.92428970336914, abs dis: 16.296676635742188
[rfa agg] iter:  5, weight: tensor([0.0567, 0.0379, 0.2508, 0.0331, 0.0645, 0.0438, 0.0938, 0.1157, 0.0704,
        0.2333])
[rfa agg] iter:  6, prev_obj_val: 54.92428970336914, obj_val: 38.62761306762695, abs dis: 16.296676635742188
[rfa agg] iter:  6, weight: tensor([0.0844, 0.0720, 0.1334, 0.0661, 0.0821, 0.0766, 0.0948, 0.1006, 0.1693,
        0.1207])
[rfa agg] iter:  7, prev_obj_val: 38.62761306762695, obj_val: 54.92428970336914, abs dis: 16.296676635742188
[rfa agg] iter:  7, weight: tensor([0.0567, 0.0379, 0.2508, 0.0331, 0.0645, 0.0438, 0.0938, 0.1157, 0.0704,
        0.2333])
[rfa agg] iter:  8, prev_obj_val: 54.92428970336914, obj_val: 38.62761306762695, abs dis: 16.296676635742188
[rfa agg] iter:  8, weight: tensor([0.0844, 0.0720, 0.1334, 0.0661, 0.0821, 0.0766, 0.0948, 0.1006, 0.1693,
        0.1207])
[rfa agg] iter:  9, prev_obj_val: 38.62761306762695, obj_val: 54.92428970336914, abs dis: 16.296676635742188
[rfa agg] iter:  9, weight: tensor([0.0567, 0.0379, 0.2508, 0.0331, 0.0645, 0.0438, 0.0938, 0.1157, 0.0704,
        0.2333])
___Test Target_ResNet_18 poisoned: False, epoch: 211: Average loss: 0.6422, Accuracy: 7836/10000 (78.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 211: Average loss: 5.6360, Accuracy: 372/9000 (4.1333%)
Done in 130.31073570251465 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:212 choose agents : [81, 8, 28, 77, 1, 93, 53, 12, 50, 10]. Adversary List: []
___Train Local_ResNet_18,  epoch 212, local model 81, internal_epoch   1,  Average loss: 0.0060, Accuracy: 918/1034 (88.7814%)
___Train Local_ResNet_18,  epoch 212, local model 81, internal_epoch   2,  Average loss: 0.0138, Accuracy: 787/1034 (76.1122%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 56.1262, Accuracy: 1329/10000 (13.2900%)
___Train Local_ResNet_18,  epoch 212, local model 8, internal_epoch   1,  Average loss: 0.0024, Accuracy: 510/534 (95.5056%)
___Train Local_ResNet_18,  epoch 212, local model 8, internal_epoch   2,  Average loss: 0.0024, Accuracy: 512/534 (95.8801%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 2.4636, Accuracy: 4492/10000 (44.9200%)
___Train Local_ResNet_18,  epoch 212, local model 28, internal_epoch   1,  Average loss: 0.0021, Accuracy: 405/423 (95.7447%)
___Train Local_ResNet_18,  epoch 212, local model 28, internal_epoch   2,  Average loss: 0.0014, Accuracy: 415/423 (98.1087%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 2.4644, Accuracy: 4727/10000 (47.2700%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 212, local model 77, internal_epoch   1,  Average loss: 0.0015, Accuracy: 489/496 (98.5887%)
___Train Local_ResNet_18,  epoch 212, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 494/496 (99.5968%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1.2749, Accuracy: 6355/10000 (63.5500%)
___Train Local_ResNet_18,  epoch 212, local model 1, internal_epoch   1,  Average loss: 0.0046, Accuracy: 616/641 (96.0998%)
___Train Local_ResNet_18,  epoch 212, local model 1, internal_epoch   2,  Average loss: 0.0118, Accuracy: 580/641 (90.4836%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 2.9254, Accuracy: 3795/10000 (37.9500%)
___Train Local_ResNet_18,  epoch 212, local model 93, internal_epoch   1,  Average loss: 0.0028, Accuracy: 551/584 (94.3493%)
___Train Local_ResNet_18,  epoch 212, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 526/584 (90.0685%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 3.8350, Accuracy: 3282/10000 (32.8200%)
___Train Local_ResNet_18,  epoch 212, local model 53, internal_epoch   1,  Average loss: 0.0030, Accuracy: 587/625 (93.9200%)
___Train Local_ResNet_18,  epoch 212, local model 53, internal_epoch   2,  Average loss: 0.0020, Accuracy: 600/625 (96.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 3.3099, Accuracy: 3807/10000 (38.0700%)
___Train Local_ResNet_18,  epoch 212, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 889/977 (90.9928%)
___Train Local_ResNet_18,  epoch 212, local model 12, internal_epoch   2,  Average loss: 0.0111, Accuracy: 779/977 (79.7339%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 9.5606, Accuracy: 3333/10000 (33.3300%)
___Train Local_ResNet_18,  epoch 212, local model 50, internal_epoch   1,  Average loss: 0.0021, Accuracy: 387/401 (96.5087%)
___Train Local_ResNet_18,  epoch 212, local model 50, internal_epoch   2,  Average loss: 0.0006, Accuracy: 397/401 (99.0025%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 2.0035, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 212, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 693/752 (92.1543%)
___Train Local_ResNet_18,  epoch 212, local model 10, internal_epoch   2,  Average loss: 0.0030, Accuracy: 709/752 (94.2819%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 5.1158, Accuracy: 3184/10000 (31.8400%)
time spent on training: 70.42988467216492
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0766970774702335  data num: [1034, 534, 423, 496, 641, 584, 625, 977, 401, 752]
[rfa agg] considering poison per batch poison_fraction: 0.005991959177361991
[rfa agg] init. name: [81, 8, 28, 77, 1, 93, 53, 12, 50, 10], weight: tensor([0.1599, 0.0826, 0.0654, 0.0767, 0.0991, 0.0903, 0.0966, 0.1511, 0.0620,
        0.1163])
[rfa agg] iter:  0, prev_obj_val: 35.47026443481445, obj_val: 37.726654052734375, abs dis: 2.256389617919922
[rfa agg] iter:  0, weight: tensor([0.0402, 0.1743, 0.0867, 0.2007, 0.0799, 0.1033, 0.1200, 0.0433, 0.0822,
        0.0694])
[rfa agg] iter:  1, prev_obj_val: 37.726654052734375, obj_val: 40.7676887512207, abs dis: 3.041034698486328
[rfa agg] iter:  1, weight: tensor([0.0323, 0.1269, 0.1086, 0.3240, 0.0589, 0.0744, 0.0843, 0.0346, 0.1034,
        0.0525])
[rfa agg] iter:  2, prev_obj_val: 40.7676887512207, obj_val: 44.22045135498047, abs dis: 3.4527626037597656
[rfa agg] iter:  2, weight: tensor([0.0320, 0.0970, 0.1813, 0.2433, 0.0533, 0.0646, 0.0720, 0.0341, 0.1734,
        0.0491])
[rfa agg] iter:  3, prev_obj_val: 44.22045135498047, obj_val: 48.24116134643555, abs dis: 4.020709991455078
[rfa agg] iter:  3, weight: tensor([0.0294, 0.0731, 0.2709, 0.1351, 0.0454, 0.0533, 0.0587, 0.0311, 0.2602,
        0.0429])
[rfa agg] iter:  4, prev_obj_val: 48.24116134643555, obj_val: 44.20673370361328, abs dis: 4.034427642822266
[rfa agg] iter:  4, weight: tensor([0.0370, 0.0786, 0.2517, 0.1221, 0.0534, 0.0610, 0.0668, 0.0389, 0.2391,
        0.0515])
[rfa agg] iter:  5, prev_obj_val: 44.20673370361328, obj_val: 56.89952087402344, abs dis: 12.692787170410156
[rfa agg] iter:  5, weight: tensor([0.0285, 0.0706, 0.2810, 0.1282, 0.0440, 0.0516, 0.0569, 0.0301, 0.2675,
        0.0415])
[rfa agg] iter:  6, prev_obj_val: 56.89952087402344, obj_val: 48.25285339355469, abs dis: 8.64666748046875
[rfa agg] iter:  6, weight: tensor([0.0570, 0.0964, 0.1762, 0.1264, 0.0741, 0.0814, 0.0883, 0.0593, 0.1671,
        0.0737])
[rfa agg] iter:  7, prev_obj_val: 48.25285339355469, obj_val: 40.76520538330078, abs dis: 7.487648010253906
[rfa agg] iter:  7, weight: tensor([0.0384, 0.0815, 0.2417, 0.1260, 0.0555, 0.0634, 0.0694, 0.0404, 0.2303,
        0.0535])
[rfa agg] iter:  8, prev_obj_val: 40.76520538330078, obj_val: 44.21660232543945, abs dis: 3.451396942138672
[rfa agg] iter:  8, weight: tensor([0.0319, 0.0959, 0.1934, 0.2230, 0.0531, 0.0643, 0.0717, 0.0340, 0.1838,
        0.0489])
[rfa agg] iter:  9, prev_obj_val: 44.21660232543945, obj_val: 52.53706359863281, abs dis: 8.32046127319336
[rfa agg] iter:  9, weight: tensor([0.0292, 0.0726, 0.2729, 0.1338, 0.0451, 0.0529, 0.0583, 0.0309, 0.2615,
        0.0426])
___Test Target_ResNet_18 poisoned: False, epoch: 212: Average loss: 0.6399, Accuracy: 7862/10000 (78.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 212: Average loss: 5.6845, Accuracy: 364/9000 (4.0444%)
Done in 141.058917760849 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:213 choose agents : [18, 39, 62, 65, 87, 12, 74, 4, 7, 35]. Adversary List: []
___Train Local_ResNet_18,  epoch 213, local model 18, internal_epoch   1,  Average loss: 0.0024, Accuracy: 374/386 (96.8912%)
___Train Local_ResNet_18,  epoch 213, local model 18, internal_epoch   2,  Average loss: 0.0015, Accuracy: 377/386 (97.6684%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.5038, Accuracy: 5906/10000 (59.0600%)
___Train Local_ResNet_18,  epoch 213, local model 39, internal_epoch   1,  Average loss: 0.0048, Accuracy: 194/217 (89.4009%)
___Train Local_ResNet_18,  epoch 213, local model 39, internal_epoch   2,  Average loss: 0.0012, Accuracy: 216/217 (99.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 2.7360, Accuracy: 4117/10000 (41.1700%)
___Train Local_ResNet_18,  epoch 213, local model 62, internal_epoch   1,  Average loss: 0.0016, Accuracy: 350/358 (97.7654%)
___Train Local_ResNet_18,  epoch 213, local model 62, internal_epoch   2,  Average loss: 0.0005, Accuracy: 357/358 (99.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.0297, Accuracy: 6880/10000 (68.8000%)
___Train Local_ResNet_18,  epoch 213, local model 65, internal_epoch   1,  Average loss: 0.0024, Accuracy: 304/314 (96.8153%)
___Train Local_ResNet_18,  epoch 213, local model 65, internal_epoch   2,  Average loss: 0.0004, Accuracy: 314/314 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.7555, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 213, local model 87, internal_epoch   1,  Average loss: 0.0072, Accuracy: 340/397 (85.6423%)
___Train Local_ResNet_18,  epoch 213, local model 87, internal_epoch   2,  Average loss: 0.0061, Accuracy: 352/397 (88.6650%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 3.2803, Accuracy: 3995/10000 (39.9500%)
___Train Local_ResNet_18,  epoch 213, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 877/977 (89.7646%)
___Train Local_ResNet_18,  epoch 213, local model 12, internal_epoch   2,  Average loss: 0.0122, Accuracy: 775/977 (79.3245%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 6.5493, Accuracy: 2780/10000 (27.8000%)
___Train Local_ResNet_18,  epoch 213, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 439/469 (93.6034%)
___Train Local_ResNet_18,  epoch 213, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 433/469 (92.3241%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 2.4921, Accuracy: 4214/10000 (42.1400%)
___Train Local_ResNet_18,  epoch 213, local model 4, internal_epoch   1,  Average loss: 0.0042, Accuracy: 512/557 (91.9210%)
___Train Local_ResNet_18,  epoch 213, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 519/557 (93.1777%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 3.9473, Accuracy: 3409/10000 (34.0900%)
___Train Local_ResNet_18,  epoch 213, local model 7, internal_epoch   1,  Average loss: 0.0016, Accuracy: 342/352 (97.1591%)
___Train Local_ResNet_18,  epoch 213, local model 7, internal_epoch   2,  Average loss: 0.0004, Accuracy: 351/352 (99.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.6612, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 213, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 385/419 (91.8854%)
___Train Local_ResNet_18,  epoch 213, local model 35, internal_epoch   2,  Average loss: 0.0028, Accuracy: 402/419 (95.9427%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 3.3585, Accuracy: 3658/10000 (36.5800%)
time spent on training: 62.79264259338379
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [386, 217, 358, 314, 397, 977, 469, 557, 352, 419]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [18, 39, 62, 65, 87, 12, 74, 4, 7, 35], weight: tensor([0.0868, 0.0488, 0.0805, 0.0706, 0.0893, 0.2197, 0.1055, 0.1253, 0.0792,
        0.0942])
[rfa agg] iter:  0, prev_obj_val: 29.202054977416992, obj_val: 36.88322067260742, abs dis: 7.68116569519043
[rfa agg] iter:  0, weight: tensor([0.1536, 0.0279, 0.1560, 0.0646, 0.1062, 0.0335, 0.0890, 0.0681, 0.1520,
        0.1492])
[rfa agg] iter:  1, prev_obj_val: 36.88322067260742, obj_val: 44.66590881347656, abs dis: 7.782688140869141
[rfa agg] iter:  1, weight: tensor([0.0718, 0.0761, 0.1287, 0.3101, 0.0675, 0.0335, 0.0579, 0.0518, 0.1260,
        0.0766])
[rfa agg] iter:  2, prev_obj_val: 44.66590881347656, obj_val: 44.642757415771484, abs dis: 0.023151397705078125
[rfa agg] iter:  2, weight: tensor([0.0676, 0.2836, 0.0940, 0.1610, 0.0664, 0.0429, 0.0612, 0.0582, 0.0922,
        0.0727])
[rfa agg] iter:  3, prev_obj_val: 44.642757415771484, obj_val: 53.32241439819336, abs dis: 8.679656982421875
[rfa agg] iter:  3, weight: tensor([0.0633, 0.3330, 0.0878, 0.1478, 0.0621, 0.0401, 0.0573, 0.0545, 0.0861,
        0.0680])
[rfa agg] iter:  4, prev_obj_val: 53.32241439819336, obj_val: 33.54549789428711, abs dis: 19.77691650390625
[rfa agg] iter:  4, weight: tensor([0.0832, 0.1805, 0.1029, 0.1344, 0.0833, 0.0647, 0.0805, 0.0796, 0.1011,
        0.0898])
[rfa agg] iter:  5, prev_obj_val: 33.54549789428711, obj_val: 40.63979721069336, abs dis: 7.09429931640625
[rfa agg] iter:  5, weight: tensor([0.0839, 0.0483, 0.1960, 0.1737, 0.0744, 0.0316, 0.0616, 0.0529, 0.1897,
        0.0880])
[rfa agg] iter:  6, prev_obj_val: 40.63979721069336, obj_val: 40.62979507446289, abs dis: 0.01000213623046875
[rfa agg] iter:  6, weight: tensor([0.0717, 0.1580, 0.1103, 0.2471, 0.0691, 0.0397, 0.0618, 0.0572, 0.1083,
        0.0768])
[rfa agg] iter:  7, prev_obj_val: 40.62979507446289, obj_val: 44.65234375, abs dis: 4.022548675537109
[rfa agg] iter:  7, weight: tensor([0.0709, 0.1626, 0.1087, 0.2499, 0.0683, 0.0393, 0.0612, 0.0566, 0.1066,
        0.0759])
[rfa agg] iter:  8, prev_obj_val: 44.65234375, obj_val: 48.930702209472656, abs dis: 4.278358459472656
[rfa agg] iter:  8, weight: tensor([0.0660, 0.3022, 0.0916, 0.1560, 0.0648, 0.0419, 0.0598, 0.0568, 0.0899,
        0.0710])
[rfa agg] iter:  9, prev_obj_val: 48.930702209472656, obj_val: 33.547359466552734, abs dis: 15.383342742919922
[rfa agg] iter:  9, weight: tensor([0.0744, 0.2501, 0.0966, 0.1390, 0.0739, 0.0527, 0.0700, 0.0680, 0.0949,
        0.0802])
___Test Target_ResNet_18 poisoned: False, epoch: 213: Average loss: 0.6372, Accuracy: 7871/10000 (78.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 213: Average loss: 5.6176, Accuracy: 398/9000 (4.4222%)
Done in 134.3881630897522 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:214 choose agents : [17, 30, 72, 51, 63, 46, 54, 95, 26, 2]. Adversary List: []
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 214, local model 17, internal_epoch   1,  Average loss: 0.0020, Accuracy: 511/526 (97.1483%)
___Train Local_ResNet_18,  epoch 214, local model 17, internal_epoch   2,  Average loss: 0.0014, Accuracy: 516/526 (98.0989%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.3393, Accuracy: 6223/10000 (62.2300%)
___Train Local_ResNet_18,  epoch 214, local model 30, internal_epoch   1,  Average loss: 0.0042, Accuracy: 308/337 (91.3947%)
___Train Local_ResNet_18,  epoch 214, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 324/337 (96.1424%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 2.8255, Accuracy: 4280/10000 (42.8000%)
___Train Local_ResNet_18,  epoch 214, local model 72, internal_epoch   1,  Average loss: 0.0061, Accuracy: 540/618 (87.3786%)
___Train Local_ResNet_18,  epoch 214, local model 72, internal_epoch   2,  Average loss: 0.0066, Accuracy: 549/618 (88.8350%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 6.6516, Accuracy: 2783/10000 (27.8300%)
___Train Local_ResNet_18,  epoch 214, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 442/479 (92.2756%)
___Train Local_ResNet_18,  epoch 214, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 452/479 (94.3633%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 10.9337, Accuracy: 1994/10000 (19.9400%)
___Train Local_ResNet_18,  epoch 214, local model 63, internal_epoch   1,  Average loss: 0.0012, Accuracy: 742/752 (98.6702%)
___Train Local_ResNet_18,  epoch 214, local model 63, internal_epoch   2,  Average loss: 0.0003, Accuracy: 752/752 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 0.9629, Accuracy: 7087/10000 (70.8700%)
___Train Local_ResNet_18,  epoch 214, local model 46, internal_epoch   1,  Average loss: 0.0013, Accuracy: 594/601 (98.8353%)
___Train Local_ResNet_18,  epoch 214, local model 46, internal_epoch   2,  Average loss: 0.0008, Accuracy: 594/601 (98.8353%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.5502, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   1,  Average loss: 0.0026, Accuracy: 423/440 (96.1364%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   2,  Average loss: 0.0007, Accuracy: 432/440 (98.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 2.8343, Accuracy: 4145/10000 (41.4500%)
___Train Local_ResNet_18,  epoch 214, local model 95, internal_epoch   1,  Average loss: 0.0070, Accuracy: 483/569 (84.8858%)
___Train Local_ResNet_18,  epoch 214, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 510/569 (89.6309%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 4.7383, Accuracy: 2935/10000 (29.3500%)
___Train Local_ResNet_18,  epoch 214, local model 26, internal_epoch   1,  Average loss: 0.0025, Accuracy: 448/468 (95.7265%)
___Train Local_ResNet_18,  epoch 214, local model 26, internal_epoch   2,  Average loss: 0.0023, Accuracy: 450/468 (96.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.5203, Accuracy: 6090/10000 (60.9000%)
___Train Local_ResNet_18,  epoch 214, local model 2, internal_epoch   1,  Average loss: 0.0083, Accuracy: 404/461 (87.6356%)
___Train Local_ResNet_18,  epoch 214, local model 2, internal_epoch   2,  Average loss: 0.0187, Accuracy: 361/461 (78.3080%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 47.4750, Accuracy: 1019/10000 (10.1900%)
time spent on training: 72.95439314842224
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.1001713959245858  data num: [526, 337, 618, 479, 752, 601, 440, 569, 468, 461]
[rfa agg] considering poison per batch poison_fraction: 0.007825890306608265
[rfa agg] init. name: [17, 30, 72, 51, 63, 46, 54, 95, 26, 2], weight: tensor([0.1002, 0.0642, 0.1177, 0.0912, 0.1432, 0.1145, 0.0838, 0.1084, 0.0891,
        0.0878])
[rfa agg] iter:  0, prev_obj_val: 25.025840759277344, obj_val: 32.82330322265625, abs dis: 7.797462463378906
[rfa agg] iter:  0, weight: tensor([0.0778, 0.1551, 0.0635, 0.1071, 0.0518, 0.0646, 0.2111, 0.0793, 0.1081,
        0.0816])
[rfa agg] iter:  1, prev_obj_val: 32.82330322265625, obj_val: 28.728361129760742, abs dis: 4.094942092895508
[rfa agg] iter:  1, weight: tensor([0.0772, 0.2282, 0.0688, 0.0953, 0.0601, 0.0691, 0.1445, 0.0806, 0.0944,
        0.0818])
[rfa agg] iter:  2, prev_obj_val: 28.728361129760742, obj_val: 24.986736297607422, abs dis: 3.7416248321533203
[rfa agg] iter:  2, weight: tensor([0.0714, 0.2602, 0.0611, 0.0925, 0.0519, 0.0618, 0.1593, 0.0737, 0.0923,
        0.0758])
[rfa agg] iter:  3, prev_obj_val: 24.986736297607422, obj_val: 24.97590446472168, abs dis: 0.010831832885742188
[rfa agg] iter:  3, weight: tensor([0.0750, 0.1727, 0.0608, 0.1036, 0.0500, 0.0623, 0.2165, 0.0760, 0.1048,
        0.0784])
[rfa agg] iter:  4, prev_obj_val: 24.97590446472168, obj_val: 28.7362117767334, abs dis: 3.7603073120117188
[rfa agg] iter:  4, weight: tensor([0.0751, 0.1630, 0.0608, 0.1040, 0.0500, 0.0623, 0.2249, 0.0761, 0.1051,
        0.0786])
[rfa agg] iter:  5, prev_obj_val: 28.7362117767334, obj_val: 28.72671890258789, abs dis: 0.009492874145507812
[rfa agg] iter:  5, weight: tensor([0.0724, 0.2454, 0.0620, 0.0941, 0.0527, 0.0628, 0.1653, 0.0747, 0.0938,
        0.0768])
[rfa agg] iter:  6, prev_obj_val: 28.72671890258789, obj_val: 24.98761749267578, abs dis: 3.7391014099121094
[rfa agg] iter:  6, weight: tensor([0.0708, 0.2651, 0.0606, 0.0918, 0.0515, 0.0614, 0.1590, 0.0731, 0.0916,
        0.0751])
[rfa agg] iter:  7, prev_obj_val: 24.98761749267578, obj_val: 24.97591781616211, abs dis: 0.011699676513671875
[rfa agg] iter:  7, weight: tensor([0.0750, 0.1732, 0.0608, 0.1035, 0.0500, 0.0623, 0.2163, 0.0759, 0.1048,
        0.0783])
[rfa agg] iter:  8, prev_obj_val: 24.97591781616211, obj_val: 28.736202239990234, abs dis: 3.760284423828125
[rfa agg] iter:  8, weight: tensor([0.0751, 0.1630, 0.0608, 0.1040, 0.0500, 0.0623, 0.2249, 0.0761, 0.1051,
        0.0785])
[rfa agg] iter:  9, prev_obj_val: 28.736202239990234, obj_val: 28.72671890258789, abs dis: 0.00948333740234375
[rfa agg] iter:  9, weight: tensor([0.0724, 0.2454, 0.0620, 0.0941, 0.0527, 0.0628, 0.1653, 0.0747, 0.0938,
        0.0768])
___Test Target_ResNet_18 poisoned: False, epoch: 214: Average loss: 0.6395, Accuracy: 7837/10000 (78.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 214: Average loss: 5.4741, Accuracy: 488/9000 (5.4222%)
Done in 147.6369547843933 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:215 choose agents : [95, 82, 45, 0, 34, 62, 66, 10, 12, 38]. Adversary List: []
___Train Local_ResNet_18,  epoch 215, local model 95, internal_epoch   1,  Average loss: 0.0074, Accuracy: 480/569 (84.3585%)
___Train Local_ResNet_18,  epoch 215, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 508/569 (89.2794%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 4.1305, Accuracy: 3515/10000 (35.1500%)
___Train Local_ResNet_18,  epoch 215, local model 82, internal_epoch   1,  Average loss: 0.0026, Accuracy: 573/601 (95.3411%)
___Train Local_ResNet_18,  epoch 215, local model 82, internal_epoch   2,  Average loss: 0.0018, Accuracy: 583/601 (97.0050%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 3.4796, Accuracy: 3696/10000 (36.9600%)
___Train Local_ResNet_18,  epoch 215, local model 45, internal_epoch   1,  Average loss: 0.0043, Accuracy: 501/529 (94.7070%)
___Train Local_ResNet_18,  epoch 215, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 484/529 (91.4934%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 5.0339, Accuracy: 3124/10000 (31.2400%)
___Train Local_ResNet_18,  epoch 215, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 332/367 (90.4632%)
___Train Local_ResNet_18,  epoch 215, local model 0, internal_epoch   2,  Average loss: 0.0018, Accuracy: 354/367 (96.4578%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 6.5810, Accuracy: 2069/10000 (20.6900%)
___Train Local_ResNet_18,  epoch 215, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 315/349 (90.2579%)
___Train Local_ResNet_18,  epoch 215, local model 34, internal_epoch   2,  Average loss: 0.0017, Accuracy: 343/349 (98.2808%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 4.9466, Accuracy: 3137/10000 (31.3700%)
___Train Local_ResNet_18,  epoch 215, local model 62, internal_epoch   1,  Average loss: 0.0011, Accuracy: 352/358 (98.3240%)
___Train Local_ResNet_18,  epoch 215, local model 62, internal_epoch   2,  Average loss: 0.0003, Accuracy: 357/358 (99.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 0.9865, Accuracy: 6947/10000 (69.4700%)
___Train Local_ResNet_18,  epoch 215, local model 66, internal_epoch   1,  Average loss: 0.0028, Accuracy: 526/555 (94.7748%)
___Train Local_ResNet_18,  epoch 215, local model 66, internal_epoch   2,  Average loss: 0.0021, Accuracy: 536/555 (96.5766%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 3.0200, Accuracy: 4356/10000 (43.5600%)
___Train Local_ResNet_18,  epoch 215, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 693/752 (92.1543%)
___Train Local_ResNet_18,  epoch 215, local model 10, internal_epoch   2,  Average loss: 0.0032, Accuracy: 710/752 (94.4149%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 3.6854, Accuracy: 3777/10000 (37.7700%)
___Train Local_ResNet_18,  epoch 215, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 900/977 (92.1187%)
___Train Local_ResNet_18,  epoch 215, local model 12, internal_epoch   2,  Average loss: 0.0081, Accuracy: 811/977 (83.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 15.6336, Accuracy: 2064/10000 (20.6400%)
___Train Local_ResNet_18,  epoch 215, local model 38, internal_epoch   1,  Average loss: 0.0018, Accuracy: 741/756 (98.0159%)
___Train Local_ResNet_18,  epoch 215, local model 38, internal_epoch   2,  Average loss: 0.0026, Accuracy: 721/756 (95.3704%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 2.0754, Accuracy: 5265/10000 (52.6500%)
time spent on training: 69.14765357971191
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [569, 601, 529, 367, 349, 358, 555, 752, 977, 756]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [95, 82, 45, 0, 34, 62, 66, 10, 12, 38], weight: tensor([0.0979, 0.1034, 0.0910, 0.0631, 0.0600, 0.0616, 0.0955, 0.1294, 0.1681,
        0.1301])
[rfa agg] iter:  0, prev_obj_val: 30.916088104248047, obj_val: 42.15863037109375, abs dis: 11.242542266845703
[rfa agg] iter:  0, weight: tensor([0.1517, 0.1127, 0.1521, 0.0702, 0.0673, 0.0712, 0.1753, 0.0744, 0.0492,
        0.0758])
[rfa agg] iter:  1, prev_obj_val: 42.15863037109375, obj_val: 36.04296112060547, abs dis: 6.115669250488281
[rfa agg] iter:  1, weight: tensor([0.0630, 0.0518, 0.0594, 0.1756, 0.1779, 0.2877, 0.0634, 0.0434, 0.0339,
        0.0439])
[rfa agg] iter:  2, prev_obj_val: 36.04296112060547, obj_val: 45.95330810546875, abs dis: 9.910346984863281
[rfa agg] iter:  2, weight: tensor([0.1072, 0.0838, 0.1032, 0.1367, 0.1326, 0.1487, 0.1124, 0.0639, 0.0465,
        0.0649])
[rfa agg] iter:  3, prev_obj_val: 45.95330810546875, obj_val: 38.84878921508789, abs dis: 7.104518890380859
[rfa agg] iter:  3, weight: tensor([0.0655, 0.0555, 0.0617, 0.1880, 0.1865, 0.2415, 0.0655, 0.0482, 0.0389,
        0.0488])
[rfa agg] iter:  4, prev_obj_val: 38.84878921508789, obj_val: 38.84721374511719, abs dis: 0.001575469970703125
[rfa agg] iter:  4, weight: tensor([0.0771, 0.0622, 0.0734, 0.1751, 0.1738, 0.2211, 0.0790, 0.0500, 0.0378,
        0.0507])
___Test Target_ResNet_18 poisoned: False, epoch: 215: Average loss: 0.6372, Accuracy: 7860/10000 (78.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 215: Average loss: 5.4839, Accuracy: 477/9000 (5.3000%)
Done in 131.9175305366516 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:216 choose agents : [41, 4, 68, 55, 30, 39, 10, 64, 23, 60]. Adversary List: []
___Train Local_ResNet_18,  epoch 216, local model 41, internal_epoch   1,  Average loss: 0.0078, Accuracy: 431/513 (84.0156%)
___Train Local_ResNet_18,  epoch 216, local model 41, internal_epoch   2,  Average loss: 0.0201, Accuracy: 466/513 (90.8382%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 4.8909, Accuracy: 2605/10000 (26.0500%)
___Train Local_ResNet_18,  epoch 216, local model 4, internal_epoch   1,  Average loss: 0.0039, Accuracy: 513/557 (92.1005%)
___Train Local_ResNet_18,  epoch 216, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 509/557 (91.3824%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 3.4354, Accuracy: 4471/10000 (44.7100%)
___Train Local_ResNet_18,  epoch 216, local model 68, internal_epoch   1,  Average loss: 0.0018, Accuracy: 404/416 (97.1154%)
___Train Local_ResNet_18,  epoch 216, local model 68, internal_epoch   2,  Average loss: 0.0013, Accuracy: 411/416 (98.7981%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.2991, Accuracy: 6432/10000 (64.3200%)
___Train Local_ResNet_18,  epoch 216, local model 55, internal_epoch   1,  Average loss: 0.0047, Accuracy: 272/299 (90.9699%)
___Train Local_ResNet_18,  epoch 216, local model 55, internal_epoch   2,  Average loss: 0.0014, Accuracy: 294/299 (98.3278%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 13.4798, Accuracy: 1448/10000 (14.4800%)
___Train Local_ResNet_18,  epoch 216, local model 30, internal_epoch   1,  Average loss: 0.0028, Accuracy: 321/337 (95.2522%)
___Train Local_ResNet_18,  epoch 216, local model 30, internal_epoch   2,  Average loss: 0.0006, Accuracy: 337/337 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 2.2185, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 216, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 207/217 (95.3917%)
___Train Local_ResNet_18,  epoch 216, local model 39, internal_epoch   2,  Average loss: 0.0011, Accuracy: 216/217 (99.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.8799, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 216, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 693/752 (92.1543%)
___Train Local_ResNet_18,  epoch 216, local model 10, internal_epoch   2,  Average loss: 0.0030, Accuracy: 716/752 (95.2128%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 4.1551, Accuracy: 3725/10000 (37.2500%)
___Train Local_ResNet_18,  epoch 216, local model 64, internal_epoch   1,  Average loss: 0.0023, Accuracy: 658/686 (95.9184%)
___Train Local_ResNet_18,  epoch 216, local model 64, internal_epoch   2,  Average loss: 0.0026, Accuracy: 650/686 (94.7522%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 3.1453, Accuracy: 3541/10000 (35.4100%)
___Train Local_ResNet_18,  epoch 216, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 234/248 (94.3548%)
___Train Local_ResNet_18,  epoch 216, local model 23, internal_epoch   2,  Average loss: 0.0004, Accuracy: 248/248 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.2311, Accuracy: 6331/10000 (63.3100%)
___Train Local_ResNet_18,  epoch 216, local model 60, internal_epoch   1,  Average loss: 0.0022, Accuracy: 274/284 (96.4789%)
___Train Local_ResNet_18,  epoch 216, local model 60, internal_epoch   2,  Average loss: 0.0004, Accuracy: 283/284 (99.6479%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.4677, Accuracy: 5887/10000 (58.8700%)
time spent on training: 63.26807975769043
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [513, 557, 416, 299, 337, 217, 752, 686, 248, 284]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [41, 4, 68, 55, 30, 39, 10, 64, 23, 60], weight: tensor([0.1191, 0.1293, 0.0965, 0.0694, 0.0782, 0.0504, 0.1745, 0.1592, 0.0576,
        0.0659])
[rfa agg] iter:  0, prev_obj_val: 28.450525283813477, obj_val: 30.453365325927734, abs dis: 2.002840042114258
[rfa agg] iter:  0, weight: tensor([0.0681, 0.0753, 0.1569, 0.1086, 0.2750, 0.0450, 0.0525, 0.0576, 0.0515,
        0.1095])
[rfa agg] iter:  1, prev_obj_val: 30.453365325927734, obj_val: 36.123836517333984, abs dis: 5.67047119140625
[rfa agg] iter:  1, weight: tensor([0.0557, 0.0614, 0.1066, 0.1607, 0.2183, 0.0562, 0.0455, 0.0493, 0.0643,
        0.1822])
[rfa agg] iter:  2, prev_obj_val: 36.123836517333984, obj_val: 52.661659240722656, abs dis: 16.537822723388672
[rfa agg] iter:  2, weight: tensor([0.0447, 0.0490, 0.0664, 0.1694, 0.0883, 0.1437, 0.0402, 0.0424, 0.1649,
        0.1910])
[rfa agg] iter:  3, prev_obj_val: 52.661659240722656, obj_val: 32.986427307128906, abs dis: 19.67523193359375
[rfa agg] iter:  3, weight: tensor([0.0745, 0.0813, 0.0882, 0.1125, 0.0917, 0.1359, 0.0754, 0.0770, 0.1554,
        0.1081])
[rfa agg] iter:  4, prev_obj_val: 32.986427307128906, obj_val: 48.25446319580078, abs dis: 15.268035888671875
[rfa agg] iter:  4, weight: tensor([0.0447, 0.0491, 0.0735, 0.2004, 0.1116, 0.0746, 0.0384, 0.0410, 0.0854,
        0.2814])
[rfa agg] iter:  5, prev_obj_val: 48.25446319580078, obj_val: 32.98069763183594, abs dis: 15.273765563964844
[rfa agg] iter:  5, weight: tensor([0.0653, 0.0713, 0.0805, 0.1132, 0.0866, 0.1599, 0.0645, 0.0664, 0.1828,
        0.1094])
[rfa agg] iter:  6, prev_obj_val: 32.98069763183594, obj_val: 52.66749954223633, abs dis: 19.68680191040039
[rfa agg] iter:  6, weight: tensor([0.0442, 0.0486, 0.0728, 0.1998, 0.1107, 0.0742, 0.0380, 0.0406, 0.0850,
        0.2861])
[rfa agg] iter:  7, prev_obj_val: 52.66749954223633, obj_val: 32.98638916015625, abs dis: 19.681110382080078
[rfa agg] iter:  7, weight: tensor([0.0746, 0.0814, 0.0883, 0.1128, 0.0918, 0.1355, 0.0754, 0.0771, 0.1548,
        0.1084])
[rfa agg] iter:  8, prev_obj_val: 32.98638916015625, obj_val: 48.25447082519531, abs dis: 15.268081665039062
[rfa agg] iter:  8, weight: tensor([0.0447, 0.0491, 0.0735, 0.2004, 0.1116, 0.0746, 0.0384, 0.0410, 0.0854,
        0.2813])
[rfa agg] iter:  9, prev_obj_val: 48.25447082519531, obj_val: 32.98069763183594, abs dis: 15.273773193359375
[rfa agg] iter:  9, weight: tensor([0.0653, 0.0713, 0.0805, 0.1132, 0.0866, 0.1599, 0.0645, 0.0664, 0.1828,
        0.1094])
___Test Target_ResNet_18 poisoned: False, epoch: 216: Average loss: 0.6329, Accuracy: 7882/10000 (78.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 216: Average loss: 5.5264, Accuracy: 463/9000 (5.1444%)
Done in 142.05818486213684 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:217 choose agents : [23, 34, 52, 92, 57, 74, 67, 16, 64, 30]. Adversary List: []
___Train Local_ResNet_18,  epoch 217, local model 23, internal_epoch   1,  Average loss: 0.0027, Accuracy: 237/248 (95.5645%)
___Train Local_ResNet_18,  epoch 217, local model 23, internal_epoch   2,  Average loss: 0.0008, Accuracy: 245/248 (98.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.3865, Accuracy: 6007/10000 (60.0700%)
___Train Local_ResNet_18,  epoch 217, local model 34, internal_epoch   1,  Average loss: 0.0035, Accuracy: 325/349 (93.1232%)
___Train Local_ResNet_18,  epoch 217, local model 34, internal_epoch   2,  Average loss: 0.0017, Accuracy: 340/349 (97.4212%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 4.1396, Accuracy: 4087/10000 (40.8700%)
___Train Local_ResNet_18,  epoch 217, local model 52, internal_epoch   1,  Average loss: 0.0051, Accuracy: 195/214 (91.1215%)
___Train Local_ResNet_18,  epoch 217, local model 52, internal_epoch   2,  Average loss: 0.0013, Accuracy: 210/214 (98.1308%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 2.9518, Accuracy: 4272/10000 (42.7200%)
___Train Local_ResNet_18,  epoch 217, local model 92, internal_epoch   1,  Average loss: 0.0041, Accuracy: 728/796 (91.4573%)
___Train Local_ResNet_18,  epoch 217, local model 92, internal_epoch   2,  Average loss: 0.0061, Accuracy: 702/796 (88.1910%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 4.7652, Accuracy: 3212/10000 (32.1200%)
___Train Local_ResNet_18,  epoch 217, local model 57, internal_epoch   1,  Average loss: 0.0023, Accuracy: 282/290 (97.2414%)
___Train Local_ResNet_18,  epoch 217, local model 57, internal_epoch   2,  Average loss: 0.0007, Accuracy: 289/290 (99.6552%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.9713, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 217, local model 74, internal_epoch   1,  Average loss: 0.0029, Accuracy: 443/469 (94.4563%)
___Train Local_ResNet_18,  epoch 217, local model 74, internal_epoch   2,  Average loss: 0.0006, Accuracy: 466/469 (99.3603%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 2.4439, Accuracy: 4627/10000 (46.2700%)
___Train Local_ResNet_18,  epoch 217, local model 67, internal_epoch   1,  Average loss: 0.0031, Accuracy: 789/842 (93.7055%)
___Train Local_ResNet_18,  epoch 217, local model 67, internal_epoch   2,  Average loss: 0.0139, Accuracy: 653/842 (77.5534%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 74.5839, Accuracy: 1001/10000 (10.0100%)
___Train Local_ResNet_18,  epoch 217, local model 16, internal_epoch   1,  Average loss: 0.0026, Accuracy: 742/773 (95.9897%)
___Train Local_ResNet_18,  epoch 217, local model 16, internal_epoch   2,  Average loss: 0.0109, Accuracy: 646/773 (83.5705%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 4.1001, Accuracy: 2815/10000 (28.1500%)
___Train Local_ResNet_18,  epoch 217, local model 64, internal_epoch   1,  Average loss: 0.0020, Accuracy: 667/686 (97.2303%)
___Train Local_ResNet_18,  epoch 217, local model 64, internal_epoch   2,  Average loss: 0.0017, Accuracy: 666/686 (97.0845%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.8052, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 217, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 323/337 (95.8457%)
___Train Local_ResNet_18,  epoch 217, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 320/337 (94.9555%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 4.4703, Accuracy: 3452/10000 (34.5200%)
time spent on training: 70.13520908355713
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [248, 349, 214, 796, 290, 469, 842, 773, 686, 337]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [23, 34, 52, 92, 57, 74, 67, 16, 64, 30], weight: tensor([0.0496, 0.0697, 0.0428, 0.1591, 0.0580, 0.0937, 0.1683, 0.1545, 0.1371,
        0.0673])
[rfa agg] iter:  0, prev_obj_val: 35.76765060424805, obj_val: 37.22487258911133, abs dis: 1.4572219848632812
[rfa agg] iter:  0, weight: tensor([0.0333, 0.0886, 0.0286, 0.0838, 0.0515, 0.3556, 0.0734, 0.0810, 0.1198,
        0.0845])
[rfa agg] iter:  1, prev_obj_val: 37.22487258911133, obj_val: 43.322784423828125, abs dis: 6.097911834716797
[rfa agg] iter:  1, weight: tensor([0.0361, 0.1100, 0.0310, 0.0724, 0.0587, 0.3555, 0.0641, 0.0700, 0.0986,
        0.1036])
[rfa agg] iter:  2, prev_obj_val: 43.322784423828125, obj_val: 45.961097717285156, abs dis: 2.6383132934570312
[rfa agg] iter:  2, weight: tensor([0.0547, 0.2559, 0.0466, 0.0504, 0.1204, 0.1032, 0.0463, 0.0488, 0.0612,
        0.2127])
[rfa agg] iter:  3, prev_obj_val: 45.961097717285156, obj_val: 45.95702362060547, abs dis: 0.0040740966796875
[rfa agg] iter:  3, weight: tensor([0.0700, 0.2163, 0.0589, 0.0456, 0.2018, 0.0797, 0.0423, 0.0442, 0.0540,
        0.1872])
___Test Target_ResNet_18 poisoned: False, epoch: 217: Average loss: 0.6365, Accuracy: 7853/10000 (78.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 217: Average loss: 5.4655, Accuracy: 530/9000 (5.8889%)
Done in 138.87165594100952 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:218 choose agents : [35, 81, 62, 68, 2, 74, 39, 1, 64, 29]. Adversary List: []
___Train Local_ResNet_18,  epoch 218, local model 35, internal_epoch   1,  Average loss: 0.0038, Accuracy: 386/419 (92.1241%)
___Train Local_ResNet_18,  epoch 218, local model 35, internal_epoch   2,  Average loss: 0.0009, Accuracy: 412/419 (98.3294%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 4.1397, Accuracy: 3028/10000 (30.2800%)
___Train Local_ResNet_18,  epoch 218, local model 81, internal_epoch   1,  Average loss: 0.0058, Accuracy: 910/1034 (88.0077%)
___Train Local_ResNet_18,  epoch 218, local model 81, internal_epoch   2,  Average loss: 0.0104, Accuracy: 839/1034 (81.1412%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 16.7175, Accuracy: 1406/10000 (14.0600%)
___Train Local_ResNet_18,  epoch 218, local model 62, internal_epoch   1,  Average loss: 0.0010, Accuracy: 356/358 (99.4413%)
___Train Local_ResNet_18,  epoch 218, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 358/358 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 0.8750, Accuracy: 7271/10000 (72.7100%)
___Train Local_ResNet_18,  epoch 218, local model 68, internal_epoch   1,  Average loss: 0.0017, Accuracy: 407/416 (97.8365%)
___Train Local_ResNet_18,  epoch 218, local model 68, internal_epoch   2,  Average loss: 0.0006, Accuracy: 414/416 (99.5192%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.2253, Accuracy: 6596/10000 (65.9600%)
___Train Local_ResNet_18,  epoch 218, local model 2, internal_epoch   1,  Average loss: 0.0063, Accuracy: 412/461 (89.3709%)
___Train Local_ResNet_18,  epoch 218, local model 2, internal_epoch   2,  Average loss: 0.0055, Accuracy: 424/461 (91.9740%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 2.6119, Accuracy: 4002/10000 (40.0200%)
___Train Local_ResNet_18,  epoch 218, local model 74, internal_epoch   1,  Average loss: 0.0025, Accuracy: 447/469 (95.3092%)
___Train Local_ResNet_18,  epoch 218, local model 74, internal_epoch   2,  Average loss: 0.0011, Accuracy: 461/469 (98.2942%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 2.1935, Accuracy: 4993/10000 (49.9300%)
___Train Local_ResNet_18,  epoch 218, local model 39, internal_epoch   1,  Average loss: 0.0023, Accuracy: 211/217 (97.2350%)
___Train Local_ResNet_18,  epoch 218, local model 39, internal_epoch   2,  Average loss: 0.0004, Accuracy: 216/217 (99.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.0507, Accuracy: 6763/10000 (67.6300%)
___Train Local_ResNet_18,  epoch 218, local model 1, internal_epoch   1,  Average loss: 0.0042, Accuracy: 613/641 (95.6318%)
___Train Local_ResNet_18,  epoch 218, local model 1, internal_epoch   2,  Average loss: 0.0106, Accuracy: 597/641 (93.1357%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 3.1757, Accuracy: 4800/10000 (48.0000%)
___Train Local_ResNet_18,  epoch 218, local model 64, internal_epoch   1,  Average loss: 0.0017, Accuracy: 674/686 (98.2507%)
___Train Local_ResNet_18,  epoch 218, local model 64, internal_epoch   2,  Average loss: 0.0011, Accuracy: 676/686 (98.5423%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.3970, Accuracy: 6153/10000 (61.5300%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   1,  Average loss: 0.0042, Accuracy: 774/848 (91.2736%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   2,  Average loss: 0.0089, Accuracy: 721/848 (85.0236%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 18.7595, Accuracy: 1057/10000 (10.5700%)
time spent on training: 85.96571350097656
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [419, 1034, 358, 416, 461, 469, 217, 641, 686, 848]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 81, 62, 68, 2, 74, 39, 1, 64, 29], weight: tensor([0.0755, 0.1863, 0.0645, 0.0750, 0.0831, 0.0845, 0.0391, 0.1155, 0.1236,
        0.1528])
[rfa agg] iter:  0, prev_obj_val: 33.91814041137695, obj_val: 37.564640045166016, abs dis: 3.6464996337890625
[rfa agg] iter:  0, weight: tensor([0.0917, 0.0593, 0.0550, 0.0929, 0.1432, 0.1772, 0.0202, 0.1346, 0.1502,
        0.0756])
[rfa agg] iter:  1, prev_obj_val: 37.564640045166016, obj_val: 42.853878021240234, abs dis: 5.289237976074219
[rfa agg] iter:  1, weight: tensor([0.1689, 0.0352, 0.0760, 0.1942, 0.1374, 0.2042, 0.0203, 0.0585, 0.0636,
        0.0416])
[rfa agg] iter:  2, prev_obj_val: 42.853878021240234, obj_val: 42.83401107788086, abs dis: 0.019866943359375
[rfa agg] iter:  2, weight: tensor([0.1885, 0.0333, 0.2018, 0.2184, 0.0887, 0.1018, 0.0296, 0.0480, 0.0520,
        0.0379])
[rfa agg] iter:  3, prev_obj_val: 42.83401107788086, obj_val: 42.83394241333008, abs dis: 6.866455078125e-05
[rfa agg] iter:  3, weight: tensor([0.1906, 0.0326, 0.2080, 0.2208, 0.0855, 0.0986, 0.0290, 0.0470, 0.0508,
        0.0371])
___Test Target_ResNet_18 poisoned: False, epoch: 218: Average loss: 0.6378, Accuracy: 7848/10000 (78.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 218: Average loss: 5.4482, Accuracy: 544/9000 (6.0444%)
Done in 149.8040416240692 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:219 choose agents : [11, 21, 39, 95, 90, 68, 38, 97, 3, 98]. Adversary List: []
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 219, local model 11, internal_epoch   1,  Average loss: 0.0026, Accuracy: 522/546 (95.6044%)
___Train Local_ResNet_18,  epoch 219, local model 11, internal_epoch   2,  Average loss: 0.0021, Accuracy: 526/546 (96.3370%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.5529, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch 219, local model 21, internal_epoch   1,  Average loss: 0.0046, Accuracy: 238/262 (90.8397%)
___Train Local_ResNet_18,  epoch 219, local model 21, internal_epoch   2,  Average loss: 0.0036, Accuracy: 256/262 (97.7099%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 9.2595, Accuracy: 2235/10000 (22.3500%)
___Train Local_ResNet_18,  epoch 219, local model 39, internal_epoch   1,  Average loss: 0.0034, Accuracy: 210/217 (96.7742%)
___Train Local_ResNet_18,  epoch 219, local model 39, internal_epoch   2,  Average loss: 0.0006, Accuracy: 217/217 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.2658, Accuracy: 4905/10000 (49.0500%)
___Train Local_ResNet_18,  epoch 219, local model 95, internal_epoch   1,  Average loss: 0.0067, Accuracy: 491/569 (86.2917%)
___Train Local_ResNet_18,  epoch 219, local model 95, internal_epoch   2,  Average loss: 0.0049, Accuracy: 519/569 (91.2127%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 12.9026, Accuracy: 1564/10000 (15.6400%)
___Train Local_ResNet_18,  epoch 219, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 528/578 (91.3495%)
___Train Local_ResNet_18,  epoch 219, local model 90, internal_epoch   2,  Average loss: 0.0031, Accuracy: 538/578 (93.0796%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 3.9081, Accuracy: 3362/10000 (33.6200%)
___Train Local_ResNet_18,  epoch 219, local model 68, internal_epoch   1,  Average loss: 0.0011, Accuracy: 415/416 (99.7596%)
___Train Local_ResNet_18,  epoch 219, local model 68, internal_epoch   2,  Average loss: 0.0003, Accuracy: 415/416 (99.7596%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 0.8807, Accuracy: 7388/10000 (73.8800%)
___Train Local_ResNet_18,  epoch 219, local model 38, internal_epoch   1,  Average loss: 0.0022, Accuracy: 729/756 (96.4286%)
___Train Local_ResNet_18,  epoch 219, local model 38, internal_epoch   2,  Average loss: 0.0028, Accuracy: 719/756 (95.1058%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.2696, Accuracy: 5055/10000 (50.5500%)
___Train Local_ResNet_18,  epoch 219, local model 97, internal_epoch   1,  Average loss: 0.0034, Accuracy: 389/418 (93.0622%)
___Train Local_ResNet_18,  epoch 219, local model 97, internal_epoch   2,  Average loss: 0.0017, Accuracy: 406/418 (97.1292%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.5861, Accuracy: 4808/10000 (48.0800%)
___Train Local_ResNet_18,  epoch 219, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 698/780 (89.4872%)
___Train Local_ResNet_18,  epoch 219, local model 3, internal_epoch   2,  Average loss: 0.0132, Accuracy: 594/780 (76.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 26.1262, Accuracy: 2161/10000 (21.6100%)
___Train Local_ResNet_18,  epoch 219, local model 98, internal_epoch   1,  Average loss: 0.0034, Accuracy: 751/802 (93.6409%)
___Train Local_ResNet_18,  epoch 219, local model 98, internal_epoch   2,  Average loss: 0.0068, Accuracy: 686/802 (85.5362%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 7.0018, Accuracy: 2830/10000 (28.3000%)
time spent on training: 75.38446974754333
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10217065868263472  data num: [546, 262, 217, 569, 578, 416, 756, 418, 780, 802]
[rfa agg] considering poison per batch poison_fraction: 0.007982082709580838
[rfa agg] init. name: [11, 21, 39, 95, 90, 68, 38, 97, 3, 98], weight: tensor([0.1022, 0.0490, 0.0406, 0.1065, 0.1082, 0.0778, 0.1415, 0.0782, 0.1460,
        0.1501])
[rfa agg] iter:  0, prev_obj_val: 30.4829158782959, obj_val: 35.95680236816406, abs dis: 5.473886489868164
[rfa agg] iter:  0, weight: tensor([0.1304, 0.0406, 0.0247, 0.1216, 0.0863, 0.2346, 0.0664, 0.1838, 0.0542,
        0.0574])
[rfa agg] iter:  1, prev_obj_val: 35.95680236816406, obj_val: 39.423805236816406, abs dis: 3.4670028686523438
[rfa agg] iter:  1, weight: tensor([0.0877, 0.0665, 0.0356, 0.0870, 0.0661, 0.2837, 0.0564, 0.2191, 0.0476,
        0.0503])
[rfa agg] iter:  2, prev_obj_val: 39.423805236816406, obj_val: 43.00693130493164, abs dis: 3.5831260681152344
[rfa agg] iter:  2, weight: tensor([0.0921, 0.1149, 0.0552, 0.0924, 0.0728, 0.2058, 0.0647, 0.1881, 0.0555,
        0.0585])
[rfa agg] iter:  3, prev_obj_val: 43.00693130493164, obj_val: 43.00177764892578, abs dis: 0.005153656005859375
[rfa agg] iter:  3, weight: tensor([0.0871, 0.1897, 0.0793, 0.0883, 0.0714, 0.1540, 0.0656, 0.1473, 0.0572,
        0.0600])
[rfa agg] iter:  4, prev_obj_val: 43.00177764892578, obj_val: 43.001731872558594, abs dis: 4.57763671875e-05
[rfa agg] iter:  4, weight: tensor([0.0864, 0.1975, 0.0788, 0.0876, 0.0709, 0.1525, 0.0651, 0.1451, 0.0567,
        0.0595])
___Test Target_ResNet_18 poisoned: False, epoch: 219: Average loss: 0.6340, Accuracy: 7862/10000 (78.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 219: Average loss: 5.5116, Accuracy: 530/9000 (5.8889%)
Done in 145.48755717277527 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:220 choose agents : [90, 88, 25, 27, 56, 93, 42, 18, 66, 82]. Adversary List: []
___Train Local_ResNet_18,  epoch 220, local model 90, internal_epoch   1,  Average loss: 0.0064, Accuracy: 532/578 (92.0415%)
___Train Local_ResNet_18,  epoch 220, local model 90, internal_epoch   2,  Average loss: 0.0116, Accuracy: 476/578 (82.3529%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 76.1765, Accuracy: 1379/10000 (13.7900%)
___Train Local_ResNet_18,  epoch 220, local model 88, internal_epoch   1,  Average loss: 0.0062, Accuracy: 384/447 (85.9060%)
___Train Local_ResNet_18,  epoch 220, local model 88, internal_epoch   2,  Average loss: 0.0041, Accuracy: 409/447 (91.4989%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 5.0065, Accuracy: 3074/10000 (30.7400%)
___Train Local_ResNet_18,  epoch 220, local model 25, internal_epoch   1,  Average loss: 0.0022, Accuracy: 524/545 (96.1468%)
___Train Local_ResNet_18,  epoch 220, local model 25, internal_epoch   2,  Average loss: 0.0015, Accuracy: 532/545 (97.6147%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 2.2022, Accuracy: 5007/10000 (50.0700%)
___Train Local_ResNet_18,  epoch 220, local model 27, internal_epoch   1,  Average loss: 0.0019, Accuracy: 384/397 (96.7254%)
___Train Local_ResNet_18,  epoch 220, local model 27, internal_epoch   2,  Average loss: 0.0006, Accuracy: 395/397 (99.4962%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.4713, Accuracy: 5969/10000 (59.6900%)
___Train Local_ResNet_18,  epoch 220, local model 56, internal_epoch   1,  Average loss: 0.0016, Accuracy: 730/743 (98.2503%)
___Train Local_ResNet_18,  epoch 220, local model 56, internal_epoch   2,  Average loss: 0.0009, Accuracy: 732/743 (98.5195%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.9033, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 220, local model 93, internal_epoch   1,  Average loss: 0.0023, Accuracy: 565/584 (96.7466%)
___Train Local_ResNet_18,  epoch 220, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 526/584 (90.0685%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 4.4997, Accuracy: 4179/10000 (41.7900%)
___Train Local_ResNet_18,  epoch 220, local model 42, internal_epoch   1,  Average loss: 0.0032, Accuracy: 187/198 (94.4444%)
___Train Local_ResNet_18,  epoch 220, local model 42, internal_epoch   2,  Average loss: 0.0005, Accuracy: 197/198 (99.4949%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.9030, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   1,  Average loss: 0.0023, Accuracy: 375/386 (97.1503%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   2,  Average loss: 0.0129, Accuracy: 365/386 (94.5596%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 2.3424, Accuracy: 4638/10000 (46.3800%)
___Train Local_ResNet_18,  epoch 220, local model 66, internal_epoch   1,  Average loss: 0.0031, Accuracy: 525/555 (94.5946%)
___Train Local_ResNet_18,  epoch 220, local model 66, internal_epoch   2,  Average loss: 0.0007, Accuracy: 549/555 (98.9189%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 2.7243, Accuracy: 4619/10000 (46.1900%)
___Train Local_ResNet_18,  epoch 220, local model 82, internal_epoch   1,  Average loss: 0.0026, Accuracy: 576/601 (95.8403%)
___Train Local_ResNet_18,  epoch 220, local model 82, internal_epoch   2,  Average loss: 0.0032, Accuracy: 560/601 (93.1780%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 3.1062, Accuracy: 4452/10000 (44.5200%)
time spent on training: 71.83870720863342
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [578, 447, 545, 397, 743, 584, 198, 386, 555, 601]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [90, 88, 25, 27, 56, 93, 42, 18, 66, 82], weight: tensor([0.1148, 0.0888, 0.1083, 0.0789, 0.1476, 0.1160, 0.0393, 0.0767, 0.1103,
        0.1194])
[rfa agg] iter:  0, prev_obj_val: 23.742406845092773, obj_val: 26.860919952392578, abs dis: 3.1185131072998047
[rfa agg] iter:  0, weight: tensor([0.0559, 0.1689, 0.0865, 0.2484, 0.0496, 0.0620, 0.0220, 0.1547, 0.0874,
        0.0645])
[rfa agg] iter:  1, prev_obj_val: 26.860919952392578, obj_val: 26.85995101928711, abs dis: 0.00096893310546875
[rfa agg] iter:  1, weight: tensor([0.0557, 0.1830, 0.0804, 0.2294, 0.0513, 0.0611, 0.0299, 0.1645, 0.0813,
        0.0634])
___Test Target_ResNet_18 poisoned: False, epoch: 220: Average loss: 0.6252, Accuracy: 7880/10000 (78.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 220: Average loss: 5.5765, Accuracy: 499/9000 (5.5444%)
Done in 131.86527037620544 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:221 choose agents : [86, 67, 38, 29, 30, 96, 0, 3, 8, 68]. Adversary List: []
___Train Local_ResNet_18,  epoch 221, local model 86, internal_epoch   1,  Average loss: 0.0024, Accuracy: 207/212 (97.6415%)
___Train Local_ResNet_18,  epoch 221, local model 86, internal_epoch   2,  Average loss: 0.0014, Accuracy: 210/212 (99.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.3487, Accuracy: 6464/10000 (64.6400%)
___Train Local_ResNet_18,  epoch 221, local model 67, internal_epoch   1,  Average loss: 0.0027, Accuracy: 804/842 (95.4869%)
___Train Local_ResNet_18,  epoch 221, local model 67, internal_epoch   2,  Average loss: 0.0142, Accuracy: 670/842 (79.5724%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 27.5764, Accuracy: 1604/10000 (16.0400%)
___Train Local_ResNet_18,  epoch 221, local model 38, internal_epoch   1,  Average loss: 0.0017, Accuracy: 737/756 (97.4868%)
___Train Local_ResNet_18,  epoch 221, local model 38, internal_epoch   2,  Average loss: 0.0012, Accuracy: 740/756 (97.8836%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.5770, Accuracy: 6005/10000 (60.0500%)
___Train Local_ResNet_18,  epoch 221, local model 29, internal_epoch   1,  Average loss: 0.0052, Accuracy: 772/848 (91.0377%)
___Train Local_ResNet_18,  epoch 221, local model 29, internal_epoch   2,  Average loss: 0.0064, Accuracy: 752/848 (88.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 10.1636, Accuracy: 2105/10000 (21.0500%)
___Train Local_ResNet_18,  epoch 221, local model 30, internal_epoch   1,  Average loss: 0.0020, Accuracy: 332/337 (98.5163%)
___Train Local_ResNet_18,  epoch 221, local model 30, internal_epoch   2,  Average loss: 0.0005, Accuracy: 337/337 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.8302, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 221, local model 96, internal_epoch   1,  Average loss: 0.0025, Accuracy: 674/708 (95.1977%)
___Train Local_ResNet_18,  epoch 221, local model 96, internal_epoch   2,  Average loss: 0.0099, Accuracy: 600/708 (84.7458%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 9.8019, Accuracy: 1887/10000 (18.8700%)
___Train Local_ResNet_18,  epoch 221, local model 0, internal_epoch   1,  Average loss: 0.0040, Accuracy: 342/367 (93.1880%)
___Train Local_ResNet_18,  epoch 221, local model 0, internal_epoch   2,  Average loss: 0.0017, Accuracy: 355/367 (96.7302%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 5.1003, Accuracy: 2828/10000 (28.2800%)
___Train Local_ResNet_18,  epoch 221, local model 3, internal_epoch   1,  Average loss: 0.0068, Accuracy: 697/780 (89.3590%)
___Train Local_ResNet_18,  epoch 221, local model 3, internal_epoch   2,  Average loss: 0.0102, Accuracy: 641/780 (82.1795%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 5.1538, Accuracy: 2754/10000 (27.5400%)
___Train Local_ResNet_18,  epoch 221, local model 8, internal_epoch   1,  Average loss: 0.0015, Accuracy: 524/534 (98.1273%)
___Train Local_ResNet_18,  epoch 221, local model 8, internal_epoch   2,  Average loss: 0.0012, Accuracy: 523/534 (97.9401%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.5058, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 221, local model 68, internal_epoch   1,  Average loss: 0.0009, Accuracy: 415/416 (99.7596%)
___Train Local_ResNet_18,  epoch 221, local model 68, internal_epoch   2,  Average loss: 0.0003, Accuracy: 414/416 (99.5192%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 0.8070, Accuracy: 7532/10000 (75.3200%)
time spent on training: 68.92529559135437
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [212, 842, 756, 848, 337, 708, 367, 780, 534, 416]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [86, 67, 38, 29, 30, 96, 0, 3, 8, 68], weight: tensor([0.0366, 0.1452, 0.1303, 0.1462, 0.0581, 0.1221, 0.0633, 0.1345, 0.0921,
        0.0717])
[rfa agg] iter:  0, prev_obj_val: 32.95751953125, obj_val: 37.11558151245117, abs dis: 4.158061981201172
[rfa agg] iter:  0, weight: tensor([0.0196, 0.0749, 0.1134, 0.0756, 0.0513, 0.1010, 0.0552, 0.0843, 0.3313,
        0.0934])
[rfa agg] iter:  1, prev_obj_val: 37.11558151245117, obj_val: 41.968536376953125, abs dis: 4.852954864501953
[rfa agg] iter:  1, weight: tensor([0.0260, 0.0670, 0.0920, 0.0676, 0.0810, 0.0835, 0.0857, 0.0733, 0.2351,
        0.1888])
[rfa agg] iter:  2, prev_obj_val: 41.968536376953125, obj_val: 44.85662841796875, abs dis: 2.888092041015625
[rfa agg] iter:  2, weight: tensor([0.0258, 0.0433, 0.0554, 0.0437, 0.1138, 0.0507, 0.1133, 0.0463, 0.0953,
        0.4124])
[rfa agg] iter:  3, prev_obj_val: 44.85662841796875, obj_val: 44.84756088256836, abs dis: 0.009067535400390625
[rfa agg] iter:  3, weight: tensor([0.0318, 0.0416, 0.0518, 0.0420, 0.2020, 0.0476, 0.1771, 0.0441, 0.0789,
        0.2831])
[rfa agg] iter:  4, prev_obj_val: 44.84756088256836, obj_val: 44.84748458862305, abs dis: 7.62939453125e-05
[rfa agg] iter:  4, weight: tensor([0.0316, 0.0414, 0.0515, 0.0418, 0.2069, 0.0473, 0.1840, 0.0439, 0.0785,
        0.2730])
___Test Target_ResNet_18 poisoned: False, epoch: 221: Average loss: 0.6291, Accuracy: 7871/10000 (78.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 221: Average loss: 5.5502, Accuracy: 494/9000 (5.4889%)
Done in 137.80537366867065 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:222 choose agents : [79, 90, 21, 25, 53, 14, 6, 12, 7, 58]. Adversary List: []
___Train Local_ResNet_18,  epoch 222, local model 79, internal_epoch   1,  Average loss: 0.0047, Accuracy: 139/154 (90.2597%)
___Train Local_ResNet_18,  epoch 222, local model 79, internal_epoch   2,  Average loss: 0.0007, Accuracy: 154/154 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.0427, Accuracy: 6927/10000 (69.2700%)
___Train Local_ResNet_18,  epoch 222, local model 90, internal_epoch   1,  Average loss: 0.0135, Accuracy: 538/578 (93.0796%)
___Train Local_ResNet_18,  epoch 222, local model 90, internal_epoch   2,  Average loss: 0.0300, Accuracy: 330/578 (57.0934%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 5929.1811, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 222, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 244/262 (93.1298%)
___Train Local_ResNet_18,  epoch 222, local model 21, internal_epoch   2,  Average loss: 0.0068, Accuracy: 246/262 (93.8931%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 8.3331, Accuracy: 1865/10000 (18.6500%)
___Train Local_ResNet_18,  epoch 222, local model 25, internal_epoch   1,  Average loss: 0.0022, Accuracy: 519/545 (95.2294%)
___Train Local_ResNet_18,  epoch 222, local model 25, internal_epoch   2,  Average loss: 0.0012, Accuracy: 531/545 (97.4312%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 2.5589, Accuracy: 4670/10000 (46.7000%)
___Train Local_ResNet_18,  epoch 222, local model 53, internal_epoch   1,  Average loss: 0.0031, Accuracy: 586/625 (93.7600%)
___Train Local_ResNet_18,  epoch 222, local model 53, internal_epoch   2,  Average loss: 0.0022, Accuracy: 588/625 (94.0800%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 3.3244, Accuracy: 4137/10000 (41.3700%)
___Train Local_ResNet_18,  epoch 222, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 283/318 (88.9937%)
___Train Local_ResNet_18,  epoch 222, local model 14, internal_epoch   2,  Average loss: 0.0022, Accuracy: 302/318 (94.9686%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 6.9845, Accuracy: 2689/10000 (26.8900%)
___Train Local_ResNet_18,  epoch 222, local model 6, internal_epoch   1,  Average loss: 0.0023, Accuracy: 500/520 (96.1538%)
___Train Local_ResNet_18,  epoch 222, local model 6, internal_epoch   2,  Average loss: 0.0048, Accuracy: 480/520 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 2.9836, Accuracy: 3984/10000 (39.8400%)
___Train Local_ResNet_18,  epoch 222, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 896/977 (91.7093%)
___Train Local_ResNet_18,  epoch 222, local model 12, internal_epoch   2,  Average loss: 0.0104, Accuracy: 783/977 (80.1433%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 30.1038, Accuracy: 1378/10000 (13.7800%)
___Train Local_ResNet_18,  epoch 222, local model 7, internal_epoch   1,  Average loss: 0.0016, Accuracy: 343/352 (97.4432%)
___Train Local_ResNet_18,  epoch 222, local model 7, internal_epoch   2,  Average loss: 0.0004, Accuracy: 351/352 (99.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.5552, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 222, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 213/234 (91.0256%)
___Train Local_ResNet_18,  epoch 222, local model 58, internal_epoch   2,  Average loss: 0.0003, Accuracy: 234/234 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 3.7927, Accuracy: 3069/10000 (30.6900%)
time spent on training: 68.17992758750916
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [154, 578, 262, 545, 625, 318, 520, 977, 352, 234]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [79, 90, 21, 25, 53, 14, 6, 12, 7, 58], weight: tensor([0.0337, 0.1266, 0.0574, 0.1194, 0.1369, 0.0697, 0.1139, 0.2140, 0.0771,
        0.0513])
[rfa agg] iter:  0, prev_obj_val: 39.47378158569336, obj_val: 44.83924865722656, abs dis: 5.365467071533203
[rfa agg] iter:  0, weight: tensor([0.0254, 0.0641, 0.0768, 0.1623, 0.1308, 0.0952, 0.1526, 0.0722, 0.1705,
        0.0502])
[rfa agg] iter:  1, prev_obj_val: 44.83924865722656, obj_val: 54.061038970947266, abs dis: 9.221790313720703
[rfa agg] iter:  1, weight: tensor([0.0314, 0.0416, 0.1401, 0.0796, 0.0710, 0.1939, 0.0755, 0.0478, 0.2439,
        0.0755])
[rfa agg] iter:  2, prev_obj_val: 54.061038970947266, obj_val: 50.55522918701172, abs dis: 3.505809783935547
[rfa agg] iter:  2, weight: tensor([0.0809, 0.0398, 0.1224, 0.0623, 0.0594, 0.1600, 0.0592, 0.0463, 0.0992,
        0.2705])
[rfa agg] iter:  3, prev_obj_val: 50.55522918701172, obj_val: 50.549041748046875, abs dis: 0.00618743896484375
[rfa agg] iter:  3, weight: tensor([0.0519, 0.0379, 0.1557, 0.0630, 0.0590, 0.2215, 0.0599, 0.0441, 0.1183,
        0.1885])
[rfa agg] iter:  4, prev_obj_val: 50.549041748046875, obj_val: 50.548988342285156, abs dis: 5.340576171875e-05
[rfa agg] iter:  4, weight: tensor([0.0516, 0.0377, 0.1585, 0.0627, 0.0587, 0.2277, 0.0595, 0.0438, 0.1177,
        0.1821])
___Test Target_ResNet_18 poisoned: False, epoch: 222: Average loss: 0.6345, Accuracy: 7841/10000 (78.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 222: Average loss: 5.2300, Accuracy: 676/9000 (7.5111%)
Done in 141.79536080360413 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:223 choose agents : [65, 0, 98, 20, 45, 82, 88, 17, 11, 46]. Adversary List: []
___Train Local_ResNet_18,  epoch 223, local model 65, internal_epoch   1,  Average loss: 0.0027, Accuracy: 300/314 (95.5414%)
___Train Local_ResNet_18,  epoch 223, local model 65, internal_epoch   2,  Average loss: 0.0004, Accuracy: 314/314 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 2.2173, Accuracy: 4811/10000 (48.1100%)
___Train Local_ResNet_18,  epoch 223, local model 0, internal_epoch   1,  Average loss: 0.0031, Accuracy: 350/367 (95.3678%)
___Train Local_ResNet_18,  epoch 223, local model 0, internal_epoch   2,  Average loss: 0.0014, Accuracy: 359/367 (97.8202%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 4.3806, Accuracy: 3143/10000 (31.4300%)
___Train Local_ResNet_18,  epoch 223, local model 98, internal_epoch   1,  Average loss: 0.0030, Accuracy: 756/802 (94.2643%)
___Train Local_ResNet_18,  epoch 223, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 725/802 (90.3990%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 2.4779, Accuracy: 4770/10000 (47.7000%)
___Train Local_ResNet_18,  epoch 223, local model 20, internal_epoch   1,  Average loss: 0.0056, Accuracy: 320/362 (88.3978%)
___Train Local_ResNet_18,  epoch 223, local model 20, internal_epoch   2,  Average loss: 0.0025, Accuracy: 345/362 (95.3039%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 8.0073, Accuracy: 2321/10000 (23.2100%)
___Train Local_ResNet_18,  epoch 223, local model 45, internal_epoch   1,  Average loss: 0.0036, Accuracy: 493/529 (93.1947%)
___Train Local_ResNet_18,  epoch 223, local model 45, internal_epoch   2,  Average loss: 0.0059, Accuracy: 476/529 (89.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 4.8166, Accuracy: 3075/10000 (30.7500%)
___Train Local_ResNet_18,  epoch 223, local model 82, internal_epoch   1,  Average loss: 0.0025, Accuracy: 579/601 (96.3394%)
___Train Local_ResNet_18,  epoch 223, local model 82, internal_epoch   2,  Average loss: 0.0030, Accuracy: 570/601 (94.8419%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 3.9978, Accuracy: 3887/10000 (38.8700%)
___Train Local_ResNet_18,  epoch 223, local model 88, internal_epoch   1,  Average loss: 0.0046, Accuracy: 403/447 (90.1566%)
___Train Local_ResNet_18,  epoch 223, local model 88, internal_epoch   2,  Average loss: 0.0027, Accuracy: 422/447 (94.4072%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 4.8186, Accuracy: 2647/10000 (26.4700%)
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 223, local model 17, internal_epoch   1,  Average loss: 0.0023, Accuracy: 503/526 (95.6274%)
___Train Local_ResNet_18,  epoch 223, local model 17, internal_epoch   2,  Average loss: 0.0022, Accuracy: 506/526 (96.1977%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.5784, Accuracy: 5881/10000 (58.8100%)
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 223, local model 11, internal_epoch   1,  Average loss: 0.0022, Accuracy: 526/546 (96.3370%)
___Train Local_ResNet_18,  epoch 223, local model 11, internal_epoch   2,  Average loss: 0.0029, Accuracy: 519/546 (95.0549%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 2.0778, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 223, local model 46, internal_epoch   1,  Average loss: 0.0012, Accuracy: 592/601 (98.5025%)
___Train Local_ResNet_18,  epoch 223, local model 46, internal_epoch   2,  Average loss: 0.0009, Accuracy: 591/601 (98.3361%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.4325, Accuracy: 6097/10000 (60.9700%)
time spent on training: 79.42316198348999
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.21040235525024534  data num: [314, 367, 802, 362, 529, 601, 447, 526, 546, 601]
[rfa agg] considering poison per batch poison_fraction: 0.016437684003925417
[rfa agg] init. name: [65, 0, 98, 20, 45, 82, 88, 17, 11, 46], weight: tensor([0.0616, 0.0720, 0.1574, 0.0711, 0.1038, 0.1180, 0.0877, 0.1032, 0.1072,
        0.1180])
[rfa agg] iter:  0, prev_obj_val: 29.69973373413086, obj_val: 29.570819854736328, abs dis: 0.12891387939453125
[rfa agg] iter:  0, weight: tensor([0.1050, 0.2260, 0.0420, 0.1955, 0.0622, 0.0545, 0.1307, 0.0633, 0.0657,
        0.0550])
[rfa agg] iter:  1, prev_obj_val: 29.570819854736328, obj_val: 41.109344482421875, abs dis: 11.538524627685547
[rfa agg] iter:  1, weight: tensor([0.0962, 0.2606, 0.0378, 0.2130, 0.0560, 0.0491, 0.1214, 0.0571, 0.0592,
        0.0497])
[rfa agg] iter:  2, prev_obj_val: 41.109344482421875, obj_val: 33.03412628173828, abs dis: 8.075218200683594
[rfa agg] iter:  2, weight: tensor([0.2655, 0.1332, 0.0531, 0.1287, 0.0652, 0.0613, 0.0976, 0.0656, 0.0681,
        0.0617])
[rfa agg] iter:  3, prev_obj_val: 33.03412628173828, obj_val: 26.74727439880371, abs dis: 6.28685188293457
[rfa agg] iter:  3, weight: tensor([0.2005, 0.1976, 0.0413, 0.1785, 0.0569, 0.0513, 0.1046, 0.0576, 0.0598,
        0.0518])
[rfa agg] iter:  4, prev_obj_val: 26.74727439880371, obj_val: 29.582242965698242, abs dis: 2.8349685668945312
[rfa agg] iter:  4, weight: tensor([0.0731, 0.1900, 0.0438, 0.1711, 0.0709, 0.0601, 0.1813, 0.0730, 0.0757,
        0.0610])
[rfa agg] iter:  5, prev_obj_val: 29.582242965698242, obj_val: 29.568641662597656, abs dis: 0.013601303100585938
[rfa agg] iter:  5, weight: tensor([0.0979, 0.2518, 0.0386, 0.2083, 0.0572, 0.0502, 0.1264, 0.0583, 0.0605,
        0.0507])
[rfa agg] iter:  6, prev_obj_val: 29.568641662597656, obj_val: 45.46446228027344, abs dis: 15.895820617675781
[rfa agg] iter:  6, weight: tensor([0.0949, 0.2663, 0.0374, 0.2140, 0.0553, 0.0485, 0.1196, 0.0564, 0.0585,
        0.0491])
[rfa agg] iter:  7, prev_obj_val: 45.46446228027344, obj_val: 33.03640365600586, abs dis: 12.428058624267578
[rfa agg] iter:  7, weight: tensor([0.2063, 0.1291, 0.0637, 0.1257, 0.0747, 0.0714, 0.1043, 0.0750, 0.0779,
        0.0718])
[rfa agg] iter:  8, prev_obj_val: 33.03640365600586, obj_val: 29.578731536865234, abs dis: 3.457672119140625
[rfa agg] iter:  8, weight: tensor([0.1965, 0.1981, 0.0416, 0.1791, 0.0573, 0.0517, 0.1054, 0.0580, 0.0602,
        0.0521])
[rfa agg] iter:  9, prev_obj_val: 29.578731536865234, obj_val: 36.90119171142578, abs dis: 7.322460174560547
[rfa agg] iter:  9, weight: tensor([0.0987, 0.2556, 0.0382, 0.2120, 0.0565, 0.0496, 0.1217, 0.0576, 0.0598,
        0.0501])
___Test Target_ResNet_18 poisoned: False, epoch: 223: Average loss: 0.6342, Accuracy: 7852/10000 (78.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 223: Average loss: 5.2351, Accuracy: 637/9000 (7.0778%)
Done in 159.76311564445496 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:224 choose agents : [85, 42, 29, 8, 63, 48, 69, 96, 88, 17]. Adversary List: []
___Train Local_ResNet_18,  epoch 224, local model 85, internal_epoch   1,  Average loss: 0.0027, Accuracy: 353/364 (96.9780%)
___Train Local_ResNet_18,  epoch 224, local model 85, internal_epoch   2,  Average loss: 0.0010, Accuracy: 362/364 (99.4505%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 2.6299, Accuracy: 4235/10000 (42.3500%)
___Train Local_ResNet_18,  epoch 224, local model 42, internal_epoch   1,  Average loss: 0.0029, Accuracy: 193/198 (97.4747%)
___Train Local_ResNet_18,  epoch 224, local model 42, internal_epoch   2,  Average loss: 0.0010, Accuracy: 198/198 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.7658, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 224, local model 29, internal_epoch   1,  Average loss: 0.0031, Accuracy: 794/848 (93.6321%)
___Train Local_ResNet_18,  epoch 224, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 801/848 (94.4575%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 3.8855, Accuracy: 3562/10000 (35.6200%)
___Train Local_ResNet_18,  epoch 224, local model 8, internal_epoch   1,  Average loss: 0.0012, Accuracy: 526/534 (98.5019%)
___Train Local_ResNet_18,  epoch 224, local model 8, internal_epoch   2,  Average loss: 0.0010, Accuracy: 526/534 (98.5019%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 2.0036, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 224, local model 63, internal_epoch   1,  Average loss: 0.0016, Accuracy: 731/752 (97.2074%)
___Train Local_ResNet_18,  epoch 224, local model 63, internal_epoch   2,  Average loss: 0.0013, Accuracy: 736/752 (97.8723%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.4259, Accuracy: 6194/10000 (61.9400%)
___Train Local_ResNet_18,  epoch 224, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 349/378 (92.3280%)
___Train Local_ResNet_18,  epoch 224, local model 48, internal_epoch   2,  Average loss: 0.0017, Accuracy: 364/378 (96.2963%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 3.2732, Accuracy: 3912/10000 (39.1200%)
___Train Local_ResNet_18,  epoch 224, local model 69, internal_epoch   1,  Average loss: 0.0076, Accuracy: 187/216 (86.5741%)
___Train Local_ResNet_18,  epoch 224, local model 69, internal_epoch   2,  Average loss: 0.0015, Accuracy: 214/216 (99.0741%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 12.5457, Accuracy: 1026/10000 (10.2600%)
___Train Local_ResNet_18,  epoch 224, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 680/708 (96.0452%)
___Train Local_ResNet_18,  epoch 224, local model 96, internal_epoch   2,  Average loss: 0.0191, Accuracy: 500/708 (70.6215%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 59.0832, Accuracy: 1221/10000 (12.2100%)
___Train Local_ResNet_18,  epoch 224, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 417/447 (93.2886%)
___Train Local_ResNet_18,  epoch 224, local model 88, internal_epoch   2,  Average loss: 0.0016, Accuracy: 431/447 (96.4206%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 3.3425, Accuracy: 4240/10000 (42.4000%)
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 224, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 514/526 (97.7186%)
___Train Local_ResNet_18,  epoch 224, local model 17, internal_epoch   2,  Average loss: 0.0012, Accuracy: 517/526 (98.2890%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.4850, Accuracy: 5979/10000 (59.7900%)
time spent on training: 73.97950029373169
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10581371957352645  data num: [364, 198, 848, 534, 752, 378, 216, 708, 447, 526]
[rfa agg] considering poison per batch poison_fraction: 0.008266696841681754
[rfa agg] init. name: [85, 42, 29, 8, 63, 48, 69, 96, 88, 17], weight: tensor([0.0732, 0.0398, 0.1706, 0.1074, 0.1513, 0.0760, 0.0435, 0.1424, 0.0899,
        0.1058])
[rfa agg] iter:  0, prev_obj_val: 35.14500427246094, obj_val: 40.82896041870117, abs dis: 5.683956146240234
[rfa agg] iter:  0, weight: tensor([0.1962, 0.0331, 0.0476, 0.0880, 0.0577, 0.1916, 0.0355, 0.0517, 0.2121,
        0.0865])
[rfa agg] iter:  1, prev_obj_val: 40.82896041870117, obj_val: 44.393104553222656, abs dis: 3.5641441345214844
[rfa agg] iter:  1, weight: tensor([0.2443, 0.0575, 0.0445, 0.0678, 0.0518, 0.2350, 0.0600, 0.0467, 0.1256,
        0.0667])
[rfa agg] iter:  2, prev_obj_val: 44.393104553222656, obj_val: 44.38816833496094, abs dis: 0.00493621826171875
[rfa agg] iter:  2, weight: tensor([0.1844, 0.1020, 0.0514, 0.0727, 0.0588, 0.1866, 0.1021, 0.0532, 0.1174,
        0.0715])
___Test Target_ResNet_18 poisoned: False, epoch: 224: Average loss: 0.6338, Accuracy: 7851/10000 (78.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 224: Average loss: 5.2358, Accuracy: 657/9000 (7.3000%)
Done in 140.5064754486084 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:225 choose agents : [20, 71, 51, 95, 80, 24, 55, 13, 63, 61]. Adversary List: []
___Train Local_ResNet_18,  epoch 225, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 332/362 (91.7127%)
___Train Local_ResNet_18,  epoch 225, local model 20, internal_epoch   2,  Average loss: 0.0011, Accuracy: 356/362 (98.3425%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 7.4956, Accuracy: 2576/10000 (25.7600%)
___Train Local_ResNet_18,  epoch 225, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 1090/1166 (93.4820%)
___Train Local_ResNet_18,  epoch 225, local model 71, internal_epoch   2,  Average loss: 0.0088, Accuracy: 957/1166 (82.0755%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 9.9047, Accuracy: 1943/10000 (19.4300%)
___Train Local_ResNet_18,  epoch 225, local model 51, internal_epoch   1,  Average loss: 0.0036, Accuracy: 450/479 (93.9457%)
___Train Local_ResNet_18,  epoch 225, local model 51, internal_epoch   2,  Average loss: 0.0023, Accuracy: 463/479 (96.6597%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 7.8129, Accuracy: 2161/10000 (21.6100%)
___Train Local_ResNet_18,  epoch 225, local model 95, internal_epoch   1,  Average loss: 0.0048, Accuracy: 517/569 (90.8612%)
___Train Local_ResNet_18,  epoch 225, local model 95, internal_epoch   2,  Average loss: 0.0040, Accuracy: 524/569 (92.0914%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 4.5287, Accuracy: 2786/10000 (27.8600%)
___Train Local_ResNet_18,  epoch 225, local model 80, internal_epoch   1,  Average loss: 0.0041, Accuracy: 334/363 (92.0110%)
___Train Local_ResNet_18,  epoch 225, local model 80, internal_epoch   2,  Average loss: 0.0009, Accuracy: 356/363 (98.0716%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 3.1840, Accuracy: 4322/10000 (43.2200%)
___Train Local_ResNet_18,  epoch 225, local model 24, internal_epoch   1,  Average loss: 0.0028, Accuracy: 304/320 (95.0000%)
___Train Local_ResNet_18,  epoch 225, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 320/320 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 2.2630, Accuracy: 4542/10000 (45.4200%)
___Train Local_ResNet_18,  epoch 225, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 273/299 (91.3043%)
___Train Local_ResNet_18,  epoch 225, local model 55, internal_epoch   2,  Average loss: 0.0009, Accuracy: 293/299 (97.9933%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 12.9178, Accuracy: 1470/10000 (14.7000%)
___Train Local_ResNet_18,  epoch 225, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 559/620 (90.1613%)
___Train Local_ResNet_18,  epoch 225, local model 13, internal_epoch   2,  Average loss: 0.0038, Accuracy: 585/620 (94.3548%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 3.0594, Accuracy: 4288/10000 (42.8800%)
___Train Local_ResNet_18,  epoch 225, local model 63, internal_epoch   1,  Average loss: 0.0010, Accuracy: 743/752 (98.8032%)
___Train Local_ResNet_18,  epoch 225, local model 63, internal_epoch   2,  Average loss: 0.0005, Accuracy: 747/752 (99.3351%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 0.9384, Accuracy: 7125/10000 (71.2500%)
___Train Local_ResNet_18,  epoch 225, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 552/590 (93.5593%)
___Train Local_ResNet_18,  epoch 225, local model 61, internal_epoch   2,  Average loss: 0.0064, Accuracy: 519/590 (87.9661%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 6.9813, Accuracy: 2795/10000 (27.9500%)
time spent on training: 70.22263240814209
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [362, 1166, 479, 569, 363, 320, 299, 620, 752, 590]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [20, 71, 51, 95, 80, 24, 55, 13, 63, 61], weight: tensor([0.0656, 0.2112, 0.0868, 0.1031, 0.0658, 0.0580, 0.0542, 0.1123, 0.1362,
        0.1069])
[rfa agg] iter:  0, prev_obj_val: 36.55153274536133, obj_val: 44.116432189941406, abs dis: 7.564899444580078
[rfa agg] iter:  0, weight: tensor([0.0581, 0.0460, 0.2032, 0.2050, 0.0586, 0.0377, 0.0351, 0.1405, 0.0885,
        0.1273])
[rfa agg] iter:  1, prev_obj_val: 44.116432189941406, obj_val: 53.31515884399414, abs dis: 9.198726654052734
[rfa agg] iter:  1, weight: tensor([0.1854, 0.0397, 0.1244, 0.0922, 0.1921, 0.0866, 0.0789, 0.0733, 0.0585,
        0.0689])
[rfa agg] iter:  2, prev_obj_val: 53.31515884399414, obj_val: 66.08448791503906, abs dis: 12.769329071044922
[rfa agg] iter:  2, weight: tensor([0.1218, 0.0317, 0.0596, 0.0530, 0.1240, 0.2775, 0.2004, 0.0466, 0.0411,
        0.0440])
[rfa agg] iter:  3, prev_obj_val: 66.08448791503906, obj_val: 49.734474182128906, abs dis: 16.350013732910156
[rfa agg] iter:  3, weight: tensor([0.1143, 0.0606, 0.0851, 0.0825, 0.1151, 0.1686, 0.1537, 0.0763, 0.0716,
        0.0723])
[rfa agg] iter:  4, prev_obj_val: 49.734474182128906, obj_val: 49.71556091308594, abs dis: 0.01891326904296875
[rfa agg] iter:  4, weight: tensor([0.1749, 0.0322, 0.0690, 0.0587, 0.1826, 0.1868, 0.1544, 0.0504, 0.0433,
        0.0476])
[rfa agg] iter:  5, prev_obj_val: 49.71556091308594, obj_val: 53.28156280517578, abs dis: 3.5660018920898438
[rfa agg] iter:  5, weight: tensor([0.1795, 0.0315, 0.0675, 0.0574, 0.1876, 0.1861, 0.1523, 0.0493, 0.0424,
        0.0465])
[rfa agg] iter:  6, prev_obj_val: 53.28156280517578, obj_val: 66.08663940429688, abs dis: 12.805076599121094
[rfa agg] iter:  6, weight: tensor([0.1152, 0.0299, 0.0561, 0.0500, 0.1175, 0.2994, 0.2075, 0.0440, 0.0388,
        0.0415])
[rfa agg] iter:  7, prev_obj_val: 66.08663940429688, obj_val: 49.734458923339844, abs dis: 16.35218048095703
[rfa agg] iter:  7, weight: tensor([0.1143, 0.0605, 0.0851, 0.0824, 0.1150, 0.1688, 0.1538, 0.0763, 0.0716,
        0.0723])
[rfa agg] iter:  8, prev_obj_val: 49.734458923339844, obj_val: 49.71556091308594, abs dis: 0.01889801025390625
[rfa agg] iter:  8, weight: tensor([0.1749, 0.0322, 0.0690, 0.0587, 0.1826, 0.1868, 0.1545, 0.0504, 0.0433,
        0.0476])
[rfa agg] iter:  9, prev_obj_val: 49.71556091308594, obj_val: 53.28156280517578, abs dis: 3.5660018920898438
[rfa agg] iter:  9, weight: tensor([0.1795, 0.0315, 0.0675, 0.0574, 0.1876, 0.1861, 0.1523, 0.0493, 0.0424,
        0.0465])
___Test Target_ResNet_18 poisoned: False, epoch: 225: Average loss: 0.6243, Accuracy: 7910/10000 (79.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 225: Average loss: 5.3261, Accuracy: 630/9000 (7.0000%)
Done in 158.37205743789673 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:226 choose agents : [41, 90, 74, 85, 14, 21, 78, 1, 2, 9]. Adversary List: []
___Train Local_ResNet_18,  epoch 226, local model 41, internal_epoch   1,  Average loss: 0.0207, Accuracy: 437/513 (85.1852%)
___Train Local_ResNet_18,  epoch 226, local model 41, internal_epoch   2,  Average loss: 0.0115, Accuracy: 408/513 (79.5322%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 5.6025, Accuracy: 2409/10000 (24.0900%)
___Train Local_ResNet_18,  epoch 226, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 540/578 (93.4256%)
___Train Local_ResNet_18,  epoch 226, local model 90, internal_epoch   2,  Average loss: 0.0336, Accuracy: 306/578 (52.9412%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 3424.5085, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 226, local model 74, internal_epoch   1,  Average loss: 0.0021, Accuracy: 454/469 (96.8017%)
___Train Local_ResNet_18,  epoch 226, local model 74, internal_epoch   2,  Average loss: 0.0009, Accuracy: 462/469 (98.5075%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 2.0377, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 226, local model 85, internal_epoch   1,  Average loss: 0.0022, Accuracy: 354/364 (97.2527%)
___Train Local_ResNet_18,  epoch 226, local model 85, internal_epoch   2,  Average loss: 0.0011, Accuracy: 360/364 (98.9011%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 2.2518, Accuracy: 4696/10000 (46.9600%)
___Train Local_ResNet_18,  epoch 226, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 300/318 (94.3396%)
___Train Local_ResNet_18,  epoch 226, local model 14, internal_epoch   2,  Average loss: 0.0006, Accuracy: 313/318 (98.4277%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 5.4275, Accuracy: 3013/10000 (30.1300%)
___Train Local_ResNet_18,  epoch 226, local model 21, internal_epoch   1,  Average loss: 0.0030, Accuracy: 252/262 (96.1832%)
___Train Local_ResNet_18,  epoch 226, local model 21, internal_epoch   2,  Average loss: 0.0021, Accuracy: 259/262 (98.8550%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 2.2974, Accuracy: 4650/10000 (46.5000%)
___Train Local_ResNet_18,  epoch 226, local model 78, internal_epoch   1,  Average loss: 0.0040, Accuracy: 231/255 (90.5882%)
___Train Local_ResNet_18,  epoch 226, local model 78, internal_epoch   2,  Average loss: 0.0009, Accuracy: 254/255 (99.6078%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 3.0770, Accuracy: 4063/10000 (40.6300%)
___Train Local_ResNet_18,  epoch 226, local model 1, internal_epoch   1,  Average loss: 0.0065, Accuracy: 621/641 (96.8799%)
___Train Local_ResNet_18,  epoch 226, local model 1, internal_epoch   2,  Average loss: 0.0124, Accuracy: 571/641 (89.0796%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 2.7085, Accuracy: 4857/10000 (48.5700%)
___Train Local_ResNet_18,  epoch 226, local model 2, internal_epoch   1,  Average loss: 0.0044, Accuracy: 425/461 (92.1909%)
___Train Local_ResNet_18,  epoch 226, local model 2, internal_epoch   2,  Average loss: 0.0033, Accuracy: 429/461 (93.0586%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 3.4143, Accuracy: 3616/10000 (36.1600%)
___Train Local_ResNet_18,  epoch 226, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 339/368 (92.1196%)
___Train Local_ResNet_18,  epoch 226, local model 9, internal_epoch   2,  Average loss: 0.0011, Accuracy: 364/368 (98.9130%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 9.3130, Accuracy: 1554/10000 (15.5400%)
time spent on training: 69.58957648277283
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [513, 578, 469, 364, 318, 262, 255, 641, 461, 368]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [41, 90, 74, 85, 14, 21, 78, 1, 2, 9], weight: tensor([0.1213, 0.1367, 0.1109, 0.0861, 0.0752, 0.0620, 0.0603, 0.1516, 0.1090,
        0.0870])
[rfa agg] iter:  0, prev_obj_val: 36.76273727416992, obj_val: 43.17279052734375, abs dis: 6.410053253173828
[rfa agg] iter:  0, weight: tensor([0.0862, 0.0366, 0.1052, 0.1457, 0.1267, 0.1039, 0.0781, 0.0738, 0.1012,
        0.1428])
[rfa agg] iter:  1, prev_obj_val: 43.17279052734375, obj_val: 39.586360931396484, abs dis: 3.5864295959472656
[rfa agg] iter:  1, weight: tensor([0.0579, 0.0275, 0.0672, 0.1013, 0.1566, 0.1271, 0.2444, 0.0525, 0.0652,
        0.1003])
[rfa agg] iter:  2, prev_obj_val: 39.586360931396484, obj_val: 43.13557434082031, abs dis: 3.549213409423828
[rfa agg] iter:  2, weight: tensor([0.0523, 0.0228, 0.0628, 0.1086, 0.2038, 0.1618, 0.1754, 0.0462, 0.0606,
        0.1057])
[rfa agg] iter:  3, prev_obj_val: 43.13557434082031, obj_val: 47.02629470825195, abs dis: 3.8907203674316406
[rfa agg] iter:  3, weight: tensor([0.0534, 0.0251, 0.0621, 0.0944, 0.1524, 0.1234, 0.2871, 0.0485, 0.0602,
        0.0933])
[rfa agg] iter:  4, prev_obj_val: 47.02629470825195, obj_val: 36.505680084228516, abs dis: 10.520614624023438
[rfa agg] iter:  4, weight: tensor([0.0626, 0.0317, 0.0711, 0.0980, 0.1373, 0.1122, 0.2622, 0.0582, 0.0691,
        0.0976])
[rfa agg] iter:  5, prev_obj_val: 36.505680084228516, obj_val: 51.12098693847656, abs dis: 14.615306854248047
[rfa agg] iter:  5, weight: tensor([0.0514, 0.0206, 0.0641, 0.1325, 0.2280, 0.1775, 0.0955, 0.0440, 0.0615,
        0.1248])
[rfa agg] iter:  6, prev_obj_val: 51.12098693847656, obj_val: 39.6507453918457, abs dis: 11.47024154663086
[rfa agg] iter:  6, weight: tensor([0.0734, 0.0394, 0.0816, 0.1049, 0.1355, 0.1110, 0.2000, 0.0696, 0.0795,
        0.1050])
[rfa agg] iter:  7, prev_obj_val: 39.6507453918457, obj_val: 43.134727478027344, abs dis: 3.4839820861816406
[rfa agg] iter:  7, weight: tensor([0.0551, 0.0243, 0.0660, 0.1124, 0.1966, 0.1572, 0.1664, 0.0487, 0.0638,
        0.1096])
[rfa agg] iter:  8, prev_obj_val: 43.134727478027344, obj_val: 43.12651443481445, abs dis: 0.008213043212890625
[rfa agg] iter:  8, weight: tensor([0.0538, 0.0254, 0.0627, 0.0952, 0.1530, 0.1239, 0.2824, 0.0489, 0.0607,
        0.0941])
[rfa agg] iter:  9, prev_obj_val: 43.12651443481445, obj_val: 47.02720642089844, abs dis: 3.9006919860839844
[rfa agg] iter:  9, weight: tensor([0.0527, 0.0248, 0.0613, 0.0930, 0.1480, 0.1200, 0.3009, 0.0478, 0.0594,
        0.0919])
___Test Target_ResNet_18 poisoned: False, epoch: 226: Average loss: 0.6535, Accuracy: 7801/10000 (78.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 226: Average loss: 4.8638, Accuracy: 697/9000 (7.7444%)
Done in 146.7044861316681 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:227 choose agents : [9, 5, 16, 36, 94, 57, 63, 92, 28, 56]. Adversary List: []
___Train Local_ResNet_18,  epoch 227, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 343/368 (93.2065%)
___Train Local_ResNet_18,  epoch 227, local model 9, internal_epoch   2,  Average loss: 0.0012, Accuracy: 361/368 (98.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 7.9621, Accuracy: 1771/10000 (17.7100%)
___Train Local_ResNet_18,  epoch 227, local model 5, internal_epoch   1,  Average loss: 0.0018, Accuracy: 350/365 (95.8904%)
___Train Local_ResNet_18,  epoch 227, local model 5, internal_epoch   2,  Average loss: 0.0007, Accuracy: 359/365 (98.3562%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.6182, Accuracy: 6006/10000 (60.0600%)
___Train Local_ResNet_18,  epoch 227, local model 16, internal_epoch   1,  Average loss: 0.0030, Accuracy: 735/773 (95.0841%)
___Train Local_ResNet_18,  epoch 227, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 731/773 (94.5666%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 3.5869, Accuracy: 3496/10000 (34.9600%)
___Train Local_ResNet_18,  epoch 227, local model 36, internal_epoch   1,  Average loss: 0.0067, Accuracy: 745/849 (87.7503%)
___Train Local_ResNet_18,  epoch 227, local model 36, internal_epoch   2,  Average loss: 0.0178, Accuracy: 574/849 (67.6090%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 31.4302, Accuracy: 1469/10000 (14.6900%)
___Train Local_ResNet_18,  epoch 227, local model 94, internal_epoch   1,  Average loss: 0.0053, Accuracy: 189/203 (93.1034%)
___Train Local_ResNet_18,  epoch 227, local model 94, internal_epoch   2,  Average loss: 0.0029, Accuracy: 196/203 (96.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 3.3460, Accuracy: 3331/10000 (33.3100%)
___Train Local_ResNet_18,  epoch 227, local model 57, internal_epoch   1,  Average loss: 0.0017, Accuracy: 285/290 (98.2759%)
___Train Local_ResNet_18,  epoch 227, local model 57, internal_epoch   2,  Average loss: 0.0003, Accuracy: 290/290 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.5061, Accuracy: 6367/10000 (63.6700%)
___Train Local_ResNet_18,  epoch 227, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 737/752 (98.0053%)
___Train Local_ResNet_18,  epoch 227, local model 63, internal_epoch   2,  Average loss: 0.0007, Accuracy: 746/752 (99.2021%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.0468, Accuracy: 6856/10000 (68.5600%)
___Train Local_ResNet_18,  epoch 227, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 741/796 (93.0905%)
___Train Local_ResNet_18,  epoch 227, local model 92, internal_epoch   2,  Average loss: 0.0058, Accuracy: 708/796 (88.9447%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 4.6907, Accuracy: 2957/10000 (29.5700%)
___Train Local_ResNet_18,  epoch 227, local model 28, internal_epoch   1,  Average loss: 0.0014, Accuracy: 418/423 (98.8180%)
___Train Local_ResNet_18,  epoch 227, local model 28, internal_epoch   2,  Average loss: 0.0007, Accuracy: 419/423 (99.0544%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.6329, Accuracy: 5920/10000 (59.2000%)
___Train Local_ResNet_18,  epoch 227, local model 56, internal_epoch   1,  Average loss: 0.0015, Accuracy: 728/743 (97.9812%)
___Train Local_ResNet_18,  epoch 227, local model 56, internal_epoch   2,  Average loss: 0.0009, Accuracy: 734/743 (98.7887%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.5010, Accuracy: 6086/10000 (60.8600%)
time spent on training: 72.89019513130188
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [368, 365, 773, 849, 203, 290, 752, 796, 423, 743]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [9, 5, 16, 36, 94, 57, 63, 92, 28, 56], weight: tensor([0.0662, 0.0656, 0.1390, 0.1526, 0.0365, 0.0521, 0.1352, 0.1431, 0.0761,
        0.1336])
[rfa agg] iter:  0, prev_obj_val: 35.548492431640625, obj_val: 37.289710998535156, abs dis: 1.7412185668945312
[rfa agg] iter:  0, weight: tensor([0.0895, 0.0901, 0.1065, 0.0923, 0.0283, 0.0521, 0.1341, 0.1084, 0.1667,
        0.1321])
[rfa agg] iter:  1, prev_obj_val: 37.289710998535156, obj_val: 39.10749435424805, abs dis: 1.8177833557128906
[rfa agg] iter:  1, weight: tensor([0.1033, 0.1046, 0.0897, 0.0790, 0.0297, 0.0567, 0.1101, 0.0914, 0.2270,
        0.1085])
[rfa agg] iter:  2, prev_obj_val: 39.10749435424805, obj_val: 49.560630798339844, abs dis: 10.453136444091797
[rfa agg] iter:  2, weight: tensor([0.1122, 0.1152, 0.0688, 0.0617, 0.0284, 0.0570, 0.0824, 0.0702, 0.3228,
        0.0813])
[rfa agg] iter:  3, prev_obj_val: 49.560630798339844, obj_val: 49.521278381347656, abs dis: 0.0393524169921875
[rfa agg] iter:  3, weight: tensor([0.1922, 0.2248, 0.0426, 0.0403, 0.0526, 0.1941, 0.0480, 0.0436, 0.1144,
        0.0474])
[rfa agg] iter:  4, prev_obj_val: 49.521278381347656, obj_val: 49.52115249633789, abs dis: 0.000125885009765625
[rfa agg] iter:  4, weight: tensor([0.1989, 0.2314, 0.0409, 0.0387, 0.0508, 0.1969, 0.0462, 0.0419, 0.1088,
        0.0456])
___Test Target_ResNet_18 poisoned: False, epoch: 227: Average loss: 0.6487, Accuracy: 7836/10000 (78.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 227: Average loss: 5.0265, Accuracy: 633/9000 (7.0333%)
Done in 139.62376165390015 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:228 choose agents : [44, 40, 74, 85, 2, 99, 35, 70, 88, 50]. Adversary List: []
___Train Local_ResNet_18,  epoch 228, local model 44, internal_epoch   1,  Average loss: 0.0032, Accuracy: 405/436 (92.8899%)
___Train Local_ResNet_18,  epoch 228, local model 44, internal_epoch   2,  Average loss: 0.0012, Accuracy: 427/436 (97.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.5346, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 228, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 600/652 (92.0245%)
___Train Local_ResNet_18,  epoch 228, local model 40, internal_epoch   2,  Average loss: 0.0200, Accuracy: 457/652 (70.0920%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 37.9354, Accuracy: 1576/10000 (15.7600%)
___Train Local_ResNet_18,  epoch 228, local model 74, internal_epoch   1,  Average loss: 0.0026, Accuracy: 452/469 (96.3753%)
___Train Local_ResNet_18,  epoch 228, local model 74, internal_epoch   2,  Average loss: 0.0021, Accuracy: 452/469 (96.3753%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 2.2812, Accuracy: 4539/10000 (45.3900%)
___Train Local_ResNet_18,  epoch 228, local model 85, internal_epoch   1,  Average loss: 0.0023, Accuracy: 352/364 (96.7033%)
___Train Local_ResNet_18,  epoch 228, local model 85, internal_epoch   2,  Average loss: 0.0012, Accuracy: 358/364 (98.3516%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 2.3130, Accuracy: 4716/10000 (47.1600%)
___Train Local_ResNet_18,  epoch 228, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 429/461 (93.0586%)
___Train Local_ResNet_18,  epoch 228, local model 2, internal_epoch   2,  Average loss: 0.0055, Accuracy: 421/461 (91.3232%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 3.5171, Accuracy: 3664/10000 (36.6400%)
___Train Local_ResNet_18,  epoch 228, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 369/391 (94.3734%)
___Train Local_ResNet_18,  epoch 228, local model 99, internal_epoch   2,  Average loss: 0.0048, Accuracy: 364/391 (93.0946%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 3.3323, Accuracy: 4237/10000 (42.3700%)
___Train Local_ResNet_18,  epoch 228, local model 35, internal_epoch   1,  Average loss: 0.0033, Accuracy: 391/419 (93.3174%)
___Train Local_ResNet_18,  epoch 228, local model 35, internal_epoch   2,  Average loss: 0.0013, Accuracy: 406/419 (96.8974%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 4.4314, Accuracy: 2924/10000 (29.2400%)
___Train Local_ResNet_18,  epoch 228, local model 70, internal_epoch   1,  Average loss: 0.0029, Accuracy: 576/610 (94.4262%)
___Train Local_ResNet_18,  epoch 228, local model 70, internal_epoch   2,  Average loss: 0.0032, Accuracy: 577/610 (94.5902%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 3.1424, Accuracy: 4154/10000 (41.5400%)
___Train Local_ResNet_18,  epoch 228, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 421/447 (94.1834%)
___Train Local_ResNet_18,  epoch 228, local model 88, internal_epoch   2,  Average loss: 0.0023, Accuracy: 429/447 (95.9732%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 4.8238, Accuracy: 3362/10000 (33.6200%)
___Train Local_ResNet_18,  epoch 228, local model 50, internal_epoch   1,  Average loss: 0.0015, Accuracy: 395/401 (98.5037%)
___Train Local_ResNet_18,  epoch 228, local model 50, internal_epoch   2,  Average loss: 0.0003, Accuracy: 399/401 (99.5012%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 2.3708, Accuracy: 4961/10000 (49.6100%)
time spent on training: 69.58820605278015
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [436, 652, 469, 364, 461, 391, 419, 610, 447, 401]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [44, 40, 74, 85, 2, 99, 35, 70, 88, 50], weight: tensor([0.0938, 0.1402, 0.1009, 0.0783, 0.0991, 0.0841, 0.0901, 0.1312, 0.0961,
        0.0862])
[rfa agg] iter:  0, prev_obj_val: 20.86806297302246, obj_val: 33.09807205200195, abs dis: 12.230009078979492
[rfa agg] iter:  0, weight: tensor([0.1196, 0.0399, 0.0734, 0.2085, 0.0690, 0.0921, 0.1124, 0.0494, 0.1193,
        0.1162])
[rfa agg] iter:  1, prev_obj_val: 33.09807205200195, obj_val: 28.79463768005371, abs dis: 4.303434371948242
[rfa agg] iter:  1, weight: tensor([0.1126, 0.0627, 0.0875, 0.1551, 0.0845, 0.0974, 0.1077, 0.0727, 0.1150,
        0.1048])
[rfa agg] iter:  2, prev_obj_val: 28.79463768005371, obj_val: 24.591625213623047, abs dis: 4.203012466430664
[rfa agg] iter:  2, weight: tensor([0.1131, 0.0551, 0.0829, 0.1792, 0.0796, 0.0961, 0.1079, 0.0651, 0.1151,
        0.1058])
[rfa agg] iter:  3, prev_obj_val: 24.591625213623047, obj_val: 28.795679092407227, abs dis: 4.20405387878418
[rfa agg] iter:  3, weight: tensor([0.1115, 0.0452, 0.0751, 0.2255, 0.0715, 0.0917, 0.1058, 0.0550, 0.1131,
        0.1056])
[rfa agg] iter:  4, prev_obj_val: 28.795679092407227, obj_val: 24.591405868530273, abs dis: 4.204273223876953
[rfa agg] iter:  4, weight: tensor([0.1128, 0.0548, 0.0826, 0.1817, 0.0793, 0.0958, 0.1076, 0.0649, 0.1150,
        0.1056])
[rfa agg] iter:  5, prev_obj_val: 24.591405868530273, obj_val: 28.795692443847656, abs dis: 4.204286575317383
[rfa agg] iter:  5, weight: tensor([0.1114, 0.0452, 0.0751, 0.2258, 0.0714, 0.0917, 0.1058, 0.0549, 0.1130,
        0.1056])
[rfa agg] iter:  6, prev_obj_val: 28.795692443847656, obj_val: 24.59140396118164, abs dis: 4.204288482666016
[rfa agg] iter:  6, weight: tensor([0.1128, 0.0548, 0.0826, 0.1817, 0.0793, 0.0958, 0.1076, 0.0649, 0.1150,
        0.1056])
[rfa agg] iter:  7, prev_obj_val: 24.59140396118164, obj_val: 28.795692443847656, abs dis: 4.204288482666016
[rfa agg] iter:  7, weight: tensor([0.1114, 0.0452, 0.0751, 0.2258, 0.0714, 0.0917, 0.1058, 0.0549, 0.1130,
        0.1056])
[rfa agg] iter:  8, prev_obj_val: 28.795692443847656, obj_val: 24.59140396118164, abs dis: 4.204288482666016
[rfa agg] iter:  8, weight: tensor([0.1128, 0.0548, 0.0826, 0.1817, 0.0793, 0.0958, 0.1076, 0.0649, 0.1150,
        0.1056])
[rfa agg] iter:  9, prev_obj_val: 24.59140396118164, obj_val: 28.795692443847656, abs dis: 4.204288482666016
[rfa agg] iter:  9, weight: tensor([0.1114, 0.0452, 0.0751, 0.2258, 0.0714, 0.0917, 0.1058, 0.0549, 0.1130,
        0.1056])
___Test Target_ResNet_18 poisoned: False, epoch: 228: Average loss: 0.6550, Accuracy: 7816/10000 (78.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 228: Average loss: 5.0002, Accuracy: 618/9000 (6.8667%)
Done in 146.17241191864014 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:229 choose agents : [86, 60, 41, 79, 76, 67, 9, 40, 72, 44]. Adversary List: []
___Train Local_ResNet_18,  epoch 229, local model 86, internal_epoch   1,  Average loss: 0.0032, Accuracy: 209/212 (98.5849%)
___Train Local_ResNet_18,  epoch 229, local model 86, internal_epoch   2,  Average loss: 0.0020, Accuracy: 207/212 (97.6415%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 2.0154, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 229, local model 60, internal_epoch   1,  Average loss: 0.0020, Accuracy: 277/284 (97.5352%)
___Train Local_ResNet_18,  epoch 229, local model 60, internal_epoch   2,  Average loss: 0.0003, Accuracy: 284/284 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.7917, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 229, local model 41, internal_epoch   1,  Average loss: 0.0059, Accuracy: 443/513 (86.3548%)
___Train Local_ResNet_18,  epoch 229, local model 41, internal_epoch   2,  Average loss: 0.0238, Accuracy: 458/513 (89.2788%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 3.7225, Accuracy: 3800/10000 (38.0000%)
___Train Local_ResNet_18,  epoch 229, local model 79, internal_epoch   1,  Average loss: 0.0045, Accuracy: 135/154 (87.6623%)
___Train Local_ResNet_18,  epoch 229, local model 79, internal_epoch   2,  Average loss: 0.0008, Accuracy: 154/154 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.0173, Accuracy: 6986/10000 (69.8600%)
___Train Local_ResNet_18,  epoch 229, local model 76, internal_epoch   1,  Average loss: 0.0354, Accuracy: 63/65 (96.9231%)
___Train Local_ResNet_18,  epoch 229, local model 76, internal_epoch   2,  Average loss: 0.0471, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 0.9752, Accuracy: 7028/10000 (70.2800%)
___Train Local_ResNet_18,  epoch 229, local model 67, internal_epoch   1,  Average loss: 0.0027, Accuracy: 809/842 (96.0808%)
___Train Local_ResNet_18,  epoch 229, local model 67, internal_epoch   2,  Average loss: 0.0156, Accuracy: 653/842 (77.5534%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 31.9080, Accuracy: 1416/10000 (14.1600%)
___Train Local_ResNet_18,  epoch 229, local model 9, internal_epoch   1,  Average loss: 0.0028, Accuracy: 348/368 (94.5652%)
___Train Local_ResNet_18,  epoch 229, local model 9, internal_epoch   2,  Average loss: 0.0013, Accuracy: 361/368 (98.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 5.4175, Accuracy: 2571/10000 (25.7100%)
___Train Local_ResNet_18,  epoch 229, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 603/652 (92.4847%)
___Train Local_ResNet_18,  epoch 229, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 589/652 (90.3374%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 5.5779, Accuracy: 3513/10000 (35.1300%)
___Train Local_ResNet_18,  epoch 229, local model 72, internal_epoch   1,  Average loss: 0.0068, Accuracy: 530/618 (85.7605%)
___Train Local_ResNet_18,  epoch 229, local model 72, internal_epoch   2,  Average loss: 0.0070, Accuracy: 537/618 (86.8932%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 4.5676, Accuracy: 3260/10000 (32.6000%)
___Train Local_ResNet_18,  epoch 229, local model 44, internal_epoch   1,  Average loss: 0.0020, Accuracy: 420/436 (96.3303%)
___Train Local_ResNet_18,  epoch 229, local model 44, internal_epoch   2,  Average loss: 0.0006, Accuracy: 433/436 (99.3119%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.9110, Accuracy: 5290/10000 (52.9000%)
time spent on training: 68.53712272644043
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [212, 284, 513, 154, 65, 842, 368, 652, 618, 436]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [86, 60, 41, 79, 76, 67, 9, 40, 72, 44], weight: tensor([0.0512, 0.0685, 0.1238, 0.0372, 0.0157, 0.2032, 0.0888, 0.1573, 0.1491,
        0.1052])
[rfa agg] iter:  0, prev_obj_val: 32.14370346069336, obj_val: 41.48250961303711, abs dis: 9.33880615234375
[rfa agg] iter:  0, weight: tensor([0.0366, 0.0720, 0.1190, 0.0202, 0.0068, 0.0621, 0.1580, 0.0832, 0.0996,
        0.3424])
[rfa agg] iter:  1, prev_obj_val: 41.48250961303711, obj_val: 44.75285720825195, abs dis: 3.2703475952148438
[rfa agg] iter:  1, weight: tensor([0.0979, 0.3469, 0.0642, 0.0389, 0.0111, 0.0473, 0.1666, 0.0552, 0.0616,
        0.1103])
[rfa agg] iter:  2, prev_obj_val: 44.75285720825195, obj_val: 44.74837875366211, abs dis: 0.00447845458984375
[rfa agg] iter:  2, weight: tensor([0.1830, 0.2818, 0.0635, 0.0571, 0.0147, 0.0498, 0.1332, 0.0566, 0.0623,
        0.0981])
___Test Target_ResNet_18 poisoned: False, epoch: 229: Average loss: 0.6508, Accuracy: 7836/10000 (78.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 229: Average loss: 5.1241, Accuracy: 583/9000 (6.4778%)
Done in 131.52055144309998 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:230 choose agents : [46, 96, 54, 39, 67, 82, 21, 80, 11, 33]. Adversary List: []
___Train Local_ResNet_18,  epoch 230, local model 46, internal_epoch   1,  Average loss: 0.0011, Accuracy: 593/601 (98.6689%)
___Train Local_ResNet_18,  epoch 230, local model 46, internal_epoch   2,  Average loss: 0.0006, Accuracy: 595/601 (99.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.5170, Accuracy: 5945/10000 (59.4500%)
___Train Local_ResNet_18,  epoch 230, local model 96, internal_epoch   1,  Average loss: 0.0020, Accuracy: 682/708 (96.3277%)
___Train Local_ResNet_18,  epoch 230, local model 96, internal_epoch   2,  Average loss: 0.0032, Accuracy: 682/708 (96.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 2.6737, Accuracy: 4597/10000 (45.9700%)
___Train Local_ResNet_18,  epoch 230, local model 54, internal_epoch   1,  Average loss: 0.0023, Accuracy: 427/440 (97.0455%)
___Train Local_ResNet_18,  epoch 230, local model 54, internal_epoch   2,  Average loss: 0.0007, Accuracy: 436/440 (99.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 2.7184, Accuracy: 4777/10000 (47.7700%)
___Train Local_ResNet_18,  epoch 230, local model 39, internal_epoch   1,  Average loss: 0.0019, Accuracy: 213/217 (98.1567%)
___Train Local_ResNet_18,  epoch 230, local model 39, internal_epoch   2,  Average loss: 0.0004, Accuracy: 216/217 (99.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 0.9987, Accuracy: 6904/10000 (69.0400%)
___Train Local_ResNet_18,  epoch 230, local model 67, internal_epoch   1,  Average loss: 0.0027, Accuracy: 808/842 (95.9620%)
___Train Local_ResNet_18,  epoch 230, local model 67, internal_epoch   2,  Average loss: 0.0179, Accuracy: 602/842 (71.4964%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 33.5359, Accuracy: 1220/10000 (12.2000%)
___Train Local_ResNet_18,  epoch 230, local model 82, internal_epoch   1,  Average loss: 0.0020, Accuracy: 583/601 (97.0050%)
___Train Local_ResNet_18,  epoch 230, local model 82, internal_epoch   2,  Average loss: 0.0016, Accuracy: 587/601 (97.6705%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 2.3176, Accuracy: 5007/10000 (50.0700%)
___Train Local_ResNet_18,  epoch 230, local model 21, internal_epoch   1,  Average loss: 0.0104, Accuracy: 250/262 (95.4198%)
___Train Local_ResNet_18,  epoch 230, local model 21, internal_epoch   2,  Average loss: 0.0245, Accuracy: 217/262 (82.8244%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 26.5644, Accuracy: 1184/10000 (11.8400%)
___Train Local_ResNet_18,  epoch 230, local model 80, internal_epoch   1,  Average loss: 0.0030, Accuracy: 344/363 (94.7658%)
___Train Local_ResNet_18,  epoch 230, local model 80, internal_epoch   2,  Average loss: 0.0008, Accuracy: 360/363 (99.1736%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 4.5736, Accuracy: 3656/10000 (36.5600%)
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 230, local model 11, internal_epoch   1,  Average loss: 0.0020, Accuracy: 526/546 (96.3370%)
___Train Local_ResNet_18,  epoch 230, local model 11, internal_epoch   2,  Average loss: 0.0023, Accuracy: 519/546 (95.0549%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.7667, Accuracy: 5662/10000 (56.6200%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 230, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 498/527 (94.4972%)
___Train Local_ResNet_18,  epoch 230, local model 33, internal_epoch   2,  Average loss: 0.0030, Accuracy: 498/527 (94.4972%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 2.5169, Accuracy: 4368/10000 (43.6800%)
time spent on training: 82.85224723815918
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.21010377912668887  data num: [601, 708, 440, 217, 842, 601, 262, 363, 546, 527]
[rfa agg] considering poison per batch poison_fraction: 0.016414357744272568
[rfa agg] init. name: [46, 96, 54, 39, 67, 82, 21, 80, 11, 33], weight: tensor([0.1177, 0.1386, 0.0862, 0.0425, 0.1649, 0.1177, 0.0513, 0.0711, 0.1069,
        0.1032])
[rfa agg] iter:  0, prev_obj_val: 31.095903396606445, obj_val: 40.23800277709961, abs dis: 9.142099380493164
[rfa agg] iter:  0, weight: tensor([0.0850, 0.0606, 0.2939, 0.0309, 0.0502, 0.0840, 0.0479, 0.1330, 0.1103,
        0.1042])
[rfa agg] iter:  1, prev_obj_val: 40.23800277709961, obj_val: 36.73368835449219, abs dis: 3.504314422607422
[rfa agg] iter:  1, weight: tensor([0.0693, 0.0565, 0.1477, 0.0734, 0.0500, 0.0689, 0.1030, 0.2748, 0.0800,
        0.0765])
[rfa agg] iter:  2, prev_obj_val: 36.73368835449219, obj_val: 36.7217903137207, abs dis: 0.011898040771484375
[rfa agg] iter:  2, weight: tensor([0.0617, 0.0484, 0.1635, 0.0442, 0.0419, 0.0612, 0.0710, 0.3648, 0.0734,
        0.0699])
[rfa agg] iter:  3, prev_obj_val: 36.7217903137207, obj_val: 36.72050094604492, abs dis: 0.00128936767578125
[rfa agg] iter:  3, weight: tensor([0.0583, 0.0457, 0.1554, 0.0418, 0.0396, 0.0578, 0.0656, 0.4004, 0.0693,
        0.0661])
[rfa agg] iter:  4, prev_obj_val: 36.72050094604492, obj_val: 36.72029113769531, abs dis: 0.000209808349609375
[rfa agg] iter:  4, weight: tensor([0.0569, 0.0447, 0.1516, 0.0408, 0.0387, 0.0565, 0.0639, 0.4148, 0.0677,
        0.0645])
[rfa agg] iter:  5, prev_obj_val: 36.72029113769531, obj_val: 33.666839599609375, abs dis: 3.0534515380859375
[rfa agg] iter:  5, weight: tensor([0.0563, 0.0443, 0.1500, 0.0404, 0.0383, 0.0559, 0.0632, 0.4208, 0.0670,
        0.0639])
[rfa agg] iter:  6, prev_obj_val: 33.666839599609375, obj_val: 40.22340774536133, abs dis: 6.556568145751953
[rfa agg] iter:  6, weight: tensor([0.0694, 0.0521, 0.2585, 0.0351, 0.0439, 0.0687, 0.0556, 0.2495, 0.0859,
        0.0814])
[rfa agg] iter:  7, prev_obj_val: 40.22340774536133, obj_val: 36.73213195800781, abs dis: 3.4912757873535156
[rfa agg] iter:  7, weight: tensor([0.0680, 0.0554, 0.1448, 0.0722, 0.0491, 0.0676, 0.1019, 0.2875, 0.0785,
        0.0750])
[rfa agg] iter:  8, prev_obj_val: 36.73213195800781, obj_val: 36.721595764160156, abs dis: 0.01053619384765625
[rfa agg] iter:  8, weight: tensor([0.0613, 0.0481, 0.1624, 0.0440, 0.0417, 0.0608, 0.0705, 0.3689, 0.0729,
        0.0695])
[rfa agg] iter:  9, prev_obj_val: 36.721595764160156, obj_val: 36.7204704284668, abs dis: 0.001125335693359375
[rfa agg] iter:  9, weight: tensor([0.0581, 0.0456, 0.1550, 0.0417, 0.0395, 0.0577, 0.0654, 0.4019, 0.0691,
        0.0659])
___Test Target_ResNet_18 poisoned: False, epoch: 230: Average loss: 0.6434, Accuracy: 7871/10000 (78.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 230: Average loss: 5.2135, Accuracy: 558/9000 (6.2000%)
Done in 165.83016920089722 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:231 choose agents : [91, 23, 65, 69, 44, 38, 93, 2, 16, 36]. Adversary List: []
___Train Local_ResNet_18,  epoch 231, local model 91, internal_epoch   1,  Average loss: 0.0027, Accuracy: 225/234 (96.1538%)
___Train Local_ResNet_18,  epoch 231, local model 91, internal_epoch   2,  Average loss: 0.0004, Accuracy: 234/234 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.2415, Accuracy: 6371/10000 (63.7100%)
___Train Local_ResNet_18,  epoch 231, local model 23, internal_epoch   1,  Average loss: 0.0020, Accuracy: 244/248 (98.3871%)
___Train Local_ResNet_18,  epoch 231, local model 23, internal_epoch   2,  Average loss: 0.0004, Accuracy: 248/248 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.1185, Accuracy: 6699/10000 (66.9900%)
___Train Local_ResNet_18,  epoch 231, local model 65, internal_epoch   1,  Average loss: 0.0025, Accuracy: 300/314 (95.5414%)
___Train Local_ResNet_18,  epoch 231, local model 65, internal_epoch   2,  Average loss: 0.0005, Accuracy: 313/314 (99.6815%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 3.3135, Accuracy: 4317/10000 (43.1700%)
___Train Local_ResNet_18,  epoch 231, local model 69, internal_epoch   1,  Average loss: 0.0069, Accuracy: 192/216 (88.8889%)
___Train Local_ResNet_18,  epoch 231, local model 69, internal_epoch   2,  Average loss: 0.0009, Accuracy: 215/216 (99.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 9.9563, Accuracy: 1110/10000 (11.1000%)
___Train Local_ResNet_18,  epoch 231, local model 44, internal_epoch   1,  Average loss: 0.0017, Accuracy: 426/436 (97.7064%)
___Train Local_ResNet_18,  epoch 231, local model 44, internal_epoch   2,  Average loss: 0.0006, Accuracy: 430/436 (98.6239%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.6067, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 231, local model 38, internal_epoch   1,  Average loss: 0.0022, Accuracy: 726/756 (96.0317%)
___Train Local_ResNet_18,  epoch 231, local model 38, internal_epoch   2,  Average loss: 0.0029, Accuracy: 712/756 (94.1799%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 2.3453, Accuracy: 4821/10000 (48.2100%)
___Train Local_ResNet_18,  epoch 231, local model 93, internal_epoch   1,  Average loss: 0.0022, Accuracy: 564/584 (96.5753%)
___Train Local_ResNet_18,  epoch 231, local model 93, internal_epoch   2,  Average loss: 0.0029, Accuracy: 560/584 (95.8904%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 2.7970, Accuracy: 4485/10000 (44.8500%)
___Train Local_ResNet_18,  epoch 231, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 421/461 (91.3232%)
___Train Local_ResNet_18,  epoch 231, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 426/461 (92.4078%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 3.1055, Accuracy: 3995/10000 (39.9500%)
___Train Local_ResNet_18,  epoch 231, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 742/773 (95.9897%)
___Train Local_ResNet_18,  epoch 231, local model 16, internal_epoch   2,  Average loss: 0.0234, Accuracy: 504/773 (65.2005%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 135.7296, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 231, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 760/849 (89.5171%)
___Train Local_ResNet_18,  epoch 231, local model 36, internal_epoch   2,  Average loss: 0.0154, Accuracy: 615/849 (72.4382%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 23.6025, Accuracy: 1315/10000 (13.1500%)
time spent on training: 68.35170435905457
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [234, 248, 314, 216, 436, 756, 584, 461, 773, 849]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [91, 23, 65, 69, 44, 38, 93, 2, 16, 36], weight: tensor([0.0480, 0.0509, 0.0645, 0.0443, 0.0895, 0.1552, 0.1199, 0.0946, 0.1587,
        0.1743])
[rfa agg] iter:  0, prev_obj_val: 35.76954650878906, obj_val: 42.057037353515625, abs dis: 6.2874908447265625
[rfa agg] iter:  0, weight: tensor([0.0348, 0.0369, 0.0643, 0.0320, 0.2695, 0.0868, 0.1160, 0.2233, 0.0695,
        0.0668])
[rfa agg] iter:  1, prev_obj_val: 42.057037353515625, obj_val: 47.297706604003906, abs dis: 5.240669250488281
[rfa agg] iter:  1, weight: tensor([0.0667, 0.0710, 0.1656, 0.0606, 0.2320, 0.0727, 0.0836, 0.1263, 0.0613,
        0.0602])
[rfa agg] iter:  2, prev_obj_val: 47.297706604003906, obj_val: 50.322105407714844, abs dis: 3.0243988037109375
[rfa agg] iter:  2, weight: tensor([0.0990, 0.1062, 0.3587, 0.0867, 0.0969, 0.0486, 0.0524, 0.0674, 0.0422,
        0.0419])
[rfa agg] iter:  3, prev_obj_val: 50.322105407714844, obj_val: 53.71326446533203, abs dis: 3.3911590576171875
[rfa agg] iter:  3, weight: tensor([0.1642, 0.1801, 0.2330, 0.1323, 0.0733, 0.0427, 0.0449, 0.0547, 0.0374,
        0.0374])
[rfa agg] iter:  4, prev_obj_val: 53.71326446533203, obj_val: 71.00106811523438, abs dis: 17.287803649902344
[rfa agg] iter:  4, weight: tensor([0.2457, 0.2969, 0.0987, 0.1566, 0.0474, 0.0309, 0.0318, 0.0372, 0.0274,
        0.0274])
[rfa agg] iter:  5, prev_obj_val: 71.00106811523438, obj_val: 44.60041809082031, abs dis: 26.400650024414062
[rfa agg] iter:  5, weight: tensor([0.1291, 0.1372, 0.1158, 0.1175, 0.0968, 0.0838, 0.0809, 0.0847, 0.0765,
        0.0777])
[rfa agg] iter:  6, prev_obj_val: 44.60041809082031, obj_val: 50.33078384399414, abs dis: 5.730365753173828
[rfa agg] iter:  6, weight: tensor([0.0831, 0.0885, 0.2636, 0.0749, 0.1522, 0.0634, 0.0703, 0.0961, 0.0543,
        0.0536])
[rfa agg] iter:  7, prev_obj_val: 50.33078384399414, obj_val: 53.71331787109375, abs dis: 3.3825340270996094
[rfa agg] iter:  7, weight: tensor([0.1645, 0.1805, 0.2258, 0.1324, 0.0749, 0.0436, 0.0458, 0.0559, 0.0383,
        0.0382])
[rfa agg] iter:  8, prev_obj_val: 53.71331787109375, obj_val: 71.00100708007812, abs dis: 17.287689208984375
[rfa agg] iter:  8, weight: tensor([0.2456, 0.2966, 0.0987, 0.1566, 0.0475, 0.0310, 0.0318, 0.0372, 0.0274,
        0.0275])
[rfa agg] iter:  9, prev_obj_val: 71.00100708007812, obj_val: 44.60041809082031, abs dis: 26.400588989257812
[rfa agg] iter:  9, weight: tensor([0.1291, 0.1372, 0.1158, 0.1175, 0.0968, 0.0838, 0.0809, 0.0847, 0.0765,
        0.0777])
___Test Target_ResNet_18 poisoned: False, epoch: 231: Average loss: 0.6383, Accuracy: 7879/10000 (78.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 231: Average loss: 5.2270, Accuracy: 540/9000 (6.0000%)
Done in 149.7825129032135 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:232 choose agents : [36, 26, 95, 49, 48, 27, 74, 94, 29, 76]. Adversary List: []
___Train Local_ResNet_18,  epoch 232, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 794/849 (93.5218%)
___Train Local_ResNet_18,  epoch 232, local model 36, internal_epoch   2,  Average loss: 0.0156, Accuracy: 615/849 (72.4382%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 8.4956, Accuracy: 1749/10000 (17.4900%)
___Train Local_ResNet_18,  epoch 232, local model 26, internal_epoch   1,  Average loss: 0.0019, Accuracy: 454/468 (97.0085%)
___Train Local_ResNet_18,  epoch 232, local model 26, internal_epoch   2,  Average loss: 0.0009, Accuracy: 466/468 (99.5726%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.9027, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 232, local model 95, internal_epoch   1,  Average loss: 0.0046, Accuracy: 517/569 (90.8612%)
___Train Local_ResNet_18,  epoch 232, local model 95, internal_epoch   2,  Average loss: 0.0031, Accuracy: 532/569 (93.4974%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 4.8688, Accuracy: 3439/10000 (34.3900%)
___Train Local_ResNet_18,  epoch 232, local model 49, internal_epoch   1,  Average loss: 0.0028, Accuracy: 403/426 (94.6009%)
___Train Local_ResNet_18,  epoch 232, local model 49, internal_epoch   2,  Average loss: 0.0019, Accuracy: 415/426 (97.4178%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 2.3646, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch 232, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 361/378 (95.5026%)
___Train Local_ResNet_18,  epoch 232, local model 48, internal_epoch   2,  Average loss: 0.0009, Accuracy: 372/378 (98.4127%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.8621, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 232, local model 27, internal_epoch   1,  Average loss: 0.0012, Accuracy: 394/397 (99.2443%)
___Train Local_ResNet_18,  epoch 232, local model 27, internal_epoch   2,  Average loss: 0.0007, Accuracy: 396/397 (99.7481%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.3604, Accuracy: 6416/10000 (64.1600%)
___Train Local_ResNet_18,  epoch 232, local model 74, internal_epoch   1,  Average loss: 0.0020, Accuracy: 454/469 (96.8017%)
___Train Local_ResNet_18,  epoch 232, local model 74, internal_epoch   2,  Average loss: 0.0010, Accuracy: 458/469 (97.6546%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.4617, Accuracy: 6018/10000 (60.1800%)
___Train Local_ResNet_18,  epoch 232, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 184/203 (90.6404%)
___Train Local_ResNet_18,  epoch 232, local model 94, internal_epoch   2,  Average loss: 0.0015, Accuracy: 197/203 (97.0443%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 2.9256, Accuracy: 3783/10000 (37.8300%)
___Train Local_ResNet_18,  epoch 232, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 777/848 (91.6274%)
___Train Local_ResNet_18,  epoch 232, local model 29, internal_epoch   2,  Average loss: 0.0057, Accuracy: 769/848 (90.6840%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 8.9039, Accuracy: 2284/10000 (22.8400%)
___Train Local_ResNet_18,  epoch 232, local model 76, internal_epoch   1,  Average loss: 0.0287, Accuracy: 63/65 (96.9231%)
___Train Local_ResNet_18,  epoch 232, local model 76, internal_epoch   2,  Average loss: 0.0414, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.6672, Accuracy: 5573/10000 (55.7300%)
time spent on training: 72.46808576583862
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [849, 468, 569, 426, 378, 397, 469, 203, 848, 65]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 26, 95, 49, 48, 27, 74, 94, 29, 76], weight: tensor([0.1817, 0.1002, 0.1218, 0.0912, 0.0809, 0.0850, 0.1004, 0.0435, 0.1815,
        0.0139])
[rfa agg] iter:  0, prev_obj_val: 28.668672561645508, obj_val: 37.158287048339844, abs dis: 8.489614486694336
[rfa agg] iter:  0, weight: tensor([0.0463, 0.2322, 0.1348, 0.1165, 0.0609, 0.1153, 0.2266, 0.0170, 0.0466,
        0.0037])
[rfa agg] iter:  1, prev_obj_val: 37.158287048339844, obj_val: 37.07495880126953, abs dis: 0.0833282470703125
[rfa agg] iter:  1, weight: tensor([0.0424, 0.0935, 0.0744, 0.1505, 0.3067, 0.1496, 0.0934, 0.0403, 0.0426,
        0.0066])
[rfa agg] iter:  2, prev_obj_val: 37.07495880126953, obj_val: 40.730106353759766, abs dis: 3.6551475524902344
[rfa agg] iter:  2, weight: tensor([0.0378, 0.0828, 0.0659, 0.1373, 0.3787, 0.1350, 0.0826, 0.0360, 0.0380,
        0.0059])
[rfa agg] iter:  3, prev_obj_val: 40.730106353759766, obj_val: 44.56376266479492, abs dis: 3.8336563110351562
[rfa agg] iter:  3, weight: tensor([0.0483, 0.0906, 0.0774, 0.1322, 0.3133, 0.1265, 0.0906, 0.0635, 0.0485,
        0.0091])
[rfa agg] iter:  4, prev_obj_val: 44.56376266479492, obj_val: 48.4589958190918, abs dis: 3.895233154296875
[rfa agg] iter:  4, weight: tensor([0.0581, 0.0967, 0.0869, 0.1292, 0.2234, 0.1224, 0.0967, 0.1147, 0.0584,
        0.0135])
[rfa agg] iter:  5, prev_obj_val: 48.4589958190918, obj_val: 44.56248474121094, abs dis: 3.8965110778808594
[rfa agg] iter:  5, weight: tensor([0.0604, 0.0911, 0.0851, 0.1146, 0.1673, 0.1080, 0.0911, 0.2040, 0.0606,
        0.0177])
[rfa agg] iter:  6, prev_obj_val: 44.56248474121094, obj_val: 48.45866775512695, abs dis: 3.8961830139160156
[rfa agg] iter:  6, weight: tensor([0.0584, 0.0970, 0.0873, 0.1294, 0.2181, 0.1228, 0.0970, 0.1179, 0.0586,
        0.0136])
[rfa agg] iter:  7, prev_obj_val: 48.45866775512695, obj_val: 44.562503814697266, abs dis: 3.8961639404296875
[rfa agg] iter:  7, weight: tensor([0.0604, 0.0911, 0.0851, 0.1145, 0.1672, 0.1079, 0.0911, 0.2043, 0.0606,
        0.0177])
[rfa agg] iter:  8, prev_obj_val: 44.562503814697266, obj_val: 48.45866775512695, abs dis: 3.8961639404296875
[rfa agg] iter:  8, weight: tensor([0.0584, 0.0970, 0.0873, 0.1294, 0.2181, 0.1228, 0.0970, 0.1179, 0.0586,
        0.0136])
[rfa agg] iter:  9, prev_obj_val: 48.45866775512695, obj_val: 44.562503814697266, abs dis: 3.8961639404296875
[rfa agg] iter:  9, weight: tensor([0.0604, 0.0911, 0.0851, 0.1145, 0.1672, 0.1079, 0.0911, 0.2043, 0.0606,
        0.0177])
___Test Target_ResNet_18 poisoned: False, epoch: 232: Average loss: 0.6375, Accuracy: 7891/10000 (78.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 232: Average loss: 5.2053, Accuracy: 557/9000 (6.1889%)
Done in 156.7694251537323 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:233 choose agents : [70, 99, 76, 10, 58, 65, 75, 17, 11, 48]. Adversary List: []
___Train Local_ResNet_18,  epoch 233, local model 70, internal_epoch   1,  Average loss: 0.0026, Accuracy: 581/610 (95.2459%)
___Train Local_ResNet_18,  epoch 233, local model 70, internal_epoch   2,  Average loss: 0.0017, Accuracy: 595/610 (97.5410%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 2.0880, Accuracy: 5031/10000 (50.3100%)
___Train Local_ResNet_18,  epoch 233, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 371/391 (94.8849%)
___Train Local_ResNet_18,  epoch 233, local model 99, internal_epoch   2,  Average loss: 0.0035, Accuracy: 371/391 (94.8849%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 2.7456, Accuracy: 4606/10000 (46.0600%)
___Train Local_ResNet_18,  epoch 233, local model 76, internal_epoch   1,  Average loss: 0.0308, Accuracy: 63/65 (96.9231%)
___Train Local_ResNet_18,  epoch 233, local model 76, internal_epoch   2,  Average loss: 0.0505, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.6203, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 233, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 705/752 (93.7500%)
___Train Local_ResNet_18,  epoch 233, local model 10, internal_epoch   2,  Average loss: 0.0032, Accuracy: 702/752 (93.3511%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 4.5859, Accuracy: 3788/10000 (37.8800%)
___Train Local_ResNet_18,  epoch 233, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 215/234 (91.8803%)
___Train Local_ResNet_18,  epoch 233, local model 58, internal_epoch   2,  Average loss: 0.0004, Accuracy: 234/234 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 4.5940, Accuracy: 2538/10000 (25.3800%)
___Train Local_ResNet_18,  epoch 233, local model 65, internal_epoch   1,  Average loss: 0.0020, Accuracy: 308/314 (98.0892%)
___Train Local_ResNet_18,  epoch 233, local model 65, internal_epoch   2,  Average loss: 0.0004, Accuracy: 314/314 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.5118, Accuracy: 6023/10000 (60.2300%)
___Train Local_ResNet_18,  epoch 233, local model 75, internal_epoch   1,  Average loss: 0.0111, Accuracy: 552/578 (95.5017%)
___Train Local_ResNet_18,  epoch 233, local model 75, internal_epoch   2,  Average loss: 0.0220, Accuracy: 366/578 (63.3218%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 40.1835, Accuracy: 1770/10000 (17.7000%)
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 233, local model 17, internal_epoch   1,  Average loss: 0.0015, Accuracy: 519/526 (98.6692%)
___Train Local_ResNet_18,  epoch 233, local model 17, internal_epoch   2,  Average loss: 0.0015, Accuracy: 514/526 (97.7186%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 2.3742, Accuracy: 5291/10000 (52.9100%)
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 233, local model 11, internal_epoch   1,  Average loss: 0.0019, Accuracy: 528/546 (96.7033%)
___Train Local_ResNet_18,  epoch 233, local model 11, internal_epoch   2,  Average loss: 0.0014, Accuracy: 533/546 (97.6190%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 3.0028, Accuracy: 4034/10000 (40.3400%)
___Train Local_ResNet_18,  epoch 233, local model 48, internal_epoch   1,  Average loss: 0.0019, Accuracy: 372/378 (98.4127%)
___Train Local_ResNet_18,  epoch 233, local model 48, internal_epoch   2,  Average loss: 0.0003, Accuracy: 378/378 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.7247, Accuracy: 5575/10000 (55.7500%)
time spent on training: 81.26844358444214
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.24396904870277653  data num: [610, 391, 65, 752, 234, 314, 578, 526, 546, 378]
[rfa agg] considering poison per batch poison_fraction: 0.019060081929904417
[rfa agg] init. name: [70, 99, 76, 10, 58, 65, 75, 17, 11, 48], weight: tensor([0.1388, 0.0890, 0.0148, 0.1711, 0.0533, 0.0715, 0.1315, 0.1197, 0.1243,
        0.0860])
[rfa agg] iter:  0, prev_obj_val: 25.75031280517578, obj_val: 33.02656936645508, abs dis: 7.276256561279297
[rfa agg] iter:  0, weight: tensor([0.0971, 0.2217, 0.0064, 0.0728, 0.0378, 0.0750, 0.0758, 0.1229, 0.1271,
        0.1634])
[rfa agg] iter:  1, prev_obj_val: 33.02656936645508, obj_val: 32.9770622253418, abs dis: 0.04950714111328125
[rfa agg] iter:  1, weight: tensor([0.0636, 0.1126, 0.0088, 0.0543, 0.0703, 0.2247, 0.0538, 0.0705, 0.0731,
        0.2682])
[rfa agg] iter:  2, prev_obj_val: 32.9770622253418, obj_val: 32.97658920288086, abs dis: 0.0004730224609375
[rfa agg] iter:  2, weight: tensor([0.0604, 0.1047, 0.0084, 0.0516, 0.0675, 0.2375, 0.0509, 0.0669, 0.0694,
        0.2827])
___Test Target_ResNet_18 poisoned: False, epoch: 233: Average loss: 0.6401, Accuracy: 7875/10000 (78.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 233: Average loss: 5.2762, Accuracy: 498/9000 (5.5333%)
Done in 145.10079264640808 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:234 choose agents : [64, 16, 97, 52, 24, 10, 34, 27, 49, 56]. Adversary List: []
___Train Local_ResNet_18,  epoch 234, local model 64, internal_epoch   1,  Average loss: 0.0018, Accuracy: 666/686 (97.0845%)
___Train Local_ResNet_18,  epoch 234, local model 64, internal_epoch   2,  Average loss: 0.0012, Accuracy: 672/686 (97.9592%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.6626, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 234, local model 16, internal_epoch   1,  Average loss: 0.0016, Accuracy: 757/773 (97.9301%)
___Train Local_ResNet_18,  epoch 234, local model 16, internal_epoch   2,  Average loss: 0.0072, Accuracy: 671/773 (86.8047%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 4.0455, Accuracy: 4404/10000 (44.0400%)
___Train Local_ResNet_18,  epoch 234, local model 97, internal_epoch   1,  Average loss: 0.0017, Accuracy: 406/418 (97.1292%)
___Train Local_ResNet_18,  epoch 234, local model 97, internal_epoch   2,  Average loss: 0.0006, Accuracy: 416/418 (99.5215%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 2.1980, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 234, local model 52, internal_epoch   1,  Average loss: 0.0045, Accuracy: 203/214 (94.8598%)
___Train Local_ResNet_18,  epoch 234, local model 52, internal_epoch   2,  Average loss: 0.0013, Accuracy: 212/214 (99.0654%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 2.7635, Accuracy: 4402/10000 (44.0200%)
___Train Local_ResNet_18,  epoch 234, local model 24, internal_epoch   1,  Average loss: 0.0023, Accuracy: 308/320 (96.2500%)
___Train Local_ResNet_18,  epoch 234, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 319/320 (99.6875%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.7252, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 234, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 704/752 (93.6170%)
___Train Local_ResNet_18,  epoch 234, local model 10, internal_epoch   2,  Average loss: 0.0024, Accuracy: 717/752 (95.3457%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 5.3451, Accuracy: 3145/10000 (31.4500%)
___Train Local_ResNet_18,  epoch 234, local model 34, internal_epoch   1,  Average loss: 0.0030, Accuracy: 332/349 (95.1289%)
___Train Local_ResNet_18,  epoch 234, local model 34, internal_epoch   2,  Average loss: 0.0008, Accuracy: 347/349 (99.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 3.7854, Accuracy: 3912/10000 (39.1200%)
___Train Local_ResNet_18,  epoch 234, local model 27, internal_epoch   1,  Average loss: 0.0029, Accuracy: 390/397 (98.2368%)
___Train Local_ResNet_18,  epoch 234, local model 27, internal_epoch   2,  Average loss: 0.0018, Accuracy: 387/397 (97.4811%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 2.0530, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 234, local model 49, internal_epoch   1,  Average loss: 0.0016, Accuracy: 416/426 (97.6526%)
___Train Local_ResNet_18,  epoch 234, local model 49, internal_epoch   2,  Average loss: 0.0006, Accuracy: 421/426 (98.8263%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.9984, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 234, local model 56, internal_epoch   1,  Average loss: 0.0013, Accuracy: 733/743 (98.6541%)
___Train Local_ResNet_18,  epoch 234, local model 56, internal_epoch   2,  Average loss: 0.0012, Accuracy: 730/743 (98.2503%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.3918, Accuracy: 6372/10000 (63.7200%)
time spent on training: 70.53002691268921
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [686, 773, 418, 214, 320, 752, 349, 397, 426, 743]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [64, 16, 97, 52, 24, 10, 34, 27, 49, 56], weight: tensor([0.1351, 0.1522, 0.0823, 0.0421, 0.0630, 0.1481, 0.0687, 0.0782, 0.0839,
        0.1463])
[rfa agg] iter:  0, prev_obj_val: 30.792362213134766, obj_val: 35.86838912963867, abs dis: 5.076026916503906
[rfa agg] iter:  0, weight: tensor([0.0500, 0.0374, 0.2353, 0.0208, 0.0463, 0.0436, 0.0885, 0.1773, 0.2571,
        0.0437])
[rfa agg] iter:  1, prev_obj_val: 35.86838912963867, obj_val: 35.83428955078125, abs dis: 0.034099578857421875
[rfa agg] iter:  1, weight: tensor([0.0509, 0.0407, 0.1453, 0.0390, 0.1120, 0.0462, 0.2401, 0.1302, 0.1495,
        0.0461])
[rfa agg] iter:  2, prev_obj_val: 35.83428955078125, obj_val: 39.12909698486328, abs dis: 3.2948074340820312
[rfa agg] iter:  2, weight: tensor([0.0486, 0.0389, 0.1368, 0.0373, 0.1079, 0.0441, 0.2787, 0.1228, 0.1407,
        0.0441])
[rfa agg] iter:  3, prev_obj_val: 39.12909698486328, obj_val: 39.12233352661133, abs dis: 0.006763458251953125
[rfa agg] iter:  3, weight: tensor([0.0510, 0.0419, 0.1100, 0.0562, 0.2137, 0.0470, 0.2191, 0.1015, 0.1126,
        0.0469])
[rfa agg] iter:  4, prev_obj_val: 39.12233352661133, obj_val: 39.12227249145508, abs dis: 6.103515625e-05
[rfa agg] iter:  4, weight: tensor([0.0509, 0.0418, 0.1097, 0.0562, 0.2227, 0.0469, 0.2117, 0.1011, 0.1123,
        0.0468])
___Test Target_ResNet_18 poisoned: False, epoch: 234: Average loss: 0.6342, Accuracy: 7919/10000 (79.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 234: Average loss: 5.3638, Accuracy: 462/9000 (5.1333%)
Done in 136.30627393722534 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:235 choose agents : [48, 14, 45, 65, 37, 38, 24, 99, 56, 20]. Adversary List: []
___Train Local_ResNet_18,  epoch 235, local model 48, internal_epoch   1,  Average loss: 0.0017, Accuracy: 368/378 (97.3545%)
___Train Local_ResNet_18,  epoch 235, local model 48, internal_epoch   2,  Average loss: 0.0003, Accuracy: 378/378 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.5950, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 235, local model 14, internal_epoch   1,  Average loss: 0.0041, Accuracy: 291/318 (91.5094%)
___Train Local_ResNet_18,  epoch 235, local model 14, internal_epoch   2,  Average loss: 0.0007, Accuracy: 314/318 (98.7421%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 4.4445, Accuracy: 3378/10000 (33.7800%)
___Train Local_ResNet_18,  epoch 235, local model 45, internal_epoch   1,  Average loss: 0.0043, Accuracy: 495/529 (93.5728%)
___Train Local_ResNet_18,  epoch 235, local model 45, internal_epoch   2,  Average loss: 0.0110, Accuracy: 441/529 (83.3648%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 23.5584, Accuracy: 1152/10000 (11.5200%)
___Train Local_ResNet_18,  epoch 235, local model 65, internal_epoch   1,  Average loss: 0.0017, Accuracy: 312/314 (99.3631%)
___Train Local_ResNet_18,  epoch 235, local model 65, internal_epoch   2,  Average loss: 0.0002, Accuracy: 314/314 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.4234, Accuracy: 6157/10000 (61.5700%)
___Train Local_ResNet_18,  epoch 235, local model 37, internal_epoch   1,  Average loss: 0.0045, Accuracy: 666/725 (91.8621%)
___Train Local_ResNet_18,  epoch 235, local model 37, internal_epoch   2,  Average loss: 0.0176, Accuracy: 543/725 (74.8966%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 30.5031, Accuracy: 1509/10000 (15.0900%)
___Train Local_ResNet_18,  epoch 235, local model 38, internal_epoch   1,  Average loss: 0.0018, Accuracy: 733/756 (96.9577%)
___Train Local_ResNet_18,  epoch 235, local model 38, internal_epoch   2,  Average loss: 0.0031, Accuracy: 708/756 (93.6508%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 3.0510, Accuracy: 4390/10000 (43.9000%)
___Train Local_ResNet_18,  epoch 235, local model 24, internal_epoch   1,  Average loss: 0.0021, Accuracy: 309/320 (96.5625%)
___Train Local_ResNet_18,  epoch 235, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 320/320 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.6557, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 235, local model 99, internal_epoch   1,  Average loss: 0.0052, Accuracy: 368/391 (94.1176%)
___Train Local_ResNet_18,  epoch 235, local model 99, internal_epoch   2,  Average loss: 0.0160, Accuracy: 311/391 (79.5396%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 17.2349, Accuracy: 1602/10000 (16.0200%)
___Train Local_ResNet_18,  epoch 235, local model 56, internal_epoch   1,  Average loss: 0.0009, Accuracy: 734/743 (98.7887%)
___Train Local_ResNet_18,  epoch 235, local model 56, internal_epoch   2,  Average loss: 0.0006, Accuracy: 738/743 (99.3271%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.1728, Accuracy: 6683/10000 (66.8300%)
___Train Local_ResNet_18,  epoch 235, local model 20, internal_epoch   1,  Average loss: 0.0038, Accuracy: 341/362 (94.1989%)
___Train Local_ResNet_18,  epoch 235, local model 20, internal_epoch   2,  Average loss: 0.0011, Accuracy: 354/362 (97.7901%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 5.0037, Accuracy: 3838/10000 (38.3800%)
time spent on training: 72.66107726097107
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [378, 318, 529, 314, 725, 756, 320, 391, 743, 362]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [48, 14, 45, 65, 37, 38, 24, 99, 56, 20], weight: tensor([0.0782, 0.0658, 0.1094, 0.0649, 0.1499, 0.1563, 0.0662, 0.0809, 0.1536,
        0.0749])
[rfa agg] iter:  0, prev_obj_val: 34.67015075683594, obj_val: 54.209354400634766, abs dis: 19.539203643798828
[rfa agg] iter:  0, weight: tensor([0.1810, 0.1347, 0.0484, 0.1552, 0.0368, 0.0391, 0.1572, 0.0612, 0.0387,
        0.1477])
[rfa agg] iter:  1, prev_obj_val: 54.209354400634766, obj_val: 37.38050842285156, abs dis: 16.828845977783203
[rfa agg] iter:  1, weight: tensor([0.1104, 0.1362, 0.0760, 0.1369, 0.0697, 0.0736, 0.1394, 0.0802, 0.0727,
        0.1048])
[rfa agg] iter:  2, prev_obj_val: 37.38050842285156, obj_val: 49.83515167236328, abs dis: 12.454643249511719
[rfa agg] iter:  2, weight: tensor([0.0957, 0.1675, 0.0343, 0.2449, 0.0274, 0.0291, 0.2451, 0.0421, 0.0288,
        0.0851])
[rfa agg] iter:  3, prev_obj_val: 49.83515167236328, obj_val: 37.35947036743164, abs dis: 12.47568130493164
[rfa agg] iter:  3, weight: tensor([0.1098, 0.1485, 0.0686, 0.1511, 0.0612, 0.0648, 0.1539, 0.0745, 0.0640,
        0.1036])
[rfa agg] iter:  4, prev_obj_val: 37.35947036743164, obj_val: 54.220218658447266, abs dis: 16.860748291015625
[rfa agg] iter:  4, weight: tensor([0.0934, 0.1678, 0.0334, 0.2492, 0.0266, 0.0283, 0.2495, 0.0409, 0.0280,
        0.0830])
[rfa agg] iter:  5, prev_obj_val: 54.220218658447266, obj_val: 37.38007354736328, abs dis: 16.840145111083984
[rfa agg] iter:  5, weight: tensor([0.1103, 0.1365, 0.0759, 0.1372, 0.0696, 0.0736, 0.1398, 0.0800, 0.0726,
        0.1045])
[rfa agg] iter:  6, prev_obj_val: 37.38007354736328, obj_val: 49.835166931152344, abs dis: 12.455093383789062
[rfa agg] iter:  6, weight: tensor([0.0956, 0.1675, 0.0343, 0.2450, 0.0273, 0.0291, 0.2452, 0.0421, 0.0288,
        0.0851])
[rfa agg] iter:  7, prev_obj_val: 49.835166931152344, obj_val: 37.359474182128906, abs dis: 12.475692749023438
[rfa agg] iter:  7, weight: tensor([0.1098, 0.1485, 0.0686, 0.1511, 0.0612, 0.0648, 0.1539, 0.0745, 0.0640,
        0.1036])
[rfa agg] iter:  8, prev_obj_val: 37.359474182128906, obj_val: 54.220218658447266, abs dis: 16.86074447631836
[rfa agg] iter:  8, weight: tensor([0.0934, 0.1678, 0.0334, 0.2492, 0.0266, 0.0283, 0.2495, 0.0409, 0.0280,
        0.0830])
[rfa agg] iter:  9, prev_obj_val: 54.220218658447266, obj_val: 37.38007354736328, abs dis: 16.840145111083984
[rfa agg] iter:  9, weight: tensor([0.1103, 0.1365, 0.0759, 0.1372, 0.0696, 0.0736, 0.1398, 0.0800, 0.0726,
        0.1045])
___Test Target_ResNet_18 poisoned: False, epoch: 235: Average loss: 0.6339, Accuracy: 7923/10000 (79.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 235: Average loss: 5.4005, Accuracy: 471/9000 (5.2333%)
Done in 155.1082365512848 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:236 choose agents : [0, 86, 37, 20, 36, 50, 78, 63, 83, 4]. Adversary List: []
___Train Local_ResNet_18,  epoch 236, local model 0, internal_epoch   1,  Average loss: 0.0024, Accuracy: 357/367 (97.2752%)
___Train Local_ResNet_18,  epoch 236, local model 0, internal_epoch   2,  Average loss: 0.0013, Accuracy: 360/367 (98.0926%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 2.7897, Accuracy: 4097/10000 (40.9700%)
___Train Local_ResNet_18,  epoch 236, local model 86, internal_epoch   1,  Average loss: 0.0024, Accuracy: 211/212 (99.5283%)
___Train Local_ResNet_18,  epoch 236, local model 86, internal_epoch   2,  Average loss: 0.0011, Accuracy: 210/212 (99.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 0.9956, Accuracy: 7102/10000 (71.0200%)
___Train Local_ResNet_18,  epoch 236, local model 37, internal_epoch   1,  Average loss: 0.0049, Accuracy: 661/725 (91.1724%)
___Train Local_ResNet_18,  epoch 236, local model 37, internal_epoch   2,  Average loss: 0.0105, Accuracy: 598/725 (82.4828%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 5.1908, Accuracy: 3474/10000 (34.7400%)
___Train Local_ResNet_18,  epoch 236, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 326/362 (90.0552%)
___Train Local_ResNet_18,  epoch 236, local model 20, internal_epoch   2,  Average loss: 0.0021, Accuracy: 348/362 (96.1326%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 5.8719, Accuracy: 2765/10000 (27.6500%)
___Train Local_ResNet_18,  epoch 236, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 791/849 (93.1684%)
___Train Local_ResNet_18,  epoch 236, local model 36, internal_epoch   2,  Average loss: 0.0110, Accuracy: 687/849 (80.9187%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 7.8182, Accuracy: 2544/10000 (25.4400%)
___Train Local_ResNet_18,  epoch 236, local model 50, internal_epoch   1,  Average loss: 0.0017, Accuracy: 392/401 (97.7556%)
___Train Local_ResNet_18,  epoch 236, local model 50, internal_epoch   2,  Average loss: 0.0010, Accuracy: 396/401 (98.7531%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.9923, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 236, local model 78, internal_epoch   1,  Average loss: 0.0026, Accuracy: 244/255 (95.6863%)
___Train Local_ResNet_18,  epoch 236, local model 78, internal_epoch   2,  Average loss: 0.0007, Accuracy: 252/255 (98.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 2.0217, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 236, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 738/752 (98.1383%)
___Train Local_ResNet_18,  epoch 236, local model 63, internal_epoch   2,  Average loss: 0.0013, Accuracy: 734/752 (97.6064%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.6581, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 236, local model 83, internal_epoch   1,  Average loss: 0.0008, Accuracy: 365/366 (99.7268%)
___Train Local_ResNet_18,  epoch 236, local model 83, internal_epoch   2,  Average loss: 0.0002, Accuracy: 366/366 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 0.7953, Accuracy: 7469/10000 (74.6900%)
___Train Local_ResNet_18,  epoch 236, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 525/557 (94.2549%)
___Train Local_ResNet_18,  epoch 236, local model 4, internal_epoch   2,  Average loss: 0.0025, Accuracy: 530/557 (95.1526%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 2.3539, Accuracy: 5576/10000 (55.7600%)
time spent on training: 71.54807496070862
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [367, 212, 725, 362, 849, 401, 255, 752, 366, 557]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [0, 86, 37, 20, 36, 50, 78, 63, 83, 4], weight: tensor([0.0757, 0.0437, 0.1496, 0.0747, 0.1752, 0.0827, 0.0526, 0.1552, 0.0755,
        0.1149])
[rfa agg] iter:  0, prev_obj_val: 34.24840545654297, obj_val: 39.0260124206543, abs dis: 4.777606964111328
[rfa agg] iter:  0, weight: tensor([0.1733, 0.0305, 0.0470, 0.1577, 0.0408, 0.1864, 0.0366, 0.0497, 0.2009,
        0.0773])
[rfa agg] iter:  1, prev_obj_val: 39.0260124206543, obj_val: 42.465816497802734, abs dis: 3.4398040771484375
[rfa agg] iter:  1, weight: tensor([0.2026, 0.0502, 0.0397, 0.1820, 0.0358, 0.0934, 0.0600, 0.0419, 0.2379,
        0.0565])
[rfa agg] iter:  2, prev_obj_val: 42.465816497802734, obj_val: 46.018043518066406, abs dis: 3.552227020263672
[rfa agg] iter:  2, weight: tensor([0.1625, 0.0959, 0.0485, 0.1548, 0.0444, 0.0931, 0.1143, 0.0511, 0.1701,
        0.0652])
[rfa agg] iter:  3, prev_obj_val: 46.018043518066406, obj_val: 42.46742248535156, abs dis: 3.5506210327148438
[rfa agg] iter:  3, weight: tensor([0.1155, 0.1740, 0.0466, 0.1120, 0.0433, 0.0773, 0.2042, 0.0490, 0.1182,
        0.0598])
[rfa agg] iter:  4, prev_obj_val: 42.46742248535156, obj_val: 46.017723083496094, abs dis: 3.5503005981445312
[rfa agg] iter:  4, weight: tensor([0.1602, 0.0973, 0.0486, 0.1527, 0.0445, 0.0933, 0.1164, 0.0513, 0.1702,
        0.0654])
[rfa agg] iter:  5, prev_obj_val: 46.017723083496094, obj_val: 42.46743392944336, abs dis: 3.5502891540527344
[rfa agg] iter:  5, weight: tensor([0.1154, 0.1741, 0.0466, 0.1120, 0.0433, 0.0773, 0.2043, 0.0490, 0.1182,
        0.0598])
[rfa agg] iter:  6, prev_obj_val: 42.46743392944336, obj_val: 46.017723083496094, abs dis: 3.5502891540527344
[rfa agg] iter:  6, weight: tensor([0.1602, 0.0973, 0.0486, 0.1527, 0.0445, 0.0933, 0.1164, 0.0513, 0.1702,
        0.0654])
[rfa agg] iter:  7, prev_obj_val: 46.017723083496094, obj_val: 42.46743392944336, abs dis: 3.5502891540527344
[rfa agg] iter:  7, weight: tensor([0.1154, 0.1741, 0.0466, 0.1120, 0.0433, 0.0773, 0.2043, 0.0490, 0.1182,
        0.0598])
[rfa agg] iter:  8, prev_obj_val: 42.46743392944336, obj_val: 46.017723083496094, abs dis: 3.5502891540527344
[rfa agg] iter:  8, weight: tensor([0.1602, 0.0973, 0.0486, 0.1527, 0.0445, 0.0933, 0.1164, 0.0513, 0.1702,
        0.0654])
[rfa agg] iter:  9, prev_obj_val: 46.017723083496094, obj_val: 42.46743392944336, abs dis: 3.5502891540527344
[rfa agg] iter:  9, weight: tensor([0.1154, 0.1741, 0.0466, 0.1120, 0.0433, 0.0773, 0.2043, 0.0490, 0.1182,
        0.0598])
___Test Target_ResNet_18 poisoned: False, epoch: 236: Average loss: 0.6319, Accuracy: 7924/10000 (79.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 236: Average loss: 5.4766, Accuracy: 448/9000 (4.9778%)
Done in 152.21106100082397 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:237 choose agents : [1, 0, 37, 91, 77, 21, 13, 70, 54, 57]. Adversary List: []
___Train Local_ResNet_18,  epoch 237, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 620/641 (96.7239%)
___Train Local_ResNet_18,  epoch 237, local model 1, internal_epoch   2,  Average loss: 0.0108, Accuracy: 587/641 (91.5757%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 3.0422, Accuracy: 3761/10000 (37.6100%)
___Train Local_ResNet_18,  epoch 237, local model 0, internal_epoch   1,  Average loss: 0.0016, Accuracy: 363/367 (98.9101%)
___Train Local_ResNet_18,  epoch 237, local model 0, internal_epoch   2,  Average loss: 0.0007, Accuracy: 363/367 (98.9101%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 2.3475, Accuracy: 4611/10000 (46.1100%)
___Train Local_ResNet_18,  epoch 237, local model 37, internal_epoch   1,  Average loss: 0.0046, Accuracy: 665/725 (91.7241%)
___Train Local_ResNet_18,  epoch 237, local model 37, internal_epoch   2,  Average loss: 0.0095, Accuracy: 604/725 (83.3103%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 32.6037, Accuracy: 1491/10000 (14.9100%)
___Train Local_ResNet_18,  epoch 237, local model 91, internal_epoch   1,  Average loss: 0.0021, Accuracy: 225/234 (96.1538%)
___Train Local_ResNet_18,  epoch 237, local model 91, internal_epoch   2,  Average loss: 0.0005, Accuracy: 234/234 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.0062, Accuracy: 6943/10000 (69.4300%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 237, local model 77, internal_epoch   1,  Average loss: 0.0011, Accuracy: 492/496 (99.1935%)
___Train Local_ResNet_18,  epoch 237, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 496/496 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.1481, Accuracy: 6790/10000 (67.9000%)
___Train Local_ResNet_18,  epoch 237, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 251/262 (95.8015%)
___Train Local_ResNet_18,  epoch 237, local model 21, internal_epoch   2,  Average loss: 0.0076, Accuracy: 254/262 (96.9466%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 3.8770, Accuracy: 3691/10000 (36.9100%)
___Train Local_ResNet_18,  epoch 237, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 574/620 (92.5806%)
___Train Local_ResNet_18,  epoch 237, local model 13, internal_epoch   2,  Average loss: 0.0032, Accuracy: 581/620 (93.7097%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 3.2978, Accuracy: 4103/10000 (41.0300%)
___Train Local_ResNet_18,  epoch 237, local model 70, internal_epoch   1,  Average loss: 0.0024, Accuracy: 584/610 (95.7377%)
___Train Local_ResNet_18,  epoch 237, local model 70, internal_epoch   2,  Average loss: 0.0015, Accuracy: 588/610 (96.3934%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 2.9493, Accuracy: 4271/10000 (42.7100%)
___Train Local_ResNet_18,  epoch 237, local model 54, internal_epoch   1,  Average loss: 0.0020, Accuracy: 430/440 (97.7273%)
___Train Local_ResNet_18,  epoch 237, local model 54, internal_epoch   2,  Average loss: 0.0011, Accuracy: 432/440 (98.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 3.5075, Accuracy: 4333/10000 (43.3300%)
___Train Local_ResNet_18,  epoch 237, local model 57, internal_epoch   1,  Average loss: 0.0017, Accuracy: 289/290 (99.6552%)
___Train Local_ResNet_18,  epoch 237, local model 57, internal_epoch   2,  Average loss: 0.0004, Accuracy: 288/290 (99.3103%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.1965, Accuracy: 6681/10000 (66.8100%)
time spent on training: 73.51262927055359
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10586979722518676  data num: [641, 367, 725, 234, 496, 262, 620, 610, 440, 290]
[rfa agg] considering poison per batch poison_fraction: 0.008271077908217716
[rfa agg] init. name: [1, 0, 37, 91, 77, 21, 13, 70, 54, 57], weight: tensor([0.1368, 0.0783, 0.1547, 0.0499, 0.1059, 0.0559, 0.1323, 0.1302, 0.0939,
        0.0619])
[rfa agg] iter:  0, prev_obj_val: 29.79357147216797, obj_val: 32.44805145263672, abs dis: 2.65447998046875
[rfa agg] iter:  0, weight: tensor([0.0505, 0.2942, 0.0472, 0.0458, 0.0969, 0.0838, 0.0604, 0.0600, 0.1541,
        0.1072])
[rfa agg] iter:  1, prev_obj_val: 32.44805145263672, obj_val: 39.30029296875, abs dis: 6.852241516113281
[rfa agg] iter:  1, weight: tensor([0.0450, 0.2428, 0.0425, 0.0596, 0.0770, 0.1215, 0.0528, 0.0524, 0.1103,
        0.1960])
[rfa agg] iter:  2, prev_obj_val: 39.30029296875, obj_val: 35.58745574951172, abs dis: 3.7128372192382812
[rfa agg] iter:  2, weight: tensor([0.0446, 0.1093, 0.0433, 0.1774, 0.0645, 0.1464, 0.0507, 0.0502, 0.0792,
        0.2344])
[rfa agg] iter:  3, prev_obj_val: 35.58745574951172, obj_val: 51.99171447753906, abs dis: 16.404258728027344
[rfa agg] iter:  3, weight: tensor([0.0357, 0.1158, 0.0342, 0.0759, 0.0556, 0.1420, 0.0412, 0.0408, 0.0724,
        0.3863])
[rfa agg] iter:  4, prev_obj_val: 51.99171447753906, obj_val: 35.613319396972656, abs dis: 16.378395080566406
[rfa agg] iter:  4, weight: tensor([0.0689, 0.1052, 0.0687, 0.1927, 0.0857, 0.1083, 0.0759, 0.0750, 0.0946,
        0.1250])
[rfa agg] iter:  5, prev_obj_val: 35.613319396972656, obj_val: 51.989356994628906, abs dis: 16.37603759765625
[rfa agg] iter:  5, weight: tensor([0.0383, 0.1235, 0.0367, 0.0810, 0.0595, 0.1434, 0.0441, 0.0437, 0.0776,
        0.3521])
[rfa agg] iter:  6, prev_obj_val: 51.989356994628906, obj_val: 35.61333084106445, abs dis: 16.376026153564453
[rfa agg] iter:  6, weight: tensor([0.0689, 0.1052, 0.0687, 0.1927, 0.0857, 0.1083, 0.0759, 0.0750, 0.0946,
        0.1249])
[rfa agg] iter:  7, prev_obj_val: 35.61333084106445, obj_val: 51.989349365234375, abs dis: 16.376018524169922
[rfa agg] iter:  7, weight: tensor([0.0383, 0.1235, 0.0367, 0.0811, 0.0595, 0.1434, 0.0441, 0.0437, 0.0776,
        0.3521])
[rfa agg] iter:  8, prev_obj_val: 51.989349365234375, obj_val: 35.61333084106445, abs dis: 16.376018524169922
[rfa agg] iter:  8, weight: tensor([0.0689, 0.1052, 0.0687, 0.1927, 0.0857, 0.1083, 0.0759, 0.0750, 0.0946,
        0.1249])
[rfa agg] iter:  9, prev_obj_val: 35.61333084106445, obj_val: 51.989349365234375, abs dis: 16.376018524169922
[rfa agg] iter:  9, weight: tensor([0.0383, 0.1235, 0.0367, 0.0811, 0.0595, 0.1434, 0.0441, 0.0437, 0.0776,
        0.3521])
___Test Target_ResNet_18 poisoned: False, epoch: 237: Average loss: 0.6316, Accuracy: 7927/10000 (79.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 237: Average loss: 5.5407, Accuracy: 469/9000 (5.2111%)
Done in 156.48757410049438 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:238 choose agents : [41, 28, 85, 59, 89, 31, 33, 42, 82, 68]. Adversary List: []
___Train Local_ResNet_18,  epoch 238, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 467/513 (91.0331%)
___Train Local_ResNet_18,  epoch 238, local model 41, internal_epoch   2,  Average loss: 0.0033, Accuracy: 477/513 (92.9825%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 4.2711, Accuracy: 3775/10000 (37.7500%)
___Train Local_ResNet_18,  epoch 238, local model 28, internal_epoch   1,  Average loss: 0.0011, Accuracy: 419/423 (99.0544%)
___Train Local_ResNet_18,  epoch 238, local model 28, internal_epoch   2,  Average loss: 0.0004, Accuracy: 422/423 (99.7636%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.8306, Accuracy: 5944/10000 (59.4400%)
___Train Local_ResNet_18,  epoch 238, local model 85, internal_epoch   1,  Average loss: 0.0022, Accuracy: 354/364 (97.2527%)
___Train Local_ResNet_18,  epoch 238, local model 85, internal_epoch   2,  Average loss: 0.0017, Accuracy: 355/364 (97.5275%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 3.0252, Accuracy: 3909/10000 (39.0900%)
___Train Local_ResNet_18,  epoch 238, local model 59, internal_epoch   1,  Average loss: 0.0020, Accuracy: 619/642 (96.4174%)
___Train Local_ResNet_18,  epoch 238, local model 59, internal_epoch   2,  Average loss: 0.0018, Accuracy: 627/642 (97.6636%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 3.2432, Accuracy: 3844/10000 (38.4400%)
___Train Local_ResNet_18,  epoch 238, local model 89, internal_epoch   1,  Average loss: 0.0032, Accuracy: 389/413 (94.1889%)
___Train Local_ResNet_18,  epoch 238, local model 89, internal_epoch   2,  Average loss: 0.0009, Accuracy: 408/413 (98.7893%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 3.4456, Accuracy: 3643/10000 (36.4300%)
___Train Local_ResNet_18,  epoch 238, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 680/706 (96.3173%)
___Train Local_ResNet_18,  epoch 238, local model 31, internal_epoch   2,  Average loss: 0.0240, Accuracy: 479/706 (67.8470%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 135.0569, Accuracy: 1000/10000 (10.0000%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 238, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 503/527 (95.4459%)
___Train Local_ResNet_18,  epoch 238, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 486/527 (92.2201%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 2.6612, Accuracy: 4239/10000 (42.3900%)
___Train Local_ResNet_18,  epoch 238, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 193/198 (97.4747%)
___Train Local_ResNet_18,  epoch 238, local model 42, internal_epoch   2,  Average loss: 0.0027, Accuracy: 194/198 (97.9798%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 5.2306, Accuracy: 2962/10000 (29.6200%)
___Train Local_ResNet_18,  epoch 238, local model 82, internal_epoch   1,  Average loss: 0.0025, Accuracy: 578/601 (96.1730%)
___Train Local_ResNet_18,  epoch 238, local model 82, internal_epoch   2,  Average loss: 0.0024, Accuracy: 576/601 (95.8403%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 3.5985, Accuracy: 3683/10000 (36.8300%)
___Train Local_ResNet_18,  epoch 238, local model 68, internal_epoch   1,  Average loss: 0.0007, Accuracy: 416/416 (100.0000%)
___Train Local_ResNet_18,  epoch 238, local model 68, internal_epoch   2,  Average loss: 0.0003, Accuracy: 415/416 (99.7596%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 0.7818, Accuracy: 7609/10000 (76.0900%)
time spent on training: 73.01074957847595
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10972308973558192  data num: [513, 423, 364, 642, 413, 706, 527, 198, 601, 416]
[rfa agg] considering poison per batch poison_fraction: 0.008572116385592337
[rfa agg] init. name: [41, 28, 85, 59, 89, 31, 33, 42, 82, 68], weight: tensor([0.1068, 0.0881, 0.0758, 0.1337, 0.0860, 0.1470, 0.1097, 0.0412, 0.1251,
        0.0866])
[rfa agg] iter:  0, prev_obj_val: 29.089719772338867, obj_val: 28.845561981201172, abs dis: 0.2441577911376953
[rfa agg] iter:  0, weight: tensor([0.0654, 0.1501, 0.2412, 0.0511, 0.1335, 0.0444, 0.0673, 0.0378, 0.0591,
        0.1502])
[rfa agg] iter:  1, prev_obj_val: 28.845561981201172, obj_val: 40.61867141723633, abs dis: 11.773109436035156
[rfa agg] iter:  1, weight: tensor([0.0561, 0.1376, 0.3250, 0.0437, 0.1212, 0.0374, 0.0578, 0.0328, 0.0506,
        0.1377])
[rfa agg] iter:  2, prev_obj_val: 40.61867141723633, obj_val: 36.57329177856445, abs dis: 4.045379638671875
[rfa agg] iter:  2, weight: tensor([0.0737, 0.1107, 0.1564, 0.0648, 0.1059, 0.0589, 0.0758, 0.1731, 0.0714,
        0.1093])
[rfa agg] iter:  3, prev_obj_val: 36.57329177856445, obj_val: 36.57032775878906, abs dis: 0.002964019775390625
[rfa agg] iter:  3, weight: tensor([0.0737, 0.1228, 0.1966, 0.0627, 0.1162, 0.0562, 0.0758, 0.1046, 0.0700,
        0.1214])
___Test Target_ResNet_18 poisoned: False, epoch: 238: Average loss: 0.6281, Accuracy: 7931/10000 (79.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 238: Average loss: 5.5217, Accuracy: 446/9000 (4.9556%)
Done in 147.0804328918457 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:239 choose agents : [37, 47, 73, 15, 90, 9, 71, 78, 77, 69]. Adversary List: []
___Train Local_ResNet_18,  epoch 239, local model 37, internal_epoch   1,  Average loss: 0.0034, Accuracy: 679/725 (93.6552%)
___Train Local_ResNet_18,  epoch 239, local model 37, internal_epoch   2,  Average loss: 0.0080, Accuracy: 619/725 (85.3793%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 5.1217, Accuracy: 3203/10000 (32.0300%)
___Train Local_ResNet_18,  epoch 239, local model 47, internal_epoch   1,  Average loss: 0.0027, Accuracy: 622/654 (95.1070%)
___Train Local_ResNet_18,  epoch 239, local model 47, internal_epoch   2,  Average loss: 0.0028, Accuracy: 629/654 (96.1774%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.5253, Accuracy: 5995/10000 (59.9500%)
___Train Local_ResNet_18,  epoch 239, local model 73, internal_epoch   1,  Average loss: 0.0099, Accuracy: 415/500 (83.0000%)
___Train Local_ResNet_18,  epoch 239, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 462/500 (92.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 8.7887, Accuracy: 1787/10000 (17.8700%)
___Train Local_ResNet_18,  epoch 239, local model 15, internal_epoch   1,  Average loss: 0.0076, Accuracy: 293/341 (85.9238%)
___Train Local_ResNet_18,  epoch 239, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 326/341 (95.6012%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 3.2788, Accuracy: 3505/10000 (35.0500%)
___Train Local_ResNet_18,  epoch 239, local model 90, internal_epoch   1,  Average loss: 0.0083, Accuracy: 539/578 (93.2526%)
___Train Local_ResNet_18,  epoch 239, local model 90, internal_epoch   2,  Average loss: 0.0118, Accuracy: 473/578 (81.8339%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 39.6010, Accuracy: 1448/10000 (14.4800%)
___Train Local_ResNet_18,  epoch 239, local model 9, internal_epoch   1,  Average loss: 0.0028, Accuracy: 351/368 (95.3804%)
___Train Local_ResNet_18,  epoch 239, local model 9, internal_epoch   2,  Average loss: 0.0008, Accuracy: 365/368 (99.1848%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 6.3815, Accuracy: 2283/10000 (22.8300%)
___Train Local_ResNet_18,  epoch 239, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 1106/1166 (94.8542%)
___Train Local_ResNet_18,  epoch 239, local model 71, internal_epoch   2,  Average loss: 0.0123, Accuracy: 917/1166 (78.6449%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 4.4891, Accuracy: 2680/10000 (26.8000%)
___Train Local_ResNet_18,  epoch 239, local model 78, internal_epoch   1,  Average loss: 0.0020, Accuracy: 249/255 (97.6471%)
___Train Local_ResNet_18,  epoch 239, local model 78, internal_epoch   2,  Average loss: 0.0004, Accuracy: 255/255 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.3925, Accuracy: 6356/10000 (63.5600%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 239, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 490/496 (98.7903%)
___Train Local_ResNet_18,  epoch 239, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.3691, Accuracy: 6398/10000 (63.9800%)
___Train Local_ResNet_18,  epoch 239, local model 69, internal_epoch   1,  Average loss: 0.0061, Accuracy: 192/216 (88.8889%)
___Train Local_ResNet_18,  epoch 239, local model 69, internal_epoch   2,  Average loss: 0.0011, Accuracy: 214/216 (99.0741%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 6.8615, Accuracy: 1638/10000 (16.3800%)
time spent on training: 79.00393056869507
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.09360256652198529  data num: [725, 654, 500, 341, 578, 368, 1166, 255, 496, 216]
[rfa agg] considering poison per batch poison_fraction: 0.0073127005095301005
[rfa agg] init. name: [37, 47, 73, 15, 90, 9, 71, 78, 77, 69], weight: tensor([0.1368, 0.1234, 0.0944, 0.0644, 0.1091, 0.0694, 0.2200, 0.0481, 0.0936,
        0.0408])
[rfa agg] iter:  0, prev_obj_val: 39.22325134277344, obj_val: 46.618125915527344, abs dis: 7.394874572753906
[rfa agg] iter:  0, weight: tensor([0.0903, 0.1131, 0.1756, 0.0587, 0.1202, 0.0653, 0.0508, 0.0260, 0.2780,
        0.0220])
[rfa agg] iter:  1, prev_obj_val: 46.618125915527344, obj_val: 52.47222137451172, abs dis: 5.854095458984375
[rfa agg] iter:  1, weight: tensor([0.0618, 0.0686, 0.1319, 0.1582, 0.0725, 0.2216, 0.0443, 0.0482, 0.1525,
        0.0405])
[rfa agg] iter:  2, prev_obj_val: 52.47222137451172, obj_val: 52.46445846557617, abs dis: 0.007762908935546875
[rfa agg] iter:  2, weight: tensor([0.0550, 0.0590, 0.0922, 0.1825, 0.0606, 0.2592, 0.0429, 0.0822, 0.0982,
        0.0682])
___Test Target_ResNet_18 poisoned: False, epoch: 239: Average loss: 0.6326, Accuracy: 7933/10000 (79.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 239: Average loss: 5.5834, Accuracy: 425/9000 (4.7222%)
Done in 143.84497165679932 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:240 choose agents : [28, 33, 87, 46, 26, 67, 13, 69, 54, 34]. Adversary List: []
___Train Local_ResNet_18,  epoch 240, local model 28, internal_epoch   1,  Average loss: 0.0009, Accuracy: 423/423 (100.0000%)
___Train Local_ResNet_18,  epoch 240, local model 28, internal_epoch   2,  Average loss: 0.0003, Accuracy: 423/423 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.6000, Accuracy: 6222/10000 (62.2200%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 240, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 497/527 (94.3074%)
___Train Local_ResNet_18,  epoch 240, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 493/527 (93.5484%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 2.8611, Accuracy: 4782/10000 (47.8200%)
___Train Local_ResNet_18,  epoch 240, local model 87, internal_epoch   1,  Average loss: 0.0060, Accuracy: 348/397 (87.6574%)
___Train Local_ResNet_18,  epoch 240, local model 87, internal_epoch   2,  Average loss: 0.0065, Accuracy: 362/397 (91.1839%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 3.7309, Accuracy: 3806/10000 (38.0600%)
___Train Local_ResNet_18,  epoch 240, local model 46, internal_epoch   1,  Average loss: 0.0011, Accuracy: 593/601 (98.6689%)
___Train Local_ResNet_18,  epoch 240, local model 46, internal_epoch   2,  Average loss: 0.0013, Accuracy: 586/601 (97.5042%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.6141, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 240, local model 26, internal_epoch   1,  Average loss: 0.0017, Accuracy: 459/468 (98.0769%)
___Train Local_ResNet_18,  epoch 240, local model 26, internal_epoch   2,  Average loss: 0.0017, Accuracy: 458/468 (97.8632%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 2.3054, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 240, local model 67, internal_epoch   1,  Average loss: 0.0036, Accuracy: 792/842 (94.0618%)
___Train Local_ResNet_18,  epoch 240, local model 67, internal_epoch   2,  Average loss: 0.0194, Accuracy: 569/842 (67.5772%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 369.2621, Accuracy: 1003/10000 (10.0300%)
___Train Local_ResNet_18,  epoch 240, local model 13, internal_epoch   1,  Average loss: 0.0035, Accuracy: 573/620 (92.4194%)
___Train Local_ResNet_18,  epoch 240, local model 13, internal_epoch   2,  Average loss: 0.0020, Accuracy: 601/620 (96.9355%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 3.3699, Accuracy: 3932/10000 (39.3200%)
___Train Local_ResNet_18,  epoch 240, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 195/216 (90.2778%)
___Train Local_ResNet_18,  epoch 240, local model 69, internal_epoch   2,  Average loss: 0.0006, Accuracy: 215/216 (99.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 6.0382, Accuracy: 1802/10000 (18.0200%)
___Train Local_ResNet_18,  epoch 240, local model 54, internal_epoch   1,  Average loss: 0.0022, Accuracy: 424/440 (96.3636%)
___Train Local_ResNet_18,  epoch 240, local model 54, internal_epoch   2,  Average loss: 0.0007, Accuracy: 433/440 (98.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 2.8955, Accuracy: 4601/10000 (46.0100%)
___Train Local_ResNet_18,  epoch 240, local model 34, internal_epoch   1,  Average loss: 0.0020, Accuracy: 342/349 (97.9943%)
___Train Local_ResNet_18,  epoch 240, local model 34, internal_epoch   2,  Average loss: 0.0007, Accuracy: 347/349 (99.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 2.3448, Accuracy: 5555/10000 (55.5500%)
time spent on training: 74.04207849502563
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10792545566250256  data num: [423, 527, 397, 601, 468, 842, 620, 216, 440, 349]
[rfa agg] considering poison per batch poison_fraction: 0.008431676223633012
[rfa agg] init. name: [28, 33, 87, 46, 26, 67, 13, 69, 54, 34], weight: tensor([0.0866, 0.1079, 0.0813, 0.1231, 0.0958, 0.1724, 0.1270, 0.0442, 0.0901,
        0.0715])
[rfa agg] iter:  0, prev_obj_val: 27.691259384155273, obj_val: 34.29930877685547, abs dis: 6.608049392700195
[rfa agg] iter:  0, weight: tensor([0.1967, 0.0682, 0.1232, 0.0580, 0.0970, 0.0372, 0.0590, 0.0289, 0.1795,
        0.1524])
[rfa agg] iter:  1, prev_obj_val: 34.29930877685547, obj_val: 34.292510986328125, abs dis: 0.00679779052734375
[rfa agg] iter:  1, weight: tensor([0.1277, 0.0676, 0.1066, 0.0611, 0.0843, 0.0439, 0.0624, 0.0635, 0.1291,
        0.2539])
___Test Target_ResNet_18 poisoned: False, epoch: 240: Average loss: 0.6261, Accuracy: 7927/10000 (79.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 240: Average loss: 5.6369, Accuracy: 433/9000 (4.8111%)
Done in 136.72282648086548 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:241 choose agents : [78, 91, 57, 30, 75, 17, 28, 31, 85, 45]. Adversary List: []
___Train Local_ResNet_18,  epoch 241, local model 78, internal_epoch   1,  Average loss: 0.0021, Accuracy: 246/255 (96.4706%)
___Train Local_ResNet_18,  epoch 241, local model 78, internal_epoch   2,  Average loss: 0.0005, Accuracy: 255/255 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.7030, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 241, local model 91, internal_epoch   1,  Average loss: 0.0022, Accuracy: 227/234 (97.0085%)
___Train Local_ResNet_18,  epoch 241, local model 91, internal_epoch   2,  Average loss: 0.0005, Accuracy: 233/234 (99.5726%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.0928, Accuracy: 6745/10000 (67.4500%)
___Train Local_ResNet_18,  epoch 241, local model 57, internal_epoch   1,  Average loss: 0.0016, Accuracy: 287/290 (98.9655%)
___Train Local_ResNet_18,  epoch 241, local model 57, internal_epoch   2,  Average loss: 0.0005, Accuracy: 288/290 (99.3103%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.2579, Accuracy: 6661/10000 (66.6100%)
___Train Local_ResNet_18,  epoch 241, local model 30, internal_epoch   1,  Average loss: 0.0024, Accuracy: 330/337 (97.9228%)
___Train Local_ResNet_18,  epoch 241, local model 30, internal_epoch   2,  Average loss: 0.0024, Accuracy: 327/337 (97.0326%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 2.5376, Accuracy: 4680/10000 (46.8000%)
___Train Local_ResNet_18,  epoch 241, local model 75, internal_epoch   1,  Average loss: 0.0021, Accuracy: 561/578 (97.0588%)
___Train Local_ResNet_18,  epoch 241, local model 75, internal_epoch   2,  Average loss: 0.0054, Accuracy: 547/578 (94.6367%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 4.2657, Accuracy: 3269/10000 (32.6900%)
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 241, local model 17, internal_epoch   1,  Average loss: 0.0011, Accuracy: 521/526 (99.0494%)
___Train Local_ResNet_18,  epoch 241, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 522/526 (99.2395%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.5240, Accuracy: 6302/10000 (63.0200%)
___Train Local_ResNet_18,  epoch 241, local model 28, internal_epoch   1,  Average loss: 0.0008, Accuracy: 423/423 (100.0000%)
___Train Local_ResNet_18,  epoch 241, local model 28, internal_epoch   2,  Average loss: 0.0003, Accuracy: 423/423 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.7391, Accuracy: 6118/10000 (61.1800%)
___Train Local_ResNet_18,  epoch 241, local model 31, internal_epoch   1,  Average loss: 0.0037, Accuracy: 683/706 (96.7422%)
___Train Local_ResNet_18,  epoch 241, local model 31, internal_epoch   2,  Average loss: 0.0187, Accuracy: 514/706 (72.8045%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 147.3677, Accuracy: 1478/10000 (14.7800%)
___Train Local_ResNet_18,  epoch 241, local model 85, internal_epoch   1,  Average loss: 0.0016, Accuracy: 361/364 (99.1758%)
___Train Local_ResNet_18,  epoch 241, local model 85, internal_epoch   2,  Average loss: 0.0005, Accuracy: 363/364 (99.7253%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.7388, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 241, local model 45, internal_epoch   1,  Average loss: 0.0038, Accuracy: 504/529 (95.2741%)
___Train Local_ResNet_18,  epoch 241, local model 45, internal_epoch   2,  Average loss: 0.0097, Accuracy: 454/529 (85.8223%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 10.9892, Accuracy: 1972/10000 (19.7200%)
time spent on training: 74.96244478225708
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.123998114097124  data num: [255, 234, 290, 337, 578, 526, 423, 706, 364, 529]
[rfa agg] considering poison per batch poison_fraction: 0.009687352663837813
[rfa agg] init. name: [78, 91, 57, 30, 75, 17, 28, 31, 85, 45], weight: tensor([0.0601, 0.0552, 0.0684, 0.0794, 0.1363, 0.1240, 0.0997, 0.1664, 0.0858,
        0.1247])
[rfa agg] iter:  0, prev_obj_val: 28.595287322998047, obj_val: 31.046276092529297, abs dis: 2.45098876953125
[rfa agg] iter:  0, weight: tensor([0.0674, 0.0620, 0.1664, 0.1700, 0.0531, 0.0626, 0.1125, 0.0437, 0.2016,
        0.0606])
[rfa agg] iter:  1, prev_obj_val: 31.046276092529297, obj_val: 46.39088439941406, abs dis: 15.344608306884766
[rfa agg] iter:  1, weight: tensor([0.0859, 0.0793, 0.3607, 0.1096, 0.0405, 0.0466, 0.0747, 0.0340, 0.1237,
        0.0452])
[rfa agg] iter:  2, prev_obj_val: 46.39088439941406, obj_val: 31.065658569335938, abs dis: 15.325225830078125
[rfa agg] iter:  2, weight: tensor([0.1894, 0.1750, 0.1128, 0.0868, 0.0640, 0.0684, 0.0825, 0.0592, 0.0944,
        0.0676])
[rfa agg] iter:  3, prev_obj_val: 31.065658569335938, obj_val: 46.388973236083984, abs dis: 15.323314666748047
[rfa agg] iter:  3, weight: tensor([0.0898, 0.0827, 0.3405, 0.1111, 0.0420, 0.0483, 0.0773, 0.0353, 0.1262,
        0.0468])
[rfa agg] iter:  4, prev_obj_val: 46.388973236083984, obj_val: 31.065671920776367, abs dis: 15.323301315307617
[rfa agg] iter:  4, weight: tensor([0.1894, 0.1750, 0.1128, 0.0868, 0.0640, 0.0684, 0.0825, 0.0592, 0.0944,
        0.0676])
[rfa agg] iter:  5, prev_obj_val: 31.065671920776367, obj_val: 46.388973236083984, abs dis: 15.323301315307617
[rfa agg] iter:  5, weight: tensor([0.0898, 0.0827, 0.3405, 0.1111, 0.0420, 0.0483, 0.0773, 0.0353, 0.1262,
        0.0468])
[rfa agg] iter:  6, prev_obj_val: 46.388973236083984, obj_val: 31.065671920776367, abs dis: 15.323301315307617
[rfa agg] iter:  6, weight: tensor([0.1894, 0.1750, 0.1128, 0.0868, 0.0640, 0.0684, 0.0825, 0.0592, 0.0944,
        0.0676])
[rfa agg] iter:  7, prev_obj_val: 31.065671920776367, obj_val: 46.388973236083984, abs dis: 15.323301315307617
[rfa agg] iter:  7, weight: tensor([0.0898, 0.0827, 0.3405, 0.1111, 0.0420, 0.0483, 0.0773, 0.0353, 0.1262,
        0.0468])
[rfa agg] iter:  8, prev_obj_val: 46.388973236083984, obj_val: 31.065671920776367, abs dis: 15.323301315307617
[rfa agg] iter:  8, weight: tensor([0.1894, 0.1750, 0.1128, 0.0868, 0.0640, 0.0684, 0.0825, 0.0592, 0.0944,
        0.0676])
[rfa agg] iter:  9, prev_obj_val: 31.065671920776367, obj_val: 46.388973236083984, abs dis: 15.323301315307617
[rfa agg] iter:  9, weight: tensor([0.0898, 0.0827, 0.3405, 0.1111, 0.0420, 0.0483, 0.0773, 0.0353, 0.1262,
        0.0468])
___Test Target_ResNet_18 poisoned: False, epoch: 241: Average loss: 0.6284, Accuracy: 7922/10000 (79.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 241: Average loss: 5.6228, Accuracy: 455/9000 (5.0556%)
Done in 154.59819149971008 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:242 choose agents : [96, 51, 32, 66, 85, 8, 2, 40, 10, 91]. Adversary List: []
___Train Local_ResNet_18,  epoch 242, local model 96, internal_epoch   1,  Average loss: 0.0024, Accuracy: 694/708 (98.0226%)
___Train Local_ResNet_18,  epoch 242, local model 96, internal_epoch   2,  Average loss: 0.0164, Accuracy: 529/708 (74.7175%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 170.4932, Accuracy: 1052/10000 (10.5200%)
___Train Local_ResNet_18,  epoch 242, local model 51, internal_epoch   1,  Average loss: 0.0025, Accuracy: 459/479 (95.8246%)
___Train Local_ResNet_18,  epoch 242, local model 51, internal_epoch   2,  Average loss: 0.0012, Accuracy: 472/479 (98.5386%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 4.8914, Accuracy: 3240/10000 (32.4000%)
___Train Local_ResNet_18,  epoch 242, local model 32, internal_epoch   1,  Average loss: 0.0026, Accuracy: 784/824 (95.1456%)
___Train Local_ResNet_18,  epoch 242, local model 32, internal_epoch   2,  Average loss: 0.0023, Accuracy: 792/824 (96.1165%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 2.2533, Accuracy: 5004/10000 (50.0400%)
___Train Local_ResNet_18,  epoch 242, local model 66, internal_epoch   1,  Average loss: 0.0028, Accuracy: 527/555 (94.9550%)
___Train Local_ResNet_18,  epoch 242, local model 66, internal_epoch   2,  Average loss: 0.0018, Accuracy: 539/555 (97.1171%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 2.5939, Accuracy: 4573/10000 (45.7300%)
___Train Local_ResNet_18,  epoch 242, local model 85, internal_epoch   1,  Average loss: 0.0012, Accuracy: 363/364 (99.7253%)
___Train Local_ResNet_18,  epoch 242, local model 85, internal_epoch   2,  Average loss: 0.0009, Accuracy: 360/364 (98.9011%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 1.3832, Accuracy: 6394/10000 (63.9400%)
___Train Local_ResNet_18,  epoch 242, local model 8, internal_epoch   1,  Average loss: 0.0012, Accuracy: 526/534 (98.5019%)
___Train Local_ResNet_18,  epoch 242, local model 8, internal_epoch   2,  Average loss: 0.0008, Accuracy: 529/534 (99.0637%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 1.9344, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 242, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 434/461 (94.1432%)
___Train Local_ResNet_18,  epoch 242, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 437/461 (94.7939%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 2.5018, Accuracy: 4831/10000 (48.3100%)
___Train Local_ResNet_18,  epoch 242, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 601/652 (92.1779%)
___Train Local_ResNet_18,  epoch 242, local model 40, internal_epoch   2,  Average loss: 0.0086, Accuracy: 572/652 (87.7301%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 7.8006, Accuracy: 2708/10000 (27.0800%)
___Train Local_ResNet_18,  epoch 242, local model 10, internal_epoch   1,  Average loss: 0.0030, Accuracy: 706/752 (93.8830%)
___Train Local_ResNet_18,  epoch 242, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 712/752 (94.6809%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 7.4283, Accuracy: 2522/10000 (25.2200%)
___Train Local_ResNet_18,  epoch 242, local model 91, internal_epoch   1,  Average loss: 0.0017, Accuracy: 230/234 (98.2906%)
___Train Local_ResNet_18,  epoch 242, local model 91, internal_epoch   2,  Average loss: 0.0002, Accuracy: 234/234 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 0.9516, Accuracy: 7057/10000 (70.5700%)
time spent on training: 71.11310005187988
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [708, 479, 824, 555, 364, 534, 461, 652, 752, 234]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [96, 51, 32, 66, 85, 8, 2, 40, 10, 91], weight: tensor([0.1273, 0.0861, 0.1481, 0.0998, 0.0654, 0.0960, 0.0829, 0.1172, 0.1352,
        0.0421])
[rfa agg] iter:  0, prev_obj_val: 28.879425048828125, obj_val: 28.75811195373535, abs dis: 0.12131309509277344
[rfa agg] iter:  0, weight: tensor([0.0559, 0.2077, 0.0562, 0.1233, 0.0881, 0.1263, 0.1879, 0.0673, 0.0620,
        0.0253])
[rfa agg] iter:  1, prev_obj_val: 28.75811195373535, obj_val: 28.757369995117188, abs dis: 0.0007419586181640625
[rfa agg] iter:  1, weight: tensor([0.0524, 0.2218, 0.0531, 0.1188, 0.0847, 0.1217, 0.2014, 0.0635, 0.0586,
        0.0240])
___Test Target_ResNet_18 poisoned: False, epoch: 242: Average loss: 0.6260, Accuracy: 7928/10000 (79.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 242: Average loss: 5.5577, Accuracy: 522/9000 (5.8000%)
Done in 134.65923762321472 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:243 choose agents : [59, 80, 32, 77, 16, 83, 57, 96, 3, 10]. Adversary List: []
___Train Local_ResNet_18,  epoch 243, local model 59, internal_epoch   1,  Average loss: 0.0020, Accuracy: 621/642 (96.7290%)
___Train Local_ResNet_18,  epoch 243, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 627/642 (97.6636%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 2.4282, Accuracy: 4473/10000 (44.7300%)
___Train Local_ResNet_18,  epoch 243, local model 80, internal_epoch   1,  Average loss: 0.0024, Accuracy: 350/363 (96.4187%)
___Train Local_ResNet_18,  epoch 243, local model 80, internal_epoch   2,  Average loss: 0.0007, Accuracy: 360/363 (99.1736%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 2.9141, Accuracy: 4746/10000 (47.4600%)
___Train Local_ResNet_18,  epoch 243, local model 32, internal_epoch   1,  Average loss: 0.0023, Accuracy: 787/824 (95.5097%)
___Train Local_ResNet_18,  epoch 243, local model 32, internal_epoch   2,  Average loss: 0.0032, Accuracy: 774/824 (93.9320%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 2.2351, Accuracy: 5086/10000 (50.8600%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 243, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 492/496 (99.1935%)
___Train Local_ResNet_18,  epoch 243, local model 77, internal_epoch   2,  Average loss: 0.0005, Accuracy: 495/496 (99.7984%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 1.2059, Accuracy: 6638/10000 (66.3800%)
___Train Local_ResNet_18,  epoch 243, local model 16, internal_epoch   1,  Average loss: 0.0026, Accuracy: 735/773 (95.0841%)
___Train Local_ResNet_18,  epoch 243, local model 16, internal_epoch   2,  Average loss: 0.0035, Accuracy: 724/773 (93.6611%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 4.2447, Accuracy: 4044/10000 (40.4400%)
___Train Local_ResNet_18,  epoch 243, local model 83, internal_epoch   1,  Average loss: 0.0008, Accuracy: 363/366 (99.1803%)
___Train Local_ResNet_18,  epoch 243, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 366/366 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 0.7917, Accuracy: 7522/10000 (75.2200%)
___Train Local_ResNet_18,  epoch 243, local model 57, internal_epoch   1,  Average loss: 0.0010, Accuracy: 289/290 (99.6552%)
___Train Local_ResNet_18,  epoch 243, local model 57, internal_epoch   2,  Average loss: 0.0002, Accuracy: 290/290 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 0.9086, Accuracy: 7276/10000 (72.7600%)
___Train Local_ResNet_18,  epoch 243, local model 96, internal_epoch   1,  Average loss: 0.0023, Accuracy: 689/708 (97.3164%)
___Train Local_ResNet_18,  epoch 243, local model 96, internal_epoch   2,  Average loss: 0.0160, Accuracy: 512/708 (72.3164%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 10.9355, Accuracy: 1756/10000 (17.5600%)
___Train Local_ResNet_18,  epoch 243, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 709/780 (90.8974%)
___Train Local_ResNet_18,  epoch 243, local model 3, internal_epoch   2,  Average loss: 0.0178, Accuracy: 555/780 (71.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 26.3827, Accuracy: 1929/10000 (19.2900%)
___Train Local_ResNet_18,  epoch 243, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 693/752 (92.1543%)
___Train Local_ResNet_18,  epoch 243, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 713/752 (94.8138%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 6.0779, Accuracy: 2767/10000 (27.6700%)
time spent on training: 77.90532422065735
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.08274941608274941  data num: [642, 363, 824, 496, 773, 366, 290, 708, 780, 752]
[rfa agg] considering poison per batch poison_fraction: 0.006464798131464798
[rfa agg] init. name: [59, 80, 32, 77, 16, 83, 57, 96, 3, 10], weight: tensor([0.1071, 0.0606, 0.1375, 0.0827, 0.1290, 0.0611, 0.0484, 0.1181, 0.1301,
        0.1255])
[rfa agg] iter:  0, prev_obj_val: 32.63868713378906, obj_val: 37.41716003417969, abs dis: 4.778472900390625
[rfa agg] iter:  0, weight: tensor([0.1142, 0.0663, 0.0842, 0.2970, 0.0791, 0.0675, 0.0386, 0.0841, 0.0733,
        0.0957])
[rfa agg] iter:  1, prev_obj_val: 37.41716003417969, obj_val: 43.122676849365234, abs dis: 5.705516815185547
[rfa agg] iter:  1, weight: tensor([0.0800, 0.1018, 0.0659, 0.3385, 0.0619, 0.1055, 0.0513, 0.0647, 0.0583,
        0.0722])
[rfa agg] iter:  2, prev_obj_val: 43.122676849365234, obj_val: 43.09895706176758, abs dis: 0.02371978759765625
[rfa agg] iter:  2, weight: tensor([0.0589, 0.2173, 0.0526, 0.1350, 0.0493, 0.2534, 0.0793, 0.0509, 0.0473,
        0.0560])
[rfa agg] iter:  3, prev_obj_val: 43.09895706176758, obj_val: 43.09881591796875, abs dis: 0.000141143798828125
[rfa agg] iter:  3, weight: tensor([0.0570, 0.2282, 0.0509, 0.1298, 0.0478, 0.2601, 0.0772, 0.0492, 0.0457,
        0.0542])
___Test Target_ResNet_18 poisoned: False, epoch: 243: Average loss: 0.6264, Accuracy: 7946/10000 (79.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 243: Average loss: 5.5914, Accuracy: 520/9000 (5.7778%)
Done in 137.74191403388977 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:244 choose agents : [15, 14, 29, 50, 17, 36, 2, 0, 94, 1]. Adversary List: []
___Train Local_ResNet_18,  epoch 244, local model 15, internal_epoch   1,  Average loss: 0.0060, Accuracy: 298/341 (87.3900%)
___Train Local_ResNet_18,  epoch 244, local model 15, internal_epoch   2,  Average loss: 0.0030, Accuracy: 325/341 (95.3079%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 3.0330, Accuracy: 4069/10000 (40.6900%)
___Train Local_ResNet_18,  epoch 244, local model 14, internal_epoch   1,  Average loss: 0.0026, Accuracy: 304/318 (95.5975%)
___Train Local_ResNet_18,  epoch 244, local model 14, internal_epoch   2,  Average loss: 0.0004, Accuracy: 317/318 (99.6855%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 5.1224, Accuracy: 3011/10000 (30.1100%)
___Train Local_ResNet_18,  epoch 244, local model 29, internal_epoch   1,  Average loss: 0.0041, Accuracy: 778/848 (91.7453%)
___Train Local_ResNet_18,  epoch 244, local model 29, internal_epoch   2,  Average loss: 0.0065, Accuracy: 754/848 (88.9151%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 8.4051, Accuracy: 2410/10000 (24.1000%)
___Train Local_ResNet_18,  epoch 244, local model 50, internal_epoch   1,  Average loss: 0.0011, Accuracy: 399/401 (99.5012%)
___Train Local_ResNet_18,  epoch 244, local model 50, internal_epoch   2,  Average loss: 0.0004, Accuracy: 400/401 (99.7506%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.8441, Accuracy: 5762/10000 (57.6200%)
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 244, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 519/526 (98.6692%)
___Train Local_ResNet_18,  epoch 244, local model 17, internal_epoch   2,  Average loss: 0.0029, Accuracy: 499/526 (94.8669%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 3.1065, Accuracy: 4291/10000 (42.9100%)
___Train Local_ResNet_18,  epoch 244, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 796/849 (93.7574%)
___Train Local_ResNet_18,  epoch 244, local model 36, internal_epoch   2,  Average loss: 0.0192, Accuracy: 571/849 (67.2556%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 20.5159, Accuracy: 1552/10000 (15.5200%)
___Train Local_ResNet_18,  epoch 244, local model 2, internal_epoch   1,  Average loss: 0.0025, Accuracy: 442/461 (95.8785%)
___Train Local_ResNet_18,  epoch 244, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 449/461 (97.3970%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 3.6736, Accuracy: 3925/10000 (39.2500%)
___Train Local_ResNet_18,  epoch 244, local model 0, internal_epoch   1,  Average loss: 0.0012, Accuracy: 364/367 (99.1826%)
___Train Local_ResNet_18,  epoch 244, local model 0, internal_epoch   2,  Average loss: 0.0004, Accuracy: 366/367 (99.7275%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.5853, Accuracy: 5940/10000 (59.4000%)
___Train Local_ResNet_18,  epoch 244, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 190/203 (93.5961%)
___Train Local_ResNet_18,  epoch 244, local model 94, internal_epoch   2,  Average loss: 0.0024, Accuracy: 196/203 (96.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 2.1842, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch 244, local model 1, internal_epoch   1,  Average loss: 0.0039, Accuracy: 613/641 (95.6318%)
___Train Local_ResNet_18,  epoch 244, local model 1, internal_epoch   2,  Average loss: 0.0122, Accuracy: 578/641 (90.1716%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 3.4843, Accuracy: 3744/10000 (37.4400%)
time spent on training: 77.71777868270874
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10615539858728557  data num: [341, 318, 848, 401, 526, 849, 461, 367, 203, 641]
[rfa agg] considering poison per batch poison_fraction: 0.008293390514631686
[rfa agg] init. name: [15, 14, 29, 50, 17, 36, 2, 0, 94, 1], weight: tensor([0.0688, 0.0642, 0.1711, 0.0809, 0.1062, 0.1713, 0.0930, 0.0741, 0.0410,
        0.1294])
[rfa agg] iter:  0, prev_obj_val: 36.44607925415039, obj_val: 45.24403381347656, abs dis: 8.797954559326172
[rfa agg] iter:  0, weight: tensor([0.1375, 0.0806, 0.0463, 0.2093, 0.0825, 0.0455, 0.1131, 0.1948, 0.0327,
        0.0577])
[rfa agg] iter:  1, prev_obj_val: 45.24403381347656, obj_val: 41.72837448120117, abs dis: 3.5156593322753906
[rfa agg] iter:  1, weight: tensor([0.1228, 0.3014, 0.0412, 0.0874, 0.0572, 0.0406, 0.0667, 0.1534, 0.0825,
        0.0467])
[rfa agg] iter:  2, prev_obj_val: 41.72837448120117, obj_val: 45.22016143798828, abs dis: 3.4917869567871094
[rfa agg] iter:  2, weight: tensor([0.1516, 0.2045, 0.0389, 0.1022, 0.0581, 0.0383, 0.0709, 0.2384, 0.0517,
        0.0454])
[rfa agg] iter:  3, prev_obj_val: 45.22016143798828, obj_val: 49.08232879638672, abs dis: 3.8621673583984375
[rfa agg] iter:  3, weight: tensor([0.1177, 0.3314, 0.0393, 0.0832, 0.0546, 0.0387, 0.0636, 0.1477, 0.0792,
        0.0445])
[rfa agg] iter:  4, prev_obj_val: 49.08232879638672, obj_val: 41.733055114746094, abs dis: 7.349273681640625
[rfa agg] iter:  4, weight: tensor([0.1043, 0.2681, 0.0452, 0.0811, 0.0590, 0.0445, 0.0664, 0.1220, 0.1595,
        0.0499])
[rfa agg] iter:  5, prev_obj_val: 41.733055114746094, obj_val: 41.72053909301758, abs dis: 0.012516021728515625
[rfa agg] iter:  5, weight: tensor([0.1504, 0.2026, 0.0392, 0.1028, 0.0585, 0.0385, 0.0713, 0.2388, 0.0523,
        0.0457])
[rfa agg] iter:  6, prev_obj_val: 41.72053909301758, obj_val: 49.08797836303711, abs dis: 7.367439270019531
[rfa agg] iter:  6, weight: tensor([0.1554, 0.1954, 0.0389, 0.1023, 0.0581, 0.0382, 0.0708, 0.2438, 0.0516,
        0.0454])
[rfa agg] iter:  7, prev_obj_val: 49.08797836303711, obj_val: 41.73224639892578, abs dis: 7.355731964111328
[rfa agg] iter:  7, weight: tensor([0.1070, 0.2556, 0.0459, 0.0824, 0.0599, 0.0452, 0.0674, 0.1244, 0.1616,
        0.0506])
[rfa agg] iter:  8, prev_obj_val: 41.73224639892578, obj_val: 41.720523834228516, abs dis: 0.011722564697265625
[rfa agg] iter:  8, weight: tensor([0.1509, 0.2015, 0.0392, 0.1029, 0.0585, 0.0385, 0.0714, 0.2391, 0.0523,
        0.0457])
[rfa agg] iter:  9, prev_obj_val: 41.720523834228516, obj_val: 49.087989807128906, abs dis: 7.367465972900391
[rfa agg] iter:  9, weight: tensor([0.1555, 0.1953, 0.0389, 0.1023, 0.0581, 0.0382, 0.0708, 0.2438, 0.0516,
        0.0454])
___Test Target_ResNet_18 poisoned: False, epoch: 244: Average loss: 0.6298, Accuracy: 7907/10000 (79.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 244: Average loss: 5.5019, Accuracy: 591/9000 (6.5667%)
Done in 147.52115678787231 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:245 choose agents : [38, 41, 82, 49, 74, 23, 97, 83, 22, 4]. Adversary List: []
___Train Local_ResNet_18,  epoch 245, local model 38, internal_epoch   1,  Average loss: 0.0025, Accuracy: 717/756 (94.8413%)
___Train Local_ResNet_18,  epoch 245, local model 38, internal_epoch   2,  Average loss: 0.0039, Accuracy: 699/756 (92.4603%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 2.9051, Accuracy: 4344/10000 (43.4400%)
___Train Local_ResNet_18,  epoch 245, local model 41, internal_epoch   1,  Average loss: 0.0041, Accuracy: 472/513 (92.0078%)
___Train Local_ResNet_18,  epoch 245, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 474/513 (92.3977%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 6.7607, Accuracy: 2791/10000 (27.9100%)
___Train Local_ResNet_18,  epoch 245, local model 82, internal_epoch   1,  Average loss: 0.0022, Accuracy: 578/601 (96.1730%)
___Train Local_ResNet_18,  epoch 245, local model 82, internal_epoch   2,  Average loss: 0.0022, Accuracy: 581/601 (96.6722%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 2.9736, Accuracy: 4754/10000 (47.5400%)
___Train Local_ResNet_18,  epoch 245, local model 49, internal_epoch   1,  Average loss: 0.0018, Accuracy: 416/426 (97.6526%)
___Train Local_ResNet_18,  epoch 245, local model 49, internal_epoch   2,  Average loss: 0.0004, Accuracy: 423/426 (99.2958%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 2.7627, Accuracy: 4628/10000 (46.2800%)
___Train Local_ResNet_18,  epoch 245, local model 74, internal_epoch   1,  Average loss: 0.0022, Accuracy: 453/469 (96.5885%)
___Train Local_ResNet_18,  epoch 245, local model 74, internal_epoch   2,  Average loss: 0.0012, Accuracy: 463/469 (98.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 2.8243, Accuracy: 4646/10000 (46.4600%)
___Train Local_ResNet_18,  epoch 245, local model 23, internal_epoch   1,  Average loss: 0.0021, Accuracy: 239/248 (96.3710%)
___Train Local_ResNet_18,  epoch 245, local model 23, internal_epoch   2,  Average loss: 0.0004, Accuracy: 247/248 (99.5968%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 1.3203, Accuracy: 6220/10000 (62.2000%)
___Train Local_ResNet_18,  epoch 245, local model 97, internal_epoch   1,  Average loss: 0.0016, Accuracy: 408/418 (97.6077%)
___Train Local_ResNet_18,  epoch 245, local model 97, internal_epoch   2,  Average loss: 0.0011, Accuracy: 412/418 (98.5646%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 2.2112, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 245, local model 83, internal_epoch   1,  Average loss: 0.0005, Accuracy: 366/366 (100.0000%)
___Train Local_ResNet_18,  epoch 245, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 366/366 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 0.6899, Accuracy: 7795/10000 (77.9500%)
___Train Local_ResNet_18,  epoch 245, local model 22, internal_epoch   1,  Average loss: 0.0034, Accuracy: 456/494 (92.3077%)
___Train Local_ResNet_18,  epoch 245, local model 22, internal_epoch   2,  Average loss: 0.0017, Accuracy: 476/494 (96.3563%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 3.6450, Accuracy: 3737/10000 (37.3700%)
___Train Local_ResNet_18,  epoch 245, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 519/557 (93.1777%)
___Train Local_ResNet_18,  epoch 245, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 507/557 (91.0233%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 8.8281, Accuracy: 1743/10000 (17.4300%)
time spent on training: 67.51619911193848
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [756, 513, 601, 426, 469, 248, 418, 366, 494, 557]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 41, 82, 49, 74, 23, 97, 83, 22, 4], weight: tensor([0.1559, 0.1058, 0.1240, 0.0879, 0.0967, 0.0512, 0.0862, 0.0755, 0.1019,
        0.1149])
[rfa agg] iter:  0, prev_obj_val: 25.89008331298828, obj_val: 37.41477584838867, abs dis: 11.52469253540039
[rfa agg] iter:  0, weight: tensor([0.0406, 0.0535, 0.0481, 0.1240, 0.0734, 0.0397, 0.1205, 0.3679, 0.0747,
        0.0576])
[rfa agg] iter:  1, prev_obj_val: 37.41477584838867, obj_val: 33.455162048339844, abs dis: 3.959613800048828
[rfa agg] iter:  1, weight: tensor([0.0585, 0.0657, 0.0634, 0.0987, 0.0777, 0.2455, 0.0965, 0.1423, 0.0808,
        0.0709])
[rfa agg] iter:  2, prev_obj_val: 33.455162048339844, obj_val: 29.54681396484375, abs dis: 3.9083480834960938
[rfa agg] iter:  2, weight: tensor([0.0591, 0.0693, 0.0657, 0.1151, 0.0851, 0.1325, 0.1125, 0.1978, 0.0882,
        0.0748])
[rfa agg] iter:  3, prev_obj_val: 29.54681396484375, obj_val: 29.544925689697266, abs dis: 0.001888275146484375
[rfa agg] iter:  3, weight: tensor([0.0502, 0.0623, 0.0575, 0.1194, 0.0803, 0.0710, 0.1164, 0.2934, 0.0826,
        0.0670])
___Test Target_ResNet_18 poisoned: False, epoch: 245: Average loss: 0.6264, Accuracy: 7932/10000 (79.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 245: Average loss: 5.5865, Accuracy: 542/9000 (6.0222%)
Done in 131.15325498580933 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:246 choose agents : [43, 92, 33, 62, 59, 26, 11, 93, 86, 90]. Adversary List: []
___Train Local_ResNet_18,  epoch 246, local model 43, internal_epoch   1,  Average loss: 0.0043, Accuracy: 314/345 (91.0145%)
___Train Local_ResNet_18,  epoch 246, local model 43, internal_epoch   2,  Average loss: 0.0015, Accuracy: 336/345 (97.3913%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 3.0381, Accuracy: 4585/10000 (45.8500%)
___Train Local_ResNet_18,  epoch 246, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 726/796 (91.2060%)
___Train Local_ResNet_18,  epoch 246, local model 92, internal_epoch   2,  Average loss: 0.0113, Accuracy: 651/796 (81.7839%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 13.5232, Accuracy: 1693/10000 (16.9300%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 246, local model 33, internal_epoch   1,  Average loss: 0.0028, Accuracy: 507/527 (96.2049%)
___Train Local_ResNet_18,  epoch 246, local model 33, internal_epoch   2,  Average loss: 0.0059, Accuracy: 477/527 (90.5123%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 5.4208, Accuracy: 2842/10000 (28.4200%)
___Train Local_ResNet_18,  epoch 246, local model 62, internal_epoch   1,  Average loss: 0.0006, Accuracy: 358/358 (100.0000%)
___Train Local_ResNet_18,  epoch 246, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 358/358 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 0.7760, Accuracy: 7593/10000 (75.9300%)
___Train Local_ResNet_18,  epoch 246, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 626/642 (97.5078%)
___Train Local_ResNet_18,  epoch 246, local model 59, internal_epoch   2,  Average loss: 0.0244, Accuracy: 418/642 (65.1090%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 732.9648, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 246, local model 26, internal_epoch   1,  Average loss: 0.0019, Accuracy: 451/468 (96.3675%)
___Train Local_ResNet_18,  epoch 246, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 443/468 (94.6581%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.9885, Accuracy: 5434/10000 (54.3400%)
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 246, local model 11, internal_epoch   1,  Average loss: 0.0013, Accuracy: 538/546 (98.5348%)
___Train Local_ResNet_18,  epoch 246, local model 11, internal_epoch   2,  Average loss: 0.0010, Accuracy: 538/546 (98.5348%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.6859, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 246, local model 93, internal_epoch   1,  Average loss: 0.0022, Accuracy: 564/584 (96.5753%)
___Train Local_ResNet_18,  epoch 246, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 551/584 (94.3493%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 6.0623, Accuracy: 1961/10000 (19.6100%)
___Train Local_ResNet_18,  epoch 246, local model 86, internal_epoch   1,  Average loss: 0.0015, Accuracy: 212/212 (100.0000%)
___Train Local_ResNet_18,  epoch 246, local model 86, internal_epoch   2,  Average loss: 0.0006, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.0316, Accuracy: 7033/10000 (70.3300%)
___Train Local_ResNet_18,  epoch 246, local model 90, internal_epoch   1,  Average loss: 0.0070, Accuracy: 523/578 (90.4844%)
___Train Local_ResNet_18,  epoch 246, local model 90, internal_epoch   2,  Average loss: 0.0153, Accuracy: 448/578 (77.5087%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 54.1144, Accuracy: 1458/10000 (14.5800%)
time spent on training: 77.39326310157776
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.21222310126582278  data num: [345, 796, 527, 358, 642, 468, 546, 584, 212, 578]
[rfa agg] considering poison per batch poison_fraction: 0.016579929786392403
[rfa agg] init. name: [43, 92, 33, 62, 59, 26, 11, 93, 86, 90], weight: tensor([0.0682, 0.1574, 0.1042, 0.0708, 0.1270, 0.0926, 0.1080, 0.1155, 0.0419,
        0.1143])
[rfa agg] iter:  0, prev_obj_val: 31.499122619628906, obj_val: 34.29317855834961, abs dis: 2.794055938720703
[rfa agg] iter:  0, weight: tensor([0.1671, 0.0556, 0.0909, 0.2220, 0.0582, 0.1269, 0.0979, 0.0744, 0.0385,
        0.0686])
[rfa agg] iter:  1, prev_obj_val: 34.29317855834961, obj_val: 37.8672981262207, abs dis: 3.5741195678710938
[rfa agg] iter:  1, weight: tensor([0.1978, 0.0396, 0.0600, 0.3839, 0.0405, 0.0792, 0.0640, 0.0507, 0.0373,
        0.0470])
[rfa agg] iter:  2, prev_obj_val: 37.8672981262207, obj_val: 34.271400451660156, abs dis: 3.595897674560547
[rfa agg] iter:  2, weight: tensor([0.2098, 0.0480, 0.0673, 0.2943, 0.0485, 0.0835, 0.0714, 0.0586, 0.0639,
        0.0549])
[rfa agg] iter:  3, prev_obj_val: 34.271400451660156, obj_val: 45.695640563964844, abs dis: 11.424240112304688
[rfa agg] iter:  3, weight: tensor([0.2008, 0.0371, 0.0561, 0.4076, 0.0379, 0.0740, 0.0600, 0.0474, 0.0350,
        0.0439])
[rfa agg] iter:  4, prev_obj_val: 45.695640563964844, obj_val: 41.728858947753906, abs dis: 3.9667816162109375
[rfa agg] iter:  4, weight: tensor([0.1378, 0.0589, 0.0734, 0.1509, 0.0584, 0.0840, 0.0772, 0.0669, 0.2286,
        0.0638])
[rfa agg] iter:  5, prev_obj_val: 41.728858947753906, obj_val: 37.86872100830078, abs dis: 3.860137939453125
[rfa agg] iter:  5, weight: tensor([0.1748, 0.0585, 0.0769, 0.2044, 0.0587, 0.0911, 0.0811, 0.0687, 0.1208,
        0.0651])
[rfa agg] iter:  6, prev_obj_val: 37.86872100830078, obj_val: 34.27306365966797, abs dis: 3.5956573486328125
[rfa agg] iter:  6, weight: tensor([0.2070, 0.0492, 0.0690, 0.2846, 0.0499, 0.0855, 0.0731, 0.0601, 0.0653,
        0.0564])
[rfa agg] iter:  7, prev_obj_val: 34.27306365966797, obj_val: 45.69526290893555, abs dis: 11.422199249267578
[rfa agg] iter:  7, weight: tensor([0.2010, 0.0374, 0.0566, 0.4045, 0.0382, 0.0745, 0.0605, 0.0478, 0.0353,
        0.0443])
[rfa agg] iter:  8, prev_obj_val: 45.69526290893555, obj_val: 41.72885513305664, abs dis: 3.9664077758789062
[rfa agg] iter:  8, weight: tensor([0.1378, 0.0589, 0.0734, 0.1509, 0.0584, 0.0841, 0.0772, 0.0669, 0.2285,
        0.0638])
[rfa agg] iter:  9, prev_obj_val: 41.72885513305664, obj_val: 37.86872100830078, abs dis: 3.8601341247558594
[rfa agg] iter:  9, weight: tensor([0.1748, 0.0585, 0.0769, 0.2044, 0.0587, 0.0911, 0.0811, 0.0687, 0.1208,
        0.0651])
___Test Target_ResNet_18 poisoned: False, epoch: 246: Average loss: 0.6275, Accuracy: 7936/10000 (79.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 246: Average loss: 5.5971, Accuracy: 485/9000 (5.3889%)
Done in 148.26074194908142 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:247 choose agents : [80, 12, 53, 55, 18, 42, 52, 31, 29, 13]. Adversary List: []
___Train Local_ResNet_18,  epoch 247, local model 80, internal_epoch   1,  Average loss: 0.0018, Accuracy: 357/363 (98.3471%)
___Train Local_ResNet_18,  epoch 247, local model 80, internal_epoch   2,  Average loss: 0.0006, Accuracy: 362/363 (99.7245%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 2.1990, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 247, local model 12, internal_epoch   1,  Average loss: 0.0030, Accuracy: 928/977 (94.9846%)
___Train Local_ResNet_18,  epoch 247, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 866/977 (88.6387%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 8.6647, Accuracy: 2415/10000 (24.1500%)
___Train Local_ResNet_18,  epoch 247, local model 53, internal_epoch   1,  Average loss: 0.0019, Accuracy: 604/625 (96.6400%)
___Train Local_ResNet_18,  epoch 247, local model 53, internal_epoch   2,  Average loss: 0.0018, Accuracy: 604/625 (96.6400%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 2.0762, Accuracy: 5003/10000 (50.0300%)
___Train Local_ResNet_18,  epoch 247, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 283/299 (94.6488%)
___Train Local_ResNet_18,  epoch 247, local model 55, internal_epoch   2,  Average loss: 0.0006, Accuracy: 297/299 (99.3311%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 3.9193, Accuracy: 3349/10000 (33.4900%)
___Train Local_ResNet_18,  epoch 247, local model 18, internal_epoch   1,  Average loss: 0.0046, Accuracy: 377/386 (97.6684%)
___Train Local_ResNet_18,  epoch 247, local model 18, internal_epoch   2,  Average loss: 0.0219, Accuracy: 252/386 (65.2850%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 122.6833, Accuracy: 1003/10000 (10.0300%)
___Train Local_ResNet_18,  epoch 247, local model 42, internal_epoch   1,  Average loss: 0.0023, Accuracy: 193/198 (97.4747%)
___Train Local_ResNet_18,  epoch 247, local model 42, internal_epoch   2,  Average loss: 0.0003, Accuracy: 198/198 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 1.7660, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 247, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 201/214 (93.9252%)
___Train Local_ResNet_18,  epoch 247, local model 52, internal_epoch   2,  Average loss: 0.0019, Accuracy: 211/214 (98.5981%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 3.5637, Accuracy: 3930/10000 (39.3000%)
___Train Local_ResNet_18,  epoch 247, local model 31, internal_epoch   1,  Average loss: 0.0018, Accuracy: 685/706 (97.0255%)
___Train Local_ResNet_18,  epoch 247, local model 31, internal_epoch   2,  Average loss: 0.0022, Accuracy: 679/706 (96.1756%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 1.5978, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 247, local model 29, internal_epoch   1,  Average loss: 0.0045, Accuracy: 777/848 (91.6274%)
___Train Local_ResNet_18,  epoch 247, local model 29, internal_epoch   2,  Average loss: 0.0068, Accuracy: 761/848 (89.7406%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 8.2133, Accuracy: 2107/10000 (21.0700%)
___Train Local_ResNet_18,  epoch 247, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 570/620 (91.9355%)
___Train Local_ResNet_18,  epoch 247, local model 13, internal_epoch   2,  Average loss: 0.0036, Accuracy: 581/620 (93.7097%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 5.8651, Accuracy: 3192/10000 (31.9200%)
time spent on training: 68.68345856666565
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [363, 977, 625, 299, 386, 198, 214, 706, 848, 620]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [80, 12, 53, 55, 18, 42, 52, 31, 29, 13], weight: tensor([0.0693, 0.1866, 0.1194, 0.0571, 0.0737, 0.0378, 0.0409, 0.1348, 0.1620,
        0.1184])
[rfa agg] iter:  0, prev_obj_val: 37.579734802246094, obj_val: 39.51854705810547, abs dis: 1.938812255859375
[rfa agg] iter:  0, weight: tensor([0.0869, 0.0790, 0.2249, 0.0515, 0.0818, 0.0268, 0.0289, 0.1203, 0.0915,
        0.2084])
[rfa agg] iter:  1, prev_obj_val: 39.51854705810547, obj_val: 43.860321044921875, abs dis: 4.341773986816406
[rfa agg] iter:  1, weight: tensor([0.1150, 0.0788, 0.1931, 0.0639, 0.0956, 0.0321, 0.0346, 0.1131, 0.0894,
        0.1845])
[rfa agg] iter:  2, prev_obj_val: 43.860321044921875, obj_val: 46.190242767333984, abs dis: 2.3299217224121094
[rfa agg] iter:  2, weight: tensor([0.2115, 0.0703, 0.1328, 0.0936, 0.1052, 0.0426, 0.0458, 0.0913, 0.0774,
        0.1293])
[rfa agg] iter:  3, prev_obj_val: 46.190242767333984, obj_val: 51.65827178955078, abs dis: 5.468029022216797
[rfa agg] iter:  3, weight: tensor([0.3079, 0.0592, 0.1016, 0.1078, 0.0926, 0.0452, 0.0485, 0.0738, 0.0643,
        0.0992])
[rfa agg] iter:  4, prev_obj_val: 51.65827178955078, obj_val: 54.855064392089844, abs dis: 3.1967926025390625
[rfa agg] iter:  4, weight: tensor([0.2930, 0.0479, 0.0711, 0.2057, 0.0707, 0.0654, 0.0695, 0.0559, 0.0509,
        0.0698])
[rfa agg] iter:  5, prev_obj_val: 54.855064392089844, obj_val: 54.84291076660156, abs dis: 0.01215362548828125
[rfa agg] iter:  5, weight: tensor([0.1725, 0.0446, 0.0625, 0.3114, 0.0616, 0.0920, 0.0964, 0.0507, 0.0469,
        0.0614])
[rfa agg] iter:  6, prev_obj_val: 54.84291076660156, obj_val: 58.3712272644043, abs dis: 3.5283164978027344
[rfa agg] iter:  6, weight: tensor([0.1627, 0.0425, 0.0597, 0.3444, 0.0584, 0.0883, 0.0922, 0.0483, 0.0447,
        0.0586])
[rfa agg] iter:  7, prev_obj_val: 58.3712272644043, obj_val: 54.84889602661133, abs dis: 3.5223312377929688
[rfa agg] iter:  7, weight: tensor([0.1227, 0.0443, 0.0591, 0.2455, 0.0574, 0.1599, 0.1577, 0.0491, 0.0462,
        0.0582])
[rfa agg] iter:  8, prev_obj_val: 54.84889602661133, obj_val: 58.369972229003906, abs dis: 3.521076202392578
[rfa agg] iter:  8, weight: tensor([0.1659, 0.0433, 0.0608, 0.3299, 0.0594, 0.0909, 0.0953, 0.0492, 0.0456,
        0.0597])
[rfa agg] iter:  9, prev_obj_val: 58.369972229003906, obj_val: 54.84904479980469, abs dis: 3.5209274291992188
[rfa agg] iter:  9, weight: tensor([0.1229, 0.0443, 0.0592, 0.2438, 0.0575, 0.1603, 0.1583, 0.0492, 0.0462,
        0.0582])
___Test Target_ResNet_18 poisoned: False, epoch: 247: Average loss: 0.6275, Accuracy: 7946/10000 (79.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 247: Average loss: 5.7288, Accuracy: 465/9000 (5.1667%)
Done in 143.0502290725708 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:248 choose agents : [28, 59, 11, 20, 4, 19, 50, 93, 13, 55]. Adversary List: []
___Train Local_ResNet_18,  epoch 248, local model 28, internal_epoch   1,  Average loss: 0.0008, Accuracy: 422/423 (99.7636%)
___Train Local_ResNet_18,  epoch 248, local model 28, internal_epoch   2,  Average loss: 0.0005, Accuracy: 420/423 (99.2908%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.5254, Accuracy: 6299/10000 (62.9900%)
___Train Local_ResNet_18,  epoch 248, local model 59, internal_epoch   1,  Average loss: 0.0016, Accuracy: 621/642 (96.7290%)
___Train Local_ResNet_18,  epoch 248, local model 59, internal_epoch   2,  Average loss: 0.0014, Accuracy: 625/642 (97.3520%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 2.5547, Accuracy: 4729/10000 (47.2900%)
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 248, local model 11, internal_epoch   1,  Average loss: 0.0013, Accuracy: 537/546 (98.3516%)
___Train Local_ResNet_18,  epoch 248, local model 11, internal_epoch   2,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.7154, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 248, local model 20, internal_epoch   1,  Average loss: 0.0036, Accuracy: 342/362 (94.4751%)
___Train Local_ResNet_18,  epoch 248, local model 20, internal_epoch   2,  Average loss: 0.0023, Accuracy: 345/362 (95.3039%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 6.0527, Accuracy: 2778/10000 (27.7800%)
___Train Local_ResNet_18,  epoch 248, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 525/557 (94.2549%)
___Train Local_ResNet_18,  epoch 248, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 528/557 (94.7935%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 4.2596, Accuracy: 4178/10000 (41.7800%)
___Train Local_ResNet_18,  epoch 248, local model 19, internal_epoch   1,  Average loss: 0.0117, Accuracy: 135/173 (78.0347%)
___Train Local_ResNet_18,  epoch 248, local model 19, internal_epoch   2,  Average loss: 0.0024, Accuracy: 165/173 (95.3757%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 5.4387, Accuracy: 3402/10000 (34.0200%)
___Train Local_ResNet_18,  epoch 248, local model 50, internal_epoch   1,  Average loss: 0.0008, Accuracy: 401/401 (100.0000%)
___Train Local_ResNet_18,  epoch 248, local model 50, internal_epoch   2,  Average loss: 0.0002, Accuracy: 401/401 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.1517, Accuracy: 6830/10000 (68.3000%)
___Train Local_ResNet_18,  epoch 248, local model 93, internal_epoch   1,  Average loss: 0.0017, Accuracy: 569/584 (97.4315%)
___Train Local_ResNet_18,  epoch 248, local model 93, internal_epoch   2,  Average loss: 0.0062, Accuracy: 544/584 (93.1507%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 5.6214, Accuracy: 2590/10000 (25.9000%)
___Train Local_ResNet_18,  epoch 248, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 589/620 (95.0000%)
___Train Local_ResNet_18,  epoch 248, local model 13, internal_epoch   2,  Average loss: 0.0030, Accuracy: 583/620 (94.0323%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 2.4234, Accuracy: 4593/10000 (45.9300%)
___Train Local_ResNet_18,  epoch 248, local model 55, internal_epoch   1,  Average loss: 0.0023, Accuracy: 289/299 (96.6555%)
___Train Local_ResNet_18,  epoch 248, local model 55, internal_epoch   2,  Average loss: 0.0006, Accuracy: 296/299 (98.9967%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 7.0783, Accuracy: 2351/10000 (23.5100%)
time spent on training: 69.77008175849915
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.11851530280008682  data num: [423, 642, 546, 362, 557, 173, 401, 584, 620, 299]
[rfa agg] considering poison per batch poison_fraction: 0.009259008031256783
[rfa agg] init. name: [28, 59, 11, 20, 4, 19, 50, 93, 13, 55], weight: tensor([0.0918, 0.1394, 0.1185, 0.0786, 0.1209, 0.0376, 0.0870, 0.1268, 0.1346,
        0.0649])
[rfa agg] iter:  0, prev_obj_val: 23.261938095092773, obj_val: 26.1412296295166, abs dis: 2.879291534423828
[rfa agg] iter:  0, weight: tensor([0.2324, 0.0474, 0.0720, 0.1626, 0.0711, 0.0164, 0.2221, 0.0541, 0.0578,
        0.0641])
[rfa agg] iter:  1, prev_obj_val: 26.1412296295166, obj_val: 23.207569122314453, abs dis: 2.9336605072021484
[rfa agg] iter:  1, weight: tensor([0.1538, 0.0478, 0.0675, 0.2824, 0.0671, 0.0214, 0.1460, 0.0532, 0.0568,
        0.1040])
[rfa agg] iter:  2, prev_obj_val: 23.207569122314453, obj_val: 26.138322830200195, abs dis: 2.930753707885742
[rfa agg] iter:  2, weight: tensor([0.2331, 0.0454, 0.0689, 0.1792, 0.0677, 0.0157, 0.2217, 0.0515, 0.0551,
        0.0618])
[rfa agg] iter:  3, prev_obj_val: 26.138322830200195, obj_val: 23.208419799804688, abs dis: 2.929903030395508
[rfa agg] iter:  3, weight: tensor([0.1529, 0.0475, 0.0671, 0.2867, 0.0667, 0.0213, 0.1451, 0.0529, 0.0564,
        0.1034])
[rfa agg] iter:  4, prev_obj_val: 23.208419799804688, obj_val: 26.13823890686035, abs dis: 2.929819107055664
[rfa agg] iter:  4, weight: tensor([0.2329, 0.0454, 0.0689, 0.1796, 0.0677, 0.0157, 0.2214, 0.0515, 0.0551,
        0.0618])
[rfa agg] iter:  5, prev_obj_val: 26.13823890686035, obj_val: 23.20844268798828, abs dis: 2.9297962188720703
[rfa agg] iter:  5, weight: tensor([0.1529, 0.0475, 0.0671, 0.2868, 0.0667, 0.0213, 0.1450, 0.0529, 0.0564,
        0.1033])
[rfa agg] iter:  6, prev_obj_val: 23.20844268798828, obj_val: 26.13823890686035, abs dis: 2.9297962188720703
[rfa agg] iter:  6, weight: tensor([0.2329, 0.0454, 0.0689, 0.1796, 0.0677, 0.0157, 0.2214, 0.0515, 0.0551,
        0.0618])
[rfa agg] iter:  7, prev_obj_val: 26.13823890686035, obj_val: 23.20844268798828, abs dis: 2.9297962188720703
[rfa agg] iter:  7, weight: tensor([0.1529, 0.0475, 0.0671, 0.2868, 0.0667, 0.0213, 0.1450, 0.0529, 0.0564,
        0.1033])
[rfa agg] iter:  8, prev_obj_val: 23.20844268798828, obj_val: 26.13823890686035, abs dis: 2.9297962188720703
[rfa agg] iter:  8, weight: tensor([0.2329, 0.0454, 0.0689, 0.1796, 0.0677, 0.0157, 0.2214, 0.0515, 0.0551,
        0.0618])
[rfa agg] iter:  9, prev_obj_val: 26.13823890686035, obj_val: 23.20844268798828, abs dis: 2.9297962188720703
[rfa agg] iter:  9, weight: tensor([0.1529, 0.0475, 0.0671, 0.2868, 0.0667, 0.0213, 0.1450, 0.0529, 0.0564,
        0.1033])
___Test Target_ResNet_18 poisoned: False, epoch: 248: Average loss: 0.6265, Accuracy: 7964/10000 (79.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 248: Average loss: 5.8012, Accuracy: 417/9000 (4.6333%)
Done in 145.61375832557678 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:249 choose agents : [13, 33, 16, 5, 8, 3, 39, 27, 19, 93]. Adversary List: []
___Train Local_ResNet_18,  epoch 249, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 596/620 (96.1290%)
___Train Local_ResNet_18,  epoch 249, local model 13, internal_epoch   2,  Average loss: 0.0022, Accuracy: 593/620 (95.6452%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 2.4380, Accuracy: 4552/10000 (45.5200%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 249, local model 33, internal_epoch   1,  Average loss: 0.0024, Accuracy: 509/527 (96.5844%)
___Train Local_ResNet_18,  epoch 249, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 503/527 (95.4459%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 2.6567, Accuracy: 4627/10000 (46.2700%)
___Train Local_ResNet_18,  epoch 249, local model 16, internal_epoch   1,  Average loss: 0.0028, Accuracy: 755/773 (97.6714%)
___Train Local_ResNet_18,  epoch 249, local model 16, internal_epoch   2,  Average loss: 0.0185, Accuracy: 526/773 (68.0466%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 105.5829, Accuracy: 933/10000 (9.3300%)
___Train Local_ResNet_18,  epoch 249, local model 5, internal_epoch   1,  Average loss: 0.0011, Accuracy: 361/365 (98.9041%)
___Train Local_ResNet_18,  epoch 249, local model 5, internal_epoch   2,  Average loss: 0.0003, Accuracy: 364/365 (99.7260%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 0.9487, Accuracy: 7138/10000 (71.3800%)
___Train Local_ResNet_18,  epoch 249, local model 8, internal_epoch   1,  Average loss: 0.0016, Accuracy: 524/534 (98.1273%)
___Train Local_ResNet_18,  epoch 249, local model 8, internal_epoch   2,  Average loss: 0.0011, Accuracy: 523/534 (97.9401%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 2.3495, Accuracy: 4621/10000 (46.2100%)
___Train Local_ResNet_18,  epoch 249, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 718/780 (92.0513%)
___Train Local_ResNet_18,  epoch 249, local model 3, internal_epoch   2,  Average loss: 0.0085, Accuracy: 670/780 (85.8974%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 15.6556, Accuracy: 2219/10000 (22.1900%)
___Train Local_ResNet_18,  epoch 249, local model 39, internal_epoch   1,  Average loss: 0.0021, Accuracy: 210/217 (96.7742%)
___Train Local_ResNet_18,  epoch 249, local model 39, internal_epoch   2,  Average loss: 0.0004, Accuracy: 216/217 (99.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.2461, Accuracy: 6482/10000 (64.8200%)
___Train Local_ResNet_18,  epoch 249, local model 27, internal_epoch   1,  Average loss: 0.0016, Accuracy: 391/397 (98.4887%)
___Train Local_ResNet_18,  epoch 249, local model 27, internal_epoch   2,  Average loss: 0.0027, Accuracy: 383/397 (96.4736%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.6344, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 249, local model 19, internal_epoch   1,  Average loss: 0.0102, Accuracy: 139/173 (80.3468%)
___Train Local_ResNet_18,  epoch 249, local model 19, internal_epoch   2,  Average loss: 0.0022, Accuracy: 167/173 (96.5318%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 5.4171, Accuracy: 3271/10000 (32.7100%)
___Train Local_ResNet_18,  epoch 249, local model 93, internal_epoch   1,  Average loss: 0.0013, Accuracy: 572/584 (97.9452%)
___Train Local_ResNet_18,  epoch 249, local model 93, internal_epoch   2,  Average loss: 0.0012, Accuracy: 576/584 (98.6301%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.6229, Accuracy: 5888/10000 (58.8800%)
time spent on training: 75.00861310958862
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10603621730382294  data num: [620, 527, 773, 365, 534, 780, 217, 397, 173, 584]
[rfa agg] considering poison per batch poison_fraction: 0.008284079476861167
[rfa agg] init. name: [13, 33, 16, 5, 8, 3, 39, 27, 19, 93], weight: tensor([0.1247, 0.1060, 0.1555, 0.0734, 0.1074, 0.1569, 0.0437, 0.0799, 0.0348,
        0.1175])
[rfa agg] iter:  0, prev_obj_val: 29.65753173828125, obj_val: 34.744171142578125, abs dis: 5.086639404296875
[rfa agg] iter:  0, weight: tensor([0.1103, 0.1445, 0.0619, 0.1077, 0.1522, 0.0653, 0.0290, 0.2048, 0.0180,
        0.1062])
[rfa agg] iter:  1, prev_obj_val: 34.744171142578125, obj_val: 37.82107925415039, abs dis: 3.0769081115722656
[rfa agg] iter:  1, weight: tensor([0.0780, 0.0918, 0.0505, 0.2600, 0.0944, 0.0531, 0.0389, 0.2368, 0.0221,
        0.0745])
[rfa agg] iter:  2, prev_obj_val: 37.82107925415039, obj_val: 37.79566955566406, abs dis: 0.025409698486328125
[rfa agg] iter:  2, weight: tensor([0.0612, 0.0689, 0.0421, 0.4472, 0.0706, 0.0440, 0.0431, 0.1417, 0.0230,
        0.0583])
[rfa agg] iter:  3, prev_obj_val: 37.79566955566406, obj_val: 41.33122634887695, abs dis: 3.5355567932128906
[rfa agg] iter:  3, weight: tensor([0.0531, 0.0598, 0.0365, 0.5225, 0.0613, 0.0383, 0.0376, 0.1203, 0.0200,
        0.0506])
[rfa agg] iter:  4, prev_obj_val: 41.33122634887695, obj_val: 41.32124328613281, abs dis: 0.009983062744140625
[rfa agg] iter:  4, weight: tensor([0.0716, 0.0780, 0.0518, 0.3560, 0.0797, 0.0540, 0.0748, 0.1302, 0.0360,
        0.0681])
[rfa agg] iter:  5, prev_obj_val: 41.32124328613281, obj_val: 41.32118225097656, abs dis: 6.103515625e-05
[rfa agg] iter:  5, weight: tensor([0.0731, 0.0795, 0.0529, 0.3430, 0.0813, 0.0551, 0.0762, 0.1328, 0.0367,
        0.0694])
___Test Target_ResNet_18 poisoned: False, epoch: 249: Average loss: 0.6238, Accuracy: 7964/10000 (79.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 249: Average loss: 5.8023, Accuracy: 425/9000 (4.7222%)
Done in 140.92625451087952 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:250 choose agents : [92, 14, 74, 41, 87, 44, 60, 80, 2, 45]. Adversary List: []
___Train Local_ResNet_18,  epoch 250, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 744/796 (93.4673%)
___Train Local_ResNet_18,  epoch 250, local model 92, internal_epoch   2,  Average loss: 0.0092, Accuracy: 652/796 (81.9095%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 9.9948, Accuracy: 2207/10000 (22.0700%)
___Train Local_ResNet_18,  epoch 250, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 301/318 (94.6541%)
___Train Local_ResNet_18,  epoch 250, local model 14, internal_epoch   2,  Average loss: 0.0006, Accuracy: 315/318 (99.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 3.3820, Accuracy: 4086/10000 (40.8600%)
___Train Local_ResNet_18,  epoch 250, local model 74, internal_epoch   1,  Average loss: 0.0017, Accuracy: 460/469 (98.0810%)
___Train Local_ResNet_18,  epoch 250, local model 74, internal_epoch   2,  Average loss: 0.0008, Accuracy: 463/469 (98.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 1.4752, Accuracy: 5900/10000 (59.0000%)
___Train Local_ResNet_18,  epoch 250, local model 41, internal_epoch   1,  Average loss: 0.0208, Accuracy: 460/513 (89.6686%)
___Train Local_ResNet_18,  epoch 250, local model 41, internal_epoch   2,  Average loss: 0.0141, Accuracy: 414/513 (80.7018%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 34.8874, Accuracy: 1835/10000 (18.3500%)
___Train Local_ResNet_18,  epoch 250, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 361/397 (90.9320%)
___Train Local_ResNet_18,  epoch 250, local model 87, internal_epoch   2,  Average loss: 0.0068, Accuracy: 354/397 (89.1688%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 3.0302, Accuracy: 3813/10000 (38.1300%)
___Train Local_ResNet_18,  epoch 250, local model 44, internal_epoch   1,  Average loss: 0.0020, Accuracy: 420/436 (96.3303%)
___Train Local_ResNet_18,  epoch 250, local model 44, internal_epoch   2,  Average loss: 0.0010, Accuracy: 427/436 (97.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.2118, Accuracy: 4967/10000 (49.6700%)
___Train Local_ResNet_18,  epoch 250, local model 60, internal_epoch   1,  Average loss: 0.0016, Accuracy: 279/284 (98.2394%)
___Train Local_ResNet_18,  epoch 250, local model 60, internal_epoch   2,  Average loss: 0.0002, Accuracy: 284/284 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 1.2386, Accuracy: 6437/10000 (64.3700%)
___Train Local_ResNet_18,  epoch 250, local model 80, internal_epoch   1,  Average loss: 0.0014, Accuracy: 358/363 (98.6226%)
___Train Local_ResNet_18,  epoch 250, local model 80, internal_epoch   2,  Average loss: 0.0005, Accuracy: 362/363 (99.7245%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.6737, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 250, local model 2, internal_epoch   1,  Average loss: 0.0035, Accuracy: 439/461 (95.2278%)
___Train Local_ResNet_18,  epoch 250, local model 2, internal_epoch   2,  Average loss: 0.0026, Accuracy: 437/461 (94.7939%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.8564, Accuracy: 4549/10000 (45.4900%)
___Train Local_ResNet_18,  epoch 250, local model 45, internal_epoch   1,  Average loss: 0.0037, Accuracy: 490/529 (92.6276%)
___Train Local_ResNet_18,  epoch 250, local model 45, internal_epoch   2,  Average loss: 0.0071, Accuracy: 457/529 (86.3894%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 5.8363, Accuracy: 2887/10000 (28.8700%)
time spent on training: 66.79205751419067
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [796, 318, 469, 513, 397, 436, 284, 363, 461, 529]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [92, 14, 74, 41, 87, 44, 60, 80, 2, 45], weight: tensor([0.1743, 0.0696, 0.1027, 0.1124, 0.0869, 0.0955, 0.0622, 0.0795, 0.1010,
        0.1159])
[rfa agg] iter:  0, prev_obj_val: 25.30301284790039, obj_val: 28.08346176147461, abs dis: 2.7804489135742188
[rfa agg] iter:  0, weight: tensor([0.0402, 0.1008, 0.0808, 0.0568, 0.1010, 0.1348, 0.0935, 0.2554, 0.0770,
        0.0596])
[rfa agg] iter:  1, prev_obj_val: 28.08346176147461, obj_val: 39.84916687011719, abs dis: 11.765705108642578
[rfa agg] iter:  1, weight: tensor([0.0371, 0.1717, 0.0654, 0.0490, 0.0799, 0.0984, 0.1714, 0.2129, 0.0629,
        0.0513])
[rfa agg] iter:  2, prev_obj_val: 39.84916687011719, obj_val: 31.459579467773438, abs dis: 8.38958740234375
[rfa agg] iter:  2, weight: tensor([0.0567, 0.1928, 0.0756, 0.0646, 0.0820, 0.0933, 0.1778, 0.1163, 0.0737,
        0.0671])
[rfa agg] iter:  3, prev_obj_val: 31.459579467773438, obj_val: 48.63864517211914, abs dis: 17.179065704345703
[rfa agg] iter:  3, weight: tensor([0.0311, 0.2588, 0.0489, 0.0388, 0.0569, 0.0671, 0.3033, 0.1072, 0.0474,
        0.0405])
[rfa agg] iter:  4, prev_obj_val: 48.63864517211914, obj_val: 31.48792839050293, abs dis: 17.15071678161621
[rfa agg] iter:  4, weight: tensor([0.0746, 0.1485, 0.0884, 0.0792, 0.0914, 0.1024, 0.1335, 0.1137, 0.0863,
        0.0821])
[rfa agg] iter:  5, prev_obj_val: 31.48792839050293, obj_val: 53.053741455078125, abs dis: 21.565813064575195
[rfa agg] iter:  5, weight: tensor([0.0327, 0.2502, 0.0514, 0.0409, 0.0599, 0.0705, 0.2899, 0.1120, 0.0498,
        0.0426])
[rfa agg] iter:  6, prev_obj_val: 53.053741455078125, obj_val: 28.106151580810547, abs dis: 24.947589874267578
[rfa agg] iter:  6, weight: tensor([0.0811, 0.1362, 0.0918, 0.0837, 0.0932, 0.1041, 0.1222, 0.1114, 0.0897,
        0.0866])
[rfa agg] iter:  7, prev_obj_val: 28.106151580810547, obj_val: 39.84835433959961, abs dis: 11.742202758789062
[rfa agg] iter:  7, weight: tensor([0.0379, 0.1745, 0.0667, 0.0502, 0.0813, 0.0998, 0.1713, 0.2017, 0.0642,
        0.0525])
[rfa agg] iter:  8, prev_obj_val: 39.84835433959961, obj_val: 31.459585189819336, abs dis: 8.388769149780273
[rfa agg] iter:  8, weight: tensor([0.0568, 0.1928, 0.0756, 0.0646, 0.0820, 0.0933, 0.1778, 0.1163, 0.0737,
        0.0671])
[rfa agg] iter:  9, prev_obj_val: 31.459585189819336, obj_val: 48.638648986816406, abs dis: 17.17906379699707
[rfa agg] iter:  9, weight: tensor([0.0311, 0.2589, 0.0489, 0.0388, 0.0569, 0.0671, 0.3032, 0.1072, 0.0474,
        0.0405])
___Test Target_ResNet_18 poisoned: False, epoch: 250: Average loss: 0.6177, Accuracy: 7971/10000 (79.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 250: Average loss: 5.6935, Accuracy: 534/9000 (5.9333%)
Done in 142.1197280883789 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:251 choose agents : [67, 9, 92, 47, 24, 79, 63, 14, 87, 2]. Adversary List: []
___Train Local_ResNet_18,  epoch 251, local model 67, internal_epoch   1,  Average loss: 0.0022, Accuracy: 810/842 (96.1995%)
___Train Local_ResNet_18,  epoch 251, local model 67, internal_epoch   2,  Average loss: 0.0156, Accuracy: 611/842 (72.5653%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 22.7657, Accuracy: 1661/10000 (16.6100%)
___Train Local_ResNet_18,  epoch 251, local model 9, internal_epoch   1,  Average loss: 0.0025, Accuracy: 350/368 (95.1087%)
___Train Local_ResNet_18,  epoch 251, local model 9, internal_epoch   2,  Average loss: 0.0009, Accuracy: 361/368 (98.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 4.7733, Accuracy: 3337/10000 (33.3700%)
___Train Local_ResNet_18,  epoch 251, local model 92, internal_epoch   1,  Average loss: 0.0041, Accuracy: 738/796 (92.7136%)
___Train Local_ResNet_18,  epoch 251, local model 92, internal_epoch   2,  Average loss: 0.0068, Accuracy: 705/796 (88.5678%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 4.7842, Accuracy: 3155/10000 (31.5500%)
___Train Local_ResNet_18,  epoch 251, local model 47, internal_epoch   1,  Average loss: 0.0021, Accuracy: 626/654 (95.7187%)
___Train Local_ResNet_18,  epoch 251, local model 47, internal_epoch   2,  Average loss: 0.0028, Accuracy: 612/654 (93.5780%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 2.4173, Accuracy: 4852/10000 (48.5200%)
___Train Local_ResNet_18,  epoch 251, local model 24, internal_epoch   1,  Average loss: 0.0018, Accuracy: 311/320 (97.1875%)
___Train Local_ResNet_18,  epoch 251, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 318/320 (99.3750%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 1.5139, Accuracy: 6082/10000 (60.8200%)
___Train Local_ResNet_18,  epoch 251, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 136/154 (88.3117%)
___Train Local_ResNet_18,  epoch 251, local model 79, internal_epoch   2,  Average loss: 0.0009, Accuracy: 153/154 (99.3506%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 1.1478, Accuracy: 6839/10000 (68.3900%)
___Train Local_ResNet_18,  epoch 251, local model 63, internal_epoch   1,  Average loss: 0.0009, Accuracy: 745/752 (99.0691%)
___Train Local_ResNet_18,  epoch 251, local model 63, internal_epoch   2,  Average loss: 0.0004, Accuracy: 751/752 (99.8670%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 0.9625, Accuracy: 7168/10000 (71.6800%)
___Train Local_ResNet_18,  epoch 251, local model 14, internal_epoch   1,  Average loss: 0.0020, Accuracy: 312/318 (98.1132%)
___Train Local_ResNet_18,  epoch 251, local model 14, internal_epoch   2,  Average loss: 0.0002, Accuracy: 318/318 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 3.1889, Accuracy: 4529/10000 (45.2900%)
___Train Local_ResNet_18,  epoch 251, local model 87, internal_epoch   1,  Average loss: 0.0048, Accuracy: 371/397 (93.4509%)
___Train Local_ResNet_18,  epoch 251, local model 87, internal_epoch   2,  Average loss: 0.0069, Accuracy: 351/397 (88.4131%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 5.9873, Accuracy: 2596/10000 (25.9600%)
___Train Local_ResNet_18,  epoch 251, local model 2, internal_epoch   1,  Average loss: 0.0049, Accuracy: 437/461 (94.7939%)
___Train Local_ResNet_18,  epoch 251, local model 2, internal_epoch   2,  Average loss: 0.0140, Accuracy: 390/461 (84.5987%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 43.9988, Accuracy: 1000/10000 (10.0000%)
time spent on training: 65.72349429130554
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [842, 368, 796, 654, 320, 154, 752, 318, 397, 461]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [67, 9, 92, 47, 24, 79, 63, 14, 87, 2], weight: tensor([0.1663, 0.0727, 0.1573, 0.1292, 0.0632, 0.0304, 0.1486, 0.0628, 0.0784,
        0.0911])
[rfa agg] iter:  0, prev_obj_val: 35.381858825683594, obj_val: 41.502891540527344, abs dis: 6.12103271484375
[rfa agg] iter:  0, weight: tensor([0.0698, 0.1250, 0.0791, 0.1012, 0.0701, 0.0190, 0.0928, 0.0695, 0.1922,
        0.1813])
[rfa agg] iter:  1, prev_obj_val: 41.502891540527344, obj_val: 44.21818923950195, abs dis: 2.7152976989746094
[rfa agg] iter:  1, weight: tensor([0.0465, 0.2748, 0.0509, 0.0587, 0.1317, 0.0231, 0.0569, 0.1305, 0.1361,
        0.0909])
[rfa agg] iter:  2, prev_obj_val: 44.21818923950195, obj_val: 41.436553955078125, abs dis: 2.781635284423828
[rfa agg] iter:  2, weight: tensor([0.0394, 0.2221, 0.0428, 0.0481, 0.2101, 0.0249, 0.0473, 0.2050, 0.0930,
        0.0674])
[rfa agg] iter:  3, prev_obj_val: 41.436553955078125, obj_val: 44.21897506713867, abs dis: 2.782421112060547
[rfa agg] iter:  3, weight: tensor([0.0424, 0.3301, 0.0465, 0.0536, 0.1271, 0.0212, 0.0521, 0.1255, 0.1208,
        0.0806])
[rfa agg] iter:  4, prev_obj_val: 44.21897506713867, obj_val: 41.43584060668945, abs dis: 2.7831344604492188
[rfa agg] iter:  4, weight: tensor([0.0391, 0.2288, 0.0425, 0.0477, 0.2088, 0.0247, 0.0469, 0.2031, 0.0918,
        0.0667])
[rfa agg] iter:  5, prev_obj_val: 41.43584060668945, obj_val: 44.21916961669922, abs dis: 2.7833290100097656
[rfa agg] iter:  5, weight: tensor([0.0423, 0.3321, 0.0464, 0.0535, 0.1267, 0.0212, 0.0519, 0.1251, 0.1204,
        0.0803])
[rfa agg] iter:  6, prev_obj_val: 44.21916961669922, obj_val: 41.43581008911133, abs dis: 2.7833595275878906
[rfa agg] iter:  6, weight: tensor([0.0391, 0.2290, 0.0425, 0.0477, 0.2087, 0.0247, 0.0469, 0.2030, 0.0917,
        0.0666])
[rfa agg] iter:  7, prev_obj_val: 41.43581008911133, obj_val: 44.21917724609375, abs dis: 2.783367156982422
[rfa agg] iter:  7, weight: tensor([0.0423, 0.3322, 0.0464, 0.0535, 0.1267, 0.0212, 0.0519, 0.1251, 0.1204,
        0.0803])
[rfa agg] iter:  8, prev_obj_val: 44.21917724609375, obj_val: 41.43581008911133, abs dis: 2.783367156982422
[rfa agg] iter:  8, weight: tensor([0.0391, 0.2291, 0.0425, 0.0477, 0.2087, 0.0247, 0.0469, 0.2030, 0.0917,
        0.0666])
[rfa agg] iter:  9, prev_obj_val: 41.43581008911133, obj_val: 44.21917724609375, abs dis: 2.783367156982422
[rfa agg] iter:  9, weight: tensor([0.0423, 0.3322, 0.0464, 0.0535, 0.1267, 0.0212, 0.0519, 0.1251, 0.1204,
        0.0803])
___Test Target_ResNet_18 poisoned: False, epoch: 251: Average loss: 0.6201, Accuracy: 7956/10000 (79.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 251: Average loss: 5.6928, Accuracy: 593/9000 (6.5889%)
Done in 138.4299032688141 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:252 choose agents : [64, 12, 61, 1, 84, 9, 0, 14, 88, 16]. Adversary List: []
___Train Local_ResNet_18,  epoch 252, local model 64, internal_epoch   1,  Average loss: 0.0020, Accuracy: 652/686 (95.0437%)
___Train Local_ResNet_18,  epoch 252, local model 64, internal_epoch   2,  Average loss: 0.0028, Accuracy: 653/686 (95.1895%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 1.8218, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 252, local model 12, internal_epoch   1,  Average loss: 0.0032, Accuracy: 913/977 (93.4493%)
___Train Local_ResNet_18,  epoch 252, local model 12, internal_epoch   2,  Average loss: 0.0069, Accuracy: 853/977 (87.3081%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 9.2354, Accuracy: 1997/10000 (19.9700%)
___Train Local_ResNet_18,  epoch 252, local model 61, internal_epoch   1,  Average loss: 0.0034, Accuracy: 549/590 (93.0508%)
___Train Local_ResNet_18,  epoch 252, local model 61, internal_epoch   2,  Average loss: 0.0050, Accuracy: 544/590 (92.2034%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 3.3625, Accuracy: 3359/10000 (33.5900%)
___Train Local_ResNet_18,  epoch 252, local model 1, internal_epoch   1,  Average loss: 0.0048, Accuracy: 607/641 (94.6958%)
___Train Local_ResNet_18,  epoch 252, local model 1, internal_epoch   2,  Average loss: 0.0117, Accuracy: 579/641 (90.3276%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 3.4986, Accuracy: 3919/10000 (39.1900%)
___Train Local_ResNet_18,  epoch 252, local model 84, internal_epoch   1,  Average loss: 0.0027, Accuracy: 1003/1053 (95.2517%)
___Train Local_ResNet_18,  epoch 252, local model 84, internal_epoch   2,  Average loss: 0.0069, Accuracy: 912/1053 (86.6097%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 4.8766, Accuracy: 3917/10000 (39.1700%)
___Train Local_ResNet_18,  epoch 252, local model 9, internal_epoch   1,  Average loss: 0.0014, Accuracy: 363/368 (98.6413%)
___Train Local_ResNet_18,  epoch 252, local model 9, internal_epoch   2,  Average loss: 0.0006, Accuracy: 364/368 (98.9130%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 2.5379, Accuracy: 5020/10000 (50.2000%)
___Train Local_ResNet_18,  epoch 252, local model 0, internal_epoch   1,  Average loss: 0.0013, Accuracy: 365/367 (99.4550%)
___Train Local_ResNet_18,  epoch 252, local model 0, internal_epoch   2,  Average loss: 0.0006, Accuracy: 364/367 (99.1826%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 1.6990, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 252, local model 14, internal_epoch   1,  Average loss: 0.0015, Accuracy: 316/318 (99.3711%)
___Train Local_ResNet_18,  epoch 252, local model 14, internal_epoch   2,  Average loss: 0.0002, Accuracy: 318/318 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 1.7321, Accuracy: 6022/10000 (60.2200%)
___Train Local_ResNet_18,  epoch 252, local model 88, internal_epoch   1,  Average loss: 0.0037, Accuracy: 416/447 (93.0649%)
___Train Local_ResNet_18,  epoch 252, local model 88, internal_epoch   2,  Average loss: 0.0030, Accuracy: 422/447 (94.4072%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 4.0329, Accuracy: 3355/10000 (33.5500%)
___Train Local_ResNet_18,  epoch 252, local model 16, internal_epoch   1,  Average loss: 0.0020, Accuracy: 757/773 (97.9301%)
___Train Local_ResNet_18,  epoch 252, local model 16, internal_epoch   2,  Average loss: 0.0139, Accuracy: 590/773 (76.3260%)
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 28.4483, Accuracy: 1144/10000 (11.4400%)
time spent on training: 72.4325053691864
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [686, 977, 590, 641, 1053, 368, 367, 318, 447, 773]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [64, 12, 61, 1, 84, 9, 0, 14, 88, 16], weight: tensor([0.1103, 0.1571, 0.0949, 0.1031, 0.1693, 0.0592, 0.0590, 0.0511, 0.0719,
        0.1243])
[rfa agg] iter:  0, prev_obj_val: 37.260498046875, obj_val: 39.10609436035156, abs dis: 1.8455963134765625
[rfa agg] iter:  0, weight: tensor([0.1824, 0.0681, 0.2305, 0.1569, 0.0640, 0.0481, 0.0480, 0.0325, 0.0783,
        0.0913])
[rfa agg] iter:  1, prev_obj_val: 39.10609436035156, obj_val: 41.2294921875, abs dis: 2.1233978271484375
[rfa agg] iter:  1, weight: tensor([0.1584, 0.0678, 0.2193, 0.1408, 0.0642, 0.0600, 0.0599, 0.0392, 0.1029,
        0.0873])
[rfa agg] iter:  2, prev_obj_val: 41.2294921875, obj_val: 45.74592208862305, abs dis: 4.516429901123047
[rfa agg] iter:  2, weight: tensor([0.1385, 0.0677, 0.1794, 0.1250, 0.0646, 0.0764, 0.0763, 0.0478, 0.1400,
        0.0843])
[rfa agg] iter:  3, prev_obj_val: 45.74592208862305, obj_val: 50.920921325683594, abs dis: 5.174999237060547
[rfa agg] iter:  3, weight: tensor([0.0939, 0.0557, 0.1089, 0.0861, 0.0538, 0.1146, 0.1146, 0.0616, 0.2452,
        0.0656])
[rfa agg] iter:  4, prev_obj_val: 50.920921325683594, obj_val: 53.97361755371094, abs dis: 3.0526962280273438
[rfa agg] iter:  4, weight: tensor([0.0571, 0.0387, 0.0618, 0.0526, 0.0378, 0.2072, 0.2118, 0.0781, 0.2114,
        0.0435])
[rfa agg] iter:  5, prev_obj_val: 53.97361755371094, obj_val: 74.73639678955078, abs dis: 20.762779235839844
[rfa agg] iter:  5, weight: tensor([0.0400, 0.0286, 0.0423, 0.0370, 0.0280, 0.2848, 0.3068, 0.0891, 0.1119,
        0.0315])
[rfa agg] iter:  6, prev_obj_val: 74.73639678955078, obj_val: 54.01226043701172, abs dis: 20.724136352539062
[rfa agg] iter:  6, weight: tensor([0.0808, 0.0690, 0.0797, 0.0751, 0.0689, 0.1298, 0.1297, 0.1847, 0.1114,
        0.0709])
[rfa agg] iter:  7, prev_obj_val: 54.01226043701172, obj_val: 70.31798553466797, abs dis: 16.30572509765625
[rfa agg] iter:  7, weight: tensor([0.0430, 0.0307, 0.0455, 0.0398, 0.0301, 0.2758, 0.2907, 0.0956, 0.1148,
        0.0339])
[rfa agg] iter:  8, prev_obj_val: 70.31798553466797, obj_val: 53.99635314941406, abs dis: 16.321632385253906
[rfa agg] iter:  8, weight: tensor([0.0725, 0.0602, 0.0722, 0.0673, 0.0599, 0.1353, 0.1352, 0.2266, 0.1081,
        0.0626])
[rfa agg] iter:  9, prev_obj_val: 53.99635314941406, obj_val: 74.73471069335938, abs dis: 20.738357543945312
[rfa agg] iter:  9, weight: tensor([0.0419, 0.0299, 0.0443, 0.0387, 0.0293, 0.2799, 0.2969, 0.0939, 0.1122,
        0.0330])
___Test Target_ResNet_18 poisoned: False, epoch: 252: Average loss: 0.6227, Accuracy: 7937/10000 (79.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 252: Average loss: 5.6639, Accuracy: 618/9000 (6.8667%)
Done in 141.9146134853363 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:253 choose agents : [48, 44, 4, 45, 1, 58, 22, 13, 52, 20]. Adversary List: []
___Train Local_ResNet_18,  epoch 253, local model 48, internal_epoch   1,  Average loss: 0.0016, Accuracy: 371/378 (98.1481%)
___Train Local_ResNet_18,  epoch 253, local model 48, internal_epoch   2,  Average loss: 0.0003, Accuracy: 378/378 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 1.6976, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 253, local model 44, internal_epoch   1,  Average loss: 0.0014, Accuracy: 425/436 (97.4771%)
___Train Local_ResNet_18,  epoch 253, local model 44, internal_epoch   2,  Average loss: 0.0006, Accuracy: 430/436 (98.6239%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 1.7272, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 253, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 518/557 (92.9982%)
___Train Local_ResNet_18,  epoch 253, local model 4, internal_epoch   2,  Average loss: 0.0023, Accuracy: 535/557 (96.0503%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 3.0837, Accuracy: 4721/10000 (47.2100%)
___Train Local_ResNet_18,  epoch 253, local model 45, internal_epoch   1,  Average loss: 0.0037, Accuracy: 499/529 (94.3289%)
___Train Local_ResNet_18,  epoch 253, local model 45, internal_epoch   2,  Average loss: 0.0125, Accuracy: 438/529 (82.7977%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 5.0500, Accuracy: 3207/10000 (32.0700%)
___Train Local_ResNet_18,  epoch 253, local model 1, internal_epoch   1,  Average loss: 0.0051, Accuracy: 626/641 (97.6599%)
___Train Local_ResNet_18,  epoch 253, local model 1, internal_epoch   2,  Average loss: 0.0107, Accuracy: 571/641 (89.0796%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 5.3415, Accuracy: 3384/10000 (33.8400%)
___Train Local_ResNet_18,  epoch 253, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 216/234 (92.3077%)
___Train Local_ResNet_18,  epoch 253, local model 58, internal_epoch   2,  Average loss: 0.0008, Accuracy: 232/234 (99.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 4.1045, Accuracy: 3124/10000 (31.2400%)
___Train Local_ResNet_18,  epoch 253, local model 22, internal_epoch   1,  Average loss: 0.0029, Accuracy: 465/494 (94.1296%)
___Train Local_ResNet_18,  epoch 253, local model 22, internal_epoch   2,  Average loss: 0.0017, Accuracy: 480/494 (97.1660%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 2.7669, Accuracy: 4165/10000 (41.6500%)
___Train Local_ResNet_18,  epoch 253, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 594/620 (95.8065%)
___Train Local_ResNet_18,  epoch 253, local model 13, internal_epoch   2,  Average loss: 0.0023, Accuracy: 594/620 (95.8065%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 2.6437, Accuracy: 4635/10000 (46.3500%)
___Train Local_ResNet_18,  epoch 253, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 206/214 (96.2617%)
___Train Local_ResNet_18,  epoch 253, local model 52, internal_epoch   2,  Average loss: 0.0009, Accuracy: 212/214 (99.0654%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 1.9685, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 253, local model 20, internal_epoch   1,  Average loss: 0.0022, Accuracy: 351/362 (96.9613%)
___Train Local_ResNet_18,  epoch 253, local model 20, internal_epoch   2,  Average loss: 0.0006, Accuracy: 357/362 (98.6188%)
___Test Local_ResNet_18 poisoned: False, epoch: 253: Average loss: 3.7881, Accuracy: 4671/10000 (46.7100%)
time spent on training: 65.18491959571838
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [378, 436, 557, 529, 641, 234, 494, 620, 214, 362]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [48, 44, 4, 45, 1, 58, 22, 13, 52, 20], weight: tensor([0.0847, 0.0976, 0.1247, 0.1185, 0.1436, 0.0524, 0.1106, 0.1389, 0.0479,
        0.0811])
[rfa agg] iter:  0, prev_obj_val: 24.102108001708984, obj_val: 37.79316711425781, abs dis: 13.691059112548828
[rfa agg] iter:  0, weight: tensor([0.2900, 0.1287, 0.0583, 0.0535, 0.0412, 0.0371, 0.0759, 0.0497, 0.0341,
        0.2315])
[rfa agg] iter:  1, prev_obj_val: 37.79316711425781, obj_val: 46.32600402832031, abs dis: 8.5328369140625
[rfa agg] iter:  1, weight: tensor([0.0891, 0.0686, 0.0523, 0.0489, 0.0432, 0.2545, 0.0580, 0.0488, 0.2520,
        0.0847])
[rfa agg] iter:  2, prev_obj_val: 46.32600402832031, obj_val: 30.506023406982422, abs dis: 15.81998062133789
[rfa agg] iter:  2, weight: tensor([0.1024, 0.0888, 0.0752, 0.0706, 0.0651, 0.1811, 0.0801, 0.0720, 0.1669,
        0.0977])
[rfa agg] iter:  3, prev_obj_val: 30.506023406982422, obj_val: 30.499319076538086, abs dis: 0.0067043304443359375
[rfa agg] iter:  3, weight: tensor([0.1804, 0.1084, 0.0691, 0.0642, 0.0536, 0.1109, 0.0814, 0.0622, 0.1023,
        0.1676])
___Test Target_ResNet_18 poisoned: False, epoch: 253: Average loss: 0.6225, Accuracy: 7932/10000 (79.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 253: Average loss: 5.6804, Accuracy: 576/9000 (6.4000%)
Done in 124.64078497886658 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:254 choose agents : [95, 47, 93, 56, 5, 31, 75, 13, 77, 4]. Adversary List: []
___Train Local_ResNet_18,  epoch 254, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 504/569 (88.5764%)
___Train Local_ResNet_18,  epoch 254, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 503/569 (88.4007%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 7.2441, Accuracy: 2291/10000 (22.9100%)
___Train Local_ResNet_18,  epoch 254, local model 47, internal_epoch   1,  Average loss: 0.0018, Accuracy: 634/654 (96.9419%)
___Train Local_ResNet_18,  epoch 254, local model 47, internal_epoch   2,  Average loss: 0.0015, Accuracy: 633/654 (96.7890%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 1.6190, Accuracy: 5911/10000 (59.1100%)
___Train Local_ResNet_18,  epoch 254, local model 93, internal_epoch   1,  Average loss: 0.0017, Accuracy: 569/584 (97.4315%)
___Train Local_ResNet_18,  epoch 254, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 549/584 (94.0068%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 3.6474, Accuracy: 3403/10000 (34.0300%)
___Train Local_ResNet_18,  epoch 254, local model 56, internal_epoch   1,  Average loss: 0.0009, Accuracy: 737/743 (99.1925%)
___Train Local_ResNet_18,  epoch 254, local model 56, internal_epoch   2,  Average loss: 0.0005, Accuracy: 740/743 (99.5962%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 1.0385, Accuracy: 6997/10000 (69.9700%)
___Train Local_ResNet_18,  epoch 254, local model 5, internal_epoch   1,  Average loss: 0.0008, Accuracy: 364/365 (99.7260%)
___Train Local_ResNet_18,  epoch 254, local model 5, internal_epoch   2,  Average loss: 0.0002, Accuracy: 365/365 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 0.9495, Accuracy: 7177/10000 (71.7700%)
___Train Local_ResNet_18,  epoch 254, local model 31, internal_epoch   1,  Average loss: 0.0018, Accuracy: 676/706 (95.7507%)
___Train Local_ResNet_18,  epoch 254, local model 31, internal_epoch   2,  Average loss: 0.0030, Accuracy: 663/706 (93.9093%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 3.4683, Accuracy: 3951/10000 (39.5100%)
___Train Local_ResNet_18,  epoch 254, local model 75, internal_epoch   1,  Average loss: 0.0058, Accuracy: 564/578 (97.5779%)
___Train Local_ResNet_18,  epoch 254, local model 75, internal_epoch   2,  Average loss: 0.0344, Accuracy: 298/578 (51.5571%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 182.7665, Accuracy: 900/10000 (9.0000%)
___Train Local_ResNet_18,  epoch 254, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 585/620 (94.3548%)
___Train Local_ResNet_18,  epoch 254, local model 13, internal_epoch   2,  Average loss: 0.0021, Accuracy: 594/620 (95.8065%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 1.9395, Accuracy: 5237/10000 (52.3700%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 254, local model 77, internal_epoch   1,  Average loss: 0.0008, Accuracy: 496/496 (100.0000%)
___Train Local_ResNet_18,  epoch 254, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 496/496 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 1.1654, Accuracy: 6815/10000 (68.1500%)
___Train Local_ResNet_18,  epoch 254, local model 4, internal_epoch   1,  Average loss: 0.0023, Accuracy: 532/557 (95.5117%)
___Train Local_ResNet_18,  epoch 254, local model 4, internal_epoch   2,  Average loss: 0.0028, Accuracy: 525/557 (94.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 254: Average loss: 3.0353, Accuracy: 4608/10000 (46.0800%)
time spent on training: 72.55096936225891
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.08446866485013624  data num: [569, 654, 584, 743, 365, 706, 578, 620, 496, 557]
[rfa agg] considering poison per batch poison_fraction: 0.006599114441416894
[rfa agg] init. name: [95, 47, 93, 56, 5, 31, 75, 13, 77, 4], weight: tensor([0.0969, 0.1114, 0.0995, 0.1265, 0.0622, 0.1202, 0.0984, 0.1056, 0.0845,
        0.0949])
[rfa agg] iter:  0, prev_obj_val: 30.624908447265625, obj_val: 34.198604583740234, abs dis: 3.5736961364746094
[rfa agg] iter:  0, weight: tensor([0.1105, 0.0727, 0.0834, 0.0669, 0.1462, 0.0630, 0.0550, 0.0895, 0.1970,
        0.1158])
[rfa agg] iter:  1, prev_obj_val: 34.198604583740234, obj_val: 34.19466018676758, abs dis: 0.00394439697265625
[rfa agg] iter:  1, weight: tensor([0.0958, 0.0663, 0.0742, 0.0622, 0.2662, 0.0585, 0.0512, 0.0794, 0.1478,
        0.0984])
___Test Target_ResNet_18 poisoned: False, epoch: 254: Average loss: 0.6358, Accuracy: 7896/10000 (78.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 254: Average loss: 5.5616, Accuracy: 538/9000 (5.9778%)
Done in 129.98022651672363 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:255 choose agents : [17, 65, 22, 0, 49, 14, 87, 55, 30, 92]. Adversary List: []
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 255, local model 17, internal_epoch   1,  Average loss: 0.0010, Accuracy: 522/526 (99.2395%)
___Train Local_ResNet_18,  epoch 255, local model 17, internal_epoch   2,  Average loss: 0.0007, Accuracy: 521/526 (99.0494%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 1.0596, Accuracy: 6963/10000 (69.6300%)
___Train Local_ResNet_18,  epoch 255, local model 65, internal_epoch   1,  Average loss: 0.0014, Accuracy: 312/314 (99.3631%)
___Train Local_ResNet_18,  epoch 255, local model 65, internal_epoch   2,  Average loss: 0.0003, Accuracy: 313/314 (99.6815%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 1.2190, Accuracy: 6616/10000 (66.1600%)
___Train Local_ResNet_18,  epoch 255, local model 22, internal_epoch   1,  Average loss: 0.0026, Accuracy: 472/494 (95.5466%)
___Train Local_ResNet_18,  epoch 255, local model 22, internal_epoch   2,  Average loss: 0.0017, Accuracy: 476/494 (96.3563%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 1.7228, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 255, local model 0, internal_epoch   1,  Average loss: 0.0008, Accuracy: 367/367 (100.0000%)
___Train Local_ResNet_18,  epoch 255, local model 0, internal_epoch   2,  Average loss: 0.0003, Accuracy: 367/367 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 1.1014, Accuracy: 6958/10000 (69.5800%)
___Train Local_ResNet_18,  epoch 255, local model 49, internal_epoch   1,  Average loss: 0.0018, Accuracy: 414/426 (97.1831%)
___Train Local_ResNet_18,  epoch 255, local model 49, internal_epoch   2,  Average loss: 0.0006, Accuracy: 423/426 (99.2958%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 3.2612, Accuracy: 4199/10000 (41.9900%)
___Train Local_ResNet_18,  epoch 255, local model 14, internal_epoch   1,  Average loss: 0.0016, Accuracy: 314/318 (98.7421%)
___Train Local_ResNet_18,  epoch 255, local model 14, internal_epoch   2,  Average loss: 0.0006, Accuracy: 317/318 (99.6855%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 2.4813, Accuracy: 4962/10000 (49.6200%)
___Train Local_ResNet_18,  epoch 255, local model 87, internal_epoch   1,  Average loss: 0.0040, Accuracy: 366/397 (92.1914%)
___Train Local_ResNet_18,  epoch 255, local model 87, internal_epoch   2,  Average loss: 0.0049, Accuracy: 367/397 (92.4433%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 2.5878, Accuracy: 4459/10000 (44.5900%)
___Train Local_ResNet_18,  epoch 255, local model 55, internal_epoch   1,  Average loss: 0.0020, Accuracy: 290/299 (96.9900%)
___Train Local_ResNet_18,  epoch 255, local model 55, internal_epoch   2,  Average loss: 0.0002, Accuracy: 299/299 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 4.1182, Accuracy: 3805/10000 (38.0500%)
___Train Local_ResNet_18,  epoch 255, local model 30, internal_epoch   1,  Average loss: 0.0018, Accuracy: 331/337 (98.2196%)
___Train Local_ResNet_18,  epoch 255, local model 30, internal_epoch   2,  Average loss: 0.0012, Accuracy: 331/337 (98.2196%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 1.8246, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 255, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 746/796 (93.7186%)
___Train Local_ResNet_18,  epoch 255, local model 92, internal_epoch   2,  Average loss: 0.0067, Accuracy: 711/796 (89.3216%)
___Test Local_ResNet_18 poisoned: False, epoch: 255: Average loss: 10.8012, Accuracy: 2294/10000 (22.9400%)
time spent on training: 72.09573101997375
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.12306972391202621  data num: [526, 314, 494, 367, 426, 318, 397, 299, 337, 796]
[rfa agg] considering poison per batch poison_fraction: 0.009614822180627048
[rfa agg] init. name: [17, 65, 22, 0, 49, 14, 87, 55, 30, 92], weight: tensor([0.1231, 0.0735, 0.1156, 0.0859, 0.0997, 0.0744, 0.0929, 0.0700, 0.0788,
        0.1862])
[rfa agg] iter:  0, prev_obj_val: 27.11156463623047, obj_val: 44.0113639831543, abs dis: 16.899799346923828
[rfa agg] iter:  0, weight: tensor([0.0351, 0.2359, 0.0432, 0.0927, 0.0555, 0.2076, 0.0496, 0.1715, 0.0825,
        0.0265])
[rfa agg] iter:  1, prev_obj_val: 44.0113639831543, obj_val: 26.87984848022461, abs dis: 17.131515502929688
[rfa agg] iter:  1, weight: tensor([0.0752, 0.1344, 0.0842, 0.1050, 0.0910, 0.1356, 0.0839, 0.1269, 0.0960,
        0.0679])
[rfa agg] iter:  2, prev_obj_val: 26.87984848022461, obj_val: 48.45265197753906, abs dis: 21.572803497314453
[rfa agg] iter:  2, weight: tensor([0.0290, 0.2726, 0.0356, 0.0787, 0.0460, 0.2285, 0.0412, 0.1767, 0.0699,
        0.0218])
[rfa agg] iter:  3, prev_obj_val: 48.45265197753906, obj_val: 26.89137077331543, abs dis: 21.561281204223633
[rfa agg] iter:  3, weight: tensor([0.0810, 0.1256, 0.0894, 0.1050, 0.0945, 0.1269, 0.0872, 0.1189, 0.0961,
        0.0754])
[rfa agg] iter:  4, prev_obj_val: 26.89137077331543, obj_val: 48.45241165161133, abs dis: 21.5610408782959
[rfa agg] iter:  4, weight: tensor([0.0294, 0.2701, 0.0362, 0.0798, 0.0467, 0.2269, 0.0418, 0.1762, 0.0709,
        0.0221])
[rfa agg] iter:  5, prev_obj_val: 48.45241165161133, obj_val: 26.891372680664062, abs dis: 21.561038970947266
[rfa agg] iter:  5, weight: tensor([0.0810, 0.1256, 0.0894, 0.1050, 0.0945, 0.1269, 0.0872, 0.1189, 0.0961,
        0.0754])
[rfa agg] iter:  6, prev_obj_val: 26.891372680664062, obj_val: 48.45241165161133, abs dis: 21.561038970947266
[rfa agg] iter:  6, weight: tensor([0.0294, 0.2701, 0.0362, 0.0798, 0.0467, 0.2269, 0.0418, 0.1762, 0.0709,
        0.0221])
[rfa agg] iter:  7, prev_obj_val: 48.45241165161133, obj_val: 26.891372680664062, abs dis: 21.561038970947266
[rfa agg] iter:  7, weight: tensor([0.0810, 0.1256, 0.0894, 0.1050, 0.0945, 0.1269, 0.0872, 0.1189, 0.0961,
        0.0754])
[rfa agg] iter:  8, prev_obj_val: 26.891372680664062, obj_val: 48.45241165161133, abs dis: 21.561038970947266
[rfa agg] iter:  8, weight: tensor([0.0294, 0.2701, 0.0362, 0.0798, 0.0467, 0.2269, 0.0418, 0.1762, 0.0709,
        0.0221])
[rfa agg] iter:  9, prev_obj_val: 48.45241165161133, obj_val: 26.891372680664062, abs dis: 21.561038970947266
[rfa agg] iter:  9, weight: tensor([0.0810, 0.1256, 0.0894, 0.1050, 0.0945, 0.1269, 0.0872, 0.1189, 0.0961,
        0.0754])
___Test Target_ResNet_18 poisoned: False, epoch: 255: Average loss: 0.6318, Accuracy: 7915/10000 (79.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 255: Average loss: 5.5427, Accuracy: 572/9000 (6.3556%)
Done in 144.89458084106445 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:256 choose agents : [89, 69, 73, 15, 31, 36, 22, 1, 0, 96]. Adversary List: []
___Train Local_ResNet_18,  epoch 256, local model 89, internal_epoch   1,  Average loss: 0.0029, Accuracy: 392/413 (94.9153%)
___Train Local_ResNet_18,  epoch 256, local model 89, internal_epoch   2,  Average loss: 0.0027, Accuracy: 397/413 (96.1259%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 3.2041, Accuracy: 3776/10000 (37.7600%)
___Train Local_ResNet_18,  epoch 256, local model 69, internal_epoch   1,  Average loss: 0.0053, Accuracy: 195/216 (90.2778%)
___Train Local_ResNet_18,  epoch 256, local model 69, internal_epoch   2,  Average loss: 0.0010, Accuracy: 216/216 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 7.5923, Accuracy: 1403/10000 (14.0300%)
___Train Local_ResNet_18,  epoch 256, local model 73, internal_epoch   1,  Average loss: 0.0089, Accuracy: 411/500 (82.2000%)
___Train Local_ResNet_18,  epoch 256, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 465/500 (93.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 7.6344, Accuracy: 2499/10000 (24.9900%)
___Train Local_ResNet_18,  epoch 256, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 307/341 (90.0293%)
___Train Local_ResNet_18,  epoch 256, local model 15, internal_epoch   2,  Average loss: 0.0021, Accuracy: 329/341 (96.4809%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 4.6116, Accuracy: 3071/10000 (30.7100%)
___Train Local_ResNet_18,  epoch 256, local model 31, internal_epoch   1,  Average loss: 0.0029, Accuracy: 685/706 (97.0255%)
___Train Local_ResNet_18,  epoch 256, local model 31, internal_epoch   2,  Average loss: 0.0214, Accuracy: 476/706 (67.4221%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 198.9560, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 256, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 796/849 (93.7574%)
___Train Local_ResNet_18,  epoch 256, local model 36, internal_epoch   2,  Average loss: 0.0182, Accuracy: 596/849 (70.2002%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 7.8140, Accuracy: 2200/10000 (22.0000%)
___Train Local_ResNet_18,  epoch 256, local model 22, internal_epoch   1,  Average loss: 0.0023, Accuracy: 474/494 (95.9514%)
___Train Local_ResNet_18,  epoch 256, local model 22, internal_epoch   2,  Average loss: 0.0016, Accuracy: 477/494 (96.5587%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 2.1250, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch 256, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 623/641 (97.1919%)
___Train Local_ResNet_18,  epoch 256, local model 1, internal_epoch   2,  Average loss: 0.0113, Accuracy: 608/641 (94.8518%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 3.8863, Accuracy: 3839/10000 (38.3900%)
___Train Local_ResNet_18,  epoch 256, local model 0, internal_epoch   1,  Average loss: 0.0009, Accuracy: 367/367 (100.0000%)
___Train Local_ResNet_18,  epoch 256, local model 0, internal_epoch   2,  Average loss: 0.0003, Accuracy: 366/367 (99.7275%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 1.2101, Accuracy: 6783/10000 (67.8300%)
___Train Local_ResNet_18,  epoch 256, local model 96, internal_epoch   1,  Average loss: 0.0010, Accuracy: 701/708 (99.0113%)
___Train Local_ResNet_18,  epoch 256, local model 96, internal_epoch   2,  Average loss: 0.0011, Accuracy: 700/708 (98.8701%)
___Test Local_ResNet_18 poisoned: False, epoch: 256: Average loss: 1.8734, Accuracy: 5665/10000 (56.6500%)
time spent on training: 66.25999164581299
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [413, 216, 500, 341, 706, 849, 494, 641, 367, 708]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [89, 69, 73, 15, 31, 36, 22, 1, 0, 96], weight: tensor([0.0789, 0.0413, 0.0955, 0.0651, 0.1349, 0.1622, 0.0944, 0.1224, 0.0701,
        0.1352])
[rfa agg] iter:  0, prev_obj_val: 31.153173446655273, obj_val: 38.5807991027832, abs dis: 7.42762565612793
[rfa agg] iter:  0, weight: tensor([0.1771, 0.0249, 0.1629, 0.0805, 0.0581, 0.0516, 0.2146, 0.0727, 0.0938,
        0.0638])
[rfa agg] iter:  1, prev_obj_val: 38.5807991027832, obj_val: 45.99513244628906, abs dis: 7.414333343505859
[rfa agg] iter:  1, weight: tensor([0.1298, 0.0390, 0.0837, 0.1640, 0.0410, 0.0384, 0.0883, 0.0472, 0.3248,
        0.0439])
[rfa agg] iter:  2, prev_obj_val: 45.99513244628906, obj_val: 45.988067626953125, abs dis: 0.0070648193359375
[rfa agg] iter:  2, weight: tensor([0.1131, 0.1121, 0.0901, 0.1632, 0.0550, 0.0529, 0.0924, 0.0608, 0.2024,
        0.0580])
___Test Target_ResNet_18 poisoned: False, epoch: 256: Average loss: 0.6314, Accuracy: 7906/10000 (79.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 256: Average loss: 5.5419, Accuracy: 533/9000 (5.9222%)
Done in 123.24850869178772 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:257 choose agents : [54, 37, 60, 30, 4, 36, 19, 95, 47, 88]. Adversary List: []
___Train Local_ResNet_18,  epoch 257, local model 54, internal_epoch   1,  Average loss: 0.0016, Accuracy: 431/440 (97.9545%)
___Train Local_ResNet_18,  epoch 257, local model 54, internal_epoch   2,  Average loss: 0.0004, Accuracy: 437/440 (99.3182%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 2.2389, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 257, local model 37, internal_epoch   1,  Average loss: 0.0032, Accuracy: 692/725 (95.4483%)
___Train Local_ResNet_18,  epoch 257, local model 37, internal_epoch   2,  Average loss: 0.0116, Accuracy: 590/725 (81.3793%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 5.9076, Accuracy: 2495/10000 (24.9500%)
___Train Local_ResNet_18,  epoch 257, local model 60, internal_epoch   1,  Average loss: 0.0013, Accuracy: 281/284 (98.9437%)
___Train Local_ResNet_18,  epoch 257, local model 60, internal_epoch   2,  Average loss: 0.0002, Accuracy: 284/284 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 1.0771, Accuracy: 6738/10000 (67.3800%)
___Train Local_ResNet_18,  epoch 257, local model 30, internal_epoch   1,  Average loss: 0.0016, Accuracy: 332/337 (98.5163%)
___Train Local_ResNet_18,  epoch 257, local model 30, internal_epoch   2,  Average loss: 0.0008, Accuracy: 336/337 (99.7033%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 1.5071, Accuracy: 6190/10000 (61.9000%)
___Train Local_ResNet_18,  epoch 257, local model 4, internal_epoch   1,  Average loss: 0.0021, Accuracy: 540/557 (96.9479%)
___Train Local_ResNet_18,  epoch 257, local model 4, internal_epoch   2,  Average loss: 0.0019, Accuracy: 535/557 (96.0503%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 3.6749, Accuracy: 4616/10000 (46.1600%)
___Train Local_ResNet_18,  epoch 257, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 803/849 (94.5819%)
___Train Local_ResNet_18,  epoch 257, local model 36, internal_epoch   2,  Average loss: 0.0219, Accuracy: 521/849 (61.3663%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 13.6105, Accuracy: 1451/10000 (14.5100%)
___Train Local_ResNet_18,  epoch 257, local model 19, internal_epoch   1,  Average loss: 0.0115, Accuracy: 136/173 (78.6127%)
___Train Local_ResNet_18,  epoch 257, local model 19, internal_epoch   2,  Average loss: 0.0026, Accuracy: 166/173 (95.9538%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 8.4119, Accuracy: 2441/10000 (24.4100%)
___Train Local_ResNet_18,  epoch 257, local model 95, internal_epoch   1,  Average loss: 0.0046, Accuracy: 522/569 (91.7399%)
___Train Local_ResNet_18,  epoch 257, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 503/569 (88.4007%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 4.7855, Accuracy: 3254/10000 (32.5400%)
___Train Local_ResNet_18,  epoch 257, local model 47, internal_epoch   1,  Average loss: 0.0014, Accuracy: 644/654 (98.4709%)
___Train Local_ResNet_18,  epoch 257, local model 47, internal_epoch   2,  Average loss: 0.0018, Accuracy: 634/654 (96.9419%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 1.4763, Accuracy: 6311/10000 (63.1100%)
___Train Local_ResNet_18,  epoch 257, local model 88, internal_epoch   1,  Average loss: 0.0034, Accuracy: 417/447 (93.2886%)
___Train Local_ResNet_18,  epoch 257, local model 88, internal_epoch   2,  Average loss: 0.0019, Accuracy: 426/447 (95.3020%)
___Test Local_ResNet_18 poisoned: False, epoch: 257: Average loss: 3.9904, Accuracy: 3838/10000 (38.3800%)
time spent on training: 67.10180115699768
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [440, 725, 284, 337, 557, 849, 173, 569, 654, 447]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [54, 37, 60, 30, 4, 36, 19, 95, 47, 88], weight: tensor([0.0874, 0.1440, 0.0564, 0.0669, 0.1106, 0.1686, 0.0344, 0.1130, 0.1299,
        0.0888])
[rfa agg] iter:  0, prev_obj_val: 31.162254333496094, obj_val: 39.61996078491211, abs dis: 8.457706451416016
[rfa agg] iter:  0, weight: tensor([0.2518, 0.0545, 0.0530, 0.1110, 0.0994, 0.0450, 0.0166, 0.0960, 0.0624,
        0.2103])
[rfa agg] iter:  1, prev_obj_val: 39.61996078491211, obj_val: 39.59461975097656, abs dis: 0.025341033935546875
[rfa agg] iter:  1, weight: tensor([0.1263, 0.0488, 0.2024, 0.2335, 0.0697, 0.0428, 0.0302, 0.0694, 0.0528,
        0.1241])
[rfa agg] iter:  2, prev_obj_val: 39.59461975097656, obj_val: 39.59449768066406, abs dis: 0.0001220703125
[rfa agg] iter:  2, weight: tensor([0.1221, 0.0474, 0.2106, 0.2433, 0.0676, 0.0416, 0.0294, 0.0674, 0.0513,
        0.1193])
___Test Target_ResNet_18 poisoned: False, epoch: 257: Average loss: 0.6304, Accuracy: 7886/10000 (78.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 257: Average loss: 5.5225, Accuracy: 562/9000 (6.2444%)
Done in 128.84673857688904 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:258 choose agents : [8, 66, 49, 58, 44, 26, 21, 79, 98, 32]. Adversary List: []
___Train Local_ResNet_18,  epoch 258, local model 8, internal_epoch   1,  Average loss: 0.0008, Accuracy: 531/534 (99.4382%)
___Train Local_ResNet_18,  epoch 258, local model 8, internal_epoch   2,  Average loss: 0.0004, Accuracy: 533/534 (99.8127%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 1.0305, Accuracy: 6969/10000 (69.6900%)
___Train Local_ResNet_18,  epoch 258, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 519/555 (93.5135%)
___Train Local_ResNet_18,  epoch 258, local model 66, internal_epoch   2,  Average loss: 0.0016, Accuracy: 538/555 (96.9369%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 3.3727, Accuracy: 4254/10000 (42.5400%)
___Train Local_ResNet_18,  epoch 258, local model 49, internal_epoch   1,  Average loss: 0.0014, Accuracy: 421/426 (98.8263%)
___Train Local_ResNet_18,  epoch 258, local model 49, internal_epoch   2,  Average loss: 0.0005, Accuracy: 424/426 (99.5305%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 1.9462, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 258, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 213/234 (91.0256%)
___Train Local_ResNet_18,  epoch 258, local model 58, internal_epoch   2,  Average loss: 0.0004, Accuracy: 234/234 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 3.7495, Accuracy: 3209/10000 (32.0900%)
___Train Local_ResNet_18,  epoch 258, local model 44, internal_epoch   1,  Average loss: 0.0014, Accuracy: 427/436 (97.9358%)
___Train Local_ResNet_18,  epoch 258, local model 44, internal_epoch   2,  Average loss: 0.0004, Accuracy: 434/436 (99.5413%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 1.6720, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 258, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 460/468 (98.2906%)
___Train Local_ResNet_18,  epoch 258, local model 26, internal_epoch   2,  Average loss: 0.0013, Accuracy: 456/468 (97.4359%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 1.8779, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 258, local model 21, internal_epoch   1,  Average loss: 0.0024, Accuracy: 257/262 (98.0916%)
___Train Local_ResNet_18,  epoch 258, local model 21, internal_epoch   2,  Average loss: 0.0008, Accuracy: 259/262 (98.8550%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 2.3901, Accuracy: 4689/10000 (46.8900%)
___Train Local_ResNet_18,  epoch 258, local model 79, internal_epoch   1,  Average loss: 0.0036, Accuracy: 146/154 (94.8052%)
___Train Local_ResNet_18,  epoch 258, local model 79, internal_epoch   2,  Average loss: 0.0004, Accuracy: 154/154 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 1.0099, Accuracy: 7043/10000 (70.4300%)
___Train Local_ResNet_18,  epoch 258, local model 98, internal_epoch   1,  Average loss: 0.0028, Accuracy: 762/802 (95.0125%)
___Train Local_ResNet_18,  epoch 258, local model 98, internal_epoch   2,  Average loss: 0.0056, Accuracy: 721/802 (89.9002%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 2.7413, Accuracy: 4545/10000 (45.4500%)
___Train Local_ResNet_18,  epoch 258, local model 32, internal_epoch   1,  Average loss: 0.0015, Accuracy: 801/824 (97.2087%)
___Train Local_ResNet_18,  epoch 258, local model 32, internal_epoch   2,  Average loss: 0.0028, Accuracy: 786/824 (95.3883%)
___Test Local_ResNet_18 poisoned: False, epoch: 258: Average loss: 5.6517, Accuracy: 2984/10000 (29.8400%)
time spent on training: 64.19485235214233
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [534, 555, 426, 234, 436, 468, 262, 154, 802, 824]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [8, 66, 49, 58, 44, 26, 21, 79, 98, 32], weight: tensor([0.1137, 0.1182, 0.0907, 0.0498, 0.0929, 0.0997, 0.0558, 0.0328, 0.1708,
        0.1755])
[rfa agg] iter:  0, prev_obj_val: 26.75128173828125, obj_val: 34.273109436035156, abs dis: 7.521827697753906
[rfa agg] iter:  0, weight: tensor([0.1145, 0.1080, 0.2029, 0.0222, 0.2118, 0.1973, 0.0344, 0.0114, 0.0478,
        0.0496])
[rfa agg] iter:  1, prev_obj_val: 34.273109436035156, obj_val: 40.777679443359375, abs dis: 6.504570007324219
[rfa agg] iter:  1, weight: tensor([0.0876, 0.0884, 0.1963, 0.0567, 0.2024, 0.1124, 0.1174, 0.0252, 0.0558,
        0.0578])
[rfa agg] iter:  2, prev_obj_val: 40.777679443359375, obj_val: 40.75169372558594, abs dis: 0.0259857177734375
[rfa agg] iter:  2, weight: tensor([0.0681, 0.0696, 0.1072, 0.1109, 0.1099, 0.0786, 0.3135, 0.0389, 0.0507,
        0.0525])
[rfa agg] iter:  3, prev_obj_val: 40.75169372558594, obj_val: 40.74956130981445, abs dis: 0.002132415771484375
[rfa agg] iter:  3, weight: tensor([0.0625, 0.0638, 0.0980, 0.1022, 0.1005, 0.0720, 0.3706, 0.0357, 0.0465,
        0.0481])
[rfa agg] iter:  4, prev_obj_val: 40.74956130981445, obj_val: 40.749267578125, abs dis: 0.000293731689453125
[rfa agg] iter:  4, weight: tensor([0.0605, 0.0618, 0.0948, 0.0986, 0.0972, 0.0697, 0.3913, 0.0345, 0.0450,
        0.0466])
[rfa agg] iter:  5, prev_obj_val: 40.749267578125, obj_val: 40.74922180175781, abs dis: 4.57763671875e-05
[rfa agg] iter:  5, weight: tensor([0.0597, 0.0610, 0.0935, 0.0972, 0.0959, 0.0688, 0.3994, 0.0340, 0.0445,
        0.0460])
[rfa agg] iter:  6, prev_obj_val: 40.74922180175781, obj_val: 37.46242141723633, abs dis: 3.2868003845214844
[rfa agg] iter:  6, weight: tensor([0.0594, 0.0606, 0.0930, 0.0966, 0.0954, 0.0684, 0.4027, 0.0339, 0.0442,
        0.0457])
[rfa agg] iter:  7, prev_obj_val: 37.46242141723633, obj_val: 40.758644104003906, abs dis: 3.296222686767578
[rfa agg] iter:  7, weight: tensor([0.0790, 0.0802, 0.1420, 0.0783, 0.1458, 0.0949, 0.2363, 0.0318, 0.0549,
        0.0568])
[rfa agg] iter:  8, prev_obj_val: 40.758644104003906, obj_val: 40.7502555847168, abs dis: 0.008388519287109375
[rfa agg] iter:  8, weight: tensor([0.0650, 0.0664, 0.1020, 0.1060, 0.1046, 0.0749, 0.3456, 0.0371, 0.0484,
        0.0500])
[rfa agg] iter:  9, prev_obj_val: 40.7502555847168, obj_val: 40.749366760253906, abs dis: 0.000888824462890625
[rfa agg] iter:  9, weight: tensor([0.0614, 0.0627, 0.0962, 0.1002, 0.0987, 0.0708, 0.3820, 0.0350, 0.0457,
        0.0473])
___Test Target_ResNet_18 poisoned: False, epoch: 258: Average loss: 0.6278, Accuracy: 7915/10000 (79.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 258: Average loss: 5.6158, Accuracy: 572/9000 (6.3556%)
Done in 134.40882468223572 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:259 choose agents : [81, 15, 55, 12, 47, 26, 82, 33, 64, 70]. Adversary List: []
___Train Local_ResNet_18,  epoch 259, local model 81, internal_epoch   1,  Average loss: 0.0055, Accuracy: 944/1034 (91.2959%)
___Train Local_ResNet_18,  epoch 259, local model 81, internal_epoch   2,  Average loss: 0.0101, Accuracy: 837/1034 (80.9478%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 12.7168, Accuracy: 2101/10000 (21.0100%)
___Train Local_ResNet_18,  epoch 259, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 316/341 (92.6686%)
___Train Local_ResNet_18,  epoch 259, local model 15, internal_epoch   2,  Average loss: 0.0034, Accuracy: 325/341 (95.3079%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 3.3508, Accuracy: 3705/10000 (37.0500%)
___Train Local_ResNet_18,  epoch 259, local model 55, internal_epoch   1,  Average loss: 0.0018, Accuracy: 293/299 (97.9933%)
___Train Local_ResNet_18,  epoch 259, local model 55, internal_epoch   2,  Average loss: 0.0003, Accuracy: 299/299 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 5.7286, Accuracy: 3018/10000 (30.1800%)
___Train Local_ResNet_18,  epoch 259, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 893/977 (91.4023%)
___Train Local_ResNet_18,  epoch 259, local model 12, internal_epoch   2,  Average loss: 0.0110, Accuracy: 789/977 (80.7574%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 12.1315, Accuracy: 2693/10000 (26.9300%)
___Train Local_ResNet_18,  epoch 259, local model 47, internal_epoch   1,  Average loss: 0.0018, Accuracy: 635/654 (97.0948%)
___Train Local_ResNet_18,  epoch 259, local model 47, internal_epoch   2,  Average loss: 0.0032, Accuracy: 625/654 (95.5657%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 2.6292, Accuracy: 4863/10000 (48.6300%)
___Train Local_ResNet_18,  epoch 259, local model 26, internal_epoch   1,  Average loss: 0.0011, Accuracy: 462/468 (98.7179%)
___Train Local_ResNet_18,  epoch 259, local model 26, internal_epoch   2,  Average loss: 0.0006, Accuracy: 465/468 (99.3590%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 2.0271, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 259, local model 82, internal_epoch   1,  Average loss: 0.0012, Accuracy: 589/601 (98.0033%)
___Train Local_ResNet_18,  epoch 259, local model 82, internal_epoch   2,  Average loss: 0.0008, Accuracy: 593/601 (98.6689%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 2.4833, Accuracy: 4861/10000 (48.6100%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 259, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 507/527 (96.2049%)
___Train Local_ResNet_18,  epoch 259, local model 33, internal_epoch   2,  Average loss: 0.0055, Accuracy: 472/527 (89.5636%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 5.2631, Accuracy: 2696/10000 (26.9600%)
___Train Local_ResNet_18,  epoch 259, local model 64, internal_epoch   1,  Average loss: 0.0018, Accuracy: 665/686 (96.9388%)
___Train Local_ResNet_18,  epoch 259, local model 64, internal_epoch   2,  Average loss: 0.0020, Accuracy: 664/686 (96.7930%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 1.9142, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 259, local model 70, internal_epoch   1,  Average loss: 0.0026, Accuracy: 577/610 (94.5902%)
___Train Local_ResNet_18,  epoch 259, local model 70, internal_epoch   2,  Average loss: 0.0015, Accuracy: 589/610 (96.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 259: Average loss: 2.8167, Accuracy: 4117/10000 (41.1700%)
time spent on training: 74.06252479553223
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.08504114894303695  data num: [1034, 341, 299, 977, 654, 468, 601, 527, 686, 610]
[rfa agg] considering poison per batch poison_fraction: 0.006643839761174762
[rfa agg] init. name: [81, 15, 55, 12, 47, 26, 82, 33, 64, 70], weight: tensor([0.1669, 0.0550, 0.0482, 0.1577, 0.1055, 0.0755, 0.0970, 0.0850, 0.1107,
        0.0984])
[rfa agg] iter:  0, prev_obj_val: 33.745025634765625, obj_val: 38.73893356323242, abs dis: 4.993907928466797
[rfa agg] iter:  0, weight: tensor([0.0443, 0.0383, 0.0259, 0.0478, 0.1047, 0.1377, 0.1702, 0.1628, 0.1106,
        0.1578])
[rfa agg] iter:  1, prev_obj_val: 38.73893356323242, obj_val: 41.912841796875, abs dis: 3.173908233642578
[rfa agg] iter:  1, weight: tensor([0.0400, 0.0568, 0.0350, 0.0425, 0.0749, 0.3339, 0.1028, 0.1342, 0.0789,
        0.1011])
[rfa agg] iter:  2, prev_obj_val: 41.912841796875, obj_val: 48.83673858642578, abs dis: 6.923896789550781
[rfa agg] iter:  2, weight: tensor([0.0442, 0.0847, 0.0488, 0.0467, 0.0754, 0.3072, 0.0969, 0.1209, 0.0793,
        0.0960])
[rfa agg] iter:  3, prev_obj_val: 48.83673858642578, obj_val: 52.44883728027344, abs dis: 3.6120986938476562
[rfa agg] iter:  3, weight: tensor([0.0506, 0.2062, 0.1000, 0.0529, 0.0748, 0.1578, 0.0885, 0.1020, 0.0785,
        0.0887])
[rfa agg] iter:  4, prev_obj_val: 52.44883728027344, obj_val: 52.4415283203125, abs dis: 0.0073089599609375
[rfa agg] iter:  4, weight: tensor([0.0469, 0.2804, 0.1393, 0.0488, 0.0654, 0.1155, 0.0753, 0.0841, 0.0687,
        0.0756])
[rfa agg] iter:  5, prev_obj_val: 52.4415283203125, obj_val: 52.44102478027344, abs dis: 0.0005035400390625
[rfa agg] iter:  5, weight: tensor([0.0456, 0.3013, 0.1355, 0.0474, 0.0635, 0.1119, 0.0731, 0.0815, 0.0667,
        0.0734])
[rfa agg] iter:  6, prev_obj_val: 52.44102478027344, obj_val: 52.44096755981445, abs dis: 5.7220458984375e-05
[rfa agg] iter:  6, weight: tensor([0.0452, 0.3077, 0.1341, 0.0470, 0.0630, 0.1109, 0.0725, 0.0807, 0.0661,
        0.0728])
___Test Target_ResNet_18 poisoned: False, epoch: 259: Average loss: 0.6368, Accuracy: 7906/10000 (79.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 259: Average loss: 5.6916, Accuracy: 524/9000 (5.8222%)
Done in 139.6641013622284 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:260 choose agents : [62, 25, 12, 16, 22, 72, 58, 28, 15, 29]. Adversary List: []
___Train Local_ResNet_18,  epoch 260, local model 62, internal_epoch   1,  Average loss: 0.0005, Accuracy: 358/358 (100.0000%)
___Train Local_ResNet_18,  epoch 260, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 358/358 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 0.7170, Accuracy: 7728/10000 (77.2800%)
___Train Local_ResNet_18,  epoch 260, local model 25, internal_epoch   1,  Average loss: 0.0020, Accuracy: 527/545 (96.6972%)
___Train Local_ResNet_18,  epoch 260, local model 25, internal_epoch   2,  Average loss: 0.0007, Accuracy: 537/545 (98.5321%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 2.8967, Accuracy: 4329/10000 (43.2900%)
___Train Local_ResNet_18,  epoch 260, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 908/977 (92.9376%)
___Train Local_ResNet_18,  epoch 260, local model 12, internal_epoch   2,  Average loss: 0.0111, Accuracy: 777/977 (79.5292%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 15.8035, Accuracy: 1878/10000 (18.7800%)
___Train Local_ResNet_18,  epoch 260, local model 16, internal_epoch   1,  Average loss: 0.0017, Accuracy: 754/773 (97.5420%)
___Train Local_ResNet_18,  epoch 260, local model 16, internal_epoch   2,  Average loss: 0.0118, Accuracy: 615/773 (79.5602%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 6.0507, Accuracy: 3247/10000 (32.4700%)
___Train Local_ResNet_18,  epoch 260, local model 22, internal_epoch   1,  Average loss: 0.0017, Accuracy: 488/494 (98.7854%)
___Train Local_ResNet_18,  epoch 260, local model 22, internal_epoch   2,  Average loss: 0.0005, Accuracy: 490/494 (99.1903%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 2.7921, Accuracy: 4267/10000 (42.6700%)
___Train Local_ResNet_18,  epoch 260, local model 72, internal_epoch   1,  Average loss: 0.0054, Accuracy: 553/618 (89.4822%)
___Train Local_ResNet_18,  epoch 260, local model 72, internal_epoch   2,  Average loss: 0.0111, Accuracy: 511/618 (82.6861%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 7.4095, Accuracy: 3100/10000 (31.0000%)
___Train Local_ResNet_18,  epoch 260, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 222/234 (94.8718%)
___Train Local_ResNet_18,  epoch 260, local model 58, internal_epoch   2,  Average loss: 0.0003, Accuracy: 234/234 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 4.8131, Accuracy: 2678/10000 (26.7800%)
___Train Local_ResNet_18,  epoch 260, local model 28, internal_epoch   1,  Average loss: 0.0007, Accuracy: 422/423 (99.7636%)
___Train Local_ResNet_18,  epoch 260, local model 28, internal_epoch   2,  Average loss: 0.0002, Accuracy: 423/423 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 1.1581, Accuracy: 6934/10000 (69.3400%)
___Train Local_ResNet_18,  epoch 260, local model 15, internal_epoch   1,  Average loss: 0.0029, Accuracy: 322/341 (94.4282%)
___Train Local_ResNet_18,  epoch 260, local model 15, internal_epoch   2,  Average loss: 0.0012, Accuracy: 335/341 (98.2405%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 3.5120, Accuracy: 4284/10000 (42.8400%)
___Train Local_ResNet_18,  epoch 260, local model 29, internal_epoch   1,  Average loss: 0.0036, Accuracy: 787/848 (92.8066%)
___Train Local_ResNet_18,  epoch 260, local model 29, internal_epoch   2,  Average loss: 0.0100, Accuracy: 716/848 (84.4340%)
___Test Local_ResNet_18 poisoned: False, epoch: 260: Average loss: 24.5059, Accuracy: 1205/10000 (12.0500%)
time spent on training: 66.64648461341858
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [358, 545, 977, 773, 494, 618, 234, 423, 341, 848]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [62, 25, 12, 16, 22, 72, 58, 28, 15, 29], weight: tensor([0.0638, 0.0971, 0.1741, 0.1378, 0.0880, 0.1101, 0.0417, 0.0754, 0.0608,
        0.1511])
[rfa agg] iter:  0, prev_obj_val: 34.77930450439453, obj_val: 43.065216064453125, abs dis: 8.285911560058594
[rfa agg] iter:  0, weight: tensor([0.0570, 0.2318, 0.0519, 0.0663, 0.2296, 0.1213, 0.0210, 0.1073, 0.0534,
        0.0604])
[rfa agg] iter:  1, prev_obj_val: 43.065216064453125, obj_val: 46.107139587402344, abs dis: 3.0419235229492188
[rfa agg] iter:  1, weight: tensor([0.2094, 0.0759, 0.0362, 0.0413, 0.1116, 0.0589, 0.0330, 0.2389, 0.1553,
        0.0395])
[rfa agg] iter:  2, prev_obj_val: 46.107139587402344, obj_val: 57.869102478027344, abs dis: 11.761962890625
[rfa agg] iter:  2, weight: tensor([0.4287, 0.0487, 0.0264, 0.0295, 0.0657, 0.0399, 0.0315, 0.1121, 0.1892,
        0.0284])
[rfa agg] iter:  3, prev_obj_val: 57.869102478027344, obj_val: 53.82289123535156, abs dis: 4.046211242675781
[rfa agg] iter:  3, weight: tensor([0.1459, 0.0737, 0.0516, 0.0549, 0.0859, 0.0668, 0.2299, 0.1035, 0.1338,
        0.0540])
[rfa agg] iter:  4, prev_obj_val: 53.82289123535156, obj_val: 46.120704650878906, abs dis: 7.702186584472656
[rfa agg] iter:  4, weight: tensor([0.1957, 0.0760, 0.0496, 0.0536, 0.0917, 0.0672, 0.1250, 0.1181, 0.1709,
        0.0523])
[rfa agg] iter:  5, prev_obj_val: 46.120704650878906, obj_val: 61.9937744140625, abs dis: 15.873069763183594
[rfa agg] iter:  5, weight: tensor([0.4001, 0.0513, 0.0278, 0.0312, 0.0691, 0.0421, 0.0333, 0.1168, 0.1983,
        0.0300])
[rfa agg] iter:  6, prev_obj_val: 61.9937744140625, obj_val: 49.88091278076172, abs dis: 12.112861633300781
[rfa agg] iter:  6, weight: tensor([0.1061, 0.0643, 0.0479, 0.0503, 0.0729, 0.0596, 0.3667, 0.0836, 0.0990,
        0.0497])
[rfa agg] iter:  7, prev_obj_val: 49.88091278076172, obj_val: 46.10216522216797, abs dis: 3.77874755859375
[rfa agg] iter:  7, weight: tensor([0.2758, 0.0668, 0.0401, 0.0440, 0.0844, 0.0572, 0.0669, 0.1204, 0.2017,
        0.0427])
[rfa agg] iter:  8, prev_obj_val: 46.10216522216797, obj_val: 57.86958312988281, abs dis: 11.767417907714844
[rfa agg] iter:  8, weight: tensor([0.4219, 0.0484, 0.0263, 0.0294, 0.0652, 0.0397, 0.0314, 0.1107, 0.1988,
        0.0283])
[rfa agg] iter:  9, prev_obj_val: 57.86958312988281, obj_val: 53.822872161865234, abs dis: 4.046710968017578
[rfa agg] iter:  9, weight: tensor([0.1458, 0.0737, 0.0516, 0.0549, 0.0859, 0.0669, 0.2296, 0.1035, 0.1339,
        0.0540])
___Test Target_ResNet_18 poisoned: False, epoch: 260: Average loss: 0.6363, Accuracy: 7903/10000 (79.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 260: Average loss: 5.7098, Accuracy: 545/9000 (6.0556%)
Done in 141.1502902507782 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:261 choose agents : [61, 83, 69, 20, 34, 8, 28, 50, 93, 92]. Adversary List: []
___Train Local_ResNet_18,  epoch 261, local model 61, internal_epoch   1,  Average loss: 0.0027, Accuracy: 563/590 (95.4237%)
___Train Local_ResNet_18,  epoch 261, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 551/590 (93.3898%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 6.9369, Accuracy: 2756/10000 (27.5600%)
___Train Local_ResNet_18,  epoch 261, local model 83, internal_epoch   1,  Average loss: 0.0005, Accuracy: 365/366 (99.7268%)
___Train Local_ResNet_18,  epoch 261, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 366/366 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 0.7361, Accuracy: 7716/10000 (77.1600%)
___Train Local_ResNet_18,  epoch 261, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 205/216 (94.9074%)
___Train Local_ResNet_18,  epoch 261, local model 69, internal_epoch   2,  Average loss: 0.0007, Accuracy: 214/216 (99.0741%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 5.9935, Accuracy: 2011/10000 (20.1100%)
___Train Local_ResNet_18,  epoch 261, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 345/362 (95.3039%)
___Train Local_ResNet_18,  epoch 261, local model 20, internal_epoch   2,  Average loss: 0.0013, Accuracy: 354/362 (97.7901%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 7.4912, Accuracy: 2562/10000 (25.6200%)
___Train Local_ResNet_18,  epoch 261, local model 34, internal_epoch   1,  Average loss: 0.0024, Accuracy: 335/349 (95.9885%)
___Train Local_ResNet_18,  epoch 261, local model 34, internal_epoch   2,  Average loss: 0.0013, Accuracy: 340/349 (97.4212%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 3.0492, Accuracy: 4761/10000 (47.6100%)
___Train Local_ResNet_18,  epoch 261, local model 8, internal_epoch   1,  Average loss: 0.0010, Accuracy: 530/534 (99.2509%)
___Train Local_ResNet_18,  epoch 261, local model 8, internal_epoch   2,  Average loss: 0.0009, Accuracy: 529/534 (99.0637%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 1.5112, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch 261, local model 28, internal_epoch   1,  Average loss: 0.0006, Accuracy: 422/423 (99.7636%)
___Train Local_ResNet_18,  epoch 261, local model 28, internal_epoch   2,  Average loss: 0.0002, Accuracy: 423/423 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 1.0077, Accuracy: 7168/10000 (71.6800%)
___Train Local_ResNet_18,  epoch 261, local model 50, internal_epoch   1,  Average loss: 0.0008, Accuracy: 401/401 (100.0000%)
___Train Local_ResNet_18,  epoch 261, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/401 (99.7506%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 1.0615, Accuracy: 6933/10000 (69.3300%)
___Train Local_ResNet_18,  epoch 261, local model 93, internal_epoch   1,  Average loss: 0.0012, Accuracy: 581/584 (99.4863%)
___Train Local_ResNet_18,  epoch 261, local model 93, internal_epoch   2,  Average loss: 0.0072, Accuracy: 537/584 (91.9521%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 7.3696, Accuracy: 2153/10000 (21.5300%)
___Train Local_ResNet_18,  epoch 261, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 751/796 (94.3467%)
___Train Local_ResNet_18,  epoch 261, local model 92, internal_epoch   2,  Average loss: 0.0066, Accuracy: 702/796 (88.1910%)
___Test Local_ResNet_18 poisoned: False, epoch: 261: Average loss: 8.0945, Accuracy: 1914/10000 (19.1400%)
time spent on training: 64.03940272331238
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [590, 366, 216, 362, 349, 534, 423, 401, 584, 796]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [61, 83, 69, 20, 34, 8, 28, 50, 93, 92], weight: tensor([0.1277, 0.0792, 0.0467, 0.0783, 0.0755, 0.1156, 0.0915, 0.0868, 0.1264,
        0.1723])
[rfa agg] iter:  0, prev_obj_val: 26.987506866455078, obj_val: 42.235050201416016, abs dis: 15.247543334960938
[rfa agg] iter:  0, weight: tensor([0.0377, 0.2854, 0.0277, 0.1662, 0.1673, 0.0460, 0.1046, 0.0982, 0.0373,
        0.0295])
[rfa agg] iter:  1, prev_obj_val: 42.235050201416016, obj_val: 30.26403045654297, abs dis: 11.971019744873047
[rfa agg] iter:  1, weight: tensor([0.0554, 0.1041, 0.3200, 0.1011, 0.0977, 0.0607, 0.0803, 0.0760, 0.0548,
        0.0500])
[rfa agg] iter:  2, prev_obj_val: 30.26403045654297, obj_val: 42.23181915283203, abs dis: 11.967788696289062
[rfa agg] iter:  2, weight: tensor([0.0444, 0.2319, 0.0491, 0.1784, 0.1765, 0.0523, 0.0963, 0.0910, 0.0439,
        0.0362])
[rfa agg] iter:  3, prev_obj_val: 42.23181915283203, obj_val: 30.264324188232422, abs dis: 11.96749496459961
[rfa agg] iter:  3, weight: tensor([0.0553, 0.1038, 0.3214, 0.1009, 0.0975, 0.0606, 0.0801, 0.0758, 0.0547,
        0.0499])
[rfa agg] iter:  4, prev_obj_val: 30.264324188232422, obj_val: 42.23181915283203, abs dis: 11.96749496459961
[rfa agg] iter:  4, weight: tensor([0.0444, 0.2319, 0.0491, 0.1784, 0.1765, 0.0523, 0.0963, 0.0910, 0.0439,
        0.0362])
[rfa agg] iter:  5, prev_obj_val: 42.23181915283203, obj_val: 30.264324188232422, abs dis: 11.96749496459961
[rfa agg] iter:  5, weight: tensor([0.0553, 0.1038, 0.3214, 0.1009, 0.0975, 0.0606, 0.0801, 0.0758, 0.0547,
        0.0499])
[rfa agg] iter:  6, prev_obj_val: 30.264324188232422, obj_val: 42.23181915283203, abs dis: 11.96749496459961
[rfa agg] iter:  6, weight: tensor([0.0444, 0.2319, 0.0491, 0.1784, 0.1765, 0.0523, 0.0963, 0.0910, 0.0439,
        0.0362])
[rfa agg] iter:  7, prev_obj_val: 42.23181915283203, obj_val: 30.264324188232422, abs dis: 11.96749496459961
[rfa agg] iter:  7, weight: tensor([0.0553, 0.1038, 0.3214, 0.1009, 0.0975, 0.0606, 0.0801, 0.0758, 0.0547,
        0.0499])
[rfa agg] iter:  8, prev_obj_val: 30.264324188232422, obj_val: 42.23181915283203, abs dis: 11.96749496459961
[rfa agg] iter:  8, weight: tensor([0.0444, 0.2319, 0.0491, 0.1784, 0.1765, 0.0523, 0.0963, 0.0910, 0.0439,
        0.0362])
[rfa agg] iter:  9, prev_obj_val: 42.23181915283203, obj_val: 30.264324188232422, abs dis: 11.96749496459961
[rfa agg] iter:  9, weight: tensor([0.0553, 0.1038, 0.3214, 0.1009, 0.0975, 0.0606, 0.0801, 0.0758, 0.0547,
        0.0499])
___Test Target_ResNet_18 poisoned: False, epoch: 261: Average loss: 0.6345, Accuracy: 7914/10000 (79.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 261: Average loss: 5.7526, Accuracy: 533/9000 (5.9222%)
Done in 144.7401828765869 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:262 choose agents : [60, 95, 5, 2, 44, 0, 6, 41, 19, 53]. Adversary List: []
___Train Local_ResNet_18,  epoch 262, local model 60, internal_epoch   1,  Average loss: 0.0010, Accuracy: 282/284 (99.2958%)
___Train Local_ResNet_18,  epoch 262, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 284/284 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 0.8858, Accuracy: 7266/10000 (72.6600%)
___Train Local_ResNet_18,  epoch 262, local model 95, internal_epoch   1,  Average loss: 0.0050, Accuracy: 513/569 (90.1582%)
___Train Local_ResNet_18,  epoch 262, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 505/569 (88.7522%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 9.5805, Accuracy: 1922/10000 (19.2200%)
___Train Local_ResNet_18,  epoch 262, local model 5, internal_epoch   1,  Average loss: 0.0008, Accuracy: 365/365 (100.0000%)
___Train Local_ResNet_18,  epoch 262, local model 5, internal_epoch   2,  Average loss: 0.0002, Accuracy: 365/365 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 0.8810, Accuracy: 7364/10000 (73.6400%)
___Train Local_ResNet_18,  epoch 262, local model 2, internal_epoch   1,  Average loss: 0.0025, Accuracy: 448/461 (97.1800%)
___Train Local_ResNet_18,  epoch 262, local model 2, internal_epoch   2,  Average loss: 0.0050, Accuracy: 428/461 (92.8416%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 3.8657, Accuracy: 3655/10000 (36.5500%)
___Train Local_ResNet_18,  epoch 262, local model 44, internal_epoch   1,  Average loss: 0.0011, Accuracy: 432/436 (99.0826%)
___Train Local_ResNet_18,  epoch 262, local model 44, internal_epoch   2,  Average loss: 0.0005, Accuracy: 433/436 (99.3119%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 1.2648, Accuracy: 6553/10000 (65.5300%)
___Train Local_ResNet_18,  epoch 262, local model 0, internal_epoch   1,  Average loss: 0.0009, Accuracy: 367/367 (100.0000%)
___Train Local_ResNet_18,  epoch 262, local model 0, internal_epoch   2,  Average loss: 0.0003, Accuracy: 367/367 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 1.3583, Accuracy: 6458/10000 (64.5800%)
___Train Local_ResNet_18,  epoch 262, local model 6, internal_epoch   1,  Average loss: 0.0017, Accuracy: 503/520 (96.7308%)
___Train Local_ResNet_18,  epoch 262, local model 6, internal_epoch   2,  Average loss: 0.0018, Accuracy: 505/520 (97.1154%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 2.4567, Accuracy: 4602/10000 (46.0200%)
___Train Local_ResNet_18,  epoch 262, local model 41, internal_epoch   1,  Average loss: 0.0040, Accuracy: 467/513 (91.0331%)
___Train Local_ResNet_18,  epoch 262, local model 41, internal_epoch   2,  Average loss: 0.0026, Accuracy: 488/513 (95.1267%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 3.8075, Accuracy: 4456/10000 (44.5600%)
___Train Local_ResNet_18,  epoch 262, local model 19, internal_epoch   1,  Average loss: 0.0090, Accuracy: 143/173 (82.6590%)
___Train Local_ResNet_18,  epoch 262, local model 19, internal_epoch   2,  Average loss: 0.0031, Accuracy: 163/173 (94.2197%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 5.1355, Accuracy: 3455/10000 (34.5500%)
___Train Local_ResNet_18,  epoch 262, local model 53, internal_epoch   1,  Average loss: 0.0016, Accuracy: 608/625 (97.2800%)
___Train Local_ResNet_18,  epoch 262, local model 53, internal_epoch   2,  Average loss: 0.0012, Accuracy: 612/625 (97.9200%)
___Test Local_ResNet_18 poisoned: False, epoch: 262: Average loss: 2.7101, Accuracy: 4567/10000 (45.6700%)
time spent on training: 69.70333194732666
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [284, 569, 365, 461, 436, 367, 520, 513, 173, 625]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [60, 95, 5, 2, 44, 0, 6, 41, 19, 53], weight: tensor([0.0658, 0.1319, 0.0846, 0.1069, 0.1011, 0.0851, 0.1206, 0.1189, 0.0401,
        0.1449])
[rfa agg] iter:  0, prev_obj_val: 20.849231719970703, obj_val: 39.48847198486328, abs dis: 18.639240264892578
[rfa agg] iter:  0, weight: tensor([0.0696, 0.0457, 0.2855, 0.0554, 0.1035, 0.3004, 0.0436, 0.0422, 0.0146,
        0.0396])
[rfa agg] iter:  1, prev_obj_val: 39.48847198486328, obj_val: 27.40938949584961, abs dis: 12.079082489013672
[rfa agg] iter:  1, weight: tensor([0.1387, 0.0749, 0.1079, 0.0749, 0.0919, 0.1085, 0.0696, 0.0683, 0.1946,
        0.0709])
[rfa agg] iter:  2, prev_obj_val: 27.40938949584961, obj_val: 39.48682403564453, abs dis: 12.077434539794922
[rfa agg] iter:  2, weight: tensor([0.4115, 0.0481, 0.1242, 0.0525, 0.0755, 0.1252, 0.0452, 0.0442, 0.0300,
        0.0436])
[rfa agg] iter:  3, prev_obj_val: 39.48682403564453, obj_val: 27.409330368041992, abs dis: 12.077493667602539
[rfa agg] iter:  3, weight: tensor([0.1394, 0.0749, 0.1076, 0.0748, 0.0918, 0.1082, 0.0696, 0.0682, 0.1947,
        0.0708])
[rfa agg] iter:  4, prev_obj_val: 27.409330368041992, obj_val: 39.48683166503906, abs dis: 12.07750129699707
[rfa agg] iter:  4, weight: tensor([0.4117, 0.0481, 0.1242, 0.0525, 0.0755, 0.1252, 0.0452, 0.0441, 0.0299,
        0.0436])
[rfa agg] iter:  5, prev_obj_val: 39.48683166503906, obj_val: 27.409330368041992, abs dis: 12.07750129699707
[rfa agg] iter:  5, weight: tensor([0.1394, 0.0749, 0.1076, 0.0748, 0.0918, 0.1082, 0.0696, 0.0682, 0.1947,
        0.0708])
[rfa agg] iter:  6, prev_obj_val: 27.409330368041992, obj_val: 39.48683166503906, abs dis: 12.07750129699707
[rfa agg] iter:  6, weight: tensor([0.4117, 0.0481, 0.1242, 0.0525, 0.0755, 0.1252, 0.0452, 0.0441, 0.0299,
        0.0436])
[rfa agg] iter:  7, prev_obj_val: 39.48683166503906, obj_val: 27.409330368041992, abs dis: 12.07750129699707
[rfa agg] iter:  7, weight: tensor([0.1394, 0.0749, 0.1076, 0.0748, 0.0918, 0.1082, 0.0696, 0.0682, 0.1947,
        0.0708])
[rfa agg] iter:  8, prev_obj_val: 27.409330368041992, obj_val: 39.48683166503906, abs dis: 12.07750129699707
[rfa agg] iter:  8, weight: tensor([0.4117, 0.0481, 0.1242, 0.0525, 0.0755, 0.1252, 0.0452, 0.0441, 0.0299,
        0.0436])
[rfa agg] iter:  9, prev_obj_val: 39.48683166503906, obj_val: 27.409330368041992, abs dis: 12.07750129699707
[rfa agg] iter:  9, weight: tensor([0.1394, 0.0749, 0.1076, 0.0748, 0.0918, 0.1082, 0.0696, 0.0682, 0.1947,
        0.0708])
___Test Target_ResNet_18 poisoned: False, epoch: 262: Average loss: 0.6294, Accuracy: 7949/10000 (79.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 262: Average loss: 5.7097, Accuracy: 569/9000 (6.3222%)
Done in 145.35029196739197 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:263 choose agents : [33, 50, 21, 14, 79, 18, 71, 99, 97, 72]. Adversary List: []
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 263, local model 33, internal_epoch   1,  Average loss: 0.0021, Accuracy: 518/527 (98.2922%)
___Train Local_ResNet_18,  epoch 263, local model 33, internal_epoch   2,  Average loss: 0.0075, Accuracy: 462/527 (87.6660%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 4.3726, Accuracy: 3206/10000 (32.0600%)
___Train Local_ResNet_18,  epoch 263, local model 50, internal_epoch   1,  Average loss: 0.0009, Accuracy: 398/401 (99.2519%)
___Train Local_ResNet_18,  epoch 263, local model 50, internal_epoch   2,  Average loss: 0.0004, Accuracy: 400/401 (99.7506%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 1.1841, Accuracy: 6762/10000 (67.6200%)
___Train Local_ResNet_18,  epoch 263, local model 21, internal_epoch   1,  Average loss: 0.0011, Accuracy: 262/262 (100.0000%)
___Train Local_ResNet_18,  epoch 263, local model 21, internal_epoch   2,  Average loss: 0.0015, Accuracy: 259/262 (98.8550%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 3.6860, Accuracy: 3797/10000 (37.9700%)
___Train Local_ResNet_18,  epoch 263, local model 14, internal_epoch   1,  Average loss: 0.0018, Accuracy: 314/318 (98.7421%)
___Train Local_ResNet_18,  epoch 263, local model 14, internal_epoch   2,  Average loss: 0.0005, Accuracy: 316/318 (99.3711%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 3.2090, Accuracy: 4504/10000 (45.0400%)
___Train Local_ResNet_18,  epoch 263, local model 79, internal_epoch   1,  Average loss: 0.0033, Accuracy: 143/154 (92.8571%)
___Train Local_ResNet_18,  epoch 263, local model 79, internal_epoch   2,  Average loss: 0.0004, Accuracy: 154/154 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 0.9806, Accuracy: 7129/10000 (71.2900%)
___Train Local_ResNet_18,  epoch 263, local model 18, internal_epoch   1,  Average loss: 0.0028, Accuracy: 384/386 (99.4819%)
___Train Local_ResNet_18,  epoch 263, local model 18, internal_epoch   2,  Average loss: 0.0093, Accuracy: 330/386 (85.4922%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 6.4684, Accuracy: 2432/10000 (24.3200%)
___Train Local_ResNet_18,  epoch 263, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 1103/1166 (94.5969%)
___Train Local_ResNet_18,  epoch 263, local model 71, internal_epoch   2,  Average loss: 0.0095, Accuracy: 952/1166 (81.6467%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 20.3490, Accuracy: 1605/10000 (16.0500%)
___Train Local_ResNet_18,  epoch 263, local model 99, internal_epoch   1,  Average loss: 0.0028, Accuracy: 371/391 (94.8849%)
___Train Local_ResNet_18,  epoch 263, local model 99, internal_epoch   2,  Average loss: 0.0011, Accuracy: 385/391 (98.4655%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 3.5364, Accuracy: 4058/10000 (40.5800%)
___Train Local_ResNet_18,  epoch 263, local model 97, internal_epoch   1,  Average loss: 0.0013, Accuracy: 410/418 (98.0861%)
___Train Local_ResNet_18,  epoch 263, local model 97, internal_epoch   2,  Average loss: 0.0006, Accuracy: 415/418 (99.2823%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 2.0014, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 263, local model 72, internal_epoch   1,  Average loss: 0.0069, Accuracy: 534/618 (86.4078%)
___Train Local_ResNet_18,  epoch 263, local model 72, internal_epoch   2,  Average loss: 0.0099, Accuracy: 504/618 (81.5534%)
___Test Local_ResNet_18 poisoned: False, epoch: 263: Average loss: 11.3581, Accuracy: 2841/10000 (28.4100%)
time spent on training: 76.80752611160278
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.11355311355311355  data num: [527, 401, 262, 318, 154, 386, 1166, 391, 418, 618]
[rfa agg] considering poison per batch poison_fraction: 0.008871336996336996
[rfa agg] init. name: [33, 50, 21, 14, 79, 18, 71, 99, 97, 72], weight: tensor([0.1136, 0.0864, 0.0565, 0.0685, 0.0332, 0.0832, 0.2512, 0.0842, 0.0901,
        0.1332])
[rfa agg] iter:  0, prev_obj_val: 38.652099609375, obj_val: 46.67497253417969, abs dis: 8.022872924804688
[rfa agg] iter:  0, weight: tensor([0.2196, 0.1261, 0.0379, 0.0460, 0.0144, 0.1024, 0.0567, 0.1183, 0.1299,
        0.1487])
[rfa agg] iter:  1, prev_obj_val: 46.67497253417969, obj_val: 53.50641632080078, abs dis: 6.831443786621094
[rfa agg] iter:  1, weight: tensor([0.0667, 0.1165, 0.1675, 0.1997, 0.0277, 0.0939, 0.0391, 0.1092, 0.1199,
        0.0598])
[rfa agg] iter:  2, prev_obj_val: 53.50641632080078, obj_val: 46.543235778808594, abs dis: 6.9631805419921875
[rfa agg] iter:  2, weight: tensor([0.0580, 0.0807, 0.2189, 0.2633, 0.0509, 0.0719, 0.0405, 0.0774, 0.0837,
        0.0549])
[rfa agg] iter:  3, prev_obj_val: 46.543235778808594, obj_val: 49.70184326171875, abs dis: 3.1586074829101562
[rfa agg] iter:  3, weight: tensor([0.0608, 0.1097, 0.1860, 0.2255, 0.0258, 0.0870, 0.0360, 0.1020, 0.1127,
        0.0546])
[rfa agg] iter:  4, prev_obj_val: 49.70184326171875, obj_val: 65.83036041259766, abs dis: 16.128517150878906
[rfa agg] iter:  4, weight: tensor([0.0442, 0.0685, 0.2725, 0.3246, 0.0263, 0.0586, 0.0286, 0.0650, 0.0708,
        0.0408])
[rfa agg] iter:  5, prev_obj_val: 65.83036041259766, obj_val: 61.638755798339844, abs dis: 4.1916046142578125
[rfa agg] iter:  5, weight: tensor([0.0613, 0.0708, 0.0919, 0.1116, 0.3442, 0.0658, 0.0512, 0.0685, 0.0736,
        0.0610])
[rfa agg] iter:  6, prev_obj_val: 61.638755798339844, obj_val: 46.553016662597656, abs dis: 15.085739135742188
[rfa agg] iter:  6, weight: tensor([0.0693, 0.0839, 0.1250, 0.1515, 0.2015, 0.0773, 0.0550, 0.0811, 0.0873,
        0.0681])
[rfa agg] iter:  7, prev_obj_val: 46.553016662597656, obj_val: 49.7037353515625, abs dis: 3.1507186889648438
[rfa agg] iter:  7, weight: tensor([0.0620, 0.1115, 0.1819, 0.2189, 0.0263, 0.0887, 0.0367, 0.1039, 0.1145,
        0.0557])
[rfa agg] iter:  8, prev_obj_val: 49.7037353515625, obj_val: 65.83007049560547, abs dis: 16.12633514404297
[rfa agg] iter:  8, weight: tensor([0.0445, 0.0689, 0.2718, 0.3228, 0.0265, 0.0590, 0.0288, 0.0654, 0.0712,
        0.0411])
[rfa agg] iter:  9, prev_obj_val: 65.83007049560547, obj_val: 61.63875198364258, abs dis: 4.191318511962891
[rfa agg] iter:  9, weight: tensor([0.0613, 0.0708, 0.0919, 0.1116, 0.3442, 0.0658, 0.0513, 0.0685, 0.0736,
        0.0610])
___Test Target_ResNet_18 poisoned: False, epoch: 263: Average loss: 0.6320, Accuracy: 7936/10000 (79.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 263: Average loss: 5.8127, Accuracy: 503/9000 (5.5889%)
Done in 151.3479359149933 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:264 choose agents : [42, 71, 89, 16, 50, 15, 3, 85, 25, 38]. Adversary List: []
___Train Local_ResNet_18,  epoch 264, local model 42, internal_epoch   1,  Average loss: 0.0020, Accuracy: 197/198 (99.4949%)
___Train Local_ResNet_18,  epoch 264, local model 42, internal_epoch   2,  Average loss: 0.0012, Accuracy: 196/198 (98.9899%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 2.3010, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 264, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1137/1166 (97.5129%)
___Train Local_ResNet_18,  epoch 264, local model 71, internal_epoch   2,  Average loss: 0.0065, Accuracy: 1013/1166 (86.8782%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 11.0909, Accuracy: 2066/10000 (20.6600%)
___Train Local_ResNet_18,  epoch 264, local model 89, internal_epoch   1,  Average loss: 0.0027, Accuracy: 394/413 (95.3995%)
___Train Local_ResNet_18,  epoch 264, local model 89, internal_epoch   2,  Average loss: 0.0025, Accuracy: 399/413 (96.6102%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 2.8029, Accuracy: 4104/10000 (41.0400%)
___Train Local_ResNet_18,  epoch 264, local model 16, internal_epoch   1,  Average loss: 0.0015, Accuracy: 761/773 (98.4476%)
___Train Local_ResNet_18,  epoch 264, local model 16, internal_epoch   2,  Average loss: 0.0062, Accuracy: 693/773 (89.6507%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 6.0359, Accuracy: 3089/10000 (30.8900%)
___Train Local_ResNet_18,  epoch 264, local model 50, internal_epoch   1,  Average loss: 0.0008, Accuracy: 400/401 (99.7506%)
___Train Local_ResNet_18,  epoch 264, local model 50, internal_epoch   2,  Average loss: 0.0003, Accuracy: 400/401 (99.7506%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 0.9179, Accuracy: 7253/10000 (72.5300%)
___Train Local_ResNet_18,  epoch 264, local model 15, internal_epoch   1,  Average loss: 0.0024, Accuracy: 331/341 (97.0674%)
___Train Local_ResNet_18,  epoch 264, local model 15, internal_epoch   2,  Average loss: 0.0022, Accuracy: 332/341 (97.3607%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 4.4512, Accuracy: 3417/10000 (34.1700%)
___Train Local_ResNet_18,  epoch 264, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 722/780 (92.5641%)
___Train Local_ResNet_18,  epoch 264, local model 3, internal_epoch   2,  Average loss: 0.0152, Accuracy: 601/780 (77.0513%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 122.1292, Accuracy: 1005/10000 (10.0500%)
___Train Local_ResNet_18,  epoch 264, local model 85, internal_epoch   1,  Average loss: 0.0015, Accuracy: 361/364 (99.1758%)
___Train Local_ResNet_18,  epoch 264, local model 85, internal_epoch   2,  Average loss: 0.0007, Accuracy: 361/364 (99.1758%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 1.4048, Accuracy: 6243/10000 (62.4300%)
___Train Local_ResNet_18,  epoch 264, local model 25, internal_epoch   1,  Average loss: 0.0018, Accuracy: 528/545 (96.8807%)
___Train Local_ResNet_18,  epoch 264, local model 25, internal_epoch   2,  Average loss: 0.0016, Accuracy: 526/545 (96.5138%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 2.9235, Accuracy: 4107/10000 (41.0700%)
___Train Local_ResNet_18,  epoch 264, local model 38, internal_epoch   1,  Average loss: 0.0014, Accuracy: 736/756 (97.3545%)
___Train Local_ResNet_18,  epoch 264, local model 38, internal_epoch   2,  Average loss: 0.0027, Accuracy: 711/756 (94.0476%)
___Test Local_ResNet_18 poisoned: False, epoch: 264: Average loss: 2.5927, Accuracy: 4770/10000 (47.7000%)
time spent on training: 66.95224404335022
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [198, 1166, 413, 773, 401, 341, 780, 364, 545, 756]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 71, 89, 16, 50, 15, 3, 85, 25, 38], weight: tensor([0.0345, 0.2032, 0.0720, 0.1347, 0.0699, 0.0594, 0.1360, 0.0634, 0.0950,
        0.1318])
[rfa agg] iter:  0, prev_obj_val: 40.76451873779297, obj_val: 45.56874465942383, abs dis: 4.804225921630859
[rfa agg] iter:  0, weight: tensor([0.0192, 0.0565, 0.0938, 0.0905, 0.0944, 0.0542, 0.0864, 0.0581, 0.3295,
        0.1174])
[rfa agg] iter:  1, prev_obj_val: 45.56874465942383, obj_val: 50.31533432006836, abs dis: 4.746589660644531
[rfa agg] iter:  1, weight: tensor([0.0227, 0.0407, 0.1957, 0.0556, 0.2469, 0.0856, 0.0542, 0.0934, 0.1384,
        0.0668])
[rfa agg] iter:  2, prev_obj_val: 50.31533432006836, obj_val: 53.49673843383789, abs dis: 3.1814041137695312
[rfa agg] iter:  2, weight: tensor([0.0258, 0.0307, 0.1799, 0.0388, 0.2267, 0.1578, 0.0380, 0.1871, 0.0701,
        0.0450])
[rfa agg] iter:  3, prev_obj_val: 53.49673843383789, obj_val: 69.6255874633789, abs dis: 16.128849029541016
[rfa agg] iter:  3, weight: tensor([0.0301, 0.0277, 0.1116, 0.0339, 0.1204, 0.2306, 0.0333, 0.3182, 0.0552,
        0.0388])
[rfa agg] iter:  4, prev_obj_val: 69.6255874633789, obj_val: 57.308753967285156, abs dis: 12.31683349609375
[rfa agg] iter:  4, weight: tensor([0.2848, 0.0520, 0.0907, 0.0572, 0.0895, 0.1122, 0.0568, 0.1210, 0.0726,
        0.0632])
[rfa agg] iter:  5, prev_obj_val: 57.308753967285156, obj_val: 53.48554992675781, abs dis: 3.8232040405273438
[rfa agg] iter:  5, weight: tensor([0.0571, 0.0382, 0.1126, 0.0453, 0.1162, 0.2138, 0.0447, 0.2529, 0.0680,
        0.0513])
[rfa agg] iter:  6, prev_obj_val: 53.48554992675781, obj_val: 69.6270523071289, abs dis: 16.141502380371094
[rfa agg] iter:  6, weight: tensor([0.0293, 0.0270, 0.1063, 0.0330, 0.1165, 0.2366, 0.0325, 0.3271, 0.0538,
        0.0378])
[rfa agg] iter:  7, prev_obj_val: 69.6270523071289, obj_val: 57.30870056152344, abs dis: 12.318351745605469
[rfa agg] iter:  7, weight: tensor([0.2844, 0.0520, 0.0907, 0.0572, 0.0895, 0.1123, 0.0569, 0.1211, 0.0727,
        0.0632])
[rfa agg] iter:  8, prev_obj_val: 57.30870056152344, obj_val: 53.48554992675781, abs dis: 3.823150634765625
[rfa agg] iter:  8, weight: tensor([0.0571, 0.0382, 0.1126, 0.0453, 0.1162, 0.2138, 0.0447, 0.2529, 0.0680,
        0.0513])
[rfa agg] iter:  9, prev_obj_val: 53.48554992675781, obj_val: 69.6270523071289, abs dis: 16.141502380371094
[rfa agg] iter:  9, weight: tensor([0.0293, 0.0270, 0.1063, 0.0330, 0.1165, 0.2366, 0.0325, 0.3271, 0.0538,
        0.0378])
___Test Target_ResNet_18 poisoned: False, epoch: 264: Average loss: 0.6385, Accuracy: 7914/10000 (79.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 264: Average loss: 5.7666, Accuracy: 518/9000 (5.7556%)
Done in 141.37873244285583 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:265 choose agents : [60, 76, 30, 77, 54, 52, 84, 88, 82, 96]. Adversary List: []
___Train Local_ResNet_18,  epoch 265, local model 60, internal_epoch   1,  Average loss: 0.0008, Accuracy: 283/284 (99.6479%)
___Train Local_ResNet_18,  epoch 265, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 284/284 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 0.8382, Accuracy: 7457/10000 (74.5700%)
___Train Local_ResNet_18,  epoch 265, local model 76, internal_epoch   1,  Average loss: 0.0274, Accuracy: 64/65 (98.4615%)
___Train Local_ResNet_18,  epoch 265, local model 76, internal_epoch   2,  Average loss: 0.0033, Accuracy: 65/65 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 1.2856, Accuracy: 6493/10000 (64.9300%)
___Train Local_ResNet_18,  epoch 265, local model 30, internal_epoch   1,  Average loss: 0.0017, Accuracy: 335/337 (99.4065%)
___Train Local_ResNet_18,  epoch 265, local model 30, internal_epoch   2,  Average loss: 0.0012, Accuracy: 330/337 (97.9228%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 2.1266, Accuracy: 4919/10000 (49.1900%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 265, local model 77, internal_epoch   1,  Average loss: 0.0007, Accuracy: 494/496 (99.5968%)
___Train Local_ResNet_18,  epoch 265, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 496/496 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 0.9279, Accuracy: 7364/10000 (73.6400%)
___Train Local_ResNet_18,  epoch 265, local model 54, internal_epoch   1,  Average loss: 0.0020, Accuracy: 427/440 (97.0455%)
___Train Local_ResNet_18,  epoch 265, local model 54, internal_epoch   2,  Average loss: 0.0007, Accuracy: 436/440 (99.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 3.0903, Accuracy: 4555/10000 (45.5500%)
___Train Local_ResNet_18,  epoch 265, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 210/214 (98.1308%)
___Train Local_ResNet_18,  epoch 265, local model 52, internal_epoch   2,  Average loss: 0.0013, Accuracy: 211/214 (98.5981%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 2.8802, Accuracy: 4637/10000 (46.3700%)
___Train Local_ResNet_18,  epoch 265, local model 84, internal_epoch   1,  Average loss: 0.0020, Accuracy: 1014/1053 (96.2963%)
___Train Local_ResNet_18,  epoch 265, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 968/1053 (91.9278%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 3.3621, Accuracy: 4086/10000 (40.8600%)
___Train Local_ResNet_18,  epoch 265, local model 88, internal_epoch   1,  Average loss: 0.0032, Accuracy: 424/447 (94.8546%)
___Train Local_ResNet_18,  epoch 265, local model 88, internal_epoch   2,  Average loss: 0.0022, Accuracy: 430/447 (96.1969%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 5.2845, Accuracy: 3235/10000 (32.3500%)
___Train Local_ResNet_18,  epoch 265, local model 82, internal_epoch   1,  Average loss: 0.0011, Accuracy: 595/601 (99.0017%)
___Train Local_ResNet_18,  epoch 265, local model 82, internal_epoch   2,  Average loss: 0.0012, Accuracy: 589/601 (98.0033%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 1.7415, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 265, local model 96, internal_epoch   1,  Average loss: 0.0012, Accuracy: 694/708 (98.0226%)
___Train Local_ResNet_18,  epoch 265, local model 96, internal_epoch   2,  Average loss: 0.0027, Accuracy: 681/708 (96.1864%)
___Test Local_ResNet_18 poisoned: False, epoch: 265: Average loss: 4.2505, Accuracy: 3885/10000 (38.8500%)
time spent on training: 72.46472239494324
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10678148546824542  data num: [284, 65, 337, 496, 440, 214, 1053, 447, 601, 708]
[rfa agg] considering poison per batch poison_fraction: 0.008342303552206673
[rfa agg] init. name: [60, 76, 30, 77, 54, 52, 84, 88, 82, 96], weight: tensor([0.0611, 0.0140, 0.0726, 0.1068, 0.0947, 0.0461, 0.2267, 0.0962, 0.1294,
        0.1524])
[rfa agg] iter:  0, prev_obj_val: 35.15342712402344, obj_val: 44.573646545410156, abs dis: 9.420219421386719
[rfa agg] iter:  0, weight: tensor([0.0409, 0.0043, 0.0771, 0.2801, 0.2095, 0.0221, 0.0401, 0.1844, 0.0849,
        0.0565])
[rfa agg] iter:  1, prev_obj_val: 44.573646545410156, obj_val: 47.94502258300781, abs dis: 3.3713760375976562
[rfa agg] iter:  1, weight: tensor([0.2235, 0.0082, 0.2235, 0.0877, 0.1251, 0.0614, 0.0405, 0.1232, 0.0589,
        0.0481])
[rfa agg] iter:  2, prev_obj_val: 47.94502258300781, obj_val: 55.74057388305664, abs dis: 7.795551300048828
[rfa agg] iter:  2, weight: tensor([0.4769, 0.0079, 0.1152, 0.0599, 0.0779, 0.0730, 0.0318, 0.0776, 0.0434,
        0.0366])
[rfa agg] iter:  3, prev_obj_val: 55.74057388305664, obj_val: 47.96073913574219, abs dis: 7.779834747314453
[rfa agg] iter:  3, weight: tensor([0.1591, 0.0182, 0.0934, 0.0700, 0.0819, 0.3434, 0.0456, 0.0823, 0.0564,
        0.0498])
[rfa agg] iter:  4, prev_obj_val: 47.96073913574219, obj_val: 55.740013122558594, abs dis: 7.779273986816406
[rfa agg] iter:  4, weight: tensor([0.4730, 0.0079, 0.1135, 0.0605, 0.0784, 0.0761, 0.0321, 0.0778, 0.0438,
        0.0369])
[rfa agg] iter:  5, prev_obj_val: 55.740013122558594, obj_val: 47.96087646484375, abs dis: 7.779136657714844
[rfa agg] iter:  5, weight: tensor([0.1589, 0.0182, 0.0933, 0.0699, 0.0818, 0.3441, 0.0456, 0.0822, 0.0563,
        0.0498])
[rfa agg] iter:  6, prev_obj_val: 47.96087646484375, obj_val: 55.74000549316406, abs dis: 7.7791290283203125
[rfa agg] iter:  6, weight: tensor([0.4728, 0.0079, 0.1136, 0.0605, 0.0784, 0.0761, 0.0321, 0.0778, 0.0439,
        0.0369])
[rfa agg] iter:  7, prev_obj_val: 55.74000549316406, obj_val: 47.96087646484375, abs dis: 7.7791290283203125
[rfa agg] iter:  7, weight: tensor([0.1589, 0.0182, 0.0933, 0.0699, 0.0818, 0.3441, 0.0456, 0.0822, 0.0563,
        0.0498])
[rfa agg] iter:  8, prev_obj_val: 47.96087646484375, obj_val: 55.74000549316406, abs dis: 7.7791290283203125
[rfa agg] iter:  8, weight: tensor([0.4728, 0.0079, 0.1136, 0.0605, 0.0784, 0.0761, 0.0321, 0.0778, 0.0439,
        0.0369])
[rfa agg] iter:  9, prev_obj_val: 55.74000549316406, obj_val: 47.96087646484375, abs dis: 7.7791290283203125
[rfa agg] iter:  9, weight: tensor([0.1589, 0.0182, 0.0933, 0.0699, 0.0818, 0.3441, 0.0456, 0.0822, 0.0563,
        0.0498])
___Test Target_ResNet_18 poisoned: False, epoch: 265: Average loss: 0.6372, Accuracy: 7917/10000 (79.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 265: Average loss: 5.8276, Accuracy: 488/9000 (5.4222%)
Done in 144.22121787071228 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:266 choose agents : [84, 78, 54, 95, 6, 36, 46, 81, 13, 55]. Adversary List: []
___Train Local_ResNet_18,  epoch 266, local model 84, internal_epoch   1,  Average loss: 0.0020, Accuracy: 1022/1053 (97.0560%)
___Train Local_ResNet_18,  epoch 266, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 941/1053 (89.3637%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 3.6578, Accuracy: 4019/10000 (40.1900%)
___Train Local_ResNet_18,  epoch 266, local model 78, internal_epoch   1,  Average loss: 0.0021, Accuracy: 245/255 (96.0784%)
___Train Local_ResNet_18,  epoch 266, local model 78, internal_epoch   2,  Average loss: 0.0007, Accuracy: 254/255 (99.6078%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 2.4053, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch 266, local model 54, internal_epoch   1,  Average loss: 0.0014, Accuracy: 433/440 (98.4091%)
___Train Local_ResNet_18,  epoch 266, local model 54, internal_epoch   2,  Average loss: 0.0008, Accuracy: 433/440 (98.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 2.1001, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 266, local model 95, internal_epoch   1,  Average loss: 0.0042, Accuracy: 522/569 (91.7399%)
___Train Local_ResNet_18,  epoch 266, local model 95, internal_epoch   2,  Average loss: 0.0046, Accuracy: 517/569 (90.8612%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 5.9676, Accuracy: 2701/10000 (27.0100%)
___Train Local_ResNet_18,  epoch 266, local model 6, internal_epoch   1,  Average loss: 0.0022, Accuracy: 498/520 (95.7692%)
___Train Local_ResNet_18,  epoch 266, local model 6, internal_epoch   2,  Average loss: 0.0078, Accuracy: 471/520 (90.5769%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 8.2677, Accuracy: 2058/10000 (20.5800%)
___Train Local_ResNet_18,  epoch 266, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 810/849 (95.4064%)
___Train Local_ResNet_18,  epoch 266, local model 36, internal_epoch   2,  Average loss: 0.0083, Accuracy: 704/849 (82.9211%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 6.3291, Accuracy: 3399/10000 (33.9900%)
___Train Local_ResNet_18,  epoch 266, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 598/601 (99.5008%)
___Train Local_ResNet_18,  epoch 266, local model 46, internal_epoch   2,  Average loss: 0.0004, Accuracy: 597/601 (99.3344%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 1.3505, Accuracy: 6401/10000 (64.0100%)
___Train Local_ResNet_18,  epoch 266, local model 81, internal_epoch   1,  Average loss: 0.0055, Accuracy: 941/1034 (91.0058%)
___Train Local_ResNet_18,  epoch 266, local model 81, internal_epoch   2,  Average loss: 0.0146, Accuracy: 751/1034 (72.6306%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 57.9373, Accuracy: 1056/10000 (10.5600%)
___Train Local_ResNet_18,  epoch 266, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 589/620 (95.0000%)
___Train Local_ResNet_18,  epoch 266, local model 13, internal_epoch   2,  Average loss: 0.0035, Accuracy: 578/620 (93.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 5.3016, Accuracy: 3154/10000 (31.5400%)
___Train Local_ResNet_18,  epoch 266, local model 55, internal_epoch   1,  Average loss: 0.0018, Accuracy: 295/299 (98.6622%)
___Train Local_ResNet_18,  epoch 266, local model 55, internal_epoch   2,  Average loss: 0.0004, Accuracy: 298/299 (99.6656%)
___Test Local_ResNet_18 poisoned: False, epoch: 266: Average loss: 5.9157, Accuracy: 2898/10000 (28.9800%)
time spent on training: 68.28959584236145
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [1053, 255, 440, 569, 520, 849, 601, 1034, 620, 299]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 78, 54, 95, 6, 36, 46, 81, 13, 55], weight: tensor([0.1688, 0.0409, 0.0705, 0.0912, 0.0833, 0.1361, 0.0963, 0.1657, 0.0994,
        0.0479])
[rfa agg] iter:  0, prev_obj_val: 42.154422760009766, obj_val: 47.36421585083008, abs dis: 5.2097930908203125
[rfa agg] iter:  0, weight: tensor([0.0519, 0.0237, 0.1120, 0.1889, 0.1773, 0.0633, 0.1543, 0.0497, 0.1433,
        0.0355])
[rfa agg] iter:  1, prev_obj_val: 47.36421585083008, obj_val: 50.39381790161133, abs dis: 3.02960205078125
[rfa agg] iter:  1, weight: tensor([0.0498, 0.0327, 0.2687, 0.1445, 0.1332, 0.0578, 0.1070, 0.0476, 0.1056,
        0.0531])
[rfa agg] iter:  2, prev_obj_val: 50.39381790161133, obj_val: 57.33015441894531, abs dis: 6.936336517333984
[rfa agg] iter:  2, weight: tensor([0.0432, 0.0348, 0.4063, 0.1050, 0.0966, 0.0491, 0.0818, 0.0414, 0.0816,
        0.0601])
[rfa agg] iter:  3, prev_obj_val: 57.33015441894531, obj_val: 60.9308967590332, abs dis: 3.6007423400878906
[rfa agg] iter:  3, weight: tensor([0.0545, 0.0716, 0.2374, 0.1025, 0.0941, 0.0598, 0.0855, 0.0524, 0.0865,
        0.1557])
[rfa agg] iter:  4, prev_obj_val: 60.9308967590332, obj_val: 60.92640686035156, abs dis: 0.004489898681640625
[rfa agg] iter:  4, weight: tensor([0.0521, 0.0941, 0.1613, 0.0891, 0.0817, 0.0564, 0.0761, 0.0502, 0.0772,
        0.2617])
___Test Target_ResNet_18 poisoned: False, epoch: 266: Average loss: 0.6310, Accuracy: 7951/10000 (79.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 266: Average loss: 5.9053, Accuracy: 477/9000 (5.3000%)
Done in 129.71778869628906 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:267 choose agents : [67, 80, 33, 13, 16, 30, 47, 50, 87, 61]. Adversary List: []
___Train Local_ResNet_18,  epoch 267, local model 67, internal_epoch   1,  Average loss: 0.0019, Accuracy: 808/842 (95.9620%)
___Train Local_ResNet_18,  epoch 267, local model 67, internal_epoch   2,  Average loss: 0.0081, Accuracy: 721/842 (85.6295%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 8.6334, Accuracy: 2572/10000 (25.7200%)
___Train Local_ResNet_18,  epoch 267, local model 80, internal_epoch   1,  Average loss: 0.0015, Accuracy: 360/363 (99.1736%)
___Train Local_ResNet_18,  epoch 267, local model 80, internal_epoch   2,  Average loss: 0.0005, Accuracy: 361/363 (99.4490%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 2.4350, Accuracy: 5401/10000 (54.0100%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 267, local model 33, internal_epoch   1,  Average loss: 0.0023, Accuracy: 506/527 (96.0152%)
___Train Local_ResNet_18,  epoch 267, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 487/527 (92.4099%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 4.7420, Accuracy: 3836/10000 (38.3600%)
___Train Local_ResNet_18,  epoch 267, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 577/620 (93.0645%)
___Train Local_ResNet_18,  epoch 267, local model 13, internal_epoch   2,  Average loss: 0.0026, Accuracy: 588/620 (94.8387%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 4.6649, Accuracy: 3546/10000 (35.4600%)
___Train Local_ResNet_18,  epoch 267, local model 16, internal_epoch   1,  Average loss: 0.0014, Accuracy: 764/773 (98.8357%)
___Train Local_ResNet_18,  epoch 267, local model 16, internal_epoch   2,  Average loss: 0.0064, Accuracy: 698/773 (90.2975%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 5.7211, Accuracy: 2317/10000 (23.1700%)
___Train Local_ResNet_18,  epoch 267, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 336/337 (99.7033%)
___Train Local_ResNet_18,  epoch 267, local model 30, internal_epoch   2,  Average loss: 0.0008, Accuracy: 334/337 (99.1098%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 1.3038, Accuracy: 6537/10000 (65.3700%)
___Train Local_ResNet_18,  epoch 267, local model 47, internal_epoch   1,  Average loss: 0.0014, Accuracy: 645/654 (98.6239%)
___Train Local_ResNet_18,  epoch 267, local model 47, internal_epoch   2,  Average loss: 0.0023, Accuracy: 634/654 (96.9419%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 1.6047, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18,  epoch 267, local model 50, internal_epoch   1,  Average loss: 0.0007, Accuracy: 401/401 (100.0000%)
___Train Local_ResNet_18,  epoch 267, local model 50, internal_epoch   2,  Average loss: 0.0003, Accuracy: 400/401 (99.7506%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 1.0155, Accuracy: 7128/10000 (71.2800%)
___Train Local_ResNet_18,  epoch 267, local model 87, internal_epoch   1,  Average loss: 0.0034, Accuracy: 376/397 (94.7103%)
___Train Local_ResNet_18,  epoch 267, local model 87, internal_epoch   2,  Average loss: 0.0030, Accuracy: 386/397 (97.2292%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 6.1018, Accuracy: 2784/10000 (27.8400%)
___Train Local_ResNet_18,  epoch 267, local model 61, internal_epoch   1,  Average loss: 0.0027, Accuracy: 566/590 (95.9322%)
___Train Local_ResNet_18,  epoch 267, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 555/590 (94.0678%)
___Test Local_ResNet_18 poisoned: False, epoch: 267: Average loss: 4.3318, Accuracy: 3050/10000 (30.5000%)
time spent on training: 71.76470136642456
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.09574854651162791  data num: [842, 363, 527, 620, 773, 337, 654, 401, 397, 590]
[rfa agg] considering poison per batch poison_fraction: 0.00748035519622093
[rfa agg] init. name: [67, 80, 33, 13, 16, 30, 47, 50, 87, 61], weight: tensor([0.1530, 0.0660, 0.0957, 0.1126, 0.1404, 0.0612, 0.1188, 0.0729, 0.0721,
        0.1072])
[rfa agg] iter:  0, prev_obj_val: 27.508758544921875, obj_val: 38.09962844848633, abs dis: 10.590869903564453
[rfa agg] iter:  0, weight: tensor([0.0558, 0.0719, 0.1598, 0.1132, 0.0614, 0.0667, 0.0859, 0.1509, 0.1269,
        0.1074])
[rfa agg] iter:  1, prev_obj_val: 38.09962844848633, obj_val: 55.271358489990234, abs dis: 17.171730041503906
[rfa agg] iter:  1, weight: tensor([0.0322, 0.2758, 0.0528, 0.0469, 0.0339, 0.2548, 0.0402, 0.1183, 0.1006,
        0.0446])
[rfa agg] iter:  2, prev_obj_val: 55.271358489990234, obj_val: 46.45988845825195, abs dis: 8.811470031738281
[rfa agg] iter:  2, weight: tensor([0.0711, 0.1532, 0.0885, 0.0870, 0.0726, 0.1422, 0.0792, 0.1136, 0.1100,
        0.0827])
[rfa agg] iter:  3, prev_obj_val: 46.45988845825195, obj_val: 38.02604675292969, abs dis: 8.433841705322266
[rfa agg] iter:  3, weight: tensor([0.0542, 0.2001, 0.0755, 0.0714, 0.0561, 0.1854, 0.0634, 0.1162, 0.1097,
        0.0679])
[rfa agg] iter:  4, prev_obj_val: 38.02604675292969, obj_val: 55.274993896484375, abs dis: 17.248947143554688
[rfa agg] iter:  4, weight: tensor([0.0288, 0.3023, 0.0469, 0.0418, 0.0303, 0.2769, 0.0359, 0.1070, 0.0904,
        0.0398])
[rfa agg] iter:  5, prev_obj_val: 55.274993896484375, obj_val: 46.459877014160156, abs dis: 8.815116882324219
[rfa agg] iter:  5, weight: tensor([0.0711, 0.1533, 0.0885, 0.0869, 0.0726, 0.1422, 0.0792, 0.1135, 0.1099,
        0.0827])
[rfa agg] iter:  6, prev_obj_val: 46.459877014160156, obj_val: 38.02604675292969, abs dis: 8.433830261230469
[rfa agg] iter:  6, weight: tensor([0.0542, 0.2001, 0.0755, 0.0714, 0.0561, 0.1854, 0.0634, 0.1162, 0.1097,
        0.0679])
[rfa agg] iter:  7, prev_obj_val: 38.02604675292969, obj_val: 55.274993896484375, abs dis: 17.248947143554688
[rfa agg] iter:  7, weight: tensor([0.0288, 0.3023, 0.0469, 0.0418, 0.0303, 0.2769, 0.0359, 0.1070, 0.0904,
        0.0398])
[rfa agg] iter:  8, prev_obj_val: 55.274993896484375, obj_val: 46.459877014160156, abs dis: 8.815116882324219
[rfa agg] iter:  8, weight: tensor([0.0711, 0.1533, 0.0885, 0.0869, 0.0726, 0.1422, 0.0792, 0.1135, 0.1099,
        0.0827])
[rfa agg] iter:  9, prev_obj_val: 46.459877014160156, obj_val: 38.02604675292969, abs dis: 8.433830261230469
[rfa agg] iter:  9, weight: tensor([0.0542, 0.2001, 0.0755, 0.0714, 0.0561, 0.1854, 0.0634, 0.1162, 0.1097,
        0.0679])
___Test Target_ResNet_18 poisoned: False, epoch: 267: Average loss: 0.6279, Accuracy: 7960/10000 (79.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 267: Average loss: 5.9266, Accuracy: 500/9000 (5.5556%)
Done in 146.5380663871765 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:268 choose agents : [42, 8, 37, 58, 30, 34, 82, 0, 53, 74]. Adversary List: []
___Train Local_ResNet_18,  epoch 268, local model 42, internal_epoch   1,  Average loss: 0.0030, Accuracy: 194/198 (97.9798%)
___Train Local_ResNet_18,  epoch 268, local model 42, internal_epoch   2,  Average loss: 0.0210, Accuracy: 183/198 (92.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 5.4251, Accuracy: 2827/10000 (28.2700%)
___Train Local_ResNet_18,  epoch 268, local model 8, internal_epoch   1,  Average loss: 0.0007, Accuracy: 531/534 (99.4382%)
___Train Local_ResNet_18,  epoch 268, local model 8, internal_epoch   2,  Average loss: 0.0002, Accuracy: 533/534 (99.8127%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 1.2947, Accuracy: 6439/10000 (64.3900%)
___Train Local_ResNet_18,  epoch 268, local model 37, internal_epoch   1,  Average loss: 0.0030, Accuracy: 682/725 (94.0690%)
___Train Local_ResNet_18,  epoch 268, local model 37, internal_epoch   2,  Average loss: 0.0075, Accuracy: 627/725 (86.4828%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 7.1934, Accuracy: 2198/10000 (21.9800%)
___Train Local_ResNet_18,  epoch 268, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 217/234 (92.7350%)
___Train Local_ResNet_18,  epoch 268, local model 58, internal_epoch   2,  Average loss: 0.0007, Accuracy: 232/234 (99.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 4.3065, Accuracy: 3000/10000 (30.0000%)
___Train Local_ResNet_18,  epoch 268, local model 30, internal_epoch   1,  Average loss: 0.0009, Accuracy: 337/337 (100.0000%)
___Train Local_ResNet_18,  epoch 268, local model 30, internal_epoch   2,  Average loss: 0.0006, Accuracy: 336/337 (99.7033%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 1.1825, Accuracy: 6907/10000 (69.0700%)
___Train Local_ResNet_18,  epoch 268, local model 34, internal_epoch   1,  Average loss: 0.0017, Accuracy: 344/349 (98.5673%)
___Train Local_ResNet_18,  epoch 268, local model 34, internal_epoch   2,  Average loss: 0.0008, Accuracy: 347/349 (99.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 3.0095, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 268, local model 82, internal_epoch   1,  Average loss: 0.0009, Accuracy: 596/601 (99.1681%)
___Train Local_ResNet_18,  epoch 268, local model 82, internal_epoch   2,  Average loss: 0.0007, Accuracy: 596/601 (99.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 1.7134, Accuracy: 5918/10000 (59.1800%)
___Train Local_ResNet_18,  epoch 268, local model 0, internal_epoch   1,  Average loss: 0.0008, Accuracy: 367/367 (100.0000%)
___Train Local_ResNet_18,  epoch 268, local model 0, internal_epoch   2,  Average loss: 0.0002, Accuracy: 367/367 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 1.3237, Accuracy: 6704/10000 (67.0400%)
___Train Local_ResNet_18,  epoch 268, local model 53, internal_epoch   1,  Average loss: 0.0018, Accuracy: 605/625 (96.8000%)
___Train Local_ResNet_18,  epoch 268, local model 53, internal_epoch   2,  Average loss: 0.0027, Accuracy: 590/625 (94.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 2.1437, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 268, local model 74, internal_epoch   1,  Average loss: 0.0026, Accuracy: 454/469 (96.8017%)
___Train Local_ResNet_18,  epoch 268, local model 74, internal_epoch   2,  Average loss: 0.0010, Accuracy: 464/469 (98.9339%)
___Test Local_ResNet_18 poisoned: False, epoch: 268: Average loss: 1.7679, Accuracy: 5452/10000 (54.5200%)
time spent on training: 65.09623956680298
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [198, 534, 725, 234, 337, 349, 601, 367, 625, 469]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [42, 8, 37, 58, 30, 34, 82, 0, 53, 74], weight: tensor([0.0446, 0.1203, 0.1633, 0.0527, 0.0759, 0.0786, 0.1354, 0.0827, 0.1408,
        0.1057])
[rfa agg] iter:  0, prev_obj_val: 33.31732940673828, obj_val: 36.85625076293945, abs dis: 3.538921356201172
[rfa agg] iter:  0, weight: tensor([0.0833, 0.0666, 0.0512, 0.1079, 0.1594, 0.1584, 0.0599, 0.1745, 0.0620,
        0.0768])
[rfa agg] iter:  1, prev_obj_val: 36.85625076293945, obj_val: 33.25130081176758, abs dis: 3.604949951171875
[rfa agg] iter:  1, weight: tensor([0.1360, 0.0621, 0.0499, 0.2036, 0.1165, 0.1188, 0.0572, 0.1273, 0.0591,
        0.0694])
[rfa agg] iter:  2, prev_obj_val: 33.25130081176758, obj_val: 36.856056213378906, abs dis: 3.604755401611328
[rfa agg] iter:  2, weight: tensor([0.0853, 0.0653, 0.0499, 0.1097, 0.1602, 0.1597, 0.0587, 0.1754, 0.0606,
        0.0753])
[rfa agg] iter:  3, prev_obj_val: 36.856056213378906, obj_val: 33.25132369995117, abs dis: 3.6047325134277344
[rfa agg] iter:  3, weight: tensor([0.1362, 0.0621, 0.0499, 0.2037, 0.1165, 0.1188, 0.0571, 0.1272, 0.0591,
        0.0694])
[rfa agg] iter:  4, prev_obj_val: 33.25132369995117, obj_val: 36.85605239868164, abs dis: 3.6047286987304688
[rfa agg] iter:  4, weight: tensor([0.0853, 0.0653, 0.0499, 0.1097, 0.1602, 0.1597, 0.0587, 0.1754, 0.0606,
        0.0753])
[rfa agg] iter:  5, prev_obj_val: 36.85605239868164, obj_val: 33.25132369995117, abs dis: 3.6047286987304688
[rfa agg] iter:  5, weight: tensor([0.1362, 0.0621, 0.0499, 0.2037, 0.1165, 0.1188, 0.0571, 0.1272, 0.0591,
        0.0694])
[rfa agg] iter:  6, prev_obj_val: 33.25132369995117, obj_val: 36.85605239868164, abs dis: 3.6047286987304688
[rfa agg] iter:  6, weight: tensor([0.0853, 0.0653, 0.0499, 0.1097, 0.1602, 0.1597, 0.0587, 0.1754, 0.0606,
        0.0753])
[rfa agg] iter:  7, prev_obj_val: 36.85605239868164, obj_val: 33.25132369995117, abs dis: 3.6047286987304688
[rfa agg] iter:  7, weight: tensor([0.1362, 0.0621, 0.0499, 0.2037, 0.1165, 0.1188, 0.0571, 0.1272, 0.0591,
        0.0694])
[rfa agg] iter:  8, prev_obj_val: 33.25132369995117, obj_val: 36.85605239868164, abs dis: 3.6047286987304688
[rfa agg] iter:  8, weight: tensor([0.0853, 0.0653, 0.0499, 0.1097, 0.1602, 0.1597, 0.0587, 0.1754, 0.0606,
        0.0753])
[rfa agg] iter:  9, prev_obj_val: 36.85605239868164, obj_val: 33.25132369995117, abs dis: 3.6047286987304688
[rfa agg] iter:  9, weight: tensor([0.1362, 0.0621, 0.0499, 0.2037, 0.1165, 0.1188, 0.0571, 0.1272, 0.0591,
        0.0694])
___Test Target_ResNet_18 poisoned: False, epoch: 268: Average loss: 0.6232, Accuracy: 7968/10000 (79.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 268: Average loss: 5.9091, Accuracy: 540/9000 (6.0000%)
Done in 141.85985350608826 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:269 choose agents : [63, 59, 29, 16, 50, 97, 34, 65, 4, 86]. Adversary List: []
___Train Local_ResNet_18,  epoch 269, local model 63, internal_epoch   1,  Average loss: 0.0007, Accuracy: 748/752 (99.4681%)
___Train Local_ResNet_18,  epoch 269, local model 63, internal_epoch   2,  Average loss: 0.0007, Accuracy: 741/752 (98.5372%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 0.9867, Accuracy: 7117/10000 (71.1700%)
___Train Local_ResNet_18,  epoch 269, local model 59, internal_epoch   1,  Average loss: 0.0015, Accuracy: 628/642 (97.8193%)
___Train Local_ResNet_18,  epoch 269, local model 59, internal_epoch   2,  Average loss: 0.0016, Accuracy: 620/642 (96.5732%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 2.0875, Accuracy: 4790/10000 (47.9000%)
___Train Local_ResNet_18,  epoch 269, local model 29, internal_epoch   1,  Average loss: 0.0028, Accuracy: 806/848 (95.0472%)
___Train Local_ResNet_18,  epoch 269, local model 29, internal_epoch   2,  Average loss: 0.0068, Accuracy: 755/848 (89.0330%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 13.9492, Accuracy: 2309/10000 (23.0900%)
___Train Local_ResNet_18,  epoch 269, local model 16, internal_epoch   1,  Average loss: 0.0024, Accuracy: 764/773 (98.8357%)
___Train Local_ResNet_18,  epoch 269, local model 16, internal_epoch   2,  Average loss: 0.0210, Accuracy: 502/773 (64.9418%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 43.3024, Accuracy: 1036/10000 (10.3600%)
___Train Local_ResNet_18,  epoch 269, local model 50, internal_epoch   1,  Average loss: 0.0009, Accuracy: 401/401 (100.0000%)
___Train Local_ResNet_18,  epoch 269, local model 50, internal_epoch   2,  Average loss: 0.0005, Accuracy: 399/401 (99.5012%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 2.2369, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 269, local model 97, internal_epoch   1,  Average loss: 0.0011, Accuracy: 415/418 (99.2823%)
___Train Local_ResNet_18,  epoch 269, local model 97, internal_epoch   2,  Average loss: 0.0003, Accuracy: 418/418 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 1.5223, Accuracy: 6247/10000 (62.4700%)
___Train Local_ResNet_18,  epoch 269, local model 34, internal_epoch   1,  Average loss: 0.0015, Accuracy: 344/349 (98.5673%)
___Train Local_ResNet_18,  epoch 269, local model 34, internal_epoch   2,  Average loss: 0.0005, Accuracy: 347/349 (99.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 2.0999, Accuracy: 5968/10000 (59.6800%)
___Train Local_ResNet_18,  epoch 269, local model 65, internal_epoch   1,  Average loss: 0.0013, Accuracy: 312/314 (99.3631%)
___Train Local_ResNet_18,  epoch 269, local model 65, internal_epoch   2,  Average loss: 0.0002, Accuracy: 314/314 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 1.3843, Accuracy: 6593/10000 (65.9300%)
___Train Local_ResNet_18,  epoch 269, local model 4, internal_epoch   1,  Average loss: 0.0025, Accuracy: 531/557 (95.3321%)
___Train Local_ResNet_18,  epoch 269, local model 4, internal_epoch   2,  Average loss: 0.0028, Accuracy: 534/557 (95.8707%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 2.9001, Accuracy: 4310/10000 (43.1000%)
___Train Local_ResNet_18,  epoch 269, local model 86, internal_epoch   1,  Average loss: 0.0013, Accuracy: 212/212 (100.0000%)
___Train Local_ResNet_18,  epoch 269, local model 86, internal_epoch   2,  Average loss: 0.0008, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 269: Average loss: 0.9587, Accuracy: 7317/10000 (73.1700%)
time spent on training: 69.13171148300171
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [752, 642, 848, 773, 401, 418, 349, 314, 557, 212]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [63, 59, 29, 16, 50, 97, 34, 65, 4, 86], weight: tensor([0.1428, 0.1219, 0.1610, 0.1468, 0.0761, 0.0794, 0.0663, 0.0596, 0.1058,
        0.0403])
[rfa agg] iter:  0, prev_obj_val: 33.404293060302734, obj_val: 37.6169319152832, abs dis: 4.212638854980469
[rfa agg] iter:  0, weight: tensor([0.0697, 0.0751, 0.0537, 0.0550, 0.2199, 0.2246, 0.0908, 0.0517, 0.1344,
        0.0252])
[rfa agg] iter:  1, prev_obj_val: 37.6169319152832, obj_val: 37.5997314453125, abs dis: 0.017200469970703125
[rfa agg] iter:  1, weight: tensor([0.0478, 0.0493, 0.0389, 0.0391, 0.2299, 0.2345, 0.1847, 0.0716, 0.0747,
        0.0295])
[rfa agg] iter:  2, prev_obj_val: 37.5997314453125, obj_val: 40.59606170654297, abs dis: 2.9963302612304688
[rfa agg] iter:  2, weight: tensor([0.0466, 0.0481, 0.0379, 0.0381, 0.2310, 0.2359, 0.1910, 0.0701, 0.0725,
        0.0288])
[rfa agg] iter:  3, prev_obj_val: 40.59606170654297, obj_val: 40.57738494873047, abs dis: 0.0186767578125
[rfa agg] iter:  3, weight: tensor([0.0453, 0.0460, 0.0377, 0.0377, 0.1384, 0.1433, 0.3401, 0.1085, 0.0650,
        0.0380])
[rfa agg] iter:  4, prev_obj_val: 40.57738494873047, obj_val: 51.4959831237793, abs dis: 10.918598175048828
[rfa agg] iter:  4, weight: tensor([0.0422, 0.0429, 0.0352, 0.0352, 0.1275, 0.1318, 0.3877, 0.1014, 0.0606,
        0.0355])
[rfa agg] iter:  5, prev_obj_val: 51.4959831237793, obj_val: 43.951622009277344, abs dis: 7.544361114501953
[rfa agg] iter:  5, weight: tensor([0.0513, 0.0503, 0.0452, 0.0448, 0.0814, 0.0847, 0.1173, 0.2725, 0.0624,
        0.1901])
[rfa agg] iter:  6, prev_obj_val: 43.951622009277344, obj_val: 43.945220947265625, abs dis: 0.00640106201171875
[rfa agg] iter:  6, weight: tensor([0.0489, 0.0490, 0.0416, 0.0415, 0.1099, 0.1140, 0.2331, 0.2372, 0.0657,
        0.0591])
___Test Target_ResNet_18 poisoned: False, epoch: 269: Average loss: 0.6222, Accuracy: 7969/10000 (79.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 269: Average loss: 5.9629, Accuracy: 495/9000 (5.5000%)
Done in 140.79087734222412 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:270 choose agents : [12, 45, 87, 95, 26, 42, 46, 88, 92, 38]. Adversary List: []
___Train Local_ResNet_18,  epoch 270, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 897/977 (91.8117%)
___Train Local_ResNet_18,  epoch 270, local model 12, internal_epoch   2,  Average loss: 0.0141, Accuracy: 718/977 (73.4903%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 7.2023, Accuracy: 2464/10000 (24.6400%)
___Train Local_ResNet_18,  epoch 270, local model 45, internal_epoch   1,  Average loss: 0.0026, Accuracy: 507/529 (95.8412%)
___Train Local_ResNet_18,  epoch 270, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 494/529 (93.3837%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 3.6760, Accuracy: 3695/10000 (36.9500%)
___Train Local_ResNet_18,  epoch 270, local model 87, internal_epoch   1,  Average loss: 0.0037, Accuracy: 364/397 (91.6877%)
___Train Local_ResNet_18,  epoch 270, local model 87, internal_epoch   2,  Average loss: 0.0027, Accuracy: 375/397 (94.4584%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 2.5987, Accuracy: 4678/10000 (46.7800%)
___Train Local_ResNet_18,  epoch 270, local model 95, internal_epoch   1,  Average loss: 0.0032, Accuracy: 537/569 (94.3761%)
___Train Local_ResNet_18,  epoch 270, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 514/569 (90.3339%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 5.4404, Accuracy: 2730/10000 (27.3000%)
___Train Local_ResNet_18,  epoch 270, local model 26, internal_epoch   1,  Average loss: 0.0014, Accuracy: 458/468 (97.8632%)
___Train Local_ResNet_18,  epoch 270, local model 26, internal_epoch   2,  Average loss: 0.0012, Accuracy: 456/468 (97.4359%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 3.0184, Accuracy: 4296/10000 (42.9600%)
___Train Local_ResNet_18,  epoch 270, local model 42, internal_epoch   1,  Average loss: 0.0025, Accuracy: 192/198 (96.9697%)
___Train Local_ResNet_18,  epoch 270, local model 42, internal_epoch   2,  Average loss: 0.0011, Accuracy: 196/198 (98.9899%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 2.3623, Accuracy: 4993/10000 (49.9300%)
___Train Local_ResNet_18,  epoch 270, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 599/601 (99.6672%)
___Train Local_ResNet_18,  epoch 270, local model 46, internal_epoch   2,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 1.2494, Accuracy: 6564/10000 (65.6400%)
___Train Local_ResNet_18,  epoch 270, local model 88, internal_epoch   1,  Average loss: 0.0034, Accuracy: 419/447 (93.7360%)
___Train Local_ResNet_18,  epoch 270, local model 88, internal_epoch   2,  Average loss: 0.0021, Accuracy: 431/447 (96.4206%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 3.4485, Accuracy: 4051/10000 (40.5100%)
___Train Local_ResNet_18,  epoch 270, local model 92, internal_epoch   1,  Average loss: 0.0026, Accuracy: 759/796 (95.3518%)
___Train Local_ResNet_18,  epoch 270, local model 92, internal_epoch   2,  Average loss: 0.0101, Accuracy: 670/796 (84.1709%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 46.7372, Accuracy: 1529/10000 (15.2900%)
___Train Local_ResNet_18,  epoch 270, local model 38, internal_epoch   1,  Average loss: 0.0012, Accuracy: 749/756 (99.0741%)
___Train Local_ResNet_18,  epoch 270, local model 38, internal_epoch   2,  Average loss: 0.0013, Accuracy: 730/756 (96.5608%)
___Test Local_ResNet_18 poisoned: False, epoch: 270: Average loss: 2.5344, Accuracy: 5318/10000 (53.1800%)
time spent on training: 67.32574272155762
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [977, 529, 397, 569, 468, 198, 601, 447, 796, 756]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [12, 45, 87, 95, 26, 42, 46, 88, 92, 38], weight: tensor([0.1703, 0.0922, 0.0692, 0.0992, 0.0816, 0.0345, 0.1047, 0.0779, 0.1387,
        0.1318])
[rfa agg] iter:  0, prev_obj_val: 29.55916976928711, obj_val: 37.01537322998047, abs dis: 7.456203460693359
[rfa agg] iter:  0, weight: tensor([0.0426, 0.1650, 0.0779, 0.1659, 0.1906, 0.0147, 0.1267, 0.0883, 0.0572,
        0.0710])
[rfa agg] iter:  1, prev_obj_val: 37.01537322998047, obj_val: 40.54104232788086, abs dis: 3.5256690979003906
[rfa agg] iter:  1, weight: tensor([0.0386, 0.0898, 0.1952, 0.0951, 0.1538, 0.0238, 0.0727, 0.2290, 0.0472,
        0.0547])
[rfa agg] iter:  2, prev_obj_val: 40.54104232788086, obj_val: 40.54010772705078, abs dis: 0.000934600830078125
[rfa agg] iter:  2, weight: tensor([0.0423, 0.0842, 0.2051, 0.0895, 0.1251, 0.0328, 0.0720, 0.2412, 0.0504,
        0.0574])
[rfa agg] iter:  3, prev_obj_val: 40.54010772705078, obj_val: 44.447662353515625, abs dis: 3.9075546264648438
[rfa agg] iter:  3, weight: tensor([0.0422, 0.0840, 0.2056, 0.0892, 0.1244, 0.0327, 0.0718, 0.2425, 0.0503,
        0.0573])
[rfa agg] iter:  4, prev_obj_val: 44.447662353515625, obj_val: 48.461090087890625, abs dis: 4.013427734375
[rfa agg] iter:  4, weight: tensor([0.0509, 0.0903, 0.1785, 0.0963, 0.1211, 0.0514, 0.0798, 0.2054, 0.0595,
        0.0667])
[rfa agg] iter:  5, prev_obj_val: 48.461090087890625, obj_val: 48.459373474121094, abs dis: 0.00171661376953125
[rfa agg] iter:  5, weight: tensor([0.0579, 0.0931, 0.1539, 0.0995, 0.1166, 0.0799, 0.0845, 0.1750, 0.0662,
        0.0734])
___Test Target_ResNet_18 poisoned: False, epoch: 270: Average loss: 0.6249, Accuracy: 7940/10000 (79.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 270: Average loss: 5.7497, Accuracy: 622/9000 (6.9111%)
Done in 138.56714844703674 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:271 choose agents : [53, 41, 66, 33, 0, 84, 78, 6, 8, 67]. Adversary List: []
___Train Local_ResNet_18,  epoch 271, local model 53, internal_epoch   1,  Average loss: 0.0017, Accuracy: 610/625 (97.6000%)
___Train Local_ResNet_18,  epoch 271, local model 53, internal_epoch   2,  Average loss: 0.0018, Accuracy: 600/625 (96.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 2.6365, Accuracy: 4617/10000 (46.1700%)
___Train Local_ResNet_18,  epoch 271, local model 41, internal_epoch   1,  Average loss: 0.0172, Accuracy: 461/513 (89.8635%)
___Train Local_ResNet_18,  epoch 271, local model 41, internal_epoch   2,  Average loss: 0.0111, Accuracy: 404/513 (78.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 7.4694, Accuracy: 2450/10000 (24.5000%)
___Train Local_ResNet_18,  epoch 271, local model 66, internal_epoch   1,  Average loss: 0.0014, Accuracy: 543/555 (97.8378%)
___Train Local_ResNet_18,  epoch 271, local model 66, internal_epoch   2,  Average loss: 0.0004, Accuracy: 553/555 (99.6396%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 2.3086, Accuracy: 5029/10000 (50.2900%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 271, local model 33, internal_epoch   1,  Average loss: 0.0019, Accuracy: 516/527 (97.9127%)
___Train Local_ResNet_18,  epoch 271, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 490/527 (92.9791%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 2.6662, Accuracy: 4176/10000 (41.7600%)
___Train Local_ResNet_18,  epoch 271, local model 0, internal_epoch   1,  Average loss: 0.0008, Accuracy: 367/367 (100.0000%)
___Train Local_ResNet_18,  epoch 271, local model 0, internal_epoch   2,  Average loss: 0.0004, Accuracy: 365/367 (99.4550%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 1.2853, Accuracy: 6722/10000 (67.2200%)
___Train Local_ResNet_18,  epoch 271, local model 84, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1032/1053 (98.0057%)
___Train Local_ResNet_18,  epoch 271, local model 84, internal_epoch   2,  Average loss: 0.0025, Accuracy: 1005/1053 (95.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 1.8496, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 271, local model 78, internal_epoch   1,  Average loss: 0.0022, Accuracy: 246/255 (96.4706%)
___Train Local_ResNet_18,  epoch 271, local model 78, internal_epoch   2,  Average loss: 0.0008, Accuracy: 252/255 (98.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 2.0538, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 271, local model 6, internal_epoch   1,  Average loss: 0.0017, Accuracy: 512/520 (98.4615%)
___Train Local_ResNet_18,  epoch 271, local model 6, internal_epoch   2,  Average loss: 0.0105, Accuracy: 447/520 (85.9615%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 7.5286, Accuracy: 1771/10000 (17.7100%)
___Train Local_ResNet_18,  epoch 271, local model 8, internal_epoch   1,  Average loss: 0.0007, Accuracy: 533/534 (99.8127%)
___Train Local_ResNet_18,  epoch 271, local model 8, internal_epoch   2,  Average loss: 0.0002, Accuracy: 534/534 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 1.1544, Accuracy: 6748/10000 (67.4800%)
___Train Local_ResNet_18,  epoch 271, local model 67, internal_epoch   1,  Average loss: 0.0020, Accuracy: 818/842 (97.1496%)
___Train Local_ResNet_18,  epoch 271, local model 67, internal_epoch   2,  Average loss: 0.0110, Accuracy: 703/842 (83.4917%)
___Test Local_ResNet_18 poisoned: False, epoch: 271: Average loss: 19.8968, Accuracy: 1501/10000 (15.0100%)
time spent on training: 71.12679409980774
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.09100328095320324  data num: [625, 513, 555, 527, 367, 1053, 255, 520, 534, 842]
[rfa agg] considering poison per batch poison_fraction: 0.007109631324469004
[rfa agg] init. name: [53, 41, 66, 33, 0, 84, 78, 6, 8, 67], weight: tensor([0.1079, 0.0886, 0.0958, 0.0910, 0.0634, 0.1818, 0.0440, 0.0898, 0.0922,
        0.1454])
[rfa agg] iter:  0, prev_obj_val: 30.343341827392578, obj_val: 39.383567810058594, abs dis: 9.040225982666016
[rfa agg] iter:  0, weight: tensor([0.1024, 0.1055, 0.1862, 0.1467, 0.0400, 0.0340, 0.0156, 0.1105, 0.2183,
        0.0409])
[rfa agg] iter:  1, prev_obj_val: 39.383567810058594, obj_val: 42.75012969970703, abs dis: 3.3665618896484375
[rfa agg] iter:  1, weight: tensor([0.0974, 0.1060, 0.1288, 0.1184, 0.1670, 0.0504, 0.0405, 0.1086, 0.1266,
        0.0564])
[rfa agg] iter:  2, prev_obj_val: 42.75012969970703, obj_val: 50.12901306152344, abs dis: 7.378883361816406
[rfa agg] iter:  2, weight: tensor([0.0829, 0.0880, 0.1026, 0.0954, 0.2938, 0.0474, 0.0478, 0.0897, 0.1003,
        0.0521])
[rfa agg] iter:  3, prev_obj_val: 50.12901306152344, obj_val: 46.24365997314453, abs dis: 3.8853530883789062
[rfa agg] iter:  3, weight: tensor([0.0732, 0.0741, 0.0836, 0.0784, 0.3454, 0.0487, 0.0881, 0.0753, 0.0811,
        0.0520])
[rfa agg] iter:  4, prev_obj_val: 46.24365997314453, obj_val: 39.40990447998047, abs dis: 6.8337554931640625
[rfa agg] iter:  4, weight: tensor([0.0539, 0.0556, 0.0637, 0.0595, 0.5348, 0.0334, 0.0441, 0.0566, 0.0621,
        0.0362])
[rfa agg] iter:  5, prev_obj_val: 39.40990447998047, obj_val: 42.74961853027344, abs dis: 3.3397140502929688
[rfa agg] iter:  5, weight: tensor([0.0970, 0.1047, 0.1277, 0.1171, 0.1734, 0.0502, 0.0405, 0.1068, 0.1265,
        0.0562])
[rfa agg] iter:  6, prev_obj_val: 42.74961853027344, obj_val: 50.128990173339844, abs dis: 7.379371643066406
[rfa agg] iter:  6, weight: tensor([0.0829, 0.0879, 0.1025, 0.0953, 0.2944, 0.0473, 0.0478, 0.0896, 0.1003,
        0.0520])
[rfa agg] iter:  7, prev_obj_val: 50.128990173339844, obj_val: 46.24365997314453, abs dis: 3.8853302001953125
[rfa agg] iter:  7, weight: tensor([0.0732, 0.0741, 0.0836, 0.0784, 0.3455, 0.0487, 0.0881, 0.0753, 0.0811,
        0.0520])
[rfa agg] iter:  8, prev_obj_val: 46.24365997314453, obj_val: 39.409908294677734, abs dis: 6.833751678466797
[rfa agg] iter:  8, weight: tensor([0.0539, 0.0556, 0.0637, 0.0595, 0.5348, 0.0334, 0.0441, 0.0566, 0.0621,
        0.0362])
[rfa agg] iter:  9, prev_obj_val: 39.409908294677734, obj_val: 42.749610900878906, abs dis: 3.339702606201172
[rfa agg] iter:  9, weight: tensor([0.0970, 0.1047, 0.1277, 0.1171, 0.1734, 0.0502, 0.0405, 0.1068, 0.1265,
        0.0562])
___Test Target_ResNet_18 poisoned: False, epoch: 271: Average loss: 0.6255, Accuracy: 7929/10000 (79.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 271: Average loss: 5.7352, Accuracy: 631/9000 (7.0111%)
Done in 145.9494218826294 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:272 choose agents : [70, 2, 35, 42, 1, 56, 66, 71, 57, 80]. Adversary List: []
___Train Local_ResNet_18,  epoch 272, local model 70, internal_epoch   1,  Average loss: 0.0023, Accuracy: 582/610 (95.4098%)
___Train Local_ResNet_18,  epoch 272, local model 70, internal_epoch   2,  Average loss: 0.0023, Accuracy: 585/610 (95.9016%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 1.9053, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch 272, local model 2, internal_epoch   1,  Average loss: 0.0024, Accuracy: 447/461 (96.9631%)
___Train Local_ResNet_18,  epoch 272, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 433/461 (93.9262%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 3.4762, Accuracy: 4092/10000 (40.9200%)
___Train Local_ResNet_18,  epoch 272, local model 35, internal_epoch   1,  Average loss: 0.0028, Accuracy: 396/419 (94.5107%)
___Train Local_ResNet_18,  epoch 272, local model 35, internal_epoch   2,  Average loss: 0.0011, Accuracy: 409/419 (97.6134%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 3.1133, Accuracy: 4112/10000 (41.1200%)
___Train Local_ResNet_18,  epoch 272, local model 42, internal_epoch   1,  Average loss: 0.0161, Accuracy: 194/198 (97.9798%)
___Train Local_ResNet_18,  epoch 272, local model 42, internal_epoch   2,  Average loss: 0.0067, Accuracy: 181/198 (91.4141%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 13.5012, Accuracy: 1297/10000 (12.9700%)
___Train Local_ResNet_18,  epoch 272, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 629/641 (98.1279%)
___Train Local_ResNet_18,  epoch 272, local model 1, internal_epoch   2,  Average loss: 0.0127, Accuracy: 587/641 (91.5757%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 3.1415, Accuracy: 4522/10000 (45.2200%)
___Train Local_ResNet_18,  epoch 272, local model 56, internal_epoch   1,  Average loss: 0.0008, Accuracy: 739/743 (99.4616%)
___Train Local_ResNet_18,  epoch 272, local model 56, internal_epoch   2,  Average loss: 0.0004, Accuracy: 740/743 (99.5962%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 1.0827, Accuracy: 6973/10000 (69.7300%)
___Train Local_ResNet_18,  epoch 272, local model 66, internal_epoch   1,  Average loss: 0.0018, Accuracy: 537/555 (96.7568%)
___Train Local_ResNet_18,  epoch 272, local model 66, internal_epoch   2,  Average loss: 0.0008, Accuracy: 549/555 (98.9189%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 2.7264, Accuracy: 4888/10000 (48.8800%)
___Train Local_ResNet_18,  epoch 272, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 1117/1166 (95.7976%)
___Train Local_ResNet_18,  epoch 272, local model 71, internal_epoch   2,  Average loss: 0.0074, Accuracy: 1011/1166 (86.7067%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 6.4167, Accuracy: 2815/10000 (28.1500%)
___Train Local_ResNet_18,  epoch 272, local model 57, internal_epoch   1,  Average loss: 0.0011, Accuracy: 288/290 (99.3103%)
___Train Local_ResNet_18,  epoch 272, local model 57, internal_epoch   2,  Average loss: 0.0005, Accuracy: 287/290 (98.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 1.1597, Accuracy: 6922/10000 (69.2200%)
___Train Local_ResNet_18,  epoch 272, local model 80, internal_epoch   1,  Average loss: 0.0013, Accuracy: 362/363 (99.7245%)
___Train Local_ResNet_18,  epoch 272, local model 80, internal_epoch   2,  Average loss: 0.0004, Accuracy: 362/363 (99.7245%)
___Test Local_ResNet_18 poisoned: False, epoch: 272: Average loss: 2.8503, Accuracy: 5303/10000 (53.0300%)
time spent on training: 67.54986691474915
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [610, 461, 419, 198, 641, 743, 555, 1166, 290, 363]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 2, 35, 42, 1, 56, 66, 71, 57, 80], weight: tensor([0.1120, 0.0846, 0.0769, 0.0364, 0.1177, 0.1364, 0.1019, 0.2141, 0.0533,
        0.0667])
[rfa agg] iter:  0, prev_obj_val: 35.27569580078125, obj_val: 38.13746643066406, abs dis: 2.8617706298828125
[rfa agg] iter:  0, weight: tensor([0.1761, 0.1333, 0.0743, 0.0147, 0.1071, 0.0920, 0.2865, 0.0437, 0.0272,
        0.0451])
[rfa agg] iter:  1, prev_obj_val: 38.13746643066406, obj_val: 48.581626892089844, abs dis: 10.444160461425781
[rfa agg] iter:  1, weight: tensor([0.1122, 0.2413, 0.1361, 0.0189, 0.0792, 0.0722, 0.1920, 0.0411, 0.0376,
        0.0696])
[rfa agg] iter:  2, prev_obj_val: 48.581626892089844, obj_val: 48.500396728515625, abs dis: 0.08123016357421875
[rfa agg] iter:  2, weight: tensor([0.0599, 0.0879, 0.1420, 0.0358, 0.0502, 0.0494, 0.0727, 0.0356, 0.1094,
        0.3569])
[rfa agg] iter:  3, prev_obj_val: 48.500396728515625, obj_val: 59.781227111816406, abs dis: 11.280830383300781
[rfa agg] iter:  3, weight: tensor([0.0497, 0.0718, 0.1198, 0.0299, 0.0417, 0.0410, 0.0601, 0.0296, 0.0930,
        0.4634])
[rfa agg] iter:  4, prev_obj_val: 59.781227111816406, obj_val: 55.700523376464844, abs dis: 4.0807037353515625
[rfa agg] iter:  4, weight: tensor([0.0632, 0.0742, 0.0938, 0.1089, 0.0560, 0.0570, 0.0703, 0.0460, 0.2927,
        0.1380])
[rfa agg] iter:  5, prev_obj_val: 55.700523376464844, obj_val: 68.29170227050781, abs dis: 12.591178894042969
[rfa agg] iter:  5, weight: tensor([0.0468, 0.0580, 0.0777, 0.0588, 0.0409, 0.0412, 0.0532, 0.0321, 0.4572,
        0.1341])
[rfa agg] iter:  6, prev_obj_val: 68.29170227050781, obj_val: 52.02471160888672, abs dis: 16.266990661621094
[rfa agg] iter:  6, weight: tensor([0.0783, 0.0850, 0.0991, 0.1632, 0.0711, 0.0734, 0.0843, 0.0629, 0.1614,
        0.1212])
[rfa agg] iter:  7, prev_obj_val: 52.02471160888672, obj_val: 48.50843811035156, abs dis: 3.5162734985351562
[rfa agg] iter:  7, weight: tensor([0.0598, 0.0791, 0.1152, 0.0522, 0.0513, 0.0511, 0.0699, 0.0384, 0.2207,
        0.2623])
[rfa agg] iter:  8, prev_obj_val: 48.50843811035156, obj_val: 52.00074005126953, abs dis: 3.4923019409179688
[rfa agg] iter:  8, weight: tensor([0.0515, 0.0744, 0.1233, 0.0311, 0.0431, 0.0425, 0.0623, 0.0306, 0.0970,
        0.4443])
[rfa agg] iter:  9, prev_obj_val: 52.00074005126953, obj_val: 48.50596237182617, abs dis: 3.4947776794433594
[rfa agg] iter:  9, weight: tensor([0.0574, 0.0761, 0.1115, 0.0485, 0.0492, 0.0491, 0.0671, 0.0369, 0.2190,
        0.2852])
___Test Target_ResNet_18 poisoned: False, epoch: 272: Average loss: 0.6256, Accuracy: 7942/10000 (79.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 272: Average loss: 5.7959, Accuracy: 602/9000 (6.6889%)
Done in 143.043377161026 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:273 choose agents : [17, 62, 81, 52, 9, 7, 60, 39, 47, 77]. Adversary List: []
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 273, local model 17, internal_epoch   1,  Average loss: 0.0011, Accuracy: 519/526 (98.6692%)
___Train Local_ResNet_18,  epoch 273, local model 17, internal_epoch   2,  Average loss: 0.0012, Accuracy: 516/526 (98.0989%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 1.8929, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 273, local model 62, internal_epoch   1,  Average loss: 0.0006, Accuracy: 357/358 (99.7207%)
___Train Local_ResNet_18,  epoch 273, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 358/358 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 0.7650, Accuracy: 7590/10000 (75.9000%)
___Train Local_ResNet_18,  epoch 273, local model 81, internal_epoch   1,  Average loss: 0.0048, Accuracy: 947/1034 (91.5861%)
___Train Local_ResNet_18,  epoch 273, local model 81, internal_epoch   2,  Average loss: 0.0124, Accuracy: 788/1034 (76.2089%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 14.3398, Accuracy: 1934/10000 (19.3400%)
___Train Local_ResNet_18,  epoch 273, local model 52, internal_epoch   1,  Average loss: 0.0018, Accuracy: 214/214 (100.0000%)
___Train Local_ResNet_18,  epoch 273, local model 52, internal_epoch   2,  Average loss: 0.0005, Accuracy: 214/214 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 1.1310, Accuracy: 6947/10000 (69.4700%)
___Train Local_ResNet_18,  epoch 273, local model 9, internal_epoch   1,  Average loss: 0.0015, Accuracy: 361/368 (98.0978%)
___Train Local_ResNet_18,  epoch 273, local model 9, internal_epoch   2,  Average loss: 0.0005, Accuracy: 365/368 (99.1848%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 4.5570, Accuracy: 3312/10000 (33.1200%)
___Train Local_ResNet_18,  epoch 273, local model 7, internal_epoch   1,  Average loss: 0.0013, Accuracy: 346/352 (98.2955%)
___Train Local_ResNet_18,  epoch 273, local model 7, internal_epoch   2,  Average loss: 0.0007, Accuracy: 349/352 (99.1477%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 1.6498, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 273, local model 60, internal_epoch   1,  Average loss: 0.0009, Accuracy: 284/284 (100.0000%)
___Train Local_ResNet_18,  epoch 273, local model 60, internal_epoch   2,  Average loss: 0.0002, Accuracy: 284/284 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 0.8799, Accuracy: 7339/10000 (73.3900%)
___Train Local_ResNet_18,  epoch 273, local model 39, internal_epoch   1,  Average loss: 0.0018, Accuracy: 214/217 (98.6175%)
___Train Local_ResNet_18,  epoch 273, local model 39, internal_epoch   2,  Average loss: 0.0003, Accuracy: 217/217 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 1.1637, Accuracy: 6665/10000 (66.6500%)
___Train Local_ResNet_18,  epoch 273, local model 47, internal_epoch   1,  Average loss: 0.0014, Accuracy: 646/654 (98.7768%)
___Train Local_ResNet_18,  epoch 273, local model 47, internal_epoch   2,  Average loss: 0.0029, Accuracy: 622/654 (95.1070%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 3.2881, Accuracy: 4442/10000 (44.4200%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 273, local model 77, internal_epoch   1,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%)
___Train Local_ResNet_18,  epoch 273, local model 77, internal_epoch   2,  Average loss: 0.0005, Accuracy: 491/496 (98.9919%)
___Test Local_ResNet_18 poisoned: False, epoch: 273: Average loss: 0.9034, Accuracy: 7292/10000 (72.9200%)
time spent on training: 78.74796891212463
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.22695980457472795  data num: [526, 358, 1034, 214, 368, 352, 284, 217, 654, 496]
[rfa agg] considering poison per batch poison_fraction: 0.01773123473240062
[rfa agg] init. name: [17, 62, 81, 52, 9, 7, 60, 39, 47, 77], weight: tensor([0.1168, 0.0795, 0.2296, 0.0475, 0.0817, 0.0782, 0.0631, 0.0482, 0.1452,
        0.1101])
[rfa agg] iter:  0, prev_obj_val: 36.87480163574219, obj_val: 43.33205032348633, abs dis: 6.457248687744141
[rfa agg] iter:  0, weight: tensor([0.0819, 0.1951, 0.0393, 0.0338, 0.1842, 0.1781, 0.0717, 0.0342, 0.0575,
        0.1243])
[rfa agg] iter:  1, prev_obj_val: 43.33205032348633, obj_val: 59.233306884765625, abs dis: 15.901256561279297
[rfa agg] iter:  1, weight: tensor([0.0417, 0.1122, 0.0271, 0.0663, 0.1111, 0.1067, 0.3810, 0.0667, 0.0345,
        0.0526])
[rfa agg] iter:  2, prev_obj_val: 59.233306884765625, obj_val: 43.33795928955078, abs dis: 15.895347595214844
[rfa agg] iter:  2, weight: tensor([0.0694, 0.0947, 0.0581, 0.1655, 0.0968, 0.0926, 0.1125, 0.1672, 0.0646,
        0.0787])
[rfa agg] iter:  3, prev_obj_val: 43.33795928955078, obj_val: 59.23323440551758, abs dis: 15.895275115966797
[rfa agg] iter:  3, weight: tensor([0.0418, 0.1120, 0.0273, 0.0668, 0.1100, 0.1058, 0.3815, 0.0674, 0.0346,
        0.0527])
[rfa agg] iter:  4, prev_obj_val: 59.23323440551758, obj_val: 43.337955474853516, abs dis: 15.895278930664062
[rfa agg] iter:  4, weight: tensor([0.0694, 0.0947, 0.0581, 0.1655, 0.0968, 0.0926, 0.1125, 0.1672, 0.0646,
        0.0787])
[rfa agg] iter:  5, prev_obj_val: 43.337955474853516, obj_val: 59.23323440551758, abs dis: 15.895278930664062
[rfa agg] iter:  5, weight: tensor([0.0418, 0.1120, 0.0273, 0.0668, 0.1100, 0.1058, 0.3815, 0.0674, 0.0346,
        0.0527])
[rfa agg] iter:  6, prev_obj_val: 59.23323440551758, obj_val: 43.337955474853516, abs dis: 15.895278930664062
[rfa agg] iter:  6, weight: tensor([0.0694, 0.0947, 0.0581, 0.1655, 0.0968, 0.0926, 0.1125, 0.1672, 0.0646,
        0.0787])
[rfa agg] iter:  7, prev_obj_val: 43.337955474853516, obj_val: 59.23323440551758, abs dis: 15.895278930664062
[rfa agg] iter:  7, weight: tensor([0.0418, 0.1120, 0.0273, 0.0668, 0.1100, 0.1058, 0.3815, 0.0674, 0.0346,
        0.0527])
[rfa agg] iter:  8, prev_obj_val: 59.23323440551758, obj_val: 43.337955474853516, abs dis: 15.895278930664062
[rfa agg] iter:  8, weight: tensor([0.0694, 0.0947, 0.0581, 0.1655, 0.0968, 0.0926, 0.1125, 0.1672, 0.0646,
        0.0787])
[rfa agg] iter:  9, prev_obj_val: 43.337955474853516, obj_val: 59.23323440551758, abs dis: 15.895278930664062
[rfa agg] iter:  9, weight: tensor([0.0418, 0.1120, 0.0273, 0.0668, 0.1100, 0.1058, 0.3815, 0.0674, 0.0346,
        0.0527])
___Test Target_ResNet_18 poisoned: False, epoch: 273: Average loss: 0.6243, Accuracy: 7960/10000 (79.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 273: Average loss: 5.8959, Accuracy: 566/9000 (6.2889%)
Done in 148.33668541908264 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:274 choose agents : [86, 75, 23, 20, 40, 58, 9, 59, 19, 79]. Adversary List: []
___Train Local_ResNet_18,  epoch 274, local model 86, internal_epoch   1,  Average loss: 0.0012, Accuracy: 210/212 (99.0566%)
___Train Local_ResNet_18,  epoch 274, local model 86, internal_epoch   2,  Average loss: 0.0012, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 0.9709, Accuracy: 7260/10000 (72.6000%)
___Train Local_ResNet_18,  epoch 274, local model 75, internal_epoch   1,  Average loss: 0.0078, Accuracy: 560/578 (96.8858%)
___Train Local_ResNet_18,  epoch 274, local model 75, internal_epoch   2,  Average loss: 0.0272, Accuracy: 332/578 (57.4394%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 66.2913, Accuracy: 1102/10000 (11.0200%)
___Train Local_ResNet_18,  epoch 274, local model 23, internal_epoch   1,  Average loss: 0.0015, Accuracy: 243/248 (97.9839%)
___Train Local_ResNet_18,  epoch 274, local model 23, internal_epoch   2,  Average loss: 0.0003, Accuracy: 248/248 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 0.8736, Accuracy: 7303/10000 (73.0300%)
___Train Local_ResNet_18,  epoch 274, local model 20, internal_epoch   1,  Average loss: 0.0025, Accuracy: 349/362 (96.4088%)
___Train Local_ResNet_18,  epoch 274, local model 20, internal_epoch   2,  Average loss: 0.0009, Accuracy: 357/362 (98.6188%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 4.7538, Accuracy: 4034/10000 (40.3400%)
___Train Local_ResNet_18,  epoch 274, local model 40, internal_epoch   1,  Average loss: 0.0029, Accuracy: 624/652 (95.7055%)
___Train Local_ResNet_18,  epoch 274, local model 40, internal_epoch   2,  Average loss: 0.0117, Accuracy: 540/652 (82.8221%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 12.7038, Accuracy: 1856/10000 (18.5600%)
___Train Local_ResNet_18,  epoch 274, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 229/234 (97.8632%)
___Train Local_ResNet_18,  epoch 274, local model 58, internal_epoch   2,  Average loss: 0.0004, Accuracy: 233/234 (99.5726%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 1.3580, Accuracy: 6223/10000 (62.2300%)
___Train Local_ResNet_18,  epoch 274, local model 9, internal_epoch   1,  Average loss: 0.0014, Accuracy: 366/368 (99.4565%)
___Train Local_ResNet_18,  epoch 274, local model 9, internal_epoch   2,  Average loss: 0.0004, Accuracy: 367/368 (99.7283%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 7.0195, Accuracy: 2652/10000 (26.5200%)
___Train Local_ResNet_18,  epoch 274, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 635/642 (98.9097%)
___Train Local_ResNet_18,  epoch 274, local model 59, internal_epoch   2,  Average loss: 0.0214, Accuracy: 456/642 (71.0280%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 81.0290, Accuracy: 1301/10000 (13.0100%)
___Train Local_ResNet_18,  epoch 274, local model 19, internal_epoch   1,  Average loss: 0.0075, Accuracy: 147/173 (84.9711%)
___Train Local_ResNet_18,  epoch 274, local model 19, internal_epoch   2,  Average loss: 0.0021, Accuracy: 168/173 (97.1098%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 6.3034, Accuracy: 3230/10000 (32.3000%)
___Train Local_ResNet_18,  epoch 274, local model 79, internal_epoch   1,  Average loss: 0.0024, Accuracy: 151/154 (98.0519%)
___Train Local_ResNet_18,  epoch 274, local model 79, internal_epoch   2,  Average loss: 0.0005, Accuracy: 154/154 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 274: Average loss: 0.9705, Accuracy: 7247/10000 (72.4700%)
time spent on training: 65.34716963768005
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [212, 578, 248, 362, 652, 234, 368, 642, 173, 154]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [86, 75, 23, 20, 40, 58, 9, 59, 19, 79], weight: tensor([0.0585, 0.1595, 0.0685, 0.0999, 0.1800, 0.0646, 0.1016, 0.1772, 0.0478,
        0.0425])
[rfa agg] iter:  0, prev_obj_val: 32.60139465332031, obj_val: 41.06236267089844, abs dis: 8.460968017578125
[rfa agg] iter:  0, weight: tensor([0.0769, 0.0682, 0.0902, 0.2289, 0.0698, 0.0850, 0.2387, 0.0663, 0.0402,
        0.0360])
[rfa agg] iter:  1, prev_obj_val: 41.06236267089844, obj_val: 57.526458740234375, abs dis: 16.464096069335938
[rfa agg] iter:  1, weight: tensor([0.1573, 0.0384, 0.1858, 0.0669, 0.0400, 0.1732, 0.0682, 0.0383, 0.1169,
        0.1148])
[rfa agg] iter:  2, prev_obj_val: 57.526458740234375, obj_val: 48.83464431762695, abs dis: 8.691814422607422
[rfa agg] iter:  2, weight: tensor([0.0994, 0.0760, 0.1164, 0.0944, 0.0799, 0.1097, 0.0961, 0.0772, 0.1317,
        0.1192])
[rfa agg] iter:  3, prev_obj_val: 48.83464431762695, obj_val: 48.81491470336914, abs dis: 0.0197296142578125
[rfa agg] iter:  3, weight: tensor([0.0997, 0.0529, 0.1169, 0.0747, 0.0552, 0.1101, 0.0761, 0.0532, 0.1838,
        0.1775])
[rfa agg] iter:  4, prev_obj_val: 48.81491470336914, obj_val: 48.81477355957031, abs dis: 0.000141143798828125
[rfa agg] iter:  4, weight: tensor([0.0977, 0.0511, 0.1145, 0.0725, 0.0534, 0.1078, 0.0738, 0.0514, 0.1921,
        0.1858])
___Test Target_ResNet_18 poisoned: False, epoch: 274: Average loss: 0.6220, Accuracy: 7986/10000 (79.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 274: Average loss: 5.9273, Accuracy: 531/9000 (5.9000%)
Done in 123.45481824874878 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:275 choose agents : [68, 60, 87, 9, 57, 40, 20, 39, 73, 48]. Adversary List: []
___Train Local_ResNet_18,  epoch 275, local model 68, internal_epoch   1,  Average loss: 0.0009, Accuracy: 414/416 (99.5192%)
___Train Local_ResNet_18,  epoch 275, local model 68, internal_epoch   2,  Average loss: 0.0003, Accuracy: 415/416 (99.7596%)
___Test Local_ResNet_18 poisoned: False, epoch: 275: Average loss: 0.9307, Accuracy: 7364/10000 (73.6400%)
___Train Local_ResNet_18,  epoch 275, local model 60, internal_epoch   1,  Average loss: 0.0008, Accuracy: 283/284 (99.6479%)
___Train Local_ResNet_18,  epoch 275, local model 60, internal_epoch   2,  Average loss: 0.0002, Accuracy: 284/284 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 275: Average loss: 0.8666, Accuracy: 7326/10000 (73.2600%)
___Train Local_ResNet_18,  epoch 275, local model 87, internal_epoch   1,  Average loss: 0.0028, Accuracy: 378/397 (95.2141%)
___Train Local_ResNet_18,  epoch 275, local model 87, internal_epoch   2,  Average loss: 0.0030, Accuracy: 380/397 (95.7179%)
___Test Local_ResNet_18 poisoned: False, epoch: 275: Average loss: 2.3861, Accuracy: 4887/10000 (48.8700%)
___Train Local_ResNet_18,  epoch 275, local model 9, internal_epoch   1,  Average loss: 0.0018, Accuracy: 361/368 (98.0978%)
___Train Local_ResNet_18,  epoch 275, local model 9, internal_epoch   2,  Average loss: 0.0010, Accuracy: 359/368 (97.5543%)
___Test Local_ResNet_18 poisoned: False, epoch: 275: Average loss: 4.8659, Accuracy: 3054/10000 (30.5400%)
___Train Local_ResNet_18,  epoch 275, local model 57, internal_epoch   1,  Average loss: 0.0013, Accuracy: 288/290 (99.3103%)
___Train Local_ResNet_18,  epoch 275, local model 57, internal_epoch   2,  Average loss: 0.0004, Accuracy: 289/290 (99.6552%)
___Test Local_ResNet_18 poisoned: False, epoch: 275: Average loss: 1.1238, Accuracy: 6955/10000 (69.5500%)
___Train Local_ResNet_18,  epoch 275, local model 40, internal_epoch   1,  Average loss: 0.0028, Accuracy: 631/652 (96.7791%)
___Train Local_ResNet_18,  epoch 275, local model 40, internal_epoch   2,  Average loss: 0.0151, Accuracy: 526/652 (80.6748%)
___Test Local_ResNet_18 poisoned: False, epoch: 275: Average loss: 32.6881, Accuracy: 1083/10000 (10.8300%)
___Train Local_ResNet_18,  epoch 275, local model 20, internal_epoch   1,  Average loss: 0.0019, Accuracy: 358/362 (98.8950%)
___Train Local_ResNet_18,  epoch 275, local model 20, internal_epoch   2,  Average loss: 0.0006, Accuracy: 358/362 (98.8950%)
___Test Local_ResNet_18 poisoned: False, epoch: 275: Average loss: 3.7965, Accuracy: 4825/10000 (48.2500%)
___Train Local_ResNet_18,  epoch 275, local model 39, internal_epoch   1,  Average loss: 0.0018, Accuracy: 211/217 (97.2350%)
___Train Local_ResNet_18,  epoch 275, local model 39, internal_epoch   2,  Average loss: 0.0006, Accuracy: 216/217 (99.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 275: Average loss: 1.2106, Accuracy: 6607/10000 (66.0700%)
___Train Local_ResNet_18,  epoch 275, local model 73, internal_epoch   1,  Average loss: 0.0073, Accuracy: 428/500 (85.6000%)
___Train Local_ResNet_18,  epoch 275, local model 73, internal_epoch   2,  Average loss: 0.0044, Accuracy: 463/500 (92.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 275: Average loss: 2.6795, Accuracy: 4358/10000 (43.5800%)
___Train Local_ResNet_18,  epoch 275, local model 48, internal_epoch   1,  Average loss: 0.0014, Accuracy: 375/378 (99.2063%)
___Train Local_ResNet_18,  epoch 275, local model 48, internal_epoch   2,  Average loss: 0.0004, Accuracy: 378/378 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 275: Average loss: 1.5587, Accuracy: 6064/10000 (60.6400%)
time spent on training: 64.84813117980957
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [416, 284, 397, 368, 290, 652, 362, 217, 500, 378]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [68, 60, 87, 9, 57, 40, 20, 39, 73, 48], weight: tensor([0.1077, 0.0735, 0.1027, 0.0952, 0.0751, 0.1687, 0.0937, 0.0562, 0.1294,
        0.0978])
[rfa agg] iter:  0, prev_obj_val: 20.745567321777344, obj_val: 32.35189437866211, abs dis: 11.606327056884766
[rfa agg] iter:  0, weight: tensor([0.0602, 0.2298, 0.0559, 0.0968, 0.2199, 0.0314, 0.0969, 0.0595, 0.0467,
        0.1030])
[rfa agg] iter:  1, prev_obj_val: 32.35189437866211, obj_val: 24.094966888427734, abs dis: 8.256927490234375
[rfa agg] iter:  1, weight: tensor([0.0729, 0.1158, 0.0688, 0.0895, 0.1179, 0.0524, 0.0883, 0.2353, 0.0665,
        0.0925])
[rfa agg] iter:  2, prev_obj_val: 24.094966888427734, obj_val: 36.75138473510742, abs dis: 12.656417846679688
[rfa agg] iter:  2, weight: tensor([0.0612, 0.1934, 0.0571, 0.0874, 0.1913, 0.0362, 0.0868, 0.1447, 0.0506,
        0.0913])
[rfa agg] iter:  3, prev_obj_val: 36.75138473510742, obj_val: 20.495819091796875, abs dis: 16.255565643310547
[rfa agg] iter:  3, weight: tensor([0.0835, 0.1138, 0.0790, 0.0978, 0.1160, 0.0644, 0.0965, 0.1695, 0.0787,
        0.1009])
[rfa agg] iter:  4, prev_obj_val: 20.495819091796875, obj_val: 41.18351745605469, abs dis: 20.687698364257812
[rfa agg] iter:  4, weight: tensor([0.0485, 0.2927, 0.0449, 0.0799, 0.2573, 0.0249, 0.0801, 0.0495, 0.0372,
        0.0849])
[rfa agg] iter:  5, prev_obj_val: 41.18351745605469, obj_val: 20.509878158569336, abs dis: 20.67363929748535
[rfa agg] iter:  5, weight: tensor([0.0895, 0.1100, 0.0848, 0.1013, 0.1122, 0.0732, 0.0998, 0.1382, 0.0865,
        0.1044])
[rfa agg] iter:  6, prev_obj_val: 20.509878158569336, obj_val: 41.182960510253906, abs dis: 20.67308235168457
[rfa agg] iter:  6, weight: tensor([0.0497, 0.2853, 0.0460, 0.0817, 0.2545, 0.0255, 0.0819, 0.0505, 0.0381,
        0.0869])
[rfa agg] iter:  7, prev_obj_val: 41.182960510253906, obj_val: 20.5098819732666, abs dis: 20.673078536987305
[rfa agg] iter:  7, weight: tensor([0.0895, 0.1100, 0.0848, 0.1013, 0.1122, 0.0732, 0.0998, 0.1382, 0.0865,
        0.1044])
[rfa agg] iter:  8, prev_obj_val: 20.5098819732666, obj_val: 41.182960510253906, abs dis: 20.673078536987305
[rfa agg] iter:  8, weight: tensor([0.0497, 0.2853, 0.0460, 0.0817, 0.2545, 0.0255, 0.0819, 0.0505, 0.0381,
        0.0869])
[rfa agg] iter:  9, prev_obj_val: 41.182960510253906, obj_val: 20.5098819732666, abs dis: 20.673078536987305
[rfa agg] iter:  9, weight: tensor([0.0895, 0.1100, 0.0848, 0.1013, 0.1122, 0.0732, 0.0998, 0.1382, 0.0865,
        0.1044])
___Test Target_ResNet_18 poisoned: False, epoch: 275: Average loss: 0.6204, Accuracy: 7976/10000 (79.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 275: Average loss: 5.9348, Accuracy: 538/9000 (5.9778%)
Done in 140.04339909553528 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:276 choose agents : [20, 11, 42, 73, 76, 87, 74, 85, 23, 48]. Adversary List: []
___Train Local_ResNet_18,  epoch 276, local model 20, internal_epoch   1,  Average loss: 0.0020, Accuracy: 354/362 (97.7901%)
___Train Local_ResNet_18,  epoch 276, local model 20, internal_epoch   2,  Average loss: 0.0007, Accuracy: 358/362 (98.8950%)
___Test Local_ResNet_18 poisoned: False, epoch: 276: Average loss: 3.3118, Accuracy: 4979/10000 (49.7900%)
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 276, local model 11, internal_epoch   1,  Average loss: 0.0013, Accuracy: 540/546 (98.9011%)
___Train Local_ResNet_18,  epoch 276, local model 11, internal_epoch   2,  Average loss: 0.0018, Accuracy: 534/546 (97.8022%)
___Test Local_ResNet_18 poisoned: False, epoch: 276: Average loss: 1.8421, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 276, local model 42, internal_epoch   1,  Average loss: 0.0021, Accuracy: 197/198 (99.4949%)
___Train Local_ResNet_18,  epoch 276, local model 42, internal_epoch   2,  Average loss: 0.0028, Accuracy: 192/198 (96.9697%)
___Test Local_ResNet_18 poisoned: False, epoch: 276: Average loss: 2.1329, Accuracy: 4854/10000 (48.5400%)
___Train Local_ResNet_18,  epoch 276, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 445/500 (89.0000%)
___Train Local_ResNet_18,  epoch 276, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 459/500 (91.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 276: Average loss: 3.7698, Accuracy: 3655/10000 (36.5500%)
___Train Local_ResNet_18,  epoch 276, local model 76, internal_epoch   1,  Average loss: 0.0308, Accuracy: 63/65 (96.9231%)
___Train Local_ResNet_18,  epoch 276, local model 76, internal_epoch   2,  Average loss: 0.0551, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 276: Average loss: 0.8745, Accuracy: 7423/10000 (74.2300%)
___Train Local_ResNet_18,  epoch 276, local model 87, internal_epoch   1,  Average loss: 0.0020, Accuracy: 391/397 (98.4887%)
___Train Local_ResNet_18,  epoch 276, local model 87, internal_epoch   2,  Average loss: 0.0007, Accuracy: 394/397 (99.2443%)
___Test Local_ResNet_18 poisoned: False, epoch: 276: Average loss: 5.4000, Accuracy: 2893/10000 (28.9300%)
___Train Local_ResNet_18,  epoch 276, local model 74, internal_epoch   1,  Average loss: 0.0019, Accuracy: 456/469 (97.2281%)
___Train Local_ResNet_18,  epoch 276, local model 74, internal_epoch   2,  Average loss: 0.0016, Accuracy: 455/469 (97.0149%)
___Test Local_ResNet_18 poisoned: False, epoch: 276: Average loss: 1.9446, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 276, local model 85, internal_epoch   1,  Average loss: 0.0013, Accuracy: 362/364 (99.4505%)
___Train Local_ResNet_18,  epoch 276, local model 85, internal_epoch   2,  Average loss: 0.0009, Accuracy: 358/364 (98.3516%)
___Test Local_ResNet_18 poisoned: False, epoch: 276: Average loss: 1.7916, Accuracy: 5961/10000 (59.6100%)
___Train Local_ResNet_18,  epoch 276, local model 23, internal_epoch   1,  Average loss: 0.0016, Accuracy: 243/248 (97.9839%)
___Train Local_ResNet_18,  epoch 276, local model 23, internal_epoch   2,  Average loss: 0.0008, Accuracy: 245/248 (98.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 276: Average loss: 0.9042, Accuracy: 7241/10000 (72.4100%)
___Train Local_ResNet_18,  epoch 276, local model 48, internal_epoch   1,  Average loss: 0.0017, Accuracy: 371/378 (98.1481%)
___Train Local_ResNet_18,  epoch 276, local model 48, internal_epoch   2,  Average loss: 0.0007, Accuracy: 375/378 (99.2063%)
___Test Local_ResNet_18 poisoned: False, epoch: 276: Average loss: 2.0597, Accuracy: 5283/10000 (52.8300%)
time spent on training: 69.15552043914795
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.15480578395236744  data num: [362, 546, 198, 500, 65, 397, 469, 364, 248, 378]
[rfa agg] considering poison per batch poison_fraction: 0.012094201871278706
[rfa agg] init. name: [20, 11, 42, 73, 76, 87, 74, 85, 23, 48], weight: tensor([0.1026, 0.1548, 0.0561, 0.1418, 0.0184, 0.1126, 0.1330, 0.1032, 0.0703,
        0.1072])
[rfa agg] iter:  0, prev_obj_val: 20.03074073791504, obj_val: 26.526411056518555, abs dis: 6.495670318603516
[rfa agg] iter:  0, weight: tensor([0.1585, 0.0645, 0.0823, 0.0759, 0.0103, 0.0917, 0.0731, 0.1634, 0.1126,
        0.1676])
[rfa agg] iter:  1, prev_obj_val: 26.526411056518555, obj_val: 43.2736701965332, abs dis: 16.74725914001465
[rfa agg] iter:  1, weight: tensor([0.0765, 0.0467, 0.1607, 0.0522, 0.0138, 0.0562, 0.0499, 0.0774, 0.3866,
        0.0801])
[rfa agg] iter:  2, prev_obj_val: 43.2736701965332, obj_val: 30.50385856628418, abs dis: 12.769811630249023
[rfa agg] iter:  2, weight: tensor([0.0872, 0.0754, 0.0933, 0.0796, 0.2140, 0.0765, 0.0753, 0.0879, 0.1196,
        0.0912])
[rfa agg] iter:  3, prev_obj_val: 30.50385856628418, obj_val: 23.134536743164062, abs dis: 7.369321823120117
[rfa agg] iter:  3, weight: tensor([0.0885, 0.0612, 0.1702, 0.0672, 0.0265, 0.0696, 0.0640, 0.0894, 0.2707,
        0.0926])
[rfa agg] iter:  4, prev_obj_val: 23.134536743164062, obj_val: 23.132591247558594, abs dis: 0.00194549560546875
[rfa agg] iter:  4, weight: tensor([0.1152, 0.0596, 0.1419, 0.0680, 0.0128, 0.0770, 0.0653, 0.1173, 0.2219,
        0.1209])
___Test Target_ResNet_18 poisoned: False, epoch: 276: Average loss: 0.6197, Accuracy: 7974/10000 (79.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 276: Average loss: 5.9290, Accuracy: 539/9000 (5.9889%)
Done in 133.0365228652954 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:277 choose agents : [41, 48, 71, 70, 84, 28, 96, 77, 17, 87]. Adversary List: []
___Train Local_ResNet_18,  epoch 277, local model 41, internal_epoch   1,  Average loss: 0.0138, Accuracy: 488/513 (95.1267%)
___Train Local_ResNet_18,  epoch 277, local model 41, internal_epoch   2,  Average loss: 0.0134, Accuracy: 407/513 (79.3372%)
___Test Local_ResNet_18 poisoned: False, epoch: 277: Average loss: 6.4569, Accuracy: 2543/10000 (25.4300%)
___Train Local_ResNet_18,  epoch 277, local model 48, internal_epoch   1,  Average loss: 0.0012, Accuracy: 375/378 (99.2063%)
___Train Local_ResNet_18,  epoch 277, local model 48, internal_epoch   2,  Average loss: 0.0008, Accuracy: 374/378 (98.9418%)
___Test Local_ResNet_18 poisoned: False, epoch: 277: Average loss: 1.8308, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 277, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 1115/1166 (95.6261%)
___Train Local_ResNet_18,  epoch 277, local model 71, internal_epoch   2,  Average loss: 0.0079, Accuracy: 991/1166 (84.9914%)
___Test Local_ResNet_18 poisoned: False, epoch: 277: Average loss: 7.7898, Accuracy: 2656/10000 (26.5600%)
___Train Local_ResNet_18,  epoch 277, local model 70, internal_epoch   1,  Average loss: 0.0016, Accuracy: 596/610 (97.7049%)
___Train Local_ResNet_18,  epoch 277, local model 70, internal_epoch   2,  Average loss: 0.0015, Accuracy: 591/610 (96.8852%)
___Test Local_ResNet_18 poisoned: False, epoch: 277: Average loss: 2.2349, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 277, local model 84, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1027/1053 (97.5309%)
___Train Local_ResNet_18,  epoch 277, local model 84, internal_epoch   2,  Average loss: 0.0028, Accuracy: 989/1053 (93.9221%)
___Test Local_ResNet_18 poisoned: False, epoch: 277: Average loss: 2.2343, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18,  epoch 277, local model 28, internal_epoch   1,  Average loss: 0.0006, Accuracy: 422/423 (99.7636%)
___Train Local_ResNet_18,  epoch 277, local model 28, internal_epoch   2,  Average loss: 0.0005, Accuracy: 420/423 (99.2908%)
___Test Local_ResNet_18 poisoned: False, epoch: 277: Average loss: 1.2607, Accuracy: 6925/10000 (69.2500%)
___Train Local_ResNet_18,  epoch 277, local model 96, internal_epoch   1,  Average loss: 0.0014, Accuracy: 703/708 (99.2938%)
___Train Local_ResNet_18,  epoch 277, local model 96, internal_epoch   2,  Average loss: 0.0193, Accuracy: 496/708 (70.0565%)
___Test Local_ResNet_18 poisoned: False, epoch: 277: Average loss: 310.3236, Accuracy: 993/10000 (9.9300%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 277, local model 77, internal_epoch   1,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%)
___Train Local_ResNet_18,  epoch 277, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%)
___Test Local_ResNet_18 poisoned: False, epoch: 277: Average loss: 1.1609, Accuracy: 6930/10000 (69.3000%)
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 277, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 520/526 (98.8593%)
___Train Local_ResNet_18,  epoch 277, local model 17, internal_epoch   2,  Average loss: 0.0021, Accuracy: 510/526 (96.9582%)
___Test Local_ResNet_18 poisoned: False, epoch: 277: Average loss: 1.3512, Accuracy: 6316/10000 (63.1600%)
___Train Local_ResNet_18,  epoch 277, local model 87, internal_epoch   1,  Average loss: 0.0022, Accuracy: 387/397 (97.4811%)
___Train Local_ResNet_18,  epoch 277, local model 87, internal_epoch   2,  Average loss: 0.0027, Accuracy: 383/397 (96.4736%)
___Test Local_ResNet_18 poisoned: False, epoch: 277: Average loss: 3.4675, Accuracy: 4347/10000 (43.4700%)
time spent on training: 78.15381217002869
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.16299840510366825  data num: [513, 378, 1166, 610, 1053, 423, 708, 496, 526, 397]
[rfa agg] considering poison per batch poison_fraction: 0.012734250398724082
[rfa agg] init. name: [41, 48, 71, 70, 84, 28, 96, 77, 17, 87], weight: tensor([0.0818, 0.0603, 0.1860, 0.0973, 0.1679, 0.0675, 0.1129, 0.0791, 0.0839,
        0.0633])
[rfa agg] iter:  0, prev_obj_val: 40.246307373046875, obj_val: 48.73879623413086, abs dis: 8.492488861083984
[rfa agg] iter:  0, weight: tensor([0.1465, 0.0412, 0.0385, 0.1564, 0.0435, 0.0679, 0.0622, 0.1430, 0.2389,
        0.0620])
[rfa agg] iter:  1, prev_obj_val: 48.73879623413086, obj_val: 48.62339401245117, abs dis: 0.1154022216796875
[rfa agg] iter:  1, weight: tensor([0.0655, 0.0984, 0.0275, 0.0567, 0.0299, 0.3046, 0.0364, 0.1314, 0.0728,
        0.1769])
[rfa agg] iter:  2, prev_obj_val: 48.62339401245117, obj_val: 64.64876556396484, abs dis: 16.025371551513672
[rfa agg] iter:  2, weight: tensor([0.0537, 0.0847, 0.0229, 0.0471, 0.0249, 0.3824, 0.0302, 0.1121, 0.0602,
        0.1817])
[rfa agg] iter:  3, prev_obj_val: 64.64876556396484, obj_val: 56.04879379272461, abs dis: 8.599971771240234
[rfa agg] iter:  3, weight: tensor([0.0792, 0.2275, 0.0529, 0.0773, 0.0559, 0.1345, 0.0609, 0.1052, 0.0833,
        0.1231])
[rfa agg] iter:  4, prev_obj_val: 56.04879379272461, obj_val: 56.0245246887207, abs dis: 0.02426910400390625
[rfa agg] iter:  4, weight: tensor([0.0571, 0.3735, 0.0316, 0.0533, 0.0338, 0.1421, 0.0388, 0.0865, 0.0611,
        0.1222])
[rfa agg] iter:  5, prev_obj_val: 56.0245246887207, obj_val: 64.64302825927734, abs dis: 8.61850357055664
[rfa agg] iter:  5, weight: tensor([0.0508, 0.4389, 0.0282, 0.0475, 0.0302, 0.1281, 0.0345, 0.0774, 0.0545,
        0.1099])
[rfa agg] iter:  6, prev_obj_val: 64.64302825927734, obj_val: 60.270145416259766, abs dis: 4.372882843017578
[rfa agg] iter:  6, weight: tensor([0.0787, 0.2338, 0.0526, 0.0768, 0.0556, 0.1330, 0.0606, 0.1045, 0.0828,
        0.1216])
[rfa agg] iter:  7, prev_obj_val: 60.270145416259766, obj_val: 56.033451080322266, abs dis: 4.2366943359375
[rfa agg] iter:  7, weight: tensor([0.0688, 0.3025, 0.0421, 0.0658, 0.0448, 0.1352, 0.0501, 0.0964, 0.0728,
        0.1214])
[rfa agg] iter:  8, prev_obj_val: 56.033451080322266, obj_val: 60.27125930786133, abs dis: 4.2378082275390625
[rfa agg] iter:  8, weight: tensor([0.0542, 0.4041, 0.0300, 0.0506, 0.0321, 0.1357, 0.0368, 0.0822, 0.0580,
        0.1165])
[rfa agg] iter:  9, prev_obj_val: 60.27125930786133, obj_val: 56.03143310546875, abs dis: 4.239826202392578
[rfa agg] iter:  9, weight: tensor([0.0668, 0.3208, 0.0410, 0.0640, 0.0436, 0.1320, 0.0486, 0.0939, 0.0708,
        0.1185])
___Test Target_ResNet_18 poisoned: False, epoch: 277: Average loss: 0.6190, Accuracy: 7966/10000 (79.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 277: Average loss: 5.9271, Accuracy: 541/9000 (6.0111%)
Done in 156.24850487709045 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:278 choose agents : [70, 47, 40, 19, 26, 10, 32, 75, 93, 24]. Adversary List: []
___Train Local_ResNet_18,  epoch 278, local model 70, internal_epoch   1,  Average loss: 0.0017, Accuracy: 591/610 (96.8852%)
___Train Local_ResNet_18,  epoch 278, local model 70, internal_epoch   2,  Average loss: 0.0012, Accuracy: 599/610 (98.1967%)
___Test Local_ResNet_18 poisoned: False, epoch: 278: Average loss: 2.0095, Accuracy: 4896/10000 (48.9600%)
___Train Local_ResNet_18,  epoch 278, local model 47, internal_epoch   1,  Average loss: 0.0011, Accuracy: 643/654 (98.3180%)
___Train Local_ResNet_18,  epoch 278, local model 47, internal_epoch   2,  Average loss: 0.0015, Accuracy: 639/654 (97.7064%)
___Test Local_ResNet_18 poisoned: False, epoch: 278: Average loss: 1.2448, Accuracy: 6659/10000 (66.5900%)
___Train Local_ResNet_18,  epoch 278, local model 40, internal_epoch   1,  Average loss: 0.0024, Accuracy: 636/652 (97.5460%)
___Train Local_ResNet_18,  epoch 278, local model 40, internal_epoch   2,  Average loss: 0.0194, Accuracy: 487/652 (74.6933%)
___Test Local_ResNet_18 poisoned: False, epoch: 278: Average loss: 109.6669, Accuracy: 1205/10000 (12.0500%)
___Train Local_ResNet_18,  epoch 278, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 155/173 (89.5954%)
___Train Local_ResNet_18,  epoch 278, local model 19, internal_epoch   2,  Average loss: 0.0016, Accuracy: 171/173 (98.8439%)
___Test Local_ResNet_18 poisoned: False, epoch: 278: Average loss: 3.9476, Accuracy: 4095/10000 (40.9500%)
___Train Local_ResNet_18,  epoch 278, local model 26, internal_epoch   1,  Average loss: 0.0008, Accuracy: 467/468 (99.7863%)
___Train Local_ResNet_18,  epoch 278, local model 26, internal_epoch   2,  Average loss: 0.0004, Accuracy: 466/468 (99.5726%)
___Test Local_ResNet_18 poisoned: False, epoch: 278: Average loss: 1.1290, Accuracy: 6764/10000 (67.6400%)
___Train Local_ResNet_18,  epoch 278, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 700/752 (93.0851%)
___Train Local_ResNet_18,  epoch 278, local model 10, internal_epoch   2,  Average loss: 0.0031, Accuracy: 704/752 (93.6170%)
___Test Local_ResNet_18 poisoned: False, epoch: 278: Average loss: 7.0478, Accuracy: 2753/10000 (27.5300%)
___Train Local_ResNet_18,  epoch 278, local model 32, internal_epoch   1,  Average loss: 0.0018, Accuracy: 800/824 (97.0874%)
___Train Local_ResNet_18,  epoch 278, local model 32, internal_epoch   2,  Average loss: 0.0023, Accuracy: 787/824 (95.5097%)
___Test Local_ResNet_18 poisoned: False, epoch: 278: Average loss: 2.0267, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 278, local model 75, internal_epoch   1,  Average loss: 0.0024, Accuracy: 565/578 (97.7509%)
___Train Local_ResNet_18,  epoch 278, local model 75, internal_epoch   2,  Average loss: 0.0128, Accuracy: 476/578 (82.3529%)
___Test Local_ResNet_18 poisoned: False, epoch: 278: Average loss: 25.6686, Accuracy: 1619/10000 (16.1900%)
___Train Local_ResNet_18,  epoch 278, local model 93, internal_epoch   1,  Average loss: 0.0008, Accuracy: 582/584 (99.6575%)
___Train Local_ResNet_18,  epoch 278, local model 93, internal_epoch   2,  Average loss: 0.0002, Accuracy: 583/584 (99.8288%)
___Test Local_ResNet_18 poisoned: False, epoch: 278: Average loss: 1.3852, Accuracy: 6441/10000 (64.4100%)
___Train Local_ResNet_18,  epoch 278, local model 24, internal_epoch   1,  Average loss: 0.0017, Accuracy: 314/320 (98.1250%)
___Train Local_ResNet_18,  epoch 278, local model 24, internal_epoch   2,  Average loss: 0.0002, Accuracy: 320/320 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 278: Average loss: 1.5752, Accuracy: 5894/10000 (58.9400%)
time spent on training: 64.54366755485535
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [610, 654, 652, 173, 468, 752, 824, 578, 584, 320]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [70, 47, 40, 19, 26, 10, 32, 75, 93, 24], weight: tensor([0.1086, 0.1165, 0.1161, 0.0308, 0.0833, 0.1339, 0.1467, 0.1029, 0.1040,
        0.0570])
[rfa agg] iter:  0, prev_obj_val: 25.323789596557617, obj_val: 31.36774444580078, abs dis: 6.043954849243164
[rfa agg] iter:  0, weight: tensor([0.1387, 0.0960, 0.0794, 0.0119, 0.2507, 0.0777, 0.0684, 0.1025, 0.1401,
        0.0345])
[rfa agg] iter:  1, prev_obj_val: 31.36774444580078, obj_val: 34.841270446777344, abs dis: 3.4735260009765625
[rfa agg] iter:  1, weight: tensor([0.1062, 0.0829, 0.0735, 0.0173, 0.3308, 0.0728, 0.0666, 0.0891, 0.1038,
        0.0570])
[rfa agg] iter:  2, prev_obj_val: 34.841270446777344, obj_val: 41.96200942993164, abs dis: 7.120738983154297
[rfa agg] iter:  2, weight: tensor([0.1104, 0.0900, 0.0817, 0.0240, 0.2461, 0.0815, 0.0757, 0.0955, 0.1074,
        0.0876])
[rfa agg] iter:  3, prev_obj_val: 41.96200942993164, obj_val: 45.57927703857422, abs dis: 3.617267608642578
[rfa agg] iter:  3, weight: tensor([0.0997, 0.0861, 0.0807, 0.0378, 0.1525, 0.0816, 0.0775, 0.0896, 0.0963,
        0.1981])
[rfa agg] iter:  4, prev_obj_val: 45.57927703857422, obj_val: 45.5750846862793, abs dis: 0.004192352294921875
[rfa agg] iter:  4, weight: tensor([0.0831, 0.0733, 0.0694, 0.0423, 0.1146, 0.0706, 0.0677, 0.0754, 0.0801,
        0.3236])
___Test Target_ResNet_18 poisoned: False, epoch: 278: Average loss: 0.6165, Accuracy: 7992/10000 (79.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 278: Average loss: 6.0537, Accuracy: 470/9000 (5.2222%)
Done in 131.13465070724487 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:279 choose agents : [43, 60, 3, 89, 87, 20, 66, 54, 27, 90]. Adversary List: []
___Train Local_ResNet_18,  epoch 279, local model 43, internal_epoch   1,  Average loss: 0.0032, Accuracy: 326/345 (94.4928%)
___Train Local_ResNet_18,  epoch 279, local model 43, internal_epoch   2,  Average loss: 0.0014, Accuracy: 342/345 (99.1304%)
___Test Local_ResNet_18 poisoned: False, epoch: 279: Average loss: 3.9260, Accuracy: 4319/10000 (43.1900%)
___Train Local_ResNet_18,  epoch 279, local model 60, internal_epoch   1,  Average loss: 0.0005, Accuracy: 283/284 (99.6479%)
___Train Local_ResNet_18,  epoch 279, local model 60, internal_epoch   2,  Average loss: 0.0003, Accuracy: 283/284 (99.6479%)
___Test Local_ResNet_18 poisoned: False, epoch: 279: Average loss: 0.7119, Accuracy: 7789/10000 (77.8900%)
___Train Local_ResNet_18,  epoch 279, local model 3, internal_epoch   1,  Average loss: 0.0043, Accuracy: 726/780 (93.0769%)
___Train Local_ResNet_18,  epoch 279, local model 3, internal_epoch   2,  Average loss: 0.0132, Accuracy: 621/780 (79.6154%)
___Test Local_ResNet_18 poisoned: False, epoch: 279: Average loss: 133.3311, Accuracy: 1259/10000 (12.5900%)
___Train Local_ResNet_18,  epoch 279, local model 89, internal_epoch   1,  Average loss: 0.0026, Accuracy: 394/413 (95.3995%)
___Train Local_ResNet_18,  epoch 279, local model 89, internal_epoch   2,  Average loss: 0.0038, Accuracy: 393/413 (95.1574%)
___Test Local_ResNet_18 poisoned: False, epoch: 279: Average loss: 3.4773, Accuracy: 3597/10000 (35.9700%)
___Train Local_ResNet_18,  epoch 279, local model 87, internal_epoch   1,  Average loss: 0.0033, Accuracy: 375/397 (94.4584%)
___Train Local_ResNet_18,  epoch 279, local model 87, internal_epoch   2,  Average loss: 0.0035, Accuracy: 370/397 (93.1990%)
___Test Local_ResNet_18 poisoned: False, epoch: 279: Average loss: 3.0049, Accuracy: 4564/10000 (45.6400%)
___Train Local_ResNet_18,  epoch 279, local model 20, internal_epoch   1,  Average loss: 0.0021, Accuracy: 347/362 (95.8564%)
___Train Local_ResNet_18,  epoch 279, local model 20, internal_epoch   2,  Average loss: 0.0014, Accuracy: 352/362 (97.2376%)
___Test Local_ResNet_18 poisoned: False, epoch: 279: Average loss: 4.2672, Accuracy: 4502/10000 (45.0200%)
___Train Local_ResNet_18,  epoch 279, local model 66, internal_epoch   1,  Average loss: 0.0015, Accuracy: 542/555 (97.6577%)
___Train Local_ResNet_18,  epoch 279, local model 66, internal_epoch   2,  Average loss: 0.0008, Accuracy: 547/555 (98.5586%)
___Test Local_ResNet_18 poisoned: False, epoch: 279: Average loss: 3.2736, Accuracy: 4582/10000 (45.8200%)
___Train Local_ResNet_18,  epoch 279, local model 54, internal_epoch   1,  Average loss: 0.0014, Accuracy: 435/440 (98.8636%)
___Train Local_ResNet_18,  epoch 279, local model 54, internal_epoch   2,  Average loss: 0.0005, Accuracy: 436/440 (99.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 279: Average loss: 2.2890, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 279, local model 27, internal_epoch   1,  Average loss: 0.0010, Accuracy: 394/397 (99.2443%)
___Train Local_ResNet_18,  epoch 279, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 397/397 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 279: Average loss: 1.1772, Accuracy: 6737/10000 (67.3700%)
___Train Local_ResNet_18,  epoch 279, local model 90, internal_epoch   1,  Average loss: 0.0039, Accuracy: 533/578 (92.2145%)
___Train Local_ResNet_18,  epoch 279, local model 90, internal_epoch   2,  Average loss: 0.0106, Accuracy: 539/578 (93.2526%)
___Test Local_ResNet_18 poisoned: False, epoch: 279: Average loss: 11.3645, Accuracy: 1295/10000 (12.9500%)
time spent on training: 64.06576633453369
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [345, 284, 780, 413, 397, 362, 555, 440, 397, 578]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [43, 60, 3, 89, 87, 20, 66, 54, 27, 90], weight: tensor([0.0758, 0.0624, 0.1714, 0.0907, 0.0872, 0.0795, 0.1220, 0.0967, 0.0872,
        0.1270])
[rfa agg] iter:  0, prev_obj_val: 24.55632781982422, obj_val: 39.90164566040039, abs dis: 15.345317840576172
[rfa agg] iter:  0, weight: tensor([0.1618, 0.0827, 0.0342, 0.1022, 0.0943, 0.1902, 0.0571, 0.1212, 0.1123,
        0.0438])
[rfa agg] iter:  1, prev_obj_val: 39.90164566040039, obj_val: 31.309528350830078, abs dis: 8.592117309570312
[rfa agg] iter:  1, weight: tensor([0.1152, 0.1911, 0.0585, 0.0926, 0.0883, 0.1222, 0.0761, 0.1002, 0.0907,
        0.0651])
[rfa agg] iter:  2, prev_obj_val: 31.309528350830078, obj_val: 48.71076202392578, abs dis: 17.401233673095703
[rfa agg] iter:  2, weight: tensor([0.1001, 0.4147, 0.0315, 0.0646, 0.0612, 0.1089, 0.0455, 0.0713, 0.0648,
        0.0373])
[rfa agg] iter:  3, prev_obj_val: 48.71076202392578, obj_val: 31.329639434814453, abs dis: 17.381122589111328
[rfa agg] iter:  3, weight: tensor([0.1097, 0.1373, 0.0742, 0.0986, 0.0943, 0.1157, 0.0893, 0.1061, 0.0959,
        0.0789])
[rfa agg] iter:  4, prev_obj_val: 31.329639434814453, obj_val: 48.70929718017578, abs dis: 17.379657745361328
[rfa agg] iter:  4, weight: tensor([0.1047, 0.3856, 0.0332, 0.0680, 0.0643, 0.1139, 0.0479, 0.0749, 0.0682,
        0.0393])
[rfa agg] iter:  5, prev_obj_val: 48.70929718017578, obj_val: 31.329647064208984, abs dis: 17.379650115966797
[rfa agg] iter:  5, weight: tensor([0.1097, 0.1373, 0.0742, 0.0986, 0.0943, 0.1157, 0.0893, 0.1061, 0.0959,
        0.0789])
[rfa agg] iter:  6, prev_obj_val: 31.329647064208984, obj_val: 48.70929718017578, abs dis: 17.379650115966797
[rfa agg] iter:  6, weight: tensor([0.1047, 0.3856, 0.0332, 0.0680, 0.0643, 0.1139, 0.0479, 0.0749, 0.0682,
        0.0393])
[rfa agg] iter:  7, prev_obj_val: 48.70929718017578, obj_val: 31.329647064208984, abs dis: 17.379650115966797
[rfa agg] iter:  7, weight: tensor([0.1097, 0.1373, 0.0742, 0.0986, 0.0943, 0.1157, 0.0893, 0.1061, 0.0959,
        0.0789])
[rfa agg] iter:  8, prev_obj_val: 31.329647064208984, obj_val: 48.70929718017578, abs dis: 17.379650115966797
[rfa agg] iter:  8, weight: tensor([0.1047, 0.3856, 0.0332, 0.0680, 0.0643, 0.1139, 0.0479, 0.0749, 0.0682,
        0.0393])
[rfa agg] iter:  9, prev_obj_val: 48.70929718017578, obj_val: 31.329647064208984, abs dis: 17.379650115966797
[rfa agg] iter:  9, weight: tensor([0.1097, 0.1373, 0.0742, 0.0986, 0.0943, 0.1157, 0.0893, 0.1061, 0.0959,
        0.0789])
___Test Target_ResNet_18 poisoned: False, epoch: 279: Average loss: 0.6158, Accuracy: 7997/10000 (79.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 279: Average loss: 6.0667, Accuracy: 455/9000 (5.0556%)
Done in 141.042466878891 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:280 choose agents : [37, 13, 78, 67, 65, 16, 82, 33, 3, 46]. Adversary List: []
___Train Local_ResNet_18,  epoch 280, local model 37, internal_epoch   1,  Average loss: 0.0032, Accuracy: 682/725 (94.0690%)
___Train Local_ResNet_18,  epoch 280, local model 37, internal_epoch   2,  Average loss: 0.0087, Accuracy: 614/725 (84.6897%)
___Test Local_ResNet_18 poisoned: False, epoch: 280: Average loss: 7.4835, Accuracy: 2369/10000 (23.6900%)
___Train Local_ResNet_18,  epoch 280, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 583/620 (94.0323%)
___Train Local_ResNet_18,  epoch 280, local model 13, internal_epoch   2,  Average loss: 0.0038, Accuracy: 580/620 (93.5484%)
___Test Local_ResNet_18 poisoned: False, epoch: 280: Average loss: 4.4429, Accuracy: 3055/10000 (30.5500%)
___Train Local_ResNet_18,  epoch 280, local model 78, internal_epoch   1,  Average loss: 0.0016, Accuracy: 249/255 (97.6471%)
___Train Local_ResNet_18,  epoch 280, local model 78, internal_epoch   2,  Average loss: 0.0007, Accuracy: 254/255 (99.6078%)
___Test Local_ResNet_18 poisoned: False, epoch: 280: Average loss: 1.8248, Accuracy: 5968/10000 (59.6800%)
___Train Local_ResNet_18,  epoch 280, local model 67, internal_epoch   1,  Average loss: 0.0020, Accuracy: 810/842 (96.1995%)
___Train Local_ResNet_18,  epoch 280, local model 67, internal_epoch   2,  Average loss: 0.0071, Accuracy: 729/842 (86.5796%)
___Test Local_ResNet_18 poisoned: False, epoch: 280: Average loss: 7.3457, Accuracy: 2002/10000 (20.0200%)
___Train Local_ResNet_18,  epoch 280, local model 65, internal_epoch   1,  Average loss: 0.0010, Accuracy: 314/314 (100.0000%)
___Train Local_ResNet_18,  epoch 280, local model 65, internal_epoch   2,  Average loss: 0.0002, Accuracy: 314/314 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 280: Average loss: 0.9672, Accuracy: 7254/10000 (72.5400%)
___Train Local_ResNet_18,  epoch 280, local model 16, internal_epoch   1,  Average loss: 0.0016, Accuracy: 764/773 (98.8357%)
___Train Local_ResNet_18,  epoch 280, local model 16, internal_epoch   2,  Average loss: 0.0117, Accuracy: 618/773 (79.9483%)
___Test Local_ResNet_18 poisoned: False, epoch: 280: Average loss: 15.6233, Accuracy: 2045/10000 (20.4500%)
___Train Local_ResNet_18,  epoch 280, local model 82, internal_epoch   1,  Average loss: 0.0011, Accuracy: 591/601 (98.3361%)
___Train Local_ResNet_18,  epoch 280, local model 82, internal_epoch   2,  Average loss: 0.0007, Accuracy: 598/601 (99.5008%)
___Test Local_ResNet_18 poisoned: False, epoch: 280: Average loss: 1.8745, Accuracy: 5559/10000 (55.5900%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 280, local model 33, internal_epoch   1,  Average loss: 0.0015, Accuracy: 520/527 (98.6717%)
___Train Local_ResNet_18,  epoch 280, local model 33, internal_epoch   2,  Average loss: 0.0025, Accuracy: 511/527 (96.9639%)
___Test Local_ResNet_18 poisoned: False, epoch: 280: Average loss: 2.0199, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 280, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 730/780 (93.5897%)
___Train Local_ResNet_18,  epoch 280, local model 3, internal_epoch   2,  Average loss: 0.0169, Accuracy: 592/780 (75.8974%)
___Test Local_ResNet_18 poisoned: False, epoch: 280: Average loss: 37.4595, Accuracy: 1710/10000 (17.1000%)
___Train Local_ResNet_18,  epoch 280, local model 46, internal_epoch   1,  Average loss: 0.0009, Accuracy: 593/601 (98.6689%)
___Train Local_ResNet_18,  epoch 280, local model 46, internal_epoch   2,  Average loss: 0.0004, Accuracy: 598/601 (99.5008%)
___Test Local_ResNet_18 poisoned: False, epoch: 280: Average loss: 1.3263, Accuracy: 6301/10000 (63.0100%)
time spent on training: 71.81953263282776
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.08728055647565419  data num: [725, 620, 255, 842, 314, 773, 601, 527, 780, 601]
[rfa agg] considering poison per batch poison_fraction: 0.006818793474660484
[rfa agg] init. name: [37, 13, 78, 67, 65, 16, 82, 33, 3, 46], weight: tensor([0.1201, 0.1027, 0.0422, 0.1395, 0.0520, 0.1280, 0.0995, 0.0873, 0.1292,
        0.0995])
[rfa agg] iter:  0, prev_obj_val: 34.146263122558594, obj_val: 40.970882415771484, abs dis: 6.824619293212891
[rfa agg] iter:  0, weight: tensor([0.0849, 0.1370, 0.0311, 0.0675, 0.0508, 0.0726, 0.1396, 0.2040, 0.0715,
        0.1409])
[rfa agg] iter:  1, prev_obj_val: 40.970882415771484, obj_val: 34.07205581665039, abs dis: 6.898826599121094
[rfa agg] iter:  1, weight: tensor([0.0884, 0.1248, 0.0531, 0.0743, 0.0971, 0.0782, 0.1239, 0.1585, 0.0774,
        0.1243])
[rfa agg] iter:  2, prev_obj_val: 34.07205581665039, obj_val: 40.9716682434082, abs dis: 6.8996124267578125
[rfa agg] iter:  2, weight: tensor([0.0834, 0.1366, 0.0307, 0.0661, 0.0502, 0.0710, 0.1392, 0.2128, 0.0697,
        0.1403])
[rfa agg] iter:  3, prev_obj_val: 40.9716682434082, obj_val: 34.07203674316406, abs dis: 6.899631500244141
[rfa agg] iter:  3, weight: tensor([0.0884, 0.1248, 0.0530, 0.0743, 0.0971, 0.0782, 0.1239, 0.1586, 0.0774,
        0.1243])
[rfa agg] iter:  4, prev_obj_val: 34.07203674316406, obj_val: 40.97166442871094, abs dis: 6.899627685546875
[rfa agg] iter:  4, weight: tensor([0.0834, 0.1366, 0.0307, 0.0661, 0.0502, 0.0710, 0.1392, 0.2128, 0.0697,
        0.1403])
[rfa agg] iter:  5, prev_obj_val: 40.97166442871094, obj_val: 34.07203674316406, abs dis: 6.899627685546875
[rfa agg] iter:  5, weight: tensor([0.0884, 0.1248, 0.0530, 0.0743, 0.0971, 0.0782, 0.1239, 0.1586, 0.0774,
        0.1243])
[rfa agg] iter:  6, prev_obj_val: 34.07203674316406, obj_val: 40.97166442871094, abs dis: 6.899627685546875
[rfa agg] iter:  6, weight: tensor([0.0834, 0.1366, 0.0307, 0.0661, 0.0502, 0.0710, 0.1392, 0.2128, 0.0697,
        0.1403])
[rfa agg] iter:  7, prev_obj_val: 40.97166442871094, obj_val: 34.07203674316406, abs dis: 6.899627685546875
[rfa agg] iter:  7, weight: tensor([0.0884, 0.1248, 0.0530, 0.0743, 0.0971, 0.0782, 0.1239, 0.1586, 0.0774,
        0.1243])
[rfa agg] iter:  8, prev_obj_val: 34.07203674316406, obj_val: 40.97166442871094, abs dis: 6.899627685546875
[rfa agg] iter:  8, weight: tensor([0.0834, 0.1366, 0.0307, 0.0661, 0.0502, 0.0710, 0.1392, 0.2128, 0.0697,
        0.1403])
[rfa agg] iter:  9, prev_obj_val: 40.97166442871094, obj_val: 34.07203674316406, abs dis: 6.899627685546875
[rfa agg] iter:  9, weight: tensor([0.0884, 0.1248, 0.0530, 0.0743, 0.0971, 0.0782, 0.1239, 0.1586, 0.0774,
        0.1243])
___Test Target_ResNet_18 poisoned: False, epoch: 280: Average loss: 0.6166, Accuracy: 8003/10000 (80.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 280: Average loss: 6.0508, Accuracy: 445/9000 (4.9444%)
Done in 141.90052771568298 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:281 choose agents : [35, 74, 98, 38, 82, 6, 15, 71, 65, 57]. Adversary List: []
___Train Local_ResNet_18,  epoch 281, local model 35, internal_epoch   1,  Average loss: 0.0028, Accuracy: 401/419 (95.7041%)
___Train Local_ResNet_18,  epoch 281, local model 35, internal_epoch   2,  Average loss: 0.0019, Accuracy: 406/419 (96.8974%)
___Test Local_ResNet_18 poisoned: False, epoch: 281: Average loss: 4.5036, Accuracy: 2932/10000 (29.3200%)
___Train Local_ResNet_18,  epoch 281, local model 74, internal_epoch   1,  Average loss: 0.0012, Accuracy: 466/469 (99.3603%)
___Train Local_ResNet_18,  epoch 281, local model 74, internal_epoch   2,  Average loss: 0.0005, Accuracy: 465/469 (99.1471%)
___Test Local_ResNet_18 poisoned: False, epoch: 281: Average loss: 1.8836, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 281, local model 98, internal_epoch   1,  Average loss: 0.0034, Accuracy: 748/802 (93.2668%)
___Train Local_ResNet_18,  epoch 281, local model 98, internal_epoch   2,  Average loss: 0.0079, Accuracy: 679/802 (84.6633%)
___Test Local_ResNet_18 poisoned: False, epoch: 281: Average loss: 8.5036, Accuracy: 2469/10000 (24.6900%)
___Train Local_ResNet_18,  epoch 281, local model 38, internal_epoch   1,  Average loss: 0.0016, Accuracy: 740/756 (97.8836%)
___Train Local_ResNet_18,  epoch 281, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 703/756 (92.9894%)
___Test Local_ResNet_18 poisoned: False, epoch: 281: Average loss: 3.7851, Accuracy: 3839/10000 (38.3900%)
___Train Local_ResNet_18,  epoch 281, local model 82, internal_epoch   1,  Average loss: 0.0010, Accuracy: 596/601 (99.1681%)
___Train Local_ResNet_18,  epoch 281, local model 82, internal_epoch   2,  Average loss: 0.0010, Accuracy: 590/601 (98.1697%)
___Test Local_ResNet_18 poisoned: False, epoch: 281: Average loss: 2.2742, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 281, local model 6, internal_epoch   1,  Average loss: 0.0016, Accuracy: 511/520 (98.2692%)
___Train Local_ResNet_18,  epoch 281, local model 6, internal_epoch   2,  Average loss: 0.0072, Accuracy: 467/520 (89.8077%)
___Test Local_ResNet_18 poisoned: False, epoch: 281: Average loss: 9.7255, Accuracy: 1603/10000 (16.0300%)
___Train Local_ResNet_18,  epoch 281, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 327/341 (95.8944%)
___Train Local_ResNet_18,  epoch 281, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 324/341 (95.0147%)
___Test Local_ResNet_18 poisoned: False, epoch: 281: Average loss: 6.5037, Accuracy: 2016/10000 (20.1600%)
___Train Local_ResNet_18,  epoch 281, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 1123/1166 (96.3122%)
___Train Local_ResNet_18,  epoch 281, local model 71, internal_epoch   2,  Average loss: 0.0127, Accuracy: 915/1166 (78.4734%)
___Test Local_ResNet_18 poisoned: False, epoch: 281: Average loss: 39.1082, Accuracy: 1357/10000 (13.5700%)
___Train Local_ResNet_18,  epoch 281, local model 65, internal_epoch   1,  Average loss: 0.0009, Accuracy: 314/314 (100.0000%)
___Train Local_ResNet_18,  epoch 281, local model 65, internal_epoch   2,  Average loss: 0.0002, Accuracy: 314/314 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 281: Average loss: 0.9018, Accuracy: 7456/10000 (74.5600%)
___Train Local_ResNet_18,  epoch 281, local model 57, internal_epoch   1,  Average loss: 0.0010, Accuracy: 289/290 (99.6552%)
___Train Local_ResNet_18,  epoch 281, local model 57, internal_epoch   2,  Average loss: 0.0003, Accuracy: 290/290 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 281: Average loss: 0.9869, Accuracy: 7185/10000 (71.8500%)
time spent on training: 65.89585518836975
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [419, 469, 802, 756, 601, 520, 341, 1166, 314, 290]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [35, 74, 98, 38, 82, 6, 15, 71, 65, 57], weight: tensor([0.0738, 0.0826, 0.1412, 0.1331, 0.1058, 0.0916, 0.0601, 0.2054, 0.0553,
        0.0511])
[rfa agg] iter:  0, prev_obj_val: 37.922664642333984, obj_val: 42.49181365966797, abs dis: 4.569149017333984
[rfa agg] iter:  0, weight: tensor([0.0844, 0.1674, 0.0826, 0.1037, 0.2055, 0.1939, 0.0475, 0.0499, 0.0339,
        0.0313])
[rfa agg] iter:  1, prev_obj_val: 42.49181365966797, obj_val: 50.632904052734375, abs dis: 8.141090393066406
[rfa agg] iter:  1, weight: tensor([0.1959, 0.2652, 0.0553, 0.0644, 0.0919, 0.1152, 0.0796, 0.0389, 0.0487,
        0.0450])
[rfa agg] iter:  2, prev_obj_val: 50.632904052734375, obj_val: 50.59808349609375, abs dis: 0.034820556640625
[rfa agg] iter:  2, weight: tensor([0.1595, 0.1006, 0.0490, 0.0543, 0.0649, 0.0717, 0.2096, 0.0385, 0.1308,
        0.1210])
[rfa agg] iter:  3, prev_obj_val: 50.59808349609375, obj_val: 50.596923828125, abs dis: 0.00115966796875
[rfa agg] iter:  3, weight: tensor([0.1527, 0.0964, 0.0472, 0.0523, 0.0626, 0.0688, 0.2387, 0.0371, 0.1269,
        0.1172])
[rfa agg] iter:  4, prev_obj_val: 50.596923828125, obj_val: 50.59685134887695, abs dis: 7.2479248046875e-05
[rfa agg] iter:  4, weight: tensor([0.1509, 0.0956, 0.0469, 0.0519, 0.0621, 0.0682, 0.2460, 0.0368, 0.1256,
        0.1161])
___Test Target_ResNet_18 poisoned: False, epoch: 281: Average loss: 0.6255, Accuracy: 7955/10000 (79.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 281: Average loss: 5.9879, Accuracy: 442/9000 (4.9111%)
Done in 127.89986038208008 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:282 choose agents : [43, 72, 83, 9, 7, 27, 11, 15, 20, 26]. Adversary List: []
___Train Local_ResNet_18,  epoch 282, local model 43, internal_epoch   1,  Average loss: 0.0022, Accuracy: 335/345 (97.1014%)
___Train Local_ResNet_18,  epoch 282, local model 43, internal_epoch   2,  Average loss: 0.0019, Accuracy: 336/345 (97.3913%)
___Test Local_ResNet_18 poisoned: False, epoch: 282: Average loss: 3.8614, Accuracy: 4784/10000 (47.8400%)
___Train Local_ResNet_18,  epoch 282, local model 72, internal_epoch   1,  Average loss: 0.0041, Accuracy: 575/618 (93.0421%)
___Train Local_ResNet_18,  epoch 282, local model 72, internal_epoch   2,  Average loss: 0.0052, Accuracy: 574/618 (92.8803%)
___Test Local_ResNet_18 poisoned: False, epoch: 282: Average loss: 20.5112, Accuracy: 1248/10000 (12.4800%)
___Train Local_ResNet_18,  epoch 282, local model 83, internal_epoch   1,  Average loss: 0.0006, Accuracy: 366/366 (100.0000%)
___Train Local_ResNet_18,  epoch 282, local model 83, internal_epoch   2,  Average loss: 0.0002, Accuracy: 366/366 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 282: Average loss: 0.7774, Accuracy: 7593/10000 (75.9300%)
___Train Local_ResNet_18,  epoch 282, local model 9, internal_epoch   1,  Average loss: 0.0012, Accuracy: 367/368 (99.7283%)
___Train Local_ResNet_18,  epoch 282, local model 9, internal_epoch   2,  Average loss: 0.0002, Accuracy: 368/368 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 282: Average loss: 3.5786, Accuracy: 4355/10000 (43.5500%)
___Train Local_ResNet_18,  epoch 282, local model 7, internal_epoch   1,  Average loss: 0.0012, Accuracy: 345/352 (98.0114%)
___Train Local_ResNet_18,  epoch 282, local model 7, internal_epoch   2,  Average loss: 0.0003, Accuracy: 351/352 (99.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 282: Average loss: 1.3655, Accuracy: 6184/10000 (61.8400%)
___Train Local_ResNet_18,  epoch 282, local model 27, internal_epoch   1,  Average loss: 0.0007, Accuracy: 397/397 (100.0000%)
___Train Local_ResNet_18,  epoch 282, local model 27, internal_epoch   2,  Average loss: 0.0004, Accuracy: 396/397 (99.7481%)
___Test Local_ResNet_18 poisoned: False, epoch: 282: Average loss: 0.9807, Accuracy: 7091/10000 (70.9100%)
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 282, local model 11, internal_epoch   1,  Average loss: 0.0013, Accuracy: 543/546 (99.4505%)
___Train Local_ResNet_18,  epoch 282, local model 11, internal_epoch   2,  Average loss: 0.0010, Accuracy: 537/546 (98.3516%)
___Test Local_ResNet_18 poisoned: False, epoch: 282: Average loss: 1.7426, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 282, local model 15, internal_epoch   1,  Average loss: 0.0017, Accuracy: 334/341 (97.9472%)
___Train Local_ResNet_18,  epoch 282, local model 15, internal_epoch   2,  Average loss: 0.0005, Accuracy: 338/341 (99.1202%)
___Test Local_ResNet_18 poisoned: False, epoch: 282: Average loss: 3.0781, Accuracy: 4586/10000 (45.8600%)
___Train Local_ResNet_18,  epoch 282, local model 20, internal_epoch   1,  Average loss: 0.0022, Accuracy: 350/362 (96.6851%)
___Train Local_ResNet_18,  epoch 282, local model 20, internal_epoch   2,  Average loss: 0.0012, Accuracy: 356/362 (98.3425%)
___Test Local_ResNet_18 poisoned: False, epoch: 282: Average loss: 3.6241, Accuracy: 4693/10000 (46.9300%)
___Train Local_ResNet_18,  epoch 282, local model 26, internal_epoch   1,  Average loss: 0.0008, Accuracy: 465/468 (99.3590%)
___Train Local_ResNet_18,  epoch 282, local model 26, internal_epoch   2,  Average loss: 0.0003, Accuracy: 468/468 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 282: Average loss: 1.1860, Accuracy: 6906/10000 (69.0600%)
time spent on training: 72.2818078994751
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.13115541676675474  data num: [345, 618, 366, 368, 352, 397, 546, 341, 362, 468]
[rfa agg] considering poison per batch poison_fraction: 0.010246516934902715
[rfa agg] init. name: [43, 72, 83, 9, 7, 27, 11, 15, 20, 26], weight: tensor([0.0829, 0.1485, 0.0879, 0.0884, 0.0846, 0.0954, 0.1312, 0.0819, 0.0870,
        0.1124])
[rfa agg] iter:  0, prev_obj_val: 21.214027404785156, obj_val: 34.35071563720703, abs dis: 13.136688232421875
[rfa agg] iter:  0, weight: tensor([0.1191, 0.0469, 0.1364, 0.1342, 0.1273, 0.0759, 0.0524, 0.1215, 0.1264,
        0.0599])
[rfa agg] iter:  1, prev_obj_val: 34.35071563720703, obj_val: 21.16924285888672, abs dis: 13.181472778320312
[rfa agg] iter:  1, weight: tensor([0.1082, 0.0747, 0.1163, 0.1165, 0.1113, 0.0902, 0.0788, 0.1075, 0.1138,
        0.0827])
[rfa agg] iter:  2, prev_obj_val: 21.16924285888672, obj_val: 34.350807189941406, abs dis: 13.181564331054688
[rfa agg] iter:  2, weight: tensor([0.1195, 0.0463, 0.1368, 0.1347, 0.1277, 0.0753, 0.0519, 0.1215, 0.1270,
        0.0594])
[rfa agg] iter:  3, prev_obj_val: 34.350807189941406, obj_val: 21.16924285888672, abs dis: 13.181564331054688
[rfa agg] iter:  3, weight: tensor([0.1082, 0.0747, 0.1163, 0.1165, 0.1113, 0.0902, 0.0788, 0.1075, 0.1138,
        0.0827])
[rfa agg] iter:  4, prev_obj_val: 21.16924285888672, obj_val: 34.350807189941406, abs dis: 13.181564331054688
[rfa agg] iter:  4, weight: tensor([0.1195, 0.0463, 0.1368, 0.1347, 0.1277, 0.0753, 0.0519, 0.1215, 0.1270,
        0.0594])
[rfa agg] iter:  5, prev_obj_val: 34.350807189941406, obj_val: 21.16924285888672, abs dis: 13.181564331054688
[rfa agg] iter:  5, weight: tensor([0.1082, 0.0747, 0.1163, 0.1165, 0.1113, 0.0902, 0.0788, 0.1075, 0.1138,
        0.0827])
[rfa agg] iter:  6, prev_obj_val: 21.16924285888672, obj_val: 34.350807189941406, abs dis: 13.181564331054688
[rfa agg] iter:  6, weight: tensor([0.1195, 0.0463, 0.1368, 0.1347, 0.1277, 0.0753, 0.0519, 0.1215, 0.1270,
        0.0594])
[rfa agg] iter:  7, prev_obj_val: 34.350807189941406, obj_val: 21.16924285888672, abs dis: 13.181564331054688
[rfa agg] iter:  7, weight: tensor([0.1082, 0.0747, 0.1163, 0.1165, 0.1113, 0.0902, 0.0788, 0.1075, 0.1138,
        0.0827])
[rfa agg] iter:  8, prev_obj_val: 21.16924285888672, obj_val: 34.350807189941406, abs dis: 13.181564331054688
[rfa agg] iter:  8, weight: tensor([0.1195, 0.0463, 0.1368, 0.1347, 0.1277, 0.0753, 0.0519, 0.1215, 0.1270,
        0.0594])
[rfa agg] iter:  9, prev_obj_val: 34.350807189941406, obj_val: 21.16924285888672, abs dis: 13.181564331054688
[rfa agg] iter:  9, weight: tensor([0.1082, 0.0747, 0.1163, 0.1165, 0.1113, 0.0902, 0.0788, 0.1075, 0.1138,
        0.0827])
___Test Target_ResNet_18 poisoned: False, epoch: 282: Average loss: 0.6314, Accuracy: 7952/10000 (79.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 282: Average loss: 6.0179, Accuracy: 419/9000 (4.6556%)
Done in 143.23042154312134 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:283 choose agents : [71, 99, 72, 0, 21, 93, 62, 8, 3, 49]. Adversary List: []
___Train Local_ResNet_18,  epoch 283, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 1122/1166 (96.2264%)
___Train Local_ResNet_18,  epoch 283, local model 71, internal_epoch   2,  Average loss: 0.0073, Accuracy: 1012/1166 (86.7925%)
___Test Local_ResNet_18 poisoned: False, epoch: 283: Average loss: 29.3167, Accuracy: 1431/10000 (14.3100%)
___Train Local_ResNet_18,  epoch 283, local model 99, internal_epoch   1,  Average loss: 0.0021, Accuracy: 378/391 (96.6752%)
___Train Local_ResNet_18,  epoch 283, local model 99, internal_epoch   2,  Average loss: 0.0011, Accuracy: 386/391 (98.7212%)
___Test Local_ResNet_18 poisoned: False, epoch: 283: Average loss: 3.3559, Accuracy: 4444/10000 (44.4400%)
___Train Local_ResNet_18,  epoch 283, local model 72, internal_epoch   1,  Average loss: 0.0061, Accuracy: 563/618 (91.1003%)
___Train Local_ResNet_18,  epoch 283, local model 72, internal_epoch   2,  Average loss: 0.0078, Accuracy: 531/618 (85.9223%)
___Test Local_ResNet_18 poisoned: False, epoch: 283: Average loss: 7.0757, Accuracy: 2539/10000 (25.3900%)
___Train Local_ResNet_18,  epoch 283, local model 0, internal_epoch   1,  Average loss: 0.0007, Accuracy: 367/367 (100.0000%)
___Train Local_ResNet_18,  epoch 283, local model 0, internal_epoch   2,  Average loss: 0.0001, Accuracy: 367/367 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 283: Average loss: 0.8802, Accuracy: 7491/10000 (74.9100%)
___Train Local_ResNet_18,  epoch 283, local model 21, internal_epoch   1,  Average loss: 0.0014, Accuracy: 260/262 (99.2366%)
___Train Local_ResNet_18,  epoch 283, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 259/262 (98.8550%)
___Test Local_ResNet_18 poisoned: False, epoch: 283: Average loss: 2.3480, Accuracy: 4441/10000 (44.4100%)
___Train Local_ResNet_18,  epoch 283, local model 93, internal_epoch   1,  Average loss: 0.0008, Accuracy: 582/584 (99.6575%)
___Train Local_ResNet_18,  epoch 283, local model 93, internal_epoch   2,  Average loss: 0.0021, Accuracy: 571/584 (97.7740%)
___Test Local_ResNet_18 poisoned: False, epoch: 283: Average loss: 2.7365, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 283, local model 62, internal_epoch   1,  Average loss: 0.0006, Accuracy: 357/358 (99.7207%)
___Train Local_ResNet_18,  epoch 283, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 358/358 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 283: Average loss: 0.7452, Accuracy: 7668/10000 (76.6800%)
___Train Local_ResNet_18,  epoch 283, local model 8, internal_epoch   1,  Average loss: 0.0007, Accuracy: 534/534 (100.0000%)
___Train Local_ResNet_18,  epoch 283, local model 8, internal_epoch   2,  Average loss: 0.0003, Accuracy: 533/534 (99.8127%)
___Test Local_ResNet_18 poisoned: False, epoch: 283: Average loss: 1.2948, Accuracy: 6658/10000 (66.5800%)
___Train Local_ResNet_18,  epoch 283, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 734/780 (94.1026%)
___Train Local_ResNet_18,  epoch 283, local model 3, internal_epoch   2,  Average loss: 0.0115, Accuracy: 635/780 (81.4103%)
___Test Local_ResNet_18 poisoned: False, epoch: 283: Average loss: 15.2397, Accuracy: 1421/10000 (14.2100%)
___Train Local_ResNet_18,  epoch 283, local model 49, internal_epoch   1,  Average loss: 0.0016, Accuracy: 416/426 (97.6526%)
___Train Local_ResNet_18,  epoch 283, local model 49, internal_epoch   2,  Average loss: 0.0007, Accuracy: 420/426 (98.5915%)
___Test Local_ResNet_18 poisoned: False, epoch: 283: Average loss: 1.9671, Accuracy: 5551/10000 (55.5100%)
time spent on training: 67.46492767333984
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [1166, 391, 618, 367, 262, 584, 358, 534, 780, 426]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [71, 99, 72, 0, 21, 93, 62, 8, 3, 49], weight: tensor([0.2125, 0.0713, 0.1127, 0.0669, 0.0478, 0.1065, 0.0653, 0.0973, 0.1422,
        0.0777])
[rfa agg] iter:  0, prev_obj_val: 37.209373474121094, obj_val: 44.166866302490234, abs dis: 6.957492828369141
[rfa agg] iter:  0, weight: tensor([0.0441, 0.0955, 0.1210, 0.0576, 0.0296, 0.1404, 0.0562, 0.2854, 0.0655,
        0.1046])
[rfa agg] iter:  1, prev_obj_val: 44.166866302490234, obj_val: 50.781646728515625, abs dis: 6.614780426025391
[rfa agg] iter:  1, weight: tensor([0.0281, 0.1631, 0.0502, 0.1890, 0.0507, 0.0500, 0.1845, 0.0643, 0.0353,
        0.1850])
[rfa agg] iter:  2, prev_obj_val: 50.781646728515625, obj_val: 63.53090286254883, abs dis: 12.749256134033203
[rfa agg] iter:  2, weight: tensor([0.0300, 0.0874, 0.0459, 0.2349, 0.1421, 0.0451, 0.2298, 0.0532, 0.0355,
        0.0961])
[rfa agg] iter:  3, prev_obj_val: 63.53090286254883, obj_val: 50.78874588012695, abs dis: 12.742156982421875
[rfa agg] iter:  3, weight: tensor([0.0576, 0.0959, 0.0747, 0.1360, 0.1835, 0.0722, 0.1327, 0.0794, 0.0634,
        0.1047])
[rfa agg] iter:  4, prev_obj_val: 50.78874588012695, obj_val: 63.53045654296875, abs dis: 12.741710662841797
[rfa agg] iter:  4, weight: tensor([0.0305, 0.0878, 0.0467, 0.2298, 0.1480, 0.0457, 0.2250, 0.0540, 0.0361,
        0.0965])
[rfa agg] iter:  5, prev_obj_val: 63.53045654296875, obj_val: 50.788753509521484, abs dis: 12.741703033447266
[rfa agg] iter:  5, weight: tensor([0.0576, 0.0958, 0.0747, 0.1360, 0.1836, 0.0722, 0.1327, 0.0794, 0.0634,
        0.1047])
[rfa agg] iter:  6, prev_obj_val: 50.788753509521484, obj_val: 63.53045654296875, abs dis: 12.741703033447266
[rfa agg] iter:  6, weight: tensor([0.0305, 0.0878, 0.0467, 0.2298, 0.1480, 0.0457, 0.2250, 0.0540, 0.0361,
        0.0965])
[rfa agg] iter:  7, prev_obj_val: 63.53045654296875, obj_val: 50.788753509521484, abs dis: 12.741703033447266
[rfa agg] iter:  7, weight: tensor([0.0576, 0.0958, 0.0747, 0.1360, 0.1836, 0.0722, 0.1327, 0.0794, 0.0634,
        0.1047])
[rfa agg] iter:  8, prev_obj_val: 50.788753509521484, obj_val: 63.53045654296875, abs dis: 12.741703033447266
[rfa agg] iter:  8, weight: tensor([0.0305, 0.0878, 0.0467, 0.2298, 0.1480, 0.0457, 0.2250, 0.0540, 0.0361,
        0.0965])
[rfa agg] iter:  9, prev_obj_val: 63.53045654296875, obj_val: 50.788753509521484, abs dis: 12.741703033447266
[rfa agg] iter:  9, weight: tensor([0.0576, 0.0958, 0.0747, 0.1360, 0.1836, 0.0722, 0.1327, 0.0794, 0.0634,
        0.1047])
___Test Target_ResNet_18 poisoned: False, epoch: 283: Average loss: 0.6333, Accuracy: 7958/10000 (79.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 283: Average loss: 6.0779, Accuracy: 402/9000 (4.4667%)
Done in 143.62198877334595 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:284 choose agents : [96, 95, 79, 42, 86, 36, 44, 73, 62, 27]. Adversary List: []
___Train Local_ResNet_18,  epoch 284, local model 96, internal_epoch   1,  Average loss: 0.0010, Accuracy: 703/708 (99.2938%)
___Train Local_ResNet_18,  epoch 284, local model 96, internal_epoch   2,  Average loss: 0.0067, Accuracy: 627/708 (88.5593%)
___Test Local_ResNet_18 poisoned: False, epoch: 284: Average loss: 3.7600, Accuracy: 3045/10000 (30.4500%)
___Train Local_ResNet_18,  epoch 284, local model 95, internal_epoch   1,  Average loss: 0.0031, Accuracy: 535/569 (94.0246%)
___Train Local_ResNet_18,  epoch 284, local model 95, internal_epoch   2,  Average loss: 0.0028, Accuracy: 536/569 (94.2004%)
___Test Local_ResNet_18 poisoned: False, epoch: 284: Average loss: 4.3444, Accuracy: 3143/10000 (31.4300%)
___Train Local_ResNet_18,  epoch 284, local model 79, internal_epoch   1,  Average loss: 0.0020, Accuracy: 151/154 (98.0519%)
___Train Local_ResNet_18,  epoch 284, local model 79, internal_epoch   2,  Average loss: 0.0005, Accuracy: 154/154 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 284: Average loss: 0.8601, Accuracy: 7385/10000 (73.8500%)
___Train Local_ResNet_18,  epoch 284, local model 42, internal_epoch   1,  Average loss: 0.0017, Accuracy: 196/198 (98.9899%)
___Train Local_ResNet_18,  epoch 284, local model 42, internal_epoch   2,  Average loss: 0.0021, Accuracy: 195/198 (98.4848%)
___Test Local_ResNet_18 poisoned: False, epoch: 284: Average loss: 1.4504, Accuracy: 6093/10000 (60.9300%)
___Train Local_ResNet_18,  epoch 284, local model 86, internal_epoch   1,  Average loss: 0.0012, Accuracy: 211/212 (99.5283%)
___Train Local_ResNet_18,  epoch 284, local model 86, internal_epoch   2,  Average loss: 0.0007, Accuracy: 210/212 (99.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 284: Average loss: 0.8160, Accuracy: 7540/10000 (75.4000%)
___Train Local_ResNet_18,  epoch 284, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 811/849 (95.5241%)
___Train Local_ResNet_18,  epoch 284, local model 36, internal_epoch   2,  Average loss: 0.0112, Accuracy: 675/849 (79.5053%)
___Test Local_ResNet_18 poisoned: False, epoch: 284: Average loss: 15.7503, Accuracy: 1231/10000 (12.3100%)
___Train Local_ResNet_18,  epoch 284, local model 44, internal_epoch   1,  Average loss: 0.0012, Accuracy: 434/436 (99.5413%)
___Train Local_ResNet_18,  epoch 284, local model 44, internal_epoch   2,  Average loss: 0.0003, Accuracy: 434/436 (99.5413%)
___Test Local_ResNet_18 poisoned: False, epoch: 284: Average loss: 1.6761, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch 284, local model 73, internal_epoch   1,  Average loss: 0.0070, Accuracy: 429/500 (85.8000%)
___Train Local_ResNet_18,  epoch 284, local model 73, internal_epoch   2,  Average loss: 0.0045, Accuracy: 455/500 (91.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 284: Average loss: 4.8820, Accuracy: 3252/10000 (32.5200%)
___Train Local_ResNet_18,  epoch 284, local model 62, internal_epoch   1,  Average loss: 0.0006, Accuracy: 357/358 (99.7207%)
___Train Local_ResNet_18,  epoch 284, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 357/358 (99.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 284: Average loss: 0.7770, Accuracy: 7574/10000 (75.7400%)
___Train Local_ResNet_18,  epoch 284, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 396/397 (99.7481%)
___Train Local_ResNet_18,  epoch 284, local model 27, internal_epoch   2,  Average loss: 0.0002, Accuracy: 397/397 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 284: Average loss: 1.1496, Accuracy: 6812/10000 (68.1200%)
time spent on training: 64.81612873077393
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [708, 569, 154, 198, 212, 849, 436, 500, 358, 397]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [96, 95, 79, 42, 86, 36, 44, 73, 62, 27], weight: tensor([0.1616, 0.1299, 0.0352, 0.0452, 0.0484, 0.1938, 0.0995, 0.1141, 0.0817,
        0.0906])
[rfa agg] iter:  0, prev_obj_val: 31.232284545898438, obj_val: 33.509490966796875, abs dis: 2.2772064208984375
[rfa agg] iter:  0, weight: tensor([0.0481, 0.0810, 0.0166, 0.0295, 0.0317, 0.0424, 0.2283, 0.1023, 0.2023,
        0.2178])
[rfa agg] iter:  1, prev_obj_val: 33.509490966796875, obj_val: 43.087242126464844, abs dis: 9.577751159667969
[rfa agg] iter:  1, weight: tensor([0.0373, 0.0583, 0.0165, 0.0314, 0.0338, 0.0336, 0.1331, 0.0712, 0.4617,
        0.1231])
[rfa agg] iter:  2, prev_obj_val: 43.087242126464844, obj_val: 43.07000732421875, abs dis: 0.01723480224609375
[rfa agg] iter:  2, weight: tensor([0.0514, 0.0681, 0.0557, 0.1824, 0.2062, 0.0486, 0.0951, 0.0751, 0.1305,
        0.0869])
___Test Target_ResNet_18 poisoned: False, epoch: 284: Average loss: 0.6321, Accuracy: 7954/10000 (79.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 284: Average loss: 6.1293, Accuracy: 404/9000 (4.4889%)
Done in 123.79344058036804 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:285 choose agents : [44, 71, 61, 88, 23, 50, 20, 47, 67, 48]. Adversary List: []
___Train Local_ResNet_18,  epoch 285, local model 44, internal_epoch   1,  Average loss: 0.0009, Accuracy: 435/436 (99.7706%)
___Train Local_ResNet_18,  epoch 285, local model 44, internal_epoch   2,  Average loss: 0.0002, Accuracy: 436/436 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 285: Average loss: 1.2768, Accuracy: 6541/10000 (65.4100%)
___Train Local_ResNet_18,  epoch 285, local model 71, internal_epoch   1,  Average loss: 0.0012, Accuracy: 1143/1166 (98.0274%)
___Train Local_ResNet_18,  epoch 285, local model 71, internal_epoch   2,  Average loss: 0.0041, Accuracy: 1076/1166 (92.2813%)
___Test Local_ResNet_18 poisoned: False, epoch: 285: Average loss: 6.4932, Accuracy: 2919/10000 (29.1900%)
___Train Local_ResNet_18,  epoch 285, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 555/590 (94.0678%)
___Train Local_ResNet_18,  epoch 285, local model 61, internal_epoch   2,  Average loss: 0.0094, Accuracy: 499/590 (84.5763%)
___Test Local_ResNet_18 poisoned: False, epoch: 285: Average loss: 14.0170, Accuracy: 1396/10000 (13.9600%)
___Train Local_ResNet_18,  epoch 285, local model 88, internal_epoch   1,  Average loss: 0.0028, Accuracy: 424/447 (94.8546%)
___Train Local_ResNet_18,  epoch 285, local model 88, internal_epoch   2,  Average loss: 0.0012, Accuracy: 435/447 (97.3154%)
___Test Local_ResNet_18 poisoned: False, epoch: 285: Average loss: 5.3845, Accuracy: 3207/10000 (32.0700%)
___Train Local_ResNet_18,  epoch 285, local model 23, internal_epoch   1,  Average loss: 0.0013, Accuracy: 244/248 (98.3871%)
___Train Local_ResNet_18,  epoch 285, local model 23, internal_epoch   2,  Average loss: 0.0005, Accuracy: 246/248 (99.1935%)
___Test Local_ResNet_18 poisoned: False, epoch: 285: Average loss: 0.9134, Accuracy: 7273/10000 (72.7300%)
___Train Local_ResNet_18,  epoch 285, local model 50, internal_epoch   1,  Average loss: 0.0005, Accuracy: 401/401 (100.0000%)
___Train Local_ResNet_18,  epoch 285, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 285: Average loss: 0.8420, Accuracy: 7530/10000 (75.3000%)
___Train Local_ResNet_18,  epoch 285, local model 20, internal_epoch   1,  Average loss: 0.0022, Accuracy: 350/362 (96.6851%)
___Train Local_ResNet_18,  epoch 285, local model 20, internal_epoch   2,  Average loss: 0.0009, Accuracy: 357/362 (98.6188%)
___Test Local_ResNet_18 poisoned: False, epoch: 285: Average loss: 5.9229, Accuracy: 3406/10000 (34.0600%)
___Train Local_ResNet_18,  epoch 285, local model 47, internal_epoch   1,  Average loss: 0.0010, Accuracy: 646/654 (98.7768%)
___Train Local_ResNet_18,  epoch 285, local model 47, internal_epoch   2,  Average loss: 0.0014, Accuracy: 648/654 (99.0826%)
___Test Local_ResNet_18 poisoned: False, epoch: 285: Average loss: 1.5960, Accuracy: 5940/10000 (59.4000%)
___Train Local_ResNet_18,  epoch 285, local model 67, internal_epoch   1,  Average loss: 0.0016, Accuracy: 828/842 (98.3373%)
___Train Local_ResNet_18,  epoch 285, local model 67, internal_epoch   2,  Average loss: 0.0181, Accuracy: 582/842 (69.1211%)
___Test Local_ResNet_18 poisoned: False, epoch: 285: Average loss: 491.0110, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 285, local model 48, internal_epoch   1,  Average loss: 0.0008, Accuracy: 377/378 (99.7354%)
___Train Local_ResNet_18,  epoch 285, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 378/378 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 285: Average loss: 0.9484, Accuracy: 7293/10000 (72.9300%)
time spent on training: 66.61498069763184
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [436, 1166, 590, 447, 248, 401, 362, 654, 842, 378]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [44, 71, 61, 88, 23, 50, 20, 47, 67, 48], weight: tensor([0.0789, 0.2111, 0.1068, 0.0809, 0.0449, 0.0726, 0.0655, 0.1184, 0.1524,
        0.0684])
[rfa agg] iter:  0, prev_obj_val: 39.82168960571289, obj_val: 42.5322380065918, abs dis: 2.7105484008789062
[rfa agg] iter:  0, weight: tensor([0.0918, 0.0659, 0.2247, 0.0922, 0.0242, 0.0847, 0.0548, 0.2130, 0.0910,
        0.0576])
[rfa agg] iter:  1, prev_obj_val: 42.5322380065918, obj_val: 52.59563446044922, abs dis: 10.063396453857422
[rfa agg] iter:  1, weight: tensor([0.2140, 0.0350, 0.0749, 0.1783, 0.0244, 0.2066, 0.0773, 0.0639, 0.0423,
        0.0834])
[rfa agg] iter:  2, prev_obj_val: 52.59563446044922, obj_val: 52.57356643676758, abs dis: 0.022068023681640625
[rfa agg] iter:  2, weight: tensor([0.1105, 0.0334, 0.0490, 0.1085, 0.0629, 0.1023, 0.1981, 0.0459, 0.0370,
        0.2523])
[rfa agg] iter:  3, prev_obj_val: 52.57356643676758, obj_val: 56.51318359375, abs dis: 3.939617156982422
[rfa agg] iter:  3, weight: tensor([0.1076, 0.0326, 0.0476, 0.1050, 0.0616, 0.0999, 0.2083, 0.0448, 0.0361,
        0.2567])
[rfa agg] iter:  4, prev_obj_val: 56.51318359375, obj_val: 52.577293395996094, abs dis: 3.9358901977539062
[rfa agg] iter:  4, weight: tensor([0.1096, 0.0422, 0.0581, 0.1091, 0.1217, 0.1013, 0.1699, 0.0553, 0.0460,
        0.1869])
[rfa agg] iter:  5, prev_obj_val: 52.577293395996094, obj_val: 56.51296615600586, abs dis: 3.9356727600097656
[rfa agg] iter:  5, weight: tensor([0.1085, 0.0329, 0.0481, 0.1059, 0.0622, 0.1007, 0.2061, 0.0452, 0.0364,
        0.2541])
[rfa agg] iter:  6, prev_obj_val: 56.51296615600586, obj_val: 52.577301025390625, abs dis: 3.9356651306152344
[rfa agg] iter:  6, weight: tensor([0.1096, 0.0423, 0.0581, 0.1091, 0.1217, 0.1013, 0.1698, 0.0553, 0.0460,
        0.1869])
[rfa agg] iter:  7, prev_obj_val: 52.577301025390625, obj_val: 56.51296615600586, abs dis: 3.9356651306152344
[rfa agg] iter:  7, weight: tensor([0.1085, 0.0329, 0.0481, 0.1059, 0.0622, 0.1007, 0.2061, 0.0452, 0.0364,
        0.2541])
[rfa agg] iter:  8, prev_obj_val: 56.51296615600586, obj_val: 52.577301025390625, abs dis: 3.9356651306152344
[rfa agg] iter:  8, weight: tensor([0.1096, 0.0423, 0.0581, 0.1091, 0.1217, 0.1013, 0.1698, 0.0553, 0.0460,
        0.1869])
[rfa agg] iter:  9, prev_obj_val: 52.577301025390625, obj_val: 56.51296615600586, abs dis: 3.9356651306152344
[rfa agg] iter:  9, weight: tensor([0.1085, 0.0329, 0.0481, 0.1059, 0.0622, 0.1007, 0.2061, 0.0452, 0.0364,
        0.2541])
___Test Target_ResNet_18 poisoned: False, epoch: 285: Average loss: 0.6271, Accuracy: 7967/10000 (79.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 285: Average loss: 6.1408, Accuracy: 409/9000 (4.5444%)
Done in 139.28373169898987 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:286 choose agents : [85, 82, 19, 56, 41, 95, 18, 55, 21, 10]. Adversary List: []
___Train Local_ResNet_18,  epoch 286, local model 85, internal_epoch   1,  Average loss: 0.0012, Accuracy: 363/364 (99.7253%)
___Train Local_ResNet_18,  epoch 286, local model 85, internal_epoch   2,  Average loss: 0.0003, Accuracy: 364/364 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 286: Average loss: 1.6621, Accuracy: 5944/10000 (59.4400%)
___Train Local_ResNet_18,  epoch 286, local model 82, internal_epoch   1,  Average loss: 0.0009, Accuracy: 596/601 (99.1681%)
___Train Local_ResNet_18,  epoch 286, local model 82, internal_epoch   2,  Average loss: 0.0010, Accuracy: 595/601 (99.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 286: Average loss: 1.4985, Accuracy: 6130/10000 (61.3000%)
___Train Local_ResNet_18,  epoch 286, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 157/173 (90.7514%)
___Train Local_ResNet_18,  epoch 286, local model 19, internal_epoch   2,  Average loss: 0.0028, Accuracy: 165/173 (95.3757%)
___Test Local_ResNet_18 poisoned: False, epoch: 286: Average loss: 4.1763, Accuracy: 4046/10000 (40.4600%)
___Train Local_ResNet_18,  epoch 286, local model 56, internal_epoch   1,  Average loss: 0.0007, Accuracy: 737/743 (99.1925%)
___Train Local_ResNet_18,  epoch 286, local model 56, internal_epoch   2,  Average loss: 0.0005, Accuracy: 740/743 (99.5962%)
___Test Local_ResNet_18 poisoned: False, epoch: 286: Average loss: 1.0452, Accuracy: 7048/10000 (70.4800%)
___Train Local_ResNet_18,  epoch 286, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 472/513 (92.0078%)
___Train Local_ResNet_18,  epoch 286, local model 41, internal_epoch   2,  Average loss: 0.0034, Accuracy: 479/513 (93.3723%)
___Test Local_ResNet_18 poisoned: False, epoch: 286: Average loss: 5.6310, Accuracy: 3386/10000 (33.8600%)
___Train Local_ResNet_18,  epoch 286, local model 95, internal_epoch   1,  Average loss: 0.0027, Accuracy: 541/569 (95.0791%)
___Train Local_ResNet_18,  epoch 286, local model 95, internal_epoch   2,  Average loss: 0.0034, Accuracy: 532/569 (93.4974%)
___Test Local_ResNet_18 poisoned: False, epoch: 286: Average loss: 3.4056, Accuracy: 4060/10000 (40.6000%)
___Train Local_ResNet_18,  epoch 286, local model 18, internal_epoch   1,  Average loss: 0.0018, Accuracy: 378/386 (97.9275%)
___Train Local_ResNet_18,  epoch 286, local model 18, internal_epoch   2,  Average loss: 0.0131, Accuracy: 365/386 (94.5596%)
___Test Local_ResNet_18 poisoned: False, epoch: 286: Average loss: 3.7736, Accuracy: 3038/10000 (30.3800%)
___Train Local_ResNet_18,  epoch 286, local model 55, internal_epoch   1,  Average loss: 0.0016, Accuracy: 295/299 (98.6622%)
___Train Local_ResNet_18,  epoch 286, local model 55, internal_epoch   2,  Average loss: 0.0003, Accuracy: 299/299 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 286: Average loss: 5.7673, Accuracy: 3176/10000 (31.7600%)
___Train Local_ResNet_18,  epoch 286, local model 21, internal_epoch   1,  Average loss: 0.0013, Accuracy: 262/262 (100.0000%)
___Train Local_ResNet_18,  epoch 286, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 259/262 (98.8550%)
___Test Local_ResNet_18 poisoned: False, epoch: 286: Average loss: 1.5855, Accuracy: 5883/10000 (58.8300%)
___Train Local_ResNet_18,  epoch 286, local model 10, internal_epoch   1,  Average loss: 0.0022, Accuracy: 725/752 (96.4096%)
___Train Local_ResNet_18,  epoch 286, local model 10, internal_epoch   2,  Average loss: 0.0021, Accuracy: 719/752 (95.6117%)
___Test Local_ResNet_18 poisoned: False, epoch: 286: Average loss: 3.7592, Accuracy: 3988/10000 (39.8800%)
time spent on training: 64.91686153411865
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [364, 601, 173, 743, 513, 569, 386, 299, 262, 752]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [85, 82, 19, 56, 41, 95, 18, 55, 21, 10], weight: tensor([0.0781, 0.1289, 0.0371, 0.1594, 0.1100, 0.1221, 0.0828, 0.0641, 0.0562,
        0.1613])
[rfa agg] iter:  0, prev_obj_val: 31.860496520996094, obj_val: 34.65532684326172, abs dis: 2.794830322265625
[rfa agg] iter:  0, weight: tensor([0.3700, 0.0581, 0.0223, 0.0481, 0.0637, 0.0714, 0.1168, 0.1082, 0.0932,
        0.0483])
[rfa agg] iter:  1, prev_obj_val: 34.65532684326172, obj_val: 34.64562225341797, abs dis: 0.00970458984375
[rfa agg] iter:  1, weight: tensor([0.2608, 0.0531, 0.0273, 0.0455, 0.0565, 0.0632, 0.0917, 0.1934, 0.1628,
        0.0457])
[rfa agg] iter:  2, prev_obj_val: 34.64562225341797, obj_val: 31.78476905822754, abs dis: 2.8608531951904297
[rfa agg] iter:  2, weight: tensor([0.2521, 0.0527, 0.0271, 0.0452, 0.0560, 0.0627, 0.0906, 0.2001, 0.1681,
        0.0453])
[rfa agg] iter:  3, prev_obj_val: 31.78476905822754, obj_val: 34.66046142578125, abs dis: 2.875692367553711
[rfa agg] iter:  3, weight: tensor([0.4408, 0.0510, 0.0196, 0.0422, 0.0557, 0.0625, 0.1041, 0.0975, 0.0843,
        0.0423])
[rfa agg] iter:  4, prev_obj_val: 34.66046142578125, obj_val: 34.645668029785156, abs dis: 0.01479339599609375
[rfa agg] iter:  4, weight: tensor([0.2655, 0.0529, 0.0272, 0.0454, 0.0563, 0.0629, 0.0912, 0.1916, 0.1615,
        0.0455])
[rfa agg] iter:  5, prev_obj_val: 34.645668029785156, obj_val: 34.645572662353516, abs dis: 9.5367431640625e-05
[rfa agg] iter:  5, weight: tensor([0.2524, 0.0527, 0.0271, 0.0452, 0.0560, 0.0627, 0.0906, 0.1999, 0.1680,
        0.0453])
[rfa agg] iter:  6, prev_obj_val: 34.645572662353516, obj_val: 31.784927368164062, abs dis: 2.860645294189453
[rfa agg] iter:  6, weight: tensor([0.2514, 0.0527, 0.0271, 0.0452, 0.0560, 0.0627, 0.0906, 0.2006, 0.1685,
        0.0453])
[rfa agg] iter:  7, prev_obj_val: 31.784927368164062, obj_val: 34.660430908203125, abs dis: 2.8755035400390625
[rfa agg] iter:  7, weight: tensor([0.4406, 0.0510, 0.0196, 0.0422, 0.0557, 0.0625, 0.1042, 0.0976, 0.0843,
        0.0423])
[rfa agg] iter:  8, prev_obj_val: 34.660430908203125, obj_val: 34.645668029785156, abs dis: 0.01476287841796875
[rfa agg] iter:  8, weight: tensor([0.2655, 0.0529, 0.0272, 0.0454, 0.0563, 0.0629, 0.0912, 0.1916, 0.1615,
        0.0455])
[rfa agg] iter:  9, prev_obj_val: 34.645668029785156, obj_val: 34.645572662353516, abs dis: 9.5367431640625e-05
[rfa agg] iter:  9, weight: tensor([0.2524, 0.0527, 0.0271, 0.0452, 0.0560, 0.0627, 0.0906, 0.1999, 0.1680,
        0.0453])
___Test Target_ResNet_18 poisoned: False, epoch: 286: Average loss: 0.6293, Accuracy: 7965/10000 (79.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 286: Average loss: 6.1192, Accuracy: 416/9000 (4.6222%)
Done in 136.4363398551941 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:287 choose agents : [57, 72, 11, 86, 1, 99, 5, 80, 42, 26]. Adversary List: []
___Train Local_ResNet_18,  epoch 287, local model 57, internal_epoch   1,  Average loss: 0.0010, Accuracy: 288/290 (99.3103%)
___Train Local_ResNet_18,  epoch 287, local model 57, internal_epoch   2,  Average loss: 0.0005, Accuracy: 289/290 (99.6552%)
___Test Local_ResNet_18 poisoned: False, epoch: 287: Average loss: 0.8423, Accuracy: 7490/10000 (74.9000%)
___Train Local_ResNet_18,  epoch 287, local model 72, internal_epoch   1,  Average loss: 0.0036, Accuracy: 572/618 (92.5566%)
___Train Local_ResNet_18,  epoch 287, local model 72, internal_epoch   2,  Average loss: 0.0066, Accuracy: 551/618 (89.1586%)
___Test Local_ResNet_18 poisoned: False, epoch: 287: Average loss: 6.2275, Accuracy: 2659/10000 (26.5900%)
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 287, local model 11, internal_epoch   1,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%)
___Train Local_ResNet_18,  epoch 287, local model 11, internal_epoch   2,  Average loss: 0.0014, Accuracy: 533/546 (97.6190%)
___Test Local_ResNet_18 poisoned: False, epoch: 287: Average loss: 2.6319, Accuracy: 4704/10000 (47.0400%)
___Train Local_ResNet_18,  epoch 287, local model 86, internal_epoch   1,  Average loss: 0.0008, Accuracy: 212/212 (100.0000%)
___Train Local_ResNet_18,  epoch 287, local model 86, internal_epoch   2,  Average loss: 0.0003, Accuracy: 212/212 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 287: Average loss: 0.7150, Accuracy: 7841/10000 (78.4100%)
___Train Local_ResNet_18,  epoch 287, local model 1, internal_epoch   1,  Average loss: 0.0043, Accuracy: 623/641 (97.1919%)
___Train Local_ResNet_18,  epoch 287, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 572/641 (89.2356%)
___Test Local_ResNet_18 poisoned: False, epoch: 287: Average loss: 2.9088, Accuracy: 4651/10000 (46.5100%)
___Train Local_ResNet_18,  epoch 287, local model 99, internal_epoch   1,  Average loss: 0.0028, Accuracy: 383/391 (97.9540%)
___Train Local_ResNet_18,  epoch 287, local model 99, internal_epoch   2,  Average loss: 0.0179, Accuracy: 300/391 (76.7263%)
___Test Local_ResNet_18 poisoned: False, epoch: 287: Average loss: 21.1628, Accuracy: 1443/10000 (14.4300%)
___Train Local_ResNet_18,  epoch 287, local model 5, internal_epoch   1,  Average loss: 0.0008, Accuracy: 363/365 (99.4521%)
___Train Local_ResNet_18,  epoch 287, local model 5, internal_epoch   2,  Average loss: 0.0003, Accuracy: 364/365 (99.7260%)
___Test Local_ResNet_18 poisoned: False, epoch: 287: Average loss: 0.9705, Accuracy: 7249/10000 (72.4900%)
___Train Local_ResNet_18,  epoch 287, local model 80, internal_epoch   1,  Average loss: 0.0013, Accuracy: 359/363 (98.8981%)
___Train Local_ResNet_18,  epoch 287, local model 80, internal_epoch   2,  Average loss: 0.0004, Accuracy: 362/363 (99.7245%)
___Test Local_ResNet_18 poisoned: False, epoch: 287: Average loss: 2.8360, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch 287, local model 42, internal_epoch   1,  Average loss: 0.0010, Accuracy: 198/198 (100.0000%)
___Train Local_ResNet_18,  epoch 287, local model 42, internal_epoch   2,  Average loss: 0.0004, Accuracy: 198/198 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 287: Average loss: 0.8011, Accuracy: 7517/10000 (75.1700%)
___Train Local_ResNet_18,  epoch 287, local model 26, internal_epoch   1,  Average loss: 0.0009, Accuracy: 466/468 (99.5726%)
___Train Local_ResNet_18,  epoch 287, local model 26, internal_epoch   2,  Average loss: 0.0006, Accuracy: 466/468 (99.5726%)
___Test Local_ResNet_18 poisoned: False, epoch: 287: Average loss: 1.6180, Accuracy: 6197/10000 (61.9700%)
time spent on training: 68.96693658828735
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.13343108504398826  data num: [290, 618, 546, 212, 641, 391, 365, 363, 198, 468]
[rfa agg] considering poison per batch poison_fraction: 0.010424303519061583
[rfa agg] init. name: [57, 72, 11, 86, 1, 99, 5, 80, 42, 26], weight: tensor([0.0709, 0.1510, 0.1334, 0.0518, 0.1566, 0.0956, 0.0892, 0.0887, 0.0484,
        0.1144])
[rfa agg] iter:  0, prev_obj_val: 23.05188751220703, obj_val: 31.55271339416504, abs dis: 8.500825881958008
[rfa agg] iter:  0, weight: tensor([0.0866, 0.0473, 0.0568, 0.0332, 0.0399, 0.0730, 0.2973, 0.2626, 0.0309,
        0.0724])
[rfa agg] iter:  1, prev_obj_val: 31.55271339416504, obj_val: 43.81463623046875, abs dis: 12.261922836303711
[rfa agg] iter:  1, weight: tensor([0.2205, 0.0470, 0.0516, 0.1669, 0.0416, 0.0585, 0.1026, 0.1015, 0.1531,
        0.0569])
[rfa agg] iter:  2, prev_obj_val: 43.81463623046875, obj_val: 28.18856430053711, abs dis: 15.62607192993164
[rfa agg] iter:  2, weight: tensor([0.1171, 0.0707, 0.0736, 0.1697, 0.0645, 0.0748, 0.0983, 0.0976, 0.1579,
        0.0758])
[rfa agg] iter:  3, prev_obj_val: 28.18856430053711, obj_val: 43.82036209106445, abs dis: 15.631797790527344
[rfa agg] iter:  3, weight: tensor([0.4014, 0.0407, 0.0458, 0.0703, 0.0356, 0.0544, 0.1183, 0.1156, 0.0654,
        0.0524])
[rfa agg] iter:  4, prev_obj_val: 43.82036209106445, obj_val: 28.188556671142578, abs dis: 15.631805419921875
[rfa agg] iter:  4, weight: tensor([0.1173, 0.0707, 0.0736, 0.1695, 0.0645, 0.0748, 0.0984, 0.0977, 0.1577,
        0.0758])
[rfa agg] iter:  5, prev_obj_val: 28.188556671142578, obj_val: 43.82036209106445, abs dis: 15.631805419921875
[rfa agg] iter:  5, weight: tensor([0.4014, 0.0407, 0.0458, 0.0703, 0.0356, 0.0544, 0.1183, 0.1156, 0.0654,
        0.0524])
[rfa agg] iter:  6, prev_obj_val: 43.82036209106445, obj_val: 28.188556671142578, abs dis: 15.631805419921875
[rfa agg] iter:  6, weight: tensor([0.1173, 0.0707, 0.0736, 0.1695, 0.0645, 0.0748, 0.0984, 0.0977, 0.1577,
        0.0758])
[rfa agg] iter:  7, prev_obj_val: 28.188556671142578, obj_val: 43.82036209106445, abs dis: 15.631805419921875
[rfa agg] iter:  7, weight: tensor([0.4014, 0.0407, 0.0458, 0.0703, 0.0356, 0.0544, 0.1183, 0.1156, 0.0654,
        0.0524])
[rfa agg] iter:  8, prev_obj_val: 43.82036209106445, obj_val: 28.188556671142578, abs dis: 15.631805419921875
[rfa agg] iter:  8, weight: tensor([0.1173, 0.0707, 0.0736, 0.1695, 0.0645, 0.0748, 0.0984, 0.0977, 0.1577,
        0.0758])
[rfa agg] iter:  9, prev_obj_val: 28.188556671142578, obj_val: 43.82036209106445, abs dis: 15.631805419921875
[rfa agg] iter:  9, weight: tensor([0.4014, 0.0407, 0.0458, 0.0703, 0.0356, 0.0544, 0.1183, 0.1156, 0.0654,
        0.0524])
___Test Target_ResNet_18 poisoned: False, epoch: 287: Average loss: 0.6327, Accuracy: 7955/10000 (79.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 287: Average loss: 6.2420, Accuracy: 404/9000 (4.4889%)
Done in 142.2640836238861 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:288 choose agents : [17, 31, 21, 57, 8, 87, 64, 12, 42, 65]. Adversary List: []
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 288, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 519/526 (98.6692%)
___Train Local_ResNet_18,  epoch 288, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 495/526 (94.1065%)
___Test Local_ResNet_18 poisoned: False, epoch: 288: Average loss: 2.5742, Accuracy: 4758/10000 (47.5800%)
___Train Local_ResNet_18,  epoch 288, local model 31, internal_epoch   1,  Average loss: 0.0013, Accuracy: 691/706 (97.8754%)
___Train Local_ResNet_18,  epoch 288, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 665/706 (94.1926%)
___Test Local_ResNet_18 poisoned: False, epoch: 288: Average loss: 11.9501, Accuracy: 1435/10000 (14.3500%)
___Train Local_ResNet_18,  epoch 288, local model 21, internal_epoch   1,  Average loss: 0.0021, Accuracy: 262/262 (100.0000%)
___Train Local_ResNet_18,  epoch 288, local model 21, internal_epoch   2,  Average loss: 0.0056, Accuracy: 251/262 (95.8015%)
___Test Local_ResNet_18 poisoned: False, epoch: 288: Average loss: 6.1801, Accuracy: 2380/10000 (23.8000%)
___Train Local_ResNet_18,  epoch 288, local model 57, internal_epoch   1,  Average loss: 0.0008, Accuracy: 290/290 (100.0000%)
___Train Local_ResNet_18,  epoch 288, local model 57, internal_epoch   2,  Average loss: 0.0002, Accuracy: 290/290 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 288: Average loss: 0.7911, Accuracy: 7623/10000 (76.2300%)
___Train Local_ResNet_18,  epoch 288, local model 8, internal_epoch   1,  Average loss: 0.0006, Accuracy: 532/534 (99.6255%)
___Train Local_ResNet_18,  epoch 288, local model 8, internal_epoch   2,  Average loss: 0.0002, Accuracy: 534/534 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 288: Average loss: 1.3473, Accuracy: 6472/10000 (64.7200%)
___Train Local_ResNet_18,  epoch 288, local model 87, internal_epoch   1,  Average loss: 0.0026, Accuracy: 378/397 (95.2141%)
___Train Local_ResNet_18,  epoch 288, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 373/397 (93.9547%)
___Test Local_ResNet_18 poisoned: False, epoch: 288: Average loss: 2.3264, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18,  epoch 288, local model 64, internal_epoch   1,  Average loss: 0.0019, Accuracy: 661/686 (96.3557%)
___Train Local_ResNet_18,  epoch 288, local model 64, internal_epoch   2,  Average loss: 0.0024, Accuracy: 651/686 (94.8980%)
___Test Local_ResNet_18 poisoned: False, epoch: 288: Average loss: 2.3453, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 288, local model 12, internal_epoch   1,  Average loss: 0.0022, Accuracy: 935/977 (95.7011%)
___Train Local_ResNet_18,  epoch 288, local model 12, internal_epoch   2,  Average loss: 0.0068, Accuracy: 866/977 (88.6387%)
___Test Local_ResNet_18 poisoned: False, epoch: 288: Average loss: 4.3768, Accuracy: 3649/10000 (36.4900%)
___Train Local_ResNet_18,  epoch 288, local model 42, internal_epoch   1,  Average loss: 0.0011, Accuracy: 198/198 (100.0000%)
___Train Local_ResNet_18,  epoch 288, local model 42, internal_epoch   2,  Average loss: 0.0005, Accuracy: 197/198 (99.4949%)
___Test Local_ResNet_18 poisoned: False, epoch: 288: Average loss: 0.8319, Accuracy: 7449/10000 (74.4900%)
___Train Local_ResNet_18,  epoch 288, local model 65, internal_epoch   1,  Average loss: 0.0009, Accuracy: 314/314 (100.0000%)
___Train Local_ResNet_18,  epoch 288, local model 65, internal_epoch   2,  Average loss: 0.0002, Accuracy: 314/314 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 288: Average loss: 0.8777, Accuracy: 7492/10000 (74.9200%)
time spent on training: 69.5542528629303
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10756646216768916  data num: [526, 706, 262, 290, 534, 397, 686, 977, 198, 314]
[rfa agg] considering poison per batch poison_fraction: 0.008403629856850715
[rfa agg] init. name: [17, 31, 21, 57, 8, 87, 64, 12, 42, 65], weight: tensor([0.1076, 0.1444, 0.0536, 0.0593, 0.1092, 0.0812, 0.1403, 0.1998, 0.0405,
        0.0642])
[rfa agg] iter:  0, prev_obj_val: 34.921722412109375, obj_val: 41.50564956665039, abs dis: 6.583927154541016
[rfa agg] iter:  0, weight: tensor([0.1557, 0.0786, 0.0504, 0.0585, 0.1745, 0.2347, 0.0974, 0.0581, 0.0287,
        0.0633])
[rfa agg] iter:  1, prev_obj_val: 41.50564956665039, obj_val: 46.91123962402344, abs dis: 5.405590057373047
[rfa agg] iter:  1, weight: tensor([0.0885, 0.0606, 0.1037, 0.1453, 0.0922, 0.1816, 0.0705, 0.0504, 0.0509,
        0.1563])
[rfa agg] iter:  2, prev_obj_val: 46.91123962402344, obj_val: 63.4031982421875, abs dis: 16.491958618164062
[rfa agg] iter:  2, weight: tensor([0.0344, 0.0267, 0.0882, 0.3303, 0.0356, 0.0510, 0.0303, 0.0235, 0.0510,
        0.3289])
[rfa agg] iter:  3, prev_obj_val: 63.4031982421875, obj_val: 44.05150604248047, abs dis: 19.35169219970703
[rfa agg] iter:  3, weight: tensor([0.0770, 0.0692, 0.1080, 0.1282, 0.0788, 0.0869, 0.0756, 0.0662, 0.1715,
        0.1387])
[rfa agg] iter:  4, prev_obj_val: 44.05150604248047, obj_val: 44.04316711425781, abs dis: 0.00833892822265625
[rfa agg] iter:  4, weight: tensor([0.0617, 0.0454, 0.1188, 0.2229, 0.0641, 0.1029, 0.0520, 0.0389, 0.0550,
        0.2383])
___Test Target_ResNet_18 poisoned: False, epoch: 288: Average loss: 0.6317, Accuracy: 7966/10000 (79.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 288: Average loss: 6.2309, Accuracy: 440/9000 (4.8889%)
Done in 136.77097702026367 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:289 choose agents : [14, 42, 13, 92, 5, 34, 33, 74, 94, 15]. Adversary List: []
___Train Local_ResNet_18,  epoch 289, local model 14, internal_epoch   1,  Average loss: 0.0016, Accuracy: 311/318 (97.7987%)
___Train Local_ResNet_18,  epoch 289, local model 14, internal_epoch   2,  Average loss: 0.0006, Accuracy: 316/318 (99.3711%)
___Test Local_ResNet_18 poisoned: False, epoch: 289: Average loss: 2.2176, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 289, local model 42, internal_epoch   1,  Average loss: 0.0021, Accuracy: 198/198 (100.0000%)
___Train Local_ResNet_18,  epoch 289, local model 42, internal_epoch   2,  Average loss: 0.0018, Accuracy: 193/198 (97.4747%)
___Test Local_ResNet_18 poisoned: False, epoch: 289: Average loss: 1.3771, Accuracy: 6287/10000 (62.8700%)
___Train Local_ResNet_18,  epoch 289, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 590/620 (95.1613%)
___Train Local_ResNet_18,  epoch 289, local model 13, internal_epoch   2,  Average loss: 0.0049, Accuracy: 564/620 (90.9677%)
___Test Local_ResNet_18 poisoned: False, epoch: 289: Average loss: 6.6699, Accuracy: 2504/10000 (25.0400%)
___Train Local_ResNet_18,  epoch 289, local model 92, internal_epoch   1,  Average loss: 0.0024, Accuracy: 765/796 (96.1055%)
___Train Local_ResNet_18,  epoch 289, local model 92, internal_epoch   2,  Average loss: 0.0061, Accuracy: 720/796 (90.4523%)
___Test Local_ResNet_18 poisoned: False, epoch: 289: Average loss: 5.7099, Accuracy: 3096/10000 (30.9600%)
___Train Local_ResNet_18,  epoch 289, local model 5, internal_epoch   1,  Average loss: 0.0007, Accuracy: 365/365 (100.0000%)
___Train Local_ResNet_18,  epoch 289, local model 5, internal_epoch   2,  Average loss: 0.0002, Accuracy: 365/365 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 289: Average loss: 0.8835, Accuracy: 7411/10000 (74.1100%)
___Train Local_ResNet_18,  epoch 289, local model 34, internal_epoch   1,  Average loss: 0.0013, Accuracy: 347/349 (99.4269%)
___Train Local_ResNet_18,  epoch 289, local model 34, internal_epoch   2,  Average loss: 0.0005, Accuracy: 347/349 (99.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 289: Average loss: 1.8065, Accuracy: 6269/10000 (62.6900%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 289, local model 33, internal_epoch   1,  Average loss: 0.0012, Accuracy: 520/527 (98.6717%)
___Train Local_ResNet_18,  epoch 289, local model 33, internal_epoch   2,  Average loss: 0.0012, Accuracy: 519/527 (98.4820%)
___Test Local_ResNet_18 poisoned: False, epoch: 289: Average loss: 2.5550, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 289, local model 74, internal_epoch   1,  Average loss: 0.0016, Accuracy: 462/469 (98.5075%)
___Train Local_ResNet_18,  epoch 289, local model 74, internal_epoch   2,  Average loss: 0.0012, Accuracy: 459/469 (97.8678%)
___Test Local_ResNet_18 poisoned: False, epoch: 289: Average loss: 1.8223, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 289, local model 94, internal_epoch   1,  Average loss: 0.0045, Accuracy: 190/203 (93.5961%)
___Train Local_ResNet_18,  epoch 289, local model 94, internal_epoch   2,  Average loss: 0.0067, Accuracy: 199/203 (98.0296%)
___Test Local_ResNet_18 poisoned: False, epoch: 289: Average loss: 2.5891, Accuracy: 4301/10000 (43.0100%)
___Train Local_ResNet_18,  epoch 289, local model 15, internal_epoch   1,  Average loss: 0.0016, Accuracy: 337/341 (98.8270%)
___Train Local_ResNet_18,  epoch 289, local model 15, internal_epoch   2,  Average loss: 0.0007, Accuracy: 339/341 (99.4135%)
___Test Local_ResNet_18 poisoned: False, epoch: 289: Average loss: 3.4325, Accuracy: 4479/10000 (44.7900%)
time spent on training: 70.34665751457214
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.12589584328714765  data num: [318, 198, 620, 796, 365, 349, 527, 469, 203, 341]
[rfa agg] considering poison per batch poison_fraction: 0.00983561275680841
[rfa agg] init. name: [14, 42, 13, 92, 5, 34, 33, 74, 94, 15], weight: tensor([0.0760, 0.0473, 0.1481, 0.1902, 0.0872, 0.0834, 0.1259, 0.1120, 0.0485,
        0.0815])
[rfa agg] iter:  0, prev_obj_val: 28.888978958129883, obj_val: 38.93144989013672, abs dis: 10.042470932006836
[rfa agg] iter:  0, weight: tensor([0.1632, 0.0431, 0.0465, 0.0362, 0.2024, 0.1838, 0.0513, 0.0629, 0.0434,
        0.1672])
[rfa agg] iter:  1, prev_obj_val: 38.93144989013672, obj_val: 51.89310073852539, abs dis: 12.961650848388672
[rfa agg] iter:  1, weight: tensor([0.1457, 0.2198, 0.0489, 0.0421, 0.0873, 0.0831, 0.0504, 0.0558, 0.1863,
        0.0807])
[rfa agg] iter:  2, prev_obj_val: 51.89310073852539, obj_val: 31.697067260742188, abs dis: 20.196033477783203
[rfa agg] iter:  2, weight: tensor([0.1253, 0.1275, 0.0813, 0.0747, 0.1033, 0.0986, 0.0803, 0.0842, 0.1287,
        0.0961])
[rfa agg] iter:  3, prev_obj_val: 31.697067260742188, obj_val: 47.481327056884766, abs dis: 15.784259796142578
[rfa agg] iter:  3, weight: tensor([0.3294, 0.0657, 0.0436, 0.0352, 0.1267, 0.1190, 0.0468, 0.0551, 0.0654,
        0.1131])
[rfa agg] iter:  4, prev_obj_val: 47.481327056884766, obj_val: 31.693756103515625, abs dis: 15.78757095336914
[rfa agg] iter:  4, weight: tensor([0.1296, 0.1498, 0.0719, 0.0648, 0.0996, 0.0951, 0.0719, 0.0765, 0.1482,
        0.0926])
[rfa agg] iter:  5, prev_obj_val: 31.693756103515625, obj_val: 47.48160171508789, abs dis: 15.787845611572266
[rfa agg] iter:  5, weight: tensor([0.3329, 0.0655, 0.0433, 0.0350, 0.1260, 0.1183, 0.0465, 0.0547, 0.0653,
        0.1124])
[rfa agg] iter:  6, prev_obj_val: 47.48160171508789, obj_val: 31.69375228881836, abs dis: 15.787849426269531
[rfa agg] iter:  6, weight: tensor([0.1296, 0.1498, 0.0719, 0.0648, 0.0996, 0.0950, 0.0719, 0.0765, 0.1482,
        0.0926])
[rfa agg] iter:  7, prev_obj_val: 31.69375228881836, obj_val: 47.48160171508789, abs dis: 15.787849426269531
[rfa agg] iter:  7, weight: tensor([0.3329, 0.0655, 0.0433, 0.0350, 0.1260, 0.1183, 0.0465, 0.0547, 0.0653,
        0.1124])
[rfa agg] iter:  8, prev_obj_val: 47.48160171508789, obj_val: 31.69375228881836, abs dis: 15.787849426269531
[rfa agg] iter:  8, weight: tensor([0.1296, 0.1498, 0.0719, 0.0648, 0.0996, 0.0950, 0.0719, 0.0765, 0.1482,
        0.0926])
[rfa agg] iter:  9, prev_obj_val: 31.69375228881836, obj_val: 47.48160171508789, abs dis: 15.787849426269531
[rfa agg] iter:  9, weight: tensor([0.3329, 0.0655, 0.0433, 0.0350, 0.1260, 0.1183, 0.0465, 0.0547, 0.0653,
        0.1124])
___Test Target_ResNet_18 poisoned: False, epoch: 289: Average loss: 0.6290, Accuracy: 7973/10000 (79.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 289: Average loss: 6.1910, Accuracy: 485/9000 (5.3889%)
Done in 144.1860601902008 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:290 choose agents : [58, 17, 50, 51, 27, 6, 8, 20, 39, 38]. Adversary List: []
___Train Local_ResNet_18,  epoch 290, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 228/234 (97.4359%)
___Train Local_ResNet_18,  epoch 290, local model 58, internal_epoch   2,  Average loss: 0.0002, Accuracy: 234/234 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 290: Average loss: 2.9859, Accuracy: 4281/10000 (42.8100%)
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 290, local model 17, internal_epoch   1,  Average loss: 0.0008, Accuracy: 524/526 (99.6198%)
___Train Local_ResNet_18,  epoch 290, local model 17, internal_epoch   2,  Average loss: 0.0002, Accuracy: 526/526 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 290: Average loss: 1.0873, Accuracy: 7029/10000 (70.2900%)
___Train Local_ResNet_18,  epoch 290, local model 50, internal_epoch   1,  Average loss: 0.0007, Accuracy: 401/401 (100.0000%)
___Train Local_ResNet_18,  epoch 290, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 290: Average loss: 1.0008, Accuracy: 7101/10000 (71.0100%)
___Train Local_ResNet_18,  epoch 290, local model 51, internal_epoch   1,  Average loss: 0.0027, Accuracy: 462/479 (96.4509%)
___Train Local_ResNet_18,  epoch 290, local model 51, internal_epoch   2,  Average loss: 0.0023, Accuracy: 464/479 (96.8685%)
___Test Local_ResNet_18 poisoned: False, epoch: 290: Average loss: 2.7249, Accuracy: 4373/10000 (43.7300%)
___Train Local_ResNet_18,  epoch 290, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 397/397 (100.0000%)
___Train Local_ResNet_18,  epoch 290, local model 27, internal_epoch   2,  Average loss: 0.0004, Accuracy: 397/397 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 290: Average loss: 1.0214, Accuracy: 7116/10000 (71.1600%)
___Train Local_ResNet_18,  epoch 290, local model 6, internal_epoch   1,  Average loss: 0.0013, Accuracy: 512/520 (98.4615%)
___Train Local_ResNet_18,  epoch 290, local model 6, internal_epoch   2,  Average loss: 0.0012, Accuracy: 511/520 (98.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 290: Average loss: 1.7103, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 290, local model 8, internal_epoch   1,  Average loss: 0.0005, Accuracy: 533/534 (99.8127%)
___Train Local_ResNet_18,  epoch 290, local model 8, internal_epoch   2,  Average loss: 0.0003, Accuracy: 532/534 (99.6255%)
___Test Local_ResNet_18 poisoned: False, epoch: 290: Average loss: 1.0005, Accuracy: 7114/10000 (71.1400%)
___Train Local_ResNet_18,  epoch 290, local model 20, internal_epoch   1,  Average loss: 0.0013, Accuracy: 361/362 (99.7238%)
___Train Local_ResNet_18,  epoch 290, local model 20, internal_epoch   2,  Average loss: 0.0006, Accuracy: 359/362 (99.1713%)
___Test Local_ResNet_18 poisoned: False, epoch: 290: Average loss: 2.9463, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 290, local model 39, internal_epoch   1,  Average loss: 0.0022, Accuracy: 213/217 (98.1567%)
___Train Local_ResNet_18,  epoch 290, local model 39, internal_epoch   2,  Average loss: 0.0010, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 290: Average loss: 1.7212, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 290, local model 38, internal_epoch   1,  Average loss: 0.0015, Accuracy: 737/756 (97.4868%)
___Train Local_ResNet_18,  epoch 290, local model 38, internal_epoch   2,  Average loss: 0.0032, Accuracy: 704/756 (93.1217%)
___Test Local_ResNet_18 poisoned: False, epoch: 290: Average loss: 1.8351, Accuracy: 5451/10000 (54.5100%)
time spent on training: 69.65643906593323
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.11884319927699954  data num: [234, 526, 401, 479, 397, 520, 534, 362, 217, 756]
[rfa agg] considering poison per batch poison_fraction: 0.00928462494351559
[rfa agg] init. name: [58, 17, 50, 51, 27, 6, 8, 20, 39, 38], weight: tensor([0.0529, 0.1188, 0.0906, 0.1082, 0.0897, 0.1175, 0.1207, 0.0818, 0.0490,
        0.1708])
[rfa agg] iter:  0, prev_obj_val: 21.88401222229004, obj_val: 24.710811614990234, abs dis: 2.8267993927001953
[rfa agg] iter:  0, weight: tensor([0.0291, 0.0653, 0.2202, 0.0906, 0.2118, 0.0637, 0.0665, 0.1831, 0.0269,
        0.0427])
[rfa agg] iter:  1, prev_obj_val: 24.710811614990234, obj_val: 35.1422119140625, abs dis: 10.431400299072266
[rfa agg] iter:  1, weight: tensor([0.0374, 0.0562, 0.1267, 0.0729, 0.1247, 0.0550, 0.0572, 0.3954, 0.0345,
        0.0402])
[rfa agg] iter:  2, prev_obj_val: 35.1422119140625, obj_val: 31.57134246826172, abs dis: 3.5708694458007812
[rfa agg] iter:  2, weight: tensor([0.2110, 0.0613, 0.0840, 0.0705, 0.0831, 0.0603, 0.0623, 0.1257, 0.1892,
        0.0526])
[rfa agg] iter:  3, prev_obj_val: 31.57134246826172, obj_val: 35.12127685546875, abs dis: 3.5499343872070312
[rfa agg] iter:  3, weight: tensor([0.1243, 0.0714, 0.1086, 0.0847, 0.1072, 0.0702, 0.0726, 0.1886, 0.1140,
        0.0584])
[rfa agg] iter:  4, prev_obj_val: 35.12127685546875, obj_val: 31.57168197631836, abs dis: 3.5495948791503906
[rfa agg] iter:  4, weight: tensor([0.2155, 0.0606, 0.0830, 0.0698, 0.0821, 0.0596, 0.0616, 0.1232, 0.1925,
        0.0520])
[rfa agg] iter:  5, prev_obj_val: 31.57168197631836, obj_val: 35.12127685546875, abs dis: 3.5495948791503906
[rfa agg] iter:  5, weight: tensor([0.1243, 0.0714, 0.1085, 0.0847, 0.1072, 0.0702, 0.0726, 0.1886, 0.1141,
        0.0584])
[rfa agg] iter:  6, prev_obj_val: 35.12127685546875, obj_val: 31.571685791015625, abs dis: 3.549591064453125
[rfa agg] iter:  6, weight: tensor([0.2155, 0.0606, 0.0830, 0.0698, 0.0821, 0.0596, 0.0616, 0.1232, 0.1925,
        0.0520])
[rfa agg] iter:  7, prev_obj_val: 31.571685791015625, obj_val: 35.12127685546875, abs dis: 3.549591064453125
[rfa agg] iter:  7, weight: tensor([0.1243, 0.0714, 0.1085, 0.0847, 0.1072, 0.0702, 0.0726, 0.1886, 0.1141,
        0.0584])
[rfa agg] iter:  8, prev_obj_val: 35.12127685546875, obj_val: 31.571685791015625, abs dis: 3.549591064453125
[rfa agg] iter:  8, weight: tensor([0.2155, 0.0606, 0.0830, 0.0698, 0.0821, 0.0596, 0.0616, 0.1232, 0.1925,
        0.0520])
[rfa agg] iter:  9, prev_obj_val: 31.571685791015625, obj_val: 35.12127685546875, abs dis: 3.549591064453125
[rfa agg] iter:  9, weight: tensor([0.1243, 0.0714, 0.1085, 0.0847, 0.1072, 0.0702, 0.0726, 0.1886, 0.1141,
        0.0584])
___Test Target_ResNet_18 poisoned: False, epoch: 290: Average loss: 0.6268, Accuracy: 7973/10000 (79.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 290: Average loss: 6.2407, Accuracy: 483/9000 (5.3667%)
Done in 144.70990824699402 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:291 choose agents : [34, 55, 96, 49, 88, 20, 8, 16, 35, 71]. Adversary List: []
___Train Local_ResNet_18,  epoch 291, local model 34, internal_epoch   1,  Average loss: 0.0013, Accuracy: 344/349 (98.5673%)
___Train Local_ResNet_18,  epoch 291, local model 34, internal_epoch   2,  Average loss: 0.0007, Accuracy: 346/349 (99.1404%)
___Test Local_ResNet_18 poisoned: False, epoch: 291: Average loss: 2.4001, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 291, local model 55, internal_epoch   1,  Average loss: 0.0013, Accuracy: 297/299 (99.3311%)
___Train Local_ResNet_18,  epoch 291, local model 55, internal_epoch   2,  Average loss: 0.0004, Accuracy: 298/299 (99.6656%)
___Test Local_ResNet_18 poisoned: False, epoch: 291: Average loss: 3.0325, Accuracy: 4712/10000 (47.1200%)
___Train Local_ResNet_18,  epoch 291, local model 96, internal_epoch   1,  Average loss: 0.0027, Accuracy: 700/708 (98.8701%)
___Train Local_ResNet_18,  epoch 291, local model 96, internal_epoch   2,  Average loss: 0.0261, Accuracy: 420/708 (59.3220%)
___Test Local_ResNet_18 poisoned: False, epoch: 291: Average loss: 466.7116, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 291, local model 49, internal_epoch   1,  Average loss: 0.0012, Accuracy: 422/426 (99.0610%)
___Train Local_ResNet_18,  epoch 291, local model 49, internal_epoch   2,  Average loss: 0.0003, Accuracy: 425/426 (99.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 291: Average loss: 1.8845, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 291, local model 88, internal_epoch   1,  Average loss: 0.0025, Accuracy: 435/447 (97.3154%)
___Train Local_ResNet_18,  epoch 291, local model 88, internal_epoch   2,  Average loss: 0.0017, Accuracy: 434/447 (97.0917%)
___Test Local_ResNet_18 poisoned: False, epoch: 291: Average loss: 8.1958, Accuracy: 2297/10000 (22.9700%)
___Train Local_ResNet_18,  epoch 291, local model 20, internal_epoch   1,  Average loss: 0.0011, Accuracy: 360/362 (99.4475%)
___Train Local_ResNet_18,  epoch 291, local model 20, internal_epoch   2,  Average loss: 0.0003, Accuracy: 362/362 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 291: Average loss: 2.3174, Accuracy: 5915/10000 (59.1500%)
___Train Local_ResNet_18,  epoch 291, local model 8, internal_epoch   1,  Average loss: 0.0007, Accuracy: 533/534 (99.8127%)
___Train Local_ResNet_18,  epoch 291, local model 8, internal_epoch   2,  Average loss: 0.0003, Accuracy: 533/534 (99.8127%)
___Test Local_ResNet_18 poisoned: False, epoch: 291: Average loss: 1.1465, Accuracy: 6735/10000 (67.3500%)
___Train Local_ResNet_18,  epoch 291, local model 16, internal_epoch   1,  Average loss: 0.0015, Accuracy: 766/773 (99.0944%)
___Train Local_ResNet_18,  epoch 291, local model 16, internal_epoch   2,  Average loss: 0.0151, Accuracy: 602/773 (77.8784%)
___Test Local_ResNet_18 poisoned: False, epoch: 291: Average loss: 64.2043, Accuracy: 999/10000 (9.9900%)
___Train Local_ResNet_18,  epoch 291, local model 35, internal_epoch   1,  Average loss: 0.0027, Accuracy: 398/419 (94.9881%)
___Train Local_ResNet_18,  epoch 291, local model 35, internal_epoch   2,  Average loss: 0.0023, Accuracy: 400/419 (95.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 291: Average loss: 3.5638, Accuracy: 3901/10000 (39.0100%)
___Train Local_ResNet_18,  epoch 291, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1127/1166 (96.6552%)
___Train Local_ResNet_18,  epoch 291, local model 71, internal_epoch   2,  Average loss: 0.0076, Accuracy: 990/1166 (84.9057%)
___Test Local_ResNet_18 poisoned: False, epoch: 291: Average loss: 8.5567, Accuracy: 2586/10000 (25.8600%)
time spent on training: 67.59197521209717
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [349, 299, 708, 426, 447, 362, 534, 773, 419, 1166]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [34, 55, 96, 49, 88, 20, 8, 16, 35, 71], weight: tensor([0.0637, 0.0545, 0.1291, 0.0777, 0.0815, 0.0660, 0.0974, 0.1410, 0.0764,
        0.2127])
[rfa agg] iter:  0, prev_obj_val: 40.23390579223633, obj_val: 43.05144500732422, abs dis: 2.8175392150878906
[rfa agg] iter:  0, weight: tensor([0.0533, 0.0347, 0.0814, 0.0944, 0.0966, 0.0555, 0.3558, 0.0832, 0.0908,
        0.0544])
[rfa agg] iter:  1, prev_obj_val: 43.05144500732422, obj_val: 51.41693878173828, abs dis: 8.365493774414062
[rfa agg] iter:  1, weight: tensor([0.0888, 0.0417, 0.0350, 0.2400, 0.1860, 0.0942, 0.0749, 0.0352, 0.1766,
        0.0275])
[rfa agg] iter:  2, prev_obj_val: 51.41693878173828, obj_val: 59.53121566772461, abs dis: 8.114276885986328
[rfa agg] iter:  2, weight: tensor([0.1864, 0.1677, 0.0346, 0.0970, 0.0978, 0.2060, 0.0533, 0.0351, 0.0919,
        0.0301])
[rfa agg] iter:  3, prev_obj_val: 59.53121566772461, obj_val: 51.392120361328125, abs dis: 8.139095306396484
[rfa agg] iter:  3, weight: tensor([0.1228, 0.2728, 0.0473, 0.0911, 0.0940, 0.1284, 0.0641, 0.0481, 0.0881,
        0.0433])
[rfa agg] iter:  4, prev_obj_val: 51.392120361328125, obj_val: 59.53144073486328, abs dis: 8.139320373535156
[rfa agg] iter:  4, weight: tensor([0.1880, 0.1752, 0.0342, 0.0947, 0.0949, 0.2070, 0.0525, 0.0346, 0.0892,
        0.0297])
[rfa agg] iter:  5, prev_obj_val: 59.53144073486328, obj_val: 51.39210891723633, abs dis: 8.139331817626953
[rfa agg] iter:  5, weight: tensor([0.1227, 0.2734, 0.0473, 0.0911, 0.0939, 0.1284, 0.0640, 0.0480, 0.0881,
        0.0432])
[rfa agg] iter:  6, prev_obj_val: 51.39210891723633, obj_val: 59.531436920166016, abs dis: 8.139328002929688
[rfa agg] iter:  6, weight: tensor([0.1880, 0.1752, 0.0342, 0.0947, 0.0949, 0.2070, 0.0525, 0.0346, 0.0892,
        0.0297])
[rfa agg] iter:  7, prev_obj_val: 59.531436920166016, obj_val: 51.39210891723633, abs dis: 8.139328002929688
[rfa agg] iter:  7, weight: tensor([0.1227, 0.2734, 0.0473, 0.0911, 0.0939, 0.1284, 0.0640, 0.0480, 0.0881,
        0.0432])
[rfa agg] iter:  8, prev_obj_val: 51.39210891723633, obj_val: 59.531436920166016, abs dis: 8.139328002929688
[rfa agg] iter:  8, weight: tensor([0.1880, 0.1752, 0.0342, 0.0947, 0.0949, 0.2070, 0.0525, 0.0346, 0.0892,
        0.0297])
[rfa agg] iter:  9, prev_obj_val: 59.531436920166016, obj_val: 51.39210891723633, abs dis: 8.139328002929688
[rfa agg] iter:  9, weight: tensor([0.1227, 0.2734, 0.0473, 0.0911, 0.0939, 0.1284, 0.0640, 0.0480, 0.0881,
        0.0432])
___Test Target_ResNet_18 poisoned: False, epoch: 291: Average loss: 0.6258, Accuracy: 7983/10000 (79.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 291: Average loss: 6.1732, Accuracy: 505/9000 (5.6111%)
Done in 138.62664675712585 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:292 choose agents : [84, 32, 75, 4, 70, 91, 28, 55, 47, 92]. Adversary List: []
___Train Local_ResNet_18,  epoch 292, local model 84, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1035/1053 (98.2906%)
___Train Local_ResNet_18,  epoch 292, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 957/1053 (90.8832%)
___Test Local_ResNet_18 poisoned: False, epoch: 292: Average loss: 2.2248, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 292, local model 32, internal_epoch   1,  Average loss: 0.0019, Accuracy: 794/824 (96.3592%)
___Train Local_ResNet_18,  epoch 292, local model 32, internal_epoch   2,  Average loss: 0.0037, Accuracy: 758/824 (91.9903%)
___Test Local_ResNet_18 poisoned: False, epoch: 292: Average loss: 4.5713, Accuracy: 3969/10000 (39.6900%)
___Train Local_ResNet_18,  epoch 292, local model 75, internal_epoch   1,  Average loss: 0.0017, Accuracy: 565/578 (97.7509%)
___Train Local_ResNet_18,  epoch 292, local model 75, internal_epoch   2,  Average loss: 0.0138, Accuracy: 460/578 (79.5848%)
___Test Local_ResNet_18 poisoned: False, epoch: 292: Average loss: 57.1031, Accuracy: 1704/10000 (17.0400%)
___Train Local_ResNet_18,  epoch 292, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 521/557 (93.5368%)
___Train Local_ResNet_18,  epoch 292, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 513/557 (92.1005%)
___Test Local_ResNet_18 poisoned: False, epoch: 292: Average loss: 3.9978, Accuracy: 3801/10000 (38.0100%)
___Train Local_ResNet_18,  epoch 292, local model 70, internal_epoch   1,  Average loss: 0.0025, Accuracy: 580/610 (95.0820%)
___Train Local_ResNet_18,  epoch 292, local model 70, internal_epoch   2,  Average loss: 0.0027, Accuracy: 584/610 (95.7377%)
___Test Local_ResNet_18 poisoned: False, epoch: 292: Average loss: 3.2003, Accuracy: 3917/10000 (39.1700%)
___Train Local_ResNet_18,  epoch 292, local model 91, internal_epoch   1,  Average loss: 0.0019, Accuracy: 226/234 (96.5812%)
___Train Local_ResNet_18,  epoch 292, local model 91, internal_epoch   2,  Average loss: 0.0005, Accuracy: 233/234 (99.5726%)
___Test Local_ResNet_18 poisoned: False, epoch: 292: Average loss: 1.2437, Accuracy: 6529/10000 (65.2900%)
___Train Local_ResNet_18,  epoch 292, local model 28, internal_epoch   1,  Average loss: 0.0007, Accuracy: 420/423 (99.2908%)
___Train Local_ResNet_18,  epoch 292, local model 28, internal_epoch   2,  Average loss: 0.0004, Accuracy: 420/423 (99.2908%)
___Test Local_ResNet_18 poisoned: False, epoch: 292: Average loss: 1.4085, Accuracy: 6560/10000 (65.6000%)
___Train Local_ResNet_18,  epoch 292, local model 55, internal_epoch   1,  Average loss: 0.0009, Accuracy: 298/299 (99.6656%)
___Train Local_ResNet_18,  epoch 292, local model 55, internal_epoch   2,  Average loss: 0.0002, Accuracy: 299/299 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 292: Average loss: 2.0560, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 292, local model 47, internal_epoch   1,  Average loss: 0.0012, Accuracy: 644/654 (98.4709%)
___Train Local_ResNet_18,  epoch 292, local model 47, internal_epoch   2,  Average loss: 0.0009, Accuracy: 643/654 (98.3180%)
___Test Local_ResNet_18 poisoned: False, epoch: 292: Average loss: 1.4809, Accuracy: 6234/10000 (62.3400%)
___Train Local_ResNet_18,  epoch 292, local model 92, internal_epoch   1,  Average loss: 0.0023, Accuracy: 764/796 (95.9799%)
___Train Local_ResNet_18,  epoch 292, local model 92, internal_epoch   2,  Average loss: 0.0055, Accuracy: 713/796 (89.5729%)
___Test Local_ResNet_18 poisoned: False, epoch: 292: Average loss: 5.3664, Accuracy: 3397/10000 (33.9700%)
time spent on training: 68.44954490661621
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [1053, 824, 578, 557, 610, 234, 423, 299, 654, 796]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [84, 32, 75, 4, 70, 91, 28, 55, 47, 92], weight: tensor([0.1747, 0.1367, 0.0959, 0.0924, 0.1012, 0.0388, 0.0702, 0.0496, 0.1085,
        0.1321])
[rfa agg] iter:  0, prev_obj_val: 35.66259002685547, obj_val: 38.27400207519531, abs dis: 2.6114120483398438
[rfa agg] iter:  0, weight: tensor([0.0552, 0.0800, 0.1127, 0.2238, 0.1566, 0.0232, 0.1204, 0.0380, 0.1131,
        0.0769])
[rfa agg] iter:  1, prev_obj_val: 38.27400207519531, obj_val: 44.19349670410156, abs dis: 5.91949462890625
[rfa agg] iter:  1, weight: tensor([0.0549, 0.0762, 0.1041, 0.2015, 0.1332, 0.0275, 0.1819, 0.0467, 0.1007,
        0.0732])
[rfa agg] iter:  2, prev_obj_val: 44.19349670410156, obj_val: 51.131431579589844, abs dis: 6.937934875488281
[rfa agg] iter:  2, weight: tensor([0.0441, 0.0570, 0.0705, 0.1080, 0.0825, 0.0325, 0.4208, 0.0617, 0.0680,
        0.0548])
[rfa agg] iter:  3, prev_obj_val: 51.131431579589844, obj_val: 54.73792266845703, abs dis: 3.6064910888671875
[rfa agg] iter:  3, weight: tensor([0.0554, 0.0677, 0.0769, 0.1033, 0.0868, 0.0669, 0.2371, 0.1651, 0.0755,
        0.0652])
[rfa agg] iter:  4, prev_obj_val: 54.73792266845703, obj_val: 54.73488998413086, abs dis: 0.003032684326171875
[rfa agg] iter:  4, weight: tensor([0.0518, 0.0618, 0.0680, 0.0874, 0.0757, 0.0860, 0.1565, 0.2862, 0.0671,
        0.0595])
___Test Target_ResNet_18 poisoned: False, epoch: 292: Average loss: 0.6246, Accuracy: 7992/10000 (79.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 292: Average loss: 6.3747, Accuracy: 432/9000 (4.8000%)
Done in 132.54650282859802 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:293 choose agents : [12, 99, 32, 86, 68, 93, 55, 94, 84, 89]. Adversary List: []
___Train Local_ResNet_18,  epoch 293, local model 12, internal_epoch   1,  Average loss: 0.0035, Accuracy: 932/977 (95.3941%)
___Train Local_ResNet_18,  epoch 293, local model 12, internal_epoch   2,  Average loss: 0.0156, Accuracy: 705/977 (72.1597%)
___Test Local_ResNet_18 poisoned: False, epoch: 293: Average loss: 31.0671, Accuracy: 1475/10000 (14.7500%)
___Train Local_ResNet_18,  epoch 293, local model 99, internal_epoch   1,  Average loss: 0.0017, Accuracy: 383/391 (97.9540%)
___Train Local_ResNet_18,  epoch 293, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 387/391 (98.9770%)
___Test Local_ResNet_18 poisoned: False, epoch: 293: Average loss: 2.7519, Accuracy: 4925/10000 (49.2500%)
___Train Local_ResNet_18,  epoch 293, local model 32, internal_epoch   1,  Average loss: 0.0018, Accuracy: 795/824 (96.4806%)
___Train Local_ResNet_18,  epoch 293, local model 32, internal_epoch   2,  Average loss: 0.0029, Accuracy: 772/824 (93.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 293: Average loss: 2.6800, Accuracy: 4492/10000 (44.9200%)
___Train Local_ResNet_18,  epoch 293, local model 86, internal_epoch   1,  Average loss: 0.0007, Accuracy: 212/212 (100.0000%)
___Train Local_ResNet_18,  epoch 293, local model 86, internal_epoch   2,  Average loss: 0.0002, Accuracy: 212/212 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 293: Average loss: 0.7136, Accuracy: 7830/10000 (78.3000%)
___Train Local_ResNet_18,  epoch 293, local model 68, internal_epoch   1,  Average loss: 0.0007, Accuracy: 415/416 (99.7596%)
___Train Local_ResNet_18,  epoch 293, local model 68, internal_epoch   2,  Average loss: 0.0002, Accuracy: 416/416 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 293: Average loss: 0.8186, Accuracy: 7581/10000 (75.8100%)
___Train Local_ResNet_18,  epoch 293, local model 93, internal_epoch   1,  Average loss: 0.0008, Accuracy: 580/584 (99.3151%)
___Train Local_ResNet_18,  epoch 293, local model 93, internal_epoch   2,  Average loss: 0.0003, Accuracy: 583/584 (99.8288%)
___Test Local_ResNet_18 poisoned: False, epoch: 293: Average loss: 1.3598, Accuracy: 6405/10000 (64.0500%)
___Train Local_ResNet_18,  epoch 293, local model 55, internal_epoch   1,  Average loss: 0.0008, Accuracy: 298/299 (99.6656%)
___Train Local_ResNet_18,  epoch 293, local model 55, internal_epoch   2,  Average loss: 0.0002, Accuracy: 299/299 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 293: Average loss: 1.4706, Accuracy: 6527/10000 (65.2700%)
___Train Local_ResNet_18,  epoch 293, local model 94, internal_epoch   1,  Average loss: 0.0031, Accuracy: 193/203 (95.0739%)
___Train Local_ResNet_18,  epoch 293, local model 94, internal_epoch   2,  Average loss: 0.0026, Accuracy: 199/203 (98.0296%)
___Test Local_ResNet_18 poisoned: False, epoch: 293: Average loss: 3.8956, Accuracy: 3322/10000 (33.2200%)
___Train Local_ResNet_18,  epoch 293, local model 84, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1028/1053 (97.6258%)
___Train Local_ResNet_18,  epoch 293, local model 84, internal_epoch   2,  Average loss: 0.0034, Accuracy: 980/1053 (93.0674%)
___Test Local_ResNet_18 poisoned: False, epoch: 293: Average loss: 2.9627, Accuracy: 4642/10000 (46.4200%)
___Train Local_ResNet_18,  epoch 293, local model 89, internal_epoch   1,  Average loss: 0.0017, Accuracy: 405/413 (98.0630%)
___Train Local_ResNet_18,  epoch 293, local model 89, internal_epoch   2,  Average loss: 0.0008, Accuracy: 408/413 (98.7893%)
___Test Local_ResNet_18 poisoned: False, epoch: 293: Average loss: 2.5635, Accuracy: 4729/10000 (47.2900%)
time spent on training: 65.95847582817078
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [977, 391, 824, 212, 416, 584, 299, 203, 1053, 413]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [12, 99, 32, 86, 68, 93, 55, 94, 84, 89], weight: tensor([0.1819, 0.0728, 0.1534, 0.0395, 0.0774, 0.1087, 0.0557, 0.0378, 0.1960,
        0.0769])
[rfa agg] iter:  0, prev_obj_val: 41.58781433105469, obj_val: 43.75069808959961, abs dis: 2.162883758544922
[rfa agg] iter:  0, weight: tensor([0.0785, 0.0826, 0.1240, 0.0211, 0.0890, 0.3848, 0.0362, 0.0201, 0.0764,
        0.0872])
[rfa agg] iter:  1, prev_obj_val: 43.75069808959961, obj_val: 46.332977294921875, abs dis: 2.5822792053222656
[rfa agg] iter:  1, weight: tensor([0.0708, 0.1394, 0.1021, 0.0268, 0.1535, 0.2157, 0.0485, 0.0256, 0.0701,
        0.1474])
[rfa agg] iter:  2, prev_obj_val: 46.332977294921875, obj_val: 53.87377166748047, abs dis: 7.540794372558594
[rfa agg] iter:  2, weight: tensor([0.0415, 0.2063, 0.0554, 0.0227, 0.2615, 0.0866, 0.0446, 0.0216, 0.0414,
        0.2186])
[rfa agg] iter:  3, prev_obj_val: 53.87377166748047, obj_val: 57.0897216796875, abs dis: 3.2159500122070312
[rfa agg] iter:  3, weight: tensor([0.0455, 0.1718, 0.0560, 0.0506, 0.1934, 0.0697, 0.1382, 0.0476, 0.0457,
        0.1815])
[rfa agg] iter:  4, prev_obj_val: 57.0897216796875, obj_val: 64.08462524414062, abs dis: 6.994903564453125
[rfa agg] iter:  4, weight: tensor([0.0451, 0.1243, 0.0543, 0.0697, 0.1361, 0.0644, 0.2644, 0.0649, 0.0454,
        0.1314])
[rfa agg] iter:  5, prev_obj_val: 64.08462524414062, obj_val: 57.09132766723633, abs dis: 6.993297576904297
[rfa agg] iter:  5, weight: tensor([0.0395, 0.0732, 0.0458, 0.1863, 0.0788, 0.0504, 0.2594, 0.1493, 0.0400,
        0.0773])
[rfa agg] iter:  6, prev_obj_val: 57.09132766723633, obj_val: 64.08436584472656, abs dis: 6.993038177490234
[rfa agg] iter:  6, weight: tensor([0.0447, 0.1223, 0.0538, 0.0693, 0.1349, 0.0638, 0.2722, 0.0649, 0.0450,
        0.1292])
[rfa agg] iter:  7, prev_obj_val: 64.08436584472656, obj_val: 57.091331481933594, abs dis: 6.993034362792969
[rfa agg] iter:  7, weight: tensor([0.0395, 0.0731, 0.0458, 0.1863, 0.0788, 0.0504, 0.2597, 0.1492, 0.0399,
        0.0773])
[rfa agg] iter:  8, prev_obj_val: 57.091331481933594, obj_val: 64.08436584472656, abs dis: 6.993034362792969
[rfa agg] iter:  8, weight: tensor([0.0447, 0.1223, 0.0538, 0.0693, 0.1349, 0.0638, 0.2722, 0.0649, 0.0450,
        0.1292])
[rfa agg] iter:  9, prev_obj_val: 64.08436584472656, obj_val: 57.091331481933594, abs dis: 6.993034362792969
[rfa agg] iter:  9, weight: tensor([0.0395, 0.0731, 0.0458, 0.1863, 0.0788, 0.0504, 0.2597, 0.1492, 0.0399,
        0.0773])
___Test Target_ResNet_18 poisoned: False, epoch: 293: Average loss: 0.6248, Accuracy: 7994/10000 (79.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 293: Average loss: 6.4049, Accuracy: 416/9000 (4.6222%)
Done in 139.92312026023865 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:294 choose agents : [85, 53, 21, 90, 35, 87, 11, 29, 63, 6]. Adversary List: []
___Train Local_ResNet_18,  epoch 294, local model 85, internal_epoch   1,  Average loss: 0.0009, Accuracy: 363/364 (99.7253%)
___Train Local_ResNet_18,  epoch 294, local model 85, internal_epoch   2,  Average loss: 0.0002, Accuracy: 364/364 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 294: Average loss: 1.0657, Accuracy: 6994/10000 (69.9400%)
___Train Local_ResNet_18,  epoch 294, local model 53, internal_epoch   1,  Average loss: 0.0012, Accuracy: 612/625 (97.9200%)
___Train Local_ResNet_18,  epoch 294, local model 53, internal_epoch   2,  Average loss: 0.0005, Accuracy: 621/625 (99.3600%)
___Test Local_ResNet_18 poisoned: False, epoch: 294: Average loss: 1.8089, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 294, local model 21, internal_epoch   1,  Average loss: 0.0007, Accuracy: 262/262 (100.0000%)
___Train Local_ResNet_18,  epoch 294, local model 21, internal_epoch   2,  Average loss: 0.0012, Accuracy: 261/262 (99.6183%)
___Test Local_ResNet_18 poisoned: False, epoch: 294: Average loss: 0.9518, Accuracy: 7307/10000 (73.0700%)
___Train Local_ResNet_18,  epoch 294, local model 90, internal_epoch   1,  Average loss: 0.0155, Accuracy: 527/578 (91.1765%)
___Train Local_ResNet_18,  epoch 294, local model 90, internal_epoch   2,  Average loss: 0.0155, Accuracy: 438/578 (75.7785%)
___Test Local_ResNet_18 poisoned: False, epoch: 294: Average loss: 16.3800, Accuracy: 1653/10000 (16.5300%)
___Train Local_ResNet_18,  epoch 294, local model 35, internal_epoch   1,  Average loss: 0.0020, Accuracy: 408/419 (97.3747%)
___Train Local_ResNet_18,  epoch 294, local model 35, internal_epoch   2,  Average loss: 0.0009, Accuracy: 411/419 (98.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 294: Average loss: 2.8627, Accuracy: 4406/10000 (44.0600%)
___Train Local_ResNet_18,  epoch 294, local model 87, internal_epoch   1,  Average loss: 0.0024, Accuracy: 385/397 (96.9773%)
___Train Local_ResNet_18,  epoch 294, local model 87, internal_epoch   2,  Average loss: 0.0036, Accuracy: 373/397 (93.9547%)
___Test Local_ResNet_18 poisoned: False, epoch: 294: Average loss: 3.1791, Accuracy: 3812/10000 (38.1200%)
poison local model 11 index 3 
___Train Local_ResNet_18,  epoch 294, local model 11, internal_epoch   1,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%)
___Train Local_ResNet_18,  epoch 294, local model 11, internal_epoch   2,  Average loss: 0.0008, Accuracy: 542/546 (99.2674%)
___Test Local_ResNet_18 poisoned: False, epoch: 294: Average loss: 1.9799, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 294, local model 29, internal_epoch   1,  Average loss: 0.0034, Accuracy: 792/848 (93.3962%)
___Train Local_ResNet_18,  epoch 294, local model 29, internal_epoch   2,  Average loss: 0.0065, Accuracy: 746/848 (87.9717%)
___Test Local_ResNet_18 poisoned: False, epoch: 294: Average loss: 15.2698, Accuracy: 1503/10000 (15.0300%)
___Train Local_ResNet_18,  epoch 294, local model 63, internal_epoch   1,  Average loss: 0.0008, Accuracy: 743/752 (98.8032%)
___Train Local_ResNet_18,  epoch 294, local model 63, internal_epoch   2,  Average loss: 0.0005, Accuracy: 746/752 (99.2021%)
___Test Local_ResNet_18 poisoned: False, epoch: 294: Average loss: 1.0553, Accuracy: 7041/10000 (70.4100%)
___Train Local_ResNet_18,  epoch 294, local model 6, internal_epoch   1,  Average loss: 0.0016, Accuracy: 509/520 (97.8846%)
___Train Local_ResNet_18,  epoch 294, local model 6, internal_epoch   2,  Average loss: 0.0065, Accuracy: 469/520 (90.1923%)
___Test Local_ResNet_18 poisoned: False, epoch: 294: Average loss: 9.6645, Accuracy: 1934/10000 (19.3400%)
time spent on training: 71.26596140861511
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10280549802297119  data num: [364, 625, 262, 578, 419, 397, 546, 848, 752, 520]
[rfa agg] considering poison per batch poison_fraction: 0.008031679533044624
[rfa agg] init. name: [85, 53, 21, 90, 35, 87, 11, 29, 63, 6], weight: tensor([0.0685, 0.1177, 0.0493, 0.1088, 0.0789, 0.0748, 0.1028, 0.1597, 0.1416,
        0.0979])
[rfa agg] iter:  0, prev_obj_val: 27.349950790405273, obj_val: 35.71639633178711, abs dis: 8.366445541381836
[rfa agg] iter:  0, weight: tensor([0.0874, 0.0915, 0.0390, 0.0688, 0.1989, 0.1684, 0.1279, 0.0482, 0.0625,
        0.1074])
[rfa agg] iter:  1, prev_obj_val: 35.71639633178711, obj_val: 39.44051742553711, abs dis: 3.72412109375
[rfa agg] iter:  1, weight: tensor([0.3480, 0.0555, 0.0888, 0.0462, 0.1348, 0.1212, 0.0644, 0.0374, 0.0448,
        0.0590])
[rfa agg] iter:  2, prev_obj_val: 39.44051742553711, obj_val: 39.43772506713867, abs dis: 0.0027923583984375
[rfa agg] iter:  2, weight: tensor([0.2721, 0.0580, 0.1918, 0.0491, 0.1115, 0.1029, 0.0650, 0.0413, 0.0485,
        0.0599])
___Test Target_ResNet_18 poisoned: False, epoch: 294: Average loss: 0.6254, Accuracy: 7992/10000 (79.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 294: Average loss: 6.3246, Accuracy: 449/9000 (4.9889%)
Done in 128.92468452453613 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:295 choose agents : [12, 32, 40, 95, 41, 87, 33, 94, 45, 52]. Adversary List: []
___Train Local_ResNet_18,  epoch 295, local model 12, internal_epoch   1,  Average loss: 0.0027, Accuracy: 936/977 (95.8035%)
___Train Local_ResNet_18,  epoch 295, local model 12, internal_epoch   2,  Average loss: 0.0107, Accuracy: 784/977 (80.2456%)
___Test Local_ResNet_18 poisoned: False, epoch: 295: Average loss: 11.7934, Accuracy: 2635/10000 (26.3500%)
___Train Local_ResNet_18,  epoch 295, local model 32, internal_epoch   1,  Average loss: 0.0010, Accuracy: 814/824 (98.7864%)
___Train Local_ResNet_18,  epoch 295, local model 32, internal_epoch   2,  Average loss: 0.0014, Accuracy: 800/824 (97.0874%)
___Test Local_ResNet_18 poisoned: False, epoch: 295: Average loss: 1.7571, Accuracy: 5846/10000 (58.4600%)
___Train Local_ResNet_18,  epoch 295, local model 40, internal_epoch   1,  Average loss: 0.0023, Accuracy: 624/652 (95.7055%)
___Train Local_ResNet_18,  epoch 295, local model 40, internal_epoch   2,  Average loss: 0.0075, Accuracy: 577/652 (88.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 295: Average loss: 4.4830, Accuracy: 3085/10000 (30.8500%)
___Train Local_ResNet_18,  epoch 295, local model 95, internal_epoch   1,  Average loss: 0.0034, Accuracy: 530/569 (93.1459%)
___Train Local_ResNet_18,  epoch 295, local model 95, internal_epoch   2,  Average loss: 0.0053, Accuracy: 516/569 (90.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 295: Average loss: 10.7547, Accuracy: 1818/10000 (18.1800%)
___Train Local_ResNet_18,  epoch 295, local model 41, internal_epoch   1,  Average loss: 0.0140, Accuracy: 473/513 (92.2027%)
___Train Local_ResNet_18,  epoch 295, local model 41, internal_epoch   2,  Average loss: 0.0110, Accuracy: 394/513 (76.8031%)
___Test Local_ResNet_18 poisoned: False, epoch: 295: Average loss: 29.3343, Accuracy: 1554/10000 (15.5400%)
___Train Local_ResNet_18,  epoch 295, local model 87, internal_epoch   1,  Average loss: 0.0022, Accuracy: 384/397 (96.7254%)
___Train Local_ResNet_18,  epoch 295, local model 87, internal_epoch   2,  Average loss: 0.0026, Accuracy: 378/397 (95.2141%)
___Test Local_ResNet_18 poisoned: False, epoch: 295: Average loss: 3.6582, Accuracy: 4196/10000 (41.9600%)
poison local model 33 index 1 
___Train Local_ResNet_18,  epoch 295, local model 33, internal_epoch   1,  Average loss: 0.0013, Accuracy: 523/527 (99.2410%)
___Train Local_ResNet_18,  epoch 295, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 509/527 (96.5844%)
___Test Local_ResNet_18 poisoned: False, epoch: 295: Average loss: 1.9720, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 295, local model 94, internal_epoch   1,  Average loss: 0.0021, Accuracy: 197/203 (97.0443%)
___Train Local_ResNet_18,  epoch 295, local model 94, internal_epoch   2,  Average loss: 0.0015, Accuracy: 202/203 (99.5074%)
___Test Local_ResNet_18 poisoned: False, epoch: 295: Average loss: 2.0535, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 295, local model 45, internal_epoch   1,  Average loss: 0.0026, Accuracy: 513/529 (96.9754%)
___Train Local_ResNet_18,  epoch 295, local model 45, internal_epoch   2,  Average loss: 0.0054, Accuracy: 481/529 (90.9263%)
___Test Local_ResNet_18 poisoned: False, epoch: 295: Average loss: 5.0922, Accuracy: 2768/10000 (27.6800%)
___Train Local_ResNet_18,  epoch 295, local model 52, internal_epoch   1,  Average loss: 0.0021, Accuracy: 213/214 (99.5327%)
___Train Local_ResNet_18,  epoch 295, local model 52, internal_epoch   2,  Average loss: 0.0007, Accuracy: 214/214 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 295: Average loss: 1.2913, Accuracy: 6694/10000 (66.9400%)
time spent on training: 70.51331734657288
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.09750231267345051  data num: [977, 824, 652, 569, 513, 397, 527, 203, 529, 214]
[rfa agg] considering poison per batch poison_fraction: 0.007617368177613321
[rfa agg] init. name: [12, 32, 40, 95, 41, 87, 33, 94, 45, 52], weight: tensor([0.1808, 0.1525, 0.1206, 0.1053, 0.0949, 0.0735, 0.0975, 0.0376, 0.0979,
        0.0396])
[rfa agg] iter:  0, prev_obj_val: 35.032466888427734, obj_val: 41.34825134277344, abs dis: 6.315784454345703
[rfa agg] iter:  0, weight: tensor([0.0521, 0.0683, 0.0813, 0.1429, 0.1177, 0.2029, 0.1459, 0.0264, 0.1347,
        0.0278])
[rfa agg] iter:  1, prev_obj_val: 41.34825134277344, obj_val: 44.92204284667969, abs dis: 3.57379150390625
[rfa agg] iter:  1, weight: tensor([0.0551, 0.0687, 0.0764, 0.1158, 0.0998, 0.2749, 0.1115, 0.0436, 0.1082,
        0.0460])
[rfa agg] iter:  2, prev_obj_val: 44.92204284667969, obj_val: 48.57400894165039, abs dis: 3.651966094970703
[rfa agg] iter:  2, weight: tensor([0.0613, 0.0745, 0.0809, 0.1147, 0.1001, 0.2220, 0.1094, 0.0633, 0.1071,
        0.0667])
[rfa agg] iter:  3, prev_obj_val: 48.57400894165039, obj_val: 48.572505950927734, abs dis: 0.00150299072265625
[rfa agg] iter:  3, weight: tensor([0.0646, 0.0770, 0.0816, 0.1102, 0.0969, 0.1739, 0.1043, 0.0919, 0.1027,
        0.0969])
___Test Target_ResNet_18 poisoned: False, epoch: 295: Average loss: 0.6236, Accuracy: 7984/10000 (79.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 295: Average loss: 6.1864, Accuracy: 502/9000 (5.5778%)
Done in 134.8305857181549 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:296 choose agents : [32, 46, 40, 24, 98, 10, 59, 96, 71, 78]. Adversary List: []
___Train Local_ResNet_18,  epoch 296, local model 32, internal_epoch   1,  Average loss: 0.0012, Accuracy: 805/824 (97.6942%)
___Train Local_ResNet_18,  epoch 296, local model 32, internal_epoch   2,  Average loss: 0.0019, Accuracy: 797/824 (96.7233%)
___Test Local_ResNet_18 poisoned: False, epoch: 296: Average loss: 1.7068, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 296, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 597/601 (99.3344%)
___Train Local_ResNet_18,  epoch 296, local model 46, internal_epoch   2,  Average loss: 0.0004, Accuracy: 597/601 (99.3344%)
___Test Local_ResNet_18 poisoned: False, epoch: 296: Average loss: 1.5027, Accuracy: 6049/10000 (60.4900%)
___Train Local_ResNet_18,  epoch 296, local model 40, internal_epoch   1,  Average loss: 0.0032, Accuracy: 634/652 (97.2393%)
___Train Local_ResNet_18,  epoch 296, local model 40, internal_epoch   2,  Average loss: 0.0105, Accuracy: 562/652 (86.1963%)
___Test Local_ResNet_18 poisoned: False, epoch: 296: Average loss: 8.8546, Accuracy: 2128/10000 (21.2800%)
___Train Local_ResNet_18,  epoch 296, local model 24, internal_epoch   1,  Average loss: 0.0013, Accuracy: 316/320 (98.7500%)
___Train Local_ResNet_18,  epoch 296, local model 24, internal_epoch   2,  Average loss: 0.0002, Accuracy: 320/320 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 296: Average loss: 1.2796, Accuracy: 6501/10000 (65.0100%)
___Train Local_ResNet_18,  epoch 296, local model 98, internal_epoch   1,  Average loss: 0.0036, Accuracy: 749/802 (93.3915%)
___Train Local_ResNet_18,  epoch 296, local model 98, internal_epoch   2,  Average loss: 0.0098, Accuracy: 656/802 (81.7955%)
___Test Local_ResNet_18 poisoned: False, epoch: 296: Average loss: 34.4375, Accuracy: 1107/10000 (11.0700%)
___Train Local_ResNet_18,  epoch 296, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 696/752 (92.5532%)
___Train Local_ResNet_18,  epoch 296, local model 10, internal_epoch   2,  Average loss: 0.0049, Accuracy: 685/752 (91.0904%)
___Test Local_ResNet_18 poisoned: False, epoch: 296: Average loss: 10.2206, Accuracy: 2266/10000 (22.6600%)
___Train Local_ResNet_18,  epoch 296, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 631/642 (98.2866%)
___Train Local_ResNet_18,  epoch 296, local model 59, internal_epoch   2,  Average loss: 0.0208, Accuracy: 464/642 (72.2741%)
___Test Local_ResNet_18 poisoned: False, epoch: 296: Average loss: 148.7574, Accuracy: 999/10000 (9.9900%)
___Train Local_ResNet_18,  epoch 296, local model 96, internal_epoch   1,  Average loss: 0.0008, Accuracy: 705/708 (99.5763%)
___Train Local_ResNet_18,  epoch 296, local model 96, internal_epoch   2,  Average loss: 0.0029, Accuracy: 686/708 (96.8927%)
___Test Local_ResNet_18 poisoned: False, epoch: 296: Average loss: 3.7380, Accuracy: 4207/10000 (42.0700%)
___Train Local_ResNet_18,  epoch 296, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1141/1166 (97.8559%)
___Train Local_ResNet_18,  epoch 296, local model 71, internal_epoch   2,  Average loss: 0.0054, Accuracy: 1059/1166 (90.8233%)
___Test Local_ResNet_18 poisoned: False, epoch: 296: Average loss: 8.8656, Accuracy: 2169/10000 (21.6900%)
___Train Local_ResNet_18,  epoch 296, local model 78, internal_epoch   1,  Average loss: 0.0023, Accuracy: 248/255 (97.2549%)
___Train Local_ResNet_18,  epoch 296, local model 78, internal_epoch   2,  Average loss: 0.0009, Accuracy: 252/255 (98.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 296: Average loss: 2.5266, Accuracy: 5111/10000 (51.1100%)
time spent on training: 65.87298154830933
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [824, 601, 652, 320, 802, 752, 642, 708, 1166, 255]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [32, 46, 40, 24, 98, 10, 59, 96, 71, 78], weight: tensor([0.1226, 0.0894, 0.0970, 0.0476, 0.1193, 0.1119, 0.0955, 0.1053, 0.1735,
        0.0379])
[rfa agg] iter:  0, prev_obj_val: 31.3017578125, obj_val: 36.54693603515625, abs dis: 5.24517822265625
[rfa agg] iter:  0, weight: tensor([0.1000, 0.2440, 0.1442, 0.0186, 0.0874, 0.1216, 0.0954, 0.1327, 0.0436,
        0.0126])
[rfa agg] iter:  1, prev_obj_val: 36.54693603515625, obj_val: 36.54063034057617, abs dis: 0.006305694580078125
[rfa agg] iter:  1, weight: tensor([0.0871, 0.3160, 0.1263, 0.0270, 0.0793, 0.1022, 0.0950, 0.1031, 0.0463,
        0.0176])
[rfa agg] iter:  2, prev_obj_val: 36.54063034057617, obj_val: 36.54051208496094, abs dis: 0.000118255615234375
[rfa agg] iter:  2, weight: tensor([0.0859, 0.3269, 0.1237, 0.0266, 0.0781, 0.1005, 0.0938, 0.1015, 0.0457,
        0.0174])
___Test Target_ResNet_18 poisoned: False, epoch: 296: Average loss: 0.6254, Accuracy: 7986/10000 (79.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 296: Average loss: 6.1728, Accuracy: 464/9000 (5.1556%)
Done in 126.82574892044067 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:297 choose agents : [95, 43, 1, 8, 17, 19, 94, 71, 63, 23]. Adversary List: []
___Train Local_ResNet_18,  epoch 297, local model 95, internal_epoch   1,  Average loss: 0.0029, Accuracy: 538/569 (94.5518%)
___Train Local_ResNet_18,  epoch 297, local model 95, internal_epoch   2,  Average loss: 0.0033, Accuracy: 531/569 (93.3216%)
___Test Local_ResNet_18 poisoned: False, epoch: 297: Average loss: 4.1763, Accuracy: 3174/10000 (31.7400%)
___Train Local_ResNet_18,  epoch 297, local model 43, internal_epoch   1,  Average loss: 0.0023, Accuracy: 330/345 (95.6522%)
___Train Local_ResNet_18,  epoch 297, local model 43, internal_epoch   2,  Average loss: 0.0018, Accuracy: 335/345 (97.1014%)
___Test Local_ResNet_18 poisoned: False, epoch: 297: Average loss: 3.8339, Accuracy: 4140/10000 (41.4000%)
___Train Local_ResNet_18,  epoch 297, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 624/641 (97.3479%)
___Train Local_ResNet_18,  epoch 297, local model 1, internal_epoch   2,  Average loss: 0.0118, Accuracy: 607/641 (94.6958%)
___Test Local_ResNet_18 poisoned: False, epoch: 297: Average loss: 2.8377, Accuracy: 4288/10000 (42.8800%)
___Train Local_ResNet_18,  epoch 297, local model 8, internal_epoch   1,  Average loss: 0.0006, Accuracy: 533/534 (99.8127%)
___Train Local_ResNet_18,  epoch 297, local model 8, internal_epoch   2,  Average loss: 0.0002, Accuracy: 534/534 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 297: Average loss: 1.1713, Accuracy: 6734/10000 (67.3400%)
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 297, local model 17, internal_epoch   1,  Average loss: 0.0009, Accuracy: 523/526 (99.4297%)
___Train Local_ResNet_18,  epoch 297, local model 17, internal_epoch   2,  Average loss: 0.0006, Accuracy: 522/526 (99.2395%)
___Test Local_ResNet_18 poisoned: False, epoch: 297: Average loss: 1.0695, Accuracy: 6968/10000 (69.6800%)
___Train Local_ResNet_18,  epoch 297, local model 19, internal_epoch   1,  Average loss: 0.0064, Accuracy: 148/173 (85.5491%)
___Train Local_ResNet_18,  epoch 297, local model 19, internal_epoch   2,  Average loss: 0.0031, Accuracy: 164/173 (94.7977%)
___Test Local_ResNet_18 poisoned: False, epoch: 297: Average loss: 4.6253, Accuracy: 3595/10000 (35.9500%)
___Train Local_ResNet_18,  epoch 297, local model 94, internal_epoch   1,  Average loss: 0.0028, Accuracy: 199/203 (98.0296%)
___Train Local_ResNet_18,  epoch 297, local model 94, internal_epoch   2,  Average loss: 0.0035, Accuracy: 194/203 (95.5665%)
___Test Local_ResNet_18 poisoned: False, epoch: 297: Average loss: 3.4196, Accuracy: 3740/10000 (37.4000%)
___Train Local_ResNet_18,  epoch 297, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1126/1166 (96.5695%)
___Train Local_ResNet_18,  epoch 297, local model 71, internal_epoch   2,  Average loss: 0.0072, Accuracy: 1005/1166 (86.1921%)
___Test Local_ResNet_18 poisoned: False, epoch: 297: Average loss: 23.1065, Accuracy: 1826/10000 (18.2600%)
___Train Local_ResNet_18,  epoch 297, local model 63, internal_epoch   1,  Average loss: 0.0007, Accuracy: 745/752 (99.0691%)
___Train Local_ResNet_18,  epoch 297, local model 63, internal_epoch   2,  Average loss: 0.0004, Accuracy: 748/752 (99.4681%)
___Test Local_ResNet_18 poisoned: False, epoch: 297: Average loss: 0.9632, Accuracy: 7175/10000 (71.7500%)
___Train Local_ResNet_18,  epoch 297, local model 23, internal_epoch   1,  Average loss: 0.0011, Accuracy: 248/248 (100.0000%)
___Train Local_ResNet_18,  epoch 297, local model 23, internal_epoch   2,  Average loss: 0.0004, Accuracy: 247/248 (99.5968%)
___Test Local_ResNet_18 poisoned: False, epoch: 297: Average loss: 0.8293, Accuracy: 7443/10000 (74.4300%)
time spent on training: 70.87392020225525
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10199728524335855  data num: [569, 345, 641, 534, 526, 173, 203, 1166, 752, 248]
[rfa agg] considering poison per batch poison_fraction: 0.007968537909637387
[rfa agg] init. name: [95, 43, 1, 8, 17, 19, 94, 71, 63, 23], weight: tensor([0.1103, 0.0669, 0.1243, 0.1035, 0.1020, 0.0335, 0.0394, 0.2261, 0.1458,
        0.0481])
[rfa agg] iter:  0, prev_obj_val: 40.54228591918945, obj_val: 45.724185943603516, abs dis: 5.1819000244140625
[rfa agg] iter:  0, weight: tensor([0.1932, 0.0760, 0.0953, 0.2219, 0.2103, 0.0160, 0.0233, 0.0489, 0.0864,
        0.0286])
[rfa agg] iter:  1, prev_obj_val: 45.724185943603516, obj_val: 45.71611022949219, abs dis: 0.008075714111328125
[rfa agg] iter:  1, weight: tensor([0.1578, 0.1789, 0.0933, 0.1567, 0.1530, 0.0256, 0.0396, 0.0572, 0.0890,
        0.0489])
___Test Target_ResNet_18 poisoned: False, epoch: 297: Average loss: 0.6294, Accuracy: 7962/10000 (79.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 297: Average loss: 6.1612, Accuracy: 445/9000 (4.9444%)
Done in 129.08558058738708 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:298 choose agents : [38, 15, 57, 55, 80, 77, 88, 43, 28, 98]. Adversary List: []
___Train Local_ResNet_18,  epoch 298, local model 38, internal_epoch   1,  Average loss: 0.0012, Accuracy: 744/756 (98.4127%)
___Train Local_ResNet_18,  epoch 298, local model 38, internal_epoch   2,  Average loss: 0.0018, Accuracy: 731/756 (96.6931%)
___Test Local_ResNet_18 poisoned: False, epoch: 298: Average loss: 2.5477, Accuracy: 4941/10000 (49.4100%)
___Train Local_ResNet_18,  epoch 298, local model 15, internal_epoch   1,  Average loss: 0.0018, Accuracy: 339/341 (99.4135%)
___Train Local_ResNet_18,  epoch 298, local model 15, internal_epoch   2,  Average loss: 0.0006, Accuracy: 339/341 (99.4135%)
___Test Local_ResNet_18 poisoned: False, epoch: 298: Average loss: 3.3506, Accuracy: 4226/10000 (42.2600%)
___Train Local_ResNet_18,  epoch 298, local model 57, internal_epoch   1,  Average loss: 0.0007, Accuracy: 289/290 (99.6552%)
___Train Local_ResNet_18,  epoch 298, local model 57, internal_epoch   2,  Average loss: 0.0002, Accuracy: 290/290 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 298: Average loss: 0.7455, Accuracy: 7726/10000 (77.2600%)
___Train Local_ResNet_18,  epoch 298, local model 55, internal_epoch   1,  Average loss: 0.0008, Accuracy: 299/299 (100.0000%)
___Train Local_ResNet_18,  epoch 298, local model 55, internal_epoch   2,  Average loss: 0.0001, Accuracy: 299/299 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 298: Average loss: 1.4069, Accuracy: 6551/10000 (65.5100%)
___Train Local_ResNet_18,  epoch 298, local model 80, internal_epoch   1,  Average loss: 0.0013, Accuracy: 363/363 (100.0000%)
___Train Local_ResNet_18,  epoch 298, local model 80, internal_epoch   2,  Average loss: 0.0005, Accuracy: 362/363 (99.7245%)
___Test Local_ResNet_18 poisoned: False, epoch: 298: Average loss: 2.5712, Accuracy: 5355/10000 (53.5500%)
poison local model 77 index 2 
___Train Local_ResNet_18,  epoch 298, local model 77, internal_epoch   1,  Average loss: 0.0005, Accuracy: 496/496 (100.0000%)
___Train Local_ResNet_18,  epoch 298, local model 77, internal_epoch   2,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 298: Average loss: 0.9390, Accuracy: 7355/10000 (73.5500%)
___Train Local_ResNet_18,  epoch 298, local model 88, internal_epoch   1,  Average loss: 0.0026, Accuracy: 426/447 (95.3020%)
___Train Local_ResNet_18,  epoch 298, local model 88, internal_epoch   2,  Average loss: 0.0020, Accuracy: 429/447 (95.9732%)
___Test Local_ResNet_18 poisoned: False, epoch: 298: Average loss: 4.3280, Accuracy: 3296/10000 (32.9600%)
___Train Local_ResNet_18,  epoch 298, local model 43, internal_epoch   1,  Average loss: 0.0013, Accuracy: 344/345 (99.7101%)
___Train Local_ResNet_18,  epoch 298, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 345/345 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 298: Average loss: 2.3502, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 298, local model 28, internal_epoch   1,  Average loss: 0.0006, Accuracy: 423/423 (100.0000%)
___Train Local_ResNet_18,  epoch 298, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 298: Average loss: 1.1971, Accuracy: 6982/10000 (69.8200%)
___Train Local_ResNet_18,  epoch 298, local model 98, internal_epoch   1,  Average loss: 0.0019, Accuracy: 781/802 (97.3815%)
___Train Local_ResNet_18,  epoch 298, local model 98, internal_epoch   2,  Average loss: 0.0054, Accuracy: 722/802 (90.0249%)
___Test Local_ResNet_18 poisoned: False, epoch: 298: Average loss: 3.5736, Accuracy: 3141/10000 (31.4100%)
time spent on training: 69.96806311607361
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10872424375274002  data num: [756, 341, 290, 299, 363, 496, 447, 345, 423, 802]
[rfa agg] considering poison per batch poison_fraction: 0.008494081543182814
[rfa agg] init. name: [38, 15, 57, 55, 80, 77, 88, 43, 28, 98], weight: tensor([0.1657, 0.0747, 0.0636, 0.0655, 0.0796, 0.1087, 0.0980, 0.0756, 0.0927,
        0.1758])
[rfa agg] iter:  0, prev_obj_val: 32.188350677490234, obj_val: 45.05909729003906, abs dis: 12.870746612548828
[rfa agg] iter:  0, weight: tensor([0.0297, 0.0850, 0.2619, 0.2535, 0.0931, 0.0454, 0.0583, 0.0882, 0.0575,
        0.0274])
[rfa agg] iter:  1, prev_obj_val: 45.05909729003906, obj_val: 32.00026321411133, abs dis: 13.058834075927734
[rfa agg] iter:  1, weight: tensor([0.0663, 0.1009, 0.1443, 0.1485, 0.1080, 0.0825, 0.0940, 0.1026, 0.0903,
        0.0627])
[rfa agg] iter:  2, prev_obj_val: 32.00026321411133, obj_val: 53.957664489746094, abs dis: 21.957401275634766
[rfa agg] iter:  2, weight: tensor([0.0224, 0.0658, 0.3324, 0.2961, 0.0721, 0.0343, 0.0443, 0.0683, 0.0437,
        0.0207])
[rfa agg] iter:  3, prev_obj_val: 53.957664489746094, obj_val: 28.6638126373291, abs dis: 25.293851852416992
[rfa agg] iter:  3, weight: tensor([0.0817, 0.0997, 0.1193, 0.1230, 0.1064, 0.0928, 0.1012, 0.1011, 0.0967,
        0.0782])
[rfa agg] iter:  4, prev_obj_val: 28.6638126373291, obj_val: 45.05818176269531, abs dis: 16.39436912536621
[rfa agg] iter:  4, weight: tensor([0.0307, 0.1400, 0.1433, 0.1448, 0.1617, 0.0525, 0.0727, 0.1523, 0.0738,
        0.0281])
[rfa agg] iter:  5, prev_obj_val: 45.05818176269531, obj_val: 32.000343322753906, abs dis: 13.057838439941406
[rfa agg] iter:  5, weight: tensor([0.0664, 0.1011, 0.1440, 0.1481, 0.1081, 0.0825, 0.0940, 0.1027, 0.0903,
        0.0628])
[rfa agg] iter:  6, prev_obj_val: 32.000343322753906, obj_val: 53.95765686035156, abs dis: 21.957313537597656
[rfa agg] iter:  6, weight: tensor([0.0224, 0.0659, 0.3324, 0.2960, 0.0721, 0.0343, 0.0443, 0.0683, 0.0437,
        0.0207])
[rfa agg] iter:  7, prev_obj_val: 53.95765686035156, obj_val: 28.6638126373291, abs dis: 25.29384422302246
[rfa agg] iter:  7, weight: tensor([0.0817, 0.0997, 0.1193, 0.1230, 0.1064, 0.0928, 0.1012, 0.1011, 0.0967,
        0.0782])
[rfa agg] iter:  8, prev_obj_val: 28.6638126373291, obj_val: 45.05818176269531, abs dis: 16.39436912536621
[rfa agg] iter:  8, weight: tensor([0.0307, 0.1400, 0.1433, 0.1448, 0.1617, 0.0525, 0.0727, 0.1523, 0.0738,
        0.0281])
[rfa agg] iter:  9, prev_obj_val: 45.05818176269531, obj_val: 32.000343322753906, abs dis: 13.057838439941406
[rfa agg] iter:  9, weight: tensor([0.0664, 0.1011, 0.1440, 0.1481, 0.1081, 0.0825, 0.0940, 0.1027, 0.0903,
        0.0628])
___Test Target_ResNet_18 poisoned: False, epoch: 298: Average loss: 0.6307, Accuracy: 7959/10000 (79.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 298: Average loss: 6.2193, Accuracy: 428/9000 (4.7556%)
Done in 144.82732462882996 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:299 choose agents : [51, 96, 59, 53, 85, 64, 4, 80, 66, 21]. Adversary List: []
___Train Local_ResNet_18,  epoch 299, local model 51, internal_epoch   1,  Average loss: 0.0030, Accuracy: 450/479 (93.9457%)
___Train Local_ResNet_18,  epoch 299, local model 51, internal_epoch   2,  Average loss: 0.0014, Accuracy: 465/479 (97.0772%)
___Test Local_ResNet_18 poisoned: False, epoch: 299: Average loss: 6.6551, Accuracy: 2277/10000 (22.7700%)
___Train Local_ResNet_18,  epoch 299, local model 96, internal_epoch   1,  Average loss: 0.0021, Accuracy: 700/708 (98.8701%)
___Train Local_ResNet_18,  epoch 299, local model 96, internal_epoch   2,  Average loss: 0.0257, Accuracy: 441/708 (62.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 299: Average loss: 39.2355, Accuracy: 1274/10000 (12.7400%)
___Train Local_ResNet_18,  epoch 299, local model 59, internal_epoch   1,  Average loss: 0.0012, Accuracy: 631/642 (98.2866%)
___Train Local_ResNet_18,  epoch 299, local model 59, internal_epoch   2,  Average loss: 0.0062, Accuracy: 633/642 (98.5981%)
___Test Local_ResNet_18 poisoned: False, epoch: 299: Average loss: 3.1778, Accuracy: 3645/10000 (36.4500%)
___Train Local_ResNet_18,  epoch 299, local model 53, internal_epoch   1,  Average loss: 0.0011, Accuracy: 613/625 (98.0800%)
___Train Local_ResNet_18,  epoch 299, local model 53, internal_epoch   2,  Average loss: 0.0006, Accuracy: 619/625 (99.0400%)
___Test Local_ResNet_18 poisoned: False, epoch: 299: Average loss: 2.1948, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 299, local model 85, internal_epoch   1,  Average loss: 0.0009, Accuracy: 364/364 (100.0000%)
___Train Local_ResNet_18,  epoch 299, local model 85, internal_epoch   2,  Average loss: 0.0005, Accuracy: 362/364 (99.4505%)
___Test Local_ResNet_18 poisoned: False, epoch: 299: Average loss: 1.1147, Accuracy: 6970/10000 (69.7000%)
___Train Local_ResNet_18,  epoch 299, local model 64, internal_epoch   1,  Average loss: 0.0015, Accuracy: 672/686 (97.9592%)
___Train Local_ResNet_18,  epoch 299, local model 64, internal_epoch   2,  Average loss: 0.0014, Accuracy: 671/686 (97.8134%)
___Test Local_ResNet_18 poisoned: False, epoch: 299: Average loss: 1.9391, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 299, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 543/557 (97.4865%)
___Train Local_ResNet_18,  epoch 299, local model 4, internal_epoch   2,  Average loss: 0.0013, Accuracy: 543/557 (97.4865%)
___Test Local_ResNet_18 poisoned: False, epoch: 299: Average loss: 3.2461, Accuracy: 4385/10000 (43.8500%)
___Train Local_ResNet_18,  epoch 299, local model 80, internal_epoch   1,  Average loss: 0.0012, Accuracy: 362/363 (99.7245%)
___Train Local_ResNet_18,  epoch 299, local model 80, internal_epoch   2,  Average loss: 0.0003, Accuracy: 363/363 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 299: Average loss: 1.8951, Accuracy: 6019/10000 (60.1900%)
___Train Local_ResNet_18,  epoch 299, local model 66, internal_epoch   1,  Average loss: 0.0017, Accuracy: 541/555 (97.4775%)
___Train Local_ResNet_18,  epoch 299, local model 66, internal_epoch   2,  Average loss: 0.0009, Accuracy: 544/555 (98.0180%)
___Test Local_ResNet_18 poisoned: False, epoch: 299: Average loss: 2.6809, Accuracy: 4579/10000 (45.7900%)
___Train Local_ResNet_18,  epoch 299, local model 21, internal_epoch   1,  Average loss: 0.0011, Accuracy: 262/262 (100.0000%)
___Train Local_ResNet_18,  epoch 299, local model 21, internal_epoch   2,  Average loss: 0.0003, Accuracy: 261/262 (99.6183%)
___Test Local_ResNet_18 poisoned: False, epoch: 299: Average loss: 1.1414, Accuracy: 6690/10000 (66.9000%)
time spent on training: 63.631959199905396
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [479, 708, 642, 625, 364, 686, 557, 363, 555, 262]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [51, 96, 59, 53, 85, 64, 4, 80, 66, 21], weight: tensor([0.0914, 0.1351, 0.1225, 0.1193, 0.0695, 0.1309, 0.1063, 0.0693, 0.1059,
        0.0500])
[rfa agg] iter:  0, prev_obj_val: 32.47572326660156, obj_val: 32.174930572509766, abs dis: 0.3007926940917969
[rfa agg] iter:  0, weight: tensor([0.0801, 0.0395, 0.0461, 0.0560, 0.2615, 0.0493, 0.0654, 0.2518, 0.0649,
        0.0855])
[rfa agg] iter:  1, prev_obj_val: 32.174930572509766, obj_val: 52.93701934814453, abs dis: 20.762088775634766
[rfa agg] iter:  1, weight: tensor([0.0547, 0.0261, 0.0310, 0.0378, 0.3488, 0.0332, 0.0443, 0.3183, 0.0440,
        0.0618])
[rfa agg] iter:  2, prev_obj_val: 52.93701934814453, obj_val: 39.85541915893555, abs dis: 13.081600189208984
[rfa agg] iter:  2, weight: tensor([0.0938, 0.0706, 0.0762, 0.0857, 0.1298, 0.0814, 0.0899, 0.1293, 0.0895,
        0.1538])
[rfa agg] iter:  3, prev_obj_val: 39.85541915893555, obj_val: 39.82096862792969, abs dis: 0.034450531005859375
[rfa agg] iter:  3, weight: tensor([0.0652, 0.0397, 0.0448, 0.0524, 0.1452, 0.0479, 0.0579, 0.1437, 0.0576,
        0.3457])
[rfa agg] iter:  4, prev_obj_val: 39.82096862792969, obj_val: 57.344940185546875, abs dis: 17.523971557617188
[rfa agg] iter:  4, weight: tensor([0.0556, 0.0337, 0.0382, 0.0447, 0.1261, 0.0408, 0.0494, 0.1248, 0.0491,
        0.4377])
[rfa agg] iter:  5, prev_obj_val: 57.344940185546875, obj_val: 39.865108489990234, abs dis: 17.47983169555664
[rfa agg] iter:  5, weight: tensor([0.0966, 0.0766, 0.0815, 0.0908, 0.1233, 0.0872, 0.0942, 0.1229, 0.0937,
        0.1332])
[rfa agg] iter:  6, prev_obj_val: 39.865108489990234, obj_val: 35.85768127441406, abs dis: 4.007427215576172
[rfa agg] iter:  6, weight: tensor([0.0665, 0.0406, 0.0456, 0.0534, 0.1474, 0.0488, 0.0590, 0.1458, 0.0587,
        0.3342])
[rfa agg] iter:  7, prev_obj_val: 35.85768127441406, obj_val: 39.830318450927734, abs dis: 3.972637176513672
[rfa agg] iter:  7, weight: tensor([0.0677, 0.0370, 0.0427, 0.0509, 0.2350, 0.0457, 0.0578, 0.2284, 0.0574,
        0.1774])
[rfa agg] iter:  8, prev_obj_val: 39.830318450927734, obj_val: 57.342350006103516, abs dis: 17.51203155517578
[rfa agg] iter:  8, weight: tensor([0.0589, 0.0357, 0.0404, 0.0473, 0.1345, 0.0432, 0.0523, 0.1333, 0.0520,
        0.4022])
[rfa agg] iter:  9, prev_obj_val: 57.342350006103516, obj_val: 39.865135192871094, abs dis: 17.477214813232422
[rfa agg] iter:  9, weight: tensor([0.0966, 0.0766, 0.0815, 0.0908, 0.1233, 0.0872, 0.0942, 0.1229, 0.0937,
        0.1331])
___Test Target_ResNet_18 poisoned: False, epoch: 299: Average loss: 0.6307, Accuracy: 7967/10000 (79.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 299: Average loss: 6.2212, Accuracy: 404/9000 (4.4889%)
Done in 141.092782497406 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:300 choose agents : [17, 39, 59, 89, 57, 76, 93, 68, 65, 73]. Adversary List: []
poison local model 17 index 0 
___Train Local_ResNet_18,  epoch 300, local model 17, internal_epoch   1,  Average loss: 0.0006, Accuracy: 525/526 (99.8099%)
___Train Local_ResNet_18,  epoch 300, local model 17, internal_epoch   2,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 300: Average loss: 0.9355, Accuracy: 7334/10000 (73.3400%)
___Train Local_ResNet_18,  epoch 300, local model 39, internal_epoch   1,  Average loss: 0.0014, Accuracy: 217/217 (100.0000%)
___Train Local_ResNet_18,  epoch 300, local model 39, internal_epoch   2,  Average loss: 0.0002, Accuracy: 217/217 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 300: Average loss: 1.2067, Accuracy: 6713/10000 (67.1300%)
___Train Local_ResNet_18,  epoch 300, local model 59, internal_epoch   1,  Average loss: 0.0016, Accuracy: 637/642 (99.2212%)
___Train Local_ResNet_18,  epoch 300, local model 59, internal_epoch   2,  Average loss: 0.0160, Accuracy: 490/642 (76.3240%)
___Test Local_ResNet_18 poisoned: False, epoch: 300: Average loss: 146.3685, Accuracy: 1013/10000 (10.1300%)
___Train Local_ResNet_18,  epoch 300, local model 89, internal_epoch   1,  Average loss: 0.0025, Accuracy: 399/413 (96.6102%)
___Train Local_ResNet_18,  epoch 300, local model 89, internal_epoch   2,  Average loss: 0.0027, Accuracy: 394/413 (95.3995%)
___Test Local_ResNet_18 poisoned: False, epoch: 300: Average loss: 3.0205, Accuracy: 4196/10000 (41.9600%)
___Train Local_ResNet_18,  epoch 300, local model 57, internal_epoch   1,  Average loss: 0.0007, Accuracy: 288/290 (99.3103%)
___Train Local_ResNet_18,  epoch 300, local model 57, internal_epoch   2,  Average loss: 0.0002, Accuracy: 290/290 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 300: Average loss: 0.7537, Accuracy: 7706/10000 (77.0600%)
___Train Local_ResNet_18,  epoch 300, local model 76, internal_epoch   1,  Average loss: 0.0322, Accuracy: 63/65 (96.9231%)
___Train Local_ResNet_18,  epoch 300, local model 76, internal_epoch   2,  Average loss: 0.0495, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 300: Average loss: 1.2409, Accuracy: 6695/10000 (66.9500%)
___Train Local_ResNet_18,  epoch 300, local model 93, internal_epoch   1,  Average loss: 0.0010, Accuracy: 576/584 (98.6301%)
___Train Local_ResNet_18,  epoch 300, local model 93, internal_epoch   2,  Average loss: 0.0020, Accuracy: 572/584 (97.9452%)
___Test Local_ResNet_18 poisoned: False, epoch: 300: Average loss: 2.2882, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 300, local model 68, internal_epoch   1,  Average loss: 0.0006, Accuracy: 416/416 (100.0000%)
___Train Local_ResNet_18,  epoch 300, local model 68, internal_epoch   2,  Average loss: 0.0002, Accuracy: 416/416 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 300: Average loss: 0.8437, Accuracy: 7541/10000 (75.4100%)
___Train Local_ResNet_18,  epoch 300, local model 65, internal_epoch   1,  Average loss: 0.0009, Accuracy: 313/314 (99.6815%)
___Train Local_ResNet_18,  epoch 300, local model 65, internal_epoch   2,  Average loss: 0.0003, Accuracy: 314/314 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 300: Average loss: 0.9271, Accuracy: 7364/10000 (73.6400%)
___Train Local_ResNet_18,  epoch 300, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 437/500 (87.4000%)
___Train Local_ResNet_18,  epoch 300, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 467/500 (93.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 300: Average loss: 5.6160, Accuracy: 3122/10000 (31.2200%)
time spent on training: 70.42134499549866
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.13259389967229646  data num: [526, 217, 642, 413, 290, 65, 584, 416, 314, 500]
[rfa agg] considering poison per batch poison_fraction: 0.01035889841189816
[rfa agg] init. name: [17, 39, 59, 89, 57, 76, 93, 68, 65, 73], weight: tensor([0.1326, 0.0547, 0.1618, 0.1041, 0.0731, 0.0164, 0.1472, 0.1049, 0.0792,
        0.1260])
[rfa agg] iter:  0, prev_obj_val: 26.868392944335938, obj_val: 29.28732681274414, abs dis: 2.418933868408203
[rfa agg] iter:  0, weight: tensor([0.0693, 0.0644, 0.0513, 0.1168, 0.2016, 0.0086, 0.0598, 0.1233, 0.2192,
        0.0857])
[rfa agg] iter:  1, prev_obj_val: 29.28732681274414, obj_val: 45.07072830200195, abs dis: 15.783401489257812
[rfa agg] iter:  1, weight: tensor([0.0344, 0.0550, 0.0265, 0.0522, 0.3328, 0.0057, 0.0305, 0.0541, 0.3674,
        0.0414])
[rfa agg] iter:  2, prev_obj_val: 45.07072830200195, obj_val: 32.8155517578125, abs dis: 12.255176544189453
[rfa agg] iter:  2, weight: tensor([0.0777, 0.1875, 0.0687, 0.0907, 0.1283, 0.0554, 0.0738, 0.0922, 0.1390,
        0.0867])
[rfa agg] iter:  3, prev_obj_val: 32.8155517578125, obj_val: 45.05668258666992, abs dis: 12.241130828857422
[rfa agg] iter:  3, weight: tensor([0.0515, 0.1690, 0.0415, 0.0710, 0.2283, 0.0114, 0.0466, 0.0730, 0.2471,
        0.0604])
[rfa agg] iter:  4, prev_obj_val: 45.05668258666992, obj_val: 32.815635681152344, abs dis: 12.241046905517578
[rfa agg] iter:  4, weight: tensor([0.0777, 0.1878, 0.0688, 0.0907, 0.1282, 0.0552, 0.0738, 0.0922, 0.1388,
        0.0868])
[rfa agg] iter:  5, prev_obj_val: 32.815635681152344, obj_val: 45.05668258666992, abs dis: 12.241046905517578
[rfa agg] iter:  5, weight: tensor([0.0515, 0.1690, 0.0415, 0.0710, 0.2283, 0.0114, 0.0466, 0.0730, 0.2471,
        0.0605])
[rfa agg] iter:  6, prev_obj_val: 45.05668258666992, obj_val: 32.815635681152344, abs dis: 12.241046905517578
[rfa agg] iter:  6, weight: tensor([0.0777, 0.1878, 0.0688, 0.0907, 0.1282, 0.0552, 0.0738, 0.0922, 0.1388,
        0.0868])
[rfa agg] iter:  7, prev_obj_val: 32.815635681152344, obj_val: 45.05668258666992, abs dis: 12.241046905517578
[rfa agg] iter:  7, weight: tensor([0.0515, 0.1690, 0.0415, 0.0710, 0.2283, 0.0114, 0.0466, 0.0730, 0.2471,
        0.0605])
[rfa agg] iter:  8, prev_obj_val: 45.05668258666992, obj_val: 32.815635681152344, abs dis: 12.241046905517578
[rfa agg] iter:  8, weight: tensor([0.0777, 0.1878, 0.0688, 0.0907, 0.1282, 0.0552, 0.0738, 0.0922, 0.1388,
        0.0868])
[rfa agg] iter:  9, prev_obj_val: 32.815635681152344, obj_val: 45.05668258666992, abs dis: 12.241046905517578
[rfa agg] iter:  9, weight: tensor([0.0515, 0.1690, 0.0415, 0.0710, 0.2283, 0.0114, 0.0466, 0.0730, 0.2471,
        0.0605])
___Test Target_ResNet_18 poisoned: False, epoch: 300: Average loss: 0.6275, Accuracy: 7981/10000 (79.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 300: Average loss: 6.2514, Accuracy: 402/9000 (4.4667%)
Done in 141.85441946983337 sec.
Saving all the graphs.
This run has a label: Nov.13_08.00.50. Visdom environment: cifar
