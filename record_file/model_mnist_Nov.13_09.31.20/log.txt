current path: saved_models/model_mnist_Nov.13_09.31.20
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [41, 73, 51, 74]
We use following environment for graphs:  mnist_DBA
----------------------------------Start one training epoch------------------------------------------
Server Epoch:11 choose agents : [41, 73, 51, 74, 23, 76, 63, 11, 75, 43]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   1,  Average loss: 0.0251, Accuracy: 337/606 (55.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   2,  Average loss: 0.0158, Accuracy: 348/606 (57.4257%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   3,  Average loss: 0.0129, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   4,  Average loss: 0.0122, Accuracy: 390/606 (64.3564%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   5,  Average loss: 0.0118, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   6,  Average loss: 0.0117, Accuracy: 393/606 (64.8515%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   7,  Average loss: 0.0112, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   8,  Average loss: 0.0113, Accuracy: 380/606 (62.7063%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   9,  Average loss: 0.0111, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch  10,  Average loss: 0.0105, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Global model norm: 16.539532092117113.
Norm before scaling: 16.771590708183066. Distance: 4.683387885449089
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.3936, Accuracy: 4211/10000 (42.1100%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.8792, Accuracy: 5911/8968 (65.9121%)
Scaling by  100
Scaled Norm after poisoning: 467.11282429944055, distance: 468.3388029781432
Total norm for 4 adversaries is: 467.11282429944055. distance: 468.3388029781432
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 99715.5181, Accuracy: 4/8968 (0.0446%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0245, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   2,  Average loss: 0.0196, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   3,  Average loss: 0.0167, Accuracy: 307/591 (51.9459%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   4,  Average loss: 0.0154, Accuracy: 312/591 (52.7919%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   5,  Average loss: 0.0148, Accuracy: 329/591 (55.6684%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   6,  Average loss: 0.0140, Accuracy: 354/591 (59.8985%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   7,  Average loss: 0.0142, Accuracy: 347/591 (58.7140%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   8,  Average loss: 0.0138, Accuracy: 355/591 (60.0677%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   9,  Average loss: 0.0134, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch  10,  Average loss: 0.0137, Accuracy: 342/591 (57.8680%), train_poison_data_count: 195
Global model norm: 16.539532092117113.
Norm before scaling: 16.596511180052552. Distance: 4.013046921388002
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0759, Accuracy: 5309/10000 (53.0900%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.9496, Accuracy: 4970/8968 (55.4193%)
Scaling by  100
Scaled Norm after poisoning: 399.87167863578435, distance: 401.3046691729365
Total norm for 4 adversaries is: 399.87167863578435. distance: 401.3046691729365
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0251, Accuracy: 314/568 (55.2817%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   2,  Average loss: 0.0127, Accuracy: 356/568 (62.6761%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   3,  Average loss: 0.0113, Accuracy: 371/568 (65.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   4,  Average loss: 0.0109, Accuracy: 385/568 (67.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   5,  Average loss: 0.0104, Accuracy: 396/568 (69.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   6,  Average loss: 0.0104, Accuracy: 387/568 (68.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   7,  Average loss: 0.0103, Accuracy: 380/568 (66.9014%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   8,  Average loss: 0.0102, Accuracy: 376/568 (66.1972%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   9,  Average loss: 0.0100, Accuracy: 385/568 (67.7817%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch  10,  Average loss: 0.0098, Accuracy: 401/568 (70.5986%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.719933697874765. Distance: 4.641436470574167
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.3206, Accuracy: 5094/10000 (50.9400%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.7913, Accuracy: 5199/8968 (57.9728%)
Scaling by  100
Scaled Norm after poisoning: 462.76195284400814, distance: 464.143667144129
Total norm for 4 adversaries is: 462.76195284400814. distance: 464.143667144129
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 7829.7658, Accuracy: 8070/8968 (89.9866%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0265, Accuracy: 309/557 (55.4758%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   2,  Average loss: 0.0131, Accuracy: 376/557 (67.5045%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   3,  Average loss: 0.0077, Accuracy: 484/557 (86.8941%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   4,  Average loss: 0.0061, Accuracy: 493/557 (88.5099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   5,  Average loss: 0.0050, Accuracy: 509/557 (91.3824%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   6,  Average loss: 0.0046, Accuracy: 506/557 (90.8438%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   7,  Average loss: 0.0036, Accuracy: 515/557 (92.4596%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   8,  Average loss: 0.0037, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   9,  Average loss: 0.0030, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch  10,  Average loss: 0.0034, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.842614866377172. Distance: 4.709500171033218
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0161, Accuracy: 7196/10000 (71.9600%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1118, Accuracy: 8562/8968 (95.4728%)
Scaling by  100
Scaled Norm after poisoning: 469.9588080353426, distance: 470.95002057012374
Total norm for 4 adversaries is: 469.9588080353426. distance: 470.95002057012374
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1213, Accuracy: 9577/10000 (95.7700%)
___Train Local_Simple,  epoch  11, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.0957, Accuracy: 9719/10000 (97.1900%)
___Train Local_Simple,  epoch  11, local model 63, internal_epoch   1,  Average loss: 0.0020, Accuracy: 857/889 (96.4004%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1366, Accuracy: 9601/10000 (96.0100%)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0017, Accuracy: 626/645 (97.0543%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1996, Accuracy: 9381/10000 (93.8100%)
___Train Local_Simple,  epoch  11, local model 75, internal_epoch   1,  Average loss: 0.0010, Accuracy: 669/686 (97.5219%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1799, Accuracy: 9447/10000 (94.4700%)
___Train Local_Simple,  epoch  11, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 398/408 (97.5490%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3283, Accuracy: 8975/10000 (89.7500%)
time spent on training: 66.40466833114624
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.43638413831986467  data num: [606, 591, 568, 557, 293, 78, 889, 645, 686, 408]
[rfa agg] considering poison per batch poison_fraction: 0.13637004322495772
[rfa agg] init. name: [41, 73, 51, 74, 23, 76, 63, 11, 75, 43], weight: tensor([0.1139, 0.1111, 0.1067, 0.1047, 0.0551, 0.0147, 0.1671, 0.1212, 0.1289,
        0.0767])
[rfa agg] iter:  0, prev_obj_val: 236.81494140625, obj_val: 218.8279571533203, abs dis: 17.986984252929688
[rfa agg] iter:  0, weight: tensor([0.0641, 0.0758, 0.0628, 0.0577, 0.0722, 0.0192, 0.2195, 0.1590, 0.1691,
        0.1006])
[rfa agg] iter:  1, prev_obj_val: 218.8279571533203, obj_val: 209.6243896484375, abs dis: 9.203567504882812
[rfa agg] iter:  1, weight: tensor([0.0390, 0.0459, 0.0375, 0.0353, 0.0822, 0.0219, 0.2501, 0.1811, 0.1925,
        0.1145])
[rfa agg] iter:  2, prev_obj_val: 209.6243896484375, obj_val: 204.41893005371094, abs dis: 5.2054595947265625
[rfa agg] iter:  2, weight: tensor([0.0238, 0.0277, 0.0227, 0.0217, 0.0882, 0.0235, 0.2687, 0.1943, 0.2064,
        0.1229])
[rfa agg] iter:  3, prev_obj_val: 204.41893005371094, obj_val: 201.36509704589844, abs dis: 3.0538330078125
[rfa agg] iter:  3, weight: tensor([0.0146, 0.0168, 0.0138, 0.0133, 0.0917, 0.0245, 0.2803, 0.2023, 0.2148,
        0.1280])
[rfa agg] iter:  4, prev_obj_val: 201.36509704589844, obj_val: 199.5452423095703, abs dis: 1.819854736328125
[rfa agg] iter:  4, weight: tensor([0.0089, 0.0102, 0.0084, 0.0081, 0.0938, 0.0251, 0.2879, 0.2071, 0.2196,
        0.1310])
[rfa agg] iter:  5, prev_obj_val: 199.5452423095703, obj_val: 198.45530700683594, abs dis: 1.089935302734375
[rfa agg] iter:  5, weight: tensor([0.0054, 0.0062, 0.0051, 0.0050, 0.0949, 0.0255, 0.2933, 0.2098, 0.2221,
        0.1327])
[rfa agg] iter:  6, prev_obj_val: 198.45530700683594, obj_val: 197.8058319091797, abs dis: 0.64947509765625
[rfa agg] iter:  6, weight: tensor([0.0033, 0.0038, 0.0031, 0.0030, 0.0954, 0.0258, 0.2977, 0.2111, 0.2230,
        0.1337])
[rfa agg] iter:  7, prev_obj_val: 197.8058319091797, obj_val: 197.4275665283203, abs dis: 0.378265380859375
[rfa agg] iter:  7, weight: tensor([0.0021, 0.0023, 0.0019, 0.0019, 0.0954, 0.0260, 0.3020, 0.2113, 0.2228,
        0.1342])
[rfa agg] iter:  8, prev_obj_val: 197.4275665283203, obj_val: 197.22035217285156, abs dis: 0.20721435546875
[rfa agg] iter:  8, weight: tensor([0.0013, 0.0015, 0.0012, 0.0012, 0.0953, 0.0263, 0.3065, 0.2103, 0.2218,
        0.1347])
[rfa agg] iter:  9, prev_obj_val: 197.22035217285156, obj_val: 197.12136840820312, abs dis: 0.0989837646484375
[rfa agg] iter:  9, weight: tensor([0.0009, 0.0010, 0.0008, 0.0008, 0.0955, 0.0268, 0.3101, 0.2077, 0.2208,
        0.1357])
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 0.0805, Accuracy: 9744/10000 (97.4400%)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 10.8248, Accuracy: 47/8968 (0.5241%)
Done in 78.7715892791748 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:12 choose agents : [41, 73, 51, 74, 46, 37, 21, 43, 35, 11]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0252, Accuracy: 319/606 (52.6403%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   2,  Average loss: 0.0145, Accuracy: 365/606 (60.2310%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   3,  Average loss: 0.0117, Accuracy: 392/606 (64.6865%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   4,  Average loss: 0.0115, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   5,  Average loss: 0.0108, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   6,  Average loss: 0.0109, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   7,  Average loss: 0.0106, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   8,  Average loss: 0.0107, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   9,  Average loss: 0.0105, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch  10,  Average loss: 0.0106, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Global model norm: 16.52227297167041.
Norm before scaling: 16.75232464046035. Distance: 4.483755673696577
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.3147, Accuracy: 4883/10000 (48.8300%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.8768, Accuracy: 5361/8968 (59.7792%)
Scaling by  100
Scaled Norm after poisoning: 447.2904187996877, distance: 448.3755575686525
Total norm for 4 adversaries is: 447.2904187996877. distance: 448.3755575686525
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   1,  Average loss: 0.0243, Accuracy: 349/591 (59.0525%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   2,  Average loss: 0.0194, Accuracy: 282/591 (47.7157%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   3,  Average loss: 0.0167, Accuracy: 327/591 (55.3299%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   4,  Average loss: 0.0147, Accuracy: 347/591 (58.7140%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   5,  Average loss: 0.0136, Accuracy: 330/591 (55.8376%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   6,  Average loss: 0.0137, Accuracy: 347/591 (58.7140%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   7,  Average loss: 0.0133, Accuracy: 359/591 (60.7445%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   8,  Average loss: 0.0131, Accuracy: 365/591 (61.7597%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   9,  Average loss: 0.0127, Accuracy: 368/591 (62.2673%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch  10,  Average loss: 0.0130, Accuracy: 368/591 (62.2673%), train_poison_data_count: 195
Global model norm: 16.52227297167041.
Norm before scaling: 16.663372070202357. Distance: 3.674594213179295
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.8676, Accuracy: 6452/10000 (64.5200%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 1.0191, Accuracy: 4026/8968 (44.8930%)
Scaling by  100
Scaled Norm after poisoning: 366.62977323861736, distance: 367.45941527602747
Total norm for 4 adversaries is: 366.62977323861736. distance: 367.45941527602747
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   1,  Average loss: 0.0220, Accuracy: 339/568 (59.6831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   2,  Average loss: 0.0130, Accuracy: 357/568 (62.8521%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   3,  Average loss: 0.0114, Accuracy: 375/568 (66.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   4,  Average loss: 0.0111, Accuracy: 396/568 (69.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   5,  Average loss: 0.0114, Accuracy: 370/568 (65.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   6,  Average loss: 0.0112, Accuracy: 376/568 (66.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   7,  Average loss: 0.0109, Accuracy: 373/568 (65.6690%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   8,  Average loss: 0.0103, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   9,  Average loss: 0.0105, Accuracy: 382/568 (67.2535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch  10,  Average loss: 0.0103, Accuracy: 399/568 (70.2465%), train_poison_data_count: 180
Global model norm: 16.52227297167041.
Norm before scaling: 16.618384859306612. Distance: 4.028641677522232
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.5383, Accuracy: 4650/10000 (46.5000%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.7115, Accuracy: 5927/8968 (66.0905%)
Scaling by  100
Scaled Norm after poisoning: 401.5819499180709, distance: 402.8641791907044
Total norm for 4 adversaries is: 401.5819499180709. distance: 402.8641791907044
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 10.0307, Accuracy: 8963/8968 (99.9442%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   1,  Average loss: 0.0224, Accuracy: 312/557 (56.0144%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   2,  Average loss: 0.0116, Accuracy: 391/557 (70.1975%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   3,  Average loss: 0.0057, Accuracy: 499/557 (89.5871%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   4,  Average loss: 0.0045, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   5,  Average loss: 0.0038, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   6,  Average loss: 0.0033, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   7,  Average loss: 0.0034, Accuracy: 513/557 (92.1005%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   8,  Average loss: 0.0026, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   9,  Average loss: 0.0024, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch  10,  Average loss: 0.0027, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Global model norm: 16.52227297167041.
Norm before scaling: 16.709859091839782. Distance: 3.679776395141056
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.7396, Accuracy: 7712/10000 (77.1200%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0916, Accuracy: 8650/8968 (96.4541%)
Scaling by  100
Scaled Norm after poisoning: 367.35522233255375, distance: 367.97766576247534
Total norm for 4 adversaries is: 367.35522233255375. distance: 367.97766576247534
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  12, local model 46, internal_epoch   1,  Average loss: 0.0034, Accuracy: 676/710 (95.2113%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2089, Accuracy: 9348/10000 (93.4800%)
___Train Local_Simple,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0011, Accuracy: 843/860 (98.0233%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.4855, Accuracy: 8472/10000 (84.7200%)
___Train Local_Simple,  epoch  12, local model 21, internal_epoch   1,  Average loss: 0.0013, Accuracy: 304/312 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2264, Accuracy: 9306/10000 (93.0600%)
___Train Local_Simple,  epoch  12, local model 43, internal_epoch   1,  Average loss: 0.0015, Accuracy: 397/408 (97.3039%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3078, Accuracy: 9023/10000 (90.2300%)
___Train Local_Simple,  epoch  12, local model 35, internal_epoch   1,  Average loss: 0.0006, Accuracy: 491/499 (98.3968%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2825, Accuracy: 9122/10000 (91.2200%)
___Train Local_Simple,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 629/645 (97.5194%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1992, Accuracy: 9392/10000 (93.9200%)
time spent on training: 72.83653545379639
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4034051424600417  data num: [606, 591, 568, 557, 710, 860, 312, 408, 499, 645]
[rfa agg] considering poison per batch poison_fraction: 0.12606410701876303
[rfa agg] init. name: [41, 73, 51, 74, 46, 37, 21, 43, 35, 11], weight: tensor([0.1053, 0.1027, 0.0987, 0.0968, 0.1233, 0.1494, 0.0542, 0.0709, 0.0867,
        0.1121])
[rfa agg] iter:  0, prev_obj_val: 199.91075134277344, obj_val: 178.737548828125, abs dis: 21.173202514648438
[rfa agg] iter:  0, weight: tensor([0.0457, 0.0554, 0.0495, 0.0510, 0.1652, 0.2002, 0.0725, 0.0948, 0.1159,
        0.1498])
[rfa agg] iter:  1, prev_obj_val: 178.737548828125, obj_val: 169.29470825195312, abs dis: 9.442840576171875
[rfa agg] iter:  1, weight: tensor([0.0229, 0.0278, 0.0245, 0.0259, 0.1862, 0.2256, 0.0815, 0.1067, 0.1304,
        0.1684])
[rfa agg] iter:  2, prev_obj_val: 169.29470825195312, obj_val: 164.75015258789062, abs dis: 4.5445556640625
[rfa agg] iter:  2, weight: tensor([0.0116, 0.0139, 0.0122, 0.0130, 0.1970, 0.2388, 0.0860, 0.1125, 0.1375,
        0.1775])
[rfa agg] iter:  3, prev_obj_val: 164.75015258789062, obj_val: 162.52389526367188, abs dis: 2.22625732421875
[rfa agg] iter:  3, weight: tensor([0.0058, 0.0069, 0.0061, 0.0065, 0.2028, 0.2463, 0.0880, 0.1153, 0.1408,
        0.1814])
[rfa agg] iter:  4, prev_obj_val: 162.52389526367188, obj_val: 161.44143676757812, abs dis: 1.08245849609375
[rfa agg] iter:  4, weight: tensor([0.0029, 0.0035, 0.0031, 0.0033, 0.2064, 0.2517, 0.0887, 0.1165, 0.1419,
        0.1821])
[rfa agg] iter:  5, prev_obj_val: 161.44143676757812, obj_val: 160.9427947998047, abs dis: 0.4986419677734375
[rfa agg] iter:  5, weight: tensor([0.0015, 0.0018, 0.0016, 0.0017, 0.2080, 0.2573, 0.0888, 0.1172, 0.1420,
        0.1803])
[rfa agg] iter:  6, prev_obj_val: 160.9427947998047, obj_val: 160.75038146972656, abs dis: 0.192413330078125
[rfa agg] iter:  6, weight: tensor([0.0008, 0.0010, 0.0008, 0.0009, 0.2048, 0.2642, 0.0892, 0.1190, 0.1427,
        0.1765])
[rfa agg] iter:  7, prev_obj_val: 160.75038146972656, obj_val: 160.69937133789062, abs dis: 0.0510101318359375
[rfa agg] iter:  7, weight: tensor([0.0005, 0.0006, 0.0005, 0.0006, 0.1921, 0.2692, 0.0918, 0.1247, 0.1472,
        0.1728])
[rfa agg] iter:  8, prev_obj_val: 160.69937133789062, obj_val: 160.69076538085938, abs dis: 0.00860595703125
[rfa agg] iter:  8, weight: tensor([0.0004, 0.0005, 0.0004, 0.0005, 0.1757, 0.2684, 0.0958, 0.1327, 0.1545,
        0.1711])
[rfa agg] iter:  9, prev_obj_val: 160.69076538085938, obj_val: 160.68968200683594, abs dis: 0.0010833740234375
[rfa agg] iter:  9, weight: tensor([0.0004, 0.0004, 0.0004, 0.0004, 0.1653, 0.2656, 0.0983, 0.1383, 0.1601,
        0.1707])
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 0.0804, Accuracy: 9747/10000 (97.4700%)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 10.2541, Accuracy: 53/8968 (0.5910%)
Done in 85.09323930740356 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:13 choose agents : [41, 73, 51, 74, 61, 64, 28, 67, 22, 82]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0231, Accuracy: 343/606 (56.6007%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   2,  Average loss: 0.0156, Accuracy: 324/606 (53.4653%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   3,  Average loss: 0.0121, Accuracy: 400/606 (66.0066%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   4,  Average loss: 0.0114, Accuracy: 401/606 (66.1716%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   5,  Average loss: 0.0112, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   6,  Average loss: 0.0112, Accuracy: 403/606 (66.5017%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   7,  Average loss: 0.0109, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   8,  Average loss: 0.0107, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   9,  Average loss: 0.0107, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch  10,  Average loss: 0.0109, Accuracy: 404/606 (66.6667%), train_poison_data_count: 200
Global model norm: 16.514187348733284.
Norm before scaling: 16.680685530738558. Distance: 4.145744872307587
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.4923, Accuracy: 4738/10000 (47.3800%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.9162, Accuracy: 5235/8968 (58.3742%)
Scaling by  100
Scaled Norm after poisoning: 413.49567334495777, distance: 414.57446179787775
Total norm for 4 adversaries is: 413.49567334495777. distance: 414.57446179787775
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 29502.9719, Accuracy: 4005/8968 (44.6588%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   1,  Average loss: 0.0242, Accuracy: 351/591 (59.3909%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   2,  Average loss: 0.0233, Accuracy: 254/591 (42.9780%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   3,  Average loss: 0.0162, Accuracy: 325/591 (54.9915%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   4,  Average loss: 0.0159, Accuracy: 345/591 (58.3756%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   5,  Average loss: 0.0164, Accuracy: 315/591 (53.2995%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   6,  Average loss: 0.0151, Accuracy: 330/591 (55.8376%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   7,  Average loss: 0.0149, Accuracy: 358/591 (60.5753%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   8,  Average loss: 0.0141, Accuracy: 363/591 (61.4213%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   9,  Average loss: 0.0138, Accuracy: 368/591 (62.2673%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch  10,  Average loss: 0.0142, Accuracy: 343/591 (58.0372%), train_poison_data_count: 195
Global model norm: 16.514187348733284.
Norm before scaling: 16.561512352628004. Distance: 3.645561309838849
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.2549, Accuracy: 4785/10000 (47.8500%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.8826, Accuracy: 5428/8968 (60.5263%)
Scaling by  100
Scaled Norm after poisoning: 363.3200207805785, distance: 364.55612993748986
Total norm for 4 adversaries is: 363.3200207805785. distance: 364.55612993748986
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.2046, Accuracy: 8966/8968 (99.9777%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   1,  Average loss: 0.0229, Accuracy: 316/568 (55.6338%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   2,  Average loss: 0.0133, Accuracy: 340/568 (59.8592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   3,  Average loss: 0.0124, Accuracy: 383/568 (67.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   4,  Average loss: 0.0110, Accuracy: 381/568 (67.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   5,  Average loss: 0.0102, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   6,  Average loss: 0.0099, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   7,  Average loss: 0.0101, Accuracy: 382/568 (67.2535%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   8,  Average loss: 0.0098, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   9,  Average loss: 0.0095, Accuracy: 393/568 (69.1901%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch  10,  Average loss: 0.0096, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Global model norm: 16.514187348733284.
Norm before scaling: 16.717306085428543. Distance: 4.317148550426
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.3104, Accuracy: 5189/10000 (51.8900%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.7248, Accuracy: 5703/8968 (63.5928%)
Scaling by  100
Scaled Norm after poisoning: 430.6526115966325, distance: 431.7148581529248
Total norm for 4 adversaries is: 430.6526115966325. distance: 431.7148581529248
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   1,  Average loss: 0.0233, Accuracy: 337/557 (60.5027%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   2,  Average loss: 0.0113, Accuracy: 396/557 (71.0952%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   3,  Average loss: 0.0057, Accuracy: 493/557 (88.5099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   4,  Average loss: 0.0046, Accuracy: 510/557 (91.5619%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   5,  Average loss: 0.0043, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   6,  Average loss: 0.0036, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   7,  Average loss: 0.0033, Accuracy: 514/557 (92.2801%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   8,  Average loss: 0.0025, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   9,  Average loss: 0.0024, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch  10,  Average loss: 0.0024, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Global model norm: 16.514187348733284.
Norm before scaling: 16.800946999153332. Distance: 4.133787793637592
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.7183, Accuracy: 7878/10000 (78.7800%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1476, Accuracy: 8400/8968 (93.6664%)
Scaling by  100
Scaled Norm after poisoning: 412.7968439499023, distance: 413.3787609444878
Total norm for 4 adversaries is: 412.7968439499023. distance: 413.3787609444878
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  13, local model 61, internal_epoch   1,  Average loss: 0.0015, Accuracy: 675/699 (96.5665%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2634, Accuracy: 9128/10000 (91.2800%)
___Train Local_Simple,  epoch  13, local model 64, internal_epoch   1,  Average loss: 0.0018, Accuracy: 783/813 (96.3100%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3371, Accuracy: 8755/10000 (87.5500%)
___Train Local_Simple,  epoch  13, local model 28, internal_epoch   1,  Average loss: 0.0015, Accuracy: 486/501 (97.0060%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1376, Accuracy: 9551/10000 (95.5100%)
___Train Local_Simple,  epoch  13, local model 67, internal_epoch   1,  Average loss: 0.0014, Accuracy: 974/998 (97.5952%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3155, Accuracy: 8973/10000 (89.7300%)
___Train Local_Simple,  epoch  13, local model 22, internal_epoch   1,  Average loss: 0.0015, Accuracy: 568/583 (97.4271%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2025, Accuracy: 9393/10000 (93.9300%)
___Train Local_Simple,  epoch  13, local model 82, internal_epoch   1,  Average loss: 0.0014, Accuracy: 692/713 (97.0547%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2823, Accuracy: 9042/10000 (90.4200%)
time spent on training: 76.37613677978516
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.35027907678382864  data num: [606, 591, 568, 557, 699, 813, 501, 998, 583, 713]
[rfa agg] considering poison per batch poison_fraction: 0.10946221149494645
[rfa agg] init. name: [41, 73, 51, 74, 61, 64, 28, 67, 22, 82], weight: tensor([0.0914, 0.0892, 0.0857, 0.0840, 0.1054, 0.1226, 0.0756, 0.1506, 0.0879,
        0.1076])
[rfa agg] iter:  0, prev_obj_val: 185.9991455078125, obj_val: 159.79515075683594, abs dis: 26.203994750976562
[rfa agg] iter:  0, weight: tensor([0.0371, 0.0425, 0.0340, 0.0335, 0.1384, 0.1611, 0.0992, 0.1975, 0.1155,
        0.1411])
[rfa agg] iter:  1, prev_obj_val: 159.79515075683594, obj_val: 149.30838012695312, abs dis: 10.486770629882812
[rfa agg] iter:  1, weight: tensor([0.0154, 0.0173, 0.0139, 0.0140, 0.1525, 0.1776, 0.1093, 0.2174, 0.1273,
        0.1552])
[rfa agg] iter:  2, prev_obj_val: 149.30838012695312, obj_val: 145.0625, abs dis: 4.245880126953125
[rfa agg] iter:  2, weight: tensor([0.0063, 0.0070, 0.0057, 0.0058, 0.1585, 0.1849, 0.1135, 0.2253, 0.1324,
        0.1608])
[rfa agg] iter:  3, prev_obj_val: 145.0625, obj_val: 143.38626098632812, abs dis: 1.676239013671875
[rfa agg] iter:  3, weight: tensor([0.0026, 0.0028, 0.0023, 0.0024, 0.1612, 0.1887, 0.1155, 0.2273, 0.1350,
        0.1623])
[rfa agg] iter:  4, prev_obj_val: 143.38626098632812, obj_val: 142.79718017578125, abs dis: 0.589080810546875
[rfa agg] iter:  4, weight: tensor([0.0011, 0.0012, 0.0010, 0.0010, 0.1633, 0.1914, 0.1176, 0.2241, 0.1376,
        0.1618])
[rfa agg] iter:  5, prev_obj_val: 142.79718017578125, obj_val: 142.65924072265625, abs dis: 0.137939453125
[rfa agg] iter:  5, weight: tensor([0.0005, 0.0006, 0.0005, 0.0005, 0.1665, 0.1912, 0.1236, 0.2121, 0.1424,
        0.1622])
[rfa agg] iter:  6, prev_obj_val: 142.65924072265625, obj_val: 142.6440887451172, abs dis: 0.0151519775390625
[rfa agg] iter:  6, weight: tensor([0.0004, 0.0004, 0.0003, 0.0003, 0.1697, 0.1848, 0.1337, 0.1966, 0.1476,
        0.1662])
[rfa agg] iter:  7, prev_obj_val: 142.6440887451172, obj_val: 142.6432342529297, abs dis: 0.0008544921875
[rfa agg] iter:  7, weight: tensor([0.0003, 0.0004, 0.0003, 0.0003, 0.1713, 0.1793, 0.1401, 0.1880, 0.1502,
        0.1698])
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 0.0804, Accuracy: 9752/10000 (97.5200%)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 9.7912, Accuracy: 56/8968 (0.6244%)
Done in 88.98410105705261 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:14 choose agents : [41, 73, 51, 74, 60, 42, 85, 56, 57, 63]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   1,  Average loss: 0.0221, Accuracy: 364/606 (60.0660%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   2,  Average loss: 0.0160, Accuracy: 328/606 (54.1254%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   3,  Average loss: 0.0133, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   4,  Average loss: 0.0126, Accuracy: 401/606 (66.1716%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   5,  Average loss: 0.0116, Accuracy: 397/606 (65.5116%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   6,  Average loss: 0.0118, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   7,  Average loss: 0.0110, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   8,  Average loss: 0.0107, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   9,  Average loss: 0.0109, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch  10,  Average loss: 0.0109, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Global model norm: 16.506336267109386.
Norm before scaling: 16.673883833696618. Distance: 4.250508446292273
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.4708, Accuracy: 4445/10000 (44.4500%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.9157, Accuracy: 5491/8968 (61.2288%)
Scaling by  100
Scaled Norm after poisoning: 423.8984990537239, distance: 425.05086092725423
Total norm for 4 adversaries is: 423.8984990537239. distance: 425.05086092725423
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 22973.0043, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   1,  Average loss: 0.0253, Accuracy: 341/591 (57.6988%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   2,  Average loss: 0.0212, Accuracy: 257/591 (43.4856%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   3,  Average loss: 0.0183, Accuracy: 319/591 (53.9763%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   4,  Average loss: 0.0174, Accuracy: 317/591 (53.6379%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   5,  Average loss: 0.0162, Accuracy: 315/591 (53.2995%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   6,  Average loss: 0.0152, Accuracy: 321/591 (54.3147%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   7,  Average loss: 0.0151, Accuracy: 329/591 (55.6684%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   8,  Average loss: 0.0141, Accuracy: 344/591 (58.2064%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   9,  Average loss: 0.0141, Accuracy: 347/591 (58.7140%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch  10,  Average loss: 0.0139, Accuracy: 349/591 (59.0525%), train_poison_data_count: 195
Global model norm: 16.506336267109386.
Norm before scaling: 16.698852792042707. Distance: 4.253672639791839
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.2139, Accuracy: 4485/10000 (44.8500%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.8180, Accuracy: 5938/8968 (66.2132%)
Scaling by  100
Scaled Norm after poisoning: 424.31078306472483, distance: 425.3672310486552
Total norm for 4 adversaries is: 424.31078306472483. distance: 425.3672310486552
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   1,  Average loss: 0.0214, Accuracy: 329/568 (57.9225%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   2,  Average loss: 0.0120, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   3,  Average loss: 0.0115, Accuracy: 371/568 (65.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   4,  Average loss: 0.0110, Accuracy: 373/568 (65.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   5,  Average loss: 0.0104, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   6,  Average loss: 0.0105, Accuracy: 396/568 (69.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   7,  Average loss: 0.0103, Accuracy: 389/568 (68.4859%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   8,  Average loss: 0.0099, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   9,  Average loss: 0.0098, Accuracy: 399/568 (70.2465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch  10,  Average loss: 0.0099, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Global model norm: 16.506336267109386.
Norm before scaling: 16.586136215248604. Distance: 3.6278487225992406
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.2865, Accuracy: 5024/10000 (50.2400%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.7175, Accuracy: 5736/8968 (63.9607%)
Scaling by  100
Scaled Norm after poisoning: 361.7088241078727, distance: 362.78488805351304
Total norm for 4 adversaries is: 361.7088241078727. distance: 362.78488805351304
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0221, Accuracy: 334/557 (59.9641%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   2,  Average loss: 0.0118, Accuracy: 380/557 (68.2226%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   3,  Average loss: 0.0053, Accuracy: 499/557 (89.5871%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   4,  Average loss: 0.0050, Accuracy: 503/557 (90.3052%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   5,  Average loss: 0.0046, Accuracy: 504/557 (90.4847%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   6,  Average loss: 0.0034, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   7,  Average loss: 0.0038, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   8,  Average loss: 0.0028, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   9,  Average loss: 0.0028, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch  10,  Average loss: 0.0028, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Global model norm: 16.506336267109386.
Norm before scaling: 16.68533002481849. Distance: 3.623798302719668
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.6960, Accuracy: 7938/10000 (79.3800%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1606, Accuracy: 8320/8968 (92.7743%)
Scaling by  100
Scaled Norm after poisoning: 361.7630763877099, distance: 362.37982921928756
Total norm for 4 adversaries is: 361.7630763877099. distance: 362.37982921928756
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  14, local model 60, internal_epoch   1,  Average loss: 0.0016, Accuracy: 329/338 (97.3373%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1108, Accuracy: 9672/10000 (96.7200%)
___Train Local_Simple,  epoch  14, local model 42, internal_epoch   1,  Average loss: 0.0013, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1023, Accuracy: 9686/10000 (96.8600%)
___Train Local_Simple,  epoch  14, local model 85, internal_epoch   1,  Average loss: 0.0008, Accuracy: 423/431 (98.1439%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1435, Accuracy: 9541/10000 (95.4100%)
___Train Local_Simple,  epoch  14, local model 56, internal_epoch   1,  Average loss: 0.0015, Accuracy: 861/880 (97.8409%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1377, Accuracy: 9561/10000 (95.6100%)
___Train Local_Simple,  epoch  14, local model 57, internal_epoch   1,  Average loss: 0.0020, Accuracy: 331/343 (96.5015%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2504, Accuracy: 9271/10000 (92.7100%)
___Train Local_Simple,  epoch  14, local model 63, internal_epoch   1,  Average loss: 0.0020, Accuracy: 848/889 (95.3881%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1229, Accuracy: 9607/10000 (96.0700%)
time spent on training: 70.95432996749878
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.42691671263099834  data num: [606, 591, 568, 557, 338, 236, 431, 880, 343, 889]
[rfa agg] considering poison per batch poison_fraction: 0.13341147269718698
[rfa agg] init. name: [41, 73, 51, 74, 60, 42, 85, 56, 57, 63], weight: tensor([0.1114, 0.1087, 0.1044, 0.1024, 0.0621, 0.0434, 0.0792, 0.1618, 0.0631,
        0.1634])
[rfa agg] iter:  0, prev_obj_val: 205.7574462890625, obj_val: 186.6512451171875, abs dis: 19.106201171875
[rfa agg] iter:  0, weight: tensor([0.0539, 0.0524, 0.0624, 0.0561, 0.0841, 0.0587, 0.1071, 0.2189, 0.0854,
        0.2211])
[rfa agg] iter:  1, prev_obj_val: 186.6512451171875, obj_val: 177.95050048828125, abs dis: 8.70074462890625
[rfa agg] iter:  1, weight: tensor([0.0288, 0.0280, 0.0328, 0.0310, 0.0954, 0.0666, 0.1215, 0.2482, 0.0969,
        0.2508])
[rfa agg] iter:  2, prev_obj_val: 177.95050048828125, obj_val: 173.55433654785156, abs dis: 4.3961639404296875
[rfa agg] iter:  2, weight: tensor([0.0156, 0.0152, 0.0174, 0.0168, 0.1016, 0.0707, 0.1291, 0.2638, 0.1031,
        0.2667])
[rfa agg] iter:  3, prev_obj_val: 173.55433654785156, obj_val: 171.25628662109375, abs dis: 2.2980499267578125
[rfa agg] iter:  3, weight: tensor([0.0084, 0.0082, 0.0094, 0.0091, 0.1050, 0.0730, 0.1330, 0.2721, 0.1066,
        0.2752])
[rfa agg] iter:  4, prev_obj_val: 171.25628662109375, obj_val: 170.0443878173828, abs dis: 1.2118988037109375
[rfa agg] iter:  4, weight: tensor([0.0046, 0.0045, 0.0051, 0.0049, 0.1071, 0.0741, 0.1350, 0.2763, 0.1087,
        0.2798])
[rfa agg] iter:  5, prev_obj_val: 170.0443878173828, obj_val: 169.41490173339844, abs dis: 0.629486083984375
[rfa agg] iter:  5, weight: tensor([0.0025, 0.0024, 0.0028, 0.0027, 0.1087, 0.0748, 0.1358, 0.2780, 0.1104,
        0.2820])
[rfa agg] iter:  6, prev_obj_val: 169.41490173339844, obj_val: 169.10882568359375, abs dis: 0.3060760498046875
[rfa agg] iter:  6, weight: tensor([0.0014, 0.0014, 0.0015, 0.0015, 0.1108, 0.0755, 0.1362, 0.2772, 0.1123,
        0.2823])
[rfa agg] iter:  7, prev_obj_val: 169.10882568359375, obj_val: 168.98468017578125, abs dis: 0.1241455078125
[rfa agg] iter:  7, weight: tensor([0.0008, 0.0008, 0.0009, 0.0009, 0.1143, 0.0770, 0.1374, 0.2729, 0.1151,
        0.2799])
[rfa agg] iter:  8, prev_obj_val: 168.98468017578125, obj_val: 168.9490509033203, abs dis: 0.0356292724609375
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0005, 0.0006, 0.0006, 0.1195, 0.0801, 0.1407, 0.2646, 0.1186,
        0.2741])
[rfa agg] iter:  9, prev_obj_val: 168.9490509033203, obj_val: 168.94236755371094, abs dis: 0.006683349609375
[rfa agg] iter:  9, weight: tensor([0.0005, 0.0004, 0.0005, 0.0005, 0.1245, 0.0840, 0.1455, 0.2556, 0.1215,
        0.2671])
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 0.0810, Accuracy: 9755/10000 (97.5500%)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 9.2288, Accuracy: 57/8968 (0.6356%)
Done in 84.1129047870636 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:15 choose agents : [41, 73, 51, 74, 77, 18, 43, 91, 42, 52]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   1,  Average loss: 0.0200, Accuracy: 382/606 (63.0363%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   2,  Average loss: 0.0133, Accuracy: 358/606 (59.0759%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   3,  Average loss: 0.0107, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   4,  Average loss: 0.0114, Accuracy: 391/606 (64.5215%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   5,  Average loss: 0.0110, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   6,  Average loss: 0.0109, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   7,  Average loss: 0.0104, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   8,  Average loss: 0.0103, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   9,  Average loss: 0.0101, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch  10,  Average loss: 0.0099, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Global model norm: 16.499081672775667.
Norm before scaling: 16.60500515775477. Distance: 3.4057115601705177
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.1737, Accuracy: 6000/10000 (60.0000%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 1.0860, Accuracy: 4089/8968 (45.5955%)
Scaling by  100
Scaled Norm after poisoning: 339.7818233808277, distance: 340.57115400089305
Total norm for 4 adversaries is: 339.7818233808277. distance: 340.57115400089305
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 786.2919, Accuracy: 7739/8968 (86.2957%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   1,  Average loss: 0.0236, Accuracy: 329/591 (55.6684%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   2,  Average loss: 0.0211, Accuracy: 248/591 (41.9628%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   3,  Average loss: 0.0164, Accuracy: 333/591 (56.3452%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   4,  Average loss: 0.0156, Accuracy: 323/591 (54.6531%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   5,  Average loss: 0.0148, Accuracy: 334/591 (56.5144%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   6,  Average loss: 0.0143, Accuracy: 340/591 (57.5296%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   7,  Average loss: 0.0141, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   8,  Average loss: 0.0138, Accuracy: 358/591 (60.5753%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   9,  Average loss: 0.0135, Accuracy: 370/591 (62.6058%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch  10,  Average loss: 0.0132, Accuracy: 378/591 (63.9594%), train_poison_data_count: 195
Global model norm: 16.499081672775667.
Norm before scaling: 16.603090922289987. Distance: 3.564145829005525
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.0416, Accuracy: 5891/10000 (58.9100%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.9693, Accuracy: 4560/8968 (50.8475%)
Scaling by  100
Scaled Norm after poisoning: 355.4961761397723, distance: 356.4145562929494
Total norm for 4 adversaries is: 355.4961761397723. distance: 356.4145562929494
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   1,  Average loss: 0.0204, Accuracy: 341/568 (60.0352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   2,  Average loss: 0.0134, Accuracy: 342/568 (60.2113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   3,  Average loss: 0.0117, Accuracy: 366/568 (64.4366%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   4,  Average loss: 0.0115, Accuracy: 382/568 (67.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   5,  Average loss: 0.0110, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   6,  Average loss: 0.0105, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   7,  Average loss: 0.0104, Accuracy: 382/568 (67.2535%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   8,  Average loss: 0.0098, Accuracy: 396/568 (69.7183%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   9,  Average loss: 0.0100, Accuracy: 393/568 (69.1901%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch  10,  Average loss: 0.0099, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Global model norm: 16.499081672775667.
Norm before scaling: 16.559435521332126. Distance: 3.340477741589251
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.3342, Accuracy: 4689/10000 (46.8900%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.7582, Accuracy: 5824/8968 (64.9420%)
Scaling by  100
Scaled Norm after poisoning: 333.08223224528206, distance: 334.0477604325465
Total norm for 4 adversaries is: 333.08223224528206. distance: 334.0477604325465
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   1,  Average loss: 0.0201, Accuracy: 324/557 (58.1688%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   2,  Average loss: 0.0111, Accuracy: 393/557 (70.5566%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   3,  Average loss: 0.0061, Accuracy: 478/557 (85.8169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   4,  Average loss: 0.0047, Accuracy: 510/557 (91.5619%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   5,  Average loss: 0.0042, Accuracy: 513/557 (92.1005%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   6,  Average loss: 0.0030, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   7,  Average loss: 0.0028, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   8,  Average loss: 0.0022, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   9,  Average loss: 0.0022, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch  10,  Average loss: 0.0025, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Global model norm: 16.499081672775667.
Norm before scaling: 16.688239720554805. Distance: 3.486843722815645
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.6797, Accuracy: 7914/10000 (79.1400%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1065, Accuracy: 8546/8968 (95.2944%)
Scaling by  100
Scaled Norm after poisoning: 348.2312113560472, distance: 348.6844024329164
Total norm for 4 adversaries is: 348.2312113560472. distance: 348.6844024329164
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  15, local model 77, internal_epoch   1,  Average loss: 0.0016, Accuracy: 574/589 (97.4533%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1714, Accuracy: 9479/10000 (94.7900%)
___Train Local_Simple,  epoch  15, local model 18, internal_epoch   1,  Average loss: 0.0020, Accuracy: 443/459 (96.5142%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2548, Accuracy: 9139/10000 (91.3900%)
___Train Local_Simple,  epoch  15, local model 43, internal_epoch   1,  Average loss: 0.0014, Accuracy: 396/408 (97.0588%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1113, Accuracy: 9655/10000 (96.5500%)
___Train Local_Simple,  epoch  15, local model 91, internal_epoch   1,  Average loss: 0.0007, Accuracy: 253/256 (98.8281%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.0853, Accuracy: 9730/10000 (97.3000%)
___Train Local_Simple,  epoch  15, local model 42, internal_epoch   1,  Average loss: 0.0013, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.0961, Accuracy: 9700/10000 (97.0000%)
___Train Local_Simple,  epoch  15, local model 52, internal_epoch   1,  Average loss: 0.0011, Accuracy: 247/253 (97.6285%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1274, Accuracy: 9617/10000 (96.1700%)
time spent on training: 72.13821792602539
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.5133760778244528  data num: [606, 591, 568, 557, 589, 459, 408, 256, 236, 253]
[rfa agg] considering poison per batch poison_fraction: 0.1604300243201415
[rfa agg] init. name: [41, 73, 51, 74, 77, 18, 43, 91, 42, 52], weight: tensor([0.1340, 0.1307, 0.1256, 0.1231, 0.1302, 0.1015, 0.0902, 0.0566, 0.0522,
        0.0559])
[rfa agg] iter:  0, prev_obj_val: 199.7484130859375, obj_val: 189.79656982421875, abs dis: 9.95184326171875
[rfa agg] iter:  0, weight: tensor([0.0871, 0.0821, 0.0882, 0.0760, 0.1783, 0.1390, 0.1236, 0.0776, 0.0715,
        0.0767])
[rfa agg] iter:  1, prev_obj_val: 189.79656982421875, obj_val: 185.18353271484375, abs dis: 4.613037109375
[rfa agg] iter:  1, weight: tensor([0.0606, 0.0566, 0.0601, 0.0533, 0.2057, 0.1604, 0.1426, 0.0895, 0.0825,
        0.0885])
[rfa agg] iter:  2, prev_obj_val: 185.18353271484375, obj_val: 182.57408142089844, abs dis: 2.6094512939453125
[rfa agg] iter:  2, weight: tensor([0.0434, 0.0404, 0.0424, 0.0384, 0.2233, 0.1742, 0.1549, 0.0972, 0.0896,
        0.0961])
[rfa agg] iter:  3, prev_obj_val: 182.57408142089844, obj_val: 180.943359375, abs dis: 1.6307220458984375
[rfa agg] iter:  3, weight: tensor([0.0315, 0.0294, 0.0306, 0.0281, 0.2353, 0.1836, 0.1633, 0.1025, 0.0944,
        0.1014])
[rfa agg] iter:  4, prev_obj_val: 180.943359375, obj_val: 179.86196899414062, abs dis: 1.081390380859375
[rfa agg] iter:  4, weight: tensor([0.0232, 0.0216, 0.0224, 0.0207, 0.2436, 0.1901, 0.1692, 0.1062, 0.0978,
        0.1051])
[rfa agg] iter:  5, prev_obj_val: 179.86196899414062, obj_val: 179.11712646484375, abs dis: 0.744842529296875
[rfa agg] iter:  5, weight: tensor([0.0172, 0.0160, 0.0166, 0.0154, 0.2495, 0.1948, 0.1735, 0.1089, 0.1003,
        0.1078])
[rfa agg] iter:  6, prev_obj_val: 179.11712646484375, obj_val: 178.5908660888672, abs dis: 0.5262603759765625
[rfa agg] iter:  6, weight: tensor([0.0128, 0.0120, 0.0123, 0.0115, 0.2536, 0.1983, 0.1767, 0.1110, 0.1021,
        0.1098])
[rfa agg] iter:  7, prev_obj_val: 178.5908660888672, obj_val: 178.21270751953125, abs dis: 0.3781585693359375
[rfa agg] iter:  7, weight: tensor([0.0096, 0.0090, 0.0092, 0.0086, 0.2565, 0.2007, 0.1790, 0.1125, 0.1035,
        0.1113])
[rfa agg] iter:  8, prev_obj_val: 178.21270751953125, obj_val: 177.93801879882812, abs dis: 0.274688720703125
[rfa agg] iter:  8, weight: tensor([0.0072, 0.0067, 0.0069, 0.0065, 0.2584, 0.2025, 0.1809, 0.1137, 0.1045,
        0.1126])
[rfa agg] iter:  9, prev_obj_val: 177.93801879882812, obj_val: 177.73728942871094, abs dis: 0.2007293701171875
[rfa agg] iter:  9, weight: tensor([0.0055, 0.0051, 0.0052, 0.0049, 0.2596, 0.2037, 0.1824, 0.1147, 0.1053,
        0.1137])
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 0.1149, Accuracy: 9717/10000 (97.1700%)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 5.3735, Accuracy: 112/8968 (1.2489%)
Done in 85.55827403068542 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:16 choose agents : [41, 73, 51, 74, 28, 37, 96, 99, 80, 13]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   1,  Average loss: 0.0170, Accuracy: 376/606 (62.0462%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   2,  Average loss: 0.0142, Accuracy: 341/606 (56.2706%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   3,  Average loss: 0.0110, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   4,  Average loss: 0.0102, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   5,  Average loss: 0.0103, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   6,  Average loss: 0.0105, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   8,  Average loss: 0.0099, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   9,  Average loss: 0.0096, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Global model norm: 16.45533115996103.
Norm before scaling: 16.499170455887224. Distance: 2.3936892549063162
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.9643, Accuracy: 5886/10000 (58.8600%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 1.0097, Accuracy: 4240/8968 (47.2792%)
Scaling by  100
Scaled Norm after poisoning: 239.0392390644264, distance: 239.3689294269413
Total norm for 4 adversaries is: 239.0392390644264. distance: 239.3689294269413
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 12273.1451, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   1,  Average loss: 0.0198, Accuracy: 347/591 (58.7140%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   2,  Average loss: 0.0220, Accuracy: 233/591 (39.4247%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   3,  Average loss: 0.0135, Accuracy: 359/591 (60.7445%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   4,  Average loss: 0.0138, Accuracy: 348/591 (58.8832%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   5,  Average loss: 0.0129, Accuracy: 363/591 (61.4213%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   6,  Average loss: 0.0128, Accuracy: 354/591 (59.8985%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   7,  Average loss: 0.0129, Accuracy: 368/591 (62.2673%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   8,  Average loss: 0.0126, Accuracy: 372/591 (62.9442%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   9,  Average loss: 0.0120, Accuracy: 378/591 (63.9594%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch  10,  Average loss: 0.0121, Accuracy: 386/591 (65.3130%), train_poison_data_count: 195
Global model norm: 16.45533115996103.
Norm before scaling: 16.54266667005778. Distance: 2.576722104396144
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8199, Accuracy: 6744/10000 (67.4400%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.8217, Accuracy: 4656/8968 (51.9179%)
Scaling by  100
Scaled Norm after poisoning: 257.468414324942, distance: 257.67221183123337
Total norm for 4 adversaries is: 257.468414324942. distance: 257.67221183123337
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   1,  Average loss: 0.0158, Accuracy: 343/568 (60.3873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   2,  Average loss: 0.0123, Accuracy: 338/568 (59.5070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   3,  Average loss: 0.0103, Accuracy: 390/568 (68.6620%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   4,  Average loss: 0.0098, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   5,  Average loss: 0.0093, Accuracy: 403/568 (70.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   6,  Average loss: 0.0094, Accuracy: 400/568 (70.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   7,  Average loss: 0.0089, Accuracy: 409/568 (72.0070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   8,  Average loss: 0.0085, Accuracy: 415/568 (73.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   9,  Average loss: 0.0085, Accuracy: 411/568 (72.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch  10,  Average loss: 0.0086, Accuracy: 405/568 (71.3028%), train_poison_data_count: 180
Global model norm: 16.45533115996103.
Norm before scaling: 16.509611162658782. Distance: 2.226748060558584
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8079, Accuracy: 7143/10000 (71.4300%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.8973, Accuracy: 4492/8968 (50.0892%)
Scaling by  100
Scaled Norm after poisoning: 222.5712052495785, distance: 222.67480843710183
Total norm for 4 adversaries is: 222.5712052495785. distance: 222.67480843710183
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   1,  Average loss: 0.0160, Accuracy: 343/557 (61.5799%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   2,  Average loss: 0.0079, Accuracy: 455/557 (81.6876%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   3,  Average loss: 0.0037, Accuracy: 514/557 (92.2801%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   4,  Average loss: 0.0031, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   5,  Average loss: 0.0028, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   6,  Average loss: 0.0023, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   7,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   8,  Average loss: 0.0023, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Global model norm: 16.45533115996103.
Norm before scaling: 16.62383983263945. Distance: 2.5945096110079353
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.5018, Accuracy: 8412/10000 (84.1200%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1081, Accuracy: 8557/8968 (95.4170%)
Scaling by  100
Scaled Norm after poisoning: 259.7495939602216, distance: 259.4509527348088
Total norm for 4 adversaries is: 259.7495939602216. distance: 259.4509527348088
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  16, local model 28, internal_epoch   1,  Average loss: 0.0015, Accuracy: 490/501 (97.8044%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1442, Accuracy: 9522/10000 (95.2200%)
___Train Local_Simple,  epoch  16, local model 37, internal_epoch   1,  Average loss: 0.0013, Accuracy: 842/860 (97.9070%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1414, Accuracy: 9563/10000 (95.6300%)
___Train Local_Simple,  epoch  16, local model 96, internal_epoch   1,  Average loss: 0.0017, Accuracy: 654/672 (97.3214%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1838, Accuracy: 9396/10000 (93.9600%)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0011, Accuracy: 373/377 (98.9390%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1223, Accuracy: 9616/10000 (96.1600%)
___Train Local_Simple,  epoch  16, local model 80, internal_epoch   1,  Average loss: 0.0010, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2925, Accuracy: 9121/10000 (91.2100%)
___Train Local_Simple,  epoch  16, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 717/734 (97.6839%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2174, Accuracy: 9312/10000 (93.1200%)
time spent on training: 73.13705325126648
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3937595387485162  data num: [606, 591, 568, 557, 501, 860, 672, 377, 431, 734]
[rfa agg] considering poison per batch poison_fraction: 0.12304985585891132
[rfa agg] init. name: [41, 73, 51, 74, 28, 37, 96, 99, 80, 13], weight: tensor([0.1028, 0.1002, 0.0963, 0.0945, 0.0850, 0.1458, 0.1140, 0.0639, 0.0731,
        0.1245])
[rfa agg] iter:  0, prev_obj_val: 120.35741424560547, obj_val: 105.64327239990234, abs dis: 14.714141845703125
[rfa agg] iter:  0, weight: tensor([0.0422, 0.0391, 0.0444, 0.0351, 0.1175, 0.2020, 0.1577, 0.0886, 0.1012,
        0.1722])
[rfa agg] iter:  1, prev_obj_val: 105.64327239990234, obj_val: 100.18098449707031, abs dis: 5.462287902832031
[rfa agg] iter:  1, weight: tensor([0.0177, 0.0161, 0.0182, 0.0148, 0.1306, 0.2248, 0.1751, 0.0986, 0.1126,
        0.1913])
[rfa agg] iter:  2, prev_obj_val: 100.18098449707031, obj_val: 97.99505615234375, abs dis: 2.1859283447265625
[rfa agg] iter:  2, weight: tensor([0.0074, 0.0067, 0.0075, 0.0063, 0.1358, 0.2348, 0.1820, 0.1030, 0.1175,
        0.1988])
[rfa agg] iter:  3, prev_obj_val: 97.99505615234375, obj_val: 97.12853240966797, abs dis: 0.8665237426757812
[rfa agg] iter:  3, weight: tensor([0.0031, 0.0028, 0.0032, 0.0026, 0.1377, 0.2404, 0.1839, 0.1058, 0.1201,
        0.2004])
[rfa agg] iter:  4, prev_obj_val: 97.12853240966797, obj_val: 96.8292465209961, abs dis: 0.299285888671875
[rfa agg] iter:  4, weight: tensor([0.0014, 0.0012, 0.0014, 0.0012, 0.1386, 0.2464, 0.1819, 0.1098, 0.1225,
        0.1956])
[rfa agg] iter:  5, prev_obj_val: 96.8292465209961, obj_val: 96.7630386352539, abs dis: 0.0662078857421875
[rfa agg] iter:  5, weight: tensor([0.0007, 0.0007, 0.0007, 0.0006, 0.1417, 0.2553, 0.1752, 0.1188, 0.1258,
        0.1805])
[rfa agg] iter:  6, prev_obj_val: 96.7630386352539, obj_val: 96.75608825683594, abs dis: 0.00695037841796875
[rfa agg] iter:  6, weight: tensor([0.0005, 0.0005, 0.0005, 0.0004, 0.1472, 0.2619, 0.1683, 0.1289, 0.1273,
        0.1644])
[rfa agg] iter:  7, prev_obj_val: 96.75608825683594, obj_val: 96.75568389892578, abs dis: 0.00040435791015625
[rfa agg] iter:  7, weight: tensor([0.0005, 0.0004, 0.0005, 0.0004, 0.1509, 0.2642, 0.1657, 0.1334, 0.1271,
        0.1569])
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.1095, Accuracy: 9725/10000 (97.2500%)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 5.5160, Accuracy: 100/8968 (1.1151%)
Done in 86.93686151504517 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:17 choose agents : [41, 73, 51, 74, 98, 78, 46, 45, 62, 50]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   1,  Average loss: 0.0179, Accuracy: 370/606 (61.0561%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   2,  Average loss: 0.0135, Accuracy: 349/606 (57.5908%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   3,  Average loss: 0.0117, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   4,  Average loss: 0.0109, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   5,  Average loss: 0.0103, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   6,  Average loss: 0.0099, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   7,  Average loss: 0.0097, Accuracy: 434/606 (71.6172%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   9,  Average loss: 0.0100, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch  10,  Average loss: 0.0101, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Global model norm: 16.45609337094327.
Norm before scaling: 16.520445207780607. Distance: 2.554798088829863
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9548, Accuracy: 6227/10000 (62.2700%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 1.0321, Accuracy: 4100/8968 (45.7181%)
Scaling by  100
Scaled Norm after poisoning: 255.1474910468453, distance: 255.47980289545396
Total norm for 4 adversaries is: 255.1474910468453. distance: 255.47980289545396
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 71815.5879, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   1,  Average loss: 0.0193, Accuracy: 335/591 (56.6836%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   2,  Average loss: 0.0188, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   3,  Average loss: 0.0147, Accuracy: 298/591 (50.4230%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   4,  Average loss: 0.0142, Accuracy: 348/591 (58.8832%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   5,  Average loss: 0.0135, Accuracy: 365/591 (61.7597%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   6,  Average loss: 0.0132, Accuracy: 349/591 (59.0525%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   7,  Average loss: 0.0123, Accuracy: 379/591 (64.1286%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   8,  Average loss: 0.0121, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   9,  Average loss: 0.0126, Accuracy: 368/591 (62.2673%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch  10,  Average loss: 0.0126, Accuracy: 371/591 (62.7750%), train_poison_data_count: 195
Global model norm: 16.45609337094327.
Norm before scaling: 16.487719965718995. Distance: 2.4064089239573887
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.8796, Accuracy: 5913/10000 (59.1300%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.7827, Accuracy: 5592/8968 (62.3550%)
Scaling by  100
Scaled Norm after poisoning: 240.21645512433156, distance: 240.6408923323299
Total norm for 4 adversaries is: 240.21645512433156. distance: 240.6408923323299
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   1,  Average loss: 0.0151, Accuracy: 359/568 (63.2042%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   2,  Average loss: 0.0119, Accuracy: 343/568 (60.3873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   3,  Average loss: 0.0102, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   4,  Average loss: 0.0095, Accuracy: 402/568 (70.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   5,  Average loss: 0.0097, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   6,  Average loss: 0.0092, Accuracy: 401/568 (70.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   7,  Average loss: 0.0091, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   8,  Average loss: 0.0087, Accuracy: 408/568 (71.8310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   9,  Average loss: 0.0086, Accuracy: 414/568 (72.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch  10,  Average loss: 0.0086, Accuracy: 411/568 (72.3592%), train_poison_data_count: 180
Global model norm: 16.45609337094327.
Norm before scaling: 16.48305589360774. Distance: 2.0678258393255042
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9023, Accuracy: 6579/10000 (65.7900%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.8102, Accuracy: 5064/8968 (56.4674%)
Scaling by  100
Scaled Norm after poisoning: 206.61816572182127, distance: 206.7825888765783
Total norm for 4 adversaries is: 206.61816572182127. distance: 206.7825888765783
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   1,  Average loss: 0.0157, Accuracy: 360/557 (64.6320%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   2,  Average loss: 0.0078, Accuracy: 476/557 (85.4578%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   3,  Average loss: 0.0032, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   4,  Average loss: 0.0027, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   5,  Average loss: 0.0025, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   6,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   7,  Average loss: 0.0024, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   8,  Average loss: 0.0019, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   9,  Average loss: 0.0019, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch  10,  Average loss: 0.0019, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Global model norm: 16.45609337094327.
Norm before scaling: 16.647632767388057. Distance: 2.5326881561726537
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4343, Accuracy: 8655/10000 (86.5500%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1113, Accuracy: 8520/8968 (95.0045%)
Scaling by  100
Scaled Norm after poisoning: 253.78830529843174, distance: 253.2687940336314
Total norm for 4 adversaries is: 253.78830529843174. distance: 253.2687940336314
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  17, local model 98, internal_epoch   1,  Average loss: 0.0017, Accuracy: 787/818 (96.2103%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3237, Accuracy: 8972/10000 (89.7200%)
___Train Local_Simple,  epoch  17, local model 78, internal_epoch   1,  Average loss: 0.0013, Accuracy: 296/303 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1754, Accuracy: 9459/10000 (94.5900%)
___Train Local_Simple,  epoch  17, local model 46, internal_epoch   1,  Average loss: 0.0027, Accuracy: 690/710 (97.1831%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3901, Accuracy: 8789/10000 (87.8900%)
___Train Local_Simple,  epoch  17, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 614/628 (97.7707%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4574, Accuracy: 8601/10000 (86.0100%)
___Train Local_Simple,  epoch  17, local model 62, internal_epoch   1,  Average loss: 0.0011, Accuracy: 416/423 (98.3452%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1022, Accuracy: 9682/10000 (96.8200%)
___Train Local_Simple,  epoch  17, local model 50, internal_epoch   1,  Average loss: 0.0021, Accuracy: 457/474 (96.4135%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2044, Accuracy: 9344/10000 (93.4400%)
time spent on training: 74.1220154762268
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.40894681225783724  data num: [606, 591, 568, 557, 818, 303, 710, 628, 423, 474]
[rfa agg] considering poison per batch poison_fraction: 0.12779587883057414
[rfa agg] init. name: [41, 73, 51, 74, 98, 78, 46, 45, 62, 50], weight: tensor([0.1067, 0.1041, 0.1000, 0.0981, 0.1441, 0.0534, 0.1250, 0.1106, 0.0745,
        0.0835])
[rfa agg] iter:  0, prev_obj_val: 120.92778015136719, obj_val: 107.36083221435547, abs dis: 13.566947937011719
[rfa agg] iter:  0, weight: tensor([0.0429, 0.0458, 0.0521, 0.0392, 0.1996, 0.0741, 0.1734, 0.1535, 0.1035,
        0.1159])
[rfa agg] iter:  1, prev_obj_val: 107.36083221435547, obj_val: 102.05604553222656, abs dis: 5.304786682128906
[rfa agg] iter:  1, weight: tensor([0.0194, 0.0204, 0.0232, 0.0179, 0.2233, 0.0832, 0.1943, 0.1721, 0.1161,
        0.1299])
[rfa agg] iter:  2, prev_obj_val: 102.05604553222656, obj_val: 99.77662658691406, abs dis: 2.2794189453125
[rfa agg] iter:  2, weight: tensor([0.0088, 0.0092, 0.0104, 0.0082, 0.2332, 0.0876, 0.2034, 0.1807, 0.1221,
        0.1364])
[rfa agg] iter:  3, prev_obj_val: 99.77662658691406, obj_val: 98.79082489013672, abs dis: 0.9858016967773438
[rfa agg] iter:  3, weight: tensor([0.0040, 0.0042, 0.0047, 0.0037, 0.2360, 0.0901, 0.2068, 0.1849, 0.1258,
        0.1397])
[rfa agg] iter:  4, prev_obj_val: 98.79082489013672, obj_val: 98.39814758300781, abs dis: 0.39267730712890625
[rfa agg] iter:  4, weight: tensor([0.0019, 0.0020, 0.0022, 0.0018, 0.2335, 0.0928, 0.2060, 0.1877, 0.1301,
        0.1421])
[rfa agg] iter:  5, prev_obj_val: 98.39814758300781, obj_val: 98.28191375732422, abs dis: 0.11623382568359375
[rfa agg] iter:  5, weight: tensor([0.0010, 0.0010, 0.0011, 0.0009, 0.2257, 0.0967, 0.1993, 0.1900, 0.1392,
        0.1450])
[rfa agg] iter:  6, prev_obj_val: 98.28191375732422, obj_val: 98.26290893554688, abs dis: 0.01900482177734375
[rfa agg] iter:  6, weight: tensor([0.0007, 0.0007, 0.0008, 0.0006, 0.2161, 0.1004, 0.1882, 0.1908, 0.1539,
        0.1479])
[rfa agg] iter:  7, prev_obj_val: 98.26290893554688, obj_val: 98.26126861572266, abs dis: 0.00164031982421875
[rfa agg] iter:  7, weight: tensor([0.0006, 0.0006, 0.0007, 0.0005, 0.2103, 0.1022, 0.1804, 0.1904, 0.1649,
        0.1495])
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.1041, Accuracy: 9730/10000 (97.3000%)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 5.6282, Accuracy: 90/8968 (1.0036%)
Done in 88.69962525367737 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:18 choose agents : [41, 73, 51, 74, 67, 14, 36, 24, 7, 4]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   1,  Average loss: 0.0167, Accuracy: 378/606 (62.3762%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   2,  Average loss: 0.0142, Accuracy: 345/606 (56.9307%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   3,  Average loss: 0.0114, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   4,  Average loss: 0.0109, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   5,  Average loss: 0.0105, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   6,  Average loss: 0.0104, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Global model norm: 16.45539792437756.
Norm before scaling: 16.521576616548565. Distance: 2.4829613844426377
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.8926, Accuracy: 6453/10000 (64.5300%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 1.1291, Accuracy: 3767/8968 (42.0049%)
Scaling by  100
Scaled Norm after poisoning: 248.03927202914863, distance: 248.2961390280767
Total norm for 4 adversaries is: 248.03927202914863. distance: 248.2961390280767
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 15452.2192, Accuracy: 2940/8968 (32.7832%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   1,  Average loss: 0.0197, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   2,  Average loss: 0.0197, Accuracy: 246/591 (41.6244%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   3,  Average loss: 0.0156, Accuracy: 328/591 (55.4992%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   4,  Average loss: 0.0134, Accuracy: 368/591 (62.2673%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   5,  Average loss: 0.0128, Accuracy: 369/591 (62.4365%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   6,  Average loss: 0.0125, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   7,  Average loss: 0.0124, Accuracy: 378/591 (63.9594%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   8,  Average loss: 0.0125, Accuracy: 383/591 (64.8054%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   9,  Average loss: 0.0123, Accuracy: 358/591 (60.5753%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch  10,  Average loss: 0.0118, Accuracy: 384/591 (64.9746%), train_poison_data_count: 195
Global model norm: 16.45539792437756.
Norm before scaling: 16.537796656801618. Distance: 2.5383294088926514
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.8202, Accuracy: 6400/10000 (64.0000%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.7994, Accuracy: 4686/8968 (52.2525%)
Scaling by  100
Scaled Norm after poisoning: 253.63259291246462, distance: 253.8329528819101
Total norm for 4 adversaries is: 253.63259291246462. distance: 253.8329528819101
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   1,  Average loss: 0.0159, Accuracy: 335/568 (58.9789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   2,  Average loss: 0.0124, Accuracy: 342/568 (60.2113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   3,  Average loss: 0.0113, Accuracy: 398/568 (70.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   4,  Average loss: 0.0103, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   5,  Average loss: 0.0099, Accuracy: 385/568 (67.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   6,  Average loss: 0.0095, Accuracy: 399/568 (70.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   7,  Average loss: 0.0092, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   8,  Average loss: 0.0087, Accuracy: 407/568 (71.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   9,  Average loss: 0.0086, Accuracy: 410/568 (72.1831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch  10,  Average loss: 0.0085, Accuracy: 402/568 (70.7746%), train_poison_data_count: 180
Global model norm: 16.45539792437756.
Norm before scaling: 16.484459234085733. Distance: 2.2062484568301417
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9953, Accuracy: 5981/10000 (59.8100%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.5735, Accuracy: 6950/8968 (77.4978%)
Scaling by  100
Scaled Norm after poisoning: 220.35218614186698, distance: 220.62485835689503
Total norm for 4 adversaries is: 220.35218614186698. distance: 220.62485835689503
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   1,  Average loss: 0.0152, Accuracy: 355/557 (63.7343%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   2,  Average loss: 0.0075, Accuracy: 456/557 (81.8671%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   3,  Average loss: 0.0040, Accuracy: 519/557 (93.1777%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   4,  Average loss: 0.0036, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   5,  Average loss: 0.0026, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   6,  Average loss: 0.0026, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   7,  Average loss: 0.0020, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   8,  Average loss: 0.0019, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   9,  Average loss: 0.0020, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch  10,  Average loss: 0.0018, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Global model norm: 16.45539792437756.
Norm before scaling: 16.60855551247421. Distance: 2.487975480532261
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4491, Accuracy: 8584/10000 (85.8400%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1086, Accuracy: 8512/8968 (94.9153%)
Scaling by  100
Scaled Norm after poisoning: 249.11523908374213, distance: 248.79755355760636
Total norm for 4 adversaries is: 249.11523908374213. distance: 248.79755355760636
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  18, local model 67, internal_epoch   1,  Average loss: 0.0015, Accuracy: 970/998 (97.1944%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3701, Accuracy: 8770/10000 (87.7000%)
___Train Local_Simple,  epoch  18, local model 14, internal_epoch   1,  Average loss: 0.0014, Accuracy: 369/376 (98.1383%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1112, Accuracy: 9687/10000 (96.8700%)
___Train Local_Simple,  epoch  18, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 982/1005 (97.7114%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2051, Accuracy: 9372/10000 (93.7200%)
___Train Local_Simple,  epoch  18, local model 24, internal_epoch   1,  Average loss: 0.0017, Accuracy: 365/379 (96.3061%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1238, Accuracy: 9629/10000 (96.2900%)
___Train Local_Simple,  epoch  18, local model 7, internal_epoch   1,  Average loss: 0.0016, Accuracy: 405/418 (96.8900%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1253, Accuracy: 9610/10000 (96.1000%)
___Train Local_Simple,  epoch  18, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 642/658 (97.5684%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2081, Accuracy: 9326/10000 (93.2600%)
time spent on training: 77.67130041122437
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.37719298245614036  data num: [606, 591, 568, 557, 998, 376, 1005, 379, 418, 658]
[rfa agg] considering poison per batch poison_fraction: 0.11787280701754387
[rfa agg] init. name: [41, 73, 51, 74, 67, 14, 36, 24, 7, 4], weight: tensor([0.0984, 0.0960, 0.0923, 0.0905, 0.1621, 0.0611, 0.1633, 0.0616, 0.0679,
        0.1069])
[rfa agg] iter:  0, prev_obj_val: 116.09122467041016, obj_val: 100.85298919677734, abs dis: 15.238235473632812
[rfa agg] iter:  0, weight: tensor([0.0373, 0.0363, 0.0412, 0.0337, 0.2215, 0.0836, 0.2233, 0.0842, 0.0928,
        0.1460])
[rfa agg] iter:  1, prev_obj_val: 100.85298919677734, obj_val: 95.30296325683594, abs dis: 5.550025939941406
[rfa agg] iter:  1, weight: tensor([0.0150, 0.0144, 0.0161, 0.0136, 0.2445, 0.0927, 0.2469, 0.0932, 0.1026,
        0.1611])
[rfa agg] iter:  2, prev_obj_val: 95.30296325683594, obj_val: 93.17900848388672, abs dis: 2.1239547729492188
[rfa agg] iter:  2, weight: tensor([0.0060, 0.0057, 0.0064, 0.0055, 0.2529, 0.0969, 0.2564, 0.0971, 0.1066,
        0.1666])
[rfa agg] iter:  3, prev_obj_val: 93.17900848388672, obj_val: 92.40776062011719, abs dis: 0.7712478637695312
[rfa agg] iter:  3, weight: tensor([0.0024, 0.0023, 0.0026, 0.0022, 0.2536, 0.1006, 0.2598, 0.1000, 0.1087,
        0.1678])
[rfa agg] iter:  4, prev_obj_val: 92.40776062011719, obj_val: 92.19617462158203, abs dis: 0.21158599853515625
[rfa agg] iter:  4, weight: tensor([0.0011, 0.0010, 0.0011, 0.0010, 0.2454, 0.1083, 0.2567, 0.1061, 0.1117,
        0.1676])
[rfa agg] iter:  5, prev_obj_val: 92.19617462158203, obj_val: 92.16639709472656, abs dis: 0.02977752685546875
[rfa agg] iter:  5, weight: tensor([0.0007, 0.0006, 0.0007, 0.0006, 0.2281, 0.1216, 0.2434, 0.1183, 0.1171,
        0.1690])
[rfa agg] iter:  6, prev_obj_val: 92.16639709472656, obj_val: 92.16432189941406, abs dis: 0.0020751953125
[rfa agg] iter:  6, weight: tensor([0.0005, 0.0005, 0.0006, 0.0005, 0.2150, 0.1303, 0.2311, 0.1281, 0.1217,
        0.1716])
[rfa agg] iter:  7, prev_obj_val: 92.16432189941406, obj_val: 92.1642074584961, abs dis: 0.00011444091796875
[rfa agg] iter:  7, weight: tensor([0.0005, 0.0005, 0.0006, 0.0005, 0.2094, 0.1338, 0.2253, 0.1324, 0.1239,
        0.1732])
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.1013, Accuracy: 9732/10000 (97.3200%)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 5.6747, Accuracy: 91/8968 (1.0147%)
Done in 92.82255005836487 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:19 choose agents : [41, 73, 51, 74, 80, 39, 26, 29, 4, 42]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   1,  Average loss: 0.0167, Accuracy: 379/606 (62.5413%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   2,  Average loss: 0.0129, Accuracy: 361/606 (59.5710%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   3,  Average loss: 0.0108, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   4,  Average loss: 0.0104, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   5,  Average loss: 0.0100, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   6,  Average loss: 0.0101, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   7,  Average loss: 0.0099, Accuracy: 434/606 (71.6172%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   9,  Average loss: 0.0099, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Global model norm: 16.454959314296595.
Norm before scaling: 16.482667084212565. Distance: 2.359929707983595
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.0973, Accuracy: 5647/10000 (56.4700%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.9406, Accuracy: 4619/8968 (51.5054%)
Scaling by  100
Scaled Norm after poisoning: 235.57967899683112, distance: 235.99296533477434
Total norm for 4 adversaries is: 235.57967899683112. distance: 235.99296533477434
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1716.0754, Accuracy: 5209/8968 (58.0843%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   1,  Average loss: 0.0220, Accuracy: 334/591 (56.5144%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   2,  Average loss: 0.0227, Accuracy: 237/591 (40.1015%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   3,  Average loss: 0.0154, Accuracy: 316/591 (53.4687%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   4,  Average loss: 0.0148, Accuracy: 347/591 (58.7140%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   5,  Average loss: 0.0140, Accuracy: 368/591 (62.2673%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   6,  Average loss: 0.0133, Accuracy: 374/591 (63.2826%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   7,  Average loss: 0.0134, Accuracy: 342/591 (57.8680%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   8,  Average loss: 0.0131, Accuracy: 371/591 (62.7750%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   9,  Average loss: 0.0128, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch  10,  Average loss: 0.0128, Accuracy: 376/591 (63.6210%), train_poison_data_count: 195
Global model norm: 16.454959314296595.
Norm before scaling: 16.597639242313008. Distance: 3.179461496930168
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.9156, Accuracy: 6256/10000 (62.5600%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.8469, Accuracy: 4830/8968 (53.8582%)
Scaling by  100
Scaled Norm after poisoning: 317.52355965738985, distance: 317.9461555240132
Total norm for 4 adversaries is: 317.52355965738985. distance: 317.9461555240132
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   1,  Average loss: 0.0153, Accuracy: 356/568 (62.6761%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   2,  Average loss: 0.0111, Accuracy: 371/568 (65.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   3,  Average loss: 0.0100, Accuracy: 399/568 (70.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   4,  Average loss: 0.0100, Accuracy: 389/568 (68.4859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   5,  Average loss: 0.0091, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   6,  Average loss: 0.0091, Accuracy: 405/568 (71.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   7,  Average loss: 0.0083, Accuracy: 420/568 (73.9437%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   8,  Average loss: 0.0081, Accuracy: 421/568 (74.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   9,  Average loss: 0.0078, Accuracy: 423/568 (74.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch  10,  Average loss: 0.0075, Accuracy: 437/568 (76.9366%), train_poison_data_count: 180
Global model norm: 16.454959314296595.
Norm before scaling: 16.491711008334516. Distance: 2.2017735874839612
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.9388, Accuracy: 6329/10000 (63.2900%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.4989, Accuracy: 7204/8968 (80.3301%)
Scaling by  100
Scaled Norm after poisoning: 219.96621722153154, distance: 220.17736103537075
Total norm for 4 adversaries is: 219.96621722153154. distance: 220.17736103537075
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   1,  Average loss: 0.0158, Accuracy: 368/557 (66.0682%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   2,  Average loss: 0.0081, Accuracy: 434/557 (77.9174%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   3,  Average loss: 0.0037, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   4,  Average loss: 0.0032, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   5,  Average loss: 0.0027, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   6,  Average loss: 0.0030, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   7,  Average loss: 0.0021, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   8,  Average loss: 0.0021, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   9,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch  10,  Average loss: 0.0021, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Global model norm: 16.454959314296595.
Norm before scaling: 16.613019024940858. Distance: 2.529585585446822
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.4892, Accuracy: 8453/10000 (84.5300%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1063, Accuracy: 8542/8968 (95.2498%)
Scaling by  100
Scaled Norm after poisoning: 253.26188428433127, distance: 252.95854094594236
Total norm for 4 adversaries is: 253.26188428433127. distance: 252.95854094594236
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  19, local model 80, internal_epoch   1,  Average loss: 0.0010, Accuracy: 427/431 (99.0719%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2698, Accuracy: 9207/10000 (92.0700%)
___Train Local_Simple,  epoch  19, local model 39, internal_epoch   1,  Average loss: 0.0013, Accuracy: 252/257 (98.0545%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1064, Accuracy: 9709/10000 (97.0900%)
___Train Local_Simple,  epoch  19, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 541/554 (97.6534%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1368, Accuracy: 9588/10000 (95.8800%)
___Train Local_Simple,  epoch  19, local model 29, internal_epoch   1,  Average loss: 0.0011, Accuracy: 984/1002 (98.2036%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2437, Accuracy: 9212/10000 (92.1200%)
___Train Local_Simple,  epoch  19, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 644/658 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2717, Accuracy: 9125/10000 (91.2500%)
___Train Local_Simple,  epoch  19, local model 42, internal_epoch   1,  Average loss: 0.0016, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1114, Accuracy: 9663/10000 (96.6300%)
time spent on training: 80.2154107093811
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.42527472527472526  data num: [606, 591, 568, 557, 431, 257, 554, 1002, 658, 236]
[rfa agg] considering poison per batch poison_fraction: 0.13289835164835165
[rfa agg] init. name: [41, 73, 51, 74, 80, 39, 26, 29, 4, 42], weight: tensor([0.1110, 0.1082, 0.1040, 0.1020, 0.0789, 0.0471, 0.1015, 0.1835, 0.1205,
        0.0432])
[rfa agg] iter:  0, prev_obj_val: 133.68304443359375, obj_val: 119.57988739013672, abs dis: 14.103157043457031
[rfa agg] iter:  0, weight: tensor([0.0547, 0.0396, 0.0574, 0.0460, 0.1102, 0.0658, 0.1416, 0.2562, 0.1681,
        0.0604])
[rfa agg] iter:  1, prev_obj_val: 119.57988739013672, obj_val: 114.04926300048828, abs dis: 5.5306243896484375
[rfa agg] iter:  1, weight: tensor([0.0261, 0.0185, 0.0268, 0.0221, 0.1245, 0.0745, 0.1600, 0.2895, 0.1897,
        0.0683])
[rfa agg] iter:  2, prev_obj_val: 114.04926300048828, obj_val: 111.57762145996094, abs dis: 2.4716415405273438
[rfa agg] iter:  2, weight: tensor([0.0124, 0.0089, 0.0126, 0.0106, 0.1312, 0.0787, 0.1686, 0.3052, 0.1995,
        0.0721])
[rfa agg] iter:  3, prev_obj_val: 111.57762145996094, obj_val: 110.44023132324219, abs dis: 1.13739013671875
[rfa agg] iter:  3, weight: tensor([0.0060, 0.0043, 0.0060, 0.0051, 0.1343, 0.0813, 0.1727, 0.3128, 0.2033,
        0.0743])
[rfa agg] iter:  4, prev_obj_val: 110.44023132324219, obj_val: 109.92941284179688, abs dis: 0.5108184814453125
[rfa agg] iter:  4, weight: tensor([0.0029, 0.0021, 0.0029, 0.0025, 0.1358, 0.0836, 0.1747, 0.3163, 0.2031,
        0.0761])
[rfa agg] iter:  5, prev_obj_val: 109.92941284179688, obj_val: 109.72932434082031, abs dis: 0.2000885009765625
[rfa agg] iter:  5, weight: tensor([0.0015, 0.0011, 0.0015, 0.0013, 0.1364, 0.0875, 0.1762, 0.3170, 0.1985,
        0.0791])
[rfa agg] iter:  6, prev_obj_val: 109.72932434082031, obj_val: 109.67509460449219, abs dis: 0.054229736328125
[rfa agg] iter:  6, weight: tensor([0.0009, 0.0006, 0.0009, 0.0007, 0.1368, 0.0942, 0.1781, 0.3135, 0.1891,
        0.0852])
[rfa agg] iter:  7, prev_obj_val: 109.67509460449219, obj_val: 109.66693878173828, abs dis: 0.00815582275390625
[rfa agg] iter:  7, weight: tensor([0.0006, 0.0005, 0.0006, 0.0006, 0.1373, 0.1009, 0.1805, 0.3065, 0.1799,
        0.0926])
[rfa agg] iter:  8, prev_obj_val: 109.66693878173828, obj_val: 109.66622161865234, abs dis: 0.0007171630859375
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0004, 0.0006, 0.0005, 0.1381, 0.1042, 0.1825, 0.3006, 0.1754,
        0.0970])
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.0986, Accuracy: 9737/10000 (97.3700%)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 5.6902, Accuracy: 89/8968 (0.9924%)
Done in 95.44984316825867 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:20 choose agents : [41, 73, 51, 74, 69, 95, 80, 8, 25, 68]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   1,  Average loss: 0.0173, Accuracy: 374/606 (61.7162%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   2,  Average loss: 0.0152, Accuracy: 341/606 (56.2706%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   3,  Average loss: 0.0113, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   4,  Average loss: 0.0109, Accuracy: 402/606 (66.3366%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   5,  Average loss: 0.0105, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   6,  Average loss: 0.0098, Accuracy: 435/606 (71.7822%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   7,  Average loss: 0.0097, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   9,  Average loss: 0.0101, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch  10,  Average loss: 0.0099, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Global model norm: 16.453852073203862.
Norm before scaling: 16.509473450811413. Distance: 2.4635828725797637
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.0847, Accuracy: 5589/10000 (55.8900%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.8902, Accuracy: 4794/8968 (53.4567%)
Scaling by  100
Scaled Norm after poisoning: 246.04787866134916, distance: 246.35828837284936
Total norm for 4 adversaries is: 246.04787866134916. distance: 246.35828837284936
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 1496.6141, Accuracy: 7674/8968 (85.5709%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   1,  Average loss: 0.0210, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   2,  Average loss: 0.0185, Accuracy: 294/591 (49.7462%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   3,  Average loss: 0.0166, Accuracy: 229/591 (38.7479%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   4,  Average loss: 0.0147, Accuracy: 340/591 (57.5296%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   5,  Average loss: 0.0131, Accuracy: 381/591 (64.4670%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   6,  Average loss: 0.0131, Accuracy: 353/591 (59.7293%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   7,  Average loss: 0.0128, Accuracy: 372/591 (62.9442%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   8,  Average loss: 0.0126, Accuracy: 376/591 (63.6210%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   9,  Average loss: 0.0123, Accuracy: 383/591 (64.8054%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch  10,  Average loss: 0.0124, Accuracy: 372/591 (62.9442%), train_poison_data_count: 195
Global model norm: 16.453852073203862.
Norm before scaling: 16.584096510816565. Distance: 2.934255878277166
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.9324, Accuracy: 5748/10000 (57.4800%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.6872, Accuracy: 5856/8968 (65.2988%)
Scaling by  100
Scaled Norm after poisoning: 293.15290378913187, distance: 293.4255788313282
Total norm for 4 adversaries is: 293.15290378913187. distance: 293.4255788313282
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   1,  Average loss: 0.0165, Accuracy: 347/568 (61.0915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   2,  Average loss: 0.0129, Accuracy: 343/568 (60.3873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   3,  Average loss: 0.0114, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   4,  Average loss: 0.0106, Accuracy: 385/568 (67.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   5,  Average loss: 0.0101, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   6,  Average loss: 0.0100, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   7,  Average loss: 0.0097, Accuracy: 389/568 (68.4859%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   8,  Average loss: 0.0092, Accuracy: 403/568 (70.9507%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   9,  Average loss: 0.0088, Accuracy: 410/568 (72.1831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch  10,  Average loss: 0.0084, Accuracy: 423/568 (74.4718%), train_poison_data_count: 180
Global model norm: 16.453852073203862.
Norm before scaling: 16.488203050779973. Distance: 2.4501356632274454
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.1787, Accuracy: 5239/10000 (52.3900%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.5096, Accuracy: 7324/8968 (81.6682%)
Scaling by  100
Scaled Norm after poisoning: 244.5714922957089, distance: 245.01355989261083
Total norm for 4 adversaries is: 244.5714922957089. distance: 245.01355989261083
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   1,  Average loss: 0.0151, Accuracy: 355/557 (63.7343%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   2,  Average loss: 0.0076, Accuracy: 459/557 (82.4057%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   3,  Average loss: 0.0033, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   4,  Average loss: 0.0030, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   5,  Average loss: 0.0023, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   7,  Average loss: 0.0018, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   8,  Average loss: 0.0014, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   9,  Average loss: 0.0019, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch  10,  Average loss: 0.0018, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Global model norm: 16.453852073203862.
Norm before scaling: 16.626175688280757. Distance: 2.4167579984397407
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.4097, Accuracy: 8732/10000 (87.3200%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1109, Accuracy: 8534/8968 (95.1606%)
Scaling by  100
Scaled Norm after poisoning: 242.20631378537595, distance: 241.6757981392634
Total norm for 4 adversaries is: 242.20631378537595. distance: 241.6757981392634
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  20, local model 69, internal_epoch   1,  Average loss: 0.0021, Accuracy: 250/256 (97.6562%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1786, Accuracy: 9422/10000 (94.2200%)
___Train Local_Simple,  epoch  20, local model 95, internal_epoch   1,  Average loss: 0.0005, Accuracy: 598/602 (99.3355%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.0754, Accuracy: 7682/10000 (76.8200%)
___Train Local_Simple,  epoch  20, local model 80, internal_epoch   1,  Average loss: 0.0012, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2227, Accuracy: 9341/10000 (93.4100%)
___Train Local_Simple,  epoch  20, local model 8, internal_epoch   1,  Average loss: 0.0017, Accuracy: 615/633 (97.1564%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1542, Accuracy: 9537/10000 (95.3700%)
___Train Local_Simple,  epoch  20, local model 25, internal_epoch   1,  Average loss: 0.0016, Accuracy: 630/647 (97.3725%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2180, Accuracy: 9283/10000 (92.8300%)
___Train Local_Simple,  epoch  20, local model 68, internal_epoch   1,  Average loss: 0.0012, Accuracy: 485/494 (98.1781%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1496, Accuracy: 9512/10000 (95.1200%)
time spent on training: 86.04078364372253
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.43119777158774375  data num: [606, 591, 568, 557, 256, 602, 431, 633, 647, 494]
[rfa agg] considering poison per batch poison_fraction: 0.13474930362116994
[rfa agg] init. name: [41, 73, 51, 74, 69, 95, 80, 8, 25, 68], weight: tensor([0.1125, 0.1097, 0.1055, 0.1034, 0.0475, 0.1118, 0.0800, 0.1175, 0.1201,
        0.0917])
[rfa agg] iter:  0, prev_obj_val: 134.7848663330078, obj_val: 121.13843536376953, abs dis: 13.646430969238281
[rfa agg] iter:  0, weight: tensor([0.0548, 0.0453, 0.0533, 0.0489, 0.0667, 0.1567, 0.1123, 0.1648, 0.1685,
        0.1286])
[rfa agg] iter:  1, prev_obj_val: 121.13843536376953, obj_val: 115.64138793945312, abs dis: 5.497047424316406
[rfa agg] iter:  1, weight: tensor([0.0266, 0.0216, 0.0254, 0.0244, 0.0755, 0.1772, 0.1270, 0.1864, 0.1906,
        0.1454])
[rfa agg] iter:  2, prev_obj_val: 115.64138793945312, obj_val: 113.14337921142578, abs dis: 2.4980087280273438
[rfa agg] iter:  2, weight: tensor([0.0130, 0.0106, 0.0123, 0.0120, 0.0798, 0.1869, 0.1340, 0.1967, 0.2013,
        0.1534])
[rfa agg] iter:  3, prev_obj_val: 113.14337921142578, obj_val: 111.96871185302734, abs dis: 1.1746673583984375
[rfa agg] iter:  3, weight: tensor([0.0064, 0.0052, 0.0060, 0.0059, 0.0822, 0.1914, 0.1376, 0.2017, 0.2064,
        0.1572])
[rfa agg] iter:  4, prev_obj_val: 111.96871185302734, obj_val: 111.42464447021484, abs dis: 0.5440673828125
[rfa agg] iter:  4, weight: tensor([0.0032, 0.0026, 0.0030, 0.0030, 0.0840, 0.1929, 0.1396, 0.2042, 0.2085,
        0.1591])
[rfa agg] iter:  5, prev_obj_val: 111.42464447021484, obj_val: 111.19854736328125, abs dis: 0.22609710693359375
[rfa agg] iter:  5, weight: tensor([0.0016, 0.0013, 0.0015, 0.0015, 0.0868, 0.1917, 0.1416, 0.2058, 0.2072,
        0.1608])
[rfa agg] iter:  6, prev_obj_val: 111.19854736328125, obj_val: 111.12922668457031, abs dis: 0.0693206787109375
[rfa agg] iter:  6, weight: tensor([0.0009, 0.0008, 0.0009, 0.0009, 0.0927, 0.1868, 0.1448, 0.2075, 0.2002,
        0.1645])
[rfa agg] iter:  7, prev_obj_val: 111.12922668457031, obj_val: 111.11651611328125, abs dis: 0.0127105712890625
[rfa agg] iter:  7, weight: tensor([0.0007, 0.0006, 0.0006, 0.0006, 0.1007, 0.1798, 0.1486, 0.2094, 0.1888,
        0.1703])
[rfa agg] iter:  8, prev_obj_val: 111.11651611328125, obj_val: 111.1150894165039, abs dis: 0.00142669677734375
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0005, 0.0006, 0.0006, 0.1059, 0.1750, 0.1510, 0.2106, 0.1804,
        0.1749])
[rfa agg] iter:  9, prev_obj_val: 111.1150894165039, obj_val: 111.11497497558594, abs dis: 0.00011444091796875
[rfa agg] iter:  9, weight: tensor([0.0006, 0.0005, 0.0005, 0.0005, 0.1079, 0.1730, 0.1520, 0.2112, 0.1766,
        0.1772])
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.0974, Accuracy: 9736/10000 (97.3600%)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 5.6734, Accuracy: 88/8968 (0.9813%)
Done in 102.23665380477905 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:21 choose agents : [41, 73, 51, 74, 70, 61, 64, 31, 10, 23]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0153, Accuracy: 398/606 (65.6766%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: 0.0135, Accuracy: 365/606 (60.2310%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: 0.0111, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: 0.0105, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: 0.0100, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: 0.0099, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: 0.0100, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: 0.0100, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 441/606 (72.7723%), train_poison_data_count: 200
Global model norm: 16.453600754339554.
Norm before scaling: 16.47298554997507. Distance: 2.2466809906583087
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.8803, Accuracy: 6576/10000 (65.7600%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.9683, Accuracy: 3884/8968 (43.3095%)
Scaling by  100
Scaled Norm after poisoning: 224.28898072575925, distance: 224.66810590847112
Total norm for 4 adversaries is: 224.28898072575925. distance: 224.66810590847112
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 5.8841, Accuracy: 8728/8968 (97.3238%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   1,  Average loss: 0.0191, Accuracy: 351/591 (59.3909%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   2,  Average loss: 0.0190, Accuracy: 272/591 (46.0237%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   3,  Average loss: 0.0157, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   4,  Average loss: 0.0138, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   5,  Average loss: 0.0128, Accuracy: 368/591 (62.2673%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   6,  Average loss: 0.0124, Accuracy: 367/591 (62.0981%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   7,  Average loss: 0.0124, Accuracy: 381/591 (64.4670%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   8,  Average loss: 0.0122, Accuracy: 396/591 (67.0051%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   9,  Average loss: 0.0117, Accuracy: 399/591 (67.5127%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch  10,  Average loss: 0.0114, Accuracy: 396/591 (67.0051%), train_poison_data_count: 195
Global model norm: 16.453600754339554.
Norm before scaling: 16.50483771409916. Distance: 2.315332276327674
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.7517, Accuracy: 6943/10000 (69.4300%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.8499, Accuracy: 4801/8968 (53.5348%)
Scaling by  100
Scaled Norm after poisoning: 231.32476831826722, distance: 231.53323026889683
Total norm for 4 adversaries is: 231.32476831826722. distance: 231.53323026889683
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   1,  Average loss: 0.0145, Accuracy: 374/568 (65.8451%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   2,  Average loss: 0.0109, Accuracy: 383/568 (67.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   3,  Average loss: 0.0096, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   4,  Average loss: 0.0094, Accuracy: 425/568 (74.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   5,  Average loss: 0.0082, Accuracy: 427/568 (75.1761%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   6,  Average loss: 0.0082, Accuracy: 432/568 (76.0563%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   7,  Average loss: 0.0072, Accuracy: 477/568 (83.9789%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   8,  Average loss: 0.0061, Accuracy: 491/568 (86.4437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   9,  Average loss: 0.0057, Accuracy: 504/568 (88.7324%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch  10,  Average loss: 0.0057, Accuracy: 508/568 (89.4366%), train_poison_data_count: 180
Global model norm: 16.453600754339554.
Norm before scaling: 16.509835750656997. Distance: 2.2240084807007827
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.8756, Accuracy: 6487/10000 (64.8700%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.2548, Accuracy: 8220/8968 (91.6592%)
Scaling by  100
Scaled Norm after poisoning: 222.3142043791849, distance: 222.40084693802314
Total norm for 4 adversaries is: 222.3142043791849. distance: 222.40084693802314
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   1,  Average loss: 0.0152, Accuracy: 343/557 (61.5799%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   2,  Average loss: 0.0067, Accuracy: 491/557 (88.1508%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   3,  Average loss: 0.0027, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   4,  Average loss: 0.0027, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   5,  Average loss: 0.0020, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   6,  Average loss: 0.0022, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   7,  Average loss: 0.0021, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Global model norm: 16.453600754339554.
Norm before scaling: 16.616302280135727. Distance: 2.421020357017222
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.4340, Accuracy: 8656/10000 (86.5600%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0886, Accuracy: 8636/8968 (96.2979%)
Scaling by  100
Scaled Norm after poisoning: 242.56140491894007, distance: 242.10204137408672
Total norm for 4 adversaries is: 242.56140491894007. distance: 242.10204137408672
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  21, local model 70, internal_epoch   1,  Average loss: 0.0018, Accuracy: 699/724 (96.5470%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2427, Accuracy: 9158/10000 (91.5800%)
___Train Local_Simple,  epoch  21, local model 61, internal_epoch   1,  Average loss: 0.0016, Accuracy: 679/699 (97.1388%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1628, Accuracy: 9492/10000 (94.9200%)
___Train Local_Simple,  epoch  21, local model 64, internal_epoch   1,  Average loss: 0.0019, Accuracy: 786/813 (96.6790%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2543, Accuracy: 9130/10000 (91.3000%)
___Train Local_Simple,  epoch  21, local model 31, internal_epoch   1,  Average loss: 0.0011, Accuracy: 817/835 (97.8443%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1601, Accuracy: 9502/10000 (95.0200%)
___Train Local_Simple,  epoch  21, local model 10, internal_epoch   1,  Average loss: 0.0017, Accuracy: 866/892 (97.0852%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.7139, Accuracy: 8287/10000 (82.8700%)
___Train Local_Simple,  epoch  21, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1255, Accuracy: 9599/10000 (95.9900%)
time spent on training: 88.23443937301636
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3529948312557008  data num: [606, 591, 568, 557, 724, 699, 813, 835, 892, 293]
[rfa agg] considering poison per batch poison_fraction: 0.1103108847674065
[rfa agg] init. name: [41, 73, 51, 74, 70, 61, 64, 31, 10, 23], weight: tensor([0.0921, 0.0898, 0.0863, 0.0847, 0.1101, 0.1063, 0.1236, 0.1269, 0.1356,
        0.0445])
[rfa agg] iter:  0, prev_obj_val: 104.49185180664062, obj_val: 89.09185028076172, abs dis: 15.400001525878906
[rfa agg] iter:  0, weight: tensor([0.0329, 0.0315, 0.0321, 0.0274, 0.1489, 0.1440, 0.1672, 0.1718, 0.1839,
        0.0604])
[rfa agg] iter:  1, prev_obj_val: 89.09185028076172, obj_val: 83.99481201171875, abs dis: 5.097038269042969
[rfa agg] iter:  1, weight: tensor([0.0116, 0.0110, 0.0111, 0.0098, 0.1622, 0.1575, 0.1821, 0.1873, 0.2011,
        0.0662])
[rfa agg] iter:  2, prev_obj_val: 83.99481201171875, obj_val: 82.2840805053711, abs dis: 1.7107315063476562
[rfa agg] iter:  2, weight: tensor([0.0041, 0.0039, 0.0039, 0.0035, 0.1658, 0.1632, 0.1861, 0.1923, 0.2081,
        0.0691])
[rfa agg] iter:  3, prev_obj_val: 82.2840805053711, obj_val: 81.79670715332031, abs dis: 0.48737335205078125
[rfa agg] iter:  3, weight: tensor([0.0015, 0.0014, 0.0014, 0.0013, 0.1636, 0.1685, 0.1833, 0.1942, 0.2114,
        0.0734])
[rfa agg] iter:  4, prev_obj_val: 81.79670715332031, obj_val: 81.7215576171875, abs dis: 0.0751495361328125
[rfa agg] iter:  4, weight: tensor([0.0007, 0.0007, 0.0007, 0.0006, 0.1551, 0.1786, 0.1725, 0.1993, 0.2065,
        0.0853])
[rfa agg] iter:  5, prev_obj_val: 81.7215576171875, obj_val: 81.71735382080078, abs dis: 0.00420379638671875
[rfa agg] iter:  5, weight: tensor([0.0005, 0.0005, 0.0005, 0.0005, 0.1486, 0.1863, 0.1637, 0.2068, 0.1958,
        0.0967])
[rfa agg] iter:  6, prev_obj_val: 81.71735382080078, obj_val: 81.71722412109375, abs dis: 0.00012969970703125
[rfa agg] iter:  6, weight: tensor([0.0005, 0.0005, 0.0005, 0.0004, 0.1467, 0.1892, 0.1610, 0.2107, 0.1905,
        0.1000])
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.0957, Accuracy: 9744/10000 (97.4400%)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 5.7554, Accuracy: 88/8968 (0.9813%)
Done in 104.55016684532166 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:22 choose agents : [41, 73, 51, 74, 7, 46, 65, 57, 83, 9]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   1,  Average loss: 0.0165, Accuracy: 378/606 (62.3762%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   2,  Average loss: 0.0154, Accuracy: 323/606 (53.3003%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   3,  Average loss: 0.0110, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   4,  Average loss: 0.0106, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   5,  Average loss: 0.0104, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   6,  Average loss: 0.0105, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   7,  Average loss: 0.0101, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   8,  Average loss: 0.0099, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   9,  Average loss: 0.0101, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Global model norm: 16.453464428478846.
Norm before scaling: 16.49741320128657. Distance: 2.4990266812576643
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.0545, Accuracy: 5892/10000 (58.9200%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 1.0093, Accuracy: 4316/8968 (48.1267%)
Scaling by  100
Scaled Norm after poisoning: 249.48419445177282, distance: 249.90266855317893
Total norm for 4 adversaries is: 249.48419445177282. distance: 249.90266855317893
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 805.1149, Accuracy: 7629/8968 (85.0691%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   1,  Average loss: 0.0202, Accuracy: 341/591 (57.6988%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   2,  Average loss: 0.0205, Accuracy: 244/591 (41.2860%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   3,  Average loss: 0.0146, Accuracy: 273/591 (46.1929%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   4,  Average loss: 0.0143, Accuracy: 336/591 (56.8528%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   5,  Average loss: 0.0133, Accuracy: 361/591 (61.0829%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   6,  Average loss: 0.0126, Accuracy: 378/591 (63.9594%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   7,  Average loss: 0.0125, Accuracy: 382/591 (64.6362%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   8,  Average loss: 0.0120, Accuracy: 381/591 (64.4670%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   9,  Average loss: 0.0120, Accuracy: 380/591 (64.2978%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch  10,  Average loss: 0.0122, Accuracy: 371/591 (62.7750%), train_poison_data_count: 195
Global model norm: 16.453464428478846.
Norm before scaling: 16.538988692560867. Distance: 2.5707669769412096
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.8487, Accuracy: 6396/10000 (63.9600%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.6946, Accuracy: 5575/8968 (62.1655%)
Scaling by  100
Scaled Norm after poisoning: 256.86654487301377, distance: 257.0767000089662
Total norm for 4 adversaries is: 256.86654487301377. distance: 257.0767000089662
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   1,  Average loss: 0.0155, Accuracy: 354/568 (62.3239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   2,  Average loss: 0.0121, Accuracy: 340/568 (59.8592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   3,  Average loss: 0.0101, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   4,  Average loss: 0.0101, Accuracy: 371/568 (65.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   5,  Average loss: 0.0091, Accuracy: 405/568 (71.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   6,  Average loss: 0.0090, Accuracy: 409/568 (72.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   7,  Average loss: 0.0085, Accuracy: 409/568 (72.0070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   8,  Average loss: 0.0079, Accuracy: 422/568 (74.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   9,  Average loss: 0.0074, Accuracy: 434/568 (76.4085%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch  10,  Average loss: 0.0071, Accuracy: 438/568 (77.1127%), train_poison_data_count: 180
Global model norm: 16.453464428478846.
Norm before scaling: 16.49760558354558. Distance: 2.2298968061168605
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.8738, Accuracy: 6734/10000 (67.3400%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.4688, Accuracy: 7531/8968 (83.9764%)
Scaling by  100
Scaled Norm after poisoning: 222.80780149323766, distance: 222.9896823566059
Total norm for 4 adversaries is: 222.80780149323766. distance: 222.9896823566059
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   1,  Average loss: 0.0171, Accuracy: 330/557 (59.2460%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   2,  Average loss: 0.0087, Accuracy: 444/557 (79.7127%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   3,  Average loss: 0.0037, Accuracy: 516/557 (92.6391%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   4,  Average loss: 0.0034, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   5,  Average loss: 0.0024, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   7,  Average loss: 0.0023, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   8,  Average loss: 0.0020, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   9,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch  10,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Global model norm: 16.453464428478846.
Norm before scaling: 16.67344456499944. Distance: 2.788654543321439
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.5370, Accuracy: 8350/10000 (83.5000%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0836, Accuracy: 8650/8968 (96.4541%)
Scaling by  100
Scaled Norm after poisoning: 279.2628130453462, distance: 278.8654469452965
Total norm for 4 adversaries is: 279.2628130453462. distance: 278.8654469452965
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  22, local model 7, internal_epoch   1,  Average loss: 0.0013, Accuracy: 411/418 (98.3254%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1501, Accuracy: 9518/10000 (95.1800%)
___Train Local_Simple,  epoch  22, local model 46, internal_epoch   1,  Average loss: 0.0016, Accuracy: 691/710 (97.3239%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3194, Accuracy: 8947/10000 (89.4700%)
___Train Local_Simple,  epoch  22, local model 65, internal_epoch   1,  Average loss: 0.0012, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1257, Accuracy: 9588/10000 (95.8800%)
___Train Local_Simple,  epoch  22, local model 57, internal_epoch   1,  Average loss: 0.0015, Accuracy: 330/343 (96.2099%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1448, Accuracy: 9564/10000 (95.6400%)
___Train Local_Simple,  epoch  22, local model 83, internal_epoch   1,  Average loss: 0.0015, Accuracy: 420/433 (96.9977%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1086, Accuracy: 9644/10000 (96.4400%)
___Train Local_Simple,  epoch  22, local model 9, internal_epoch   1,  Average loss: 0.0012, Accuracy: 428/436 (98.1651%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1078, Accuracy: 9660/10000 (96.6000%)
time spent on training: 83.00664520263672
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.46135505662626664  data num: [606, 591, 568, 557, 418, 710, 371, 343, 433, 436]
[rfa agg] considering poison per batch poison_fraction: 0.14417345519570832
[rfa agg] init. name: [41, 73, 51, 74, 7, 46, 65, 57, 83, 9], weight: tensor([0.1204, 0.1174, 0.1129, 0.1107, 0.0831, 0.1411, 0.0737, 0.0682, 0.0860,
        0.0866])
[rfa agg] iter:  0, prev_obj_val: 137.98326110839844, obj_val: 126.41976165771484, abs dis: 11.563499450683594
[rfa agg] iter:  0, weight: tensor([0.0614, 0.0586, 0.0677, 0.0491, 0.1177, 0.1997, 0.1044, 0.0967, 0.1219,
        0.1227])
[rfa agg] iter:  1, prev_obj_val: 126.41976165771484, obj_val: 121.5561294555664, abs dis: 4.8636322021484375
[rfa agg] iter:  1, weight: tensor([0.0333, 0.0316, 0.0361, 0.0268, 0.1345, 0.2281, 0.1194, 0.1107, 0.1394,
        0.1403])
[rfa agg] iter:  2, prev_obj_val: 121.5561294555664, obj_val: 119.1521987915039, abs dis: 2.4039306640625
[rfa agg] iter:  2, weight: tensor([0.0183, 0.0174, 0.0196, 0.0149, 0.1433, 0.2429, 0.1273, 0.1182, 0.1487,
        0.1495])
[rfa agg] iter:  3, prev_obj_val: 119.1521987915039, obj_val: 117.89254760742188, abs dis: 1.2596511840820312
[rfa agg] iter:  3, weight: tensor([0.0102, 0.0096, 0.0108, 0.0083, 0.1480, 0.2504, 0.1316, 0.1227, 0.1538,
        0.1546])
[rfa agg] iter:  4, prev_obj_val: 117.89254760742188, obj_val: 117.21803283691406, abs dis: 0.6745147705078125
[rfa agg] iter:  4, weight: tensor([0.0057, 0.0054, 0.0060, 0.0047, 0.1506, 0.2536, 0.1341, 0.1258, 0.1568,
        0.1574])
[rfa agg] iter:  5, prev_obj_val: 117.21803283691406, obj_val: 116.85957336425781, abs dis: 0.35845947265625
[rfa agg] iter:  5, weight: tensor([0.0032, 0.0030, 0.0034, 0.0026, 0.1517, 0.2534, 0.1358, 0.1286, 0.1589,
        0.1593])
[rfa agg] iter:  6, prev_obj_val: 116.85957336425781, obj_val: 116.67960357666016, abs dis: 0.17996978759765625
[rfa agg] iter:  6, weight: tensor([0.0018, 0.0017, 0.0019, 0.0015, 0.1519, 0.2490, 0.1376, 0.1321, 0.1611,
        0.1613])
[rfa agg] iter:  7, prev_obj_val: 116.67960357666016, obj_val: 116.60227966308594, abs dis: 0.07732391357421875
[rfa agg] iter:  7, weight: tensor([0.0011, 0.0011, 0.0012, 0.0009, 0.1511, 0.2385, 0.1407, 0.1362, 0.1641,
        0.1650])
[rfa agg] iter:  8, prev_obj_val: 116.60227966308594, obj_val: 116.5774154663086, abs dis: 0.02486419677734375
[rfa agg] iter:  8, weight: tensor([0.0008, 0.0007, 0.0008, 0.0006, 0.1492, 0.2224, 0.1458, 0.1395, 0.1684,
        0.1718])
[rfa agg] iter:  9, prev_obj_val: 116.5774154663086, obj_val: 116.5718002319336, abs dis: 0.005615234375
[rfa agg] iter:  9, weight: tensor([0.0006, 0.0006, 0.0006, 0.0005, 0.1471, 0.2063, 0.1517, 0.1398, 0.1728,
        0.1800])
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.0951, Accuracy: 9742/10000 (97.4200%)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 5.7149, Accuracy: 86/8968 (0.9590%)
Done in 98.59719586372375 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:23 choose agents : [41, 73, 51, 74, 64, 58, 12, 83, 96, 90]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   1,  Average loss: 0.0150, Accuracy: 382/606 (63.0363%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   2,  Average loss: 0.0128, Accuracy: 373/606 (61.5512%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   3,  Average loss: 0.0107, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   4,  Average loss: 0.0106, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   5,  Average loss: 0.0103, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   6,  Average loss: 0.0100, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   7,  Average loss: 0.0101, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   8,  Average loss: 0.0099, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   9,  Average loss: 0.0096, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch  10,  Average loss: 0.0097, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Global model norm: 16.453299352115142.
Norm before scaling: 16.46399343519015. Distance: 2.188473729987569
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.9508, Accuracy: 5934/10000 (59.3400%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.9723, Accuracy: 4456/8968 (49.6878%)
Scaling by  100
Scaled Norm after poisoning: 218.45170733482493, distance: 218.84738011054645
Total norm for 4 adversaries is: 218.45170733482493. distance: 218.84738011054645
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 245.9104, Accuracy: 8644/8968 (96.3872%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   1,  Average loss: 0.0209, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   2,  Average loss: 0.0186, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   3,  Average loss: 0.0153, Accuracy: 319/591 (53.9763%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   4,  Average loss: 0.0149, Accuracy: 345/591 (58.3756%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   5,  Average loss: 0.0133, Accuracy: 377/591 (63.7902%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   6,  Average loss: 0.0128, Accuracy: 375/591 (63.4518%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   7,  Average loss: 0.0126, Accuracy: 376/591 (63.6210%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   8,  Average loss: 0.0120, Accuracy: 380/591 (64.2978%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   9,  Average loss: 0.0114, Accuracy: 392/591 (66.3283%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch  10,  Average loss: 0.0116, Accuracy: 388/591 (65.6514%), train_poison_data_count: 195
Global model norm: 16.453299352115142.
Norm before scaling: 16.519361753534568. Distance: 2.649451047791745
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.0182, Accuracy: 5439/10000 (54.3900%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.5668, Accuracy: 6998/8968 (78.0330%)
Scaling by  100
Scaled Norm after poisoning: 264.5420128495661, distance: 264.9451004453564
Total norm for 4 adversaries is: 264.5420128495661. distance: 264.9451004453564
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   1,  Average loss: 0.0146, Accuracy: 356/568 (62.6761%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   2,  Average loss: 0.0105, Accuracy: 385/568 (67.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   3,  Average loss: 0.0094, Accuracy: 412/568 (72.5352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   4,  Average loss: 0.0089, Accuracy: 410/568 (72.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   5,  Average loss: 0.0087, Accuracy: 401/568 (70.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   6,  Average loss: 0.0081, Accuracy: 423/568 (74.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   7,  Average loss: 0.0075, Accuracy: 433/568 (76.2324%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   8,  Average loss: 0.0064, Accuracy: 480/568 (84.5070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   9,  Average loss: 0.0058, Accuracy: 524/568 (92.2535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch  10,  Average loss: 0.0060, Accuracy: 510/568 (89.7887%), train_poison_data_count: 180
Global model norm: 16.453299352115142.
Norm before scaling: 16.477778412045854. Distance: 2.0524178504998773
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.9023, Accuracy: 6542/10000 (65.4200%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.2496, Accuracy: 8382/8968 (93.4657%)
Scaling by  100
Scaled Norm after poisoning: 205.07138619880638, distance: 205.24179718687907
Total norm for 4 adversaries is: 205.07138619880638. distance: 205.24179718687907
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   1,  Average loss: 0.0161, Accuracy: 347/557 (62.2980%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   2,  Average loss: 0.0083, Accuracy: 451/557 (80.9695%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   3,  Average loss: 0.0033, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   4,  Average loss: 0.0029, Accuracy: 523/557 (93.8959%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   5,  Average loss: 0.0027, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   6,  Average loss: 0.0020, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   7,  Average loss: 0.0019, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   8,  Average loss: 0.0021, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch  10,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Global model norm: 16.453299352115142.
Norm before scaling: 16.651258339743425. Distance: 2.7373365658262365
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4850, Accuracy: 8513/10000 (85.1300%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.1011, Accuracy: 8563/8968 (95.4839%)
Scaling by  100
Scaled Norm after poisoning: 274.0562926891116, distance: 273.7336467718209
Total norm for 4 adversaries is: 274.0562926891116. distance: 273.7336467718209
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  23, local model 64, internal_epoch   1,  Average loss: 0.0018, Accuracy: 787/813 (96.8020%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2174, Accuracy: 9263/10000 (92.6300%)
___Train Local_Simple,  epoch  23, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 265/276 (96.0145%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1303, Accuracy: 9614/10000 (96.1400%)
___Train Local_Simple,  epoch  23, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1129/1160 (97.3276%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3000, Accuracy: 9184/10000 (91.8400%)
___Train Local_Simple,  epoch  23, local model 83, internal_epoch   1,  Average loss: 0.0015, Accuracy: 424/433 (97.9215%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1104, Accuracy: 9642/10000 (96.4200%)
___Train Local_Simple,  epoch  23, local model 96, internal_epoch   1,  Average loss: 0.0014, Accuracy: 664/672 (98.8095%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1389, Accuracy: 9597/10000 (95.9700%)
___Train Local_Simple,  epoch  23, local model 90, internal_epoch   1,  Average loss: 0.0016, Accuracy: 662/683 (96.9253%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4103, Accuracy: 8693/10000 (86.9300%)
time spent on training: 83.94403171539307
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3651517534203491  data num: [606, 591, 568, 557, 813, 276, 1160, 433, 672, 683]
[rfa agg] considering poison per batch poison_fraction: 0.1141099229438591
[rfa agg] init. name: [41, 73, 51, 74, 64, 58, 12, 83, 96, 90], weight: tensor([0.0953, 0.0929, 0.0893, 0.0876, 0.1279, 0.0434, 0.1824, 0.0681, 0.1057,
        0.1074])
[rfa agg] iter:  0, prev_obj_val: 112.4654312133789, obj_val: 96.90206146240234, abs dis: 15.563369750976562
[rfa agg] iter:  0, weight: tensor([0.0400, 0.0324, 0.0417, 0.0286, 0.1727, 0.0587, 0.2460, 0.0920, 0.1428,
        0.1451])
[rfa agg] iter:  1, prev_obj_val: 96.90206146240234, obj_val: 91.31231689453125, abs dis: 5.589744567871094
[rfa agg] iter:  1, weight: tensor([0.0156, 0.0125, 0.0159, 0.0113, 0.1903, 0.0650, 0.2705, 0.1016, 0.1574,
        0.1600])
[rfa agg] iter:  2, prev_obj_val: 91.31231689453125, obj_val: 89.224853515625, abs dis: 2.08746337890625
[rfa agg] iter:  2, weight: tensor([0.0061, 0.0049, 0.0061, 0.0044, 0.1971, 0.0680, 0.2783, 0.1057, 0.1634,
        0.1660])
[rfa agg] iter:  3, prev_obj_val: 89.224853515625, obj_val: 88.50199890136719, abs dis: 0.7228546142578125
[rfa agg] iter:  3, weight: tensor([0.0024, 0.0019, 0.0024, 0.0018, 0.1995, 0.0710, 0.2765, 0.1092, 0.1672,
        0.1682])
[rfa agg] iter:  4, prev_obj_val: 88.50199890136719, obj_val: 88.32537841796875, abs dis: 0.1766204833984375
[rfa agg] iter:  4, weight: tensor([0.0011, 0.0009, 0.0011, 0.0008, 0.1986, 0.0772, 0.2629, 0.1174, 0.1738,
        0.1664])
[rfa agg] iter:  5, prev_obj_val: 88.32537841796875, obj_val: 88.30523681640625, abs dis: 0.0201416015625
[rfa agg] iter:  5, weight: tensor([0.0007, 0.0005, 0.0007, 0.0005, 0.1939, 0.0848, 0.2422, 0.1328, 0.1844,
        0.1595])
[rfa agg] iter:  6, prev_obj_val: 88.30523681640625, obj_val: 88.30412292480469, abs dis: 0.0011138916015625
[rfa agg] iter:  6, weight: tensor([0.0006, 0.0005, 0.0006, 0.0004, 0.1909, 0.0878, 0.2290, 0.1431, 0.1918,
        0.1552])
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.0931, Accuracy: 9741/10000 (97.4100%)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 5.7297, Accuracy: 86/8968 (0.9590%)
Done in 99.45130133628845 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:24 choose agents : [41, 73, 51, 74, 28, 65, 33, 75, 13, 32]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   1,  Average loss: 0.0154, Accuracy: 382/606 (63.0363%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   2,  Average loss: 0.0119, Accuracy: 386/606 (63.6964%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   3,  Average loss: 0.0111, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   4,  Average loss: 0.0109, Accuracy: 401/606 (66.1716%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   5,  Average loss: 0.0110, Accuracy: 387/606 (63.8614%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   6,  Average loss: 0.0102, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   7,  Average loss: 0.0103, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   9,  Average loss: 0.0102, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Global model norm: 16.4520732836938.
Norm before scaling: 16.44477619374919. Distance: 2.189578785212542
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.9600, Accuracy: 5851/10000 (58.5100%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.9948, Accuracy: 4702/8968 (52.4309%)
Scaling by  100
Scaled Norm after poisoning: 218.42572393150033, distance: 218.95788336458682
Total norm for 4 adversaries is: 218.42572393150033. distance: 218.95788336458682
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 310.0292, Accuracy: 7043/8968 (78.5348%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   1,  Average loss: 0.0202, Accuracy: 354/591 (59.8985%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   2,  Average loss: 0.0194, Accuracy: 250/591 (42.3012%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   3,  Average loss: 0.0145, Accuracy: 352/591 (59.5601%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   4,  Average loss: 0.0143, Accuracy: 360/591 (60.9137%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   5,  Average loss: 0.0135, Accuracy: 351/591 (59.3909%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   6,  Average loss: 0.0129, Accuracy: 366/591 (61.9289%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   7,  Average loss: 0.0126, Accuracy: 379/591 (64.1286%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   8,  Average loss: 0.0125, Accuracy: 367/591 (62.0981%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   9,  Average loss: 0.0123, Accuracy: 376/591 (63.6210%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch  10,  Average loss: 0.0120, Accuracy: 388/591 (65.6514%), train_poison_data_count: 195
Global model norm: 16.4520732836938.
Norm before scaling: 16.56350601307925. Distance: 2.8007235341529695
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.8236, Accuracy: 6505/10000 (65.0500%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.7844, Accuracy: 5178/8968 (57.7386%)
Scaling by  100
Scaled Norm after poisoning: 279.8118927288474, distance: 280.072339985583
Total norm for 4 adversaries is: 279.8118927288474. distance: 280.072339985583
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1960, Accuracy: 8967/8968 (99.9888%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   1,  Average loss: 0.0163, Accuracy: 341/568 (60.0352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   2,  Average loss: 0.0108, Accuracy: 398/568 (70.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   3,  Average loss: 0.0104, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   4,  Average loss: 0.0097, Accuracy: 398/568 (70.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   5,  Average loss: 0.0093, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   6,  Average loss: 0.0081, Accuracy: 426/568 (75.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   7,  Average loss: 0.0076, Accuracy: 435/568 (76.5845%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   8,  Average loss: 0.0070, Accuracy: 478/568 (84.1549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   9,  Average loss: 0.0065, Accuracy: 490/568 (86.2676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch  10,  Average loss: 0.0064, Accuracy: 494/568 (86.9718%), train_poison_data_count: 180
Global model norm: 16.4520732836938.
Norm before scaling: 16.486553840009478. Distance: 2.3709737882480537
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.0243, Accuracy: 5607/10000 (56.0700%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.2871, Accuracy: 8095/8968 (90.2654%)
Scaling by  100
Scaled Norm after poisoning: 236.72190798223556, distance: 237.09737253394437
Total norm for 4 adversaries is: 236.72190798223556. distance: 237.09737253394437
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   1,  Average loss: 0.0159, Accuracy: 340/557 (61.0413%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   2,  Average loss: 0.0069, Accuracy: 484/557 (86.8941%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   3,  Average loss: 0.0039, Accuracy: 515/557 (92.4596%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   4,  Average loss: 0.0029, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   5,  Average loss: 0.0026, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   7,  Average loss: 0.0021, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch  10,  Average loss: 0.0019, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Global model norm: 16.4520732836938.
Norm before scaling: 16.63527918093755. Distance: 2.584716600861456
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.4025, Accuracy: 8816/10000 (88.1600%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0765, Accuracy: 8685/8968 (96.8443%)
Scaling by  100
Scaled Norm after poisoning: 258.87519616120045, distance: 258.4716649122298
Total norm for 4 adversaries is: 258.87519616120045. distance: 258.4716649122298
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  24, local model 28, internal_epoch   1,  Average loss: 0.0014, Accuracy: 486/501 (97.0060%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1073, Accuracy: 9637/10000 (96.3700%)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0012, Accuracy: 363/371 (97.8437%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1202, Accuracy: 9601/10000 (96.0100%)
___Train Local_Simple,  epoch  24, local model 33, internal_epoch   1,  Average loss: 0.0019, Accuracy: 602/623 (96.6292%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1721, Accuracy: 9423/10000 (94.2300%)
___Train Local_Simple,  epoch  24, local model 75, internal_epoch   1,  Average loss: 0.0010, Accuracy: 673/686 (98.1050%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1656, Accuracy: 9460/10000 (94.6000%)
___Train Local_Simple,  epoch  24, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 718/734 (97.8202%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2661, Accuracy: 9163/10000 (91.6300%)
___Train Local_Simple,  epoch  24, local model 32, internal_epoch   1,  Average loss: 0.0020, Accuracy: 943/977 (96.5200%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2640, Accuracy: 9131/10000 (91.3100%)
time spent on training: 82.36538743972778
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3736723527518507  data num: [606, 591, 568, 557, 501, 371, 623, 686, 734, 977]
[rfa agg] considering poison per batch poison_fraction: 0.11677261023495333
[rfa agg] init. name: [41, 73, 51, 74, 28, 65, 33, 75, 13, 32], weight: tensor([0.0975, 0.0951, 0.0914, 0.0896, 0.0806, 0.0597, 0.1003, 0.1104, 0.1181,
        0.1572])
[rfa agg] iter:  0, prev_obj_val: 118.0152359008789, obj_val: 102.18538665771484, abs dis: 15.829849243164062
[rfa agg] iter:  0, weight: tensor([0.0432, 0.0327, 0.0382, 0.0324, 0.1100, 0.0815, 0.1366, 0.1503, 0.1610,
        0.2141])
[rfa agg] iter:  1, prev_obj_val: 102.18538665771484, obj_val: 96.48731231689453, abs dis: 5.6980743408203125
[rfa agg] iter:  1, weight: tensor([0.0170, 0.0128, 0.0148, 0.0130, 0.1216, 0.0902, 0.1509, 0.1658, 0.1778,
        0.2361])
[rfa agg] iter:  2, prev_obj_val: 96.48731231689453, obj_val: 94.3267822265625, abs dis: 2.1605300903320312
[rfa agg] iter:  2, weight: tensor([0.0067, 0.0051, 0.0058, 0.0052, 0.1267, 0.0942, 0.1565, 0.1715, 0.1844,
        0.2440])
[rfa agg] iter:  3, prev_obj_val: 94.3267822265625, obj_val: 93.5445556640625, abs dis: 0.7822265625
[rfa agg] iter:  3, weight: tensor([0.0027, 0.0020, 0.0023, 0.0021, 0.1306, 0.0976, 0.1588, 0.1733, 0.1867,
        0.2439])
[rfa agg] iter:  4, prev_obj_val: 93.5445556640625, obj_val: 93.3258056640625, abs dis: 0.21875
[rfa agg] iter:  4, weight: tensor([0.0012, 0.0009, 0.0010, 0.0009, 0.1389, 0.1051, 0.1596, 0.1753, 0.1846,
        0.2325])
[rfa agg] iter:  5, prev_obj_val: 93.3258056640625, obj_val: 93.29327392578125, abs dis: 0.03253173828125
[rfa agg] iter:  5, weight: tensor([0.0007, 0.0005, 0.0006, 0.0005, 0.1556, 0.1201, 0.1577, 0.1819, 0.1750,
        0.2074])
[rfa agg] iter:  6, prev_obj_val: 93.29327392578125, obj_val: 93.2907943725586, abs dis: 0.00247955322265625
[rfa agg] iter:  6, weight: tensor([0.0005, 0.0004, 0.0005, 0.0004, 0.1690, 0.1308, 0.1553, 0.1889, 0.1662,
        0.1880])
[rfa agg] iter:  7, prev_obj_val: 93.2907943725586, obj_val: 93.29064178466797, abs dis: 0.000152587890625
[rfa agg] iter:  7, weight: tensor([0.0005, 0.0004, 0.0005, 0.0004, 0.1747, 0.1347, 0.1544, 0.1922, 0.1624,
        0.1798])
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.0907, Accuracy: 9742/10000 (97.4200%)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 5.8586, Accuracy: 76/8968 (0.8475%)
Done in 98.13198828697205 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:25 choose agents : [41, 73, 51, 74, 80, 23, 25, 12, 58, 19]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   1,  Average loss: 0.0170, Accuracy: 370/606 (61.0561%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   2,  Average loss: 0.0138, Accuracy: 346/606 (57.0957%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   3,  Average loss: 0.0109, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   4,  Average loss: 0.0109, Accuracy: 404/606 (66.6667%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   5,  Average loss: 0.0106, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   6,  Average loss: 0.0108, Accuracy: 402/606 (66.3366%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   8,  Average loss: 0.0104, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   9,  Average loss: 0.0099, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Global model norm: 16.45172455162851.
Norm before scaling: 16.50404354602655. Distance: 2.512130869609002
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.0148, Accuracy: 5578/10000 (55.7800%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.8824, Accuracy: 5084/8968 (56.6905%)
Scaling by  100
Scaled Norm after poisoning: 250.83863245371515, distance: 251.21309585937195
Total norm for 4 adversaries is: 250.83863245371515. distance: 251.21309585937195
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0189, Accuracy: 353/591 (59.7293%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   2,  Average loss: 0.0198, Accuracy: 248/591 (41.9628%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   3,  Average loss: 0.0141, Accuracy: 332/591 (56.1760%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   4,  Average loss: 0.0135, Accuracy: 355/591 (60.0677%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   5,  Average loss: 0.0137, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   6,  Average loss: 0.0126, Accuracy: 390/591 (65.9898%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   7,  Average loss: 0.0130, Accuracy: 352/591 (59.5601%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   8,  Average loss: 0.0120, Accuracy: 375/591 (63.4518%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   9,  Average loss: 0.0118, Accuracy: 401/591 (67.8511%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch  10,  Average loss: 0.0121, Accuracy: 378/591 (63.9594%), train_poison_data_count: 195
Global model norm: 16.45172455162851.
Norm before scaling: 16.45723013097843. Distance: 2.1942476017975694
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.7535, Accuracy: 6947/10000 (69.4700%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.8232, Accuracy: 4755/8968 (53.0219%)
Scaling by  100
Scaled Norm after poisoning: 218.98523066636253, distance: 219.42477177554497
Total norm for 4 adversaries is: 218.98523066636253. distance: 219.42477177554497
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 476.5060, Accuracy: 6154/8968 (68.6218%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   1,  Average loss: 0.0152, Accuracy: 355/568 (62.5000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   2,  Average loss: 0.0109, Accuracy: 383/568 (67.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   3,  Average loss: 0.0095, Accuracy: 415/568 (73.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   4,  Average loss: 0.0090, Accuracy: 422/568 (74.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   5,  Average loss: 0.0084, Accuracy: 437/568 (76.9366%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   6,  Average loss: 0.0078, Accuracy: 448/568 (78.8732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   7,  Average loss: 0.0067, Accuracy: 470/568 (82.7465%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   8,  Average loss: 0.0061, Accuracy: 495/568 (87.1479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   9,  Average loss: 0.0054, Accuracy: 518/568 (91.1972%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch  10,  Average loss: 0.0054, Accuracy: 517/568 (91.0211%), train_poison_data_count: 180
Global model norm: 16.45172455162851.
Norm before scaling: 16.506216092058605. Distance: 2.2486586281076413
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.8616, Accuracy: 6841/10000 (68.4100%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.2417, Accuracy: 8249/8968 (91.9826%)
Scaling by  100
Scaled Norm after poisoning: 224.7426653419417, distance: 224.8658627937998
Total norm for 4 adversaries is: 224.7426653419417. distance: 224.8658627937998
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0156, Accuracy: 364/557 (65.3501%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   2,  Average loss: 0.0075, Accuracy: 455/557 (81.6876%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   3,  Average loss: 0.0028, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   4,  Average loss: 0.0025, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   5,  Average loss: 0.0024, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   6,  Average loss: 0.0023, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   7,  Average loss: 0.0021, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   8,  Average loss: 0.0019, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Global model norm: 16.45172455162851.
Norm before scaling: 16.62214441082898. Distance: 2.5412610673639966
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4261, Accuracy: 8728/10000 (87.2800%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0871, Accuracy: 8651/8968 (96.4652%)
Scaling by  100
Scaled Norm after poisoning: 254.49672302654508, distance: 254.12610673639966
Total norm for 4 adversaries is: 254.49672302654508. distance: 254.12610673639966
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  25, local model 80, internal_epoch   1,  Average loss: 0.0011, Accuracy: 423/431 (98.1439%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1800, Accuracy: 9451/10000 (94.5100%)
___Train Local_Simple,  epoch  25, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1375, Accuracy: 9533/10000 (95.3300%)
___Train Local_Simple,  epoch  25, local model 25, internal_epoch   1,  Average loss: 0.0014, Accuracy: 633/647 (97.8362%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3827, Accuracy: 8728/10000 (87.2800%)
___Train Local_Simple,  epoch  25, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1124/1160 (96.8966%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4458, Accuracy: 8651/10000 (86.5100%)
___Train Local_Simple,  epoch  25, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 265/276 (96.0145%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1484, Accuracy: 9556/10000 (95.5600%)
___Train Local_Simple,  epoch  25, local model 19, internal_epoch   1,  Average loss: 0.0026, Accuracy: 200/205 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1193, Accuracy: 9648/10000 (96.4800%)
time spent on training: 86.63607501983643
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.43532058492688414  data num: [606, 591, 568, 557, 431, 293, 647, 1160, 276, 205]
[rfa agg] considering poison per batch poison_fraction: 0.13603768278965128
[rfa agg] init. name: [41, 73, 51, 74, 80, 23, 25, 12, 58, 19], weight: tensor([0.1136, 0.1108, 0.1065, 0.1044, 0.0808, 0.0549, 0.1213, 0.2175, 0.0517,
        0.0384])
[rfa agg] iter:  0, prev_obj_val: 125.17435455322266, obj_val: 113.26181030273438, abs dis: 11.912544250488281
[rfa agg] iter:  0, weight: tensor([0.0520, 0.0593, 0.0565, 0.0459, 0.1126, 0.0766, 0.1690, 0.3025, 0.0721,
        0.0536])
[rfa agg] iter:  1, prev_obj_val: 113.26181030273438, obj_val: 108.2440414428711, abs dis: 5.017768859863281
[rfa agg] iter:  1, weight: tensor([0.0265, 0.0302, 0.0284, 0.0237, 0.1277, 0.0869, 0.1916, 0.3425, 0.0819,
        0.0608])
[rfa agg] iter:  2, prev_obj_val: 108.2440414428711, obj_val: 105.85407257080078, abs dis: 2.3899688720703125
[rfa agg] iter:  2, weight: tensor([0.0137, 0.0154, 0.0145, 0.0123, 0.1354, 0.0922, 0.2030, 0.3619, 0.0869,
        0.0646])
[rfa agg] iter:  3, prev_obj_val: 105.85407257080078, obj_val: 104.67802429199219, abs dis: 1.1760482788085938
[rfa agg] iter:  3, weight: tensor([0.0071, 0.0080, 0.0075, 0.0064, 0.1397, 0.0952, 0.2090, 0.3705, 0.0898,
        0.0669])
[rfa agg] iter:  4, prev_obj_val: 104.67802429199219, obj_val: 104.1098861694336, abs dis: 0.5681381225585938
[rfa agg] iter:  4, weight: tensor([0.0037, 0.0042, 0.0039, 0.0034, 0.1426, 0.0974, 0.2120, 0.3722, 0.0919,
        0.0687])
[rfa agg] iter:  5, prev_obj_val: 104.1098861694336, obj_val: 103.86383819580078, abs dis: 0.2460479736328125
[rfa agg] iter:  5, weight: tensor([0.0020, 0.0023, 0.0021, 0.0018, 0.1457, 0.1002, 0.2128, 0.3676, 0.0943,
        0.0711])
[rfa agg] iter:  6, prev_obj_val: 103.86383819580078, obj_val: 103.78364562988281, abs dis: 0.08019256591796875
[rfa agg] iter:  6, weight: tensor([0.0012, 0.0014, 0.0013, 0.0011, 0.1506, 0.1046, 0.2107, 0.3564, 0.0977,
        0.0749])
[rfa agg] iter:  7, prev_obj_val: 103.78364562988281, obj_val: 103.76712799072266, abs dis: 0.01651763916015625
[rfa agg] iter:  7, weight: tensor([0.0009, 0.0010, 0.0009, 0.0008, 0.1568, 0.1103, 0.2067, 0.3415, 0.1014,
        0.0795])
[rfa agg] iter:  8, prev_obj_val: 103.76712799072266, obj_val: 103.764892578125, abs dis: 0.00223541259765625
[rfa agg] iter:  8, weight: tensor([0.0008, 0.0009, 0.0008, 0.0007, 0.1619, 0.1150, 0.2039, 0.3289, 0.1042,
        0.0830])
[rfa agg] iter:  9, prev_obj_val: 103.764892578125, obj_val: 103.76461029052734, abs dis: 0.00028228759765625
[rfa agg] iter:  9, weight: tensor([0.0007, 0.0008, 0.0008, 0.0007, 0.1650, 0.1176, 0.2030, 0.3207, 0.1058,
        0.0849])
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.0923, Accuracy: 9740/10000 (97.4000%)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 5.6932, Accuracy: 82/8968 (0.9144%)
Done in 102.47655487060547 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:26 choose agents : [41, 73, 51, 74, 11, 13, 82, 50, 34, 14]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   1,  Average loss: 0.0170, Accuracy: 376/606 (62.0462%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   2,  Average loss: 0.0142, Accuracy: 354/606 (58.4158%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   3,  Average loss: 0.0118, Accuracy: 399/606 (65.8416%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   4,  Average loss: 0.0112, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   5,  Average loss: 0.0108, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   6,  Average loss: 0.0109, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   7,  Average loss: 0.0103, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   8,  Average loss: 0.0098, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   9,  Average loss: 0.0100, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch  10,  Average loss: 0.0099, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Global model norm: 16.449531822151314.
Norm before scaling: 16.491165107757794. Distance: 2.500971700655417
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.9989, Accuracy: 6043/10000 (60.4300%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.9071, Accuracy: 4521/8968 (50.4126%)
Scaling by  100
Scaled Norm after poisoning: 249.6614504559124, distance: 250.09715299759011
Total norm for 4 adversaries is: 249.6614504559124. distance: 250.09715299759011
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 10698.4345, Accuracy: 1502/8968 (16.7484%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   1,  Average loss: 0.0190, Accuracy: 341/591 (57.6988%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   2,  Average loss: 0.0213, Accuracy: 241/591 (40.7783%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   3,  Average loss: 0.0139, Accuracy: 322/591 (54.4839%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   4,  Average loss: 0.0137, Accuracy: 354/591 (59.8985%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   5,  Average loss: 0.0133, Accuracy: 359/591 (60.7445%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   6,  Average loss: 0.0131, Accuracy: 361/591 (61.0829%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   7,  Average loss: 0.0128, Accuracy: 380/591 (64.2978%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   8,  Average loss: 0.0119, Accuracy: 388/591 (65.6514%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   9,  Average loss: 0.0113, Accuracy: 410/591 (69.3739%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch  10,  Average loss: 0.0117, Accuracy: 396/591 (67.0051%), train_poison_data_count: 195
Global model norm: 16.449531822151314.
Norm before scaling: 16.480959917277932. Distance: 2.3166741510540203
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.8447, Accuracy: 6265/10000 (62.6500%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.6008, Accuracy: 6713/8968 (74.8550%)
Scaling by  100
Scaled Norm after poisoning: 231.31618140815397, distance: 231.6674188761769
Total norm for 4 adversaries is: 231.31618140815397. distance: 231.6674188761769
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   1,  Average loss: 0.0158, Accuracy: 346/568 (60.9155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   2,  Average loss: 0.0113, Accuracy: 382/568 (67.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   3,  Average loss: 0.0101, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   4,  Average loss: 0.0103, Accuracy: 392/568 (69.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   5,  Average loss: 0.0094, Accuracy: 407/568 (71.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   6,  Average loss: 0.0092, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   7,  Average loss: 0.0088, Accuracy: 402/568 (70.7746%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   8,  Average loss: 0.0082, Accuracy: 424/568 (74.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   9,  Average loss: 0.0075, Accuracy: 446/568 (78.5211%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch  10,  Average loss: 0.0073, Accuracy: 454/568 (79.9296%), train_poison_data_count: 180
Global model norm: 16.449531822151314.
Norm before scaling: 16.484722115717386. Distance: 2.3419784971792548
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.9894, Accuracy: 6437/10000 (64.3700%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.4502, Accuracy: 7571/8968 (84.4224%)
Scaling by  100
Scaled Norm after poisoning: 233.8517074852138, distance: 234.19784971792546
Total norm for 4 adversaries is: 233.8517074852138. distance: 234.19784971792546
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   1,  Average loss: 0.0152, Accuracy: 358/557 (64.2729%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   2,  Average loss: 0.0078, Accuracy: 451/557 (80.9695%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   3,  Average loss: 0.0035, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   4,  Average loss: 0.0033, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   5,  Average loss: 0.0028, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   6,  Average loss: 0.0024, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   7,  Average loss: 0.0019, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   8,  Average loss: 0.0018, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch  10,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Global model norm: 16.449531822151314.
Norm before scaling: 16.619816251581366. Distance: 2.5626300685715777
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.4631, Accuracy: 8571/10000 (85.7100%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0824, Accuracy: 8643/8968 (96.3760%)
Scaling by  100
Scaled Norm after poisoning: 256.60811866053655, distance: 256.26301796201494
Total norm for 4 adversaries is: 256.60811866053655. distance: 256.26301796201494
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  26, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 628/645 (97.3643%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1761, Accuracy: 9451/10000 (94.5100%)
___Train Local_Simple,  epoch  26, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 724/734 (98.6376%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2245, Accuracy: 9314/10000 (93.1400%)
___Train Local_Simple,  epoch  26, local model 82, internal_epoch   1,  Average loss: 0.0015, Accuracy: 697/713 (97.7560%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.5042, Accuracy: 8405/10000 (84.0500%)
___Train Local_Simple,  epoch  26, local model 50, internal_epoch   1,  Average loss: 0.0022, Accuracy: 457/474 (96.4135%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2048, Accuracy: 9359/10000 (93.5900%)
___Train Local_Simple,  epoch  26, local model 34, internal_epoch   1,  Average loss: 0.0008, Accuracy: 408/413 (98.7893%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1812, Accuracy: 9436/10000 (94.3600%)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0012, Accuracy: 370/376 (98.4043%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.0992, Accuracy: 9714/10000 (97.1400%)
time spent on training: 85.27252388000488
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4090188479830897  data num: [606, 591, 568, 557, 645, 734, 713, 474, 413, 376]
[rfa agg] considering poison per batch poison_fraction: 0.12781838999471554
[rfa agg] init. name: [41, 73, 51, 74, 11, 13, 82, 50, 34, 14], weight: tensor([0.1067, 0.1041, 0.1001, 0.0981, 0.1136, 0.1293, 0.1256, 0.0835, 0.0727,
        0.0662])
[rfa agg] iter:  0, prev_obj_val: 122.91574096679688, obj_val: 109.29481506347656, abs dis: 13.620925903320312
[rfa agg] iter:  0, weight: tensor([0.0457, 0.0498, 0.0471, 0.0401, 0.1569, 0.1789, 0.1735, 0.1156, 0.1008,
        0.0918])
[rfa agg] iter:  1, prev_obj_val: 109.29481506347656, obj_val: 103.84549713134766, abs dis: 5.449317932128906
[rfa agg] iter:  1, weight: tensor([0.0210, 0.0226, 0.0214, 0.0187, 0.1757, 0.2006, 0.1942, 0.1297, 0.1131,
        0.1032])
[rfa agg] iter:  2, prev_obj_val: 103.84549713134766, obj_val: 101.46015930175781, abs dis: 2.3853378295898438
[rfa agg] iter:  2, weight: tensor([0.0097, 0.0103, 0.0098, 0.0087, 0.1837, 0.2106, 0.2030, 0.1363, 0.1191,
        0.1088])
[rfa agg] iter:  3, prev_obj_val: 101.46015930175781, obj_val: 100.40165710449219, abs dis: 1.058502197265625
[rfa agg] iter:  3, weight: tensor([0.0045, 0.0048, 0.0045, 0.0040, 0.1862, 0.2155, 0.2054, 0.1399, 0.1227,
        0.1126])
[rfa agg] iter:  4, prev_obj_val: 100.40165710449219, obj_val: 99.9551773071289, abs dis: 0.44647979736328125
[rfa agg] iter:  4, weight: tensor([0.0021, 0.0022, 0.0021, 0.0019, 0.1847, 0.2183, 0.2024, 0.1428, 0.1263,
        0.1170])
[rfa agg] iter:  5, prev_obj_val: 99.9551773071289, obj_val: 99.8025131225586, abs dis: 0.1526641845703125
[rfa agg] iter:  5, weight: tensor([0.0011, 0.0011, 0.0011, 0.0010, 0.1792, 0.2204, 0.1915, 0.1472, 0.1321,
        0.1253])
[rfa agg] iter:  6, prev_obj_val: 99.8025131225586, obj_val: 99.77056884765625, abs dis: 0.03194427490234375
[rfa agg] iter:  6, weight: tensor([0.0007, 0.0007, 0.0007, 0.0006, 0.1711, 0.2217, 0.1739, 0.1528, 0.1403,
        0.1377])
[rfa agg] iter:  7, prev_obj_val: 99.77056884765625, obj_val: 99.76710510253906, abs dis: 0.0034637451171875
[rfa agg] iter:  7, weight: tensor([0.0005, 0.0006, 0.0005, 0.0005, 0.1658, 0.2226, 0.1607, 0.1558, 0.1467,
        0.1463])
[rfa agg] iter:  8, prev_obj_val: 99.76710510253906, obj_val: 99.76686096191406, abs dis: 0.000244140625
[rfa agg] iter:  8, weight: tensor([0.0005, 0.0005, 0.0005, 0.0004, 0.1638, 0.2235, 0.1551, 0.1561, 0.1500,
        0.1495])
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 0.0912, Accuracy: 9740/10000 (97.4000%)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 5.7256, Accuracy: 83/8968 (0.9255%)
Done in 104.0157380104065 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:27 choose agents : [41, 73, 51, 74, 55, 58, 53, 14, 36, 6]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   1,  Average loss: 0.0164, Accuracy: 376/606 (62.0462%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   2,  Average loss: 0.0128, Accuracy: 351/606 (57.9208%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   3,  Average loss: 0.0111, Accuracy: 403/606 (66.5017%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   4,  Average loss: 0.0105, Accuracy: 403/606 (66.5017%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   5,  Average loss: 0.0103, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   6,  Average loss: 0.0102, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Global model norm: 16.44866540938808.
Norm before scaling: 16.48218939154237. Distance: 2.2963602955535154
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.8971, Accuracy: 6283/10000 (62.8300%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.9214, Accuracy: 4312/8968 (48.0821%)
Scaling by  100
Scaled Norm after poisoning: 229.31710781688312, distance: 229.63604015376157
Total norm for 4 adversaries is: 229.31710781688312. distance: 229.63604015376157
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 113.9166, Accuracy: 7777/8968 (86.7194%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   1,  Average loss: 0.0202, Accuracy: 331/591 (56.0068%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   2,  Average loss: 0.0189, Accuracy: 283/591 (47.8849%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   3,  Average loss: 0.0155, Accuracy: 303/591 (51.2690%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   4,  Average loss: 0.0151, Accuracy: 335/591 (56.6836%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   5,  Average loss: 0.0143, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   6,  Average loss: 0.0140, Accuracy: 371/591 (62.7750%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   7,  Average loss: 0.0127, Accuracy: 382/591 (64.6362%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   8,  Average loss: 0.0129, Accuracy: 354/591 (59.8985%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   9,  Average loss: 0.0120, Accuracy: 372/591 (62.9442%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch  10,  Average loss: 0.0120, Accuracy: 385/591 (65.1438%), train_poison_data_count: 195
Global model norm: 16.44866540938808.
Norm before scaling: 16.5195372539301. Distance: 2.8227476137411482
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.9535, Accuracy: 5715/10000 (57.1500%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.5551, Accuracy: 7317/8968 (81.5901%)
Scaling by  100
Scaled Norm after poisoning: 281.75603088044096, distance: 282.27475810369583
Total norm for 4 adversaries is: 281.75603088044096. distance: 282.27475810369583
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   1,  Average loss: 0.0150, Accuracy: 347/568 (61.0915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   2,  Average loss: 0.0112, Accuracy: 376/568 (66.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   3,  Average loss: 0.0099, Accuracy: 404/568 (71.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   4,  Average loss: 0.0092, Accuracy: 416/568 (73.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   5,  Average loss: 0.0084, Accuracy: 417/568 (73.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   6,  Average loss: 0.0078, Accuracy: 421/568 (74.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   7,  Average loss: 0.0066, Accuracy: 493/568 (86.7958%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   8,  Average loss: 0.0057, Accuracy: 496/568 (87.3239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   9,  Average loss: 0.0049, Accuracy: 519/568 (91.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch  10,  Average loss: 0.0044, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Global model norm: 16.44866540938808.
Norm before scaling: 16.500639931956048. Distance: 2.183863969437111
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.8113, Accuracy: 7048/10000 (70.4800%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.2010, Accuracy: 8459/8968 (94.3243%)
Scaling by  100
Scaled Norm after poisoning: 218.30597793006035, distance: 218.38640317966227
Total norm for 4 adversaries is: 218.30597793006035. distance: 218.38640317966227
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   1,  Average loss: 0.0160, Accuracy: 370/557 (66.4273%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   2,  Average loss: 0.0080, Accuracy: 463/557 (83.1239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   3,  Average loss: 0.0038, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   4,  Average loss: 0.0027, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   5,  Average loss: 0.0030, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   6,  Average loss: 0.0022, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   7,  Average loss: 0.0020, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   8,  Average loss: 0.0019, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch  10,  Average loss: 0.0018, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Global model norm: 16.44866540938808.
Norm before scaling: 16.637701474409333. Distance: 2.582828369830347
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.4717, Accuracy: 8569/10000 (85.6900%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1012, Accuracy: 8578/8968 (95.6512%)
Scaling by  100
Scaled Norm after poisoning: 258.72560271453614, distance: 258.2828361264062
Total norm for 4 adversaries is: 258.72560271453614. distance: 258.2828361264062
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  27, local model 55, internal_epoch   1,  Average loss: 0.0019, Accuracy: 343/354 (96.8927%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2177, Accuracy: 9302/10000 (93.0200%)
___Train Local_Simple,  epoch  27, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 268/276 (97.1014%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1459, Accuracy: 9553/10000 (95.5300%)
___Train Local_Simple,  epoch  27, local model 53, internal_epoch   1,  Average loss: 0.0011, Accuracy: 727/739 (98.3762%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2656, Accuracy: 9185/10000 (91.8500%)
___Train Local_Simple,  epoch  27, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 371/376 (98.6702%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1171, Accuracy: 9651/10000 (96.5100%)
___Train Local_Simple,  epoch  27, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 983/1005 (97.8109%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3280, Accuracy: 9023/10000 (90.2300%)
___Train Local_Simple,  epoch  27, local model 6, internal_epoch   1,  Average loss: 0.0013, Accuracy: 598/615 (97.2358%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1656, Accuracy: 9496/10000 (94.9600%)
time spent on training: 84.68220520019531
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.40829963073676806  data num: [606, 591, 568, 557, 354, 276, 739, 376, 1005, 615]
[rfa agg] considering poison per batch poison_fraction: 0.12759363460524
[rfa agg] init. name: [41, 73, 51, 74, 55, 58, 53, 14, 36, 6], weight: tensor([0.1066, 0.1039, 0.0999, 0.0979, 0.0622, 0.0485, 0.1299, 0.0661, 0.1767,
        0.1081])
[rfa agg] iter:  0, prev_obj_val: 124.93992614746094, obj_val: 110.82378387451172, abs dis: 14.116142272949219
[rfa agg] iter:  0, weight: tensor([0.0498, 0.0399, 0.0515, 0.0401, 0.0862, 0.0672, 0.1799, 0.0916, 0.2442,
        0.1495])
[rfa agg] iter:  1, prev_obj_val: 110.82378387451172, obj_val: 105.29901123046875, abs dis: 5.524772644042969
[rfa agg] iter:  1, weight: tensor([0.0227, 0.0179, 0.0229, 0.0184, 0.0969, 0.0754, 0.2020, 0.1029, 0.2734,
        0.1675])
[rfa agg] iter:  2, prev_obj_val: 105.29901123046875, obj_val: 102.91822814941406, abs dis: 2.3807830810546875
[rfa agg] iter:  2, weight: tensor([0.0103, 0.0082, 0.0103, 0.0084, 0.1020, 0.0793, 0.2123, 0.1083, 0.2856,
        0.1754])
[rfa agg] iter:  3, prev_obj_val: 102.91822814941406, obj_val: 101.88130187988281, abs dis: 1.03692626953125
[rfa agg] iter:  3, weight: tensor([0.0047, 0.0037, 0.0047, 0.0038, 0.1051, 0.0814, 0.2178, 0.1116, 0.2889,
        0.1783])
[rfa agg] iter:  4, prev_obj_val: 101.88130187988281, obj_val: 101.459228515625, abs dis: 0.4220733642578125
[rfa agg] iter:  4, weight: tensor([0.0022, 0.0017, 0.0022, 0.0018, 0.1082, 0.0830, 0.2220, 0.1156, 0.2848,
        0.1785])
[rfa agg] iter:  5, prev_obj_val: 101.459228515625, obj_val: 101.32677459716797, abs dis: 0.13245391845703125
[rfa agg] iter:  5, weight: tensor([0.0011, 0.0009, 0.0011, 0.0009, 0.1129, 0.0849, 0.2264, 0.1244, 0.2709,
        0.1765])
[rfa agg] iter:  6, prev_obj_val: 101.32677459716797, obj_val: 101.30274200439453, abs dis: 0.0240325927734375
[rfa agg] iter:  6, weight: tensor([0.0007, 0.0006, 0.0007, 0.0006, 0.1176, 0.0862, 0.2290, 0.1400, 0.2502,
        0.1744])
[rfa agg] iter:  7, prev_obj_val: 101.30274200439453, obj_val: 101.30036926269531, abs dis: 0.00237274169921875
[rfa agg] iter:  7, weight: tensor([0.0006, 0.0005, 0.0006, 0.0005, 0.1199, 0.0868, 0.2288, 0.1532, 0.2349,
        0.1743])
[rfa agg] iter:  8, prev_obj_val: 101.30036926269531, obj_val: 101.30020141601562, abs dis: 0.0001678466796875
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0005, 0.0006, 0.0005, 0.1207, 0.0873, 0.2281, 0.1593, 0.2275,
        0.1752])
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 0.0921, Accuracy: 9736/10000 (97.3600%)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 5.6875, Accuracy: 89/8968 (0.9924%)
Done in 101.55767631530762 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:28 choose agents : [41, 73, 51, 74, 47, 92, 37, 43, 17, 2]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   1,  Average loss: 0.0158, Accuracy: 381/606 (62.8713%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   2,  Average loss: 0.0121, Accuracy: 391/606 (64.5215%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   3,  Average loss: 0.0104, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   4,  Average loss: 0.0105, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   5,  Average loss: 0.0100, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   6,  Average loss: 0.0103, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   9,  Average loss: 0.0095, Accuracy: 441/606 (72.7723%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch  10,  Average loss: 0.0095, Accuracy: 438/606 (72.2772%), train_poison_data_count: 200
Global model norm: 16.448144055518657.
Norm before scaling: 16.481243222943714. Distance: 2.3379942345984572
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.9815, Accuracy: 6013/10000 (60.1300%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.9469, Accuracy: 4805/8968 (53.5794%)
Scaling by  100
Scaled Norm after poisoning: 233.44183396244557, distance: 233.79941823869024
Total norm for 4 adversaries is: 233.44183396244557. distance: 233.79941823869024
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 1094.4157, Accuracy: 6867/8968 (76.5723%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   1,  Average loss: 0.0201, Accuracy: 341/591 (57.6988%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   2,  Average loss: 0.0216, Accuracy: 240/591 (40.6091%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   3,  Average loss: 0.0147, Accuracy: 301/591 (50.9306%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   4,  Average loss: 0.0151, Accuracy: 340/591 (57.5296%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   5,  Average loss: 0.0138, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   6,  Average loss: 0.0132, Accuracy: 374/591 (63.2826%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   7,  Average loss: 0.0127, Accuracy: 371/591 (62.7750%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   8,  Average loss: 0.0118, Accuracy: 428/591 (72.4196%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   9,  Average loss: 0.0108, Accuracy: 444/591 (75.1269%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch  10,  Average loss: 0.0104, Accuracy: 458/591 (77.4958%), train_poison_data_count: 195
Global model norm: 16.448144055518657.
Norm before scaling: 16.530898322996073. Distance: 3.0221357672922746
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.0281, Accuracy: 5392/10000 (53.9200%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.4577, Accuracy: 7647/8968 (85.2698%)
Scaling by  100
Scaled Norm after poisoning: 301.60102733163893, distance: 302.2135911693913
Total norm for 4 adversaries is: 301.60102733163893. distance: 302.2135911693913
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0161, Accuracy: 351/568 (61.7958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   2,  Average loss: 0.0121, Accuracy: 334/568 (58.8028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   3,  Average loss: 0.0110, Accuracy: 400/568 (70.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   4,  Average loss: 0.0100, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   5,  Average loss: 0.0096, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   6,  Average loss: 0.0090, Accuracy: 402/568 (70.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   7,  Average loss: 0.0087, Accuracy: 402/568 (70.7746%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   8,  Average loss: 0.0083, Accuracy: 404/568 (71.1268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   9,  Average loss: 0.0079, Accuracy: 440/568 (77.4648%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch  10,  Average loss: 0.0080, Accuracy: 422/568 (74.2958%), train_poison_data_count: 180
Global model norm: 16.448144055518657.
Norm before scaling: 16.49293505529811. Distance: 2.307101055966163
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.0124, Accuracy: 5967/10000 (59.6700%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.4583, Accuracy: 7531/8968 (83.9764%)
Scaling by  100
Scaled Norm after poisoning: 230.46251898356488, distance: 230.7101045549371
Total norm for 4 adversaries is: 230.46251898356488. distance: 230.7101045549371
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   1,  Average loss: 0.0152, Accuracy: 366/557 (65.7092%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   2,  Average loss: 0.0078, Accuracy: 446/557 (80.0718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   3,  Average loss: 0.0035, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   4,  Average loss: 0.0030, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   5,  Average loss: 0.0022, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   6,  Average loss: 0.0023, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   7,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   8,  Average loss: 0.0018, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   9,  Average loss: 0.0018, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Global model norm: 16.448144055518657.
Norm before scaling: 16.632495079756524. Distance: 2.5570869027155787
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.4257, Accuracy: 8740/10000 (87.4000%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0630, Accuracy: 8736/8968 (97.4130%)
Scaling by  100
Scaled Norm after poisoning: 256.1512309652249, distance: 255.70868892892554
Total norm for 4 adversaries is: 256.1512309652249. distance: 255.70868892892554
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  28, local model 47, internal_epoch   1,  Average loss: 0.0014, Accuracy: 757/776 (97.5515%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2141, Accuracy: 9330/10000 (93.3000%)
___Train Local_Simple,  epoch  28, local model 92, internal_epoch   1,  Average loss: 0.0012, Accuracy: 916/937 (97.7588%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.7580, Accuracy: 7820/10000 (78.2000%)
___Train Local_Simple,  epoch  28, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 843/860 (98.0233%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3458, Accuracy: 9046/10000 (90.4600%)
___Train Local_Simple,  epoch  28, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 401/408 (98.2843%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2299, Accuracy: 9223/10000 (92.2300%)
___Train Local_Simple,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0015, Accuracy: 603/620 (97.2581%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1242, Accuracy: 9619/10000 (96.1900%)
___Train Local_Simple,  epoch  28, local model 2, internal_epoch   1,  Average loss: 0.0012, Accuracy: 541/548 (98.7226%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1395, Accuracy: 9571/10000 (95.7100%)
time spent on training: 85.31837701797485
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3588317107093185  data num: [606, 591, 568, 557, 776, 937, 860, 408, 620, 548]
[rfa agg] considering poison per batch poison_fraction: 0.11213490959666203
[rfa agg] init. name: [41, 73, 51, 74, 47, 92, 37, 43, 17, 2], weight: tensor([0.0936, 0.0913, 0.0878, 0.0861, 0.1199, 0.1448, 0.1329, 0.0631, 0.0958,
        0.0847])
[rfa agg] iter:  0, prev_obj_val: 117.85870361328125, obj_val: 100.80538177490234, abs dis: 17.053321838378906
[rfa agg] iter:  0, weight: tensor([0.0371, 0.0279, 0.0361, 0.0305, 0.1622, 0.1959, 0.1802, 0.0855, 0.1298,
        0.1149])
[rfa agg] iter:  1, prev_obj_val: 100.80538177490234, obj_val: 95.04717254638672, abs dis: 5.758209228515625
[rfa agg] iter:  1, weight: tensor([0.0135, 0.0101, 0.0130, 0.0113, 0.1772, 0.2142, 0.1981, 0.0939, 0.1423,
        0.1263])
[rfa agg] iter:  2, prev_obj_val: 95.04717254638672, obj_val: 93.03054809570312, abs dis: 2.0166244506835938
[rfa agg] iter:  2, weight: tensor([0.0049, 0.0037, 0.0047, 0.0041, 0.1814, 0.2194, 0.2058, 0.0974, 0.1471,
        0.1315])
[rfa agg] iter:  3, prev_obj_val: 93.03054809570312, obj_val: 92.38972473144531, abs dis: 0.6408233642578125
[rfa agg] iter:  3, weight: tensor([0.0018, 0.0014, 0.0017, 0.0015, 0.1793, 0.2163, 0.2108, 0.1008, 0.1498,
        0.1366])
[rfa agg] iter:  4, prev_obj_val: 92.38972473144531, obj_val: 92.25933837890625, abs dis: 0.1303863525390625
[rfa agg] iter:  4, weight: tensor([0.0008, 0.0006, 0.0008, 0.0007, 0.1720, 0.2026, 0.2120, 0.1094, 0.1544,
        0.1468])
[rfa agg] iter:  5, prev_obj_val: 92.25933837890625, obj_val: 92.24872589111328, abs dis: 0.01061248779296875
[rfa agg] iter:  5, weight: tensor([0.0005, 0.0004, 0.0005, 0.0005, 0.1666, 0.1872, 0.2042, 0.1223, 0.1606,
        0.1571])
[rfa agg] iter:  6, prev_obj_val: 92.24872589111328, obj_val: 92.24833679199219, abs dis: 0.00038909912109375
[rfa agg] iter:  6, weight: tensor([0.0005, 0.0004, 0.0005, 0.0004, 0.1659, 0.1805, 0.1985, 0.1286, 0.1640,
        0.1608])
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 0.0900, Accuracy: 9744/10000 (97.4400%)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 5.7285, Accuracy: 83/8968 (0.9255%)
Done in 102.92815828323364 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:29 choose agents : [41, 73, 51, 74, 66, 6, 38, 37, 45, 81]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   1,  Average loss: 0.0163, Accuracy: 372/606 (61.3861%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   2,  Average loss: 0.0125, Accuracy: 375/606 (61.8812%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   3,  Average loss: 0.0109, Accuracy: 400/606 (66.0066%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   4,  Average loss: 0.0104, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   5,  Average loss: 0.0102, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   6,  Average loss: 0.0100, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   7,  Average loss: 0.0095, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch  10,  Average loss: 0.0094, Accuracy: 437/606 (72.1122%), train_poison_data_count: 200
Global model norm: 16.44662813917909.
Norm before scaling: 16.461812536068326. Distance: 2.2246030517702606
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.8600, Accuracy: 6406/10000 (64.0600%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.9827, Accuracy: 4417/8968 (49.2529%)
Scaling by  100
Scaled Norm after poisoning: 222.0679266857328, distance: 222.46030193609826
Total norm for 4 adversaries is: 222.0679266857328. distance: 222.46030193609826
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 116.3386, Accuracy: 8711/8968 (97.1343%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   1,  Average loss: 0.0192, Accuracy: 352/591 (59.5601%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   2,  Average loss: 0.0196, Accuracy: 260/591 (43.9932%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   3,  Average loss: 0.0151, Accuracy: 341/591 (57.6988%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   4,  Average loss: 0.0147, Accuracy: 318/591 (53.8071%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   5,  Average loss: 0.0132, Accuracy: 357/591 (60.4061%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   6,  Average loss: 0.0127, Accuracy: 373/591 (63.1134%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   7,  Average loss: 0.0124, Accuracy: 369/591 (62.4365%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   8,  Average loss: 0.0117, Accuracy: 385/591 (65.1438%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   9,  Average loss: 0.0112, Accuracy: 394/591 (66.6667%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch  10,  Average loss: 0.0115, Accuracy: 379/591 (64.1286%), train_poison_data_count: 195
Global model norm: 16.44662813917909.
Norm before scaling: 16.513473096268147. Distance: 2.6106756018478237
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.9338, Accuracy: 5443/10000 (54.4300%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.4968, Accuracy: 7379/8968 (82.2814%)
Scaling by  100
Scaled Norm after poisoning: 260.70198203600216, distance: 261.06756488981927
Total norm for 4 adversaries is: 260.70198203600216. distance: 261.06756488981927
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   1,  Average loss: 0.0157, Accuracy: 341/568 (60.0352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   2,  Average loss: 0.0109, Accuracy: 370/568 (65.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   3,  Average loss: 0.0096, Accuracy: 398/568 (70.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   4,  Average loss: 0.0094, Accuracy: 404/568 (71.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   5,  Average loss: 0.0090, Accuracy: 408/568 (71.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   6,  Average loss: 0.0082, Accuracy: 416/568 (73.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   7,  Average loss: 0.0077, Accuracy: 423/568 (74.4718%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   8,  Average loss: 0.0074, Accuracy: 447/568 (78.6972%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   9,  Average loss: 0.0069, Accuracy: 475/568 (83.6268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch  10,  Average loss: 0.0072, Accuracy: 452/568 (79.5775%), train_poison_data_count: 180
Global model norm: 16.44662813917909.
Norm before scaling: 16.516682831839393. Distance: 2.337681556219447
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.8927, Accuracy: 6710/10000 (67.1000%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.3770, Accuracy: 7798/8968 (86.9536%)
Scaling by  100
Scaled Norm after poisoning: 233.67177835588106, distance: 233.76816440118617
Total norm for 4 adversaries is: 233.67177835588106. distance: 233.76816440118617
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   1,  Average loss: 0.0170, Accuracy: 349/557 (62.6571%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   2,  Average loss: 0.0083, Accuracy: 453/557 (81.3285%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   3,  Average loss: 0.0040, Accuracy: 515/557 (92.4596%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   4,  Average loss: 0.0033, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   5,  Average loss: 0.0025, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   7,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   9,  Average loss: 0.0020, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Global model norm: 16.44662813917909.
Norm before scaling: 16.64396423362404. Distance: 2.770400756875931
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.5476, Accuracy: 8225/10000 (82.2500%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0696, Accuracy: 8709/8968 (97.1120%)
Scaling by  100
Scaled Norm after poisoning: 277.32145156839204, distance: 277.04007494404124
Total norm for 4 adversaries is: 277.32145156839204. distance: 277.04007494404124
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  29, local model 66, internal_epoch   1,  Average loss: 0.0014, Accuracy: 648/660 (98.1818%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1618, Accuracy: 9468/10000 (94.6800%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   1,  Average loss: 0.0012, Accuracy: 602/615 (97.8862%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3565, Accuracy: 8975/10000 (89.7500%)
___Train Local_Simple,  epoch  29, local model 38, internal_epoch   1,  Average loss: 0.0016, Accuracy: 865/895 (96.6480%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.7044, Accuracy: 8102/10000 (81.0200%)
___Train Local_Simple,  epoch  29, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 840/860 (97.6744%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2005, Accuracy: 9425/10000 (94.2500%)
___Train Local_Simple,  epoch  29, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 615/628 (97.9299%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2620, Accuracy: 9126/10000 (91.2600%)
___Train Local_Simple,  epoch  29, local model 81, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1209/1227 (98.5330%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3505, Accuracy: 9082/10000 (90.8200%)
time spent on training: 83.591721534729
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3221867628694325  data num: [606, 591, 568, 557, 660, 615, 895, 860, 628, 1227]
[rfa agg] considering poison per batch poison_fraction: 0.10068336339669764
[rfa agg] init. name: [41, 73, 51, 74, 66, 6, 38, 37, 45, 81], weight: tensor([0.0841, 0.0820, 0.0788, 0.0773, 0.0916, 0.0853, 0.1242, 0.1193, 0.0871,
        0.1703])
[rfa agg] iter:  0, prev_obj_val: 105.472900390625, obj_val: 87.77316284179688, abs dis: 17.699737548828125
[rfa agg] iter:  0, weight: tensor([0.0295, 0.0245, 0.0268, 0.0214, 0.1213, 0.1131, 0.1645, 0.1585, 0.1155,
        0.2249])
[rfa agg] iter:  1, prev_obj_val: 87.77316284179688, obj_val: 82.44515991210938, abs dis: 5.3280029296875
[rfa agg] iter:  1, weight: tensor([0.0093, 0.0076, 0.0083, 0.0067, 0.1310, 0.1221, 0.1771, 0.1720, 0.1248,
        0.2411])
[rfa agg] iter:  2, prev_obj_val: 82.44515991210938, obj_val: 80.90259552001953, abs dis: 1.5425643920898438
[rfa agg] iter:  2, weight: tensor([0.0029, 0.0024, 0.0026, 0.0021, 0.1346, 0.1256, 0.1795, 0.1796, 0.1289,
        0.2417])
[rfa agg] iter:  3, prev_obj_val: 80.90259552001953, obj_val: 80.5911865234375, abs dis: 0.31140899658203125
[rfa agg] iter:  3, weight: tensor([0.0010, 0.0008, 0.0009, 0.0008, 0.1393, 0.1289, 0.1703, 0.1925, 0.1365,
        0.2291])
[rfa agg] iter:  4, prev_obj_val: 80.5911865234375, obj_val: 80.56785583496094, abs dis: 0.0233306884765625
[rfa agg] iter:  4, weight: tensor([0.0006, 0.0005, 0.0005, 0.0004, 0.1474, 0.1327, 0.1498, 0.2041, 0.1513,
        0.2127])
[rfa agg] iter:  5, prev_obj_val: 80.56785583496094, obj_val: 80.5672607421875, abs dis: 0.0005950927734375
[rfa agg] iter:  5, weight: tensor([0.0005, 0.0004, 0.0005, 0.0004, 0.1514, 0.1349, 0.1407, 0.2059, 0.1586,
        0.2067])
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.0878, Accuracy: 9746/10000 (97.4600%)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 5.8129, Accuracy: 78/8968 (0.8698%)
Done in 99.17728900909424 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:30 choose agents : [41, 73, 51, 74, 4, 24, 38, 54, 10, 11]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   1,  Average loss: 0.0163, Accuracy: 384/606 (63.3663%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   2,  Average loss: 0.0131, Accuracy: 361/606 (59.5710%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   3,  Average loss: 0.0110, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   4,  Average loss: 0.0103, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   5,  Average loss: 0.0104, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   6,  Average loss: 0.0103, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   7,  Average loss: 0.0100, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   8,  Average loss: 0.0099, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   9,  Average loss: 0.0099, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch  10,  Average loss: 0.0095, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Global model norm: 16.446115070974493.
Norm before scaling: 16.457794772965862. Distance: 2.2504906649172396
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.9302, Accuracy: 6174/10000 (61.7400%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.9436, Accuracy: 4554/8968 (50.7806%)
Scaling by  100
Scaled Norm after poisoning: 224.60970489106208, distance: 225.04907450931674
Total norm for 4 adversaries is: 224.60970489106208. distance: 225.04907450931674
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 1241.1397, Accuracy: 5508/8968 (61.4184%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   1,  Average loss: 0.0222, Accuracy: 337/591 (57.0220%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   2,  Average loss: 0.0191, Accuracy: 257/591 (43.4856%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   3,  Average loss: 0.0143, Accuracy: 344/591 (58.2064%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   4,  Average loss: 0.0136, Accuracy: 366/591 (61.9289%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   5,  Average loss: 0.0136, Accuracy: 358/591 (60.5753%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   6,  Average loss: 0.0130, Accuracy: 366/591 (61.9289%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   7,  Average loss: 0.0126, Accuracy: 374/591 (63.2826%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   8,  Average loss: 0.0126, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   9,  Average loss: 0.0117, Accuracy: 378/591 (63.9594%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch  10,  Average loss: 0.0121, Accuracy: 365/591 (61.7597%), train_poison_data_count: 195
Global model norm: 16.446115070974493.
Norm before scaling: 16.536810302192595. Distance: 2.642648136313891
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.8620, Accuracy: 6283/10000 (62.8300%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.6624, Accuracy: 6105/8968 (68.0754%)
Scaling by  100
Scaled Norm after poisoning: 264.02112841589025, distance: 264.2648115527302
Total norm for 4 adversaries is: 264.02112841589025. distance: 264.2648115527302
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   1,  Average loss: 0.0154, Accuracy: 353/568 (62.1479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   2,  Average loss: 0.0117, Accuracy: 376/568 (66.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   3,  Average loss: 0.0103, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   4,  Average loss: 0.0106, Accuracy: 376/568 (66.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   5,  Average loss: 0.0097, Accuracy: 390/568 (68.6620%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   6,  Average loss: 0.0094, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   7,  Average loss: 0.0082, Accuracy: 430/568 (75.7042%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   8,  Average loss: 0.0073, Accuracy: 462/568 (81.3380%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   9,  Average loss: 0.0068, Accuracy: 468/568 (82.3944%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch  10,  Average loss: 0.0071, Accuracy: 461/568 (81.1620%), train_poison_data_count: 180
Global model norm: 16.446115070974493.
Norm before scaling: 16.47525295590139. Distance: 2.3518085541109013
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.1047, Accuracy: 5296/10000 (52.9600%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.2414, Accuracy: 8706/8968 (97.0785%)
Scaling by  100
Scaled Norm after poisoning: 234.78358552345605, distance: 235.1808562707645
Total norm for 4 adversaries is: 234.78358552345605. distance: 235.1808562707645
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   1,  Average loss: 0.0169, Accuracy: 355/557 (63.7343%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   2,  Average loss: 0.0084, Accuracy: 431/557 (77.3788%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   3,  Average loss: 0.0040, Accuracy: 515/557 (92.4596%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   4,  Average loss: 0.0036, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   5,  Average loss: 0.0025, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   6,  Average loss: 0.0022, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   7,  Average loss: 0.0023, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   8,  Average loss: 0.0019, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.446115070974493.
Norm before scaling: 16.647648349140507. Distance: 2.7751371951168813
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.4303, Accuracy: 8719/10000 (87.1900%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1241, Accuracy: 8437/8968 (94.0789%)
Scaling by  100
Scaled Norm after poisoning: 277.81495358871524, distance: 277.51371024689934
Total norm for 4 adversaries is: 277.81495358871524. distance: 277.51371024689934
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  30, local model 4, internal_epoch   1,  Average loss: 0.0014, Accuracy: 642/658 (97.5684%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2300, Accuracy: 9179/10000 (91.7900%)
___Train Local_Simple,  epoch  30, local model 24, internal_epoch   1,  Average loss: 0.0017, Accuracy: 364/379 (96.0422%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1227, Accuracy: 9617/10000 (96.1700%)
___Train Local_Simple,  epoch  30, local model 38, internal_epoch   1,  Average loss: 0.0017, Accuracy: 868/895 (96.9832%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3672, Accuracy: 8694/10000 (86.9400%)
___Train Local_Simple,  epoch  30, local model 54, internal_epoch   1,  Average loss: 0.0020, Accuracy: 504/519 (97.1098%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.4747, Accuracy: 8739/10000 (87.3900%)
___Train Local_Simple,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0015, Accuracy: 866/892 (97.0852%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1632, Accuracy: 9474/10000 (94.7400%)
___Train Local_Simple,  epoch  30, local model 11, internal_epoch   1,  Average loss: 0.0017, Accuracy: 625/645 (96.8992%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1735, Accuracy: 9454/10000 (94.5400%)
time spent on training: 84.0804169178009
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.36798732171156895  data num: [606, 591, 568, 557, 658, 379, 895, 519, 892, 645]
[rfa agg] considering poison per batch poison_fraction: 0.1149960380348653
[rfa agg] init. name: [41, 73, 51, 74, 4, 24, 38, 54, 10, 11], weight: tensor([0.0960, 0.0937, 0.0900, 0.0883, 0.1043, 0.0601, 0.1418, 0.0823, 0.1414,
        0.1022])
[rfa agg] iter:  0, prev_obj_val: 117.40934753417969, obj_val: 101.34940338134766, abs dis: 16.05994415283203
[rfa agg] iter:  0, weight: tensor([0.0406, 0.0337, 0.0379, 0.0294, 0.1415, 0.0816, 0.1927, 0.1118, 0.1921,
        0.1386])
[rfa agg] iter:  1, prev_obj_val: 101.34940338134766, obj_val: 95.61106872558594, abs dis: 5.738334655761719
[rfa agg] iter:  1, weight: tensor([0.0158, 0.0130, 0.0143, 0.0115, 0.1557, 0.0900, 0.2124, 0.1233, 0.2117,
        0.1522])
[rfa agg] iter:  2, prev_obj_val: 95.61106872558594, obj_val: 93.47724151611328, abs dis: 2.1338272094726562
[rfa agg] iter:  2, weight: tensor([0.0061, 0.0050, 0.0055, 0.0045, 0.1610, 0.0937, 0.2201, 0.1281, 0.2196,
        0.1565])
[rfa agg] iter:  3, prev_obj_val: 93.47724151611328, obj_val: 92.73934173583984, abs dis: 0.7378997802734375
[rfa agg] iter:  3, weight: tensor([0.0024, 0.0020, 0.0022, 0.0018, 0.1628, 0.0967, 0.2225, 0.1300, 0.2234,
        0.1563])
[rfa agg] iter:  4, prev_obj_val: 92.73934173583984, obj_val: 92.5590591430664, abs dis: 0.1802825927734375
[rfa agg] iter:  4, weight: tensor([0.0011, 0.0009, 0.0010, 0.0008, 0.1655, 0.1042, 0.2178, 0.1278, 0.2260,
        0.1550])
[rfa agg] iter:  5, prev_obj_val: 92.5590591430664, obj_val: 92.53852081298828, abs dis: 0.020538330078125
[rfa agg] iter:  5, weight: tensor([0.0007, 0.0006, 0.0006, 0.0005, 0.1720, 0.1185, 0.2043, 0.1197, 0.2258,
        0.1574])
[rfa agg] iter:  6, prev_obj_val: 92.53852081298828, obj_val: 92.53739166259766, abs dis: 0.001129150390625
[rfa agg] iter:  6, weight: tensor([0.0006, 0.0005, 0.0005, 0.0004, 0.1775, 0.1274, 0.1943, 0.1141, 0.2240,
        0.1606])
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 0.0874, Accuracy: 9750/10000 (97.5000%)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 5.8673, Accuracy: 71/8968 (0.7917%)
Done in 100.12348008155823 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:31 choose agents : [41, 73, 51, 74, 80, 7, 72, 14, 99, 12]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   1,  Average loss: 0.0172, Accuracy: 360/606 (59.4059%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   2,  Average loss: 0.0132, Accuracy: 350/606 (57.7558%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   3,  Average loss: 0.0111, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   4,  Average loss: 0.0107, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   5,  Average loss: 0.0102, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   6,  Average loss: 0.0102, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   9,  Average loss: 0.0096, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Global model norm: 16.444314102710205.
Norm before scaling: 16.469882180603744. Distance: 2.4285974541239326
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.0449, Accuracy: 5832/10000 (58.3200%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.8291, Accuracy: 4997/8968 (55.7203%)
Scaling by  100
Scaled Norm after poisoning: 242.3749516503304, distance: 242.8597444385339
Total norm for 4 adversaries is: 242.3749516503304. distance: 242.8597444385339
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 934.1315, Accuracy: 6104/8968 (68.0642%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   1,  Average loss: 0.0208, Accuracy: 338/591 (57.1912%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   2,  Average loss: 0.0203, Accuracy: 221/591 (37.3942%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   3,  Average loss: 0.0146, Accuracy: 331/591 (56.0068%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   4,  Average loss: 0.0139, Accuracy: 353/591 (59.7293%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   5,  Average loss: 0.0132, Accuracy: 367/591 (62.0981%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   6,  Average loss: 0.0130, Accuracy: 365/591 (61.7597%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   7,  Average loss: 0.0127, Accuracy: 388/591 (65.6514%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   8,  Average loss: 0.0121, Accuracy: 386/591 (65.3130%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   9,  Average loss: 0.0116, Accuracy: 401/591 (67.8511%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch  10,  Average loss: 0.0117, Accuracy: 382/591 (64.6362%), train_poison_data_count: 195
Global model norm: 16.444314102710205.
Norm before scaling: 16.516120203077357. Distance: 2.477532807411053
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.8162, Accuracy: 6639/10000 (66.3900%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.7138, Accuracy: 5764/8968 (64.2730%)
Scaling by  100
Scaled Norm after poisoning: 247.53779698765197, distance: 247.75327949393525
Total norm for 4 adversaries is: 247.53779698765197. distance: 247.75327949393525
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   1,  Average loss: 0.0160, Accuracy: 344/568 (60.5634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   2,  Average loss: 0.0113, Accuracy: 375/568 (66.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   3,  Average loss: 0.0100, Accuracy: 398/568 (70.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   4,  Average loss: 0.0097, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   5,  Average loss: 0.0089, Accuracy: 418/568 (73.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   6,  Average loss: 0.0080, Accuracy: 444/568 (78.1690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   7,  Average loss: 0.0074, Accuracy: 456/568 (80.2817%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   8,  Average loss: 0.0059, Accuracy: 506/568 (89.0845%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   9,  Average loss: 0.0052, Accuracy: 520/568 (91.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch  10,  Average loss: 0.0054, Accuracy: 517/568 (91.0211%), train_poison_data_count: 180
Global model norm: 16.444314102710205.
Norm before scaling: 16.51433148908093. Distance: 2.4849026677433383
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.9748, Accuracy: 6041/10000 (60.4100%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1802, Accuracy: 8470/8968 (94.4469%)
Scaling by  100
Scaled Norm after poisoning: 248.25614449847964, distance: 248.4902616929887
Total norm for 4 adversaries is: 248.25614449847964. distance: 248.4902616929887
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0150, Accuracy: 364/557 (65.3501%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   2,  Average loss: 0.0068, Accuracy: 479/557 (85.9964%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   3,  Average loss: 0.0025, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   4,  Average loss: 0.0023, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   5,  Average loss: 0.0020, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   8,  Average loss: 0.0013, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   9,  Average loss: 0.0018, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch  10,  Average loss: 0.0018, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Global model norm: 16.444314102710205.
Norm before scaling: 16.645347591310518. Distance: 2.499438222708892
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.4272, Accuracy: 8720/10000 (87.2000%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1018, Accuracy: 8558/8968 (95.4282%)
Scaling by  100
Scaled Norm after poisoning: 250.56500217009557, distance: 249.94382181302262
Total norm for 4 adversaries is: 250.56500217009557. distance: 249.94382181302262
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  31, local model 80, internal_epoch   1,  Average loss: 0.0009, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1972, Accuracy: 9390/10000 (93.9000%)
___Train Local_Simple,  epoch  31, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 411/418 (98.3254%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1656, Accuracy: 9466/10000 (94.6600%)
___Train Local_Simple,  epoch  31, local model 72, internal_epoch   1,  Average loss: 0.0006, Accuracy: 725/731 (99.1792%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1660, Accuracy: 9478/10000 (94.7800%)
___Train Local_Simple,  epoch  31, local model 14, internal_epoch   1,  Average loss: 0.0012, Accuracy: 369/376 (98.1383%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1399, Accuracy: 9582/10000 (95.8200%)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: 0.0009, Accuracy: 374/377 (99.2042%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1021, Accuracy: 9697/10000 (96.9700%)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1129/1160 (97.3276%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2685, Accuracy: 9161/10000 (91.6100%)
time spent on training: 84.00811171531677
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3993121238177128  data num: [606, 591, 568, 557, 431, 418, 731, 376, 377, 1160]
[rfa agg] considering poison per batch poison_fraction: 0.12478503869303526
[rfa agg] init. name: [41, 73, 51, 74, 80, 7, 72, 14, 99, 12], weight: tensor([0.1042, 0.1016, 0.0977, 0.0958, 0.0741, 0.0719, 0.1257, 0.0647, 0.0648,
        0.1995])
[rfa agg] iter:  0, prev_obj_val: 123.07477569580078, obj_val: 108.72930908203125, abs dis: 14.345466613769531
[rfa agg] iter:  0, weight: tensor([0.0461, 0.0442, 0.0435, 0.0396, 0.1021, 0.0990, 0.1730, 0.0892, 0.0894,
        0.2740])
[rfa agg] iter:  1, prev_obj_val: 108.72930908203125, obj_val: 103.07538604736328, abs dis: 5.653923034667969
[rfa agg] iter:  1, weight: tensor([0.0204, 0.0196, 0.0189, 0.0179, 0.1142, 0.1106, 0.1933, 0.0999, 0.1000,
        0.3052])
[rfa agg] iter:  2, prev_obj_val: 103.07538604736328, obj_val: 100.67451477050781, abs dis: 2.4008712768554688
[rfa agg] iter:  2, weight: tensor([0.0091, 0.0087, 0.0083, 0.0081, 0.1199, 0.1159, 0.2024, 0.1052, 0.1051,
        0.3174])
[rfa agg] iter:  3, prev_obj_val: 100.67451477050781, obj_val: 99.65576171875, abs dis: 1.0187530517578125
[rfa agg] iter:  3, weight: tensor([0.0041, 0.0039, 0.0037, 0.0036, 0.1233, 0.1188, 0.2066, 0.1090, 0.1084,
        0.3186])
[rfa agg] iter:  4, prev_obj_val: 99.65576171875, obj_val: 99.26261138916016, abs dis: 0.39315032958984375
[rfa agg] iter:  4, weight: tensor([0.0019, 0.0018, 0.0017, 0.0017, 0.1271, 0.1216, 0.2088, 0.1140, 0.1128,
        0.3086])
[rfa agg] iter:  5, prev_obj_val: 99.26261138916016, obj_val: 99.1518783569336, abs dis: 0.1107330322265625
[rfa agg] iter:  5, weight: tensor([0.0010, 0.0009, 0.0009, 0.0009, 0.1337, 0.1273, 0.2094, 0.1222, 0.1215,
        0.2822])
[rfa agg] iter:  6, prev_obj_val: 99.1518783569336, obj_val: 99.13360595703125, abs dis: 0.01827239990234375
[rfa agg] iter:  6, weight: tensor([0.0006, 0.0006, 0.0006, 0.0006, 0.1420, 0.1360, 0.2086, 0.1294, 0.1340,
        0.2475])
[rfa agg] iter:  7, prev_obj_val: 99.13360595703125, obj_val: 99.13140869140625, abs dis: 0.002197265625
[rfa agg] iter:  7, weight: tensor([0.0006, 0.0005, 0.0005, 0.0005, 0.1473, 0.1428, 0.2087, 0.1324, 0.1439,
        0.2228])
[rfa agg] iter:  8, prev_obj_val: 99.13140869140625, obj_val: 99.131103515625, abs dis: 0.00030517578125
[rfa agg] iter:  8, weight: tensor([0.0005, 0.0005, 0.0005, 0.0005, 0.1496, 0.1459, 0.2095, 0.1336, 0.1492,
        0.2103])
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.0867, Accuracy: 9749/10000 (97.4900%)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 5.8199, Accuracy: 72/8968 (0.8029%)
Done in 100.35075235366821 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:32 choose agents : [41, 73, 51, 74, 93, 25, 34, 57, 69, 58]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   1,  Average loss: 0.0158, Accuracy: 368/606 (60.7261%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   2,  Average loss: 0.0126, Accuracy: 377/606 (62.2112%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   3,  Average loss: 0.0107, Accuracy: 401/606 (66.1716%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   4,  Average loss: 0.0109, Accuracy: 383/606 (63.2013%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   5,  Average loss: 0.0104, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   6,  Average loss: 0.0101, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   7,  Average loss: 0.0100, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   8,  Average loss: 0.0099, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   9,  Average loss: 0.0096, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Global model norm: 16.443411224714843.
Norm before scaling: 16.448432564773174. Distance: 2.1277180286757926
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.8821, Accuracy: 6266/10000 (62.6600%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.9511, Accuracy: 4471/8968 (49.8550%)
Scaling by  100
Scaled Norm after poisoning: 212.38180536477225, distance: 212.77181145537114
Total norm for 4 adversaries is: 212.38180536477225. distance: 212.77181145537114
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 706.3397, Accuracy: 2396/8968 (26.7172%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   1,  Average loss: 0.0237, Accuracy: 314/591 (53.1303%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   2,  Average loss: 0.0201, Accuracy: 253/591 (42.8088%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   3,  Average loss: 0.0143, Accuracy: 348/591 (58.8832%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   4,  Average loss: 0.0146, Accuracy: 340/591 (57.5296%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   5,  Average loss: 0.0135, Accuracy: 362/591 (61.2521%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   6,  Average loss: 0.0126, Accuracy: 386/591 (65.3130%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   7,  Average loss: 0.0120, Accuracy: 387/591 (65.4822%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   8,  Average loss: 0.0110, Accuracy: 415/591 (70.2200%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   9,  Average loss: 0.0109, Accuracy: 408/591 (69.0355%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch  10,  Average loss: 0.0105, Accuracy: 434/591 (73.4349%), train_poison_data_count: 195
Global model norm: 16.443411224714843.
Norm before scaling: 16.58079123381792. Distance: 2.909039870811451
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.8612, Accuracy: 6309/10000 (63.0900%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.5103, Accuracy: 7234/8968 (80.6646%)
Scaling by  100
Scaled Norm after poisoning: 290.69391656001335, distance: 290.9039924313518
Total norm for 4 adversaries is: 290.69391656001335. distance: 290.9039924313518
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   1,  Average loss: 0.0163, Accuracy: 352/568 (61.9718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   2,  Average loss: 0.0115, Accuracy: 360/568 (63.3803%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   3,  Average loss: 0.0104, Accuracy: 387/568 (68.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   4,  Average loss: 0.0091, Accuracy: 408/568 (71.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   5,  Average loss: 0.0089, Accuracy: 399/568 (70.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   6,  Average loss: 0.0084, Accuracy: 410/568 (72.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   7,  Average loss: 0.0076, Accuracy: 435/568 (76.5845%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   8,  Average loss: 0.0065, Accuracy: 473/568 (83.2746%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   9,  Average loss: 0.0059, Accuracy: 506/568 (89.0845%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch  10,  Average loss: 0.0059, Accuracy: 504/568 (88.7324%), train_poison_data_count: 180
Global model norm: 16.443411224714843.
Norm before scaling: 16.537195993225676. Distance: 2.5494952618588016
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.8621, Accuracy: 6689/10000 (66.8900%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.3226, Accuracy: 8118/8968 (90.5219%)
Scaling by  100
Scaled Norm after poisoning: 254.81161086428145, distance: 254.94952778687392
Total norm for 4 adversaries is: 254.81161086428145. distance: 254.94952778687392
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   1,  Average loss: 0.0167, Accuracy: 338/557 (60.6822%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   2,  Average loss: 0.0071, Accuracy: 464/557 (83.3034%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   3,  Average loss: 0.0039, Accuracy: 516/557 (92.6391%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   4,  Average loss: 0.0024, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   5,  Average loss: 0.0024, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   6,  Average loss: 0.0019, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   7,  Average loss: 0.0019, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   8,  Average loss: 0.0019, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch  10,  Average loss: 0.0015, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.443411224714843.
Norm before scaling: 16.663807941679703. Distance: 2.750686299777111
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4790, Accuracy: 8559/10000 (85.5900%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0702, Accuracy: 8697/8968 (96.9781%)
Scaling by  100
Scaled Norm after poisoning: 275.51076147312284, distance: 275.0686278004091
Total norm for 4 adversaries is: 275.51076147312284. distance: 275.0686278004091
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: 0.0006, Accuracy: 617/623 (99.0369%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2681, Accuracy: 9098/10000 (90.9800%)
___Train Local_Simple,  epoch  32, local model 25, internal_epoch   1,  Average loss: 0.0012, Accuracy: 632/647 (97.6816%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3212, Accuracy: 8953/10000 (89.5300%)
___Train Local_Simple,  epoch  32, local model 34, internal_epoch   1,  Average loss: 0.0007, Accuracy: 409/413 (99.0315%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1857, Accuracy: 9424/10000 (94.2400%)
___Train Local_Simple,  epoch  32, local model 57, internal_epoch   1,  Average loss: 0.0023, Accuracy: 328/343 (95.6268%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1571, Accuracy: 9508/10000 (95.0800%)
___Train Local_Simple,  epoch  32, local model 69, internal_epoch   1,  Average loss: 0.0019, Accuracy: 249/256 (97.2656%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1490, Accuracy: 9537/10000 (95.3700%)
___Train Local_Simple,  epoch  32, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 265/276 (96.0145%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1489, Accuracy: 9549/10000 (95.4900%)
time spent on training: 88.5449492931366
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.47581967213114756  data num: [606, 591, 568, 557, 623, 647, 413, 343, 256, 276]
[rfa agg] considering poison per batch poison_fraction: 0.1486936475409836
[rfa agg] init. name: [41, 73, 51, 74, 93, 25, 34, 57, 69, 58], weight: tensor([0.1242, 0.1211, 0.1164, 0.1141, 0.1277, 0.1326, 0.0846, 0.0703, 0.0525,
        0.0566])
[rfa agg] iter:  0, prev_obj_val: 144.36878967285156, obj_val: 132.652099609375, abs dis: 11.716690063476562
[rfa agg] iter:  0, weight: tensor([0.0769, 0.0553, 0.0619, 0.0538, 0.1830, 0.1903, 0.1214, 0.1010, 0.0753,
        0.0812])
[rfa agg] iter:  1, prev_obj_val: 132.652099609375, obj_val: 127.90606689453125, abs dis: 4.74603271484375
[rfa agg] iter:  1, weight: tensor([0.0429, 0.0299, 0.0334, 0.0295, 0.2101, 0.2187, 0.1395, 0.1162, 0.0865,
        0.0933])
[rfa agg] iter:  2, prev_obj_val: 127.90606689453125, obj_val: 125.57157135009766, abs dis: 2.3344955444335938
[rfa agg] iter:  2, weight: tensor([0.0239, 0.0168, 0.0186, 0.0167, 0.2242, 0.2338, 0.1492, 0.1244, 0.0925,
        0.0999])
[rfa agg] iter:  3, prev_obj_val: 125.57157135009766, obj_val: 124.33729553222656, abs dis: 1.2342758178710938
[rfa agg] iter:  3, weight: tensor([0.0135, 0.0096, 0.0105, 0.0095, 0.2314, 0.2422, 0.1545, 0.1293, 0.0959,
        0.1036])
[rfa agg] iter:  4, prev_obj_val: 124.33729553222656, obj_val: 123.66580200195312, abs dis: 0.6714935302734375
[rfa agg] iter:  4, weight: tensor([0.0077, 0.0055, 0.0060, 0.0054, 0.2346, 0.2468, 0.1575, 0.1327, 0.0979,
        0.1059])
[rfa agg] iter:  5, prev_obj_val: 123.66580200195312, obj_val: 123.30165100097656, abs dis: 0.3641510009765625
[rfa agg] iter:  5, weight: tensor([0.0044, 0.0032, 0.0035, 0.0031, 0.2346, 0.2492, 0.1593, 0.1357, 0.0994,
        0.1076])
[rfa agg] iter:  6, prev_obj_val: 123.30165100097656, obj_val: 123.11398315429688, abs dis: 0.1876678466796875
[rfa agg] iter:  6, weight: tensor([0.0026, 0.0019, 0.0020, 0.0019, 0.2314, 0.2493, 0.1607, 0.1395, 0.1011,
        0.1096])
[rfa agg] iter:  7, prev_obj_val: 123.11398315429688, obj_val: 123.03001403808594, abs dis: 0.0839691162109375
[rfa agg] iter:  7, weight: tensor([0.0016, 0.0012, 0.0013, 0.0012, 0.2243, 0.2462, 0.1625, 0.1453, 0.1041,
        0.1124])
[rfa agg] iter:  8, prev_obj_val: 123.03001403808594, obj_val: 123.00129699707031, abs dis: 0.028717041015625
[rfa agg] iter:  8, weight: tensor([0.0011, 0.0008, 0.0009, 0.0008, 0.2142, 0.2387, 0.1648, 0.1530, 0.1094,
        0.1164])
[rfa agg] iter:  9, prev_obj_val: 123.00129699707031, obj_val: 122.9944076538086, abs dis: 0.00688934326171875
[rfa agg] iter:  9, weight: tensor([0.0009, 0.0006, 0.0007, 0.0006, 0.2047, 0.2295, 0.1670, 0.1600, 0.1158,
        0.1201])
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.0885, Accuracy: 9747/10000 (97.4700%)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 5.6298, Accuracy: 79/8968 (0.8809%)
Done in 104.51619458198547 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:33 choose agents : [41, 73, 51, 74, 2, 4, 1, 20, 49, 57]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   1,  Average loss: 0.0157, Accuracy: 375/606 (61.8812%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   2,  Average loss: 0.0128, Accuracy: 345/606 (56.9307%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   3,  Average loss: 0.0107, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   4,  Average loss: 0.0106, Accuracy: 402/606 (66.3366%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   5,  Average loss: 0.0106, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   6,  Average loss: 0.0100, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   7,  Average loss: 0.0099, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   9,  Average loss: 0.0097, Accuracy: 436/606 (71.9472%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Global model norm: 16.441732463650233.
Norm before scaling: 16.481019171153278. Distance: 2.388040978621634
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.0270, Accuracy: 5783/10000 (57.8300%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.9220, Accuracy: 4658/8968 (51.9402%)
Scaling by  100
Scaled Norm after poisoning: 238.4466249892206, distance: 238.80409236704887
Total norm for 4 adversaries is: 238.4466249892206. distance: 238.80409236704887
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.4760, Accuracy: 8960/8968 (99.9108%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   1,  Average loss: 0.0198, Accuracy: 353/591 (59.7293%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   2,  Average loss: 0.0202, Accuracy: 254/591 (42.9780%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   3,  Average loss: 0.0147, Accuracy: 279/591 (47.2081%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   4,  Average loss: 0.0139, Accuracy: 351/591 (59.3909%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   5,  Average loss: 0.0133, Accuracy: 357/591 (60.4061%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   6,  Average loss: 0.0125, Accuracy: 363/591 (61.4213%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   7,  Average loss: 0.0122, Accuracy: 378/591 (63.9594%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   8,  Average loss: 0.0115, Accuracy: 395/591 (66.8359%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   9,  Average loss: 0.0109, Accuracy: 404/591 (68.3587%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch  10,  Average loss: 0.0116, Accuracy: 390/591 (65.9898%), train_poison_data_count: 195
Global model norm: 16.441732463650233.
Norm before scaling: 16.51247512388124. Distance: 2.510959160360594
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.8400, Accuracy: 6302/10000 (63.0200%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.5618, Accuracy: 6757/8968 (75.3457%)
Scaling by  100
Scaled Norm after poisoning: 250.84282149136737, distance: 251.09591823892717
Total norm for 4 adversaries is: 250.84282149136737. distance: 251.09591823892717
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   1,  Average loss: 0.0151, Accuracy: 356/568 (62.6761%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   2,  Average loss: 0.0120, Accuracy: 345/568 (60.7394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   3,  Average loss: 0.0099, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   4,  Average loss: 0.0089, Accuracy: 434/568 (76.4085%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   5,  Average loss: 0.0079, Accuracy: 468/568 (82.3944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   6,  Average loss: 0.0073, Accuracy: 447/568 (78.6972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   7,  Average loss: 0.0061, Accuracy: 498/568 (87.6761%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   8,  Average loss: 0.0050, Accuracy: 522/568 (91.9014%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   9,  Average loss: 0.0042, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch  10,  Average loss: 0.0041, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Global model norm: 16.441732463650233.
Norm before scaling: 16.50993371812719. Distance: 2.3721044859106937
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.9094, Accuracy: 6400/10000 (64.0000%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.1345, Accuracy: 8634/8968 (96.2756%)
Scaling by  100
Scaled Norm after poisoning: 237.0678551992024, distance: 237.21044849458045
Total norm for 4 adversaries is: 237.0678551992024. distance: 237.21044849458045
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   1,  Average loss: 0.0150, Accuracy: 359/557 (64.4524%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   2,  Average loss: 0.0072, Accuracy: 468/557 (84.0215%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   3,  Average loss: 0.0031, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   4,  Average loss: 0.0029, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   5,  Average loss: 0.0024, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   6,  Average loss: 0.0021, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   7,  Average loss: 0.0018, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Global model norm: 16.441732463650233.
Norm before scaling: 16.637831705112788. Distance: 2.6010716063935866
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.4563, Accuracy: 8641/10000 (86.4100%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0609, Accuracy: 8748/8968 (97.5468%)
Scaling by  100
Scaled Norm after poisoning: 260.5728215154067, distance: 260.1071594074258
Total norm for 4 adversaries is: 260.5728215154067. distance: 260.1071594074258
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  33, local model 2, internal_epoch   1,  Average loss: 0.0012, Accuracy: 541/548 (98.7226%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1541, Accuracy: 9513/10000 (95.1300%)
___Train Local_Simple,  epoch  33, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 643/658 (97.7204%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2033, Accuracy: 9300/10000 (93.0000%)
___Train Local_Simple,  epoch  33, local model 1, internal_epoch   1,  Average loss: 0.0019, Accuracy: 736/760 (96.8421%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1426, Accuracy: 9566/10000 (95.6600%)
___Train Local_Simple,  epoch  33, local model 20, internal_epoch   1,  Average loss: 0.0013, Accuracy: 420/429 (97.9021%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3263, Accuracy: 9017/10000 (90.1700%)
___Train Local_Simple,  epoch  33, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 498/506 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1531, Accuracy: 9508/10000 (95.0800%)
___Train Local_Simple,  epoch  33, local model 57, internal_epoch   1,  Average loss: 0.0020, Accuracy: 330/343 (96.2099%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1699, Accuracy: 9468/10000 (94.6800%)
time spent on training: 83.9830572605133
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41717570966582823  data num: [606, 591, 568, 557, 548, 658, 760, 429, 506, 343]
[rfa agg] considering poison per batch poison_fraction: 0.13036740927057133
[rfa agg] init. name: [41, 73, 51, 74, 2, 4, 1, 20, 49, 57], weight: tensor([0.1089, 0.1062, 0.1020, 0.1001, 0.0985, 0.1182, 0.1365, 0.0771, 0.0909,
        0.0616])
[rfa agg] iter:  0, prev_obj_val: 126.3241195678711, obj_val: 112.61287689208984, abs dis: 13.71124267578125
[rfa agg] iter:  0, weight: tensor([0.0492, 0.0462, 0.0482, 0.0411, 0.1379, 0.1652, 0.1909, 0.1079, 0.1271,
        0.0863])
[rfa agg] iter:  1, prev_obj_val: 112.61287689208984, obj_val: 107.24029541015625, abs dis: 5.372581481933594
[rfa agg] iter:  1, weight: tensor([0.0226, 0.0211, 0.0217, 0.0189, 0.1550, 0.1854, 0.2142, 0.1212, 0.1427,
        0.0972])
[rfa agg] iter:  2, prev_obj_val: 107.24029541015625, obj_val: 104.90785217285156, abs dis: 2.3324432373046875
[rfa agg] iter:  2, weight: tensor([0.0104, 0.0097, 0.0099, 0.0088, 0.1632, 0.1941, 0.2244, 0.1273, 0.1497,
        0.1025])
[rfa agg] iter:  3, prev_obj_val: 104.90785217285156, obj_val: 103.87586212158203, abs dis: 1.0319900512695312
[rfa agg] iter:  3, weight: tensor([0.0048, 0.0045, 0.0046, 0.0041, 0.1678, 0.1972, 0.2281, 0.1303, 0.1528,
        0.1058])
[rfa agg] iter:  4, prev_obj_val: 103.87586212158203, obj_val: 103.44192504882812, abs dis: 0.43393707275390625
[rfa agg] iter:  4, weight: tensor([0.0023, 0.0021, 0.0022, 0.0019, 0.1722, 0.1964, 0.2273, 0.1319, 0.1542,
        0.1095])
[rfa agg] iter:  5, prev_obj_val: 103.44192504882812, obj_val: 103.29509735107422, abs dis: 0.14682769775390625
[rfa agg] iter:  5, weight: tensor([0.0012, 0.0011, 0.0011, 0.0010, 0.1796, 0.1911, 0.2210, 0.1323, 0.1555,
        0.1162])
[rfa agg] iter:  6, prev_obj_val: 103.29509735107422, obj_val: 103.26506042480469, abs dis: 0.03003692626953125
[rfa agg] iter:  6, weight: tensor([0.0007, 0.0007, 0.0007, 0.0006, 0.1909, 0.1820, 0.2095, 0.1308, 0.1580,
        0.1261])
[rfa agg] iter:  7, prev_obj_val: 103.26506042480469, obj_val: 103.26187133789062, abs dis: 0.0031890869140625
[rfa agg] iter:  7, weight: tensor([0.0006, 0.0005, 0.0006, 0.0005, 0.1999, 0.1752, 0.1999, 0.1291, 0.1608,
        0.1329])
[rfa agg] iter:  8, prev_obj_val: 103.26187133789062, obj_val: 103.26163482666016, abs dis: 0.00023651123046875
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0005, 0.0005, 0.0005, 0.2042, 0.1723, 0.1952, 0.1285, 0.1622,
        0.1356])
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.0883, Accuracy: 9744/10000 (97.4400%)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 5.5455, Accuracy: 87/8968 (0.9701%)
Done in 100.83500242233276 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:34 choose agents : [41, 73, 51, 74, 27, 43, 49, 0, 45, 25]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0162, Accuracy: 372/606 (61.3861%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   2,  Average loss: 0.0143, Accuracy: 352/606 (58.0858%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   3,  Average loss: 0.0112, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   4,  Average loss: 0.0109, Accuracy: 393/606 (64.8515%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   5,  Average loss: 0.0105, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   6,  Average loss: 0.0104, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 435/606 (71.7822%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   9,  Average loss: 0.0096, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch  10,  Average loss: 0.0103, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Global model norm: 16.44164429843707.
Norm before scaling: 16.478101590633855. Distance: 2.3192488676090814
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.0232, Accuracy: 5734/10000 (57.3400%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.8723, Accuracy: 4877/8968 (54.3822%)
Scaling by  100
Scaled Norm after poisoning: 231.6065747528554, distance: 231.9248851325575
Total norm for 4 adversaries is: 231.6065747528554. distance: 231.9248851325575
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 147.2907, Accuracy: 8586/8968 (95.7404%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   1,  Average loss: 0.0193, Accuracy: 336/591 (56.8528%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   2,  Average loss: 0.0176, Accuracy: 297/591 (50.2538%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   3,  Average loss: 0.0161, Accuracy: 304/591 (51.4382%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   4,  Average loss: 0.0137, Accuracy: 350/591 (59.2217%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   5,  Average loss: 0.0129, Accuracy: 349/591 (59.0525%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   6,  Average loss: 0.0125, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   7,  Average loss: 0.0117, Accuracy: 388/591 (65.6514%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   8,  Average loss: 0.0109, Accuracy: 408/591 (69.0355%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   9,  Average loss: 0.0109, Accuracy: 432/591 (73.0964%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch  10,  Average loss: 0.0102, Accuracy: 431/591 (72.9272%), train_poison_data_count: 195
Global model norm: 16.44164429843707.
Norm before scaling: 16.4846619495167. Distance: 2.2736318184042905
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.8081, Accuracy: 6429/10000 (64.2900%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.4539, Accuracy: 7748/8968 (86.3961%)
Scaling by  100
Scaled Norm after poisoning: 227.13222333037643, distance: 227.3631800116281
Total norm for 4 adversaries is: 227.13222333037643. distance: 227.3631800116281
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   1,  Average loss: 0.0150, Accuracy: 354/568 (62.3239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   2,  Average loss: 0.0110, Accuracy: 385/568 (67.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   3,  Average loss: 0.0094, Accuracy: 404/568 (71.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   4,  Average loss: 0.0086, Accuracy: 420/568 (73.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   5,  Average loss: 0.0081, Accuracy: 419/568 (73.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   6,  Average loss: 0.0072, Accuracy: 471/568 (82.9225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   7,  Average loss: 0.0063, Accuracy: 490/568 (86.2676%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   8,  Average loss: 0.0050, Accuracy: 517/568 (91.0211%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   9,  Average loss: 0.0044, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch  10,  Average loss: 0.0042, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Global model norm: 16.44164429843707.
Norm before scaling: 16.521798271230477. Distance: 2.3186230401089403
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.7966, Accuracy: 7012/10000 (70.1200%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.1421, Accuracy: 8652/8968 (96.4764%)
Scaling by  100
Scaled Norm after poisoning: 231.85571853795196, distance: 231.86230591937536
Total norm for 4 adversaries is: 231.85571853795196. distance: 231.86230591937536
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   1,  Average loss: 0.0125, Accuracy: 403/557 (72.3519%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 504/557 (90.4847%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   3,  Average loss: 0.0031, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   4,  Average loss: 0.0019, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   5,  Average loss: 0.0023, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   6,  Average loss: 0.0018, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   7,  Average loss: 0.0019, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   9,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Global model norm: 16.44164429843707.
Norm before scaling: 16.594131609018348. Distance: 2.2889305311054784
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3758, Accuracy: 8863/10000 (88.6300%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0656, Accuracy: 8719/8968 (97.2235%)
Scaling by  100
Scaled Norm after poisoning: 229.43885351003652, distance: 228.89304782747334
Total norm for 4 adversaries is: 229.43885351003652. distance: 228.89304782747334
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  34, local model 27, internal_epoch   1,  Average loss: 0.0015, Accuracy: 460/471 (97.6645%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2173, Accuracy: 9310/10000 (93.1000%)
___Train Local_Simple,  epoch  34, local model 43, internal_epoch   1,  Average loss: 0.0014, Accuracy: 399/408 (97.7941%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1187, Accuracy: 9641/10000 (96.4100%)
___Train Local_Simple,  epoch  34, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 498/506 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1324, Accuracy: 9578/10000 (95.7800%)
___Train Local_Simple,  epoch  34, local model 0, internal_epoch   1,  Average loss: 0.0018, Accuracy: 420/435 (96.5517%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1810, Accuracy: 9402/10000 (94.0200%)
___Train Local_Simple,  epoch  34, local model 45, internal_epoch   1,  Average loss: 0.0013, Accuracy: 613/628 (97.6115%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3298, Accuracy: 8891/10000 (88.9100%)
___Train Local_Simple,  epoch  34, local model 25, internal_epoch   1,  Average loss: 0.0012, Accuracy: 635/647 (98.1453%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3237, Accuracy: 8980/10000 (89.8000%)
time spent on training: 83.4965672492981
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4286505445818719  data num: [606, 591, 568, 557, 471, 408, 506, 435, 628, 647]
[rfa agg] considering poison per batch poison_fraction: 0.13395329518183496
[rfa agg] init. name: [41, 73, 51, 74, 27, 43, 49, 0, 45, 25], weight: tensor([0.1119, 0.1091, 0.1049, 0.1028, 0.0869, 0.0753, 0.0934, 0.0803, 0.1159,
        0.1194])
[rfa agg] iter:  0, prev_obj_val: 120.0707778930664, obj_val: 107.89981842041016, abs dis: 12.17095947265625
[rfa agg] iter:  0, weight: tensor([0.0510, 0.0519, 0.0492, 0.0472, 0.1218, 0.1056, 0.1309, 0.1126, 0.1624,
        0.1673])
[rfa agg] iter:  1, prev_obj_val: 107.89981842041016, obj_val: 102.96926879882812, abs dis: 4.930549621582031
[rfa agg] iter:  1, weight: tensor([0.0247, 0.0249, 0.0235, 0.0230, 0.1375, 0.1193, 0.1478, 0.1273, 0.1832,
        0.1889])
[rfa agg] iter:  2, prev_obj_val: 102.96926879882812, obj_val: 100.72845458984375, abs dis: 2.240814208984375
[rfa agg] iter:  2, weight: tensor([0.0121, 0.0121, 0.0114, 0.0113, 0.1449, 0.1259, 0.1559, 0.1344, 0.1930,
        0.1991])
[rfa agg] iter:  3, prev_obj_val: 100.72845458984375, obj_val: 99.67777252197266, abs dis: 1.0506820678710938
[rfa agg] iter:  3, weight: tensor([0.0059, 0.0059, 0.0056, 0.0055, 0.1483, 0.1294, 0.1601, 0.1383, 0.1973,
        0.2036])
[rfa agg] iter:  4, prev_obj_val: 99.67777252197266, obj_val: 99.19534301757812, abs dis: 0.48242950439453125
[rfa agg] iter:  4, weight: tensor([0.0029, 0.0029, 0.0028, 0.0027, 0.1497, 0.1320, 0.1627, 0.1410, 0.1984,
        0.2047])
[rfa agg] iter:  5, prev_obj_val: 99.19534301757812, obj_val: 98.9996566772461, abs dis: 0.19568634033203125
[rfa agg] iter:  5, weight: tensor([0.0015, 0.0015, 0.0014, 0.0014, 0.1501, 0.1358, 0.1661, 0.1437, 0.1967,
        0.2016])
[rfa agg] iter:  6, prev_obj_val: 98.9996566772461, obj_val: 98.9426040649414, abs dis: 0.0570526123046875
[rfa agg] iter:  6, weight: tensor([0.0009, 0.0009, 0.0008, 0.0008, 0.1500, 0.1437, 0.1729, 0.1461, 0.1918,
        0.1920])
[rfa agg] iter:  7, prev_obj_val: 98.9426040649414, obj_val: 98.9327392578125, abs dis: 0.00986480712890625
[rfa agg] iter:  7, weight: tensor([0.0007, 0.0007, 0.0006, 0.0006, 0.1497, 0.1543, 0.1819, 0.1462, 0.1858,
        0.1795])
[rfa agg] iter:  8, prev_obj_val: 98.9327392578125, obj_val: 98.93170928955078, abs dis: 0.00102996826171875
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0006, 0.0005, 0.0005, 0.1494, 0.1614, 0.1880, 0.1451, 0.1824,
        0.1714])
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.0881, Accuracy: 9747/10000 (97.4700%)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 5.5250, Accuracy: 88/8968 (0.9813%)
Done in 98.88405704498291 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:35 choose agents : [41, 73, 51, 74, 8, 12, 55, 26, 62, 65]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   1,  Average loss: 0.0148, Accuracy: 374/606 (61.7162%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   2,  Average loss: 0.0128, Accuracy: 377/606 (62.2112%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   3,  Average loss: 0.0111, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   4,  Average loss: 0.0109, Accuracy: 399/606 (65.8416%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   5,  Average loss: 0.0106, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   6,  Average loss: 0.0100, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 435/606 (71.7822%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   8,  Average loss: 0.0098, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   9,  Average loss: 0.0095, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch  10,  Average loss: 0.0095, Accuracy: 434/606 (71.6172%), train_poison_data_count: 200
Global model norm: 16.44122109883275.
Norm before scaling: 16.44224102849312. Distance: 2.0981741324527845
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.9522, Accuracy: 5861/10000 (58.6100%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.8407, Accuracy: 4820/8968 (53.7467%)
Scaling by  100
Scaled Norm after poisoning: 209.42011640778446, distance: 209.81741504520068
Total norm for 4 adversaries is: 209.42011640778446. distance: 209.81741504520068
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 2298.5508, Accuracy: 6558/8968 (73.1267%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   1,  Average loss: 0.0207, Accuracy: 332/591 (56.1760%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   2,  Average loss: 0.0213, Accuracy: 233/591 (39.4247%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   3,  Average loss: 0.0148, Accuracy: 326/591 (55.1607%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   4,  Average loss: 0.0145, Accuracy: 316/591 (53.4687%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   5,  Average loss: 0.0139, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   6,  Average loss: 0.0134, Accuracy: 365/591 (61.7597%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   7,  Average loss: 0.0126, Accuracy: 391/591 (66.1591%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   8,  Average loss: 0.0123, Accuracy: 367/591 (62.0981%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   9,  Average loss: 0.0121, Accuracy: 376/591 (63.6210%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch  10,  Average loss: 0.0118, Accuracy: 372/591 (62.9442%), train_poison_data_count: 195
Global model norm: 16.44122109883275.
Norm before scaling: 16.514790697056323. Distance: 2.6645609369795693
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.8972, Accuracy: 6090/10000 (60.9000%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.6255, Accuracy: 6421/8968 (71.5990%)
Scaling by  100
Scaled Norm after poisoning: 266.08576213788666, distance: 266.4560968762021
Total norm for 4 adversaries is: 266.08576213788666. distance: 266.4560968762021
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 2494.3284, Accuracy: 5197/8968 (57.9505%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   1,  Average loss: 0.0148, Accuracy: 368/568 (64.7887%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   2,  Average loss: 0.0114, Accuracy: 365/568 (64.2606%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   3,  Average loss: 0.0092, Accuracy: 418/568 (73.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   4,  Average loss: 0.0084, Accuracy: 433/568 (76.2324%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   5,  Average loss: 0.0079, Accuracy: 445/568 (78.3451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   6,  Average loss: 0.0068, Accuracy: 458/568 (80.6338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   7,  Average loss: 0.0060, Accuracy: 499/568 (87.8521%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   8,  Average loss: 0.0045, Accuracy: 528/568 (92.9577%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   9,  Average loss: 0.0038, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch  10,  Average loss: 0.0039, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Global model norm: 16.44122109883275.
Norm before scaling: 16.52665637973241. Distance: 2.2298491196844727
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.7832, Accuracy: 7065/10000 (70.6500%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1359, Accuracy: 8597/8968 (95.8631%)
Scaling by  100
Scaled Norm after poisoning: 223.10764988565498, distance: 222.98492627025263
Total norm for 4 adversaries is: 223.10764988565498. distance: 222.98492627025263
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   1,  Average loss: 0.0143, Accuracy: 370/557 (66.4273%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   2,  Average loss: 0.0070, Accuracy: 465/557 (83.4829%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   3,  Average loss: 0.0034, Accuracy: 519/557 (93.1777%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   4,  Average loss: 0.0025, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   5,  Average loss: 0.0024, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   6,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   7,  Average loss: 0.0017, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   8,  Average loss: 0.0014, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Global model norm: 16.44122109883275.
Norm before scaling: 16.61267183443156. Distance: 2.4402019490639657
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3949, Accuracy: 8839/10000 (88.3900%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0698, Accuracy: 8703/8968 (97.0450%)
Scaling by  100
Scaled Norm after poisoning: 244.51465798342232, distance: 244.02019479696756
Total norm for 4 adversaries is: 244.51465798342232. distance: 244.02019479696756
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.0018, Accuracy: 610/633 (96.3665%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1875, Accuracy: 9403/10000 (94.0300%)
___Train Local_Simple,  epoch  35, local model 12, internal_epoch   1,  Average loss: 0.0012, Accuracy: 1142/1160 (98.4483%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2191, Accuracy: 9259/10000 (92.5900%)
___Train Local_Simple,  epoch  35, local model 55, internal_epoch   1,  Average loss: 0.0016, Accuracy: 348/354 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2328, Accuracy: 9251/10000 (92.5100%)
___Train Local_Simple,  epoch  35, local model 26, internal_epoch   1,  Average loss: 0.0012, Accuracy: 539/554 (97.2924%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1153, Accuracy: 9664/10000 (96.6400%)
___Train Local_Simple,  epoch  35, local model 62, internal_epoch   1,  Average loss: 0.0009, Accuracy: 418/423 (98.8180%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1008, Accuracy: 9689/10000 (96.8900%)
___Train Local_Simple,  epoch  35, local model 65, internal_epoch   1,  Average loss: 0.0011, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1218, Accuracy: 9606/10000 (96.0600%)
time spent on training: 82.82191824913025
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3991748323878288  data num: [606, 591, 568, 557, 633, 1160, 354, 554, 423, 371]
[rfa agg] considering poison per batch poison_fraction: 0.1247421351211965
[rfa agg] init. name: [41, 73, 51, 74, 8, 12, 55, 26, 62, 65], weight: tensor([0.1042, 0.1016, 0.0976, 0.0958, 0.1088, 0.1994, 0.0609, 0.0952, 0.0727,
        0.0638])
[rfa agg] iter:  0, prev_obj_val: 117.31095886230469, obj_val: 103.32664489746094, abs dis: 13.98431396484375
[rfa agg] iter:  0, weight: tensor([0.0490, 0.0381, 0.0450, 0.0381, 0.1505, 0.2747, 0.0842, 0.1316, 0.1006,
        0.0882])
[rfa agg] iter:  1, prev_obj_val: 103.32664489746094, obj_val: 98.00992584228516, abs dis: 5.316719055175781
[rfa agg] iter:  1, weight: tensor([0.0214, 0.0163, 0.0191, 0.0167, 0.1682, 0.3057, 0.0943, 0.1471, 0.1125,
        0.0986])
[rfa agg] iter:  2, prev_obj_val: 98.00992584228516, obj_val: 95.81156158447266, abs dis: 2.1983642578125
[rfa agg] iter:  2, weight: tensor([0.0093, 0.0071, 0.0082, 0.0073, 0.1764, 0.3170, 0.0993, 0.1540, 0.1182,
        0.1033])
[rfa agg] iter:  3, prev_obj_val: 95.81156158447266, obj_val: 94.90540313720703, abs dis: 0.906158447265625
[rfa agg] iter:  3, weight: tensor([0.0041, 0.0031, 0.0036, 0.0032, 0.1807, 0.3168, 0.1026, 0.1578, 0.1221,
        0.1061])
[rfa agg] iter:  4, prev_obj_val: 94.90540313720703, obj_val: 94.57286071777344, abs dis: 0.33254241943359375
[rfa agg] iter:  4, weight: tensor([0.0018, 0.0014, 0.0016, 0.0015, 0.1834, 0.3051, 0.1063, 0.1617, 0.1279,
        0.1093])
[rfa agg] iter:  5, prev_obj_val: 94.57286071777344, obj_val: 94.48938751220703, abs dis: 0.08347320556640625
[rfa agg] iter:  5, weight: tensor([0.0010, 0.0007, 0.0008, 0.0008, 0.1816, 0.2804, 0.1089, 0.1687, 0.1415,
        0.1155])
[rfa agg] iter:  6, prev_obj_val: 94.48938751220703, obj_val: 94.47830200195312, abs dis: 0.01108551025390625
[rfa agg] iter:  6, weight: tensor([0.0007, 0.0005, 0.0006, 0.0005, 0.1744, 0.2543, 0.1068, 0.1772, 0.1619,
        0.1230])
[rfa agg] iter:  7, prev_obj_val: 94.47830200195312, obj_val: 94.47735595703125, abs dis: 0.000946044921875
[rfa agg] iter:  7, weight: tensor([0.0006, 0.0005, 0.0005, 0.0005, 0.1693, 0.2386, 0.1046, 0.1822, 0.1761,
        0.1272])
[rfa agg] iter:  8, prev_obj_val: 94.47735595703125, obj_val: 94.47724914550781, abs dis: 0.0001068115234375
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0004, 0.0005, 0.0005, 0.1674, 0.2313, 0.1040, 0.1841, 0.1823,
        0.1288])
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.0877, Accuracy: 9744/10000 (97.4400%)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 5.4908, Accuracy: 89/8968 (0.9924%)
Done in 98.1136782169342 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:36 choose agents : [41, 73, 51, 74, 54, 94, 68, 33, 58, 10]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   1,  Average loss: 0.0146, Accuracy: 381/606 (62.8713%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   2,  Average loss: 0.0123, Accuracy: 369/606 (60.8911%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   3,  Average loss: 0.0111, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   4,  Average loss: 0.0106, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   5,  Average loss: 0.0101, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   6,  Average loss: 0.0100, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   7,  Average loss: 0.0099, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   9,  Average loss: 0.0100, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Global model norm: 16.440716214879544.
Norm before scaling: 16.412437449304832. Distance: 2.027807164378443
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.9711, Accuracy: 5873/10000 (58.7300%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.8600, Accuracy: 5075/8968 (56.5901%)
Scaling by  100
Scaled Norm after poisoning: 202.20339968395686, distance: 202.78070821702937
Total norm for 4 adversaries is: 202.20339968395686. distance: 202.78070821702937
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 5275.1692, Accuracy: 4831/8968 (53.8693%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   1,  Average loss: 0.0201, Accuracy: 330/591 (55.8376%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   2,  Average loss: 0.0180, Accuracy: 278/591 (47.0389%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   3,  Average loss: 0.0161, Accuracy: 238/591 (40.2707%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   4,  Average loss: 0.0135, Accuracy: 380/591 (64.2978%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   5,  Average loss: 0.0129, Accuracy: 370/591 (62.6058%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   6,  Average loss: 0.0125, Accuracy: 383/591 (64.8054%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   7,  Average loss: 0.0119, Accuracy: 402/591 (68.0203%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   8,  Average loss: 0.0114, Accuracy: 403/591 (68.1895%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   9,  Average loss: 0.0108, Accuracy: 427/591 (72.2504%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch  10,  Average loss: 0.0105, Accuracy: 433/591 (73.2657%), train_poison_data_count: 195
Global model norm: 16.440716214879544.
Norm before scaling: 16.560273103535216. Distance: 2.6270945230881484
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.7388, Accuracy: 7184/10000 (71.8400%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.5910, Accuracy: 6821/8968 (76.0593%)
Scaling by  100
Scaled Norm after poisoning: 262.6612599908864, distance: 262.70945512581005
Total norm for 4 adversaries is: 262.6612599908864. distance: 262.70945512581005
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   1,  Average loss: 0.0143, Accuracy: 361/568 (63.5563%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   2,  Average loss: 0.0106, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   3,  Average loss: 0.0086, Accuracy: 423/568 (74.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   4,  Average loss: 0.0081, Accuracy: 459/568 (80.8099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   5,  Average loss: 0.0062, Accuracy: 488/568 (85.9155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   6,  Average loss: 0.0051, Accuracy: 519/568 (91.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   7,  Average loss: 0.0043, Accuracy: 524/568 (92.2535%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   8,  Average loss: 0.0032, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   9,  Average loss: 0.0025, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch  10,  Average loss: 0.0027, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Global model norm: 16.440716214879544.
Norm before scaling: 16.536638676017926. Distance: 2.304495800256989
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.8014, Accuracy: 7148/10000 (71.4800%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0963, Accuracy: 8659/8968 (96.5544%)
Scaling by  100
Scaled Norm after poisoning: 230.57008153704592, distance: 230.44957759236618
Total norm for 4 adversaries is: 230.57008153704592. distance: 230.44957759236618
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   1,  Average loss: 0.0140, Accuracy: 383/557 (68.7612%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 493/557 (88.5099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   3,  Average loss: 0.0024, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   4,  Average loss: 0.0022, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   5,  Average loss: 0.0022, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   7,  Average loss: 0.0020, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   9,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch  10,  Average loss: 0.0018, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Global model norm: 16.440716214879544.
Norm before scaling: 16.64283931130133. Distance: 2.6165774417251484
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.4302, Accuracy: 8687/10000 (86.8700%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0681, Accuracy: 8694/8968 (96.9447%)
Scaling by  100
Scaled Norm after poisoning: 262.14331421476305, distance: 261.6577260946063
Total norm for 4 adversaries is: 262.14331421476305. distance: 261.6577260946063
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  36, local model 54, internal_epoch   1,  Average loss: 0.0018, Accuracy: 500/519 (96.3391%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1707, Accuracy: 9475/10000 (94.7500%)
___Train Local_Simple,  epoch  36, local model 94, internal_epoch   1,  Average loss: 0.0020, Accuracy: 146/150 (97.3333%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1163, Accuracy: 9672/10000 (96.7200%)
___Train Local_Simple,  epoch  36, local model 68, internal_epoch   1,  Average loss: 0.0013, Accuracy: 482/494 (97.5709%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1380, Accuracy: 9528/10000 (95.2800%)
___Train Local_Simple,  epoch  36, local model 33, internal_epoch   1,  Average loss: 0.0016, Accuracy: 606/623 (97.2713%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1425, Accuracy: 9522/10000 (95.2200%)
___Train Local_Simple,  epoch  36, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 265/276 (96.0145%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1198, Accuracy: 9654/10000 (96.5400%)
___Train Local_Simple,  epoch  36, local model 10, internal_epoch   1,  Average loss: 0.0012, Accuracy: 869/892 (97.4215%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3550, Accuracy: 8812/10000 (88.1200%)
time spent on training: 80.9822506904602
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.44010614101592116  data num: [606, 591, 568, 557, 519, 150, 494, 623, 276, 892]
[rfa agg] considering poison per batch poison_fraction: 0.13753316906747537
[rfa agg] init. name: [41, 73, 51, 74, 54, 94, 68, 33, 58, 10], weight: tensor([0.1149, 0.1120, 0.1077, 0.1056, 0.0984, 0.0284, 0.0936, 0.1181, 0.0523,
        0.1691])
[rfa agg] iter:  0, prev_obj_val: 126.96241760253906, obj_val: 114.4423599243164, abs dis: 12.520057678222656
[rfa agg] iter:  0, weight: tensor([0.0618, 0.0469, 0.0535, 0.0438, 0.1395, 0.0404, 0.1328, 0.1673, 0.0743,
        0.2397])
[rfa agg] iter:  1, prev_obj_val: 114.4423599243164, obj_val: 109.52307891845703, abs dis: 4.919281005859375
[rfa agg] iter:  1, weight: tensor([0.0305, 0.0226, 0.0254, 0.0213, 0.1583, 0.0458, 0.1506, 0.1895, 0.0843,
        0.2716])
[rfa agg] iter:  2, prev_obj_val: 109.52307891845703, obj_val: 107.2962417602539, abs dis: 2.226837158203125
[rfa agg] iter:  2, weight: tensor([0.0150, 0.0112, 0.0124, 0.0105, 0.1673, 0.0486, 0.1593, 0.1999, 0.0893,
        0.2866])
[rfa agg] iter:  3, prev_obj_val: 107.2962417602539, obj_val: 106.24898529052734, abs dis: 1.0472564697265625
[rfa agg] iter:  3, weight: tensor([0.0074, 0.0055, 0.0061, 0.0052, 0.1719, 0.0502, 0.1638, 0.2044, 0.0921,
        0.2933])
[rfa agg] iter:  4, prev_obj_val: 106.24898529052734, obj_val: 105.76610565185547, abs dis: 0.482879638671875
[rfa agg] iter:  4, weight: tensor([0.0037, 0.0028, 0.0031, 0.0026, 0.1744, 0.0516, 0.1669, 0.2054, 0.0945,
        0.2950])
[rfa agg] iter:  5, prev_obj_val: 105.76610565185547, obj_val: 105.57000732421875, abs dis: 0.19609832763671875
[rfa agg] iter:  5, weight: tensor([0.0020, 0.0015, 0.0016, 0.0014, 0.1756, 0.0542, 0.1711, 0.2034, 0.0976,
        0.2917])
[rfa agg] iter:  6, prev_obj_val: 105.57000732421875, obj_val: 105.51295471191406, abs dis: 0.0570526123046875
[rfa agg] iter:  6, weight: tensor([0.0012, 0.0009, 0.0010, 0.0008, 0.1749, 0.0596, 0.1787, 0.1988, 0.1023,
        0.2818])
[rfa agg] iter:  7, prev_obj_val: 105.51295471191406, obj_val: 105.50312042236328, abs dis: 0.00983428955078125
[rfa agg] iter:  7, weight: tensor([0.0009, 0.0006, 0.0007, 0.0006, 0.1723, 0.0669, 0.1885, 0.1943, 0.1066,
        0.2686])
[rfa agg] iter:  8, prev_obj_val: 105.50312042236328, obj_val: 105.50204467773438, abs dis: 0.00107574462890625
[rfa agg] iter:  8, weight: tensor([0.0008, 0.0006, 0.0006, 0.0005, 0.1704, 0.0717, 0.1954, 0.1923, 0.1087,
        0.2589])
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.0877, Accuracy: 9746/10000 (97.4600%)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 5.4499, Accuracy: 91/8968 (1.0147%)
Done in 96.41201496124268 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:37 choose agents : [41, 73, 51, 74, 13, 81, 37, 94, 61, 57]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   1,  Average loss: 0.0165, Accuracy: 365/606 (60.2310%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   2,  Average loss: 0.0121, Accuracy: 398/606 (65.6766%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   3,  Average loss: 0.0102, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   4,  Average loss: 0.0102, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   5,  Average loss: 0.0107, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   6,  Average loss: 0.0100, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   7,  Average loss: 0.0100, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   8,  Average loss: 0.0096, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   9,  Average loss: 0.0104, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch  10,  Average loss: 0.0101, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Global model norm: 16.439633075118532.
Norm before scaling: 16.476195764055145. Distance: 2.407244984399592
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.9052, Accuracy: 6236/10000 (62.3600%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.9941, Accuracy: 4593/8968 (51.2154%)
Scaling by  100
Scaled Norm after poisoning: 240.33188315847732, distance: 240.72449241819993
Total norm for 4 adversaries is: 240.33188315847732. distance: 240.72449241819993
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 129.5012, Accuracy: 8144/8968 (90.8118%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   1,  Average loss: 0.0213, Accuracy: 335/591 (56.6836%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   2,  Average loss: 0.0208, Accuracy: 244/591 (41.2860%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   3,  Average loss: 0.0156, Accuracy: 337/591 (57.0220%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   4,  Average loss: 0.0144, Accuracy: 364/591 (61.5905%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   5,  Average loss: 0.0134, Accuracy: 374/591 (63.2826%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   6,  Average loss: 0.0131, Accuracy: 363/591 (61.4213%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   7,  Average loss: 0.0123, Accuracy: 401/591 (67.8511%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   8,  Average loss: 0.0119, Accuracy: 412/591 (69.7124%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   9,  Average loss: 0.0101, Accuracy: 440/591 (74.4501%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch  10,  Average loss: 0.0102, Accuracy: 448/591 (75.8037%), train_poison_data_count: 195
Global model norm: 16.439633075118532.
Norm before scaling: 16.55342100806696. Distance: 2.8940116220279104
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.9375, Accuracy: 5915/10000 (59.1500%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.4196, Accuracy: 7937/8968 (88.5036%)
Scaling by  100
Scaled Norm after poisoning: 289.069533698209, distance: 289.4011732223973
Total norm for 4 adversaries is: 289.069533698209. distance: 289.4011732223973
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   1,  Average loss: 0.0145, Accuracy: 362/568 (63.7324%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   2,  Average loss: 0.0106, Accuracy: 394/568 (69.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   3,  Average loss: 0.0088, Accuracy: 423/568 (74.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   4,  Average loss: 0.0079, Accuracy: 468/568 (82.3944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   5,  Average loss: 0.0068, Accuracy: 488/568 (85.9155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   6,  Average loss: 0.0059, Accuracy: 499/568 (87.8521%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   7,  Average loss: 0.0044, Accuracy: 529/568 (93.1338%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   8,  Average loss: 0.0033, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   9,  Average loss: 0.0026, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch  10,  Average loss: 0.0023, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Global model norm: 16.439633075118532.
Norm before scaling: 16.530692482328515. Distance: 2.290409355889817
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6959, Accuracy: 7564/10000 (75.6400%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.1262, Accuracy: 8523/8968 (95.0379%)
Scaling by  100
Scaled Norm after poisoning: 229.14110179374194, distance: 229.04093520591468
Total norm for 4 adversaries is: 229.14110179374194. distance: 229.04093520591468
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   1,  Average loss: 0.0123, Accuracy: 410/557 (73.6086%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 481/557 (86.3555%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   3,  Average loss: 0.0028, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   4,  Average loss: 0.0028, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   5,  Average loss: 0.0021, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   6,  Average loss: 0.0019, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch  10,  Average loss: 0.0015, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Global model norm: 16.439633075118532.
Norm before scaling: 16.58987088310119. Distance: 2.2570140443161257
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4089, Accuracy: 8772/10000 (87.7200%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0570, Accuracy: 8772/8968 (97.8145%)
Scaling by  100
Scaled Norm after poisoning: 226.27019937455307, distance: 225.70140673021956
Total norm for 4 adversaries is: 226.27019937455307. distance: 225.70140673021956
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  37, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 710/734 (96.7302%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2199, Accuracy: 9342/10000 (93.4200%)
___Train Local_Simple,  epoch  37, local model 81, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1209/1227 (98.5330%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.3046, Accuracy: 9152/10000 (91.5200%)
___Train Local_Simple,  epoch  37, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 847/860 (98.4884%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2580, Accuracy: 9264/10000 (92.6400%)
___Train Local_Simple,  epoch  37, local model 94, internal_epoch   1,  Average loss: 0.0026, Accuracy: 146/150 (97.3333%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1216, Accuracy: 9654/10000 (96.5400%)
___Train Local_Simple,  epoch  37, local model 61, internal_epoch   1,  Average loss: 0.0013, Accuracy: 685/699 (97.9971%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2584, Accuracy: 9167/10000 (91.6700%)
___Train Local_Simple,  epoch  37, local model 57, internal_epoch   1,  Average loss: 0.0023, Accuracy: 330/343 (96.2099%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1393, Accuracy: 9579/10000 (95.7900%)
time spent on training: 80.52414679527283
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3665351223362273  data num: [606, 591, 568, 557, 734, 1227, 860, 150, 699, 343]
[rfa agg] considering poison per batch poison_fraction: 0.11454222573007103
[rfa agg] init. name: [41, 73, 51, 74, 13, 81, 37, 94, 61, 57], weight: tensor([0.0957, 0.0933, 0.0897, 0.0879, 0.1159, 0.1937, 0.1358, 0.0237, 0.1103,
        0.0541])
[rfa agg] iter:  0, prev_obj_val: 115.10125732421875, obj_val: 98.8482894897461, abs dis: 16.252967834472656
[rfa agg] iter:  0, weight: tensor([0.0346, 0.0285, 0.0354, 0.0342, 0.1587, 0.2646, 0.1860, 0.0325, 0.1511,
        0.0743])
[rfa agg] iter:  1, prev_obj_val: 98.8482894897461, obj_val: 93.46320343017578, abs dis: 5.3850860595703125
[rfa agg] iter:  1, weight: tensor([0.0127, 0.0103, 0.0127, 0.0125, 0.1744, 0.2894, 0.2045, 0.0358, 0.1660,
        0.0819])
[rfa agg] iter:  2, prev_obj_val: 93.46320343017578, obj_val: 91.60176086425781, abs dis: 1.8614425659179688
[rfa agg] iter:  2, weight: tensor([0.0046, 0.0037, 0.0046, 0.0045, 0.1802, 0.2954, 0.2121, 0.0373, 0.1717,
        0.0858])
[rfa agg] iter:  3, prev_obj_val: 91.60176086425781, obj_val: 91.03202056884766, abs dis: 0.5697402954101562
[rfa agg] iter:  3, weight: tensor([0.0017, 0.0014, 0.0017, 0.0017, 0.1814, 0.2889, 0.2184, 0.0392, 0.1750,
        0.0905])
[rfa agg] iter:  4, prev_obj_val: 91.03202056884766, obj_val: 90.92747497558594, abs dis: 0.10454559326171875
[rfa agg] iter:  4, weight: tensor([0.0008, 0.0007, 0.0008, 0.0008, 0.1746, 0.2681, 0.2305, 0.0440, 0.1790,
        0.1009])
[rfa agg] iter:  5, prev_obj_val: 90.92747497558594, obj_val: 90.91986846923828, abs dis: 0.00760650634765625
[rfa agg] iter:  5, weight: tensor([0.0006, 0.0005, 0.0006, 0.0006, 0.1637, 0.2477, 0.2435, 0.0496, 0.1834,
        0.1101])
[rfa agg] iter:  6, prev_obj_val: 90.91986846923828, obj_val: 90.9195556640625, abs dis: 0.00031280517578125
[rfa agg] iter:  6, weight: tensor([0.0005, 0.0004, 0.0005, 0.0005, 0.1588, 0.2378, 0.2499, 0.0517, 0.1864,
        0.1134])
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.0874, Accuracy: 9751/10000 (97.5100%)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 5.4729, Accuracy: 95/8968 (1.0593%)
Done in 95.86311650276184 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:38 choose agents : [41, 73, 51, 74, 60, 92, 23, 39, 79, 86]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   1,  Average loss: 0.0164, Accuracy: 369/606 (60.8911%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   2,  Average loss: 0.0133, Accuracy: 350/606 (57.7558%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   3,  Average loss: 0.0106, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   4,  Average loss: 0.0102, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   5,  Average loss: 0.0103, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   6,  Average loss: 0.0102, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   7,  Average loss: 0.0100, Accuracy: 433/606 (71.4521%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   9,  Average loss: 0.0099, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Global model norm: 16.439608942657365.
Norm before scaling: 16.447968721055744. Distance: 2.288689384386961
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.0470, Accuracy: 5482/10000 (54.8200%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.8003, Accuracy: 5278/8968 (58.8537%)
Scaling by  100
Scaled Norm after poisoning: 228.37454672916158, distance: 228.86893253836354
Total norm for 4 adversaries is: 228.37454672916158. distance: 228.86893253836354
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.7797, Accuracy: 8954/8968 (99.8439%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   1,  Average loss: 0.0214, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   2,  Average loss: 0.0208, Accuracy: 237/591 (40.1015%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   3,  Average loss: 0.0138, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   4,  Average loss: 0.0137, Accuracy: 344/591 (58.2064%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   5,  Average loss: 0.0128, Accuracy: 376/591 (63.6210%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   6,  Average loss: 0.0118, Accuracy: 398/591 (67.3435%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   7,  Average loss: 0.0117, Accuracy: 418/591 (70.7276%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   8,  Average loss: 0.0097, Accuracy: 484/591 (81.8951%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   9,  Average loss: 0.0091, Accuracy: 516/591 (87.3096%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch  10,  Average loss: 0.0092, Accuracy: 516/591 (87.3096%), train_poison_data_count: 195
Global model norm: 16.439608942657365.
Norm before scaling: 16.556597194004908. Distance: 2.6947262333693267
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.7019, Accuracy: 7422/10000 (74.2200%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.4070, Accuracy: 7634/8968 (85.1249%)
Scaling by  100
Scaled Norm after poisoning: 269.3429215238448, distance: 269.4726041270244
Total norm for 4 adversaries is: 269.3429215238448. distance: 269.4726041270244
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   1,  Average loss: 0.0154, Accuracy: 349/568 (61.4437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   2,  Average loss: 0.0107, Accuracy: 394/568 (69.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   3,  Average loss: 0.0094, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   4,  Average loss: 0.0084, Accuracy: 448/568 (78.8732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   5,  Average loss: 0.0070, Accuracy: 464/568 (81.6901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   6,  Average loss: 0.0062, Accuracy: 510/568 (89.7887%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   7,  Average loss: 0.0048, Accuracy: 531/568 (93.4859%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   8,  Average loss: 0.0033, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   9,  Average loss: 0.0029, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch  10,  Average loss: 0.0028, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Global model norm: 16.439608942657365.
Norm before scaling: 16.523571401644208. Distance: 2.3865797935779356
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.7125, Accuracy: 7520/10000 (75.2000%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.1464, Accuracy: 8509/8968 (94.8818%)
Scaling by  100
Scaled Norm after poisoning: 238.61072508376483, distance: 238.65798292221444
Total norm for 4 adversaries is: 238.61072508376483. distance: 238.65798292221444
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   1,  Average loss: 0.0134, Accuracy: 379/557 (68.0431%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 487/557 (87.4327%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   3,  Average loss: 0.0028, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   4,  Average loss: 0.0023, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   5,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   6,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   7,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   9,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.439608942657365.
Norm before scaling: 16.63102257425064. Distance: 2.486314412429046
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3899, Accuracy: 8823/10000 (88.2300%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0577, Accuracy: 8757/8968 (97.6472%)
Scaling by  100
Scaled Norm after poisoning: 249.20411594965682, distance: 248.63142588478232
Total norm for 4 adversaries is: 249.20411594965682. distance: 248.63142588478232
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  38, local model 60, internal_epoch   1,  Average loss: 0.0020, Accuracy: 330/338 (97.6331%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1253, Accuracy: 9660/10000 (96.6000%)
___Train Local_Simple,  epoch  38, local model 92, internal_epoch   1,  Average loss: 0.0013, Accuracy: 914/937 (97.5454%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.4574, Accuracy: 8483/10000 (84.8300%)
___Train Local_Simple,  epoch  38, local model 23, internal_epoch   1,  Average loss: 0.0012, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1277, Accuracy: 9574/10000 (95.7400%)
___Train Local_Simple,  epoch  38, local model 39, internal_epoch   1,  Average loss: 0.0012, Accuracy: 251/257 (97.6654%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1044, Accuracy: 9689/10000 (96.8900%)
___Train Local_Simple,  epoch  38, local model 79, internal_epoch   1,  Average loss: 0.0020, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0911, Accuracy: 9744/10000 (97.4400%)
___Train Local_Simple,  epoch  38, local model 86, internal_epoch   1,  Average loss: 0.0015, Accuracy: 244/250 (97.6000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0974, Accuracy: 9716/10000 (97.1600%)
time spent on training: 80.28282427787781
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.5070976195675911  data num: [606, 591, 568, 557, 338, 937, 293, 257, 182, 250]
[rfa agg] considering poison per batch poison_fraction: 0.15846800611487222
[rfa agg] init. name: [41, 73, 51, 74, 60, 92, 23, 39, 79, 86], weight: tensor([0.1323, 0.1291, 0.1240, 0.1216, 0.0738, 0.2046, 0.0640, 0.0561, 0.0397,
        0.0546])
[rfa agg] iter:  0, prev_obj_val: 143.3460235595703, obj_val: 133.9123077392578, abs dis: 9.4337158203125
[rfa agg] iter:  0, weight: tensor([0.0788, 0.0660, 0.0736, 0.0656, 0.1073, 0.2968, 0.0930, 0.0816, 0.0578,
        0.0794])
[rfa agg] iter:  1, prev_obj_val: 133.9123077392578, obj_val: 129.99737548828125, abs dis: 3.9149322509765625
[rfa agg] iter:  1, weight: tensor([0.0480, 0.0394, 0.0438, 0.0399, 0.1244, 0.3433, 0.1077, 0.0946, 0.0670,
        0.0920])
[rfa agg] iter:  2, prev_obj_val: 129.99737548828125, obj_val: 127.97752380371094, abs dis: 2.0198516845703125
[rfa agg] iter:  2, weight: tensor([0.0298, 0.0245, 0.0270, 0.0250, 0.1343, 0.3695, 0.1162, 0.1021, 0.0723,
        0.0993])
[rfa agg] iter:  3, prev_obj_val: 127.97752380371094, obj_val: 126.8302230834961, abs dis: 1.1473007202148438
[rfa agg] iter:  3, weight: tensor([0.0189, 0.0156, 0.0170, 0.0159, 0.1405, 0.3847, 0.1214, 0.1067, 0.0756,
        0.1038])
[rfa agg] iter:  4, prev_obj_val: 126.8302230834961, obj_val: 126.14545440673828, abs dis: 0.6847686767578125
[rfa agg] iter:  4, weight: tensor([0.0121, 0.0100, 0.0109, 0.0102, 0.1447, 0.3932, 0.1248, 0.1098, 0.0777,
        0.1067])
[rfa agg] iter:  5, prev_obj_val: 126.14545440673828, obj_val: 125.72697448730469, abs dis: 0.41847991943359375
[rfa agg] iter:  5, weight: tensor([0.0078, 0.0064, 0.0070, 0.0066, 0.1477, 0.3971, 0.1271, 0.1120, 0.0793,
        0.1089])
[rfa agg] iter:  6, prev_obj_val: 125.72697448730469, obj_val: 125.47052001953125, abs dis: 0.2564544677734375
[rfa agg] iter:  6, weight: tensor([0.0051, 0.0042, 0.0046, 0.0043, 0.1504, 0.3972, 0.1290, 0.1139, 0.0807,
        0.1107])
[rfa agg] iter:  7, prev_obj_val: 125.47052001953125, obj_val: 125.31708526611328, abs dis: 0.15343475341796875
[rfa agg] iter:  7, weight: tensor([0.0033, 0.0028, 0.0030, 0.0028, 0.1529, 0.3938, 0.1308, 0.1157, 0.0822,
        0.1126])
[rfa agg] iter:  8, prev_obj_val: 125.31708526611328, obj_val: 125.23117065429688, abs dis: 0.08591461181640625
[rfa agg] iter:  8, weight: tensor([0.0023, 0.0019, 0.0020, 0.0019, 0.1557, 0.3865, 0.1331, 0.1177, 0.0841,
        0.1149])
[rfa agg] iter:  9, prev_obj_val: 125.23117065429688, obj_val: 125.18889617919922, abs dis: 0.04227447509765625
[rfa agg] iter:  9, weight: tensor([0.0016, 0.0013, 0.0014, 0.0014, 0.1584, 0.3750, 0.1362, 0.1199, 0.0867,
        0.1180])
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.0917, Accuracy: 9750/10000 (97.5000%)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 5.0819, Accuracy: 119/8968 (1.3269%)
Done in 95.7321047782898 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:39 choose agents : [41, 73, 51, 74, 63, 99, 97, 37, 44, 52]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   1,  Average loss: 0.0156, Accuracy: 356/606 (58.7459%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   2,  Average loss: 0.0119, Accuracy: 373/606 (61.5512%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   3,  Average loss: 0.0102, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   4,  Average loss: 0.0106, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   5,  Average loss: 0.0102, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   6,  Average loss: 0.0100, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   7,  Average loss: 0.0097, Accuracy: 437/606 (72.1122%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   8,  Average loss: 0.0098, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   9,  Average loss: 0.0096, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch  10,  Average loss: 0.0101, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Global model norm: 16.434830017232077.
Norm before scaling: 16.436903097824285. Distance: 2.0859342996522736
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.9212, Accuracy: 5887/10000 (58.8700%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.9207, Accuracy: 4867/8968 (54.2707%)
Scaling by  100
Scaled Norm after poisoning: 208.21387929542544, distance: 208.5934480334893
Total norm for 4 adversaries is: 208.21387929542544. distance: 208.5934480334893
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   1,  Average loss: 0.0191, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   2,  Average loss: 0.0199, Accuracy: 252/591 (42.6396%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   3,  Average loss: 0.0143, Accuracy: 360/591 (60.9137%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   4,  Average loss: 0.0140, Accuracy: 361/591 (61.0829%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   5,  Average loss: 0.0130, Accuracy: 366/591 (61.9289%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   6,  Average loss: 0.0123, Accuracy: 376/591 (63.6210%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   7,  Average loss: 0.0114, Accuracy: 405/591 (68.5279%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   8,  Average loss: 0.0102, Accuracy: 464/591 (78.5110%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   9,  Average loss: 0.0095, Accuracy: 483/591 (81.7259%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch  10,  Average loss: 0.0094, Accuracy: 493/591 (83.4179%), train_poison_data_count: 195
Global model norm: 16.434830017232077.
Norm before scaling: 16.495815786937076. Distance: 2.3735697605833526
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.7122, Accuracy: 7220/10000 (72.2000%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.3880, Accuracy: 7982/8968 (89.0054%)
Scaling by  100
Scaled Norm after poisoning: 237.16214456042516, distance: 237.35697173508512
Total norm for 4 adversaries is: 237.16214456042516. distance: 237.35697173508512
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   1,  Average loss: 0.0146, Accuracy: 358/568 (63.0282%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   2,  Average loss: 0.0102, Accuracy: 414/568 (72.8873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   3,  Average loss: 0.0081, Accuracy: 416/568 (73.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   4,  Average loss: 0.0070, Accuracy: 471/568 (82.9225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   5,  Average loss: 0.0064, Accuracy: 491/568 (86.4437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   6,  Average loss: 0.0047, Accuracy: 524/568 (92.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   7,  Average loss: 0.0036, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   8,  Average loss: 0.0025, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   9,  Average loss: 0.0021, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch  10,  Average loss: 0.0020, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Global model norm: 16.434830017232077.
Norm before scaling: 16.554022004674575. Distance: 2.3346440743610093
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6650, Accuracy: 7688/10000 (76.8800%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1136, Accuracy: 8618/8968 (96.0972%)
Scaling by  100
Scaled Norm after poisoning: 233.7175194679466, distance: 233.46442281159244
Total norm for 4 adversaries is: 233.7175194679466. distance: 233.46442281159244
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   1,  Average loss: 0.0126, Accuracy: 384/557 (68.9408%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 489/557 (87.7917%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   3,  Average loss: 0.0028, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   4,  Average loss: 0.0023, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   5,  Average loss: 0.0021, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   6,  Average loss: 0.0015, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   7,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   8,  Average loss: 0.0013, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Global model norm: 16.434830017232077.
Norm before scaling: 16.601669117304706. Distance: 2.427123848463702
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4478, Accuracy: 8641/10000 (86.4100%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0522, Accuracy: 8756/8968 (97.6360%)
Scaling by  100
Scaled Norm after poisoning: 243.19022261390361, distance: 242.712374787525
Total norm for 4 adversaries is: 243.19022261390361. distance: 242.712374787525
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  39, local model 63, internal_epoch   1,  Average loss: 0.0018, Accuracy: 854/889 (96.0630%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1525, Accuracy: 9522/10000 (95.2200%)
___Train Local_Simple,  epoch  39, local model 99, internal_epoch   1,  Average loss: 0.0009, Accuracy: 375/377 (99.4695%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.0972, Accuracy: 9703/10000 (97.0300%)
___Train Local_Simple,  epoch  39, local model 97, internal_epoch   1,  Average loss: 0.0010, Accuracy: 477/487 (97.9466%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2398, Accuracy: 9227/10000 (92.2700%)
___Train Local_Simple,  epoch  39, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 850/860 (98.8372%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4350, Accuracy: 8758/10000 (87.5800%)
___Train Local_Simple,  epoch  39, local model 44, internal_epoch   1,  Average loss: 0.0027, Accuracy: 500/517 (96.7118%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1271, Accuracy: 9599/10000 (95.9900%)
___Train Local_Simple,  epoch  39, local model 52, internal_epoch   1,  Average loss: 0.0010, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1295, Accuracy: 9630/10000 (96.3000%)
time spent on training: 80.57229590415955
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.407011393514461  data num: [606, 591, 568, 557, 889, 377, 487, 860, 517, 253]
[rfa agg] considering poison per batch poison_fraction: 0.12719106047326906
[rfa agg] init. name: [41, 73, 51, 74, 63, 99, 97, 37, 44, 52], weight: tensor([0.1062, 0.1036, 0.0996, 0.0976, 0.1558, 0.0661, 0.0854, 0.1507, 0.0906,
        0.0443])
[rfa agg] iter:  0, prev_obj_val: 115.92655181884766, obj_val: 102.50675201416016, abs dis: 13.4197998046875
[rfa agg] iter:  0, weight: tensor([0.0490, 0.0425, 0.0422, 0.0387, 0.2172, 0.0923, 0.1191, 0.2105, 0.1265,
        0.0620])
[rfa agg] iter:  1, prev_obj_val: 102.50675201416016, obj_val: 97.44966125488281, abs dis: 5.057090759277344
[rfa agg] iter:  1, weight: tensor([0.0215, 0.0184, 0.0181, 0.0168, 0.2425, 0.1033, 0.1331, 0.2354, 0.1414,
        0.0695])
[rfa agg] iter:  2, prev_obj_val: 97.44966125488281, obj_val: 95.35881805419922, abs dis: 2.0908432006835938
[rfa agg] iter:  2, weight: tensor([0.0094, 0.0080, 0.0079, 0.0074, 0.2527, 0.1085, 0.1390, 0.2464, 0.1478,
        0.0730])
[rfa agg] iter:  3, prev_obj_val: 95.35881805419922, obj_val: 94.49529266357422, abs dis: 0.863525390625
[rfa agg] iter:  3, weight: tensor([0.0041, 0.0035, 0.0035, 0.0033, 0.2553, 0.1118, 0.1412, 0.2512, 0.1505,
        0.0755])
[rfa agg] iter:  4, prev_obj_val: 94.49529266357422, obj_val: 94.17974090576172, abs dis: 0.3155517578125
[rfa agg] iter:  4, weight: tensor([0.0019, 0.0016, 0.0016, 0.0015, 0.2523, 0.1168, 0.1413, 0.2516, 0.1518,
        0.0796])
[rfa agg] iter:  5, prev_obj_val: 94.17974090576172, obj_val: 94.10166931152344, abs dis: 0.07807159423828125
[rfa agg] iter:  5, weight: tensor([0.0010, 0.0009, 0.0009, 0.0008, 0.2435, 0.1294, 0.1390, 0.2431, 0.1525,
        0.0890])
[rfa agg] iter:  6, prev_obj_val: 94.10166931152344, obj_val: 94.09150695800781, abs dis: 0.010162353515625
[rfa agg] iter:  6, weight: tensor([0.0007, 0.0006, 0.0006, 0.0006, 0.2327, 0.1480, 0.1359, 0.2271, 0.1524,
        0.1015])
[rfa agg] iter:  7, prev_obj_val: 94.09150695800781, obj_val: 94.09068298339844, abs dis: 0.000823974609375
[rfa agg] iter:  7, weight: tensor([0.0006, 0.0006, 0.0005, 0.0005, 0.2258, 0.1603, 0.1348, 0.2157, 0.1526,
        0.1086])
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.0912, Accuracy: 9747/10000 (97.4700%)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 5.0862, Accuracy: 114/8968 (1.2712%)
Done in 96.09939527511597 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:40 choose agents : [41, 73, 51, 74, 88, 25, 28, 8, 16, 6]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   1,  Average loss: 0.0158, Accuracy: 378/606 (62.3762%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   2,  Average loss: 0.0121, Accuracy: 385/606 (63.5314%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   3,  Average loss: 0.0103, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   4,  Average loss: 0.0105, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   5,  Average loss: 0.0102, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   6,  Average loss: 0.0100, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   7,  Average loss: 0.0097, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   8,  Average loss: 0.0095, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Global model norm: 16.434190308134575.
Norm before scaling: 16.445191879011325. Distance: 2.2321546499758234
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.0555, Accuracy: 5503/10000 (55.0300%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.6699, Accuracy: 6170/8968 (68.8002%)
Scaling by  100
Scaled Norm after poisoning: 222.78498252238637, distance: 223.21546660401918
Total norm for 4 adversaries is: 222.78498252238637. distance: 223.21546660401918
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   1,  Average loss: 0.0196, Accuracy: 340/591 (57.5296%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   2,  Average loss: 0.0194, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   3,  Average loss: 0.0130, Accuracy: 374/591 (63.2826%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   4,  Average loss: 0.0128, Accuracy: 351/591 (59.3909%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   5,  Average loss: 0.0125, Accuracy: 395/591 (66.8359%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   6,  Average loss: 0.0114, Accuracy: 426/591 (72.0812%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   7,  Average loss: 0.0106, Accuracy: 442/591 (74.7885%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   8,  Average loss: 0.0092, Accuracy: 488/591 (82.5719%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   9,  Average loss: 0.0078, Accuracy: 523/591 (88.4941%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch  10,  Average loss: 0.0075, Accuracy: 526/591 (89.0017%), train_poison_data_count: 195
Global model norm: 16.434190308134575.
Norm before scaling: 16.511808851333303. Distance: 2.3285811828589518
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.7786, Accuracy: 6713/10000 (67.1300%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.2602, Accuracy: 8271/8968 (92.2279%)
Scaling by  100
Scaled Norm after poisoning: 232.82285211883735, distance: 232.85810794881075
Total norm for 4 adversaries is: 232.82285211883735. distance: 232.85810794881075
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0150, Accuracy: 359/568 (63.2042%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   2,  Average loss: 0.0113, Accuracy: 377/568 (66.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   3,  Average loss: 0.0086, Accuracy: 420/568 (73.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   4,  Average loss: 0.0074, Accuracy: 469/568 (82.5704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   5,  Average loss: 0.0060, Accuracy: 521/568 (91.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   6,  Average loss: 0.0047, Accuracy: 527/568 (92.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   7,  Average loss: 0.0036, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   8,  Average loss: 0.0029, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   9,  Average loss: 0.0024, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch  10,  Average loss: 0.0024, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Global model norm: 16.434190308134575.
Norm before scaling: 16.579138348211604. Distance: 2.4980104158915815
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.8263, Accuracy: 7055/10000 (70.5500%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0649, Accuracy: 8767/8968 (97.7587%)
Scaling by  100
Scaled Norm after poisoning: 250.05031524925138, distance: 249.8010536532022
Total norm for 4 adversaries is: 250.05031524925138. distance: 249.8010536532022
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   1,  Average loss: 0.0132, Accuracy: 393/557 (70.5566%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 488/557 (87.6122%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   3,  Average loss: 0.0028, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   4,  Average loss: 0.0024, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   5,  Average loss: 0.0020, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   7,  Average loss: 0.0014, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch  10,  Average loss: 0.0013, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Global model norm: 16.434190308134575.
Norm before scaling: 16.65153141711465. Distance: 2.5790155895482316
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.4537, Accuracy: 8642/10000 (86.4200%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0436, Accuracy: 8800/8968 (98.1267%)
Scaling by  100
Scaled Norm after poisoning: 258.52902702114517, distance: 257.9015679479285
Total norm for 4 adversaries is: 258.52902702114517. distance: 257.9015679479285
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  40, local model 88, internal_epoch   1,  Average loss: 0.0008, Accuracy: 526/530 (99.2453%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1600, Accuracy: 9488/10000 (94.8800%)
___Train Local_Simple,  epoch  40, local model 25, internal_epoch   1,  Average loss: 0.0017, Accuracy: 631/647 (97.5270%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2137, Accuracy: 9295/10000 (92.9500%)
___Train Local_Simple,  epoch  40, local model 28, internal_epoch   1,  Average loss: 0.0014, Accuracy: 492/501 (98.2036%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1204, Accuracy: 9588/10000 (95.8800%)
___Train Local_Simple,  epoch  40, local model 8, internal_epoch   1,  Average loss: 0.0015, Accuracy: 614/633 (96.9984%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1500, Accuracy: 9543/10000 (95.4300%)
___Train Local_Simple,  epoch  40, local model 16, internal_epoch   1,  Average loss: 0.0011, Accuracy: 896/915 (97.9235%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1338, Accuracy: 9591/10000 (95.9100%)
___Train Local_Simple,  epoch  40, local model 6, internal_epoch   1,  Average loss: 0.0013, Accuracy: 602/615 (97.8862%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1641, Accuracy: 9478/10000 (94.7800%)
time spent on training: 83.66524744033813
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3767645627129645  data num: [606, 591, 568, 557, 530, 647, 501, 633, 915, 615]
[rfa agg] considering poison per batch poison_fraction: 0.1177389258478014
[rfa agg] init. name: [41, 73, 51, 74, 88, 25, 28, 8, 16, 6], weight: tensor([0.0983, 0.0959, 0.0922, 0.0904, 0.0860, 0.1050, 0.0813, 0.1027, 0.1485,
        0.0998])
[rfa agg] iter:  0, prev_obj_val: 114.55927276611328, obj_val: 99.1947250366211, abs dis: 15.364547729492188
[rfa agg] iter:  0, weight: tensor([0.0394, 0.0374, 0.0340, 0.0315, 0.1185, 0.1446, 0.1119, 0.1414, 0.2040,
        0.1374])
[rfa agg] iter:  1, prev_obj_val: 99.1947250366211, obj_val: 93.86611938476562, abs dis: 5.328605651855469
[rfa agg] iter:  1, weight: tensor([0.0152, 0.0143, 0.0128, 0.0120, 0.1308, 0.1597, 0.1234, 0.1560, 0.2242,
        0.1515])
[rfa agg] iter:  2, prev_obj_val: 93.86611938476562, obj_val: 91.90673828125, abs dis: 1.959381103515625
[rfa agg] iter:  2, weight: tensor([0.0058, 0.0054, 0.0049, 0.0046, 0.1361, 0.1659, 0.1280, 0.1619, 0.2302,
        0.1571])
[rfa agg] iter:  3, prev_obj_val: 91.90673828125, obj_val: 91.2176284790039, abs dis: 0.6891098022460938
[rfa agg] iter:  3, weight: tensor([0.0023, 0.0021, 0.0019, 0.0018, 0.1399, 0.1689, 0.1307, 0.1650, 0.2278,
        0.1597])
[rfa agg] iter:  4, prev_obj_val: 91.2176284790039, obj_val: 91.0344009399414, abs dis: 0.1832275390625
[rfa agg] iter:  4, weight: tensor([0.0010, 0.0009, 0.0008, 0.0008, 0.1475, 0.1676, 0.1355, 0.1690, 0.2156,
        0.1614])
[rfa agg] iter:  5, prev_obj_val: 91.0344009399414, obj_val: 91.01065063476562, abs dis: 0.02375030517578125
[rfa agg] iter:  5, weight: tensor([0.0006, 0.0005, 0.0005, 0.0004, 0.1612, 0.1571, 0.1454, 0.1743, 0.1986,
        0.1614])
[rfa agg] iter:  6, prev_obj_val: 91.01065063476562, obj_val: 91.00934600830078, abs dis: 0.00130462646484375
[rfa agg] iter:  6, weight: tensor([0.0005, 0.0004, 0.0004, 0.0004, 0.1700, 0.1480, 0.1528, 0.1774, 0.1899,
        0.1602])
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.0903, Accuracy: 9752/10000 (97.5200%)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 5.1229, Accuracy: 121/8968 (1.3492%)
Done in 99.01476097106934 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:41 choose agents : [41, 73, 51, 74, 3, 23, 44, 27, 86, 37]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   1,  Average loss: 0.0163, Accuracy: 365/606 (60.2310%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   2,  Average loss: 0.0141, Accuracy: 352/606 (58.0858%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   3,  Average loss: 0.0121, Accuracy: 397/606 (65.5116%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   4,  Average loss: 0.0111, Accuracy: 400/606 (66.0066%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   5,  Average loss: 0.0104, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   6,  Average loss: 0.0105, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   7,  Average loss: 0.0101, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   8,  Average loss: 0.0096, Accuracy: 434/606 (71.6172%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   9,  Average loss: 0.0097, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch  10,  Average loss: 0.0100, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Global model norm: 16.435551400957486.
Norm before scaling: 16.46511667552562. Distance: 2.3001733051188866
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.9937, Accuracy: 5669/10000 (56.6900%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.7763, Accuracy: 5487/8968 (61.1842%)
Scaling by  100
Scaled Norm after poisoning: 229.66560269770483, distance: 230.0173396996409
Total norm for 4 adversaries is: 229.66560269770483. distance: 230.0173396996409
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   1,  Average loss: 0.0196, Accuracy: 327/591 (55.3299%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   2,  Average loss: 0.0192, Accuracy: 239/591 (40.4399%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   3,  Average loss: 0.0145, Accuracy: 349/591 (59.0525%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   4,  Average loss: 0.0128, Accuracy: 396/591 (67.0051%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   5,  Average loss: 0.0122, Accuracy: 418/591 (70.7276%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   6,  Average loss: 0.0112, Accuracy: 423/591 (71.5736%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   7,  Average loss: 0.0096, Accuracy: 486/591 (82.2335%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   8,  Average loss: 0.0075, Accuracy: 518/591 (87.6481%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   9,  Average loss: 0.0067, Accuracy: 537/591 (90.8629%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch  10,  Average loss: 0.0061, Accuracy: 539/591 (91.2014%), train_poison_data_count: 195
Global model norm: 16.435551400957486.
Norm before scaling: 16.54438776012645. Distance: 2.502954072866969
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.7222, Accuracy: 7264/10000 (72.6400%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.1709, Accuracy: 8526/8968 (95.0714%)
Scaling by  100
Scaled Norm after poisoning: 250.3005927255267, distance: 250.29541920498664
Total norm for 4 adversaries is: 250.3005927255267. distance: 250.29541920498664
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0138, Accuracy: 357/568 (62.8521%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   2,  Average loss: 0.0091, Accuracy: 428/568 (75.3521%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   3,  Average loss: 0.0061, Accuracy: 513/568 (90.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   4,  Average loss: 0.0050, Accuracy: 515/568 (90.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   5,  Average loss: 0.0036, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   6,  Average loss: 0.0027, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   7,  Average loss: 0.0021, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   8,  Average loss: 0.0017, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   9,  Average loss: 0.0013, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch  10,  Average loss: 0.0013, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Global model norm: 16.435551400957486.
Norm before scaling: 16.546131726106143. Distance: 2.2971630305093744
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6719, Accuracy: 7661/10000 (76.6100%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0597, Accuracy: 8768/8968 (97.7698%)
Scaling by  100
Scaled Norm after poisoning: 229.94940849836948, distance: 229.71630771725808
Total norm for 4 adversaries is: 229.94940849836948. distance: 229.71630771725808
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   1,  Average loss: 0.0123, Accuracy: 403/557 (72.3519%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 488/557 (87.6122%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   3,  Average loss: 0.0025, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   4,  Average loss: 0.0025, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   5,  Average loss: 0.0020, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   6,  Average loss: 0.0023, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   7,  Average loss: 0.0014, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch  10,  Average loss: 0.0015, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.435551400957486.
Norm before scaling: 16.62186075271997. Distance: 2.443431581791776
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4000, Accuracy: 8835/10000 (88.3500%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0582, Accuracy: 8733/8968 (97.3796%)
Scaling by  100
Scaled Norm after poisoning: 244.93379207451144, distance: 244.34316448644518
Total norm for 4 adversaries is: 244.93379207451144. distance: 244.34316448644518
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  41, local model 3, internal_epoch   1,  Average loss: 0.0017, Accuracy: 896/923 (97.0748%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2852, Accuracy: 9038/10000 (90.3800%)
___Train Local_Simple,  epoch  41, local model 23, internal_epoch   1,  Average loss: 0.0010, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1289, Accuracy: 9580/10000 (95.8000%)
___Train Local_Simple,  epoch  41, local model 44, internal_epoch   1,  Average loss: 0.0017, Accuracy: 501/517 (96.9052%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1118, Accuracy: 9669/10000 (96.6900%)
___Train Local_Simple,  epoch  41, local model 27, internal_epoch   1,  Average loss: 0.0016, Accuracy: 458/471 (97.2399%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2176, Accuracy: 9279/10000 (92.7900%)
___Train Local_Simple,  epoch  41, local model 86, internal_epoch   1,  Average loss: 0.0013, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.0966, Accuracy: 9720/10000 (97.2000%)
___Train Local_Simple,  epoch  41, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 842/860 (97.9070%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2766, Accuracy: 9146/10000 (91.4600%)
time spent on training: 79.72542023658752
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4119943222143364  data num: [606, 591, 568, 557, 923, 293, 517, 471, 250, 860]
[rfa agg] considering poison per batch poison_fraction: 0.12874822569198013
[rfa agg] init. name: [41, 73, 51, 74, 3, 23, 44, 27, 86, 37], weight: tensor([0.1075, 0.1049, 0.1008, 0.0988, 0.1638, 0.0520, 0.0917, 0.0836, 0.0444,
        0.1526])
[rfa agg] iter:  0, prev_obj_val: 121.14678192138672, obj_val: 107.58140563964844, abs dis: 13.565376281738281
[rfa agg] iter:  0, weight: tensor([0.0474, 0.0435, 0.0464, 0.0414, 0.2285, 0.0726, 0.1281, 0.1167, 0.0620,
        0.2133])
[rfa agg] iter:  1, prev_obj_val: 107.58140563964844, obj_val: 102.34967803955078, abs dis: 5.231727600097656
[rfa agg] iter:  1, weight: tensor([0.0214, 0.0193, 0.0205, 0.0186, 0.2557, 0.0815, 0.1435, 0.1307, 0.0696,
        0.2393])
[rfa agg] iter:  2, prev_obj_val: 102.34967803955078, obj_val: 100.13072967529297, abs dis: 2.2189483642578125
[rfa agg] iter:  2, weight: tensor([0.0097, 0.0087, 0.0091, 0.0084, 0.2669, 0.0855, 0.1502, 0.1369, 0.0732,
        0.2514])
[rfa agg] iter:  3, prev_obj_val: 100.13072967529297, obj_val: 99.18527221679688, abs dis: 0.9454574584960938
[rfa agg] iter:  3, weight: tensor([0.0044, 0.0039, 0.0041, 0.0038, 0.2698, 0.0879, 0.1532, 0.1396, 0.0756,
        0.2576])
[rfa agg] iter:  4, prev_obj_val: 99.18527221679688, obj_val: 98.82122802734375, abs dis: 0.364044189453125
[rfa agg] iter:  4, weight: tensor([0.0021, 0.0019, 0.0019, 0.0018, 0.2651, 0.0907, 0.1551, 0.1412, 0.0789,
        0.2613])
[rfa agg] iter:  5, prev_obj_val: 98.82122802734375, obj_val: 98.7208023071289, abs dis: 0.10042572021484375
[rfa agg] iter:  5, weight: tensor([0.0011, 0.0010, 0.0010, 0.0010, 0.2498, 0.0973, 0.1585, 0.1434, 0.0866,
        0.2603])
[rfa agg] iter:  6, prev_obj_val: 98.7208023071289, obj_val: 98.7052001953125, abs dis: 0.01560211181640625
[rfa agg] iter:  6, weight: tensor([0.0008, 0.0007, 0.0007, 0.0007, 0.2288, 0.1081, 0.1638, 0.1457, 0.0987,
        0.2520])
[rfa agg] iter:  7, prev_obj_val: 98.7052001953125, obj_val: 98.70365905761719, abs dis: 0.0015411376953125
[rfa agg] iter:  7, weight: tensor([0.0007, 0.0006, 0.0006, 0.0006, 0.2143, 0.1166, 0.1679, 0.1468, 0.1077,
        0.2442])
[rfa agg] iter:  8, prev_obj_val: 98.70365905761719, obj_val: 98.70350646972656, abs dis: 0.000152587890625
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0006, 0.0006, 0.0006, 0.2076, 0.1206, 0.1702, 0.1471, 0.1117,
        0.2404])
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.0898, Accuracy: 9750/10000 (97.5000%)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 5.0377, Accuracy: 125/8968 (1.3938%)
Done in 95.09662985801697 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:42 choose agents : [41, 73, 51, 74, 23, 35, 29, 48, 11, 43]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   1,  Average loss: 0.0158, Accuracy: 367/606 (60.5611%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   2,  Average loss: 0.0122, Accuracy: 390/606 (64.3564%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   3,  Average loss: 0.0108, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   4,  Average loss: 0.0103, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   5,  Average loss: 0.0106, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   6,  Average loss: 0.0105, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   7,  Average loss: 0.0101, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   8,  Average loss: 0.0102, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   9,  Average loss: 0.0094, Accuracy: 437/606 (72.1122%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch  10,  Average loss: 0.0099, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Global model norm: 16.434764097706594.
Norm before scaling: 16.452863468363. Distance: 2.3020739202752853
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.9925, Accuracy: 5996/10000 (59.9600%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.8403, Accuracy: 5148/8968 (57.4041%)
Scaling by  100
Scaled Norm after poisoning: 229.77187225866007, distance: 230.20740478696595
Total norm for 4 adversaries is: 229.77187225866007. distance: 230.20740478696595
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   1,  Average loss: 0.0180, Accuracy: 331/591 (56.0068%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   2,  Average loss: 0.0167, Accuracy: 294/591 (49.7462%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   3,  Average loss: 0.0134, Accuracy: 378/591 (63.9594%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   4,  Average loss: 0.0128, Accuracy: 371/591 (62.7750%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   5,  Average loss: 0.0120, Accuracy: 375/591 (63.4518%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   6,  Average loss: 0.0107, Accuracy: 435/591 (73.6041%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   7,  Average loss: 0.0098, Accuracy: 459/591 (77.6650%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   8,  Average loss: 0.0076, Accuracy: 519/591 (87.8173%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   9,  Average loss: 0.0059, Accuracy: 551/591 (93.2318%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch  10,  Average loss: 0.0060, Accuracy: 551/591 (93.2318%), train_poison_data_count: 195
Global model norm: 16.434764097706594.
Norm before scaling: 16.478227526705503. Distance: 2.1948657684297146
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6549, Accuracy: 7606/10000 (76.0600%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.1955, Accuracy: 8376/8968 (93.3988%)
Scaling by  100
Scaled Norm after poisoning: 219.33026609430812, distance: 219.48658130965546
Total norm for 4 adversaries is: 219.33026609430812. distance: 219.48658130965546
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   1,  Average loss: 0.0142, Accuracy: 349/568 (61.4437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   2,  Average loss: 0.0103, Accuracy: 406/568 (71.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   3,  Average loss: 0.0081, Accuracy: 449/568 (79.0493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   4,  Average loss: 0.0063, Accuracy: 513/568 (90.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   5,  Average loss: 0.0048, Accuracy: 526/568 (92.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   6,  Average loss: 0.0036, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   7,  Average loss: 0.0027, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   8,  Average loss: 0.0019, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   9,  Average loss: 0.0015, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch  10,  Average loss: 0.0016, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Global model norm: 16.434764097706594.
Norm before scaling: 16.557913206261645. Distance: 2.3499030154080254
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6297, Accuracy: 7834/10000 (78.3400%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0618, Accuracy: 8776/8968 (97.8591%)
Scaling by  100
Scaled Norm after poisoning: 235.25442510450256, distance: 234.9903255987361
Total norm for 4 adversaries is: 235.25442510450256. distance: 234.9903255987361
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   1,  Average loss: 0.0137, Accuracy: 384/557 (68.9408%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 493/557 (88.5099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   3,  Average loss: 0.0028, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   4,  Average loss: 0.0024, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   5,  Average loss: 0.0021, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   6,  Average loss: 0.0019, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   8,  Average loss: 0.0013, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   9,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.434764097706594.
Norm before scaling: 16.63004908936963. Distance: 2.4740718989490653
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3893, Accuracy: 8854/10000 (88.5400%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0542, Accuracy: 8764/8968 (97.7252%)
Scaling by  100
Scaled Norm after poisoning: 248.02020772005656, distance: 247.40717956437723
Total norm for 4 adversaries is: 248.02020772005656. distance: 247.40717956437723
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  42, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1343, Accuracy: 9564/10000 (95.6400%)
___Train Local_Simple,  epoch  42, local model 35, internal_epoch   1,  Average loss: 0.0009, Accuracy: 491/499 (98.3968%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1610, Accuracy: 9500/10000 (95.0000%)
___Train Local_Simple,  epoch  42, local model 29, internal_epoch   1,  Average loss: 0.0011, Accuracy: 983/1002 (98.1038%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2944, Accuracy: 9120/10000 (91.2000%)
___Train Local_Simple,  epoch  42, local model 48, internal_epoch   1,  Average loss: 0.0010, Accuracy: 440/448 (98.2143%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.0972, Accuracy: 9698/10000 (96.9800%)
___Train Local_Simple,  epoch  42, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 633/645 (98.1395%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1863, Accuracy: 9373/10000 (93.7300%)
___Train Local_Simple,  epoch  42, local model 43, internal_epoch   1,  Average loss: 0.0012, Accuracy: 401/408 (98.2843%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1465, Accuracy: 9549/10000 (95.4900%)
time spent on training: 80.13149118423462
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41338792949973296  data num: [606, 591, 568, 557, 293, 499, 1002, 448, 645, 408]
[rfa agg] considering poison per batch poison_fraction: 0.12918372796866656
[rfa agg] init. name: [41, 73, 51, 74, 23, 35, 29, 48, 11, 43], weight: tensor([0.1079, 0.1052, 0.1011, 0.0992, 0.0522, 0.0888, 0.1784, 0.0798, 0.1148,
        0.0726])
[rfa agg] iter:  0, prev_obj_val: 118.40544891357422, obj_val: 105.14087677001953, abs dis: 13.264572143554688
[rfa agg] iter:  0, weight: tensor([0.0457, 0.0483, 0.0437, 0.0397, 0.0732, 0.1246, 0.2503, 0.1119, 0.1608,
        0.1019])
[rfa agg] iter:  1, prev_obj_val: 105.14087677001953, obj_val: 100.09114074707031, abs dis: 5.049736022949219
[rfa agg] iter:  1, weight: tensor([0.0205, 0.0213, 0.0191, 0.0175, 0.0821, 0.1397, 0.2805, 0.1254, 0.1798,
        0.1142])
[rfa agg] iter:  2, prev_obj_val: 100.09114074707031, obj_val: 97.96674346923828, abs dis: 2.1243972778320312
[rfa agg] iter:  2, weight: tensor([0.0092, 0.0094, 0.0085, 0.0078, 0.0862, 0.1465, 0.2939, 0.1315, 0.1874,
        0.1196])
[rfa agg] iter:  3, prev_obj_val: 97.96674346923828, obj_val: 97.06292724609375, abs dis: 0.9038162231445312
[rfa agg] iter:  3, weight: tensor([0.0041, 0.0042, 0.0038, 0.0035, 0.0885, 0.1500, 0.2997, 0.1346, 0.1891,
        0.1223])
[rfa agg] iter:  4, prev_obj_val: 97.06292724609375, obj_val: 96.70831298828125, abs dis: 0.3546142578125
[rfa agg] iter:  4, weight: tensor([0.0019, 0.0020, 0.0018, 0.0016, 0.0913, 0.1533, 0.3005, 0.1376, 0.1859,
        0.1242])
[rfa agg] iter:  5, prev_obj_val: 96.70831298828125, obj_val: 96.60496520996094, abs dis: 0.1033477783203125
[rfa agg] iter:  5, weight: tensor([0.0010, 0.0010, 0.0009, 0.0008, 0.0973, 0.1595, 0.2920, 0.1434, 0.1769,
        0.1272])
[rfa agg] iter:  6, prev_obj_val: 96.60496520996094, obj_val: 96.58781433105469, abs dis: 0.01715087890625
[rfa agg] iter:  6, weight: tensor([0.0007, 0.0007, 0.0006, 0.0006, 0.1072, 0.1687, 0.2718, 0.1527, 0.1659,
        0.1311])
[rfa agg] iter:  7, prev_obj_val: 96.58781433105469, obj_val: 96.58599090576172, abs dis: 0.00182342529296875
[rfa agg] iter:  7, weight: tensor([0.0006, 0.0006, 0.0005, 0.0005, 0.1146, 0.1761, 0.2528, 0.1606, 0.1597,
        0.1341])
[rfa agg] iter:  8, prev_obj_val: 96.58599090576172, obj_val: 96.58577728271484, abs dis: 0.000213623046875
[rfa agg] iter:  8, weight: tensor([0.0005, 0.0005, 0.0005, 0.0005, 0.1178, 0.1801, 0.2417, 0.1651, 0.1573,
        0.1360])
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.0886, Accuracy: 9755/10000 (97.5500%)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 5.0787, Accuracy: 124/8968 (1.3827%)
Done in 95.65620064735413 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:43 choose agents : [41, 73, 51, 74, 33, 12, 97, 15, 42, 20]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   1,  Average loss: 0.0153, Accuracy: 366/606 (60.3960%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   2,  Average loss: 0.0124, Accuracy: 368/606 (60.7261%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   3,  Average loss: 0.0100, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   4,  Average loss: 0.0103, Accuracy: 400/606 (66.0066%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   5,  Average loss: 0.0099, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   6,  Average loss: 0.0098, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   7,  Average loss: 0.0097, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   9,  Average loss: 0.0096, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Global model norm: 16.434263657756507.
Norm before scaling: 16.443073444664797. Distance: 2.001235103706613
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.8230, Accuracy: 6613/10000 (66.1300%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.8725, Accuracy: 4678/8968 (52.1632%)
Scaling by  100
Scaled Norm after poisoning: 199.86990886261492, distance: 200.12351654665676
Total norm for 4 adversaries is: 199.86990886261492. distance: 200.12351654665676
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   1,  Average loss: 0.0199, Accuracy: 332/591 (56.1760%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   2,  Average loss: 0.0209, Accuracy: 224/591 (37.9019%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   3,  Average loss: 0.0138, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   4,  Average loss: 0.0137, Accuracy: 355/591 (60.0677%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   5,  Average loss: 0.0130, Accuracy: 375/591 (63.4518%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   6,  Average loss: 0.0112, Accuracy: 440/591 (74.4501%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   7,  Average loss: 0.0098, Accuracy: 482/591 (81.5567%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   8,  Average loss: 0.0074, Accuracy: 531/591 (89.8477%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   9,  Average loss: 0.0062, Accuracy: 530/591 (89.6785%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch  10,  Average loss: 0.0058, Accuracy: 547/591 (92.5550%), train_poison_data_count: 195
Global model norm: 16.434263657756507.
Norm before scaling: 16.555379697362067. Distance: 2.7648326363708007
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.7592, Accuracy: 6926/10000 (69.2600%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.1181, Accuracy: 8691/8968 (96.9112%)
Scaling by  100
Scaled Norm after poisoning: 276.3118002139974, distance: 276.4832725500767
Total norm for 4 adversaries is: 276.3118002139974. distance: 276.4832725500767
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   1,  Average loss: 0.0141, Accuracy: 365/568 (64.2606%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   2,  Average loss: 0.0095, Accuracy: 419/568 (73.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   3,  Average loss: 0.0056, Accuracy: 508/568 (89.4366%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   4,  Average loss: 0.0049, Accuracy: 515/568 (90.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   5,  Average loss: 0.0036, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   6,  Average loss: 0.0026, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   7,  Average loss: 0.0020, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   8,  Average loss: 0.0017, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   9,  Average loss: 0.0017, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch  10,  Average loss: 0.0015, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Global model norm: 16.434263657756507.
Norm before scaling: 16.556882891829307. Distance: 2.313448530987838
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.5773, Accuracy: 8142/10000 (81.4200%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0940, Accuracy: 8619/8968 (96.1084%)
Scaling by  100
Scaled Norm after poisoning: 231.64598697419734, distance: 231.34487074225353
Total norm for 4 adversaries is: 231.64598697419734. distance: 231.34487074225353
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   1,  Average loss: 0.0134, Accuracy: 394/557 (70.7361%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 485/557 (87.0736%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   3,  Average loss: 0.0025, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   4,  Average loss: 0.0021, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   5,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   6,  Average loss: 0.0016, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.434263657756507.
Norm before scaling: 16.67266300416315. Distance: 2.5926474560377137
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.4469, Accuracy: 8635/10000 (86.3500%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0448, Accuracy: 8804/8968 (98.1713%)
Scaling by  100
Scaled Norm after poisoning: 260.0103513564412, distance: 259.2647506652225
Total norm for 4 adversaries is: 260.0103513564412. distance: 259.2647506652225
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  43, local model 33, internal_epoch   1,  Average loss: 0.0015, Accuracy: 603/623 (96.7897%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1598, Accuracy: 9460/10000 (94.6000%)
___Train Local_Simple,  epoch  43, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1132/1160 (97.5862%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3324, Accuracy: 9126/10000 (91.2600%)
___Train Local_Simple,  epoch  43, local model 97, internal_epoch   1,  Average loss: 0.0010, Accuracy: 479/487 (98.3573%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2305, Accuracy: 9239/10000 (92.3900%)
___Train Local_Simple,  epoch  43, local model 15, internal_epoch   1,  Average loss: 0.0012, Accuracy: 393/401 (98.0050%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1378, Accuracy: 9556/10000 (95.5600%)
___Train Local_Simple,  epoch  43, local model 42, internal_epoch   1,  Average loss: 0.0015, Accuracy: 232/236 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0989, Accuracy: 9699/10000 (96.9900%)
___Train Local_Simple,  epoch  43, local model 20, internal_epoch   1,  Average loss: 0.0014, Accuracy: 422/429 (98.3683%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2294, Accuracy: 9283/10000 (92.8300%)
time spent on training: 80.97932195663452
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41039236479321317  data num: [606, 591, 568, 557, 623, 1160, 487, 401, 236, 429]
[rfa agg] considering poison per batch poison_fraction: 0.12824761399787912
[rfa agg] init. name: [41, 73, 51, 74, 33, 12, 97, 15, 42, 20], weight: tensor([0.1071, 0.1045, 0.1004, 0.0984, 0.1101, 0.2050, 0.0861, 0.0709, 0.0417,
        0.0758])
[rfa agg] iter:  0, prev_obj_val: 122.3553466796875, obj_val: 108.14187622070312, abs dis: 14.213470458984375
[rfa agg] iter:  0, weight: tensor([0.0531, 0.0383, 0.0451, 0.0380, 0.1541, 0.2868, 0.1206, 0.0993, 0.0585,
        0.1063])
[rfa agg] iter:  1, prev_obj_val: 108.14187622070312, obj_val: 102.90836334228516, abs dis: 5.233512878417969
[rfa agg] iter:  1, weight: tensor([0.0234, 0.0163, 0.0191, 0.0164, 0.1726, 0.3208, 0.1351, 0.1113, 0.0656,
        0.1193])
[rfa agg] iter:  2, prev_obj_val: 102.90836334228516, obj_val: 100.7655258178711, abs dis: 2.1428375244140625
[rfa agg] iter:  2, weight: tensor([0.0102, 0.0071, 0.0082, 0.0072, 0.1804, 0.3343, 0.1415, 0.1167, 0.0690,
        0.1254])
[rfa agg] iter:  3, prev_obj_val: 100.7655258178711, obj_val: 99.88895416259766, abs dis: 0.8765716552734375
[rfa agg] iter:  3, weight: tensor([0.0045, 0.0031, 0.0036, 0.0032, 0.1834, 0.3375, 0.1444, 0.1197, 0.0712,
        0.1293])
[rfa agg] iter:  4, prev_obj_val: 99.88895416259766, obj_val: 99.57493591308594, abs dis: 0.31401824951171875
[rfa agg] iter:  4, weight: tensor([0.0020, 0.0014, 0.0017, 0.0015, 0.1839, 0.3313, 0.1460, 0.1234, 0.0745,
        0.1342])
[rfa agg] iter:  5, prev_obj_val: 99.57493591308594, obj_val: 99.50083923339844, abs dis: 0.0740966796875
[rfa agg] iter:  5, weight: tensor([0.0011, 0.0008, 0.0009, 0.0008, 0.1823, 0.3132, 0.1466, 0.1311, 0.0812,
        0.1419])
[rfa agg] iter:  6, prev_obj_val: 99.50083923339844, obj_val: 99.49179077148438, abs dis: 0.0090484619140625
[rfa agg] iter:  6, weight: tensor([0.0008, 0.0006, 0.0007, 0.0006, 0.1809, 0.2909, 0.1466, 0.1414, 0.0894,
        0.1482])
[rfa agg] iter:  7, prev_obj_val: 99.49179077148438, obj_val: 99.4909896850586, abs dis: 0.00080108642578125
[rfa agg] iter:  7, weight: tensor([0.0007, 0.0005, 0.0006, 0.0005, 0.1812, 0.2755, 0.1476, 0.1482, 0.0943,
        0.1509])
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.0874, Accuracy: 9756/10000 (97.5600%)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 5.0873, Accuracy: 123/8968 (1.3715%)
Done in 96.75742626190186 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:44 choose agents : [41, 73, 51, 74, 90, 56, 54, 24, 38, 43]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   1,  Average loss: 0.0156, Accuracy: 369/606 (60.8911%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   2,  Average loss: 0.0115, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   3,  Average loss: 0.0108, Accuracy: 399/606 (65.8416%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   4,  Average loss: 0.0105, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   5,  Average loss: 0.0101, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   6,  Average loss: 0.0103, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   7,  Average loss: 0.0101, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   9,  Average loss: 0.0097, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Global model norm: 16.43415502592134.
Norm before scaling: 16.435913473518422. Distance: 2.126407942246013
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.8672, Accuracy: 6194/10000 (61.9400%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.8831, Accuracy: 4600/8968 (51.2935%)
Scaling by  100
Scaled Norm after poisoning: 212.2258433691571, distance: 212.64079894272408
Total norm for 4 adversaries is: 212.2258433691571. distance: 212.64079894272408
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   1,  Average loss: 0.0192, Accuracy: 344/591 (58.2064%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   2,  Average loss: 0.0190, Accuracy: 280/591 (47.3773%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   3,  Average loss: 0.0146, Accuracy: 338/591 (57.1912%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   4,  Average loss: 0.0134, Accuracy: 357/591 (60.4061%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   5,  Average loss: 0.0128, Accuracy: 357/591 (60.4061%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   6,  Average loss: 0.0125, Accuracy: 381/591 (64.4670%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   7,  Average loss: 0.0107, Accuracy: 457/591 (77.3266%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   8,  Average loss: 0.0093, Accuracy: 469/591 (79.3570%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   9,  Average loss: 0.0088, Accuracy: 502/591 (84.9408%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch  10,  Average loss: 0.0081, Accuracy: 520/591 (87.9865%), train_poison_data_count: 195
Global model norm: 16.43415502592134.
Norm before scaling: 16.527811367025713. Distance: 2.401689840501021
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.7724, Accuracy: 6791/10000 (67.9100%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.3168, Accuracy: 8179/8968 (91.2021%)
Scaling by  100
Scaled Norm after poisoning: 240.17310651642495, distance: 240.16898347830013
Total norm for 4 adversaries is: 240.17310651642495. distance: 240.16898347830013
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   1,  Average loss: 0.0150, Accuracy: 364/568 (64.0845%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   2,  Average loss: 0.0105, Accuracy: 401/568 (70.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   3,  Average loss: 0.0081, Accuracy: 478/568 (84.1549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   4,  Average loss: 0.0063, Accuracy: 511/568 (89.9648%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   5,  Average loss: 0.0052, Accuracy: 523/568 (92.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   6,  Average loss: 0.0042, Accuracy: 527/568 (92.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   7,  Average loss: 0.0033, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   8,  Average loss: 0.0023, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   9,  Average loss: 0.0020, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch  10,  Average loss: 0.0022, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Global model norm: 16.43415502592134.
Norm before scaling: 16.55370399538414. Distance: 2.603796197606847
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.8533, Accuracy: 6740/10000 (67.4000%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0415, Accuracy: 8840/8968 (98.5727%)
Scaling by  100
Scaled Norm after poisoning: 260.35365070899235, distance: 260.3796056961835
Total norm for 4 adversaries is: 260.35365070899235. distance: 260.3796056961835
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   1,  Average loss: 0.0123, Accuracy: 409/557 (73.4291%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 496/557 (89.0485%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   3,  Average loss: 0.0022, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   4,  Average loss: 0.0023, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   5,  Average loss: 0.0018, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   8,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.43415502592134.
Norm before scaling: 16.62189471850917. Distance: 2.348366729827352
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3790, Accuracy: 8899/10000 (88.9900%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0455, Accuracy: 8800/8968 (98.1267%)
Scaling by  100
Scaled Norm after poisoning: 235.55776560644313, distance: 234.8366786194184
Total norm for 4 adversaries is: 235.55776560644313. distance: 234.8366786194184
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  44, local model 90, internal_epoch   1,  Average loss: 0.0019, Accuracy: 662/683 (96.9253%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3007, Accuracy: 9010/10000 (90.1000%)
___Train Local_Simple,  epoch  44, local model 56, internal_epoch   1,  Average loss: 0.0012, Accuracy: 863/880 (98.0682%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1745, Accuracy: 9409/10000 (94.0900%)
___Train Local_Simple,  epoch  44, local model 54, internal_epoch   1,  Average loss: 0.0015, Accuracy: 505/519 (97.3025%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2382, Accuracy: 9247/10000 (92.4700%)
___Train Local_Simple,  epoch  44, local model 24, internal_epoch   1,  Average loss: 0.0016, Accuracy: 365/379 (96.3061%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1181, Accuracy: 9659/10000 (96.5900%)
___Train Local_Simple,  epoch  44, local model 38, internal_epoch   1,  Average loss: 0.0014, Accuracy: 872/895 (97.4302%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1666, Accuracy: 9430/10000 (94.3000%)
___Train Local_Simple,  epoch  44, local model 43, internal_epoch   1,  Average loss: 0.0010, Accuracy: 399/408 (97.7941%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1949, Accuracy: 9354/10000 (93.5400%)
time spent on training: 80.11906838417053
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.38153138350312193  data num: [606, 591, 568, 557, 683, 880, 519, 379, 895, 408]
[rfa agg] considering poison per batch poison_fraction: 0.11922855734472561
[rfa agg] init. name: [41, 73, 51, 74, 90, 56, 54, 24, 38, 43], weight: tensor([0.0996, 0.0971, 0.0933, 0.0915, 0.1122, 0.1446, 0.0853, 0.0623, 0.1471,
        0.0670])
[rfa agg] iter:  0, prev_obj_val: 114.0155029296875, obj_val: 99.06324768066406, abs dis: 14.952255249023438
[rfa agg] iter:  0, weight: tensor([0.0428, 0.0375, 0.0338, 0.0356, 0.1543, 0.1985, 0.1173, 0.0857, 0.2021,
        0.0922])
[rfa agg] iter:  1, prev_obj_val: 99.06324768066406, obj_val: 93.72883605957031, abs dis: 5.33441162109375
[rfa agg] iter:  1, weight: tensor([0.0171, 0.0148, 0.0131, 0.0142, 0.1709, 0.2193, 0.1299, 0.0951, 0.2235,
        0.1021])
[rfa agg] iter:  2, prev_obj_val: 93.72883605957031, obj_val: 91.7051773071289, abs dis: 2.0236587524414062
[rfa agg] iter:  2, weight: tensor([0.0068, 0.0059, 0.0052, 0.0056, 0.1776, 0.2266, 0.1351, 0.0993, 0.2317,
        0.1062])
[rfa agg] iter:  3, prev_obj_val: 91.7051773071289, obj_val: 90.97144317626953, abs dis: 0.733734130859375
[rfa agg] iter:  3, weight: tensor([0.0027, 0.0024, 0.0021, 0.0023, 0.1806, 0.2272, 0.1374, 0.1027, 0.2339,
        0.1086])
[rfa agg] iter:  4, prev_obj_val: 90.97144317626953, obj_val: 90.76954650878906, abs dis: 0.20189666748046875
[rfa agg] iter:  4, weight: tensor([0.0012, 0.0010, 0.0009, 0.0010, 0.1817, 0.2232, 0.1379, 0.1097, 0.2310,
        0.1123])
[rfa agg] iter:  5, prev_obj_val: 90.76954650878906, obj_val: 90.7419662475586, abs dis: 0.02758026123046875
[rfa agg] iter:  5, weight: tensor([0.0007, 0.0006, 0.0006, 0.0006, 0.1797, 0.2182, 0.1353, 0.1226, 0.2230,
        0.1188])
[rfa agg] iter:  6, prev_obj_val: 90.7419662475586, obj_val: 90.74040222167969, abs dis: 0.00156402587890625
[rfa agg] iter:  6, weight: tensor([0.0006, 0.0005, 0.0005, 0.0005, 0.1773, 0.2166, 0.1326, 0.1310, 0.2169,
        0.1234])
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.0864, Accuracy: 9760/10000 (97.6000%)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 5.1334, Accuracy: 112/8968 (1.2489%)
Done in 95.36163067817688 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:45 choose agents : [41, 73, 51, 74, 32, 62, 8, 35, 96, 27]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   1,  Average loss: 0.0159, Accuracy: 372/606 (61.3861%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   2,  Average loss: 0.0116, Accuracy: 385/606 (63.5314%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   3,  Average loss: 0.0107, Accuracy: 399/606 (65.8416%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   4,  Average loss: 0.0102, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   5,  Average loss: 0.0105, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   6,  Average loss: 0.0097, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   7,  Average loss: 0.0097, Accuracy: 433/606 (71.4521%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   9,  Average loss: 0.0097, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Global model norm: 16.433373226919493.
Norm before scaling: 16.43231653210612. Distance: 2.054668353901706
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.8558, Accuracy: 6367/10000 (63.6700%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.8414, Accuracy: 5008/8968 (55.8430%)
Scaling by  100
Scaled Norm after poisoning: 205.08788131554726, distance: 205.4668369682806
Total norm for 4 adversaries is: 205.08788131554726. distance: 205.4668369682806
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   1,  Average loss: 0.0178, Accuracy: 353/591 (59.7293%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   2,  Average loss: 0.0165, Accuracy: 299/591 (50.5922%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   3,  Average loss: 0.0133, Accuracy: 385/591 (65.1438%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   4,  Average loss: 0.0120, Accuracy: 402/591 (68.0203%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   5,  Average loss: 0.0102, Accuracy: 445/591 (75.2961%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   6,  Average loss: 0.0084, Accuracy: 489/591 (82.7411%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   7,  Average loss: 0.0060, Accuracy: 536/591 (90.6937%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   8,  Average loss: 0.0042, Accuracy: 548/591 (92.7242%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   9,  Average loss: 0.0030, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch  10,  Average loss: 0.0028, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Global model norm: 16.433373226919493.
Norm before scaling: 16.535166862298745. Distance: 2.4338800007837964
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.6107, Accuracy: 7858/10000 (78.5800%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0997, Accuracy: 8690/8968 (96.9001%)
Scaling by  100
Scaled Norm after poisoning: 243.41528300416965, distance: 243.38800844793073
Total norm for 4 adversaries is: 243.41528300416965. distance: 243.38800844793073
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0155, Accuracy: 344/568 (60.5634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   2,  Average loss: 0.0100, Accuracy: 410/568 (72.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   3,  Average loss: 0.0072, Accuracy: 464/568 (81.6901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   4,  Average loss: 0.0055, Accuracy: 512/568 (90.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   5,  Average loss: 0.0041, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   6,  Average loss: 0.0030, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   7,  Average loss: 0.0023, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   8,  Average loss: 0.0017, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   9,  Average loss: 0.0013, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch  10,  Average loss: 0.0014, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Global model norm: 16.433373226919493.
Norm before scaling: 16.588590520270817. Distance: 2.4343158758816275
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5761, Accuracy: 8135/10000 (81.3500%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0907, Accuracy: 8635/8968 (96.2868%)
Scaling by  100
Scaled Norm after poisoning: 243.8215840399492, distance: 243.43157887535872
Total norm for 4 adversaries is: 243.8215840399492. distance: 243.43157887535872
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   1,  Average loss: 0.0120, Accuracy: 408/557 (73.2496%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 501/557 (89.9461%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   3,  Average loss: 0.0028, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   4,  Average loss: 0.0021, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   5,  Average loss: 0.0020, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   8,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   9,  Average loss: 0.0015, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch  10,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Global model norm: 16.433373226919493.
Norm before scaling: 16.623300106937627. Distance: 2.4484009175832817
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4099, Accuracy: 8790/10000 (87.9000%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0459, Accuracy: 8778/8968 (97.8814%)
Scaling by  100
Scaled Norm after poisoning: 245.4487599276069, distance: 244.84007854618082
Total norm for 4 adversaries is: 245.4487599276069. distance: 244.84007854618082
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  45, local model 32, internal_epoch   1,  Average loss: 0.0020, Accuracy: 932/977 (95.3941%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3154, Accuracy: 8908/10000 (89.0800%)
___Train Local_Simple,  epoch  45, local model 62, internal_epoch   1,  Average loss: 0.0010, Accuracy: 417/423 (98.5816%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.0980, Accuracy: 9705/10000 (97.0500%)
___Train Local_Simple,  epoch  45, local model 8, internal_epoch   1,  Average loss: 0.0017, Accuracy: 611/633 (96.5245%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1431, Accuracy: 9579/10000 (95.7900%)
___Train Local_Simple,  epoch  45, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 493/499 (98.7976%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1990, Accuracy: 9363/10000 (93.6300%)
___Train Local_Simple,  epoch  45, local model 96, internal_epoch   1,  Average loss: 0.0014, Accuracy: 657/672 (97.7679%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2148, Accuracy: 9287/10000 (92.8700%)
___Train Local_Simple,  epoch  45, local model 27, internal_epoch   1,  Average loss: 0.0016, Accuracy: 460/471 (97.6645%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2547, Accuracy: 9145/10000 (91.4500%)
time spent on training: 88.75639581680298
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3871935967983992  data num: [606, 591, 568, 557, 977, 423, 633, 499, 672, 471]
[rfa agg] considering poison per batch poison_fraction: 0.12099799899949976
[rfa agg] init. name: [41, 73, 51, 74, 32, 62, 8, 35, 96, 27], weight: tensor([0.1011, 0.0985, 0.0947, 0.0929, 0.1629, 0.0705, 0.1056, 0.0832, 0.1121,
        0.0785])
[rfa agg] iter:  0, prev_obj_val: 113.62187194824219, obj_val: 98.97711944580078, abs dis: 14.644752502441406
[rfa agg] iter:  0, weight: tensor([0.0435, 0.0368, 0.0359, 0.0343, 0.2255, 0.0979, 0.1465, 0.1154, 0.1552,
        0.1089])
[rfa agg] iter:  1, prev_obj_val: 98.97711944580078, obj_val: 93.83238983154297, abs dis: 5.1447296142578125
[rfa agg] iter:  1, weight: tensor([0.0175, 0.0144, 0.0139, 0.0135, 0.2491, 0.1087, 0.1625, 0.1279, 0.1718,
        0.1207])
[rfa agg] iter:  2, prev_obj_val: 93.83238983154297, obj_val: 91.89410400390625, abs dis: 1.9382858276367188
[rfa agg] iter:  2, weight: tensor([0.0069, 0.0057, 0.0055, 0.0053, 0.2568, 0.1136, 0.1694, 0.1331, 0.1781,
        0.1256])
[rfa agg] iter:  3, prev_obj_val: 91.89410400390625, obj_val: 91.19271087646484, abs dis: 0.7013931274414062
[rfa agg] iter:  3, weight: tensor([0.0028, 0.0023, 0.0022, 0.0021, 0.2542, 0.1176, 0.1738, 0.1365, 0.1807,
        0.1279])
[rfa agg] iter:  4, prev_obj_val: 91.19271087646484, obj_val: 90.99625396728516, abs dis: 0.1964569091796875
[rfa agg] iter:  4, weight: tensor([0.0012, 0.0010, 0.0010, 0.0009, 0.2360, 0.1261, 0.1782, 0.1427, 0.1839,
        0.1289])
[rfa agg] iter:  5, prev_obj_val: 90.99625396728516, obj_val: 90.96598052978516, abs dis: 0.0302734375
[rfa agg] iter:  5, weight: tensor([0.0007, 0.0006, 0.0006, 0.0005, 0.2029, 0.1423, 0.1793, 0.1550, 0.1917,
        0.1264])
[rfa agg] iter:  6, prev_obj_val: 90.96598052978516, obj_val: 90.96324920654297, abs dis: 0.0027313232421875
[rfa agg] iter:  6, weight: tensor([0.0006, 0.0005, 0.0005, 0.0004, 0.1787, 0.1547, 0.1774, 0.1662, 0.1992,
        0.1218])
[rfa agg] iter:  7, prev_obj_val: 90.96324920654297, obj_val: 90.96299743652344, abs dis: 0.00025177001953125
[rfa agg] iter:  7, weight: tensor([0.0005, 0.0005, 0.0004, 0.0004, 0.1681, 0.1599, 0.1764, 0.1721, 0.2027,
        0.1190])
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.0856, Accuracy: 9762/10000 (97.6200%)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 5.1368, Accuracy: 113/8968 (1.2600%)
Done in 107.17696952819824 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:46 choose agents : [41, 73, 51, 74, 58, 86, 89, 17, 80, 63]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   1,  Average loss: 0.0163, Accuracy: 377/606 (62.2112%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   2,  Average loss: 0.0141, Accuracy: 340/606 (56.1056%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   3,  Average loss: 0.0111, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   4,  Average loss: 0.0107, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   5,  Average loss: 0.0104, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   6,  Average loss: 0.0102, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   7,  Average loss: 0.0099, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   9,  Average loss: 0.0097, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Global model norm: 16.433084453274056.
Norm before scaling: 16.442128737244133. Distance: 2.2196392372767355
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.9957, Accuracy: 5544/10000 (55.4400%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.7599, Accuracy: 5738/8968 (63.9831%)
Scaling by  100
Scaled Norm after poisoning: 221.52894668361063, distance: 221.96390824298442
Total norm for 4 adversaries is: 221.52894668361063. distance: 221.96390824298442
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   1,  Average loss: 0.0202, Accuracy: 324/591 (54.8223%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   2,  Average loss: 0.0190, Accuracy: 254/591 (42.9780%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   3,  Average loss: 0.0146, Accuracy: 348/591 (58.8832%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   4,  Average loss: 0.0135, Accuracy: 368/591 (62.2673%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   5,  Average loss: 0.0120, Accuracy: 418/591 (70.7276%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   6,  Average loss: 0.0098, Accuracy: 479/591 (81.0491%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   7,  Average loss: 0.0068, Accuracy: 527/591 (89.1709%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   8,  Average loss: 0.0050, Accuracy: 539/591 (91.2014%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   9,  Average loss: 0.0038, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch  10,  Average loss: 0.0038, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Global model norm: 16.433084453274056.
Norm before scaling: 16.555364028767233. Distance: 2.789207647056934
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.8007, Accuracy: 7000/10000 (70.0000%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0953, Accuracy: 8683/8968 (96.8220%)
Scaling by  100
Scaled Norm after poisoning: 278.73329546360264, distance: 278.92075767590336
Total norm for 4 adversaries is: 278.73329546360264. distance: 278.92075767590336
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   1,  Average loss: 0.0144, Accuracy: 366/568 (64.4366%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   2,  Average loss: 0.0106, Accuracy: 397/568 (69.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   3,  Average loss: 0.0064, Accuracy: 473/568 (83.2746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   4,  Average loss: 0.0054, Accuracy: 523/568 (92.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   5,  Average loss: 0.0043, Accuracy: 529/568 (93.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   6,  Average loss: 0.0033, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   7,  Average loss: 0.0020, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   8,  Average loss: 0.0016, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   9,  Average loss: 0.0016, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch  10,  Average loss: 0.0016, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Global model norm: 16.433084453274056.
Norm before scaling: 16.57788016725431. Distance: 2.3758077753575138
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6852, Accuracy: 7690/10000 (76.9000%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0548, Accuracy: 8777/8968 (97.8702%)
Scaling by  100
Scaled Norm after poisoning: 237.96682738881904, distance: 237.58077573743208
Total norm for 4 adversaries is: 237.96682738881904. distance: 237.58077573743208
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   1,  Average loss: 0.0143, Accuracy: 371/557 (66.6068%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 495/557 (88.8689%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   3,  Average loss: 0.0023, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   4,  Average loss: 0.0023, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   5,  Average loss: 0.0022, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   6,  Average loss: 0.0019, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   7,  Average loss: 0.0020, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Global model norm: 16.433084453274056.
Norm before scaling: 16.632709751913733. Distance: 2.533664540758392
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.5023, Accuracy: 8430/10000 (84.3000%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0371, Accuracy: 8836/8968 (98.5281%)
Scaling by  100
Scaled Norm after poisoning: 253.9345311172744, distance: 253.36645120013424
Total norm for 4 adversaries is: 253.9345311172744. distance: 253.36645120013424
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  46, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 267/276 (96.7391%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1324, Accuracy: 9594/10000 (95.9400%)
___Train Local_Simple,  epoch  46, local model 86, internal_epoch   1,  Average loss: 0.0013, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0959, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch  46, local model 89, internal_epoch   1,  Average loss: 0.0008, Accuracy: 482/492 (97.9675%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1615, Accuracy: 9505/10000 (95.0500%)
___Train Local_Simple,  epoch  46, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 604/620 (97.4194%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1169, Accuracy: 9631/10000 (96.3100%)
___Train Local_Simple,  epoch  46, local model 80, internal_epoch   1,  Average loss: 0.0008, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1737, Accuracy: 9478/10000 (94.7800%)
___Train Local_Simple,  epoch  46, local model 63, internal_epoch   1,  Average loss: 0.0019, Accuracy: 854/889 (96.0630%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1510, Accuracy: 9516/10000 (95.1600%)
time spent on training: 88.7417106628418
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.43977272727272726  data num: [606, 591, 568, 557, 276, 250, 492, 620, 431, 889]
[rfa agg] considering poison per batch poison_fraction: 0.13742897727272727
[rfa agg] init. name: [41, 73, 51, 74, 58, 86, 89, 17, 80, 63], weight: tensor([0.1148, 0.1119, 0.1076, 0.1055, 0.0523, 0.0473, 0.0932, 0.1174, 0.0816,
        0.1684])
[rfa agg] iter:  0, prev_obj_val: 131.68814086914062, obj_val: 118.79314422607422, abs dis: 12.894996643066406
[rfa agg] iter:  0, weight: tensor([0.0592, 0.0469, 0.0539, 0.0482, 0.0739, 0.0670, 0.1318, 0.1658, 0.1154,
        0.2379])
[rfa agg] iter:  1, prev_obj_val: 118.79314422607422, obj_val: 113.6479721069336, abs dis: 5.145172119140625
[rfa agg] iter:  1, weight: tensor([0.0295, 0.0228, 0.0261, 0.0237, 0.0839, 0.0761, 0.1496, 0.1879, 0.1308,
        0.2696])
[rfa agg] iter:  2, prev_obj_val: 113.6479721069336, obj_val: 111.29179382324219, abs dis: 2.3561782836914062
[rfa agg] iter:  2, weight: tensor([0.0147, 0.0113, 0.0129, 0.0118, 0.0889, 0.0806, 0.1585, 0.1982, 0.1383,
        0.2847])
[rfa agg] iter:  3, prev_obj_val: 111.29179382324219, obj_val: 110.167236328125, abs dis: 1.1245574951171875
[rfa agg] iter:  3, weight: tensor([0.0074, 0.0057, 0.0065, 0.0059, 0.0916, 0.0832, 0.1634, 0.2028, 0.1420,
        0.2916])
[rfa agg] iter:  4, prev_obj_val: 110.167236328125, obj_val: 109.63506317138672, abs dis: 0.5321731567382812
[rfa agg] iter:  4, weight: tensor([0.0037, 0.0029, 0.0033, 0.0030, 0.0935, 0.0853, 0.1669, 0.2041, 0.1440,
        0.2933])
[rfa agg] iter:  5, prev_obj_val: 109.63506317138672, obj_val: 109.40538787841797, abs dis: 0.22967529296875
[rfa agg] iter:  5, weight: tensor([0.0019, 0.0015, 0.0017, 0.0016, 0.0954, 0.0883, 0.1710, 0.2032, 0.1456,
        0.2898])
[rfa agg] iter:  6, prev_obj_val: 109.40538787841797, obj_val: 109.32960510253906, abs dis: 0.07578277587890625
[rfa agg] iter:  6, weight: tensor([0.0011, 0.0009, 0.0010, 0.0009, 0.0976, 0.0938, 0.1769, 0.2015, 0.1477,
        0.2786])
[rfa agg] iter:  7, prev_obj_val: 109.32960510253906, obj_val: 109.31397247314453, abs dis: 0.01563262939453125
[rfa agg] iter:  7, weight: tensor([0.0008, 0.0006, 0.0007, 0.0006, 0.0991, 0.1015, 0.1830, 0.2012, 0.1511,
        0.2614])
[rfa agg] iter:  8, prev_obj_val: 109.31397247314453, obj_val: 109.31192016601562, abs dis: 0.00205230712890625
[rfa agg] iter:  8, weight: tensor([0.0007, 0.0005, 0.0006, 0.0005, 0.0994, 0.1075, 0.1867, 0.2026, 0.1545,
        0.2470])
[rfa agg] iter:  9, prev_obj_val: 109.31192016601562, obj_val: 109.31170654296875, abs dis: 0.000213623046875
[rfa agg] iter:  9, weight: tensor([0.0006, 0.0005, 0.0006, 0.0005, 0.0993, 0.1105, 0.1883, 0.2040, 0.1569,
        0.2388])
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.0859, Accuracy: 9760/10000 (97.6000%)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 5.0792, Accuracy: 118/8968 (1.3158%)
Done in 103.68425464630127 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:47 choose agents : [41, 73, 51, 74, 58, 26, 90, 89, 93, 79]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   1,  Average loss: 0.0156, Accuracy: 369/606 (60.8911%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   2,  Average loss: 0.0125, Accuracy: 349/606 (57.5908%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   3,  Average loss: 0.0109, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   4,  Average loss: 0.0101, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   5,  Average loss: 0.0100, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   6,  Average loss: 0.0097, Accuracy: 434/606 (71.6172%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   7,  Average loss: 0.0097, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   8,  Average loss: 0.0096, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Global model norm: 16.432178172481805.
Norm before scaling: 16.464212157963157. Distance: 2.143010279315285
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.8549, Accuracy: 6929/10000 (69.2900%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.9555, Accuracy: 4156/8968 (46.3426%)
Scaling by  100
Scaled Norm after poisoning: 214.1052968167766, distance: 214.3010349805852
Total norm for 4 adversaries is: 214.1052968167766. distance: 214.3010349805852
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   1,  Average loss: 0.0216, Accuracy: 323/591 (54.6531%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   2,  Average loss: 0.0206, Accuracy: 209/591 (35.3638%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   3,  Average loss: 0.0151, Accuracy: 327/591 (55.3299%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   4,  Average loss: 0.0124, Accuracy: 393/591 (66.4975%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   5,  Average loss: 0.0108, Accuracy: 476/591 (80.5415%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   6,  Average loss: 0.0084, Accuracy: 517/591 (87.4788%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   7,  Average loss: 0.0057, Accuracy: 543/591 (91.8782%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   8,  Average loss: 0.0044, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   9,  Average loss: 0.0030, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch  10,  Average loss: 0.0029, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Global model norm: 16.432178172481805.
Norm before scaling: 16.606803400698556. Distance: 3.054229780085406
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.7038, Accuracy: 7810/10000 (78.1000%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0519, Accuracy: 8799/8968 (98.1155%)
Scaling by  100
Scaled Norm after poisoning: 305.2823488182702, distance: 305.4229649191429
Total norm for 4 adversaries is: 305.2823488182702. distance: 305.4229649191429
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   1,  Average loss: 0.0143, Accuracy: 359/568 (63.2042%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   2,  Average loss: 0.0091, Accuracy: 426/568 (75.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   3,  Average loss: 0.0055, Accuracy: 519/568 (91.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   4,  Average loss: 0.0048, Accuracy: 524/568 (92.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   5,  Average loss: 0.0034, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   6,  Average loss: 0.0026, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   7,  Average loss: 0.0021, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   8,  Average loss: 0.0018, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   9,  Average loss: 0.0015, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch  10,  Average loss: 0.0016, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Global model norm: 16.432178172481805.
Norm before scaling: 16.565273758007574. Distance: 2.3886014065520276
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.7001, Accuracy: 7520/10000 (75.2000%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0505, Accuracy: 8801/8968 (98.1378%)
Scaling by  100
Scaled Norm after poisoning: 239.15021266716448, distance: 238.86013493779157
Total norm for 4 adversaries is: 239.15021266716448. distance: 238.86013493779157
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   1,  Average loss: 0.0112, Accuracy: 405/557 (72.7110%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 508/557 (91.2029%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   3,  Average loss: 0.0025, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   4,  Average loss: 0.0019, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   5,  Average loss: 0.0021, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   8,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch  10,  Average loss: 0.0015, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Global model norm: 16.432178172481805.
Norm before scaling: 16.613924625297845. Distance: 2.342419564607608
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3998, Accuracy: 8823/10000 (88.2300%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0522, Accuracy: 8760/8968 (97.6806%)
Scaling by  100
Scaled Norm after poisoning: 234.92810569140084, distance: 234.24195390397085
Total norm for 4 adversaries is: 234.92810569140084. distance: 234.24195390397085
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  47, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 267/276 (96.7391%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1718, Accuracy: 9485/10000 (94.8500%)
___Train Local_Simple,  epoch  47, local model 26, internal_epoch   1,  Average loss: 0.0012, Accuracy: 540/554 (97.4729%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0960, Accuracy: 9713/10000 (97.1300%)
___Train Local_Simple,  epoch  47, local model 90, internal_epoch   1,  Average loss: 0.0017, Accuracy: 666/683 (97.5110%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.4077, Accuracy: 8743/10000 (87.4300%)
___Train Local_Simple,  epoch  47, local model 89, internal_epoch   1,  Average loss: 0.0007, Accuracy: 484/492 (98.3740%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1401, Accuracy: 9570/10000 (95.7000%)
___Train Local_Simple,  epoch  47, local model 93, internal_epoch   1,  Average loss: 0.0005, Accuracy: 618/623 (99.1974%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1756, Accuracy: 9447/10000 (94.4700%)
___Train Local_Simple,  epoch  47, local model 79, internal_epoch   1,  Average loss: 0.0019, Accuracy: 175/182 (96.1538%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0912, Accuracy: 9746/10000 (97.4600%)
time spent on training: 80.52699208259583
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4524551831644583  data num: [606, 591, 568, 557, 276, 554, 683, 492, 623, 182]
[rfa agg] considering poison per batch poison_fraction: 0.14139224473889322
[rfa agg] init. name: [41, 73, 51, 74, 58, 26, 90, 89, 93, 79], weight: tensor([0.1181, 0.1152, 0.1107, 0.1085, 0.0538, 0.1080, 0.1331, 0.0959, 0.1214,
        0.0355])
[rfa agg] iter:  0, prev_obj_val: 134.65664672851562, obj_val: 121.83899688720703, abs dis: 12.817649841308594
[rfa agg] iter:  0, weight: tensor([0.0626, 0.0444, 0.0557, 0.0543, 0.0770, 0.1544, 0.1902, 0.1372, 0.1735,
        0.0508])
[rfa agg] iter:  1, prev_obj_val: 121.83899688720703, obj_val: 116.87813568115234, abs dis: 4.9608612060546875
[rfa agg] iter:  1, weight: tensor([0.0318, 0.0216, 0.0272, 0.0270, 0.0878, 0.1759, 0.2166, 0.1565, 0.1976,
        0.0579])
[rfa agg] iter:  2, prev_obj_val: 116.87813568115234, obj_val: 114.6078872680664, abs dis: 2.2702484130859375
[rfa agg] iter:  2, weight: tensor([0.0161, 0.0109, 0.0136, 0.0136, 0.0932, 0.1865, 0.2292, 0.1662, 0.2091,
        0.0616])
[rfa agg] iter:  3, prev_obj_val: 114.6078872680664, obj_val: 113.51293182373047, abs dis: 1.0949554443359375
[rfa agg] iter:  3, weight: tensor([0.0082, 0.0056, 0.0069, 0.0069, 0.0961, 0.1918, 0.2348, 0.1716, 0.2145,
        0.0637])
[rfa agg] iter:  4, prev_obj_val: 113.51293182373047, obj_val: 112.98295593261719, abs dis: 0.5299758911132812
[rfa agg] iter:  4, weight: tensor([0.0042, 0.0029, 0.0035, 0.0035, 0.0979, 0.1946, 0.2359, 0.1755, 0.2165,
        0.0654])
[rfa agg] iter:  5, prev_obj_val: 112.98295593261719, obj_val: 112.7422103881836, abs dis: 0.24074554443359375
[rfa agg] iter:  5, weight: tensor([0.0022, 0.0015, 0.0019, 0.0019, 0.0995, 0.1964, 0.2322, 0.1799, 0.2165,
        0.0679])
[rfa agg] iter:  6, prev_obj_val: 112.7422103881836, obj_val: 112.6530990600586, abs dis: 0.089111328125
[rfa agg] iter:  6, weight: tensor([0.0013, 0.0009, 0.0011, 0.0011, 0.1011, 0.1983, 0.2210, 0.1867, 0.2155,
        0.0732])
[rfa agg] iter:  7, prev_obj_val: 112.6530990600586, obj_val: 112.63092803955078, abs dis: 0.0221710205078125
[rfa agg] iter:  7, weight: tensor([0.0008, 0.0006, 0.0007, 0.0007, 0.1013, 0.2005, 0.2031, 0.1949, 0.2149,
        0.0824])
[rfa agg] iter:  8, prev_obj_val: 112.63092803955078, obj_val: 112.62744140625, abs dis: 0.00348663330078125
[rfa agg] iter:  8, weight: tensor([0.0007, 0.0005, 0.0006, 0.0006, 0.0997, 0.2026, 0.1875, 0.2006, 0.2155,
        0.0918])
[rfa agg] iter:  9, prev_obj_val: 112.62744140625, obj_val: 112.62702941894531, abs dis: 0.0004119873046875
[rfa agg] iter:  9, weight: tensor([0.0006, 0.0004, 0.0005, 0.0005, 0.0980, 0.2040, 0.1790, 0.2032, 0.2167,
        0.0970])
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.0863, Accuracy: 9759/10000 (97.5900%)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 5.0505, Accuracy: 121/8968 (1.3492%)
Done in 94.90146350860596 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:48 choose agents : [41, 73, 51, 74, 36, 67, 87, 65, 30, 98]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   1,  Average loss: 0.0150, Accuracy: 372/606 (61.3861%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   2,  Average loss: 0.0123, Accuracy: 391/606 (64.5215%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   3,  Average loss: 0.0104, Accuracy: 433/606 (71.4521%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   4,  Average loss: 0.0101, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   5,  Average loss: 0.0098, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   6,  Average loss: 0.0096, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   7,  Average loss: 0.0097, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Global model norm: 16.431917236060265.
Norm before scaling: 16.43695879723354. Distance: 2.024830106978777
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.7541, Accuracy: 6927/10000 (69.2700%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.8389, Accuracy: 5128/8968 (57.1811%)
Scaling by  100
Scaled Norm after poisoning: 202.178033008658, distance: 202.4830336256596
Total norm for 4 adversaries is: 202.178033008658. distance: 202.4830336256596
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 5935.8683, Accuracy: 1248/8968 (13.9161%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   1,  Average loss: 0.0214, Accuracy: 322/591 (54.4839%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   2,  Average loss: 0.0199, Accuracy: 245/591 (41.4552%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   3,  Average loss: 0.0141, Accuracy: 349/591 (59.0525%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   4,  Average loss: 0.0128, Accuracy: 397/591 (67.1743%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   5,  Average loss: 0.0117, Accuracy: 452/591 (76.4805%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   6,  Average loss: 0.0095, Accuracy: 483/591 (81.7259%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   7,  Average loss: 0.0068, Accuracy: 527/591 (89.1709%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   8,  Average loss: 0.0046, Accuracy: 551/591 (93.2318%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   9,  Average loss: 0.0033, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch  10,  Average loss: 0.0034, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Global model norm: 16.431917236060265.
Norm before scaling: 16.5906508258181. Distance: 2.869624378200124
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.6399, Accuracy: 8139/10000 (81.3900%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0874, Accuracy: 8682/8968 (96.8109%)
Scaling by  100
Scaled Norm after poisoning: 286.9113947501911, distance: 286.96244582261977
Total norm for 4 adversaries is: 286.9113947501911. distance: 286.96244582261977
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   1,  Average loss: 0.0140, Accuracy: 363/568 (63.9085%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   2,  Average loss: 0.0092, Accuracy: 437/568 (76.9366%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   3,  Average loss: 0.0048, Accuracy: 525/568 (92.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   4,  Average loss: 0.0042, Accuracy: 523/568 (92.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   5,  Average loss: 0.0031, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   6,  Average loss: 0.0022, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   7,  Average loss: 0.0021, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   8,  Average loss: 0.0016, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   9,  Average loss: 0.0015, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch  10,  Average loss: 0.0014, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Global model norm: 16.431917236060265.
Norm before scaling: 16.55537140222547. Distance: 2.3412252433188936
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.6482, Accuracy: 7701/10000 (77.0100%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0522, Accuracy: 8795/8968 (98.0709%)
Scaling by  100
Scaled Norm after poisoning: 234.39811552676784, distance: 234.1225140017508
Total norm for 4 adversaries is: 234.39811552676784. distance: 234.1225140017508
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0119, Accuracy: 411/557 (73.7882%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 490/557 (87.9713%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   3,  Average loss: 0.0026, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   4,  Average loss: 0.0022, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   5,  Average loss: 0.0016, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   6,  Average loss: 0.0016, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   8,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch  10,  Average loss: 0.0013, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Global model norm: 16.431917236060265.
Norm before scaling: 16.643078604323406. Distance: 2.4384441992308235
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4237, Accuracy: 8772/10000 (87.7200%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0344, Accuracy: 8847/8968 (98.6508%)
Scaling by  100
Scaled Norm after poisoning: 244.6097258261617, distance: 243.84441280507127
Total norm for 4 adversaries is: 244.6097258261617. distance: 243.84441280507127
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  48, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 984/1005 (97.9104%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3863, Accuracy: 8852/10000 (88.5200%)
___Train Local_Simple,  epoch  48, local model 67, internal_epoch   1,  Average loss: 0.0012, Accuracy: 974/998 (97.5952%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2867, Accuracy: 9120/10000 (91.2000%)
___Train Local_Simple,  epoch  48, local model 87, internal_epoch   1,  Average loss: 0.0009, Accuracy: 464/470 (98.7234%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1442, Accuracy: 9560/10000 (95.6000%)
___Train Local_Simple,  epoch  48, local model 65, internal_epoch   1,  Average loss: 0.0010, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1118, Accuracy: 9631/10000 (96.3100%)
___Train Local_Simple,  epoch  48, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 390/400 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1654, Accuracy: 9517/10000 (95.1700%)
___Train Local_Simple,  epoch  48, local model 98, internal_epoch   1,  Average loss: 0.0013, Accuracy: 795/818 (97.1883%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2876, Accuracy: 9073/10000 (90.7300%)
time spent on training: 76.82483768463135
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.36372180451127817  data num: [606, 591, 568, 557, 1005, 998, 470, 371, 400, 818]
[rfa agg] considering poison per batch poison_fraction: 0.11366306390977443
[rfa agg] init. name: [41, 73, 51, 74, 36, 67, 87, 65, 30, 98], weight: tensor([0.0949, 0.0926, 0.0890, 0.0872, 0.1574, 0.1563, 0.0736, 0.0581, 0.0627,
        0.1281])
[rfa agg] iter:  0, prev_obj_val: 112.38726806640625, obj_val: 96.24954986572266, abs dis: 16.137718200683594
[rfa agg] iter:  0, weight: tensor([0.0401, 0.0280, 0.0339, 0.0309, 0.2146, 0.2130, 0.1005, 0.0792, 0.0855,
        0.1744])
[rfa agg] iter:  1, prev_obj_val: 96.24954986572266, obj_val: 90.90937805175781, abs dis: 5.340171813964844
[rfa agg] iter:  1, weight: tensor([0.0148, 0.0101, 0.0120, 0.0112, 0.2357, 0.2336, 0.1107, 0.0871, 0.0941,
        0.1908])
[rfa agg] iter:  2, prev_obj_val: 90.90937805175781, obj_val: 89.0657958984375, abs dis: 1.8435821533203125
[rfa agg] iter:  2, weight: tensor([0.0053, 0.0037, 0.0043, 0.0041, 0.2435, 0.2404, 0.1154, 0.0903, 0.0979,
        0.1951])
[rfa agg] iter:  3, prev_obj_val: 89.0657958984375, obj_val: 88.5000991821289, abs dis: 0.5656967163085938
[rfa agg] iter:  3, weight: tensor([0.0020, 0.0014, 0.0016, 0.0015, 0.2460, 0.2402, 0.1205, 0.0931, 0.1020,
        0.1918])
[rfa agg] iter:  4, prev_obj_val: 88.5000991821289, obj_val: 88.39533233642578, abs dis: 0.104766845703125
[rfa agg] iter:  4, weight: tensor([0.0009, 0.0006, 0.0007, 0.0007, 0.2424, 0.2312, 0.1310, 0.1009, 0.1117,
        0.1797])
[rfa agg] iter:  5, prev_obj_val: 88.39533233642578, obj_val: 88.38778686523438, abs dis: 0.00754547119140625
[rfa agg] iter:  5, weight: tensor([0.0006, 0.0004, 0.0005, 0.0005, 0.2339, 0.2192, 0.1407, 0.1121, 0.1231,
        0.1689])
[rfa agg] iter:  6, prev_obj_val: 88.38778686523438, obj_val: 88.38750457763672, abs dis: 0.00028228759765625
[rfa agg] iter:  6, weight: tensor([0.0006, 0.0004, 0.0005, 0.0005, 0.2288, 0.2135, 0.1445, 0.1179, 0.1281,
        0.1653])
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.0848, Accuracy: 9759/10000 (97.5900%)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 5.0719, Accuracy: 125/8968 (1.3938%)
Done in 90.917320728302 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:49 choose agents : [41, 73, 51, 74, 25, 54, 52, 46, 6, 35]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   1,  Average loss: 0.0149, Accuracy: 372/606 (61.3861%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   2,  Average loss: 0.0126, Accuracy: 356/606 (58.7459%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   3,  Average loss: 0.0103, Accuracy: 435/606 (71.7822%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   4,  Average loss: 0.0103, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   5,  Average loss: 0.0102, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   6,  Average loss: 0.0099, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   7,  Average loss: 0.0097, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   9,  Average loss: 0.0097, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch  10,  Average loss: 0.0094, Accuracy: 442/606 (72.9373%), train_poison_data_count: 200
Global model norm: 16.431990595828804.
Norm before scaling: 16.418156022159394. Distance: 1.9790114960994354
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.9622, Accuracy: 5821/10000 (58.2100%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.7315, Accuracy: 5710/8968 (63.6708%)
Scaling by  100
Scaled Norm after poisoning: 197.47854907242458, distance: 197.90115509390034
Total norm for 4 adversaries is: 197.47854907242458. distance: 197.90115509390034
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 1.6989, Accuracy: 8945/8968 (99.7435%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   1,  Average loss: 0.0194, Accuracy: 345/591 (58.3756%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   2,  Average loss: 0.0190, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   3,  Average loss: 0.0129, Accuracy: 380/591 (64.2978%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   4,  Average loss: 0.0118, Accuracy: 436/591 (73.7733%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   5,  Average loss: 0.0105, Accuracy: 461/591 (78.0034%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   6,  Average loss: 0.0081, Accuracy: 514/591 (86.9712%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   7,  Average loss: 0.0054, Accuracy: 548/591 (92.7242%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   8,  Average loss: 0.0034, Accuracy: 564/591 (95.4315%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   9,  Average loss: 0.0026, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch  10,  Average loss: 0.0025, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Global model norm: 16.431990595828804.
Norm before scaling: 16.577246898869962. Distance: 2.642559809878558
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5705, Accuracy: 8256/10000 (82.5600%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0849, Accuracy: 8658/8968 (96.5433%)
Scaling by  100
Scaled Norm after poisoning: 264.3528063970572, distance: 264.25598680540804
Total norm for 4 adversaries is: 264.3528063970572. distance: 264.25598680540804
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   1,  Average loss: 0.0142, Accuracy: 360/568 (63.3803%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   2,  Average loss: 0.0099, Accuracy: 422/568 (74.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   3,  Average loss: 0.0069, Accuracy: 460/568 (80.9859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   4,  Average loss: 0.0051, Accuracy: 523/568 (92.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   5,  Average loss: 0.0040, Accuracy: 533/568 (93.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   6,  Average loss: 0.0028, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   7,  Average loss: 0.0023, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   8,  Average loss: 0.0015, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   9,  Average loss: 0.0015, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch  10,  Average loss: 0.0015, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Global model norm: 16.431990595828804.
Norm before scaling: 16.576396366638505. Distance: 2.3569077481847627
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5748, Accuracy: 8090/10000 (80.9000%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0839, Accuracy: 8669/8968 (96.6659%)
Scaling by  100
Scaled Norm after poisoning: 236.0959732688171, distance: 235.69076502644307
Total norm for 4 adversaries is: 236.0959732688171. distance: 235.69076502644307
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0130, Accuracy: 410/557 (73.6086%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 479/557 (85.9964%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   3,  Average loss: 0.0026, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   4,  Average loss: 0.0019, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   5,  Average loss: 0.0019, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   8,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch  10,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.431990595828804.
Norm before scaling: 16.655312803429364. Distance: 2.524097179246865
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.4170, Accuracy: 8761/10000 (87.6100%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0413, Accuracy: 8808/8968 (98.2159%)
Scaling by  100
Scaled Norm after poisoning: 253.14519209586027, distance: 252.40973788911157
Total norm for 4 adversaries is: 253.14519209586027. distance: 252.40973788911157
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  49, local model 25, internal_epoch   1,  Average loss: 0.0017, Accuracy: 631/647 (97.5270%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3694, Accuracy: 8789/10000 (87.8900%)
___Train Local_Simple,  epoch  49, local model 54, internal_epoch   1,  Average loss: 0.0012, Accuracy: 509/519 (98.0732%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2942, Accuracy: 9069/10000 (90.6900%)
___Train Local_Simple,  epoch  49, local model 52, internal_epoch   1,  Average loss: 0.0009, Accuracy: 248/253 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1339, Accuracy: 9608/10000 (96.0800%)
___Train Local_Simple,  epoch  49, local model 46, internal_epoch   1,  Average loss: 0.0015, Accuracy: 695/710 (97.8873%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2334, Accuracy: 9295/10000 (92.9500%)
___Train Local_Simple,  epoch  49, local model 6, internal_epoch   1,  Average loss: 0.0012, Accuracy: 600/615 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1806, Accuracy: 9402/10000 (94.0200%)
___Train Local_Simple,  epoch  49, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 493/499 (98.7976%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2122, Accuracy: 9309/10000 (93.0900%)
time spent on training: 75.02521276473999
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4172506738544474  data num: [606, 591, 568, 557, 647, 519, 253, 710, 615, 499]
[rfa agg] considering poison per batch poison_fraction: 0.1303908355795148
[rfa agg] init. name: [41, 73, 51, 74, 25, 54, 52, 46, 6, 35], weight: tensor([0.1089, 0.1062, 0.1021, 0.1001, 0.1163, 0.0933, 0.0455, 0.1276, 0.1105,
        0.0897])
[rfa agg] iter:  0, prev_obj_val: 121.55558776855469, obj_val: 107.8564453125, abs dis: 13.699142456054688
[rfa agg] iter:  0, weight: tensor([0.0541, 0.0408, 0.0447, 0.0399, 0.1638, 0.1314, 0.0641, 0.1795, 0.1555,
        0.1262])
[rfa agg] iter:  1, prev_obj_val: 107.8564453125, obj_val: 102.77030944824219, abs dis: 5.0861358642578125
[rfa agg] iter:  1, weight: tensor([0.0244, 0.0177, 0.0193, 0.0175, 0.1841, 0.1477, 0.0721, 0.2012, 0.1744,
        0.1416])
[rfa agg] iter:  2, prev_obj_val: 102.77030944824219, obj_val: 100.6544189453125, abs dis: 2.1158905029296875
[rfa agg] iter:  2, weight: tensor([0.0108, 0.0079, 0.0085, 0.0078, 0.1932, 0.1550, 0.0759, 0.2102, 0.1824,
        0.1483])
[rfa agg] iter:  3, prev_obj_val: 100.6544189453125, obj_val: 99.76365661621094, abs dis: 0.8907623291015625
[rfa agg] iter:  3, weight: tensor([0.0048, 0.0035, 0.0038, 0.0035, 0.1977, 0.1587, 0.0783, 0.2129, 0.1855,
        0.1513])
[rfa agg] iter:  4, prev_obj_val: 99.76365661621094, obj_val: 99.42243957519531, abs dis: 0.341217041015625
[rfa agg] iter:  4, weight: tensor([0.0022, 0.0016, 0.0018, 0.0016, 0.1995, 0.1610, 0.0814, 0.2109, 0.1867,
        0.1532])
[rfa agg] iter:  5, prev_obj_val: 99.42243957519531, obj_val: 99.3292236328125, abs dis: 0.0932159423828125
[rfa agg] iter:  5, weight: tensor([0.0012, 0.0009, 0.0009, 0.0008, 0.1966, 0.1612, 0.0879, 0.2038, 0.1897,
        0.1569])
[rfa agg] iter:  6, prev_obj_val: 99.3292236328125, obj_val: 99.31565856933594, abs dis: 0.0135650634765625
[rfa agg] iter:  6, weight: tensor([0.0008, 0.0006, 0.0006, 0.0006, 0.1876, 0.1581, 0.0966, 0.1950, 0.1966,
        0.1636])
[rfa agg] iter:  7, prev_obj_val: 99.31565856933594, obj_val: 99.31456756591797, abs dis: 0.00109100341796875
[rfa agg] iter:  7, weight: tensor([0.0007, 0.0005, 0.0006, 0.0005, 0.1801, 0.1549, 0.1012, 0.1900, 0.2025,
        0.1690])
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.0850, Accuracy: 9759/10000 (97.5900%)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 5.0109, Accuracy: 134/8968 (1.4942%)
Done in 89.27139925956726 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:50 choose agents : [41, 73, 51, 74, 17, 20, 77, 44, 8, 78]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   1,  Average loss: 0.0142, Accuracy: 392/606 (64.6865%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   2,  Average loss: 0.0121, Accuracy: 377/606 (62.2112%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   3,  Average loss: 0.0104, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   4,  Average loss: 0.0104, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   5,  Average loss: 0.0101, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   6,  Average loss: 0.0096, Accuracy: 448/606 (73.9274%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   7,  Average loss: 0.0099, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   9,  Average loss: 0.0096, Accuracy: 436/606 (71.9472%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch  10,  Average loss: 0.0097, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Global model norm: 16.43215217188546.
Norm before scaling: 16.414543104874923. Distance: 1.8792475590631026
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.7572, Accuracy: 6998/10000 (69.9800%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.8834, Accuracy: 4652/8968 (51.8733%)
Scaling by  100
Scaled Norm after poisoning: 187.54928518925365, distance: 187.92477925023618
Total norm for 4 adversaries is: 187.54928518925365. distance: 187.92477925023618
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   1,  Average loss: 0.0188, Accuracy: 338/591 (57.1912%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   2,  Average loss: 0.0152, Accuracy: 315/591 (53.2995%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   3,  Average loss: 0.0160, Accuracy: 273/591 (46.1929%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   4,  Average loss: 0.0112, Accuracy: 418/591 (70.7276%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   5,  Average loss: 0.0085, Accuracy: 485/591 (82.0643%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   6,  Average loss: 0.0064, Accuracy: 531/591 (89.8477%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   7,  Average loss: 0.0037, Accuracy: 559/591 (94.5854%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   8,  Average loss: 0.0030, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   9,  Average loss: 0.0019, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch  10,  Average loss: 0.0020, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Global model norm: 16.43215217188546.
Norm before scaling: 16.580781110855234. Distance: 2.597490210712039
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.5488, Accuracy: 8438/10000 (84.3800%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0634, Accuracy: 8744/8968 (97.5022%)
Scaling by  100
Scaled Norm after poisoning: 259.9144841337243, distance: 259.74900745719896
Total norm for 4 adversaries is: 259.9144841337243. distance: 259.74900745719896
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0138, Accuracy: 362/568 (63.7324%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   2,  Average loss: 0.0084, Accuracy: 443/568 (77.9930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   3,  Average loss: 0.0039, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   4,  Average loss: 0.0037, Accuracy: 534/568 (94.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   5,  Average loss: 0.0027, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   6,  Average loss: 0.0023, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   7,  Average loss: 0.0017, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   8,  Average loss: 0.0014, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch  10,  Average loss: 0.0013, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Global model norm: 16.43215217188546.
Norm before scaling: 16.543663743518053. Distance: 2.3092549211516333
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6776, Accuracy: 7581/10000 (75.8100%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0416, Accuracy: 8823/8968 (98.3831%)
Scaling by  100
Scaled Norm after poisoning: 231.1515753380236, distance: 230.9254902154589
Total norm for 4 adversaries is: 231.1515753380236. distance: 230.9254902154589
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   1,  Average loss: 0.0120, Accuracy: 412/557 (73.9677%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 506/557 (90.8438%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   3,  Average loss: 0.0025, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   4,  Average loss: 0.0019, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   5,  Average loss: 0.0020, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   8,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   9,  Average loss: 0.0010, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Global model norm: 16.43215217188546.
Norm before scaling: 16.64680508039803. Distance: 2.461030310439879
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.4314, Accuracy: 8688/10000 (86.8800%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0310, Accuracy: 8865/8968 (98.8515%)
Scaling by  100
Scaled Norm after poisoning: 246.86251550711378, distance: 246.10304149126236
Total norm for 4 adversaries is: 246.86251550711378. distance: 246.10304149126236
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 606/620 (97.7419%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1135, Accuracy: 9656/10000 (96.5600%)
___Train Local_Simple,  epoch  50, local model 20, internal_epoch   1,  Average loss: 0.0013, Accuracy: 419/429 (97.6690%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2499, Accuracy: 9197/10000 (91.9700%)
___Train Local_Simple,  epoch  50, local model 77, internal_epoch   1,  Average loss: 0.0016, Accuracy: 576/589 (97.7929%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1241, Accuracy: 9615/10000 (96.1500%)
___Train Local_Simple,  epoch  50, local model 44, internal_epoch   1,  Average loss: 0.0017, Accuracy: 499/517 (96.5184%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1440, Accuracy: 9567/10000 (95.6700%)
___Train Local_Simple,  epoch  50, local model 8, internal_epoch   1,  Average loss: 0.0016, Accuracy: 616/633 (97.3144%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1847, Accuracy: 9424/10000 (94.2400%)
___Train Local_Simple,  epoch  50, local model 78, internal_epoch   1,  Average loss: 0.0012, Accuracy: 295/303 (97.3597%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1936, Accuracy: 9359/10000 (93.5900%)
time spent on training: 75.11665630340576
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4289673009421762  data num: [606, 591, 568, 557, 620, 429, 589, 517, 633, 303]
[rfa agg] considering poison per batch poison_fraction: 0.13405228154443008
[rfa agg] init. name: [41, 73, 51, 74, 17, 20, 77, 44, 8, 78], weight: tensor([0.1120, 0.1092, 0.1049, 0.1029, 0.1145, 0.0793, 0.1088, 0.0955, 0.1169,
        0.0560])
[rfa agg] iter:  0, prev_obj_val: 120.7199935913086, obj_val: 108.02094268798828, abs dis: 12.699050903320312
[rfa agg] iter:  0, weight: tensor([0.0606, 0.0442, 0.0490, 0.0434, 0.1609, 0.1115, 0.1528, 0.1344, 0.1644,
        0.0788])
[rfa agg] iter:  1, prev_obj_val: 108.02094268798828, obj_val: 103.09829711914062, abs dis: 4.922645568847656
[rfa agg] iter:  1, weight: tensor([0.0294, 0.0205, 0.0225, 0.0204, 0.1817, 0.1262, 0.1725, 0.1520, 0.1858,
        0.0891])
[rfa agg] iter:  2, prev_obj_val: 103.09829711914062, obj_val: 100.92412567138672, abs dis: 2.1741714477539062
[rfa agg] iter:  2, weight: tensor([0.0139, 0.0098, 0.0106, 0.0097, 0.1910, 0.1334, 0.1813, 0.1603, 0.1958,
        0.0941])
[rfa agg] iter:  3, prev_obj_val: 100.92412567138672, obj_val: 99.93206024169922, abs dis: 0.9920654296875
[rfa agg] iter:  3, weight: tensor([0.0066, 0.0047, 0.0051, 0.0047, 0.1949, 0.1374, 0.1847, 0.1646, 0.2006,
        0.0968])
[rfa agg] iter:  4, prev_obj_val: 99.93206024169922, obj_val: 99.49163055419922, abs dis: 0.4404296875
[rfa agg] iter:  4, weight: tensor([0.0032, 0.0023, 0.0025, 0.0023, 0.1956, 0.1407, 0.1847, 0.1671, 0.2027,
        0.0991])
[rfa agg] iter:  5, prev_obj_val: 99.49163055419922, obj_val: 99.32383728027344, abs dis: 0.16779327392578125
[rfa agg] iter:  5, weight: tensor([0.0016, 0.0012, 0.0013, 0.0012, 0.1944, 0.1451, 0.1817, 0.1681, 0.2027,
        0.1028])
[rfa agg] iter:  6, prev_obj_val: 99.32383728027344, obj_val: 99.28105926513672, abs dis: 0.04277801513671875
[rfa agg] iter:  6, weight: tensor([0.0010, 0.0007, 0.0007, 0.0007, 0.1932, 0.1508, 0.1770, 0.1660, 0.2000,
        0.1098])
[rfa agg] iter:  7, prev_obj_val: 99.28105926513672, obj_val: 99.27516174316406, abs dis: 0.00589752197265625
[rfa agg] iter:  7, weight: tensor([0.0008, 0.0005, 0.0006, 0.0005, 0.1942, 0.1546, 0.1738, 0.1616, 0.1959,
        0.1175])
[rfa agg] iter:  8, prev_obj_val: 99.27516174316406, obj_val: 99.2746810913086, abs dis: 0.00048065185546875
[rfa agg] iter:  8, weight: tensor([0.0007, 0.0005, 0.0005, 0.0005, 0.1958, 0.1561, 0.1727, 0.1585, 0.1930,
        0.1217])
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.0838, Accuracy: 9765/10000 (97.6500%)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 4.9704, Accuracy: 135/8968 (1.5054%)
Done in 89.33162021636963 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:51 choose agents : [41, 73, 51, 74, 3, 39, 14, 32, 4, 30]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   1,  Average loss: 0.0159, Accuracy: 385/606 (63.5314%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   2,  Average loss: 0.0136, Accuracy: 336/606 (55.4455%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   3,  Average loss: 0.0105, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   4,  Average loss: 0.0105, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   5,  Average loss: 0.0098, Accuracy: 433/606 (71.4521%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   6,  Average loss: 0.0097, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   7,  Average loss: 0.0096, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   9,  Average loss: 0.0096, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch  10,  Average loss: 0.0094, Accuracy: 438/606 (72.2772%), train_poison_data_count: 200
Global model norm: 16.43190423556079.
Norm before scaling: 16.461263790074145. Distance: 2.240846345787338
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.9603, Accuracy: 6018/10000 (60.1800%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.7095, Accuracy: 5631/8968 (62.7899%)
Scaling by  100
Scaled Norm after poisoning: 223.78195477126837, distance: 224.08463977089104
Total norm for 4 adversaries is: 223.78195477126837. distance: 224.08463977089104
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   1,  Average loss: 0.0202, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   2,  Average loss: 0.0188, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   3,  Average loss: 0.0128, Accuracy: 372/591 (62.9442%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   4,  Average loss: 0.0122, Accuracy: 411/591 (69.5431%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   5,  Average loss: 0.0107, Accuracy: 475/591 (80.3723%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   6,  Average loss: 0.0085, Accuracy: 519/591 (87.8173%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   7,  Average loss: 0.0059, Accuracy: 539/591 (91.2014%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   8,  Average loss: 0.0035, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   9,  Average loss: 0.0030, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch  10,  Average loss: 0.0029, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Global model norm: 16.43190423556079.
Norm before scaling: 16.591990806878687. Distance: 2.7108851710828916
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.5961, Accuracy: 8207/10000 (82.0700%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0955, Accuracy: 8657/8968 (96.5321%)
Scaling by  100
Scaled Norm after poisoning: 271.2061168419695, distance: 271.08850319130096
Total norm for 4 adversaries is: 271.2061168419695. distance: 271.08850319130096
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   1,  Average loss: 0.0130, Accuracy: 381/568 (67.0775%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   2,  Average loss: 0.0081, Accuracy: 443/568 (77.9930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   3,  Average loss: 0.0045, Accuracy: 519/568 (91.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   4,  Average loss: 0.0032, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   5,  Average loss: 0.0024, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   6,  Average loss: 0.0018, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   7,  Average loss: 0.0016, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   8,  Average loss: 0.0013, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   9,  Average loss: 0.0011, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch  10,  Average loss: 0.0013, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Global model norm: 16.43190423556079.
Norm before scaling: 16.56034773751747. Distance: 2.236929227177544
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.5784, Accuracy: 8033/10000 (80.3300%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0464, Accuracy: 8801/8968 (98.1378%)
Scaling by  100
Scaled Norm after poisoning: 224.1247559954054, distance: 223.6929221891028
Total norm for 4 adversaries is: 224.1247559954054. distance: 223.6929221891028
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   1,  Average loss: 0.0127, Accuracy: 386/557 (69.2998%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 515/557 (92.4596%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   3,  Average loss: 0.0023, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   4,  Average loss: 0.0022, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   5,  Average loss: 0.0017, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   7,  Average loss: 0.0011, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   9,  Average loss: 0.0014, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch  10,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Global model norm: 16.43190423556079.
Norm before scaling: 16.658195682559306. Distance: 2.487704654881816
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.4205, Accuracy: 8742/10000 (87.4200%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0308, Accuracy: 8859/8968 (98.7846%)
Scaling by  100
Scaled Norm after poisoning: 249.57300253382778, distance: 248.7704608419175
Total norm for 4 adversaries is: 249.57300253382778. distance: 248.7704608419175
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  51, local model 3, internal_epoch   1,  Average loss: 0.0014, Accuracy: 901/923 (97.6165%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1970, Accuracy: 9347/10000 (93.4700%)
___Train Local_Simple,  epoch  51, local model 39, internal_epoch   1,  Average loss: 0.0012, Accuracy: 252/257 (98.0545%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0920, Accuracy: 9731/10000 (97.3100%)
___Train Local_Simple,  epoch  51, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 369/376 (98.1383%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0845, Accuracy: 9763/10000 (97.6300%)
___Train Local_Simple,  epoch  51, local model 32, internal_epoch   1,  Average loss: 0.0019, Accuracy: 949/977 (97.1341%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2178, Accuracy: 9288/10000 (92.8800%)
___Train Local_Simple,  epoch  51, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 646/658 (98.1763%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.5672, Accuracy: 8253/10000 (82.5300%)
___Train Local_Simple,  epoch  51, local model 30, internal_epoch   1,  Average loss: 0.0018, Accuracy: 389/400 (97.2500%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1619, Accuracy: 9532/10000 (95.3200%)
time spent on training: 74.90820026397705
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3926940639269406  data num: [606, 591, 568, 557, 923, 257, 376, 977, 658, 400]
[rfa agg] considering poison per batch poison_fraction: 0.12271689497716895
[rfa agg] init. name: [41, 73, 51, 74, 3, 39, 14, 32, 4, 30], weight: tensor([0.1025, 0.0999, 0.0961, 0.0942, 0.1561, 0.0435, 0.0636, 0.1652, 0.1113,
        0.0676])
[rfa agg] iter:  0, prev_obj_val: 118.5930404663086, obj_val: 103.74815368652344, abs dis: 14.844886779785156
[rfa agg] iter:  0, weight: tensor([0.0424, 0.0351, 0.0421, 0.0354, 0.2169, 0.0606, 0.0886, 0.2299, 0.1547,
        0.0942])
[rfa agg] iter:  1, prev_obj_val: 103.74815368652344, obj_val: 98.46178436279297, abs dis: 5.286369323730469
[rfa agg] iter:  1, weight: tensor([0.0173, 0.0140, 0.0166, 0.0143, 0.2403, 0.0675, 0.0986, 0.2552, 0.1714,
        0.1047])
[rfa agg] iter:  2, prev_obj_val: 98.46178436279297, obj_val: 96.43230438232422, abs dis: 2.02947998046875
[rfa agg] iter:  2, weight: tensor([0.0070, 0.0057, 0.0066, 0.0058, 0.2486, 0.0707, 0.1032, 0.2654, 0.1775,
        0.1094])
[rfa agg] iter:  3, prev_obj_val: 96.43230438232422, obj_val: 95.67826843261719, abs dis: 0.7540359497070312
[rfa agg] iter:  3, weight: tensor([0.0029, 0.0023, 0.0027, 0.0024, 0.2491, 0.0735, 0.1069, 0.2690, 0.1786,
        0.1127])
[rfa agg] iter:  4, prev_obj_val: 95.67826843261719, obj_val: 95.45746612548828, abs dis: 0.22080230712890625
[rfa agg] iter:  4, weight: tensor([0.0013, 0.0010, 0.0012, 0.0011, 0.2421, 0.0786, 0.1139, 0.2666, 0.1757,
        0.1186])
[rfa agg] iter:  5, prev_obj_val: 95.45746612548828, obj_val: 95.42305755615234, abs dis: 0.0344085693359375
[rfa agg] iter:  5, weight: tensor([0.0007, 0.0006, 0.0007, 0.0006, 0.2288, 0.0869, 0.1263, 0.2550, 0.1709,
        0.1295])
[rfa agg] iter:  6, prev_obj_val: 95.42305755615234, obj_val: 95.42066955566406, abs dis: 0.00238800048828125
[rfa agg] iter:  6, weight: tensor([0.0006, 0.0005, 0.0006, 0.0005, 0.2196, 0.0920, 0.1356, 0.2434, 0.1688,
        0.1384])
[rfa agg] iter:  7, prev_obj_val: 95.42066955566406, obj_val: 95.42054748535156, abs dis: 0.0001220703125
[rfa agg] iter:  7, weight: tensor([0.0006, 0.0005, 0.0005, 0.0005, 0.2159, 0.0940, 0.1395, 0.2376, 0.1687,
        0.1422])
___Test Target_Simple poisoned: False, epoch: 51: Average loss: 0.0832, Accuracy: 9765/10000 (97.6500%)
___Test Target_Simple poisoned: True, epoch: 51: Average loss: 4.9819, Accuracy: 134/8968 (1.4942%)
Done in 89.08864426612854 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:52 choose agents : [41, 73, 51, 74, 30, 65, 23, 3, 98, 88]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   1,  Average loss: 0.0158, Accuracy: 372/606 (61.3861%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   2,  Average loss: 0.0122, Accuracy: 368/606 (60.7261%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   3,  Average loss: 0.0104, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   4,  Average loss: 0.0101, Accuracy: 436/606 (71.9472%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   5,  Average loss: 0.0098, Accuracy: 435/606 (71.7822%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   6,  Average loss: 0.0102, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   7,  Average loss: 0.0099, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   8,  Average loss: 0.0100, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch  10,  Average loss: 0.0098, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Global model norm: 16.431418566675283.
Norm before scaling: 16.43579185516323. Distance: 2.1364050709895475
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.8760, Accuracy: 6485/10000 (64.8500%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.7367, Accuracy: 5637/8968 (62.8568%)
Scaling by  100
Scaled Norm after poisoning: 213.23745200480144, distance: 213.64050558122165
Total norm for 4 adversaries is: 213.23745200480144. distance: 213.64050558122165
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   1,  Average loss: 0.0198, Accuracy: 335/591 (56.6836%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   2,  Average loss: 0.0166, Accuracy: 279/591 (47.2081%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   3,  Average loss: 0.0127, Accuracy: 418/591 (70.7276%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   4,  Average loss: 0.0113, Accuracy: 442/591 (74.7885%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   5,  Average loss: 0.0083, Accuracy: 494/591 (83.5871%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   6,  Average loss: 0.0070, Accuracy: 522/591 (88.3249%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   7,  Average loss: 0.0044, Accuracy: 550/591 (93.0626%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   8,  Average loss: 0.0027, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   9,  Average loss: 0.0024, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch  10,  Average loss: 0.0024, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Global model norm: 16.431418566675283.
Norm before scaling: 16.573192671662007. Distance: 2.622536456906549
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.6079, Accuracy: 7969/10000 (79.6900%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0654, Accuracy: 8770/8968 (97.7921%)
Scaling by  100
Scaled Norm after poisoning: 262.3492275336445, distance: 262.25364928347517
Total norm for 4 adversaries is: 262.3492275336445. distance: 262.25364928347517
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   1,  Average loss: 0.0135, Accuracy: 374/568 (65.8451%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   2,  Average loss: 0.0086, Accuracy: 454/568 (79.9296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   3,  Average loss: 0.0044, Accuracy: 516/568 (90.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   4,  Average loss: 0.0032, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   5,  Average loss: 0.0025, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   6,  Average loss: 0.0020, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   7,  Average loss: 0.0015, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   8,  Average loss: 0.0012, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   9,  Average loss: 0.0010, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch  10,  Average loss: 0.0010, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Global model norm: 16.431418566675283.
Norm before scaling: 16.576122972010165. Distance: 2.255543766815664
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.5488, Accuracy: 8136/10000 (81.3600%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0547, Accuracy: 8771/8968 (97.8033%)
Scaling by  100
Scaled Norm after poisoning: 226.08328629898762, distance: 225.55436913857378
Total norm for 4 adversaries is: 226.08328629898762. distance: 225.55436913857378
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   1,  Average loss: 0.0108, Accuracy: 426/557 (76.4811%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 514/557 (92.2801%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   3,  Average loss: 0.0026, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   4,  Average loss: 0.0015, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   5,  Average loss: 0.0014, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   7,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch  10,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.431418566675283.
Norm before scaling: 16.6128481860732. Distance: 2.255664582532789
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.4104, Accuracy: 8753/10000 (87.5300%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0422, Accuracy: 8814/8968 (98.2828%)
Scaling by  100
Scaled Norm after poisoning: 226.36459459796268, distance: 225.5664570863762
Total norm for 4 adversaries is: 226.36459459796268. distance: 225.5664570863762
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  52, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 389/400 (97.2500%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1700, Accuracy: 9505/10000 (95.0500%)
___Train Local_Simple,  epoch  52, local model 65, internal_epoch   1,  Average loss: 0.0010, Accuracy: 365/371 (98.3827%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.0950, Accuracy: 9692/10000 (96.9200%)
___Train Local_Simple,  epoch  52, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1329, Accuracy: 9564/10000 (95.6400%)
___Train Local_Simple,  epoch  52, local model 3, internal_epoch   1,  Average loss: 0.0013, Accuracy: 900/923 (97.5081%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1626, Accuracy: 9519/10000 (95.1900%)
___Train Local_Simple,  epoch  52, local model 98, internal_epoch   1,  Average loss: 0.0012, Accuracy: 800/818 (97.7995%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2592, Accuracy: 9161/10000 (91.6100%)
___Train Local_Simple,  epoch  52, local model 88, internal_epoch   1,  Average loss: 0.0010, Accuracy: 523/530 (98.6792%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1178, Accuracy: 9617/10000 (96.1700%)
time spent on training: 75.85571193695068
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41046491073006897  data num: [606, 591, 568, 557, 400, 371, 293, 923, 818, 530]
[rfa agg] considering poison per batch poison_fraction: 0.12827028460314654
[rfa agg] init. name: [41, 73, 51, 74, 30, 65, 23, 3, 98, 88], weight: tensor([0.1071, 0.1045, 0.1004, 0.0985, 0.0707, 0.0656, 0.0518, 0.1632, 0.1446,
        0.0937])
[rfa agg] iter:  0, prev_obj_val: 117.48175811767578, obj_val: 104.09146881103516, abs dis: 13.390289306640625
[rfa agg] iter:  0, weight: tensor([0.0489, 0.0395, 0.0452, 0.0431, 0.0988, 0.0916, 0.0724, 0.2277, 0.2017,
        0.1310])
[rfa agg] iter:  1, prev_obj_val: 104.09146881103516, obj_val: 99.00939178466797, abs dis: 5.0820770263671875
[rfa agg] iter:  1, weight: tensor([0.0218, 0.0173, 0.0196, 0.0191, 0.1108, 0.1027, 0.0812, 0.2549, 0.2255,
        0.1470])
[rfa agg] iter:  2, prev_obj_val: 99.00939178466797, obj_val: 96.87931060791016, abs dis: 2.1300811767578125
[rfa agg] iter:  2, weight: tensor([0.0097, 0.0077, 0.0087, 0.0085, 0.1163, 0.1078, 0.0853, 0.2664, 0.2351,
        0.1545])
[rfa agg] iter:  3, prev_obj_val: 96.87931060791016, obj_val: 95.98017120361328, abs dis: 0.899139404296875
[rfa agg] iter:  3, weight: tensor([0.0043, 0.0034, 0.0039, 0.0038, 0.1194, 0.1107, 0.0879, 0.2702, 0.2374,
        0.1590])
[rfa agg] iter:  4, prev_obj_val: 95.98017120361328, obj_val: 95.63484191894531, abs dis: 0.34532928466796875
[rfa agg] iter:  4, weight: tensor([0.0020, 0.0016, 0.0018, 0.0017, 0.1221, 0.1142, 0.0911, 0.2675, 0.2342,
        0.1637])
[rfa agg] iter:  5, prev_obj_val: 95.63484191894531, obj_val: 95.53938293457031, abs dis: 0.095458984375
[rfa agg] iter:  5, weight: tensor([0.0010, 0.0008, 0.0009, 0.0009, 0.1257, 0.1219, 0.0981, 0.2548, 0.2253,
        0.1704])
[rfa agg] iter:  6, prev_obj_val: 95.53938293457031, obj_val: 95.52472686767578, abs dis: 0.01465606689453125
[rfa agg] iter:  6, weight: tensor([0.0007, 0.0006, 0.0006, 0.0006, 0.1289, 0.1347, 0.1088, 0.2344, 0.2145,
        0.1761])
[rfa agg] iter:  7, prev_obj_val: 95.52472686767578, obj_val: 95.52328491210938, abs dis: 0.00144195556640625
[rfa agg] iter:  7, weight: tensor([0.0006, 0.0005, 0.0005, 0.0005, 0.1312, 0.1448, 0.1171, 0.2185, 0.2070,
        0.1793])
[rfa agg] iter:  8, prev_obj_val: 95.52328491210938, obj_val: 95.52312469482422, abs dis: 0.00016021728515625
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0005, 0.0005, 0.0005, 0.1327, 0.1498, 0.1212, 0.2101, 0.2029,
        0.1812])
___Test Target_Simple poisoned: False, epoch: 52: Average loss: 0.0827, Accuracy: 9765/10000 (97.6500%)
___Test Target_Simple poisoned: True, epoch: 52: Average loss: 4.9787, Accuracy: 132/8968 (1.4719%)
Done in 90.14307141304016 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:53 choose agents : [41, 73, 51, 74, 71, 2, 43, 25, 17, 37]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   1,  Average loss: 0.0149, Accuracy: 389/606 (64.1914%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   2,  Average loss: 0.0142, Accuracy: 338/606 (55.7756%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   3,  Average loss: 0.0106, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   4,  Average loss: 0.0102, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   5,  Average loss: 0.0104, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   6,  Average loss: 0.0100, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   7,  Average loss: 0.0097, Accuracy: 437/606 (72.1122%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   8,  Average loss: 0.0099, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   9,  Average loss: 0.0094, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Global model norm: 16.43191166441889.
Norm before scaling: 16.455969119979972. Distance: 2.169786066153983
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.8486, Accuracy: 6613/10000 (66.1300%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.9108, Accuracy: 4243/8968 (47.3127%)
Scaling by  100
Scaled Norm after poisoning: 216.69804560436165, distance: 216.97860457600422
Total norm for 4 adversaries is: 216.69804560436165. distance: 216.97860457600422
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   1,  Average loss: 0.0189, Accuracy: 333/591 (56.3452%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   2,  Average loss: 0.0184, Accuracy: 281/591 (47.5465%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   3,  Average loss: 0.0116, Accuracy: 400/591 (67.6819%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   4,  Average loss: 0.0106, Accuracy: 466/591 (78.8494%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   5,  Average loss: 0.0084, Accuracy: 516/591 (87.3096%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   6,  Average loss: 0.0052, Accuracy: 559/591 (94.5854%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   7,  Average loss: 0.0038, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   8,  Average loss: 0.0023, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   9,  Average loss: 0.0019, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch  10,  Average loss: 0.0020, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Global model norm: 16.43191166441889.
Norm before scaling: 16.56299288034312. Distance: 2.512350854195169
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.4797, Accuracy: 8683/10000 (86.8300%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0690, Accuracy: 8710/8968 (97.1231%)
Scaling by  100
Scaled Norm after poisoning: 251.3769890522997, distance: 251.23508195761593
Total norm for 4 adversaries is: 251.3769890522997. distance: 251.23508195761593
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   1,  Average loss: 0.0146, Accuracy: 355/568 (62.5000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   2,  Average loss: 0.0102, Accuracy: 419/568 (73.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   3,  Average loss: 0.0061, Accuracy: 490/568 (86.2676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   4,  Average loss: 0.0041, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   5,  Average loss: 0.0036, Accuracy: 537/568 (94.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   6,  Average loss: 0.0030, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   7,  Average loss: 0.0022, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   8,  Average loss: 0.0017, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   9,  Average loss: 0.0018, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch  10,  Average loss: 0.0015, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Global model norm: 16.43191166441889.
Norm before scaling: 16.574905989022135. Distance: 2.5426170469215656
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.7372, Accuracy: 7152/10000 (71.5200%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0296, Accuracy: 8911/8968 (99.3644%)
Scaling by  100
Scaled Norm after poisoning: 254.4494132558572, distance: 254.26169927606085
Total norm for 4 adversaries is: 254.4494132558572. distance: 254.26169927606085
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   1,  Average loss: 0.0125, Accuracy: 397/557 (71.2747%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 503/557 (90.3052%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   3,  Average loss: 0.0020, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   4,  Average loss: 0.0022, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   5,  Average loss: 0.0020, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   6,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   7,  Average loss: 0.0014, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   8,  Average loss: 0.0013, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   9,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch  10,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Global model norm: 16.43191166441889.
Norm before scaling: 16.661989293209597. Distance: 2.521123338731987
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.4603, Accuracy: 8581/10000 (85.8100%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0288, Accuracy: 8867/8968 (98.8738%)
Scaling by  100
Scaled Norm after poisoning: 252.8961079302131, distance: 252.11233390346058
Total norm for 4 adversaries is: 252.8961079302131. distance: 252.11233390346058
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  53, local model 71, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1365/1384 (98.6272%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6370, Accuracy: 8503/10000 (85.0300%)
___Train Local_Simple,  epoch  53, local model 2, internal_epoch   1,  Average loss: 0.0012, Accuracy: 542/548 (98.9051%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1546, Accuracy: 9510/10000 (95.1000%)
___Train Local_Simple,  epoch  53, local model 43, internal_epoch   1,  Average loss: 0.0010, Accuracy: 401/408 (98.2843%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1584, Accuracy: 9479/10000 (94.7900%)
___Train Local_Simple,  epoch  53, local model 25, internal_epoch   1,  Average loss: 0.0012, Accuracy: 632/647 (97.6816%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2943, Accuracy: 9064/10000 (90.6400%)
___Train Local_Simple,  epoch  53, local model 17, internal_epoch   1,  Average loss: 0.0015, Accuracy: 605/620 (97.5806%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1257, Accuracy: 9609/10000 (96.0900%)
___Train Local_Simple,  epoch  53, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 845/860 (98.2558%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2955, Accuracy: 9133/10000 (91.3300%)
time spent on training: 75.33710551261902
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.34202386212991603  data num: [606, 591, 568, 557, 1384, 548, 408, 647, 620, 860]
[rfa agg] considering poison per batch poison_fraction: 0.10688245691559876
[rfa agg] init. name: [41, 73, 51, 74, 71, 2, 43, 25, 17, 37], weight: tensor([0.0893, 0.0871, 0.0837, 0.0820, 0.2039, 0.0807, 0.0601, 0.0953, 0.0913,
        0.1267])
[rfa agg] iter:  0, prev_obj_val: 108.22269439697266, obj_val: 91.36296844482422, abs dis: 16.859725952148438
[rfa agg] iter:  0, weight: tensor([0.0331, 0.0288, 0.0280, 0.0267, 0.2732, 0.1085, 0.0808, 0.1281, 0.1226,
        0.1703])
[rfa agg] iter:  1, prev_obj_val: 91.36296844482422, obj_val: 85.9653091430664, abs dis: 5.3976593017578125
[rfa agg] iter:  1, weight: tensor([0.0114, 0.0097, 0.0092, 0.0090, 0.2958, 0.1183, 0.0880, 0.1396, 0.1332,
        0.1858])
[rfa agg] iter:  2, prev_obj_val: 85.9653091430664, obj_val: 84.2313003540039, abs dis: 1.7340087890625
[rfa agg] iter:  2, weight: tensor([0.0039, 0.0033, 0.0031, 0.0031, 0.2998, 0.1225, 0.0911, 0.1443, 0.1366,
        0.1924])
[rfa agg] iter:  3, prev_obj_val: 84.2313003540039, obj_val: 83.77207946777344, abs dis: 0.45922088623046875
[rfa agg] iter:  3, weight: tensor([0.0014, 0.0012, 0.0011, 0.0011, 0.2897, 0.1276, 0.0954, 0.1475, 0.1380,
        0.1970])
[rfa agg] iter:  4, prev_obj_val: 83.77207946777344, obj_val: 83.71124267578125, abs dis: 0.0608367919921875
[rfa agg] iter:  4, weight: tensor([0.0007, 0.0006, 0.0005, 0.0005, 0.2647, 0.1392, 0.1090, 0.1479, 0.1409,
        0.1959])
[rfa agg] iter:  5, prev_obj_val: 83.71124267578125, obj_val: 83.70834350585938, abs dis: 0.002899169921875
[rfa agg] iter:  5, weight: tensor([0.0005, 0.0004, 0.0004, 0.0004, 0.2462, 0.1483, 0.1233, 0.1456, 0.1446,
        0.1903])
[rfa agg] iter:  6, prev_obj_val: 83.70834350585938, obj_val: 83.70825958251953, abs dis: 8.392333984375e-05
[rfa agg] iter:  6, weight: tensor([0.0005, 0.0004, 0.0004, 0.0004, 0.2386, 0.1513, 0.1285, 0.1450, 0.1464,
        0.1884])
___Test Target_Simple poisoned: False, epoch: 53: Average loss: 0.0821, Accuracy: 9766/10000 (97.6600%)
___Test Target_Simple poisoned: True, epoch: 53: Average loss: 4.9725, Accuracy: 136/8968 (1.5165%)
Done in 89.46453142166138 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:54 choose agents : [41, 73, 51, 74, 46, 56, 30, 0, 33, 53]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   1,  Average loss: 0.0156, Accuracy: 366/606 (60.3960%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   2,  Average loss: 0.0123, Accuracy: 360/606 (59.4059%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   3,  Average loss: 0.0102, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   4,  Average loss: 0.0102, Accuracy: 408/606 (67.3267%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   5,  Average loss: 0.0101, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   6,  Average loss: 0.0097, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   7,  Average loss: 0.0099, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   9,  Average loss: 0.0094, Accuracy: 433/606 (71.4521%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Global model norm: 16.43118733495325.
Norm before scaling: 16.432973028002646. Distance: 2.1232706774934664
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.8079, Accuracy: 6744/10000 (67.4400%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.7223, Accuracy: 5489/8968 (61.2065%)
Scaling by  100
Scaled Norm after poisoning: 211.91464415242757, distance: 212.32707118087887
Total norm for 4 adversaries is: 211.91464415242757. distance: 212.32707118087887
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   1,  Average loss: 0.0210, Accuracy: 323/591 (54.6531%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   2,  Average loss: 0.0189, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   3,  Average loss: 0.0116, Accuracy: 426/591 (72.0812%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   4,  Average loss: 0.0095, Accuracy: 486/591 (82.2335%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   5,  Average loss: 0.0067, Accuracy: 526/591 (89.0017%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   6,  Average loss: 0.0051, Accuracy: 546/591 (92.3858%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   7,  Average loss: 0.0032, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   8,  Average loss: 0.0028, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   9,  Average loss: 0.0025, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch  10,  Average loss: 0.0023, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Global model norm: 16.43118733495325.
Norm before scaling: 16.631751044982174. Distance: 3.010311525262124
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.5579, Accuracy: 8535/10000 (85.3500%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0543, Accuracy: 8766/8968 (97.7475%)
Scaling by  100
Scaled Norm after poisoning: 301.0758443689895, distance: 301.0311575443645
Total norm for 4 adversaries is: 301.0758443689895. distance: 301.0311575443645
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   1,  Average loss: 0.0143, Accuracy: 363/568 (63.9085%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   2,  Average loss: 0.0078, Accuracy: 474/568 (83.4507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   3,  Average loss: 0.0037, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   4,  Average loss: 0.0027, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   5,  Average loss: 0.0022, Accuracy: 545/568 (95.9507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   6,  Average loss: 0.0019, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   7,  Average loss: 0.0018, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   8,  Average loss: 0.0017, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   9,  Average loss: 0.0015, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch  10,  Average loss: 0.0016, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Global model norm: 16.43118733495325.
Norm before scaling: 16.572169752411252. Distance: 2.4962865907205996
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.6909, Accuracy: 7440/10000 (74.4000%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0310, Accuracy: 8879/8968 (99.0076%)
Scaling by  100
Scaled Norm after poisoning: 249.853144366846, distance: 249.6286538916356
Total norm for 4 adversaries is: 249.853144366846. distance: 249.6286538916356
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   1,  Average loss: 0.0116, Accuracy: 418/557 (75.0449%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   2,  Average loss: 0.0060, Accuracy: 487/557 (87.4327%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   3,  Average loss: 0.0030, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   4,  Average loss: 0.0025, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   5,  Average loss: 0.0018, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   7,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   8,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   9,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch  10,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.43118733495325.
Norm before scaling: 16.645686766831012. Distance: 2.493715684697672
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.4007, Accuracy: 8826/10000 (88.2600%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0317, Accuracy: 8856/8968 (98.7511%)
Scaling by  100
Scaled Norm after poisoning: 250.0875862198082, distance: 249.37156952527687
Total norm for 4 adversaries is: 250.0875862198082. distance: 249.37156952527687
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  54, local model 46, internal_epoch   1,  Average loss: 0.0016, Accuracy: 691/710 (97.3239%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2952, Accuracy: 9065/10000 (90.6500%)
___Train Local_Simple,  epoch  54, local model 56, internal_epoch   1,  Average loss: 0.0013, Accuracy: 857/880 (97.3864%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1035, Accuracy: 9676/10000 (96.7600%)
___Train Local_Simple,  epoch  54, local model 30, internal_epoch   1,  Average loss: 0.0011, Accuracy: 394/400 (98.5000%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2339, Accuracy: 9300/10000 (93.0000%)
___Train Local_Simple,  epoch  54, local model 0, internal_epoch   1,  Average loss: 0.0015, Accuracy: 423/435 (97.2414%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1652, Accuracy: 9482/10000 (94.8200%)
___Train Local_Simple,  epoch  54, local model 33, internal_epoch   1,  Average loss: 0.0013, Accuracy: 610/623 (97.9133%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1582, Accuracy: 9466/10000 (94.6600%)
___Train Local_Simple,  epoch  54, local model 53, internal_epoch   1,  Average loss: 0.0010, Accuracy: 728/739 (98.5115%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2267, Accuracy: 9309/10000 (93.0900%)
time spent on training: 75.1610369682312
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3800949418890162  data num: [606, 591, 568, 557, 710, 880, 400, 435, 623, 739]
[rfa agg] considering poison per batch poison_fraction: 0.11877966934031757
[rfa agg] init. name: [41, 73, 51, 74, 46, 56, 30, 0, 33, 53], weight: tensor([0.0992, 0.0967, 0.0930, 0.0912, 0.1162, 0.1440, 0.0655, 0.0712, 0.1020,
        0.1210])
[rfa agg] iter:  0, prev_obj_val: 121.6397476196289, obj_val: 105.46743774414062, abs dis: 16.17230987548828
[rfa agg] iter:  0, weight: tensor([0.0451, 0.0315, 0.0375, 0.0359, 0.1593, 0.1975, 0.0898, 0.0977, 0.1398,
        0.1661])
[rfa agg] iter:  1, prev_obj_val: 105.46743774414062, obj_val: 99.76380157470703, abs dis: 5.703636169433594
[rfa agg] iter:  1, weight: tensor([0.0181, 0.0123, 0.0145, 0.0141, 0.1761, 0.2185, 0.0994, 0.1083, 0.1547,
        0.1842])
[rfa agg] iter:  2, prev_obj_val: 99.76380157470703, obj_val: 97.60799407958984, abs dis: 2.1558074951171875
[rfa agg] iter:  2, weight: tensor([0.0071, 0.0049, 0.0057, 0.0056, 0.1821, 0.2264, 0.1032, 0.1128, 0.1604,
        0.1920])
[rfa agg] iter:  3, prev_obj_val: 97.60799407958984, obj_val: 96.8226089477539, abs dis: 0.7853851318359375
[rfa agg] iter:  3, weight: tensor([0.0028, 0.0020, 0.0023, 0.0022, 0.1825, 0.2284, 0.1050, 0.1156, 0.1626,
        0.1966])
[rfa agg] iter:  4, prev_obj_val: 96.8226089477539, obj_val: 96.59925079345703, abs dis: 0.223358154296875
[rfa agg] iter:  4, weight: tensor([0.0012, 0.0008, 0.0010, 0.0010, 0.1770, 0.2252, 0.1081, 0.1204, 0.1649,
        0.2003])
[rfa agg] iter:  5, prev_obj_val: 96.59925079345703, obj_val: 96.56639862060547, abs dis: 0.0328521728515625
[rfa agg] iter:  5, weight: tensor([0.0007, 0.0005, 0.0006, 0.0006, 0.1661, 0.2161, 0.1159, 0.1294, 0.1709,
        0.1993])
[rfa agg] iter:  6, prev_obj_val: 96.56639862060547, obj_val: 96.5643081665039, abs dis: 0.0020904541015625
[rfa agg] iter:  6, weight: tensor([0.0006, 0.0004, 0.0005, 0.0005, 0.1588, 0.2086, 0.1230, 0.1361, 0.1771,
        0.1945])
___Test Target_Simple poisoned: False, epoch: 54: Average loss: 0.0817, Accuracy: 9766/10000 (97.6600%)
___Test Target_Simple poisoned: True, epoch: 54: Average loss: 4.9949, Accuracy: 141/8968 (1.5723%)
Done in 89.07762694358826 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:55 choose agents : [41, 73, 51, 74, 17, 65, 6, 24, 86, 35]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   1,  Average loss: 0.0149, Accuracy: 388/606 (64.0264%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   2,  Average loss: 0.0136, Accuracy: 357/606 (58.9109%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   3,  Average loss: 0.0109, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   4,  Average loss: 0.0110, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   5,  Average loss: 0.0106, Accuracy: 393/606 (64.8515%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   6,  Average loss: 0.0101, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   7,  Average loss: 0.0100, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 442/606 (72.9373%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   9,  Average loss: 0.0094, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Global model norm: 16.431785373374392.
Norm before scaling: 16.41502555480325. Distance: 2.080092910928962
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.9538, Accuracy: 6037/10000 (60.3700%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.7113, Accuracy: 5820/8968 (64.8974%)
Scaling by  100
Scaled Norm after poisoning: 207.48525926556806, distance: 208.00929591607198
Total norm for 4 adversaries is: 207.48525926556806. distance: 208.00929591607198
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   1,  Average loss: 0.0204, Accuracy: 321/591 (54.3147%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   2,  Average loss: 0.0183, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   3,  Average loss: 0.0130, Accuracy: 399/591 (67.5127%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   4,  Average loss: 0.0112, Accuracy: 454/591 (76.8190%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   5,  Average loss: 0.0089, Accuracy: 511/591 (86.4636%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   6,  Average loss: 0.0057, Accuracy: 550/591 (93.0626%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   7,  Average loss: 0.0041, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   8,  Average loss: 0.0028, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   9,  Average loss: 0.0023, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch  10,  Average loss: 0.0024, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Global model norm: 16.431785373374392.
Norm before scaling: 16.623132127505805. Distance: 2.931847023099587
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.5761, Accuracy: 8244/10000 (82.4400%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0607, Accuracy: 8781/8968 (97.9148%)
Scaling by  100
Scaled Norm after poisoning: 293.257885656976, distance: 293.1846954140001
Total norm for 4 adversaries is: 293.257885656976. distance: 293.1846954140001
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   1,  Average loss: 0.0148, Accuracy: 363/568 (63.9085%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   2,  Average loss: 0.0096, Accuracy: 438/568 (77.1127%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   3,  Average loss: 0.0044, Accuracy: 523/568 (92.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   4,  Average loss: 0.0040, Accuracy: 529/568 (93.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   5,  Average loss: 0.0028, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   6,  Average loss: 0.0024, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   7,  Average loss: 0.0018, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   8,  Average loss: 0.0014, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   9,  Average loss: 0.0013, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch  10,  Average loss: 0.0015, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Global model norm: 16.431785373374392.
Norm before scaling: 16.579153073977892. Distance: 2.4865133811334426
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.5879, Accuracy: 8113/10000 (81.1300%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0441, Accuracy: 8804/8968 (98.1713%)
Scaling by  100
Scaled Norm after poisoning: 248.92908911224094, distance: 248.65134664324663
Total norm for 4 adversaries is: 248.92908911224094. distance: 248.65134664324663
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   1,  Average loss: 0.0123, Accuracy: 404/557 (72.5314%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 489/557 (87.7917%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   3,  Average loss: 0.0027, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   4,  Average loss: 0.0020, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   5,  Average loss: 0.0020, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   6,  Average loss: 0.0018, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   7,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   8,  Average loss: 0.0013, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch  10,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.431785373374392.
Norm before scaling: 16.654980237130836. Distance: 2.515182835358492
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.3789, Accuracy: 8915/10000 (89.1500%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0414, Accuracy: 8801/8968 (98.1378%)
Scaling by  100
Scaled Norm after poisoning: 252.264385739446, distance: 251.51829580569284
Total norm for 4 adversaries is: 252.264385739446. distance: 251.51829580569284
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  55, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 602/620 (97.0968%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1077, Accuracy: 9666/10000 (96.6600%)
___Train Local_Simple,  epoch  55, local model 65, internal_epoch   1,  Average loss: 0.0009, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1053, Accuracy: 9643/10000 (96.4300%)
___Train Local_Simple,  epoch  55, local model 6, internal_epoch   1,  Average loss: 0.0012, Accuracy: 601/615 (97.7236%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.2128, Accuracy: 9343/10000 (93.4300%)
___Train Local_Simple,  epoch  55, local model 24, internal_epoch   1,  Average loss: 0.0015, Accuracy: 365/379 (96.3061%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1088, Accuracy: 9690/10000 (96.9000%)
___Train Local_Simple,  epoch  55, local model 86, internal_epoch   1,  Average loss: 0.0011, Accuracy: 244/250 (97.6000%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.0899, Accuracy: 9737/10000 (97.3700%)
___Train Local_Simple,  epoch  55, local model 35, internal_epoch   1,  Average loss: 0.0006, Accuracy: 495/499 (99.1984%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1538, Accuracy: 9516/10000 (95.1600%)
time spent on training: 74.35736179351807
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.45925632911392406  data num: [606, 591, 568, 557, 620, 371, 615, 379, 250, 499]
[rfa agg] considering poison per batch poison_fraction: 0.14351760284810128
[rfa agg] init. name: [41, 73, 51, 74, 17, 65, 6, 24, 86, 35], weight: tensor([0.1199, 0.1169, 0.1123, 0.1102, 0.1226, 0.0734, 0.1216, 0.0750, 0.0494,
        0.0987])
[rfa agg] iter:  0, prev_obj_val: 136.93443298339844, obj_val: 124.77841186523438, abs dis: 12.156021118164062
[rfa agg] iter:  0, weight: tensor([0.0705, 0.0499, 0.0580, 0.0542, 0.1739, 0.1041, 0.1726, 0.1065, 0.0702,
        0.1400])
[rfa agg] iter:  1, prev_obj_val: 124.77841186523438, obj_val: 119.85643768310547, abs dis: 4.921974182128906
[rfa agg] iter:  1, weight: tensor([0.0380, 0.0259, 0.0299, 0.0285, 0.1988, 0.1191, 0.1973, 0.1219, 0.0804,
        0.1602])
[rfa agg] iter:  2, prev_obj_val: 119.85643768310547, obj_val: 117.49156951904297, abs dis: 2.3648681640625
[rfa agg] iter:  2, weight: tensor([0.0203, 0.0139, 0.0159, 0.0153, 0.2115, 0.1268, 0.2100, 0.1300, 0.0857,
        0.1706])
[rfa agg] iter:  3, prev_obj_val: 117.49156951904297, obj_val: 116.2833480834961, abs dis: 1.208221435546875
[rfa agg] iter:  3, weight: tensor([0.0109, 0.0075, 0.0086, 0.0083, 0.2179, 0.1308, 0.2165, 0.1345, 0.0888,
        0.1761])
[rfa agg] iter:  4, prev_obj_val: 116.2833480834961, obj_val: 115.65269470214844, abs dis: 0.6306533813476562
[rfa agg] iter:  4, weight: tensor([0.0059, 0.0041, 0.0047, 0.0045, 0.2208, 0.1330, 0.2196, 0.1375, 0.0908,
        0.1792])
[rfa agg] iter:  5, prev_obj_val: 115.65269470214844, obj_val: 115.32718658447266, abs dis: 0.32550811767578125
[rfa agg] iter:  5, weight: tensor([0.0033, 0.0023, 0.0026, 0.0025, 0.2209, 0.1343, 0.2202, 0.1401, 0.0927,
        0.1811])
[rfa agg] iter:  6, prev_obj_val: 115.32718658447266, obj_val: 115.17059326171875, abs dis: 0.15659332275390625
[rfa agg] iter:  6, weight: tensor([0.0018, 0.0013, 0.0014, 0.0014, 0.2182, 0.1355, 0.2181, 0.1435, 0.0955,
        0.1833])
[rfa agg] iter:  7, prev_obj_val: 115.17059326171875, obj_val: 115.10829162597656, abs dis: 0.0623016357421875
[rfa agg] iter:  7, weight: tensor([0.0011, 0.0008, 0.0009, 0.0008, 0.2112, 0.1376, 0.2120, 0.1481, 0.1005,
        0.1870])
[rfa agg] iter:  8, prev_obj_val: 115.10829162597656, obj_val: 115.09078216552734, abs dis: 0.01750946044921875
[rfa agg] iter:  8, weight: tensor([0.0008, 0.0005, 0.0006, 0.0006, 0.2009, 0.1411, 0.2020, 0.1529, 0.1075,
        0.1931])
[rfa agg] iter:  9, prev_obj_val: 115.09078216552734, obj_val: 115.08753967285156, abs dis: 0.00324249267578125
[rfa agg] iter:  9, weight: tensor([0.0006, 0.0004, 0.0005, 0.0005, 0.1918, 0.1447, 0.1928, 0.1556, 0.1138,
        0.1993])
___Test Target_Simple poisoned: False, epoch: 55: Average loss: 0.0818, Accuracy: 9774/10000 (97.7400%)
___Test Target_Simple poisoned: True, epoch: 55: Average loss: 4.9452, Accuracy: 144/8968 (1.6057%)
Done in 88.58916974067688 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:56 choose agents : [41, 73, 51, 74, 84, 85, 60, 94, 30, 76]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   1,  Average loss: 0.0143, Accuracy: 398/606 (65.6766%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   2,  Average loss: 0.0136, Accuracy: 349/606 (57.5908%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   3,  Average loss: 0.0103, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   4,  Average loss: 0.0105, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   5,  Average loss: 0.0102, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   6,  Average loss: 0.0099, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   7,  Average loss: 0.0099, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 424/606 (69.9670%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   9,  Average loss: 0.0093, Accuracy: 437/606 (72.1122%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Global model norm: 16.431779801688307.
Norm before scaling: 16.41904077290582. Distance: 1.9287403577661202
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.8870, Accuracy: 6365/10000 (63.6500%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.7150, Accuracy: 5562/8968 (62.0205%)
Scaling by  100
Scaled Norm after poisoning: 192.50076095628816, distance: 192.8740379917681
Total norm for 4 adversaries is: 192.50076095628816. distance: 192.8740379917681
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   1,  Average loss: 0.0189, Accuracy: 343/591 (58.0372%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   2,  Average loss: 0.0199, Accuracy: 214/591 (36.2098%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   3,  Average loss: 0.0122, Accuracy: 441/591 (74.6193%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   4,  Average loss: 0.0083, Accuracy: 514/591 (86.9712%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   5,  Average loss: 0.0060, Accuracy: 537/591 (90.8629%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   6,  Average loss: 0.0044, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   7,  Average loss: 0.0031, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   8,  Average loss: 0.0022, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   9,  Average loss: 0.0018, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch  10,  Average loss: 0.0018, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Global model norm: 16.431779801688307.
Norm before scaling: 16.610097989614914. Distance: 3.031161120183358
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.5703, Accuracy: 8410/10000 (84.1000%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0558, Accuracy: 8766/8968 (97.7475%)
Scaling by  100
Scaled Norm after poisoning: 303.01780321047147, distance: 303.11612100398094
Total norm for 4 adversaries is: 303.01780321047147. distance: 303.11612100398094
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   1,  Average loss: 0.0135, Accuracy: 366/568 (64.4366%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   2,  Average loss: 0.0073, Accuracy: 478/568 (84.1549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   3,  Average loss: 0.0028, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   4,  Average loss: 0.0026, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   5,  Average loss: 0.0019, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   6,  Average loss: 0.0016, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   7,  Average loss: 0.0014, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   8,  Average loss: 0.0011, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   9,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch  10,  Average loss: 0.0009, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Global model norm: 16.431779801688307.
Norm before scaling: 16.58036790464903. Distance: 2.2576533594772332
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.5275, Accuracy: 8251/10000 (82.5100%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0501, Accuracy: 8792/8968 (98.0375%)
Scaling by  100
Scaled Norm after poisoning: 226.32015486915876, distance: 225.765321669981
Total norm for 4 adversaries is: 226.32015486915876. distance: 225.765321669981
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   1,  Average loss: 0.0105, Accuracy: 425/557 (76.3016%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   2,  Average loss: 0.0034, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   3,  Average loss: 0.0022, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   4,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   5,  Average loss: 0.0016, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   6,  Average loss: 0.0012, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   7,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   8,  Average loss: 0.0013, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch  10,  Average loss: 0.0013, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.431779801688307.
Norm before scaling: 16.661973724868346. Distance: 2.451733723113902
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.4361, Accuracy: 8704/10000 (87.0400%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0243, Accuracy: 8875/8968 (98.9630%)
Scaling by  100
Scaled Norm after poisoning: 246.0501647911458, distance: 245.1733841208095
Total norm for 4 adversaries is: 246.0501647911458. distance: 245.1733841208095
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  56, local model 84, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1216/1246 (97.5923%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1533, Accuracy: 9554/10000 (95.5400%)
___Train Local_Simple,  epoch  56, local model 85, internal_epoch   1,  Average loss: 0.0009, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1609, Accuracy: 9491/10000 (94.9100%)
___Train Local_Simple,  epoch  56, local model 60, internal_epoch   1,  Average loss: 0.0017, Accuracy: 329/338 (97.3373%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1244, Accuracy: 9647/10000 (96.4700%)
___Train Local_Simple,  epoch  56, local model 94, internal_epoch   1,  Average loss: 0.0023, Accuracy: 147/150 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1087, Accuracy: 9685/10000 (96.8500%)
___Train Local_Simple,  epoch  56, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 393/400 (98.2500%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1685, Accuracy: 9507/10000 (95.0700%)
___Train Local_Simple,  epoch  56, local model 76, internal_epoch   1,  Average loss: 0.0014, Accuracy: 77/78 (98.7179%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.0849, Accuracy: 9768/10000 (97.6800%)
time spent on training: 90.5999903678894
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4676737160120846  data num: [606, 591, 568, 557, 1246, 431, 338, 150, 400, 78]
[rfa agg] considering poison per batch poison_fraction: 0.14614803625377643
[rfa agg] init. name: [41, 73, 51, 74, 84, 85, 60, 94, 30, 76], weight: tensor([0.1221, 0.1190, 0.1144, 0.1122, 0.2510, 0.0868, 0.0681, 0.0302, 0.0806,
        0.0157])
[rfa agg] iter:  0, prev_obj_val: 134.12057495117188, obj_val: 122.4409408569336, abs dis: 11.679634094238281
[rfa agg] iter:  0, weight: tensor([0.0741, 0.0482, 0.0647, 0.0555, 0.3568, 0.1236, 0.0970, 0.0430, 0.1147,
        0.0224])
[rfa agg] iter:  1, prev_obj_val: 122.4409408569336, obj_val: 117.79815673828125, abs dis: 4.642784118652344
[rfa agg] iter:  1, weight: tensor([0.0412, 0.0252, 0.0338, 0.0296, 0.4095, 0.1420, 0.1116, 0.0495, 0.1318,
        0.0258])
[rfa agg] iter:  2, prev_obj_val: 117.79815673828125, obj_val: 115.56006622314453, abs dis: 2.2380905151367188
[rfa agg] iter:  2, weight: tensor([0.0225, 0.0138, 0.0182, 0.0162, 0.4365, 0.1517, 0.1196, 0.0530, 0.1408,
        0.0276])
[rfa agg] iter:  3, prev_obj_val: 115.56006622314453, obj_val: 114.4077377319336, abs dis: 1.1523284912109375
[rfa agg] iter:  3, weight: tensor([0.0124, 0.0077, 0.0100, 0.0090, 0.4501, 0.1571, 0.1243, 0.0550, 0.1457,
        0.0287])
[rfa agg] iter:  4, prev_obj_val: 114.4077377319336, obj_val: 113.80465698242188, abs dis: 0.6030807495117188
[rfa agg] iter:  4, weight: tensor([0.0069, 0.0043, 0.0056, 0.0050, 0.4559, 0.1603, 0.1276, 0.0564, 0.1485,
        0.0296])
[rfa agg] iter:  5, prev_obj_val: 113.80465698242188, obj_val: 113.49986267089844, abs dis: 0.3047943115234375
[rfa agg] iter:  5, weight: tensor([0.0039, 0.0024, 0.0031, 0.0028, 0.4564, 0.1625, 0.1306, 0.0576, 0.1502,
        0.0304])
[rfa agg] iter:  6, prev_obj_val: 113.49986267089844, obj_val: 113.36468505859375, abs dis: 0.1351776123046875
[rfa agg] iter:  6, weight: tensor([0.0023, 0.0014, 0.0019, 0.0017, 0.4528, 0.1646, 0.1337, 0.0589, 0.1510,
        0.0317])
[rfa agg] iter:  7, prev_obj_val: 113.36468505859375, obj_val: 113.31969451904297, abs dis: 0.04499053955078125
[rfa agg] iter:  7, weight: tensor([0.0015, 0.0010, 0.0012, 0.0011, 0.4471, 0.1671, 0.1362, 0.0602, 0.1512,
        0.0333])
[rfa agg] iter:  8, prev_obj_val: 113.31969451904297, obj_val: 113.3099136352539, abs dis: 0.0097808837890625
[rfa agg] iter:  8, weight: tensor([0.0012, 0.0007, 0.0010, 0.0009, 0.4418, 0.1700, 0.1371, 0.0611, 0.1514,
        0.0348])
[rfa agg] iter:  9, prev_obj_val: 113.3099136352539, obj_val: 113.3084716796875, abs dis: 0.00144195556640625
[rfa agg] iter:  9, weight: tensor([0.0011, 0.0007, 0.0009, 0.0008, 0.4384, 0.1723, 0.1370, 0.0616, 0.1517,
        0.0356])
___Test Target_Simple poisoned: False, epoch: 56: Average loss: 0.0821, Accuracy: 9772/10000 (97.7200%)
___Test Target_Simple poisoned: True, epoch: 56: Average loss: 4.8265, Accuracy: 167/8968 (1.8622%)
Done in 106.04315710067749 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:57 choose agents : [41, 73, 51, 74, 42, 25, 16, 95, 52, 59]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   1,  Average loss: 0.0146, Accuracy: 387/606 (63.8614%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   2,  Average loss: 0.0122, Accuracy: 378/606 (62.3762%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   3,  Average loss: 0.0109, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   4,  Average loss: 0.0104, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   5,  Average loss: 0.0105, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   6,  Average loss: 0.0098, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   7,  Average loss: 0.0095, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   8,  Average loss: 0.0095, Accuracy: 433/606 (71.4521%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   9,  Average loss: 0.0096, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Global model norm: 16.431220766246817.
Norm before scaling: 16.42438915399995. Distance: 2.0171233529692105
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.8355, Accuracy: 6699/10000 (66.9900%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.7957, Accuracy: 5122/8968 (57.1142%)
Scaling by  100
Scaled Norm after poisoning: 201.31698225373339, distance: 201.7123377176022
Total norm for 4 adversaries is: 201.31698225373339. distance: 201.7123377176022
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 323.7088, Accuracy: 8343/8968 (93.0308%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   1,  Average loss: 0.0198, Accuracy: 332/591 (56.1760%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   2,  Average loss: 0.0174, Accuracy: 274/591 (46.3621%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   3,  Average loss: 0.0114, Accuracy: 457/591 (77.3266%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   4,  Average loss: 0.0093, Accuracy: 494/591 (83.5871%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   5,  Average loss: 0.0070, Accuracy: 531/591 (89.8477%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   6,  Average loss: 0.0046, Accuracy: 552/591 (93.4010%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   7,  Average loss: 0.0034, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   8,  Average loss: 0.0023, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   9,  Average loss: 0.0018, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch  10,  Average loss: 0.0017, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Global model norm: 16.431220766246817.
Norm before scaling: 16.593774827841596. Distance: 2.5986540061318677
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.4605, Accuracy: 8833/10000 (88.3300%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0480, Accuracy: 8796/8968 (98.0821%)
Scaling by  100
Scaled Norm after poisoning: 260.1183324469846, distance: 259.8654098759587
Total norm for 4 adversaries is: 260.1183324469846. distance: 259.8654098759587
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   1,  Average loss: 0.0145, Accuracy: 352/568 (61.9718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   2,  Average loss: 0.0095, Accuracy: 436/568 (76.7606%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   3,  Average loss: 0.0047, Accuracy: 510/568 (89.7887%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   4,  Average loss: 0.0038, Accuracy: 524/568 (92.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   5,  Average loss: 0.0027, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   6,  Average loss: 0.0023, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   7,  Average loss: 0.0018, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   8,  Average loss: 0.0015, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   9,  Average loss: 0.0013, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch  10,  Average loss: 0.0011, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Global model norm: 16.431220766246817.
Norm before scaling: 16.592311760882282. Distance: 2.5342429092547363
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.6981, Accuracy: 7649/10000 (76.4900%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0475, Accuracy: 8795/8968 (98.0709%)
Scaling by  100
Scaled Norm after poisoning: 253.739223909115, distance: 253.4242829475897
Total norm for 4 adversaries is: 253.739223909115. distance: 253.4242829475897
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   1,  Average loss: 0.0108, Accuracy: 428/557 (76.8402%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   3,  Average loss: 0.0015, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   4,  Average loss: 0.0017, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   5,  Average loss: 0.0014, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   6,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   7,  Average loss: 0.0014, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch  10,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Global model norm: 16.431220766246817.
Norm before scaling: 16.632040039014306. Distance: 2.287346623182626
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.3824, Accuracy: 8851/10000 (88.5100%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0253, Accuracy: 8879/8968 (99.0076%)
Scaling by  100
Scaled Norm after poisoning: 229.6308008249329, distance: 228.73465624769239
Total norm for 4 adversaries is: 229.6308008249329. distance: 228.73465624769239
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  57, local model 42, internal_epoch   1,  Average loss: 0.0016, Accuracy: 232/236 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.0957, Accuracy: 9709/10000 (97.0900%)
___Train Local_Simple,  epoch  57, local model 25, internal_epoch   1,  Average loss: 0.0012, Accuracy: 633/647 (97.8362%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.2724, Accuracy: 9096/10000 (90.9600%)
___Train Local_Simple,  epoch  57, local model 16, internal_epoch   1,  Average loss: 0.0012, Accuracy: 896/915 (97.9235%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1408, Accuracy: 9570/10000 (95.7000%)
___Train Local_Simple,  epoch  57, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 598/602 (99.3355%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.6459, Accuracy: 8214/10000 (82.1400%)
___Train Local_Simple,  epoch  57, local model 52, internal_epoch   1,  Average loss: 0.0009, Accuracy: 248/253 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1287, Accuracy: 9621/10000 (96.2100%)
___Train Local_Simple,  epoch  57, local model 59, internal_epoch   1,  Average loss: 0.0015, Accuracy: 743/760 (97.7632%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.5832, Accuracy: 8279/10000 (82.7900%)
time spent on training: 81.27469635009766
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4048823016564952  data num: [606, 591, 568, 557, 236, 647, 915, 602, 253, 760]
[rfa agg] considering poison per batch poison_fraction: 0.12652571926765474
[rfa agg] init. name: [41, 73, 51, 74, 42, 25, 16, 95, 52, 59], weight: tensor([0.1057, 0.1031, 0.0990, 0.0971, 0.0412, 0.1128, 0.1595, 0.1050, 0.0441,
        0.1325])
[rfa agg] iter:  0, prev_obj_val: 118.41629028320312, obj_val: 104.3704833984375, abs dis: 14.045806884765625
[rfa agg] iter:  0, weight: tensor([0.0506, 0.0393, 0.0392, 0.0416, 0.0574, 0.1572, 0.2221, 0.1464, 0.0616,
        0.1846])
[rfa agg] iter:  1, prev_obj_val: 104.3704833984375, obj_val: 99.17417907714844, abs dis: 5.1963043212890625
[rfa agg] iter:  1, weight: tensor([0.0221, 0.0166, 0.0165, 0.0178, 0.0643, 0.1758, 0.2478, 0.1639, 0.0690,
        0.2062])
[rfa agg] iter:  2, prev_obj_val: 99.17417907714844, obj_val: 97.05998992919922, abs dis: 2.1141891479492188
[rfa agg] iter:  2, weight: tensor([0.0095, 0.0072, 0.0071, 0.0077, 0.0674, 0.1838, 0.2581, 0.1718, 0.0725,
        0.2149])
[rfa agg] iter:  3, prev_obj_val: 97.05998992919922, obj_val: 96.20441436767578, abs dis: 0.8555755615234375
[rfa agg] iter:  3, weight: tensor([0.0041, 0.0031, 0.0031, 0.0033, 0.0696, 0.1875, 0.2609, 0.1762, 0.0751,
        0.2170])
[rfa agg] iter:  4, prev_obj_val: 96.20441436767578, obj_val: 95.90386962890625, abs dis: 0.30054473876953125
[rfa agg] iter:  4, weight: tensor([0.0019, 0.0014, 0.0014, 0.0015, 0.0733, 0.1892, 0.2597, 0.1799, 0.0797,
        0.2119])
[rfa agg] iter:  5, prev_obj_val: 95.90386962890625, obj_val: 95.83514404296875, abs dis: 0.0687255859375
[rfa agg] iter:  5, weight: tensor([0.0010, 0.0008, 0.0008, 0.0008, 0.0826, 0.1886, 0.2570, 0.1826, 0.0905,
        0.1953])
[rfa agg] iter:  6, prev_obj_val: 95.83514404296875, obj_val: 95.82707214355469, abs dis: 0.0080718994140625
[rfa agg] iter:  6, weight: tensor([0.0007, 0.0006, 0.0006, 0.0006, 0.0955, 0.1851, 0.2551, 0.1818, 0.1037,
        0.1763])
[rfa agg] iter:  7, prev_obj_val: 95.82707214355469, obj_val: 95.82649993896484, abs dis: 0.00057220458984375
[rfa agg] iter:  7, weight: tensor([0.0007, 0.0005, 0.0005, 0.0006, 0.1026, 0.1824, 0.2545, 0.1816, 0.1103,
        0.1663])
___Test Target_Simple poisoned: False, epoch: 57: Average loss: 0.0819, Accuracy: 9770/10000 (97.7000%)
___Test Target_Simple poisoned: True, epoch: 57: Average loss: 4.8228, Accuracy: 176/8968 (1.9625%)
Done in 95.07314467430115 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:58 choose agents : [41, 73, 51, 74, 52, 81, 77, 21, 10, 8]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   1,  Average loss: 0.0158, Accuracy: 381/606 (62.8713%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   2,  Average loss: 0.0124, Accuracy: 371/606 (61.2211%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   3,  Average loss: 0.0100, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   4,  Average loss: 0.0101, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   5,  Average loss: 0.0098, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   6,  Average loss: 0.0097, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   8,  Average loss: 0.0095, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   9,  Average loss: 0.0093, Accuracy: 435/606 (71.7822%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch  10,  Average loss: 0.0097, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Global model norm: 16.430949599348423.
Norm before scaling: 16.423273348230648. Distance: 2.055476512191076
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.9213, Accuracy: 6107/10000 (61.0700%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.5847, Accuracy: 6195/8968 (69.0789%)
Scaling by  100
Scaled Norm after poisoning: 205.11483064371527, distance: 205.54764882503522
Total norm for 4 adversaries is: 205.11483064371527. distance: 205.54764882503522
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 7.8815, Accuracy: 8933/8968 (99.6097%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   1,  Average loss: 0.0191, Accuracy: 343/591 (58.0372%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   2,  Average loss: 0.0175, Accuracy: 283/591 (47.8849%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   3,  Average loss: 0.0113, Accuracy: 491/591 (83.0795%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   4,  Average loss: 0.0088, Accuracy: 515/591 (87.1404%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   5,  Average loss: 0.0064, Accuracy: 530/591 (89.6785%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   6,  Average loss: 0.0045, Accuracy: 547/591 (92.5550%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   7,  Average loss: 0.0033, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   8,  Average loss: 0.0026, Accuracy: 559/591 (94.5854%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   9,  Average loss: 0.0020, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch  10,  Average loss: 0.0023, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Global model norm: 16.430949599348423.
Norm before scaling: 16.55646816756502. Distance: 2.6821481512001855
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.6738, Accuracy: 7544/10000 (75.4400%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0384, Accuracy: 8838/8968 (98.5504%)
Scaling by  100
Scaled Norm after poisoning: 268.14887714197124, distance: 268.21481595914867
Total norm for 4 adversaries is: 268.14887714197124. distance: 268.21481595914867
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   1,  Average loss: 0.0144, Accuracy: 364/568 (64.0845%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   2,  Average loss: 0.0072, Accuracy: 478/568 (84.1549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   3,  Average loss: 0.0030, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   4,  Average loss: 0.0028, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   5,  Average loss: 0.0021, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   6,  Average loss: 0.0018, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   7,  Average loss: 0.0016, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   8,  Average loss: 0.0013, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch  10,  Average loss: 0.0012, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Global model norm: 16.430949599348423.
Norm before scaling: 16.567826936695617. Distance: 2.3099658587025873
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.5539, Accuracy: 8173/10000 (81.7300%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0445, Accuracy: 8811/8968 (98.2493%)
Scaling by  100
Scaled Norm after poisoning: 231.40329378597878, distance: 230.99657566455394
Total norm for 4 adversaries is: 231.40329378597878. distance: 230.99657566455394
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   1,  Average loss: 0.0126, Accuracy: 408/557 (73.2496%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 511/557 (91.7415%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   3,  Average loss: 0.0023, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   4,  Average loss: 0.0023, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   5,  Average loss: 0.0019, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   6,  Average loss: 0.0018, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   8,  Average loss: 0.0014, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   9,  Average loss: 0.0014, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch  10,  Average loss: 0.0013, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.430949599348423.
Norm before scaling: 16.69373767870895. Distance: 2.6887469393022427
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.4865, Accuracy: 8480/10000 (84.8000%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0208, Accuracy: 8898/8968 (99.2194%)
Scaling by  100
Scaled Norm after poisoning: 269.64997566289526, distance: 268.8746949091714
Total norm for 4 adversaries is: 269.64997566289526. distance: 268.8746949091714
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  58, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 247/253 (97.6285%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1240, Accuracy: 9637/10000 (96.3700%)
___Train Local_Simple,  epoch  58, local model 81, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1213/1227 (98.8590%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.3259, Accuracy: 9103/10000 (91.0300%)
___Train Local_Simple,  epoch  58, local model 77, internal_epoch   1,  Average loss: 0.0016, Accuracy: 576/589 (97.7929%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1418, Accuracy: 9543/10000 (95.4300%)
___Train Local_Simple,  epoch  58, local model 21, internal_epoch   1,  Average loss: 0.0013, Accuracy: 302/312 (96.7949%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1366, Accuracy: 9558/10000 (95.5800%)
___Train Local_Simple,  epoch  58, local model 10, internal_epoch   1,  Average loss: 0.0012, Accuracy: 875/892 (98.0942%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.4478, Accuracy: 8630/10000 (86.3000%)
___Train Local_Simple,  epoch  58, local model 8, internal_epoch   1,  Average loss: 0.0015, Accuracy: 617/633 (97.4724%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1753, Accuracy: 9494/10000 (94.9400%)
time spent on training: 80.31219291687012
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.37283236994219654  data num: [606, 591, 568, 557, 253, 1227, 589, 312, 892, 633]
[rfa agg] considering poison per batch poison_fraction: 0.11651011560693642
[rfa agg] init. name: [41, 73, 51, 74, 52, 81, 77, 21, 10, 8], weight: tensor([0.0973, 0.0949, 0.0912, 0.0894, 0.0406, 0.1970, 0.0946, 0.0501, 0.1432,
        0.1016])
[rfa agg] iter:  0, prev_obj_val: 115.07195281982422, obj_val: 99.28755187988281, abs dis: 15.784400939941406
[rfa agg] iter:  0, weight: tensor([0.0423, 0.0325, 0.0369, 0.0300, 0.0557, 0.2692, 0.1294, 0.0686, 0.1962,
        0.1392])
[rfa agg] iter:  1, prev_obj_val: 99.28755187988281, obj_val: 93.85128021240234, abs dis: 5.436271667480469
[rfa agg] iter:  1, weight: tensor([0.0164, 0.0122, 0.0138, 0.0114, 0.0617, 0.2961, 0.1426, 0.0758, 0.2165,
        0.1536])
[rfa agg] iter:  2, prev_obj_val: 93.85128021240234, obj_val: 91.87150573730469, abs dis: 1.9797744750976562
[rfa agg] iter:  2, weight: tensor([0.0062, 0.0046, 0.0052, 0.0043, 0.0645, 0.3044, 0.1476, 0.0790, 0.2246,
        0.1595])
[rfa agg] iter:  3, prev_obj_val: 91.87150573730469, obj_val: 91.19408416748047, abs dis: 0.6774215698242188
[rfa agg] iter:  3, weight: tensor([0.0024, 0.0018, 0.0020, 0.0017, 0.0674, 0.3026, 0.1496, 0.0816, 0.2282,
        0.1626])
[rfa agg] iter:  4, prev_obj_val: 91.19408416748047, obj_val: 91.02916717529297, abs dis: 0.1649169921875
[rfa agg] iter:  4, weight: tensor([0.0010, 0.0008, 0.0009, 0.0007, 0.0740, 0.2911, 0.1513, 0.0878, 0.2274,
        0.1651])
[rfa agg] iter:  5, prev_obj_val: 91.02916717529297, obj_val: 91.01126861572266, abs dis: 0.0178985595703125
[rfa agg] iter:  5, weight: tensor([0.0007, 0.0005, 0.0005, 0.0005, 0.0830, 0.2768, 0.1545, 0.0986, 0.2195,
        0.1656])
[rfa agg] iter:  6, prev_obj_val: 91.01126861572266, obj_val: 91.01046752929688, abs dis: 0.00080108642578125
[rfa agg] iter:  6, weight: tensor([0.0006, 0.0004, 0.0005, 0.0004, 0.0865, 0.2697, 0.1574, 0.1048, 0.2139,
        0.1658])
___Test Target_Simple poisoned: False, epoch: 58: Average loss: 0.0807, Accuracy: 9769/10000 (97.6900%)
___Test Target_Simple poisoned: True, epoch: 58: Average loss: 4.8540, Accuracy: 168/8968 (1.8733%)
Done in 94.58909463882446 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:59 choose agents : [41, 73, 51, 74, 40, 54, 46, 30, 78, 9]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   1,  Average loss: 0.0158, Accuracy: 363/606 (59.9010%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   2,  Average loss: 0.0124, Accuracy: 368/606 (60.7261%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   3,  Average loss: 0.0104, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   4,  Average loss: 0.0102, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   5,  Average loss: 0.0098, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   6,  Average loss: 0.0097, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   7,  Average loss: 0.0095, Accuracy: 435/606 (71.7822%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   8,  Average loss: 0.0098, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch  10,  Average loss: 0.0095, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Global model norm: 16.431253268828126.
Norm before scaling: 16.447132841651687. Distance: 2.1027068812206138
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.9158, Accuracy: 6158/10000 (61.5800%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.6905, Accuracy: 5889/8968 (65.6668%)
Scaling by  100
Scaled Norm after poisoning: 209.98528594284886, distance: 210.2706960681873
Total norm for 4 adversaries is: 209.98528594284886. distance: 210.2706960681873
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   1,  Average loss: 0.0193, Accuracy: 328/591 (55.4992%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   2,  Average loss: 0.0164, Accuracy: 290/591 (49.0694%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   3,  Average loss: 0.0103, Accuracy: 485/591 (82.0643%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   4,  Average loss: 0.0082, Accuracy: 511/591 (86.4636%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   5,  Average loss: 0.0059, Accuracy: 532/591 (90.0169%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   6,  Average loss: 0.0043, Accuracy: 550/591 (93.0626%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   7,  Average loss: 0.0031, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   8,  Average loss: 0.0020, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   9,  Average loss: 0.0017, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch  10,  Average loss: 0.0017, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Global model norm: 16.431253268828126.
Norm before scaling: 16.59512283192386. Distance: 2.5980275742005032
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.4670, Accuracy: 8749/10000 (87.4900%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0664, Accuracy: 8730/8968 (97.3461%)
Scaling by  100
Scaled Norm after poisoning: 260.06477558485307, distance: 259.80274969676515
Total norm for 4 adversaries is: 260.06477558485307. distance: 259.80274969676515
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   1,  Average loss: 0.0136, Accuracy: 371/568 (65.3169%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   2,  Average loss: 0.0069, Accuracy: 474/568 (83.4507%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   3,  Average loss: 0.0032, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   4,  Average loss: 0.0026, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   5,  Average loss: 0.0019, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   6,  Average loss: 0.0017, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   7,  Average loss: 0.0015, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   8,  Average loss: 0.0011, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   9,  Average loss: 0.0013, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch  10,  Average loss: 0.0010, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Global model norm: 16.431253268828126.
Norm before scaling: 16.60016630158368. Distance: 2.456178647623529
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.5435, Accuracy: 8299/10000 (82.9900%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0655, Accuracy: 8715/8968 (97.1789%)
Scaling by  100
Scaled Norm after poisoning: 246.07475521932355, distance: 245.61785931096298
Total norm for 4 adversaries is: 246.07475521932355. distance: 245.61785931096298
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   1,  Average loss: 0.0109, Accuracy: 420/557 (75.4039%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   3,  Average loss: 0.0021, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   4,  Average loss: 0.0018, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   5,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   6,  Average loss: 0.0013, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   9,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Global model norm: 16.431253268828126.
Norm before scaling: 16.655581233642636. Distance: 2.3930695445583634
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.4123, Accuracy: 8778/10000 (87.7800%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0279, Accuracy: 8865/8968 (98.8515%)
Scaling by  100
Scaled Norm after poisoning: 240.2235531099105, distance: 239.30695834534356
Total norm for 4 adversaries is: 240.2235531099105. distance: 239.30695834534356
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  59, local model 40, internal_epoch   1,  Average loss: 0.0010, Accuracy: 759/772 (98.3161%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1172, Accuracy: 9621/10000 (96.2100%)
___Train Local_Simple,  epoch  59, local model 54, internal_epoch   1,  Average loss: 0.0013, Accuracy: 505/519 (97.3025%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1885, Accuracy: 9422/10000 (94.2200%)
___Train Local_Simple,  epoch  59, local model 46, internal_epoch   1,  Average loss: 0.0015, Accuracy: 692/710 (97.4648%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1992, Accuracy: 9387/10000 (93.8700%)
___Train Local_Simple,  epoch  59, local model 30, internal_epoch   1,  Average loss: 0.0014, Accuracy: 388/400 (97.0000%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1662, Accuracy: 9512/10000 (95.1200%)
___Train Local_Simple,  epoch  59, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 300/303 (99.0099%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1478, Accuracy: 9560/10000 (95.6000%)
___Train Local_Simple,  epoch  59, local model 9, internal_epoch   1,  Average loss: 0.0011, Accuracy: 429/436 (98.3945%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1886, Accuracy: 9397/10000 (93.9700%)
time spent on training: 76.36616516113281
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.42511900402782865  data num: [606, 591, 568, 557, 772, 519, 710, 400, 303, 436]
[rfa agg] considering poison per batch poison_fraction: 0.13284968875869646
[rfa agg] init. name: [41, 73, 51, 74, 40, 54, 46, 30, 78, 9], weight: tensor([0.1109, 0.1082, 0.1040, 0.1020, 0.1413, 0.0950, 0.1300, 0.0732, 0.0555,
        0.0798])
[rfa agg] iter:  0, prev_obj_val: 123.71076965332031, obj_val: 110.32124328613281, abs dis: 13.3895263671875
[rfa agg] iter:  0, weight: tensor([0.0530, 0.0433, 0.0446, 0.0438, 0.2003, 0.1349, 0.1843, 0.1039, 0.0787,
        0.1132])
[rfa agg] iter:  1, prev_obj_val: 110.32124328613281, obj_val: 105.29298400878906, abs dis: 5.02825927734375
[rfa agg] iter:  1, weight: tensor([0.0243, 0.0192, 0.0197, 0.0196, 0.2251, 0.1518, 0.2073, 0.1170, 0.0886,
        0.1273])
[rfa agg] iter:  2, prev_obj_val: 105.29298400878906, obj_val: 103.16663360595703, abs dis: 2.1263504028320312
[rfa agg] iter:  2, weight: tensor([0.0110, 0.0087, 0.0089, 0.0089, 0.2358, 0.1597, 0.2174, 0.1230, 0.0931,
        0.1336])
[rfa agg] iter:  3, prev_obj_val: 103.16663360595703, obj_val: 102.2479248046875, abs dis: 0.9187088012695312
[rfa agg] iter:  3, weight: tensor([0.0050, 0.0040, 0.0040, 0.0041, 0.2396, 0.1638, 0.2213, 0.1263, 0.0955,
        0.1365])
[rfa agg] iter:  4, prev_obj_val: 102.2479248046875, obj_val: 101.87639617919922, abs dis: 0.37152862548828125
[rfa agg] iter:  4, weight: tensor([0.0024, 0.0019, 0.0019, 0.0019, 0.2390, 0.1670, 0.2209, 0.1290, 0.0976,
        0.1384])
[rfa agg] iter:  5, prev_obj_val: 101.87639617919922, obj_val: 101.76127624511719, abs dis: 0.11511993408203125
[rfa agg] iter:  5, weight: tensor([0.0012, 0.0010, 0.0010, 0.0010, 0.2340, 0.1711, 0.2139, 0.1331, 0.1018,
        0.1418])
[rfa agg] iter:  6, prev_obj_val: 101.76127624511719, obj_val: 101.74089050292969, abs dis: 0.0203857421875
[rfa agg] iter:  6, weight: tensor([0.0008, 0.0006, 0.0006, 0.0006, 0.2266, 0.1749, 0.2006, 0.1379, 0.1089,
        0.1485])
[rfa agg] iter:  7, prev_obj_val: 101.74089050292969, obj_val: 101.73900604248047, abs dis: 0.00188446044921875
[rfa agg] iter:  7, weight: tensor([0.0007, 0.0005, 0.0005, 0.0005, 0.2219, 0.1767, 0.1904, 0.1401, 0.1143,
        0.1543])
[rfa agg] iter:  8, prev_obj_val: 101.73900604248047, obj_val: 101.7388687133789, abs dis: 0.0001373291015625
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0005, 0.0005, 0.0005, 0.2203, 0.1774, 0.1860, 0.1406, 0.1166,
        0.1570])
___Test Target_Simple poisoned: False, epoch: 59: Average loss: 0.0806, Accuracy: 9767/10000 (97.6700%)
___Test Target_Simple poisoned: True, epoch: 59: Average loss: 4.8068, Accuracy: 184/8968 (2.0517%)
Done in 90.98025298118591 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:60 choose agents : [41, 73, 51, 74, 89, 4, 11, 24, 43, 23]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   1,  Average loss: 0.0157, Accuracy: 367/606 (60.5611%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   2,  Average loss: 0.0129, Accuracy: 353/606 (58.2508%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   3,  Average loss: 0.0108, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   4,  Average loss: 0.0112, Accuracy: 383/606 (63.2013%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   5,  Average loss: 0.0104, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   6,  Average loss: 0.0102, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   7,  Average loss: 0.0102, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   8,  Average loss: 0.0101, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   9,  Average loss: 0.0097, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch  10,  Average loss: 0.0099, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Global model norm: 16.432150314698433.
Norm before scaling: 16.432165172188775. Distance: 2.2202881330512736
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.9396, Accuracy: 5795/10000 (57.9500%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.6474, Accuracy: 6260/8968 (69.8037%)
Scaling by  100
Scaled Norm after poisoning: 221.52627524742974, distance: 222.02881991984734
Total norm for 4 adversaries is: 221.52627524742974. distance: 222.02881991984734
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   1,  Average loss: 0.0186, Accuracy: 338/591 (57.1912%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   2,  Average loss: 0.0156, Accuracy: 305/591 (51.6074%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   3,  Average loss: 0.0092, Accuracy: 466/591 (78.8494%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   4,  Average loss: 0.0065, Accuracy: 517/591 (87.4788%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   5,  Average loss: 0.0043, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   6,  Average loss: 0.0032, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   7,  Average loss: 0.0025, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   8,  Average loss: 0.0018, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   9,  Average loss: 0.0015, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch  10,  Average loss: 0.0018, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Global model norm: 16.432150314698433.
Norm before scaling: 16.57101693605199. Distance: 2.7591725742834092
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6073, Accuracy: 8130/10000 (81.3000%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0475, Accuracy: 8802/8968 (98.1490%)
Scaling by  100
Scaled Norm after poisoning: 275.8574841516902, distance: 275.9172628479414
Total norm for 4 adversaries is: 275.8574841516902. distance: 275.9172628479414
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   1,  Average loss: 0.0133, Accuracy: 381/568 (67.0775%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   2,  Average loss: 0.0068, Accuracy: 481/568 (84.6831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   3,  Average loss: 0.0028, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   4,  Average loss: 0.0020, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   5,  Average loss: 0.0016, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   6,  Average loss: 0.0015, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   7,  Average loss: 0.0010, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   8,  Average loss: 0.0012, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   9,  Average loss: 0.0009, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch  10,  Average loss: 0.0010, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Global model norm: 16.432150314698433.
Norm before scaling: 16.613988915535813. Distance: 2.4288304034562938
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6000, Accuracy: 7980/10000 (79.8000%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0277, Accuracy: 8868/8968 (98.8849%)
Scaling by  100
Scaled Norm after poisoning: 243.46081403123173, distance: 242.88304155498383
Total norm for 4 adversaries is: 243.46081403123173. distance: 242.88304155498383
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   1,  Average loss: 0.0097, Accuracy: 439/557 (78.8151%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 509/557 (91.3824%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   3,  Average loss: 0.0021, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   4,  Average loss: 0.0017, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   5,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   6,  Average loss: 0.0017, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   7,  Average loss: 0.0017, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   8,  Average loss: 0.0014, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch  10,  Average loss: 0.0012, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Global model norm: 16.432150314698433.
Norm before scaling: 16.625134919271613. Distance: 2.4164339041152694
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.3860, Accuracy: 8857/10000 (88.5700%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0270, Accuracy: 8869/8968 (98.8961%)
Scaling by  100
Scaled Norm after poisoning: 242.3129836208741, distance: 241.64338070284484
Total norm for 4 adversaries is: 242.3129836208741. distance: 241.64338070284484
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  60, local model 89, internal_epoch   1,  Average loss: 0.0008, Accuracy: 485/492 (98.5772%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1360, Accuracy: 9592/10000 (95.9200%)
___Train Local_Simple,  epoch  60, local model 4, internal_epoch   1,  Average loss: 0.0011, Accuracy: 641/658 (97.4164%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1516, Accuracy: 9521/10000 (95.2100%)
___Train Local_Simple,  epoch  60, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 629/645 (97.5194%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1972, Accuracy: 9375/10000 (93.7500%)
___Train Local_Simple,  epoch  60, local model 24, internal_epoch   1,  Average loss: 0.0015, Accuracy: 365/379 (96.3061%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1024, Accuracy: 9710/10000 (97.1000%)
___Train Local_Simple,  epoch  60, local model 43, internal_epoch   1,  Average loss: 0.0009, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2019, Accuracy: 9341/10000 (93.4100%)
___Train Local_Simple,  epoch  60, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1435, Accuracy: 9530/10000 (95.3000%)
time spent on training: 78.28847360610962
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4467962285934193  data num: [606, 591, 568, 557, 492, 658, 645, 379, 408, 293]
[rfa agg] considering poison per batch poison_fraction: 0.13962382143544352
[rfa agg] init. name: [41, 73, 51, 74, 89, 4, 11, 24, 43, 23], weight: tensor([0.1166, 0.1137, 0.1093, 0.1072, 0.0947, 0.1266, 0.1241, 0.0729, 0.0785,
        0.0564])
[rfa agg] iter:  0, prev_obj_val: 131.86685180664062, obj_val: 119.38836669921875, abs dis: 12.478485107421875
[rfa agg] iter:  0, weight: tensor([0.0603, 0.0486, 0.0538, 0.0518, 0.1346, 0.1796, 0.1761, 0.1036, 0.1115,
        0.0801])
[rfa agg] iter:  1, prev_obj_val: 119.38836669921875, obj_val: 114.38702392578125, abs dis: 5.0013427734375
[rfa agg] iter:  1, weight: tensor([0.0307, 0.0240, 0.0266, 0.0259, 0.1532, 0.2039, 0.1999, 0.1179, 0.1268,
        0.0911])
[rfa agg] iter:  2, prev_obj_val: 114.38702392578125, obj_val: 112.06712341308594, abs dis: 2.3199005126953125
[rfa agg] iter:  2, weight: tensor([0.0156, 0.0122, 0.0134, 0.0132, 0.1627, 0.2156, 0.2113, 0.1251, 0.1343,
        0.0966])
[rfa agg] iter:  3, prev_obj_val: 112.06712341308594, obj_val: 110.93740844726562, abs dis: 1.1297149658203125
[rfa agg] iter:  3, weight: tensor([0.0080, 0.0062, 0.0068, 0.0067, 0.1682, 0.2208, 0.2164, 0.1290, 0.1383,
        0.0997])
[rfa agg] iter:  4, prev_obj_val: 110.93740844726562, obj_val: 110.38478088378906, abs dis: 0.5526275634765625
[rfa agg] iter:  4, weight: tensor([0.0041, 0.0032, 0.0035, 0.0035, 0.1722, 0.2221, 0.2173, 0.1318, 0.1406,
        0.1017])
[rfa agg] iter:  5, prev_obj_val: 110.38478088378906, obj_val: 110.12889862060547, abs dis: 0.25588226318359375
[rfa agg] iter:  5, weight: tensor([0.0022, 0.0017, 0.0019, 0.0018, 0.1761, 0.2201, 0.2144, 0.1350, 0.1428,
        0.1041])
[rfa agg] iter:  6, prev_obj_val: 110.12889862060547, obj_val: 110.03044891357422, abs dis: 0.09844970703125
[rfa agg] iter:  6, weight: tensor([0.0012, 0.0010, 0.0010, 0.0010, 0.1799, 0.2146, 0.2060, 0.1408, 0.1464,
        0.1081])
[rfa agg] iter:  7, prev_obj_val: 110.03044891357422, obj_val: 110.00463104248047, abs dis: 0.02581787109375
[rfa agg] iter:  7, weight: tensor([0.0008, 0.0006, 0.0007, 0.0007, 0.1804, 0.2069, 0.1930, 0.1502, 0.1523,
        0.1144])
[rfa agg] iter:  8, prev_obj_val: 110.00463104248047, obj_val: 110.0005111694336, abs dis: 0.004119873046875
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0005, 0.0005, 0.0005, 0.1772, 0.2007, 0.1818, 0.1595, 0.1582,
        0.1204])
[rfa agg] iter:  9, prev_obj_val: 110.0005111694336, obj_val: 110.00005340576172, abs dis: 0.000457763671875
[rfa agg] iter:  9, weight: tensor([0.0006, 0.0005, 0.0005, 0.0005, 0.1744, 0.1977, 0.1758, 0.1649, 0.1615,
        0.1237])
___Test Target_Simple poisoned: False, epoch: 60: Average loss: 0.0801, Accuracy: 9769/10000 (97.6900%)
___Test Target_Simple poisoned: True, epoch: 60: Average loss: 4.8253, Accuracy: 177/8968 (1.9737%)
Done in 92.15742778778076 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:61 choose agents : [41, 73, 51, 74, 25, 97, 91, 57, 72, 15]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   1,  Average loss: 0.0154, Accuracy: 368/606 (60.7261%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   2,  Average loss: 0.0120, Accuracy: 370/606 (61.0561%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   3,  Average loss: 0.0106, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   4,  Average loss: 0.0098, Accuracy: 441/606 (72.7723%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   5,  Average loss: 0.0103, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   6,  Average loss: 0.0096, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   7,  Average loss: 0.0096, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   9,  Average loss: 0.0092, Accuracy: 440/606 (72.6073%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch  10,  Average loss: 0.0095, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Global model norm: 16.43180487426081.
Norm before scaling: 16.432171672336576. Distance: 2.1181168997241904
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.8259, Accuracy: 6898/10000 (68.9800%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.6904, Accuracy: 5828/8968 (64.9866%)
Scaling by  100
Scaled Norm after poisoning: 211.39242610013255, distance: 211.811697770685
Total norm for 4 adversaries is: 211.39242610013255. distance: 211.811697770685
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.9956, Accuracy: 8960/8968 (99.9108%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   1,  Average loss: 0.0191, Accuracy: 338/591 (57.1912%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   2,  Average loss: 0.0187, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   3,  Average loss: 0.0112, Accuracy: 450/591 (76.1421%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   4,  Average loss: 0.0071, Accuracy: 524/591 (88.6633%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   5,  Average loss: 0.0051, Accuracy: 549/591 (92.8934%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   6,  Average loss: 0.0033, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   7,  Average loss: 0.0026, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   8,  Average loss: 0.0023, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   9,  Average loss: 0.0022, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch  10,  Average loss: 0.0018, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Global model norm: 16.43180487426081.
Norm before scaling: 16.609408991322226. Distance: 2.9493927152747927
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.5781, Accuracy: 8315/10000 (83.1500%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0440, Accuracy: 8810/8968 (98.2382%)
Scaling by  100
Scaled Norm after poisoning: 294.9171361374242, distance: 294.93925486869324
Total norm for 4 adversaries is: 294.9171361374242. distance: 294.93925486869324
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   1,  Average loss: 0.0135, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   2,  Average loss: 0.0066, Accuracy: 488/568 (85.9155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   3,  Average loss: 0.0023, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   4,  Average loss: 0.0014, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   5,  Average loss: 0.0013, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   6,  Average loss: 0.0010, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   7,  Average loss: 0.0012, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   8,  Average loss: 0.0009, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   9,  Average loss: 0.0008, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch  10,  Average loss: 0.0008, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Global model norm: 16.43180487426081.
Norm before scaling: 16.613762980171835. Distance: 2.3624433561124474
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.5189, Accuracy: 8251/10000 (82.5100%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0502, Accuracy: 8780/8968 (97.9037%)
Scaling by  100
Scaled Norm after poisoning: 236.90623145033564, distance: 236.24434517041885
Total norm for 4 adversaries is: 236.90623145033564. distance: 236.24434517041885
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   1,  Average loss: 0.0120, Accuracy: 407/557 (73.0700%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 505/557 (90.6643%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   3,  Average loss: 0.0021, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   4,  Average loss: 0.0019, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   5,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   6,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   8,  Average loss: 0.0015, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch  10,  Average loss: 0.0013, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Global model norm: 16.43180487426081.
Norm before scaling: 16.679102924475117. Distance: 2.5610637826837914
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.4246, Accuracy: 8692/10000 (86.9200%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0331, Accuracy: 8843/8968 (98.6062%)
Scaling by  100
Scaled Norm after poisoning: 256.95020188744746, distance: 256.1063774342607
Total norm for 4 adversaries is: 256.95020188744746. distance: 256.1063774342607
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  61, local model 25, internal_epoch   1,  Average loss: 0.0013, Accuracy: 635/647 (98.1453%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2719, Accuracy: 9102/10000 (91.0200%)
___Train Local_Simple,  epoch  61, local model 97, internal_epoch   1,  Average loss: 0.0009, Accuracy: 480/487 (98.5626%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2427, Accuracy: 9223/10000 (92.2300%)
___Train Local_Simple,  epoch  61, local model 91, internal_epoch   1,  Average loss: 0.0007, Accuracy: 254/256 (99.2188%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.0909, Accuracy: 9746/10000 (97.4600%)
___Train Local_Simple,  epoch  61, local model 57, internal_epoch   1,  Average loss: 0.0018, Accuracy: 329/343 (95.9184%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1612, Accuracy: 9503/10000 (95.0300%)
___Train Local_Simple,  epoch  61, local model 72, internal_epoch   1,  Average loss: 0.0006, Accuracy: 724/731 (99.0424%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1384, Accuracy: 9562/10000 (95.6200%)
___Train Local_Simple,  epoch  61, local model 15, internal_epoch   1,  Average loss: 0.0015, Accuracy: 395/401 (98.5037%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1138, Accuracy: 9647/10000 (96.4700%)
time spent on training: 75.24924778938293
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4476576055523424  data num: [606, 591, 568, 557, 647, 487, 256, 343, 731, 401]
[rfa agg] considering poison per batch poison_fraction: 0.139893001735107
[rfa agg] init. name: [41, 73, 51, 74, 25, 97, 91, 57, 72, 15], weight: tensor([0.1168, 0.1139, 0.1095, 0.1074, 0.1247, 0.0939, 0.0494, 0.0661, 0.1409,
        0.0773])
[rfa agg] iter:  0, prev_obj_val: 134.27664184570312, obj_val: 121.169677734375, abs dis: 13.106964111328125
[rfa agg] iter:  0, weight: tensor([0.0620, 0.0449, 0.0545, 0.0480, 0.1785, 0.1344, 0.0707, 0.0948, 0.2016,
        0.1106])
[rfa agg] iter:  1, prev_obj_val: 121.169677734375, obj_val: 116.14053344726562, abs dis: 5.029144287109375
[rfa agg] iter:  1, weight: tensor([0.0307, 0.0213, 0.0261, 0.0232, 0.2028, 0.1527, 0.0805, 0.1079, 0.2290,
        0.1257])
[rfa agg] iter:  2, prev_obj_val: 116.14053344726562, obj_val: 113.88157653808594, abs dis: 2.2589569091796875
[rfa agg] iter:  2, weight: tensor([0.0151, 0.0105, 0.0127, 0.0114, 0.2142, 0.1614, 0.0854, 0.1146, 0.2418,
        0.1329])
[rfa agg] iter:  3, prev_obj_val: 113.88157653808594, obj_val: 112.81732940673828, abs dis: 1.0642471313476562
[rfa agg] iter:  3, weight: tensor([0.0075, 0.0052, 0.0063, 0.0057, 0.2192, 0.1656, 0.0882, 0.1184, 0.2475,
        0.1364])
[rfa agg] iter:  4, prev_obj_val: 112.81732940673828, obj_val: 112.31855773925781, abs dis: 0.49877166748046875
[rfa agg] iter:  4, weight: tensor([0.0038, 0.0026, 0.0032, 0.0028, 0.2201, 0.1675, 0.0907, 0.1218, 0.2493,
        0.1382])
[rfa agg] iter:  5, prev_obj_val: 112.31855773925781, obj_val: 112.10487365722656, abs dis: 0.21368408203125
[rfa agg] iter:  5, weight: tensor([0.0019, 0.0014, 0.0016, 0.0015, 0.2160, 0.1680, 0.0947, 0.1262, 0.2488,
        0.1398])
[rfa agg] iter:  6, prev_obj_val: 112.10487365722656, obj_val: 112.03462982177734, abs dis: 0.07024383544921875
[rfa agg] iter:  6, weight: tensor([0.0011, 0.0008, 0.0009, 0.0008, 0.2037, 0.1674, 0.1029, 0.1322, 0.2472,
        0.1428])
[rfa agg] iter:  7, prev_obj_val: 112.03462982177734, obj_val: 112.02012634277344, abs dis: 0.01450347900390625
[rfa agg] iter:  7, weight: tensor([0.0008, 0.0005, 0.0007, 0.0006, 0.1861, 0.1652, 0.1155, 0.1365, 0.2466,
        0.1475])
[rfa agg] iter:  8, prev_obj_val: 112.02012634277344, obj_val: 112.01824951171875, abs dis: 0.0018768310546875
[rfa agg] iter:  8, weight: tensor([0.0007, 0.0005, 0.0006, 0.0005, 0.1730, 0.1629, 0.1254, 0.1372, 0.2480,
        0.1513])
[rfa agg] iter:  9, prev_obj_val: 112.01824951171875, obj_val: 112.01805877685547, abs dis: 0.00019073486328125
[rfa agg] iter:  9, weight: tensor([0.0006, 0.0004, 0.0005, 0.0005, 0.1667, 0.1614, 0.1300, 0.1369, 0.2497,
        0.1532])
___Test Target_Simple poisoned: False, epoch: 61: Average loss: 0.0802, Accuracy: 9770/10000 (97.7000%)
___Test Target_Simple poisoned: True, epoch: 61: Average loss: 4.7517, Accuracy: 185/8968 (2.0629%)
Done in 89.07949352264404 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:62 choose agents : [41, 73, 51, 74, 94, 95, 90, 69, 20, 81]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   1,  Average loss: 0.0152, Accuracy: 372/606 (61.3861%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   2,  Average loss: 0.0116, Accuracy: 376/606 (62.0462%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   3,  Average loss: 0.0109, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   4,  Average loss: 0.0104, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   5,  Average loss: 0.0101, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   6,  Average loss: 0.0099, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   7,  Average loss: 0.0095, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   8,  Average loss: 0.0098, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   9,  Average loss: 0.0094, Accuracy: 437/606 (72.1122%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch  10,  Average loss: 0.0095, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Global model norm: 16.43119662143051.
Norm before scaling: 16.437815616028868. Distance: 2.0824744806638007
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.8526, Accuracy: 6885/10000 (68.8500%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.7806, Accuracy: 5464/8968 (60.9277%)
Scaling by  100
Scaled Norm after poisoning: 207.9064073537658, distance: 208.24746772169883
Total norm for 4 adversaries is: 207.9064073537658. distance: 208.24746772169883
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.2261, Accuracy: 8963/8968 (99.9442%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   1,  Average loss: 0.0197, Accuracy: 331/591 (56.0068%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   2,  Average loss: 0.0164, Accuracy: 285/591 (48.2234%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   3,  Average loss: 0.0109, Accuracy: 396/591 (67.0051%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   4,  Average loss: 0.0070, Accuracy: 513/591 (86.8020%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   5,  Average loss: 0.0050, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   6,  Average loss: 0.0034, Accuracy: 564/591 (95.4315%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   7,  Average loss: 0.0025, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   8,  Average loss: 0.0021, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   9,  Average loss: 0.0016, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch  10,  Average loss: 0.0016, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Global model norm: 16.43119662143051.
Norm before scaling: 16.577385888625223. Distance: 2.772541857885873
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.5182, Accuracy: 8540/10000 (85.4000%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0663, Accuracy: 8722/8968 (97.2569%)
Scaling by  100
Scaled Norm after poisoning: 277.22503269005125, distance: 277.2541844814971
Total norm for 4 adversaries is: 277.22503269005125. distance: 277.2541844814971
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   1,  Average loss: 0.0131, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   2,  Average loss: 0.0063, Accuracy: 486/568 (85.5634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   3,  Average loss: 0.0023, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   4,  Average loss: 0.0023, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   5,  Average loss: 0.0016, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   6,  Average loss: 0.0016, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   7,  Average loss: 0.0012, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   8,  Average loss: 0.0010, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   9,  Average loss: 0.0011, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch  10,  Average loss: 0.0010, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Global model norm: 16.43119662143051.
Norm before scaling: 16.591188854552342. Distance: 2.3638603572814545
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.5989, Accuracy: 8035/10000 (80.3500%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0384, Accuracy: 8816/8968 (98.3051%)
Scaling by  100
Scaled Norm after poisoning: 236.8921497749556, distance: 236.38603887497248
Total norm for 4 adversaries is: 236.8921497749556. distance: 236.38603887497248
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   1,  Average loss: 0.0097, Accuracy: 434/557 (77.9174%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 513/557 (92.1005%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   3,  Average loss: 0.0017, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   4,  Average loss: 0.0015, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   5,  Average loss: 0.0016, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   6,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   7,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   8,  Average loss: 0.0010, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Global model norm: 16.43119662143051.
Norm before scaling: 16.62613347140532. Distance: 2.2548128152707445
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.3551, Accuracy: 8944/10000 (89.4400%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0317, Accuracy: 8858/8968 (98.7734%)
Scaling by  100
Scaled Norm after poisoning: 226.3797366290764, distance: 225.4812821361232
Total norm for 4 adversaries is: 226.3797366290764. distance: 225.4812821361232
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  62, local model 94, internal_epoch   1,  Average loss: 0.0024, Accuracy: 145/150 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1233, Accuracy: 9651/10000 (96.5100%)
___Train Local_Simple,  epoch  62, local model 95, internal_epoch   1,  Average loss: 0.0005, Accuracy: 596/602 (99.0033%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.9762, Accuracy: 7819/10000 (78.1900%)
___Train Local_Simple,  epoch  62, local model 90, internal_epoch   1,  Average loss: 0.0015, Accuracy: 667/683 (97.6574%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.3450, Accuracy: 8909/10000 (89.0900%)
___Train Local_Simple,  epoch  62, local model 69, internal_epoch   1,  Average loss: 0.0017, Accuracy: 248/256 (96.8750%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1255, Accuracy: 9592/10000 (95.9200%)
___Train Local_Simple,  epoch  62, local model 20, internal_epoch   1,  Average loss: 0.0012, Accuracy: 416/429 (96.9697%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.2654, Accuracy: 9190/10000 (91.9000%)
___Train Local_Simple,  epoch  62, local model 81, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1207/1227 (98.3700%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.3517, Accuracy: 9085/10000 (90.8500%)
time spent on training: 75.16893649101257
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.40959604868583527  data num: [606, 591, 568, 557, 150, 602, 683, 256, 429, 1227]
[rfa agg] considering poison per batch poison_fraction: 0.12799876521432352
[rfa agg] init. name: [41, 73, 51, 74, 94, 95, 90, 69, 20, 81], weight: tensor([0.1069, 0.1043, 0.1002, 0.0983, 0.0265, 0.1062, 0.1205, 0.0452, 0.0757,
        0.2164])
[rfa agg] iter:  0, prev_obj_val: 119.93184661865234, obj_val: 105.93408203125, abs dis: 13.997764587402344
[rfa agg] iter:  0, weight: tensor([0.0495, 0.0376, 0.0432, 0.0429, 0.0371, 0.1489, 0.1688, 0.0633, 0.1061,
        0.3025])
[rfa agg] iter:  1, prev_obj_val: 105.93408203125, obj_val: 100.77465057373047, abs dis: 5.159431457519531
[rfa agg] iter:  1, weight: tensor([0.0218, 0.0159, 0.0182, 0.0185, 0.0417, 0.1670, 0.1891, 0.0710, 0.1191,
        0.3376])
[rfa agg] iter:  2, prev_obj_val: 100.77465057373047, obj_val: 98.6708984375, abs dis: 2.1037521362304688
[rfa agg] iter:  2, weight: tensor([0.0095, 0.0069, 0.0078, 0.0080, 0.0439, 0.1753, 0.1981, 0.0747, 0.1251,
        0.3508])
[rfa agg] iter:  3, prev_obj_val: 98.6708984375, obj_val: 97.81534576416016, abs dis: 0.8555526733398438
[rfa agg] iter:  3, weight: tensor([0.0041, 0.0030, 0.0034, 0.0035, 0.0455, 0.1797, 0.2021, 0.0771, 0.1291,
        0.3523])
[rfa agg] iter:  4, prev_obj_val: 97.81534576416016, obj_val: 97.51301574707031, abs dis: 0.30233001708984375
[rfa agg] iter:  4, weight: tensor([0.0019, 0.0014, 0.0016, 0.0016, 0.0482, 0.1821, 0.2028, 0.0807, 0.1343,
        0.3454])
[rfa agg] iter:  5, prev_obj_val: 97.51301574707031, obj_val: 97.44441986083984, abs dis: 0.06859588623046875
[rfa agg] iter:  5, weight: tensor([0.0010, 0.0008, 0.0009, 0.0009, 0.0539, 0.1792, 0.1977, 0.0881, 0.1433,
        0.3343])
[rfa agg] iter:  6, prev_obj_val: 97.44441986083984, obj_val: 97.43696594238281, abs dis: 0.00745391845703125
[rfa agg] iter:  6, weight: tensor([0.0008, 0.0006, 0.0006, 0.0007, 0.0601, 0.1721, 0.1900, 0.0965, 0.1511,
        0.3276])
[rfa agg] iter:  7, prev_obj_val: 97.43696594238281, obj_val: 97.4365234375, abs dis: 0.0004425048828125
[rfa agg] iter:  7, weight: tensor([0.0007, 0.0005, 0.0006, 0.0006, 0.0626, 0.1684, 0.1863, 0.1002, 0.1542,
        0.3259])
___Test Target_Simple poisoned: False, epoch: 62: Average loss: 0.0793, Accuracy: 9771/10000 (97.7100%)
___Test Target_Simple poisoned: True, epoch: 62: Average loss: 4.7434, Accuracy: 191/8968 (2.1298%)
Done in 89.76778197288513 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:63 choose agents : [41, 73, 51, 74, 59, 21, 69, 14, 28, 22]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   1,  Average loss: 0.0156, Accuracy: 361/606 (59.5710%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   2,  Average loss: 0.0123, Accuracy: 353/606 (58.2508%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   3,  Average loss: 0.0103, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   4,  Average loss: 0.0102, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   5,  Average loss: 0.0099, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   6,  Average loss: 0.0095, Accuracy: 440/606 (72.6073%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   7,  Average loss: 0.0094, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   8,  Average loss: 0.0095, Accuracy: 435/606 (71.7822%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   9,  Average loss: 0.0094, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch  10,  Average loss: 0.0094, Accuracy: 443/606 (73.1023%), train_poison_data_count: 200
Global model norm: 16.43148728551565.
Norm before scaling: 16.434897793369924. Distance: 2.0250499295331092
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.8743, Accuracy: 6550/10000 (65.5000%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.6076, Accuracy: 6118/8968 (68.2203%)
Scaling by  100
Scaled Norm after poisoning: 202.18652434076807, distance: 202.50498643551967
Total norm for 4 adversaries is: 202.18652434076807. distance: 202.50498643551967
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   1,  Average loss: 0.0187, Accuracy: 334/591 (56.5144%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   2,  Average loss: 0.0151, Accuracy: 317/591 (53.6379%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   3,  Average loss: 0.0145, Accuracy: 350/591 (59.2217%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   4,  Average loss: 0.0081, Accuracy: 481/591 (81.3875%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   5,  Average loss: 0.0058, Accuracy: 538/591 (91.0321%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   6,  Average loss: 0.0037, Accuracy: 559/591 (94.5854%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   7,  Average loss: 0.0030, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   8,  Average loss: 0.0023, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   9,  Average loss: 0.0020, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch  10,  Average loss: 0.0022, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Global model norm: 16.43148728551565.
Norm before scaling: 16.577127237882248. Distance: 2.630168640038643
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.5164, Accuracy: 8618/10000 (86.1800%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0615, Accuracy: 8739/8968 (97.4465%)
Scaling by  100
Scaled Norm after poisoning: 263.1288895199461, distance: 263.0168572306726
Total norm for 4 adversaries is: 263.1288895199461. distance: 263.0168572306726
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   1,  Average loss: 0.0134, Accuracy: 375/568 (66.0211%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   2,  Average loss: 0.0071, Accuracy: 468/568 (82.3944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   3,  Average loss: 0.0031, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   4,  Average loss: 0.0021, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   5,  Average loss: 0.0024, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   6,  Average loss: 0.0018, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   7,  Average loss: 0.0015, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   8,  Average loss: 0.0013, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch  10,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Global model norm: 16.43148728551565.
Norm before scaling: 16.580699206657137. Distance: 2.381423395206646
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.5502, Accuracy: 8174/10000 (81.7400%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0375, Accuracy: 8846/8968 (98.6396%)
Scaling by  100
Scaled Norm after poisoning: 238.55236420700172, distance: 238.1423386076067
Total norm for 4 adversaries is: 238.55236420700172. distance: 238.1423386076067
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   1,  Average loss: 0.0103, Accuracy: 431/557 (77.3788%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 514/557 (92.2801%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   3,  Average loss: 0.0024, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   4,  Average loss: 0.0015, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   5,  Average loss: 0.0018, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   6,  Average loss: 0.0015, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   8,  Average loss: 0.0012, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Global model norm: 16.43148728551565.
Norm before scaling: 16.620094436028335. Distance: 2.2608421616663694
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.3919, Accuracy: 8827/10000 (88.2700%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0243, Accuracy: 8880/8968 (99.0187%)
Scaling by  100
Scaled Norm after poisoning: 226.92796385912865, distance: 226.08421066607016
Total norm for 4 adversaries is: 226.92796385912865. distance: 226.08421066607016
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  63, local model 59, internal_epoch   1,  Average loss: 0.0012, Accuracy: 740/760 (97.3684%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2581, Accuracy: 9111/10000 (91.1100%)
___Train Local_Simple,  epoch  63, local model 21, internal_epoch   1,  Average loss: 0.0012, Accuracy: 305/312 (97.7564%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1713, Accuracy: 9456/10000 (94.5600%)
___Train Local_Simple,  epoch  63, local model 69, internal_epoch   1,  Average loss: 0.0019, Accuracy: 249/256 (97.2656%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1996, Accuracy: 9358/10000 (93.5800%)
___Train Local_Simple,  epoch  63, local model 14, internal_epoch   1,  Average loss: 0.0012, Accuracy: 369/376 (98.1383%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1003, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch  63, local model 28, internal_epoch   1,  Average loss: 0.0013, Accuracy: 489/501 (97.6048%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1250, Accuracy: 9576/10000 (95.7600%)
___Train Local_Simple,  epoch  63, local model 22, internal_epoch   1,  Average loss: 0.0014, Accuracy: 565/583 (96.9125%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1385, Accuracy: 9587/10000 (95.8700%)
time spent on training: 79.92053055763245
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4544031311154599  data num: [606, 591, 568, 557, 760, 312, 256, 376, 501, 583]
[rfa agg] considering poison per batch poison_fraction: 0.1420009784735812
[rfa agg] init. name: [41, 73, 51, 74, 59, 21, 69, 14, 28, 22], weight: tensor([0.1186, 0.1157, 0.1112, 0.1090, 0.1487, 0.0611, 0.0501, 0.0736, 0.0980,
        0.1141])
[rfa agg] iter:  0, prev_obj_val: 126.24739837646484, obj_val: 114.74307250976562, abs dis: 11.504325866699219
[rfa agg] iter:  0, weight: tensor([0.0647, 0.0504, 0.0546, 0.0545, 0.2113, 0.0868, 0.0713, 0.1048, 0.1394,
        0.1622])
[rfa agg] iter:  1, prev_obj_val: 114.74307250976562, obj_val: 110.0981674194336, abs dis: 4.644905090332031
[rfa agg] iter:  1, weight: tensor([0.0341, 0.0255, 0.0275, 0.0281, 0.2407, 0.0991, 0.0814, 0.1197, 0.1589,
        0.1851])
[rfa agg] iter:  2, prev_obj_val: 110.0981674194336, obj_val: 107.90483093261719, abs dis: 2.1933364868164062
[rfa agg] iter:  2, weight: tensor([0.0179, 0.0133, 0.0143, 0.0147, 0.2551, 0.1053, 0.0865, 0.1275, 0.1687,
        0.1966])
[rfa agg] iter:  3, prev_obj_val: 107.90483093261719, obj_val: 106.81141662597656, abs dis: 1.093414306640625
[rfa agg] iter:  3, weight: tensor([0.0094, 0.0070, 0.0075, 0.0077, 0.2617, 0.1087, 0.0894, 0.1321, 0.1738,
        0.2027])
[rfa agg] iter:  4, prev_obj_val: 106.81141662597656, obj_val: 106.26182556152344, abs dis: 0.549591064453125
[rfa agg] iter:  4, weight: tensor([0.0050, 0.0038, 0.0040, 0.0041, 0.2632, 0.1107, 0.0913, 0.1356, 0.1763,
        0.2059])
[rfa agg] iter:  5, prev_obj_val: 106.26182556152344, obj_val: 105.99848937988281, abs dis: 0.263336181640625
[rfa agg] iter:  5, weight: tensor([0.0027, 0.0020, 0.0022, 0.0022, 0.2595, 0.1125, 0.0932, 0.1400, 0.1780,
        0.2077])
[rfa agg] iter:  6, prev_obj_val: 105.99848937988281, obj_val: 105.89095306396484, abs dis: 0.10753631591796875
[rfa agg] iter:  6, weight: tensor([0.0016, 0.0012, 0.0012, 0.0013, 0.2484, 0.1148, 0.0959, 0.1472, 0.1799,
        0.2085])
[rfa agg] iter:  7, prev_obj_val: 105.89095306396484, obj_val: 105.85932159423828, abs dis: 0.0316314697265625
[rfa agg] iter:  7, weight: tensor([0.0010, 0.0008, 0.0008, 0.0008, 0.2299, 0.1179, 0.0996, 0.1581, 0.1832,
        0.2079])
[rfa agg] iter:  8, prev_obj_val: 105.85932159423828, obj_val: 105.85321044921875, abs dis: 0.00611114501953125
[rfa agg] iter:  8, weight: tensor([0.0008, 0.0006, 0.0006, 0.0007, 0.2115, 0.1210, 0.1029, 0.1684, 0.1871,
        0.2065])
[rfa agg] iter:  9, prev_obj_val: 105.85321044921875, obj_val: 105.85235595703125, abs dis: 0.0008544921875
[rfa agg] iter:  9, weight: tensor([0.0007, 0.0005, 0.0006, 0.0006, 0.1999, 0.1230, 0.1048, 0.1744, 0.1899,
        0.2055])
___Test Target_Simple poisoned: False, epoch: 63: Average loss: 0.0796, Accuracy: 9768/10000 (97.6800%)
___Test Target_Simple poisoned: True, epoch: 63: Average loss: 4.6779, Accuracy: 201/8968 (2.2413%)
Done in 93.83471584320068 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:64 choose agents : [41, 73, 51, 74, 72, 97, 37, 50, 42, 52]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   1,  Average loss: 0.0155, Accuracy: 373/606 (61.5512%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   2,  Average loss: 0.0130, Accuracy: 351/606 (57.9208%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   3,  Average loss: 0.0108, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   4,  Average loss: 0.0106, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   5,  Average loss: 0.0099, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   6,  Average loss: 0.0101, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   7,  Average loss: 0.0097, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   8,  Average loss: 0.0095, Accuracy: 433/606 (71.4521%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   9,  Average loss: 0.0097, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch  10,  Average loss: 0.0097, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Global model norm: 16.430932883434277.
Norm before scaling: 16.416893868721786. Distance: 2.1003369015702353
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 1.0073, Accuracy: 5619/10000 (56.1900%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.4812, Accuracy: 6983/8968 (77.8657%)
Scaling by  100
Scaled Norm after poisoning: 209.51579221505, distance: 210.0336933535903
Total norm for 4 adversaries is: 209.51579221505. distance: 210.0336933535903
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 23.2714, Accuracy: 8832/8968 (98.4835%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   1,  Average loss: 0.0192, Accuracy: 344/591 (58.2064%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   2,  Average loss: 0.0164, Accuracy: 321/591 (54.3147%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   3,  Average loss: 0.0093, Accuracy: 454/591 (76.8190%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   4,  Average loss: 0.0061, Accuracy: 523/591 (88.4941%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   5,  Average loss: 0.0045, Accuracy: 548/591 (92.7242%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   6,  Average loss: 0.0035, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   7,  Average loss: 0.0025, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   8,  Average loss: 0.0019, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   9,  Average loss: 0.0018, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch  10,  Average loss: 0.0017, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Global model norm: 16.430932883434277.
Norm before scaling: 16.60479012742351. Distance: 2.9235387950741667
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.5753, Accuracy: 8314/10000 (83.1400%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0371, Accuracy: 8830/8968 (98.4612%)
Scaling by  100
Scaled Norm after poisoning: 292.3361319825177, distance: 292.35390315078746
Total norm for 4 adversaries is: 292.3361319825177. distance: 292.35390315078746
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   1,  Average loss: 0.0135, Accuracy: 373/568 (65.6690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   2,  Average loss: 0.0066, Accuracy: 479/568 (84.3310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   3,  Average loss: 0.0030, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   4,  Average loss: 0.0024, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   5,  Average loss: 0.0021, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   6,  Average loss: 0.0017, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   7,  Average loss: 0.0013, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   8,  Average loss: 0.0013, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   9,  Average loss: 0.0011, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch  10,  Average loss: 0.0012, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Global model norm: 16.430932883434277.
Norm before scaling: 16.586989007824872. Distance: 2.3825139093143135
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.6320, Accuracy: 7760/10000 (77.6000%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0501, Accuracy: 8781/8968 (97.9148%)
Scaling by  100
Scaled Norm after poisoning: 238.70762876634254, distance: 238.2514018190659
Total norm for 4 adversaries is: 238.70762876634254. distance: 238.2514018190659
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   1,  Average loss: 0.0123, Accuracy: 420/557 (75.4039%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 493/557 (88.5099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   3,  Average loss: 0.0023, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   4,  Average loss: 0.0020, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   5,  Average loss: 0.0018, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   6,  Average loss: 0.0015, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch  10,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Global model norm: 16.430932883434277.
Norm before scaling: 16.656018225111136. Distance: 2.4683892674604855
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.3782, Accuracy: 8880/10000 (88.8000%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0264, Accuracy: 8865/8968 (98.8515%)
Scaling by  100
Scaled Norm after poisoning: 247.65878744756867, distance: 246.8389214143507
Total norm for 4 adversaries is: 247.65878744756867. distance: 246.8389214143507
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  64, local model 72, internal_epoch   1,  Average loss: 0.0006, Accuracy: 721/731 (98.6320%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1530, Accuracy: 9500/10000 (95.0000%)
___Train Local_Simple,  epoch  64, local model 97, internal_epoch   1,  Average loss: 0.0008, Accuracy: 480/487 (98.5626%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1614, Accuracy: 9468/10000 (94.6800%)
___Train Local_Simple,  epoch  64, local model 37, internal_epoch   1,  Average loss: 0.0010, Accuracy: 846/860 (98.3721%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.2188, Accuracy: 9343/10000 (93.4300%)
___Train Local_Simple,  epoch  64, local model 50, internal_epoch   1,  Average loss: 0.0017, Accuracy: 454/474 (95.7806%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1515, Accuracy: 9529/10000 (95.2900%)
___Train Local_Simple,  epoch  64, local model 42, internal_epoch   1,  Average loss: 0.0015, Accuracy: 232/236 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.0904, Accuracy: 9722/10000 (97.2200%)
___Train Local_Simple,  epoch  64, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 248/253 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1074, Accuracy: 9697/10000 (96.9700%)
time spent on training: 75.51872849464417
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.43296662315867984  data num: [606, 591, 568, 557, 731, 487, 860, 474, 236, 253]
[rfa agg] considering poison per batch poison_fraction: 0.13530206973708744
[rfa agg] init. name: [41, 73, 51, 74, 72, 97, 37, 50, 42, 52], weight: tensor([0.1130, 0.1102, 0.1059, 0.1039, 0.1363, 0.0908, 0.1604, 0.0884, 0.0440,
        0.0472])
[rfa agg] iter:  0, prev_obj_val: 129.88043212890625, obj_val: 116.45806884765625, abs dis: 13.42236328125
[rfa agg] iter:  0, weight: tensor([0.0590, 0.0426, 0.0511, 0.0475, 0.1922, 0.1280, 0.2262, 0.1247, 0.0621,
        0.0666])
[rfa agg] iter:  1, prev_obj_val: 116.45806884765625, obj_val: 111.25326538085938, abs dis: 5.204803466796875
[rfa agg] iter:  1, weight: tensor([0.0287, 0.0199, 0.0239, 0.0224, 0.2173, 0.1448, 0.2561, 0.1411, 0.0703,
        0.0754])
[rfa agg] iter:  2, prev_obj_val: 111.25326538085938, obj_val: 108.93930053710938, abs dis: 2.31396484375
[rfa agg] iter:  2, weight: tensor([0.0138, 0.0096, 0.0114, 0.0107, 0.2289, 0.1525, 0.2702, 0.1488, 0.0743,
        0.0798])
[rfa agg] iter:  3, prev_obj_val: 108.93930053710938, obj_val: 107.87185668945312, abs dis: 1.06744384765625
[rfa agg] iter:  3, weight: tensor([0.0066, 0.0046, 0.0055, 0.0052, 0.2340, 0.1559, 0.2770, 0.1524, 0.0765,
        0.0822])
[rfa agg] iter:  4, prev_obj_val: 107.87185668945312, obj_val: 107.3879165649414, abs dis: 0.48394012451171875
[rfa agg] iter:  4, weight: tensor([0.0032, 0.0023, 0.0027, 0.0025, 0.2355, 0.1570, 0.2800, 0.1542, 0.0783,
        0.0843])
[rfa agg] iter:  5, prev_obj_val: 107.3879165649414, obj_val: 107.19359588623047, abs dis: 0.1943206787109375
[rfa agg] iter:  5, weight: tensor([0.0017, 0.0012, 0.0014, 0.0013, 0.2345, 0.1569, 0.2789, 0.1549, 0.0815,
        0.0879])
[rfa agg] iter:  6, prev_obj_val: 107.19359588623047, obj_val: 107.13777923583984, abs dis: 0.055816650390625
[rfa agg] iter:  6, weight: tensor([0.0010, 0.0007, 0.0008, 0.0008, 0.2316, 0.1564, 0.2701, 0.1546, 0.0886,
        0.0954])
[rfa agg] iter:  7, prev_obj_val: 107.13777923583984, obj_val: 107.1283950805664, abs dis: 0.0093841552734375
[rfa agg] iter:  7, weight: tensor([0.0007, 0.0005, 0.0006, 0.0005, 0.2285, 0.1565, 0.2552, 0.1533, 0.0990,
        0.1052])
[rfa agg] iter:  8, prev_obj_val: 107.1283950805664, obj_val: 107.12739562988281, abs dis: 0.00099945068359375
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0004, 0.0005, 0.0005, 0.2269, 0.1576, 0.2435, 0.1522, 0.1063,
        0.1115])
___Test Target_Simple poisoned: False, epoch: 64: Average loss: 0.0797, Accuracy: 9772/10000 (97.7200%)
___Test Target_Simple poisoned: True, epoch: 64: Average loss: 4.6197, Accuracy: 212/8968 (2.3640%)
Done in 89.79063057899475 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:65 choose agents : [41, 73, 51, 74, 75, 62, 42, 43, 87, 26]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   1,  Average loss: 0.0160, Accuracy: 376/606 (62.0462%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   2,  Average loss: 0.0129, Accuracy: 345/606 (56.9307%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   3,  Average loss: 0.0105, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   4,  Average loss: 0.0101, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   5,  Average loss: 0.0099, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   6,  Average loss: 0.0099, Accuracy: 423/606 (69.8020%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   7,  Average loss: 0.0096, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch  10,  Average loss: 0.0094, Accuracy: 433/606 (71.4521%), train_poison_data_count: 200
Global model norm: 16.43014443016536.
Norm before scaling: 16.448840736424728. Distance: 2.113839969355803
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.8929, Accuracy: 6606/10000 (66.0600%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.5882, Accuracy: 6333/8968 (70.6178%)
Scaling by  100
Scaled Norm after poisoning: 211.11082693694325, distance: 211.3839904208689
Total norm for 4 adversaries is: 211.11082693694325. distance: 211.3839904208689
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   1,  Average loss: 0.0190, Accuracy: 329/591 (55.6684%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   2,  Average loss: 0.0146, Accuracy: 325/591 (54.9915%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   3,  Average loss: 0.0081, Accuracy: 463/591 (78.3418%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   4,  Average loss: 0.0048, Accuracy: 547/591 (92.5550%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   5,  Average loss: 0.0035, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   6,  Average loss: 0.0025, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   7,  Average loss: 0.0024, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   8,  Average loss: 0.0016, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   9,  Average loss: 0.0015, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch  10,  Average loss: 0.0014, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Global model norm: 16.43014443016536.
Norm before scaling: 16.60366071299536. Distance: 2.795007689709398
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.5025, Accuracy: 8632/10000 (86.3200%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0425, Accuracy: 8823/8968 (98.3831%)
Scaling by  100
Scaled Norm after poisoning: 279.6115329792389, distance: 279.5007546948666
Total norm for 4 adversaries is: 279.6115329792389. distance: 279.5007546948666
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   1,  Average loss: 0.0140, Accuracy: 365/568 (64.2606%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   2,  Average loss: 0.0068, Accuracy: 483/568 (85.0352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   3,  Average loss: 0.0024, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   4,  Average loss: 0.0020, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   5,  Average loss: 0.0016, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   6,  Average loss: 0.0013, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   7,  Average loss: 0.0010, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   8,  Average loss: 0.0010, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   9,  Average loss: 0.0008, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch  10,  Average loss: 0.0007, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Global model norm: 16.43014443016536.
Norm before scaling: 16.62057091936215. Distance: 2.4342199900566617
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.5197, Accuracy: 8266/10000 (82.6600%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0409, Accuracy: 8821/8968 (98.3608%)
Scaling by  100
Scaled Norm after poisoning: 244.05132816940375, distance: 243.42200688824337
Total norm for 4 adversaries is: 244.05132816940375. distance: 243.42200688824337
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   1,  Average loss: 0.0103, Accuracy: 426/557 (76.4811%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 511/557 (91.7415%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   3,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   4,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   5,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   7,  Average loss: 0.0012, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   8,  Average loss: 0.0010, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Global model norm: 16.43014443016536.
Norm before scaling: 16.649172540671877. Distance: 2.41397420480974
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.4053, Accuracy: 8801/10000 (88.0100%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0190, Accuracy: 8913/8968 (99.3867%)
Scaling by  100
Scaled Norm after poisoning: 242.2487906316562, distance: 241.39742904596147
Total norm for 4 adversaries is: 242.2487906316562. distance: 241.39742904596147
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  65, local model 75, internal_epoch   1,  Average loss: 0.0010, Accuracy: 671/686 (97.8134%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1033, Accuracy: 9660/10000 (96.6000%)
___Train Local_Simple,  epoch  65, local model 62, internal_epoch   1,  Average loss: 0.0010, Accuracy: 418/423 (98.8180%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.0907, Accuracy: 9734/10000 (97.3400%)
___Train Local_Simple,  epoch  65, local model 42, internal_epoch   1,  Average loss: 0.0013, Accuracy: 232/236 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.0931, Accuracy: 9712/10000 (97.1200%)
___Train Local_Simple,  epoch  65, local model 43, internal_epoch   1,  Average loss: 0.0014, Accuracy: 401/408 (98.2843%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1124, Accuracy: 9669/10000 (96.6900%)
___Train Local_Simple,  epoch  65, local model 87, internal_epoch   1,  Average loss: 0.0009, Accuracy: 462/470 (98.2979%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1650, Accuracy: 9484/10000 (94.8400%)
___Train Local_Simple,  epoch  65, local model 26, internal_epoch   1,  Average loss: 0.0011, Accuracy: 541/554 (97.6534%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1186, Accuracy: 9644/10000 (96.4400%)
time spent on training: 75.14606213569641
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.45538340851147285  data num: [606, 591, 568, 557, 686, 423, 236, 408, 470, 554]
[rfa agg] considering poison per batch poison_fraction: 0.14230731515983527
[rfa agg] init. name: [41, 73, 51, 74, 75, 62, 42, 43, 87, 26], weight: tensor([0.1188, 0.1159, 0.1114, 0.1092, 0.1345, 0.0830, 0.0463, 0.0800, 0.0922,
        0.1086])
[rfa agg] iter:  0, prev_obj_val: 132.64401245117188, obj_val: 120.35082244873047, abs dis: 12.293190002441406
[rfa agg] iter:  0, weight: tensor([0.0634, 0.0487, 0.0544, 0.0526, 0.1926, 0.1190, 0.0664, 0.1148, 0.1323,
        0.1558])
[rfa agg] iter:  1, prev_obj_val: 120.35082244873047, obj_val: 115.51576232910156, abs dis: 4.835060119628906
[rfa agg] iter:  1, weight: tensor([0.0326, 0.0240, 0.0269, 0.0263, 0.2192, 0.1358, 0.0758, 0.1309, 0.1510,
        0.1775])
[rfa agg] iter:  2, prev_obj_val: 115.51576232910156, obj_val: 113.28177642822266, abs dis: 2.2339859008789062
[rfa agg] iter:  2, weight: tensor([0.0167, 0.0123, 0.0136, 0.0134, 0.2318, 0.1442, 0.0805, 0.1389, 0.1604,
        0.1882])
[rfa agg] iter:  3, prev_obj_val: 113.28177642822266, obj_val: 112.18966674804688, abs dis: 1.0921096801757812
[rfa agg] iter:  3, weight: tensor([0.0086, 0.0063, 0.0070, 0.0069, 0.2371, 0.1487, 0.0830, 0.1432, 0.1657,
        0.1935])
[rfa agg] iter:  4, prev_obj_val: 112.18966674804688, obj_val: 111.64876556396484, abs dis: 0.5409011840820312
[rfa agg] iter:  4, weight: tensor([0.0045, 0.0033, 0.0036, 0.0036, 0.2376, 0.1518, 0.0848, 0.1457, 0.1692,
        0.1960])
[rfa agg] iter:  5, prev_obj_val: 111.64876556396484, obj_val: 111.39010620117188, abs dis: 0.25865936279296875
[rfa agg] iter:  5, weight: tensor([0.0023, 0.0017, 0.0019, 0.0019, 0.2338, 0.1550, 0.0867, 0.1478, 0.1723,
        0.1965])
[rfa agg] iter:  6, prev_obj_val: 111.39010620117188, obj_val: 111.282470703125, abs dis: 0.107635498046875
[rfa agg] iter:  6, weight: tensor([0.0013, 0.0010, 0.0011, 0.0010, 0.2246, 0.1606, 0.0901, 0.1504, 0.1751,
        0.1949])
[rfa agg] iter:  7, prev_obj_val: 111.282470703125, obj_val: 111.25013732910156, abs dis: 0.0323333740234375
[rfa agg] iter:  7, weight: tensor([0.0008, 0.0006, 0.0007, 0.0007, 0.2109, 0.1705, 0.0963, 0.1536, 0.1756,
        0.1904])
[rfa agg] iter:  8, prev_obj_val: 111.25013732910156, obj_val: 111.24413299560547, abs dis: 0.00600433349609375
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0005, 0.0005, 0.0005, 0.1989, 0.1824, 0.1035, 0.1559, 0.1723,
        0.1849])
[rfa agg] iter:  9, prev_obj_val: 111.24413299560547, obj_val: 111.24339294433594, abs dis: 0.00074005126953125
[rfa agg] iter:  9, weight: tensor([0.0006, 0.0004, 0.0004, 0.0004, 0.1924, 0.1904, 0.1082, 0.1569, 0.1689,
        0.1813])
___Test Target_Simple poisoned: False, epoch: 65: Average loss: 0.0795, Accuracy: 9770/10000 (97.7000%)
___Test Target_Simple poisoned: True, epoch: 65: Average loss: 4.5574, Accuracy: 233/8968 (2.5981%)
Done in 89.34618878364563 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:66 choose agents : [41, 73, 51, 74, 49, 52, 36, 55, 83, 33]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   1,  Average loss: 0.0160, Accuracy: 364/606 (60.0660%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   2,  Average loss: 0.0123, Accuracy: 364/606 (60.0660%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   3,  Average loss: 0.0104, Accuracy: 425/606 (70.1320%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   4,  Average loss: 0.0097, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   5,  Average loss: 0.0100, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   6,  Average loss: 0.0095, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   7,  Average loss: 0.0095, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   8,  Average loss: 0.0096, Accuracy: 435/606 (71.7822%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch  10,  Average loss: 0.0094, Accuracy: 437/606 (72.1122%), train_poison_data_count: 200
Global model norm: 16.43137306350121.
Norm before scaling: 16.436184558521994. Distance: 2.034980400234754
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.8691, Accuracy: 6748/10000 (67.4800%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.6434, Accuracy: 5989/8968 (66.7819%)
Scaling by  100
Scaled Norm after poisoning: 203.18252070183104, distance: 203.49804206674816
Total norm for 4 adversaries is: 203.18252070183104. distance: 203.49804206674816
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   1,  Average loss: 0.0200, Accuracy: 330/591 (55.8376%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   2,  Average loss: 0.0158, Accuracy: 328/591 (55.4992%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   3,  Average loss: 0.0076, Accuracy: 480/591 (81.2183%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   4,  Average loss: 0.0053, Accuracy: 535/591 (90.5245%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   5,  Average loss: 0.0041, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   6,  Average loss: 0.0032, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   7,  Average loss: 0.0023, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   8,  Average loss: 0.0022, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   9,  Average loss: 0.0017, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch  10,  Average loss: 0.0012, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Global model norm: 16.43137306350121.
Norm before scaling: 16.627368729571753. Distance: 2.900479895248664
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.5490, Accuracy: 8395/10000 (83.9500%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0353, Accuracy: 8844/8968 (98.6173%)
Scaling by  100
Scaled Norm after poisoning: 290.180076095, distance: 290.0479755574929
Total norm for 4 adversaries is: 290.180076095. distance: 290.0479755574929
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   1,  Average loss: 0.0144, Accuracy: 382/568 (67.2535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   2,  Average loss: 0.0061, Accuracy: 485/568 (85.3873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   3,  Average loss: 0.0027, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   4,  Average loss: 0.0020, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   5,  Average loss: 0.0017, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   6,  Average loss: 0.0015, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   7,  Average loss: 0.0010, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   8,  Average loss: 0.0010, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   9,  Average loss: 0.0010, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch  10,  Average loss: 0.0010, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Global model norm: 16.43137306350121.
Norm before scaling: 16.616284832382338. Distance: 2.5125935930878036
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.5736, Accuracy: 8077/10000 (80.7700%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0391, Accuracy: 8821/8968 (98.3608%)
Scaling by  100
Scaled Norm after poisoning: 251.75586512532334, distance: 251.25933595838782
Total norm for 4 adversaries is: 251.75586512532334. distance: 251.25933595838782
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   1,  Average loss: 0.0113, Accuracy: 419/557 (75.2244%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   3,  Average loss: 0.0025, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   4,  Average loss: 0.0017, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   5,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   7,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   8,  Average loss: 0.0013, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.43137306350121.
Norm before scaling: 16.721020581796886. Distance: 2.705254041549756
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.4350, Accuracy: 8665/10000 (86.6500%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0141, Accuracy: 8920/8968 (99.4648%)
Scaling by  100
Scaled Norm after poisoning: 271.44503357033443, distance: 270.52541470257466
Total norm for 4 adversaries is: 271.44503357033443. distance: 270.52541470257466
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  66, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 499/506 (98.6166%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1243, Accuracy: 9602/10000 (96.0200%)
___Train Local_Simple,  epoch  66, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 248/253 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1205, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch  66, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 985/1005 (98.0100%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1921, Accuracy: 9409/10000 (94.0900%)
___Train Local_Simple,  epoch  66, local model 55, internal_epoch   1,  Average loss: 0.0015, Accuracy: 348/354 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1817, Accuracy: 9397/10000 (93.9700%)
___Train Local_Simple,  epoch  66, local model 83, internal_epoch   1,  Average loss: 0.0013, Accuracy: 424/433 (97.9215%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.0798, Accuracy: 9744/10000 (97.4400%)
___Train Local_Simple,  epoch  66, local model 33, internal_epoch   1,  Average loss: 0.0015, Accuracy: 603/623 (96.7897%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2340, Accuracy: 9210/10000 (92.1000%)
time spent on training: 75.000173330307
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.42248908296943233  data num: [606, 591, 568, 557, 506, 253, 1005, 354, 433, 623]
[rfa agg] considering poison per batch poison_fraction: 0.1320278384279476
[rfa agg] init. name: [41, 73, 51, 74, 49, 52, 36, 55, 83, 33], weight: tensor([0.1103, 0.1075, 0.1033, 0.1013, 0.0921, 0.0460, 0.1829, 0.0644, 0.0788,
        0.1134])
[rfa agg] iter:  0, prev_obj_val: 131.10897827148438, obj_val: 116.57268524169922, abs dis: 14.536293029785156
[rfa agg] iter:  0, weight: tensor([0.0574, 0.0410, 0.0462, 0.0408, 0.1299, 0.0650, 0.2578, 0.0910, 0.1111,
        0.1598])
[rfa agg] iter:  1, prev_obj_val: 116.57268524169922, obj_val: 111.16950225830078, abs dis: 5.4031829833984375
[rfa agg] iter:  1, weight: tensor([0.0265, 0.0180, 0.0202, 0.0181, 0.1463, 0.0733, 0.2900, 0.1027, 0.1252,
        0.1797])
[rfa agg] iter:  2, prev_obj_val: 111.16950225830078, obj_val: 108.8934097290039, abs dis: 2.276092529296875
[rfa agg] iter:  2, weight: tensor([0.0119, 0.0081, 0.0091, 0.0082, 0.1537, 0.0773, 0.3039, 0.1082, 0.1315,
        0.1881])
[rfa agg] iter:  3, prev_obj_val: 108.8934097290039, obj_val: 107.91145324707031, abs dis: 0.9819564819335938
[rfa agg] iter:  3, weight: tensor([0.0054, 0.0037, 0.0041, 0.0037, 0.1573, 0.0798, 0.3090, 0.1115, 0.1345,
        0.1909])
[rfa agg] iter:  4, prev_obj_val: 107.91145324707031, obj_val: 107.51119232177734, abs dis: 0.40026092529296875
[rfa agg] iter:  4, weight: tensor([0.0025, 0.0017, 0.0019, 0.0017, 0.1601, 0.0828, 0.3083, 0.1146, 0.1369,
        0.1894])
[rfa agg] iter:  5, prev_obj_val: 107.51119232177734, obj_val: 107.38325500488281, abs dis: 0.12793731689453125
[rfa agg] iter:  5, weight: tensor([0.0013, 0.0009, 0.0010, 0.0009, 0.1648, 0.0891, 0.3005, 0.1179, 0.1415,
        0.1824])
[rfa agg] iter:  6, prev_obj_val: 107.38325500488281, obj_val: 107.35916137695312, abs dis: 0.0240936279296875
[rfa agg] iter:  6, weight: tensor([0.0008, 0.0005, 0.0006, 0.0006, 0.1732, 0.0998, 0.2851, 0.1184, 0.1501,
        0.1709])
[rfa agg] iter:  7, prev_obj_val: 107.35916137695312, obj_val: 107.3566665649414, abs dis: 0.00249481201171875
[rfa agg] iter:  7, weight: tensor([0.0007, 0.0005, 0.0005, 0.0005, 0.1812, 0.1082, 0.2707, 0.1167, 0.1584,
        0.1627])
[rfa agg] iter:  8, prev_obj_val: 107.3566665649414, obj_val: 107.3564453125, abs dis: 0.00022125244140625
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0004, 0.0005, 0.0004, 0.1858, 0.1119, 0.2620, 0.1160, 0.1629,
        0.1594])
___Test Target_Simple poisoned: False, epoch: 66: Average loss: 0.0793, Accuracy: 9775/10000 (97.7500%)
___Test Target_Simple poisoned: True, epoch: 66: Average loss: 4.5660, Accuracy: 245/8968 (2.7319%)
Done in 89.3423216342926 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:67 choose agents : [41, 73, 51, 74, 25, 15, 1, 67, 86, 4]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   1,  Average loss: 0.0163, Accuracy: 344/606 (56.7657%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   2,  Average loss: 0.0117, Accuracy: 387/606 (63.8614%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   3,  Average loss: 0.0104, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   4,  Average loss: 0.0101, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   5,  Average loss: 0.0102, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   6,  Average loss: 0.0098, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   8,  Average loss: 0.0094, Accuracy: 438/606 (72.2772%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   9,  Average loss: 0.0097, Accuracy: 435/606 (71.7822%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch  10,  Average loss: 0.0094, Accuracy: 432/606 (71.2871%), train_poison_data_count: 200
Global model norm: 16.431693440312422.
Norm before scaling: 16.427343211258137. Distance: 2.0542416397041596
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.8883, Accuracy: 6156/10000 (61.5600%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.4960, Accuracy: 6780/8968 (75.6021%)
Scaling by  100
Scaled Norm after poisoning: 205.01903493944167, distance: 205.42415152861165
Total norm for 4 adversaries is: 205.01903493944167. distance: 205.42415152861165
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   1,  Average loss: 0.0187, Accuracy: 322/591 (54.4839%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   2,  Average loss: 0.0129, Accuracy: 401/591 (67.8511%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   3,  Average loss: 0.0054, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   4,  Average loss: 0.0039, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   5,  Average loss: 0.0030, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   6,  Average loss: 0.0022, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   7,  Average loss: 0.0020, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   8,  Average loss: 0.0015, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   9,  Average loss: 0.0013, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch  10,  Average loss: 0.0014, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Global model norm: 16.431693440312422.
Norm before scaling: 16.60422221341608. Distance: 2.8223251811676793
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.4907, Accuracy: 8601/10000 (86.0100%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0424, Accuracy: 8824/8968 (98.3943%)
Scaling by  100
Scaled Norm after poisoning: 282.30942133588104, distance: 282.2325199414483
Total norm for 4 adversaries is: 282.30942133588104. distance: 282.2325199414483
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   1,  Average loss: 0.0130, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   2,  Average loss: 0.0076, Accuracy: 447/568 (78.6972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   3,  Average loss: 0.0031, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   4,  Average loss: 0.0025, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   5,  Average loss: 0.0018, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   6,  Average loss: 0.0015, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   7,  Average loss: 0.0013, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   8,  Average loss: 0.0012, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   9,  Average loss: 0.0011, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch  10,  Average loss: 0.0011, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Global model norm: 16.431693440312422.
Norm before scaling: 16.61593036353075. Distance: 2.539427745664692
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.6704, Accuracy: 7703/10000 (77.0300%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0244, Accuracy: 8889/8968 (99.1191%)
Scaling by  100
Scaled Norm after poisoning: 254.40305434978566, distance: 253.94278391007688
Total norm for 4 adversaries is: 254.40305434978566. distance: 253.94278391007688
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   1,  Average loss: 0.0099, Accuracy: 431/557 (77.3788%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 516/557 (92.6391%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   3,  Average loss: 0.0022, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   4,  Average loss: 0.0016, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   5,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   6,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   8,  Average loss: 0.0010, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Global model norm: 16.431693440312422.
Norm before scaling: 16.6920712956968. Distance: 2.4510867647387737
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.3604, Accuracy: 8962/10000 (89.6200%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0237, Accuracy: 8880/8968 (99.0187%)
Scaling by  100
Scaled Norm after poisoning: 246.19087170831497, distance: 245.10867328340302
Total norm for 4 adversaries is: 246.19087170831497. distance: 245.10867328340302
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  67, local model 25, internal_epoch   1,  Average loss: 0.0012, Accuracy: 633/647 (97.8362%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.2880, Accuracy: 9068/10000 (90.6800%)
___Train Local_Simple,  epoch  67, local model 15, internal_epoch   1,  Average loss: 0.0010, Accuracy: 391/401 (97.5062%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1137, Accuracy: 9633/10000 (96.3300%)
___Train Local_Simple,  epoch  67, local model 1, internal_epoch   1,  Average loss: 0.0016, Accuracy: 735/760 (96.7105%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1443, Accuracy: 9548/10000 (95.4800%)
___Train Local_Simple,  epoch  67, local model 67, internal_epoch   1,  Average loss: 0.0012, Accuracy: 977/998 (97.8958%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.2549, Accuracy: 9218/10000 (92.1800%)
___Train Local_Simple,  epoch  67, local model 86, internal_epoch   1,  Average loss: 0.0013, Accuracy: 243/250 (97.2000%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.0897, Accuracy: 9727/10000 (97.2700%)
___Train Local_Simple,  epoch  67, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 641/658 (97.4164%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.2802, Accuracy: 9060/10000 (90.6000%)
time spent on training: 74.96280860900879
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.38469184890656066  data num: [606, 591, 568, 557, 647, 401, 760, 998, 250, 658]
[rfa agg] considering poison per batch poison_fraction: 0.12021620278330021
[rfa agg] init. name: [41, 73, 51, 74, 25, 15, 1, 67, 86, 4], weight: tensor([0.1004, 0.0979, 0.0941, 0.0923, 0.1072, 0.0664, 0.1259, 0.1653, 0.0414,
        0.1090])
[rfa agg] iter:  0, prev_obj_val: 119.31665802001953, obj_val: 103.63359832763672, abs dis: 15.683059692382812
[rfa agg] iter:  0, weight: tensor([0.0454, 0.0331, 0.0358, 0.0354, 0.1482, 0.0918, 0.1739, 0.2285, 0.0573,
        0.1505])
[rfa agg] iter:  1, prev_obj_val: 103.63359832763672, obj_val: 98.19317626953125, abs dis: 5.440422058105469
[rfa agg] iter:  1, weight: tensor([0.0181, 0.0128, 0.0137, 0.0138, 0.1643, 0.1018, 0.1923, 0.2530, 0.0637,
        0.1665])
[rfa agg] iter:  2, prev_obj_val: 98.19317626953125, obj_val: 96.16548919677734, abs dis: 2.0276870727539062
[rfa agg] iter:  2, weight: tensor([0.0071, 0.0050, 0.0054, 0.0054, 0.1710, 0.1060, 0.1988, 0.2624, 0.0666,
        0.1723])
[rfa agg] iter:  3, prev_obj_val: 96.16548919677734, obj_val: 95.44490814208984, abs dis: 0.7205810546875
[rfa agg] iter:  3, weight: tensor([0.0028, 0.0020, 0.0021, 0.0022, 0.1745, 0.1085, 0.1995, 0.2652, 0.0693,
        0.1739])
[rfa agg] iter:  4, prev_obj_val: 95.44490814208984, obj_val: 95.25450897216797, abs dis: 0.190399169921875
[rfa agg] iter:  4, weight: tensor([0.0012, 0.0009, 0.0009, 0.0010, 0.1770, 0.1124, 0.1949, 0.2619, 0.0751,
        0.1746])
[rfa agg] iter:  5, prev_obj_val: 95.25450897216797, obj_val: 95.23031616210938, abs dis: 0.02419281005859375
[rfa agg] iter:  5, weight: tensor([0.0008, 0.0005, 0.0006, 0.0006, 0.1768, 0.1188, 0.1873, 0.2516, 0.0851,
        0.1780])
[rfa agg] iter:  6, prev_obj_val: 95.23031616210938, obj_val: 95.22900390625, abs dis: 0.001312255859375
[rfa agg] iter:  6, weight: tensor([0.0006, 0.0005, 0.0005, 0.0005, 0.1754, 0.1230, 0.1833, 0.2430, 0.0908,
        0.1824])
___Test Target_Simple poisoned: False, epoch: 67: Average loss: 0.0785, Accuracy: 9773/10000 (97.7300%)
___Test Target_Simple poisoned: True, epoch: 67: Average loss: 4.5566, Accuracy: 247/8968 (2.7542%)
Done in 88.86143946647644 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:68 choose agents : [41, 73, 51, 74, 83, 32, 48, 45, 93, 49]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   1,  Average loss: 0.0148, Accuracy: 386/606 (63.6964%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   2,  Average loss: 0.0117, Accuracy: 383/606 (63.2013%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   3,  Average loss: 0.0101, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   4,  Average loss: 0.0099, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   5,  Average loss: 0.0098, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   6,  Average loss: 0.0095, Accuracy: 428/606 (70.6271%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   7,  Average loss: 0.0096, Accuracy: 426/606 (70.2970%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   8,  Average loss: 0.0093, Accuracy: 438/606 (72.2772%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   9,  Average loss: 0.0096, Accuracy: 420/606 (69.3069%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch  10,  Average loss: 0.0093, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Global model norm: 16.431687868595166.
Norm before scaling: 16.428319419681312. Distance: 1.9938756634085317
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.8150, Accuracy: 6821/10000 (68.2100%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.6002, Accuracy: 6125/8968 (68.2984%)
Scaling by  100
Scaled Norm after poisoning: 199.0396376196209, distance: 199.38756817753207
Total norm for 4 adversaries is: 199.0396376196209. distance: 199.38756817753207
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 83.5773, Accuracy: 8309/8968 (92.6517%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   1,  Average loss: 0.0186, Accuracy: 339/591 (57.3604%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   2,  Average loss: 0.0123, Accuracy: 355/591 (60.0677%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   3,  Average loss: 0.0095, Accuracy: 451/591 (76.3113%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   4,  Average loss: 0.0046, Accuracy: 546/591 (92.3858%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   5,  Average loss: 0.0037, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   6,  Average loss: 0.0025, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   7,  Average loss: 0.0019, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   8,  Average loss: 0.0018, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   9,  Average loss: 0.0015, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch  10,  Average loss: 0.0013, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Global model norm: 16.431687868595166.
Norm before scaling: 16.60464677232231. Distance: 2.7869842223181744
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.5164, Accuracy: 8475/10000 (84.7500%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0391, Accuracy: 8814/8968 (98.2828%)
Scaling by  100
Scaled Norm after poisoning: 278.81439839075745, distance: 278.69841170609493
Total norm for 4 adversaries is: 278.81439839075745. distance: 278.69841170609493
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   1,  Average loss: 0.0122, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   2,  Average loss: 0.0052, Accuracy: 507/568 (89.2606%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   3,  Average loss: 0.0021, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   4,  Average loss: 0.0015, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   5,  Average loss: 0.0013, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   6,  Average loss: 0.0010, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   7,  Average loss: 0.0008, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   8,  Average loss: 0.0009, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   9,  Average loss: 0.0006, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch  10,  Average loss: 0.0007, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Global model norm: 16.431687868595166.
Norm before scaling: 16.598321374793823. Distance: 2.234722083817277
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.5202, Accuracy: 8290/10000 (82.9000%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0328, Accuracy: 8851/8968 (98.6954%)
Scaling by  100
Scaled Norm after poisoning: 224.18925110829912, distance: 223.47221758252186
Total norm for 4 adversaries is: 224.18925110829912. distance: 223.47221758252186
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   1,  Average loss: 0.0095, Accuracy: 444/557 (79.7127%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   3,  Average loss: 0.0021, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   4,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   5,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   6,  Average loss: 0.0016, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   7,  Average loss: 0.0015, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   8,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   9,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch  10,  Average loss: 0.0012, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Global model norm: 16.431687868595166.
Norm before scaling: 16.652082140069133. Distance: 2.32600746887005
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.4056, Accuracy: 8742/10000 (87.4200%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0317, Accuracy: 8834/8968 (98.5058%)
Scaling by  100
Scaled Norm after poisoning: 233.58342995597954, distance: 232.60072582915558
Total norm for 4 adversaries is: 233.58342995597954. distance: 232.60072582915558
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  68, local model 83, internal_epoch   1,  Average loss: 0.0012, Accuracy: 423/433 (97.6905%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.0884, Accuracy: 9712/10000 (97.1200%)
___Train Local_Simple,  epoch  68, local model 32, internal_epoch   1,  Average loss: 0.0017, Accuracy: 946/977 (96.8270%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2585, Accuracy: 9233/10000 (92.3300%)
___Train Local_Simple,  epoch  68, local model 48, internal_epoch   1,  Average loss: 0.0008, Accuracy: 440/448 (98.2143%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.0898, Accuracy: 9736/10000 (97.3600%)
___Train Local_Simple,  epoch  68, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 616/628 (98.0892%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1583, Accuracy: 9501/10000 (95.0100%)
___Train Local_Simple,  epoch  68, local model 93, internal_epoch   1,  Average loss: 0.0005, Accuracy: 618/623 (99.1974%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2267, Accuracy: 9265/10000 (92.6500%)
___Train Local_Simple,  epoch  68, local model 49, internal_epoch   1,  Average loss: 0.0008, Accuracy: 500/506 (98.8142%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1206, Accuracy: 9608/10000 (96.0800%)
time spent on training: 75.80224108695984
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3911066195048004  data num: [606, 591, 568, 557, 433, 977, 448, 628, 623, 506]
[rfa agg] considering poison per batch poison_fraction: 0.12222081859525014
[rfa agg] init. name: [41, 73, 51, 74, 83, 32, 48, 45, 93, 49], weight: tensor([0.1021, 0.0995, 0.0957, 0.0938, 0.0729, 0.1646, 0.0755, 0.1058, 0.1049,
        0.0852])
[rfa agg] iter:  0, prev_obj_val: 114.42198944091797, obj_val: 99.81148529052734, abs dis: 14.610504150390625
[rfa agg] iter:  0, weight: tensor([0.0454, 0.0329, 0.0403, 0.0372, 0.1011, 0.2278, 0.1047, 0.1467, 0.1455,
        0.1182])
[rfa agg] iter:  1, prev_obj_val: 99.81148529052734, obj_val: 94.65731811523438, abs dis: 5.154167175292969
[rfa agg] iter:  1, weight: tensor([0.0187, 0.0130, 0.0159, 0.0148, 0.1125, 0.2525, 0.1165, 0.1630, 0.1617,
        0.1315])
[rfa agg] iter:  2, prev_obj_val: 94.65731811523438, obj_val: 92.68415832519531, abs dis: 1.9731597900390625
[rfa agg] iter:  2, weight: tensor([0.0075, 0.0052, 0.0063, 0.0059, 0.1172, 0.2608, 0.1217, 0.1697, 0.1683,
        0.1372])
[rfa agg] iter:  3, prev_obj_val: 92.68415832519531, obj_val: 91.94561004638672, abs dis: 0.7385482788085938
[rfa agg] iter:  3, weight: tensor([0.0031, 0.0021, 0.0026, 0.0024, 0.1199, 0.2591, 0.1254, 0.1730, 0.1716,
        0.1408])
[rfa agg] iter:  4, prev_obj_val: 91.94561004638672, obj_val: 91.71883392333984, abs dis: 0.226776123046875
[rfa agg] iter:  4, weight: tensor([0.0013, 0.0009, 0.0011, 0.0010, 0.1235, 0.2428, 0.1319, 0.1762, 0.1748,
        0.1464])
[rfa agg] iter:  5, prev_obj_val: 91.71883392333984, obj_val: 91.67770385742188, abs dis: 0.04113006591796875
[rfa agg] iter:  5, weight: tensor([0.0007, 0.0005, 0.0006, 0.0006, 0.1289, 0.2088, 0.1448, 0.1798, 0.1787,
        0.1566])
[rfa agg] iter:  6, prev_obj_val: 91.67770385742188, obj_val: 91.67359924316406, abs dis: 0.0041046142578125
[rfa agg] iter:  6, weight: tensor([0.0006, 0.0004, 0.0005, 0.0004, 0.1330, 0.1806, 0.1569, 0.1816, 0.1803,
        0.1658])
[rfa agg] iter:  7, prev_obj_val: 91.67359924316406, obj_val: 91.6732406616211, abs dis: 0.00035858154296875
[rfa agg] iter:  7, weight: tensor([0.0005, 0.0004, 0.0004, 0.0004, 0.1347, 0.1675, 0.1631, 0.1822, 0.1799,
        0.1708])
___Test Target_Simple poisoned: False, epoch: 68: Average loss: 0.0778, Accuracy: 9773/10000 (97.7300%)
___Test Target_Simple poisoned: True, epoch: 68: Average loss: 4.6074, Accuracy: 242/8968 (2.6985%)
Done in 90.11594867706299 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:69 choose agents : [41, 73, 51, 74, 72, 81, 27, 30, 33, 42]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   1,  Average loss: 0.0151, Accuracy: 373/606 (61.5512%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   2,  Average loss: 0.0120, Accuracy: 394/606 (65.0165%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   3,  Average loss: 0.0106, Accuracy: 438/606 (72.2772%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   4,  Average loss: 0.0104, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   5,  Average loss: 0.0103, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   6,  Average loss: 0.0102, Accuracy: 410/606 (67.6568%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   7,  Average loss: 0.0097, Accuracy: 431/606 (71.1221%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   8,  Average loss: 0.0095, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   9,  Average loss: 0.0098, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch  10,  Average loss: 0.0096, Accuracy: 437/606 (72.1122%), train_poison_data_count: 200
Global model norm: 16.431920950486795.
Norm before scaling: 16.419984020824764. Distance: 2.1021709483110196
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.9532, Accuracy: 6011/10000 (60.1100%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.5259, Accuracy: 6718/8968 (74.9108%)
Scaling by  100
Scaled Norm after poisoning: 209.71433323094539, distance: 210.21709388748576
Total norm for 4 adversaries is: 209.71433323094539. distance: 210.21709388748576
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   1,  Average loss: 0.0196, Accuracy: 324/591 (54.8223%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   2,  Average loss: 0.0126, Accuracy: 355/591 (60.0677%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   3,  Average loss: 0.0059, Accuracy: 521/591 (88.1557%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   4,  Average loss: 0.0038, Accuracy: 561/591 (94.9239%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   5,  Average loss: 0.0031, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   6,  Average loss: 0.0023, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   7,  Average loss: 0.0021, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   8,  Average loss: 0.0016, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   9,  Average loss: 0.0013, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch  10,  Average loss: 0.0013, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Global model norm: 16.431920950486795.
Norm before scaling: 16.612540487982077. Distance: 2.763544625631666
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.5103, Accuracy: 8493/10000 (84.9300%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0403, Accuracy: 8818/8968 (98.3274%)
Scaling by  100
Scaled Norm after poisoning: 276.5409949266112, distance: 276.35446271500666
Total norm for 4 adversaries is: 276.5409949266112. distance: 276.35446271500666
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   1,  Average loss: 0.0134, Accuracy: 381/568 (67.0775%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   2,  Average loss: 0.0060, Accuracy: 486/568 (85.5634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   3,  Average loss: 0.0030, Accuracy: 529/568 (93.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   4,  Average loss: 0.0024, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   5,  Average loss: 0.0019, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   6,  Average loss: 0.0018, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   7,  Average loss: 0.0014, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   8,  Average loss: 0.0013, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   9,  Average loss: 0.0013, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch  10,  Average loss: 0.0011, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Global model norm: 16.431920950486795.
Norm before scaling: 16.608845828823416. Distance: 2.4844019666443784
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.6476, Accuracy: 7849/10000 (78.4900%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0276, Accuracy: 8865/8968 (98.8515%)
Scaling by  100
Scaled Norm after poisoning: 248.91742167333325, distance: 248.44018080314626
Total norm for 4 adversaries is: 248.91742167333325. distance: 248.44018080314626
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   1,  Average loss: 0.0091, Accuracy: 441/557 (79.1741%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   2,  Average loss: 0.0033, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   3,  Average loss: 0.0020, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   4,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   5,  Average loss: 0.0019, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   6,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   7,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch  10,  Average loss: 0.0011, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.431920950486795.
Norm before scaling: 16.638106837050113. Distance: 2.3075189299132433
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.3709, Accuracy: 8890/10000 (88.9000%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0277, Accuracy: 8861/8968 (98.8069%)
Scaling by  100
Scaled Norm after poisoning: 231.65888682230604, distance: 230.75189598354333
Total norm for 4 adversaries is: 231.65888682230604. distance: 230.75189598354333
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  69, local model 72, internal_epoch   1,  Average loss: 0.0007, Accuracy: 721/731 (98.6320%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1647, Accuracy: 9459/10000 (94.5900%)
___Train Local_Simple,  epoch  69, local model 81, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1209/1227 (98.5330%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2754, Accuracy: 9223/10000 (92.2300%)
___Train Local_Simple,  epoch  69, local model 27, internal_epoch   1,  Average loss: 0.0011, Accuracy: 463/471 (98.3015%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1397, Accuracy: 9549/10000 (95.4900%)
___Train Local_Simple,  epoch  69, local model 30, internal_epoch   1,  Average loss: 0.0013, Accuracy: 391/400 (97.7500%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1503, Accuracy: 9564/10000 (95.6400%)
___Train Local_Simple,  epoch  69, local model 33, internal_epoch   1,  Average loss: 0.0016, Accuracy: 601/623 (96.4687%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1641, Accuracy: 9446/10000 (94.4600%)
___Train Local_Simple,  epoch  69, local model 42, internal_epoch   1,  Average loss: 0.0013, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.0922, Accuracy: 9721/10000 (97.2100%)
time spent on training: 75.25149345397949
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3863560732113145  data num: [606, 591, 568, 557, 731, 1227, 471, 400, 623, 236]
[rfa agg] considering poison per batch poison_fraction: 0.12073627287853578
[rfa agg] init. name: [41, 73, 51, 74, 72, 81, 27, 30, 33, 42], weight: tensor([0.1008, 0.0983, 0.0945, 0.0927, 0.1216, 0.2042, 0.0784, 0.0666, 0.1037,
        0.0393])
[rfa agg] iter:  0, prev_obj_val: 117.26089477539062, obj_val: 102.0660400390625, abs dis: 15.194854736328125
[rfa agg] iter:  0, weight: tensor([0.0443, 0.0336, 0.0366, 0.0378, 0.1681, 0.2817, 0.1083, 0.0921, 0.1432,
        0.0543])
[rfa agg] iter:  1, prev_obj_val: 102.0660400390625, obj_val: 96.69872283935547, abs dis: 5.367317199707031
[rfa agg] iter:  1, weight: tensor([0.0179, 0.0132, 0.0143, 0.0150, 0.1863, 0.3117, 0.1202, 0.1023, 0.1587,
        0.0604])
[rfa agg] iter:  2, prev_obj_val: 96.69872283935547, obj_val: 94.6580810546875, abs dis: 2.0406417846679688
[rfa agg] iter:  2, weight: tensor([0.0071, 0.0053, 0.0057, 0.0060, 0.1937, 0.3222, 0.1252, 0.1068, 0.1649,
        0.0632])
[rfa agg] iter:  3, prev_obj_val: 94.6580810546875, obj_val: 93.9050064086914, abs dis: 0.7530746459960938
[rfa agg] iter:  3, weight: tensor([0.0029, 0.0021, 0.0023, 0.0024, 0.1969, 0.3227, 0.1278, 0.1099, 0.1675,
        0.0655])
[rfa agg] iter:  4, prev_obj_val: 93.9050064086914, obj_val: 93.68417358398438, abs dis: 0.22083282470703125
[rfa agg] iter:  4, weight: tensor([0.0012, 0.0009, 0.0010, 0.0010, 0.1990, 0.3133, 0.1305, 0.1139, 0.1692,
        0.0699])
[rfa agg] iter:  5, prev_obj_val: 93.68417358398438, obj_val: 93.65005493164062, abs dis: 0.03411865234375
[rfa agg] iter:  5, weight: tensor([0.0007, 0.0005, 0.0006, 0.0006, 0.2018, 0.2954, 0.1334, 0.1175, 0.1715,
        0.0780])
[rfa agg] iter:  6, prev_obj_val: 93.65005493164062, obj_val: 93.64781951904297, abs dis: 0.00223541259765625
[rfa agg] iter:  6, weight: tensor([0.0006, 0.0004, 0.0005, 0.0005, 0.2054, 0.2815, 0.1354, 0.1185, 0.1737,
        0.0836])
[rfa agg] iter:  7, prev_obj_val: 93.64781951904297, obj_val: 93.647705078125, abs dis: 0.00011444091796875
[rfa agg] iter:  7, weight: tensor([0.0006, 0.0004, 0.0004, 0.0005, 0.2079, 0.2746, 0.1365, 0.1189, 0.1748,
        0.0854])
___Test Target_Simple poisoned: False, epoch: 69: Average loss: 0.0765, Accuracy: 9779/10000 (97.7900%)
___Test Target_Simple poisoned: True, epoch: 69: Average loss: 4.6411, Accuracy: 244/8968 (2.7208%)
Done in 89.74132013320923 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:70 choose agents : [41, 73, 51, 74, 5, 54, 88, 44, 64, 18]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   1,  Average loss: 0.0159, Accuracy: 385/606 (63.5314%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   2,  Average loss: 0.0135, Accuracy: 324/606 (53.4653%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   3,  Average loss: 0.0108, Accuracy: 419/606 (69.1419%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   4,  Average loss: 0.0106, Accuracy: 404/606 (66.6667%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   5,  Average loss: 0.0101, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   6,  Average loss: 0.0101, Accuracy: 422/606 (69.6370%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   7,  Average loss: 0.0098, Accuracy: 436/606 (71.9472%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   8,  Average loss: 0.0097, Accuracy: 430/606 (70.9571%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   9,  Average loss: 0.0096, Accuracy: 427/606 (70.4620%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch  10,  Average loss: 0.0095, Accuracy: 429/606 (70.7921%), train_poison_data_count: 200
Global model norm: 16.432446533376144.
Norm before scaling: 16.419314924438552. Distance: 2.1549898971356205
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.9842, Accuracy: 5565/10000 (55.6500%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.3944, Accuracy: 7464/8968 (83.2293%)
Scaling by  100
Scaled Norm after poisoning: 214.94720463697593, distance: 215.4989849164028
Total norm for 4 adversaries is: 214.94720463697593. distance: 215.4989849164028
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 10754.9772, Accuracy: 3647/8968 (40.6668%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   1,  Average loss: 0.0176, Accuracy: 336/591 (56.8528%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   2,  Average loss: 0.0116, Accuracy: 374/591 (63.2826%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   3,  Average loss: 0.0065, Accuracy: 510/591 (86.2944%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   4,  Average loss: 0.0039, Accuracy: 557/591 (94.2470%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   5,  Average loss: 0.0028, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   6,  Average loss: 0.0021, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   7,  Average loss: 0.0017, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   8,  Average loss: 0.0015, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   9,  Average loss: 0.0015, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch  10,  Average loss: 0.0012, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Global model norm: 16.432446533376144.
Norm before scaling: 16.588537169674954. Distance: 2.704438700656369
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.5153, Accuracy: 8495/10000 (84.9500%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0306, Accuracy: 8865/8968 (98.8515%)
Scaling by  100
Scaled Norm after poisoning: 270.5437955535111, distance: 270.44387703366476
Total norm for 4 adversaries is: 270.5437955535111. distance: 270.44387703366476
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   1,  Average loss: 0.0145, Accuracy: 374/568 (65.8451%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   2,  Average loss: 0.0057, Accuracy: 483/568 (85.0352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   3,  Average loss: 0.0023, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   4,  Average loss: 0.0018, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   5,  Average loss: 0.0015, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   6,  Average loss: 0.0015, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   7,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   8,  Average loss: 0.0010, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   9,  Average loss: 0.0009, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch  10,  Average loss: 0.0008, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Global model norm: 16.432446533376144.
Norm before scaling: 16.647030567310928. Distance: 2.538497345456202
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.6174, Accuracy: 8014/10000 (80.1400%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0331, Accuracy: 8856/8968 (98.7511%)
Scaling by  100
Scaled Norm after poisoning: 254.50962346736517, distance: 253.8497340947987
Total norm for 4 adversaries is: 254.50962346736517. distance: 253.8497340947987
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   1,  Average loss: 0.0101, Accuracy: 432/557 (77.5583%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   2,  Average loss: 0.0036, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   3,  Average loss: 0.0020, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   4,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   5,  Average loss: 0.0014, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   6,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   7,  Average loss: 0.0011, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   8,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch  10,  Average loss: 0.0008, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Global model norm: 16.432446533376144.
Norm before scaling: 16.65772027545758. Distance: 2.331895578294111
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.3835, Accuracy: 8832/10000 (88.3200%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0267, Accuracy: 8862/8968 (98.8180%)
Scaling by  100
Scaled Norm after poisoning: 234.19875873656974, distance: 233.18956880615394
Total norm for 4 adversaries is: 234.19875873656974. distance: 233.18956880615394
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  70, local model 5, internal_epoch   1,  Average loss: 0.0015, Accuracy: 423/434 (97.4654%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1735, Accuracy: 9398/10000 (93.9800%)
___Train Local_Simple,  epoch  70, local model 54, internal_epoch   1,  Average loss: 0.0012, Accuracy: 507/519 (97.6879%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2187, Accuracy: 9314/10000 (93.1400%)
___Train Local_Simple,  epoch  70, local model 88, internal_epoch   1,  Average loss: 0.0011, Accuracy: 521/530 (98.3019%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1186, Accuracy: 9628/10000 (96.2800%)
___Train Local_Simple,  epoch  70, local model 44, internal_epoch   1,  Average loss: 0.0015, Accuracy: 504/517 (97.4855%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1574, Accuracy: 9504/10000 (95.0400%)
___Train Local_Simple,  epoch  70, local model 64, internal_epoch   1,  Average loss: 0.0016, Accuracy: 794/813 (97.6630%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1711, Accuracy: 9451/10000 (94.5100%)
___Train Local_Simple,  epoch  70, local model 18, internal_epoch   1,  Average loss: 0.0021, Accuracy: 444/459 (96.7320%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1799, Accuracy: 9386/10000 (93.8600%)
time spent on training: 74.62300610542297
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41508759385055416  data num: [606, 591, 568, 557, 434, 519, 530, 517, 813, 459]
[rfa agg] considering poison per batch poison_fraction: 0.12971487307829818
[rfa agg] init. name: [41, 73, 51, 74, 5, 54, 88, 44, 64, 18], weight: tensor([0.1083, 0.1056, 0.1015, 0.0996, 0.0776, 0.0928, 0.0947, 0.0924, 0.1453,
        0.0821])
[rfa agg] iter:  0, prev_obj_val: 124.1846923828125, obj_val: 110.17012023925781, abs dis: 14.014572143554688
[rfa agg] iter:  0, weight: tensor([0.0515, 0.0411, 0.0422, 0.0442, 0.1090, 0.1303, 0.1330, 0.1297, 0.2039,
        0.1151])
[rfa agg] iter:  1, prev_obj_val: 110.17012023925781, obj_val: 104.90284729003906, abs dis: 5.26727294921875
[rfa agg] iter:  1, weight: tensor([0.0231, 0.0179, 0.0184, 0.0196, 0.1224, 0.1463, 0.1493, 0.1454, 0.2286,
        0.1291])
[rfa agg] iter:  2, prev_obj_val: 104.90284729003906, obj_val: 102.69746398925781, abs dis: 2.20538330078125
[rfa agg] iter:  2, weight: tensor([0.0103, 0.0080, 0.0082, 0.0087, 0.1285, 0.1535, 0.1567, 0.1522, 0.2390,
        0.1351])
[rfa agg] iter:  3, prev_obj_val: 102.69746398925781, obj_val: 101.75978088378906, abs dis: 0.93768310546875
[rfa agg] iter:  3, weight: tensor([0.0046, 0.0036, 0.0037, 0.0039, 0.1318, 0.1569, 0.1604, 0.1550, 0.2426,
        0.1375])
[rfa agg] iter:  4, prev_obj_val: 101.75978088378906, obj_val: 101.38983917236328, abs dis: 0.36994171142578125
[rfa agg] iter:  4, weight: tensor([0.0021, 0.0016, 0.0017, 0.0018, 0.1350, 0.1587, 0.1637, 0.1558, 0.2415,
        0.1381])
[rfa agg] iter:  5, prev_obj_val: 101.38983917236328, obj_val: 101.281005859375, abs dis: 0.10883331298828125
[rfa agg] iter:  5, weight: tensor([0.0011, 0.0008, 0.0009, 0.0009, 0.1408, 0.1584, 0.1692, 0.1556, 0.2343,
        0.1381])
[rfa agg] iter:  6, prev_obj_val: 101.281005859375, obj_val: 101.26361846923828, abs dis: 0.01738739013671875
[rfa agg] iter:  6, weight: tensor([0.0007, 0.0006, 0.0006, 0.0006, 0.1489, 0.1548, 0.1771, 0.1552, 0.2229,
        0.1386])
[rfa agg] iter:  7, prev_obj_val: 101.26361846923828, obj_val: 101.26221466064453, abs dis: 0.00140380859375
[rfa agg] iter:  7, weight: tensor([0.0006, 0.0005, 0.0005, 0.0005, 0.1543, 0.1516, 0.1826, 0.1549, 0.2150,
        0.1394])
___Test Target_Simple poisoned: False, epoch: 70: Average loss: 0.0768, Accuracy: 9780/10000 (97.8000%)
___Test Target_Simple poisoned: True, epoch: 70: Average loss: 4.5354, Accuracy: 275/8968 (3.0665%)
Done in 89.00598788261414 sec.
Saving all the graphs.
This run has a label: Nov.13_09.31.20. Visdom environment: mnist_DBA
