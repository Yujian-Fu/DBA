current path: saved_models/model_mnist_Nov.13_10.03.50
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [51, 74]
We use following environment for graphs:  mnist_DBA
----------------------------------Start one training epoch------------------------------------------
Server Epoch:11 choose agents : [51, 74, 23, 73, 62, 11, 72, 42, 45, 37]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0226, Accuracy: 345/568 (60.7394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   2,  Average loss: 0.0130, Accuracy: 354/568 (62.3239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   3,  Average loss: 0.0115, Accuracy: 378/568 (66.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   4,  Average loss: 0.0113, Accuracy: 380/568 (66.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   5,  Average loss: 0.0113, Accuracy: 369/568 (64.9648%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   6,  Average loss: 0.0110, Accuracy: 388/568 (68.3099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   7,  Average loss: 0.0106, Accuracy: 393/568 (69.1901%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   8,  Average loss: 0.0104, Accuracy: 383/568 (67.4296%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   9,  Average loss: 0.0105, Accuracy: 385/568 (67.7817%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch  10,  Average loss: 0.0101, Accuracy: 393/568 (69.1901%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.65929208998549. Distance: 4.332608651429347
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.5322, Accuracy: 4005/10000 (40.0500%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.6246, Accuracy: 6626/8968 (73.8849%)
Scaling by  100
Scaled Norm after poisoning: 431.8668414569472, distance: 433.26085531697873
Total norm for 2 adversaries is: 431.8668414569472. distance: 433.26085531697873
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0213, Accuracy: 345/557 (61.9390%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   2,  Average loss: 0.0108, Accuracy: 401/557 (71.9928%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   3,  Average loss: 0.0057, Accuracy: 504/557 (90.4847%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   4,  Average loss: 0.0044, Accuracy: 520/557 (93.3573%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   5,  Average loss: 0.0033, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   6,  Average loss: 0.0031, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   7,  Average loss: 0.0027, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   8,  Average loss: 0.0023, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   9,  Average loss: 0.0022, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch  10,  Average loss: 0.0022, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.734693223223143. Distance: 3.92102272530284
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.6701, Accuracy: 8006/10000 (80.0600%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1052, Accuracy: 8563/8968 (95.4839%)
Scaling by  100
Scaled Norm after poisoning: 391.317885484423, distance: 392.1022467099621
Total norm for 2 adversaries is: 391.317885484423. distance: 392.1022467099621
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1445, Accuracy: 9514/10000 (95.1400%)
___Train Local_Simple,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0014, Accuracy: 574/591 (97.1235%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3774, Accuracy: 8815/10000 (88.1500%)
___Train Local_Simple,  epoch  11, local model 62, internal_epoch   1,  Average loss: 0.0009, Accuracy: 415/423 (98.1087%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1693, Accuracy: 9503/10000 (95.0300%)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 629/645 (97.5194%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2792, Accuracy: 9079/10000 (90.7900%)
___Train Local_Simple,  epoch  11, local model 72, internal_epoch   1,  Average loss: 0.0011, Accuracy: 716/731 (97.9480%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2810, Accuracy: 9112/10000 (91.1200%)
___Train Local_Simple,  epoch  11, local model 42, internal_epoch   1,  Average loss: 0.0011, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1062, Accuracy: 9669/10000 (96.6900%)
___Train Local_Simple,  epoch  11, local model 45, internal_epoch   1,  Average loss: 0.0015, Accuracy: 610/628 (97.1338%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2414, Accuracy: 9266/10000 (92.6600%)
___Train Local_Simple,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0016, Accuracy: 837/860 (97.3256%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3730, Accuracy: 8821/10000 (88.2100%)
time spent on training: 46.86851716041565
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 2.9716, Accuracy: 1853/10000 (18.5300%)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 0.0011, Accuracy: 8968/8968 (100.0000%)
Done in 56.87696838378906 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:12 choose agents : [51, 74, 21, 42, 35, 11, 60, 63, 28, 66]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   1,  Average loss: 0.0129, Accuracy: 385/568 (67.7817%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   2,  Average loss: 0.0056, Accuracy: 498/568 (87.6761%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   3,  Average loss: 0.0024, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   4,  Average loss: 0.0021, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   5,  Average loss: 0.0023, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   6,  Average loss: 0.0018, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   7,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   8,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   9,  Average loss: 0.0012, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch  10,  Average loss: 0.0010, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Global model norm: 17.427327131750044.
Norm before scaling: 17.633134412214375. Distance: 2.449920310456626
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.1404, Accuracy: 6798/10000 (67.9800%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0075, Accuracy: 8949/8968 (99.7881%)
Scaling by  100
Scaled Norm after poisoning: 245.85801606313348, distance: 244.99201995932438
Total norm for 2 adversaries is: 245.85801606313348. distance: 244.99201995932438
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 15895252.6913, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   1,  Average loss: 0.0122, Accuracy: 414/557 (74.3268%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 510/557 (91.5619%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   3,  Average loss: 0.0025, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   4,  Average loss: 0.0024, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   5,  Average loss: 0.0021, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   6,  Average loss: 0.0016, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   7,  Average loss: 0.0016, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   8,  Average loss: 0.0017, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch  10,  Average loss: 0.0017, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Global model norm: 17.427327131750044.
Norm before scaling: 17.765235916748598. Distance: 3.0746666704339423
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.8518, Accuracy: 7920/10000 (79.2000%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0166, Accuracy: 8904/8968 (99.2864%)
Scaling by  100
Scaled Norm after poisoning: 308.35579591601646, distance: 307.4666648597861
Total norm for 2 adversaries is: 308.35579591601646. distance: 307.4666648597861
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 41200379.0544, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  12, local model 21, internal_epoch   1,  Average loss: 0.0266, Accuracy: 159/312 (50.9615%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.9465, Accuracy: 3030/10000 (30.3000%)
___Train Local_Simple,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0303, Accuracy: 120/236 (50.8475%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.5749, Accuracy: 4620/10000 (46.2000%)
___Train Local_Simple,  epoch  12, local model 35, internal_epoch   1,  Average loss: 0.0200, Accuracy: 299/499 (59.9198%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.9206, Accuracy: 3971/10000 (39.7100%)
___Train Local_Simple,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0224, Accuracy: 413/645 (64.0310%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.6062, Accuracy: 4963/10000 (49.6300%)
___Train Local_Simple,  epoch  12, local model 60, internal_epoch   1,  Average loss: 0.0188, Accuracy: 220/338 (65.0888%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.1096, Accuracy: 6538/10000 (65.3800%)
___Train Local_Simple,  epoch  12, local model 63, internal_epoch   1,  Average loss: 0.0146, Accuracy: 611/889 (68.7289%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.7994, Accuracy: 6981/10000 (69.8100%)
___Train Local_Simple,  epoch  12, local model 28, internal_epoch   1,  Average loss: 0.0262, Accuracy: 281/501 (56.0878%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.5875, Accuracy: 6417/10000 (64.1700%)
___Train Local_Simple,  epoch  12, local model 66, internal_epoch   1,  Average loss: 0.0216, Accuracy: 394/660 (59.6970%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 5.2518, Accuracy: 4556/10000 (45.5600%)
time spent on training: 45.41386342048645
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 1.3911, Accuracy: 7481/10000 (74.8100%)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 0.0589, Accuracy: 8783/8968 (97.9371%)
Done in 55.0391321182251 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:13 choose agents : [51, 74, 22, 80, 59, 41, 83, 55, 56, 62]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   1,  Average loss: 0.0026, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   2,  Average loss: 0.0012, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   3,  Average loss: 0.0008, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   4,  Average loss: 0.0005, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   5,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   6,  Average loss: 0.0005, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   7,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   8,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   9,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch  10,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Global model norm: 18.197654589764017.
Norm before scaling: 18.243453014187292. Distance: 1.660477048509099
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.0304, Accuracy: 7600/10000 (76.0000%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0008, Accuracy: 8965/8968 (99.9665%)
Scaling by  100
Scaled Norm after poisoning: 166.7158299884867, distance: 166.04770351844678
Total norm for 2 adversaries is: 166.7158299884867. distance: 166.04770351844678
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 731758.2061, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   1,  Average loss: 0.0031, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   2,  Average loss: 0.0027, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   3,  Average loss: 0.0018, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   4,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   5,  Average loss: 0.0013, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   6,  Average loss: 0.0010, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   7,  Average loss: 0.0009, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   8,  Average loss: 0.0008, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch  10,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Global model norm: 18.197654589764017.
Norm before scaling: 18.260190026254435. Distance: 1.807054956711928
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6590, Accuracy: 8066/10000 (80.6600%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0002, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 181.34794767242335, distance: 180.70549676891403
Total norm for 2 adversaries is: 181.34794767242335. distance: 180.70549676891403
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  13, local model 22, internal_epoch   1,  Average loss: 0.0088, Accuracy: 500/583 (85.7633%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6945, Accuracy: 7621/10000 (76.2100%)
___Train Local_Simple,  epoch  13, local model 80, internal_epoch   1,  Average loss: 0.0092, Accuracy: 363/431 (84.2227%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.0604, Accuracy: 6400/10000 (64.0000%)
___Train Local_Simple,  epoch  13, local model 59, internal_epoch   1,  Average loss: 0.0042, Accuracy: 713/760 (93.8158%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.0413, Accuracy: 6592/10000 (65.9200%)
___Train Local_Simple,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0077, Accuracy: 533/606 (87.9538%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.3310, Accuracy: 5605/10000 (56.0500%)
___Train Local_Simple,  epoch  13, local model 83, internal_epoch   1,  Average loss: 0.0108, Accuracy: 349/433 (80.6005%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.7259, Accuracy: 7780/10000 (77.8000%)
___Train Local_Simple,  epoch  13, local model 55, internal_epoch   1,  Average loss: 0.0060, Accuracy: 317/354 (89.5480%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.9948, Accuracy: 5203/10000 (52.0300%)
___Train Local_Simple,  epoch  13, local model 56, internal_epoch   1,  Average loss: 0.0090, Accuracy: 737/880 (83.7500%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.5629, Accuracy: 8297/10000 (82.9700%)
___Train Local_Simple,  epoch  13, local model 62, internal_epoch   1,  Average loss: 0.0086, Accuracy: 369/423 (87.2340%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.5720, Accuracy: 8220/10000 (82.2000%)
time spent on training: 42.99929475784302
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 1.6139, Accuracy: 5869/10000 (58.6900%)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 52.38017225265503 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:14 choose agents : [51, 74, 75, 18, 42, 89, 41, 50, 28, 37]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   1,  Average loss: 0.0016, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   2,  Average loss: 0.0008, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   3,  Average loss: 0.0005, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   4,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   5,  Average loss: 0.0003, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   6,  Average loss: 0.0002, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   7,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch  10,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 18.385658546420004.
Norm before scaling: 18.417446390392147. Distance: 1.287383911306428
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.8510, Accuracy: 7780/10000 (77.8000%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 129.85707287244696, distance: 128.73838691557773
Total norm for 2 adversaries is: 129.85707287244696. distance: 128.73838691557773
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 4614837.8408, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0032, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   2,  Average loss: 0.0013, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   3,  Average loss: 0.0009, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   4,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   5,  Average loss: 0.0009, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   6,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   7,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch  10,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Global model norm: 18.385658546420004.
Norm before scaling: 18.431503924369885. Distance: 1.6071177828815781
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.5142, Accuracy: 8402/10000 (84.0200%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0001, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 161.48317685211052, distance: 160.71178953914676
Total norm for 2 adversaries is: 161.48317685211052. distance: 160.71178953914676
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 4992610.8684, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  14, local model 75, internal_epoch   1,  Average loss: 0.0073, Accuracy: 579/686 (84.4023%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.6803, Accuracy: 7874/10000 (78.7400%)
___Train Local_Simple,  epoch  14, local model 18, internal_epoch   1,  Average loss: 0.0105, Accuracy: 386/459 (84.0959%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.0571, Accuracy: 6836/10000 (68.3600%)
___Train Local_Simple,  epoch  14, local model 42, internal_epoch   1,  Average loss: 0.0204, Accuracy: 169/236 (71.6102%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.0404, Accuracy: 6027/10000 (60.2700%)
___Train Local_Simple,  epoch  14, local model 89, internal_epoch   1,  Average loss: 0.0080, Accuracy: 415/492 (84.3496%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.3718, Accuracy: 6771/10000 (67.7100%)
___Train Local_Simple,  epoch  14, local model 41, internal_epoch   1,  Average loss: 0.0085, Accuracy: 524/606 (86.4686%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.1749, Accuracy: 5958/10000 (59.5800%)
___Train Local_Simple,  epoch  14, local model 50, internal_epoch   1,  Average loss: 0.0193, Accuracy: 319/474 (67.2996%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.9105, Accuracy: 4484/10000 (44.8400%)
___Train Local_Simple,  epoch  14, local model 28, internal_epoch   1,  Average loss: 0.0088, Accuracy: 425/501 (84.8303%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.5856, Accuracy: 8307/10000 (83.0700%)
___Train Local_Simple,  epoch  14, local model 37, internal_epoch   1,  Average loss: 0.0046, Accuracy: 781/860 (90.8140%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.2101, Accuracy: 6553/10000 (65.5300%)
time spent on training: 45.777554512023926
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 0.8636, Accuracy: 7861/10000 (78.6100%)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 0.0001, Accuracy: 8967/8968 (99.9888%)
Done in 55.35438013076782 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:15 choose agents : [51, 74, 94, 97, 78, 13, 96, 76, 45, 44]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   1,  Average loss: 0.0028, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   2,  Average loss: 0.0011, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   4,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   5,  Average loss: 0.0003, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   6,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   7,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch  10,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 18.538709403243004.
Norm before scaling: 18.61786776191087. Distance: 2.127143676180857
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.8475, Accuracy: 7858/10000 (78.5800%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 213.14956786550144, distance: 212.71437715866787
Total norm for 2 adversaries is: 213.14956786550144. distance: 212.71437715866787
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 150185.9053, Accuracy: 6094/8968 (67.9527%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   1,  Average loss: 0.0016, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   2,  Average loss: 0.0007, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   3,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   4,  Average loss: 0.0003, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.538709403243004.
Norm before scaling: 18.53315691600968. Distance: 1.1360052432254895
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.4325, Accuracy: 8702/10000 (87.0200%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 114.45141316979227, distance: 113.60051991518348
Total norm for 2 adversaries is: 114.45141316979227. distance: 113.60051991518348
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 106668.1125, Accuracy: 128/8968 (1.4273%)
___Train Local_Simple,  epoch  15, local model 94, internal_epoch   1,  Average loss: 0.0359, Accuracy: 86/150 (57.3333%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.8211, Accuracy: 7255/10000 (72.5500%)
___Train Local_Simple,  epoch  15, local model 97, internal_epoch   1,  Average loss: 0.0072, Accuracy: 423/487 (86.8583%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.1155, Accuracy: 7697/10000 (76.9700%)
___Train Local_Simple,  epoch  15, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 283/303 (93.3993%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.7083, Accuracy: 7934/10000 (79.3400%)
___Train Local_Simple,  epoch  15, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 672/734 (91.5531%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.6693, Accuracy: 7853/10000 (78.5300%)
___Train Local_Simple,  epoch  15, local model 96, internal_epoch   1,  Average loss: 0.0063, Accuracy: 602/672 (89.5833%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.0699, Accuracy: 7249/10000 (72.4900%)
___Train Local_Simple,  epoch  15, local model 76, internal_epoch   1,  Average loss: 0.0063, Accuracy: 72/78 (92.3077%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.6405, Accuracy: 8012/10000 (80.1200%)
___Train Local_Simple,  epoch  15, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 568/628 (90.4459%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.0829, Accuracy: 6690/10000 (66.9000%)
___Train Local_Simple,  epoch  15, local model 44, internal_epoch   1,  Average loss: 0.0063, Accuracy: 464/517 (89.7485%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3440, Accuracy: 8951/10000 (89.5100%)
time spent on training: 49.252460956573486
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 0.7899, Accuracy: 7948/10000 (79.4800%)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 62.27944302558899 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:16 choose agents : [51, 74, 61, 49, 66, 14, 36, 24, 7, 4]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.68063749022007.
Norm before scaling: 18.652647657864485. Distance: 0.758287654451136
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8974, Accuracy: 7870/10000 (78.7000%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 77.05176260861104, distance: 75.82875444051551
Total norm for 2 adversaries is: 77.05176260861104. distance: 75.82875444051551
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 103040.8346, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   1,  Average loss: 0.0026, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   2,  Average loss: 0.0011, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   3,  Average loss: 0.0005, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   4,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   5,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   6,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   7,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   8,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   9,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Global model norm: 18.68063749022007.
Norm before scaling: 18.712807350463127. Distance: 1.5618517484609518
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.5408, Accuracy: 8387/10000 (83.8700%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 156.90485273725602, distance: 156.1851740523088
Total norm for 2 adversaries is: 156.90485273725602. distance: 156.1851740523088
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 2162710.1262, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  16, local model 61, internal_epoch   1,  Average loss: 0.0053, Accuracy: 623/699 (89.1273%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4753, Accuracy: 8616/10000 (86.1600%)
___Train Local_Simple,  epoch  16, local model 49, internal_epoch   1,  Average loss: 0.0038, Accuracy: 463/506 (91.5020%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3884, Accuracy: 8777/10000 (87.7700%)
___Train Local_Simple,  epoch  16, local model 66, internal_epoch   1,  Average loss: 0.0059, Accuracy: 597/660 (90.4545%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.4590, Accuracy: 6217/10000 (62.1700%)
___Train Local_Simple,  epoch  16, local model 14, internal_epoch   1,  Average loss: 0.0071, Accuracy: 345/376 (91.7553%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.5906, Accuracy: 8071/10000 (80.7100%)
___Train Local_Simple,  epoch  16, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 941/1005 (93.6318%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8057, Accuracy: 7765/10000 (77.6500%)
___Train Local_Simple,  epoch  16, local model 24, internal_epoch   1,  Average loss: 0.0073, Accuracy: 327/379 (86.2797%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.6796, Accuracy: 7584/10000 (75.8400%)
___Train Local_Simple,  epoch  16, local model 7, internal_epoch   1,  Average loss: 0.0109, Accuracy: 337/418 (80.6220%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.6689, Accuracy: 7879/10000 (78.7900%)
___Train Local_Simple,  epoch  16, local model 4, internal_epoch   1,  Average loss: 0.0057, Accuracy: 585/658 (88.9058%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.6596, Accuracy: 8038/10000 (80.3800%)
time spent on training: 49.39081311225891
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.6799, Accuracy: 8141/10000 (81.4100%)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 59.38336896896362 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:17 choose agents : [51, 74, 78, 39, 26, 29, 4, 41, 68, 93]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   1,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   5,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   6,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   7,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 18.6955663310704.
Norm before scaling: 18.680662811740312. Distance: 0.8828702249474811
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.7352, Accuracy: 8230/10000 (82.3000%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 89.50123842544023, distance: 88.28702414745045
Total norm for 2 adversaries is: 89.50123842544023. distance: 88.28702414745045
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 2246071.4458, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   1,  Average loss: 0.0008, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.6955663310704.
Norm before scaling: 18.690705397649356. Distance: 0.7483582408883294
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4061, Accuracy: 8848/10000 (88.4800%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 76.6534154082517, distance: 74.83582291005425
Total norm for 2 adversaries is: 76.6534154082517. distance: 74.83582291005425
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 340715.2719, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  17, local model 78, internal_epoch   1,  Average loss: 0.0074, Accuracy: 270/303 (89.1089%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.6703, Accuracy: 7925/10000 (79.2500%)
___Train Local_Simple,  epoch  17, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 243/257 (94.5525%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9815, Accuracy: 7400/10000 (74.0000%)
___Train Local_Simple,  epoch  17, local model 26, internal_epoch   1,  Average loss: 0.0071, Accuracy: 489/554 (88.2671%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4283, Accuracy: 8627/10000 (86.2700%)
___Train Local_Simple,  epoch  17, local model 29, internal_epoch   1,  Average loss: 0.0032, Accuracy: 945/1002 (94.3114%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9594, Accuracy: 7509/10000 (75.0900%)
___Train Local_Simple,  epoch  17, local model 4, internal_epoch   1,  Average loss: 0.0040, Accuracy: 609/658 (92.5532%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.8260, Accuracy: 7591/10000 (75.9100%)
___Train Local_Simple,  epoch  17, local model 41, internal_epoch   1,  Average loss: 0.0048, Accuracy: 558/606 (92.0792%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.7223, Accuracy: 7605/10000 (76.0500%)
___Train Local_Simple,  epoch  17, local model 68, internal_epoch   1,  Average loss: 0.0038, Accuracy: 457/494 (92.5101%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.6876, Accuracy: 8087/10000 (80.8700%)
___Train Local_Simple,  epoch  17, local model 93, internal_epoch   1,  Average loss: 0.0030, Accuracy: 594/623 (95.3451%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4404, Accuracy: 8635/10000 (86.3500%)
time spent on training: 47.82090997695923
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.6143, Accuracy: 8452/10000 (84.5200%)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 57.68292689323425 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:18 choose agents : [51, 74, 78, 8, 25, 67, 69, 60, 63, 31]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.685312404618852.
Norm before scaling: 18.636244279094385. Distance: 0.6480012828201971
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.7638, Accuracy: 8292/10000 (82.9200%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 65.75012996066053, distance: 64.80012839975704
Total norm for 2 adversaries is: 65.75012996066053. distance: 64.80012839975704
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 294820.8844, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   1,  Average loss: 0.0008, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   2,  Average loss: 0.0008, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.685312404618852.
Norm before scaling: 18.663397003099742. Distance: 1.034616005471632
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4596, Accuracy: 8828/10000 (88.2800%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 104.2331371253883, distance: 103.4616050085127
Total norm for 2 adversaries is: 104.2331371253883. distance: 103.4616050085127
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 2527706.9135, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  18, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 286/303 (94.3894%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6753, Accuracy: 8449/10000 (84.4900%)
___Train Local_Simple,  epoch  18, local model 8, internal_epoch   1,  Average loss: 0.0079, Accuracy: 549/633 (86.7299%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4175, Accuracy: 8726/10000 (87.2600%)
___Train Local_Simple,  epoch  18, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 599/647 (92.5811%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.5813, Accuracy: 8129/10000 (81.2900%)
___Train Local_Simple,  epoch  18, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 924/998 (92.5852%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9689, Accuracy: 7711/10000 (77.1100%)
___Train Local_Simple,  epoch  18, local model 69, internal_epoch   1,  Average loss: 0.0219, Accuracy: 180/256 (70.3125%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.7854, Accuracy: 7443/10000 (74.4300%)
___Train Local_Simple,  epoch  18, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 308/338 (91.1243%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4789, Accuracy: 8617/10000 (86.1700%)
___Train Local_Simple,  epoch  18, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 815/889 (91.6760%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2597, Accuracy: 9252/10000 (92.5200%)
___Train Local_Simple,  epoch  18, local model 31, internal_epoch   1,  Average loss: 0.0030, Accuracy: 796/835 (95.3293%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2995, Accuracy: 9127/10000 (91.2700%)
time spent on training: 45.77362537384033
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.8847, Accuracy: 7976/10000 (79.7600%)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 57.203922748565674 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:19 choose agents : [51, 74, 10, 23, 7, 45, 64, 56, 81, 9]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   1,  Average loss: 0.0008, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.621893911772993.
Norm before scaling: 18.59416934269778. Distance: 1.1868768864155141
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.6785, Accuracy: 8468/10000 (84.6800%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 119.11968770946304, distance: 118.687693358189
Total norm for 2 adversaries is: 119.11968770946304. distance: 118.687693358189
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1112949.2032, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   1,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   2,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.621893911772993.
Norm before scaling: 18.596798430515786. Distance: 0.9561491034141837
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3722, Accuracy: 8980/10000 (89.8000%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 96.45811003843845, distance: 95.61491470509452
Total norm for 2 adversaries is: 96.45811003843845. distance: 95.61491470509452
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 2835887.8292, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  19, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 833/892 (93.3857%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.2651, Accuracy: 6802/10000 (68.0200%)
___Train Local_Simple,  epoch  19, local model 23, internal_epoch   1,  Average loss: 0.0066, Accuracy: 264/293 (90.1024%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.4944, Accuracy: 8450/10000 (84.5000%)
___Train Local_Simple,  epoch  19, local model 7, internal_epoch   1,  Average loss: 0.0112, Accuracy: 346/418 (82.7751%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.4256, Accuracy: 6031/10000 (60.3100%)
___Train Local_Simple,  epoch  19, local model 45, internal_epoch   1,  Average loss: 0.0041, Accuracy: 597/628 (95.0637%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.9917, Accuracy: 6878/10000 (68.7800%)
___Train Local_Simple,  epoch  19, local model 64, internal_epoch   1,  Average loss: 0.0073, Accuracy: 720/813 (88.5609%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.3341, Accuracy: 6813/10000 (68.1300%)
___Train Local_Simple,  epoch  19, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 811/880 (92.1591%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2925, Accuracy: 9111/10000 (91.1100%)
___Train Local_Simple,  epoch  19, local model 81, internal_epoch   1,  Average loss: 0.0048, Accuracy: 1108/1227 (90.3015%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.4258, Accuracy: 7238/10000 (72.3800%)
___Train Local_Simple,  epoch  19, local model 9, internal_epoch   1,  Average loss: 0.0058, Accuracy: 392/436 (89.9083%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.7095, Accuracy: 7524/10000 (75.2400%)
time spent on training: 46.04433727264404
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 1.0758, Accuracy: 7419/10000 (74.1900%)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 58.43731427192688 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:20 choose agents : [51, 74, 63, 57, 98, 12, 81, 94, 88, 28]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   1,  Average loss: 0.0013, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   2,  Average loss: 0.0006, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   4,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   6,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   7,  Average loss: 0.0002, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.599932500245046.
Norm before scaling: 18.5978314191761. Distance: 1.5768667058012165
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6272, Accuracy: 8276/10000 (82.7600%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 157.97016876217484, distance: 157.68666393951963
Total norm for 2 adversaries is: 157.97016876217484. distance: 157.68666393951963
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 1291161.2930, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   1,  Average loss: 0.0018, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   2,  Average loss: 0.0006, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.599932500245046.
Norm before scaling: 18.622765733490102. Distance: 1.5307461435112726
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.4564, Accuracy: 8827/10000 (88.2700%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 153.71555762592803, distance: 153.0746154351694
Total norm for 2 adversaries is: 153.71555762592803. distance: 153.0746154351694
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 13173233.9224, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  20, local model 63, internal_epoch   1,  Average loss: 0.0054, Accuracy: 802/889 (90.2137%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2888, Accuracy: 9192/10000 (91.9200%)
___Train Local_Simple,  epoch  20, local model 57, internal_epoch   1,  Average loss: 0.0052, Accuracy: 308/343 (89.7959%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.6281, Accuracy: 7047/10000 (70.4700%)
___Train Local_Simple,  epoch  20, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 761/818 (93.0318%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.6571, Accuracy: 7574/10000 (75.7400%)
___Train Local_Simple,  epoch  20, local model 12, internal_epoch   1,  Average loss: 0.0039, Accuracy: 1077/1160 (92.8448%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.7688, Accuracy: 8144/10000 (81.4400%)
___Train Local_Simple,  epoch  20, local model 81, internal_epoch   1,  Average loss: 0.0031, Accuracy: 1156/1227 (94.2135%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.7024, Accuracy: 8093/10000 (80.9300%)
___Train Local_Simple,  epoch  20, local model 94, internal_epoch   1,  Average loss: 0.0209, Accuracy: 99/150 (66.0000%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 3.9874, Accuracy: 5836/10000 (58.3600%)
___Train Local_Simple,  epoch  20, local model 88, internal_epoch   1,  Average loss: 0.0062, Accuracy: 483/530 (91.1321%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6260, Accuracy: 7908/10000 (79.0800%)
___Train Local_Simple,  epoch  20, local model 28, internal_epoch   1,  Average loss: 0.0092, Accuracy: 426/501 (85.0299%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.4213, Accuracy: 8591/10000 (85.9100%)
time spent on training: 45.74439477920532
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 1.2052, Accuracy: 7207/10000 (72.0700%)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 0.0049, Accuracy: 8953/8968 (99.8327%)
Done in 56.24030590057373 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:21 choose agents : [51, 74, 64, 33, 72, 13, 32, 78, 99, 23]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   1,  Average loss: 0.0017, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   7,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.704361775106428.
Norm before scaling: 18.71988466928282. Distance: 1.708030565305499
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.5949, Accuracy: 8495/10000 (84.9500%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 171.1428839267061, distance: 170.80304927203437
Total norm for 2 adversaries is: 171.1428839267061. distance: 170.80304927203437
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 4847550.5642, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   1,  Average loss: 0.0022, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   2,  Average loss: 0.0007, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   3,  Average loss: 0.0004, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.704361775106428.
Norm before scaling: 18.71166328185278. Distance: 1.730474467730925
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.4326, Accuracy: 8767/10000 (87.6700%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 173.27184093029948, distance: 173.04743862775027
Total norm for 2 adversaries is: 173.27184093029948. distance: 173.04743862775027
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 11455627.6521, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  21, local model 64, internal_epoch   1,  Average loss: 0.0066, Accuracy: 720/813 (88.5609%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.8175, Accuracy: 7596/10000 (75.9600%)
___Train Local_Simple,  epoch  21, local model 33, internal_epoch   1,  Average loss: 0.0101, Accuracy: 521/623 (83.6276%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.8488, Accuracy: 7699/10000 (76.9900%)
___Train Local_Simple,  epoch  21, local model 72, internal_epoch   1,  Average loss: 0.0065, Accuracy: 658/731 (90.0137%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.5596, Accuracy: 6813/10000 (68.1300%)
___Train Local_Simple,  epoch  21, local model 13, internal_epoch   1,  Average loss: 0.0077, Accuracy: 637/734 (86.7847%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.1799, Accuracy: 6710/10000 (67.1000%)
___Train Local_Simple,  epoch  21, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 880/977 (90.0716%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.4702, Accuracy: 8509/10000 (85.0900%)
___Train Local_Simple,  epoch  21, local model 78, internal_epoch   1,  Average loss: 0.0089, Accuracy: 257/303 (84.8185%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.8330, Accuracy: 7142/10000 (71.4200%)
___Train Local_Simple,  epoch  21, local model 99, internal_epoch   1,  Average loss: 0.0045, Accuracy: 346/377 (91.7772%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.5551, Accuracy: 6574/10000 (65.7400%)
___Train Local_Simple,  epoch  21, local model 23, internal_epoch   1,  Average loss: 0.0109, Accuracy: 249/293 (84.9829%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6812, Accuracy: 7667/10000 (76.6700%)
time spent on training: 49.071494579315186
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.9377, Accuracy: 7633/10000 (76.3300%)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 58.938210248947144 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:22 choose agents : [51, 74, 25, 12, 57, 19, 11, 13, 80, 49]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   1,  Average loss: 0.0014, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   3,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 18.819350101223524.
Norm before scaling: 18.787681049786737. Distance: 1.3061129612199458
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6601, Accuracy: 8375/10000 (83.7500%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 130.85787405855638, distance: 130.6112881559247
Total norm for 2 adversaries is: 130.85787405855638. distance: 130.6112881559247
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 3391902.6095, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   1,  Average loss: 0.0018, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.819350101223524.
Norm before scaling: 18.82208798443334. Distance: 1.3933826064944832
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.4821, Accuracy: 8795/10000 (87.9500%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 139.9480930559613, distance: 139.3382588904605
Total norm for 2 adversaries is: 139.9480930559613. distance: 139.3382588904605
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 25447030.2284, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  22, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 594/647 (91.8083%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.5438, Accuracy: 8206/10000 (82.0600%)
___Train Local_Simple,  epoch  22, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 1061/1160 (91.4655%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.5516, Accuracy: 8531/10000 (85.3100%)
___Train Local_Simple,  epoch  22, local model 57, internal_epoch   1,  Average loss: 0.0074, Accuracy: 309/343 (90.0875%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6456, Accuracy: 8139/10000 (81.3900%)
___Train Local_Simple,  epoch  22, local model 19, internal_epoch   1,  Average loss: 0.0072, Accuracy: 186/205 (90.7317%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.5181, Accuracy: 8338/10000 (83.3800%)
___Train Local_Simple,  epoch  22, local model 11, internal_epoch   1,  Average loss: 0.0051, Accuracy: 588/645 (91.1628%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3363, Accuracy: 8996/10000 (89.9600%)
___Train Local_Simple,  epoch  22, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 690/734 (94.0054%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.8732, Accuracy: 7394/10000 (73.9400%)
___Train Local_Simple,  epoch  22, local model 80, internal_epoch   1,  Average loss: 0.0059, Accuracy: 383/431 (88.8631%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.0359, Accuracy: 7264/10000 (72.6400%)
___Train Local_Simple,  epoch  22, local model 49, internal_epoch   1,  Average loss: 0.0034, Accuracy: 466/506 (92.0949%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.5946, Accuracy: 8471/10000 (84.7100%)
time spent on training: 47.558154821395874
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 1.0731, Accuracy: 7934/10000 (79.3400%)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 59.38603234291077 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:23 choose agents : [51, 74, 34, 14, 54, 57, 52, 36, 6, 46]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   1,  Average loss: 0.0009, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   2,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.840091989215694.
Norm before scaling: 18.797820691349852. Distance: 1.4100981301458881
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.9112, Accuracy: 7916/10000 (79.1600%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 140.9991896585757, distance: 141.00980683980814
Total norm for 2 adversaries is: 140.9991896585757. distance: 141.00980683980814
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 1049387.1241, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   1,  Average loss: 0.0012, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   2,  Average loss: 0.0006, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.840091989215694.
Norm before scaling: 18.81113730529736. Distance: 1.5087167666993533
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3839, Accuracy: 9027/10000 (90.2700%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 150.9323498086146, distance: 150.87169243474736
Total norm for 2 adversaries is: 150.9323498086146. distance: 150.87169243474736
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 3205436.1965, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  23, local model 34, internal_epoch   1,  Average loss: 0.0072, Accuracy: 373/413 (90.3148%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.1936, Accuracy: 7260/10000 (72.6000%)
___Train Local_Simple,  epoch  23, local model 14, internal_epoch   1,  Average loss: 0.0097, Accuracy: 337/376 (89.6277%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.6008, Accuracy: 8111/10000 (81.1100%)
___Train Local_Simple,  epoch  23, local model 54, internal_epoch   1,  Average loss: 0.0063, Accuracy: 469/519 (90.3661%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.8002, Accuracy: 7725/10000 (77.2500%)
___Train Local_Simple,  epoch  23, local model 57, internal_epoch   1,  Average loss: 0.0069, Accuracy: 308/343 (89.7959%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.0308, Accuracy: 7659/10000 (76.5900%)
___Train Local_Simple,  epoch  23, local model 52, internal_epoch   1,  Average loss: 0.0063, Accuracy: 231/253 (91.3043%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.8795, Accuracy: 7752/10000 (77.5200%)
___Train Local_Simple,  epoch  23, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 908/1005 (90.3483%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.6374, Accuracy: 7927/10000 (79.2700%)
___Train Local_Simple,  epoch  23, local model 6, internal_epoch   1,  Average loss: 0.0071, Accuracy: 545/615 (88.6179%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4873, Accuracy: 8344/10000 (83.4400%)
___Train Local_Simple,  epoch  23, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 638/710 (89.8592%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.5155, Accuracy: 6202/10000 (62.0200%)
time spent on training: 48.95625901222229
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.8650, Accuracy: 7867/10000 (78.6700%)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 58.88823580741882 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:24 choose agents : [51, 74, 90, 37, 42, 17, 2, 65, 6, 38]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   1,  Average loss: 0.0008, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 18.83189391090244.
Norm before scaling: 18.774924026924765. Distance: 0.7492214373877483
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.5094, Accuracy: 8717/10000 (87.1700%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 75.48237131215639, distance: 74.92214057565026
Total norm for 2 adversaries is: 75.48237131215639. distance: 74.92214057565026
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 1080238.4859, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   1,  Average loss: 0.0018, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.83189391090244.
Norm before scaling: 18.850658358705687. Distance: 1.5794134639981987
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.4363, Accuracy: 8842/10000 (88.4200%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 158.4971965938988, distance: 157.9413397336967
Total norm for 2 adversaries is: 158.4971965938988. distance: 157.9413397336967
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 25755233.7841, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  24, local model 90, internal_epoch   1,  Average loss: 0.0082, Accuracy: 591/683 (86.5300%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.3541, Accuracy: 5960/10000 (59.6000%)
___Train Local_Simple,  epoch  24, local model 37, internal_epoch   1,  Average loss: 0.0031, Accuracy: 815/860 (94.7674%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3596, Accuracy: 8887/10000 (88.8700%)
___Train Local_Simple,  epoch  24, local model 42, internal_epoch   1,  Average loss: 0.0086, Accuracy: 203/236 (86.0169%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.1456, Accuracy: 7183/10000 (71.8300%)
___Train Local_Simple,  epoch  24, local model 17, internal_epoch   1,  Average loss: 0.0060, Accuracy: 550/620 (88.7097%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.5040, Accuracy: 8614/10000 (86.1400%)
___Train Local_Simple,  epoch  24, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 512/548 (93.4307%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3291, Accuracy: 9041/10000 (90.4100%)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0070, Accuracy: 330/371 (88.9488%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.4897, Accuracy: 8528/10000 (85.2800%)
___Train Local_Simple,  epoch  24, local model 6, internal_epoch   1,  Average loss: 0.0065, Accuracy: 548/615 (89.1057%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.5317, Accuracy: 8321/10000 (83.2100%)
___Train Local_Simple,  epoch  24, local model 38, internal_epoch   1,  Average loss: 0.0043, Accuracy: 821/895 (91.7318%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.0089, Accuracy: 7093/10000 (70.9300%)
time spent on training: 47.757352113723755
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.6531, Accuracy: 8501/10000 (85.0100%)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 58.51239228248596 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:25 choose agents : [51, 74, 37, 44, 79, 4, 24, 38, 53, 10]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   1,  Average loss: 0.0010, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.831469328242736.
Norm before scaling: 18.791881123042955. Distance: 1.1053785954569744
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.6542, Accuracy: 8368/10000 (83.6800%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 110.9148876602573, distance: 110.53785851038775
Total norm for 2 adversaries is: 110.9148876602573. distance: 110.53785851038775
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.831469328242736.
Norm before scaling: 18.80508185346783. Distance: 0.806610845796597
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4124, Accuracy: 8946/10000 (89.4600%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 81.8318886975762, distance: 80.66108991193492
Total norm for 2 adversaries is: 81.8318886975762. distance: 80.66108991193492
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  25, local model 37, internal_epoch   1,  Average loss: 0.0043, Accuracy: 817/860 (95.0000%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.5228, Accuracy: 8355/10000 (83.5500%)
___Train Local_Simple,  epoch  25, local model 44, internal_epoch   1,  Average loss: 0.0061, Accuracy: 476/517 (92.0696%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2430, Accuracy: 9272/10000 (92.7200%)
___Train Local_Simple,  epoch  25, local model 79, internal_epoch   1,  Average loss: 0.0082, Accuracy: 159/182 (87.3626%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2165, Accuracy: 9347/10000 (93.4700%)
___Train Local_Simple,  epoch  25, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 620/658 (94.2249%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.8553, Accuracy: 7678/10000 (76.7800%)
___Train Local_Simple,  epoch  25, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 354/379 (93.4037%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4015, Accuracy: 8779/10000 (87.7900%)
___Train Local_Simple,  epoch  25, local model 38, internal_epoch   1,  Average loss: 0.0055, Accuracy: 817/895 (91.2849%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4675, Accuracy: 8719/10000 (87.1900%)
___Train Local_Simple,  epoch  25, local model 53, internal_epoch   1,  Average loss: 0.0025, Accuracy: 703/739 (95.1286%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.5764, Accuracy: 8509/10000 (85.0900%)
___Train Local_Simple,  epoch  25, local model 10, internal_epoch   1,  Average loss: 0.0032, Accuracy: 846/892 (94.8430%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.6990, Accuracy: 7660/10000 (76.6000%)
time spent on training: 49.73330760002136
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 1.0987, Accuracy: 7646/10000 (76.4600%)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 60.19622325897217 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:26 choose agents : [51, 74, 11, 78, 99, 7, 71, 14, 97, 12]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.786236956203055.
Norm before scaling: 18.731177075371058. Distance: 0.6556759321577547
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.6076, Accuracy: 8552/10000 (85.5200%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 66.35109842134304, distance: 65.56759393938441
Total norm for 2 adversaries is: 66.35109842134304. distance: 65.56759393938441
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 138823.6183, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   1,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   2,  Average loss: 0.0006, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.786236956203055.
Norm before scaling: 18.78620934028345. Distance: 1.6576829865081395
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3050, Accuracy: 9140/10000 (91.4000%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 166.0034708786235, distance: 165.76829885792398
Total norm for 2 adversaries is: 166.0034708786235. distance: 165.76829885792398
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 4765086.5749, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  26, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 585/645 (90.6977%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.9155, Accuracy: 8036/10000 (80.3600%)
___Train Local_Simple,  epoch  26, local model 78, internal_epoch   1,  Average loss: 0.0065, Accuracy: 274/303 (90.4290%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.7610, Accuracy: 8426/10000 (84.2600%)
___Train Local_Simple,  epoch  26, local model 99, internal_epoch   1,  Average loss: 0.0057, Accuracy: 353/377 (93.6340%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.9516, Accuracy: 7240/10000 (72.4000%)
___Train Local_Simple,  epoch  26, local model 7, internal_epoch   1,  Average loss: 0.0129, Accuracy: 343/418 (82.0574%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.7944, Accuracy: 7470/10000 (74.7000%)
___Train Local_Simple,  epoch  26, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 1305/1384 (94.2919%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.5831, Accuracy: 7848/10000 (78.4800%)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0064, Accuracy: 341/376 (90.6915%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3068, Accuracy: 9118/10000 (91.1800%)
___Train Local_Simple,  epoch  26, local model 97, internal_epoch   1,  Average loss: 0.0049, Accuracy: 442/487 (90.7598%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.4549, Accuracy: 8594/10000 (85.9400%)
___Train Local_Simple,  epoch  26, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 1077/1160 (92.8448%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.5686, Accuracy: 8246/10000 (82.4600%)
time spent on training: 48.857078313827515
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 0.3841, Accuracy: 8950/10000 (89.5000%)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 60.062620401382446 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:27 choose agents : [51, 74, 91, 25, 34, 56, 68, 57, 2, 4]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   1,  Average loss: 0.0007, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.75979968519162.
Norm before scaling: 18.72785557566297. Distance: 0.9626510972162338
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.4843, Accuracy: 8703/10000 (87.0300%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 96.98701185596967, distance: 96.265111435491
Total norm for 2 adversaries is: 96.98701185596967. distance: 96.265111435491
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   1,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.75979968519162.
Norm before scaling: 18.723484669628892. Distance: 0.528356667217946
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3197, Accuracy: 9161/10000 (91.6100%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 54.584787472678684, distance: 52.835668919360245
Total norm for 2 adversaries is: 54.584787472678684. distance: 52.835668919360245
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  27, local model 91, internal_epoch   1,  Average loss: 0.0013, Accuracy: 250/256 (97.6562%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3550, Accuracy: 9040/10000 (90.4000%)
___Train Local_Simple,  epoch  27, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 605/647 (93.5085%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.9462, Accuracy: 7206/10000 (72.0600%)
___Train Local_Simple,  epoch  27, local model 34, internal_epoch   1,  Average loss: 0.0023, Accuracy: 398/413 (96.3680%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.4280, Accuracy: 8880/10000 (88.8000%)
___Train Local_Simple,  epoch  27, local model 56, internal_epoch   1,  Average loss: 0.0034, Accuracy: 814/880 (92.5000%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2100, Accuracy: 9374/10000 (93.7400%)
___Train Local_Simple,  epoch  27, local model 68, internal_epoch   1,  Average loss: 0.0028, Accuracy: 472/494 (95.5466%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3649, Accuracy: 8860/10000 (88.6000%)
___Train Local_Simple,  epoch  27, local model 57, internal_epoch   1,  Average loss: 0.0049, Accuracy: 318/343 (92.7114%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3912, Accuracy: 8926/10000 (89.2600%)
___Train Local_Simple,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 515/548 (93.9781%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.4409, Accuracy: 8640/10000 (86.4000%)
___Train Local_Simple,  epoch  27, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 612/658 (93.0091%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.5131, Accuracy: 8410/10000 (84.1000%)
time spent on training: 50.16062951087952
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 0.6073, Accuracy: 8355/10000 (83.5500%)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 61.041903018951416 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:28 choose agents : [51, 74, 1, 20, 48, 56, 27, 42, 0, 44]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.698741784835082.
Norm before scaling: 18.636148482812576. Distance: 0.43365689410690783
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.4730, Accuracy: 8766/10000 (87.6600%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 44.47170086396938, distance: 43.36569069993942
Total norm for 2 adversaries is: 44.47170086396938. distance: 43.36569069993942
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 114859.0328, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   1,  Average loss: 0.0006, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   2,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.698741784835082.
Norm before scaling: 18.661946562770957. Distance: 0.9830093902205356
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.4175, Accuracy: 8951/10000 (89.5100%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 98.88687606458453, distance: 98.3009370186775
Total norm for 2 adversaries is: 98.88687606458453. distance: 98.3009370186775
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 658662.8825, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  28, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 679/760 (89.3421%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2940, Accuracy: 8994/10000 (89.9400%)
___Train Local_Simple,  epoch  28, local model 20, internal_epoch   1,  Average loss: 0.0027, Accuracy: 409/429 (95.3380%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.4571, Accuracy: 8730/10000 (87.3000%)
___Train Local_Simple,  epoch  28, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 421/448 (93.9732%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2222, Accuracy: 9290/10000 (92.9000%)
___Train Local_Simple,  epoch  28, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 803/880 (91.2500%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2568, Accuracy: 9206/10000 (92.0600%)
___Train Local_Simple,  epoch  28, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 425/471 (90.2335%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.7062, Accuracy: 8204/10000 (82.0400%)
___Train Local_Simple,  epoch  28, local model 42, internal_epoch   1,  Average loss: 0.0062, Accuracy: 206/236 (87.2881%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.4966, Accuracy: 8484/10000 (84.8400%)
___Train Local_Simple,  epoch  28, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 401/435 (92.1839%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3464, Accuracy: 8913/10000 (89.1300%)
___Train Local_Simple,  epoch  28, local model 44, internal_epoch   1,  Average loss: 0.0058, Accuracy: 476/517 (92.0696%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3049, Accuracy: 9011/10000 (90.1100%)
time spent on training: 49.12290811538696
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 0.4355, Accuracy: 8967/10000 (89.6700%)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 59.700730085372925 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:29 choose agents : [51, 74, 25, 8, 12, 54, 26, 61, 64, 53]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   1,  Average loss: 0.0007, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.603085727480384.
Norm before scaling: 18.54803992761095. Distance: 1.0049934882337357
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.4896, Accuracy: 8675/10000 (86.7500%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 100.70099517724489, distance: 100.49935381477584
Total norm for 2 adversaries is: 100.70099517724489. distance: 100.49935381477584
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   1,  Average loss: 0.0001, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.603085727480384.
Norm before scaling: 18.548390378804605. Distance: 0.6435476716604134
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3599, Accuracy: 9055/10000 (90.5500%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 65.1382656534832, distance: 64.35476775509721
Total norm for 2 adversaries is: 65.1382656534832. distance: 64.35476775509721
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  29, local model 25, internal_epoch   1,  Average loss: 0.0033, Accuracy: 610/647 (94.2813%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.7801, Accuracy: 7762/10000 (77.6200%)
___Train Local_Simple,  epoch  29, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 576/633 (90.9953%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3891, Accuracy: 8837/10000 (88.3700%)
___Train Local_Simple,  epoch  29, local model 12, internal_epoch   1,  Average loss: 0.0031, Accuracy: 1100/1160 (94.8276%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3897, Accuracy: 8778/10000 (87.7800%)
___Train Local_Simple,  epoch  29, local model 54, internal_epoch   1,  Average loss: 0.0040, Accuracy: 484/519 (93.2563%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2498, Accuracy: 9250/10000 (92.5000%)
___Train Local_Simple,  epoch  29, local model 26, internal_epoch   1,  Average loss: 0.0040, Accuracy: 516/554 (93.1408%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.4580, Accuracy: 8715/10000 (87.1500%)
___Train Local_Simple,  epoch  29, local model 61, internal_epoch   1,  Average loss: 0.0034, Accuracy: 658/699 (94.1345%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3749, Accuracy: 8990/10000 (89.9000%)
___Train Local_Simple,  epoch  29, local model 64, internal_epoch   1,  Average loss: 0.0058, Accuracy: 730/813 (89.7909%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.3537, Accuracy: 7011/10000 (70.1100%)
___Train Local_Simple,  epoch  29, local model 53, internal_epoch   1,  Average loss: 0.0017, Accuracy: 717/739 (97.0230%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.4531, Accuracy: 8760/10000 (87.6000%)
time spent on training: 48.42948865890503
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.8304, Accuracy: 8053/10000 (80.5300%)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 59.11725687980652 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:30 choose agents : [51, 74, 92, 67, 33, 57, 99, 10, 13, 79]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.505805676868004.
Norm before scaling: 18.44691728512433. Distance: 0.7357834640602472
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.4418, Accuracy: 8836/10000 (88.3600%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 74.05734422982638, distance: 73.57834565426671
Total norm for 2 adversaries is: 74.05734422982638. distance: 73.57834565426671
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 406262.1591, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   1,  Average loss: 0.0011, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.505805676868004.
Norm before scaling: 18.46943159830462. Distance: 1.2868572445460205
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2695, Accuracy: 9281/10000 (92.8100%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 128.8502567784597, distance: 128.68571665835722
Total norm for 2 adversaries is: 128.8502567784597. distance: 128.68571665835722
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 1867408.0956, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  30, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 872/937 (93.0630%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.5196, Accuracy: 8375/10000 (83.7500%)
___Train Local_Simple,  epoch  30, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 918/998 (91.9840%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.5642, Accuracy: 8155/10000 (81.5500%)
___Train Local_Simple,  epoch  30, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 588/623 (94.3820%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.7605, Accuracy: 7993/10000 (79.9300%)
___Train Local_Simple,  epoch  30, local model 57, internal_epoch   1,  Average loss: 0.0044, Accuracy: 312/343 (90.9621%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3886, Accuracy: 8780/10000 (87.8000%)
___Train Local_Simple,  epoch  30, local model 99, internal_epoch   1,  Average loss: 0.0044, Accuracy: 348/377 (92.3077%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3097, Accuracy: 9084/10000 (90.8400%)
___Train Local_Simple,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0029, Accuracy: 847/892 (94.9552%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.7130, Accuracy: 7832/10000 (78.3200%)
___Train Local_Simple,  epoch  30, local model 13, internal_epoch   1,  Average loss: 0.0069, Accuracy: 645/734 (87.8747%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.1761, Accuracy: 6798/10000 (67.9800%)
___Train Local_Simple,  epoch  30, local model 79, internal_epoch   1,  Average loss: 0.0078, Accuracy: 157/182 (86.2637%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2371, Accuracy: 9265/10000 (92.6500%)
time spent on training: 50.51192259788513
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 0.3359, Accuracy: 9157/10000 (91.5700%)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 62.09160590171814 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:31 choose agents : [51, 74, 37, 13, 92, 60, 56, 59, 90, 23]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   1,  Average loss: 0.0010, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.444978290068377.
Norm before scaling: 18.402864879985824. Distance: 1.1894563320974827
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.4844, Accuracy: 8751/10000 (87.5100%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 119.12858238317537, distance: 118.9456324400459
Total norm for 2 adversaries is: 119.12858238317537. distance: 118.9456324400459
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 53.7083, Accuracy: 8883/8968 (99.0522%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.444978290068377.
Norm before scaling: 18.396237096391225. Distance: 0.48389603406637244
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3054, Accuracy: 9220/10000 (92.2000%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 49.787375054764134, distance: 48.38960333519484
Total norm for 2 adversaries is: 49.787375054764134. distance: 48.38960333519484
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  31, local model 37, internal_epoch   1,  Average loss: 0.0023, Accuracy: 828/860 (96.2791%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.9307, Accuracy: 8025/10000 (80.2500%)
___Train Local_Simple,  epoch  31, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 717/734 (97.6839%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.4813, Accuracy: 8656/10000 (86.5600%)
___Train Local_Simple,  epoch  31, local model 92, internal_epoch   1,  Average loss: 0.0033, Accuracy: 885/937 (94.4504%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.4762, Accuracy: 8483/10000 (84.8300%)
___Train Local_Simple,  epoch  31, local model 60, internal_epoch   1,  Average loss: 0.0049, Accuracy: 318/338 (94.0828%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2476, Accuracy: 9260/10000 (92.6000%)
___Train Local_Simple,  epoch  31, local model 56, internal_epoch   1,  Average loss: 0.0026, Accuracy: 838/880 (95.2273%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1791, Accuracy: 9475/10000 (94.7500%)
___Train Local_Simple,  epoch  31, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 723/760 (95.1316%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.8321, Accuracy: 7685/10000 (76.8500%)
___Train Local_Simple,  epoch  31, local model 90, internal_epoch   1,  Average loss: 0.0060, Accuracy: 612/683 (89.6047%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.0504, Accuracy: 6615/10000 (66.1500%)
___Train Local_Simple,  epoch  31, local model 23, internal_epoch   1,  Average loss: 0.0027, Accuracy: 277/293 (94.5392%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2465, Accuracy: 9312/10000 (93.1200%)
time spent on training: 48.97857904434204
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.5780, Accuracy: 8482/10000 (84.8200%)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 61.575562477111816 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:32 choose agents : [51, 74, 39, 77, 84, 62, 97, 95, 37, 43]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   1,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.365412903424776.
Norm before scaling: 18.3073123184746. Distance: 0.21413271893920213
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4501, Accuracy: 8791/10000 (87.9100%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 24.044982716726086, distance: 21.41327083200064
Total norm for 2 adversaries is: 24.044982716726086. distance: 21.41327083200064
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 7312.0639, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   1,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.365412903424776.
Norm before scaling: 18.36269168844595. Distance: 1.2584692146922
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2286, Accuracy: 9337/10000 (93.3700%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 126.5162801406404, distance: 125.84691996876602
Total norm for 2 adversaries is: 126.5162801406404. distance: 125.84691996876602
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 3619963.5865, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  32, local model 39, internal_epoch   1,  Average loss: 0.0038, Accuracy: 241/257 (93.7743%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3837, Accuracy: 8885/10000 (88.8500%)
___Train Local_Simple,  epoch  32, local model 77, internal_epoch   1,  Average loss: 0.0071, Accuracy: 526/589 (89.3039%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2926, Accuracy: 9088/10000 (90.8800%)
___Train Local_Simple,  epoch  32, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 1164/1246 (93.4189%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2280, Accuracy: 9283/10000 (92.8300%)
___Train Local_Simple,  epoch  32, local model 62, internal_epoch   1,  Average loss: 0.0027, Accuracy: 402/423 (95.0355%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2646, Accuracy: 9281/10000 (92.8100%)
___Train Local_Simple,  epoch  32, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 446/487 (91.5811%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4693, Accuracy: 8487/10000 (84.8700%)
___Train Local_Simple,  epoch  32, local model 95, internal_epoch   1,  Average loss: 0.0023, Accuracy: 580/602 (96.3455%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.9172, Accuracy: 7253/10000 (72.5300%)
___Train Local_Simple,  epoch  32, local model 37, internal_epoch   1,  Average loss: 0.0018, Accuracy: 833/860 (96.8605%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4337, Accuracy: 8720/10000 (87.2000%)
___Train Local_Simple,  epoch  32, local model 43, internal_epoch   1,  Average loss: 0.0054, Accuracy: 367/408 (89.9510%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5663, Accuracy: 8402/10000 (84.0200%)
time spent on training: 45.76758408546448
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.2552, Accuracy: 9260/10000 (92.6000%)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 55.34401321411133 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:33 choose agents : [51, 74, 50, 86, 25, 28, 8, 16, 6, 3]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   1,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.312939114562464.
Norm before scaling: 18.276648726500024. Distance: 0.9763064849963222
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.4345, Accuracy: 8839/10000 (88.3900%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 98.17844881897453, distance: 97.630651644988
Total norm for 2 adversaries is: 98.17844881897453. distance: 97.630651644988
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 940252.8587, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   1,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.312939114562464.
Norm before scaling: 18.258761040561545. Distance: 0.3603487919233134
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2536, Accuracy: 9274/10000 (92.7400%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 37.71944256820679, distance: 36.03487656564904
Total norm for 2 adversaries is: 37.71944256820679. distance: 36.03487656564904
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 21410.0991, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  33, local model 50, internal_epoch   1,  Average loss: 0.0051, Accuracy: 437/474 (92.1941%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.4811, Accuracy: 8469/10000 (84.6900%)
___Train Local_Simple,  epoch  33, local model 86, internal_epoch   1,  Average loss: 0.0037, Accuracy: 235/250 (94.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2571, Accuracy: 9219/10000 (92.1900%)
___Train Local_Simple,  epoch  33, local model 25, internal_epoch   1,  Average loss: 0.0031, Accuracy: 608/647 (93.9722%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5968, Accuracy: 8028/10000 (80.2800%)
___Train Local_Simple,  epoch  33, local model 28, internal_epoch   1,  Average loss: 0.0031, Accuracy: 480/501 (95.8084%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1768, Accuracy: 9455/10000 (94.5500%)
___Train Local_Simple,  epoch  33, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 586/633 (92.5750%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3465, Accuracy: 9012/10000 (90.1200%)
___Train Local_Simple,  epoch  33, local model 16, internal_epoch   1,  Average loss: 0.0024, Accuracy: 875/915 (95.6284%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1492, Accuracy: 9564/10000 (95.6400%)
___Train Local_Simple,  epoch  33, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 578/615 (93.9837%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3892, Accuracy: 8870/10000 (88.7000%)
___Train Local_Simple,  epoch  33, local model 3, internal_epoch   1,  Average loss: 0.0024, Accuracy: 880/923 (95.3413%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3254, Accuracy: 9104/10000 (91.0400%)
time spent on training: 50.636247396469116
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.7035, Accuracy: 8335/10000 (83.3500%)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 62.125680685043335 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:34 choose agents : [51, 74, 23, 43, 27, 84, 37, 35, 29, 47]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   1,  Average loss: 0.0001, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.231953098050994.
Norm before scaling: 18.17084466796372. Distance: 0.46218468962479736
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3309, Accuracy: 9095/10000 (90.9500%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 47.16712877745873, distance: 46.21846739687097
Total norm for 2 adversaries is: 47.16712877745873. distance: 46.21846739687097
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 29793.2597, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   1,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.231953098050994.
Norm before scaling: 18.185086958695372. Distance: 0.9861370241464702
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2997, Accuracy: 9185/10000 (91.8500%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 98.94011071255429, distance: 98.61370142822446
Total norm for 2 adversaries is: 98.94011071255429. distance: 98.61370142822446
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 1512966.8712, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  34, local model 23, internal_epoch   1,  Average loss: 0.0022, Accuracy: 278/293 (94.8805%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3169, Accuracy: 9102/10000 (91.0200%)
___Train Local_Simple,  epoch  34, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 373/408 (91.4216%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3444, Accuracy: 8940/10000 (89.4000%)
___Train Local_Simple,  epoch  34, local model 27, internal_epoch   1,  Average loss: 0.0071, Accuracy: 420/471 (89.1720%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.4104, Accuracy: 8680/10000 (86.8000%)
___Train Local_Simple,  epoch  34, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 1163/1246 (93.3387%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1811, Accuracy: 9473/10000 (94.7300%)
___Train Local_Simple,  epoch  34, local model 37, internal_epoch   1,  Average loss: 0.0017, Accuracy: 834/860 (96.9767%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.6727, Accuracy: 8271/10000 (82.7100%)
___Train Local_Simple,  epoch  34, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 473/499 (94.7896%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.7141, Accuracy: 8298/10000 (82.9800%)
___Train Local_Simple,  epoch  34, local model 29, internal_epoch   1,  Average loss: 0.0025, Accuracy: 957/1002 (95.5090%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.5824, Accuracy: 8121/10000 (81.2100%)
___Train Local_Simple,  epoch  34, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 702/776 (90.4639%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.5566, Accuracy: 8226/10000 (82.2600%)
time spent on training: 54.47667217254639
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.2810, Accuracy: 9227/10000 (92.2700%)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 65.78061437606812 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:35 choose agents : [51, 74, 11, 42, 33, 12, 95, 15, 41, 99]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   1,  Average loss: 0.0010, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.141678916682867.
Norm before scaling: 18.109838418897994. Distance: 1.2578337294404094
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.4252, Accuracy: 8868/10000 (88.6800%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 126.0037085577742, distance: 125.78337342928118
Total norm for 2 adversaries is: 126.0037085577742. distance: 125.78337342928118
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 1221378.5930, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   1,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.141678916682867.
Norm before scaling: 18.088483554590404. Distance: 0.3204474165021714
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2400, Accuracy: 9342/10000 (93.4200%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 33.95569012112053, distance: 32.04474182320128
Total norm for 2 adversaries is: 33.95569012112053. distance: 32.04474182320128
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 13724.4303, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  35, local model 11, internal_epoch   1,  Average loss: 0.0039, Accuracy: 610/645 (94.5736%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.4847, Accuracy: 8359/10000 (83.5900%)
___Train Local_Simple,  epoch  35, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 218/236 (92.3729%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3917, Accuracy: 8756/10000 (87.5600%)
___Train Local_Simple,  epoch  35, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 594/623 (95.3451%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3019, Accuracy: 8961/10000 (89.6100%)
___Train Local_Simple,  epoch  35, local model 12, internal_epoch   1,  Average loss: 0.0024, Accuracy: 1114/1160 (96.0345%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3880, Accuracy: 9000/10000 (90.0000%)
___Train Local_Simple,  epoch  35, local model 95, internal_epoch   1,  Average loss: 0.0015, Accuracy: 589/602 (97.8405%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3107, Accuracy: 9174/10000 (91.7400%)
___Train Local_Simple,  epoch  35, local model 15, internal_epoch   1,  Average loss: 0.0029, Accuracy: 385/401 (96.0100%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.5084, Accuracy: 8487/10000 (84.8700%)
___Train Local_Simple,  epoch  35, local model 41, internal_epoch   1,  Average loss: 0.0025, Accuracy: 581/606 (95.8746%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.4308, Accuracy: 8769/10000 (87.6900%)
___Train Local_Simple,  epoch  35, local model 99, internal_epoch   1,  Average loss: 0.0019, Accuracy: 366/377 (97.0822%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3790, Accuracy: 8824/10000 (88.2400%)
time spent on training: 50.62343621253967
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.6044, Accuracy: 8523/10000 (85.2300%)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 60.025758028030396 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:36 choose agents : [51, 74, 20, 88, 55, 53, 24, 38, 42, 32]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   1,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.06938446736072.
Norm before scaling: 18.011756448534612. Distance: 0.24628143117215748
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.4838, Accuracy: 8801/10000 (88.0100%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 26.815149563143407, distance: 24.62814264527981
Total norm for 2 adversaries is: 26.815149563143407. distance: 24.62814264527981
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 4.5280, Accuracy: 8834/8968 (98.5058%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   1,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   2,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.06938446736072.
Norm before scaling: 18.058993834119917. Distance: 1.379957797745848
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2695, Accuracy: 9258/10000 (92.5800%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 138.35232283693324, distance: 137.99578231779404
Total norm for 2 adversaries is: 138.35232283693324. distance: 137.99578231779404
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 1590106.3147, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  36, local model 20, internal_epoch   1,  Average loss: 0.0056, Accuracy: 391/429 (91.1422%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.4964, Accuracy: 8377/10000 (83.7700%)
___Train Local_Simple,  epoch  36, local model 88, internal_epoch   1,  Average loss: 0.0024, Accuracy: 510/530 (96.2264%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3257, Accuracy: 9023/10000 (90.2300%)
___Train Local_Simple,  epoch  36, local model 55, internal_epoch   1,  Average loss: 0.0020, Accuracy: 342/354 (96.6102%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.5636, Accuracy: 8494/10000 (84.9400%)
___Train Local_Simple,  epoch  36, local model 53, internal_epoch   1,  Average loss: 0.0014, Accuracy: 720/739 (97.4290%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3291, Accuracy: 9039/10000 (90.3900%)
___Train Local_Simple,  epoch  36, local model 24, internal_epoch   1,  Average loss: 0.0043, Accuracy: 354/379 (93.4037%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3697, Accuracy: 8769/10000 (87.6900%)
___Train Local_Simple,  epoch  36, local model 38, internal_epoch   1,  Average loss: 0.0029, Accuracy: 842/895 (94.0782%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3506, Accuracy: 8930/10000 (89.3000%)
___Train Local_Simple,  epoch  36, local model 42, internal_epoch   1,  Average loss: 0.0066, Accuracy: 209/236 (88.5593%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6277, Accuracy: 8035/10000 (80.3500%)
___Train Local_Simple,  epoch  36, local model 32, internal_epoch   1,  Average loss: 0.0033, Accuracy: 922/977 (94.3705%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3522, Accuracy: 8872/10000 (88.7200%)
time spent on training: 54.76233410835266
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.2819, Accuracy: 9235/10000 (92.3500%)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 64.56034755706787 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:37 choose agents : [51, 74, 61, 8, 35, 94, 27, 98, 57, 84]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   1,  Average loss: 0.0007, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 18.007754033256496.
Norm before scaling: 18.002112370627163. Distance: 1.1654746687340285
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4373, Accuracy: 8873/10000 (88.7300%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 117.26654001142013, distance: 116.54746049088757
Total norm for 2 adversaries is: 117.26654001142013. distance: 116.54746049088757
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 3644283.5674, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   1,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 18.007754033256496.
Norm before scaling: 17.957724198751844. Distance: 0.2437506039929854
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2666, Accuracy: 9269/10000 (92.6900%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 27.065632486865375, distance: 24.375060096079764
Total norm for 2 adversaries is: 27.065632486865375. distance: 24.375060096079764
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 25237.9003, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  37, local model 61, internal_epoch   1,  Average loss: 0.0034, Accuracy: 653/699 (93.4192%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2810, Accuracy: 9148/10000 (91.4800%)
___Train Local_Simple,  epoch  37, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 585/633 (92.4171%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2408, Accuracy: 9312/10000 (93.1200%)
___Train Local_Simple,  epoch  37, local model 35, internal_epoch   1,  Average loss: 0.0031, Accuracy: 467/499 (93.5872%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.3142, Accuracy: 9055/10000 (90.5500%)
___Train Local_Simple,  epoch  37, local model 94, internal_epoch   1,  Average loss: 0.0060, Accuracy: 136/150 (90.6667%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.4938, Accuracy: 6399/10000 (63.9900%)
___Train Local_Simple,  epoch  37, local model 27, internal_epoch   1,  Average loss: 0.0041, Accuracy: 437/471 (92.7813%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4818, Accuracy: 8452/10000 (84.5200%)
___Train Local_Simple,  epoch  37, local model 98, internal_epoch   1,  Average loss: 0.0025, Accuracy: 782/818 (95.5990%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4761, Accuracy: 8512/10000 (85.1200%)
___Train Local_Simple,  epoch  37, local model 57, internal_epoch   1,  Average loss: 0.0032, Accuracy: 321/343 (93.5860%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1900, Accuracy: 9463/10000 (94.6300%)
___Train Local_Simple,  epoch  37, local model 84, internal_epoch   1,  Average loss: 0.0025, Accuracy: 1200/1246 (96.3082%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1973, Accuracy: 9405/10000 (94.0500%)
time spent on training: 51.55836319923401
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.6190, Accuracy: 8632/10000 (86.3200%)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 61.45179581642151 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:38 choose agents : [51, 74, 87, 17, 78, 62, 57, 26, 88, 91]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.958259505660795.
Norm before scaling: 17.897338567038485. Distance: 0.2193401074713698
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.4375, Accuracy: 8937/10000 (89.3700%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 24.090557911114264, distance: 21.934010111252956
Total norm for 2 adversaries is: 24.090557911114264. distance: 21.934010111252956
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 3452.9474, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   1,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 17.958259505660795.
Norm before scaling: 17.95636801649348. Distance: 1.6762720914177216
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3621, Accuracy: 8940/10000 (89.4000%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 167.73073543443073, distance: 167.62721381834157
Total norm for 2 adversaries is: 167.73073543443073. distance: 167.62721381834157
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  38, local model 87, internal_epoch   1,  Average loss: 0.0021, Accuracy: 452/470 (96.1702%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2107, Accuracy: 9358/10000 (93.5800%)
___Train Local_Simple,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 560/620 (90.3226%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2691, Accuracy: 9213/10000 (92.1300%)
___Train Local_Simple,  epoch  38, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 280/303 (92.4092%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6398, Accuracy: 8346/10000 (83.4600%)
___Train Local_Simple,  epoch  38, local model 62, internal_epoch   1,  Average loss: 0.0048, Accuracy: 392/423 (92.6714%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2886, Accuracy: 9165/10000 (91.6500%)
___Train Local_Simple,  epoch  38, local model 57, internal_epoch   1,  Average loss: 0.0052, Accuracy: 315/343 (91.8367%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3915, Accuracy: 8799/10000 (87.9900%)
___Train Local_Simple,  epoch  38, local model 26, internal_epoch   1,  Average loss: 0.0033, Accuracy: 516/554 (93.1408%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1936, Accuracy: 9459/10000 (94.5900%)
___Train Local_Simple,  epoch  38, local model 88, internal_epoch   1,  Average loss: 0.0028, Accuracy: 504/530 (95.0943%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3392, Accuracy: 9017/10000 (90.1700%)
___Train Local_Simple,  epoch  38, local model 91, internal_epoch   1,  Average loss: 0.0021, Accuracy: 247/256 (96.4844%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2857, Accuracy: 9209/10000 (92.0900%)
time spent on training: 47.15640091896057
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.4084, Accuracy: 8823/10000 (88.2300%)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 58.41235828399658 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:39 choose agents : [51, 74, 77, 36, 66, 98, 85, 64, 30, 96]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   1,  Average loss: 0.0010, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.904935086155803.
Norm before scaling: 17.921309657604546. Distance: 1.4367454870659913
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6935, Accuracy: 8392/10000 (83.9200%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 144.27473520596044, distance: 143.67454541427998
Total norm for 2 adversaries is: 144.27473520596044. distance: 143.67454541427998
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 10377293.4719, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   1,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.904935086155803.
Norm before scaling: 17.86115032460028. Distance: 0.3323364986423101
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3545, Accuracy: 9000/10000 (90.0000%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 35.46004849210588, distance: 33.23364773534309
Total norm for 2 adversaries is: 35.46004849210588. distance: 33.23364773534309
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 81771.6045, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  39, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 541/589 (91.8506%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2148, Accuracy: 9308/10000 (93.0800%)
___Train Local_Simple,  epoch  39, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 971/1005 (96.6169%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3281, Accuracy: 8979/10000 (89.7900%)
___Train Local_Simple,  epoch  39, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 613/660 (92.8788%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.0060, Accuracy: 7382/10000 (73.8200%)
___Train Local_Simple,  epoch  39, local model 98, internal_epoch   1,  Average loss: 0.0031, Accuracy: 779/818 (95.2323%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.5570, Accuracy: 8178/10000 (81.7800%)
___Train Local_Simple,  epoch  39, local model 85, internal_epoch   1,  Average loss: 0.0027, Accuracy: 412/431 (95.5916%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2584, Accuracy: 9239/10000 (92.3900%)
___Train Local_Simple,  epoch  39, local model 64, internal_epoch   1,  Average loss: 0.0043, Accuracy: 746/813 (91.7589%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3685, Accuracy: 8840/10000 (88.4000%)
___Train Local_Simple,  epoch  39, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 372/400 (93.0000%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2622, Accuracy: 9245/10000 (92.4500%)
___Train Local_Simple,  epoch  39, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 621/672 (92.4107%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4702, Accuracy: 8535/10000 (85.3500%)
time spent on training: 44.60650157928467
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.9016, Accuracy: 8180/10000 (81.8000%)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 54.78216028213501 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:40 choose agents : [51, 74, 25, 53, 50, 45, 6, 35, 17, 20]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.893700267897184.
Norm before scaling: 17.837895650559076. Distance: 0.3392930007632573
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.4920, Accuracy: 8800/10000 (88.0000%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 35.503092886285096, distance: 33.92929984092381
Total norm for 2 adversaries is: 35.503092886285096. distance: 33.92929984092381
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 5209.3458, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   1,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.893700267897184.
Norm before scaling: 17.86443737033422. Distance: 1.3894237945266426
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2723, Accuracy: 9260/10000 (92.6000%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 139.02333718210767, distance: 138.942377894579
Total norm for 2 adversaries is: 139.02333718210767. distance: 138.942377894579
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 895074.2409, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  40, local model 25, internal_epoch   1,  Average loss: 0.0053, Accuracy: 605/647 (93.5085%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3939, Accuracy: 8717/10000 (87.1700%)
___Train Local_Simple,  epoch  40, local model 53, internal_epoch   1,  Average loss: 0.0014, Accuracy: 722/739 (97.6996%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3180, Accuracy: 9063/10000 (90.6300%)
___Train Local_Simple,  epoch  40, local model 50, internal_epoch   1,  Average loss: 0.0061, Accuracy: 430/474 (90.7173%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2070, Accuracy: 9365/10000 (93.6500%)
___Train Local_Simple,  epoch  40, local model 45, internal_epoch   1,  Average loss: 0.0050, Accuracy: 582/628 (92.6752%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.8076, Accuracy: 7584/10000 (75.8400%)
___Train Local_Simple,  epoch  40, local model 6, internal_epoch   1,  Average loss: 0.0061, Accuracy: 551/615 (89.5935%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2737, Accuracy: 9123/10000 (91.2300%)
___Train Local_Simple,  epoch  40, local model 35, internal_epoch   1,  Average loss: 0.0056, Accuracy: 463/499 (92.7856%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.7906, Accuracy: 7891/10000 (78.9100%)
___Train Local_Simple,  epoch  40, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 566/620 (91.2903%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2555, Accuracy: 9271/10000 (92.7100%)
___Train Local_Simple,  epoch  40, local model 20, internal_epoch   1,  Average loss: 0.0045, Accuracy: 395/429 (92.0746%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.5494, Accuracy: 8585/10000 (85.8500%)
time spent on training: 43.06051206588745
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.2939, Accuracy: 9185/10000 (91.8500%)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 53.37345242500305 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:41 choose agents : [51, 74, 75, 43, 8, 76, 3, 39, 14, 32]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0009, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.81838153309622.
Norm before scaling: 17.808739837495786. Distance: 1.3106420627369226
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4708, Accuracy: 8850/10000 (88.5000%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 131.48835499769552, distance: 131.06421374654485
Total norm for 2 adversaries is: 131.48835499769552. distance: 131.06421374654485
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 3032701.0495, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   1,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.81838153309622.
Norm before scaling: 17.767430303503197. Distance: 0.29045288670537417
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2636, Accuracy: 9295/10000 (92.9500%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 31.166877732267714, distance: 29.045288502262935
Total norm for 2 adversaries is: 31.166877732267714. distance: 29.045288502262935
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 22063.1795, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  41, local model 75, internal_epoch   1,  Average loss: 0.0034, Accuracy: 642/686 (93.5860%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4177, Accuracy: 8724/10000 (87.2400%)
___Train Local_Simple,  epoch  41, local model 43, internal_epoch   1,  Average loss: 0.0025, Accuracy: 386/408 (94.6078%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2178, Accuracy: 9397/10000 (93.9700%)
___Train Local_Simple,  epoch  41, local model 8, internal_epoch   1,  Average loss: 0.0034, Accuracy: 596/633 (94.1548%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1705, Accuracy: 9493/10000 (94.9300%)
___Train Local_Simple,  epoch  41, local model 76, internal_epoch   1,  Average loss: 0.0026, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2694, Accuracy: 9267/10000 (92.6700%)
___Train Local_Simple,  epoch  41, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 875/923 (94.7996%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4035, Accuracy: 8661/10000 (86.6100%)
___Train Local_Simple,  epoch  41, local model 39, internal_epoch   1,  Average loss: 0.0023, Accuracy: 248/257 (96.4981%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.3261, Accuracy: 9052/10000 (90.5200%)
___Train Local_Simple,  epoch  41, local model 14, internal_epoch   1,  Average loss: 0.0034, Accuracy: 359/376 (95.4787%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2150, Accuracy: 9409/10000 (94.0900%)
___Train Local_Simple,  epoch  41, local model 32, internal_epoch   1,  Average loss: 0.0031, Accuracy: 921/977 (94.2682%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.3462, Accuracy: 8881/10000 (88.8100%)
time spent on training: 47.80800271034241
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.6719, Accuracy: 8545/10000 (85.4500%)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 58.632052183151245 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:42 choose agents : [51, 74, 4, 30, 64, 23, 3, 96, 86, 70]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   1,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.768168003186293.
Norm before scaling: 17.715809734550135. Distance: 0.4538292180943077
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4160, Accuracy: 8915/10000 (89.1500%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 46.5717980439544, distance: 45.38291941909423
Total norm for 2 adversaries is: 46.5717980439544. distance: 45.38291941909423
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 14026.6688, Accuracy: 83/8968 (0.9255%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   1,  Average loss: 0.0010, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   3,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.768168003186293.
Norm before scaling: 17.740407151427995. Distance: 1.2728714416178453
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3011, Accuracy: 9191/10000 (91.9100%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 127.5034543036972, distance: 127.28714232616937
Total norm for 2 adversaries is: 127.5034543036972. distance: 127.28714232616937
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 1487334.5287, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  42, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 615/658 (93.4650%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4003, Accuracy: 8797/10000 (87.9700%)
___Train Local_Simple,  epoch  42, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 367/400 (91.7500%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.5922, Accuracy: 8369/10000 (83.6900%)
___Train Local_Simple,  epoch  42, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 732/813 (90.0369%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4870, Accuracy: 8593/10000 (85.9300%)
___Train Local_Simple,  epoch  42, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 273/293 (93.1741%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3222, Accuracy: 9028/10000 (90.2800%)
___Train Local_Simple,  epoch  42, local model 3, internal_epoch   1,  Average loss: 0.0039, Accuracy: 860/923 (93.1744%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6226, Accuracy: 8124/10000 (81.2400%)
___Train Local_Simple,  epoch  42, local model 96, internal_epoch   1,  Average loss: 0.0054, Accuracy: 611/672 (90.9226%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.5551, Accuracy: 8327/10000 (83.2700%)
___Train Local_Simple,  epoch  42, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 223/250 (89.2000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4055, Accuracy: 8831/10000 (88.3100%)
___Train Local_Simple,  epoch  42, local model 70, internal_epoch   1,  Average loss: 0.0061, Accuracy: 650/724 (89.7790%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.5066, Accuracy: 8561/10000 (85.6100%)
time spent on training: 42.88869881629944
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.3461, Accuracy: 9087/10000 (90.8700%)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 51.736154556274414 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:43 choose agents : [51, 74, 2, 42, 25, 17, 37, 45, 55, 30]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   1,  Average loss: 0.0010, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.697116353973993.
Norm before scaling: 17.68196844405737. Distance: 1.4022089221287988
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.4256, Accuracy: 8905/10000 (89.0500%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 140.44528099272327, distance: 140.22089158716685
Total norm for 2 adversaries is: 140.44528099272327. distance: 140.22089158716685
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 3680510.9670, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   1,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.697116353973993.
Norm before scaling: 17.654065130303557. Distance: 0.41215498613092466
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2521, Accuracy: 9307/10000 (93.0700%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 42.92699249388795, distance: 41.215496637623296
Total norm for 2 adversaries is: 42.92699249388795. distance: 41.215496637623296
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 49527.6981, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  43, local model 2, internal_epoch   1,  Average loss: 0.0030, Accuracy: 524/548 (95.6204%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2376, Accuracy: 9245/10000 (92.4500%)
___Train Local_Simple,  epoch  43, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 217/236 (91.9492%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.5992, Accuracy: 8400/10000 (84.0000%)
___Train Local_Simple,  epoch  43, local model 25, internal_epoch   1,  Average loss: 0.0030, Accuracy: 612/647 (94.5904%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3607, Accuracy: 8772/10000 (87.7200%)
___Train Local_Simple,  epoch  43, local model 17, internal_epoch   1,  Average loss: 0.0026, Accuracy: 592/620 (95.4839%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2116, Accuracy: 9404/10000 (94.0400%)
___Train Local_Simple,  epoch  43, local model 37, internal_epoch   1,  Average loss: 0.0017, Accuracy: 832/860 (96.7442%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.5301, Accuracy: 8564/10000 (85.6400%)
___Train Local_Simple,  epoch  43, local model 45, internal_epoch   1,  Average loss: 0.0023, Accuracy: 602/628 (95.8599%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.5035, Accuracy: 8419/10000 (84.1900%)
___Train Local_Simple,  epoch  43, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 335/354 (94.6328%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.5997, Accuracy: 8437/10000 (84.3700%)
___Train Local_Simple,  epoch  43, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 370/400 (92.5000%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2763, Accuracy: 9211/10000 (92.1100%)
time spent on training: 44.514309883117676
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.6445, Accuracy: 8601/10000 (86.0100%)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 53.95100688934326 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:44 choose agents : [51, 74, 0, 33, 52, 17, 64, 6, 24, 84]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   1,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.661303203879804.
Norm before scaling: 17.615578155428224. Distance: 0.6125840275405536
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3426, Accuracy: 9029/10000 (90.2900%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 62.174645342273564, distance: 61.258405832638594
Total norm for 2 adversaries is: 62.174645342273564. distance: 61.258405832638594
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   1,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.661303203879804.
Norm before scaling: 17.623082266290794. Distance: 1.211889323582236
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2726, Accuracy: 9226/10000 (92.2600%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 121.31346599306278, distance: 121.18893033580872
Total norm for 2 adversaries is: 121.31346599306278. distance: 121.18893033580872
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 497444.8047, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  44, local model 0, internal_epoch   1,  Average loss: 0.0040, Accuracy: 398/435 (91.4943%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.8362, Accuracy: 8114/10000 (81.1400%)
___Train Local_Simple,  epoch  44, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 567/623 (91.0112%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3533, Accuracy: 9067/10000 (90.6700%)
___Train Local_Simple,  epoch  44, local model 52, internal_epoch   1,  Average loss: 0.0043, Accuracy: 236/253 (93.2806%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2621, Accuracy: 9247/10000 (92.4700%)
___Train Local_Simple,  epoch  44, local model 17, internal_epoch   1,  Average loss: 0.0044, Accuracy: 573/620 (92.4194%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3067, Accuracy: 9087/10000 (90.8700%)
___Train Local_Simple,  epoch  44, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 747/813 (91.8819%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.3355, Accuracy: 6961/10000 (69.6100%)
___Train Local_Simple,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 562/615 (91.3821%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3760, Accuracy: 8806/10000 (88.0600%)
___Train Local_Simple,  epoch  44, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 356/379 (93.9314%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3501, Accuracy: 8917/10000 (89.1700%)
___Train Local_Simple,  epoch  44, local model 84, internal_epoch   1,  Average loss: 0.0030, Accuracy: 1177/1246 (94.4623%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.4624, Accuracy: 8776/10000 (87.7600%)
time spent on training: 44.39012289047241
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.3162, Accuracy: 9097/10000 (90.9700%)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 55.89633822441101 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:45 choose agents : [51, 74, 35, 82, 83, 59, 92, 30, 73, 41]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0008, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.59824369510616.
Norm before scaling: 17.59212636824355. Distance: 1.2608294113326777
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4463, Accuracy: 8922/10000 (89.2200%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 126.5942514184096, distance: 126.08294176106854
Total norm for 2 adversaries is: 126.5942514184096. distance: 126.08294176106854
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 3801586.7417, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   1,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.59824369510616.
Norm before scaling: 17.55412597844699. Distance: 0.46363014991144197
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2388, Accuracy: 9301/10000 (93.0100%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 47.77703699134005, distance: 46.363013844382195
Total norm for 2 adversaries is: 47.77703699134005. distance: 46.363013844382195
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 50540.4457, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  45, local model 35, internal_epoch   1,  Average loss: 0.0023, Accuracy: 474/499 (94.9900%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3149, Accuracy: 9087/10000 (90.8700%)
___Train Local_Simple,  epoch  45, local model 82, internal_epoch   1,  Average loss: 0.0029, Accuracy: 670/713 (93.9691%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.7674, Accuracy: 7850/10000 (78.5000%)
___Train Local_Simple,  epoch  45, local model 83, internal_epoch   1,  Average loss: 0.0045, Accuracy: 392/433 (90.5312%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1653, Accuracy: 9502/10000 (95.0200%)
___Train Local_Simple,  epoch  45, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 728/760 (95.7895%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5570, Accuracy: 8360/10000 (83.6000%)
___Train Local_Simple,  epoch  45, local model 92, internal_epoch   1,  Average loss: 0.0028, Accuracy: 886/937 (94.5571%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.7134, Accuracy: 8320/10000 (83.2000%)
___Train Local_Simple,  epoch  45, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 382/400 (95.5000%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2210, Accuracy: 9403/10000 (94.0300%)
___Train Local_Simple,  epoch  45, local model 73, internal_epoch   1,  Average loss: 0.0025, Accuracy: 566/591 (95.7699%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3680, Accuracy: 8854/10000 (88.5400%)
___Train Local_Simple,  epoch  45, local model 41, internal_epoch   1,  Average loss: 0.0025, Accuracy: 581/606 (95.8746%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3177, Accuracy: 9006/10000 (90.0600%)
time spent on training: 45.31140899658203
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.5614, Accuracy: 8808/10000 (88.0800%)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 54.170584201812744 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:46 choose agents : [51, 74, 25, 16, 93, 50, 58, 79, 75, 21]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   1,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.565560613818576.
Norm before scaling: 17.540955493612834. Distance: 0.9520703718999041
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3450, Accuracy: 9030/10000 (90.3000%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 95.89526248562804, distance: 95.20703693956924
Total norm for 2 adversaries is: 95.89526248562804. distance: 95.20703693956924
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   1,  Average loss: 0.0005, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.565560613818576.
Norm before scaling: 17.51930436377612. Distance: 0.8055439807527972
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3523, Accuracy: 9130/10000 (91.3000%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 81.05787380785411, distance: 80.55439616921909
Total norm for 2 adversaries is: 81.05787380785411. distance: 80.55439616921909
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 189030.0493, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  46, local model 25, internal_epoch   1,  Average loss: 0.0034, Accuracy: 616/647 (95.2087%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2405, Accuracy: 9273/10000 (92.7300%)
___Train Local_Simple,  epoch  46, local model 16, internal_epoch   1,  Average loss: 0.0029, Accuracy: 875/915 (95.6284%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2083, Accuracy: 9389/10000 (93.8900%)
___Train Local_Simple,  epoch  46, local model 93, internal_epoch   1,  Average loss: 0.0028, Accuracy: 597/623 (95.8266%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.5743, Accuracy: 8444/10000 (84.4400%)
___Train Local_Simple,  epoch  46, local model 50, internal_epoch   1,  Average loss: 0.0071, Accuracy: 432/474 (91.1392%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.4298, Accuracy: 8545/10000 (85.4500%)
___Train Local_Simple,  epoch  46, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 257/276 (93.1159%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3549, Accuracy: 8847/10000 (88.4700%)
___Train Local_Simple,  epoch  46, local model 79, internal_epoch   1,  Average loss: 0.0082, Accuracy: 165/182 (90.6593%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1902, Accuracy: 9446/10000 (94.4600%)
___Train Local_Simple,  epoch  46, local model 75, internal_epoch   1,  Average loss: 0.0047, Accuracy: 635/686 (92.5656%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3086, Accuracy: 9089/10000 (90.8900%)
___Train Local_Simple,  epoch  46, local model 21, internal_epoch   1,  Average loss: 0.0060, Accuracy: 287/312 (91.9872%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.4383, Accuracy: 8672/10000 (86.7200%)
time spent on training: 41.94242787361145
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.2743, Accuracy: 9178/10000 (91.7800%)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 51.42236542701721 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:47 choose agents : [51, 74, 10, 8, 40, 53, 45, 30, 76, 9]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.497827013526923.
Norm before scaling: 17.4716148142852. Distance: 0.7553456061118953
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3160, Accuracy: 9164/10000 (91.6400%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 76.5697541206301, distance: 75.53455981577241
Total norm for 2 adversaries is: 76.5697541206301. distance: 75.53455981577241
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 1393986.2882, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   1,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.497827013526923.
Norm before scaling: 17.4475418764162. Distance: 0.22526626726318127
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2396, Accuracy: 9291/10000 (92.9100%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 25.156001308941544, distance: 22.526627446020342
Total norm for 2 adversaries is: 25.156001308941544. distance: 22.526627446020342
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 4909.4050, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  47, local model 10, internal_epoch   1,  Average loss: 0.0023, Accuracy: 858/892 (96.1883%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.7249, Accuracy: 7654/10000 (76.5400%)
___Train Local_Simple,  epoch  47, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 586/633 (92.5750%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2038, Accuracy: 9429/10000 (94.2900%)
___Train Local_Simple,  epoch  47, local model 40, internal_epoch   1,  Average loss: 0.0023, Accuracy: 752/772 (97.4093%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2354, Accuracy: 9289/10000 (92.8900%)
___Train Local_Simple,  epoch  47, local model 53, internal_epoch   1,  Average loss: 0.0014, Accuracy: 721/739 (97.5643%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3668, Accuracy: 8929/10000 (89.2900%)
___Train Local_Simple,  epoch  47, local model 45, internal_epoch   1,  Average loss: 0.0027, Accuracy: 597/628 (95.0637%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.4142, Accuracy: 8679/10000 (86.7900%)
___Train Local_Simple,  epoch  47, local model 30, internal_epoch   1,  Average loss: 0.0033, Accuracy: 373/400 (93.2500%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3152, Accuracy: 9072/10000 (90.7200%)
___Train Local_Simple,  epoch  47, local model 76, internal_epoch   1,  Average loss: 0.0014, Accuracy: 77/78 (98.7179%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2703, Accuracy: 9202/10000 (92.0200%)
___Train Local_Simple,  epoch  47, local model 9, internal_epoch   1,  Average loss: 0.0030, Accuracy: 408/436 (93.5780%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3907, Accuracy: 8693/10000 (86.9300%)
time spent on training: 48.234349966049194
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.3336, Accuracy: 9164/10000 (91.6400%)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 57.13000822067261 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:48 choose agents : [51, 74, 87, 4, 11, 24, 42, 23, 25, 95]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.425276433648406.
Norm before scaling: 17.363740415048017. Distance: 0.09714182784814698
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3308, Accuracy: 9163/10000 (91.6300%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 13.527076412316463, distance: 9.71418286918246
Total norm for 2 adversaries is: 13.527076412316463. distance: 9.71418286918246
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.425276433648406.
Norm before scaling: 17.369040365904556. Distance: 0.13528982436098927
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3104, Accuracy: 9217/10000 (92.1700%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 17.005107336829997, distance: 13.528982064918655
Total norm for 2 adversaries is: 17.005107336829997. distance: 13.528982064918655
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 22.0179, Accuracy: 7559/8968 (84.2886%)
___Train Local_Simple,  epoch  48, local model 87, internal_epoch   1,  Average loss: 0.0017, Accuracy: 454/470 (96.5957%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3424, Accuracy: 9073/10000 (90.7300%)
___Train Local_Simple,  epoch  48, local model 4, internal_epoch   1,  Average loss: 0.0027, Accuracy: 627/658 (95.2888%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.5443, Accuracy: 8328/10000 (83.2800%)
___Train Local_Simple,  epoch  48, local model 11, internal_epoch   1,  Average loss: 0.0033, Accuracy: 604/645 (93.6434%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3284, Accuracy: 9041/10000 (90.4100%)
___Train Local_Simple,  epoch  48, local model 24, internal_epoch   1,  Average loss: 0.0029, Accuracy: 362/379 (95.5145%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1945, Accuracy: 9413/10000 (94.1300%)
___Train Local_Simple,  epoch  48, local model 42, internal_epoch   1,  Average loss: 0.0053, Accuracy: 214/236 (90.6780%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3752, Accuracy: 8848/10000 (88.4800%)
___Train Local_Simple,  epoch  48, local model 23, internal_epoch   1,  Average loss: 0.0022, Accuracy: 283/293 (96.5870%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2261, Accuracy: 9328/10000 (93.2800%)
___Train Local_Simple,  epoch  48, local model 25, internal_epoch   1,  Average loss: 0.0026, Accuracy: 619/647 (95.6723%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3014, Accuracy: 9132/10000 (91.3200%)
___Train Local_Simple,  epoch  48, local model 95, internal_epoch   1,  Average loss: 0.0013, Accuracy: 591/602 (98.1728%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4243, Accuracy: 8897/10000 (88.9700%)
time spent on training: 43.781134843826294
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.2742, Accuracy: 9284/10000 (92.8400%)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 52.52421593666077 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:49 choose agents : [51, 74, 89, 56, 71, 15, 92, 93, 88, 68]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.302436189615126.
Norm before scaling: 17.23843836674943. Distance: 0.07069472887441368
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2763, Accuracy: 9281/10000 (92.8100%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.304866681263974, distance: 7.06947293012468
Total norm for 2 adversaries is: 11.304866681263974. distance: 7.06947293012468
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.302436189615126.
Norm before scaling: 17.240706884491516. Distance: 0.07622989865440986
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2716, Accuracy: 9283/10000 (92.8300%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.986348334114053, distance: 7.62298982732305
Total norm for 2 adversaries is: 11.986348334114053. distance: 7.62298982732305
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 25.4140, Accuracy: 364/8968 (4.0589%)
___Train Local_Simple,  epoch  49, local model 89, internal_epoch   1,  Average loss: 0.0012, Accuracy: 481/492 (97.7642%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3601, Accuracy: 9021/10000 (90.2100%)
___Train Local_Simple,  epoch  49, local model 56, internal_epoch   1,  Average loss: 0.0029, Accuracy: 837/880 (95.1136%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1419, Accuracy: 9559/10000 (95.5900%)
___Train Local_Simple,  epoch  49, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1338/1384 (96.6763%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3127, Accuracy: 8993/10000 (89.9300%)
___Train Local_Simple,  epoch  49, local model 15, internal_epoch   1,  Average loss: 0.0041, Accuracy: 374/401 (93.2668%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.0166, Accuracy: 7591/10000 (75.9100%)
___Train Local_Simple,  epoch  49, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 894/937 (95.4109%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.8666, Accuracy: 7577/10000 (75.7700%)
___Train Local_Simple,  epoch  49, local model 93, internal_epoch   1,  Average loss: 0.0015, Accuracy: 607/623 (97.4318%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3002, Accuracy: 9158/10000 (91.5800%)
___Train Local_Simple,  epoch  49, local model 88, internal_epoch   1,  Average loss: 0.0015, Accuracy: 518/530 (97.7358%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2108, Accuracy: 9365/10000 (93.6500%)
___Train Local_Simple,  epoch  49, local model 68, internal_epoch   1,  Average loss: 0.0020, Accuracy: 475/494 (96.1538%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3601, Accuracy: 8885/10000 (88.8500%)
time spent on training: 43.604973554611206
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.2384, Accuracy: 9355/10000 (93.5500%)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 52.57563924789429 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:50 choose agents : [51, 74, 20, 79, 58, 21, 68, 14, 99, 28]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.16898949966052.
Norm before scaling: 17.10588934242568. Distance: 0.07137868747334242
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2421, Accuracy: 9348/10000 (93.4800%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.354946023400373, distance: 7.137868670614187
Total norm for 2 adversaries is: 11.354946023400373. distance: 7.137868670614187
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.1903, Accuracy: 8632/8968 (96.2533%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.16898949966052.
Norm before scaling: 17.107325433746027. Distance: 0.07030728440014228
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2378, Accuracy: 9357/10000 (93.5700%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.504068069744733, distance: 7.030728604800179
Total norm for 2 adversaries is: 11.504068069744733. distance: 7.030728604800179
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 3.1345, Accuracy: 6035/8968 (67.2948%)
___Train Local_Simple,  epoch  50, local model 20, internal_epoch   1,  Average loss: 0.0021, Accuracy: 413/429 (96.2704%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.7139, Accuracy: 8318/10000 (83.1800%)
___Train Local_Simple,  epoch  50, local model 79, internal_epoch   1,  Average loss: 0.0056, Accuracy: 167/182 (91.7582%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1426, Accuracy: 9560/10000 (95.6000%)
___Train Local_Simple,  epoch  50, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 259/276 (93.8406%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2452, Accuracy: 9246/10000 (92.4600%)
___Train Local_Simple,  epoch  50, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 294/312 (94.2308%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2538, Accuracy: 9216/10000 (92.1600%)
___Train Local_Simple,  epoch  50, local model 68, internal_epoch   1,  Average loss: 0.0015, Accuracy: 478/494 (96.7611%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2574, Accuracy: 9189/10000 (91.8900%)
___Train Local_Simple,  epoch  50, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 359/376 (95.4787%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1929, Accuracy: 9418/10000 (94.1800%)
___Train Local_Simple,  epoch  50, local model 99, internal_epoch   1,  Average loss: 0.0014, Accuracy: 370/377 (98.1432%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.3287, Accuracy: 9109/10000 (91.0900%)
___Train Local_Simple,  epoch  50, local model 28, internal_epoch   1,  Average loss: 0.0027, Accuracy: 480/501 (95.8084%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2019, Accuracy: 9360/10000 (93.6000%)
time spent on training: 44.9965980052948
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.2241, Accuracy: 9391/10000 (93.9100%)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 53.94975543022156 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:51 choose agents : [51, 74, 22, 71, 95, 37, 49, 41, 50, 72]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 17.040003663541732.
Norm before scaling: 16.97808053066834. Distance: 0.07254355378695854
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2296, Accuracy: 9371/10000 (93.7100%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.480718619686403, distance: 7.254355602079072
Total norm for 2 adversaries is: 11.480718619686403. distance: 7.254355602079072
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.1011, Accuracy: 8763/8968 (97.7141%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 17.040003663541732.
Norm before scaling: 16.979117638764848. Distance: 0.06962575918739111
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2249, Accuracy: 9387/10000 (93.8700%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.455145893075331, distance: 6.962575871655165
Total norm for 2 adversaries is: 11.455145893075331. distance: 6.962575871655165
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 16.5098, Accuracy: 2141/8968 (23.8738%)
___Train Local_Simple,  epoch  51, local model 22, internal_epoch   1,  Average loss: 0.0032, Accuracy: 556/583 (95.3688%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.3084, Accuracy: 9029/10000 (90.2900%)
___Train Local_Simple,  epoch  51, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1341/1384 (96.8931%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.3548, Accuracy: 8858/10000 (88.5800%)
___Train Local_Simple,  epoch  51, local model 95, internal_epoch   1,  Average loss: 0.0009, Accuracy: 589/602 (97.8405%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2955, Accuracy: 9222/10000 (92.2200%)
___Train Local_Simple,  epoch  51, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 843/860 (98.0233%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.4115, Accuracy: 8896/10000 (88.9600%)
___Train Local_Simple,  epoch  51, local model 49, internal_epoch   1,  Average loss: 0.0018, Accuracy: 493/506 (97.4308%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1719, Accuracy: 9480/10000 (94.8000%)
___Train Local_Simple,  epoch  51, local model 41, internal_epoch   1,  Average loss: 0.0022, Accuracy: 585/606 (96.5347%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.3584, Accuracy: 8945/10000 (89.4500%)
___Train Local_Simple,  epoch  51, local model 50, internal_epoch   1,  Average loss: 0.0042, Accuracy: 441/474 (93.0380%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.4174, Accuracy: 8559/10000 (85.5900%)
___Train Local_Simple,  epoch  51, local model 72, internal_epoch   1,  Average loss: 0.0022, Accuracy: 697/731 (95.3488%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.5297, Accuracy: 8384/10000 (83.8400%)
time spent on training: 54.63338375091553
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 51: Average loss: 0.2068, Accuracy: 9417/10000 (94.1700%)
___Test Target_Simple poisoned: True, epoch: 51: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 67.1382429599762 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:52 choose agents : [51, 74, 61, 41, 42, 85, 26, 48, 50, 36]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.910250544753264.
Norm before scaling: 16.849268757605348. Distance: 0.07201478248061144
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2131, Accuracy: 9399/10000 (93.9900%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.464046501241052, distance: 7.201478054075433
Total norm for 2 adversaries is: 11.464046501241052. distance: 7.201478054075433
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 1.7353, Accuracy: 7722/8968 (86.1062%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.910250544753264.
Norm before scaling: 16.84926966321074. Distance: 0.0674465334258254
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2083, Accuracy: 9411/10000 (94.1100%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.185847837043738, distance: 6.744653633109356
Total norm for 2 adversaries is: 11.185847837043738. distance: 6.744653633109356
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 8.4701, Accuracy: 3933/8968 (43.8559%)
___Train Local_Simple,  epoch  52, local model 61, internal_epoch   1,  Average loss: 0.0024, Accuracy: 671/699 (95.9943%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2730, Accuracy: 9146/10000 (91.4600%)
___Train Local_Simple,  epoch  52, local model 41, internal_epoch   1,  Average loss: 0.0030, Accuracy: 578/606 (95.3795%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.3472, Accuracy: 8901/10000 (89.0100%)
___Train Local_Simple,  epoch  52, local model 42, internal_epoch   1,  Average loss: 0.0029, Accuracy: 223/236 (94.4915%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1748, Accuracy: 9465/10000 (94.6500%)
___Train Local_Simple,  epoch  52, local model 85, internal_epoch   1,  Average loss: 0.0020, Accuracy: 413/431 (95.8237%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1842, Accuracy: 9457/10000 (94.5700%)
___Train Local_Simple,  epoch  52, local model 26, internal_epoch   1,  Average loss: 0.0020, Accuracy: 533/554 (96.2094%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2955, Accuracy: 9140/10000 (91.4000%)
___Train Local_Simple,  epoch  52, local model 48, internal_epoch   1,  Average loss: 0.0016, Accuracy: 433/448 (96.6518%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1362, Accuracy: 9595/10000 (95.9500%)
___Train Local_Simple,  epoch  52, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 450/474 (94.9367%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.4167, Accuracy: 8672/10000 (86.7200%)
___Train Local_Simple,  epoch  52, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 983/1005 (97.8109%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.3460, Accuracy: 9132/10000 (91.3200%)
time spent on training: 45.480287313461304
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 52: Average loss: 0.1966, Accuracy: 9433/10000 (94.3300%)
___Test Target_Simple poisoned: True, epoch: 52: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 57.82089567184448 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:53 choose agents : [51, 74, 54, 81, 33, 25, 15, 1, 66, 84]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.7836875921072.
Norm before scaling: 16.722632069738417. Distance: 0.06921912817496503
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2016, Accuracy: 9415/10000 (94.1500%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.160332282804022, distance: 6.921913026313438
Total norm for 2 adversaries is: 11.160332282804022. distance: 6.921913026313438
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 3.7790, Accuracy: 6588/8968 (73.4612%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.7836875921072.
Norm before scaling: 16.72386476230571. Distance: 0.06788623421389248
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1984, Accuracy: 9431/10000 (94.3100%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.263396022773074, distance: 6.788623369806288
Total norm for 2 adversaries is: 11.263396022773074. distance: 6.788623369806288
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 29.7645, Accuracy: 291/8968 (3.2449%)
___Train Local_Simple,  epoch  53, local model 54, internal_epoch   1,  Average loss: 0.0026, Accuracy: 498/519 (95.9538%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2655, Accuracy: 9172/10000 (91.7200%)
___Train Local_Simple,  epoch  53, local model 81, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1185/1227 (96.5770%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.3544, Accuracy: 8923/10000 (89.2300%)
___Train Local_Simple,  epoch  53, local model 33, internal_epoch   1,  Average loss: 0.0026, Accuracy: 595/623 (95.5056%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.3374, Accuracy: 8872/10000 (88.7200%)
___Train Local_Simple,  epoch  53, local model 25, internal_epoch   1,  Average loss: 0.0020, Accuracy: 622/647 (96.1360%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.3847, Accuracy: 8867/10000 (88.6700%)
___Train Local_Simple,  epoch  53, local model 15, internal_epoch   1,  Average loss: 0.0035, Accuracy: 379/401 (94.5137%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6629, Accuracy: 7826/10000 (78.2600%)
___Train Local_Simple,  epoch  53, local model 1, internal_epoch   1,  Average loss: 0.0037, Accuracy: 705/760 (92.7632%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2523, Accuracy: 9188/10000 (91.8800%)
___Train Local_Simple,  epoch  53, local model 66, internal_epoch   1,  Average loss: 0.0029, Accuracy: 623/660 (94.3939%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6143, Accuracy: 8267/10000 (82.6700%)
___Train Local_Simple,  epoch  53, local model 84, internal_epoch   1,  Average loss: 0.0023, Accuracy: 1189/1246 (95.4254%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.3062, Accuracy: 9128/10000 (91.2800%)
time spent on training: 47.85038948059082
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 53: Average loss: 0.1805, Accuracy: 9465/10000 (94.6500%)
___Test Target_Simple poisoned: True, epoch: 53: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 57.14729976654053 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:54 choose agents : [51, 74, 4, 81, 32, 47, 44, 91, 48, 71]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.655694834204795.
Norm before scaling: 16.59596504901728. Distance: 0.07010692771081752
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1871, Accuracy: 9446/10000 (94.4600%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.28973221953768, distance: 7.010693148356313
Total norm for 2 adversaries is: 11.28973221953768. distance: 7.010693148356313
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 11.8344, Accuracy: 4751/8968 (52.9773%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.655694834204795.
Norm before scaling: 16.596647250308475. Distance: 0.0688446497429811
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1826, Accuracy: 9457/10000 (94.5700%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.313055035373885, distance: 6.884464754064122
Total norm for 2 adversaries is: 11.313055035373885. distance: 6.884464754064122
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 62.1821, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  54, local model 4, internal_epoch   1,  Average loss: 0.0028, Accuracy: 630/658 (95.7447%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2800, Accuracy: 9128/10000 (91.2800%)
___Train Local_Simple,  epoch  54, local model 81, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1187/1227 (96.7400%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.4402, Accuracy: 8734/10000 (87.3400%)
___Train Local_Simple,  epoch  54, local model 32, internal_epoch   1,  Average loss: 0.0025, Accuracy: 933/977 (95.4964%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.3547, Accuracy: 8901/10000 (89.0100%)
___Train Local_Simple,  epoch  54, local model 47, internal_epoch   1,  Average loss: 0.0024, Accuracy: 747/776 (96.2629%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.3806, Accuracy: 8824/10000 (88.2400%)
___Train Local_Simple,  epoch  54, local model 44, internal_epoch   1,  Average loss: 0.0029, Accuracy: 494/517 (95.5513%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1835, Accuracy: 9401/10000 (94.0100%)
___Train Local_Simple,  epoch  54, local model 91, internal_epoch   1,  Average loss: 0.0005, Accuracy: 253/256 (98.8281%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1838, Accuracy: 9457/10000 (94.5700%)
___Train Local_Simple,  epoch  54, local model 48, internal_epoch   1,  Average loss: 0.0012, Accuracy: 436/448 (97.3214%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1309, Accuracy: 9593/10000 (95.9300%)
___Train Local_Simple,  epoch  54, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1345/1384 (97.1821%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.3686, Accuracy: 8897/10000 (88.9700%)
time spent on training: 48.956645011901855
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 54: Average loss: 0.1715, Accuracy: 9488/10000 (94.8800%)
___Test Target_Simple poisoned: True, epoch: 54: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 58.779478549957275 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:55 choose agents : [51, 74, 79, 27, 30, 33, 41, 5, 53, 86]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.52971862738113.
Norm before scaling: 16.471430232861252. Distance: 0.07303484815128676
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1791, Accuracy: 9467/10000 (94.6700%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.562131143820938, distance: 7.303484714644838
Total norm for 2 adversaries is: 11.562131143820938. distance: 7.303484714644838
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 19.3116, Accuracy: 4161/8968 (46.3983%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.52971862738113.
Norm before scaling: 16.471225501803136. Distance: 0.06693382570923907
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1740, Accuracy: 9480/10000 (94.8000%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.160339802590123, distance: 6.693382741788802
Total norm for 2 adversaries is: 11.160339802590123. distance: 6.693382741788802
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 24.0059, Accuracy: 1060/8968 (11.8198%)
___Train Local_Simple,  epoch  55, local model 79, internal_epoch   1,  Average loss: 0.0044, Accuracy: 169/182 (92.8571%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1274, Accuracy: 9611/10000 (96.1100%)
___Train Local_Simple,  epoch  55, local model 27, internal_epoch   1,  Average loss: 0.0026, Accuracy: 446/471 (94.6921%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.2001, Accuracy: 9332/10000 (93.3200%)
___Train Local_Simple,  epoch  55, local model 30, internal_epoch   1,  Average loss: 0.0022, Accuracy: 381/400 (95.2500%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.2100, Accuracy: 9385/10000 (93.8500%)
___Train Local_Simple,  epoch  55, local model 33, internal_epoch   1,  Average loss: 0.0023, Accuracy: 593/623 (95.1846%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.4008, Accuracy: 8781/10000 (87.8100%)
___Train Local_Simple,  epoch  55, local model 41, internal_epoch   1,  Average loss: 0.0024, Accuracy: 581/606 (95.8746%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.3343, Accuracy: 9022/10000 (90.2200%)
___Train Local_Simple,  epoch  55, local model 5, internal_epoch   1,  Average loss: 0.0026, Accuracy: 420/434 (96.7742%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1690, Accuracy: 9490/10000 (94.9000%)
___Train Local_Simple,  epoch  55, local model 53, internal_epoch   1,  Average loss: 0.0008, Accuracy: 728/739 (98.5115%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.4428, Accuracy: 8748/10000 (87.4800%)
___Train Local_Simple,  epoch  55, local model 86, internal_epoch   1,  Average loss: 0.0022, Accuracy: 237/250 (94.8000%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1552, Accuracy: 9501/10000 (95.0100%)
time spent on training: 46.36089301109314
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 55: Average loss: 0.1722, Accuracy: 9477/10000 (94.7700%)
___Test Target_Simple poisoned: True, epoch: 55: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 56.41389513015747 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:56 choose agents : [51, 74, 5, 43, 63, 18, 39, 29, 89, 80]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.409632277846466.
Norm before scaling: 16.351100574280448. Distance: 0.06982885692103585
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1789, Accuracy: 9465/10000 (94.6500%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.215876389239984, distance: 6.982885419490877
Total norm for 2 adversaries is: 11.215876389239984. distance: 6.982885419490877
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 8.4871, Accuracy: 5620/8968 (62.6673%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.409632277846466.
Norm before scaling: 16.35218024693114. Distance: 0.06820128757911943
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1748, Accuracy: 9475/10000 (94.7500%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.273913927909254, distance: 6.820129042492525
Total norm for 2 adversaries is: 11.273913927909254. distance: 6.820129042492525
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 72.4860, Accuracy: 1/8968 (0.0112%)
___Train Local_Simple,  epoch  56, local model 5, internal_epoch   1,  Average loss: 0.0020, Accuracy: 422/434 (97.2350%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.2741, Accuracy: 9192/10000 (91.9200%)
___Train Local_Simple,  epoch  56, local model 43, internal_epoch   1,  Average loss: 0.0018, Accuracy: 396/408 (97.0588%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1917, Accuracy: 9438/10000 (94.3800%)
___Train Local_Simple,  epoch  56, local model 63, internal_epoch   1,  Average loss: 0.0025, Accuracy: 846/889 (95.1631%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1441, Accuracy: 9586/10000 (95.8600%)
___Train Local_Simple,  epoch  56, local model 18, internal_epoch   1,  Average loss: 0.0055, Accuracy: 434/459 (94.5534%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.3209, Accuracy: 8980/10000 (89.8000%)
___Train Local_Simple,  epoch  56, local model 39, internal_epoch   1,  Average loss: 0.0018, Accuracy: 249/257 (96.8872%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.2579, Accuracy: 9255/10000 (92.5500%)
___Train Local_Simple,  epoch  56, local model 29, internal_epoch   1,  Average loss: 0.0016, Accuracy: 968/1002 (96.6068%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.5779, Accuracy: 8242/10000 (82.4200%)
___Train Local_Simple,  epoch  56, local model 89, internal_epoch   1,  Average loss: 0.0011, Accuracy: 483/492 (98.1707%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.2574, Accuracy: 9221/10000 (92.2100%)
___Train Local_Simple,  epoch  56, local model 80, internal_epoch   1,  Average loss: 0.0016, Accuracy: 415/431 (96.2877%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.2395, Accuracy: 9309/10000 (93.0900%)
time spent on training: 43.60258936882019
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 56: Average loss: 0.1683, Accuracy: 9481/10000 (94.8100%)
___Test Target_Simple poisoned: True, epoch: 56: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 52.66505742073059 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:57 choose agents : [51, 74, 54, 85, 19, 45, 53, 17, 3, 34]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.288353364360244.
Norm before scaling: 16.22994837839093. Distance: 0.06839716752189709
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1746, Accuracy: 9472/10000 (94.7200%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.031790485055105, distance: 6.83971603161026
Total norm for 2 adversaries is: 11.031790485055105. distance: 6.83971603161026
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 8.3948, Accuracy: 5659/8968 (63.1021%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.288353364360244.
Norm before scaling: 16.2313341187775. Distance: 0.06792171223609751
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1712, Accuracy: 9479/10000 (94.7900%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.205175661670223, distance: 6.792170999286231
Total norm for 2 adversaries is: 11.205175661670223. distance: 6.792170999286231
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 65.5089, Accuracy: 8/8968 (0.0892%)
___Train Local_Simple,  epoch  57, local model 54, internal_epoch   1,  Average loss: 0.0021, Accuracy: 501/519 (96.5318%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1914, Accuracy: 9425/10000 (94.2500%)
___Train Local_Simple,  epoch  57, local model 85, internal_epoch   1,  Average loss: 0.0016, Accuracy: 415/431 (96.2877%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1436, Accuracy: 9570/10000 (95.7000%)
___Train Local_Simple,  epoch  57, local model 19, internal_epoch   1,  Average loss: 0.0023, Accuracy: 197/205 (96.0976%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1862, Accuracy: 9437/10000 (94.3700%)
___Train Local_Simple,  epoch  57, local model 45, internal_epoch   1,  Average loss: 0.0021, Accuracy: 602/628 (95.8599%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.4581, Accuracy: 8575/10000 (85.7500%)
___Train Local_Simple,  epoch  57, local model 53, internal_epoch   1,  Average loss: 0.0008, Accuracy: 728/739 (98.5115%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.2750, Accuracy: 9186/10000 (91.8600%)
___Train Local_Simple,  epoch  57, local model 17, internal_epoch   1,  Average loss: 0.0027, Accuracy: 594/620 (95.8065%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.2027, Accuracy: 9395/10000 (93.9500%)
___Train Local_Simple,  epoch  57, local model 3, internal_epoch   1,  Average loss: 0.0022, Accuracy: 882/923 (95.5580%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.2817, Accuracy: 9175/10000 (91.7500%)
___Train Local_Simple,  epoch  57, local model 34, internal_epoch   1,  Average loss: 0.0009, Accuracy: 404/413 (97.8208%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.3634, Accuracy: 9028/10000 (90.2800%)
time spent on training: 51.996657609939575
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 57: Average loss: 0.1659, Accuracy: 9494/10000 (94.9400%)
___Test Target_Simple poisoned: True, epoch: 57: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 63.884580850601196 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:58 choose agents : [51, 74, 32, 5, 34, 75, 14, 40, 90, 73]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.16897524576146.
Norm before scaling: 16.11132137702156. Distance: 0.0686569684398637
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1723, Accuracy: 9480/10000 (94.8000%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.04518004367813, distance: 6.865696663844948
Total norm for 2 adversaries is: 11.04518004367813. distance: 6.865696663844948
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 12.4690, Accuracy: 4703/8968 (52.4420%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.16897524576146.
Norm before scaling: 16.111699259461858. Distance: 0.06609706919364146
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1688, Accuracy: 9485/10000 (94.8500%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.94501032606172, distance: 6.609706861312419
Total norm for 2 adversaries is: 10.94501032606172. distance: 6.609706861312419
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 68.6547, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  58, local model 32, internal_epoch   1,  Average loss: 0.0032, Accuracy: 924/977 (94.5752%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.2406, Accuracy: 9247/10000 (92.4700%)
___Train Local_Simple,  epoch  58, local model 5, internal_epoch   1,  Average loss: 0.0021, Accuracy: 424/434 (97.6959%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.2483, Accuracy: 9254/10000 (92.5400%)
___Train Local_Simple,  epoch  58, local model 34, internal_epoch   1,  Average loss: 0.0007, Accuracy: 408/413 (98.7893%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.3655, Accuracy: 9056/10000 (90.5600%)
___Train Local_Simple,  epoch  58, local model 75, internal_epoch   1,  Average loss: 0.0020, Accuracy: 657/686 (95.7726%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1972, Accuracy: 9393/10000 (93.9300%)
___Train Local_Simple,  epoch  58, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 360/376 (95.7447%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1362, Accuracy: 9586/10000 (95.8600%)
___Train Local_Simple,  epoch  58, local model 40, internal_epoch   1,  Average loss: 0.0012, Accuracy: 754/772 (97.6684%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.2878, Accuracy: 9167/10000 (91.6700%)
___Train Local_Simple,  epoch  58, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 645/683 (94.4363%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.6617, Accuracy: 7796/10000 (77.9600%)
___Train Local_Simple,  epoch  58, local model 73, internal_epoch   1,  Average loss: 0.0016, Accuracy: 575/591 (97.2927%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.3773, Accuracy: 8932/10000 (89.3200%)
time spent on training: 50.500001430511475
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 58: Average loss: 0.1630, Accuracy: 9502/10000 (95.0200%)
___Test Target_Simple poisoned: True, epoch: 58: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 60.79514026641846 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:59 choose agents : [51, 74, 13, 12, 23, 89, 52, 85, 53, 92]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.048930689286788.
Norm before scaling: 15.992040084658866. Distance: 0.06865701930809223
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1698, Accuracy: 9481/10000 (94.8100%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.043232663984693, distance: 6.865701942203702
Total norm for 2 adversaries is: 11.043232663984693. distance: 6.865701942203702
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 19.5630, Accuracy: 3217/8968 (35.8720%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.048930689286788.
Norm before scaling: 15.993227956047571. Distance: 0.06679474565112464
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1661, Accuracy: 9483/10000 (94.8300%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.101884121836594, distance: 6.679474480338711
Total norm for 2 adversaries is: 11.101884121836594. distance: 6.679474480338711
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 63.8185, Accuracy: 13/8968 (0.1450%)
___Train Local_Simple,  epoch  59, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 716/734 (97.5477%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2571, Accuracy: 9205/10000 (92.0500%)
___Train Local_Simple,  epoch  59, local model 12, internal_epoch   1,  Average loss: 0.0022, Accuracy: 1118/1160 (96.3793%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.3105, Accuracy: 9063/10000 (90.6300%)
___Train Local_Simple,  epoch  59, local model 23, internal_epoch   1,  Average loss: 0.0014, Accuracy: 285/293 (97.2696%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1540, Accuracy: 9530/10000 (95.3000%)
___Train Local_Simple,  epoch  59, local model 89, internal_epoch   1,  Average loss: 0.0010, Accuracy: 484/492 (98.3740%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2240, Accuracy: 9344/10000 (93.4400%)
___Train Local_Simple,  epoch  59, local model 52, internal_epoch   1,  Average loss: 0.0024, Accuracy: 244/253 (96.4427%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1413, Accuracy: 9566/10000 (95.6600%)
___Train Local_Simple,  epoch  59, local model 85, internal_epoch   1,  Average loss: 0.0014, Accuracy: 418/431 (96.9838%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1624, Accuracy: 9512/10000 (95.1200%)
___Train Local_Simple,  epoch  59, local model 53, internal_epoch   1,  Average loss: 0.0009, Accuracy: 727/739 (98.3762%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2743, Accuracy: 9191/10000 (91.9100%)
___Train Local_Simple,  epoch  59, local model 92, internal_epoch   1,  Average loss: 0.0021, Accuracy: 900/937 (96.0512%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.7666, Accuracy: 7853/10000 (78.5300%)
time spent on training: 42.82399392127991
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 59: Average loss: 0.1635, Accuracy: 9498/10000 (94.9800%)
___Test Target_Simple poisoned: True, epoch: 59: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 51.85740637779236 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:60 choose agents : [51, 74, 72, 12, 23, 11, 52, 28, 20, 97]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 15.932683478687174.
Norm before scaling: 15.876012574590469. Distance: 0.0670792160334207
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1697, Accuracy: 9483/10000 (94.8300%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.869006028760065, distance: 6.707922154811411
Total norm for 2 adversaries is: 10.869006028760065. distance: 6.707922154811411
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 5.1565, Accuracy: 6775/8968 (75.5464%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 15.932683478687174.
Norm before scaling: 15.877897703979796. Distance: 0.06645249761858861
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1668, Accuracy: 9484/10000 (94.8400%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.103653218969372, distance: 6.645249710844764
Total norm for 2 adversaries is: 11.103653218969372. distance: 6.645249710844764
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 58.4270, Accuracy: 89/8968 (0.9924%)
___Train Local_Simple,  epoch  60, local model 72, internal_epoch   1,  Average loss: 0.0018, Accuracy: 709/731 (96.9904%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2398, Accuracy: 9211/10000 (92.1100%)
___Train Local_Simple,  epoch  60, local model 12, internal_epoch   1,  Average loss: 0.0020, Accuracy: 1124/1160 (96.8966%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1951, Accuracy: 9350/10000 (93.5000%)
___Train Local_Simple,  epoch  60, local model 23, internal_epoch   1,  Average loss: 0.0011, Accuracy: 286/293 (97.6109%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.3250, Accuracy: 9012/10000 (90.1200%)
___Train Local_Simple,  epoch  60, local model 11, internal_epoch   1,  Average loss: 0.0021, Accuracy: 617/645 (95.6589%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.3190, Accuracy: 8998/10000 (89.9800%)
___Train Local_Simple,  epoch  60, local model 52, internal_epoch   1,  Average loss: 0.0026, Accuracy: 245/253 (96.8379%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1327, Accuracy: 9610/10000 (96.1000%)
___Train Local_Simple,  epoch  60, local model 28, internal_epoch   1,  Average loss: 0.0022, Accuracy: 480/501 (95.8084%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1701, Accuracy: 9442/10000 (94.4200%)
___Train Local_Simple,  epoch  60, local model 20, internal_epoch   1,  Average loss: 0.0017, Accuracy: 414/429 (96.5035%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.4805, Accuracy: 8635/10000 (86.3500%)
___Train Local_Simple,  epoch  60, local model 97, internal_epoch   1,  Average loss: 0.0021, Accuracy: 465/487 (95.4825%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2705, Accuracy: 9177/10000 (91.7700%)
time spent on training: 43.770702600479126
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 60: Average loss: 0.1598, Accuracy: 9519/10000 (95.1900%)
___Test Target_Simple poisoned: True, epoch: 60: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 53.736918449401855 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:61 choose agents : [51, 74, 85, 18, 56, 42, 29, 46, 89, 75]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 15.817087344868375.
Norm before scaling: 15.761349902747416. Distance: 0.06835999147954619
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1667, Accuracy: 9490/10000 (94.9000%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.97421328564237, distance: 6.835999162668319
Total norm for 2 adversaries is: 10.97421328564237. distance: 6.835999162668319
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 16.2458, Accuracy: 4012/8968 (44.7368%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 15.817087344868375.
Norm before scaling: 15.76225651576417. Distance: 0.0659323817849733
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1631, Accuracy: 9506/10000 (95.0600%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.957333440574384, distance: 6.593238268335
Total norm for 2 adversaries is: 10.957333440574384. distance: 6.593238268335
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 73.2933, Accuracy: 4/8968 (0.0446%)
___Train Local_Simple,  epoch  61, local model 85, internal_epoch   1,  Average loss: 0.0015, Accuracy: 418/431 (96.9838%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2918, Accuracy: 9159/10000 (91.5900%)
___Train Local_Simple,  epoch  61, local model 18, internal_epoch   1,  Average loss: 0.0030, Accuracy: 434/459 (94.5534%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2672, Accuracy: 9187/10000 (91.8700%)
___Train Local_Simple,  epoch  61, local model 56, internal_epoch   1,  Average loss: 0.0023, Accuracy: 852/880 (96.8182%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1405, Accuracy: 9531/10000 (95.3100%)
___Train Local_Simple,  epoch  61, local model 42, internal_epoch   1,  Average loss: 0.0027, Accuracy: 226/236 (95.7627%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2362, Accuracy: 9255/10000 (92.5500%)
___Train Local_Simple,  epoch  61, local model 29, internal_epoch   1,  Average loss: 0.0015, Accuracy: 967/1002 (96.5070%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.3962, Accuracy: 8741/10000 (87.4100%)
___Train Local_Simple,  epoch  61, local model 46, internal_epoch   1,  Average loss: 0.0024, Accuracy: 680/710 (95.7746%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.6715, Accuracy: 7792/10000 (77.9200%)
___Train Local_Simple,  epoch  61, local model 89, internal_epoch   1,  Average loss: 0.0010, Accuracy: 483/492 (98.1707%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2591, Accuracy: 9229/10000 (92.2900%)
___Train Local_Simple,  epoch  61, local model 75, internal_epoch   1,  Average loss: 0.0023, Accuracy: 653/686 (95.1895%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2506, Accuracy: 9167/10000 (91.6700%)
time spent on training: 42.43527388572693
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 61: Average loss: 0.1550, Accuracy: 9534/10000 (95.3400%)
___Test Target_Simple poisoned: True, epoch: 61: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 51.397777795791626 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:62 choose agents : [51, 74, 91, 48, 83, 10, 94, 63, 26, 29]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 15.702025478452663.
Norm before scaling: 15.646494005310043. Distance: 0.06777361861542788
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1619, Accuracy: 9506/10000 (95.0600%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.860105289630274, distance: 6.777361761503443
Total norm for 2 adversaries is: 10.860105289630274. distance: 6.777361761503443
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 17.1343, Accuracy: 4106/8968 (45.7850%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 15.702025478452663.
Norm before scaling: 15.648573525837897. Distance: 0.06618631630938634
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1586, Accuracy: 9521/10000 (95.2100%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.061076444423255, distance: 6.6186311446370665
Total norm for 2 adversaries is: 11.061076444423255. distance: 6.6186311446370665
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 77.7400, Accuracy: 9/8968 (0.1004%)
___Train Local_Simple,  epoch  62, local model 91, internal_epoch   1,  Average loss: 0.0005, Accuracy: 253/256 (98.8281%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1551, Accuracy: 9532/10000 (95.3200%)
___Train Local_Simple,  epoch  62, local model 48, internal_epoch   1,  Average loss: 0.0015, Accuracy: 434/448 (96.8750%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1456, Accuracy: 9582/10000 (95.8200%)
___Train Local_Simple,  epoch  62, local model 83, internal_epoch   1,  Average loss: 0.0025, Accuracy: 413/433 (95.3811%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1339, Accuracy: 9595/10000 (95.9500%)
___Train Local_Simple,  epoch  62, local model 10, internal_epoch   1,  Average loss: 0.0019, Accuracy: 861/892 (96.5247%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.7040, Accuracy: 8039/10000 (80.3900%)
___Train Local_Simple,  epoch  62, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 140/150 (93.3333%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.3506, Accuracy: 8861/10000 (88.6100%)
___Train Local_Simple,  epoch  62, local model 63, internal_epoch   1,  Average loss: 0.0024, Accuracy: 854/889 (96.0630%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.2019, Accuracy: 9378/10000 (93.7800%)
___Train Local_Simple,  epoch  62, local model 26, internal_epoch   1,  Average loss: 0.0015, Accuracy: 538/554 (97.1119%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1783, Accuracy: 9477/10000 (94.7700%)
___Train Local_Simple,  epoch  62, local model 29, internal_epoch   1,  Average loss: 0.0014, Accuracy: 966/1002 (96.4072%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.3791, Accuracy: 8813/10000 (88.1300%)
time spent on training: 44.381744384765625
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 62: Average loss: 0.1534, Accuracy: 9542/10000 (95.4200%)
___Test Target_Simple poisoned: True, epoch: 62: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 53.469064235687256 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:63 choose agents : [51, 74, 38, 80, 26, 18, 73, 77, 95, 39]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 15.588809650775937.
Norm before scaling: 15.533766360379802. Distance: 0.06579663447886658
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1599, Accuracy: 9520/10000 (95.2000%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.703375196665112, distance: 6.579663312002857
Total norm for 2 adversaries is: 10.703375196665112. distance: 6.579663312002857
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 22.3147, Accuracy: 2629/8968 (29.3153%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 15.588809650775937.
Norm before scaling: 15.536152179228061. Distance: 0.0676677628923445
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1571, Accuracy: 9539/10000 (95.3900%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.155625953637943, distance: 6.766776253450221
Total norm for 2 adversaries is: 11.155625953637943. distance: 6.766776253450221
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 140.5706, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  63, local model 38, internal_epoch   1,  Average loss: 0.0021, Accuracy: 862/895 (96.3128%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2897, Accuracy: 9033/10000 (90.3300%)
___Train Local_Simple,  epoch  63, local model 80, internal_epoch   1,  Average loss: 0.0017, Accuracy: 416/431 (96.5197%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2900, Accuracy: 9117/10000 (91.1700%)
___Train Local_Simple,  epoch  63, local model 26, internal_epoch   1,  Average loss: 0.0019, Accuracy: 535/554 (96.5704%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2380, Accuracy: 9316/10000 (93.1600%)
___Train Local_Simple,  epoch  63, local model 18, internal_epoch   1,  Average loss: 0.0041, Accuracy: 434/459 (94.5534%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2958, Accuracy: 9051/10000 (90.5100%)
___Train Local_Simple,  epoch  63, local model 73, internal_epoch   1,  Average loss: 0.0014, Accuracy: 577/591 (97.6311%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2076, Accuracy: 9348/10000 (93.4800%)
___Train Local_Simple,  epoch  63, local model 77, internal_epoch   1,  Average loss: 0.0027, Accuracy: 561/589 (95.2462%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1609, Accuracy: 9533/10000 (95.3300%)
___Train Local_Simple,  epoch  63, local model 95, internal_epoch   1,  Average loss: 0.0007, Accuracy: 593/602 (98.5050%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.5061, Accuracy: 8444/10000 (84.4400%)
___Train Local_Simple,  epoch  63, local model 39, internal_epoch   1,  Average loss: 0.0016, Accuracy: 250/257 (97.2763%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2235, Accuracy: 9330/10000 (93.3000%)
time spent on training: 47.84340190887451
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 63: Average loss: 0.1512, Accuracy: 9548/10000 (95.4800%)
___Test Target_Simple poisoned: True, epoch: 63: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 57.401219844818115 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:64 choose agents : [51, 74, 44, 92, 31, 1, 38, 9, 6, 19]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 15.477240804166492.
Norm before scaling: 15.423112721038493. Distance: 0.06676727916410122
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1584, Accuracy: 9522/10000 (95.2200%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.789862601012604, distance: 6.676728031348127
Total norm for 2 adversaries is: 10.789862601012604. distance: 6.676728031348127
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 12.7561, Accuracy: 4723/8968 (52.6650%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 15.477240804166492.
Norm before scaling: 15.4239477061418. Distance: 0.06302429618595676
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1539, Accuracy: 9539/10000 (95.3900%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.685865846146298, distance: 6.302429929507937
Total norm for 2 adversaries is: 10.685865846146298. distance: 6.302429929507937
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 23.4605, Accuracy: 1481/8968 (16.5143%)
___Train Local_Simple,  epoch  64, local model 44, internal_epoch   1,  Average loss: 0.0023, Accuracy: 496/517 (95.9381%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1723, Accuracy: 9420/10000 (94.2000%)
___Train Local_Simple,  epoch  64, local model 92, internal_epoch   1,  Average loss: 0.0026, Accuracy: 891/937 (95.0907%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.5775, Accuracy: 8035/10000 (80.3500%)
___Train Local_Simple,  epoch  64, local model 31, internal_epoch   1,  Average loss: 0.0013, Accuracy: 815/835 (97.6048%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1385, Accuracy: 9571/10000 (95.7100%)
___Train Local_Simple,  epoch  64, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 705/760 (92.7632%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1988, Accuracy: 9360/10000 (93.6000%)
___Train Local_Simple,  epoch  64, local model 38, internal_epoch   1,  Average loss: 0.0018, Accuracy: 860/895 (96.0894%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.3921, Accuracy: 8815/10000 (88.1500%)
___Train Local_Simple,  epoch  64, local model 9, internal_epoch   1,  Average loss: 0.0016, Accuracy: 420/436 (96.3303%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.2023, Accuracy: 9335/10000 (93.3500%)
___Train Local_Simple,  epoch  64, local model 6, internal_epoch   1,  Average loss: 0.0024, Accuracy: 588/615 (95.6098%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.2730, Accuracy: 9189/10000 (91.8900%)
___Train Local_Simple,  epoch  64, local model 19, internal_epoch   1,  Average loss: 0.0031, Accuracy: 197/205 (96.0976%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1634, Accuracy: 9485/10000 (94.8500%)
time spent on training: 43.44432973861694
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 64: Average loss: 0.1473, Accuracy: 9560/10000 (95.6000%)
___Test Target_Simple poisoned: True, epoch: 64: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 52.74465298652649 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:65 choose agents : [51, 74, 38, 66, 67, 75, 15, 54, 77, 1]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 15.36599393242266.
Norm before scaling: 15.312593171750978. Distance: 0.06756863334457974
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1550, Accuracy: 9534/10000 (95.3400%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.839216972307266, distance: 6.756863248449827
Total norm for 2 adversaries is: 10.839216972307266. distance: 6.756863248449827
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 37.5291, Accuracy: 1074/8968 (11.9759%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 15.36599393242266.
Norm before scaling: 15.31424027499227. Distance: 0.06361751678744167
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1508, Accuracy: 9551/10000 (95.5100%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.835271417433582, distance: 6.361751178076506
Total norm for 2 adversaries is: 10.835271417433582. distance: 6.361751178076506
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 37.7692, Accuracy: 705/8968 (7.8613%)
___Train Local_Simple,  epoch  65, local model 38, internal_epoch   1,  Average loss: 0.0016, Accuracy: 866/895 (96.7598%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.5339, Accuracy: 8454/10000 (84.5400%)
___Train Local_Simple,  epoch  65, local model 66, internal_epoch   1,  Average loss: 0.0027, Accuracy: 629/660 (95.3030%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.5520, Accuracy: 8083/10000 (80.8300%)
___Train Local_Simple,  epoch  65, local model 67, internal_epoch   1,  Average loss: 0.0015, Accuracy: 972/998 (97.3948%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.3705, Accuracy: 8901/10000 (89.0100%)
___Train Local_Simple,  epoch  65, local model 75, internal_epoch   1,  Average loss: 0.0019, Accuracy: 661/686 (96.3557%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1992, Accuracy: 9337/10000 (93.3700%)
___Train Local_Simple,  epoch  65, local model 15, internal_epoch   1,  Average loss: 0.0026, Accuracy: 381/401 (95.0125%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.5228, Accuracy: 8278/10000 (82.7800%)
___Train Local_Simple,  epoch  65, local model 54, internal_epoch   1,  Average loss: 0.0021, Accuracy: 498/519 (95.9538%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.2179, Accuracy: 9312/10000 (93.1200%)
___Train Local_Simple,  epoch  65, local model 77, internal_epoch   1,  Average loss: 0.0027, Accuracy: 567/589 (96.2649%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1903, Accuracy: 9414/10000 (94.1400%)
___Train Local_Simple,  epoch  65, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 719/760 (94.6053%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.2807, Accuracy: 9040/10000 (90.4000%)
time spent on training: 44.00943732261658
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 65: Average loss: 0.1429, Accuracy: 9570/10000 (95.7000%)
___Test Target_Simple poisoned: True, epoch: 65: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 54.37532448768616 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:66 choose agents : [51, 74, 37, 96, 52, 29, 39, 61, 5, 77]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 15.256201811905411.
Norm before scaling: 15.204032282794259. Distance: 0.0688531176788471
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1517, Accuracy: 9548/10000 (95.4800%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.989865576327228, distance: 6.885311647230806
Total norm for 2 adversaries is: 10.989865576327228. distance: 6.885311647230806
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 18.0553, Accuracy: 4930/8968 (54.9732%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 15.256201811905411.
Norm before scaling: 15.205221002259028. Distance: 0.0670440284179841
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1464, Accuracy: 9567/10000 (95.6700%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 11.043323167066408, distance: 6.704402775120609
Total norm for 2 adversaries is: 11.043323167066408. distance: 6.704402775120609
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 80.6598, Accuracy: 26/8968 (0.2899%)
___Train Local_Simple,  epoch  66, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 845/860 (98.2558%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.3384, Accuracy: 9037/10000 (90.3700%)
___Train Local_Simple,  epoch  66, local model 96, internal_epoch   1,  Average loss: 0.0025, Accuracy: 649/672 (96.5774%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2484, Accuracy: 9244/10000 (92.4400%)
___Train Local_Simple,  epoch  66, local model 52, internal_epoch   1,  Average loss: 0.0025, Accuracy: 243/253 (96.0474%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1434, Accuracy: 9562/10000 (95.6200%)
___Train Local_Simple,  epoch  66, local model 29, internal_epoch   1,  Average loss: 0.0012, Accuracy: 972/1002 (97.0060%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.4175, Accuracy: 8648/10000 (86.4800%)
___Train Local_Simple,  epoch  66, local model 39, internal_epoch   1,  Average loss: 0.0017, Accuracy: 250/257 (97.2763%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2092, Accuracy: 9356/10000 (93.5600%)
___Train Local_Simple,  epoch  66, local model 61, internal_epoch   1,  Average loss: 0.0018, Accuracy: 677/699 (96.8526%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2469, Accuracy: 9233/10000 (92.3300%)
___Train Local_Simple,  epoch  66, local model 5, internal_epoch   1,  Average loss: 0.0019, Accuracy: 424/434 (97.6959%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2798, Accuracy: 9107/10000 (91.0700%)
___Train Local_Simple,  epoch  66, local model 77, internal_epoch   1,  Average loss: 0.0026, Accuracy: 559/589 (94.9066%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1996, Accuracy: 9403/10000 (94.0300%)
time spent on training: 48.00460124015808
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 66: Average loss: 0.1460, Accuracy: 9566/10000 (95.6600%)
___Test Target_Simple poisoned: True, epoch: 66: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 61.17586040496826 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:67 choose agents : [51, 74, 80, 14, 39, 7, 10, 40, 2, 69]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 15.148679246394924.
Norm before scaling: 15.096197778842516. Distance: 0.06623825744598784
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1535, Accuracy: 9549/10000 (95.4900%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.685915823974579, distance: 6.62382640880219
Total norm for 2 adversaries is: 10.685915823974579. distance: 6.62382640880219
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 30.3226, Accuracy: 1673/8968 (18.6552%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 15.148679246394924.
Norm before scaling: 15.09801250792478. Distance: 0.06439285639446725
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1495, Accuracy: 9555/10000 (95.5500%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.829716905326368, distance: 6.439285475145509
Total norm for 2 adversaries is: 10.829716905326368. distance: 6.439285475145509
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 62.9809, Accuracy: 21/8968 (0.2342%)
___Train Local_Simple,  epoch  67, local model 80, internal_epoch   1,  Average loss: 0.0013, Accuracy: 418/431 (96.9838%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.2293, Accuracy: 9354/10000 (93.5400%)
___Train Local_Simple,  epoch  67, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 361/376 (96.0106%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1151, Accuracy: 9667/10000 (96.6700%)
___Train Local_Simple,  epoch  67, local model 39, internal_epoch   1,  Average loss: 0.0015, Accuracy: 249/257 (96.8872%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1946, Accuracy: 9412/10000 (94.1200%)
___Train Local_Simple,  epoch  67, local model 7, internal_epoch   1,  Average loss: 0.0023, Accuracy: 398/418 (95.2153%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.2083, Accuracy: 9314/10000 (93.1400%)
___Train Local_Simple,  epoch  67, local model 10, internal_epoch   1,  Average loss: 0.0018, Accuracy: 865/892 (96.9731%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.9995, Accuracy: 7599/10000 (75.9900%)
___Train Local_Simple,  epoch  67, local model 40, internal_epoch   1,  Average loss: 0.0012, Accuracy: 753/772 (97.5389%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.3978, Accuracy: 8834/10000 (88.3400%)
___Train Local_Simple,  epoch  67, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 531/548 (96.8978%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1525, Accuracy: 9522/10000 (95.2200%)
___Train Local_Simple,  epoch  67, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 236/256 (92.1875%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.4982, Accuracy: 8379/10000 (83.7900%)
time spent on training: 44.70406222343445
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 67: Average loss: 0.1453, Accuracy: 9570/10000 (95.7000%)
___Test Target_Simple poisoned: True, epoch: 67: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 54.64184093475342 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:68 choose agents : [51, 74, 69, 55, 96, 48, 84, 25, 26, 16]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 15.04195994815939.
Norm before scaling: 14.989937013540846. Distance: 0.06500912842360193
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1530, Accuracy: 9547/10000 (95.4700%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.576720647408644, distance: 6.500913115700795
Total norm for 2 adversaries is: 10.576720647408644. distance: 6.500913115700795
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 45.2231, Accuracy: 183/8968 (2.0406%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 15.04195994815939.
Norm before scaling: 14.992037885196657. Distance: 0.06581835107116457
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1487, Accuracy: 9558/10000 (95.5800%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.91837683718551, distance: 6.5818347754429745
Total norm for 2 adversaries is: 10.91837683718551. distance: 6.5818347754429745
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 117.4708, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  68, local model 69, internal_epoch   1,  Average loss: 0.0040, Accuracy: 237/256 (92.5781%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.3950, Accuracy: 8713/10000 (87.1300%)
___Train Local_Simple,  epoch  68, local model 55, internal_epoch   1,  Average loss: 0.0013, Accuracy: 345/354 (97.4576%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2680, Accuracy: 9103/10000 (91.0300%)
___Train Local_Simple,  epoch  68, local model 96, internal_epoch   1,  Average loss: 0.0027, Accuracy: 648/672 (96.4286%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2622, Accuracy: 9215/10000 (92.1500%)
___Train Local_Simple,  epoch  68, local model 48, internal_epoch   1,  Average loss: 0.0009, Accuracy: 440/448 (98.2143%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1529, Accuracy: 9531/10000 (95.3100%)
___Train Local_Simple,  epoch  68, local model 84, internal_epoch   1,  Average loss: 0.0018, Accuracy: 1208/1246 (96.9502%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1549, Accuracy: 9520/10000 (95.2000%)
___Train Local_Simple,  epoch  68, local model 25, internal_epoch   1,  Average loss: 0.0016, Accuracy: 626/647 (96.7543%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1887, Accuracy: 9408/10000 (94.0800%)
___Train Local_Simple,  epoch  68, local model 26, internal_epoch   1,  Average loss: 0.0016, Accuracy: 535/554 (96.5704%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1597, Accuracy: 9521/10000 (95.2100%)
___Train Local_Simple,  epoch  68, local model 16, internal_epoch   1,  Average loss: 0.0015, Accuracy: 891/915 (97.3770%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2108, Accuracy: 9400/10000 (94.0000%)
time spent on training: 45.079272747039795
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 68: Average loss: 0.1459, Accuracy: 9560/10000 (95.6000%)
___Test Target_Simple poisoned: True, epoch: 68: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 54.91637945175171 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:69 choose agents : [51, 74, 7, 92, 69, 43, 76, 27, 77, 19]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 14.93682068114051.
Norm before scaling: 14.885150939975697. Distance: 0.06480027042325315
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1532, Accuracy: 9538/10000 (95.3800%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.51604362210019, distance: 6.480026662324284
Total norm for 2 adversaries is: 10.51604362210019. distance: 6.480026662324284
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 28.5352, Accuracy: 1327/8968 (14.7971%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 14.93682068114051.
Norm before scaling: 14.887640703050467. Distance: 0.06358740738630815
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1495, Accuracy: 9547/10000 (95.4700%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.791762735732098, distance: 6.358740622631828
Total norm for 2 adversaries is: 10.791762735732098. distance: 6.358740622631828
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 54.8304, Accuracy: 74/8968 (0.8252%)
___Train Local_Simple,  epoch  69, local model 7, internal_epoch   1,  Average loss: 0.0021, Accuracy: 402/418 (96.1722%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2350, Accuracy: 9279/10000 (92.7900%)
___Train Local_Simple,  epoch  69, local model 92, internal_epoch   1,  Average loss: 0.0021, Accuracy: 896/937 (95.6243%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2886, Accuracy: 9042/10000 (90.4200%)
___Train Local_Simple,  epoch  69, local model 69, internal_epoch   1,  Average loss: 0.0041, Accuracy: 237/256 (92.5781%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.4575, Accuracy: 8583/10000 (85.8300%)
___Train Local_Simple,  epoch  69, local model 43, internal_epoch   1,  Average loss: 0.0019, Accuracy: 394/408 (96.5686%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1612, Accuracy: 9524/10000 (95.2400%)
___Train Local_Simple,  epoch  69, local model 76, internal_epoch   1,  Average loss: 0.0021, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1692, Accuracy: 9497/10000 (94.9700%)
___Train Local_Simple,  epoch  69, local model 27, internal_epoch   1,  Average loss: 0.0022, Accuracy: 450/471 (95.5414%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1940, Accuracy: 9370/10000 (93.7000%)
___Train Local_Simple,  epoch  69, local model 77, internal_epoch   1,  Average loss: 0.0027, Accuracy: 562/589 (95.4160%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2188, Accuracy: 9294/10000 (92.9400%)
___Train Local_Simple,  epoch  69, local model 19, internal_epoch   1,  Average loss: 0.0025, Accuracy: 198/205 (96.5854%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2430, Accuracy: 9286/10000 (92.8600%)
time spent on training: 46.01542568206787
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 69: Average loss: 0.1437, Accuracy: 9571/10000 (95.7100%)
___Test Target_Simple poisoned: True, epoch: 69: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 56.43489933013916 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:70 choose agents : [51, 74, 59, 85, 93, 98, 17, 58, 79, 10]. Adversary List: [51, 74]
poison local model 51 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   1,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 14.833130967263527.
Norm before scaling: 14.78120251379793. Distance: 0.0634315367712296
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1506, Accuracy: 9549/10000 (95.4900%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.299225372518352, distance: 6.343153751709181
Total norm for 2 adversaries is: 10.299225372518352. distance: 6.343153751709181
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 26.6399, Accuracy: 1273/8968 (14.1949%)
poison local model 74 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   1,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 14.833130967263527.
Norm before scaling: 14.78351367609636. Distance: 0.0631943591820895
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1474, Accuracy: 9554/10000 (95.5400%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 10.611743510931504, distance: 6.31943576611865
Total norm for 2 adversaries is: 10.611743510931504. distance: 6.31943576611865
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 87.9278, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  70, local model 59, internal_epoch   1,  Average loss: 0.0019, Accuracy: 736/760 (96.8421%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.4297, Accuracy: 8579/10000 (85.7900%)
___Train Local_Simple,  epoch  70, local model 85, internal_epoch   1,  Average loss: 0.0019, Accuracy: 416/431 (96.5197%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1470, Accuracy: 9541/10000 (95.4100%)
___Train Local_Simple,  epoch  70, local model 93, internal_epoch   1,  Average loss: 0.0009, Accuracy: 614/623 (98.5554%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.3583, Accuracy: 8979/10000 (89.7900%)
___Train Local_Simple,  epoch  70, local model 98, internal_epoch   1,  Average loss: 0.0023, Accuracy: 780/818 (95.3545%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.3860, Accuracy: 8761/10000 (87.6100%)
___Train Local_Simple,  epoch  70, local model 17, internal_epoch   1,  Average loss: 0.0024, Accuracy: 596/620 (96.1290%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2275, Accuracy: 9270/10000 (92.7000%)
___Train Local_Simple,  epoch  70, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 267/276 (96.7391%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2222, Accuracy: 9291/10000 (92.9100%)
___Train Local_Simple,  epoch  70, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 169/182 (92.8571%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1182, Accuracy: 9636/10000 (96.3600%)
___Train Local_Simple,  epoch  70, local model 10, internal_epoch   1,  Average loss: 0.0019, Accuracy: 864/892 (96.8610%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.7144, Accuracy: 8148/10000 (81.4800%)
time spent on training: 45.70400142669678
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 70: Average loss: 0.1428, Accuracy: 9563/10000 (95.6300%)
___Test Target_Simple poisoned: True, epoch: 70: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 55.75777220726013 sec.
Saving all the graphs.
This run has a label: Nov.13_10.03.50. Visdom environment: mnist_DBA
