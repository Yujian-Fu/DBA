current path: saved_models/model_mnist_Nov.13_03.45.15
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [41, 73, 51, 74]
We use following environment for graphs:  mnist_DBA
----------------------------------Start one training epoch------------------------------------------
Server Epoch:11 choose agents : [41, 73, 51, 74, 23, 76, 63, 11, 75, 43]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   1,  Average loss: 0.0251, Accuracy: 337/606 (55.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   2,  Average loss: 0.0158, Accuracy: 348/606 (57.4257%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   3,  Average loss: 0.0129, Accuracy: 395/606 (65.1815%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   4,  Average loss: 0.0122, Accuracy: 390/606 (64.3564%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   5,  Average loss: 0.0118, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   6,  Average loss: 0.0118, Accuracy: 393/606 (64.8515%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   7,  Average loss: 0.0112, Accuracy: 412/606 (67.9868%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   8,  Average loss: 0.0113, Accuracy: 380/606 (62.7063%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   9,  Average loss: 0.0111, Accuracy: 394/606 (65.0165%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch  10,  Average loss: 0.0105, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Global model norm: 16.539532092117113.
Norm before scaling: 16.771633468716885. Distance: 4.68346730014613
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.3943, Accuracy: 4208/10000 (42.0800%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.8780, Accuracy: 5914/8968 (65.9456%)
Scaling by  100
Scaled Norm after poisoning: 467.12083554472287, distance: 468.346726528541
Total norm for 4 adversaries is: 467.12083554472287. distance: 468.346726528541
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 101793.5421, Accuracy: 2/8968 (0.0223%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0245, Accuracy: 346/591 (58.5448%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   2,  Average loss: 0.0196, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   3,  Average loss: 0.0167, Accuracy: 307/591 (51.9459%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   4,  Average loss: 0.0153, Accuracy: 312/591 (52.7919%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   5,  Average loss: 0.0148, Accuracy: 328/591 (55.4992%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   6,  Average loss: 0.0140, Accuracy: 354/591 (59.8985%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   7,  Average loss: 0.0142, Accuracy: 350/591 (59.2217%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   8,  Average loss: 0.0138, Accuracy: 352/591 (59.5601%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   9,  Average loss: 0.0134, Accuracy: 356/591 (60.2369%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch  10,  Average loss: 0.0137, Accuracy: 340/591 (57.5296%), train_poison_data_count: 195
Global model norm: 16.539532092117113.
Norm before scaling: 16.596384302727753. Distance: 4.013834156923057
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0762, Accuracy: 5302/10000 (53.0200%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.9458, Accuracy: 4994/8968 (55.6869%)
Scaling by  100
Scaled Norm after poisoning: 399.94935226225834, distance: 401.38340850737717
Total norm for 4 adversaries is: 399.94935226225834. distance: 401.38340850737717
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0251, Accuracy: 314/568 (55.2817%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   2,  Average loss: 0.0127, Accuracy: 356/568 (62.6761%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   3,  Average loss: 0.0113, Accuracy: 371/568 (65.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   4,  Average loss: 0.0109, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   5,  Average loss: 0.0104, Accuracy: 395/568 (69.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   6,  Average loss: 0.0104, Accuracy: 388/568 (68.3099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   7,  Average loss: 0.0103, Accuracy: 379/568 (66.7254%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   8,  Average loss: 0.0102, Accuracy: 377/568 (66.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   9,  Average loss: 0.0100, Accuracy: 385/568 (67.7817%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch  10,  Average loss: 0.0097, Accuracy: 401/568 (70.5986%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.71982509685826. Distance: 4.6417241191675656
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.3198, Accuracy: 5095/10000 (50.9500%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.7896, Accuracy: 5210/8968 (58.0955%)
Scaling by  100
Scaled Norm after poisoning: 462.7900948324197, distance: 464.17241543417896
Total norm for 4 adversaries is: 462.7900948324197. distance: 464.17241543417896
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 7037.8823, Accuracy: 8158/8968 (90.9679%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0265, Accuracy: 309/557 (55.4758%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   2,  Average loss: 0.0131, Accuracy: 376/557 (67.5045%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   3,  Average loss: 0.0077, Accuracy: 484/557 (86.8941%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   4,  Average loss: 0.0061, Accuracy: 493/557 (88.5099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   5,  Average loss: 0.0050, Accuracy: 508/557 (91.2029%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   6,  Average loss: 0.0046, Accuracy: 506/557 (90.8438%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   7,  Average loss: 0.0036, Accuracy: 514/557 (92.2801%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   8,  Average loss: 0.0037, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   9,  Average loss: 0.0030, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch  10,  Average loss: 0.0034, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.842616678303454. Distance: 4.70929746405772
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0160, Accuracy: 7197/10000 (71.9700%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1113, Accuracy: 8567/8968 (95.5285%)
Scaling by  100
Scaled Norm after poisoning: 469.93869281003026, distance: 470.92973201954453
Total norm for 4 adversaries is: 469.93869281003026. distance: 470.92973201954453
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1213, Accuracy: 9577/10000 (95.7700%)
___Train Local_Simple,  epoch  11, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.0957, Accuracy: 9719/10000 (97.1900%)
___Train Local_Simple,  epoch  11, local model 63, internal_epoch   1,  Average loss: 0.0020, Accuracy: 857/889 (96.4004%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1366, Accuracy: 9601/10000 (96.0100%)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0017, Accuracy: 626/645 (97.0543%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1996, Accuracy: 9381/10000 (93.8100%)
___Train Local_Simple,  epoch  11, local model 75, internal_epoch   1,  Average loss: 0.0010, Accuracy: 669/686 (97.5219%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1799, Accuracy: 9447/10000 (94.4700%)
___Train Local_Simple,  epoch  11, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 398/408 (97.5490%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3284, Accuracy: 8975/10000 (89.7500%)
time spent on training: 95.95172023773193
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 3.4208, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 0.0071, Accuracy: 8968/8968 (100.0000%)
Done in 112.58111596107483 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:12 choose agents : [41, 73, 51, 74, 46, 37, 21, 43, 35, 11]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0210, Accuracy: 321/606 (52.9703%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   2,  Average loss: 0.0161, Accuracy: 354/606 (58.4158%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   3,  Average loss: 0.0130, Accuracy: 406/606 (66.9967%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   4,  Average loss: 0.0125, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   5,  Average loss: 0.0122, Accuracy: 416/606 (68.6469%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   6,  Average loss: 0.0118, Accuracy: 413/606 (68.1518%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   7,  Average loss: 0.0118, Accuracy: 409/606 (67.4917%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   8,  Average loss: 0.0116, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   9,  Average loss: 0.0114, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch  10,  Average loss: 0.0113, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Global model norm: 20.474775472860806.
Norm before scaling: 20.53185941352031. Distance: 2.548437189398021
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.1086, Accuracy: 2643/10000 (26.4300%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.2195, Accuracy: 8285/8968 (92.3840%)
Scaling by  100
Scaled Norm after poisoning: 254.85125870299328, distance: 254.84370976394533
Total norm for 4 adversaries is: 254.85125870299328. distance: 254.84370976394533
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 6149801.1476, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   1,  Average loss: 0.0275, Accuracy: 232/591 (39.2555%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   2,  Average loss: 0.0197, Accuracy: 234/591 (39.5939%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   3,  Average loss: 0.0153, Accuracy: 412/591 (69.7124%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   4,  Average loss: 0.0122, Accuracy: 435/591 (73.6041%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   5,  Average loss: 0.0102, Accuracy: 505/591 (85.4484%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   6,  Average loss: 0.0075, Accuracy: 520/591 (87.9865%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   7,  Average loss: 0.0063, Accuracy: 532/591 (90.0169%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   8,  Average loss: 0.0051, Accuracy: 537/591 (90.8629%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   9,  Average loss: 0.0045, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch  10,  Average loss: 0.0046, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Global model norm: 20.474775472860806.
Norm before scaling: 20.639850240947727. Distance: 3.497470895620212
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.3778, Accuracy: 4602/10000 (46.0200%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0269, Accuracy: 8890/8968 (99.1302%)
Scaling by  100
Scaled Norm after poisoning: 349.5679029173016, distance: 349.74708495926023
Total norm for 4 adversaries is: 349.5679029173016. distance: 349.74708495926023
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 64367670.5798, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   1,  Average loss: 0.0181, Accuracy: 322/568 (56.6901%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   2,  Average loss: 0.0093, Accuracy: 453/568 (79.7535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   3,  Average loss: 0.0052, Accuracy: 508/568 (89.4366%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   4,  Average loss: 0.0047, Accuracy: 513/568 (90.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   5,  Average loss: 0.0048, Accuracy: 520/568 (91.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   6,  Average loss: 0.0043, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   7,  Average loss: 0.0038, Accuracy: 534/568 (94.0141%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   8,  Average loss: 0.0035, Accuracy: 534/568 (94.0141%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   9,  Average loss: 0.0032, Accuracy: 539/568 (94.8944%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch  10,  Average loss: 0.0031, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Global model norm: 20.474775472860806.
Norm before scaling: 20.642118251246345. Distance: 2.9186898072139944
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.8997, Accuracy: 4887/10000 (48.8700%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0081, Accuracy: 8940/8968 (99.6878%)
Scaling by  100
Scaled Norm after poisoning: 292.3061857881218, distance: 291.86897745392537
Total norm for 4 adversaries is: 292.3061857881218. distance: 291.86897745392537
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 25675627.3720, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   1,  Average loss: 0.0255, Accuracy: 237/557 (42.5494%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   2,  Average loss: 0.0106, Accuracy: 438/557 (78.6355%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   3,  Average loss: 0.0047, Accuracy: 508/557 (91.2029%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   4,  Average loss: 0.0040, Accuracy: 518/557 (92.9982%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   5,  Average loss: 0.0035, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   6,  Average loss: 0.0033, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   7,  Average loss: 0.0033, Accuracy: 520/557 (93.3573%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   8,  Average loss: 0.0026, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   9,  Average loss: 0.0028, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch  10,  Average loss: 0.0032, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Global model norm: 20.474775472860806.
Norm before scaling: 20.72351442909645. Distance: 3.446140457974879
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.6892, Accuracy: 6449/10000 (64.4900%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0112, Accuracy: 8941/8968 (99.6989%)
Scaling by  100
Scaled Norm after poisoning: 344.9858466299741, distance: 344.61405042452924
Total norm for 4 adversaries is: 344.9858466299741. distance: 344.61405042452924
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 65471672.1998, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  12, local model 46, internal_epoch   1,  Average loss: 0.0389, Accuracy: 128/710 (18.0282%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.7255, Accuracy: 958/10000 (9.5800%)
___Train Local_Simple,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0135, Accuracy: 622/860 (72.3256%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.7651, Accuracy: 5268/10000 (52.6800%)
___Train Local_Simple,  epoch  12, local model 21, internal_epoch   1,  Average loss: 0.0395, Accuracy: 61/312 (19.5513%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.4104, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  12, local model 43, internal_epoch   1,  Average loss: 0.0428, Accuracy: 97/408 (23.7745%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.6113, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  12, local model 35, internal_epoch   1,  Average loss: 0.0360, Accuracy: 116/499 (23.2465%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.3840, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0400, Accuracy: 103/645 (15.9690%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.7047, Accuracy: 1010/10000 (10.1000%)
time spent on training: 95.14256143569946
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 4.3000, Accuracy: 5255/10000 (52.5500%)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 4.9231, Accuracy: 5856/8968 (65.2988%)
Done in 114.5516607761383 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:13 choose agents : [41, 73, 51, 74, 61, 64, 28, 67, 22, 82]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0417, Accuracy: 311/606 (51.3201%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   2,  Average loss: 0.0185, Accuracy: 337/606 (55.6106%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   3,  Average loss: 0.0154, Accuracy: 335/606 (55.2805%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   4,  Average loss: 0.0134, Accuracy: 394/606 (65.0165%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   5,  Average loss: 0.0126, Accuracy: 370/606 (61.0561%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   6,  Average loss: 0.0125, Accuracy: 388/606 (64.0264%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   7,  Average loss: 0.0123, Accuracy: 384/606 (63.3663%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   8,  Average loss: 0.0121, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   9,  Average loss: 0.0118, Accuracy: 393/606 (64.8515%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch  10,  Average loss: 0.0117, Accuracy: 399/606 (65.8416%), train_poison_data_count: 200
Global model norm: 22.295139429649236.
Norm before scaling: 27.82207086025634. Distance: 18.123073712294225
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.3173, Accuracy: 3136/10000 (31.3600%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 1.0469, Accuracy: 4766/8968 (53.1445%)
Scaling by  100
Scaled Norm after poisoning: 1811.0247099363387, distance: 1812.307507019711
Total norm for 4 adversaries is: 1811.0247099363387. distance: 1812.307507019711
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 1321107.7107, Accuracy: 1297/8968 (14.4625%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   1,  Average loss: 0.0339, Accuracy: 387/591 (65.4822%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   2,  Average loss: 0.0109, Accuracy: 481/591 (81.3875%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   3,  Average loss: 0.0079, Accuracy: 507/591 (85.7868%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   4,  Average loss: 0.0084, Accuracy: 505/591 (85.4484%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   5,  Average loss: 0.0082, Accuracy: 496/591 (83.9255%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   6,  Average loss: 0.0073, Accuracy: 503/591 (85.1100%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   7,  Average loss: 0.0069, Accuracy: 512/591 (86.6328%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   8,  Average loss: 0.0068, Accuracy: 512/591 (86.6328%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   9,  Average loss: 0.0065, Accuracy: 516/591 (87.3096%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch  10,  Average loss: 0.0070, Accuracy: 507/591 (85.7868%), train_poison_data_count: 195
Global model norm: 22.295139429649236.
Norm before scaling: 25.794259265099207. Distance: 14.381527156886289
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.0072, Accuracy: 3349/10000 (33.4900%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0084, Accuracy: 8946/8968 (99.7547%)
Scaling by  100
Scaled Norm after poisoning: 1436.9845162700954, distance: 1438.1527648341118
Total norm for 4 adversaries is: 1436.9845162700954. distance: 1438.1527648341118
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 4658827.6111, Accuracy: 5257/8968 (58.6195%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   1,  Average loss: 0.0363, Accuracy: 388/568 (68.3099%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   2,  Average loss: 0.0078, Accuracy: 486/568 (85.5634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   3,  Average loss: 0.0056, Accuracy: 505/568 (88.9085%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   4,  Average loss: 0.0049, Accuracy: 514/568 (90.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   5,  Average loss: 0.0043, Accuracy: 519/568 (91.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   6,  Average loss: 0.0040, Accuracy: 525/568 (92.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   7,  Average loss: 0.0043, Accuracy: 526/568 (92.6056%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   8,  Average loss: 0.0039, Accuracy: 533/568 (93.8380%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   9,  Average loss: 0.0035, Accuracy: 534/568 (94.0141%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch  10,  Average loss: 0.0038, Accuracy: 534/568 (94.0141%), train_poison_data_count: 180
Global model norm: 22.295139429649236.
Norm before scaling: 27.238060251595215. Distance: 16.951745155539573
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.1638, Accuracy: 4660/10000 (46.6000%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.4616, Accuracy: 7399/8968 (82.5045%)
Scaling by  100
Scaled Norm after poisoning: 1694.066483347097, distance: 1695.174474796031
Total norm for 4 adversaries is: 1694.066483347097. distance: 1695.174474796031
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 12165207.7743, Accuracy: 2/8968 (0.0223%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   1,  Average loss: 0.0520, Accuracy: 212/557 (38.0610%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   2,  Average loss: 0.0155, Accuracy: 408/557 (73.2496%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   3,  Average loss: 0.0096, Accuracy: 451/557 (80.9695%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   4,  Average loss: 0.0071, Accuracy: 487/557 (87.4327%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   5,  Average loss: 0.0070, Accuracy: 485/557 (87.0736%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   6,  Average loss: 0.0061, Accuracy: 493/557 (88.5099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   7,  Average loss: 0.0056, Accuracy: 487/557 (87.4327%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   8,  Average loss: 0.0050, Accuracy: 505/557 (90.6643%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   9,  Average loss: 0.0048, Accuracy: 508/557 (91.2029%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch  10,  Average loss: 0.0044, Accuracy: 515/557 (92.4596%), train_poison_data_count: 180
Global model norm: 22.295139429649236.
Norm before scaling: 26.998803006235875. Distance: 16.738993658264114
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.8942, Accuracy: 6067/10000 (60.6700%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0059, Accuracy: 8951/8968 (99.8104%)
Scaling by  100
Scaled Norm after poisoning: 1672.6036589700502, distance: 1673.8993398648558
Total norm for 4 adversaries is: 1672.6036589700502. distance: 1673.8993398648558
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 5007090.1347, Accuracy: 4418/8968 (49.2640%)
___Train Local_Simple,  epoch  13, local model 61, internal_epoch   1,  Average loss: 0.0245, Accuracy: 449/699 (64.2346%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.2630, Accuracy: 5082/10000 (50.8200%)
___Train Local_Simple,  epoch  13, local model 64, internal_epoch   1,  Average loss: 0.0250, Accuracy: 540/813 (66.4207%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.8760, Accuracy: 5907/10000 (59.0700%)
___Train Local_Simple,  epoch  13, local model 28, internal_epoch   1,  Average loss: 0.0208, Accuracy: 347/501 (69.2615%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 5.8239, Accuracy: 4164/10000 (41.6400%)
___Train Local_Simple,  epoch  13, local model 67, internal_epoch   1,  Average loss: 0.0307, Accuracy: 571/998 (57.2144%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 4.7659, Accuracy: 4675/10000 (46.7500%)
___Train Local_Simple,  epoch  13, local model 22, internal_epoch   1,  Average loss: 0.0349, Accuracy: 334/583 (57.2899%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.1480, Accuracy: 2863/10000 (28.6300%)
___Train Local_Simple,  epoch  13, local model 82, internal_epoch   1,  Average loss: 0.0686, Accuracy: 202/713 (28.3310%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.9156, Accuracy: 1009/10000 (10.0900%)
time spent on training: 97.88481521606445
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 4.2786, Accuracy: 1031/10000 (10.3100%)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 0.1766, Accuracy: 8890/8968 (99.1302%)
Done in 116.82850360870361 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:14 choose agents : [41, 73, 51, 74, 60, 42, 85, 56, 57, 63]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   1,  Average loss: 0.0274, Accuracy: 306/606 (50.4950%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   2,  Average loss: 0.0214, Accuracy: 309/606 (50.9901%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   3,  Average loss: 0.0186, Accuracy: 330/606 (54.4554%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   4,  Average loss: 0.0182, Accuracy: 352/606 (58.0858%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   5,  Average loss: 0.0171, Accuracy: 365/606 (60.2310%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   6,  Average loss: 0.0179, Accuracy: 352/606 (58.0858%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   7,  Average loss: 0.0167, Accuracy: 351/606 (57.9208%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   8,  Average loss: 0.0161, Accuracy: 378/606 (62.3762%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   9,  Average loss: 0.0163, Accuracy: 385/606 (63.5314%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch  10,  Average loss: 0.0166, Accuracy: 363/606 (59.9010%), train_poison_data_count: 200
Global model norm: 58.999681374934134.
Norm before scaling: 58.87516794362989. Distance: 5.019804832038574
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 3.6304, Accuracy: 2060/10000 (20.6000%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.6748, Accuracy: 6483/8968 (72.2904%)
Scaling by  100
Scaled Norm after poisoning: 501.47561942232045, distance: 501.9804994967434
Total norm for 4 adversaries is: 501.47561942232045. distance: 501.9804994967434
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 15321773.9982, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   1,  Average loss: 0.0401, Accuracy: 223/591 (37.7327%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   2,  Average loss: 0.0269, Accuracy: 273/591 (46.1929%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   3,  Average loss: 0.0121, Accuracy: 455/591 (76.9882%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   4,  Average loss: 0.0095, Accuracy: 478/591 (80.8799%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   5,  Average loss: 0.0074, Accuracy: 511/591 (86.4636%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   6,  Average loss: 0.0064, Accuracy: 518/591 (87.6481%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   7,  Average loss: 0.0070, Accuracy: 506/591 (85.6176%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   8,  Average loss: 0.0059, Accuracy: 521/591 (88.1557%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   9,  Average loss: 0.0057, Accuracy: 519/591 (87.8173%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch  10,  Average loss: 0.0056, Accuracy: 522/591 (88.3249%), train_poison_data_count: 195
Global model norm: 58.999681374934134.
Norm before scaling: 59.96636426989717. Distance: 13.003706183689278
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.5589, Accuracy: 4461/10000 (44.6100%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1394, Accuracy: 8501/8968 (94.7926%)
Scaling by  100
Scaled Norm after poisoning: 1299.6289855185594, distance: 1300.3705241199525
Total norm for 4 adversaries is: 1299.6289855185594. distance: 1300.3705241199525
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 32191101.4487, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   1,  Average loss: 0.0242, Accuracy: 276/568 (48.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   2,  Average loss: 0.0162, Accuracy: 369/568 (64.9648%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   3,  Average loss: 0.0149, Accuracy: 361/568 (63.5563%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   4,  Average loss: 0.0134, Accuracy: 367/568 (64.6127%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   5,  Average loss: 0.0125, Accuracy: 391/568 (68.8380%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   6,  Average loss: 0.0121, Accuracy: 389/568 (68.4859%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   7,  Average loss: 0.0108, Accuracy: 431/568 (75.8803%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   8,  Average loss: 0.0098, Accuracy: 468/568 (82.3944%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   9,  Average loss: 0.0090, Accuracy: 493/568 (86.7958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch  10,  Average loss: 0.0089, Accuracy: 491/568 (86.4437%), train_poison_data_count: 180
Global model norm: 58.999681374934134.
Norm before scaling: 58.84514818439792. Distance: 3.499195006303403
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.7237, Accuracy: 3591/10000 (35.9100%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.3299, Accuracy: 8335/8968 (92.9416%)
Scaling by  100
Scaled Norm after poisoning: 350.5411218744528, distance: 349.91951083427745
Total norm for 4 adversaries is: 350.5411218744528. distance: 349.91951083427745
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 602687.8336, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0306, Accuracy: 216/557 (38.7792%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   2,  Average loss: 0.0211, Accuracy: 323/557 (57.9892%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   3,  Average loss: 0.0146, Accuracy: 406/557 (72.8905%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   4,  Average loss: 0.0131, Accuracy: 433/557 (77.7379%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   5,  Average loss: 0.0117, Accuracy: 432/557 (77.5583%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   6,  Average loss: 0.0108, Accuracy: 438/557 (78.6355%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   7,  Average loss: 0.0109, Accuracy: 438/557 (78.6355%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   8,  Average loss: 0.0098, Accuracy: 455/557 (81.6876%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   9,  Average loss: 0.0092, Accuracy: 454/557 (81.5081%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch  10,  Average loss: 0.0088, Accuracy: 456/557 (81.8671%), train_poison_data_count: 180
Global model norm: 58.999681374934134.
Norm before scaling: 58.94082829613421. Distance: 4.815463256100041
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.2968, Accuracy: 3491/10000 (34.9100%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0248, Accuracy: 8940/8968 (99.6878%)
Scaling by  100
Scaled Norm after poisoning: 482.0319621145469, distance: 481.5463373342175
Total norm for 4 adversaries is: 482.0319621145469. distance: 481.5463373342175
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 33560829.3809, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  14, local model 60, internal_epoch   1,  Average loss: 0.1454, Accuracy: 63/338 (18.6391%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.7118, Accuracy: 654/10000 (6.5400%)
___Train Local_Simple,  epoch  14, local model 42, internal_epoch   1,  Average loss: 0.0501, Accuracy: 50/236 (21.1864%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.6698, Accuracy: 1147/10000 (11.4700%)
___Train Local_Simple,  epoch  14, local model 85, internal_epoch   1,  Average loss: 0.0606, Accuracy: 65/431 (15.0812%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.5151, Accuracy: 911/10000 (9.1100%)
___Train Local_Simple,  epoch  14, local model 56, internal_epoch   1,  Average loss: 0.0399, Accuracy: 193/880 (21.9318%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.0294, Accuracy: 2837/10000 (28.3700%)
___Train Local_Simple,  epoch  14, local model 57, internal_epoch   1,  Average loss: 0.0442, Accuracy: 89/343 (25.9475%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.5017, Accuracy: 1068/10000 (10.6800%)
___Train Local_Simple,  epoch  14, local model 63, internal_epoch   1,  Average loss: 0.0422, Accuracy: 199/889 (22.3847%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.0695, Accuracy: 2636/10000 (26.3600%)
time spent on training: 100.34938740730286
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 3.3067, Accuracy: 2917/10000 (29.1700%)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 0.8514, Accuracy: 6479/8968 (72.2458%)
Done in 118.1487283706665 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:15 choose agents : [41, 73, 51, 74, 77, 18, 43, 91, 42, 52]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   1,  Average loss: 0.0142, Accuracy: 458/606 (75.5776%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   2,  Average loss: 0.0077, Accuracy: 533/606 (87.9538%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   3,  Average loss: 0.0063, Accuracy: 534/606 (88.1188%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   4,  Average loss: 0.0062, Accuracy: 541/606 (89.2739%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   5,  Average loss: 0.0055, Accuracy: 547/606 (90.2640%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   6,  Average loss: 0.0057, Accuracy: 539/606 (88.9439%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   7,  Average loss: 0.0049, Accuracy: 551/606 (90.9241%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   8,  Average loss: 0.0052, Accuracy: 544/606 (89.7690%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   9,  Average loss: 0.0042, Accuracy: 554/606 (91.4191%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch  10,  Average loss: 0.0046, Accuracy: 544/606 (89.7690%), train_poison_data_count: 200
Global model norm: 61.066677985266644.
Norm before scaling: 61.031396009169946. Distance: 5.7595202373338195
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.1662, Accuracy: 2953/10000 (29.5300%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0122, Accuracy: 8925/8968 (99.5205%)
Scaling by  100
Scaled Norm after poisoning: 575.9357060471247, distance: 575.9520379337155
Total norm for 4 adversaries is: 575.9357060471247. distance: 575.9520379337155
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   1,  Average loss: 0.0093, Accuracy: 484/591 (81.8951%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   2,  Average loss: 0.0066, Accuracy: 510/591 (86.2944%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   3,  Average loss: 0.0055, Accuracy: 528/591 (89.3401%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   4,  Average loss: 0.0054, Accuracy: 531/591 (89.8477%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   5,  Average loss: 0.0048, Accuracy: 540/591 (91.3706%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   6,  Average loss: 0.0041, Accuracy: 546/591 (92.3858%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   7,  Average loss: 0.0045, Accuracy: 537/591 (90.8629%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   8,  Average loss: 0.0040, Accuracy: 546/591 (92.3858%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   9,  Average loss: 0.0043, Accuracy: 546/591 (92.3858%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch  10,  Average loss: 0.0033, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Global model norm: 61.066677985266644.
Norm before scaling: 60.89827463496503. Distance: 3.3103410414901546
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.4995, Accuracy: 5384/10000 (53.8400%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0694, Accuracy: 8767/8968 (97.7587%)
Scaling by  100
Scaled Norm after poisoning: 331.9080492018836, distance: 331.0341159722061
Total norm for 4 adversaries is: 331.9080492018836. distance: 331.0341159722061
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 972084.9282, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   1,  Average loss: 0.0224, Accuracy: 338/568 (59.5070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   2,  Average loss: 0.0092, Accuracy: 476/568 (83.8028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   3,  Average loss: 0.0072, Accuracy: 499/568 (87.8521%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   4,  Average loss: 0.0060, Accuracy: 509/568 (89.6127%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   5,  Average loss: 0.0056, Accuracy: 513/568 (90.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   6,  Average loss: 0.0048, Accuracy: 516/568 (90.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   7,  Average loss: 0.0050, Accuracy: 516/568 (90.8451%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   8,  Average loss: 0.0039, Accuracy: 523/568 (92.0775%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   9,  Average loss: 0.0047, Accuracy: 520/568 (91.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch  10,  Average loss: 0.0041, Accuracy: 523/568 (92.0775%), train_poison_data_count: 180
Global model norm: 61.066677985266644.
Norm before scaling: 61.15073070073959. Distance: 6.8068345336439755
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.2530, Accuracy: 4382/10000 (43.8200%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0324, Accuracy: 8871/8968 (98.9184%)
Scaling by  100
Scaled Norm after poisoning: 680.7738473604873, distance: 680.6834341307272
Total norm for 4 adversaries is: 680.7738473604873. distance: 680.6834341307272
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 2405198.4690, Accuracy: 659/8968 (7.3483%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   1,  Average loss: 0.0190, Accuracy: 368/557 (66.0682%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   2,  Average loss: 0.0069, Accuracy: 485/557 (87.0736%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   3,  Average loss: 0.0049, Accuracy: 513/557 (92.1005%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   4,  Average loss: 0.0039, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   5,  Average loss: 0.0041, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   6,  Average loss: 0.0030, Accuracy: 526/557 (94.4345%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   7,  Average loss: 0.0033, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   8,  Average loss: 0.0025, Accuracy: 529/557 (94.9731%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   9,  Average loss: 0.0031, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch  10,  Average loss: 0.0029, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Global model norm: 61.066677985266644.
Norm before scaling: 61.00950873634371. Distance: 4.976793029332396
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.5162, Accuracy: 6747/10000 (67.4700%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0024, Accuracy: 8961/8968 (99.9219%)
Scaling by  100
Scaled Norm after poisoning: 498.23596631014107, distance: 497.67930186014365
Total norm for 4 adversaries is: 498.23596631014107. distance: 497.67930186014365
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 22729465.0794, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  15, local model 77, internal_epoch   1,  Average loss: 0.0350, Accuracy: 197/589 (33.4465%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.9954, Accuracy: 2903/10000 (29.0300%)
___Train Local_Simple,  epoch  15, local model 18, internal_epoch   1,  Average loss: 0.0359, Accuracy: 163/459 (35.5120%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.0941, Accuracy: 2507/10000 (25.0700%)
___Train Local_Simple,  epoch  15, local model 43, internal_epoch   1,  Average loss: 0.0475, Accuracy: 136/408 (33.3333%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.3518, Accuracy: 2326/10000 (23.2600%)
___Train Local_Simple,  epoch  15, local model 91, internal_epoch   1,  Average loss: 0.0410, Accuracy: 99/256 (38.6719%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.4661, Accuracy: 2662/10000 (26.6200%)
___Train Local_Simple,  epoch  15, local model 42, internal_epoch   1,  Average loss: 0.0481, Accuracy: 71/236 (30.0847%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.4490, Accuracy: 1637/10000 (16.3700%)
___Train Local_Simple,  epoch  15, local model 52, internal_epoch   1,  Average loss: 0.0509, Accuracy: 91/253 (35.9684%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.3806, Accuracy: 1649/10000 (16.4900%)
time spent on training: 102.96454405784607
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 7.6641, Accuracy: 1960/10000 (19.6000%)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 0.0221, Accuracy: 8908/8968 (99.3310%)
Done in 121.95429039001465 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:16 choose agents : [41, 73, 51, 74, 28, 37, 96, 99, 80, 13]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   1,  Average loss: 0.0218, Accuracy: 433/606 (71.4521%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   2,  Average loss: 0.0130, Accuracy: 490/606 (80.8581%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   3,  Average loss: 0.0093, Accuracy: 496/606 (81.8482%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   4,  Average loss: 0.0085, Accuracy: 505/606 (83.3333%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   5,  Average loss: 0.0086, Accuracy: 510/606 (84.1584%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   6,  Average loss: 0.0077, Accuracy: 510/606 (84.1584%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   7,  Average loss: 0.0074, Accuracy: 513/606 (84.6535%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   8,  Average loss: 0.0071, Accuracy: 519/606 (85.6436%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   9,  Average loss: 0.0069, Accuracy: 514/606 (84.8185%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch  10,  Average loss: 0.0064, Accuracy: 518/606 (85.4785%), train_poison_data_count: 200
Global model norm: 62.22969477756881.
Norm before scaling: 62.23905487049008. Distance: 7.575130035996469
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.7981, Accuracy: 2073/10000 (20.7300%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0041, Accuracy: 8960/8968 (99.9108%)
Scaling by  100
Scaled Norm after poisoning: 756.3575956516864, distance: 757.5130774448716
Total norm for 4 adversaries is: 756.3575956516864. distance: 757.5130774448716
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 38750955.4184, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   1,  Average loss: 0.0284, Accuracy: 411/591 (69.5431%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   2,  Average loss: 0.0114, Accuracy: 489/591 (82.7411%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   3,  Average loss: 0.0087, Accuracy: 508/591 (85.9560%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   4,  Average loss: 0.0081, Accuracy: 507/591 (85.7868%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   5,  Average loss: 0.0081, Accuracy: 503/591 (85.1100%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   6,  Average loss: 0.0081, Accuracy: 508/591 (85.9560%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   7,  Average loss: 0.0076, Accuracy: 509/591 (86.1252%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   8,  Average loss: 0.0071, Accuracy: 518/591 (87.6481%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   9,  Average loss: 0.0078, Accuracy: 514/591 (86.9712%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch  10,  Average loss: 0.0079, Accuracy: 516/591 (87.3096%), train_poison_data_count: 195
Global model norm: 62.22969477756881.
Norm before scaling: 62.71820892267851. Distance: 11.4251569006766
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.3857, Accuracy: 3440/10000 (34.4000%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0567, Accuracy: 8909/8968 (99.3421%)
Scaling by  100
Scaled Norm after poisoning: 1141.168315806218, distance: 1142.5158095186255
Total norm for 4 adversaries is: 1141.168315806218. distance: 1142.5158095186255
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 246281437.9447, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   1,  Average loss: 0.0219, Accuracy: 419/568 (73.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   2,  Average loss: 0.0121, Accuracy: 432/568 (76.0563%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   3,  Average loss: 0.0084, Accuracy: 476/568 (83.8028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   4,  Average loss: 0.0079, Accuracy: 488/568 (85.9155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   5,  Average loss: 0.0067, Accuracy: 488/568 (85.9155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   6,  Average loss: 0.0070, Accuracy: 484/568 (85.2113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   7,  Average loss: 0.0056, Accuracy: 503/568 (88.5563%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   8,  Average loss: 0.0058, Accuracy: 504/568 (88.7324%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   9,  Average loss: 0.0056, Accuracy: 507/568 (89.2606%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch  10,  Average loss: 0.0048, Accuracy: 521/568 (91.7254%), train_poison_data_count: 180
Global model norm: 62.22969477756881.
Norm before scaling: 62.177786615780235. Distance: 6.297533478869363
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.6729, Accuracy: 3951/10000 (39.5100%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0126, Accuracy: 8935/8968 (99.6320%)
Scaling by  100
Scaled Norm after poisoning: 629.1662637967805, distance: 629.7533743458624
Total norm for 4 adversaries is: 629.1662637967805. distance: 629.7533743458624
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 6054594.5825, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   1,  Average loss: 0.0243, Accuracy: 325/557 (58.3483%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   2,  Average loss: 0.0169, Accuracy: 421/557 (75.5835%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   3,  Average loss: 0.0132, Accuracy: 426/557 (76.4811%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   4,  Average loss: 0.0110, Accuracy: 436/557 (78.2765%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   5,  Average loss: 0.0099, Accuracy: 457/557 (82.0467%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   6,  Average loss: 0.0093, Accuracy: 467/557 (83.8420%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   7,  Average loss: 0.0091, Accuracy: 462/557 (82.9443%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   8,  Average loss: 0.0093, Accuracy: 463/557 (83.1239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   9,  Average loss: 0.0079, Accuracy: 472/557 (84.7397%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch  10,  Average loss: 0.0091, Accuracy: 467/557 (83.8420%), train_poison_data_count: 180
Global model norm: 62.22969477756881.
Norm before scaling: 62.07473876996483. Distance: 4.8559860727277
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.8281, Accuracy: 4960/10000 (49.6000%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0135, Accuracy: 8926/8968 (99.5317%)
Scaling by  100
Scaled Norm after poisoning: 485.17450146828617, distance: 485.59856749170916
Total norm for 4 adversaries is: 485.17450146828617. distance: 485.59856749170916
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 26191752.3390, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  16, local model 28, internal_epoch   1,  Average loss: 0.0568, Accuracy: 147/501 (29.3413%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.0545, Accuracy: 3420/10000 (34.2000%)
___Train Local_Simple,  epoch  16, local model 37, internal_epoch   1,  Average loss: 0.0251, Accuracy: 504/860 (58.6047%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 3.5902, Accuracy: 2777/10000 (27.7700%)
___Train Local_Simple,  epoch  16, local model 96, internal_epoch   1,  Average loss: 0.0458, Accuracy: 201/672 (29.9107%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.9719, Accuracy: 2523/10000 (25.2300%)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0507, Accuracy: 132/377 (35.0133%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 3.7242, Accuracy: 2560/10000 (25.6000%)
___Train Local_Simple,  epoch  16, local model 80, internal_epoch   1,  Average loss: 0.0683, Accuracy: 133/431 (30.8585%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 4.5933, Accuracy: 1791/10000 (17.9100%)
___Train Local_Simple,  epoch  16, local model 13, internal_epoch   1,  Average loss: 0.0385, Accuracy: 345/734 (47.0027%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.7890, Accuracy: 1357/10000 (13.5700%)
time spent on training: 98.68248867988586
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 51.4667, Accuracy: 2409/10000 (24.0900%)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 21.7058, Accuracy: 6972/8968 (77.7431%)
Done in 115.78813242912292 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:17 choose agents : [41, 73, 51, 74, 98, 78, 46, 45, 62, 50]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   1,  Average loss: 0.1833, Accuracy: 236/606 (38.9439%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   2,  Average loss: 0.0228, Accuracy: 253/606 (41.7492%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   3,  Average loss: 0.0206, Accuracy: 261/606 (43.0693%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   4,  Average loss: 0.0207, Accuracy: 244/606 (40.2640%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   5,  Average loss: 0.0194, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   6,  Average loss: 0.0205, Accuracy: 244/606 (40.2640%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   7,  Average loss: 0.0192, Accuracy: 278/606 (45.8746%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   8,  Average loss: 0.0198, Accuracy: 278/606 (45.8746%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   9,  Average loss: 0.0194, Accuracy: 282/606 (46.5347%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch  10,  Average loss: 0.0203, Accuracy: 280/606 (46.2046%), train_poison_data_count: 200
Global model norm: 66.26894260440746.
Norm before scaling: 78.39801047778572. Distance: 46.11572834067164
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 3.7156, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.7514, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 4608.014322894407, distance: 4611.572616797875
Total norm for 4 adversaries is: 4608.014322894407. distance: 4611.572616797875
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 1799880.5193, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   1,  Average loss: 0.1041, Accuracy: 344/591 (58.2064%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   2,  Average loss: 0.0295, Accuracy: 250/591 (42.3012%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   3,  Average loss: 0.0260, Accuracy: 192/591 (32.4873%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   4,  Average loss: 0.0248, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   5,  Average loss: 0.0246, Accuracy: 226/591 (38.2403%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   6,  Average loss: 0.0246, Accuracy: 227/591 (38.4095%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   7,  Average loss: 0.0234, Accuracy: 279/591 (47.2081%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   8,  Average loss: 0.0249, Accuracy: 214/591 (36.2098%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   9,  Average loss: 0.0250, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch  10,  Average loss: 0.0238, Accuracy: 183/591 (30.9645%), train_poison_data_count: 195
Global model norm: 66.26894260440746.
Norm before scaling: 73.66835390578169. Distance: 35.503130707573696
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 3.3816, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.9384, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 3547.7616887271333, distance: 3550.3132256182694
Total norm for 4 adversaries is: 3547.7616887271333. distance: 3550.3132256182694
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   1,  Average loss: 0.1572, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   2,  Average loss: 0.0217, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   3,  Average loss: 0.0214, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   4,  Average loss: 0.0216, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   5,  Average loss: 0.0205, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   6,  Average loss: 0.0210, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   7,  Average loss: 0.0214, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   8,  Average loss: 0.0221, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   9,  Average loss: 0.0209, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch  10,  Average loss: 0.0209, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Global model norm: 66.26894260440746.
Norm before scaling: 78.05027676520436. Distance: 44.818403932477196
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 3.4613, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.9225, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 4478.888701452627, distance: 4481.840247041387
Total norm for 4 adversaries is: 4478.888701452627. distance: 4481.840247041387
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 1233376.0425, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   1,  Average loss: 0.1114, Accuracy: 229/557 (41.1131%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   2,  Average loss: 0.0295, Accuracy: 174/557 (31.2388%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   3,  Average loss: 0.0270, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   4,  Average loss: 0.0275, Accuracy: 218/557 (39.1382%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   5,  Average loss: 0.0268, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   6,  Average loss: 0.0268, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   7,  Average loss: 0.0268, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   8,  Average loss: 0.0267, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   9,  Average loss: 0.0268, Accuracy: 215/557 (38.5996%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch  10,  Average loss: 0.0266, Accuracy: 227/557 (40.7540%), train_poison_data_count: 180
Global model norm: 66.26894260440746.
Norm before scaling: 69.95552437531292. Distance: 26.78426156309837
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 2.9398, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.9137, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 2675.2269062642144, distance: 2678.4262170162538
Total norm for 4 adversaries is: 2675.2269062642144. distance: 2678.4262170162538
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 424582.0553, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  17, local model 98, internal_epoch   1,  Average loss: 0.0677, Accuracy: 310/818 (37.8973%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 3.3050, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  17, local model 78, internal_epoch   1,  Average loss: 0.1209, Accuracy: 134/303 (44.2244%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 2.7330, Accuracy: 1135/10000 (11.3500%)
___Train Local_Simple,  epoch  17, local model 46, internal_epoch   1,  Average loss: 0.1260, Accuracy: 133/710 (18.7324%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 3.0262, Accuracy: 958/10000 (9.5800%)
___Train Local_Simple,  epoch  17, local model 45, internal_epoch   1,  Average loss: 0.1142, Accuracy: 183/628 (29.1401%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 3.0481, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  17, local model 62, internal_epoch   1,  Average loss: 0.1885, Accuracy: 82/423 (19.3853%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 2.5753, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  17, local model 50, internal_epoch   1,  Average loss: 0.1380, Accuracy: 123/474 (25.9494%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 3.0324, Accuracy: 1009/10000 (10.0900%)
time spent on training: 101.1053454875946
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 7.4417, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 0.0131, Accuracy: 8968/8968 (100.0000%)
Done in 121.14430856704712 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:18 choose agents : [41, 73, 51, 74, 67, 14, 36, 24, 7, 4]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   1,  Average loss: 0.1196, Accuracy: 193/606 (31.8482%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   2,  Average loss: 0.0226, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   3,  Average loss: 0.0243, Accuracy: 254/606 (41.9142%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   4,  Average loss: 0.0215, Accuracy: 278/606 (45.8746%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   5,  Average loss: 0.0207, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   6,  Average loss: 0.0201, Accuracy: 259/606 (42.7393%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   7,  Average loss: 0.0203, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   8,  Average loss: 0.0197, Accuracy: 286/606 (47.1947%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   9,  Average loss: 0.0201, Accuracy: 268/606 (44.2244%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch  10,  Average loss: 0.0199, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Global model norm: 152.11531270511526.
Norm before scaling: 151.97399037335302. Distance: 15.154336521447366
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 3.8507, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.7927, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 1514.0725709159385, distance: 1515.433683801439
Total norm for 4 adversaries is: 1514.0725709159385. distance: 1515.433683801439
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 1036575.2394, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   1,  Average loss: 0.0688, Accuracy: 152/591 (25.7191%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   2,  Average loss: 0.0329, Accuracy: 229/591 (38.7479%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   3,  Average loss: 0.0245, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   4,  Average loss: 0.0239, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   5,  Average loss: 0.0237, Accuracy: 216/591 (36.5482%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   6,  Average loss: 0.0239, Accuracy: 215/591 (36.3790%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   7,  Average loss: 0.0240, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   8,  Average loss: 0.0235, Accuracy: 276/591 (46.7005%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   9,  Average loss: 0.0242, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch  10,  Average loss: 0.0235, Accuracy: 273/591 (46.1929%), train_poison_data_count: 195
Global model norm: 152.11531270511526.
Norm before scaling: 151.7164038181106. Distance: 11.736842803919044
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 3.2663, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.9788, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1172.5096481479375, distance: 1173.684316586023
Total norm for 4 adversaries is: 1172.5096481479375. distance: 1173.684316586023
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 441.3838, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   1,  Average loss: 0.0546, Accuracy: 221/568 (38.9085%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   2,  Average loss: 0.0230, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   3,  Average loss: 0.0211, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   4,  Average loss: 0.0207, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   5,  Average loss: 0.0202, Accuracy: 246/568 (43.3099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   6,  Average loss: 0.0208, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   7,  Average loss: 0.0206, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   8,  Average loss: 0.0207, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   9,  Average loss: 0.0207, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch  10,  Average loss: 0.0211, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Global model norm: 152.11531270511526.
Norm before scaling: 151.62002774204996. Distance: 8.118512189640406
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 3.5315, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.9008, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 812.7775295245311, distance: 811.8512024995714
Total norm for 4 adversaries is: 812.7775295245311. distance: 811.8512024995714
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 592.1743, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   1,  Average loss: 0.0529, Accuracy: 156/557 (28.0072%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   2,  Average loss: 0.1138, Accuracy: 145/557 (26.0323%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   3,  Average loss: 0.0280, Accuracy: 227/557 (40.7540%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   4,  Average loss: 0.0271, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   5,  Average loss: 0.0265, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   6,  Average loss: 0.0267, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   7,  Average loss: 0.0263, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   8,  Average loss: 0.0263, Accuracy: 218/557 (39.1382%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   9,  Average loss: 0.0264, Accuracy: 227/557 (40.7540%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch  10,  Average loss: 0.0264, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Global model norm: 152.11531270511526.
Norm before scaling: 152.10875786341165. Distance: 15.734151465486379
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 2.9861, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.9106, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 1572.8377220806983, distance: 1573.4149961151381
Total norm for 4 adversaries is: 1572.8377220806983. distance: 1573.4149961151381
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 1039.1567, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  18, local model 67, internal_epoch   1,  Average loss: 0.0485, Accuracy: 205/998 (20.5411%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 4.7648, Accuracy: 1010/10000 (10.1000%)
___Train Local_Simple,  epoch  18, local model 14, internal_epoch   1,  Average loss: 0.0529, Accuracy: 142/376 (37.7660%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 2.8921, Accuracy: 1135/10000 (11.3500%)
___Train Local_Simple,  epoch  18, local model 36, internal_epoch   1,  Average loss: 0.0479, Accuracy: 242/1005 (24.0796%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 3.0564, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  18, local model 24, internal_epoch   1,  Average loss: 0.0727, Accuracy: 57/379 (15.0396%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 2.6889, Accuracy: 1135/10000 (11.3500%)
___Train Local_Simple,  epoch  18, local model 7, internal_epoch   1,  Average loss: 0.0746, Accuracy: 44/418 (10.5263%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 2.5073, Accuracy: 974/10000 (9.7400%)
___Train Local_Simple,  epoch  18, local model 4, internal_epoch   1,  Average loss: 0.0537, Accuracy: 131/658 (19.9088%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 2.9714, Accuracy: 1010/10000 (10.1000%)
time spent on training: 94.99577045440674
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 2.4086, Accuracy: 1009/10000 (10.0900%)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 3.1560, Accuracy: 0/8968 (0.0000%)
Done in 113.21860837936401 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:19 choose agents : [41, 73, 51, 74, 80, 39, 26, 29, 4, 42]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   1,  Average loss: 0.0354, Accuracy: 170/606 (28.0528%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   2,  Average loss: 0.0218, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   3,  Average loss: 0.0203, Accuracy: 268/606 (44.2244%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   4,  Average loss: 0.0207, Accuracy: 276/606 (45.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   5,  Average loss: 0.0198, Accuracy: 272/606 (44.8845%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   6,  Average loss: 0.0196, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   7,  Average loss: 0.0199, Accuracy: 270/606 (44.5545%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   8,  Average loss: 0.0191, Accuracy: 282/606 (46.5347%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   9,  Average loss: 0.0198, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch  10,  Average loss: 0.0195, Accuracy: 276/606 (45.5446%), train_poison_data_count: 200
Global model norm: 155.45297972779423.
Norm before scaling: 154.77457145393748. Distance: 3.2561682341225384
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 3.8134, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.7392, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 328.7637116912388, distance: 325.6168185152604
Total norm for 4 adversaries is: 328.7637116912388. distance: 325.6168185152604
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1992.5889, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   1,  Average loss: 0.0339, Accuracy: 244/591 (41.2860%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   2,  Average loss: 0.0246, Accuracy: 218/591 (36.8866%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   3,  Average loss: 0.0258, Accuracy: 203/591 (34.3486%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   4,  Average loss: 0.0243, Accuracy: 272/591 (46.0237%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   5,  Average loss: 0.0243, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   6,  Average loss: 0.0244, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   7,  Average loss: 0.0248, Accuracy: 255/591 (43.1472%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   8,  Average loss: 0.0248, Accuracy: 255/591 (43.1472%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   9,  Average loss: 0.0243, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch  10,  Average loss: 0.0239, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Global model norm: 155.45297972779423.
Norm before scaling: 154.7586957371055. Distance: 2.2996266808432924
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 3.2862, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.9239, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 234.48310840015748, distance: 229.96265831380103
Total norm for 4 adversaries is: 234.48310840015748. distance: 229.96265831380103
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   1,  Average loss: 0.0333, Accuracy: 227/568 (39.9648%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   2,  Average loss: 0.0227, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   3,  Average loss: 0.0220, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   4,  Average loss: 0.0216, Accuracy: 253/568 (44.5423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   5,  Average loss: 0.0217, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   6,  Average loss: 0.0208, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   7,  Average loss: 0.0210, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   8,  Average loss: 0.0210, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   9,  Average loss: 0.0209, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch  10,  Average loss: 0.0212, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Global model norm: 155.45297972779423.
Norm before scaling: 154.86019400575475. Distance: 2.560132305183454
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 3.6221, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.8470, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 265.8156815586695, distance: 256.01321377030524
Total norm for 4 adversaries is: 265.8156815586695. distance: 256.01321377030524
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   1,  Average loss: 0.0375, Accuracy: 76/557 (13.6445%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   2,  Average loss: 0.0290, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   3,  Average loss: 0.0277, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   4,  Average loss: 0.0273, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   5,  Average loss: 0.0263, Accuracy: 228/557 (40.9336%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   6,  Average loss: 0.0265, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   7,  Average loss: 0.0263, Accuracy: 216/557 (38.7792%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   8,  Average loss: 0.0266, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   9,  Average loss: 0.0266, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch  10,  Average loss: 0.0268, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Global model norm: 155.45297972779423.
Norm before scaling: 154.8535913875587. Distance: 2.5112972588124927
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 2.9336, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.9505, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 260.77097231095337, distance: 251.12972867623617
Total norm for 4 adversaries is: 260.77097231095337. distance: 251.12972867623617
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1625.6801, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  19, local model 80, internal_epoch   1,  Average loss: 0.0371, Accuracy: 120/431 (27.8422%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 2.6221, Accuracy: 1028/10000 (10.2800%)
___Train Local_Simple,  epoch  19, local model 39, internal_epoch   1,  Average loss: 0.0410, Accuracy: 27/257 (10.5058%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 2.4755, Accuracy: 1135/10000 (11.3500%)
___Train Local_Simple,  epoch  19, local model 26, internal_epoch   1,  Average loss: 0.0383, Accuracy: 104/554 (18.7726%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 2.6928, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  19, local model 29, internal_epoch   1,  Average loss: 0.0317, Accuracy: 367/1002 (36.6267%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 3.3438, Accuracy: 1135/10000 (11.3500%)
___Train Local_Simple,  epoch  19, local model 4, internal_epoch   1,  Average loss: 0.0318, Accuracy: 219/658 (33.2827%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 3.2017, Accuracy: 1010/10000 (10.1000%)
___Train Local_Simple,  epoch  19, local model 42, internal_epoch   1,  Average loss: 0.0432, Accuracy: 45/236 (19.0678%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 2.3537, Accuracy: 1009/10000 (10.0900%)
time spent on training: 100.64003586769104
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 16.3821, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
Done in 120.50986075401306 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:20 choose agents : [41, 73, 51, 74, 69, 95, 80, 8, 25, 68]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   1,  Average loss: 0.0826, Accuracy: 263/606 (43.3993%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   2,  Average loss: 0.0277, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   3,  Average loss: 0.0292, Accuracy: 265/606 (43.7294%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   4,  Average loss: 0.0278, Accuracy: 270/606 (44.5545%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   5,  Average loss: 0.0262, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   6,  Average loss: 0.0246, Accuracy: 267/606 (44.0594%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   7,  Average loss: 0.0229, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   8,  Average loss: 0.0214, Accuracy: 284/606 (46.8647%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   9,  Average loss: 0.0217, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch  10,  Average loss: 0.0215, Accuracy: 280/606 (46.2046%), train_poison_data_count: 200
Global model norm: 152.9961256147521.
Norm before scaling: 152.1887256110813. Distance: 5.999208080164525
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 3.1485, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.6088, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 595.8801263677117, distance: 599.9207760196341
Total norm for 4 adversaries is: 595.8801263677117. distance: 599.9207760196341
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 158.1465, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   1,  Average loss: 0.1011, Accuracy: 226/591 (38.2403%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   2,  Average loss: 0.0355, Accuracy: 205/591 (34.6870%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   3,  Average loss: 0.0383, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   4,  Average loss: 0.0353, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   5,  Average loss: 0.0318, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   6,  Average loss: 0.0297, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   7,  Average loss: 0.0282, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   8,  Average loss: 0.0269, Accuracy: 181/591 (30.6261%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   9,  Average loss: 0.0260, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch  10,  Average loss: 0.0263, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Global model norm: 152.9961256147521.
Norm before scaling: 152.21213224682518. Distance: 7.431958353917575
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 2.6945, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 1.2444, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 739.1184360439131, distance: 743.1958860219828
Total norm for 4 adversaries is: 739.1184360439131. distance: 743.1958860219828
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 205.3638, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   1,  Average loss: 0.0829, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   2,  Average loss: 0.0364, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   3,  Average loss: 0.0323, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   4,  Average loss: 0.0304, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   5,  Average loss: 0.0278, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   6,  Average loss: 0.0264, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   7,  Average loss: 0.0245, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   8,  Average loss: 0.0237, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   9,  Average loss: 0.0234, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch  10,  Average loss: 0.0228, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Global model norm: 152.9961256147521.
Norm before scaling: 152.29543144001397. Distance: 6.3079838980576275
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 2.8723, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.9921, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 629.240415103798, distance: 630.7983780495952
Total norm for 4 adversaries is: 629.240415103798. distance: 630.7983780495952
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 157.7731, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   1,  Average loss: 0.0968, Accuracy: 183/557 (32.8546%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   2,  Average loss: 0.0402, Accuracy: 132/557 (23.6984%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   3,  Average loss: 0.0316, Accuracy: 216/557 (38.7792%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   4,  Average loss: 0.0302, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   5,  Average loss: 0.0290, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   6,  Average loss: 0.0281, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   7,  Average loss: 0.0281, Accuracy: 217/557 (38.9587%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   8,  Average loss: 0.0276, Accuracy: 218/557 (39.1382%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   9,  Average loss: 0.0272, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch  10,  Average loss: 0.0278, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Global model norm: 152.9961256147521.
Norm before scaling: 152.3002405817207. Distance: 6.957668919926875
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 2.6834, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 1.1062, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 693.8394311726597, distance: 695.7668655878922
Total norm for 4 adversaries is: 693.8394311726597. distance: 695.7668655878922
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 114.5318, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  20, local model 69, internal_epoch   1,  Average loss: 0.1641, Accuracy: 35/256 (13.6719%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 4.9351, Accuracy: 974/10000 (9.7400%)
___Train Local_Simple,  epoch  20, local model 95, internal_epoch   1,  Average loss: 0.0863, Accuracy: 272/602 (45.1827%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 2.8705, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  20, local model 80, internal_epoch   1,  Average loss: 0.1166, Accuracy: 125/431 (29.0023%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 4.9166, Accuracy: 1028/10000 (10.2800%)
___Train Local_Simple,  epoch  20, local model 8, internal_epoch   1,  Average loss: 0.0844, Accuracy: 118/633 (18.6414%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 2.5858, Accuracy: 1135/10000 (11.3500%)
___Train Local_Simple,  epoch  20, local model 25, internal_epoch   1,  Average loss: 0.0767, Accuracy: 211/647 (32.6121%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 2.6580, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  20, local model 68, internal_epoch   1,  Average loss: 0.1067, Accuracy: 52/494 (10.5263%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 3.8343, Accuracy: 982/10000 (9.8200%)
time spent on training: 104.65272736549377
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 2.5302, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 2.1812, Accuracy: 0/8968 (0.0000%)
Done in 124.33746409416199 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:21 choose agents : [41, 73, 51, 74, 70, 61, 64, 31, 10, 23]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0329, Accuracy: 42/606 (6.9307%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: 0.0244, Accuracy: 280/606 (46.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: 0.0220, Accuracy: 269/606 (44.3894%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: 0.0212, Accuracy: 265/606 (43.7294%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: 0.0211, Accuracy: 270/606 (44.5545%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: 0.0206, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: 0.0215, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: 0.0213, Accuracy: 279/606 (46.0396%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: 0.0206, Accuracy: 266/606 (43.8944%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: 0.0203, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Global model norm: 151.63588429606628.
Norm before scaling: 150.97511824179838. Distance: 3.0134046217269934
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 3.1044, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.8869, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 304.78848967357675, distance: 301.3404558178341
Total norm for 4 adversaries is: 304.78848967357675. distance: 301.3404558178341
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   1,  Average loss: 0.0316, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   2,  Average loss: 0.0271, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   3,  Average loss: 0.0253, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   4,  Average loss: 0.0254, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   5,  Average loss: 0.0253, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   6,  Average loss: 0.0253, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   7,  Average loss: 0.0254, Accuracy: 260/591 (43.9932%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   8,  Average loss: 0.0248, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   9,  Average loss: 0.0249, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch  10,  Average loss: 0.0250, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Global model norm: 151.63588429606628.
Norm before scaling: 150.96676734881092. Distance: 2.212446472899803
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 2.9435, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 1.0819, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 226.28643525684433, distance: 221.24465035905388
Total norm for 4 adversaries is: 226.28643525684433. distance: 221.24465035905388
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   1,  Average loss: 0.0288, Accuracy: 145/568 (25.5282%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   2,  Average loss: 0.0243, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   3,  Average loss: 0.0224, Accuracy: 227/568 (39.9648%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   4,  Average loss: 0.0220, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   5,  Average loss: 0.0221, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   6,  Average loss: 0.0219, Accuracy: 227/568 (39.9648%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   7,  Average loss: 0.0218, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   8,  Average loss: 0.0223, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   9,  Average loss: 0.0218, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch  10,  Average loss: 0.0221, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Global model norm: 151.63588429606628.
Norm before scaling: 151.06008867541752. Distance: 2.2088207450724253
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 2.9538, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 1.0426, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 232.08915312870613, distance: 220.88207402367445
Total norm for 4 adversaries is: 232.08915312870613. distance: 220.88207402367445
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   1,  Average loss: 0.0370, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   2,  Average loss: 0.0313, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   3,  Average loss: 0.0287, Accuracy: 227/557 (40.7540%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   4,  Average loss: 0.0287, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   5,  Average loss: 0.0285, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   6,  Average loss: 0.0284, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   7,  Average loss: 0.0280, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   8,  Average loss: 0.0281, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   9,  Average loss: 0.0281, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch  10,  Average loss: 0.0279, Accuracy: 228/557 (40.9336%), train_poison_data_count: 180
Global model norm: 151.63588429606628.
Norm before scaling: 151.0460272359058. Distance: 2.4368272488756846
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 2.6598, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.9701, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 252.83812447394084, distance: 243.6827150722841
Total norm for 4 adversaries is: 252.83812447394084. distance: 243.6827150722841
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  21, local model 70, internal_epoch   1,  Average loss: 0.0399, Accuracy: 61/724 (8.4254%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 2.4722, Accuracy: 974/10000 (9.7400%)
___Train Local_Simple,  epoch  21, local model 61, internal_epoch   1,  Average loss: 0.0319, Accuracy: 193/699 (27.6109%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 2.6369, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  21, local model 64, internal_epoch   1,  Average loss: 0.0386, Accuracy: 126/813 (15.4982%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 2.4659, Accuracy: 974/10000 (9.7400%)
___Train Local_Simple,  epoch  21, local model 31, internal_epoch   1,  Average loss: 0.0329, Accuracy: 279/835 (33.4132%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 2.6433, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  21, local model 10, internal_epoch   1,  Average loss: 0.0267, Accuracy: 399/892 (44.7309%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 3.0388, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  21, local model 23, internal_epoch   1,  Average loss: 0.0421, Accuracy: 9/293 (3.0717%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 2.4699, Accuracy: 980/10000 (9.8000%)
time spent on training: 101.95733451843262
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 6.6279, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 0.0064, Accuracy: 8968/8968 (100.0000%)
Done in 123.54458165168762 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:22 choose agents : [41, 73, 51, 74, 7, 46, 65, 57, 83, 9]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   1,  Average loss: 0.0537, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   2,  Average loss: 0.0333, Accuracy: 279/606 (46.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   3,  Average loss: 0.0220, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   4,  Average loss: 0.0209, Accuracy: 277/606 (45.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   5,  Average loss: 0.0210, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   6,  Average loss: 0.0211, Accuracy: 281/606 (46.3696%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   7,  Average loss: 0.0201, Accuracy: 269/606 (44.3894%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   8,  Average loss: 0.0202, Accuracy: 278/606 (45.8746%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   9,  Average loss: 0.0208, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch  10,  Average loss: 0.0206, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Global model norm: 149.19629739457343.
Norm before scaling: 148.4285063064875. Distance: 4.466193261372016
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 3.8242, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.6797, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 443.7143823733912, distance: 446.61929747269096
Total norm for 4 adversaries is: 443.7143823733912. distance: 446.61929747269096
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 606.3751, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   1,  Average loss: 0.0717, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   2,  Average loss: 0.0439, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   3,  Average loss: 0.0269, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   4,  Average loss: 0.0270, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   5,  Average loss: 0.0262, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   6,  Average loss: 0.0258, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   7,  Average loss: 0.0250, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   8,  Average loss: 0.0253, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   9,  Average loss: 0.0242, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch  10,  Average loss: 0.0252, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Global model norm: 149.19629739457343.
Norm before scaling: 148.40002816500743. Distance: 5.271920173781616
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 3.2567, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.8339, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 523.1777601829039, distance: 527.1919716763524
Total norm for 4 adversaries is: 523.1777601829039. distance: 527.1919716763524
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 715.3342, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   1,  Average loss: 0.0634, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   2,  Average loss: 0.0410, Accuracy: 245/568 (43.1338%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   3,  Average loss: 0.0281, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   4,  Average loss: 0.0270, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   5,  Average loss: 0.0256, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   6,  Average loss: 0.0239, Accuracy: 241/568 (42.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   7,  Average loss: 0.0235, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   8,  Average loss: 0.0226, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   9,  Average loss: 0.0220, Accuracy: 245/568 (43.1338%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch  10,  Average loss: 0.0222, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Global model norm: 149.19629739457343.
Norm before scaling: 148.4998158668892. Distance: 4.784126363979982
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 3.4365, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.5864, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 477.61415520271174, distance: 478.4126585647583
Total norm for 4 adversaries is: 477.61415520271174. distance: 478.4126585647583
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 652.1679, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   1,  Average loss: 0.0648, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   2,  Average loss: 0.0473, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   3,  Average loss: 0.0350, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   4,  Average loss: 0.0336, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   5,  Average loss: 0.0315, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   6,  Average loss: 0.0305, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   7,  Average loss: 0.0298, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   8,  Average loss: 0.0286, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   9,  Average loss: 0.0286, Accuracy: 228/557 (40.9336%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch  10,  Average loss: 0.0286, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Global model norm: 149.19629739457343.
Norm before scaling: 148.48595919522154. Distance: 4.519487781365075
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 3.1681, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.5122, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 450.92022229547433, distance: 451.9488010272845
Total norm for 4 adversaries is: 450.92022229547433. distance: 451.9488010272845
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 539.3176, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  22, local model 7, internal_epoch   1,  Average loss: 0.0972, Accuracy: 63/418 (15.0718%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 4.7574, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  22, local model 46, internal_epoch   1,  Average loss: 0.0857, Accuracy: 78/710 (10.9859%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 2.7255, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  22, local model 65, internal_epoch   1,  Average loss: 0.1087, Accuracy: 5/371 (1.3477%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 4.9242, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  22, local model 57, internal_epoch   1,  Average loss: 0.0804, Accuracy: 113/343 (32.9446%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 5.4629, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  22, local model 83, internal_epoch   1,  Average loss: 0.0895, Accuracy: 77/433 (17.7829%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 4.7880, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  22, local model 9, internal_epoch   1,  Average loss: 0.1011, Accuracy: 7/436 (1.6055%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 4.4579, Accuracy: 1032/10000 (10.3200%)
time spent on training: 103.08812284469604
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 4.3678, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 13.2955, Accuracy: 0/8968 (0.0000%)
Done in 121.77831625938416 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:23 choose agents : [41, 73, 51, 74, 64, 58, 12, 83, 96, 90]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   1,  Average loss: 0.1130, Accuracy: 104/606 (17.1617%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   2,  Average loss: 0.0972, Accuracy: 247/606 (40.7591%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   3,  Average loss: 0.0850, Accuracy: 261/606 (43.0693%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   4,  Average loss: 0.0843, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   5,  Average loss: 0.0831, Accuracy: 247/606 (40.7591%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   6,  Average loss: 0.0768, Accuracy: 261/606 (43.0693%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   7,  Average loss: 0.0786, Accuracy: 247/606 (40.7591%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   8,  Average loss: 0.0760, Accuracy: 248/606 (40.9241%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   9,  Average loss: 0.0733, Accuracy: 254/606 (41.9142%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch  10,  Average loss: 0.0736, Accuracy: 245/606 (40.4290%), train_poison_data_count: 200
Global model norm: 146.8730252526821.
Norm before scaling: 145.95082246470898. Distance: 4.9411030431308465
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.4978, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 8.2363, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 486.07704186167854, distance: 494.110295758953
Total norm for 4 adversaries is: 486.07704186167854. distance: 494.110295758953
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   1,  Average loss: 0.1022, Accuracy: 275/591 (46.5313%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   2,  Average loss: 0.0913, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   3,  Average loss: 0.0848, Accuracy: 256/591 (43.3164%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   4,  Average loss: 0.0830, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   5,  Average loss: 0.0803, Accuracy: 272/591 (46.0237%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   6,  Average loss: 0.0783, Accuracy: 275/591 (46.5313%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   7,  Average loss: 0.0773, Accuracy: 273/591 (46.1929%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   8,  Average loss: 0.0756, Accuracy: 278/591 (47.0389%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   9,  Average loss: 0.0753, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch  10,  Average loss: 0.0740, Accuracy: 276/591 (46.7005%), train_poison_data_count: 195
Global model norm: 146.8730252526821.
Norm before scaling: 145.98013964877208. Distance: 4.1016896836679875
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.5693, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 9.1170, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 402.4666717568052, distance: 410.1689628982183
Total norm for 4 adversaries is: 402.4666717568052. distance: 410.1689628982183
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   1,  Average loss: 0.1000, Accuracy: 143/568 (25.1761%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   2,  Average loss: 0.0874, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   3,  Average loss: 0.0811, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   4,  Average loss: 0.0797, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   5,  Average loss: 0.0782, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   6,  Average loss: 0.0761, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   7,  Average loss: 0.0739, Accuracy: 243/568 (42.7817%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   8,  Average loss: 0.0743, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   9,  Average loss: 0.0732, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch  10,  Average loss: 0.0755, Accuracy: 223/568 (39.2606%), train_poison_data_count: 180
Global model norm: 146.8730252526821.
Norm before scaling: 146.08217534362294. Distance: 3.884165967379097
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.6673, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 9.3390, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 384.39831230118585, distance: 388.4165571586773
Total norm for 4 adversaries is: 384.39831230118585. distance: 388.4165571586773
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   1,  Average loss: 0.1136, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   2,  Average loss: 0.0985, Accuracy: 29/557 (5.2065%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   3,  Average loss: 0.0848, Accuracy: 124/557 (22.2621%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   4,  Average loss: 0.0845, Accuracy: 126/557 (22.6212%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   5,  Average loss: 0.0826, Accuracy: 129/557 (23.1598%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   6,  Average loss: 0.0806, Accuracy: 120/557 (21.5440%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   7,  Average loss: 0.0805, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   8,  Average loss: 0.0784, Accuracy: 122/557 (21.9031%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   9,  Average loss: 0.0766, Accuracy: 130/557 (23.3393%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch  10,  Average loss: 0.0775, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Global model norm: 146.8730252526821.
Norm before scaling: 146.07266224810857. Distance: 4.525966958269651
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.3229, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 9.1023, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 448.24173862994957, distance: 452.596692017297
Total norm for 4 adversaries is: 448.24173862994957. distance: 452.596692017297
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  23, local model 64, internal_epoch   1,  Average loss: 0.0692, Accuracy: 104/813 (12.7921%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.5054, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  23, local model 58, internal_epoch   1,  Average loss: 0.0976, Accuracy: 0/276 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.0885, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  23, local model 12, internal_epoch   1,  Average loss: 0.0529, Accuracy: 390/1160 (33.6207%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.7645, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  23, local model 83, internal_epoch   1,  Average loss: 0.0777, Accuracy: 46/433 (10.6236%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.0055, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  23, local model 96, internal_epoch   1,  Average loss: 0.0706, Accuracy: 231/672 (34.3750%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.8056, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  23, local model 90, internal_epoch   1,  Average loss: 0.0549, Accuracy: 73/683 (10.6881%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.7107, Accuracy: 1009/10000 (10.0900%)
time spent on training: 97.76958560943604
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 5.1288, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 0.0497, Accuracy: 8968/8968 (100.0000%)
Done in 115.94271969795227 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:24 choose agents : [41, 73, 51, 74, 28, 65, 33, 75, 13, 32]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   1,  Average loss: 0.0544, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   2,  Average loss: 0.0375, Accuracy: 272/606 (44.8845%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   3,  Average loss: 0.0263, Accuracy: 279/606 (46.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   4,  Average loss: 0.0265, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   5,  Average loss: 0.0255, Accuracy: 283/606 (46.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   6,  Average loss: 0.0257, Accuracy: 266/606 (43.8944%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   7,  Average loss: 0.0248, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   8,  Average loss: 0.0240, Accuracy: 277/606 (45.7096%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   9,  Average loss: 0.0233, Accuracy: 282/606 (46.5347%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch  10,  Average loss: 0.0239, Accuracy: 269/606 (44.3894%), train_poison_data_count: 200
Global model norm: 144.1171872882447.
Norm before scaling: 143.38288039590012. Distance: 4.399114146790153
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.1194, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.7825, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 437.31578264453253, distance: 439.9113902253498
Total norm for 4 adversaries is: 437.31578264453253. distance: 439.9113902253498
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 597.4748, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   1,  Average loss: 0.0674, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   2,  Average loss: 0.0463, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   3,  Average loss: 0.0339, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   4,  Average loss: 0.0328, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   5,  Average loss: 0.0318, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   6,  Average loss: 0.0308, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   7,  Average loss: 0.0296, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   8,  Average loss: 0.0294, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   9,  Average loss: 0.0289, Accuracy: 196/591 (33.1641%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch  10,  Average loss: 0.0284, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Global model norm: 144.1171872882447.
Norm before scaling: 143.3613223641579. Distance: 4.906153198064739
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.8038, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.9460, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 487.1717805353672, distance: 490.61531837581265
Total norm for 4 adversaries is: 487.1717805353672. distance: 490.61531837581265
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 667.8614, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   1,  Average loss: 0.0589, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   2,  Average loss: 0.0435, Accuracy: 226/568 (39.7887%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   3,  Average loss: 0.0316, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   4,  Average loss: 0.0310, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   5,  Average loss: 0.0297, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   6,  Average loss: 0.0291, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   7,  Average loss: 0.0277, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   8,  Average loss: 0.0277, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   9,  Average loss: 0.0265, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch  10,  Average loss: 0.0275, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Global model norm: 144.1171872882447.
Norm before scaling: 143.4575217507782. Distance: 4.322709093127664
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.9389, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.7681, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 432.19067695867756, distance: 432.27091114832143
Total norm for 4 adversaries is: 432.19067695867756. distance: 432.27091114832143
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 591.3172, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   1,  Average loss: 0.0435, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   2,  Average loss: 0.0321, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   3,  Average loss: 0.0287, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   4,  Average loss: 0.0282, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   5,  Average loss: 0.0278, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   6,  Average loss: 0.0279, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   7,  Average loss: 0.0269, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   8,  Average loss: 0.0269, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   9,  Average loss: 0.0273, Accuracy: 228/557 (40.9336%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch  10,  Average loss: 0.0279, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Global model norm: 144.1171872882447.
Norm before scaling: 143.489641938887. Distance: 3.060269691949286
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.2707, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.8681, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 308.9286552951992, distance: 306.0269723610976
Total norm for 4 adversaries is: 308.9286552951992. distance: 306.0269723610976
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 364.3835, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  24, local model 28, internal_epoch   1,  Average loss: 0.0765, Accuracy: 10/501 (1.9960%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.1627, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0934, Accuracy: 5/371 (1.3477%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.7011, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  24, local model 33, internal_epoch   1,  Average loss: 0.0711, Accuracy: 0/623 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.8355, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  24, local model 75, internal_epoch   1,  Average loss: 0.0646, Accuracy: 10/686 (1.4577%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.8858, Accuracy: 1028/10000 (10.2800%)
___Train Local_Simple,  epoch  24, local model 13, internal_epoch   1,  Average loss: 0.0623, Accuracy: 74/734 (10.0817%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.1616, Accuracy: 1028/10000 (10.2800%)
___Train Local_Simple,  epoch  24, local model 32, internal_epoch   1,  Average loss: 0.0588, Accuracy: 93/977 (9.5189%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.9502, Accuracy: 1010/10000 (10.1000%)
time spent on training: 99.64251279830933
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 3.5772, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 10.2599, Accuracy: 0/8968 (0.0000%)
Done in 115.08942246437073 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:25 choose agents : [41, 73, 51, 74, 80, 23, 25, 12, 58, 19]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   1,  Average loss: 0.0894, Accuracy: 82/606 (13.5314%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   2,  Average loss: 0.0725, Accuracy: 263/606 (43.3993%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   3,  Average loss: 0.0637, Accuracy: 257/606 (42.4092%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   4,  Average loss: 0.0638, Accuracy: 248/606 (40.9241%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   5,  Average loss: 0.0610, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   6,  Average loss: 0.0595, Accuracy: 245/606 (40.4290%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   7,  Average loss: 0.0563, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   8,  Average loss: 0.0553, Accuracy: 248/606 (40.9241%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   9,  Average loss: 0.0536, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch  10,  Average loss: 0.0546, Accuracy: 246/606 (40.5941%), train_poison_data_count: 200
Global model norm: 141.7336231170113.
Norm before scaling: 140.92516575739765. Distance: 4.756915629625256
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.0091, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 5.5526, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 470.37923529849826, distance: 475.6915525054024
Total norm for 4 adversaries is: 470.37923529849826. distance: 475.6915525054024
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0818, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   2,  Average loss: 0.0716, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   3,  Average loss: 0.0648, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   4,  Average loss: 0.0632, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   5,  Average loss: 0.0617, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   6,  Average loss: 0.0599, Accuracy: 274/591 (46.3621%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   7,  Average loss: 0.0585, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   8,  Average loss: 0.0572, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   9,  Average loss: 0.0562, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch  10,  Average loss: 0.0566, Accuracy: 258/591 (43.6548%), train_poison_data_count: 195
Global model norm: 141.7336231170113.
Norm before scaling: 140.94056260530536. Distance: 3.91049366656533
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.0551, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 6.3693, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 386.084653120271, distance: 391.0493694854909
Total norm for 4 adversaries is: 386.084653120271. distance: 391.0493694854909
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   1,  Average loss: 0.0796, Accuracy: 108/568 (19.0141%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   2,  Average loss: 0.0684, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   3,  Average loss: 0.0625, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   4,  Average loss: 0.0617, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   5,  Average loss: 0.0608, Accuracy: 226/568 (39.7887%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   6,  Average loss: 0.0583, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   7,  Average loss: 0.0571, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   8,  Average loss: 0.0567, Accuracy: 227/568 (39.9648%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   9,  Average loss: 0.0550, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch  10,  Average loss: 0.0559, Accuracy: 223/568 (39.2606%), train_poison_data_count: 180
Global model norm: 141.7336231170113.
Norm before scaling: 141.03436250166126. Distance: 3.774153805306026
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.1212, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 6.5796, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 375.9435005755519, distance: 377.41536716858786
Total norm for 4 adversaries is: 375.9435005755519. distance: 377.41536716858786
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0908, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   2,  Average loss: 0.0766, Accuracy: 30/557 (5.3860%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   3,  Average loss: 0.0667, Accuracy: 129/557 (23.1598%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   4,  Average loss: 0.0652, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   5,  Average loss: 0.0645, Accuracy: 124/557 (22.2621%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   6,  Average loss: 0.0631, Accuracy: 123/557 (22.0826%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   7,  Average loss: 0.0611, Accuracy: 129/557 (23.1598%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   8,  Average loss: 0.0595, Accuracy: 133/557 (23.8779%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   9,  Average loss: 0.0583, Accuracy: 124/557 (22.2621%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch  10,  Average loss: 0.0588, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Global model norm: 141.7336231170113.
Norm before scaling: 141.02558915627688. Distance: 4.205291303235527
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.8536, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 6.3548, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 418.5025014859529, distance: 420.529130976678
Total norm for 4 adversaries is: 418.5025014859529. distance: 420.529130976678
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  25, local model 80, internal_epoch   1,  Average loss: 0.0588, Accuracy: 33/431 (7.6566%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.2522, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  25, local model 23, internal_epoch   1,  Average loss: 0.0528, Accuracy: 9/293 (3.0717%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.4160, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  25, local model 25, internal_epoch   1,  Average loss: 0.0858, Accuracy: 112/647 (17.3107%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.1347, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  25, local model 12, internal_epoch   1,  Average loss: 0.0424, Accuracy: 385/1160 (33.1897%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.4127, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  25, local model 58, internal_epoch   1,  Average loss: 0.0768, Accuracy: 0/276 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.3831, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  25, local model 19, internal_epoch   1,  Average loss: 0.0707, Accuracy: 0/205 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.5004, Accuracy: 892/10000 (8.9200%)
time spent on training: 97.56831741333008
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 7.2693, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 0.0034, Accuracy: 8968/8968 (100.0000%)
Done in 114.63226079940796 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:26 choose agents : [41, 73, 51, 74, 11, 13, 82, 50, 34, 14]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   1,  Average loss: 0.0724, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   2,  Average loss: 0.0506, Accuracy: 269/606 (44.3894%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   3,  Average loss: 0.0319, Accuracy: 283/606 (46.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   4,  Average loss: 0.0296, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   5,  Average loss: 0.0284, Accuracy: 267/606 (44.0594%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   6,  Average loss: 0.0264, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   7,  Average loss: 0.0247, Accuracy: 270/606 (44.5545%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   8,  Average loss: 0.0241, Accuracy: 265/606 (43.7294%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   9,  Average loss: 0.0235, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch  10,  Average loss: 0.0237, Accuracy: 268/606 (44.2244%), train_poison_data_count: 200
Global model norm: 139.33058429056413.
Norm before scaling: 138.5378445588064. Distance: 5.577440064850715
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.5063, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.4710, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 552.5872668637959, distance: 557.7439768836595
Total norm for 4 adversaries is: 552.5872668637959. distance: 557.7439768836595
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 765.9896, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   1,  Average loss: 0.0890, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   2,  Average loss: 0.0604, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   3,  Average loss: 0.0384, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   4,  Average loss: 0.0356, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   5,  Average loss: 0.0336, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   6,  Average loss: 0.0314, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   7,  Average loss: 0.0299, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   8,  Average loss: 0.0284, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   9,  Average loss: 0.0277, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch  10,  Average loss: 0.0277, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Global model norm: 139.33058429056413.
Norm before scaling: 138.5090038251124. Distance: 6.137835385856886
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.0260, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.5867, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 607.9054973842563, distance: 613.7835275974747
Total norm for 4 adversaries is: 607.9054973842563. distance: 613.7835275974747
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 839.2520, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   1,  Average loss: 0.0740, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   2,  Average loss: 0.0548, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   3,  Average loss: 0.0379, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   4,  Average loss: 0.0345, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   5,  Average loss: 0.0324, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   6,  Average loss: 0.0306, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   7,  Average loss: 0.0286, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   8,  Average loss: 0.0269, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   9,  Average loss: 0.0264, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch  10,  Average loss: 0.0262, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Global model norm: 139.33058429056413.
Norm before scaling: 138.621815788497. Distance: 5.2404620405142985
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.5075, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.3857, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 521.1437241778893, distance: 524.0462169503754
Total norm for 4 adversaries is: 521.1437241778893. distance: 524.0462169503754
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 715.5521, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   1,  Average loss: 0.0684, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   2,  Average loss: 0.0505, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   3,  Average loss: 0.0369, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   4,  Average loss: 0.0340, Accuracy: 229/557 (41.1131%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   5,  Average loss: 0.0334, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   6,  Average loss: 0.0312, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   7,  Average loss: 0.0303, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   8,  Average loss: 0.0293, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   9,  Average loss: 0.0292, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch  10,  Average loss: 0.0288, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Global model norm: 139.33058429056413.
Norm before scaling: 138.63560881407778. Distance: 4.721618588830389
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.5355, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.4390, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 469.8963316519932, distance: 472.1618829914164
Total norm for 4 adversaries is: 469.8963316519932. distance: 472.1618829914164
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 567.9706, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  26, local model 11, internal_epoch   1,  Average loss: 0.1057, Accuracy: 2/645 (0.3101%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.1128, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  26, local model 13, internal_epoch   1,  Average loss: 0.0894, Accuracy: 30/734 (4.0872%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.2184, Accuracy: 1028/10000 (10.2800%)
___Train Local_Simple,  epoch  26, local model 82, internal_epoch   1,  Average loss: 0.1005, Accuracy: 4/713 (0.5610%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.8138, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  26, local model 50, internal_epoch   1,  Average loss: 0.1153, Accuracy: 27/474 (5.6962%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.6511, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  26, local model 34, internal_epoch   1,  Average loss: 0.1125, Accuracy: 51/413 (12.3487%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 5.3199, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0553, Accuracy: 194/376 (51.5957%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 6.4145, Accuracy: 1032/10000 (10.3200%)
time spent on training: 101.33703064918518
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 4.0010, Accuracy: 1009/10000 (10.0900%)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 14.3122, Accuracy: 0/8968 (0.0000%)
Done in 118.44295501708984 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:27 choose agents : [41, 73, 51, 74, 55, 58, 53, 14, 36, 6]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   1,  Average loss: 0.1200, Accuracy: 94/606 (15.5116%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   2,  Average loss: 0.1074, Accuracy: 247/606 (40.7591%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   3,  Average loss: 0.0965, Accuracy: 245/606 (40.4290%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   4,  Average loss: 0.0948, Accuracy: 247/606 (40.7591%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   5,  Average loss: 0.0929, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   6,  Average loss: 0.0907, Accuracy: 245/606 (40.4290%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   7,  Average loss: 0.0875, Accuracy: 251/606 (41.4191%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   8,  Average loss: 0.0849, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   9,  Average loss: 0.0858, Accuracy: 247/606 (40.7591%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch  10,  Average loss: 0.0845, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Global model norm: 137.207302101601.
Norm before scaling: 136.28923603636127. Distance: 4.807676994886221
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.4500, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 9.5702, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 471.744717114034, distance: 480.76768038211554
Total norm for 4 adversaries is: 471.744717114034. distance: 480.76768038211554
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   1,  Average loss: 0.1107, Accuracy: 145/591 (24.5347%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   2,  Average loss: 0.0988, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   3,  Average loss: 0.0907, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   4,  Average loss: 0.0908, Accuracy: 256/591 (43.3164%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   5,  Average loss: 0.0893, Accuracy: 257/591 (43.4856%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   6,  Average loss: 0.0868, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   7,  Average loss: 0.0854, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   8,  Average loss: 0.0842, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   9,  Average loss: 0.0833, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch  10,  Average loss: 0.0829, Accuracy: 258/591 (43.6548%), train_poison_data_count: 195
Global model norm: 137.207302101601.
Norm before scaling: 136.32826737098583. Distance: 4.052660955660269
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.5172, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 10.4199, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 396.710458016927, distance: 405.2660969967757
Total norm for 4 adversaries is: 396.710458016927. distance: 405.2660969967757
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   1,  Average loss: 0.1059, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   2,  Average loss: 0.0972, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   3,  Average loss: 0.0876, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   4,  Average loss: 0.0856, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   5,  Average loss: 0.0864, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   6,  Average loss: 0.0847, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   7,  Average loss: 0.0827, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   8,  Average loss: 0.0823, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   9,  Average loss: 0.0797, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch  10,  Average loss: 0.0832, Accuracy: 227/568 (39.9648%), train_poison_data_count: 180
Global model norm: 137.207302101601.
Norm before scaling: 136.4228261692302. Distance: 3.723412547986382
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.5733, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 10.5924, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 366.8951229575013, distance: 372.3412833006837
Total norm for 4 adversaries is: 366.8951229575013. distance: 372.3412833006837
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   1,  Average loss: 0.1137, Accuracy: 29/557 (5.2065%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   2,  Average loss: 0.1020, Accuracy: 60/557 (10.7720%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   3,  Average loss: 0.0940, Accuracy: 111/557 (19.9282%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   4,  Average loss: 0.0921, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   5,  Average loss: 0.0904, Accuracy: 129/557 (23.1598%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   6,  Average loss: 0.0899, Accuracy: 122/557 (21.9031%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   7,  Average loss: 0.0871, Accuracy: 130/557 (23.3393%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   8,  Average loss: 0.0860, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   9,  Average loss: 0.0847, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch  10,  Average loss: 0.0856, Accuracy: 121/557 (21.7235%), train_poison_data_count: 180
Global model norm: 137.207302101601.
Norm before scaling: 136.42215328255892. Distance: 3.993059096772471
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.3622, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 10.5197, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 393.9449517381839, distance: 399.30590169067125
Total norm for 4 adversaries is: 393.9449517381839. distance: 399.30590169067125
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  27, local model 55, internal_epoch   1,  Average loss: 0.0466, Accuracy: 172/354 (48.5876%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.0117, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  27, local model 58, internal_epoch   1,  Average loss: 0.0903, Accuracy: 26/276 (9.4203%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.8527, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  27, local model 53, internal_epoch   1,  Average loss: 0.0543, Accuracy: 241/739 (32.6116%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.9508, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  27, local model 14, internal_epoch   1,  Average loss: 0.1355, Accuracy: 14/376 (3.7234%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.7324, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  27, local model 36, internal_epoch   1,  Average loss: 0.0552, Accuracy: 162/1005 (16.1194%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.7401, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  27, local model 6, internal_epoch   1,  Average loss: 0.1013, Accuracy: 35/615 (5.6911%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.5054, Accuracy: 1135/10000 (11.3500%)
time spent on training: 101.61525249481201
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 3.9176, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 0.1402, Accuracy: 8968/8968 (100.0000%)
Done in 117.68260741233826 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:28 choose agents : [41, 73, 51, 74, 47, 92, 37, 43, 17, 2]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   1,  Average loss: 0.0400, Accuracy: 267/606 (44.0594%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   2,  Average loss: 0.0282, Accuracy: 268/606 (44.2244%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   3,  Average loss: 0.0229, Accuracy: 263/606 (43.3993%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   4,  Average loss: 0.0225, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   5,  Average loss: 0.0222, Accuracy: 278/606 (45.8746%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   6,  Average loss: 0.0223, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   7,  Average loss: 0.0221, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   8,  Average loss: 0.0219, Accuracy: 278/606 (45.8746%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   9,  Average loss: 0.0208, Accuracy: 268/606 (44.2244%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch  10,  Average loss: 0.0218, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Global model norm: 134.45783783866972.
Norm before scaling: 133.81987076850731. Distance: 3.3620350796368834
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.9797, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.9246, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 335.95595879519686, distance: 336.2035167684895
Total norm for 4 adversaries is: 335.95595879519686. distance: 336.2035167684895
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 443.7312, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   1,  Average loss: 0.0448, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   2,  Average loss: 0.0313, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   3,  Average loss: 0.0267, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   4,  Average loss: 0.0267, Accuracy: 258/591 (43.6548%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   5,  Average loss: 0.0264, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   6,  Average loss: 0.0259, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   7,  Average loss: 0.0262, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   8,  Average loss: 0.0261, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   9,  Average loss: 0.0259, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch  10,  Average loss: 0.0259, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Global model norm: 134.45783783866972.
Norm before scaling: 133.81339035201222. Distance: 3.395580555375536
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.8762, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 1.1377, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 339.0237132192968, distance: 339.5580652664578
Total norm for 4 adversaries is: 339.0237132192968. distance: 339.5580652664578
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 453.4524, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0462, Accuracy: 226/568 (39.7887%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   2,  Average loss: 0.0328, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   3,  Average loss: 0.0266, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   4,  Average loss: 0.0260, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   5,  Average loss: 0.0255, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   6,  Average loss: 0.0250, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   7,  Average loss: 0.0242, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   8,  Average loss: 0.0240, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   9,  Average loss: 0.0238, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch  10,  Average loss: 0.0239, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Global model norm: 134.45783783866972.
Norm before scaling: 133.8841981550661. Distance: 3.5214009626837774
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.7098, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.9353, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 354.18711950747166, distance: 352.14007555587875
Total norm for 4 adversaries is: 354.18711950747166. distance: 352.14007555587875
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 473.4627, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   1,  Average loss: 0.0369, Accuracy: 228/557 (40.9336%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   2,  Average loss: 0.0307, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   3,  Average loss: 0.0283, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   4,  Average loss: 0.0285, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   5,  Average loss: 0.0285, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   6,  Average loss: 0.0279, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   7,  Average loss: 0.0274, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   8,  Average loss: 0.0276, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   9,  Average loss: 0.0278, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch  10,  Average loss: 0.0276, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Global model norm: 134.45783783866972.
Norm before scaling: 133.8930601730351. Distance: 2.4755177505402273
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.7744, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.9515, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 252.17504616089593, distance: 247.55177804350345
Total norm for 4 adversaries is: 252.17504616089593. distance: 247.55177804350345
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 294.8195, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  28, local model 47, internal_epoch   1,  Average loss: 0.0478, Accuracy: 63/776 (8.1186%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.7085, Accuracy: 1028/10000 (10.2800%)
___Train Local_Simple,  epoch  28, local model 92, internal_epoch   1,  Average loss: 0.0435, Accuracy: 109/937 (11.6329%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.7693, Accuracy: 974/10000 (9.7400%)
___Train Local_Simple,  epoch  28, local model 37, internal_epoch   1,  Average loss: 0.0327, Accuracy: 427/860 (49.6512%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.6917, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  28, local model 43, internal_epoch   1,  Average loss: 0.0594, Accuracy: 0/408 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.7686, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0567, Accuracy: 0/620 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.4661, Accuracy: 1028/10000 (10.2800%)
___Train Local_Simple,  epoch  28, local model 2, internal_epoch   1,  Average loss: 0.0351, Accuracy: 290/548 (52.9197%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 3.1049, Accuracy: 1032/10000 (10.3200%)
time spent on training: 101.48133444786072
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 3.4659, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 7.5684, Accuracy: 0/8968 (0.0000%)
Done in 120.80930685997009 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:29 choose agents : [41, 73, 51, 74, 66, 6, 38, 37, 45, 81]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   1,  Average loss: 0.0700, Accuracy: 61/606 (10.0660%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   2,  Average loss: 0.0523, Accuracy: 259/606 (42.7393%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   3,  Average loss: 0.0432, Accuracy: 251/606 (41.4191%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   4,  Average loss: 0.0414, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   5,  Average loss: 0.0397, Accuracy: 246/606 (40.5941%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   6,  Average loss: 0.0371, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   7,  Average loss: 0.0357, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   8,  Average loss: 0.0337, Accuracy: 251/606 (41.4191%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   9,  Average loss: 0.0326, Accuracy: 254/606 (41.9142%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch  10,  Average loss: 0.0324, Accuracy: 254/606 (41.9142%), train_poison_data_count: 200
Global model norm: 132.2132731966613.
Norm before scaling: 131.5175026968844. Distance: 4.799950623258304
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.8266, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 2.8551, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 476.6782851148141, distance: 479.9950683340403
Total norm for 4 adversaries is: 476.6782851148141. distance: 479.9950683340403
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   1,  Average loss: 0.0635, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   2,  Average loss: 0.0526, Accuracy: 277/591 (46.8697%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   3,  Average loss: 0.0458, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   4,  Average loss: 0.0455, Accuracy: 255/591 (43.1472%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   5,  Average loss: 0.0435, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   6,  Average loss: 0.0414, Accuracy: 277/591 (46.8697%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   7,  Average loss: 0.0403, Accuracy: 278/591 (47.0389%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   8,  Average loss: 0.0389, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   9,  Average loss: 0.0378, Accuracy: 278/591 (47.0389%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch  10,  Average loss: 0.0382, Accuracy: 273/591 (46.1929%), train_poison_data_count: 195
Global model norm: 132.2132731966613.
Norm before scaling: 131.5185348154396. Distance: 3.8750424536563672
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.8503, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 3.6349, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 384.4684236058925, distance: 387.50425400890765
Total norm for 4 adversaries is: 384.4684236058925. distance: 387.50425400890765
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   1,  Average loss: 0.0620, Accuracy: 87/568 (15.3169%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   2,  Average loss: 0.0513, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   3,  Average loss: 0.0442, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   4,  Average loss: 0.0429, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   5,  Average loss: 0.0415, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   6,  Average loss: 0.0398, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   7,  Average loss: 0.0386, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   8,  Average loss: 0.0377, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   9,  Average loss: 0.0364, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch  10,  Average loss: 0.0372, Accuracy: 226/568 (39.7887%), train_poison_data_count: 180
Global model norm: 132.2132731966613.
Norm before scaling: 131.60328940132916. Distance: 3.8077891277461564
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.8945, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 3.7781, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 380.69800203048084, distance: 380.7789302863277
Total norm for 4 adversaries is: 380.69800203048084. distance: 380.7789302863277
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   1,  Average loss: 0.0750, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   2,  Average loss: 0.0586, Accuracy: 12/557 (2.1544%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   3,  Average loss: 0.0497, Accuracy: 126/557 (22.6212%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   4,  Average loss: 0.0485, Accuracy: 132/557 (23.6984%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   5,  Average loss: 0.0465, Accuracy: 119/557 (21.3645%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   6,  Average loss: 0.0454, Accuracy: 117/557 (21.0054%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   7,  Average loss: 0.0434, Accuracy: 129/557 (23.1598%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   8,  Average loss: 0.0424, Accuracy: 131/557 (23.5189%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   9,  Average loss: 0.0421, Accuracy: 117/557 (21.0054%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch  10,  Average loss: 0.0413, Accuracy: 129/557 (23.1598%), train_poison_data_count: 180
Global model norm: 132.2132731966613.
Norm before scaling: 131.5926999186315. Distance: 4.331270802985982
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.6112, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 3.6446, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 432.24145089868466, distance: 433.1270743096072
Total norm for 4 adversaries is: 432.24145089868466. distance: 433.1270743096072
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  29, local model 66, internal_epoch   1,  Average loss: 0.0550, Accuracy: 23/660 (3.4848%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.8284, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   1,  Average loss: 0.0698, Accuracy: 7/615 (1.1382%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.7730, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  29, local model 38, internal_epoch   1,  Average loss: 0.0446, Accuracy: 86/895 (9.6089%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.8514, Accuracy: 958/10000 (9.5800%)
___Train Local_Simple,  epoch  29, local model 37, internal_epoch   1,  Average loss: 0.0632, Accuracy: 154/860 (17.9070%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.6920, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  29, local model 45, internal_epoch   1,  Average loss: 0.0423, Accuracy: 191/628 (30.4140%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.1064, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  29, local model 81, internal_epoch   1,  Average loss: 0.0325, Accuracy: 454/1227 (37.0008%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.3818, Accuracy: 892/10000 (8.9200%)
time spent on training: 99.4084894657135
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 9.6277, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 0.0003, Accuracy: 8968/8968 (100.0000%)
Done in 118.9233021736145 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:30 choose agents : [41, 73, 51, 74, 4, 24, 38, 54, 10, 11]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   1,  Average loss: 0.0945, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   2,  Average loss: 0.0726, Accuracy: 267/606 (44.0594%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   3,  Average loss: 0.0515, Accuracy: 277/606 (45.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   4,  Average loss: 0.0493, Accuracy: 267/606 (44.0594%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   5,  Average loss: 0.0453, Accuracy: 276/606 (45.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   6,  Average loss: 0.0426, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   7,  Average loss: 0.0374, Accuracy: 278/606 (45.8746%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   8,  Average loss: 0.0351, Accuracy: 277/606 (45.7096%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   9,  Average loss: 0.0338, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch  10,  Average loss: 0.0324, Accuracy: 276/606 (45.5446%), train_poison_data_count: 200
Global model norm: 130.25762483680177.
Norm before scaling: 129.38872209837302. Distance: 6.168520090443183
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 4.8952, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1022, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 609.1862399956191, distance: 616.8519879193063
Total norm for 4 adversaries is: 609.1862399956191. distance: 616.8519879193063
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 843.2557, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   1,  Average loss: 0.1214, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   2,  Average loss: 0.0918, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   3,  Average loss: 0.0661, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   4,  Average loss: 0.0619, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   5,  Average loss: 0.0576, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   6,  Average loss: 0.0534, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   7,  Average loss: 0.0494, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   8,  Average loss: 0.0454, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   9,  Average loss: 0.0432, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch  10,  Average loss: 0.0430, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Global model norm: 130.25762483680177.
Norm before scaling: 129.31877552438007. Distance: 6.9025996300547545
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 4.1375, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1180, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 681.3892747541599, distance: 690.2599374511026
Total norm for 4 adversaries is: 681.3892747541599. distance: 690.2599374511026
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 936.7290, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   1,  Average loss: 0.1017, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   2,  Average loss: 0.0816, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   3,  Average loss: 0.0633, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   4,  Average loss: 0.0597, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   5,  Average loss: 0.0557, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   6,  Average loss: 0.0525, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   7,  Average loss: 0.0483, Accuracy: 243/568 (42.7817%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   8,  Average loss: 0.0460, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   9,  Average loss: 0.0442, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch  10,  Average loss: 0.0439, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Global model norm: 130.25762483680177.
Norm before scaling: 129.45987554064772. Distance: 5.672289956626933
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 5.1062, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0495, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 561.0519695179761, distance: 567.2290377351992
Total norm for 4 adversaries is: 561.0519695179761. distance: 567.2290377351992
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 769.1921, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   1,  Average loss: 0.0923, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   2,  Average loss: 0.0725, Accuracy: 227/557 (40.7540%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   3,  Average loss: 0.0573, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   4,  Average loss: 0.0545, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   5,  Average loss: 0.0518, Accuracy: 218/557 (39.1382%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   6,  Average loss: 0.0480, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   7,  Average loss: 0.0456, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   8,  Average loss: 0.0434, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   9,  Average loss: 0.0424, Accuracy: 217/557 (38.9587%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch  10,  Average loss: 0.0405, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Global model norm: 130.25762483680177.
Norm before scaling: 129.4931148628181. Distance: 5.255804395441258
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 5.0479, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0899, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 520.1742196130062, distance: 525.580423198962
Total norm for 4 adversaries is: 520.1742196130062. distance: 525.580423198962
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 625.7304, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  30, local model 4, internal_epoch   1,  Average loss: 0.1356, Accuracy: 2/658 (0.3040%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 4.9234, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  30, local model 24, internal_epoch   1,  Average loss: 0.1453, Accuracy: 14/379 (3.6939%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 7.8989, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  30, local model 38, internal_epoch   1,  Average loss: 0.1218, Accuracy: 1/895 (0.1117%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.2993, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  30, local model 54, internal_epoch   1,  Average loss: 0.1439, Accuracy: 53/519 (10.2119%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 6.4977, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.1244, Accuracy: 1/892 (0.1121%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.3651, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  30, local model 11, internal_epoch   1,  Average loss: 0.1479, Accuracy: 2/645 (0.3101%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 4.8900, Accuracy: 1032/10000 (10.3200%)
time spent on training: 101.0876829624176
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 3.9001, Accuracy: 892/10000 (8.9200%)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 14.2389, Accuracy: 0/8968 (0.0000%)
Done in 121.29700088500977 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:31 choose agents : [41, 73, 51, 74, 80, 7, 72, 14, 99, 12]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   1,  Average loss: 0.1215, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   2,  Average loss: 0.1055, Accuracy: 254/606 (41.9142%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   3,  Average loss: 0.0963, Accuracy: 246/606 (40.5941%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   4,  Average loss: 0.0927, Accuracy: 256/606 (42.2442%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   5,  Average loss: 0.0924, Accuracy: 249/606 (41.0891%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   6,  Average loss: 0.0908, Accuracy: 249/606 (41.0891%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   7,  Average loss: 0.0890, Accuracy: 248/606 (40.9241%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   8,  Average loss: 0.0857, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   9,  Average loss: 0.0833, Accuracy: 253/606 (41.7492%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch  10,  Average loss: 0.0841, Accuracy: 245/606 (40.4290%), train_poison_data_count: 200
Global model norm: 128.11493862934174.
Norm before scaling: 127.21787106672552. Distance: 4.754315072679001
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.4240, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 9.5255, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 466.13644729842787, distance: 475.4315638186005
Total norm for 4 adversaries is: 466.13644729842787. distance: 475.4315638186005
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   1,  Average loss: 0.1137, Accuracy: 62/591 (10.4907%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   2,  Average loss: 0.0999, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   3,  Average loss: 0.0918, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   4,  Average loss: 0.0900, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   5,  Average loss: 0.0889, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   6,  Average loss: 0.0881, Accuracy: 259/591 (43.8240%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   7,  Average loss: 0.0847, Accuracy: 274/591 (46.3621%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   8,  Average loss: 0.0839, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   9,  Average loss: 0.0828, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch  10,  Average loss: 0.0827, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Global model norm: 128.11493862934174.
Norm before scaling: 127.2621479343917. Distance: 4.2569021389165735
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.4928, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 10.4241, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 417.17524794743036, distance: 425.69024830268313
Total norm for 4 adversaries is: 417.17524794743036. distance: 425.69024830268313
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   1,  Average loss: 0.1103, Accuracy: 101/568 (17.7817%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   2,  Average loss: 0.0976, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   3,  Average loss: 0.0887, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   4,  Average loss: 0.0880, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   5,  Average loss: 0.0883, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   6,  Average loss: 0.0840, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   7,  Average loss: 0.0843, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   8,  Average loss: 0.0809, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   9,  Average loss: 0.0830, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch  10,  Average loss: 0.0803, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Global model norm: 128.11493862934174.
Norm before scaling: 127.34832813856451. Distance: 3.9208530751189747
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.5364, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 10.5195, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 386.0349522711642, distance: 392.08533031726654
Total norm for 4 adversaries is: 386.0349522711642. distance: 392.08533031726654
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.1115, Accuracy: 19/557 (3.4111%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   2,  Average loss: 0.1020, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   3,  Average loss: 0.0947, Accuracy: 122/557 (21.9031%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   4,  Average loss: 0.0927, Accuracy: 121/557 (21.7235%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   5,  Average loss: 0.0903, Accuracy: 130/557 (23.3393%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   6,  Average loss: 0.0899, Accuracy: 130/557 (23.3393%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   7,  Average loss: 0.0878, Accuracy: 123/557 (22.0826%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   8,  Average loss: 0.0857, Accuracy: 127/557 (22.8007%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   9,  Average loss: 0.0860, Accuracy: 130/557 (23.3393%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch  10,  Average loss: 0.0850, Accuracy: 123/557 (22.0826%), train_poison_data_count: 180
Global model norm: 128.11493862934174.
Norm before scaling: 127.3496969470285. Distance: 3.7554614669129243
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.3674, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 10.4947, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 369.44398678960795, distance: 375.5461647720557
Total norm for 4 adversaries is: 369.44398678960795. distance: 375.5461647720557
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  31, local model 80, internal_epoch   1,  Average loss: 0.0640, Accuracy: 4/431 (0.9281%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.6280, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  31, local model 7, internal_epoch   1,  Average loss: 0.0808, Accuracy: 33/418 (7.8947%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.6486, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  31, local model 72, internal_epoch   1,  Average loss: 0.0464, Accuracy: 131/731 (17.9207%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.6880, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  31, local model 14, internal_epoch   1,  Average loss: 0.1330, Accuracy: 1/376 (0.2660%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.6893, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: 0.0475, Accuracy: 11/377 (2.9178%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.7665, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: 0.0515, Accuracy: 472/1160 (40.6897%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.7808, Accuracy: 892/10000 (8.9200%)
time spent on training: 100.23754119873047
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 4.0328, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 0.1345, Accuracy: 8968/8968 (100.0000%)
Done in 119.6803629398346 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:32 choose agents : [41, 73, 51, 74, 93, 25, 34, 57, 69, 58]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   1,  Average loss: 0.0431, Accuracy: 269/606 (44.3894%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   2,  Average loss: 0.0300, Accuracy: 280/606 (46.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   3,  Average loss: 0.0244, Accuracy: 269/606 (44.3894%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   4,  Average loss: 0.0236, Accuracy: 279/606 (46.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   5,  Average loss: 0.0232, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   6,  Average loss: 0.0230, Accuracy: 276/606 (45.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   7,  Average loss: 0.0226, Accuracy: 272/606 (44.8845%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   8,  Average loss: 0.0218, Accuracy: 278/606 (45.8746%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   9,  Average loss: 0.0217, Accuracy: 277/606 (45.7096%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch  10,  Average loss: 0.0220, Accuracy: 272/606 (44.8845%), train_poison_data_count: 200
Global model norm: 125.50265731125975.
Norm before scaling: 124.89183601470914. Distance: 3.6280691374191805
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.9275, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.8733, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 361.6199338566667, distance: 362.80691748504466
Total norm for 4 adversaries is: 361.6199338566667. distance: 362.80691748504466
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 484.4814, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   1,  Average loss: 0.0359, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   2,  Average loss: 0.0260, Accuracy: 207/591 (35.0254%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   3,  Average loss: 0.0242, Accuracy: 274/591 (46.3621%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   4,  Average loss: 0.0250, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   5,  Average loss: 0.0249, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   6,  Average loss: 0.0246, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   7,  Average loss: 0.0245, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   8,  Average loss: 0.0242, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   9,  Average loss: 0.0243, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch  10,  Average loss: 0.0242, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Global model norm: 125.50265731125975.
Norm before scaling: 124.90770420719652. Distance: 2.5440042617030407
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.1395, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 1.1104, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 254.8042907066127, distance: 254.4004133497035
Total norm for 4 adversaries is: 254.8042907066127. distance: 254.4004133497035
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 340.6435, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   1,  Average loss: 0.0370, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   2,  Average loss: 0.0275, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   3,  Average loss: 0.0230, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   4,  Average loss: 0.0222, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   5,  Average loss: 0.0225, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   6,  Average loss: 0.0224, Accuracy: 241/568 (42.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   7,  Average loss: 0.0220, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   8,  Average loss: 0.0218, Accuracy: 241/568 (42.4296%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   9,  Average loss: 0.0219, Accuracy: 226/568 (39.7887%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch  10,  Average loss: 0.0224, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Global model norm: 125.50265731125975.
Norm before scaling: 124.97777536801293. Distance: 2.9665949980690587
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.0194, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.9816, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 299.55049657778903, distance: 296.6595007327424
Total norm for 4 adversaries is: 299.55049657778903. distance: 296.6595007327424
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 404.8096, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   1,  Average loss: 0.0449, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   2,  Average loss: 0.0360, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   3,  Average loss: 0.0319, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   4,  Average loss: 0.0311, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   5,  Average loss: 0.0312, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   6,  Average loss: 0.0302, Accuracy: 231/557 (41.4722%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   7,  Average loss: 0.0302, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   8,  Average loss: 0.0302, Accuracy: 217/557 (38.9587%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   9,  Average loss: 0.0298, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch  10,  Average loss: 0.0297, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Global model norm: 125.50265731125975.
Norm before scaling: 124.94991574752062. Distance: 2.9688315932455205
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.6355, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.8900, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 298.6061107462471, distance: 296.8831446251201
Total norm for 4 adversaries is: 298.6061107462471. distance: 296.8831446251201
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 359.6058, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: 0.0525, Accuracy: 23/623 (3.6918%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.6721, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  32, local model 25, internal_epoch   1,  Average loss: 0.0387, Accuracy: 247/647 (38.1762%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.8043, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  32, local model 34, internal_epoch   1,  Average loss: 0.0625, Accuracy: 51/413 (12.3487%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.9059, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  32, local model 57, internal_epoch   1,  Average loss: 0.0545, Accuracy: 113/343 (32.9446%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.3042, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  32, local model 69, internal_epoch   1,  Average loss: 0.0647, Accuracy: 2/256 (0.7812%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.4239, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  32, local model 58, internal_epoch   1,  Average loss: 0.0637, Accuracy: 53/276 (19.2029%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.3340, Accuracy: 1032/10000 (10.3200%)
time spent on training: 96.65658068656921
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 3.2609, Accuracy: 1009/10000 (10.0900%)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 7.1800, Accuracy: 0/8968 (0.0000%)
Done in 117.73851680755615 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:33 choose agents : [41, 73, 51, 74, 2, 4, 1, 20, 49, 57]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   1,  Average loss: 0.0654, Accuracy: 65/606 (10.7261%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   2,  Average loss: 0.0505, Accuracy: 253/606 (41.7492%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   3,  Average loss: 0.0417, Accuracy: 245/606 (40.4290%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   4,  Average loss: 0.0388, Accuracy: 258/606 (42.5743%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   5,  Average loss: 0.0380, Accuracy: 245/606 (40.4290%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   6,  Average loss: 0.0357, Accuracy: 255/606 (42.0792%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   7,  Average loss: 0.0341, Accuracy: 245/606 (40.4290%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   8,  Average loss: 0.0322, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   9,  Average loss: 0.0309, Accuracy: 261/606 (43.0693%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch  10,  Average loss: 0.0308, Accuracy: 259/606 (42.7393%), train_poison_data_count: 200
Global model norm: 123.39552292577312.
Norm before scaling: 122.74975735082941. Distance: 4.6692660903126475
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.7613, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 2.6425, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 463.8657369056266, distance: 466.9265868420859
Total norm for 4 adversaries is: 463.8657369056266. distance: 466.9265868420859
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   1,  Average loss: 0.0638, Accuracy: 71/591 (12.0135%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   2,  Average loss: 0.0516, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   3,  Average loss: 0.0447, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   4,  Average loss: 0.0434, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   5,  Average loss: 0.0418, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   6,  Average loss: 0.0404, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   7,  Average loss: 0.0388, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   8,  Average loss: 0.0374, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   9,  Average loss: 0.0367, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch  10,  Average loss: 0.0366, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Global model norm: 123.39552292577312.
Norm before scaling: 122.7495823249004. Distance: 4.061999246106061
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.7799, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 3.3918, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 403.3302578222963, distance: 406.1999007570041
Total norm for 4 adversaries is: 403.3302578222963. distance: 406.1999007570041
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   1,  Average loss: 0.0584, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   2,  Average loss: 0.0488, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   3,  Average loss: 0.0420, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   4,  Average loss: 0.0411, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   5,  Average loss: 0.0389, Accuracy: 243/568 (42.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   6,  Average loss: 0.0382, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   7,  Average loss: 0.0367, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   8,  Average loss: 0.0355, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   9,  Average loss: 0.0352, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch  10,  Average loss: 0.0347, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Global model norm: 123.39552292577312.
Norm before scaling: 122.82790933863525. Distance: 3.647131349106681
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.8029, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 3.4754, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 364.603894658299, distance: 364.71313641682826
Total norm for 4 adversaries is: 364.603894658299. distance: 364.71313641682826
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   1,  Average loss: 0.0706, Accuracy: 25/557 (4.4883%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   2,  Average loss: 0.0568, Accuracy: 36/557 (6.4632%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   3,  Average loss: 0.0474, Accuracy: 123/557 (22.0826%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   4,  Average loss: 0.0458, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   5,  Average loss: 0.0444, Accuracy: 135/557 (24.2370%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   6,  Average loss: 0.0427, Accuracy: 125/557 (22.4417%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   7,  Average loss: 0.0419, Accuracy: 127/557 (22.8007%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   8,  Average loss: 0.0405, Accuracy: 126/557 (22.6212%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   9,  Average loss: 0.0399, Accuracy: 133/557 (23.8779%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch  10,  Average loss: 0.0393, Accuracy: 126/557 (22.6212%), train_poison_data_count: 180
Global model norm: 123.39552292577312.
Norm before scaling: 122.81717548352103. Distance: 4.177787562848079
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.5428, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 3.3313, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 416.86997748098867, distance: 417.7787430267366
Total norm for 4 adversaries is: 416.86997748098867. distance: 417.7787430267366
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  33, local model 2, internal_epoch   1,  Average loss: 0.0733, Accuracy: 63/548 (11.4964%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.7864, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  33, local model 4, internal_epoch   1,  Average loss: 0.0451, Accuracy: 49/658 (7.4468%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.9141, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  33, local model 1, internal_epoch   1,  Average loss: 0.0506, Accuracy: 55/760 (7.2368%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.7409, Accuracy: 974/10000 (9.7400%)
___Train Local_Simple,  epoch  33, local model 20, internal_epoch   1,  Average loss: 0.0361, Accuracy: 109/429 (25.4079%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.2214, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  33, local model 49, internal_epoch   1,  Average loss: 0.0325, Accuracy: 107/506 (21.1462%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.1665, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  33, local model 57, internal_epoch   1,  Average loss: 0.0718, Accuracy: 38/343 (11.0787%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.9880, Accuracy: 1009/10000 (10.0900%)
time spent on training: 107.86978149414062
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 9.8350, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 0.0002, Accuracy: 8968/8968 (100.0000%)
Done in 126.52557277679443 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:34 choose agents : [41, 73, 51, 74, 27, 43, 49, 0, 45, 25]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0965, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   2,  Average loss: 0.0745, Accuracy: 272/606 (44.8845%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   3,  Average loss: 0.0556, Accuracy: 269/606 (44.3894%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   4,  Average loss: 0.0502, Accuracy: 279/606 (46.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   5,  Average loss: 0.0474, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   6,  Average loss: 0.0437, Accuracy: 277/606 (45.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   7,  Average loss: 0.0399, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   8,  Average loss: 0.0378, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   9,  Average loss: 0.0360, Accuracy: 268/606 (44.2244%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch  10,  Average loss: 0.0353, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Global model norm: 121.65621789108233.
Norm before scaling: 120.79615043923171. Distance: 6.176315834607097
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 5.0716, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0659, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 609.5915640820499, distance: 617.6316155282209
Total norm for 4 adversaries is: 609.5915640820499. distance: 617.6316155282209
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 845.2202, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   1,  Average loss: 0.1082, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   2,  Average loss: 0.0786, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   3,  Average loss: 0.0535, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   4,  Average loss: 0.0495, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   5,  Average loss: 0.0465, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   6,  Average loss: 0.0418, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   7,  Average loss: 0.0382, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   8,  Average loss: 0.0357, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   9,  Average loss: 0.0338, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch  10,  Average loss: 0.0336, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Global model norm: 121.65621789108233.
Norm before scaling: 120.79062867856305. Distance: 6.749477507537591
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 4.5733, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.2471, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 666.9432369025118, distance: 674.9477294576225
Total norm for 4 adversaries is: 666.9432369025118. distance: 674.9477294576225
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 915.9922, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   1,  Average loss: 0.1104, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   2,  Average loss: 0.0865, Accuracy: 243/568 (42.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   3,  Average loss: 0.0710, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   4,  Average loss: 0.0669, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   5,  Average loss: 0.0625, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   6,  Average loss: 0.0587, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   7,  Average loss: 0.0564, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   8,  Average loss: 0.0522, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   9,  Average loss: 0.0512, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch  10,  Average loss: 0.0493, Accuracy: 244/568 (42.9577%), train_poison_data_count: 180
Global model norm: 121.65621789108233.
Norm before scaling: 120.8423438630371. Distance: 5.700309999301333
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 5.2630, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0297, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 562.8052227458448, distance: 570.0309750355677
Total norm for 4 adversaries is: 562.8052227458448. distance: 570.0309750355677
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 772.4786, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   1,  Average loss: 0.0978, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   2,  Average loss: 0.0774, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   3,  Average loss: 0.0611, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   4,  Average loss: 0.0599, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   5,  Average loss: 0.0551, Accuracy: 227/557 (40.7540%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   6,  Average loss: 0.0526, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   7,  Average loss: 0.0487, Accuracy: 231/557 (41.4722%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   8,  Average loss: 0.0458, Accuracy: 230/557 (41.2926%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   9,  Average loss: 0.0459, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch  10,  Average loss: 0.0456, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Global model norm: 121.65621789108233.
Norm before scaling: 120.88803898132355. Distance: 5.309883101446339
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 5.1914, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0640, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 524.6879429718201, distance: 530.988317903511
Total norm for 4 adversaries is: 524.6879429718201. distance: 530.988317903511
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 642.7311, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  34, local model 27, internal_epoch   1,  Average loss: 0.1736, Accuracy: 1/471 (0.2123%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 6.9661, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  34, local model 43, internal_epoch   1,  Average loss: 0.1639, Accuracy: 0/408 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 7.5303, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  34, local model 49, internal_epoch   1,  Average loss: 0.1596, Accuracy: 2/506 (0.3953%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 6.9756, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  34, local model 0, internal_epoch   1,  Average loss: 0.1281, Accuracy: 98/435 (22.5287%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 8.0783, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  34, local model 45, internal_epoch   1,  Average loss: 0.1350, Accuracy: 23/628 (3.6624%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 5.8632, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  34, local model 25, internal_epoch   1,  Average loss: 0.1105, Accuracy: 247/647 (38.1762%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 6.8408, Accuracy: 1032/10000 (10.3200%)
time spent on training: 99.6957688331604
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 4.4900, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 14.4698, Accuracy: 0/8968 (0.0000%)
Done in 118.78781414031982 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:35 choose agents : [41, 73, 51, 74, 8, 12, 55, 26, 62, 65]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   1,  Average loss: 0.1265, Accuracy: 39/606 (6.4356%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   2,  Average loss: 0.1011, Accuracy: 213/606 (35.1485%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   3,  Average loss: 0.0935, Accuracy: 245/606 (40.4290%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   4,  Average loss: 0.0920, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   5,  Average loss: 0.0890, Accuracy: 251/606 (41.4191%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   6,  Average loss: 0.0853, Accuracy: 260/606 (42.9043%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   7,  Average loss: 0.0833, Accuracy: 261/606 (43.0693%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   8,  Average loss: 0.0828, Accuracy: 257/606 (42.4092%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   9,  Average loss: 0.0802, Accuracy: 263/606 (43.3993%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch  10,  Average loss: 0.0809, Accuracy: 255/606 (42.0792%), train_poison_data_count: 200
Global model norm: 119.65572766926998.
Norm before scaling: 118.76822228609807. Distance: 5.225224664411962
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.4635, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 9.2568, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 513.2805032338556, distance: 522.5224875543636
Total norm for 4 adversaries is: 513.2805032338556. distance: 522.5224875543636
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   1,  Average loss: 0.1077, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   2,  Average loss: 0.0974, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   3,  Average loss: 0.0893, Accuracy: 277/591 (46.8697%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   4,  Average loss: 0.0890, Accuracy: 254/591 (42.9780%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   5,  Average loss: 0.0862, Accuracy: 272/591 (46.0237%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   6,  Average loss: 0.0854, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   7,  Average loss: 0.0831, Accuracy: 274/591 (46.3621%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   8,  Average loss: 0.0826, Accuracy: 257/591 (43.4856%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   9,  Average loss: 0.0812, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch  10,  Average loss: 0.0809, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Global model norm: 119.65572766926998.
Norm before scaling: 118.80656547514535. Distance: 3.9991954948105364
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.4309, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 10.0202, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 390.39036953413694, distance: 399.9195426895265
Total norm for 4 adversaries is: 390.39036953413694. distance: 399.9195426895265
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   1,  Average loss: 0.1177, Accuracy: 34/568 (5.9859%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   2,  Average loss: 0.0984, Accuracy: 123/568 (21.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   3,  Average loss: 0.0876, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   4,  Average loss: 0.0856, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   5,  Average loss: 0.0834, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   6,  Average loss: 0.0826, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   7,  Average loss: 0.0811, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   8,  Average loss: 0.0810, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   9,  Average loss: 0.0791, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch  10,  Average loss: 0.0783, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Global model norm: 119.65572766926998.
Norm before scaling: 118.89226675335112. Distance: 4.71661995818574
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.5146, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 10.1714, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 465.12982058775805, distance: 471.6619883454676
Total norm for 4 adversaries is: 465.12982058775805. distance: 471.6619883454676
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   1,  Average loss: 0.1177, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   2,  Average loss: 0.1018, Accuracy: 64/557 (11.4901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   3,  Average loss: 0.0928, Accuracy: 122/557 (21.9031%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   4,  Average loss: 0.0886, Accuracy: 131/557 (23.5189%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   5,  Average loss: 0.0864, Accuracy: 135/557 (24.2370%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   6,  Average loss: 0.0883, Accuracy: 127/557 (22.8007%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   7,  Average loss: 0.0838, Accuracy: 133/557 (23.8779%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   8,  Average loss: 0.0824, Accuracy: 136/557 (24.4165%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   9,  Average loss: 0.0821, Accuracy: 127/557 (22.8007%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch  10,  Average loss: 0.0837, Accuracy: 133/557 (23.8779%), train_poison_data_count: 180
Global model norm: 119.65572766926998.
Norm before scaling: 118.8949033679535. Distance: 4.472584393186428
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.3714, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 10.1890, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 440.690012934262, distance: 447.258401961327
Total norm for 4 adversaries is: 440.690012934262. distance: 447.258401961327
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.0985, Accuracy: 19/633 (3.0016%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.5246, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  35, local model 12, internal_epoch   1,  Average loss: 0.0519, Accuracy: 351/1160 (30.2586%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.8863, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  35, local model 55, internal_epoch   1,  Average loss: 0.0600, Accuracy: 80/354 (22.5989%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 4.0530, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  35, local model 26, internal_epoch   1,  Average loss: 0.1185, Accuracy: 39/554 (7.0397%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.5508, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  35, local model 62, internal_epoch   1,  Average loss: 0.0815, Accuracy: 39/423 (9.2199%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.8370, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  35, local model 65, internal_epoch   1,  Average loss: 0.0425, Accuracy: 144/371 (38.8140%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 4.1712, Accuracy: 980/10000 (9.8000%)
time spent on training: 102.4744279384613
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 4.3429, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 0.2168, Accuracy: 8968/8968 (100.0000%)
Done in 121.91067361831665 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:36 choose agents : [41, 73, 51, 74, 54, 94, 68, 33, 58, 10]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   1,  Average loss: 0.0422, Accuracy: 268/606 (44.2244%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   2,  Average loss: 0.0317, Accuracy: 270/606 (44.5545%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   3,  Average loss: 0.0269, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   4,  Average loss: 0.0268, Accuracy: 269/606 (44.3894%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   5,  Average loss: 0.0272, Accuracy: 269/606 (44.3894%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   6,  Average loss: 0.0252, Accuracy: 276/606 (45.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   7,  Average loss: 0.0250, Accuracy: 270/606 (44.5545%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   8,  Average loss: 0.0263, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   9,  Average loss: 0.0260, Accuracy: 277/606 (45.7096%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch  10,  Average loss: 0.0260, Accuracy: 272/606 (44.8845%), train_poison_data_count: 200
Global model norm: 117.31360298495865.
Norm before scaling: 116.72999862128415. Distance: 3.140727634555867
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.6177, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.8890, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 312.66388202828927, distance: 314.07275480770375
Total norm for 4 adversaries is: 312.66388202828927. distance: 314.07275480770375
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 385.1345, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   1,  Average loss: 0.0816, Accuracy: 196/591 (33.1641%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   2,  Average loss: 0.0662, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   3,  Average loss: 0.0562, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   4,  Average loss: 0.0556, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   5,  Average loss: 0.0540, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   6,  Average loss: 0.0522, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   7,  Average loss: 0.0501, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   8,  Average loss: 0.0474, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   9,  Average loss: 0.0466, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch  10,  Average loss: 0.0473, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Global model norm: 117.31360298495865.
Norm before scaling: 116.5847038168494. Distance: 4.602324081117261
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 2.7952, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.8322, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 454.32291654725054, distance: 460.2324141126959
Total norm for 4 adversaries is: 454.32291654725054. distance: 460.2324141126959
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 593.7487, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   1,  Average loss: 0.0317, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   2,  Average loss: 0.0280, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   3,  Average loss: 0.0272, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   4,  Average loss: 0.0273, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   5,  Average loss: 0.0281, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   6,  Average loss: 0.0284, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   7,  Average loss: 0.0272, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   8,  Average loss: 0.0287, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   9,  Average loss: 0.0262, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch  10,  Average loss: 0.0269, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Global model norm: 117.31360298495865.
Norm before scaling: 116.80898871127171. Distance: 1.7174497367689212
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.7987, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.9232, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 176.4923090569388, distance: 171.7449735436237
Total norm for 4 adversaries is: 176.4923090569388. distance: 171.7449735436237
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 213.2834, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   1,  Average loss: 0.0409, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   2,  Average loss: 0.0339, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   3,  Average loss: 0.0303, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   4,  Average loss: 0.0299, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   5,  Average loss: 0.0300, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   6,  Average loss: 0.0293, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   7,  Average loss: 0.0287, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   8,  Average loss: 0.0288, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   9,  Average loss: 0.0282, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch  10,  Average loss: 0.0286, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Global model norm: 117.31360298495865.
Norm before scaling: 116.79910219448392. Distance: 2.6929274469256534
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.2347, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.8830, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 271.12840016309616, distance: 269.29275136456977
Total norm for 4 adversaries is: 271.12840016309616. distance: 269.29275136456977
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 321.7519, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  36, local model 54, internal_epoch   1,  Average loss: 0.0499, Accuracy: 53/519 (10.2119%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.2952, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  36, local model 94, internal_epoch   1,  Average loss: 0.0801, Accuracy: 27/150 (18.0000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 4.0808, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  36, local model 68, internal_epoch   1,  Average loss: 0.0584, Accuracy: 5/494 (1.0121%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.2147, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  36, local model 33, internal_epoch   1,  Average loss: 0.0563, Accuracy: 0/623 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.0556, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  36, local model 58, internal_epoch   1,  Average loss: 0.0550, Accuracy: 53/276 (19.2029%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.7878, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  36, local model 10, internal_epoch   1,  Average loss: 0.0459, Accuracy: 247/892 (27.6906%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.7862, Accuracy: 1009/10000 (10.0900%)
time spent on training: 105.01474499702454
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 3.0261, Accuracy: 892/10000 (8.9200%)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 5.6013, Accuracy: 0/8968 (0.0000%)
Done in 123.51034593582153 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:37 choose agents : [41, 73, 51, 74, 13, 81, 37, 94, 61, 57]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   1,  Average loss: 0.0513, Accuracy: 253/606 (41.7492%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   2,  Average loss: 0.0392, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   3,  Average loss: 0.0308, Accuracy: 251/606 (41.4191%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   4,  Average loss: 0.0293, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   5,  Average loss: 0.0281, Accuracy: 248/606 (40.9241%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   6,  Average loss: 0.0270, Accuracy: 247/606 (40.7591%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   7,  Average loss: 0.0262, Accuracy: 251/606 (41.4191%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   8,  Average loss: 0.0257, Accuracy: 241/606 (39.7690%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   9,  Average loss: 0.0250, Accuracy: 241/606 (39.7690%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch  10,  Average loss: 0.0245, Accuracy: 253/606 (41.7492%), train_poison_data_count: 200
Global model norm: 115.14288423112606.
Norm before scaling: 114.58217660400985. Distance: 4.100825826700946
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.6981, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 1.5401, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 408.4887735605472, distance: 410.08259457699495
Total norm for 4 adversaries is: 408.4887735605472. distance: 410.08259457699495
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   1,  Average loss: 0.0662, Accuracy: 6/591 (1.0152%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   2,  Average loss: 0.0453, Accuracy: 119/591 (20.1354%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   3,  Average loss: 0.0350, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   4,  Average loss: 0.0334, Accuracy: 278/591 (47.0389%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   5,  Average loss: 0.0322, Accuracy: 281/591 (47.5465%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   6,  Average loss: 0.0321, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   7,  Average loss: 0.0310, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   8,  Average loss: 0.0299, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   9,  Average loss: 0.0298, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch  10,  Average loss: 0.0299, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Global model norm: 115.14288423112606.
Norm before scaling: 114.57378132534294. Distance: 4.85188152351614
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.5903, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 2.0967, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 482.947266790071, distance: 485.1881561569697
Total norm for 4 adversaries is: 482.947266790071. distance: 485.1881561569697
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   1,  Average loss: 0.0585, Accuracy: 8/568 (1.4085%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   2,  Average loss: 0.0423, Accuracy: 131/568 (23.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   3,  Average loss: 0.0336, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   4,  Average loss: 0.0325, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   5,  Average loss: 0.0312, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   6,  Average loss: 0.0307, Accuracy: 223/568 (39.2606%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   7,  Average loss: 0.0294, Accuracy: 226/568 (39.7887%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   8,  Average loss: 0.0284, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   9,  Average loss: 0.0281, Accuracy: 227/568 (39.9648%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch  10,  Average loss: 0.0276, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Global model norm: 115.14288423112606.
Norm before scaling: 114.64554324498401. Distance: 4.286207683862752
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.6079, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 2.1395, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 428.6118582120658, distance: 428.62075311398536
Total norm for 4 adversaries is: 428.6118582120658. distance: 428.62075311398536
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   1,  Average loss: 0.0543, Accuracy: 22/557 (3.9497%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   2,  Average loss: 0.0436, Accuracy: 79/557 (14.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   3,  Average loss: 0.0373, Accuracy: 116/557 (20.8259%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   4,  Average loss: 0.0364, Accuracy: 116/557 (20.8259%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   5,  Average loss: 0.0353, Accuracy: 121/557 (21.7235%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   6,  Average loss: 0.0344, Accuracy: 120/557 (21.5440%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   7,  Average loss: 0.0333, Accuracy: 129/557 (23.1598%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   8,  Average loss: 0.0324, Accuracy: 140/557 (25.1346%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   9,  Average loss: 0.0319, Accuracy: 125/557 (22.4417%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch  10,  Average loss: 0.0322, Accuracy: 119/557 (21.3645%), train_poison_data_count: 180
Global model norm: 115.14288423112606.
Norm before scaling: 114.64401423537123. Distance: 3.6611626380403557
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.5197, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 2.2036, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 366.7357913062209, distance: 366.1162511757707
Total norm for 4 adversaries is: 366.7357913062209. distance: 366.1162511757707
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  37, local model 13, internal_epoch   1,  Average loss: 0.0367, Accuracy: 165/734 (22.4796%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.9679, Accuracy: 1028/10000 (10.2800%)
___Train Local_Simple,  epoch  37, local model 81, internal_epoch   1,  Average loss: 0.0271, Accuracy: 605/1227 (49.3073%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.9968, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  37, local model 37, internal_epoch   1,  Average loss: 0.0505, Accuracy: 154/860 (17.9070%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.4430, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  37, local model 94, internal_epoch   1,  Average loss: 0.0707, Accuracy: 0/150 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.8902, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  37, local model 61, internal_epoch   1,  Average loss: 0.0433, Accuracy: 86/699 (12.3033%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.6924, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  37, local model 57, internal_epoch   1,  Average loss: 0.0588, Accuracy: 7/343 (2.0408%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.7310, Accuracy: 892/10000 (8.9200%)
time spent on training: 99.55859017372131
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 10.2140, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 0.0004, Accuracy: 8968/8968 (100.0000%)
Done in 119.26466035842896 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:38 choose agents : [41, 73, 51, 74, 60, 92, 23, 39, 79, 86]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   1,  Average loss: 0.1179, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   2,  Average loss: 0.0985, Accuracy: 263/606 (43.3993%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   3,  Average loss: 0.0763, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   4,  Average loss: 0.0722, Accuracy: 272/606 (44.8845%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   5,  Average loss: 0.0679, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   6,  Average loss: 0.0667, Accuracy: 267/606 (44.0594%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   7,  Average loss: 0.0635, Accuracy: 267/606 (44.0594%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   8,  Average loss: 0.0583, Accuracy: 270/606 (44.5545%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   9,  Average loss: 0.0562, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch  10,  Average loss: 0.0554, Accuracy: 277/606 (45.7096%), train_poison_data_count: 200
Global model norm: 113.75484622231485.
Norm before scaling: 112.80230217065608. Distance: 6.242537048254349
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 5.4416, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0705, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 614.1297959307951, distance: 624.2536794044549
Total norm for 4 adversaries is: 614.1297959307951. distance: 624.2536794044549
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 854.0318, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   1,  Average loss: 0.0892, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   2,  Average loss: 0.0600, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   3,  Average loss: 0.0368, Accuracy: 195/591 (32.9949%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   4,  Average loss: 0.0359, Accuracy: 196/591 (33.1641%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   5,  Average loss: 0.0339, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   6,  Average loss: 0.0334, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   7,  Average loss: 0.0334, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   8,  Average loss: 0.0326, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   9,  Average loss: 0.0312, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch  10,  Average loss: 0.0307, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Global model norm: 113.75484622231485.
Norm before scaling: 112.98912765726621. Distance: 5.905258176167852
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 5.8897, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.5896, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 583.7907105718624, distance: 590.5257985473623
Total norm for 4 adversaries is: 583.7907105718624. distance: 590.5257985473623
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 795.6562, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   1,  Average loss: 0.0836, Accuracy: 241/568 (42.4296%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   2,  Average loss: 0.0646, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   3,  Average loss: 0.0472, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   4,  Average loss: 0.0434, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   5,  Average loss: 0.0402, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   6,  Average loss: 0.0374, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   7,  Average loss: 0.0351, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   8,  Average loss: 0.0327, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   9,  Average loss: 0.0316, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch  10,  Average loss: 0.0308, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Global model norm: 113.75484622231485.
Norm before scaling: 113.05961940083868. Distance: 5.479207182566407
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 5.9603, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.1836, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 542.5738429006691, distance: 547.9207287555381
Total norm for 4 adversaries is: 542.5738429006691. distance: 547.9207287555381
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 745.3397, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   1,  Average loss: 0.1079, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   2,  Average loss: 0.0900, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   3,  Average loss: 0.0741, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   4,  Average loss: 0.0715, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   5,  Average loss: 0.0674, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   6,  Average loss: 0.0644, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   7,  Average loss: 0.0623, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   8,  Average loss: 0.0586, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   9,  Average loss: 0.0566, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch  10,  Average loss: 0.0572, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Global model norm: 113.75484622231485.
Norm before scaling: 112.94638869282187. Distance: 5.275229730168601
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 5.5744, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0532, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 519.7210790414413, distance: 527.5229852812103
Total norm for 4 adversaries is: 519.7210790414413. distance: 527.5229852812103
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 632.3176, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  38, local model 60, internal_epoch   1,  Average loss: 0.1649, Accuracy: 53/338 (15.6805%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 8.7035, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  38, local model 92, internal_epoch   1,  Average loss: 0.1147, Accuracy: 31/937 (3.3084%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 4.4407, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  38, local model 23, internal_epoch   1,  Average loss: 0.1854, Accuracy: 19/293 (6.4846%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 8.9850, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  38, local model 39, internal_epoch   1,  Average loss: 0.2159, Accuracy: 21/257 (8.1712%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 8.9849, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  38, local model 79, internal_epoch   1,  Average loss: 0.1727, Accuracy: 3/182 (1.6484%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 9.6613, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  38, local model 86, internal_epoch   1,  Average loss: 0.1832, Accuracy: 9/250 (3.6000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 9.3410, Accuracy: 1032/10000 (10.3200%)
time spent on training: 98.51832222938538
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 6.4070, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 15.2068, Accuracy: 0/8968 (0.0000%)
Done in 117.12870597839355 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:39 choose agents : [41, 73, 51, 74, 63, 99, 97, 37, 44, 52]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   1,  Average loss: 0.1643, Accuracy: 32/606 (5.2805%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   2,  Average loss: 0.1212, Accuracy: 16/606 (2.6403%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   3,  Average loss: 0.0919, Accuracy: 6/606 (0.9901%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   4,  Average loss: 0.0892, Accuracy: 5/606 (0.8251%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   5,  Average loss: 0.0849, Accuracy: 7/606 (1.1551%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   6,  Average loss: 0.0806, Accuracy: 5/606 (0.8251%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   7,  Average loss: 0.0765, Accuracy: 180/606 (29.7030%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   8,  Average loss: 0.0758, Accuracy: 248/606 (40.9241%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   9,  Average loss: 0.0731, Accuracy: 256/606 (42.2442%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch  10,  Average loss: 0.0735, Accuracy: 247/606 (40.7591%), train_poison_data_count: 200
Global model norm: 111.81733412551696.
Norm before scaling: 110.83252956318826. Distance: 7.413273696019178
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.3626, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 7.8908, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 731.1955962668266, distance: 741.3273568404177
Total norm for 4 adversaries is: 731.1955962668266. distance: 741.3273568404177
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   1,  Average loss: 0.1157, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   2,  Average loss: 0.1003, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   3,  Average loss: 0.0901, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   4,  Average loss: 0.0889, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   5,  Average loss: 0.0844, Accuracy: 274/591 (46.3621%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   6,  Average loss: 0.0834, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   7,  Average loss: 0.0813, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   8,  Average loss: 0.0796, Accuracy: 255/591 (43.1472%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   9,  Average loss: 0.0784, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch  10,  Average loss: 0.0777, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Global model norm: 111.81733412551696.
Norm before scaling: 110.9160982877373. Distance: 4.680043711661933
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.1933, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 9.6010, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 457.45749461015504, distance: 468.00439033731294
Total norm for 4 adversaries is: 457.45749461015504. distance: 468.00439033731294
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   1,  Average loss: 0.1159, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   2,  Average loss: 0.0960, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   3,  Average loss: 0.0878, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   4,  Average loss: 0.0874, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   5,  Average loss: 0.0859, Accuracy: 225/568 (39.6127%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   6,  Average loss: 0.0824, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   7,  Average loss: 0.0799, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   8,  Average loss: 0.0766, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   9,  Average loss: 0.0766, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch  10,  Average loss: 0.0787, Accuracy: 222/568 (39.0845%), train_poison_data_count: 180
Global model norm: 111.81733412551696.
Norm before scaling: 111.00895146197671. Distance: 4.5821536308784605
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.4667, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 9.9812, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 449.83535182330877, distance: 458.2153560281454
Total norm for 4 adversaries is: 449.83535182330877. distance: 458.2153560281454
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   1,  Average loss: 0.1485, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   2,  Average loss: 0.1170, Accuracy: 19/557 (3.4111%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   3,  Average loss: 0.0978, Accuracy: 22/557 (3.9497%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   4,  Average loss: 0.0922, Accuracy: 34/557 (6.1041%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   5,  Average loss: 0.0883, Accuracy: 28/557 (5.0269%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   6,  Average loss: 0.0871, Accuracy: 32/557 (5.7451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   7,  Average loss: 0.0834, Accuracy: 26/557 (4.6679%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   8,  Average loss: 0.0809, Accuracy: 23/557 (4.1293%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   9,  Average loss: 0.0800, Accuracy: 21/557 (3.7702%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch  10,  Average loss: 0.0804, Accuracy: 27/557 (4.8474%), train_poison_data_count: 180
Global model norm: 111.81733412551696.
Norm before scaling: 110.96251478539949. Distance: 6.112605106877669
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.4793, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 9.0932, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 602.7954928912458, distance: 611.2605060446814
Total norm for 4 adversaries is: 602.7954928912458. distance: 611.2605060446814
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  39, local model 63, internal_epoch   1,  Average loss: 0.0745, Accuracy: 143/889 (16.0855%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.1572, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  39, local model 99, internal_epoch   1,  Average loss: 0.0908, Accuracy: 1/377 (0.2653%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 5.4841, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  39, local model 97, internal_epoch   1,  Average loss: 0.0923, Accuracy: 22/487 (4.5175%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 5.2585, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  39, local model 37, internal_epoch   1,  Average loss: 0.1330, Accuracy: 164/860 (19.0698%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.7326, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  39, local model 44, internal_epoch   1,  Average loss: 0.0958, Accuracy: 18/517 (3.4816%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.7723, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  39, local model 52, internal_epoch   1,  Average loss: 0.0945, Accuracy: 3/253 (1.1858%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 5.8966, Accuracy: 980/10000 (9.8000%)
time spent on training: 97.75415682792664
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 5.5031, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 0.1220, Accuracy: 8968/8968 (100.0000%)
Done in 114.94513010978699 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:40 choose agents : [41, 73, 51, 74, 88, 25, 28, 8, 16, 6]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   1,  Average loss: 0.0359, Accuracy: 270/606 (44.5545%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   2,  Average loss: 0.0276, Accuracy: 256/606 (42.2442%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   3,  Average loss: 0.0315, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   4,  Average loss: 0.0292, Accuracy: 254/606 (41.9142%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   5,  Average loss: 0.0282, Accuracy: 257/606 (42.4092%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   6,  Average loss: 0.0298, Accuracy: 249/606 (41.0891%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   7,  Average loss: 0.0280, Accuracy: 251/606 (41.4191%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   8,  Average loss: 0.0278, Accuracy: 260/606 (42.9043%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   9,  Average loss: 0.0293, Accuracy: 247/606 (40.7591%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch  10,  Average loss: 0.0287, Accuracy: 251/606 (41.4191%), train_poison_data_count: 200
Global model norm: 109.80974758218188.
Norm before scaling: 109.24299623574272. Distance: 2.197543927687779
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.6915, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.8355, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 217.8360012429075, distance: 219.75439059891386
Total norm for 4 adversaries is: 217.8360012429075. distance: 219.75439059891386
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 282.3213, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   1,  Average loss: 0.1117, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   2,  Average loss: 0.0935, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   3,  Average loss: 0.0826, Accuracy: 196/591 (33.1641%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   4,  Average loss: 0.0786, Accuracy: 196/591 (33.1641%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   5,  Average loss: 0.0766, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   6,  Average loss: 0.0747, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   7,  Average loss: 0.0737, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   8,  Average loss: 0.0714, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   9,  Average loss: 0.0703, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch  10,  Average loss: 0.0699, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Global model norm: 109.80974758218188.
Norm before scaling: 108.95329417920323. Distance: 5.05504860391465
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.3780, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.7732, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 496.28831716049893, distance: 505.50491466453616
Total norm for 4 adversaries is: 496.28831716049893. distance: 505.50491466453616
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 658.0975, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0800, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   2,  Average loss: 0.0654, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   3,  Average loss: 0.0563, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   4,  Average loss: 0.0546, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   5,  Average loss: 0.0527, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   6,  Average loss: 0.0523, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   7,  Average loss: 0.0500, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   8,  Average loss: 0.0495, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   9,  Average loss: 0.0465, Accuracy: 244/568 (42.9577%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch  10,  Average loss: 0.0471, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Global model norm: 109.80974758218188.
Norm before scaling: 109.16300437161621. Distance: 4.224861521962672
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.6536, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.6795, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 417.8587343528911, distance: 422.48616841264754
Total norm for 4 adversaries is: 417.8587343528911. distance: 422.48616841264754
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 558.4149, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   1,  Average loss: 0.0426, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   2,  Average loss: 0.0349, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   3,  Average loss: 0.0308, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   4,  Average loss: 0.0306, Accuracy: 228/557 (40.9336%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   5,  Average loss: 0.0304, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   6,  Average loss: 0.0312, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   7,  Average loss: 0.0312, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   8,  Average loss: 0.0309, Accuracy: 228/557 (40.9336%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   9,  Average loss: 0.0303, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch  10,  Average loss: 0.0300, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Global model norm: 109.80974758218188.
Norm before scaling: 109.30219451851139. Distance: 2.603834654942268
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.1573, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.9033, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 260.8806000836398, distance: 260.38346121633765
Total norm for 4 adversaries is: 260.8806000836398. distance: 260.38346121633765
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 297.4228, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  40, local model 88, internal_epoch   1,  Average loss: 0.0740, Accuracy: 88/530 (16.6038%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.0937, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  40, local model 25, internal_epoch   1,  Average loss: 0.0664, Accuracy: 247/647 (38.1762%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.9794, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  40, local model 28, internal_epoch   1,  Average loss: 0.0830, Accuracy: 10/501 (1.9960%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.0614, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  40, local model 8, internal_epoch   1,  Average loss: 0.0493, Accuracy: 192/633 (30.3318%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.1070, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  40, local model 16, internal_epoch   1,  Average loss: 0.1016, Accuracy: 92/915 (10.0546%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.4960, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  40, local model 6, internal_epoch   1,  Average loss: 0.0523, Accuracy: 187/615 (30.4065%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.0765, Accuracy: 1032/10000 (10.3200%)
time spent on training: 103.18788766860962
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 3.0612, Accuracy: 1135/10000 (11.3500%)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 6.6671, Accuracy: 0/8968 (0.0000%)
Done in 120.45416522026062 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:41 choose agents : [41, 73, 51, 74, 3, 23, 44, 27, 86, 37]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   1,  Average loss: 0.0663, Accuracy: 203/606 (33.4983%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   2,  Average loss: 0.0500, Accuracy: 257/606 (42.4092%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   3,  Average loss: 0.0407, Accuracy: 246/606 (40.5941%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   4,  Average loss: 0.0385, Accuracy: 254/606 (41.9142%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   5,  Average loss: 0.0364, Accuracy: 255/606 (42.0792%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   6,  Average loss: 0.0353, Accuracy: 246/606 (40.5941%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   7,  Average loss: 0.0330, Accuracy: 256/606 (42.2442%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   8,  Average loss: 0.0313, Accuracy: 261/606 (43.0693%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   9,  Average loss: 0.0314, Accuracy: 248/606 (40.9241%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch  10,  Average loss: 0.0310, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Global model norm: 107.54383190704151.
Norm before scaling: 106.9703019899098. Distance: 4.678299075387286
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.7906, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 2.3174, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 464.69237135980615, distance: 467.82991367055615
Total norm for 4 adversaries is: 464.69237135980615. distance: 467.82991367055615
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   1,  Average loss: 0.0861, Accuracy: 0/591 (0.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   2,  Average loss: 0.0644, Accuracy: 7/591 (1.1844%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   3,  Average loss: 0.0488, Accuracy: 43/591 (7.2758%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   4,  Average loss: 0.0464, Accuracy: 40/591 (6.7682%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   5,  Average loss: 0.0439, Accuracy: 163/591 (27.5804%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   6,  Average loss: 0.0418, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   7,  Average loss: 0.0397, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   8,  Average loss: 0.0379, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   9,  Average loss: 0.0370, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch  10,  Average loss: 0.0366, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Global model norm: 107.54383190704151.
Norm before scaling: 106.93219869238405. Distance: 5.48336234891842
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.3846, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 2.7542, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 544.1633486371533, distance: 548.3362620235871
Total norm for 4 adversaries is: 544.1633486371533. distance: 548.3362620235871
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 17.8761, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0655, Accuracy: 22/568 (3.8732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   2,  Average loss: 0.0520, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   3,  Average loss: 0.0422, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   4,  Average loss: 0.0419, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   5,  Average loss: 0.0394, Accuracy: 246/568 (43.3099%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   6,  Average loss: 0.0383, Accuracy: 244/568 (42.9577%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   7,  Average loss: 0.0377, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   8,  Average loss: 0.0361, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   9,  Average loss: 0.0353, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch  10,  Average loss: 0.0347, Accuracy: 248/568 (43.6620%), train_poison_data_count: 180
Global model norm: 107.54383190704151.
Norm before scaling: 107.03302462032454. Distance: 4.120772304925144
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.7711, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 3.1338, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 410.74887781343966, distance: 412.0772265304163
Total norm for 4 adversaries is: 410.74887781343966. distance: 412.0772265304163
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   1,  Average loss: 0.0592, Accuracy: 105/557 (18.8510%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   2,  Average loss: 0.0515, Accuracy: 120/557 (21.5440%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   3,  Average loss: 0.0447, Accuracy: 124/557 (22.2621%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   4,  Average loss: 0.0427, Accuracy: 134/557 (24.0575%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   5,  Average loss: 0.0419, Accuracy: 124/557 (22.2621%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   6,  Average loss: 0.0410, Accuracy: 135/557 (24.2370%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   7,  Average loss: 0.0397, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   8,  Average loss: 0.0384, Accuracy: 129/557 (23.1598%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   9,  Average loss: 0.0377, Accuracy: 130/557 (23.3393%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch  10,  Average loss: 0.0372, Accuracy: 131/557 (23.5189%), train_poison_data_count: 180
Global model norm: 107.54383190704151.
Norm before scaling: 107.04150042156547. Distance: 3.4431192419281302
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.6961, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 3.1833, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 343.7321586279061, distance: 344.31192707340244
Total norm for 4 adversaries is: 343.7321586279061. distance: 344.31192707340244
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  41, local model 3, internal_epoch   1,  Average loss: 0.0392, Accuracy: 258/923 (27.9523%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.3399, Accuracy: 1028/10000 (10.2800%)
___Train Local_Simple,  epoch  41, local model 23, internal_epoch   1,  Average loss: 0.0388, Accuracy: 86/293 (29.3515%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.0508, Accuracy: 1135/10000 (11.3500%)
___Train Local_Simple,  epoch  41, local model 44, internal_epoch   1,  Average loss: 0.0396, Accuracy: 228/517 (44.1006%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.0946, Accuracy: 1135/10000 (11.3500%)
___Train Local_Simple,  epoch  41, local model 27, internal_epoch   1,  Average loss: 0.0434, Accuracy: 19/471 (4.0340%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.9238, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  41, local model 86, internal_epoch   1,  Average loss: 0.0395, Accuracy: 32/250 (12.8000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.0363, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  41, local model 37, internal_epoch   1,  Average loss: 0.0664, Accuracy: 127/860 (14.7674%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.4927, Accuracy: 892/10000 (8.9200%)
time spent on training: 99.92530870437622
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 10.1167, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 0.0004, Accuracy: 8968/8968 (100.0000%)
Done in 118.78238224983215 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:42 choose agents : [41, 73, 51, 74, 23, 35, 29, 48, 11, 43]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   1,  Average loss: 0.0953, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   2,  Average loss: 0.0711, Accuracy: 276/606 (45.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   3,  Average loss: 0.0523, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   4,  Average loss: 0.0491, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   5,  Average loss: 0.0455, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   6,  Average loss: 0.0417, Accuracy: 278/606 (45.8746%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   7,  Average loss: 0.0386, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   8,  Average loss: 0.0358, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   9,  Average loss: 0.0341, Accuracy: 267/606 (44.0594%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch  10,  Average loss: 0.0330, Accuracy: 277/606 (45.7096%), train_poison_data_count: 200
Global model norm: 106.19186828860768.
Norm before scaling: 105.37002787053584. Distance: 6.158957568558078
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 5.4303, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.1018, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 607.8026509484802, distance: 615.8957906983941
Total norm for 4 adversaries is: 607.8026509484802. distance: 615.8957906983941
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 846.0763, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   1,  Average loss: 0.0885, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   2,  Average loss: 0.0589, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   3,  Average loss: 0.0374, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   4,  Average loss: 0.0351, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   5,  Average loss: 0.0337, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   6,  Average loss: 0.0313, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   7,  Average loss: 0.0324, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   8,  Average loss: 0.0322, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   9,  Average loss: 0.0325, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch  10,  Average loss: 0.0307, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Global model norm: 106.19186828860768.
Norm before scaling: 105.44674770500274. Distance: 5.891102900458374
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 5.8239, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.5994, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 582.3122283191381, distance: 589.1102666309594
Total norm for 4 adversaries is: 582.3122283191381. distance: 589.1102666309594
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 794.7322, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   1,  Average loss: 0.0873, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   2,  Average loss: 0.0676, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   3,  Average loss: 0.0487, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   4,  Average loss: 0.0453, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   5,  Average loss: 0.0423, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   6,  Average loss: 0.0397, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   7,  Average loss: 0.0355, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   8,  Average loss: 0.0331, Accuracy: 243/568 (42.7817%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   9,  Average loss: 0.0322, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch  10,  Average loss: 0.0319, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Global model norm: 106.19186828860768.
Norm before scaling: 105.49474216756018. Distance: 5.602699324038028
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 5.7548, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.1630, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 554.331072104027, distance: 560.269912631403
Total norm for 4 adversaries is: 554.331072104027. distance: 560.269912631403
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 763.4218, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   1,  Average loss: 0.1134, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   2,  Average loss: 0.0934, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   3,  Average loss: 0.0797, Accuracy: 215/557 (38.5996%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   4,  Average loss: 0.0760, Accuracy: 217/557 (38.9587%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   5,  Average loss: 0.0719, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   6,  Average loss: 0.0682, Accuracy: 227/557 (40.7540%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   7,  Average loss: 0.0661, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   8,  Average loss: 0.0641, Accuracy: 217/557 (38.9587%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   9,  Average loss: 0.0601, Accuracy: 228/557 (40.9336%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch  10,  Average loss: 0.0605, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Global model norm: 106.19186828860768.
Norm before scaling: 105.36750232816094. Distance: 5.31417479201548
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 5.4500, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0478, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 522.8930339945255, distance: 531.4174736024399
Total norm for 4 adversaries is: 522.8930339945255. distance: 531.4174736024399
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 633.8240, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  42, local model 23, internal_epoch   1,  Average loss: 0.1832, Accuracy: 19/293 (6.4846%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 8.8875, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  42, local model 35, internal_epoch   1,  Average loss: 0.1321, Accuracy: 35/499 (7.0140%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 7.4821, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  42, local model 29, internal_epoch   1,  Average loss: 0.1253, Accuracy: 40/1002 (3.9920%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 3.1388, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  42, local model 48, internal_epoch   1,  Average loss: 0.1213, Accuracy: 77/448 (17.1875%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 8.2116, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  42, local model 11, internal_epoch   1,  Average loss: 0.1634, Accuracy: 2/645 (0.3101%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 5.3767, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  42, local model 43, internal_epoch   1,  Average loss: 0.1885, Accuracy: 0/408 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 7.8130, Accuracy: 1032/10000 (10.3200%)
time spent on training: 104.71093797683716
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 6.3118, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 15.3241, Accuracy: 0/8968 (0.0000%)
Done in 123.05932211875916 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:43 choose agents : [41, 73, 51, 74, 33, 12, 97, 15, 42, 20]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   1,  Average loss: 0.1418, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   2,  Average loss: 0.1084, Accuracy: 127/606 (20.9571%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   3,  Average loss: 0.0937, Accuracy: 257/606 (42.4092%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   4,  Average loss: 0.0933, Accuracy: 245/606 (40.4290%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   5,  Average loss: 0.0891, Accuracy: 249/606 (41.0891%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   6,  Average loss: 0.0881, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   7,  Average loss: 0.0840, Accuracy: 248/606 (40.9241%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   8,  Average loss: 0.0818, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   9,  Average loss: 0.0812, Accuracy: 244/606 (40.2640%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch  10,  Average loss: 0.0802, Accuracy: 248/606 (40.9241%), train_poison_data_count: 200
Global model norm: 104.48971988908765.
Norm before scaling: 103.55037270575129. Distance: 6.075400872210544
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 4.2162, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 9.0136, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 597.3189056107299, distance: 607.5400964133972
Total norm for 4 adversaries is: 597.3189056107299. distance: 607.5400964133972
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   1,  Average loss: 0.1160, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   2,  Average loss: 0.1005, Accuracy: 277/591 (46.8697%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   3,  Average loss: 0.0910, Accuracy: 279/591 (47.2081%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   4,  Average loss: 0.0893, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   5,  Average loss: 0.0881, Accuracy: 260/591 (43.9932%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   6,  Average loss: 0.0856, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   7,  Average loss: 0.0836, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   8,  Average loss: 0.0815, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   9,  Average loss: 0.0824, Accuracy: 256/591 (43.3164%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch  10,  Average loss: 0.0809, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Global model norm: 104.48971988908765.
Norm before scaling: 103.59728500755944. Distance: 4.500437185455374
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 4.3200, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 9.9487, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 439.1601537309595, distance: 450.04367843577137
Total norm for 4 adversaries is: 439.1601537309595. distance: 450.04367843577137
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   1,  Average loss: 0.1183, Accuracy: 46/568 (8.0986%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   2,  Average loss: 0.0991, Accuracy: 215/568 (37.8521%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   3,  Average loss: 0.0904, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   4,  Average loss: 0.0878, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   5,  Average loss: 0.0880, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   6,  Average loss: 0.0851, Accuracy: 227/568 (39.9648%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   7,  Average loss: 0.0821, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   8,  Average loss: 0.0817, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   9,  Average loss: 0.0796, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch  10,  Average loss: 0.0814, Accuracy: 227/568 (39.9648%), train_poison_data_count: 180
Global model norm: 104.48971988908765.
Norm before scaling: 103.68041246873732. Distance: 4.569658072804107
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 4.5176, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 10.2220, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 448.1074264336622, distance: 456.96580834893985
Total norm for 4 adversaries is: 448.1074264336622. distance: 456.96580834893985
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   1,  Average loss: 0.1516, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   2,  Average loss: 0.1225, Accuracy: 10/557 (1.7953%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   3,  Average loss: 0.1063, Accuracy: 26/557 (4.6679%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   4,  Average loss: 0.0992, Accuracy: 29/557 (5.2065%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   5,  Average loss: 0.0972, Accuracy: 26/557 (4.6679%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   6,  Average loss: 0.0942, Accuracy: 27/557 (4.8474%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   7,  Average loss: 0.0909, Accuracy: 28/557 (5.0269%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   8,  Average loss: 0.0879, Accuracy: 27/557 (4.8474%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   9,  Average loss: 0.0863, Accuracy: 28/557 (5.0269%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch  10,  Average loss: 0.0859, Accuracy: 24/557 (4.3088%), train_poison_data_count: 180
Global model norm: 104.48971988908765.
Norm before scaling: 103.61433147735886. Distance: 5.9972664646159775
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 3.5177, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 9.3615, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 590.5728151549138, distance: 599.7266304325664
Total norm for 4 adversaries is: 590.5728151549138. distance: 599.7266304325664
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  43, local model 33, internal_epoch   1,  Average loss: 0.0768, Accuracy: 3/623 (0.4815%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 4.7744, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  43, local model 12, internal_epoch   1,  Average loss: 0.0667, Accuracy: 281/1160 (24.2241%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 4.6527, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  43, local model 97, internal_epoch   1,  Average loss: 0.0910, Accuracy: 25/487 (5.1335%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 5.1532, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  43, local model 15, internal_epoch   1,  Average loss: 0.1125, Accuracy: 1/401 (0.2494%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 5.1192, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  43, local model 42, internal_epoch   1,  Average loss: 0.1273, Accuracy: 1/236 (0.4237%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 5.8215, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  43, local model 20, internal_epoch   1,  Average loss: 0.0743, Accuracy: 9/429 (2.0979%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 5.3179, Accuracy: 980/10000 (9.8000%)
time spent on training: 99.6302878856659
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 5.1973, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 0.1171, Accuracy: 8968/8968 (100.0000%)
Done in 118.70323872566223 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:44 choose agents : [41, 73, 51, 74, 90, 56, 54, 24, 38, 43]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   1,  Average loss: 0.0361, Accuracy: 266/606 (43.8944%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   2,  Average loss: 0.0287, Accuracy: 242/606 (39.9340%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   3,  Average loss: 0.0265, Accuracy: 262/606 (43.2343%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   4,  Average loss: 0.0276, Accuracy: 257/606 (42.4092%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   5,  Average loss: 0.0264, Accuracy: 247/606 (40.7591%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   6,  Average loss: 0.0276, Accuracy: 245/606 (40.4290%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   7,  Average loss: 0.0265, Accuracy: 249/606 (41.0891%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   8,  Average loss: 0.0273, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   9,  Average loss: 0.0281, Accuracy: 244/606 (40.2640%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch  10,  Average loss: 0.0271, Accuracy: 258/606 (42.5743%), train_poison_data_count: 200
Global model norm: 102.43183709179485.
Norm before scaling: 101.8960101034383. Distance: 2.15933857733873
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 4.3489, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.8261, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 213.78733226620326, distance: 215.93386393465477
Total norm for 4 adversaries is: 213.78733226620326. distance: 215.93386393465477
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 277.1830, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   1,  Average loss: 0.1005, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   2,  Average loss: 0.0831, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   3,  Average loss: 0.0712, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   4,  Average loss: 0.0702, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   5,  Average loss: 0.0677, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   6,  Average loss: 0.0643, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   7,  Average loss: 0.0638, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   8,  Average loss: 0.0620, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   9,  Average loss: 0.0605, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch  10,  Average loss: 0.0608, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Global model norm: 102.43183709179485.
Norm before scaling: 101.64022026245318. Distance: 4.97394889577666
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.0596, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.7849, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 489.14750459345083, distance: 497.39493237265697
Total norm for 4 adversaries is: 489.14750459345083. distance: 497.39493237265697
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 651.2742, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   1,  Average loss: 0.0675, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   2,  Average loss: 0.0532, Accuracy: 227/568 (39.9648%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   3,  Average loss: 0.0424, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   4,  Average loss: 0.0420, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   5,  Average loss: 0.0399, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   6,  Average loss: 0.0393, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   7,  Average loss: 0.0379, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   8,  Average loss: 0.0355, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   9,  Average loss: 0.0358, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch  10,  Average loss: 0.0362, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Global model norm: 102.43183709179485.
Norm before scaling: 101.86329495640223. Distance: 4.182759804691185
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.4010, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.7471, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 414.82825889155623, distance: 418.27598170944503
Total norm for 4 adversaries is: 414.82825889155623. distance: 418.27598170944503
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 555.5489, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   1,  Average loss: 0.0423, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   2,  Average loss: 0.0328, Accuracy: 229/557 (41.1131%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   3,  Average loss: 0.0302, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   4,  Average loss: 0.0297, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   5,  Average loss: 0.0298, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   6,  Average loss: 0.0297, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   7,  Average loss: 0.0298, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   8,  Average loss: 0.0292, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   9,  Average loss: 0.0298, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch  10,  Average loss: 0.0292, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Global model norm: 102.43183709179485.
Norm before scaling: 101.95219467966346. Distance: 2.704673808485755
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.7796, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.8822, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 270.38908597149407, distance: 270.4673761519123
Total norm for 4 adversaries is: 270.38908597149407. distance: 270.4673761519123
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 309.6583, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  44, local model 90, internal_epoch   1,  Average loss: 0.0629, Accuracy: 16/683 (2.3426%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.4905, Accuracy: 974/10000 (9.7400%)
___Train Local_Simple,  epoch  44, local model 56, internal_epoch   1,  Average loss: 0.0640, Accuracy: 92/880 (10.4545%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.3928, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  44, local model 54, internal_epoch   1,  Average loss: 0.0688, Accuracy: 53/519 (10.2119%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.5964, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  44, local model 24, internal_epoch   1,  Average loss: 0.0690, Accuracy: 14/379 (3.6939%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 4.0910, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  44, local model 38, internal_epoch   1,  Average loss: 0.0692, Accuracy: 6/895 (0.6704%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.2392, Accuracy: 958/10000 (9.5800%)
___Train Local_Simple,  epoch  44, local model 43, internal_epoch   1,  Average loss: 0.0728, Accuracy: 0/408 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.9178, Accuracy: 1032/10000 (10.3200%)
time spent on training: 103.22232627868652
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 3.1334, Accuracy: 1009/10000 (10.0900%)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 7.2070, Accuracy: 0/8968 (0.0000%)
Done in 122.15977954864502 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:45 choose agents : [41, 73, 51, 74, 32, 62, 8, 35, 96, 27]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   1,  Average loss: 0.0719, Accuracy: 5/606 (0.8251%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   2,  Average loss: 0.0547, Accuracy: 251/606 (41.4191%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   3,  Average loss: 0.0449, Accuracy: 242/606 (39.9340%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   4,  Average loss: 0.0410, Accuracy: 262/606 (43.2343%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   5,  Average loss: 0.0405, Accuracy: 246/606 (40.5941%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   6,  Average loss: 0.0381, Accuracy: 254/606 (41.9142%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   7,  Average loss: 0.0365, Accuracy: 249/606 (41.0891%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   8,  Average loss: 0.0340, Accuracy: 260/606 (42.9043%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   9,  Average loss: 0.0331, Accuracy: 255/606 (42.0792%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch  10,  Average loss: 0.0338, Accuracy: 245/606 (40.4290%), train_poison_data_count: 200
Global model norm: 100.40530169953676.
Norm before scaling: 99.83690802065637. Distance: 4.913495393424235
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.7296, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 2.7454, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 487.55490075477655, distance: 491.34954462174886
Total norm for 4 adversaries is: 487.55490075477655. distance: 491.34954462174886
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   1,  Average loss: 0.0845, Accuracy: 46/591 (7.7834%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   2,  Average loss: 0.0631, Accuracy: 40/591 (6.7682%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   3,  Average loss: 0.0484, Accuracy: 142/591 (24.0271%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   4,  Average loss: 0.0462, Accuracy: 274/591 (46.3621%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   5,  Average loss: 0.0443, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   6,  Average loss: 0.0424, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   7,  Average loss: 0.0405, Accuracy: 272/591 (46.0237%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   8,  Average loss: 0.0393, Accuracy: 259/591 (43.8240%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   9,  Average loss: 0.0388, Accuracy: 249/591 (42.1320%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch  10,  Average loss: 0.0382, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Global model norm: 100.40530169953676.
Norm before scaling: 99.81756307603136. Distance: 5.327885507699494
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.4702, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 3.2532, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 528.5248338536231, distance: 532.7885661779915
Total norm for 4 adversaries is: 528.5248338536231. distance: 532.7885661779915
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0607, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   2,  Average loss: 0.0533, Accuracy: 227/568 (39.9648%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   3,  Average loss: 0.0451, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   4,  Average loss: 0.0445, Accuracy: 226/568 (39.7887%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   5,  Average loss: 0.0430, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   6,  Average loss: 0.0413, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   7,  Average loss: 0.0402, Accuracy: 227/568 (39.9648%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   8,  Average loss: 0.0389, Accuracy: 226/568 (39.7887%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   9,  Average loss: 0.0379, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch  10,  Average loss: 0.0374, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Global model norm: 100.40530169953676.
Norm before scaling: 99.90121585690287. Distance: 3.619404387396749
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.7463, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 3.5974, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 360.1041190579469, distance: 361.94041938902046
Total norm for 4 adversaries is: 360.1041190579469. distance: 361.94041938902046
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   1,  Average loss: 0.0644, Accuracy: 28/557 (5.0269%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   2,  Average loss: 0.0543, Accuracy: 80/557 (14.3627%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   3,  Average loss: 0.0471, Accuracy: 126/557 (22.6212%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   4,  Average loss: 0.0459, Accuracy: 124/557 (22.2621%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   5,  Average loss: 0.0449, Accuracy: 112/557 (20.1077%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   6,  Average loss: 0.0433, Accuracy: 134/557 (24.0575%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   7,  Average loss: 0.0423, Accuracy: 120/557 (21.5440%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   8,  Average loss: 0.0411, Accuracy: 122/557 (21.9031%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   9,  Average loss: 0.0403, Accuracy: 119/557 (21.3645%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch  10,  Average loss: 0.0398, Accuracy: 124/557 (22.2621%), train_poison_data_count: 180
Global model norm: 100.40530169953676.
Norm before scaling: 99.90747184113658. Distance: 3.6564611390274973
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.6624, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 3.5876, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 363.96318924446194, distance: 365.6460891353824
Total norm for 4 adversaries is: 363.96318924446194. distance: 365.6460891353824
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  45, local model 32, internal_epoch   1,  Average loss: 0.0436, Accuracy: 167/977 (17.0931%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.8982, Accuracy: 1010/10000 (10.1000%)
___Train Local_Simple,  epoch  45, local model 62, internal_epoch   1,  Average loss: 0.0525, Accuracy: 95/423 (22.4586%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.9742, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  45, local model 8, internal_epoch   1,  Average loss: 0.0581, Accuracy: 21/633 (3.3175%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.7951, Accuracy: 1135/10000 (11.3500%)
___Train Local_Simple,  epoch  45, local model 35, internal_epoch   1,  Average loss: 0.0604, Accuracy: 2/499 (0.4008%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.7868, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  45, local model 96, internal_epoch   1,  Average loss: 0.0612, Accuracy: 14/672 (2.0833%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.6471, Accuracy: 974/10000 (9.7400%)
___Train Local_Simple,  epoch  45, local model 27, internal_epoch   1,  Average loss: 0.0409, Accuracy: 113/471 (23.9915%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.9825, Accuracy: 1009/10000 (10.0900%)
time spent on training: 94.08947467803955
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 9.6744, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 0.0008, Accuracy: 8968/8968 (100.0000%)
Done in 111.4268126487732 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:46 choose agents : [41, 73, 51, 74, 58, 86, 89, 17, 80, 63]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   1,  Average loss: 0.0833, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   2,  Average loss: 0.0594, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   3,  Average loss: 0.0419, Accuracy: 270/606 (44.5545%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   4,  Average loss: 0.0375, Accuracy: 278/606 (45.8746%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   5,  Average loss: 0.0344, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   6,  Average loss: 0.0328, Accuracy: 268/606 (44.2244%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   7,  Average loss: 0.0305, Accuracy: 264/606 (43.5644%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   8,  Average loss: 0.0272, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   9,  Average loss: 0.0256, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch  10,  Average loss: 0.0254, Accuracy: 278/606 (45.8746%), train_poison_data_count: 200
Global model norm: 99.16117423953037.
Norm before scaling: 98.41816774451503. Distance: 5.964930725462812
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 5.2849, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.2425, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 589.4053147028792, distance: 596.4930846204338
Total norm for 4 adversaries is: 589.4053147028792. distance: 596.4930846204338
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 821.3320, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   1,  Average loss: 0.0844, Accuracy: 196/591 (33.1641%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   2,  Average loss: 0.0551, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   3,  Average loss: 0.0374, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   4,  Average loss: 0.0374, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   5,  Average loss: 0.0362, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   6,  Average loss: 0.0346, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   7,  Average loss: 0.0343, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   8,  Average loss: 0.0353, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   9,  Average loss: 0.0338, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch  10,  Average loss: 0.0338, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Global model norm: 99.16117423953037.
Norm before scaling: 98.44506419350084. Distance: 5.424465824671792
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 5.7953, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.6782, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 535.7126095211872, distance: 542.4465987542
Total norm for 4 adversaries is: 535.7126095211872. distance: 542.4465987542
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 725.6413, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   1,  Average loss: 0.1046, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   2,  Average loss: 0.0834, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   3,  Average loss: 0.0697, Accuracy: 226/568 (39.7887%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   4,  Average loss: 0.0652, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   5,  Average loss: 0.0623, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   6,  Average loss: 0.0579, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   7,  Average loss: 0.0537, Accuracy: 241/568 (42.4296%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   8,  Average loss: 0.0507, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   9,  Average loss: 0.0489, Accuracy: 244/568 (42.9577%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch  10,  Average loss: 0.0487, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Global model norm: 99.16117423953037.
Norm before scaling: 98.38243003231065. Distance: 5.5592034676363555
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 5.3011, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.1004, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 548.0932288397659, distance: 555.9203236525897
Total norm for 4 adversaries is: 548.0932288397659. distance: 555.9203236525897
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 756.1230, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   1,  Average loss: 0.1048, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   2,  Average loss: 0.0854, Accuracy: 227/557 (40.7540%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   3,  Average loss: 0.0730, Accuracy: 216/557 (38.7792%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   4,  Average loss: 0.0681, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   5,  Average loss: 0.0663, Accuracy: 218/557 (39.1382%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   6,  Average loss: 0.0616, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   7,  Average loss: 0.0599, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   8,  Average loss: 0.0568, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   9,  Average loss: 0.0539, Accuracy: 227/557 (40.7540%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch  10,  Average loss: 0.0556, Accuracy: 217/557 (38.9587%), train_poison_data_count: 180
Global model norm: 99.16117423953037.
Norm before scaling: 98.37411649857395. Distance: 5.22739247573175
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 5.1143, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0861, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 514.596443827588, distance: 522.739269378148
Total norm for 4 adversaries is: 514.596443827588. distance: 522.739269378148
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 620.2402, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  46, local model 58, internal_epoch   1,  Average loss: 0.1606, Accuracy: 53/276 (19.2029%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 8.5968, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  46, local model 86, internal_epoch   1,  Average loss: 0.1644, Accuracy: 9/250 (3.6000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 8.8088, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  46, local model 89, internal_epoch   1,  Average loss: 0.1006, Accuracy: 117/492 (23.7805%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 7.5130, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  46, local model 17, internal_epoch   1,  Average loss: 0.1449, Accuracy: 0/620 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 5.6242, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  46, local model 80, internal_epoch   1,  Average loss: 0.1503, Accuracy: 19/431 (4.4084%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 7.4670, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  46, local model 63, internal_epoch   1,  Average loss: 0.1216, Accuracy: 84/889 (9.4488%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 3.9573, Accuracy: 1032/10000 (10.3200%)
time spent on training: 102.0400972366333
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 6.0756, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 14.8759, Accuracy: 0/8968 (0.0000%)
Done in 122.07178568840027 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:47 choose agents : [41, 73, 51, 74, 58, 26, 90, 89, 93, 79]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   1,  Average loss: 0.1270, Accuracy: 41/606 (6.7657%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   2,  Average loss: 0.0991, Accuracy: 229/606 (37.7888%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   3,  Average loss: 0.0876, Accuracy: 259/606 (42.7393%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   4,  Average loss: 0.0875, Accuracy: 245/606 (40.4290%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   5,  Average loss: 0.0831, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   6,  Average loss: 0.0795, Accuracy: 255/606 (42.0792%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   7,  Average loss: 0.0797, Accuracy: 243/606 (40.0990%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   8,  Average loss: 0.0749, Accuracy: 260/606 (42.9043%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   9,  Average loss: 0.0755, Accuracy: 237/606 (39.1089%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch  10,  Average loss: 0.0745, Accuracy: 254/606 (41.9142%), train_poison_data_count: 200
Global model norm: 97.52564766831851.
Norm before scaling: 96.62434811390709. Distance: 5.727658862904169
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.7357, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 8.4097, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 562.8433674211681, distance: 572.7658498461653
Total norm for 4 adversaries is: 562.8433674211681. distance: 572.7658498461653
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   1,  Average loss: 0.1128, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   2,  Average loss: 0.0948, Accuracy: 277/591 (46.8697%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   3,  Average loss: 0.0858, Accuracy: 260/591 (43.9932%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   4,  Average loss: 0.0828, Accuracy: 272/591 (46.0237%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   5,  Average loss: 0.0814, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   6,  Average loss: 0.0799, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   7,  Average loss: 0.0771, Accuracy: 272/591 (46.0237%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   8,  Average loss: 0.0758, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   9,  Average loss: 0.0758, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch  10,  Average loss: 0.0748, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Global model norm: 97.52564766831851.
Norm before scaling: 96.6618421030243. Distance: 4.724072214903788
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.6794, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 9.1145, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 462.2490366404239, distance: 472.40721641926683
Total norm for 4 adversaries is: 462.2490366404239. distance: 472.40721641926683
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   1,  Average loss: 0.1322, Accuracy: 46/568 (8.0986%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   2,  Average loss: 0.0975, Accuracy: 40/568 (7.0423%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   3,  Average loss: 0.0832, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   4,  Average loss: 0.0815, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   5,  Average loss: 0.0797, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   6,  Average loss: 0.0773, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   7,  Average loss: 0.0757, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   8,  Average loss: 0.0734, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   9,  Average loss: 0.0735, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch  10,  Average loss: 0.0743, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Global model norm: 97.52564766831851.
Norm before scaling: 96.73325820103187. Distance: 5.700745637543795
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.6877, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 9.1841, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 562.0085631020225, distance: 570.0745839361723
Total norm for 4 adversaries is: 562.0085631020225. distance: 570.0745839361723
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   1,  Average loss: 0.1423, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   2,  Average loss: 0.1098, Accuracy: 4/557 (0.7181%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   3,  Average loss: 0.0899, Accuracy: 10/557 (1.7953%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   4,  Average loss: 0.0872, Accuracy: 17/557 (3.0521%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   5,  Average loss: 0.0857, Accuracy: 17/557 (3.0521%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   6,  Average loss: 0.0823, Accuracy: 16/557 (2.8725%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   7,  Average loss: 0.0816, Accuracy: 17/557 (3.0521%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   8,  Average loss: 0.0796, Accuracy: 13/557 (2.3339%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   9,  Average loss: 0.0779, Accuracy: 12/557 (2.1544%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch  10,  Average loss: 0.0770, Accuracy: 16/557 (2.8725%), train_poison_data_count: 180
Global model norm: 97.52564766831851.
Norm before scaling: 96.7093392029048. Distance: 6.0280028778251555
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.2240, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 8.8769, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 594.4663047641977, distance: 602.8003141588432
Total norm for 4 adversaries is: 594.4663047641977. distance: 602.8003141588432
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  47, local model 58, internal_epoch   1,  Average loss: 0.1295, Accuracy: 0/276 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 5.1076, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  47, local model 26, internal_epoch   1,  Average loss: 0.1299, Accuracy: 39/554 (7.0397%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 4.2191, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  47, local model 90, internal_epoch   1,  Average loss: 0.0754, Accuracy: 5/683 (0.7321%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.8773, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  47, local model 89, internal_epoch   1,  Average loss: 0.0748, Accuracy: 198/492 (40.2439%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 5.1180, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  47, local model 93, internal_epoch   1,  Average loss: 0.0609, Accuracy: 211/623 (33.8684%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 4.3782, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  47, local model 79, internal_epoch   1,  Average loss: 0.0759, Accuracy: 38/182 (20.8791%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 5.7465, Accuracy: 980/10000 (9.8000%)
time spent on training: 97.34423494338989
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 5.3256, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 0.1590, Accuracy: 8968/8968 (100.0000%)
Done in 116.48465776443481 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:48 choose agents : [41, 73, 51, 74, 36, 67, 87, 65, 30, 98]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   1,  Average loss: 0.0649, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   2,  Average loss: 0.0513, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   3,  Average loss: 0.0411, Accuracy: 268/606 (44.2244%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   4,  Average loss: 0.0371, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   5,  Average loss: 0.0392, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   6,  Average loss: 0.0350, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   7,  Average loss: 0.0359, Accuracy: 268/606 (44.2244%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   8,  Average loss: 0.0344, Accuracy: 277/606 (45.7096%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   9,  Average loss: 0.0332, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch  10,  Average loss: 0.0345, Accuracy: 278/606 (45.8746%), train_poison_data_count: 200
Global model norm: 95.89456490398713.
Norm before scaling: 95.28390964638258. Distance: 4.378681922359429
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.7721, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.7152, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 432.8194809906319, distance: 437.8681843603164
Total norm for 4 adversaries is: 432.8194809906319. distance: 437.8681843603164
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 559.1439, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   1,  Average loss: 0.1171, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   2,  Average loss: 0.1006, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   3,  Average loss: 0.0868, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   4,  Average loss: 0.0853, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   5,  Average loss: 0.0834, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   6,  Average loss: 0.0825, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   7,  Average loss: 0.0793, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   8,  Average loss: 0.0774, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   9,  Average loss: 0.0768, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch  10,  Average loss: 0.0780, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Global model norm: 95.89456490398713.
Norm before scaling: 95.01232444727894. Distance: 4.923931551992872
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.3940, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.7694, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 482.0578122746275, distance: 492.39315148060297
Total norm for 4 adversaries is: 482.0578122746275. distance: 492.39315148060297
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 639.2404, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   1,  Average loss: 0.0375, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   2,  Average loss: 0.0330, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   3,  Average loss: 0.0342, Accuracy: 227/568 (39.9648%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   4,  Average loss: 0.0336, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   5,  Average loss: 0.0333, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   6,  Average loss: 0.0330, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   7,  Average loss: 0.0344, Accuracy: 222/568 (39.0845%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   8,  Average loss: 0.0326, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   9,  Average loss: 0.0312, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch  10,  Average loss: 0.0309, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Global model norm: 95.89456490398713.
Norm before scaling: 95.42520999780405. Distance: 1.8930997808671401
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 4.5461, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.8948, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 188.9336647807902, distance: 189.30997233373628
Total norm for 4 adversaries is: 188.9336647807902. distance: 189.30997233373628
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 236.2974, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0407, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   2,  Average loss: 0.0326, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   3,  Average loss: 0.0289, Accuracy: 228/557 (40.9336%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   4,  Average loss: 0.0299, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   5,  Average loss: 0.0298, Accuracy: 218/557 (39.1382%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   6,  Average loss: 0.0282, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   7,  Average loss: 0.0289, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   8,  Average loss: 0.0283, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   9,  Average loss: 0.0289, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch  10,  Average loss: 0.0282, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Global model norm: 95.89456490398713.
Norm before scaling: 95.4428156263608. Distance: 2.6125197049360604
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 4.0593, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.8860, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 261.0022748943005, distance: 261.25195872471465
Total norm for 4 adversaries is: 261.0022748943005. distance: 261.25195872471465
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 297.1523, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  48, local model 36, internal_epoch   1,  Average loss: 0.0648, Accuracy: 169/1005 (16.8159%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.7193, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  48, local model 67, internal_epoch   1,  Average loss: 0.0512, Accuracy: 82/998 (8.2164%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.6548, Accuracy: 1010/10000 (10.1000%)
___Train Local_Simple,  epoch  48, local model 87, internal_epoch   1,  Average loss: 0.0449, Accuracy: 270/470 (57.4468%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 4.7215, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  48, local model 65, internal_epoch   1,  Average loss: 0.1310, Accuracy: 5/371 (1.3477%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 4.3115, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  48, local model 30, internal_epoch   1,  Average loss: 0.0825, Accuracy: 105/400 (26.2500%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 4.3580, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  48, local model 98, internal_epoch   1,  Average loss: 0.0507, Accuracy: 45/818 (5.5012%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.9097, Accuracy: 982/10000 (9.8200%)
time spent on training: 104.24432396888733
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 3.3364, Accuracy: 892/10000 (8.9200%)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 6.4891, Accuracy: 0/8968 (0.0000%)
Done in 124.71734499931335 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:49 choose agents : [41, 73, 51, 74, 25, 54, 52, 46, 6, 35]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   1,  Average loss: 0.0638, Accuracy: 256/606 (42.2442%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   2,  Average loss: 0.0486, Accuracy: 262/606 (43.2343%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   3,  Average loss: 0.0387, Accuracy: 266/606 (43.8944%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   4,  Average loss: 0.0385, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   5,  Average loss: 0.0369, Accuracy: 249/606 (41.0891%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   6,  Average loss: 0.0351, Accuracy: 254/606 (41.9142%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   7,  Average loss: 0.0329, Accuracy: 258/606 (42.5743%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   8,  Average loss: 0.0319, Accuracy: 251/606 (41.4191%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   9,  Average loss: 0.0321, Accuracy: 239/606 (39.4389%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch  10,  Average loss: 0.0312, Accuracy: 253/606 (41.7492%), train_poison_data_count: 200
Global model norm: 93.79100145069889.
Norm before scaling: 93.26135675649641. Distance: 4.487489051061678
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.9535, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 2.1069, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 445.25429882820896, distance: 448.74888579248864
Total norm for 4 adversaries is: 445.25429882820896. distance: 448.74888579248864
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   1,  Average loss: 0.0978, Accuracy: 5/591 (0.8460%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   2,  Average loss: 0.0737, Accuracy: 7/591 (1.1844%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   3,  Average loss: 0.0566, Accuracy: 6/591 (1.0152%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   4,  Average loss: 0.0538, Accuracy: 36/591 (6.0914%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   5,  Average loss: 0.0514, Accuracy: 36/591 (6.0914%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   6,  Average loss: 0.0484, Accuracy: 42/591 (7.1066%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   7,  Average loss: 0.0456, Accuracy: 48/591 (8.1218%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   8,  Average loss: 0.0433, Accuracy: 39/591 (6.5990%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   9,  Average loss: 0.0419, Accuracy: 42/591 (7.1066%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch  10,  Average loss: 0.0415, Accuracy: 48/591 (8.1218%), train_poison_data_count: 195
Global model norm: 93.79100145069889.
Norm before scaling: 93.16212556948773. Distance: 5.825171655573295
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.3354, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 2.3045, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 577.037720820745, distance: 582.5171403057595
Total norm for 4 adversaries is: 577.037720820745. distance: 582.5171403057595
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 52.8783, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   1,  Average loss: 0.0657, Accuracy: 8/568 (1.4085%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   2,  Average loss: 0.0522, Accuracy: 155/568 (27.2887%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   3,  Average loss: 0.0437, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   4,  Average loss: 0.0420, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   5,  Average loss: 0.0402, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   6,  Average loss: 0.0396, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   7,  Average loss: 0.0388, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   8,  Average loss: 0.0367, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   9,  Average loss: 0.0364, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch  10,  Average loss: 0.0361, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Global model norm: 93.79100145069889.
Norm before scaling: 93.31589076223834. Distance: 4.213289471007648
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.9344, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 2.9559, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 419.10622907563663, distance: 421.32894289972535
Total norm for 4 adversaries is: 419.10622907563663. distance: 421.32894289972535
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0589, Accuracy: 17/557 (3.0521%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   2,  Average loss: 0.0497, Accuracy: 112/557 (20.1077%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   3,  Average loss: 0.0433, Accuracy: 125/557 (22.4417%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   4,  Average loss: 0.0418, Accuracy: 125/557 (22.4417%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   5,  Average loss: 0.0410, Accuracy: 119/557 (21.3645%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   6,  Average loss: 0.0396, Accuracy: 120/557 (21.5440%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   7,  Average loss: 0.0382, Accuracy: 124/557 (22.2621%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   8,  Average loss: 0.0370, Accuracy: 126/557 (22.6212%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   9,  Average loss: 0.0363, Accuracy: 131/557 (23.5189%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch  10,  Average loss: 0.0364, Accuracy: 131/557 (23.5189%), train_poison_data_count: 180
Global model norm: 93.79100145069889.
Norm before scaling: 93.33242419572096. Distance: 3.5350647972459486
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.8654, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 2.9677, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 352.040946659618, distance: 353.5064753650207
Total norm for 4 adversaries is: 352.040946659618. distance: 353.5064753650207
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  49, local model 25, internal_epoch   1,  Average loss: 0.0598, Accuracy: 30/647 (4.6368%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.9456, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  49, local model 54, internal_epoch   1,  Average loss: 0.0459, Accuracy: 17/519 (3.2755%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 3.1385, Accuracy: 1028/10000 (10.2800%)
___Train Local_Simple,  epoch  49, local model 52, internal_epoch   1,  Average loss: 0.0404, Accuracy: 0/253 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 3.2605, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  49, local model 46, internal_epoch   1,  Average loss: 0.0488, Accuracy: 58/710 (8.1690%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 3.0012, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  49, local model 6, internal_epoch   1,  Average loss: 0.0565, Accuracy: 50/615 (8.1301%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.9674, Accuracy: 1135/10000 (11.3500%)
___Train Local_Simple,  epoch  49, local model 35, internal_epoch   1,  Average loss: 0.0777, Accuracy: 14/499 (2.8056%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.9482, Accuracy: 892/10000 (8.9200%)
time spent on training: 102.31470251083374
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 10.2538, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 0.0002, Accuracy: 8968/8968 (100.0000%)
Done in 120.45207476615906 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:50 choose agents : [41, 73, 51, 74, 17, 20, 77, 44, 8, 78]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   1,  Average loss: 0.1113, Accuracy: 266/606 (43.8944%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   2,  Average loss: 0.0821, Accuracy: 282/606 (46.5347%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   3,  Average loss: 0.0648, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   4,  Average loss: 0.0611, Accuracy: 272/606 (44.8845%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   5,  Average loss: 0.0579, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   6,  Average loss: 0.0552, Accuracy: 269/606 (44.3894%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   7,  Average loss: 0.0503, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   8,  Average loss: 0.0466, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   9,  Average loss: 0.0450, Accuracy: 272/606 (44.8845%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch  10,  Average loss: 0.0438, Accuracy: 277/606 (45.7096%), train_poison_data_count: 200
Global model norm: 92.70154879201048.
Norm before scaling: 91.80831976528597. Distance: 6.258050235418652
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 5.4236, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0436, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 616.30200084861, distance: 625.8050065715358
Total norm for 4 adversaries is: 616.30200084861. distance: 625.8050065715358
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 858.6288, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   1,  Average loss: 0.0974, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   2,  Average loss: 0.0680, Accuracy: 196/591 (33.1641%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   3,  Average loss: 0.0439, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   4,  Average loss: 0.0397, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   5,  Average loss: 0.0378, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   6,  Average loss: 0.0340, Accuracy: 196/591 (33.1641%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   7,  Average loss: 0.0329, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   8,  Average loss: 0.0304, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   9,  Average loss: 0.0287, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch  10,  Average loss: 0.0306, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Global model norm: 92.70154879201048.
Norm before scaling: 91.93124341389601. Distance: 6.41870306159429
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 5.3730, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.4210, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 634.2308087360626, distance: 641.8702896613926
Total norm for 4 adversaries is: 634.2308087360626. distance: 641.8702896613926
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 869.1953, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0872, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   2,  Average loss: 0.0642, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   3,  Average loss: 0.0479, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   4,  Average loss: 0.0451, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   5,  Average loss: 0.0415, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   6,  Average loss: 0.0373, Accuracy: 248/568 (43.6620%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   7,  Average loss: 0.0352, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   8,  Average loss: 0.0321, Accuracy: 241/568 (42.4296%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   9,  Average loss: 0.0316, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch  10,  Average loss: 0.0308, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Global model norm: 92.70154879201048.
Norm before scaling: 92.02244227802531. Distance: 5.5397039776428585
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 5.9359, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.1756, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 547.5976796426369, distance: 553.9704132442454
Total norm for 4 adversaries is: 547.5976796426369. distance: 553.9704132442454
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 754.1263, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   1,  Average loss: 0.1117, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   2,  Average loss: 0.0923, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   3,  Average loss: 0.0766, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   4,  Average loss: 0.0740, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   5,  Average loss: 0.0710, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   6,  Average loss: 0.0684, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   7,  Average loss: 0.0639, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   8,  Average loss: 0.0610, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   9,  Average loss: 0.0604, Accuracy: 217/557 (38.9587%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch  10,  Average loss: 0.0595, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Global model norm: 92.70154879201048.
Norm before scaling: 91.87695576149659. Distance: 5.310811211929846
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 5.5683, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0327, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 522.1111591414227, distance: 531.0810907949934
Total norm for 4 adversaries is: 522.1111591414227. distance: 531.0810907949934
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 634.2560, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.1565, Accuracy: 0/620 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 6.1432, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  50, local model 20, internal_epoch   1,  Average loss: 0.1812, Accuracy: 21/429 (4.8951%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 8.0762, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  50, local model 77, internal_epoch   1,  Average loss: 0.1555, Accuracy: 61/589 (10.3565%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 6.5520, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  50, local model 44, internal_epoch   1,  Average loss: 0.1727, Accuracy: 25/517 (4.8356%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 6.9264, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  50, local model 8, internal_epoch   1,  Average loss: 0.1179, Accuracy: 192/633 (30.3318%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 7.3317, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  50, local model 78, internal_epoch   1,  Average loss: 0.1894, Accuracy: 2/303 (0.6601%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 8.9435, Accuracy: 1032/10000 (10.3200%)
time spent on training: 98.09757208824158
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 5.9663, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 15.2750, Accuracy: 0/8968 (0.0000%)
Done in 115.8268530368805 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:51 choose agents : [41, 73, 51, 74, 3, 39, 14, 32, 4, 30]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   1,  Average loss: 0.1472, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   2,  Average loss: 0.1112, Accuracy: 45/606 (7.4257%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   3,  Average loss: 0.0919, Accuracy: 256/606 (42.2442%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   4,  Average loss: 0.0894, Accuracy: 249/606 (41.0891%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   5,  Average loss: 0.0868, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   6,  Average loss: 0.0857, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   7,  Average loss: 0.0829, Accuracy: 254/606 (41.9142%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   8,  Average loss: 0.0801, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   9,  Average loss: 0.0785, Accuracy: 259/606 (42.7393%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch  10,  Average loss: 0.0766, Accuracy: 260/606 (42.9043%), train_poison_data_count: 200
Global model norm: 91.20640546824275.
Norm before scaling: 90.25593492431675. Distance: 6.498109982880359
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 3.7452, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 8.8897, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 639.611552037641, distance: 649.8110061779502
Total norm for 4 adversaries is: 639.611552037641. distance: 649.8110061779502
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   1,  Average loss: 0.1162, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   2,  Average loss: 0.1013, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   3,  Average loss: 0.0904, Accuracy: 276/591 (46.7005%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   4,  Average loss: 0.0888, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   5,  Average loss: 0.0871, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   6,  Average loss: 0.0845, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   7,  Average loss: 0.0829, Accuracy: 260/591 (43.9932%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   8,  Average loss: 0.0811, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   9,  Average loss: 0.0807, Accuracy: 257/591 (43.4856%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch  10,  Average loss: 0.0795, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Global model norm: 91.20640546824275.
Norm before scaling: 90.31603042407532. Distance: 4.61062325854926
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 4.0463, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 9.9642, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 450.1210948178279, distance: 461.06232631825384
Total norm for 4 adversaries is: 450.1210948178279. distance: 461.06232631825384
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   1,  Average loss: 0.1121, Accuracy: 141/568 (24.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   2,  Average loss: 0.1007, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   3,  Average loss: 0.0881, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   4,  Average loss: 0.0862, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   5,  Average loss: 0.0876, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   6,  Average loss: 0.0840, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   7,  Average loss: 0.0841, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   8,  Average loss: 0.0808, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   9,  Average loss: 0.0790, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch  10,  Average loss: 0.0791, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Global model norm: 91.20640546824275.
Norm before scaling: 90.39611181488947. Distance: 4.333297778252698
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 4.2517, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 10.2761, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 423.6748642827422, distance: 433.32974958453985
Total norm for 4 adversaries is: 423.6748642827422. distance: 433.32974958453985
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   1,  Average loss: 0.1473, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   2,  Average loss: 0.1187, Accuracy: 26/557 (4.6679%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   3,  Average loss: 0.0984, Accuracy: 28/557 (5.0269%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   4,  Average loss: 0.0961, Accuracy: 29/557 (5.2065%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   5,  Average loss: 0.0931, Accuracy: 22/557 (3.9497%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   6,  Average loss: 0.0897, Accuracy: 25/557 (4.4883%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   7,  Average loss: 0.0874, Accuracy: 29/557 (5.2065%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   8,  Average loss: 0.0838, Accuracy: 29/557 (5.2065%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   9,  Average loss: 0.0832, Accuracy: 28/557 (5.0269%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch  10,  Average loss: 0.0837, Accuracy: 22/557 (3.9497%), train_poison_data_count: 180
Global model norm: 91.20640546824275.
Norm before scaling: 90.33806407219771. Distance: 5.916806107431563
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 3.3195, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 9.4421, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 582.3567152098445, distance: 591.6806042959327
Total norm for 4 adversaries is: 582.3567152098445. distance: 591.6806042959327
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  51, local model 3, internal_epoch   1,  Average loss: 0.0836, Accuracy: 47/923 (5.0921%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 3.9122, Accuracy: 1028/10000 (10.2800%)
___Train Local_Simple,  epoch  51, local model 39, internal_epoch   1,  Average loss: 0.1186, Accuracy: 8/257 (3.1128%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 5.3638, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  51, local model 14, internal_epoch   1,  Average loss: 0.1632, Accuracy: 3/376 (0.7979%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 5.1485, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  51, local model 32, internal_epoch   1,  Average loss: 0.0641, Accuracy: 191/977 (19.5496%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 3.7179, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  51, local model 4, internal_epoch   1,  Average loss: 0.0789, Accuracy: 26/658 (3.9514%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 4.1166, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  51, local model 30, internal_epoch   1,  Average loss: 0.1317, Accuracy: 53/400 (13.2500%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 5.0443, Accuracy: 980/10000 (9.8000%)
time spent on training: 103.26152324676514
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 51: Average loss: 4.9739, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 51: Average loss: 0.2296, Accuracy: 8968/8968 (100.0000%)
Done in 122.93117547035217 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:52 choose agents : [41, 73, 51, 74, 30, 65, 23, 3, 98, 88]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   1,  Average loss: 0.0314, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   2,  Average loss: 0.0291, Accuracy: 253/606 (41.7492%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   3,  Average loss: 0.0259, Accuracy: 259/606 (42.7393%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   4,  Average loss: 0.0262, Accuracy: 261/606 (43.0693%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   5,  Average loss: 0.0284, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   6,  Average loss: 0.0281, Accuracy: 243/606 (40.0990%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   7,  Average loss: 0.0255, Accuracy: 255/606 (42.0792%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   8,  Average loss: 0.0255, Accuracy: 268/606 (44.2244%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   9,  Average loss: 0.0256, Accuracy: 280/606 (46.2046%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch  10,  Average loss: 0.0255, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Global model norm: 89.38538510468308.
Norm before scaling: 88.91548172632818. Distance: 1.5814332938729887
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 4.5028, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.8165, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 156.11055027207482, distance: 158.1433166268812
Total norm for 4 adversaries is: 156.11055027207482. distance: 158.1433166268812
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 186.7054, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   1,  Average loss: 0.0934, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   2,  Average loss: 0.0778, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   3,  Average loss: 0.0648, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   4,  Average loss: 0.0634, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   5,  Average loss: 0.0624, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   6,  Average loss: 0.0601, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   7,  Average loss: 0.0578, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   8,  Average loss: 0.0567, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   9,  Average loss: 0.0554, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch  10,  Average loss: 0.0552, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Global model norm: 89.38538510468308.
Norm before scaling: 88.65212197386337. Distance: 4.885494575882421
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 3.2419, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.7730, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 480.8623601146174, distance: 488.5494473438692
Total norm for 4 adversaries is: 480.8623601146174. distance: 488.5494473438692
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 610.8166, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   1,  Average loss: 0.0839, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   2,  Average loss: 0.0703, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   3,  Average loss: 0.0615, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   4,  Average loss: 0.0590, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   5,  Average loss: 0.0586, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   6,  Average loss: 0.0572, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   7,  Average loss: 0.0536, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   8,  Average loss: 0.0539, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   9,  Average loss: 0.0538, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch  10,  Average loss: 0.0524, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Global model norm: 89.38538510468308.
Norm before scaling: 88.75421975003498. Distance: 4.1141281198034205
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 3.4577, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.6842, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 405.3567680143012, distance: 411.4128287073703
Total norm for 4 adversaries is: 405.3567680143012. distance: 411.4128287073703
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 518.2960, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   1,  Average loss: 0.0428, Accuracy: 218/557 (39.1382%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   2,  Average loss: 0.0347, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   3,  Average loss: 0.0319, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   4,  Average loss: 0.0312, Accuracy: 218/557 (39.1382%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   5,  Average loss: 0.0328, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   6,  Average loss: 0.0321, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   7,  Average loss: 0.0325, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   8,  Average loss: 0.0325, Accuracy: 218/557 (39.1382%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   9,  Average loss: 0.0322, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch  10,  Average loss: 0.0301, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Global model norm: 89.38538510468308.
Norm before scaling: 88.94822987365319. Distance: 2.408350733481867
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 3.9459, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.8972, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 240.03183382626563, distance: 240.83506252983597
Total norm for 4 adversaries is: 240.03183382626563. distance: 240.83506252983597
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 259.2002, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  52, local model 30, internal_epoch   1,  Average loss: 0.0683, Accuracy: 105/400 (26.2500%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 4.1935, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  52, local model 65, internal_epoch   1,  Average loss: 0.1149, Accuracy: 5/371 (1.3477%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 4.0702, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  52, local model 23, internal_epoch   1,  Average loss: 0.0665, Accuracy: 19/293 (6.4846%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 4.3567, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  52, local model 3, internal_epoch   1,  Average loss: 0.0471, Accuracy: 186/923 (20.1517%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 4.0285, Accuracy: 1028/10000 (10.2800%)
___Train Local_Simple,  epoch  52, local model 98, internal_epoch   1,  Average loss: 0.0569, Accuracy: 60/818 (7.3350%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 3.7762, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  52, local model 88, internal_epoch   1,  Average loss: 0.0706, Accuracy: 88/530 (16.6038%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 3.8981, Accuracy: 1032/10000 (10.3200%)
time spent on training: 99.71400499343872
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 52: Average loss: 2.6849, Accuracy: 982/10000 (9.8200%)
___Test Target_Simple poisoned: True, epoch: 52: Average loss: 5.0653, Accuracy: 0/8968 (0.0000%)
Done in 115.23839163780212 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:53 choose agents : [41, 73, 51, 74, 71, 2, 43, 25, 17, 37]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   1,  Average loss: 0.0568, Accuracy: 5/606 (0.8251%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   2,  Average loss: 0.0401, Accuracy: 208/606 (34.3234%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   3,  Average loss: 0.0294, Accuracy: 255/606 (42.0792%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   4,  Average loss: 0.0281, Accuracy: 259/606 (42.7393%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   5,  Average loss: 0.0275, Accuracy: 244/606 (40.2640%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   6,  Average loss: 0.0259, Accuracy: 258/606 (42.5743%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   7,  Average loss: 0.0251, Accuracy: 255/606 (42.0792%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   8,  Average loss: 0.0248, Accuracy: 242/606 (39.9340%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   9,  Average loss: 0.0242, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch  10,  Average loss: 0.0245, Accuracy: 244/606 (40.2640%), train_poison_data_count: 200
Global model norm: 87.41098988310195.
Norm before scaling: 86.99116558952984. Distance: 4.62838270872376
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.7049, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 1.4626, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 460.86438826947784, distance: 462.8382715647011
Total norm for 4 adversaries is: 460.86438826947784. distance: 462.8382715647011
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   1,  Average loss: 0.0593, Accuracy: 5/591 (0.8460%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   2,  Average loss: 0.0426, Accuracy: 175/591 (29.6108%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   3,  Average loss: 0.0346, Accuracy: 253/591 (42.8088%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   4,  Average loss: 0.0336, Accuracy: 251/591 (42.4704%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   5,  Average loss: 0.0323, Accuracy: 258/591 (43.6548%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   6,  Average loss: 0.0313, Accuracy: 258/591 (43.6548%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   7,  Average loss: 0.0303, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   8,  Average loss: 0.0298, Accuracy: 256/591 (43.3164%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   9,  Average loss: 0.0288, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch  10,  Average loss: 0.0293, Accuracy: 259/591 (43.8240%), train_poison_data_count: 195
Global model norm: 87.41098988310195.
Norm before scaling: 86.97851577850274. Distance: 4.345107051816796
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.5763, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 1.9313, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 432.44694400007035, distance: 434.51071620847284
Total norm for 4 adversaries is: 432.44694400007035. distance: 434.51071620847284
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   1,  Average loss: 0.0578, Accuracy: 7/568 (1.2324%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   2,  Average loss: 0.0421, Accuracy: 121/568 (21.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   3,  Average loss: 0.0325, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   4,  Average loss: 0.0314, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   5,  Average loss: 0.0302, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   6,  Average loss: 0.0291, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   7,  Average loss: 0.0279, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   8,  Average loss: 0.0272, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   9,  Average loss: 0.0269, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch  10,  Average loss: 0.0270, Accuracy: 227/568 (39.9648%), train_poison_data_count: 180
Global model norm: 87.41098988310195.
Norm before scaling: 87.02901422173096. Distance: 4.2472224415513695
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.5243, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 1.8980, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 423.7483038314136, distance: 424.72226219024594
Total norm for 4 adversaries is: 423.7483038314136. distance: 424.72226219024594
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   1,  Average loss: 0.0489, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   2,  Average loss: 0.0407, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   3,  Average loss: 0.0357, Accuracy: 122/557 (21.9031%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   4,  Average loss: 0.0347, Accuracy: 122/557 (21.9031%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   5,  Average loss: 0.0338, Accuracy: 122/557 (21.9031%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   6,  Average loss: 0.0331, Accuracy: 124/557 (22.2621%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   7,  Average loss: 0.0322, Accuracy: 122/557 (21.9031%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   8,  Average loss: 0.0318, Accuracy: 119/557 (21.3645%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   9,  Average loss: 0.0313, Accuracy: 122/557 (21.9031%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch  10,  Average loss: 0.0313, Accuracy: 122/557 (21.9031%), train_poison_data_count: 180
Global model norm: 87.41098988310195.
Norm before scaling: 87.02992873772648. Distance: 3.1105497815076526
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.4899, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 1.9994, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 311.0966489694159, distance: 311.0549715283458
Total norm for 4 adversaries is: 311.0966489694159. distance: 311.0549715283458
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  53, local model 71, internal_epoch   1,  Average loss: 0.0305, Accuracy: 451/1384 (32.5867%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.9182, Accuracy: 1135/10000 (11.3500%)
___Train Local_Simple,  epoch  53, local model 2, internal_epoch   1,  Average loss: 0.0579, Accuracy: 20/548 (3.6496%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.3872, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  53, local model 43, internal_epoch   1,  Average loss: 0.0327, Accuracy: 184/408 (45.0980%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.7542, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  53, local model 25, internal_epoch   1,  Average loss: 0.0538, Accuracy: 45/647 (6.9552%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.3974, Accuracy: 1135/10000 (11.3500%)
___Train Local_Simple,  epoch  53, local model 17, internal_epoch   1,  Average loss: 0.0401, Accuracy: 67/620 (10.8065%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.5659, Accuracy: 1028/10000 (10.2800%)
___Train Local_Simple,  epoch  53, local model 37, internal_epoch   1,  Average loss: 0.0490, Accuracy: 67/860 (7.7907%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.4582, Accuracy: 1032/10000 (10.3200%)
time spent on training: 97.73140335083008
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 53: Average loss: 10.2208, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 53: Average loss: 0.0004, Accuracy: 8968/8968 (100.0000%)
Done in 117.38445258140564 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:54 choose agents : [41, 73, 51, 74, 46, 56, 30, 0, 33, 53]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   1,  Average loss: 0.0831, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   2,  Average loss: 0.0591, Accuracy: 277/606 (45.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   3,  Average loss: 0.0421, Accuracy: 269/606 (44.3894%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   4,  Average loss: 0.0379, Accuracy: 276/606 (45.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   5,  Average loss: 0.0356, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   6,  Average loss: 0.0316, Accuracy: 276/606 (45.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   7,  Average loss: 0.0303, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   8,  Average loss: 0.0265, Accuracy: 278/606 (45.8746%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   9,  Average loss: 0.0257, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch  10,  Average loss: 0.0261, Accuracy: 278/606 (45.8746%), train_poison_data_count: 200
Global model norm: 86.68012935049619.
Norm before scaling: 85.94742556317496. Distance: 5.905928991565846
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 5.7948, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.2283, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 583.2468656152384, distance: 590.5928959528721
Total norm for 4 adversaries is: 583.2468656152384. distance: 590.5928959528721
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 810.0436, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   1,  Average loss: 0.0923, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   2,  Average loss: 0.0630, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   3,  Average loss: 0.0392, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   4,  Average loss: 0.0366, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   5,  Average loss: 0.0344, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   6,  Average loss: 0.0315, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   7,  Average loss: 0.0308, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   8,  Average loss: 0.0313, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   9,  Average loss: 0.0314, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch  10,  Average loss: 0.0312, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Global model norm: 86.68012935049619.
Norm before scaling: 85.94576096658287. Distance: 6.065991841326772
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 5.7454, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.5589, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 599.2655922043247, distance: 606.5991520353454
Total norm for 4 adversaries is: 599.2655922043247. distance: 606.5991520353454
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 820.3653, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   1,  Average loss: 0.0805, Accuracy: 241/568 (42.4296%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   2,  Average loss: 0.0597, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   3,  Average loss: 0.0449, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   4,  Average loss: 0.0399, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   5,  Average loss: 0.0370, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   6,  Average loss: 0.0337, Accuracy: 241/568 (42.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   7,  Average loss: 0.0330, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   8,  Average loss: 0.0317, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   9,  Average loss: 0.0301, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch  10,  Average loss: 0.0299, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Global model norm: 86.68012935049619.
Norm before scaling: 86.03422397692967. Distance: 5.378907668391244
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 6.1243, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.2741, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 531.7809993314917, distance: 537.8907591230769
Total norm for 4 adversaries is: 531.7809993314917. distance: 537.8907591230769
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 732.2736, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   1,  Average loss: 0.1168, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   2,  Average loss: 0.0970, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   3,  Average loss: 0.0806, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   4,  Average loss: 0.0789, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   5,  Average loss: 0.0752, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   6,  Average loss: 0.0708, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   7,  Average loss: 0.0687, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   8,  Average loss: 0.0666, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   9,  Average loss: 0.0624, Accuracy: 231/557 (41.4722%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch  10,  Average loss: 0.0633, Accuracy: 228/557 (40.9336%), train_poison_data_count: 180
Global model norm: 86.68012935049619.
Norm before scaling: 85.82225795758056. Distance: 5.305791770820602
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 5.5760, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0572, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 520.974237606813, distance: 530.5791646870427
Total norm for 4 adversaries is: 520.974237606813. distance: 530.5791646870427
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 641.3405, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  54, local model 46, internal_epoch   1,  Average loss: 0.1415, Accuracy: 78/710 (10.9859%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 5.4467, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  54, local model 56, internal_epoch   1,  Average loss: 0.1285, Accuracy: 25/880 (2.8409%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 4.1232, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  54, local model 30, internal_epoch   1,  Average loss: 0.1406, Accuracy: 105/400 (26.2500%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 8.4986, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  54, local model 0, internal_epoch   1,  Average loss: 0.1327, Accuracy: 98/435 (22.5287%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 8.4463, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  54, local model 33, internal_epoch   1,  Average loss: 0.1577, Accuracy: 0/623 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 6.1358, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  54, local model 53, internal_epoch   1,  Average loss: 0.1050, Accuracy: 101/739 (13.6671%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 5.7044, Accuracy: 1032/10000 (10.3200%)
time spent on training: 102.68891596794128
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 54: Average loss: 6.6270, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 54: Average loss: 15.4061, Accuracy: 0/8968 (0.0000%)
Done in 121.353098154068 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:55 choose agents : [41, 73, 51, 74, 17, 65, 6, 24, 86, 35]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   1,  Average loss: 0.1356, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   2,  Average loss: 0.1132, Accuracy: 228/606 (37.6238%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   3,  Average loss: 0.0988, Accuracy: 260/606 (42.9043%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   4,  Average loss: 0.0987, Accuracy: 253/606 (41.7492%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   5,  Average loss: 0.0965, Accuracy: 242/606 (39.9340%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   6,  Average loss: 0.0930, Accuracy: 247/606 (40.7591%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   7,  Average loss: 0.0888, Accuracy: 258/606 (42.5743%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   8,  Average loss: 0.0845, Accuracy: 258/606 (42.5743%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   9,  Average loss: 0.0851, Accuracy: 258/606 (42.5743%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch  10,  Average loss: 0.0859, Accuracy: 249/606 (41.0891%), train_poison_data_count: 200
Global model norm: 85.38738700402419.
Norm before scaling: 84.412763539867. Distance: 5.512642288966655
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 5.0067, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 9.5836, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 539.9955728985192, distance: 551.2642288413061
Total norm for 4 adversaries is: 539.9955728985192. distance: 551.2642288413061
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   1,  Average loss: 0.1211, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   2,  Average loss: 0.1065, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   3,  Average loss: 0.0973, Accuracy: 272/591 (46.0237%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   4,  Average loss: 0.0962, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   5,  Average loss: 0.0945, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   6,  Average loss: 0.0914, Accuracy: 275/591 (46.5313%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   7,  Average loss: 0.0894, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   8,  Average loss: 0.0875, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   9,  Average loss: 0.0874, Accuracy: 259/591 (43.8240%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch  10,  Average loss: 0.0869, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Global model norm: 85.38738700402419.
Norm before scaling: 84.46171759016774. Distance: 4.419446298431151
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 5.0427, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 10.4343, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 430.0354636538712, distance: 441.944619692332
Total norm for 4 adversaries is: 430.0354636538712. distance: 441.944619692332
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   1,  Average loss: 0.1185, Accuracy: 108/568 (19.0141%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   2,  Average loss: 0.1041, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   3,  Average loss: 0.0964, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   4,  Average loss: 0.0939, Accuracy: 224/568 (39.4366%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   5,  Average loss: 0.0919, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   6,  Average loss: 0.0903, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   7,  Average loss: 0.0887, Accuracy: 224/568 (39.4366%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   8,  Average loss: 0.0857, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   9,  Average loss: 0.0839, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch  10,  Average loss: 0.0846, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Global model norm: 85.38738700402419.
Norm before scaling: 84.54607078946661. Distance: 4.255535559832743
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 5.2231, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 10.6811, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 415.06514925370453, distance: 425.5535365849989
Total norm for 4 adversaries is: 415.06514925370453. distance: 425.5535365849989
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   1,  Average loss: 0.1565, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   2,  Average loss: 0.1341, Accuracy: 23/557 (4.1293%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   3,  Average loss: 0.1154, Accuracy: 34/557 (6.1041%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   4,  Average loss: 0.1124, Accuracy: 27/557 (4.8474%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   5,  Average loss: 0.1084, Accuracy: 24/557 (4.3088%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   6,  Average loss: 0.1070, Accuracy: 28/557 (5.0269%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   7,  Average loss: 0.1026, Accuracy: 24/557 (4.3088%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   8,  Average loss: 0.0992, Accuracy: 23/557 (4.1293%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   9,  Average loss: 0.0950, Accuracy: 31/557 (5.5655%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch  10,  Average loss: 0.0976, Accuracy: 30/557 (5.3860%), train_poison_data_count: 180
Global model norm: 85.38738700402419.
Norm before scaling: 84.4269168978413. Distance: 5.804880377746915
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 4.1042, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 9.8157, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 569.71711730472, distance: 580.4880220555804
Total norm for 4 adversaries is: 569.71711730472. distance: 580.4880220555804
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  55, local model 17, internal_epoch   1,  Average loss: 0.0868, Accuracy: 60/620 (9.6774%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 5.4283, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  55, local model 65, internal_epoch   1,  Average loss: 0.0613, Accuracy: 144/371 (38.8140%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 6.3337, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  55, local model 6, internal_epoch   1,  Average loss: 0.1442, Accuracy: 8/615 (1.3008%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 5.1442, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  55, local model 24, internal_epoch   1,  Average loss: 0.1101, Accuracy: 0/379 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 5.9722, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  55, local model 86, internal_epoch   1,  Average loss: 0.1079, Accuracy: 4/250 (1.6000%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 6.2805, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  55, local model 35, internal_epoch   1,  Average loss: 0.0731, Accuracy: 234/499 (46.8938%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 6.1666, Accuracy: 980/10000 (9.8000%)
time spent on training: 96.51147127151489
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 55: Average loss: 5.2696, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 55: Average loss: 0.0550, Accuracy: 8968/8968 (100.0000%)
Done in 114.27121663093567 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:56 choose agents : [41, 73, 51, 74, 84, 85, 60, 94, 30, 76]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   1,  Average loss: 0.0403, Accuracy: 266/606 (43.8944%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   2,  Average loss: 0.0277, Accuracy: 260/606 (42.9043%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   3,  Average loss: 0.0245, Accuracy: 245/606 (40.4290%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   4,  Average loss: 0.0249, Accuracy: 249/606 (41.0891%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   5,  Average loss: 0.0254, Accuracy: 249/606 (41.0891%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   6,  Average loss: 0.0237, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   7,  Average loss: 0.0242, Accuracy: 256/606 (42.2442%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   8,  Average loss: 0.0237, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   9,  Average loss: 0.0228, Accuracy: 267/606 (44.0594%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch  10,  Average loss: 0.0240, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Global model norm: 83.25009677640772.
Norm before scaling: 82.78160980480507. Distance: 3.0750104764434245
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 3.8487, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.8499, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 304.57107390968696, distance: 307.50104166490235
Total norm for 4 adversaries is: 304.57107390968696. distance: 307.50104166490235
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 415.4951, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   1,  Average loss: 0.0785, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   2,  Average loss: 0.0575, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   3,  Average loss: 0.0442, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   4,  Average loss: 0.0425, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   5,  Average loss: 0.0410, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   6,  Average loss: 0.0395, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   7,  Average loss: 0.0379, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   8,  Average loss: 0.0364, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   9,  Average loss: 0.0358, Accuracy: 196/591 (33.1641%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch  10,  Average loss: 0.0356, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Global model norm: 83.25009677640772.
Norm before scaling: 82.6248227116101. Distance: 5.134154354840829
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.7570, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.8322, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 507.46262177622503, distance: 513.4154324229064
Total norm for 4 adversaries is: 507.46262177622503. distance: 513.4154324229064
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 698.2053, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   1,  Average loss: 0.0640, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   2,  Average loss: 0.0476, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   3,  Average loss: 0.0389, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   4,  Average loss: 0.0369, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   5,  Average loss: 0.0351, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   6,  Average loss: 0.0340, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   7,  Average loss: 0.0324, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   8,  Average loss: 0.0316, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   9,  Average loss: 0.0308, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch  10,  Average loss: 0.0314, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Global model norm: 83.25009677640772.
Norm before scaling: 82.73188588087577. Distance: 4.3411466632453966
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 3.0382, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.7091, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 430.00030886616815, distance: 434.1146701909531
Total norm for 4 adversaries is: 430.00030886616815. distance: 434.1146701909531
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 595.1163, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   1,  Average loss: 0.0446, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   2,  Average loss: 0.0328, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   3,  Average loss: 0.0291, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   4,  Average loss: 0.0287, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   5,  Average loss: 0.0281, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   6,  Average loss: 0.0285, Accuracy: 217/557 (38.9587%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   7,  Average loss: 0.0288, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   8,  Average loss: 0.0286, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   9,  Average loss: 0.0281, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch  10,  Average loss: 0.0288, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Global model norm: 83.25009677640772.
Norm before scaling: 82.81517094749307. Distance: 3.0363946104260906
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 3.4388, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.8752, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 301.6338322370354, distance: 303.63943460953817
Total norm for 4 adversaries is: 301.6338322370354. distance: 303.63943460953817
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 360.7487, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  56, local model 84, internal_epoch   1,  Average loss: 0.0529, Accuracy: 165/1246 (13.2424%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 3.1797, Accuracy: 1135/10000 (11.3500%)
___Train Local_Simple,  epoch  56, local model 85, internal_epoch   1,  Average loss: 0.0651, Accuracy: 46/431 (10.6729%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 3.7605, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  56, local model 60, internal_epoch   1,  Average loss: 0.0753, Accuracy: 53/338 (15.6805%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 4.0750, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  56, local model 94, internal_epoch   1,  Average loss: 0.1052, Accuracy: 27/150 (18.0000%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 4.8714, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  56, local model 30, internal_epoch   1,  Average loss: 0.0721, Accuracy: 105/400 (26.2500%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 3.9463, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  56, local model 76, internal_epoch   1,  Average loss: 0.0907, Accuracy: 20/78 (25.6410%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 5.0879, Accuracy: 1032/10000 (10.3200%)
time spent on training: 102.99732184410095
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 56: Average loss: 3.2710, Accuracy: 892/10000 (8.9200%)
___Test Target_Simple poisoned: True, epoch: 56: Average loss: 9.2159, Accuracy: 0/8968 (0.0000%)
Done in 121.29397892951965 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:57 choose agents : [41, 73, 51, 74, 42, 25, 16, 95, 52, 59]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   1,  Average loss: 0.0816, Accuracy: 244/606 (40.2640%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   2,  Average loss: 0.0669, Accuracy: 254/606 (41.9142%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   3,  Average loss: 0.0584, Accuracy: 243/606 (40.0990%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   4,  Average loss: 0.0553, Accuracy: 257/606 (42.4092%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   5,  Average loss: 0.0543, Accuracy: 247/606 (40.7591%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   6,  Average loss: 0.0515, Accuracy: 249/606 (41.0891%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   7,  Average loss: 0.0494, Accuracy: 255/606 (42.0792%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   8,  Average loss: 0.0468, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   9,  Average loss: 0.0461, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch  10,  Average loss: 0.0461, Accuracy: 253/606 (41.7492%), train_poison_data_count: 200
Global model norm: 81.82241273980192.
Norm before scaling: 81.22107958856031. Distance: 4.601326643334736
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.8410, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 4.6086, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 454.41753583571136, distance: 460.13265750215993
Total norm for 4 adversaries is: 454.41753583571136. distance: 460.13265750215993
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   1,  Average loss: 0.0788, Accuracy: 36/591 (6.0914%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   2,  Average loss: 0.0662, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   3,  Average loss: 0.0584, Accuracy: 272/591 (46.0237%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   4,  Average loss: 0.0573, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   5,  Average loss: 0.0561, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   6,  Average loss: 0.0540, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   7,  Average loss: 0.0531, Accuracy: 260/591 (43.9932%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   8,  Average loss: 0.0517, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   9,  Average loss: 0.0503, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch  10,  Average loss: 0.0509, Accuracy: 260/591 (43.9932%), train_poison_data_count: 195
Global model norm: 81.82241273980192.
Norm before scaling: 81.24336511371251. Distance: 4.103060087458972
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.9144, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 5.4959, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 404.87038821084457, distance: 410.30602146446745
Total norm for 4 adversaries is: 404.87038821084457. distance: 410.30602146446745
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   1,  Average loss: 0.0733, Accuracy: 106/568 (18.6620%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   2,  Average loss: 0.0636, Accuracy: 226/568 (39.7887%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   3,  Average loss: 0.0565, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   4,  Average loss: 0.0567, Accuracy: 224/568 (39.4366%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   5,  Average loss: 0.0548, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   6,  Average loss: 0.0533, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   7,  Average loss: 0.0512, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   8,  Average loss: 0.0503, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   9,  Average loss: 0.0493, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch  10,  Average loss: 0.0486, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Global model norm: 81.82241273980192.
Norm before scaling: 81.3026422012609. Distance: 3.732633687491329
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.9476, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 5.6417, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 368.9828713842961, distance: 373.26335374638643
Total norm for 4 adversaries is: 368.9828713842961. distance: 373.26335374638643
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   1,  Average loss: 0.0802, Accuracy: 14/557 (2.5135%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   2,  Average loss: 0.0693, Accuracy: 59/557 (10.5925%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   3,  Average loss: 0.0614, Accuracy: 127/557 (22.8007%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   4,  Average loss: 0.0603, Accuracy: 124/557 (22.2621%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   5,  Average loss: 0.0578, Accuracy: 122/557 (21.9031%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   6,  Average loss: 0.0565, Accuracy: 134/557 (24.0575%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   7,  Average loss: 0.0558, Accuracy: 119/557 (21.3645%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   8,  Average loss: 0.0543, Accuracy: 127/557 (22.8007%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   9,  Average loss: 0.0528, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch  10,  Average loss: 0.0534, Accuracy: 129/557 (23.1598%), train_poison_data_count: 180
Global model norm: 81.82241273980192.
Norm before scaling: 81.29263905214604. Distance: 3.8662473210036588
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.7464, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 5.5056, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 382.14830645313606, distance: 386.6247373099657
Total norm for 4 adversaries is: 382.14830645313606. distance: 386.6247373099657
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  57, local model 42, internal_epoch   1,  Average loss: 0.0706, Accuracy: 5/236 (2.1186%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 3.1741, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  57, local model 25, internal_epoch   1,  Average loss: 0.0759, Accuracy: 123/647 (19.0108%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.9689, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  57, local model 16, internal_epoch   1,  Average loss: 0.0408, Accuracy: 199/915 (21.7486%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 3.2501, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  57, local model 95, internal_epoch   1,  Average loss: 0.0531, Accuracy: 126/602 (20.9302%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 3.3165, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  57, local model 52, internal_epoch   1,  Average loss: 0.0455, Accuracy: 0/253 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 3.1767, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  57, local model 59, internal_epoch   1,  Average loss: 0.0328, Accuracy: 179/760 (23.5526%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 3.1906, Accuracy: 892/10000 (8.9200%)
time spent on training: 99.13383626937866
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 57: Average loss: 8.0668, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 57: Average loss: 0.0013, Accuracy: 8968/8968 (100.0000%)
Done in 117.83033204078674 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:58 choose agents : [41, 73, 51, 74, 52, 81, 77, 21, 10, 8]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   1,  Average loss: 0.0833, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   2,  Average loss: 0.0612, Accuracy: 269/606 (44.3894%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   3,  Average loss: 0.0403, Accuracy: 282/606 (46.5347%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   4,  Average loss: 0.0370, Accuracy: 282/606 (46.5347%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   5,  Average loss: 0.0346, Accuracy: 279/606 (46.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   6,  Average loss: 0.0321, Accuracy: 277/606 (45.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   7,  Average loss: 0.0299, Accuracy: 276/606 (45.5446%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   8,  Average loss: 0.0273, Accuracy: 278/606 (45.8746%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   9,  Average loss: 0.0261, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch  10,  Average loss: 0.0263, Accuracy: 272/606 (44.8845%), train_poison_data_count: 200
Global model norm: 80.61684794058249.
Norm before scaling: 79.89251201810154. Distance: 5.945188343090104
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 3.7299, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.2380, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 587.1889868262176, distance: 594.5188180369062
Total norm for 4 adversaries is: 587.1889868262176. distance: 594.5188180369062
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 820.0084, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   1,  Average loss: 0.0811, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   2,  Average loss: 0.0531, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   3,  Average loss: 0.0310, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   4,  Average loss: 0.0298, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   5,  Average loss: 0.0291, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   6,  Average loss: 0.0274, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   7,  Average loss: 0.0271, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   8,  Average loss: 0.0261, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   9,  Average loss: 0.0249, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch  10,  Average loss: 0.0273, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Global model norm: 80.61684794058249.
Norm before scaling: 79.95898301531699. Distance: 5.728179661666359
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 3.9945, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.6611, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 566.3696617492855, distance: 572.8179521017126
Total norm for 4 adversaries is: 566.3696617492855. distance: 572.8179521017126
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 775.4022, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   1,  Average loss: 0.0797, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   2,  Average loss: 0.0577, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   3,  Average loss: 0.0405, Accuracy: 241/568 (42.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   4,  Average loss: 0.0393, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   5,  Average loss: 0.0352, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   6,  Average loss: 0.0329, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   7,  Average loss: 0.0302, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   8,  Average loss: 0.0280, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   9,  Average loss: 0.0263, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch  10,  Average loss: 0.0268, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Global model norm: 80.61684794058249.
Norm before scaling: 79.98863444655747. Distance: 5.435151217689833
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 3.9602, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.2507, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 537.460899740623, distance: 543.5151216847605
Total norm for 4 adversaries is: 537.460899740623. distance: 543.5151216847605
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 743.5762, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   1,  Average loss: 0.0811, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   2,  Average loss: 0.0633, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   3,  Average loss: 0.0475, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   4,  Average loss: 0.0448, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   5,  Average loss: 0.0423, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   6,  Average loss: 0.0397, Accuracy: 228/557 (40.9336%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   7,  Average loss: 0.0379, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   8,  Average loss: 0.0357, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   9,  Average loss: 0.0352, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch  10,  Average loss: 0.0347, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Global model norm: 80.61684794058249.
Norm before scaling: 79.96236907914873. Distance: 5.063904367324313
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 3.7881, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.2174, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 499.85641688388876, distance: 506.390428054283
Total norm for 4 adversaries is: 499.85641688388876. distance: 506.390428054283
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 610.7615, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  58, local model 52, internal_epoch   1,  Average loss: 0.1345, Accuracy: 0/253 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 7.1654, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  58, local model 81, internal_epoch   1,  Average loss: 0.0831, Accuracy: 120/1227 (9.7800%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 3.3240, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  58, local model 77, internal_epoch   1,  Average loss: 0.1166, Accuracy: 61/589 (10.3565%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 4.4599, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  58, local model 21, internal_epoch   1,  Average loss: 0.1238, Accuracy: 36/312 (11.5385%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 6.8956, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  58, local model 10, internal_epoch   1,  Average loss: 0.0914, Accuracy: 28/892 (3.1390%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 3.1762, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  58, local model 8, internal_epoch   1,  Average loss: 0.0869, Accuracy: 192/633 (30.3318%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 5.2303, Accuracy: 1032/10000 (10.3200%)
time spent on training: 104.55911183357239
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 58: Average loss: 4.6129, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 58: Average loss: 14.9540, Accuracy: 0/8968 (0.0000%)
Done in 124.0704026222229 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:59 choose agents : [41, 73, 51, 74, 40, 54, 46, 30, 78, 9]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   1,  Average loss: 0.1307, Accuracy: 35/606 (5.7756%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   2,  Average loss: 0.1091, Accuracy: 176/606 (29.0429%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   3,  Average loss: 0.0960, Accuracy: 253/606 (41.7492%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   4,  Average loss: 0.0941, Accuracy: 247/606 (40.7591%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   5,  Average loss: 0.0928, Accuracy: 248/606 (40.9241%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   6,  Average loss: 0.0913, Accuracy: 243/606 (40.0990%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   7,  Average loss: 0.0890, Accuracy: 255/606 (42.0792%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   8,  Average loss: 0.0867, Accuracy: 255/606 (42.0792%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   9,  Average loss: 0.0856, Accuracy: 247/606 (40.7591%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch  10,  Average loss: 0.0839, Accuracy: 255/606 (42.0792%), train_poison_data_count: 200
Global model norm: 79.65584542855282.
Norm before scaling: 78.74389547272061. Distance: 5.391454660452306
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 3.5235, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 9.6752, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 528.8392064228975, distance: 539.1454754980329
Total norm for 4 adversaries is: 528.8392064228975. distance: 539.1454754980329
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   1,  Average loss: 0.1109, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   2,  Average loss: 0.0998, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   3,  Average loss: 0.0923, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   4,  Average loss: 0.0903, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   5,  Average loss: 0.0884, Accuracy: 276/591 (46.7005%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   6,  Average loss: 0.0878, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   7,  Average loss: 0.0863, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   8,  Average loss: 0.0834, Accuracy: 276/591 (46.7005%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   9,  Average loss: 0.0836, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch  10,  Average loss: 0.0830, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Global model norm: 79.65584542855282.
Norm before scaling: 78.8105638887881. Distance: 3.9768680237800766
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 3.5604, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 10.5057, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 386.6826258380379, distance: 397.6867878745785
Total norm for 4 adversaries is: 386.6826258380379. distance: 397.6867878745785
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   1,  Average loss: 0.1111, Accuracy: 46/568 (8.0986%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   2,  Average loss: 0.0970, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   3,  Average loss: 0.0898, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   4,  Average loss: 0.0892, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   5,  Average loss: 0.0841, Accuracy: 243/568 (42.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   6,  Average loss: 0.0868, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   7,  Average loss: 0.0839, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   8,  Average loss: 0.0841, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   9,  Average loss: 0.0814, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch  10,  Average loss: 0.0830, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Global model norm: 79.65584542855282.
Norm before scaling: 78.88427602447936. Distance: 4.0761929316358385
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 3.6909, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 10.7494, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 398.25190285170015, distance: 407.61926935560837
Total norm for 4 adversaries is: 398.25190285170015. distance: 407.61926935560837
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   1,  Average loss: 0.1259, Accuracy: 3/557 (0.5386%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   2,  Average loss: 0.1054, Accuracy: 18/557 (3.2316%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   3,  Average loss: 0.0955, Accuracy: 121/557 (21.7235%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   4,  Average loss: 0.0945, Accuracy: 119/557 (21.3645%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   5,  Average loss: 0.0924, Accuracy: 118/557 (21.1849%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   6,  Average loss: 0.0905, Accuracy: 123/557 (22.0826%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   7,  Average loss: 0.0898, Accuracy: 125/557 (22.4417%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   8,  Average loss: 0.0866, Accuracy: 121/557 (21.7235%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   9,  Average loss: 0.0875, Accuracy: 119/557 (21.3645%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch  10,  Average loss: 0.0853, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Global model norm: 79.65584542855282.
Norm before scaling: 78.87225133879468. Distance: 4.700700407393388
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 3.3670, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 10.5270, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 461.1715041608707, distance: 470.07004132363085
Total norm for 4 adversaries is: 461.1715041608707. distance: 470.07004132363085
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  59, local model 40, internal_epoch   1,  Average loss: 0.1383, Accuracy: 27/772 (3.4974%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 3.3298, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  59, local model 54, internal_epoch   1,  Average loss: 0.0782, Accuracy: 1/519 (0.1927%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 3.7811, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  59, local model 46, internal_epoch   1,  Average loss: 0.0718, Accuracy: 60/710 (8.4507%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 3.6823, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  59, local model 30, internal_epoch   1,  Average loss: 0.1125, Accuracy: 53/400 (13.2500%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 3.9619, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  59, local model 78, internal_epoch   1,  Average loss: 0.0598, Accuracy: 11/303 (3.6304%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 4.1842, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  59, local model 9, internal_epoch   1,  Average loss: 0.0415, Accuracy: 66/436 (15.1376%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 4.2998, Accuracy: 1009/10000 (10.0900%)
time spent on training: 108.73282027244568
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 59: Average loss: 4.0049, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 59: Average loss: 0.2482, Accuracy: 8968/8968 (100.0000%)
Done in 126.2581512928009 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:60 choose agents : [41, 73, 51, 74, 89, 4, 11, 24, 43, 23]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   1,  Average loss: 0.0327, Accuracy: 269/606 (44.3894%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   2,  Average loss: 0.0270, Accuracy: 262/606 (43.2343%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   3,  Average loss: 0.0263, Accuracy: 259/606 (42.7393%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   4,  Average loss: 0.0266, Accuracy: 240/606 (39.6040%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   5,  Average loss: 0.0245, Accuracy: 257/606 (42.4092%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   6,  Average loss: 0.0259, Accuracy: 247/606 (40.7591%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   7,  Average loss: 0.0253, Accuracy: 246/606 (40.5941%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   8,  Average loss: 0.0260, Accuracy: 257/606 (42.4092%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   9,  Average loss: 0.0264, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch  10,  Average loss: 0.0241, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Global model norm: 77.71735209337906.
Norm before scaling: 77.32190663772946. Distance: 2.1344848336462636
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.6595, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.8908, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 212.16410953551969, distance: 213.44848068386432
Total norm for 4 adversaries is: 212.16410953551969. distance: 213.44848068386432
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 262.0953, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   1,  Average loss: 0.0779, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   2,  Average loss: 0.0626, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   3,  Average loss: 0.0528, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   4,  Average loss: 0.0503, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   5,  Average loss: 0.0488, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   6,  Average loss: 0.0476, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   7,  Average loss: 0.0459, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   8,  Average loss: 0.0440, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   9,  Average loss: 0.0431, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch  10,  Average loss: 0.0426, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Global model norm: 77.71735209337906.
Norm before scaling: 77.11294476286066. Distance: 4.569787045782203
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.6590, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.8644, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 451.02451083616285, distance: 456.9787159978022
Total norm for 4 adversaries is: 451.02451083616285. distance: 456.9787159978022
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 577.0137, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   1,  Average loss: 0.0497, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   2,  Average loss: 0.0387, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   3,  Average loss: 0.0327, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   4,  Average loss: 0.0332, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   5,  Average loss: 0.0315, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   6,  Average loss: 0.0308, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   7,  Average loss: 0.0306, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   8,  Average loss: 0.0299, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   9,  Average loss: 0.0298, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch  10,  Average loss: 0.0297, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Global model norm: 77.71735209337906.
Norm before scaling: 77.30825890246948. Distance: 3.4035914133863576
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.0829, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.8907, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 338.2068870344009, distance: 340.35911641235646
Total norm for 4 adversaries is: 338.2068870344009. distance: 340.35911641235646
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 436.6679, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   1,  Average loss: 0.0348, Accuracy: 214/557 (38.4201%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   2,  Average loss: 0.0297, Accuracy: 217/557 (38.9587%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   3,  Average loss: 0.0284, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   4,  Average loss: 0.0290, Accuracy: 217/557 (38.9587%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   5,  Average loss: 0.0280, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   6,  Average loss: 0.0280, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   7,  Average loss: 0.0275, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   8,  Average loss: 0.0285, Accuracy: 218/557 (39.1382%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   9,  Average loss: 0.0273, Accuracy: 227/557 (40.7540%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch  10,  Average loss: 0.0282, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Global model norm: 77.71735209337906.
Norm before scaling: 77.36772986846648. Distance: 1.9783403445116652
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.2761, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.9892, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 198.40560767339718, distance: 197.83403318817517
Total norm for 4 adversaries is: 198.40560767339718. distance: 197.83403318817517
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 245.4994, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  60, local model 89, internal_epoch   1,  Average loss: 0.0756, Accuracy: 117/492 (23.7805%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.1677, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  60, local model 4, internal_epoch   1,  Average loss: 0.0492, Accuracy: 31/658 (4.7112%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.1465, Accuracy: 1010/10000 (10.1000%)
___Train Local_Simple,  epoch  60, local model 11, internal_epoch   1,  Average loss: 0.0557, Accuracy: 2/645 (0.3101%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.9501, Accuracy: 1010/10000 (10.1000%)
___Train Local_Simple,  epoch  60, local model 24, internal_epoch   1,  Average loss: 0.0508, Accuracy: 14/379 (3.6939%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.3011, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  60, local model 43, internal_epoch   1,  Average loss: 0.0582, Accuracy: 0/408 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.1863, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  60, local model 23, internal_epoch   1,  Average loss: 0.0532, Accuracy: 19/293 (6.4846%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.4556, Accuracy: 1032/10000 (10.3200%)
time spent on training: 99.91479587554932
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 60: Average loss: 3.0132, Accuracy: 1009/10000 (10.0900%)
___Test Target_Simple poisoned: True, epoch: 60: Average loss: 5.3500, Accuracy: 0/8968 (0.0000%)
Done in 118.53882026672363 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:61 choose agents : [41, 73, 51, 74, 25, 97, 91, 57, 72, 15]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   1,  Average loss: 0.0550, Accuracy: 10/606 (1.6502%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   2,  Average loss: 0.0374, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   3,  Average loss: 0.0290, Accuracy: 241/606 (39.7690%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   4,  Average loss: 0.0266, Accuracy: 263/606 (43.3993%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   5,  Average loss: 0.0261, Accuracy: 251/606 (41.4191%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   6,  Average loss: 0.0253, Accuracy: 252/606 (41.5842%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   7,  Average loss: 0.0246, Accuracy: 245/606 (40.4290%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   8,  Average loss: 0.0239, Accuracy: 253/606 (41.7492%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   9,  Average loss: 0.0237, Accuracy: 257/606 (42.4092%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch  10,  Average loss: 0.0233, Accuracy: 255/606 (42.0792%), train_poison_data_count: 200
Global model norm: 76.19406888211509.
Norm before scaling: 75.80848737319918. Distance: 4.557454284673053
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 2.7887, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 1.4120, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 453.3999166023302, distance: 455.7454230433916
Total norm for 4 adversaries is: 453.3999166023302. distance: 455.7454230433916
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   1,  Average loss: 0.0589, Accuracy: 35/591 (5.9222%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   2,  Average loss: 0.0404, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   3,  Average loss: 0.0334, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   4,  Average loss: 0.0330, Accuracy: 254/591 (42.9780%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   5,  Average loss: 0.0308, Accuracy: 275/591 (46.5313%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   6,  Average loss: 0.0305, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   7,  Average loss: 0.0299, Accuracy: 265/591 (44.8393%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   8,  Average loss: 0.0294, Accuracy: 258/591 (43.6548%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   9,  Average loss: 0.0286, Accuracy: 267/591 (45.1777%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch  10,  Average loss: 0.0287, Accuracy: 262/591 (44.3316%), train_poison_data_count: 195
Global model norm: 76.19406888211509.
Norm before scaling: 75.7946927510017. Distance: 4.366876526271739
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 2.6706, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 1.9575, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 434.1941889869094, distance: 436.6876565406904
Total norm for 4 adversaries is: 434.1941889869094. distance: 436.6876565406904
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   1,  Average loss: 0.0464, Accuracy: 223/568 (39.2606%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   2,  Average loss: 0.0381, Accuracy: 223/568 (39.2606%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   3,  Average loss: 0.0310, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   4,  Average loss: 0.0300, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   5,  Average loss: 0.0290, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   6,  Average loss: 0.0286, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   7,  Average loss: 0.0277, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   8,  Average loss: 0.0266, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   9,  Average loss: 0.0264, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch  10,  Average loss: 0.0261, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Global model norm: 76.19406888211509.
Norm before scaling: 75.84087860242325. Distance: 3.32182754956409
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 2.6428, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 1.9623, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 331.1763361488861, distance: 332.18275514014874
Total norm for 4 adversaries is: 331.1763361488861. distance: 332.18275514014874
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   1,  Average loss: 0.0556, Accuracy: 28/557 (5.0269%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   2,  Average loss: 0.0430, Accuracy: 58/557 (10.4129%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   3,  Average loss: 0.0360, Accuracy: 133/557 (23.8779%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   4,  Average loss: 0.0352, Accuracy: 124/557 (22.2621%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   5,  Average loss: 0.0344, Accuracy: 127/557 (22.8007%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   6,  Average loss: 0.0333, Accuracy: 123/557 (22.0826%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   7,  Average loss: 0.0325, Accuracy: 130/557 (23.3393%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   8,  Average loss: 0.0318, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   9,  Average loss: 0.0315, Accuracy: 116/557 (20.8259%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch  10,  Average loss: 0.0313, Accuracy: 130/557 (23.3393%), train_poison_data_count: 180
Global model norm: 76.19406888211509.
Norm before scaling: 75.83063790138686. Distance: 3.7627557610557716
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 2.4859, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 1.9886, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 374.76388399897877, distance: 376.2755597630545
Total norm for 4 adversaries is: 374.76388399897877. distance: 376.2755597630545
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  61, local model 25, internal_epoch   1,  Average loss: 0.0490, Accuracy: 202/647 (31.2210%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 2.5535, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  61, local model 97, internal_epoch   1,  Average loss: 0.0467, Accuracy: 107/487 (21.9713%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 2.6447, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  61, local model 91, internal_epoch   1,  Average loss: 0.0408, Accuracy: 21/256 (8.2031%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 2.8487, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  61, local model 57, internal_epoch   1,  Average loss: 0.0568, Accuracy: 38/343 (11.0787%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 2.7306, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  61, local model 72, internal_epoch   1,  Average loss: 0.0412, Accuracy: 61/731 (8.3447%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 2.7967, Accuracy: 958/10000 (9.5800%)
___Train Local_Simple,  epoch  61, local model 15, internal_epoch   1,  Average loss: 0.0559, Accuracy: 13/401 (3.2419%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 2.6315, Accuracy: 1009/10000 (10.0900%)
time spent on training: 97.87294244766235
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 61: Average loss: 10.3051, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 61: Average loss: 0.0002, Accuracy: 8968/8968 (100.0000%)
Done in 117.71602988243103 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:62 choose agents : [41, 73, 51, 74, 94, 95, 90, 69, 20, 81]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   1,  Average loss: 0.0919, Accuracy: 280/606 (46.2046%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   2,  Average loss: 0.0714, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   3,  Average loss: 0.0527, Accuracy: 272/606 (44.8845%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   4,  Average loss: 0.0482, Accuracy: 281/606 (46.3696%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   5,  Average loss: 0.0465, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   6,  Average loss: 0.0412, Accuracy: 277/606 (45.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   7,  Average loss: 0.0387, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   8,  Average loss: 0.0350, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   9,  Average loss: 0.0348, Accuracy: 266/606 (43.8944%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch  10,  Average loss: 0.0332, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Global model norm: 75.7279516179462.
Norm before scaling: 74.91517012490695. Distance: 6.038517659668062
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 5.6334, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0804, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 595.3833848874185, distance: 603.8517512601913
Total norm for 4 adversaries is: 595.3833848874185. distance: 603.8517512601913
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 828.1756, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   1,  Average loss: 0.0990, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   2,  Average loss: 0.0699, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   3,  Average loss: 0.0469, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   4,  Average loss: 0.0425, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   5,  Average loss: 0.0401, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   6,  Average loss: 0.0379, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   7,  Average loss: 0.0363, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   8,  Average loss: 0.0378, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   9,  Average loss: 0.0348, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch  10,  Average loss: 0.0353, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Global model norm: 75.7279516179462.
Norm before scaling: 74.94179381985396. Distance: 6.206723954004313
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 5.6641, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.4962, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 612.5941509270228, distance: 620.6723672760049
Total norm for 4 adversaries is: 612.5941509270228. distance: 620.6723672760049
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 840.0748, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   1,  Average loss: 0.1207, Accuracy: 241/568 (42.4296%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   2,  Average loss: 0.1006, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   3,  Average loss: 0.0814, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   4,  Average loss: 0.0789, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   5,  Average loss: 0.0755, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   6,  Average loss: 0.0718, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   7,  Average loss: 0.0682, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   8,  Average loss: 0.0646, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   9,  Average loss: 0.0628, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch  10,  Average loss: 0.0608, Accuracy: 241/568 (42.4296%), train_poison_data_count: 180
Global model norm: 75.7279516179462.
Norm before scaling: 74.81240209893343. Distance: 5.695886151343991
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 5.7389, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0322, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 559.5882135552893, distance: 569.5885850769835
Total norm for 4 adversaries is: 559.5882135552893. distance: 569.5885850769835
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 772.5774, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   1,  Average loss: 0.1059, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   2,  Average loss: 0.0871, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   3,  Average loss: 0.0697, Accuracy: 227/557 (40.7540%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   4,  Average loss: 0.0688, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   5,  Average loss: 0.0638, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   6,  Average loss: 0.0633, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   7,  Average loss: 0.0571, Accuracy: 229/557 (41.1131%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   8,  Average loss: 0.0563, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   9,  Average loss: 0.0542, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch  10,  Average loss: 0.0536, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Global model norm: 75.7279516179462.
Norm before scaling: 74.90240394798754. Distance: 5.3040913175198865
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 5.6234, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0396, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 521.36362670405, distance: 530.4090991866561
Total norm for 4 adversaries is: 521.36362670405. distance: 530.4090991866561
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 638.2148, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  62, local model 94, internal_epoch   1,  Average loss: 0.1837, Accuracy: 27/150 (18.0000%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 9.8457, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  62, local model 95, internal_epoch   1,  Average loss: 0.1334, Accuracy: 90/602 (14.9502%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 6.7684, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  62, local model 90, internal_epoch   1,  Average loss: 0.1545, Accuracy: 16/683 (2.3426%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 5.6482, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  62, local model 69, internal_epoch   1,  Average loss: 0.1818, Accuracy: 2/256 (0.7812%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 9.4073, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  62, local model 20, internal_epoch   1,  Average loss: 0.1654, Accuracy: 21/429 (4.8951%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 8.1296, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  62, local model 81, internal_epoch   1,  Average loss: 0.1048, Accuracy: 130/1227 (10.5949%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 4.2064, Accuracy: 892/10000 (8.9200%)
time spent on training: 100.03976845741272
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 62: Average loss: 5.9275, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 62: Average loss: 15.0541, Accuracy: 0/8968 (0.0000%)
Done in 120.55550789833069 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:63 choose agents : [41, 73, 51, 74, 59, 21, 69, 14, 28, 22]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   1,  Average loss: 0.1335, Accuracy: 34/606 (5.6106%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   2,  Average loss: 0.0999, Accuracy: 202/606 (33.3333%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   3,  Average loss: 0.0900, Accuracy: 253/606 (41.7492%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   4,  Average loss: 0.0858, Accuracy: 254/606 (41.9142%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   5,  Average loss: 0.0832, Accuracy: 253/606 (41.7492%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   6,  Average loss: 0.0799, Accuracy: 258/606 (42.5743%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   7,  Average loss: 0.0782, Accuracy: 254/606 (41.9142%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   8,  Average loss: 0.0763, Accuracy: 259/606 (42.7393%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   9,  Average loss: 0.0763, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch  10,  Average loss: 0.0736, Accuracy: 261/606 (43.0693%), train_poison_data_count: 200
Global model norm: 74.4160666560824.
Norm before scaling: 73.4719732916913. Distance: 5.865074701768445
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 3.6553, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 8.5744, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 576.3043900578929, distance: 586.5074328173514
Total norm for 4 adversaries is: 576.3043900578929. distance: 586.5074328173514
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   1,  Average loss: 0.1151, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   2,  Average loss: 0.0975, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   3,  Average loss: 0.0875, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   4,  Average loss: 0.0851, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   5,  Average loss: 0.0847, Accuracy: 254/591 (42.9780%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   6,  Average loss: 0.0820, Accuracy: 261/591 (44.1624%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   7,  Average loss: 0.0796, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   8,  Average loss: 0.0775, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   9,  Average loss: 0.0774, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch  10,  Average loss: 0.0784, Accuracy: 250/591 (42.3012%), train_poison_data_count: 195
Global model norm: 74.4160666560824.
Norm before scaling: 73.51761587368023. Distance: 4.7129525450501335
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 3.5385, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 9.2791, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 460.5915863050475, distance: 471.29523987093273
Total norm for 4 adversaries is: 460.5915863050475. distance: 471.29523987093273
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   1,  Average loss: 0.1411, Accuracy: 32/568 (5.6338%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   2,  Average loss: 0.1051, Accuracy: 37/568 (6.5141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   3,  Average loss: 0.0859, Accuracy: 7/568 (1.2324%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   4,  Average loss: 0.0823, Accuracy: 7/568 (1.2324%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   5,  Average loss: 0.0825, Accuracy: 101/568 (17.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   6,  Average loss: 0.0782, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   7,  Average loss: 0.0768, Accuracy: 227/568 (39.9648%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   8,  Average loss: 0.0750, Accuracy: 243/568 (42.7817%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   9,  Average loss: 0.0756, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch  10,  Average loss: 0.0735, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Global model norm: 74.4160666560824.
Norm before scaling: 73.56665836271381. Distance: 6.114832321201151
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 3.3803, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 9.1689, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 602.6114523471986, distance: 611.4832632623726
Total norm for 4 adversaries is: 602.6114523471986. distance: 611.4832632623726
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   1,  Average loss: 0.1335, Accuracy: 5/557 (0.8977%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   2,  Average loss: 0.1047, Accuracy: 8/557 (1.4363%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   3,  Average loss: 0.0890, Accuracy: 16/557 (2.8725%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   4,  Average loss: 0.0873, Accuracy: 15/557 (2.6930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   5,  Average loss: 0.0857, Accuracy: 64/557 (11.4901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   6,  Average loss: 0.0858, Accuracy: 115/557 (20.6463%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   7,  Average loss: 0.0814, Accuracy: 131/557 (23.5189%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   8,  Average loss: 0.0802, Accuracy: 116/557 (20.8259%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   9,  Average loss: 0.0813, Accuracy: 120/557 (21.5440%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch  10,  Average loss: 0.0794, Accuracy: 123/557 (22.0826%), train_poison_data_count: 180
Global model norm: 74.4160666560824.
Norm before scaling: 73.59040265742028. Distance: 5.651614824284322
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 3.4282, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 9.4314, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 556.3548496688062, distance: 565.1614537015064
Total norm for 4 adversaries is: 556.3548496688062. distance: 565.1614537015064
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  63, local model 59, internal_epoch   1,  Average loss: 0.0493, Accuracy: 155/760 (20.3947%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 4.1535, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  63, local model 21, internal_epoch   1,  Average loss: 0.1107, Accuracy: 1/312 (0.3205%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 4.9205, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  63, local model 69, internal_epoch   1,  Average loss: 0.0938, Accuracy: 1/256 (0.3906%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 5.2142, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  63, local model 14, internal_epoch   1,  Average loss: 0.1536, Accuracy: 3/376 (0.7979%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 4.6258, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  63, local model 28, internal_epoch   1,  Average loss: 0.0668, Accuracy: 61/501 (12.1756%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 4.3897, Accuracy: 980/10000 (9.8000%)
___Train Local_Simple,  epoch  63, local model 22, internal_epoch   1,  Average loss: 0.0599, Accuracy: 199/583 (34.1338%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 4.2816, Accuracy: 980/10000 (9.8000%)
time spent on training: 102.82496476173401
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 63: Average loss: 5.1502, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 63: Average loss: 0.2079, Accuracy: 8968/8968 (100.0000%)
Done in 121.75574207305908 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:64 choose agents : [41, 73, 51, 74, 72, 97, 37, 50, 42, 52]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   1,  Average loss: 0.0553, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   2,  Average loss: 0.0434, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   3,  Average loss: 0.0364, Accuracy: 266/606 (43.8944%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   4,  Average loss: 0.0349, Accuracy: 264/606 (43.5644%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   5,  Average loss: 0.0339, Accuracy: 270/606 (44.5545%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   6,  Average loss: 0.0321, Accuracy: 279/606 (46.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   7,  Average loss: 0.0322, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   8,  Average loss: 0.0314, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   9,  Average loss: 0.0315, Accuracy: 276/606 (45.5446%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch  10,  Average loss: 0.0302, Accuracy: 267/606 (44.0594%), train_poison_data_count: 200
Global model norm: 73.20456742175485.
Norm before scaling: 72.70053757753446. Distance: 3.9631656797565498
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 3.9779, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.7978, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 391.7920765533678, distance: 396.3165953502326
Total norm for 4 adversaries is: 391.7920765533678. distance: 396.3165953502326
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 493.4041, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   1,  Average loss: 0.1182, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   2,  Average loss: 0.1016, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   3,  Average loss: 0.0902, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   4,  Average loss: 0.0905, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   5,  Average loss: 0.0848, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   6,  Average loss: 0.0845, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   7,  Average loss: 0.0828, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   8,  Average loss: 0.0810, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   9,  Average loss: 0.0809, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch  10,  Average loss: 0.0795, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Global model norm: 73.20456742175485.
Norm before scaling: 72.27908151740723. Distance: 4.770656443596838
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 3.3930, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.7630, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 466.05828833419537, distance: 477.0656565138597
Total norm for 4 adversaries is: 466.05828833419537. distance: 477.0656565138597
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 609.3058, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   1,  Average loss: 0.0372, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   2,  Average loss: 0.0372, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   3,  Average loss: 0.0333, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   4,  Average loss: 0.0324, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   5,  Average loss: 0.0341, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   6,  Average loss: 0.0316, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   7,  Average loss: 0.0323, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   8,  Average loss: 0.0332, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   9,  Average loss: 0.0324, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch  10,  Average loss: 0.0323, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Global model norm: 73.20456742175485.
Norm before scaling: 72.79092021953184. Distance: 1.6735023350626688
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 4.4881, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.8940, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 164.4563902585576, distance: 167.35023621883536
Total norm for 4 adversaries is: 164.4563902585576. distance: 167.35023621883536
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 200.2583, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   1,  Average loss: 0.0383, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   2,  Average loss: 0.0325, Accuracy: 228/557 (40.9336%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   3,  Average loss: 0.0291, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   4,  Average loss: 0.0290, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   5,  Average loss: 0.0280, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   6,  Average loss: 0.0292, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   7,  Average loss: 0.0286, Accuracy: 217/557 (38.9587%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   8,  Average loss: 0.0285, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   9,  Average loss: 0.0283, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch  10,  Average loss: 0.0274, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Global model norm: 73.20456742175485.
Norm before scaling: 72.83143195399052. Distance: 2.5298638963842532
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 4.0329, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.8809, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 251.539028408118, distance: 252.98639723807287
Total norm for 4 adversaries is: 251.539028408118. distance: 252.98639723807287
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 283.3109, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  64, local model 72, internal_epoch   1,  Average loss: 0.0618, Accuracy: 18/731 (2.4624%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 3.6875, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  64, local model 97, internal_epoch   1,  Average loss: 0.0705, Accuracy: 29/487 (5.9548%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 4.0647, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  64, local model 37, internal_epoch   1,  Average loss: 0.0674, Accuracy: 427/860 (49.6512%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 3.8223, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  64, local model 50, internal_epoch   1,  Average loss: 0.0696, Accuracy: 27/474 (5.6962%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 4.0110, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  64, local model 42, internal_epoch   1,  Average loss: 0.0595, Accuracy: 52/236 (22.0339%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 4.7675, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  64, local model 52, internal_epoch   1,  Average loss: 0.0711, Accuracy: 0/253 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 4.6213, Accuracy: 1032/10000 (10.3200%)
time spent on training: 99.24448227882385
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 64: Average loss: 3.5418, Accuracy: 892/10000 (8.9200%)
___Test Target_Simple poisoned: True, epoch: 64: Average loss: 5.9151, Accuracy: 0/8968 (0.0000%)
Done in 119.26789569854736 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:65 choose agents : [41, 73, 51, 74, 75, 62, 42, 43, 87, 26]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   1,  Average loss: 0.0583, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   2,  Average loss: 0.0445, Accuracy: 260/606 (42.9043%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   3,  Average loss: 0.0368, Accuracy: 245/606 (40.4290%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   4,  Average loss: 0.0333, Accuracy: 259/606 (42.7393%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   5,  Average loss: 0.0319, Accuracy: 261/606 (43.0693%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   6,  Average loss: 0.0310, Accuracy: 256/606 (42.2442%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   7,  Average loss: 0.0309, Accuracy: 254/606 (41.9142%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   8,  Average loss: 0.0290, Accuracy: 251/606 (41.4191%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   9,  Average loss: 0.0286, Accuracy: 246/606 (40.5941%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch  10,  Average loss: 0.0282, Accuracy: 257/606 (42.4092%), train_poison_data_count: 200
Global model norm: 71.33293555793495.
Norm before scaling: 70.89097111167438. Distance: 4.254702939199173
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 3.0471, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 1.6401, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 421.92096045942066, distance: 425.47030962806326
Total norm for 4 adversaries is: 421.92096045942066. distance: 425.47030962806326
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   1,  Average loss: 0.0997, Accuracy: 6/591 (1.0152%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   2,  Average loss: 0.0734, Accuracy: 6/591 (1.0152%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   3,  Average loss: 0.0562, Accuracy: 5/591 (0.8460%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   4,  Average loss: 0.0535, Accuracy: 6/591 (1.0152%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   5,  Average loss: 0.0506, Accuracy: 3/591 (0.5076%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   6,  Average loss: 0.0479, Accuracy: 3/591 (0.5076%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   7,  Average loss: 0.0455, Accuracy: 179/591 (30.2876%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   8,  Average loss: 0.0435, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   9,  Average loss: 0.0421, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch  10,  Average loss: 0.0418, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Global model norm: 71.33293555793495.
Norm before scaling: 70.73080431952899. Distance: 5.956013296733742
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 2.3759, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 1.7303, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 589.6845555040424, distance: 595.6013505273472
Total norm for 4 adversaries is: 589.6845555040424. distance: 595.6013505273472
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 74.2753, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   1,  Average loss: 0.0678, Accuracy: 5/568 (0.8803%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   2,  Average loss: 0.0494, Accuracy: 110/568 (19.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   3,  Average loss: 0.0393, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   4,  Average loss: 0.0382, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   5,  Average loss: 0.0365, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   6,  Average loss: 0.0357, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   7,  Average loss: 0.0345, Accuracy: 230/568 (40.4930%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   8,  Average loss: 0.0335, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   9,  Average loss: 0.0324, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch  10,  Average loss: 0.0324, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Global model norm: 71.33293555793495.
Norm before scaling: 70.92318825893616. Distance: 4.530765691723188
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 2.9436, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 2.2434, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 449.9834198334423, distance: 453.0765663770308
Total norm for 4 adversaries is: 449.9834198334423. distance: 453.0765663770308
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   1,  Average loss: 0.0570, Accuracy: 16/557 (2.8725%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   2,  Average loss: 0.0456, Accuracy: 85/557 (15.2603%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   3,  Average loss: 0.0383, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   4,  Average loss: 0.0369, Accuracy: 135/557 (24.2370%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   5,  Average loss: 0.0365, Accuracy: 120/557 (21.5440%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   6,  Average loss: 0.0349, Accuracy: 125/557 (22.4417%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   7,  Average loss: 0.0341, Accuracy: 128/557 (22.9803%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   8,  Average loss: 0.0327, Accuracy: 121/557 (21.7235%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   9,  Average loss: 0.0326, Accuracy: 123/557 (22.0826%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch  10,  Average loss: 0.0323, Accuracy: 125/557 (22.4417%), train_poison_data_count: 180
Global model norm: 71.33293555793495.
Norm before scaling: 70.95367037612466. Distance: 3.73766383191562
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 2.9226, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 2.3057, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 371.4784860863412, distance: 373.76636669850325
Total norm for 4 adversaries is: 371.4784860863412. distance: 373.76636669850325
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  65, local model 75, internal_epoch   1,  Average loss: 0.0464, Accuracy: 44/686 (6.4140%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 3.1131, Accuracy: 1028/10000 (10.2800%)
___Train Local_Simple,  epoch  65, local model 62, internal_epoch   1,  Average loss: 0.0607, Accuracy: 10/423 (2.3641%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 3.1362, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  65, local model 42, internal_epoch   1,  Average loss: 0.0636, Accuracy: 5/236 (2.1186%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 3.3265, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  65, local model 43, internal_epoch   1,  Average loss: 0.0430, Accuracy: 26/408 (6.3725%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 3.3190, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  65, local model 87, internal_epoch   1,  Average loss: 0.0731, Accuracy: 48/470 (10.2128%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 2.9993, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  65, local model 26, internal_epoch   1,  Average loss: 0.0660, Accuracy: 48/554 (8.6643%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 2.9286, Accuracy: 892/10000 (8.9200%)
time spent on training: 104.68372464179993
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 65: Average loss: 10.5248, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 65: Average loss: 0.0002, Accuracy: 8968/8968 (100.0000%)
Done in 123.19366335868835 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:66 choose agents : [41, 73, 51, 74, 49, 52, 36, 55, 83, 33]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   1,  Average loss: 0.1217, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   2,  Average loss: 0.1005, Accuracy: 265/606 (43.7294%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   3,  Average loss: 0.0788, Accuracy: 276/606 (45.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   4,  Average loss: 0.0760, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   5,  Average loss: 0.0727, Accuracy: 273/606 (45.0495%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   6,  Average loss: 0.0680, Accuracy: 276/606 (45.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   7,  Average loss: 0.0654, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   8,  Average loss: 0.0602, Accuracy: 278/606 (45.8746%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   9,  Average loss: 0.0588, Accuracy: 275/606 (45.3795%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch  10,  Average loss: 0.0583, Accuracy: 276/606 (45.5446%), train_poison_data_count: 200
Global model norm: 70.9003688614347.
Norm before scaling: 69.84603254100229. Distance: 6.2467777338131745
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 5.6516, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0361, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 613.6020442844042, distance: 624.6777919455757
Total norm for 4 adversaries is: 613.6020442844042. distance: 624.6777919455757
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 853.0416, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   1,  Average loss: 0.1026, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   2,  Average loss: 0.0719, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   3,  Average loss: 0.0470, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   4,  Average loss: 0.0431, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   5,  Average loss: 0.0403, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   6,  Average loss: 0.0371, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   7,  Average loss: 0.0344, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   8,  Average loss: 0.0324, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   9,  Average loss: 0.0303, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch  10,  Average loss: 0.0289, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Global model norm: 70.9003688614347.
Norm before scaling: 70.0887446663603. Distance: 6.61187566971931
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 5.4522, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.3401, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 652.9786079956984, distance: 661.1875443094796
Total norm for 4 adversaries is: 652.9786079956984. distance: 661.1875443094796
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 900.5469, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   1,  Average loss: 0.0859, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   2,  Average loss: 0.0636, Accuracy: 241/568 (42.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   3,  Average loss: 0.0472, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   4,  Average loss: 0.0445, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   5,  Average loss: 0.0414, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   6,  Average loss: 0.0391, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   7,  Average loss: 0.0348, Accuracy: 244/568 (42.9577%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   8,  Average loss: 0.0322, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   9,  Average loss: 0.0320, Accuracy: 229/568 (40.3169%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch  10,  Average loss: 0.0321, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Global model norm: 70.9003688614347.
Norm before scaling: 70.21549210844606. Distance: 5.440044465444261
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 6.2862, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.2062, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 536.9763437526834, distance: 544.0044519578861
Total norm for 4 adversaries is: 536.9763437526834. distance: 544.0044519578861
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 739.5566, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   1,  Average loss: 0.1139, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   2,  Average loss: 0.0943, Accuracy: 219/557 (39.3178%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   3,  Average loss: 0.0764, Accuracy: 227/557 (40.7540%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   4,  Average loss: 0.0758, Accuracy: 217/557 (38.9587%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   5,  Average loss: 0.0706, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   6,  Average loss: 0.0679, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   7,  Average loss: 0.0646, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   8,  Average loss: 0.0622, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   9,  Average loss: 0.0608, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch  10,  Average loss: 0.0594, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Global model norm: 70.9003688614347.
Norm before scaling: 70.00891405296186. Distance: 5.349016773037118
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 5.8074, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0345, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 525.0942772493336, distance: 534.9016556807429
Total norm for 4 adversaries is: 525.0942772493336. distance: 534.9016556807429
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 643.0970, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  66, local model 49, internal_epoch   1,  Average loss: 0.1534, Accuracy: 2/506 (0.3953%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 7.6676, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  66, local model 52, internal_epoch   1,  Average loss: 0.1811, Accuracy: 0/253 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 9.6191, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  66, local model 36, internal_epoch   1,  Average loss: 0.1329, Accuracy: 105/1005 (10.4478%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 3.4096, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  66, local model 55, internal_epoch   1,  Average loss: 0.1479, Accuracy: 21/354 (5.9322%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 8.8418, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  66, local model 83, internal_epoch   1,  Average loss: 0.1427, Accuracy: 77/433 (17.7829%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 8.6440, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  66, local model 33, internal_epoch   1,  Average loss: 0.1830, Accuracy: 0/623 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 6.4128, Accuracy: 1032/10000 (10.3200%)
time spent on training: 95.15384125709534
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 66: Average loss: 6.1485, Accuracy: 1009/10000 (10.0900%)
___Test Target_Simple poisoned: True, epoch: 66: Average loss: 15.3333, Accuracy: 0/8968 (0.0000%)
Done in 112.84428715705872 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:67 choose agents : [41, 73, 51, 74, 25, 15, 1, 67, 86, 4]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   1,  Average loss: 0.1654, Accuracy: 4/606 (0.6601%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   2,  Average loss: 0.1214, Accuracy: 37/606 (6.1056%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   3,  Average loss: 0.0938, Accuracy: 38/606 (6.2706%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   4,  Average loss: 0.0884, Accuracy: 36/606 (5.9406%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   5,  Average loss: 0.0852, Accuracy: 32/606 (5.2805%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   6,  Average loss: 0.0829, Accuracy: 29/606 (4.7855%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   7,  Average loss: 0.0795, Accuracy: 184/606 (30.3630%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   8,  Average loss: 0.0780, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   9,  Average loss: 0.0758, Accuracy: 253/606 (41.7492%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch  10,  Average loss: 0.0748, Accuracy: 256/606 (42.2442%), train_poison_data_count: 200
Global model norm: 69.68398954162642.
Norm before scaling: 68.59464691896518. Distance: 7.322060359052726
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 3.3385, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 8.2412, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 721.4963617371885, distance: 732.2060416986465
Total norm for 4 adversaries is: 721.4963617371885. distance: 732.2060416986465
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   1,  Average loss: 0.1173, Accuracy: 143/591 (24.1963%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   2,  Average loss: 0.1029, Accuracy: 258/591 (43.6548%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   3,  Average loss: 0.0909, Accuracy: 263/591 (44.5008%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   4,  Average loss: 0.0891, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   5,  Average loss: 0.0868, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   6,  Average loss: 0.0847, Accuracy: 269/591 (45.5161%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   7,  Average loss: 0.0835, Accuracy: 256/591 (43.3164%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   8,  Average loss: 0.0801, Accuracy: 272/591 (46.0237%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   9,  Average loss: 0.0793, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch  10,  Average loss: 0.0798, Accuracy: 259/591 (43.8240%), train_poison_data_count: 195
Global model norm: 69.68398954162642.
Norm before scaling: 68.73318331258382. Distance: 4.70986526458527
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 4.1483, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 9.9223, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 459.6793209673457, distance: 470.9864979487204
Total norm for 4 adversaries is: 459.6793209673457. distance: 470.9864979487204
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   1,  Average loss: 0.1140, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   2,  Average loss: 0.1008, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   3,  Average loss: 0.0896, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   4,  Average loss: 0.0867, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   5,  Average loss: 0.0854, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   6,  Average loss: 0.0836, Accuracy: 234/568 (41.1972%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   7,  Average loss: 0.0816, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   8,  Average loss: 0.0790, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   9,  Average loss: 0.0805, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch  10,  Average loss: 0.0784, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Global model norm: 69.68398954162642.
Norm before scaling: 68.80593250335504. Distance: 4.359178545500601
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 4.3417, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 10.1989, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 425.22905592162914, distance: 435.91783557799056
Total norm for 4 adversaries is: 425.22905592162914. distance: 435.91783557799056
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   1,  Average loss: 0.1458, Accuracy: 27/557 (4.8474%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   2,  Average loss: 0.1183, Accuracy: 27/557 (4.8474%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   3,  Average loss: 0.0990, Accuracy: 26/557 (4.6679%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   4,  Average loss: 0.0959, Accuracy: 26/557 (4.6679%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   5,  Average loss: 0.0908, Accuracy: 29/557 (5.2065%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   6,  Average loss: 0.0907, Accuracy: 26/557 (4.6679%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   7,  Average loss: 0.0860, Accuracy: 30/557 (5.3860%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   8,  Average loss: 0.0835, Accuracy: 31/557 (5.5655%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   9,  Average loss: 0.0827, Accuracy: 30/557 (5.3860%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch  10,  Average loss: 0.0832, Accuracy: 27/557 (4.8474%), train_poison_data_count: 180
Global model norm: 69.68398954162642.
Norm before scaling: 68.74376392171875. Distance: 5.947278132683892
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 3.4066, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 9.4781, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 584.8116416847394, distance: 594.7277475870787
Total norm for 4 adversaries is: 584.8116416847394. distance: 594.7277475870787
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  67, local model 25, internal_epoch   1,  Average loss: 0.1264, Accuracy: 202/647 (31.2210%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 4.6708, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  67, local model 15, internal_epoch   1,  Average loss: 0.1108, Accuracy: 13/401 (3.2419%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 5.0857, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  67, local model 1, internal_epoch   1,  Average loss: 0.0905, Accuracy: 55/760 (7.2368%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 3.9542, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  67, local model 67, internal_epoch   1,  Average loss: 0.0815, Accuracy: 13/998 (1.3026%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 3.4408, Accuracy: 1010/10000 (10.1000%)
___Train Local_Simple,  epoch  67, local model 86, internal_epoch   1,  Average loss: 0.1021, Accuracy: 5/250 (2.0000%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 5.7249, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch  67, local model 4, internal_epoch   1,  Average loss: 0.0776, Accuracy: 42/658 (6.3830%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 4.2678, Accuracy: 1009/10000 (10.0900%)
time spent on training: 98.91287302970886
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 67: Average loss: 5.1561, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 67: Average loss: 0.1733, Accuracy: 8968/8968 (100.0000%)
Done in 117.43676924705505 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:68 choose agents : [41, 73, 51, 74, 83, 32, 48, 45, 93, 49]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   1,  Average loss: 0.0346, Accuracy: 272/606 (44.8845%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   2,  Average loss: 0.0269, Accuracy: 263/606 (43.3993%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   3,  Average loss: 0.0262, Accuracy: 253/606 (41.7492%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   4,  Average loss: 0.0261, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   5,  Average loss: 0.0278, Accuracy: 250/606 (41.2541%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   6,  Average loss: 0.0267, Accuracy: 248/606 (40.9241%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   7,  Average loss: 0.0277, Accuracy: 256/606 (42.2442%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   8,  Average loss: 0.0266, Accuracy: 249/606 (41.0891%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   9,  Average loss: 0.0259, Accuracy: 244/606 (40.2640%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch  10,  Average loss: 0.0265, Accuracy: 269/606 (44.3894%), train_poison_data_count: 200
Global model norm: 68.22372433765251.
Norm before scaling: 67.82450570567212. Distance: 1.9115965859899309
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 4.5365, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.8381, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 188.14835818443913, distance: 191.1596600357931
Total norm for 4 adversaries is: 188.14835818443913. distance: 191.1596600357931
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 241.1359, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   1,  Average loss: 0.0941, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   2,  Average loss: 0.0769, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   3,  Average loss: 0.0641, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   4,  Average loss: 0.0629, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   5,  Average loss: 0.0613, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   6,  Average loss: 0.0589, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   7,  Average loss: 0.0572, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   8,  Average loss: 0.0551, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   9,  Average loss: 0.0545, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch  10,  Average loss: 0.0549, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Global model norm: 68.22372433765251.
Norm before scaling: 67.48667041419179. Distance: 4.887814430210583
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 3.3259, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.7954, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 480.8015118008678, distance: 488.7813928536969
Total norm for 4 adversaries is: 480.8015118008678. distance: 488.7813928536969
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 628.0587, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   1,  Average loss: 0.0912, Accuracy: 232/568 (40.8451%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   2,  Average loss: 0.0766, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   3,  Average loss: 0.0679, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   4,  Average loss: 0.0676, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   5,  Average loss: 0.0653, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   6,  Average loss: 0.0646, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   7,  Average loss: 0.0623, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   8,  Average loss: 0.0621, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   9,  Average loss: 0.0606, Accuracy: 240/568 (42.2535%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch  10,  Average loss: 0.0601, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Global model norm: 68.22372433765251.
Norm before scaling: 67.5332961860296. Distance: 4.096423957490479
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 3.5456, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.6892, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 401.75892569425264, distance: 409.64239358860306
Total norm for 4 adversaries is: 401.75892569425264. distance: 409.64239358860306
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 530.3429, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   1,  Average loss: 0.0426, Accuracy: 217/557 (38.9587%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   2,  Average loss: 0.0357, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   3,  Average loss: 0.0318, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   4,  Average loss: 0.0315, Accuracy: 228/557 (40.9336%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   5,  Average loss: 0.0324, Accuracy: 231/557 (41.4722%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   6,  Average loss: 0.0320, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   7,  Average loss: 0.0327, Accuracy: 218/557 (39.1382%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   8,  Average loss: 0.0328, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   9,  Average loss: 0.0320, Accuracy: 220/557 (39.4973%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch  10,  Average loss: 0.0324, Accuracy: 227/557 (40.7540%), train_poison_data_count: 180
Global model norm: 68.22372433765251.
Norm before scaling: 67.84061557130617. Distance: 2.3725349282204933
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 4.0566, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.9215, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 234.87880019544122, distance: 237.25349049065642
Total norm for 4 adversaries is: 234.87880019544122. distance: 237.25349049065642
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 270.2271, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  68, local model 83, internal_epoch   1,  Average loss: 0.0801, Accuracy: 77/433 (17.7829%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 4.1570, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  68, local model 32, internal_epoch   1,  Average loss: 0.0750, Accuracy: 112/977 (11.4637%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 3.5790, Accuracy: 1010/10000 (10.1000%)
___Train Local_Simple,  epoch  68, local model 48, internal_epoch   1,  Average loss: 0.0917, Accuracy: 77/448 (17.1875%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 4.1345, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  68, local model 45, internal_epoch   1,  Average loss: 0.0798, Accuracy: 23/628 (3.6624%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 3.7494, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch  68, local model 93, internal_epoch   1,  Average loss: 0.0892, Accuracy: 4/623 (0.6421%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 3.5814, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  68, local model 49, internal_epoch   1,  Average loss: 0.1155, Accuracy: 2/506 (0.3953%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 3.7900, Accuracy: 1032/10000 (10.3200%)
time spent on training: 96.45222926139832
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 68: Average loss: 2.8305, Accuracy: 1135/10000 (11.3500%)
___Test Target_Simple poisoned: True, epoch: 68: Average loss: 5.7112, Accuracy: 0/8968 (0.0000%)
Done in 114.4181501865387 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:69 choose agents : [41, 73, 51, 74, 72, 81, 27, 30, 33, 42]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   1,  Average loss: 0.0585, Accuracy: 91/606 (15.0165%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   2,  Average loss: 0.0413, Accuracy: 263/606 (43.3993%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   3,  Average loss: 0.0318, Accuracy: 264/606 (43.5644%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   4,  Average loss: 0.0315, Accuracy: 242/606 (39.9340%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   5,  Average loss: 0.0296, Accuracy: 255/606 (42.0792%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   6,  Average loss: 0.0285, Accuracy: 251/606 (41.4191%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   7,  Average loss: 0.0268, Accuracy: 258/606 (42.5743%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   8,  Average loss: 0.0263, Accuracy: 247/606 (40.7591%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   9,  Average loss: 0.0261, Accuracy: 239/606 (39.4389%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch  10,  Average loss: 0.0254, Accuracy: 257/606 (42.4092%), train_poison_data_count: 200
Global model norm: 66.43801078707692.
Norm before scaling: 66.0735267523991. Distance: 4.533846196914963
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 2.7588, Accuracy: 892/10000 (8.9200%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 1.7381, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 450.65086610923095, distance: 453.3846152826538
Total norm for 4 adversaries is: 450.65086610923095. distance: 453.3846152826538
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   1,  Average loss: 0.0635, Accuracy: 0/591 (0.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   2,  Average loss: 0.0465, Accuracy: 233/591 (39.4247%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   3,  Average loss: 0.0381, Accuracy: 268/591 (45.3469%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   4,  Average loss: 0.0365, Accuracy: 274/591 (46.3621%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   5,  Average loss: 0.0352, Accuracy: 270/591 (45.6853%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   6,  Average loss: 0.0340, Accuracy: 273/591 (46.1929%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   7,  Average loss: 0.0335, Accuracy: 266/591 (45.0085%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   8,  Average loss: 0.0322, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   9,  Average loss: 0.0317, Accuracy: 271/591 (45.8545%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch  10,  Average loss: 0.0321, Accuracy: 264/591 (44.6701%), train_poison_data_count: 195
Global model norm: 66.43801078707692.
Norm before scaling: 66.0511461388067. Distance: 4.384761710048363
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 2.6466, Accuracy: 980/10000 (9.8000%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 2.3549, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 435.46205704400927, distance: 438.47619661733063
Total norm for 4 adversaries is: 435.46205704400927. distance: 438.47619661733063
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   1,  Average loss: 0.0695, Accuracy: 23/568 (4.0493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   2,  Average loss: 0.0523, Accuracy: 25/568 (4.4014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   3,  Average loss: 0.0397, Accuracy: 19/568 (3.3451%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   4,  Average loss: 0.0376, Accuracy: 186/568 (32.7465%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   5,  Average loss: 0.0357, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   6,  Average loss: 0.0342, Accuracy: 233/568 (41.0211%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   7,  Average loss: 0.0326, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   8,  Average loss: 0.0313, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   9,  Average loss: 0.0307, Accuracy: 228/568 (40.1408%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch  10,  Average loss: 0.0307, Accuracy: 224/568 (39.4366%), train_poison_data_count: 180
Global model norm: 66.43801078707692.
Norm before scaling: 66.0634275892778. Distance: 4.713216404379468
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 2.3906, Accuracy: 1009/10000 (10.0900%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 2.1810, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 468.3731485151556, distance: 471.32162917163055
Total norm for 4 adversaries is: 468.3731485151556. distance: 471.32162917163055
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   1,  Average loss: 0.0546, Accuracy: 111/557 (19.9282%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   2,  Average loss: 0.0458, Accuracy: 120/557 (21.5440%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   3,  Average loss: 0.0398, Accuracy: 119/557 (21.3645%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   4,  Average loss: 0.0391, Accuracy: 120/557 (21.5440%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   5,  Average loss: 0.0376, Accuracy: 127/557 (22.8007%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   6,  Average loss: 0.0362, Accuracy: 140/557 (25.1346%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   7,  Average loss: 0.0352, Accuracy: 137/557 (24.5961%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   8,  Average loss: 0.0344, Accuracy: 135/557 (24.2370%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   9,  Average loss: 0.0343, Accuracy: 121/557 (21.7235%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch  10,  Average loss: 0.0342, Accuracy: 117/557 (21.0054%), train_poison_data_count: 180
Global model norm: 66.43801078707692.
Norm before scaling: 66.09124921391825. Distance: 3.319650812974245
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 2.5449, Accuracy: 982/10000 (9.8200%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 2.4173, Accuracy: 0/8968 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 330.0260643115934, distance: 331.965088996569
Total norm for 4 adversaries is: 330.0260643115934. distance: 331.965088996569
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  69, local model 72, internal_epoch   1,  Average loss: 0.0357, Accuracy: 200/731 (27.3598%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 2.9694, Accuracy: 958/10000 (9.5800%)
___Train Local_Simple,  epoch  69, local model 81, internal_epoch   1,  Average loss: 0.0291, Accuracy: 496/1227 (40.4238%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 3.3849, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  69, local model 27, internal_epoch   1,  Average loss: 0.0485, Accuracy: 25/471 (5.3079%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 2.6840, Accuracy: 1028/10000 (10.2800%)
___Train Local_Simple,  epoch  69, local model 30, internal_epoch   1,  Average loss: 0.0543, Accuracy: 24/400 (6.0000%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 2.7216, Accuracy: 1010/10000 (10.1000%)
___Train Local_Simple,  epoch  69, local model 33, internal_epoch   1,  Average loss: 0.0337, Accuracy: 130/623 (20.8668%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 2.8568, Accuracy: 892/10000 (8.9200%)
___Train Local_Simple,  epoch  69, local model 42, internal_epoch   1,  Average loss: 0.0602, Accuracy: 14/236 (5.9322%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 2.7557, Accuracy: 1135/10000 (11.3500%)
time spent on training: 97.68931698799133
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 69: Average loss: 10.3003, Accuracy: 1032/10000 (10.3200%)
___Test Target_Simple poisoned: True, epoch: 69: Average loss: 0.0003, Accuracy: 8968/8968 (100.0000%)
Done in 115.85721945762634 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:70 choose agents : [41, 73, 51, 74, 5, 54, 88, 44, 64, 18]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   1,  Average loss: 0.0918, Accuracy: 277/606 (45.7096%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   2,  Average loss: 0.0703, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   3,  Average loss: 0.0502, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   4,  Average loss: 0.0451, Accuracy: 282/606 (46.5347%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   5,  Average loss: 0.0422, Accuracy: 277/606 (45.7096%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   6,  Average loss: 0.0399, Accuracy: 274/606 (45.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   7,  Average loss: 0.0365, Accuracy: 269/606 (44.3894%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   8,  Average loss: 0.0331, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   9,  Average loss: 0.0314, Accuracy: 271/606 (44.7195%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch  10,  Average loss: 0.0303, Accuracy: 279/606 (46.0396%), train_poison_data_count: 200
Global model norm: 66.23445056317935.
Norm before scaling: 65.41218096019081. Distance: 6.1464005892764115
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 5.6444, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.1161, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 606.2727830770568, distance: 614.6400369321868
Total norm for 4 adversaries is: 606.2727830770568. distance: 614.6400369321868
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 846.7071, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   1,  Average loss: 0.0941, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   2,  Average loss: 0.0636, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   3,  Average loss: 0.0404, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   4,  Average loss: 0.0377, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   5,  Average loss: 0.0343, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   6,  Average loss: 0.0327, Accuracy: 197/591 (33.3333%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   7,  Average loss: 0.0315, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   8,  Average loss: 0.0303, Accuracy: 200/591 (33.8409%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   9,  Average loss: 0.0310, Accuracy: 199/591 (33.6717%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch  10,  Average loss: 0.0297, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Global model norm: 66.23445056317935.
Norm before scaling: 65.47483190723936. Distance: 6.182068878333133
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 5.7111, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.5256, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 610.524441566429, distance: 618.2068828474818
Total norm for 4 adversaries is: 610.524441566429. distance: 618.2068828474818
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 838.5377, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   1,  Average loss: 0.0828, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   2,  Average loss: 0.0601, Accuracy: 239/568 (42.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   3,  Average loss: 0.0450, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   4,  Average loss: 0.0394, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   5,  Average loss: 0.0360, Accuracy: 237/568 (41.7254%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   6,  Average loss: 0.0355, Accuracy: 231/568 (40.6690%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   7,  Average loss: 0.0333, Accuracy: 235/568 (41.3732%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   8,  Average loss: 0.0302, Accuracy: 236/568 (41.5493%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   9,  Average loss: 0.0304, Accuracy: 242/568 (42.6056%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch  10,  Average loss: 0.0288, Accuracy: 238/568 (41.9014%), train_poison_data_count: 180
Global model norm: 66.23445056317935.
Norm before scaling: 65.56732584717787. Distance: 5.3855657304785245
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 6.1724, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.2741, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 531.7301947416565, distance: 538.5565487950174
Total norm for 4 adversaries is: 531.7301947416565. distance: 538.5565487950174
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 732.7701, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   1,  Average loss: 0.1157, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   2,  Average loss: 0.0954, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   3,  Average loss: 0.0815, Accuracy: 215/557 (38.5996%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   4,  Average loss: 0.0764, Accuracy: 224/557 (40.2154%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   5,  Average loss: 0.0739, Accuracy: 222/557 (39.8564%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   6,  Average loss: 0.0704, Accuracy: 226/557 (40.5745%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   7,  Average loss: 0.0686, Accuracy: 217/557 (38.9587%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   8,  Average loss: 0.0647, Accuracy: 223/557 (40.0359%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   9,  Average loss: 0.0624, Accuracy: 225/557 (40.3950%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch  10,  Average loss: 0.0629, Accuracy: 221/557 (39.6768%), train_poison_data_count: 180
Global model norm: 66.23445056317935.
Norm before scaling: 65.30495620308997. Distance: 5.314758359309168
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 5.6291, Accuracy: 1032/10000 (10.3200%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0502, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 521.3467236398441, distance: 531.4758049525867
Total norm for 4 adversaries is: 521.3467236398441. distance: 531.4758049525867
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 638.8997, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  70, local model 5, internal_epoch   1,  Average loss: 0.1600, Accuracy: 4/434 (0.9217%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 8.0180, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  70, local model 54, internal_epoch   1,  Average loss: 0.1633, Accuracy: 53/519 (10.2119%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 7.1440, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  70, local model 88, internal_epoch   1,  Average loss: 0.1455, Accuracy: 88/530 (16.6038%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 7.3913, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  70, local model 44, internal_epoch   1,  Average loss: 0.1817, Accuracy: 25/517 (4.8356%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 6.9635, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  70, local model 64, internal_epoch   1,  Average loss: 0.1330, Accuracy: 100/813 (12.3001%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 4.9433, Accuracy: 1032/10000 (10.3200%)
___Train Local_Simple,  epoch  70, local model 18, internal_epoch   1,  Average loss: 0.1732, Accuracy: 11/459 (2.3965%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 7.5114, Accuracy: 1032/10000 (10.3200%)
time spent on training: 100.46005487442017
----------------------------------End one training epoch------------------------------------------
___Test Target_Simple poisoned: False, epoch: 70: Average loss: 6.4930, Accuracy: 980/10000 (9.8000%)
___Test Target_Simple poisoned: True, epoch: 70: Average loss: 15.4019, Accuracy: 0/8968 (0.0000%)
Done in 118.94024395942688 sec.
Saving all the graphs.
This run has a label: Nov.13_03.45.15. Visdom environment: mnist_DBA
