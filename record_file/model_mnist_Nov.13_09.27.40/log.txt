current path: saved_models/model_mnist_Nov.13_09.27.40
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [41, 73, 51, 74]
We use following environment for graphs:  mnist_DBA
----------------------------------Start one training epoch------------------------------------------
Server Epoch:11 choose agents : [23, 76, 63, 11, 75, 43, 46, 37, 21, 35]. Adversary List: []
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1700, Accuracy: 9437/10000 (94.3700%)
___Train Local_Simple,  epoch  11, local model 76, internal_epoch   1,  Average loss: 0.0035, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1195, Accuracy: 9606/10000 (96.0600%)
___Train Local_Simple,  epoch  11, local model 63, internal_epoch   1,  Average loss: 0.0018, Accuracy: 861/889 (96.8504%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1146, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0018, Accuracy: 628/645 (97.3643%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2950, Accuracy: 9066/10000 (90.6600%)
___Train Local_Simple,  epoch  11, local model 75, internal_epoch   1,  Average loss: 0.0013, Accuracy: 669/686 (97.5219%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1793, Accuracy: 9440/10000 (94.4000%)
___Train Local_Simple,  epoch  11, local model 43, internal_epoch   1,  Average loss: 0.0012, Accuracy: 397/408 (97.3039%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2036, Accuracy: 9348/10000 (93.4800%)
___Train Local_Simple,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0016, Accuracy: 688/710 (96.9014%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3423, Accuracy: 8863/10000 (88.6300%)
___Train Local_Simple,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0015, Accuracy: 834/860 (96.9767%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2918, Accuracy: 9166/10000 (91.6600%)
___Train Local_Simple,  epoch  11, local model 21, internal_epoch   1,  Average loss: 0.0013, Accuracy: 302/312 (96.7949%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2550, Accuracy: 9238/10000 (92.3800%)
___Train Local_Simple,  epoch  11, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 493/499 (98.7976%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1869, Accuracy: 9428/10000 (94.2800%)
time spent on training: 23.78515934944153
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [293, 78, 889, 645, 686, 408, 710, 860, 312, 499]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [23, 76, 63, 11, 75, 43, 46, 37, 21, 35], weight: tensor([0.0545, 0.0145, 0.1652, 0.1199, 0.1275, 0.0758, 0.1320, 0.1599, 0.0580,
        0.0928])
[rfa agg] iter:  0, prev_obj_val: 0.8145514130592346, obj_val: 0.8110150098800659, abs dis: 0.003536403179168701
[rfa agg] iter:  0, weight: tensor([0.0811, 0.0236, 0.1357, 0.1108, 0.1310, 0.0966, 0.1036, 0.1187, 0.0725,
        0.1262])
[rfa agg] iter:  1, prev_obj_val: 0.8110150098800659, obj_val: 0.8108963966369629, abs dis: 0.00011861324310302734
[rfa agg] iter:  1, weight: tensor([0.0854, 0.0249, 0.1287, 0.1092, 0.1321, 0.1001, 0.1003, 0.1122, 0.0739,
        0.1331])
[rfa agg] iter:  2, prev_obj_val: 0.8108963966369629, obj_val: 0.8108922839164734, abs dis: 4.112720489501953e-06
[rfa agg] iter:  2, weight: tensor([0.0862, 0.0252, 0.1273, 0.1088, 0.1323, 0.1008, 0.0998, 0.1111, 0.0741,
        0.1345])
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 0.0827, Accuracy: 9727/10000 (97.2700%)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 12.2360, Accuracy: 41/8968 (0.4572%)
Done in 40.17145800590515 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:12 choose agents : [41, 11, 61, 64, 28, 67, 22, 82, 60, 42]. Adversary List: [41]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0221, Accuracy: 383/606 (63.2013%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   2,  Average loss: 0.0175, Accuracy: 342/606 (56.4356%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   3,  Average loss: 0.0125, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   4,  Average loss: 0.0125, Accuracy: 394/606 (65.0165%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   5,  Average loss: 0.0119, Accuracy: 402/606 (66.3366%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   6,  Average loss: 0.0115, Accuracy: 407/606 (67.1617%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   7,  Average loss: 0.0112, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   8,  Average loss: 0.0107, Accuracy: 414/606 (68.3168%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   9,  Average loss: 0.0109, Accuracy: 418/606 (68.9769%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch  10,  Average loss: 0.0108, Accuracy: 417/606 (68.8119%), train_poison_data_count: 200
Global model norm: 16.53598629575622.
Norm before scaling: 16.666646321602165. Distance: 4.19993861925595
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.4163, Accuracy: 4805/10000 (48.0500%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.8895, Accuracy: 5361/8968 (59.7792%)
Scaling by  100
Scaled Norm after poisoning: 418.7340108887741, distance: 419.9938801637471
Total norm for 1 adversaries is: 418.7340108887741. distance: 419.9938801637471
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 19468.6415, Accuracy: 350/8968 (3.9028%)
___Train Local_Simple,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 628/645 (97.3643%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3802, Accuracy: 8823/10000 (88.2300%)
___Train Local_Simple,  epoch  12, local model 61, internal_epoch   1,  Average loss: 0.0015, Accuracy: 682/699 (97.5680%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.4677, Accuracy: 8612/10000 (86.1200%)
___Train Local_Simple,  epoch  12, local model 64, internal_epoch   1,  Average loss: 0.0016, Accuracy: 787/813 (96.8020%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3299, Accuracy: 8829/10000 (88.2900%)
___Train Local_Simple,  epoch  12, local model 28, internal_epoch   1,  Average loss: 0.0016, Accuracy: 489/501 (97.6048%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1207, Accuracy: 9611/10000 (96.1100%)
___Train Local_Simple,  epoch  12, local model 67, internal_epoch   1,  Average loss: 0.0015, Accuracy: 973/998 (97.4950%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2394, Accuracy: 9234/10000 (92.3400%)
___Train Local_Simple,  epoch  12, local model 22, internal_epoch   1,  Average loss: 0.0016, Accuracy: 565/583 (96.9125%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1766, Accuracy: 9480/10000 (94.8000%)
___Train Local_Simple,  epoch  12, local model 82, internal_epoch   1,  Average loss: 0.0015, Accuracy: 693/713 (97.1950%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.4558, Accuracy: 8516/10000 (85.1600%)
___Train Local_Simple,  epoch  12, local model 60, internal_epoch   1,  Average loss: 0.0018, Accuracy: 328/338 (97.0414%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1542, Accuracy: 9531/10000 (95.3100%)
___Train Local_Simple,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0011, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1024, Accuracy: 9678/10000 (96.7800%)
time spent on training: 38.139012575149536
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.09882583170254403  data num: [606, 645, 699, 813, 501, 998, 583, 713, 338, 236]
[rfa agg] considering poison per batch poison_fraction: 0.030883072407045006
[rfa agg] init. name: [41, 11, 61, 64, 28, 67, 22, 82, 60, 42], weight: tensor([0.0988, 0.1052, 0.1140, 0.1326, 0.0817, 0.1628, 0.0951, 0.1163, 0.0551,
        0.0385])
[rfa agg] iter:  0, prev_obj_val: 74.80899047851562, obj_val: 45.57630920410156, abs dis: 29.232681274414062
[rfa agg] iter:  0, weight: tensor([0.0119, 0.1151, 0.1251, 0.1456, 0.0896, 0.1785, 0.1043, 0.1274, 0.0606,
        0.0422])
[rfa agg] iter:  1, prev_obj_val: 45.57630920410156, obj_val: 42.38499069213867, abs dis: 3.1913185119628906
[rfa agg] iter:  1, weight: tensor([0.0013, 0.1142, 0.1270, 0.1480, 0.0909, 0.1798, 0.1060, 0.1277, 0.0624,
        0.0427])
[rfa agg] iter:  2, prev_obj_val: 42.38499069213867, obj_val: 42.2837028503418, abs dis: 0.101287841796875
[rfa agg] iter:  2, weight: tensor([0.0003, 0.1053, 0.1267, 0.1388, 0.1098, 0.1610, 0.1080, 0.1232, 0.0728,
        0.0542])
[rfa agg] iter:  3, prev_obj_val: 42.2837028503418, obj_val: 42.28309631347656, abs dis: 0.000606536865234375
[rfa agg] iter:  3, weight: tensor([0.0002, 0.1042, 0.1229, 0.1290, 0.1262, 0.1478, 0.1063, 0.1215, 0.0746,
        0.0673])
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 0.0810, Accuracy: 9739/10000 (97.3900%)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 12.0059, Accuracy: 41/8968 (0.4572%)
Done in 54.46296668052673 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:13 choose agents : [85, 56, 57, 63, 77, 18, 43, 91, 42, 52]. Adversary List: []
___Train Local_Simple,  epoch  13, local model 85, internal_epoch   1,  Average loss: 0.0008, Accuracy: 423/431 (98.1439%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1330, Accuracy: 9592/10000 (95.9200%)
___Train Local_Simple,  epoch  13, local model 56, internal_epoch   1,  Average loss: 0.0012, Accuracy: 861/880 (97.8409%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1654, Accuracy: 9462/10000 (94.6200%)
___Train Local_Simple,  epoch  13, local model 57, internal_epoch   1,  Average loss: 0.0019, Accuracy: 328/343 (95.6268%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2240, Accuracy: 9361/10000 (93.6100%)
___Train Local_Simple,  epoch  13, local model 63, internal_epoch   1,  Average loss: 0.0019, Accuracy: 859/889 (96.6254%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1316, Accuracy: 9591/10000 (95.9100%)
___Train Local_Simple,  epoch  13, local model 77, internal_epoch   1,  Average loss: 0.0014, Accuracy: 574/589 (97.4533%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1624, Accuracy: 9472/10000 (94.7200%)
___Train Local_Simple,  epoch  13, local model 18, internal_epoch   1,  Average loss: 0.0023, Accuracy: 442/459 (96.2963%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2715, Accuracy: 9119/10000 (91.1900%)
___Train Local_Simple,  epoch  13, local model 43, internal_epoch   1,  Average loss: 0.0014, Accuracy: 393/408 (96.3235%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1504, Accuracy: 9523/10000 (95.2300%)
___Train Local_Simple,  epoch  13, local model 91, internal_epoch   1,  Average loss: 0.0006, Accuracy: 252/256 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.0884, Accuracy: 9714/10000 (97.1400%)
___Train Local_Simple,  epoch  13, local model 42, internal_epoch   1,  Average loss: 0.0011, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1047, Accuracy: 9677/10000 (96.7700%)
___Train Local_Simple,  epoch  13, local model 52, internal_epoch   1,  Average loss: 0.0011, Accuracy: 247/253 (97.6285%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1917, Accuracy: 9400/10000 (94.0000%)
time spent on training: 21.698129177093506
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [431, 880, 343, 889, 589, 459, 408, 256, 236, 253]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [85, 56, 57, 63, 77, 18, 43, 91, 42, 52], weight: tensor([0.0909, 0.1855, 0.0723, 0.1874, 0.1242, 0.0968, 0.0860, 0.0540, 0.0497,
        0.0533])
[rfa agg] iter:  0, prev_obj_val: 0.7308575510978699, obj_val: 0.7260107398033142, abs dis: 0.004846811294555664
[rfa agg] iter:  0, weight: tensor([0.1063, 0.1459, 0.0737, 0.1414, 0.1157, 0.0872, 0.0967, 0.0884, 0.0707,
        0.0740])
[rfa agg] iter:  1, prev_obj_val: 0.7260107398033142, obj_val: 0.7256869077682495, abs dis: 0.00032383203506469727
[rfa agg] iter:  1, weight: tensor([0.1096, 0.1352, 0.0733, 0.1301, 0.1145, 0.0850, 0.0988, 0.0985, 0.0759,
        0.0790])
[rfa agg] iter:  2, prev_obj_val: 0.7256869077682495, obj_val: 0.7256665229797363, abs dis: 2.0384788513183594e-05
[rfa agg] iter:  2, weight: tensor([0.1103, 0.1325, 0.0731, 0.1274, 0.1141, 0.0844, 0.0991, 0.1014, 0.0773,
        0.0804])
[rfa agg] iter:  3, prev_obj_val: 0.7256665229797363, obj_val: 0.7256653308868408, abs dis: 1.1920928955078125e-06
[rfa agg] iter:  3, weight: tensor([0.1104, 0.1318, 0.0730, 0.1268, 0.1140, 0.0842, 0.0992, 0.1022, 0.0776,
        0.0807])
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 0.0789, Accuracy: 9749/10000 (97.4900%)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 11.9449, Accuracy: 38/8968 (0.4237%)
Done in 37.86566519737244 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:14 choose agents : [73, 28, 37, 96, 99, 80, 13, 98, 78, 46]. Adversary List: [73]
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   1,  Average loss: 0.0267, Accuracy: 330/591 (55.8376%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   2,  Average loss: 0.0247, Accuracy: 230/591 (38.9171%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   3,  Average loss: 0.0176, Accuracy: 198/591 (33.5025%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   4,  Average loss: 0.0165, Accuracy: 309/591 (52.2843%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   5,  Average loss: 0.0149, Accuracy: 363/591 (61.4213%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   6,  Average loss: 0.0145, Accuracy: 360/591 (60.9137%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   7,  Average loss: 0.0139, Accuracy: 349/591 (59.0525%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   8,  Average loss: 0.0139, Accuracy: 349/591 (59.0525%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   9,  Average loss: 0.0140, Accuracy: 351/591 (59.3909%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch  10,  Average loss: 0.0136, Accuracy: 371/591 (62.7750%), train_poison_data_count: 195
Global model norm: 16.528287741151438.
Norm before scaling: 16.75356061298286. Distance: 4.463537203572496
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9693, Accuracy: 6272/10000 (62.7200%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 1.0974, Accuracy: 3899/8968 (43.4768%)
Scaling by  100
Scaled Norm after poisoning: 445.2664932374768, distance: 446.35369943577257
Total norm for 1 adversaries is: 445.2664932374768. distance: 446.35369943577257
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  14, local model 28, internal_epoch   1,  Average loss: 0.0014, Accuracy: 487/501 (97.2056%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.0937, Accuracy: 9706/10000 (97.0600%)
___Train Local_Simple,  epoch  14, local model 37, internal_epoch   1,  Average loss: 0.0014, Accuracy: 836/860 (97.2093%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.4184, Accuracy: 8612/10000 (86.1200%)
___Train Local_Simple,  epoch  14, local model 96, internal_epoch   1,  Average loss: 0.0015, Accuracy: 658/672 (97.9167%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2089, Accuracy: 9326/10000 (93.2600%)
___Train Local_Simple,  epoch  14, local model 99, internal_epoch   1,  Average loss: 0.0009, Accuracy: 372/377 (98.6737%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.0927, Accuracy: 9711/10000 (97.1100%)
___Train Local_Simple,  epoch  14, local model 80, internal_epoch   1,  Average loss: 0.0009, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1733, Accuracy: 9477/10000 (94.7700%)
___Train Local_Simple,  epoch  14, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 720/734 (98.0926%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3929, Accuracy: 8938/10000 (89.3800%)
___Train Local_Simple,  epoch  14, local model 98, internal_epoch   1,  Average loss: 0.0015, Accuracy: 801/818 (97.9218%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.4807, Accuracy: 8532/10000 (85.3200%)
___Train Local_Simple,  epoch  14, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 297/303 (98.0198%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2406, Accuracy: 9255/10000 (92.5500%)
___Train Local_Simple,  epoch  14, local model 46, internal_epoch   1,  Average loss: 0.0023, Accuracy: 684/710 (96.3380%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3274, Accuracy: 8969/10000 (89.6900%)
time spent on training: 37.42477631568909
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.09854927463731866  data num: [591, 501, 860, 672, 377, 431, 734, 818, 303, 710]
[rfa agg] considering poison per batch poison_fraction: 0.030796648324162082
[rfa agg] init. name: [73, 28, 37, 96, 99, 80, 13, 98, 78, 46], weight: tensor([0.0985, 0.0835, 0.1434, 0.1121, 0.0629, 0.0719, 0.1224, 0.1364, 0.0505,
        0.1184])
[rfa agg] iter:  0, prev_obj_val: 79.30355072021484, obj_val: 48.27618408203125, abs dis: 31.027366638183594
[rfa agg] iter:  0, weight: tensor([0.0118, 0.0916, 0.1576, 0.1229, 0.0689, 0.0788, 0.1339, 0.1495, 0.0553,
        0.1298])
[rfa agg] iter:  1, prev_obj_val: 48.27618408203125, obj_val: 44.84441375732422, abs dis: 3.4317703247070312
[rfa agg] iter:  1, weight: tensor([0.0013, 0.0929, 0.1611, 0.1248, 0.0697, 0.0804, 0.1332, 0.1500, 0.0557,
        0.1307])
[rfa agg] iter:  2, prev_obj_val: 44.84441375732422, obj_val: 44.71497344970703, abs dis: 0.1294403076171875
[rfa agg] iter:  2, weight: tensor([0.0002, 0.1100, 0.1358, 0.1323, 0.0893, 0.1018, 0.1232, 0.1287, 0.0657,
        0.1129])
[rfa agg] iter:  3, prev_obj_val: 44.71497344970703, obj_val: 44.71315002441406, abs dis: 0.00182342529296875
[rfa agg] iter:  3, weight: tensor([0.0002, 0.1226, 0.1102, 0.1295, 0.1161, 0.1185, 0.1166, 0.1117, 0.0778,
        0.0969])
[rfa agg] iter:  4, prev_obj_val: 44.71315002441406, obj_val: 44.71310043334961, abs dis: 4.9591064453125e-05
[rfa agg] iter:  4, weight: tensor([0.0002, 0.1250, 0.1052, 0.1283, 0.1215, 0.1219, 0.1151, 0.1086, 0.0807,
        0.0936])
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 0.0776, Accuracy: 9755/10000 (97.5500%)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 11.8405, Accuracy: 34/8968 (0.3791%)
Done in 53.897671937942505 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:15 choose agents : [45, 62, 50, 67, 14, 36, 24, 7, 4, 80]. Adversary List: []
___Train Local_Simple,  epoch  15, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 615/628 (97.9299%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2946, Accuracy: 8999/10000 (89.9900%)
___Train Local_Simple,  epoch  15, local model 62, internal_epoch   1,  Average loss: 0.0008, Accuracy: 417/423 (98.5816%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1235, Accuracy: 9605/10000 (96.0500%)
___Train Local_Simple,  epoch  15, local model 50, internal_epoch   1,  Average loss: 0.0020, Accuracy: 456/474 (96.2025%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2672, Accuracy: 9137/10000 (91.3700%)
___Train Local_Simple,  epoch  15, local model 67, internal_epoch   1,  Average loss: 0.0017, Accuracy: 971/998 (97.2946%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2785, Accuracy: 9080/10000 (90.8000%)
___Train Local_Simple,  epoch  15, local model 14, internal_epoch   1,  Average loss: 0.0015, Accuracy: 365/376 (97.0745%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.0977, Accuracy: 9692/10000 (96.9200%)
___Train Local_Simple,  epoch  15, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 984/1005 (97.9104%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3327, Accuracy: 8958/10000 (89.5800%)
___Train Local_Simple,  epoch  15, local model 24, internal_epoch   1,  Average loss: 0.0018, Accuracy: 365/379 (96.3061%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1575, Accuracy: 9499/10000 (94.9900%)
___Train Local_Simple,  epoch  15, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 410/418 (98.0861%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1956, Accuracy: 9393/10000 (93.9300%)
___Train Local_Simple,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 639/658 (97.1125%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1789, Accuracy: 9402/10000 (94.0200%)
___Train Local_Simple,  epoch  15, local model 80, internal_epoch   1,  Average loss: 0.0010, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2216, Accuracy: 9318/10000 (93.1800%)
time spent on training: 22.163742542266846
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [628, 423, 474, 998, 376, 1005, 379, 418, 658, 431]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [45, 62, 50, 67, 14, 36, 24, 7, 4, 80], weight: tensor([0.1085, 0.0731, 0.0819, 0.1724, 0.0649, 0.1736, 0.0655, 0.0722, 0.1136,
        0.0744])
[rfa agg] iter:  0, prev_obj_val: 0.8272577524185181, obj_val: 0.8224558234214783, abs dis: 0.004801928997039795
[rfa agg] iter:  0, weight: tensor([0.1041, 0.1018, 0.0777, 0.1253, 0.0843, 0.1361, 0.0805, 0.0831, 0.1119,
        0.0953])
[rfa agg] iter:  1, prev_obj_val: 0.8224558234214783, obj_val: 0.8222552537918091, abs dis: 0.00020056962966918945
[rfa agg] iter:  1, weight: tensor([0.1030, 0.1083, 0.0771, 0.1159, 0.0883, 0.1287, 0.0821, 0.0863, 0.1107,
        0.0995])
[rfa agg] iter:  2, prev_obj_val: 0.8222552537918091, obj_val: 0.8222476243972778, abs dis: 7.62939453125e-06
[rfa agg] iter:  2, weight: tensor([0.1027, 0.1098, 0.0770, 0.1142, 0.0891, 0.1273, 0.0822, 0.0871, 0.1103,
        0.1004])
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 0.0767, Accuracy: 9755/10000 (97.5500%)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 11.7013, Accuracy: 35/8968 (0.3903%)
Done in 38.14725351333618 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:16 choose agents : [51, 39, 26, 29, 4, 42, 69, 95, 80, 8]. Adversary List: [51]
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   1,  Average loss: 0.0225, Accuracy: 329/568 (57.9225%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   2,  Average loss: 0.0132, Accuracy: 349/568 (61.4437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   3,  Average loss: 0.0118, Accuracy: 367/568 (64.6127%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   4,  Average loss: 0.0112, Accuracy: 382/568 (67.2535%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   5,  Average loss: 0.0108, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   6,  Average loss: 0.0106, Accuracy: 398/568 (70.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   7,  Average loss: 0.0100, Accuracy: 399/568 (70.2465%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   8,  Average loss: 0.0104, Accuracy: 387/568 (68.1338%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   9,  Average loss: 0.0098, Accuracy: 394/568 (69.3662%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch  10,  Average loss: 0.0101, Accuracy: 384/568 (67.6056%), train_poison_data_count: 180
Global model norm: 16.52087191961656.
Norm before scaling: 16.628769984906807. Distance: 4.042499312269238
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.3375, Accuracy: 4874/10000 (48.7400%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.7894, Accuracy: 5345/8968 (59.6008%)
Scaling by  100
Scaled Norm after poisoning: 403.00674622144976, distance: 404.2499226963439
Total norm for 1 adversaries is: 403.00674622144976. distance: 404.2499226963439
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  16, local model 39, internal_epoch   1,  Average loss: 0.0011, Accuracy: 252/257 (98.0545%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1477, Accuracy: 9502/10000 (95.0200%)
___Train Local_Simple,  epoch  16, local model 26, internal_epoch   1,  Average loss: 0.0017, Accuracy: 541/554 (97.6534%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1242, Accuracy: 9617/10000 (96.1700%)
___Train Local_Simple,  epoch  16, local model 29, internal_epoch   1,  Average loss: 0.0013, Accuracy: 977/1002 (97.5050%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2159, Accuracy: 9274/10000 (92.7400%)
___Train Local_Simple,  epoch  16, local model 4, internal_epoch   1,  Average loss: 0.0012, Accuracy: 643/658 (97.7204%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2372, Accuracy: 9223/10000 (92.2300%)
___Train Local_Simple,  epoch  16, local model 42, internal_epoch   1,  Average loss: 0.0011, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.0974, Accuracy: 9692/10000 (96.9200%)
___Train Local_Simple,  epoch  16, local model 69, internal_epoch   1,  Average loss: 0.0017, Accuracy: 248/256 (96.8750%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1425, Accuracy: 9527/10000 (95.2700%)
___Train Local_Simple,  epoch  16, local model 95, internal_epoch   1,  Average loss: 0.0005, Accuracy: 595/602 (98.8372%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.2056, Accuracy: 7631/10000 (76.3100%)
___Train Local_Simple,  epoch  16, local model 80, internal_epoch   1,  Average loss: 0.0012, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1765, Accuracy: 9478/10000 (94.7800%)
___Train Local_Simple,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0019, Accuracy: 615/633 (97.1564%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2066, Accuracy: 9335/10000 (93.3500%)
time spent on training: 37.336456060409546
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10929382335963056  data num: [568, 257, 554, 1002, 658, 236, 256, 602, 431, 633]
[rfa agg] considering poison per batch poison_fraction: 0.03415431979988455
[rfa agg] init. name: [51, 39, 26, 29, 4, 42, 69, 95, 80, 8], weight: tensor([0.1093, 0.0495, 0.1066, 0.1928, 0.1266, 0.0454, 0.0493, 0.1158, 0.0829,
        0.1218])
[rfa agg] iter:  0, prev_obj_val: 78.7010269165039, obj_val: 48.909053802490234, abs dis: 29.791973114013672
[rfa agg] iter:  0, weight: tensor([0.0148, 0.0546, 0.1178, 0.2139, 0.1398, 0.0501, 0.0544, 0.1280, 0.0916,
        0.1350])
[rfa agg] iter:  1, prev_obj_val: 48.909053802490234, obj_val: 45.07405471801758, abs dis: 3.8349990844726562
[rfa agg] iter:  1, weight: tensor([0.0019, 0.0551, 0.1189, 0.2206, 0.1400, 0.0505, 0.0547, 0.1281, 0.0922,
        0.1380])
[rfa agg] iter:  2, prev_obj_val: 45.07405471801758, obj_val: 44.87619400024414, abs dis: 0.1978607177734375
[rfa agg] iter:  2, weight: tensor([0.0003, 0.0627, 0.1264, 0.2149, 0.1304, 0.0582, 0.0612, 0.1108, 0.0999,
        0.1351])
[rfa agg] iter:  3, prev_obj_val: 44.87619400024414, obj_val: 44.872344970703125, abs dis: 0.003849029541015625
[rfa agg] iter:  3, weight: tensor([0.0002, 0.0773, 0.1360, 0.1795, 0.1230, 0.0769, 0.0767, 0.0965, 0.1151,
        0.1188])
[rfa agg] iter:  4, prev_obj_val: 44.872344970703125, obj_val: 44.872039794921875, abs dis: 0.00030517578125
[rfa agg] iter:  4, weight: tensor([0.0002, 0.0804, 0.1391, 0.1660, 0.1222, 0.0836, 0.0814, 0.0939, 0.1202,
        0.1130])
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.0760, Accuracy: 9759/10000 (97.5900%)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 11.5054, Accuracy: 36/8968 (0.4014%)
Done in 53.78580594062805 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:17 choose agents : [25, 68, 70, 61, 64, 31, 10, 23, 7, 74]. Adversary List: []
___Train Local_Simple,  epoch  17, local model 25, internal_epoch   1,  Average loss: 0.0016, Accuracy: 626/647 (96.7543%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4210, Accuracy: 8577/10000 (85.7700%)
___Train Local_Simple,  epoch  17, local model 68, internal_epoch   1,  Average loss: 0.0010, Accuracy: 488/494 (98.7854%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1130, Accuracy: 9629/10000 (96.2900%)
___Train Local_Simple,  epoch  17, local model 70, internal_epoch   1,  Average loss: 0.0021, Accuracy: 690/724 (95.3039%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1783, Accuracy: 9423/10000 (94.2300%)
___Train Local_Simple,  epoch  17, local model 61, internal_epoch   1,  Average loss: 0.0014, Accuracy: 682/699 (97.5680%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2296, Accuracy: 9227/10000 (92.2700%)
___Train Local_Simple,  epoch  17, local model 64, internal_epoch   1,  Average loss: 0.0017, Accuracy: 784/813 (96.4330%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2865, Accuracy: 8978/10000 (89.7800%)
___Train Local_Simple,  epoch  17, local model 31, internal_epoch   1,  Average loss: 0.0010, Accuracy: 816/835 (97.7246%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1571, Accuracy: 9501/10000 (95.0100%)
___Train Local_Simple,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0014, Accuracy: 872/892 (97.7578%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.5967, Accuracy: 8220/10000 (82.2000%)
___Train Local_Simple,  epoch  17, local model 23, internal_epoch   1,  Average loss: 0.0010, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1331, Accuracy: 9539/10000 (95.3900%)
___Train Local_Simple,  epoch  17, local model 7, internal_epoch   1,  Average loss: 0.0013, Accuracy: 410/418 (98.0861%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1246, Accuracy: 9597/10000 (95.9700%)
poison local model 74 index 3 
___Train Local_Simple,  epoch  17, local model 74, internal_epoch   1,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1400, Accuracy: 9581/10000 (95.8100%)
time spent on training: 24.819252252578735
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.08741368487131199  data num: [647, 494, 724, 699, 813, 835, 892, 293, 418, 557]
[rfa agg] considering poison per batch poison_fraction: 0.027316776522284994
[rfa agg] init. name: [25, 68, 70, 61, 64, 31, 10, 23, 7, 74], weight: tensor([0.1015, 0.0775, 0.1136, 0.1097, 0.1276, 0.1310, 0.1400, 0.0460, 0.0656,
        0.0874])
[rfa agg] iter:  0, prev_obj_val: 0.8642984628677368, obj_val: 0.8612531423568726, abs dis: 0.003045320510864258
[rfa agg] iter:  0, weight: tensor([0.0816, 0.1088, 0.0900, 0.1174, 0.1000, 0.1163, 0.1165, 0.0712, 0.0900,
        0.1082])
[rfa agg] iter:  1, prev_obj_val: 0.8612531423568726, obj_val: 0.861160159111023, abs dis: 9.298324584960938e-05
[rfa agg] iter:  1, weight: tensor([0.0787, 0.1152, 0.0867, 0.1175, 0.0958, 0.1136, 0.1117, 0.0762, 0.0923,
        0.1123])
[rfa agg] iter:  2, prev_obj_val: 0.861160159111023, obj_val: 0.8611569404602051, abs dis: 3.2186508178710938e-06
[rfa agg] iter:  2, weight: tensor([0.0783, 0.1165, 0.0862, 0.1173, 0.0951, 0.1131, 0.1107, 0.0771, 0.0926,
        0.1131])
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.0756, Accuracy: 9758/10000 (97.5800%)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 11.4308, Accuracy: 37/8968 (0.4126%)
Done in 41.91912770271301 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:18 choose agents : [74, 46, 65, 57, 83, 9, 64, 58, 41, 12]. Adversary List: [74]
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   1,  Average loss: 0.0268, Accuracy: 293/557 (52.6032%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   2,  Average loss: 0.0144, Accuracy: 338/557 (60.6822%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   3,  Average loss: 0.0095, Accuracy: 452/557 (81.1490%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   4,  Average loss: 0.0074, Accuracy: 474/557 (85.0987%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   5,  Average loss: 0.0063, Accuracy: 491/557 (88.1508%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   6,  Average loss: 0.0054, Accuracy: 498/557 (89.4075%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   7,  Average loss: 0.0046, Accuracy: 505/557 (90.6643%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   8,  Average loss: 0.0040, Accuracy: 513/557 (92.1005%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   9,  Average loss: 0.0038, Accuracy: 514/557 (92.2801%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch  10,  Average loss: 0.0040, Accuracy: 510/557 (91.5619%), train_poison_data_count: 180
Global model norm: 16.513731820005038.
Norm before scaling: 16.841722468995155. Distance: 4.881166910204304
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9168, Accuracy: 7373/10000 (73.7300%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1490, Accuracy: 8395/8968 (93.6106%)
Scaling by  100
Scaled Norm after poisoning: 487.0749910178103, distance: 488.1166612603999
Total norm for 2 adversaries is: 487.0749910178103. distance: 488.1166612603999
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  18, local model 46, internal_epoch   1,  Average loss: 0.0022, Accuracy: 691/710 (97.3239%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.5398, Accuracy: 8179/10000 (81.7900%)
___Train Local_Simple,  epoch  18, local model 65, internal_epoch   1,  Average loss: 0.0010, Accuracy: 365/371 (98.3827%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1253, Accuracy: 9590/10000 (95.9000%)
___Train Local_Simple,  epoch  18, local model 57, internal_epoch   1,  Average loss: 0.0030, Accuracy: 330/343 (96.2099%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1777, Accuracy: 9446/10000 (94.4600%)
___Train Local_Simple,  epoch  18, local model 83, internal_epoch   1,  Average loss: 0.0015, Accuracy: 423/433 (97.6905%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1119, Accuracy: 9643/10000 (96.4300%)
___Train Local_Simple,  epoch  18, local model 9, internal_epoch   1,  Average loss: 0.0010, Accuracy: 426/436 (97.7064%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1285, Accuracy: 9603/10000 (96.0300%)
___Train Local_Simple,  epoch  18, local model 64, internal_epoch   1,  Average loss: 0.0016, Accuracy: 788/813 (96.9250%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4913, Accuracy: 8380/10000 (83.8000%)
___Train Local_Simple,  epoch  18, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 266/276 (96.3768%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1203, Accuracy: 9623/10000 (96.2300%)
poison local model 41 index 0 
___Train Local_Simple,  epoch  18, local model 41, internal_epoch   1,  Average loss: 0.0015, Accuracy: 591/606 (97.5248%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1787, Accuracy: 9428/10000 (94.2800%)
___Train Local_Simple,  epoch  18, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1131/1160 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3781, Accuracy: 8732/10000 (87.3200%)
time spent on training: 41.59650707244873
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.20385626643295354  data num: [557, 710, 371, 343, 433, 436, 813, 276, 606, 1160]
[rfa agg] considering poison per batch poison_fraction: 0.06370508326029799
[rfa agg] init. name: [74, 46, 65, 57, 83, 9, 64, 58, 41, 12], weight: tensor([0.0976, 0.1245, 0.0650, 0.0601, 0.0759, 0.0764, 0.1425, 0.0484, 0.1062,
        0.2033])
[rfa agg] iter:  0, prev_obj_val: 86.00662231445312, obj_val: 52.259185791015625, abs dis: 33.7474365234375
[rfa agg] iter:  0, weight: tensor([0.0116, 0.1363, 0.0711, 0.0659, 0.0830, 0.0836, 0.1562, 0.0530, 0.1163,
        0.2230])
[rfa agg] iter:  1, prev_obj_val: 52.259185791015625, obj_val: 48.5577392578125, abs dis: 3.701446533203125
[rfa agg] iter:  1, weight: tensor([0.0013, 0.1367, 0.0715, 0.0677, 0.0837, 0.0839, 0.1580, 0.0534, 0.1178,
        0.2261])
[rfa agg] iter:  2, prev_obj_val: 48.5577392578125, obj_val: 48.42030334472656, abs dis: 0.1374359130859375
[rfa agg] iter:  2, weight: tensor([0.0002, 0.1196, 0.0827, 0.0842, 0.0952, 0.0944, 0.1410, 0.0588, 0.1276,
        0.1962])
[rfa agg] iter:  3, prev_obj_val: 48.42030334472656, obj_val: 48.417972564697266, abs dis: 0.002330780029296875
[rfa agg] iter:  3, weight: tensor([0.0002, 0.1075, 0.0982, 0.0917, 0.1082, 0.1094, 0.1243, 0.0631, 0.1322,
        0.1651])
[rfa agg] iter:  4, prev_obj_val: 48.417972564697266, obj_val: 48.417823791503906, abs dis: 0.000148773193359375
[rfa agg] iter:  4, weight: tensor([0.0002, 0.1055, 0.1025, 0.0930, 0.1119, 0.1138, 0.1206, 0.0640, 0.1328,
        0.1558])
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.0755, Accuracy: 9762/10000 (97.6200%)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 11.2276, Accuracy: 39/8968 (0.4349%)
Done in 59.99730443954468 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:19 choose agents : [83, 96, 90, 28, 65, 33, 75, 13, 32, 80]. Adversary List: []
___Train Local_Simple,  epoch  19, local model 83, internal_epoch   1,  Average loss: 0.0013, Accuracy: 426/433 (98.3834%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.0950, Accuracy: 9691/10000 (96.9100%)
___Train Local_Simple,  epoch  19, local model 96, internal_epoch   1,  Average loss: 0.0015, Accuracy: 657/672 (97.7679%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1557, Accuracy: 9505/10000 (95.0500%)
___Train Local_Simple,  epoch  19, local model 90, internal_epoch   1,  Average loss: 0.0022, Accuracy: 655/683 (95.9004%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.4298, Accuracy: 8526/10000 (85.2600%)
___Train Local_Simple,  epoch  19, local model 28, internal_epoch   1,  Average loss: 0.0013, Accuracy: 490/501 (97.8044%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1163, Accuracy: 9612/10000 (96.1200%)
___Train Local_Simple,  epoch  19, local model 65, internal_epoch   1,  Average loss: 0.0010, Accuracy: 366/371 (98.6523%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1237, Accuracy: 9596/10000 (95.9600%)
___Train Local_Simple,  epoch  19, local model 33, internal_epoch   1,  Average loss: 0.0016, Accuracy: 602/623 (96.6292%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1436, Accuracy: 9522/10000 (95.2200%)
___Train Local_Simple,  epoch  19, local model 75, internal_epoch   1,  Average loss: 0.0019, Accuracy: 659/686 (96.0641%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1465, Accuracy: 9525/10000 (95.2500%)
___Train Local_Simple,  epoch  19, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 717/734 (97.6839%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2907, Accuracy: 9175/10000 (91.7500%)
___Train Local_Simple,  epoch  19, local model 32, internal_epoch   1,  Average loss: 0.0017, Accuracy: 944/977 (96.6223%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1478, Accuracy: 9539/10000 (95.3900%)
___Train Local_Simple,  epoch  19, local model 80, internal_epoch   1,  Average loss: 0.0012, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1887, Accuracy: 9471/10000 (94.7100%)
time spent on training: 23.19071054458618
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [433, 672, 683, 501, 371, 623, 686, 734, 977, 431]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [83, 96, 90, 28, 65, 33, 75, 13, 32, 80], weight: tensor([0.0709, 0.1100, 0.1118, 0.0820, 0.0607, 0.1019, 0.1123, 0.1201, 0.1599,
        0.0705])
[rfa agg] iter:  0, prev_obj_val: 0.7696180939674377, obj_val: 0.7662769556045532, abs dis: 0.0033411383628845215
[rfa agg] iter:  0, weight: tensor([0.1150, 0.1133, 0.0866, 0.0925, 0.0869, 0.0942, 0.0929, 0.1005, 0.1218,
        0.0964])
[rfa agg] iter:  1, prev_obj_val: 0.7662769556045532, obj_val: 0.7661596536636353, abs dis: 0.00011730194091796875
[rfa agg] iter:  1, weight: tensor([0.1234, 0.1147, 0.0826, 0.0942, 0.0910, 0.0928, 0.0895, 0.0975, 0.1140,
        0.1004])
[rfa agg] iter:  2, prev_obj_val: 0.7661596536636353, obj_val: 0.7661556601524353, abs dis: 3.993511199951172e-06
[rfa agg] iter:  2, weight: tensor([0.1250, 0.1149, 0.0819, 0.0944, 0.0917, 0.0925, 0.0889, 0.0971, 0.1125,
        0.1010])
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.0748, Accuracy: 9755/10000 (97.5500%)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 11.2446, Accuracy: 37/8968 (0.4126%)
Done in 39.464980125427246 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:20 choose agents : [73, 23, 25, 12, 58, 19, 11, 13, 82, 50]. Adversary List: []
poison local model 73 index 1 
___Train Local_Simple,  epoch  20, local model 73, internal_epoch   1,  Average loss: 0.0017, Accuracy: 573/591 (96.9543%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1917, Accuracy: 9375/10000 (93.7500%)
___Train Local_Simple,  epoch  20, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1228, Accuracy: 9580/10000 (95.8000%)
___Train Local_Simple,  epoch  20, local model 25, internal_epoch   1,  Average loss: 0.0019, Accuracy: 620/647 (95.8269%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.5460, Accuracy: 8155/10000 (81.5500%)
___Train Local_Simple,  epoch  20, local model 12, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1129/1160 (97.3276%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2235, Accuracy: 9293/10000 (92.9300%)
___Train Local_Simple,  epoch  20, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 262/276 (94.9275%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1246, Accuracy: 9584/10000 (95.8400%)
___Train Local_Simple,  epoch  20, local model 19, internal_epoch   1,  Average loss: 0.0013, Accuracy: 198/205 (96.5854%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1369, Accuracy: 9560/10000 (95.6000%)
___Train Local_Simple,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 627/645 (97.2093%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1929, Accuracy: 9379/10000 (93.7900%)
___Train Local_Simple,  epoch  20, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 718/734 (97.8202%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1984, Accuracy: 9408/10000 (94.0800%)
___Train Local_Simple,  epoch  20, local model 82, internal_epoch   1,  Average loss: 0.0014, Accuracy: 695/713 (97.4755%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.5215, Accuracy: 8240/10000 (82.4000%)
___Train Local_Simple,  epoch  20, local model 50, internal_epoch   1,  Average loss: 0.0020, Accuracy: 454/474 (95.7806%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1594, Accuracy: 9475/10000 (94.7500%)
time spent on training: 24.675179481506348
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10299756012547927  data num: [591, 293, 647, 1160, 276, 205, 645, 734, 713, 474]
[rfa agg] considering poison per batch poison_fraction: 0.03218673753921227
[rfa agg] init. name: [73, 23, 25, 12, 58, 19, 11, 13, 82, 50], weight: tensor([0.1030, 0.0511, 0.1128, 0.2022, 0.0481, 0.0357, 0.1124, 0.1279, 0.1243,
        0.0826])
[rfa agg] iter:  0, prev_obj_val: 0.8644677996635437, obj_val: 0.8609775304794312, abs dis: 0.003490269184112549
[rfa agg] iter:  0, weight: tensor([0.1053, 0.0812, 0.0856, 0.1592, 0.0549, 0.0554, 0.1117, 0.1269, 0.1246,
        0.0952])
[rfa agg] iter:  1, prev_obj_val: 0.8609775304794312, obj_val: 0.8608014583587646, abs dis: 0.0001760721206665039
[rfa agg] iter:  1, weight: tensor([0.1064, 0.0875, 0.0820, 0.1487, 0.0555, 0.0585, 0.1129, 0.1257, 0.1251,
        0.0978])
[rfa agg] iter:  2, prev_obj_val: 0.8608014583587646, obj_val: 0.8607927560806274, abs dis: 8.702278137207031e-06
[rfa agg] iter:  2, weight: tensor([0.1067, 0.0889, 0.0814, 0.1463, 0.0555, 0.0591, 0.1132, 0.1252, 0.1253,
        0.0984])
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.0744, Accuracy: 9759/10000 (97.5900%)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 11.2629, Accuracy: 33/8968 (0.3680%)
Done in 40.68892002105713 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:21 choose agents : [34, 14, 74, 55, 58, 53, 36, 6, 47, 92]. Adversary List: []
___Train Local_Simple,  epoch  21, local model 34, internal_epoch   1,  Average loss: 0.0007, Accuracy: 406/413 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3005, Accuracy: 9158/10000 (91.5800%)
___Train Local_Simple,  epoch  21, local model 14, internal_epoch   1,  Average loss: 0.0014, Accuracy: 369/376 (98.1383%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1233, Accuracy: 9633/10000 (96.3300%)
poison local model 74 index 3 
___Train Local_Simple,  epoch  21, local model 74, internal_epoch   1,  Average loss: 0.0015, Accuracy: 540/557 (96.9479%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1551, Accuracy: 9503/10000 (95.0300%)
___Train Local_Simple,  epoch  21, local model 55, internal_epoch   1,  Average loss: 0.0016, Accuracy: 347/354 (98.0226%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1972, Accuracy: 9376/10000 (93.7600%)
___Train Local_Simple,  epoch  21, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 267/276 (96.7391%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1232, Accuracy: 9596/10000 (95.9600%)
___Train Local_Simple,  epoch  21, local model 53, internal_epoch   1,  Average loss: 0.0012, Accuracy: 723/739 (97.8349%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2554, Accuracy: 9249/10000 (92.4900%)
___Train Local_Simple,  epoch  21, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 975/1005 (97.0149%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1935, Accuracy: 9411/10000 (94.1100%)
___Train Local_Simple,  epoch  21, local model 6, internal_epoch   1,  Average loss: 0.0014, Accuracy: 597/615 (97.0732%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1966, Accuracy: 9379/10000 (93.7900%)
___Train Local_Simple,  epoch  21, local model 47, internal_epoch   1,  Average loss: 0.0010, Accuracy: 759/776 (97.8093%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1048, Accuracy: 9671/10000 (96.7100%)
___Train Local_Simple,  epoch  21, local model 92, internal_epoch   1,  Average loss: 0.0013, Accuracy: 910/937 (97.1185%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2746, Accuracy: 9091/10000 (90.9100%)
time spent on training: 24.784631729125977
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.09209656084656084  data num: [413, 376, 557, 354, 276, 739, 1005, 615, 776, 937]
[rfa agg] considering poison per batch poison_fraction: 0.028780175264550262
[rfa agg] init. name: [34, 14, 74, 55, 58, 53, 36, 6, 47, 92], weight: tensor([0.0683, 0.0622, 0.0921, 0.0585, 0.0456, 0.1222, 0.1662, 0.1017, 0.1283,
        0.1549])
[rfa agg] iter:  0, prev_obj_val: 0.8047163486480713, obj_val: 0.8005465865135193, abs dis: 0.004169762134552002
[rfa agg] iter:  0, weight: tensor([0.0756, 0.0821, 0.1114, 0.0746, 0.0551, 0.1317, 0.1198, 0.1017, 0.1268,
        0.1212])
[rfa agg] iter:  1, prev_obj_val: 0.8005465865135193, obj_val: 0.8004084825515747, abs dis: 0.00013810396194458008
[rfa agg] iter:  1, weight: tensor([0.0766, 0.0864, 0.1151, 0.0772, 0.0564, 0.1339, 0.1116, 0.1017, 0.1261,
        0.1149])
[rfa agg] iter:  2, prev_obj_val: 0.8004084825515747, obj_val: 0.80040442943573, abs dis: 4.0531158447265625e-06
[rfa agg] iter:  2, weight: tensor([0.0768, 0.0873, 0.1158, 0.0776, 0.0566, 0.1344, 0.1102, 0.1017, 0.1259,
        0.1138])
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.0744, Accuracy: 9760/10000 (97.6000%)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 11.2222, Accuracy: 36/8968 (0.4014%)
Done in 40.821167945861816 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:22 choose agents : [37, 43, 17, 2, 66, 6, 38, 45, 81, 4]. Adversary List: []
___Train Local_Simple,  epoch  22, local model 37, internal_epoch   1,  Average loss: 0.0015, Accuracy: 836/860 (97.2093%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2554, Accuracy: 9204/10000 (92.0400%)
___Train Local_Simple,  epoch  22, local model 43, internal_epoch   1,  Average loss: 0.0014, Accuracy: 395/408 (96.8137%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1652, Accuracy: 9455/10000 (94.5500%)
___Train Local_Simple,  epoch  22, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 602/620 (97.0968%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1145, Accuracy: 9642/10000 (96.4200%)
___Train Local_Simple,  epoch  22, local model 2, internal_epoch   1,  Average loss: 0.0011, Accuracy: 542/548 (98.9051%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1992, Accuracy: 9342/10000 (93.4200%)
___Train Local_Simple,  epoch  22, local model 66, internal_epoch   1,  Average loss: 0.0011, Accuracy: 646/660 (97.8788%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2970, Accuracy: 9011/10000 (90.1100%)
___Train Local_Simple,  epoch  22, local model 6, internal_epoch   1,  Average loss: 0.0013, Accuracy: 600/615 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1361, Accuracy: 9547/10000 (95.4700%)
___Train Local_Simple,  epoch  22, local model 38, internal_epoch   1,  Average loss: 0.0015, Accuracy: 871/895 (97.3184%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3654, Accuracy: 8755/10000 (87.5500%)
___Train Local_Simple,  epoch  22, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 612/628 (97.4522%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2843, Accuracy: 9017/10000 (90.1700%)
___Train Local_Simple,  epoch  22, local model 81, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1197/1227 (97.5550%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2804, Accuracy: 9128/10000 (91.2800%)
___Train Local_Simple,  epoch  22, local model 4, internal_epoch   1,  Average loss: 0.0014, Accuracy: 642/658 (97.5684%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3946, Accuracy: 8720/10000 (87.2000%)
time spent on training: 21.89236545562744
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [860, 408, 620, 548, 660, 615, 895, 628, 1227, 658]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 43, 17, 2, 66, 6, 38, 45, 81, 4], weight: tensor([0.1208, 0.0573, 0.0871, 0.0770, 0.0927, 0.0864, 0.1257, 0.0882, 0.1724,
        0.0924])
[rfa agg] iter:  0, prev_obj_val: 0.8947620987892151, obj_val: 0.8926981091499329, abs dis: 0.0020639896392822266
[rfa agg] iter:  0, weight: tensor([0.0956, 0.0840, 0.1002, 0.0906, 0.0953, 0.0955, 0.1022, 0.0958, 0.1452,
        0.0956])
[rfa agg] iter:  1, prev_obj_val: 0.8926981091499329, obj_val: 0.8926408290863037, abs dis: 5.728006362915039e-05
[rfa agg] iter:  1, weight: tensor([0.0926, 0.0867, 0.1016, 0.0923, 0.0963, 0.0972, 0.0995, 0.0973, 0.1395,
        0.0970])
[rfa agg] iter:  2, prev_obj_val: 0.8926408290863037, obj_val: 0.8926388025283813, abs dis: 2.0265579223632812e-06
[rfa agg] iter:  2, weight: tensor([0.0923, 0.0870, 0.1018, 0.0925, 0.0965, 0.0976, 0.0992, 0.0975, 0.1383,
        0.0973])
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.0733, Accuracy: 9758/10000 (97.5800%)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 11.2344, Accuracy: 33/8968 (0.3680%)
Done in 38.61532115936279 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:23 choose agents : [24, 38, 54, 10, 11, 80, 73, 7, 72, 14]. Adversary List: []
___Train Local_Simple,  epoch  23, local model 24, internal_epoch   1,  Average loss: 0.0015, Accuracy: 362/379 (95.5145%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1174, Accuracy: 9628/10000 (96.2800%)
___Train Local_Simple,  epoch  23, local model 38, internal_epoch   1,  Average loss: 0.0013, Accuracy: 874/895 (97.6536%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2146, Accuracy: 9344/10000 (93.4400%)
___Train Local_Simple,  epoch  23, local model 54, internal_epoch   1,  Average loss: 0.0015, Accuracy: 502/519 (96.7245%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3025, Accuracy: 9099/10000 (90.9900%)
___Train Local_Simple,  epoch  23, local model 10, internal_epoch   1,  Average loss: 0.0014, Accuracy: 867/892 (97.1973%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3382, Accuracy: 8883/10000 (88.8300%)
___Train Local_Simple,  epoch  23, local model 11, internal_epoch   1,  Average loss: 0.0013, Accuracy: 628/645 (97.3643%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1890, Accuracy: 9417/10000 (94.1700%)
___Train Local_Simple,  epoch  23, local model 80, internal_epoch   1,  Average loss: 0.0008, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1729, Accuracy: 9462/10000 (94.6200%)
poison local model 73 index 1 
___Train Local_Simple,  epoch  23, local model 73, internal_epoch   1,  Average loss: 0.0012, Accuracy: 579/591 (97.9695%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1371, Accuracy: 9559/10000 (95.5900%)
___Train Local_Simple,  epoch  23, local model 7, internal_epoch   1,  Average loss: 0.0010, Accuracy: 410/418 (98.0861%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1855, Accuracy: 9398/10000 (93.9800%)
___Train Local_Simple,  epoch  23, local model 72, internal_epoch   1,  Average loss: 0.0006, Accuracy: 720/731 (98.4952%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3785, Accuracy: 8922/10000 (89.2200%)
___Train Local_Simple,  epoch  23, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 368/376 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1625, Accuracy: 9509/10000 (95.0900%)
time spent on training: 24.233248472213745
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10056151097498724  data num: [379, 895, 519, 892, 645, 431, 591, 418, 731, 376]
[rfa agg] considering poison per batch poison_fraction: 0.031425472179683514
[rfa agg] init. name: [24, 38, 54, 10, 11, 80, 73, 7, 72, 14], weight: tensor([0.0645, 0.1523, 0.0883, 0.1518, 0.1097, 0.0733, 0.1006, 0.0711, 0.1244,
        0.0640])
[rfa agg] iter:  0, prev_obj_val: 0.7570725679397583, obj_val: 0.7548518776893616, abs dis: 0.0022206902503967285
[rfa agg] iter:  0, weight: tensor([0.0906, 0.1216, 0.0718, 0.1179, 0.1072, 0.0980, 0.1169, 0.0839, 0.1183,
        0.0738])
[rfa agg] iter:  1, prev_obj_val: 0.7548518776893616, obj_val: 0.7547953128814697, abs dis: 5.65648078918457e-05
[rfa agg] iter:  1, weight: tensor([0.0930, 0.1171, 0.0705, 0.1123, 0.1070, 0.1022, 0.1182, 0.0868, 0.1184,
        0.0746])
[rfa agg] iter:  2, prev_obj_val: 0.7547953128814697, obj_val: 0.7547938823699951, abs dis: 1.430511474609375e-06
[rfa agg] iter:  2, weight: tensor([0.0932, 0.1164, 0.0703, 0.1114, 0.1070, 0.1029, 0.1182, 0.0873, 0.1185,
        0.0747])
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.0729, Accuracy: 9757/10000 (97.5700%)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 11.2641, Accuracy: 32/8968 (0.3568%)
Done in 40.20549535751343 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:24 choose agents : [99, 73, 12, 93, 25, 34, 57, 69, 58, 2]. Adversary List: []
___Train Local_Simple,  epoch  24, local model 99, internal_epoch   1,  Average loss: 0.0008, Accuracy: 374/377 (99.2042%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0916, Accuracy: 9703/10000 (97.0300%)
poison local model 73 index 1 
___Train Local_Simple,  epoch  24, local model 73, internal_epoch   1,  Average loss: 0.0014, Accuracy: 579/591 (97.9695%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1475, Accuracy: 9523/10000 (95.2300%)
___Train Local_Simple,  epoch  24, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1125/1160 (96.9828%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3216, Accuracy: 8869/10000 (88.6900%)
___Train Local_Simple,  epoch  24, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 618/623 (99.1974%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1883, Accuracy: 9433/10000 (94.3300%)
___Train Local_Simple,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0012, Accuracy: 632/647 (97.6816%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3862, Accuracy: 8803/10000 (88.0300%)
___Train Local_Simple,  epoch  24, local model 34, internal_epoch   1,  Average loss: 0.0006, Accuracy: 408/413 (98.7893%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1400, Accuracy: 9567/10000 (95.6700%)
___Train Local_Simple,  epoch  24, local model 57, internal_epoch   1,  Average loss: 0.0025, Accuracy: 325/343 (94.7522%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2592, Accuracy: 9217/10000 (92.1700%)
___Train Local_Simple,  epoch  24, local model 69, internal_epoch   1,  Average loss: 0.0017, Accuracy: 247/256 (96.4844%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1644, Accuracy: 9467/10000 (94.6700%)
___Train Local_Simple,  epoch  24, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 268/276 (97.1014%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1161, Accuracy: 9624/10000 (96.2400%)
___Train Local_Simple,  epoch  24, local model 2, internal_epoch   1,  Average loss: 0.0011, Accuracy: 543/548 (99.0876%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1276, Accuracy: 9595/10000 (95.9500%)
time spent on training: 24.52531361579895
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.11291555215896064  data num: [377, 591, 1160, 623, 647, 413, 343, 256, 276, 548]
[rfa agg] considering poison per batch poison_fraction: 0.0352861100496752
[rfa agg] init. name: [99, 73, 12, 93, 25, 34, 57, 69, 58, 2], weight: tensor([0.0720, 0.1129, 0.2216, 0.1190, 0.1236, 0.0789, 0.0655, 0.0489, 0.0527,
        0.1047])
[rfa agg] iter:  0, prev_obj_val: 0.774327278137207, obj_val: 0.7602310180664062, abs dis: 0.014096260070800781
[rfa agg] iter:  0, weight: tensor([0.1060, 0.1057, 0.1404, 0.1206, 0.0987, 0.1084, 0.0674, 0.0661, 0.0649,
        0.1217])
[rfa agg] iter:  1, prev_obj_val: 0.7602310180664062, obj_val: 0.7590757012367249, abs dis: 0.0011553168296813965
[rfa agg] iter:  1, weight: tensor([0.1211, 0.1035, 0.1177, 0.1218, 0.0913, 0.1147, 0.0675, 0.0708, 0.0673,
        0.1243])
[rfa agg] iter:  2, prev_obj_val: 0.7590757012367249, obj_val: 0.7590051889419556, abs dis: 7.051229476928711e-05
[rfa agg] iter:  2, weight: tensor([0.1266, 0.1027, 0.1124, 0.1222, 0.0891, 0.1158, 0.0673, 0.0720, 0.0677,
        0.1242])
[rfa agg] iter:  3, prev_obj_val: 0.7590051889419556, obj_val: 0.7590010166168213, abs dis: 4.172325134277344e-06
[rfa agg] iter:  3, weight: tensor([0.1283, 0.1025, 0.1112, 0.1223, 0.0885, 0.1160, 0.0672, 0.0723, 0.0678,
        0.1240])
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.0727, Accuracy: 9758/10000 (97.5800%)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 11.1930, Accuracy: 33/8968 (0.3680%)
Done in 40.983423948287964 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:25 choose agents : [4, 1, 20, 49, 57, 51, 27, 43, 0, 45]. Adversary List: []
___Train Local_Simple,  epoch  25, local model 4, internal_epoch   1,  Average loss: 0.0012, Accuracy: 644/658 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3414, Accuracy: 8893/10000 (88.9300%)
___Train Local_Simple,  epoch  25, local model 1, internal_epoch   1,  Average loss: 0.0019, Accuracy: 727/760 (95.6579%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1775, Accuracy: 9435/10000 (94.3500%)
___Train Local_Simple,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0018, Accuracy: 414/429 (96.5035%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3007, Accuracy: 9047/10000 (90.4700%)
___Train Local_Simple,  epoch  25, local model 49, internal_epoch   1,  Average loss: 0.0008, Accuracy: 496/506 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1462, Accuracy: 9540/10000 (95.4000%)
___Train Local_Simple,  epoch  25, local model 57, internal_epoch   1,  Average loss: 0.0015, Accuracy: 333/343 (97.0845%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2009, Accuracy: 9405/10000 (94.0500%)
poison local model 51 index 2 
___Train Local_Simple,  epoch  25, local model 51, internal_epoch   1,  Average loss: 0.0009, Accuracy: 559/568 (98.4155%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3935, Accuracy: 8721/10000 (87.2100%)
___Train Local_Simple,  epoch  25, local model 27, internal_epoch   1,  Average loss: 0.0017, Accuracy: 452/471 (95.9660%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2300, Accuracy: 9248/10000 (92.4800%)
___Train Local_Simple,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0010, Accuracy: 401/408 (98.2843%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1420, Accuracy: 9556/10000 (95.5600%)
___Train Local_Simple,  epoch  25, local model 0, internal_epoch   1,  Average loss: 0.0014, Accuracy: 422/435 (97.0115%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2100, Accuracy: 9316/10000 (93.1600%)
___Train Local_Simple,  epoch  25, local model 45, internal_epoch   1,  Average loss: 0.0013, Accuracy: 612/628 (97.4522%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2143, Accuracy: 9358/10000 (93.5800%)
time spent on training: 24.365782976150513
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10910487898578564  data num: [658, 760, 429, 506, 343, 568, 471, 408, 435, 628]
[rfa agg] considering poison per batch poison_fraction: 0.03409527468305801
[rfa agg] init. name: [4, 1, 20, 49, 57, 51, 27, 43, 0, 45], weight: tensor([0.1264, 0.1460, 0.0824, 0.0972, 0.0659, 0.1091, 0.0905, 0.0784, 0.0836,
        0.1206])
[rfa agg] iter:  0, prev_obj_val: 0.7096961140632629, obj_val: 0.707929253578186, abs dis: 0.0017668604850769043
[rfa agg] iter:  0, weight: tensor([0.1127, 0.1111, 0.0715, 0.1289, 0.0823, 0.0967, 0.0872, 0.1014, 0.0943,
        0.1139])
[rfa agg] iter:  1, prev_obj_val: 0.707929253578186, obj_val: 0.7078816890716553, abs dis: 4.756450653076172e-05
[rfa agg] iter:  1, weight: tensor([0.1109, 0.1055, 0.0706, 0.1344, 0.0835, 0.0952, 0.0857, 0.1038, 0.0961,
        0.1143])
[rfa agg] iter:  2, prev_obj_val: 0.7078816890716553, obj_val: 0.7078803777694702, abs dis: 1.3113021850585938e-06
[rfa agg] iter:  2, weight: tensor([0.1106, 0.1047, 0.0705, 0.1354, 0.0836, 0.0949, 0.0853, 0.1041, 0.0964,
        0.1145])
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.0726, Accuracy: 9763/10000 (97.6300%)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 11.1220, Accuracy: 35/8968 (0.3903%)
Done in 40.57994055747986 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:26 choose agents : [25, 8, 12, 74, 55, 26, 62, 65, 54, 94]. Adversary List: []
___Train Local_Simple,  epoch  26, local model 25, internal_epoch   1,  Average loss: 0.0013, Accuracy: 627/647 (96.9088%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3092, Accuracy: 8980/10000 (89.8000%)
___Train Local_Simple,  epoch  26, local model 8, internal_epoch   1,  Average loss: 0.0020, Accuracy: 609/633 (96.2085%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1665, Accuracy: 9470/10000 (94.7000%)
___Train Local_Simple,  epoch  26, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1130/1160 (97.4138%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2804, Accuracy: 9137/10000 (91.3700%)
poison local model 74 index 3 
___Train Local_Simple,  epoch  26, local model 74, internal_epoch   1,  Average loss: 0.0016, Accuracy: 540/557 (96.9479%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1689, Accuracy: 9456/10000 (94.5600%)
___Train Local_Simple,  epoch  26, local model 55, internal_epoch   1,  Average loss: 0.0016, Accuracy: 345/354 (97.4576%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3252, Accuracy: 8963/10000 (89.6300%)
___Train Local_Simple,  epoch  26, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 537/554 (96.9314%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1324, Accuracy: 9577/10000 (95.7700%)
___Train Local_Simple,  epoch  26, local model 62, internal_epoch   1,  Average loss: 0.0009, Accuracy: 416/423 (98.3452%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.0985, Accuracy: 9697/10000 (96.9700%)
___Train Local_Simple,  epoch  26, local model 65, internal_epoch   1,  Average loss: 0.0010, Accuracy: 362/371 (97.5741%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1367, Accuracy: 9575/10000 (95.7500%)
___Train Local_Simple,  epoch  26, local model 54, internal_epoch   1,  Average loss: 0.0014, Accuracy: 505/519 (97.3025%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2453, Accuracy: 9277/10000 (92.7700%)
___Train Local_Simple,  epoch  26, local model 94, internal_epoch   1,  Average loss: 0.0020, Accuracy: 146/150 (97.3333%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1131, Accuracy: 9658/10000 (96.5800%)
time spent on training: 24.368692636489868
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10376304023845008  data num: [647, 633, 1160, 557, 354, 554, 423, 371, 519, 150]
[rfa agg] considering poison per batch poison_fraction: 0.03242595007451565
[rfa agg] init. name: [25, 8, 12, 74, 55, 26, 62, 65, 54, 94], weight: tensor([0.1205, 0.1179, 0.2161, 0.1038, 0.0659, 0.1032, 0.0788, 0.0691, 0.0967,
        0.0279])
[rfa agg] iter:  0, prev_obj_val: 0.789860725402832, obj_val: 0.7847483158111572, abs dis: 0.005112409591674805
[rfa agg] iter:  0, weight: tensor([0.1002, 0.1089, 0.1579, 0.1068, 0.0666, 0.1093, 0.1252, 0.0881, 0.0912,
        0.0458])
[rfa agg] iter:  1, prev_obj_val: 0.7847483158111572, obj_val: 0.784426212310791, abs dis: 0.00032210350036621094
[rfa agg] iter:  1, weight: tensor([0.0976, 0.1085, 0.1430, 0.1070, 0.0662, 0.1099, 0.1362, 0.0921, 0.0901,
        0.0494])
[rfa agg] iter:  2, prev_obj_val: 0.784426212310791, obj_val: 0.7844089865684509, abs dis: 1.722574234008789e-05
[rfa agg] iter:  2, weight: tensor([0.0972, 0.1085, 0.1396, 0.1069, 0.0660, 0.1098, 0.1390, 0.0930, 0.0897,
        0.0502])
[rfa agg] iter:  3, prev_obj_val: 0.7844089865684509, obj_val: 0.7844080924987793, abs dis: 8.940696716308594e-07
[rfa agg] iter:  3, weight: tensor([0.0971, 0.1085, 0.1389, 0.1069, 0.0659, 0.1098, 0.1397, 0.0932, 0.0896,
        0.0504])
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 0.0727, Accuracy: 9763/10000 (97.6300%)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 10.9620, Accuracy: 39/8968 (0.4349%)
Done in 40.53037786483765 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:27 choose agents : [68, 33, 58, 73, 10, 13, 81, 37, 94, 61]. Adversary List: []
___Train Local_Simple,  epoch  27, local model 68, internal_epoch   1,  Average loss: 0.0012, Accuracy: 484/494 (97.9757%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1646, Accuracy: 9435/10000 (94.3500%)
___Train Local_Simple,  epoch  27, local model 33, internal_epoch   1,  Average loss: 0.0017, Accuracy: 600/623 (96.3082%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1498, Accuracy: 9511/10000 (95.1100%)
___Train Local_Simple,  epoch  27, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 266/276 (96.3768%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1356, Accuracy: 9569/10000 (95.6900%)
poison local model 73 index 1 
___Train Local_Simple,  epoch  27, local model 73, internal_epoch   1,  Average loss: 0.0009, Accuracy: 581/591 (98.3080%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2167, Accuracy: 9331/10000 (93.3100%)
___Train Local_Simple,  epoch  27, local model 10, internal_epoch   1,  Average loss: 0.0017, Accuracy: 866/892 (97.0852%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.7421, Accuracy: 8373/10000 (83.7300%)
___Train Local_Simple,  epoch  27, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 721/734 (98.2289%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1818, Accuracy: 9426/10000 (94.2600%)
___Train Local_Simple,  epoch  27, local model 81, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1209/1227 (98.5330%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3348, Accuracy: 9048/10000 (90.4800%)
___Train Local_Simple,  epoch  27, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 843/860 (98.0233%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2699, Accuracy: 9213/10000 (92.1300%)
___Train Local_Simple,  epoch  27, local model 94, internal_epoch   1,  Average loss: 0.0019, Accuracy: 146/150 (97.3333%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1102, Accuracy: 9666/10000 (96.6600%)
___Train Local_Simple,  epoch  27, local model 61, internal_epoch   1,  Average loss: 0.0014, Accuracy: 686/699 (98.1402%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2396, Accuracy: 9263/10000 (92.6300%)
time spent on training: 24.9005229473114
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.09028414298808432  data num: [494, 623, 276, 591, 892, 734, 1227, 860, 150, 699]
[rfa agg] considering poison per batch poison_fraction: 0.02821379468377635
[rfa agg] init. name: [68, 33, 58, 73, 10, 13, 81, 37, 94, 61], weight: tensor([0.0755, 0.0952, 0.0422, 0.0903, 0.1363, 0.1121, 0.1874, 0.1314, 0.0229,
        0.1068])
[rfa agg] iter:  0, prev_obj_val: 0.8435792922973633, obj_val: 0.841413140296936, abs dis: 0.002166152000427246
[rfa agg] iter:  0, weight: tensor([0.0988, 0.0967, 0.0503, 0.0950, 0.1035, 0.1067, 0.1607, 0.1264, 0.0391,
        0.1229])
[rfa agg] iter:  1, prev_obj_val: 0.841413140296936, obj_val: 0.841336727142334, abs dis: 7.641315460205078e-05
[rfa agg] iter:  1, weight: tensor([0.1029, 0.0977, 0.0517, 0.0953, 0.0991, 0.1070, 0.1542, 0.1251, 0.0409,
        0.1260])
[rfa agg] iter:  2, prev_obj_val: 0.841336727142334, obj_val: 0.8413336277008057, abs dis: 3.0994415283203125e-06
[rfa agg] iter:  2, weight: tensor([0.1036, 0.0980, 0.0519, 0.0953, 0.0985, 0.1072, 0.1528, 0.1248, 0.0412,
        0.1267])
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 0.0724, Accuracy: 9764/10000 (97.6400%)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 11.0179, Accuracy: 37/8968 (0.4126%)
Done in 40.754602909088135 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:28 choose agents : [57, 60, 92, 23, 39, 79, 86, 63, 99, 97]. Adversary List: []
___Train Local_Simple,  epoch  28, local model 57, internal_epoch   1,  Average loss: 0.0016, Accuracy: 330/343 (96.2099%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1550, Accuracy: 9516/10000 (95.1600%)
___Train Local_Simple,  epoch  28, local model 60, internal_epoch   1,  Average loss: 0.0023, Accuracy: 328/338 (97.0414%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1215, Accuracy: 9640/10000 (96.4000%)
___Train Local_Simple,  epoch  28, local model 92, internal_epoch   1,  Average loss: 0.0014, Accuracy: 912/937 (97.3319%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2651, Accuracy: 9075/10000 (90.7500%)
___Train Local_Simple,  epoch  28, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1127, Accuracy: 9604/10000 (96.0400%)
___Train Local_Simple,  epoch  28, local model 39, internal_epoch   1,  Average loss: 0.0011, Accuracy: 252/257 (98.0545%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1039, Accuracy: 9664/10000 (96.6400%)
___Train Local_Simple,  epoch  28, local model 79, internal_epoch   1,  Average loss: 0.0016, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.0874, Accuracy: 9728/10000 (97.2800%)
___Train Local_Simple,  epoch  28, local model 86, internal_epoch   1,  Average loss: 0.0012, Accuracy: 243/250 (97.2000%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.0916, Accuracy: 9708/10000 (97.0800%)
___Train Local_Simple,  epoch  28, local model 63, internal_epoch   1,  Average loss: 0.0018, Accuracy: 855/889 (96.1755%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1245, Accuracy: 9638/10000 (96.3800%)
___Train Local_Simple,  epoch  28, local model 99, internal_epoch   1,  Average loss: 0.0008, Accuracy: 373/377 (98.9390%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.0919, Accuracy: 9691/10000 (96.9100%)
___Train Local_Simple,  epoch  28, local model 97, internal_epoch   1,  Average loss: 0.0010, Accuracy: 477/487 (97.9466%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3055, Accuracy: 9071/10000 (90.7100%)
time spent on training: 21.700696229934692
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [343, 338, 937, 293, 257, 182, 250, 889, 377, 487]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [57, 60, 92, 23, 39, 79, 86, 63, 99, 97], weight: tensor([0.0788, 0.0776, 0.2153, 0.0673, 0.0590, 0.0418, 0.0574, 0.2042, 0.0866,
        0.1119])
[rfa agg] iter:  0, prev_obj_val: 0.6727141737937927, obj_val: 0.661678671836853, abs dis: 0.011035501956939697
[rfa agg] iter:  0, weight: tensor([0.0876, 0.0866, 0.1610, 0.0906, 0.0720, 0.0625, 0.0816, 0.1362, 0.1257,
        0.0961])
[rfa agg] iter:  1, prev_obj_val: 0.661678671836853, obj_val: 0.6604596376419067, abs dis: 0.001219034194946289
[rfa agg] iter:  1, weight: tensor([0.0873, 0.0877, 0.1413, 0.0989, 0.0757, 0.0692, 0.0901, 0.1164, 0.1428,
        0.0906])
[rfa agg] iter:  2, prev_obj_val: 0.6604596376419067, obj_val: 0.6603330373764038, abs dis: 0.0001266002655029297
[rfa agg] iter:  2, weight: tensor([0.0864, 0.0875, 0.1346, 0.1018, 0.0766, 0.0713, 0.0929, 0.1107, 0.1498,
        0.0885])
[rfa agg] iter:  3, prev_obj_val: 0.6603330373764038, obj_val: 0.6603201627731323, abs dis: 1.2874603271484375e-05
[rfa agg] iter:  3, weight: tensor([0.0859, 0.0873, 0.1324, 0.1028, 0.0768, 0.0719, 0.0938, 0.1090, 0.1523,
        0.0877])
[rfa agg] iter:  4, prev_obj_val: 0.6603201627731323, obj_val: 0.6603188514709473, abs dis: 1.3113021850585938e-06
[rfa agg] iter:  4, weight: tensor([0.0857, 0.0873, 0.1317, 0.1031, 0.0769, 0.0720, 0.0941, 0.1085, 0.1532,
        0.0875])
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 0.0721, Accuracy: 9762/10000 (97.6200%)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 10.9669, Accuracy: 37/8968 (0.4126%)
Done in 38.366455078125 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:29 choose agents : [37, 44, 52, 88, 25, 28, 8, 16, 6, 3]. Adversary List: []
___Train Local_Simple,  epoch  29, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 843/860 (98.0233%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.5816, Accuracy: 8101/10000 (81.0100%)
___Train Local_Simple,  epoch  29, local model 44, internal_epoch   1,  Average loss: 0.0017, Accuracy: 502/517 (97.0986%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1919, Accuracy: 9392/10000 (93.9200%)
___Train Local_Simple,  epoch  29, local model 52, internal_epoch   1,  Average loss: 0.0011, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1616, Accuracy: 9496/10000 (94.9600%)
___Train Local_Simple,  epoch  29, local model 88, internal_epoch   1,  Average loss: 0.0011, Accuracy: 521/530 (98.3019%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1082, Accuracy: 9658/10000 (96.5800%)
___Train Local_Simple,  epoch  29, local model 25, internal_epoch   1,  Average loss: 0.0016, Accuracy: 629/647 (97.2179%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3205, Accuracy: 8921/10000 (89.2100%)
___Train Local_Simple,  epoch  29, local model 28, internal_epoch   1,  Average loss: 0.0013, Accuracy: 493/501 (98.4032%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.0913, Accuracy: 9711/10000 (97.1100%)
___Train Local_Simple,  epoch  29, local model 8, internal_epoch   1,  Average loss: 0.0018, Accuracy: 614/633 (96.9984%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2571, Accuracy: 9150/10000 (91.5000%)
___Train Local_Simple,  epoch  29, local model 16, internal_epoch   1,  Average loss: 0.0011, Accuracy: 895/915 (97.8142%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1176, Accuracy: 9628/10000 (96.2800%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   1,  Average loss: 0.0010, Accuracy: 602/615 (97.8862%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1882, Accuracy: 9426/10000 (94.2600%)
___Train Local_Simple,  epoch  29, local model 3, internal_epoch   1,  Average loss: 0.0012, Accuracy: 902/923 (97.7248%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2313, Accuracy: 9290/10000 (92.9000%)
time spent on training: 22.312917709350586
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [860, 517, 253, 530, 647, 501, 633, 915, 615, 923]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 44, 52, 88, 25, 28, 8, 16, 6, 3], weight: tensor([0.1345, 0.0809, 0.0396, 0.0829, 0.1012, 0.0784, 0.0990, 0.1431, 0.0962,
        0.1444])
[rfa agg] iter:  0, prev_obj_val: 0.8093096613883972, obj_val: 0.807585597038269, abs dis: 0.0017240643501281738
[rfa agg] iter:  0, weight: tensor([0.1089, 0.0774, 0.0588, 0.1058, 0.0831, 0.1003, 0.0990, 0.1498, 0.1031,
        0.1138])
[rfa agg] iter:  1, prev_obj_val: 0.807585597038269, obj_val: 0.8075551986694336, abs dis: 3.039836883544922e-05
[rfa agg] iter:  1, weight: tensor([0.1059, 0.0776, 0.0604, 0.1088, 0.0814, 0.1036, 0.0981, 0.1511, 0.1035,
        0.1097])
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.0716, Accuracy: 9765/10000 (97.6500%)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 10.8837, Accuracy: 39/8968 (0.4349%)
Done in 38.4110381603241 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:30 choose agents : [23, 44, 27, 86, 37, 35, 29, 48, 11, 43]. Adversary List: []
___Train Local_Simple,  epoch  30, local model 23, internal_epoch   1,  Average loss: 0.0006, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1116, Accuracy: 9614/10000 (96.1400%)
___Train Local_Simple,  epoch  30, local model 44, internal_epoch   1,  Average loss: 0.0021, Accuracy: 500/517 (96.7118%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1858, Accuracy: 9406/10000 (94.0600%)
___Train Local_Simple,  epoch  30, local model 27, internal_epoch   1,  Average loss: 0.0012, Accuracy: 460/471 (97.6645%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3384, Accuracy: 8959/10000 (89.5900%)
___Train Local_Simple,  epoch  30, local model 86, internal_epoch   1,  Average loss: 0.0012, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.0912, Accuracy: 9712/10000 (97.1200%)
___Train Local_Simple,  epoch  30, local model 37, internal_epoch   1,  Average loss: 0.0013, Accuracy: 838/860 (97.4419%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1419, Accuracy: 9573/10000 (95.7300%)
___Train Local_Simple,  epoch  30, local model 35, internal_epoch   1,  Average loss: 0.0005, Accuracy: 494/499 (98.9980%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1909, Accuracy: 9408/10000 (94.0800%)
___Train Local_Simple,  epoch  30, local model 29, internal_epoch   1,  Average loss: 0.0010, Accuracy: 983/1002 (98.1038%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3840, Accuracy: 8762/10000 (87.6200%)
___Train Local_Simple,  epoch  30, local model 48, internal_epoch   1,  Average loss: 0.0007, Accuracy: 440/448 (98.2143%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1055, Accuracy: 9681/10000 (96.8100%)
___Train Local_Simple,  epoch  30, local model 11, internal_epoch   1,  Average loss: 0.0013, Accuracy: 626/645 (97.0543%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3646, Accuracy: 8909/10000 (89.0900%)
___Train Local_Simple,  epoch  30, local model 43, internal_epoch   1,  Average loss: 0.0014, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1482, Accuracy: 9544/10000 (95.4400%)
time spent on training: 22.434853553771973
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [293, 517, 471, 250, 860, 499, 1002, 448, 645, 408]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [23, 44, 27, 86, 37, 35, 29, 48, 11, 43], weight: tensor([0.0543, 0.0959, 0.0873, 0.0464, 0.1595, 0.0925, 0.1858, 0.0831, 0.1196,
        0.0757])
[rfa agg] iter:  0, prev_obj_val: 0.7356806993484497, obj_val: 0.7296926379203796, abs dis: 0.005988061428070068
[rfa agg] iter:  0, weight: tensor([0.0955, 0.0829, 0.0742, 0.0803, 0.1240, 0.1219, 0.1320, 0.1091, 0.0911,
        0.0891])
[rfa agg] iter:  1, prev_obj_val: 0.7296926379203796, obj_val: 0.7293323278427124, abs dis: 0.00036031007766723633
[rfa agg] iter:  1, weight: tensor([0.1036, 0.0786, 0.0716, 0.0873, 0.1157, 0.1290, 0.1189, 0.1171, 0.0862,
        0.0920])
[rfa agg] iter:  2, prev_obj_val: 0.7293323278427124, obj_val: 0.7293123602867126, abs dis: 1.996755599975586e-05
[rfa agg] iter:  2, weight: tensor([0.1053, 0.0774, 0.0709, 0.0889, 0.1137, 0.1306, 0.1159, 0.1194, 0.0853,
        0.0926])
[rfa agg] iter:  3, prev_obj_val: 0.7293123602867126, obj_val: 0.7293112277984619, abs dis: 1.1324882507324219e-06
[rfa agg] iter:  3, weight: tensor([0.1056, 0.0771, 0.0707, 0.0892, 0.1132, 0.1311, 0.1152, 0.1200, 0.0850,
        0.0928])
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 0.0709, Accuracy: 9765/10000 (97.6500%)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 10.8615, Accuracy: 37/8968 (0.4126%)
Done in 38.906195640563965 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:31 choose agents : [33, 12, 97, 15, 42, 73, 20, 90, 56, 54]. Adversary List: []
___Train Local_Simple,  epoch  31, local model 33, internal_epoch   1,  Average loss: 0.0019, Accuracy: 602/623 (96.6292%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1459, Accuracy: 9525/10000 (95.2500%)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1126/1160 (97.0690%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2272, Accuracy: 9297/10000 (92.9700%)
___Train Local_Simple,  epoch  31, local model 97, internal_epoch   1,  Average loss: 0.0008, Accuracy: 479/487 (98.3573%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2133, Accuracy: 9322/10000 (93.2200%)
___Train Local_Simple,  epoch  31, local model 15, internal_epoch   1,  Average loss: 0.0010, Accuracy: 394/401 (98.2544%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.0920, Accuracy: 9688/10000 (96.8800%)
___Train Local_Simple,  epoch  31, local model 42, internal_epoch   1,  Average loss: 0.0011, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.0906, Accuracy: 9710/10000 (97.1000%)
poison local model 73 index 1 
___Train Local_Simple,  epoch  31, local model 73, internal_epoch   1,  Average loss: 0.0011, Accuracy: 580/591 (98.1387%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1981, Accuracy: 9359/10000 (93.5900%)
___Train Local_Simple,  epoch  31, local model 20, internal_epoch   1,  Average loss: 0.0012, Accuracy: 418/429 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2606, Accuracy: 9184/10000 (91.8400%)
___Train Local_Simple,  epoch  31, local model 90, internal_epoch   1,  Average loss: 0.0021, Accuracy: 663/683 (97.0717%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.5184, Accuracy: 8265/10000 (82.6500%)
___Train Local_Simple,  epoch  31, local model 56, internal_epoch   1,  Average loss: 0.0015, Accuracy: 855/880 (97.1591%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1606, Accuracy: 9446/10000 (94.4600%)
___Train Local_Simple,  epoch  31, local model 54, internal_epoch   1,  Average loss: 0.0013, Accuracy: 506/519 (97.4952%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2830, Accuracy: 9118/10000 (91.1800%)
time spent on training: 25.03995442390442
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0983524712930604  data num: [623, 1160, 487, 401, 236, 591, 429, 683, 880, 519]
[rfa agg] considering poison per batch poison_fraction: 0.030735147279081377
[rfa agg] init. name: [33, 12, 97, 15, 42, 73, 20, 90, 56, 54], weight: tensor([0.1037, 0.1930, 0.0810, 0.0667, 0.0393, 0.0984, 0.0714, 0.1137, 0.1464,
        0.0864])
[rfa agg] iter:  0, prev_obj_val: 0.8650107979774475, obj_val: 0.8597854971885681, abs dis: 0.0052253007888793945
[rfa agg] iter:  0, weight: tensor([0.1002, 0.1373, 0.1041, 0.0947, 0.0714, 0.0981, 0.0803, 0.0940, 0.1380,
        0.0820])
[rfa agg] iter:  1, prev_obj_val: 0.8597854971885681, obj_val: 0.8595383167266846, abs dis: 0.0002471804618835449
[rfa agg] iter:  1, weight: tensor([0.0998, 0.1253, 0.1095, 0.0998, 0.0784, 0.0989, 0.0809, 0.0911, 0.1351,
        0.0812])
[rfa agg] iter:  2, prev_obj_val: 0.8595383167266846, obj_val: 0.8595280051231384, abs dis: 1.0311603546142578e-05
[rfa agg] iter:  2, weight: tensor([0.0998, 0.1229, 0.1108, 0.1008, 0.0799, 0.0992, 0.0808, 0.0906, 0.1342,
        0.0810])
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.0704, Accuracy: 9770/10000 (97.7000%)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 10.8488, Accuracy: 37/8968 (0.4126%)
Done in 41.36674451828003 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:32 choose agents : [24, 38, 43, 32, 62, 8, 35, 96, 27, 41]. Adversary List: []
___Train Local_Simple,  epoch  32, local model 24, internal_epoch   1,  Average loss: 0.0017, Accuracy: 366/379 (96.5699%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1191, Accuracy: 9609/10000 (96.0900%)
___Train Local_Simple,  epoch  32, local model 38, internal_epoch   1,  Average loss: 0.0018, Accuracy: 868/895 (96.9832%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2875, Accuracy: 8988/10000 (89.8800%)
___Train Local_Simple,  epoch  32, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 402/408 (98.5294%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4863, Accuracy: 8785/10000 (87.8500%)
___Train Local_Simple,  epoch  32, local model 32, internal_epoch   1,  Average loss: 0.0017, Accuracy: 952/977 (97.4411%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2124, Accuracy: 9267/10000 (92.6700%)
___Train Local_Simple,  epoch  32, local model 62, internal_epoch   1,  Average loss: 0.0008, Accuracy: 416/423 (98.3452%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1035, Accuracy: 9679/10000 (96.7900%)
___Train Local_Simple,  epoch  32, local model 8, internal_epoch   1,  Average loss: 0.0016, Accuracy: 612/633 (96.6825%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1756, Accuracy: 9433/10000 (94.3300%)
___Train Local_Simple,  epoch  32, local model 35, internal_epoch   1,  Average loss: 0.0005, Accuracy: 494/499 (98.9980%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1284, Accuracy: 9586/10000 (95.8600%)
___Train Local_Simple,  epoch  32, local model 96, internal_epoch   1,  Average loss: 0.0014, Accuracy: 654/672 (97.3214%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2523, Accuracy: 9174/10000 (91.7400%)
___Train Local_Simple,  epoch  32, local model 27, internal_epoch   1,  Average loss: 0.0014, Accuracy: 460/471 (97.6645%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3502, Accuracy: 8966/10000 (89.6600%)
poison local model 41 index 0 
___Train Local_Simple,  epoch  32, local model 41, internal_epoch   1,  Average loss: 0.0013, Accuracy: 587/606 (96.8647%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1975, Accuracy: 9382/10000 (93.8200%)
time spent on training: 24.572294235229492
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10162669797082005  data num: [379, 895, 408, 977, 423, 633, 499, 672, 471, 606]
[rfa agg] considering poison per batch poison_fraction: 0.031758343115881264
[rfa agg] init. name: [24, 38, 43, 32, 62, 8, 35, 96, 27, 41], weight: tensor([0.0636, 0.1501, 0.0684, 0.1638, 0.0709, 0.1062, 0.0837, 0.1127, 0.0790,
        0.1016])
[rfa agg] iter:  0, prev_obj_val: 0.7767112255096436, obj_val: 0.7721709609031677, abs dis: 0.00454026460647583
[rfa agg] iter:  0, weight: tensor([0.0835, 0.1045, 0.0797, 0.1329, 0.1045, 0.1010, 0.1240, 0.1067, 0.0744,
        0.0889])
[rfa agg] iter:  1, prev_obj_val: 0.7721709609031677, obj_val: 0.7719566822052002, abs dis: 0.0002142786979675293
[rfa agg] iter:  1, weight: tensor([0.0845, 0.0963, 0.0820, 0.1248, 0.1116, 0.1002, 0.1347, 0.1055, 0.0729,
        0.0875])
[rfa agg] iter:  2, prev_obj_val: 0.7719566822052002, obj_val: 0.7719456553459167, abs dis: 1.1026859283447266e-05
[rfa agg] iter:  2, weight: tensor([0.0843, 0.0948, 0.0825, 0.1228, 0.1133, 0.1000, 0.1376, 0.1052, 0.0724,
        0.0873])
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.0702, Accuracy: 9768/10000 (97.6800%)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 10.8582, Accuracy: 36/8968 (0.4014%)
Done in 40.58229088783264 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:33 choose agents : [58, 86, 89, 17, 80, 63, 26, 90, 93, 79]. Adversary List: []
___Train Local_Simple,  epoch  33, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 269/276 (97.4638%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1339, Accuracy: 9588/10000 (95.8800%)
___Train Local_Simple,  epoch  33, local model 86, internal_epoch   1,  Average loss: 0.0011, Accuracy: 244/250 (97.6000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.0861, Accuracy: 9729/10000 (97.2900%)
___Train Local_Simple,  epoch  33, local model 89, internal_epoch   1,  Average loss: 0.0007, Accuracy: 485/492 (98.5772%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1302, Accuracy: 9595/10000 (95.9500%)
___Train Local_Simple,  epoch  33, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 604/620 (97.4194%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1334, Accuracy: 9588/10000 (95.8800%)
___Train Local_Simple,  epoch  33, local model 80, internal_epoch   1,  Average loss: 0.0008, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1845, Accuracy: 9442/10000 (94.4200%)
___Train Local_Simple,  epoch  33, local model 63, internal_epoch   1,  Average loss: 0.0016, Accuracy: 860/889 (96.7379%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.0913, Accuracy: 9724/10000 (97.2400%)
___Train Local_Simple,  epoch  33, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 539/554 (97.2924%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1465, Accuracy: 9547/10000 (95.4700%)
___Train Local_Simple,  epoch  33, local model 90, internal_epoch   1,  Average loss: 0.0019, Accuracy: 663/683 (97.0717%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.4393, Accuracy: 8557/10000 (85.5700%)
___Train Local_Simple,  epoch  33, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 617/623 (99.0369%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2063, Accuracy: 9335/10000 (93.3500%)
___Train Local_Simple,  epoch  33, local model 79, internal_epoch   1,  Average loss: 0.0016, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.0854, Accuracy: 9734/10000 (97.3400%)
time spent on training: 21.878005981445312
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [276, 250, 492, 620, 431, 889, 554, 683, 623, 182]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [58, 86, 89, 17, 80, 63, 26, 90, 93, 79], weight: tensor([0.0552, 0.0500, 0.0984, 0.1240, 0.0862, 0.1778, 0.1108, 0.1366, 0.1246,
        0.0364])
[rfa agg] iter:  0, prev_obj_val: 0.6611915230751038, obj_val: 0.6579875946044922, abs dis: 0.0032039284706115723
[rfa agg] iter:  0, weight: tensor([0.0619, 0.0784, 0.1173, 0.1214, 0.0964, 0.1391, 0.0958, 0.0995, 0.1296,
        0.0606])
[rfa agg] iter:  1, prev_obj_val: 0.6579875946044922, obj_val: 0.6578413248062134, abs dis: 0.0001462697982788086
[rfa agg] iter:  1, weight: tensor([0.0617, 0.0838, 0.1197, 0.1207, 0.0988, 0.1297, 0.0944, 0.0936, 0.1326,
        0.0650])
[rfa agg] iter:  2, prev_obj_val: 0.6578413248062134, obj_val: 0.6578348278999329, abs dis: 6.496906280517578e-06
[rfa agg] iter:  2, weight: tensor([0.0615, 0.0850, 0.1199, 0.1205, 0.0993, 0.1277, 0.0943, 0.0926, 0.1334,
        0.0659])
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.0699, Accuracy: 9766/10000 (97.6600%)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 10.8882, Accuracy: 34/8968 (0.3791%)
Done in 37.78022885322571 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:34 choose agents : [36, 67, 41, 87, 65, 30, 98, 25, 54, 52]. Adversary List: []
___Train Local_Simple,  epoch  34, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 987/1005 (98.2090%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2089, Accuracy: 9325/10000 (93.2500%)
___Train Local_Simple,  epoch  34, local model 67, internal_epoch   1,  Average loss: 0.0013, Accuracy: 976/998 (97.7956%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2563, Accuracy: 9169/10000 (91.6900%)
poison local model 41 index 0 
___Train Local_Simple,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0012, Accuracy: 593/606 (97.8548%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2928, Accuracy: 9072/10000 (90.7200%)
___Train Local_Simple,  epoch  34, local model 87, internal_epoch   1,  Average loss: 0.0012, Accuracy: 458/470 (97.4468%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1510, Accuracy: 9522/10000 (95.2200%)
___Train Local_Simple,  epoch  34, local model 65, internal_epoch   1,  Average loss: 0.0009, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1228, Accuracy: 9604/10000 (96.0400%)
___Train Local_Simple,  epoch  34, local model 30, internal_epoch   1,  Average loss: 0.0015, Accuracy: 388/400 (97.0000%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1366, Accuracy: 9581/10000 (95.8100%)
___Train Local_Simple,  epoch  34, local model 98, internal_epoch   1,  Average loss: 0.0016, Accuracy: 790/818 (96.5770%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3910, Accuracy: 8780/10000 (87.8000%)
___Train Local_Simple,  epoch  34, local model 25, internal_epoch   1,  Average loss: 0.0011, Accuracy: 632/647 (97.6816%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2356, Accuracy: 9236/10000 (92.3600%)
___Train Local_Simple,  epoch  34, local model 54, internal_epoch   1,  Average loss: 0.0013, Accuracy: 507/519 (97.6879%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.5381, Accuracy: 8415/10000 (84.1500%)
___Train Local_Simple,  epoch  34, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1331, Accuracy: 9587/10000 (95.8700%)
time spent on training: 23.79260540008545
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.09955643173977329  data num: [1005, 998, 606, 470, 371, 400, 818, 647, 519, 253]
[rfa agg] considering poison per batch poison_fraction: 0.031111384918679152
[rfa agg] init. name: [36, 67, 41, 87, 65, 30, 98, 25, 54, 52], weight: tensor([0.1651, 0.1640, 0.0996, 0.0772, 0.0609, 0.0657, 0.1344, 0.1063, 0.0853,
        0.0416])
[rfa agg] iter:  0, prev_obj_val: 0.8616455793380737, obj_val: 0.8584612607955933, abs dis: 0.0031843185424804688
[rfa agg] iter:  0, weight: tensor([0.1512, 0.1325, 0.0915, 0.0881, 0.0966, 0.0934, 0.0992, 0.0998, 0.0748,
        0.0728])
[rfa agg] iter:  1, prev_obj_val: 0.8584612607955933, obj_val: 0.8583222031593323, abs dis: 0.00013905763626098633
[rfa agg] iter:  1, weight: tensor([0.1475, 0.1250, 0.0915, 0.0907, 0.1027, 0.0980, 0.0938, 0.0999, 0.0748,
        0.0761])
[rfa agg] iter:  2, prev_obj_val: 0.8583222031593323, obj_val: 0.8583158254623413, abs dis: 6.377696990966797e-06
[rfa agg] iter:  2, weight: tensor([0.1465, 0.1234, 0.0916, 0.0913, 0.1041, 0.0989, 0.0929, 0.1000, 0.0749,
        0.0765])
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.0696, Accuracy: 9771/10000 (97.7100%)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 10.8060, Accuracy: 36/8968 (0.4014%)
Done in 39.79881501197815 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:35 choose agents : [46, 6, 35, 17, 20, 77, 44, 8, 78, 3]. Adversary List: []
___Train Local_Simple,  epoch  35, local model 46, internal_epoch   1,  Average loss: 0.0016, Accuracy: 688/710 (96.9014%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2084, Accuracy: 9347/10000 (93.4700%)
___Train Local_Simple,  epoch  35, local model 6, internal_epoch   1,  Average loss: 0.0013, Accuracy: 601/615 (97.7236%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2412, Accuracy: 9220/10000 (92.2000%)
___Train Local_Simple,  epoch  35, local model 35, internal_epoch   1,  Average loss: 0.0006, Accuracy: 492/499 (98.5972%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1828, Accuracy: 9429/10000 (94.2900%)
___Train Local_Simple,  epoch  35, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 606/620 (97.7419%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1072, Accuracy: 9674/10000 (96.7400%)
___Train Local_Simple,  epoch  35, local model 20, internal_epoch   1,  Average loss: 0.0016, Accuracy: 416/429 (96.9697%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2742, Accuracy: 9128/10000 (91.2800%)
___Train Local_Simple,  epoch  35, local model 77, internal_epoch   1,  Average loss: 0.0017, Accuracy: 572/589 (97.1138%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1062, Accuracy: 9668/10000 (96.6800%)
___Train Local_Simple,  epoch  35, local model 44, internal_epoch   1,  Average loss: 0.0017, Accuracy: 501/517 (96.9052%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1233, Accuracy: 9621/10000 (96.2100%)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.0020, Accuracy: 609/633 (96.2085%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1261, Accuracy: 9622/10000 (96.2200%)
___Train Local_Simple,  epoch  35, local model 78, internal_epoch   1,  Average loss: 0.0009, Accuracy: 297/303 (98.0198%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1496, Accuracy: 9535/10000 (95.3500%)
___Train Local_Simple,  epoch  35, local model 3, internal_epoch   1,  Average loss: 0.0012, Accuracy: 904/923 (97.9415%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2252, Accuracy: 9336/10000 (93.3600%)
time spent on training: 22.134082078933716
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [710, 615, 499, 620, 429, 589, 517, 633, 303, 923]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [46, 6, 35, 17, 20, 77, 44, 8, 78, 3], weight: tensor([0.1216, 0.1053, 0.0855, 0.1062, 0.0735, 0.1009, 0.0886, 0.1084, 0.0519,
        0.1581])
[rfa agg] iter:  0, prev_obj_val: 0.7305186986923218, obj_val: 0.7290244698524475, abs dis: 0.0014942288398742676
[rfa agg] iter:  0, weight: tensor([0.1013, 0.0962, 0.1174, 0.1239, 0.0707, 0.1044, 0.0875, 0.0949, 0.0738,
        0.1300])
[rfa agg] iter:  1, prev_obj_val: 0.7290244698524475, obj_val: 0.7289841175079346, abs dis: 4.035234451293945e-05
[rfa agg] iter:  1, weight: tensor([0.0981, 0.0944, 0.1222, 0.1262, 0.0713, 0.1051, 0.0877, 0.0934, 0.0766,
        0.1251])
[rfa agg] iter:  2, prev_obj_val: 0.7289841175079346, obj_val: 0.7289829850196838, abs dis: 1.1324882507324219e-06
[rfa agg] iter:  2, weight: tensor([0.0976, 0.0941, 0.1230, 0.1265, 0.0714, 0.1053, 0.0877, 0.0932, 0.0770,
        0.1243])
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.0688, Accuracy: 9773/10000 (97.7300%)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 10.7991, Accuracy: 33/8968 (0.3680%)
Done in 38.169212341308594 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:36 choose agents : [39, 14, 32, 4, 30, 65, 23, 3, 98, 88]. Adversary List: []
___Train Local_Simple,  epoch  36, local model 39, internal_epoch   1,  Average loss: 0.0011, Accuracy: 252/257 (98.0545%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1096, Accuracy: 9639/10000 (96.3900%)
___Train Local_Simple,  epoch  36, local model 14, internal_epoch   1,  Average loss: 0.0012, Accuracy: 368/376 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1278, Accuracy: 9616/10000 (96.1600%)
___Train Local_Simple,  epoch  36, local model 32, internal_epoch   1,  Average loss: 0.0018, Accuracy: 946/977 (96.8270%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2782, Accuracy: 9114/10000 (91.1400%)
___Train Local_Simple,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 647/658 (98.3283%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2218, Accuracy: 9277/10000 (92.7700%)
___Train Local_Simple,  epoch  36, local model 30, internal_epoch   1,  Average loss: 0.0015, Accuracy: 390/400 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1574, Accuracy: 9500/10000 (95.0000%)
___Train Local_Simple,  epoch  36, local model 65, internal_epoch   1,  Average loss: 0.0008, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1168, Accuracy: 9627/10000 (96.2700%)
___Train Local_Simple,  epoch  36, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1201, Accuracy: 9576/10000 (95.7600%)
___Train Local_Simple,  epoch  36, local model 3, internal_epoch   1,  Average loss: 0.0011, Accuracy: 901/923 (97.6165%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1781, Accuracy: 9449/10000 (94.4900%)
___Train Local_Simple,  epoch  36, local model 98, internal_epoch   1,  Average loss: 0.0013, Accuracy: 799/818 (97.6773%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.4124, Accuracy: 8748/10000 (87.4800%)
___Train Local_Simple,  epoch  36, local model 88, internal_epoch   1,  Average loss: 0.0009, Accuracy: 520/530 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1124, Accuracy: 9640/10000 (96.4000%)
time spent on training: 22.64819860458374
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [257, 376, 977, 658, 400, 371, 293, 923, 818, 530]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [39, 14, 32, 4, 30, 65, 23, 3, 98, 88], weight: tensor([0.0459, 0.0671, 0.1744, 0.1174, 0.0714, 0.0662, 0.0523, 0.1647, 0.1460,
        0.0946])
[rfa agg] iter:  0, prev_obj_val: 0.7350795269012451, obj_val: 0.7295867800712585, abs dis: 0.005492746829986572
[rfa agg] iter:  0, weight: tensor([0.0639, 0.0800, 0.1198, 0.1151, 0.0920, 0.0903, 0.0842, 0.1391, 0.1124,
        0.1031])
[rfa agg] iter:  1, prev_obj_val: 0.7295867800712585, obj_val: 0.7293450236320496, abs dis: 0.00024175643920898438
[rfa agg] iter:  1, weight: tensor([0.0674, 0.0835, 0.1097, 0.1133, 0.0961, 0.0950, 0.0917, 0.1321, 0.1055,
        0.1057])
[rfa agg] iter:  2, prev_obj_val: 0.7293450236320496, obj_val: 0.7293343544006348, abs dis: 1.0669231414794922e-05
[rfa agg] iter:  2, weight: tensor([0.0681, 0.0843, 0.1079, 0.1126, 0.0970, 0.0960, 0.0935, 0.1303, 0.1041,
        0.1063])
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.0687, Accuracy: 9778/10000 (97.7800%)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 10.7959, Accuracy: 34/8968 (0.3791%)
Done in 33.920961141586304 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:37 choose agents : [71, 2, 43, 25, 17, 37, 46, 56, 30, 0]. Adversary List: []
___Train Local_Simple,  epoch  37, local model 71, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1367/1384 (98.7717%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.7025, Accuracy: 8420/10000 (84.2000%)
___Train Local_Simple,  epoch  37, local model 2, internal_epoch   1,  Average loss: 0.0011, Accuracy: 539/548 (98.3577%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1056, Accuracy: 9670/10000 (96.7000%)
___Train Local_Simple,  epoch  37, local model 43, internal_epoch   1,  Average loss: 0.0010, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1903, Accuracy: 9363/10000 (93.6300%)
___Train Local_Simple,  epoch  37, local model 25, internal_epoch   1,  Average loss: 0.0014, Accuracy: 630/647 (97.3725%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4476, Accuracy: 8575/10000 (85.7500%)
___Train Local_Simple,  epoch  37, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 604/620 (97.4194%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1076, Accuracy: 9661/10000 (96.6100%)
___Train Local_Simple,  epoch  37, local model 37, internal_epoch   1,  Average loss: 0.0011, Accuracy: 844/860 (98.1395%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1839, Accuracy: 9393/10000 (93.9300%)
___Train Local_Simple,  epoch  37, local model 46, internal_epoch   1,  Average loss: 0.0016, Accuracy: 688/710 (96.9014%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.3139, Accuracy: 8996/10000 (89.9600%)
___Train Local_Simple,  epoch  37, local model 56, internal_epoch   1,  Average loss: 0.0012, Accuracy: 863/880 (98.0682%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1037, Accuracy: 9650/10000 (96.5000%)
___Train Local_Simple,  epoch  37, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 388/400 (97.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.3289, Accuracy: 8954/10000 (89.5400%)
___Train Local_Simple,  epoch  37, local model 0, internal_epoch   1,  Average loss: 0.0015, Accuracy: 422/435 (97.0115%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1654, Accuracy: 9486/10000 (94.8600%)
time spent on training: 14.01387333869934
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [1384, 548, 408, 647, 620, 860, 710, 880, 400, 435]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [71, 2, 43, 25, 17, 37, 46, 56, 30, 0], weight: tensor([0.2008, 0.0795, 0.0592, 0.0939, 0.0900, 0.1248, 0.1030, 0.1277, 0.0580,
        0.0631])
[rfa agg] iter:  0, prev_obj_val: 0.8146998286247253, obj_val: 0.8125186562538147, abs dis: 0.0021811723709106445
[rfa agg] iter:  0, weight: tensor([0.1607, 0.1060, 0.0799, 0.0724, 0.1087, 0.1155, 0.0885, 0.1227, 0.0706,
        0.0749])
[rfa agg] iter:  1, prev_obj_val: 0.8125186562538147, obj_val: 0.8124503493309021, abs dis: 6.830692291259766e-05
[rfa agg] iter:  1, weight: tensor([0.1528, 0.1095, 0.0821, 0.0709, 0.1115, 0.1149, 0.0869, 0.1227, 0.0717,
        0.0770])
[rfa agg] iter:  2, prev_obj_val: 0.8124503493309021, obj_val: 0.812447726726532, abs dis: 2.6226043701171875e-06
[rfa agg] iter:  2, weight: tensor([0.1513, 0.1101, 0.0823, 0.0708, 0.1120, 0.1150, 0.0868, 0.1228, 0.0718,
        0.0772])
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.0682, Accuracy: 9781/10000 (97.8100%)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 10.7597, Accuracy: 34/8968 (0.3791%)
Done in 24.580204725265503 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:38 choose agents : [33, 53, 17, 65, 6, 24, 86, 35, 84, 85]. Adversary List: []
___Train Local_Simple,  epoch  38, local model 33, internal_epoch   1,  Average loss: 0.0015, Accuracy: 605/623 (97.1108%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1716, Accuracy: 9424/10000 (94.2400%)
___Train Local_Simple,  epoch  38, local model 53, internal_epoch   1,  Average loss: 0.0009, Accuracy: 726/739 (98.2409%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3698, Accuracy: 8844/10000 (88.4400%)
___Train Local_Simple,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 601/620 (96.9355%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0973, Accuracy: 9697/10000 (96.9700%)
___Train Local_Simple,  epoch  38, local model 65, internal_epoch   1,  Average loss: 0.0008, Accuracy: 366/371 (98.6523%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1361, Accuracy: 9568/10000 (95.6800%)
___Train Local_Simple,  epoch  38, local model 6, internal_epoch   1,  Average loss: 0.0010, Accuracy: 603/615 (98.0488%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2812, Accuracy: 9213/10000 (92.1300%)
___Train Local_Simple,  epoch  38, local model 24, internal_epoch   1,  Average loss: 0.0014, Accuracy: 368/379 (97.0976%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0976, Accuracy: 9686/10000 (96.8600%)
___Train Local_Simple,  epoch  38, local model 86, internal_epoch   1,  Average loss: 0.0012, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0790, Accuracy: 9740/10000 (97.4000%)
___Train Local_Simple,  epoch  38, local model 35, internal_epoch   1,  Average loss: 0.0005, Accuracy: 494/499 (98.9980%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1861, Accuracy: 9414/10000 (94.1400%)
___Train Local_Simple,  epoch  38, local model 84, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1212/1246 (97.2713%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1975, Accuracy: 9389/10000 (93.8900%)
___Train Local_Simple,  epoch  38, local model 85, internal_epoch   1,  Average loss: 0.0008, Accuracy: 421/431 (97.6798%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1479, Accuracy: 9537/10000 (95.3700%)
time spent on training: 13.97212529182434
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [623, 739, 620, 371, 615, 379, 250, 499, 1246, 431]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [33, 53, 17, 65, 6, 24, 86, 35, 84, 85], weight: tensor([0.1079, 0.1280, 0.1074, 0.0643, 0.1065, 0.0657, 0.0433, 0.0864, 0.2158,
        0.0747])
[rfa agg] iter:  0, prev_obj_val: 0.7604098916053772, obj_val: 0.7501153945922852, abs dis: 0.010294497013092041
[rfa agg] iter:  0, weight: tensor([0.0969, 0.1075, 0.1196, 0.0813, 0.0909, 0.0959, 0.0779, 0.1042, 0.1381,
        0.0878])
[rfa agg] iter:  1, prev_obj_val: 0.7501153945922852, obj_val: 0.7494900226593018, abs dis: 0.0006253719329833984
[rfa agg] iter:  1, weight: tensor([0.0943, 0.1035, 0.1204, 0.0844, 0.0884, 0.1015, 0.0903, 0.1078, 0.1190,
        0.0903])
[rfa agg] iter:  2, prev_obj_val: 0.7494900226593018, obj_val: 0.7494622468948364, abs dis: 2.777576446533203e-05
[rfa agg] iter:  2, weight: tensor([0.0936, 0.1026, 0.1201, 0.0850, 0.0879, 0.1025, 0.0939, 0.1085, 0.1150,
        0.0908])
[rfa agg] iter:  3, prev_obj_val: 0.7494622468948364, obj_val: 0.7494611144065857, abs dis: 1.1324882507324219e-06
[rfa agg] iter:  3, weight: tensor([0.0935, 0.1024, 0.1199, 0.0851, 0.0878, 0.1027, 0.0948, 0.1087, 0.1142,
        0.0909])
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.0679, Accuracy: 9781/10000 (97.8100%)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 10.8184, Accuracy: 35/8968 (0.3903%)
Done in 24.590659379959106 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:39 choose agents : [60, 94, 30, 76, 42, 25, 16, 95, 52, 59]. Adversary List: []
___Train Local_Simple,  epoch  39, local model 60, internal_epoch   1,  Average loss: 0.0018, Accuracy: 329/338 (97.3373%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1193, Accuracy: 9648/10000 (96.4800%)
___Train Local_Simple,  epoch  39, local model 94, internal_epoch   1,  Average loss: 0.0016, Accuracy: 146/150 (97.3333%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1101, Accuracy: 9661/10000 (96.6100%)
___Train Local_Simple,  epoch  39, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 390/400 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1910, Accuracy: 9405/10000 (94.0500%)
___Train Local_Simple,  epoch  39, local model 76, internal_epoch   1,  Average loss: 0.0011, Accuracy: 77/78 (98.7179%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.0715, Accuracy: 9777/10000 (97.7700%)
___Train Local_Simple,  epoch  39, local model 42, internal_epoch   1,  Average loss: 0.0012, Accuracy: 232/236 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.0804, Accuracy: 9737/10000 (97.3700%)
___Train Local_Simple,  epoch  39, local model 25, internal_epoch   1,  Average loss: 0.0010, Accuracy: 632/647 (97.6816%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2998, Accuracy: 9062/10000 (90.6200%)
___Train Local_Simple,  epoch  39, local model 16, internal_epoch   1,  Average loss: 0.0012, Accuracy: 898/915 (98.1421%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.0824, Accuracy: 9736/10000 (97.3600%)
___Train Local_Simple,  epoch  39, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 597/602 (99.1694%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.7284, Accuracy: 7846/10000 (78.4600%)
___Train Local_Simple,  epoch  39, local model 52, internal_epoch   1,  Average loss: 0.0007, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1181, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch  39, local model 59, internal_epoch   1,  Average loss: 0.0013, Accuracy: 739/760 (97.2368%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.7875, Accuracy: 7949/10000 (79.4900%)
time spent on training: 13.726703405380249
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [338, 150, 400, 78, 236, 647, 915, 602, 253, 760]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [60, 94, 30, 76, 42, 25, 16, 95, 52, 59], weight: tensor([0.0772, 0.0343, 0.0913, 0.0178, 0.0539, 0.1478, 0.2090, 0.1375, 0.0578,
        0.1736])
[rfa agg] iter:  0, prev_obj_val: 0.681746244430542, obj_val: 0.6751220226287842, abs dis: 0.0066242218017578125
[rfa agg] iter:  0, weight: tensor([0.0852, 0.0529, 0.1001, 0.0364, 0.0965, 0.1212, 0.1972, 0.1174, 0.0863,
        0.1068])
[rfa agg] iter:  1, prev_obj_val: 0.6751220226287842, obj_val: 0.6748369336128235, abs dis: 0.00028508901596069336
[rfa agg] iter:  1, weight: tensor([0.0841, 0.0562, 0.1023, 0.0422, 0.1056, 0.1143, 0.1912, 0.1166, 0.0929,
        0.0946])
[rfa agg] iter:  2, prev_obj_val: 0.6748369336128235, obj_val: 0.674824059009552, abs dis: 1.2874603271484375e-05
[rfa agg] iter:  2, weight: tensor([0.0836, 0.0569, 0.1026, 0.0437, 0.1075, 0.1127, 0.1890, 0.1168, 0.0946,
        0.0925])
[rfa agg] iter:  3, prev_obj_val: 0.674824059009552, obj_val: 0.6748233437538147, abs dis: 7.152557373046875e-07
[rfa agg] iter:  3, weight: tensor([0.0835, 0.0570, 0.1027, 0.0441, 0.1080, 0.1124, 0.1883, 0.1169, 0.0951,
        0.0921])
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.0678, Accuracy: 9779/10000 (97.7900%)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 10.8328, Accuracy: 36/8968 (0.4014%)
Done in 24.384793281555176 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:40 choose agents : [52, 81, 77, 21, 10, 8, 40, 54, 46, 30]. Adversary List: []
___Train Local_Simple,  epoch  40, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1303, Accuracy: 9595/10000 (95.9500%)
___Train Local_Simple,  epoch  40, local model 81, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1208/1227 (98.4515%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2522, Accuracy: 9213/10000 (92.1300%)
___Train Local_Simple,  epoch  40, local model 77, internal_epoch   1,  Average loss: 0.0015, Accuracy: 571/589 (96.9440%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1664, Accuracy: 9479/10000 (94.7900%)
___Train Local_Simple,  epoch  40, local model 21, internal_epoch   1,  Average loss: 0.0011, Accuracy: 306/312 (98.0769%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2129, Accuracy: 9317/10000 (93.1700%)
___Train Local_Simple,  epoch  40, local model 10, internal_epoch   1,  Average loss: 0.0012, Accuracy: 875/892 (98.0942%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.7597, Accuracy: 8323/10000 (83.2300%)
___Train Local_Simple,  epoch  40, local model 8, internal_epoch   1,  Average loss: 0.0015, Accuracy: 612/633 (96.6825%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1296, Accuracy: 9613/10000 (96.1300%)
___Train Local_Simple,  epoch  40, local model 40, internal_epoch   1,  Average loss: 0.0016, Accuracy: 761/772 (98.5751%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.4201, Accuracy: 9004/10000 (90.0400%)
___Train Local_Simple,  epoch  40, local model 54, internal_epoch   1,  Average loss: 0.0013, Accuracy: 505/519 (97.3025%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3234, Accuracy: 9043/10000 (90.4300%)
___Train Local_Simple,  epoch  40, local model 46, internal_epoch   1,  Average loss: 0.0016, Accuracy: 688/710 (96.9014%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3983, Accuracy: 8671/10000 (86.7100%)
___Train Local_Simple,  epoch  40, local model 30, internal_epoch   1,  Average loss: 0.0013, Accuracy: 391/400 (97.7500%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1385, Accuracy: 9569/10000 (95.6900%)
time spent on training: 17.225229263305664
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [253, 1227, 589, 312, 892, 633, 772, 519, 710, 400]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [52, 81, 77, 21, 10, 8, 40, 54, 46, 30], weight: tensor([0.0401, 0.1945, 0.0934, 0.0495, 0.1414, 0.1004, 0.1224, 0.0823, 0.1126,
        0.0634])
[rfa agg] iter:  0, prev_obj_val: 0.8293152451515198, obj_val: 0.8280015587806702, abs dis: 0.0013136863708496094
[rfa agg] iter:  0, weight: tensor([0.0610, 0.1693, 0.1020, 0.0703, 0.1235, 0.1066, 0.1077, 0.0777, 0.0918,
        0.0902])
[rfa agg] iter:  1, prev_obj_val: 0.8280015587806702, obj_val: 0.8279666304588318, abs dis: 3.4928321838378906e-05
[rfa agg] iter:  1, weight: tensor([0.0632, 0.1642, 0.1033, 0.0716, 0.1209, 0.1084, 0.1064, 0.0778, 0.0902,
        0.0941])
[rfa agg] iter:  2, prev_obj_val: 0.8279666304588318, obj_val: 0.8279653191566467, abs dis: 1.3113021850585938e-06
[rfa agg] iter:  2, weight: tensor([0.0634, 0.1632, 0.1035, 0.0717, 0.1206, 0.1088, 0.1063, 0.0778, 0.0900,
        0.0947])
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.0677, Accuracy: 9778/10000 (97.7800%)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 10.7866, Accuracy: 36/8968 (0.4014%)
Done in 27.768277645111084 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:41 choose agents : [78, 9, 74, 89, 4, 11, 24, 43, 23, 25]. Adversary List: []
___Train Local_Simple,  epoch  41, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 297/303 (98.0198%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1281, Accuracy: 9605/10000 (96.0500%)
___Train Local_Simple,  epoch  41, local model 9, internal_epoch   1,  Average loss: 0.0009, Accuracy: 427/436 (97.9358%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1186, Accuracy: 9626/10000 (96.2600%)
poison local model 74 index 3 
___Train Local_Simple,  epoch  41, local model 74, internal_epoch   1,  Average loss: 0.0017, Accuracy: 542/557 (97.3070%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1438, Accuracy: 9550/10000 (95.5000%)
___Train Local_Simple,  epoch  41, local model 89, internal_epoch   1,  Average loss: 0.0007, Accuracy: 483/492 (98.1707%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1442, Accuracy: 9540/10000 (95.4000%)
___Train Local_Simple,  epoch  41, local model 4, internal_epoch   1,  Average loss: 0.0008, Accuracy: 648/658 (98.4802%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2628, Accuracy: 9176/10000 (91.7600%)
___Train Local_Simple,  epoch  41, local model 11, internal_epoch   1,  Average loss: 0.0013, Accuracy: 628/645 (97.3643%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2265, Accuracy: 9256/10000 (92.5600%)
___Train Local_Simple,  epoch  41, local model 24, internal_epoch   1,  Average loss: 0.0015, Accuracy: 365/379 (96.3061%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1147, Accuracy: 9640/10000 (96.4000%)
___Train Local_Simple,  epoch  41, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 399/408 (97.7941%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1014, Accuracy: 9684/10000 (96.8400%)
___Train Local_Simple,  epoch  41, local model 23, internal_epoch   1,  Average loss: 0.0006, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1266, Accuracy: 9553/10000 (95.5300%)
___Train Local_Simple,  epoch  41, local model 25, internal_epoch   1,  Average loss: 0.0011, Accuracy: 632/647 (97.6816%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.3157, Accuracy: 8956/10000 (89.5600%)
time spent on training: 16.526881217956543
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.11560813615608136  data num: [303, 436, 557, 492, 658, 645, 379, 408, 293, 647]
[rfa agg] considering poison per batch poison_fraction: 0.036127542548775426
[rfa agg] init. name: [78, 9, 74, 89, 4, 11, 24, 43, 23, 25], weight: tensor([0.0629, 0.0905, 0.1156, 0.1021, 0.1366, 0.1339, 0.0787, 0.0847, 0.0608,
        0.1343])
[rfa agg] iter:  0, prev_obj_val: 0.5975746512413025, obj_val: 0.5951783061027527, abs dis: 0.0023963451385498047
[rfa agg] iter:  0, weight: tensor([0.0843, 0.1118, 0.1058, 0.1083, 0.1228, 0.0972, 0.0882, 0.0981, 0.0925,
        0.0909])
[rfa agg] iter:  1, prev_obj_val: 0.5951783061027527, obj_val: 0.5951454639434814, abs dis: 3.2842159271240234e-05
[rfa agg] iter:  1, weight: tensor([0.0872, 0.1135, 0.1050, 0.1087, 0.1202, 0.0933, 0.0894, 0.1003, 0.0963,
        0.0860])
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.0672, Accuracy: 9782/10000 (97.8200%)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 10.8760, Accuracy: 35/8968 (0.3903%)
Done in 27.29147434234619 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:42 choose agents : [97, 91, 57, 72, 15, 94, 95, 90, 69, 20]. Adversary List: []
___Train Local_Simple,  epoch  42, local model 97, internal_epoch   1,  Average loss: 0.0009, Accuracy: 478/487 (98.1520%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4225, Accuracy: 8940/10000 (89.4000%)
___Train Local_Simple,  epoch  42, local model 91, internal_epoch   1,  Average loss: 0.0008, Accuracy: 252/256 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.0876, Accuracy: 9734/10000 (97.3400%)
___Train Local_Simple,  epoch  42, local model 57, internal_epoch   1,  Average loss: 0.0021, Accuracy: 330/343 (96.2099%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1853, Accuracy: 9413/10000 (94.1300%)
___Train Local_Simple,  epoch  42, local model 72, internal_epoch   1,  Average loss: 0.0006, Accuracy: 722/731 (98.7688%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2252, Accuracy: 9259/10000 (92.5900%)
___Train Local_Simple,  epoch  42, local model 15, internal_epoch   1,  Average loss: 0.0012, Accuracy: 393/401 (98.0050%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1105, Accuracy: 9629/10000 (96.2900%)
___Train Local_Simple,  epoch  42, local model 94, internal_epoch   1,  Average loss: 0.0017, Accuracy: 146/150 (97.3333%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1044, Accuracy: 9683/10000 (96.8300%)
___Train Local_Simple,  epoch  42, local model 95, internal_epoch   1,  Average loss: 0.0006, Accuracy: 596/602 (99.0033%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.9491, Accuracy: 7742/10000 (77.4200%)
___Train Local_Simple,  epoch  42, local model 90, internal_epoch   1,  Average loss: 0.0015, Accuracy: 667/683 (97.6574%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.5571, Accuracy: 8120/10000 (81.2000%)
___Train Local_Simple,  epoch  42, local model 69, internal_epoch   1,  Average loss: 0.0016, Accuracy: 248/256 (96.8750%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1320, Accuracy: 9566/10000 (95.6600%)
___Train Local_Simple,  epoch  42, local model 20, internal_epoch   1,  Average loss: 0.0011, Accuracy: 419/429 (97.6690%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2375, Accuracy: 9251/10000 (92.5100%)
time spent on training: 13.651931524276733
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [487, 256, 343, 731, 401, 150, 602, 683, 256, 429]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [97, 91, 57, 72, 15, 94, 95, 90, 69, 20], weight: tensor([0.1123, 0.0590, 0.0791, 0.1685, 0.0924, 0.0346, 0.1388, 0.1574, 0.0590,
        0.0989])
[rfa agg] iter:  0, prev_obj_val: 0.646465003490448, obj_val: 0.6438838243484497, abs dis: 0.002581179141998291
[rfa agg] iter:  0, weight: tensor([0.0946, 0.0967, 0.0800, 0.1557, 0.1139, 0.0654, 0.1076, 0.1038, 0.0947,
        0.0876])
[rfa agg] iter:  1, prev_obj_val: 0.6438838243484497, obj_val: 0.6438452005386353, abs dis: 3.8623809814453125e-05
[rfa agg] iter:  1, weight: tensor([0.0927, 0.1002, 0.0802, 0.1530, 0.1157, 0.0698, 0.1053, 0.0975, 0.0998,
        0.0858])
[rfa agg] iter:  2, prev_obj_val: 0.6438452005386353, obj_val: 0.643844485282898, abs dis: 7.152557373046875e-07
[rfa agg] iter:  2, weight: tensor([0.0925, 0.1005, 0.0803, 0.1524, 0.1159, 0.0705, 0.1051, 0.0968, 0.1005,
        0.0856])
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.0669, Accuracy: 9786/10000 (97.8600%)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 10.8812, Accuracy: 35/8968 (0.3903%)
Done in 24.25692629814148 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:43 choose agents : [81, 59, 21, 69, 14, 73, 28, 22, 72, 97]. Adversary List: []
___Train Local_Simple,  epoch  43, local model 81, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1200/1227 (97.7995%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2608, Accuracy: 9136/10000 (91.3600%)
___Train Local_Simple,  epoch  43, local model 59, internal_epoch   1,  Average loss: 0.0015, Accuracy: 738/760 (97.1053%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3019, Accuracy: 9067/10000 (90.6700%)
___Train Local_Simple,  epoch  43, local model 21, internal_epoch   1,  Average loss: 0.0010, Accuracy: 305/312 (97.7564%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1352, Accuracy: 9564/10000 (95.6400%)
___Train Local_Simple,  epoch  43, local model 69, internal_epoch   1,  Average loss: 0.0015, Accuracy: 249/256 (97.2656%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1619, Accuracy: 9446/10000 (94.4600%)
___Train Local_Simple,  epoch  43, local model 14, internal_epoch   1,  Average loss: 0.0010, Accuracy: 369/376 (98.1383%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0912, Accuracy: 9729/10000 (97.2900%)
poison local model 73 index 1 
___Train Local_Simple,  epoch  43, local model 73, internal_epoch   1,  Average loss: 0.0010, Accuracy: 580/591 (98.1387%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1748, Accuracy: 9438/10000 (94.3800%)
___Train Local_Simple,  epoch  43, local model 28, internal_epoch   1,  Average loss: 0.0011, Accuracy: 491/501 (98.0040%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0910, Accuracy: 9706/10000 (97.0600%)
___Train Local_Simple,  epoch  43, local model 22, internal_epoch   1,  Average loss: 0.0012, Accuracy: 567/583 (97.2556%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2079, Accuracy: 9310/10000 (93.1000%)
___Train Local_Simple,  epoch  43, local model 72, internal_epoch   1,  Average loss: 0.0007, Accuracy: 720/731 (98.4952%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2856, Accuracy: 9047/10000 (90.4700%)
___Train Local_Simple,  epoch  43, local model 97, internal_epoch   1,  Average loss: 0.0009, Accuracy: 478/487 (98.1520%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3557, Accuracy: 8924/10000 (89.2400%)
time spent on training: 15.916296482086182
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10147664835164835  data num: [1227, 760, 312, 256, 376, 591, 501, 583, 731, 487]
[rfa agg] considering poison per batch poison_fraction: 0.03171145260989011
[rfa agg] init. name: [81, 59, 21, 69, 14, 73, 28, 22, 72, 97], weight: tensor([0.2107, 0.1305, 0.0536, 0.0440, 0.0646, 0.1015, 0.0860, 0.1001, 0.1255,
        0.0836])
[rfa agg] iter:  0, prev_obj_val: 0.7701572179794312, obj_val: 0.7644057273864746, abs dis: 0.005751490592956543
[rfa agg] iter:  0, weight: tensor([0.1565, 0.0966, 0.0817, 0.0645, 0.0860, 0.0993, 0.1128, 0.0975, 0.1157,
        0.0895])
[rfa agg] iter:  1, prev_obj_val: 0.7644057273864746, obj_val: 0.7640289664268494, abs dis: 0.00037676095962524414
[rfa agg] iter:  1, weight: tensor([0.1416, 0.0904, 0.0899, 0.0692, 0.0893, 0.0992, 0.1179, 0.0977, 0.1150,
        0.0899])
[rfa agg] iter:  2, prev_obj_val: 0.7640289664268494, obj_val: 0.7640075087547302, abs dis: 2.1457672119140625e-05
[rfa agg] iter:  2, weight: tensor([0.1379, 0.0891, 0.0922, 0.0703, 0.0899, 0.0991, 0.1189, 0.0977, 0.1149,
        0.0899])
[rfa agg] iter:  3, prev_obj_val: 0.7640075087547302, obj_val: 0.7640062570571899, abs dis: 1.2516975402832031e-06
[rfa agg] iter:  3, weight: tensor([0.1371, 0.0888, 0.0928, 0.0705, 0.0900, 0.0991, 0.1191, 0.0977, 0.1149,
        0.0899])
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.0666, Accuracy: 9786/10000 (97.8600%)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 10.9184, Accuracy: 34/8968 (0.3791%)
Done in 26.53558921813965 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:44 choose agents : [37, 50, 42, 52, 75, 62, 43, 87, 26, 49]. Adversary List: []
___Train Local_Simple,  epoch  44, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 844/860 (98.1395%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3719, Accuracy: 9007/10000 (90.0700%)
___Train Local_Simple,  epoch  44, local model 50, internal_epoch   1,  Average loss: 0.0018, Accuracy: 458/474 (96.6245%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2294, Accuracy: 9296/10000 (92.9600%)
___Train Local_Simple,  epoch  44, local model 42, internal_epoch   1,  Average loss: 0.0010, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0841, Accuracy: 9725/10000 (97.2500%)
___Train Local_Simple,  epoch  44, local model 52, internal_epoch   1,  Average loss: 0.0007, Accuracy: 250/253 (98.8142%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1029, Accuracy: 9679/10000 (96.7900%)
___Train Local_Simple,  epoch  44, local model 75, internal_epoch   1,  Average loss: 0.0009, Accuracy: 674/686 (98.2507%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0976, Accuracy: 9700/10000 (97.0000%)
___Train Local_Simple,  epoch  44, local model 62, internal_epoch   1,  Average loss: 0.0008, Accuracy: 418/423 (98.8180%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0858, Accuracy: 9734/10000 (97.3400%)
___Train Local_Simple,  epoch  44, local model 43, internal_epoch   1,  Average loss: 0.0013, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1973, Accuracy: 9303/10000 (93.0300%)
___Train Local_Simple,  epoch  44, local model 87, internal_epoch   1,  Average loss: 0.0012, Accuracy: 456/470 (97.0213%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1635, Accuracy: 9480/10000 (94.8000%)
___Train Local_Simple,  epoch  44, local model 26, internal_epoch   1,  Average loss: 0.0011, Accuracy: 543/554 (98.0144%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1232, Accuracy: 9620/10000 (96.2000%)
___Train Local_Simple,  epoch  44, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 498/506 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1445, Accuracy: 9550/10000 (95.5000%)
time spent on training: 13.698418855667114
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [860, 474, 236, 253, 686, 423, 408, 470, 554, 506]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [37, 50, 42, 52, 75, 62, 43, 87, 26, 49], weight: tensor([0.1766, 0.0973, 0.0485, 0.0520, 0.1409, 0.0869, 0.0838, 0.0965, 0.1138,
        0.1039])
[rfa agg] iter:  0, prev_obj_val: 0.5859161019325256, obj_val: 0.5824015736579895, abs dis: 0.003514528274536133
[rfa agg] iter:  0, weight: tensor([0.1191, 0.0738, 0.0728, 0.0754, 0.1270, 0.1480, 0.0805, 0.0905, 0.1035,
        0.1094])
[rfa agg] iter:  1, prev_obj_val: 0.5824015736579895, obj_val: 0.5822756886482239, abs dis: 0.000125885009765625
[rfa agg] iter:  1, weight: tensor([0.1088, 0.0722, 0.0779, 0.0795, 0.1247, 0.1592, 0.0801, 0.0880, 0.1003,
        0.1094])
[rfa agg] iter:  2, prev_obj_val: 0.5822756886482239, obj_val: 0.5822715759277344, abs dis: 4.112720489501953e-06
[rfa agg] iter:  2, weight: tensor([0.1070, 0.0720, 0.0788, 0.0803, 0.1243, 0.1613, 0.0801, 0.0873, 0.0995,
        0.1093])
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.0665, Accuracy: 9782/10000 (97.8200%)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 10.9150, Accuracy: 35/8968 (0.3903%)
Done in 24.51517677307129 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:45 choose agents : [52, 36, 55, 83, 33, 25, 15, 1, 67, 51]. Adversary List: []
___Train Local_Simple,  epoch  45, local model 52, internal_epoch   1,  Average loss: 0.0010, Accuracy: 248/253 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1531, Accuracy: 9530/10000 (95.3000%)
___Train Local_Simple,  epoch  45, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 981/1005 (97.6119%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3292, Accuracy: 8920/10000 (89.2000%)
___Train Local_Simple,  epoch  45, local model 55, internal_epoch   1,  Average loss: 0.0017, Accuracy: 346/354 (97.7401%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2138, Accuracy: 9311/10000 (93.1100%)
___Train Local_Simple,  epoch  45, local model 83, internal_epoch   1,  Average loss: 0.0013, Accuracy: 426/433 (98.3834%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1005, Accuracy: 9673/10000 (96.7300%)
___Train Local_Simple,  epoch  45, local model 33, internal_epoch   1,  Average loss: 0.0015, Accuracy: 603/623 (96.7897%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2114, Accuracy: 9291/10000 (92.9100%)
___Train Local_Simple,  epoch  45, local model 25, internal_epoch   1,  Average loss: 0.0011, Accuracy: 633/647 (97.8362%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3015, Accuracy: 9000/10000 (90.0000%)
___Train Local_Simple,  epoch  45, local model 15, internal_epoch   1,  Average loss: 0.0009, Accuracy: 393/401 (98.0050%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.0993, Accuracy: 9670/10000 (96.7000%)
___Train Local_Simple,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0016, Accuracy: 733/760 (96.4474%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3332, Accuracy: 8810/10000 (88.1000%)
___Train Local_Simple,  epoch  45, local model 67, internal_epoch   1,  Average loss: 0.0014, Accuracy: 976/998 (97.7956%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1645, Accuracy: 9472/10000 (94.7200%)
poison local model 51 index 2 
___Train Local_Simple,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0010, Accuracy: 556/568 (97.8873%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4097, Accuracy: 8810/10000 (88.1000%)
time spent on training: 15.536441326141357
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.09400860642171466  data num: [253, 1005, 354, 433, 623, 647, 401, 760, 998, 568]
[rfa agg] considering poison per batch poison_fraction: 0.02937768950678583
[rfa agg] init. name: [52, 36, 55, 83, 33, 25, 15, 1, 67, 51], weight: tensor([0.0419, 0.1663, 0.0586, 0.0717, 0.1031, 0.1071, 0.0664, 0.1258, 0.1652,
        0.0940])
[rfa agg] iter:  0, prev_obj_val: 0.8217867612838745, obj_val: 0.819442868232727, abs dis: 0.002343893051147461
[rfa agg] iter:  0, weight: tensor([0.0652, 0.1341, 0.0701, 0.1036, 0.1010, 0.0980, 0.0940, 0.1054, 0.1402,
        0.0883])
[rfa agg] iter:  1, prev_obj_val: 0.819442868232727, obj_val: 0.8193592429161072, abs dis: 8.362531661987305e-05
[rfa agg] iter:  1, weight: tensor([0.0691, 0.1287, 0.0719, 0.1100, 0.1003, 0.0971, 0.0982, 0.1026, 0.1344,
        0.0877])
[rfa agg] iter:  2, prev_obj_val: 0.8193592429161072, obj_val: 0.8193560838699341, abs dis: 3.159046173095703e-06
[rfa agg] iter:  2, weight: tensor([0.0698, 0.1278, 0.0722, 0.1113, 0.1000, 0.0970, 0.0989, 0.1022, 0.1331,
        0.0877])
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.0662, Accuracy: 9783/10000 (97.8300%)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 10.8792, Accuracy: 38/8968 (0.4237%)
Done in 26.56599736213684 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:46 choose agents : [86, 4, 83, 32, 48, 45, 93, 49, 72, 81]. Adversary List: []
___Train Local_Simple,  epoch  46, local model 86, internal_epoch   1,  Average loss: 0.0011, Accuracy: 244/250 (97.6000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0932, Accuracy: 9693/10000 (96.9300%)
___Train Local_Simple,  epoch  46, local model 4, internal_epoch   1,  Average loss: 0.0009, Accuracy: 647/658 (98.3283%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2151, Accuracy: 9298/10000 (92.9800%)
___Train Local_Simple,  epoch  46, local model 83, internal_epoch   1,  Average loss: 0.0011, Accuracy: 427/433 (98.6143%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0796, Accuracy: 9740/10000 (97.4000%)
___Train Local_Simple,  epoch  46, local model 32, internal_epoch   1,  Average loss: 0.0021, Accuracy: 939/977 (96.1105%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.4811, Accuracy: 8635/10000 (86.3500%)
___Train Local_Simple,  epoch  46, local model 48, internal_epoch   1,  Average loss: 0.0009, Accuracy: 439/448 (97.9911%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1010, Accuracy: 9701/10000 (97.0100%)
___Train Local_Simple,  epoch  46, local model 45, internal_epoch   1,  Average loss: 0.0013, Accuracy: 613/628 (97.6115%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2039, Accuracy: 9338/10000 (93.3800%)
___Train Local_Simple,  epoch  46, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 619/623 (99.3579%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2020, Accuracy: 9360/10000 (93.6000%)
___Train Local_Simple,  epoch  46, local model 49, internal_epoch   1,  Average loss: 0.0007, Accuracy: 500/506 (98.8142%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1074, Accuracy: 9656/10000 (96.5600%)
___Train Local_Simple,  epoch  46, local model 72, internal_epoch   1,  Average loss: 0.0005, Accuracy: 725/731 (99.1792%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1702, Accuracy: 9433/10000 (94.3300%)
___Train Local_Simple,  epoch  46, local model 81, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1210/1227 (98.6145%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2703, Accuracy: 9185/10000 (91.8500%)
time spent on training: 14.031318426132202
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [250, 658, 433, 977, 448, 628, 623, 506, 731, 1227]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [86, 4, 83, 32, 48, 45, 93, 49, 72, 81], weight: tensor([0.0386, 0.1015, 0.0668, 0.1507, 0.0691, 0.0969, 0.0961, 0.0781, 0.1128,
        0.1893])
[rfa agg] iter:  0, prev_obj_val: 0.7424865961074829, obj_val: 0.7347061038017273, abs dis: 0.007780492305755615
[rfa agg] iter:  0, weight: tensor([0.0642, 0.1012, 0.0984, 0.0897, 0.0811, 0.0929, 0.1084, 0.1035, 0.1198,
        0.1409])
[rfa agg] iter:  1, prev_obj_val: 0.7347061038017273, obj_val: 0.7344470620155334, abs dis: 0.00025904178619384766
[rfa agg] iter:  1, weight: tensor([0.0708, 0.0995, 0.1038, 0.0807, 0.0829, 0.0918, 0.1107, 0.1076, 0.1226,
        0.1296])
[rfa agg] iter:  2, prev_obj_val: 0.7344470620155334, obj_val: 0.7344387769699097, abs dis: 8.285045623779297e-06
[rfa agg] iter:  2, weight: tensor([0.0722, 0.0991, 0.1046, 0.0795, 0.0831, 0.0915, 0.1111, 0.1082, 0.1233,
        0.1274])
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.0658, Accuracy: 9790/10000 (97.9000%)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 10.9560, Accuracy: 34/8968 (0.3791%)
Done in 24.478057384490967 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:47 choose agents : [27, 30, 33, 42, 5, 54, 88, 44, 64, 18]. Adversary List: []
___Train Local_Simple,  epoch  47, local model 27, internal_epoch   1,  Average loss: 0.0018, Accuracy: 458/471 (97.2399%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2824, Accuracy: 9112/10000 (91.1200%)
___Train Local_Simple,  epoch  47, local model 30, internal_epoch   1,  Average loss: 0.0014, Accuracy: 388/400 (97.0000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1764, Accuracy: 9435/10000 (94.3500%)
___Train Local_Simple,  epoch  47, local model 33, internal_epoch   1,  Average loss: 0.0015, Accuracy: 604/623 (96.9502%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1376, Accuracy: 9549/10000 (95.4900%)
___Train Local_Simple,  epoch  47, local model 42, internal_epoch   1,  Average loss: 0.0010, Accuracy: 233/236 (98.7288%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0832, Accuracy: 9730/10000 (97.3000%)
___Train Local_Simple,  epoch  47, local model 5, internal_epoch   1,  Average loss: 0.0015, Accuracy: 421/434 (97.0046%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1999, Accuracy: 9346/10000 (93.4600%)
___Train Local_Simple,  epoch  47, local model 54, internal_epoch   1,  Average loss: 0.0015, Accuracy: 505/519 (97.3025%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3729, Accuracy: 8912/10000 (89.1200%)
___Train Local_Simple,  epoch  47, local model 88, internal_epoch   1,  Average loss: 0.0008, Accuracy: 523/530 (98.6792%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1070, Accuracy: 9656/10000 (96.5600%)
___Train Local_Simple,  epoch  47, local model 44, internal_epoch   1,  Average loss: 0.0017, Accuracy: 506/517 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2008, Accuracy: 9321/10000 (93.2100%)
___Train Local_Simple,  epoch  47, local model 64, internal_epoch   1,  Average loss: 0.0015, Accuracy: 793/813 (97.5400%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1704, Accuracy: 9440/10000 (94.4000%)
___Train Local_Simple,  epoch  47, local model 18, internal_epoch   1,  Average loss: 0.0017, Accuracy: 440/459 (95.8606%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3380, Accuracy: 8976/10000 (89.7600%)
time spent on training: 13.907489538192749
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [471, 400, 623, 236, 434, 519, 530, 517, 813, 459]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [27, 30, 33, 42, 5, 54, 88, 44, 64, 18], weight: tensor([0.0942, 0.0800, 0.1246, 0.0472, 0.0868, 0.1038, 0.1060, 0.1034, 0.1625,
        0.0918])
[rfa agg] iter:  0, prev_obj_val: 0.6843085885047913, obj_val: 0.6828600168228149, abs dis: 0.0014485716819763184
[rfa agg] iter:  0, weight: tensor([0.0861, 0.1028, 0.1138, 0.0810, 0.0923, 0.0782, 0.1301, 0.0970, 0.1346,
        0.0841])
[rfa agg] iter:  1, prev_obj_val: 0.6828600168228149, obj_val: 0.6828237771987915, abs dis: 3.62396240234375e-05
[rfa agg] iter:  1, weight: tensor([0.0842, 0.1053, 0.1124, 0.0848, 0.0940, 0.0760, 0.1348, 0.0957, 0.1299,
        0.0830])
[rfa agg] iter:  2, prev_obj_val: 0.6828237771987915, obj_val: 0.682822585105896, abs dis: 1.1920928955078125e-06
[rfa agg] iter:  2, weight: tensor([0.0839, 0.1055, 0.1121, 0.0853, 0.0943, 0.0758, 0.1358, 0.0954, 0.1290,
        0.0828])
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.0657, Accuracy: 9785/10000 (97.8500%)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 10.9374, Accuracy: 32/8968 (0.3568%)
Done in 24.34543251991272 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:48 choose agents : [39, 29, 91, 82, 55, 87, 19, 46, 54, 17]. Adversary List: []
___Train Local_Simple,  epoch  48, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 252/257 (98.0545%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0989, Accuracy: 9671/10000 (96.7100%)
___Train Local_Simple,  epoch  48, local model 29, internal_epoch   1,  Average loss: 0.0010, Accuracy: 980/1002 (97.8044%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4829, Accuracy: 8380/10000 (83.8000%)
___Train Local_Simple,  epoch  48, local model 91, internal_epoch   1,  Average loss: 0.0006, Accuracy: 252/256 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0747, Accuracy: 9773/10000 (97.7300%)
___Train Local_Simple,  epoch  48, local model 82, internal_epoch   1,  Average loss: 0.0017, Accuracy: 688/713 (96.4937%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2083, Accuracy: 9330/10000 (93.3000%)
___Train Local_Simple,  epoch  48, local model 55, internal_epoch   1,  Average loss: 0.0017, Accuracy: 346/354 (97.7401%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2205, Accuracy: 9277/10000 (92.7700%)
___Train Local_Simple,  epoch  48, local model 87, internal_epoch   1,  Average loss: 0.0009, Accuracy: 461/470 (98.0851%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1441, Accuracy: 9555/10000 (95.5500%)
___Train Local_Simple,  epoch  48, local model 19, internal_epoch   1,  Average loss: 0.0011, Accuracy: 200/205 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1348, Accuracy: 9554/10000 (95.5400%)
___Train Local_Simple,  epoch  48, local model 46, internal_epoch   1,  Average loss: 0.0016, Accuracy: 689/710 (97.0423%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2326, Accuracy: 9218/10000 (92.1800%)
___Train Local_Simple,  epoch  48, local model 54, internal_epoch   1,  Average loss: 0.0012, Accuracy: 507/519 (97.6879%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2618, Accuracy: 9199/10000 (91.9900%)
___Train Local_Simple,  epoch  48, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 607/620 (97.9032%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1286, Accuracy: 9600/10000 (96.0000%)
time spent on training: 14.204140901565552
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [257, 1002, 256, 713, 354, 470, 205, 710, 519, 620]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [39, 29, 91, 82, 55, 87, 19, 46, 54, 17], weight: tensor([0.0503, 0.1962, 0.0501, 0.1396, 0.0693, 0.0920, 0.0401, 0.1391, 0.1016,
        0.1214])
[rfa agg] iter:  0, prev_obj_val: 0.7320587635040283, obj_val: 0.727704644203186, abs dis: 0.004354119300842285
[rfa agg] iter:  0, weight: tensor([0.0688, 0.1396, 0.0926, 0.1273, 0.0760, 0.1058, 0.0531, 0.1207, 0.0822,
        0.1340])
[rfa agg] iter:  1, prev_obj_val: 0.727704644203186, obj_val: 0.7274836897850037, abs dis: 0.00022095441818237305
[rfa agg] iter:  1, weight: tensor([0.0719, 0.1277, 0.1020, 0.1231, 0.0779, 0.1087, 0.0548, 0.1164, 0.0814,
        0.1359])
[rfa agg] iter:  2, prev_obj_val: 0.7274836897850037, obj_val: 0.7274729013442993, abs dis: 1.0788440704345703e-05
[rfa agg] iter:  2, weight: tensor([0.0725, 0.1253, 0.1043, 0.1219, 0.0784, 0.1094, 0.0552, 0.1154, 0.0816,
        0.1361])
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.0656, Accuracy: 9785/10000 (97.8500%)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 10.9021, Accuracy: 33/8968 (0.3680%)
Done in 24.931537628173828 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:49 choose agents : [3, 34, 32, 5, 77, 14, 40, 92, 76, 13]. Adversary List: []
___Train Local_Simple,  epoch  49, local model 3, internal_epoch   1,  Average loss: 0.0009, Accuracy: 905/923 (98.0498%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2541, Accuracy: 9231/10000 (92.3100%)
___Train Local_Simple,  epoch  49, local model 34, internal_epoch   1,  Average loss: 0.0005, Accuracy: 411/413 (99.5157%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1546, Accuracy: 9504/10000 (95.0400%)
___Train Local_Simple,  epoch  49, local model 32, internal_epoch   1,  Average loss: 0.0018, Accuracy: 942/977 (96.4176%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3476, Accuracy: 8900/10000 (89.0000%)
___Train Local_Simple,  epoch  49, local model 5, internal_epoch   1,  Average loss: 0.0014, Accuracy: 424/434 (97.6959%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2538, Accuracy: 9026/10000 (90.2600%)
___Train Local_Simple,  epoch  49, local model 77, internal_epoch   1,  Average loss: 0.0020, Accuracy: 574/589 (97.4533%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1002, Accuracy: 9680/10000 (96.8000%)
___Train Local_Simple,  epoch  49, local model 14, internal_epoch   1,  Average loss: 0.0012, Accuracy: 370/376 (98.4043%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1137, Accuracy: 9655/10000 (96.5500%)
___Train Local_Simple,  epoch  49, local model 40, internal_epoch   1,  Average loss: 0.0013, Accuracy: 747/772 (96.7617%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1881, Accuracy: 9441/10000 (94.4100%)
___Train Local_Simple,  epoch  49, local model 92, internal_epoch   1,  Average loss: 0.0013, Accuracy: 914/937 (97.5454%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2490, Accuracy: 9177/10000 (91.7700%)
___Train Local_Simple,  epoch  49, local model 76, internal_epoch   1,  Average loss: 0.0036, Accuracy: 77/78 (98.7179%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.0815, Accuracy: 9757/10000 (97.5700%)
___Train Local_Simple,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 716/734 (97.5477%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2862, Accuracy: 9175/10000 (91.7500%)
time spent on training: 13.922076225280762
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [923, 413, 977, 434, 589, 376, 772, 937, 78, 734]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [3, 34, 32, 5, 77, 14, 40, 92, 76, 13], weight: tensor([0.1481, 0.0663, 0.1567, 0.0696, 0.0945, 0.0603, 0.1239, 0.1503, 0.0125,
        0.1178])
[rfa agg] iter:  0, prev_obj_val: 0.86551433801651, obj_val: 0.8626770377159119, abs dis: 0.0028373003005981445
[rfa agg] iter:  0, weight: tensor([0.1260, 0.0964, 0.1231, 0.0867, 0.1060, 0.0836, 0.1069, 0.1356, 0.0242,
        0.1114])
[rfa agg] iter:  1, prev_obj_val: 0.8626770377159119, obj_val: 0.8625601530075073, abs dis: 0.00011688470840454102
[rfa agg] iter:  1, weight: tensor([0.1217, 0.1026, 0.1163, 0.0894, 0.1088, 0.0874, 0.1048, 0.1317, 0.0262,
        0.1111])
[rfa agg] iter:  2, prev_obj_val: 0.8625601530075073, obj_val: 0.862555205821991, abs dis: 4.947185516357422e-06
[rfa agg] iter:  2, weight: tensor([0.1208, 0.1040, 0.1149, 0.0898, 0.1094, 0.0881, 0.1045, 0.1307, 0.0266,
        0.1111])
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.0654, Accuracy: 9786/10000 (97.8600%)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 10.8926, Accuracy: 33/8968 (0.3680%)
Done in 24.650506734848022 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:50 choose agents : [12, 23, 91, 51, 53, 87, 54, 94, 75, 11]. Adversary List: []
___Train Local_Simple,  epoch  50, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1135/1160 (97.8448%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.4682, Accuracy: 8920/10000 (89.2000%)
___Train Local_Simple,  epoch  50, local model 23, internal_epoch   1,  Average loss: 0.0006, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.0860, Accuracy: 9707/10000 (97.0700%)
___Train Local_Simple,  epoch  50, local model 91, internal_epoch   1,  Average loss: 0.0006, Accuracy: 252/256 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.0761, Accuracy: 9764/10000 (97.6400%)
poison local model 51 index 2 
___Train Local_Simple,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0008, Accuracy: 561/568 (98.7676%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.4508, Accuracy: 8621/10000 (86.2100%)
___Train Local_Simple,  epoch  50, local model 53, internal_epoch   1,  Average loss: 0.0009, Accuracy: 728/739 (98.5115%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2879, Accuracy: 9052/10000 (90.5200%)
___Train Local_Simple,  epoch  50, local model 87, internal_epoch   1,  Average loss: 0.0008, Accuracy: 463/470 (98.5106%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1813, Accuracy: 9423/10000 (94.2300%)
___Train Local_Simple,  epoch  50, local model 54, internal_epoch   1,  Average loss: 0.0019, Accuracy: 507/519 (97.6879%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.4767, Accuracy: 8751/10000 (87.5100%)
___Train Local_Simple,  epoch  50, local model 94, internal_epoch   1,  Average loss: 0.0015, Accuracy: 146/150 (97.3333%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1184, Accuracy: 9634/10000 (96.3400%)
___Train Local_Simple,  epoch  50, local model 75, internal_epoch   1,  Average loss: 0.0008, Accuracy: 675/686 (98.3965%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1482, Accuracy: 9551/10000 (95.5100%)
___Train Local_Simple,  epoch  50, local model 11, internal_epoch   1,  Average loss: 0.0023, Accuracy: 630/645 (97.6744%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.4107, Accuracy: 8800/10000 (88.0000%)
time spent on training: 15.412327289581299
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10353627415238789  data num: [1160, 293, 256, 568, 739, 470, 519, 150, 686, 645]
[rfa agg] considering poison per batch poison_fraction: 0.032355085672621214
[rfa agg] init. name: [12, 23, 91, 51, 53, 87, 54, 94, 75, 11], weight: tensor([0.2114, 0.0534, 0.0467, 0.1035, 0.1347, 0.0857, 0.0946, 0.0273, 0.1250,
        0.1176])
[rfa agg] iter:  0, prev_obj_val: 0.7640476822853088, obj_val: 0.7587359547615051, abs dis: 0.005311727523803711
[rfa agg] iter:  0, weight: tensor([0.1550, 0.0806, 0.0846, 0.1091, 0.1277, 0.1032, 0.0851, 0.0395, 0.1248,
        0.0905])
[rfa agg] iter:  1, prev_obj_val: 0.7587359547615051, obj_val: 0.7583889365196228, abs dis: 0.0003470182418823242
[rfa agg] iter:  1, weight: tensor([0.1400, 0.0875, 0.0952, 0.1097, 0.1274, 0.1056, 0.0828, 0.0418, 0.1243,
        0.0857])
[rfa agg] iter:  2, prev_obj_val: 0.7583889365196228, obj_val: 0.7583686113357544, abs dis: 2.0325183868408203e-05
[rfa agg] iter:  2, weight: tensor([0.1364, 0.0894, 0.0982, 0.1096, 0.1273, 0.1057, 0.0822, 0.0423, 0.1241,
        0.0847])
[rfa agg] iter:  3, prev_obj_val: 0.7583686113357544, obj_val: 0.7583674788475037, abs dis: 1.1324882507324219e-06
[rfa agg] iter:  3, weight: tensor([0.1356, 0.0899, 0.0990, 0.1095, 0.1273, 0.1057, 0.0820, 0.0424, 0.1241,
        0.0845])
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.0655, Accuracy: 9783/10000 (97.8300%)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 10.9472, Accuracy: 37/8968 (0.4126%)
Done in 26.20347285270691 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:51 choose agents : [53, 28, 20, 99, 87, 18, 57, 43, 29, 47]. Adversary List: []
___Train Local_Simple,  epoch  51, local model 53, internal_epoch   1,  Average loss: 0.0010, Accuracy: 726/739 (98.2409%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.3024, Accuracy: 9066/10000 (90.6600%)
___Train Local_Simple,  epoch  51, local model 28, internal_epoch   1,  Average loss: 0.0012, Accuracy: 491/501 (98.0040%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0929, Accuracy: 9683/10000 (96.8300%)
___Train Local_Simple,  epoch  51, local model 20, internal_epoch   1,  Average loss: 0.0011, Accuracy: 421/429 (98.1352%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2727, Accuracy: 9182/10000 (91.8200%)
___Train Local_Simple,  epoch  51, local model 99, internal_epoch   1,  Average loss: 0.0008, Accuracy: 374/377 (99.2042%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1007, Accuracy: 9656/10000 (96.5600%)
___Train Local_Simple,  epoch  51, local model 87, internal_epoch   1,  Average loss: 0.0011, Accuracy: 457/470 (97.2340%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1488, Accuracy: 9541/10000 (95.4100%)
___Train Local_Simple,  epoch  51, local model 18, internal_epoch   1,  Average loss: 0.0018, Accuracy: 445/459 (96.9499%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1626, Accuracy: 9455/10000 (94.5500%)
___Train Local_Simple,  epoch  51, local model 57, internal_epoch   1,  Average loss: 0.0015, Accuracy: 331/343 (96.5015%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1830, Accuracy: 9439/10000 (94.3900%)
___Train Local_Simple,  epoch  51, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 399/408 (97.7941%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1601, Accuracy: 9493/10000 (94.9300%)
___Train Local_Simple,  epoch  51, local model 29, internal_epoch   1,  Average loss: 0.0010, Accuracy: 979/1002 (97.7046%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.3964, Accuracy: 8715/10000 (87.1500%)
___Train Local_Simple,  epoch  51, local model 47, internal_epoch   1,  Average loss: 0.0009, Accuracy: 761/776 (98.0670%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1065, Accuracy: 9655/10000 (96.5500%)
time spent on training: 13.890521049499512
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [739, 501, 429, 377, 470, 459, 343, 408, 1002, 776]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [53, 28, 20, 99, 87, 18, 57, 43, 29, 47], weight: tensor([0.1343, 0.0910, 0.0779, 0.0685, 0.0854, 0.0834, 0.0623, 0.0741, 0.1820,
        0.1410])
[rfa agg] iter:  0, prev_obj_val: 0.7101701498031616, obj_val: 0.7060053944587708, abs dis: 0.004164755344390869
[rfa agg] iter:  0, weight: tensor([0.1090, 0.1171, 0.0741, 0.1202, 0.0908, 0.0789, 0.0725, 0.0858, 0.1256,
        0.1262])
[rfa agg] iter:  1, prev_obj_val: 0.7060053944587708, obj_val: 0.7058659195899963, abs dis: 0.00013947486877441406
[rfa agg] iter:  1, weight: tensor([0.1051, 0.1209, 0.0736, 0.1286, 0.0913, 0.0789, 0.0735, 0.0884, 0.1151,
        0.1247])
[rfa agg] iter:  2, prev_obj_val: 0.7058659195899963, obj_val: 0.7058620452880859, abs dis: 3.874301910400391e-06
[rfa agg] iter:  2, weight: tensor([0.1044, 0.1214, 0.0735, 0.1299, 0.0913, 0.0789, 0.0736, 0.0889, 0.1134,
        0.1246])
___Test Target_Simple poisoned: False, epoch: 51: Average loss: 0.0654, Accuracy: 9782/10000 (97.8200%)
___Test Target_Simple poisoned: True, epoch: 51: Average loss: 10.9233, Accuracy: 37/8968 (0.4126%)
Done in 24.40390133857727 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:52 choose agents : [91, 77, 93, 49, 85, 10, 96, 64, 26, 29]. Adversary List: []
___Train Local_Simple,  epoch  52, local model 91, internal_epoch   1,  Average loss: 0.0005, Accuracy: 254/256 (99.2188%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.0792, Accuracy: 9768/10000 (97.6800%)
___Train Local_Simple,  epoch  52, local model 77, internal_epoch   1,  Average loss: 0.0015, Accuracy: 576/589 (97.7929%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1483, Accuracy: 9563/10000 (95.6300%)
___Train Local_Simple,  epoch  52, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 618/623 (99.1974%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2248, Accuracy: 9305/10000 (93.0500%)
___Train Local_Simple,  epoch  52, local model 49, internal_epoch   1,  Average loss: 0.0012, Accuracy: 492/506 (97.2332%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1214, Accuracy: 9636/10000 (96.3600%)
___Train Local_Simple,  epoch  52, local model 85, internal_epoch   1,  Average loss: 0.0004, Accuracy: 429/431 (99.5360%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1065, Accuracy: 9638/10000 (96.3800%)
___Train Local_Simple,  epoch  52, local model 10, internal_epoch   1,  Average loss: 0.0012, Accuracy: 871/892 (97.6457%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1805, Accuracy: 9357/10000 (93.5700%)
___Train Local_Simple,  epoch  52, local model 96, internal_epoch   1,  Average loss: 0.0013, Accuracy: 661/672 (98.3631%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1235, Accuracy: 9606/10000 (96.0600%)
___Train Local_Simple,  epoch  52, local model 64, internal_epoch   1,  Average loss: 0.0013, Accuracy: 793/813 (97.5400%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2447, Accuracy: 9117/10000 (91.1700%)
___Train Local_Simple,  epoch  52, local model 26, internal_epoch   1,  Average loss: 0.0010, Accuracy: 542/554 (97.8339%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1400, Accuracy: 9574/10000 (95.7400%)
___Train Local_Simple,  epoch  52, local model 29, internal_epoch   1,  Average loss: 0.0011, Accuracy: 979/1002 (97.7046%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.3143, Accuracy: 9073/10000 (90.7300%)
time spent on training: 13.937340259552002
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [256, 589, 623, 506, 431, 892, 672, 813, 554, 1002]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [91, 77, 93, 49, 85, 10, 96, 64, 26, 29], weight: tensor([0.0404, 0.0929, 0.0983, 0.0798, 0.0680, 0.1407, 0.1060, 0.1283, 0.0874,
        0.1581])
[rfa agg] iter:  0, prev_obj_val: 0.7321288585662842, obj_val: 0.727436900138855, abs dis: 0.004691958427429199
[rfa agg] iter:  0, weight: tensor([0.0819, 0.0875, 0.1028, 0.1001, 0.1081, 0.1083, 0.1150, 0.1029, 0.0881,
        0.1054])
[rfa agg] iter:  1, prev_obj_val: 0.727436900138855, obj_val: 0.7272928953170776, abs dis: 0.00014400482177734375
[rfa agg] iter:  1, weight: tensor([0.0875, 0.0865, 0.1040, 0.1041, 0.1168, 0.1025, 0.1160, 0.0980, 0.0878,
        0.0968])
[rfa agg] iter:  2, prev_obj_val: 0.7272928953170776, obj_val: 0.7272890210151672, abs dis: 3.874301910400391e-06
[rfa agg] iter:  2, weight: tensor([0.0882, 0.0863, 0.1043, 0.1048, 0.1186, 0.1015, 0.1160, 0.0972, 0.0877,
        0.0955])
___Test Target_Simple poisoned: False, epoch: 52: Average loss: 0.0652, Accuracy: 9787/10000 (97.8700%)
___Test Target_Simple poisoned: True, epoch: 52: Average loss: 10.9489, Accuracy: 37/8968 (0.4126%)
Done in 24.377821445465088 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:53 choose agents : [38, 82, 26, 18, 76, 79, 97, 39, 45, 94]. Adversary List: []
___Train Local_Simple,  epoch  53, local model 38, internal_epoch   1,  Average loss: 0.0012, Accuracy: 871/895 (97.3184%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.4782, Accuracy: 8567/10000 (85.6700%)
___Train Local_Simple,  epoch  53, local model 82, internal_epoch   1,  Average loss: 0.0016, Accuracy: 694/713 (97.3352%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2698, Accuracy: 9090/10000 (90.9000%)
___Train Local_Simple,  epoch  53, local model 26, internal_epoch   1,  Average loss: 0.0011, Accuracy: 540/554 (97.4729%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1098, Accuracy: 9666/10000 (96.6600%)
___Train Local_Simple,  epoch  53, local model 18, internal_epoch   1,  Average loss: 0.0016, Accuracy: 444/459 (96.7320%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2011, Accuracy: 9320/10000 (93.2000%)
___Train Local_Simple,  epoch  53, local model 76, internal_epoch   1,  Average loss: 0.0016, Accuracy: 77/78 (98.7179%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.0788, Accuracy: 9755/10000 (97.5500%)
___Train Local_Simple,  epoch  53, local model 79, internal_epoch   1,  Average loss: 0.0015, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.0791, Accuracy: 9746/10000 (97.4600%)
___Train Local_Simple,  epoch  53, local model 97, internal_epoch   1,  Average loss: 0.0009, Accuracy: 479/487 (98.3573%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.4452, Accuracy: 8955/10000 (89.5500%)
___Train Local_Simple,  epoch  53, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 253/257 (98.4436%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.0794, Accuracy: 9747/10000 (97.4700%)
___Train Local_Simple,  epoch  53, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 615/628 (97.9299%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.4082, Accuracy: 8801/10000 (88.0100%)
___Train Local_Simple,  epoch  53, local model 94, internal_epoch   1,  Average loss: 0.0022, Accuracy: 147/150 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.0932, Accuracy: 9707/10000 (97.0700%)
time spent on training: 13.608664751052856
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [895, 713, 554, 459, 78, 182, 487, 257, 628, 150]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [38, 82, 26, 18, 76, 79, 97, 39, 45, 94], weight: tensor([0.2033, 0.1619, 0.1258, 0.1042, 0.0177, 0.0413, 0.1106, 0.0584, 0.1426,
        0.0341])
[rfa agg] iter:  0, prev_obj_val: 0.7314079403877258, obj_val: 0.7276276350021362, abs dis: 0.0037803053855895996
[rfa agg] iter:  0, weight: tensor([0.1537, 0.1425, 0.1197, 0.1049, 0.0292, 0.0653, 0.1077, 0.0905, 0.1353,
        0.0512])
[rfa agg] iter:  1, prev_obj_val: 0.7276276350021362, obj_val: 0.7273629307746887, abs dis: 0.00026470422744750977
[rfa agg] iter:  1, weight: tensor([0.1410, 0.1368, 0.1199, 0.1047, 0.0320, 0.0707, 0.1062, 0.0980, 0.1353,
        0.0555])
[rfa agg] iter:  2, prev_obj_val: 0.7273629307746887, obj_val: 0.7273452877998352, abs dis: 1.7642974853515625e-05
[rfa agg] iter:  2, weight: tensor([0.1379, 0.1350, 0.1200, 0.1045, 0.0328, 0.0721, 0.1056, 0.1000, 0.1354,
        0.0567])
[rfa agg] iter:  3, prev_obj_val: 0.7273452877998352, obj_val: 0.7273440361022949, abs dis: 1.2516975402832031e-06
[rfa agg] iter:  3, weight: tensor([0.1371, 0.1345, 0.1200, 0.1043, 0.0330, 0.0725, 0.1054, 0.1005, 0.1355,
        0.0570])
___Test Target_Simple poisoned: False, epoch: 53: Average loss: 0.0650, Accuracy: 9786/10000 (97.8600%)
___Test Target_Simple poisoned: True, epoch: 53: Average loss: 10.9980, Accuracy: 36/8968 (0.4014%)
Done in 24.44177794456482 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:54 choose agents : [31, 1, 38, 9, 6, 19, 67, 68, 77, 15]. Adversary List: []
___Train Local_Simple,  epoch  54, local model 31, internal_epoch   1,  Average loss: 0.0008, Accuracy: 819/835 (98.0838%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1583, Accuracy: 9528/10000 (95.2800%)
___Train Local_Simple,  epoch  54, local model 1, internal_epoch   1,  Average loss: 0.0016, Accuracy: 733/760 (96.4474%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2624, Accuracy: 9110/10000 (91.1000%)
___Train Local_Simple,  epoch  54, local model 38, internal_epoch   1,  Average loss: 0.0012, Accuracy: 870/895 (97.2067%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.7970, Accuracy: 8117/10000 (81.1700%)
___Train Local_Simple,  epoch  54, local model 9, internal_epoch   1,  Average loss: 0.0009, Accuracy: 429/436 (98.3945%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1615, Accuracy: 9479/10000 (94.7900%)
___Train Local_Simple,  epoch  54, local model 6, internal_epoch   1,  Average loss: 0.0012, Accuracy: 599/615 (97.3984%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1739, Accuracy: 9422/10000 (94.2200%)
___Train Local_Simple,  epoch  54, local model 19, internal_epoch   1,  Average loss: 0.0014, Accuracy: 198/205 (96.5854%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1337, Accuracy: 9560/10000 (95.6000%)
___Train Local_Simple,  epoch  54, local model 67, internal_epoch   1,  Average loss: 0.0011, Accuracy: 970/998 (97.1944%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1849, Accuracy: 9423/10000 (94.2300%)
___Train Local_Simple,  epoch  54, local model 68, internal_epoch   1,  Average loss: 0.0010, Accuracy: 485/494 (98.1781%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1797, Accuracy: 9376/10000 (93.7600%)
___Train Local_Simple,  epoch  54, local model 77, internal_epoch   1,  Average loss: 0.0023, Accuracy: 576/589 (97.7929%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1442, Accuracy: 9522/10000 (95.2200%)
___Train Local_Simple,  epoch  54, local model 15, internal_epoch   1,  Average loss: 0.0010, Accuracy: 394/401 (98.2544%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.0875, Accuracy: 9719/10000 (97.1900%)
time spent on training: 18.220088243484497
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [835, 760, 895, 436, 615, 205, 998, 494, 589, 401]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [31, 1, 38, 9, 6, 19, 67, 68, 77, 15], weight: tensor([0.1341, 0.1220, 0.1437, 0.0700, 0.0987, 0.0329, 0.1602, 0.0793, 0.0946,
        0.0644])
[rfa agg] iter:  0, prev_obj_val: 0.8403017520904541, obj_val: 0.8354649543762207, abs dis: 0.0048367977142333984
[rfa agg] iter:  0, weight: tensor([0.1251, 0.1022, 0.0957, 0.1043, 0.1141, 0.0521, 0.1220, 0.0945, 0.1018,
        0.0882])
[rfa agg] iter:  1, prev_obj_val: 0.8354649543762207, obj_val: 0.8353428244590759, abs dis: 0.0001221299171447754
[rfa agg] iter:  1, weight: tensor([0.1247, 0.0989, 0.0892, 0.1105, 0.1160, 0.0548, 0.1149, 0.0959, 0.1035,
        0.0916])
[rfa agg] iter:  2, prev_obj_val: 0.8353428244590759, obj_val: 0.8353399038314819, abs dis: 2.9206275939941406e-06
[rfa agg] iter:  2, weight: tensor([0.1247, 0.0983, 0.0883, 0.1116, 0.1162, 0.0552, 0.1136, 0.0960, 0.1038,
        0.0921])
___Test Target_Simple poisoned: False, epoch: 54: Average loss: 0.0646, Accuracy: 9788/10000 (97.8800%)
___Test Target_Simple poisoned: True, epoch: 54: Average loss: 11.0616, Accuracy: 34/8968 (0.3791%)
Done in 29.23938488960266 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:55 choose agents : [55, 79, 1, 37, 98, 53, 29, 39, 62, 5]. Adversary List: []
___Train Local_Simple,  epoch  55, local model 55, internal_epoch   1,  Average loss: 0.0014, Accuracy: 347/354 (98.0226%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1970, Accuracy: 9356/10000 (93.5600%)
___Train Local_Simple,  epoch  55, local model 79, internal_epoch   1,  Average loss: 0.0015, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.0731, Accuracy: 9771/10000 (97.7100%)
___Train Local_Simple,  epoch  55, local model 1, internal_epoch   1,  Average loss: 0.0014, Accuracy: 738/760 (97.1053%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.2422, Accuracy: 9085/10000 (90.8500%)
___Train Local_Simple,  epoch  55, local model 37, internal_epoch   1,  Average loss: 0.0016, Accuracy: 837/860 (97.3256%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.2909, Accuracy: 9081/10000 (90.8100%)
___Train Local_Simple,  epoch  55, local model 98, internal_epoch   1,  Average loss: 0.0012, Accuracy: 798/818 (97.5550%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.3161, Accuracy: 9016/10000 (90.1600%)
___Train Local_Simple,  epoch  55, local model 53, internal_epoch   1,  Average loss: 0.0010, Accuracy: 729/739 (98.6468%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.3649, Accuracy: 8838/10000 (88.3800%)
___Train Local_Simple,  epoch  55, local model 29, internal_epoch   1,  Average loss: 0.0009, Accuracy: 979/1002 (97.7046%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1953, Accuracy: 9383/10000 (93.8300%)
___Train Local_Simple,  epoch  55, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 253/257 (98.4436%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1173, Accuracy: 9595/10000 (95.9500%)
___Train Local_Simple,  epoch  55, local model 62, internal_epoch   1,  Average loss: 0.0007, Accuracy: 419/423 (99.0544%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1115, Accuracy: 9621/10000 (96.2100%)
___Train Local_Simple,  epoch  55, local model 5, internal_epoch   1,  Average loss: 0.0015, Accuracy: 423/434 (97.4654%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1643, Accuracy: 9445/10000 (94.4500%)
time spent on training: 13.823108911514282
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [354, 182, 760, 860, 818, 739, 1002, 257, 423, 434]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [55, 79, 1, 37, 98, 53, 29, 39, 62, 5], weight: tensor([0.0607, 0.0312, 0.1304, 0.1475, 0.1403, 0.1268, 0.1719, 0.0441, 0.0726,
        0.0745])
[rfa agg] iter:  0, prev_obj_val: 0.8235902190208435, obj_val: 0.8194108605384827, abs dis: 0.00417935848236084
[rfa agg] iter:  0, weight: tensor([0.0721, 0.0587, 0.1169, 0.1027, 0.1077, 0.1205, 0.1431, 0.0603, 0.1203,
        0.0978])
[rfa agg] iter:  1, prev_obj_val: 0.8194108605384827, obj_val: 0.8192701935768127, abs dis: 0.00014066696166992188
[rfa agg] iter:  1, weight: tensor([0.0736, 0.0641, 0.1132, 0.0959, 0.1026, 0.1189, 0.1363, 0.0620, 0.1314,
        0.1020])
[rfa agg] iter:  2, prev_obj_val: 0.8192701935768127, obj_val: 0.8192649483680725, abs dis: 5.245208740234375e-06
[rfa agg] iter:  2, weight: tensor([0.0738, 0.0652, 0.1123, 0.0948, 0.1018, 0.1186, 0.1347, 0.0623, 0.1338,
        0.1028])
___Test Target_Simple poisoned: False, epoch: 55: Average loss: 0.0648, Accuracy: 9788/10000 (97.8800%)
___Test Target_Simple poisoned: True, epoch: 55: Average loss: 10.9579, Accuracy: 36/8968 (0.4014%)
Done in 24.4152352809906 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:56 choose agents : [79, 82, 14, 39, 7, 10, 40, 2, 70, 56]. Adversary List: []
___Train Local_Simple,  epoch  56, local model 79, internal_epoch   1,  Average loss: 0.0015, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.0809, Accuracy: 9745/10000 (97.4500%)
___Train Local_Simple,  epoch  56, local model 82, internal_epoch   1,  Average loss: 0.0015, Accuracy: 692/713 (97.0547%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.2831, Accuracy: 9061/10000 (90.6100%)
___Train Local_Simple,  epoch  56, local model 14, internal_epoch   1,  Average loss: 0.0011, Accuracy: 370/376 (98.4043%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1830, Accuracy: 9457/10000 (94.5700%)
___Train Local_Simple,  epoch  56, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 253/257 (98.4436%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.0927, Accuracy: 9695/10000 (96.9500%)
___Train Local_Simple,  epoch  56, local model 7, internal_epoch   1,  Average loss: 0.0012, Accuracy: 408/418 (97.6077%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1138, Accuracy: 9622/10000 (96.2200%)
___Train Local_Simple,  epoch  56, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 850/892 (95.2915%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.5255, Accuracy: 8250/10000 (82.5000%)
___Train Local_Simple,  epoch  56, local model 40, internal_epoch   1,  Average loss: 0.0009, Accuracy: 755/772 (97.7979%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1771, Accuracy: 9422/10000 (94.2200%)
___Train Local_Simple,  epoch  56, local model 2, internal_epoch   1,  Average loss: 0.0015, Accuracy: 541/548 (98.7226%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1081, Accuracy: 9667/10000 (96.6700%)
___Train Local_Simple,  epoch  56, local model 70, internal_epoch   1,  Average loss: 0.0017, Accuracy: 698/724 (96.4088%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1896, Accuracy: 9366/10000 (93.6600%)
___Train Local_Simple,  epoch  56, local model 56, internal_epoch   1,  Average loss: 0.0010, Accuracy: 866/880 (98.4091%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1122, Accuracy: 9641/10000 (96.4100%)
time spent on training: 13.850059986114502
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [182, 713, 376, 257, 418, 892, 772, 548, 724, 880]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [79, 82, 14, 39, 7, 10, 40, 2, 70, 56], weight: tensor([0.0316, 0.1237, 0.0653, 0.0446, 0.0725, 0.1548, 0.1340, 0.0951, 0.1257,
        0.1527])
[rfa agg] iter:  0, prev_obj_val: 0.7770327925682068, obj_val: 0.7708261013031006, abs dis: 0.006206691265106201
[rfa agg] iter:  0, weight: tensor([0.0537, 0.1091, 0.0748, 0.0674, 0.0965, 0.0964, 0.1216, 0.1220, 0.1008,
        0.1577])
[rfa agg] iter:  1, prev_obj_val: 0.7708261013031006, obj_val: 0.7706483602523804, abs dis: 0.00017774105072021484
[rfa agg] iter:  1, weight: tensor([0.0566, 0.1054, 0.0758, 0.0722, 0.1021, 0.0873, 0.1202, 0.1276, 0.0963,
        0.1566])
[rfa agg] iter:  2, prev_obj_val: 0.7706483602523804, obj_val: 0.7706435918807983, abs dis: 4.76837158203125e-06
[rfa agg] iter:  2, weight: tensor([0.0570, 0.1047, 0.0759, 0.0730, 0.1032, 0.0860, 0.1201, 0.1287, 0.0955,
        0.1559])
___Test Target_Simple poisoned: False, epoch: 56: Average loss: 0.0643, Accuracy: 9786/10000 (97.8600%)
___Test Target_Simple poisoned: True, epoch: 56: Average loss: 10.8634, Accuracy: 37/8968 (0.4126%)
Done in 24.707165956497192 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:57 choose agents : [98, 49, 86, 25, 26, 16, 7, 94, 70, 44]. Adversary List: []
___Train Local_Simple,  epoch  57, local model 98, internal_epoch   1,  Average loss: 0.0014, Accuracy: 793/818 (96.9438%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.2930, Accuracy: 9076/10000 (90.7600%)
___Train Local_Simple,  epoch  57, local model 49, internal_epoch   1,  Average loss: 0.0010, Accuracy: 496/506 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1364, Accuracy: 9575/10000 (95.7500%)
___Train Local_Simple,  epoch  57, local model 86, internal_epoch   1,  Average loss: 0.0011, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.0825, Accuracy: 9731/10000 (97.3100%)
___Train Local_Simple,  epoch  57, local model 25, internal_epoch   1,  Average loss: 0.0012, Accuracy: 632/647 (97.6816%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.3156, Accuracy: 8960/10000 (89.6000%)
___Train Local_Simple,  epoch  57, local model 26, internal_epoch   1,  Average loss: 0.0011, Accuracy: 541/554 (97.6534%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1764, Accuracy: 9453/10000 (94.5300%)
___Train Local_Simple,  epoch  57, local model 16, internal_epoch   1,  Average loss: 0.0010, Accuracy: 899/915 (98.2514%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1339, Accuracy: 9589/10000 (95.8900%)
___Train Local_Simple,  epoch  57, local model 7, internal_epoch   1,  Average loss: 0.0009, Accuracy: 411/418 (98.3254%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1216, Accuracy: 9608/10000 (96.0800%)
___Train Local_Simple,  epoch  57, local model 94, internal_epoch   1,  Average loss: 0.0027, Accuracy: 146/150 (97.3333%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1246, Accuracy: 9605/10000 (96.0500%)
___Train Local_Simple,  epoch  57, local model 70, internal_epoch   1,  Average loss: 0.0021, Accuracy: 700/724 (96.6851%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.2819, Accuracy: 9078/10000 (90.7800%)
___Train Local_Simple,  epoch  57, local model 44, internal_epoch   1,  Average loss: 0.0015, Accuracy: 502/517 (97.0986%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1743, Accuracy: 9451/10000 (94.5100%)
time spent on training: 13.840049743652344
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [818, 506, 250, 647, 554, 915, 418, 150, 724, 517]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [98, 49, 86, 25, 26, 16, 7, 94, 70, 44], weight: tensor([0.1488, 0.0920, 0.0455, 0.1177, 0.1007, 0.1664, 0.0760, 0.0273, 0.1317,
        0.0940])
[rfa agg] iter:  0, prev_obj_val: 0.7754625082015991, obj_val: 0.7710967063903809, abs dis: 0.004365801811218262
[rfa agg] iter:  0, weight: tensor([0.0995, 0.1202, 0.0761, 0.0906, 0.1044, 0.1512, 0.1174, 0.0485, 0.1002,
        0.0918])
[rfa agg] iter:  1, prev_obj_val: 0.7710967063903809, obj_val: 0.7709851861000061, abs dis: 0.00011152029037475586
[rfa agg] iter:  1, weight: tensor([0.0921, 0.1252, 0.0798, 0.0868, 0.1062, 0.1477, 0.1251, 0.0515, 0.0956,
        0.0901])
[rfa agg] iter:  2, prev_obj_val: 0.7709851861000061, obj_val: 0.7709824442863464, abs dis: 2.7418136596679688e-06
[rfa agg] iter:  2, weight: tensor([0.0910, 0.1260, 0.0801, 0.0863, 0.1065, 0.1470, 0.1265, 0.0519, 0.0949,
        0.0897])
___Test Target_Simple poisoned: False, epoch: 57: Average loss: 0.0641, Accuracy: 9787/10000 (97.8700%)
___Test Target_Simple poisoned: True, epoch: 57: Average loss: 10.8689, Accuracy: 35/8968 (0.3903%)
Done in 24.540821313858032 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:58 choose agents : [78, 27, 79, 19, 60, 87, 95, 41, 17, 59]. Adversary List: []
___Train Local_Simple,  epoch  58, local model 78, internal_epoch   1,  Average loss: 0.0008, Accuracy: 298/303 (98.3498%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1185, Accuracy: 9621/10000 (96.2100%)
___Train Local_Simple,  epoch  58, local model 27, internal_epoch   1,  Average loss: 0.0011, Accuracy: 463/471 (98.3015%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1809, Accuracy: 9394/10000 (93.9400%)
___Train Local_Simple,  epoch  58, local model 79, internal_epoch   1,  Average loss: 0.0015, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.0735, Accuracy: 9764/10000 (97.6400%)
___Train Local_Simple,  epoch  58, local model 19, internal_epoch   1,  Average loss: 0.0013, Accuracy: 200/205 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1322, Accuracy: 9569/10000 (95.6900%)
___Train Local_Simple,  epoch  58, local model 60, internal_epoch   1,  Average loss: 0.0016, Accuracy: 329/338 (97.3373%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1135, Accuracy: 9657/10000 (96.5700%)
___Train Local_Simple,  epoch  58, local model 87, internal_epoch   1,  Average loss: 0.0011, Accuracy: 463/470 (98.5106%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1197, Accuracy: 9637/10000 (96.3700%)
___Train Local_Simple,  epoch  58, local model 95, internal_epoch   1,  Average loss: 0.0005, Accuracy: 598/602 (99.3355%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.7460, Accuracy: 7280/10000 (72.8000%)
poison local model 41 index 0 
___Train Local_Simple,  epoch  58, local model 41, internal_epoch   1,  Average loss: 0.0011, Accuracy: 594/606 (98.0198%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1746, Accuracy: 9433/10000 (94.3300%)
___Train Local_Simple,  epoch  58, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 606/620 (97.7419%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1072, Accuracy: 9665/10000 (96.6500%)
___Train Local_Simple,  epoch  58, local model 59, internal_epoch   1,  Average loss: 0.0013, Accuracy: 745/760 (98.0263%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.5041, Accuracy: 8606/10000 (86.0600%)
time spent on training: 15.951637029647827
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.13298222514812377  data num: [303, 471, 182, 205, 338, 470, 602, 606, 620, 760]
[rfa agg] considering poison per batch poison_fraction: 0.04155694535878868
[rfa agg] init. name: [78, 27, 79, 19, 60, 87, 95, 41, 17, 59], weight: tensor([0.0665, 0.1034, 0.0399, 0.0450, 0.0742, 0.1031, 0.1321, 0.1330, 0.1361,
        0.1668])
[rfa agg] iter:  0, prev_obj_val: 0.6495228409767151, obj_val: 0.6452650427818298, abs dis: 0.004257798194885254
[rfa agg] iter:  0, weight: tensor([0.0999, 0.1055, 0.0705, 0.0618, 0.0839, 0.1298, 0.0841, 0.1069, 0.1439,
        0.1136])
[rfa agg] iter:  1, prev_obj_val: 0.6452650427818298, obj_val: 0.6451850533485413, abs dis: 7.998943328857422e-05
[rfa agg] iter:  1, weight: tensor([0.1044, 0.1067, 0.0752, 0.0639, 0.0853, 0.1338, 0.0788, 0.1018, 0.1438,
        0.1063])
[rfa agg] iter:  2, prev_obj_val: 0.6451850533485413, obj_val: 0.6451837420463562, abs dis: 1.3113021850585938e-06
[rfa agg] iter:  2, weight: tensor([0.1050, 0.1070, 0.0758, 0.0641, 0.0854, 0.1344, 0.0782, 0.1010, 0.1437,
        0.1054])
___Test Target_Simple poisoned: False, epoch: 58: Average loss: 0.0639, Accuracy: 9790/10000 (97.9000%)
___Test Target_Simple poisoned: True, epoch: 58: Average loss: 10.9388, Accuracy: 36/8968 (0.4014%)
Done in 27.297823429107666 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:59 choose agents : [81, 10, 82, 76, 95, 13, 51, 21, 86, 78]. Adversary List: []
___Train Local_Simple,  epoch  59, local model 81, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1207/1227 (98.3700%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2197, Accuracy: 9293/10000 (92.9300%)
___Train Local_Simple,  epoch  59, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 873/892 (97.8700%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.3181, Accuracy: 8947/10000 (89.4700%)
___Train Local_Simple,  epoch  59, local model 82, internal_epoch   1,  Average loss: 0.0015, Accuracy: 698/713 (97.8962%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.4462, Accuracy: 8622/10000 (86.2200%)
___Train Local_Simple,  epoch  59, local model 76, internal_epoch   1,  Average loss: 0.0012, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.0683, Accuracy: 9781/10000 (97.8100%)
___Train Local_Simple,  epoch  59, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 597/602 (99.1694%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.8638, Accuracy: 7749/10000 (77.4900%)
___Train Local_Simple,  epoch  59, local model 13, internal_epoch   1,  Average loss: 0.0006, Accuracy: 723/734 (98.5014%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2290, Accuracy: 9335/10000 (93.3500%)
poison local model 51 index 2 
___Train Local_Simple,  epoch  59, local model 51, internal_epoch   1,  Average loss: 0.0009, Accuracy: 558/568 (98.2394%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.3192, Accuracy: 9013/10000 (90.1300%)
___Train Local_Simple,  epoch  59, local model 21, internal_epoch   1,  Average loss: 0.0011, Accuracy: 305/312 (97.7564%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2167, Accuracy: 9319/10000 (93.1900%)
___Train Local_Simple,  epoch  59, local model 86, internal_epoch   1,  Average loss: 0.0011, Accuracy: 246/250 (98.4000%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.0895, Accuracy: 9710/10000 (97.1000%)
___Train Local_Simple,  epoch  59, local model 78, internal_epoch   1,  Average loss: 0.0008, Accuracy: 297/303 (98.0198%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1227, Accuracy: 9600/10000 (96.0000%)
time spent on training: 16.39495038986206
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10001760873393203  data num: [1227, 892, 713, 78, 602, 734, 568, 312, 250, 303]
[rfa agg] considering poison per batch poison_fraction: 0.03125550272935376
[rfa agg] init. name: [81, 10, 82, 76, 95, 13, 51, 21, 86, 78], weight: tensor([0.2161, 0.1571, 0.1256, 0.0137, 0.1060, 0.1292, 0.1000, 0.0549, 0.0440,
        0.0534])
[rfa agg] iter:  0, prev_obj_val: 0.787756621837616, obj_val: 0.7847422957420349, abs dis: 0.0030143260955810547
[rfa agg] iter:  0, weight: tensor([0.1693, 0.1314, 0.1002, 0.0278, 0.1049, 0.1413, 0.1097, 0.0743, 0.0630,
        0.0781])
[rfa agg] iter:  1, prev_obj_val: 0.7847422957420349, obj_val: 0.7846100330352783, abs dis: 0.0001322627067565918
[rfa agg] iter:  1, weight: tensor([0.1590, 0.1268, 0.0983, 0.0311, 0.1045, 0.1440, 0.1116, 0.0771, 0.0661,
        0.0816])
[rfa agg] iter:  2, prev_obj_val: 0.7846100330352783, obj_val: 0.7846038341522217, abs dis: 6.198883056640625e-06
[rfa agg] iter:  2, weight: tensor([0.1567, 0.1260, 0.0982, 0.0317, 0.1044, 0.1445, 0.1121, 0.0776, 0.0666,
        0.0821])
___Test Target_Simple poisoned: False, epoch: 59: Average loss: 0.0635, Accuracy: 9787/10000 (97.8700%)
___Test Target_Simple poisoned: True, epoch: 59: Average loss: 11.0274, Accuracy: 37/8968 (0.4126%)
Done in 27.7181715965271 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:60 choose agents : [79, 90, 53, 0, 31, 32, 69, 17, 29, 7]. Adversary List: []
___Train Local_Simple,  epoch  60, local model 79, internal_epoch   1,  Average loss: 0.0015, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.0733, Accuracy: 9761/10000 (97.6100%)
___Train Local_Simple,  epoch  60, local model 90, internal_epoch   1,  Average loss: 0.0014, Accuracy: 665/683 (97.3646%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6676, Accuracy: 7877/10000 (78.7700%)
___Train Local_Simple,  epoch  60, local model 53, internal_epoch   1,  Average loss: 0.0009, Accuracy: 727/739 (98.3762%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2510, Accuracy: 9187/10000 (91.8700%)
___Train Local_Simple,  epoch  60, local model 0, internal_epoch   1,  Average loss: 0.0015, Accuracy: 424/435 (97.4713%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2177, Accuracy: 9292/10000 (92.9200%)
___Train Local_Simple,  epoch  60, local model 31, internal_epoch   1,  Average loss: 0.0007, Accuracy: 823/835 (98.5629%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2061, Accuracy: 9435/10000 (94.3500%)
___Train Local_Simple,  epoch  60, local model 32, internal_epoch   1,  Average loss: 0.0016, Accuracy: 946/977 (96.8270%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1646, Accuracy: 9459/10000 (94.5900%)
___Train Local_Simple,  epoch  60, local model 69, internal_epoch   1,  Average loss: 0.0016, Accuracy: 248/256 (96.8750%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1246, Accuracy: 9575/10000 (95.7500%)
___Train Local_Simple,  epoch  60, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 607/620 (97.9032%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1297, Accuracy: 9594/10000 (95.9400%)
___Train Local_Simple,  epoch  60, local model 29, internal_epoch   1,  Average loss: 0.0010, Accuracy: 982/1002 (98.0040%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1597, Accuracy: 9506/10000 (95.0600%)
___Train Local_Simple,  epoch  60, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 409/418 (97.8469%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1103, Accuracy: 9631/10000 (96.3100%)
time spent on training: 18.775732040405273
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [182, 683, 739, 435, 835, 977, 256, 620, 1002, 418]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [79, 90, 53, 0, 31, 32, 69, 17, 29, 7], weight: tensor([0.0296, 0.1111, 0.1202, 0.0708, 0.1358, 0.1589, 0.0416, 0.1009, 0.1630,
        0.0680])
[rfa agg] iter:  0, prev_obj_val: 0.7983905076980591, obj_val: 0.7961739897727966, abs dis: 0.002216517925262451
[rfa agg] iter:  0, weight: tensor([0.0622, 0.0879, 0.1132, 0.0767, 0.1238, 0.1240, 0.0635, 0.1090, 0.1467,
        0.0931])
[rfa agg] iter:  1, prev_obj_val: 0.7961739897727966, obj_val: 0.7961039543151855, abs dis: 7.003545761108398e-05
[rfa agg] iter:  1, weight: tensor([0.0678, 0.0853, 0.1115, 0.0777, 0.1223, 0.1176, 0.0664, 0.1109, 0.1430,
        0.0975])
[rfa agg] iter:  2, prev_obj_val: 0.7961039543151855, obj_val: 0.7961016893386841, abs dis: 2.2649765014648438e-06
[rfa agg] iter:  2, weight: tensor([0.0688, 0.0850, 0.1111, 0.0778, 0.1221, 0.1165, 0.0669, 0.1113, 0.1422,
        0.0983])
___Test Target_Simple poisoned: False, epoch: 60: Average loss: 0.0636, Accuracy: 9788/10000 (97.8800%)
___Test Target_Simple poisoned: True, epoch: 60: Average loss: 10.9816, Accuracy: 37/8968 (0.4126%)
Done in 30.256312370300293 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:61 choose agents : [36, 9, 6, 83, 4, 54, 49, 5, 91, 77]. Adversary List: []
___Train Local_Simple,  epoch  61, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 987/1005 (98.2090%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2307, Accuracy: 9276/10000 (92.7600%)
___Train Local_Simple,  epoch  61, local model 9, internal_epoch   1,  Average loss: 0.0008, Accuracy: 428/436 (98.1651%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1421, Accuracy: 9558/10000 (95.5800%)
___Train Local_Simple,  epoch  61, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 605/615 (98.3740%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1977, Accuracy: 9349/10000 (93.4900%)
___Train Local_Simple,  epoch  61, local model 83, internal_epoch   1,  Average loss: 0.0010, Accuracy: 428/433 (98.8453%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.0818, Accuracy: 9721/10000 (97.2100%)
___Train Local_Simple,  epoch  61, local model 4, internal_epoch   1,  Average loss: 0.0012, Accuracy: 643/658 (97.7204%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2339, Accuracy: 9236/10000 (92.3600%)
___Train Local_Simple,  epoch  61, local model 54, internal_epoch   1,  Average loss: 0.0013, Accuracy: 503/519 (96.9171%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.4306, Accuracy: 8761/10000 (87.6100%)
___Train Local_Simple,  epoch  61, local model 49, internal_epoch   1,  Average loss: 0.0007, Accuracy: 497/506 (98.2213%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1203, Accuracy: 9630/10000 (96.3000%)
___Train Local_Simple,  epoch  61, local model 5, internal_epoch   1,  Average loss: 0.0013, Accuracy: 424/434 (97.6959%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1728, Accuracy: 9378/10000 (93.7800%)
___Train Local_Simple,  epoch  61, local model 91, internal_epoch   1,  Average loss: 0.0005, Accuracy: 254/256 (99.2188%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.0812, Accuracy: 9764/10000 (97.6400%)
___Train Local_Simple,  epoch  61, local model 77, internal_epoch   1,  Average loss: 0.0017, Accuracy: 573/589 (97.2835%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1365, Accuracy: 9570/10000 (95.7000%)
time spent on training: 13.588300704956055
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [1005, 436, 615, 433, 658, 519, 506, 434, 256, 589]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [36, 9, 6, 83, 4, 54, 49, 5, 91, 77], weight: tensor([0.1844, 0.0800, 0.1128, 0.0794, 0.1207, 0.0952, 0.0928, 0.0796, 0.0470,
        0.1081])
[rfa agg] iter:  0, prev_obj_val: 0.6621354818344116, obj_val: 0.6567673683166504, abs dis: 0.0053681135177612305
[rfa agg] iter:  0, weight: tensor([0.1240, 0.0953, 0.1133, 0.1132, 0.1027, 0.0697, 0.1179, 0.0944, 0.0764,
        0.0931])
[rfa agg] iter:  1, prev_obj_val: 0.6567673683166504, obj_val: 0.656539261341095, abs dis: 0.00022810697555541992
[rfa agg] iter:  1, weight: tensor([0.1117, 0.0982, 0.1118, 0.1209, 0.0989, 0.0672, 0.1218, 0.0971, 0.0829,
        0.0896])
[rfa agg] iter:  2, prev_obj_val: 0.656539261341095, obj_val: 0.6565307378768921, abs dis: 8.52346420288086e-06
[rfa agg] iter:  2, weight: tensor([0.1094, 0.0988, 0.1112, 0.1227, 0.0980, 0.0669, 0.1225, 0.0975, 0.0842,
        0.0888])
___Test Target_Simple poisoned: False, epoch: 61: Average loss: 0.0635, Accuracy: 9789/10000 (97.8900%)
___Test Target_Simple poisoned: True, epoch: 61: Average loss: 10.9735, Accuracy: 37/8968 (0.4126%)
Done in 23.792829990386963 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:62 choose agents : [10, 31, 99, 86, 33, 30, 70, 11, 28, 72]. Adversary List: []
___Train Local_Simple,  epoch  62, local model 10, internal_epoch   1,  Average loss: 0.0012, Accuracy: 872/892 (97.7578%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.3101, Accuracy: 8894/10000 (88.9400%)
___Train Local_Simple,  epoch  62, local model 31, internal_epoch   1,  Average loss: 0.0008, Accuracy: 823/835 (98.5629%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1391, Accuracy: 9569/10000 (95.6900%)
___Train Local_Simple,  epoch  62, local model 99, internal_epoch   1,  Average loss: 0.0008, Accuracy: 373/377 (98.9390%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.0818, Accuracy: 9731/10000 (97.3100%)
___Train Local_Simple,  epoch  62, local model 86, internal_epoch   1,  Average loss: 0.0010, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.0876, Accuracy: 9725/10000 (97.2500%)
___Train Local_Simple,  epoch  62, local model 33, internal_epoch   1,  Average loss: 0.0017, Accuracy: 599/623 (96.1477%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1228, Accuracy: 9599/10000 (95.9900%)
___Train Local_Simple,  epoch  62, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 389/400 (97.2500%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1991, Accuracy: 9361/10000 (93.6100%)
___Train Local_Simple,  epoch  62, local model 70, internal_epoch   1,  Average loss: 0.0018, Accuracy: 705/724 (97.3757%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.3221, Accuracy: 8929/10000 (89.2900%)
___Train Local_Simple,  epoch  62, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 626/645 (97.0543%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1868, Accuracy: 9400/10000 (94.0000%)
___Train Local_Simple,  epoch  62, local model 28, internal_epoch   1,  Average loss: 0.0012, Accuracy: 490/501 (97.8044%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.0962, Accuracy: 9676/10000 (96.7600%)
___Train Local_Simple,  epoch  62, local model 72, internal_epoch   1,  Average loss: 0.0006, Accuracy: 723/731 (98.9056%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.2309, Accuracy: 9244/10000 (92.4400%)
time spent on training: 14.00926661491394
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [892, 835, 377, 250, 623, 400, 724, 645, 501, 731]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [10, 31, 99, 86, 33, 30, 70, 11, 28, 72], weight: tensor([0.1492, 0.1397, 0.0631, 0.0418, 0.1042, 0.0669, 0.1211, 0.1079, 0.0838,
        0.1223])
[rfa agg] iter:  0, prev_obj_val: 0.7086058855056763, obj_val: 0.7058137655258179, abs dis: 0.0027921199798583984
[rfa agg] iter:  0, weight: tensor([0.1225, 0.1313, 0.1117, 0.0671, 0.0988, 0.0754, 0.0848, 0.0904, 0.0932,
        0.1247])
[rfa agg] iter:  1, prev_obj_val: 0.7058137655258179, obj_val: 0.7057116031646729, abs dis: 0.00010216236114501953
[rfa agg] iter:  1, weight: tensor([0.1158, 0.1287, 0.1223, 0.0717, 0.0978, 0.0768, 0.0798, 0.0881, 0.0935,
        0.1254])
[rfa agg] iter:  2, prev_obj_val: 0.7057116031646729, obj_val: 0.7057072520256042, abs dis: 4.351139068603516e-06
[rfa agg] iter:  2, weight: tensor([0.1143, 0.1279, 0.1247, 0.0727, 0.0977, 0.0770, 0.0790, 0.0878, 0.0934,
        0.1255])
___Test Target_Simple poisoned: False, epoch: 62: Average loss: 0.0634, Accuracy: 9792/10000 (97.9200%)
___Test Target_Simple poisoned: True, epoch: 62: Average loss: 11.0691, Accuracy: 34/8968 (0.3791%)
Done in 24.62215566635132 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:63 choose agents : [65, 74, 35, 31, 89, 64, 21, 85, 54, 26]. Adversary List: []
___Train Local_Simple,  epoch  63, local model 65, internal_epoch   1,  Average loss: 0.0007, Accuracy: 366/371 (98.6523%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1281, Accuracy: 9581/10000 (95.8100%)
poison local model 74 index 3 
___Train Local_Simple,  epoch  63, local model 74, internal_epoch   1,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1363, Accuracy: 9559/10000 (95.5900%)
___Train Local_Simple,  epoch  63, local model 35, internal_epoch   1,  Average loss: 0.0004, Accuracy: 495/499 (99.1984%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1508, Accuracy: 9527/10000 (95.2700%)
___Train Local_Simple,  epoch  63, local model 31, internal_epoch   1,  Average loss: 0.0023, Accuracy: 810/835 (97.0060%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.5788, Accuracy: 8592/10000 (85.9200%)
___Train Local_Simple,  epoch  63, local model 89, internal_epoch   1,  Average loss: 0.0006, Accuracy: 485/492 (98.5772%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1322, Accuracy: 9601/10000 (96.0100%)
___Train Local_Simple,  epoch  63, local model 64, internal_epoch   1,  Average loss: 0.0014, Accuracy: 792/813 (97.4170%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1591, Accuracy: 9442/10000 (94.4200%)
___Train Local_Simple,  epoch  63, local model 21, internal_epoch   1,  Average loss: 0.0012, Accuracy: 305/312 (97.7564%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1961, Accuracy: 9367/10000 (93.6700%)
___Train Local_Simple,  epoch  63, local model 85, internal_epoch   1,  Average loss: 0.0005, Accuracy: 427/431 (99.0719%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1051, Accuracy: 9641/10000 (96.4100%)
___Train Local_Simple,  epoch  63, local model 54, internal_epoch   1,  Average loss: 0.0014, Accuracy: 505/519 (97.3025%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2267, Accuracy: 9289/10000 (92.8900%)
___Train Local_Simple,  epoch  63, local model 26, internal_epoch   1,  Average loss: 0.0011, Accuracy: 540/554 (97.4729%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1154, Accuracy: 9661/10000 (96.6100%)
time spent on training: 15.85428261756897
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10347389931265094  data num: [371, 557, 499, 835, 492, 813, 312, 431, 519, 554]
[rfa agg] considering poison per batch poison_fraction: 0.03233559353520342
[rfa agg] init. name: [65, 74, 35, 31, 89, 64, 21, 85, 54, 26], weight: tensor([0.0689, 0.1035, 0.0927, 0.1551, 0.0914, 0.1510, 0.0580, 0.0801, 0.0964,
        0.1029])
[rfa agg] iter:  0, prev_obj_val: 0.7112914323806763, obj_val: 0.7005553841590881, abs dis: 0.010736048221588135
[rfa agg] iter:  0, weight: tensor([0.0890, 0.1090, 0.1177, 0.0809, 0.1154, 0.1180, 0.0634, 0.1167, 0.0861,
        0.1037])
[rfa agg] iter:  1, prev_obj_val: 0.7005553841590881, obj_val: 0.7002796530723572, abs dis: 0.00027573108673095703
[rfa agg] iter:  1, weight: tensor([0.0937, 0.1061, 0.1256, 0.0707, 0.1143, 0.1125, 0.0644, 0.1266, 0.0831,
        0.1030])
[rfa agg] iter:  2, prev_obj_val: 0.7002796530723572, obj_val: 0.7002723217010498, abs dis: 7.331371307373047e-06
[rfa agg] iter:  2, weight: tensor([0.0945, 0.1051, 0.1274, 0.0694, 0.1133, 0.1118, 0.0646, 0.1287, 0.0825,
        0.1027])
___Test Target_Simple poisoned: False, epoch: 63: Average loss: 0.0634, Accuracy: 9789/10000 (97.8900%)
___Test Target_Simple poisoned: True, epoch: 63: Average loss: 11.0133, Accuracy: 37/8968 (0.4126%)
Done in 31.505651473999023 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:64 choose agents : [27, 56, 49, 89, 16, 44, 54, 29, 97, 82]. Adversary List: []
___Train Local_Simple,  epoch  64, local model 27, internal_epoch   1,  Average loss: 0.0012, Accuracy: 462/471 (98.0892%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1691, Accuracy: 9412/10000 (94.1200%)
___Train Local_Simple,  epoch  64, local model 56, internal_epoch   1,  Average loss: 0.0010, Accuracy: 865/880 (98.2955%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.0956, Accuracy: 9729/10000 (97.2900%)
___Train Local_Simple,  epoch  64, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 496/506 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1681, Accuracy: 9491/10000 (94.9100%)
___Train Local_Simple,  epoch  64, local model 89, internal_epoch   1,  Average loss: 0.0006, Accuracy: 486/492 (98.7805%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1241, Accuracy: 9615/10000 (96.1500%)
___Train Local_Simple,  epoch  64, local model 16, internal_epoch   1,  Average loss: 0.0011, Accuracy: 900/915 (98.3607%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.0894, Accuracy: 9704/10000 (97.0400%)
___Train Local_Simple,  epoch  64, local model 44, internal_epoch   1,  Average loss: 0.0025, Accuracy: 500/517 (96.7118%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1463, Accuracy: 9547/10000 (95.4700%)
___Train Local_Simple,  epoch  64, local model 54, internal_epoch   1,  Average loss: 0.0015, Accuracy: 507/519 (97.6879%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.2403, Accuracy: 9237/10000 (92.3700%)
___Train Local_Simple,  epoch  64, local model 29, internal_epoch   1,  Average loss: 0.0009, Accuracy: 979/1002 (97.7046%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.8369, Accuracy: 8087/10000 (80.8700%)
___Train Local_Simple,  epoch  64, local model 97, internal_epoch   1,  Average loss: 0.0008, Accuracy: 481/487 (98.7680%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1889, Accuracy: 9357/10000 (93.5700%)
___Train Local_Simple,  epoch  64, local model 82, internal_epoch   1,  Average loss: 0.0013, Accuracy: 695/713 (97.4755%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.3791, Accuracy: 8666/10000 (86.6600%)
time spent on training: 26.041951894760132
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [471, 880, 506, 492, 915, 517, 519, 1002, 487, 713]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [27, 56, 49, 89, 16, 44, 54, 29, 97, 82], weight: tensor([0.0724, 0.1353, 0.0778, 0.0757, 0.1407, 0.0795, 0.0798, 0.1541, 0.0749,
        0.1097])
[rfa agg] iter:  0, prev_obj_val: 0.7650610208511353, obj_val: 0.7623990178108215, abs dis: 0.0026620030403137207
[rfa agg] iter:  0, weight: tensor([0.0936, 0.1185, 0.0893, 0.0927, 0.1416, 0.0776, 0.0698, 0.1107, 0.1070,
        0.0992])
[rfa agg] iter:  1, prev_obj_val: 0.7623990178108215, obj_val: 0.7623252272605896, abs dis: 7.37905502319336e-05
[rfa agg] iter:  1, weight: tensor([0.0969, 0.1152, 0.0912, 0.0960, 0.1425, 0.0766, 0.0700, 0.1041, 0.1102,
        0.0973])
[rfa agg] iter:  2, prev_obj_val: 0.7623252272605896, obj_val: 0.7623230814933777, abs dis: 2.1457672119140625e-06
[rfa agg] iter:  2, weight: tensor([0.0974, 0.1147, 0.0916, 0.0966, 0.1429, 0.0763, 0.0701, 0.1032, 0.1103,
        0.0970])
___Test Target_Simple poisoned: False, epoch: 64: Average loss: 0.0635, Accuracy: 9787/10000 (97.8700%)
___Test Target_Simple poisoned: True, epoch: 64: Average loss: 11.0372, Accuracy: 37/8968 (0.4126%)
Done in 42.434287548065186 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:65 choose agents : [5, 89, 24, 0, 35, 67, 47, 29, 46, 71]. Adversary List: []
___Train Local_Simple,  epoch  65, local model 5, internal_epoch   1,  Average loss: 0.0014, Accuracy: 422/434 (97.2350%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1527, Accuracy: 9464/10000 (94.6400%)
___Train Local_Simple,  epoch  65, local model 89, internal_epoch   1,  Average loss: 0.0008, Accuracy: 485/492 (98.5772%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1191, Accuracy: 9638/10000 (96.3800%)
___Train Local_Simple,  epoch  65, local model 24, internal_epoch   1,  Average loss: 0.0017, Accuracy: 365/379 (96.3061%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1171, Accuracy: 9628/10000 (96.2800%)
___Train Local_Simple,  epoch  65, local model 0, internal_epoch   1,  Average loss: 0.0015, Accuracy: 422/435 (97.0115%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1496, Accuracy: 9521/10000 (95.2100%)
___Train Local_Simple,  epoch  65, local model 35, internal_epoch   1,  Average loss: 0.0004, Accuracy: 494/499 (98.9980%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1525, Accuracy: 9508/10000 (95.0800%)
___Train Local_Simple,  epoch  65, local model 67, internal_epoch   1,  Average loss: 0.0010, Accuracy: 980/998 (98.1964%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.2662, Accuracy: 9132/10000 (91.3200%)
___Train Local_Simple,  epoch  65, local model 47, internal_epoch   1,  Average loss: 0.0010, Accuracy: 766/776 (98.7113%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1199, Accuracy: 9630/10000 (96.3000%)
___Train Local_Simple,  epoch  65, local model 29, internal_epoch   1,  Average loss: 0.0010, Accuracy: 983/1002 (98.1038%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.2992, Accuracy: 8945/10000 (89.4500%)
___Train Local_Simple,  epoch  65, local model 46, internal_epoch   1,  Average loss: 0.0016, Accuracy: 691/710 (97.3239%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.2922, Accuracy: 9058/10000 (90.5800%)
___Train Local_Simple,  epoch  65, local model 71, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1360/1384 (98.2659%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.7057, Accuracy: 8269/10000 (82.6900%)
time spent on training: 22.398715257644653
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [434, 492, 379, 435, 499, 998, 776, 1002, 710, 1384]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [5, 89, 24, 0, 35, 67, 47, 29, 46, 71], weight: tensor([0.0610, 0.0692, 0.0533, 0.0612, 0.0702, 0.1404, 0.1092, 0.1409, 0.0999,
        0.1947])
[rfa agg] iter:  0, prev_obj_val: 0.81942218542099, obj_val: 0.8150519728660583, abs dis: 0.004370212554931641
[rfa agg] iter:  0, weight: tensor([0.0715, 0.0801, 0.0818, 0.0669, 0.0977, 0.1397, 0.1112, 0.1224, 0.0828,
        0.1459])
[rfa agg] iter:  1, prev_obj_val: 0.8150519728660583, obj_val: 0.814781665802002, abs dis: 0.0002703070640563965
[rfa agg] iter:  1, weight: tensor([0.0748, 0.0842, 0.0854, 0.0686, 0.1042, 0.1376, 0.1123, 0.1177, 0.0807,
        0.1344])
[rfa agg] iter:  2, prev_obj_val: 0.814781665802002, obj_val: 0.814765453338623, abs dis: 1.621246337890625e-05
[rfa agg] iter:  2, weight: tensor([0.0757, 0.0855, 0.0860, 0.0691, 0.1058, 0.1367, 0.1127, 0.1166, 0.0803,
        0.1317])
[rfa agg] iter:  3, prev_obj_val: 0.814765453338623, obj_val: 0.8147644996643066, abs dis: 9.5367431640625e-07
[rfa agg] iter:  3, weight: tensor([0.0759, 0.0858, 0.0861, 0.0692, 0.1063, 0.1363, 0.1128, 0.1163, 0.0802,
        0.1311])
___Test Target_Simple poisoned: False, epoch: 65: Average loss: 0.0626, Accuracy: 9795/10000 (97.9500%)
___Test Target_Simple poisoned: True, epoch: 65: Average loss: 11.0789, Accuracy: 36/8968 (0.4014%)
Done in 38.97163653373718 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:66 choose agents : [10, 16, 42, 46, 67, 85, 24, 66, 49, 29]. Adversary List: []
___Train Local_Simple,  epoch  66, local model 10, internal_epoch   1,  Average loss: 0.0013, Accuracy: 868/892 (97.3094%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.3466, Accuracy: 8795/10000 (87.9500%)
___Train Local_Simple,  epoch  66, local model 16, internal_epoch   1,  Average loss: 0.0009, Accuracy: 902/915 (98.5792%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1692, Accuracy: 9481/10000 (94.8100%)
___Train Local_Simple,  epoch  66, local model 42, internal_epoch   1,  Average loss: 0.0011, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.0757, Accuracy: 9753/10000 (97.5300%)
___Train Local_Simple,  epoch  66, local model 46, internal_epoch   1,  Average loss: 0.0014, Accuracy: 692/710 (97.4648%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.3330, Accuracy: 8826/10000 (88.2600%)
___Train Local_Simple,  epoch  66, local model 67, internal_epoch   1,  Average loss: 0.0011, Accuracy: 973/998 (97.4950%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2885, Accuracy: 9067/10000 (90.6700%)
___Train Local_Simple,  epoch  66, local model 85, internal_epoch   1,  Average loss: 0.0005, Accuracy: 428/431 (99.3039%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.0998, Accuracy: 9685/10000 (96.8500%)
___Train Local_Simple,  epoch  66, local model 24, internal_epoch   1,  Average loss: 0.0012, Accuracy: 368/379 (97.0976%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1086, Accuracy: 9657/10000 (96.5700%)
___Train Local_Simple,  epoch  66, local model 66, internal_epoch   1,  Average loss: 0.0011, Accuracy: 648/660 (98.1818%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2407, Accuracy: 9171/10000 (91.7100%)
___Train Local_Simple,  epoch  66, local model 49, internal_epoch   1,  Average loss: 0.0007, Accuracy: 499/506 (98.6166%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1232, Accuracy: 9621/10000 (96.2100%)
___Train Local_Simple,  epoch  66, local model 29, internal_epoch   1,  Average loss: 0.0011, Accuracy: 978/1002 (97.6048%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.5197, Accuracy: 8339/10000 (83.3900%)
time spent on training: 23.706038236618042
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [892, 915, 236, 710, 998, 431, 379, 660, 506, 1002]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [10, 16, 42, 46, 67, 85, 24, 66, 49, 29], weight: tensor([0.1326, 0.1360, 0.0351, 0.1055, 0.1483, 0.0641, 0.0563, 0.0981, 0.0752,
        0.1489])
[rfa agg] iter:  0, prev_obj_val: 0.8320390582084656, obj_val: 0.8278018236160278, abs dis: 0.004237234592437744
[rfa agg] iter:  0, weight: tensor([0.1173, 0.1280, 0.0617, 0.0964, 0.1158, 0.0895, 0.0782, 0.1014, 0.1024,
        0.1093])
[rfa agg] iter:  1, prev_obj_val: 0.8278018236160278, obj_val: 0.8276026248931885, abs dis: 0.00019919872283935547
[rfa agg] iter:  1, weight: tensor([0.1145, 0.1277, 0.0672, 0.0937, 0.1083, 0.0955, 0.0803, 0.1015, 0.1093,
        0.1020])
[rfa agg] iter:  2, prev_obj_val: 0.8276026248931885, obj_val: 0.8275932669639587, abs dis: 9.357929229736328e-06
[rfa agg] iter:  2, weight: tensor([0.1140, 0.1278, 0.0684, 0.0930, 0.1066, 0.0969, 0.0804, 0.1015, 0.1110,
        0.1005])
___Test Target_Simple poisoned: False, epoch: 66: Average loss: 0.0629, Accuracy: 9790/10000 (97.9000%)
___Test Target_Simple poisoned: True, epoch: 66: Average loss: 11.0841, Accuracy: 35/8968 (0.3903%)
Done in 40.26849675178528 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:67 choose agents : [44, 41, 63, 72, 69, 8, 70, 97, 30, 75]. Adversary List: []
___Train Local_Simple,  epoch  67, local model 44, internal_epoch   1,  Average loss: 0.0028, Accuracy: 503/517 (97.2921%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1394, Accuracy: 9577/10000 (95.7700%)
poison local model 41 index 0 
___Train Local_Simple,  epoch  67, local model 41, internal_epoch   1,  Average loss: 0.0011, Accuracy: 593/606 (97.8548%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.2500, Accuracy: 9178/10000 (91.7800%)
___Train Local_Simple,  epoch  67, local model 63, internal_epoch   1,  Average loss: 0.0014, Accuracy: 863/889 (97.0754%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1040, Accuracy: 9682/10000 (96.8200%)
___Train Local_Simple,  epoch  67, local model 72, internal_epoch   1,  Average loss: 0.0005, Accuracy: 721/731 (98.6320%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.2169, Accuracy: 9252/10000 (92.5200%)
___Train Local_Simple,  epoch  67, local model 69, internal_epoch   1,  Average loss: 0.0014, Accuracy: 250/256 (97.6562%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1107, Accuracy: 9636/10000 (96.3600%)
___Train Local_Simple,  epoch  67, local model 8, internal_epoch   1,  Average loss: 0.0014, Accuracy: 615/633 (97.1564%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1528, Accuracy: 9497/10000 (94.9700%)
___Train Local_Simple,  epoch  67, local model 70, internal_epoch   1,  Average loss: 0.0019, Accuracy: 692/724 (95.5801%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.3166, Accuracy: 9027/10000 (90.2700%)
___Train Local_Simple,  epoch  67, local model 97, internal_epoch   1,  Average loss: 0.0007, Accuracy: 480/487 (98.5626%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1692, Accuracy: 9465/10000 (94.6500%)
___Train Local_Simple,  epoch  67, local model 30, internal_epoch   1,  Average loss: 0.0014, Accuracy: 392/400 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1223, Accuracy: 9617/10000 (96.1700%)
___Train Local_Simple,  epoch  67, local model 75, internal_epoch   1,  Average loss: 0.0010, Accuracy: 670/686 (97.6676%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1035, Accuracy: 9653/10000 (96.5300%)
time spent on training: 25.33513832092285
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.10220947883285546  data num: [517, 606, 889, 731, 256, 633, 724, 487, 400, 686]
[rfa agg] considering poison per batch poison_fraction: 0.03194046213526733
[rfa agg] init. name: [44, 41, 63, 72, 69, 8, 70, 97, 30, 75], weight: tensor([0.0872, 0.1022, 0.1499, 0.1233, 0.0432, 0.1068, 0.1221, 0.0821, 0.0675,
        0.1157])
[rfa agg] iter:  0, prev_obj_val: 0.74135422706604, obj_val: 0.7386013269424438, abs dis: 0.0027529001235961914
[rfa agg] iter:  0, weight: tensor([0.0789, 0.0900, 0.1148, 0.1455, 0.0744, 0.1014, 0.0884, 0.0926, 0.0939,
        0.1201])
[rfa agg] iter:  1, prev_obj_val: 0.7386013269424438, obj_val: 0.7385284900665283, abs dis: 7.283687591552734e-05
[rfa agg] iter:  1, weight: tensor([0.0779, 0.0879, 0.1087, 0.1504, 0.0792, 0.0998, 0.0843, 0.0944, 0.0964,
        0.1210])
[rfa agg] iter:  2, prev_obj_val: 0.7385284900665283, obj_val: 0.7385264039039612, abs dis: 2.086162567138672e-06
[rfa agg] iter:  2, weight: tensor([0.0778, 0.0875, 0.1077, 0.1515, 0.0800, 0.0994, 0.0838, 0.0947, 0.0966,
        0.1212])
___Test Target_Simple poisoned: False, epoch: 67: Average loss: 0.0628, Accuracy: 9792/10000 (97.9200%)
___Test Target_Simple poisoned: True, epoch: 67: Average loss: 11.0388, Accuracy: 34/8968 (0.3791%)
Done in 41.719948530197144 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:68 choose agents : [81, 32, 84, 30, 55, 42, 13, 50, 17, 31]. Adversary List: []
___Train Local_Simple,  epoch  68, local model 81, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1216/1227 (99.1035%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2566, Accuracy: 9226/10000 (92.2600%)
___Train Local_Simple,  epoch  68, local model 32, internal_epoch   1,  Average loss: 0.0015, Accuracy: 949/977 (97.1341%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1413, Accuracy: 9549/10000 (95.4900%)
___Train Local_Simple,  epoch  68, local model 84, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1221/1246 (97.9936%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.3962, Accuracy: 8800/10000 (88.0000%)
___Train Local_Simple,  epoch  68, local model 30, internal_epoch   1,  Average loss: 0.0011, Accuracy: 390/400 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1750, Accuracy: 9452/10000 (94.5200%)
___Train Local_Simple,  epoch  68, local model 55, internal_epoch   1,  Average loss: 0.0014, Accuracy: 347/354 (98.0226%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2150, Accuracy: 9298/10000 (92.9800%)
___Train Local_Simple,  epoch  68, local model 42, internal_epoch   1,  Average loss: 0.0010, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.0752, Accuracy: 9751/10000 (97.5100%)
___Train Local_Simple,  epoch  68, local model 13, internal_epoch   1,  Average loss: 0.0006, Accuracy: 725/734 (98.7738%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2543, Accuracy: 9219/10000 (92.1900%)
___Train Local_Simple,  epoch  68, local model 50, internal_epoch   1,  Average loss: 0.0016, Accuracy: 456/474 (96.2025%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1902, Accuracy: 9401/10000 (94.0100%)
___Train Local_Simple,  epoch  68, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 606/620 (97.7419%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1135, Accuracy: 9626/10000 (96.2600%)
___Train Local_Simple,  epoch  68, local model 31, internal_epoch   1,  Average loss: 0.0009, Accuracy: 818/835 (97.9641%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2009, Accuracy: 9371/10000 (93.7100%)
time spent on training: 22.633827686309814
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [1227, 977, 1246, 400, 354, 236, 734, 474, 620, 835]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [81, 32, 84, 30, 55, 42, 13, 50, 17, 31], weight: tensor([0.1727, 0.1375, 0.1754, 0.0563, 0.0498, 0.0332, 0.1033, 0.0667, 0.0873,
        0.1176])
[rfa agg] iter:  0, prev_obj_val: 0.8468900918960571, obj_val: 0.8433240056037903, abs dis: 0.0035660862922668457
[rfa agg] iter:  0, weight: tensor([0.1713, 0.1095, 0.1315, 0.0625, 0.0610, 0.0635, 0.1133, 0.0775, 0.1012,
        0.1086])
[rfa agg] iter:  1, prev_obj_val: 0.8433240056037903, obj_val: 0.8431892991065979, abs dis: 0.0001347064971923828
[rfa agg] iter:  1, weight: tensor([0.1711, 0.1048, 0.1227, 0.0637, 0.0623, 0.0691, 0.1144, 0.0799, 0.1044,
        0.1077])
[rfa agg] iter:  2, prev_obj_val: 0.8431892991065979, obj_val: 0.8431848287582397, abs dis: 4.470348358154297e-06
[rfa agg] iter:  2, weight: tensor([0.1710, 0.1040, 0.1210, 0.0639, 0.0625, 0.0702, 0.1144, 0.0804, 0.1050,
        0.1076])
___Test Target_Simple poisoned: False, epoch: 68: Average loss: 0.0627, Accuracy: 9790/10000 (97.9000%)
___Test Target_Simple poisoned: True, epoch: 68: Average loss: 11.1716, Accuracy: 34/8968 (0.3791%)
Done in 39.74199390411377 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:69 choose agents : [47, 58, 12, 76, 83, 17, 75, 72, 78, 27]. Adversary List: []
___Train Local_Simple,  epoch  69, local model 47, internal_epoch   1,  Average loss: 0.0011, Accuracy: 760/776 (97.9381%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1119, Accuracy: 9646/10000 (96.4600%)
___Train Local_Simple,  epoch  69, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 268/276 (97.1014%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1088, Accuracy: 9656/10000 (96.5600%)
___Train Local_Simple,  epoch  69, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1128/1160 (97.2414%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2113, Accuracy: 9322/10000 (93.2200%)
___Train Local_Simple,  epoch  69, local model 76, internal_epoch   1,  Average loss: 0.0028, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.0723, Accuracy: 9769/10000 (97.6900%)
___Train Local_Simple,  epoch  69, local model 83, internal_epoch   1,  Average loss: 0.0010, Accuracy: 428/433 (98.8453%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.0711, Accuracy: 9764/10000 (97.6400%)
___Train Local_Simple,  epoch  69, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 607/620 (97.9032%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1366, Accuracy: 9528/10000 (95.2800%)
___Train Local_Simple,  epoch  69, local model 75, internal_epoch   1,  Average loss: 0.0009, Accuracy: 670/686 (97.6676%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.0899, Accuracy: 9702/10000 (97.0200%)
___Train Local_Simple,  epoch  69, local model 72, internal_epoch   1,  Average loss: 0.0009, Accuracy: 719/731 (98.3584%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1683, Accuracy: 9457/10000 (94.5700%)
___Train Local_Simple,  epoch  69, local model 78, internal_epoch   1,  Average loss: 0.0009, Accuracy: 297/303 (98.0198%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1353, Accuracy: 9581/10000 (95.8100%)
___Train Local_Simple,  epoch  69, local model 27, internal_epoch   1,  Average loss: 0.0010, Accuracy: 464/471 (98.5138%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2574, Accuracy: 9181/10000 (91.8100%)
time spent on training: 22.828953981399536
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [776, 276, 1160, 78, 433, 620, 686, 731, 303, 471]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [47, 58, 12, 76, 83, 17, 75, 72, 78, 27], weight: tensor([0.1402, 0.0499, 0.2096, 0.0141, 0.0782, 0.1120, 0.1240, 0.1321, 0.0548,
        0.0851])
[rfa agg] iter:  0, prev_obj_val: 0.7472683191299438, obj_val: 0.7362430095672607, abs dis: 0.011025309562683105
[rfa agg] iter:  0, weight: tensor([0.1268, 0.0554, 0.1314, 0.0220, 0.1156, 0.1311, 0.1275, 0.1351, 0.0679,
        0.0872])
[rfa agg] iter:  1, prev_obj_val: 0.7362430095672607, obj_val: 0.7356240153312683, abs dis: 0.0006189942359924316
[rfa agg] iter:  1, weight: tensor([0.1232, 0.0562, 0.1133, 0.0238, 0.1263, 0.1355, 0.1286, 0.1331, 0.0710,
        0.0891])
[rfa agg] iter:  2, prev_obj_val: 0.7356240153312683, obj_val: 0.7355987429618835, abs dis: 2.5272369384765625e-05
[rfa agg] iter:  2, weight: tensor([0.1222, 0.0563, 0.1098, 0.0241, 0.1289, 0.1363, 0.1289, 0.1320, 0.0718,
        0.0897])
[rfa agg] iter:  3, prev_obj_val: 0.7355987429618835, obj_val: 0.7355976700782776, abs dis: 1.0728836059570312e-06
[rfa agg] iter:  3, weight: tensor([0.1219, 0.0563, 0.1091, 0.0242, 0.1296, 0.1365, 0.1289, 0.1316, 0.0720,
        0.0899])
___Test Target_Simple poisoned: False, epoch: 69: Average loss: 0.0623, Accuracy: 9791/10000 (97.9100%)
___Test Target_Simple poisoned: True, epoch: 69: Average loss: 11.2421, Accuracy: 34/8968 (0.3791%)
Done in 39.26813817024231 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:70 choose agents : [4, 50, 78, 6, 16, 61, 47, 68, 88, 65]. Adversary List: []
___Train Local_Simple,  epoch  70, local model 4, internal_epoch   1,  Average loss: 0.0012, Accuracy: 643/658 (97.7204%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2473, Accuracy: 9174/10000 (91.7400%)
___Train Local_Simple,  epoch  70, local model 50, internal_epoch   1,  Average loss: 0.0018, Accuracy: 457/474 (96.4135%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1969, Accuracy: 9349/10000 (93.4900%)
___Train Local_Simple,  epoch  70, local model 78, internal_epoch   1,  Average loss: 0.0008, Accuracy: 297/303 (98.0198%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1631, Accuracy: 9511/10000 (95.1100%)
___Train Local_Simple,  epoch  70, local model 6, internal_epoch   1,  Average loss: 0.0011, Accuracy: 604/615 (98.2114%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1253, Accuracy: 9597/10000 (95.9700%)
___Train Local_Simple,  epoch  70, local model 16, internal_epoch   1,  Average loss: 0.0010, Accuracy: 899/915 (98.2514%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.0969, Accuracy: 9707/10000 (97.0700%)
___Train Local_Simple,  epoch  70, local model 61, internal_epoch   1,  Average loss: 0.0014, Accuracy: 678/699 (96.9957%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1821, Accuracy: 9394/10000 (93.9400%)
___Train Local_Simple,  epoch  70, local model 47, internal_epoch   1,  Average loss: 0.0009, Accuracy: 764/776 (98.4536%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1280, Accuracy: 9614/10000 (96.1400%)
___Train Local_Simple,  epoch  70, local model 68, internal_epoch   1,  Average loss: 0.0009, Accuracy: 487/494 (98.5830%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1136, Accuracy: 9607/10000 (96.0700%)
___Train Local_Simple,  epoch  70, local model 88, internal_epoch   1,  Average loss: 0.0010, Accuracy: 521/530 (98.3019%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1113, Accuracy: 9666/10000 (96.6600%)
___Train Local_Simple,  epoch  70, local model 65, internal_epoch   1,  Average loss: 0.0008, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1147, Accuracy: 9641/10000 (96.4100%)
time spent on training: 21.98417019844055
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.0  data num: [658, 474, 303, 615, 915, 699, 776, 494, 530, 371]
[rfa agg] considering poison per batch poison_fraction: 0.0
[rfa agg] init. name: [4, 50, 78, 6, 16, 61, 47, 68, 88, 65], weight: tensor([0.1128, 0.0812, 0.0519, 0.1054, 0.1568, 0.1198, 0.1330, 0.0847, 0.0908,
        0.0636])
[rfa agg] iter:  0, prev_obj_val: 0.670839250087738, obj_val: 0.6700734496116638, abs dis: 0.0007658004760742188
[rfa agg] iter:  0, weight: tensor([0.0942, 0.0752, 0.0603, 0.1029, 0.1430, 0.1068, 0.1272, 0.1043, 0.1014,
        0.0848])
[rfa agg] iter:  1, prev_obj_val: 0.6700734496116638, obj_val: 0.6700572967529297, abs dis: 1.615285873413086e-05
[rfa agg] iter:  1, weight: tensor([0.0918, 0.0744, 0.0615, 0.1020, 0.1406, 0.1054, 0.1264, 0.1069, 0.1036,
        0.0874])
___Test Target_Simple poisoned: False, epoch: 70: Average loss: 0.0620, Accuracy: 9793/10000 (97.9300%)
___Test Target_Simple poisoned: True, epoch: 70: Average loss: 11.3025, Accuracy: 34/8968 (0.3791%)
Done in 38.08130931854248 sec.
Saving all the graphs.
This run has a label: Nov.13_09.27.40. Visdom environment: mnist_DBA
