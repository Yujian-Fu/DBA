current path: saved_models/model_cifar_Nov.13_08.23.09
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 201
create model done
Poisoned following participants: [17, 33, 77, 11]
We use following environment for graphs:  cifar
----------------------------------Start one training epoch------------------------------------------
Server Epoch:201 choose agents : [17, 33, 77, 11, 37, 53, 39, 57, 63, 48]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   1,  Average loss: 0.0086, Accuracy: 464/526 (88.2129%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   2,  Average loss: 0.0059, Accuracy: 486/526 (92.3954%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   3,  Average loss: 0.0026, Accuracy: 508/526 (96.5779%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   4,  Average loss: 0.0014, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   5,  Average loss: 0.0018, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   6,  Average loss: 0.0016, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 38.42691355738677. Distance: 8.950408363616058
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.9381, Accuracy: 4828/10000 (48.2800%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.2345, Accuracy: 8569/9000 (95.2111%)
Scaling by  100
Scaled Norm after poisoning: 894.6049407420015, distance: 895.0408161084052
Total norm for 4 adversaries is: 894.6049407420015. distance: 895.0408161084052
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   1,  Average loss: 0.0085, Accuracy: 459/527 (87.0968%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   2,  Average loss: 0.0068, Accuracy: 483/527 (91.6509%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   3,  Average loss: 0.0035, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   4,  Average loss: 0.0021, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   5,  Average loss: 0.0020, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   6,  Average loss: 0.0017, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 38.367595542271246. Distance: 8.651321274940962
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.0421, Accuracy: 4820/10000 (48.2000%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.3189, Accuracy: 8513/9000 (94.5889%)
Scaling by  100
Scaled Norm after poisoning: 864.7221013134798, distance: 865.1322153289634
Total norm for 4 adversaries is: 864.7221013134798. distance: 865.1322153289634
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   1,  Average loss: 0.0084, Accuracy: 436/496 (87.9032%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   2,  Average loss: 0.0046, Accuracy: 474/496 (95.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   3,  Average loss: 0.0025, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   4,  Average loss: 0.0014, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   5,  Average loss: 0.0007, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.66304237236004.
Norm before scaling: 37.91064870397564. Distance: 6.473177514183197
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.0591, Accuracy: 6612/10000 (66.1200%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.1754, Accuracy: 8626/9000 (95.8444%)
Scaling by  100
Scaled Norm after poisoning: 646.621822435649, distance: 647.3177349648316
Total norm for 4 adversaries is: 646.621822435649. distance: 647.3177349648316
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 488/546 (89.3773%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   2,  Average loss: 0.0047, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   3,  Average loss: 0.0024, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   4,  Average loss: 0.0011, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 37.88609670106156. Distance: 6.545168415231211
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.3626, Accuracy: 6025/10000 (60.2500%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.1042, Accuracy: 8739/9000 (97.1000%)
Scaling by  100
Scaled Norm after poisoning: 653.6145653211838, distance: 654.516687144033
Total norm for 4 adversaries is: 653.6145653211838. distance: 654.516687144033
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   1,  Average loss: 0.0112, Accuracy: 584/725 (80.5517%)
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   2,  Average loss: 0.0174, Accuracy: 506/725 (69.7931%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 20.6182, Accuracy: 1807/10000 (18.0700%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   1,  Average loss: 0.0049, Accuracy: 558/625 (89.2800%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   2,  Average loss: 0.0041, Accuracy: 570/625 (91.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.7054, Accuracy: 4150/10000 (41.5000%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   1,  Average loss: 0.0074, Accuracy: 186/217 (85.7143%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   2,  Average loss: 0.0012, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.1476, Accuracy: 3163/10000 (31.6300%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   1,  Average loss: 0.0074, Accuracy: 245/290 (84.4828%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   2,  Average loss: 0.0019, Accuracy: 280/290 (96.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.7085, Accuracy: 3032/10000 (30.3200%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 704/752 (93.6170%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   2,  Average loss: 0.0028, Accuracy: 709/752 (94.2819%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.7758, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   1,  Average loss: 0.0059, Accuracy: 332/378 (87.8307%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   2,  Average loss: 0.0019, Accuracy: 363/378 (96.0317%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 3.9109, Accuracy: 3120/10000 (31.2000%)
time spent on training: 320.5925965309143
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4122392758756395  data num: [526, 527, 496, 546, 725, 625, 217, 290, 752, 378]
[rfa agg] considering poison per batch poison_fraction: 0.03220619342778434
[rfa agg] init. name: [17, 33, 77, 11, 37, 53, 39, 57, 63, 48], weight: tensor([0.1035, 0.1037, 0.0976, 0.1074, 0.1427, 0.1230, 0.0427, 0.0571, 0.1480,
        0.0744])
[rfa agg] iter:  0, prev_obj_val: 11359.013671875, obj_val: 11015.0078125, abs dis: 344.005859375
[rfa agg] iter:  0, weight: tensor([0.0786, 0.0788, 0.0911, 0.0817, 0.1630, 0.1402, 0.0484, 0.0648, 0.1690,
        0.0845])
[rfa agg] iter:  1, prev_obj_val: 11015.0078125, obj_val: 10711.3193359375, abs dis: 303.6884765625
[rfa agg] iter:  1, weight: tensor([0.0613, 0.0615, 0.0692, 0.0637, 0.1812, 0.1558, 0.0537, 0.0719, 0.1879,
        0.0938])
[rfa agg] iter:  2, prev_obj_val: 10711.3193359375, obj_val: 10454.14453125, abs dis: 257.1748046875
[rfa agg] iter:  2, weight: tensor([0.0466, 0.0467, 0.0516, 0.0484, 0.1965, 0.1689, 0.0581, 0.0778, 0.2038,
        0.1015])
[rfa agg] iter:  3, prev_obj_val: 10454.14453125, obj_val: 10248.134765625, abs dis: 206.009765625
[rfa agg] iter:  3, weight: tensor([0.0346, 0.0347, 0.0378, 0.0359, 0.2090, 0.1795, 0.0616, 0.0825, 0.2168,
        0.1077])
[rfa agg] iter:  4, prev_obj_val: 10248.134765625, obj_val: 10088.541015625, abs dis: 159.59375
[rfa agg] iter:  4, weight: tensor([0.0252, 0.0253, 0.0273, 0.0262, 0.2189, 0.1877, 0.0641, 0.0859, 0.2271,
        0.1123])
[rfa agg] iter:  5, prev_obj_val: 10088.541015625, obj_val: 9966.7001953125, abs dis: 121.8408203125
[rfa agg] iter:  5, weight: tensor([0.0181, 0.0182, 0.0195, 0.0188, 0.2266, 0.1939, 0.0659, 0.0883, 0.2351,
        0.1156])
[rfa agg] iter:  6, prev_obj_val: 9966.7001953125, obj_val: 9876.3125, abs dis: 90.3876953125
[rfa agg] iter:  6, weight: tensor([0.0128, 0.0128, 0.0137, 0.0133, 0.2328, 0.1986, 0.0669, 0.0898, 0.2415,
        0.1177])
[rfa agg] iter:  7, prev_obj_val: 9876.3125, obj_val: 9811.0849609375, abs dis: 65.2275390625
[rfa agg] iter:  7, weight: tensor([0.0089, 0.0089, 0.0095, 0.0093, 0.2380, 0.2021, 0.0672, 0.0904, 0.2469,
        0.1187])
[rfa agg] iter:  8, prev_obj_val: 9811.0849609375, obj_val: 9765.515625, abs dis: 45.5693359375
[rfa agg] iter:  8, weight: tensor([0.0061, 0.0061, 0.0065, 0.0064, 0.2427, 0.2047, 0.0668, 0.0901, 0.2518,
        0.1187])
[rfa agg] iter:  9, prev_obj_val: 9765.515625, obj_val: 9731.75, abs dis: 33.765625
[rfa agg] iter:  9, weight: tensor([0.0042, 0.0042, 0.0045, 0.0044, 0.2474, 0.2066, 0.0656, 0.0889, 0.2567,
        0.1176])
___Test Target_ResNet_18 poisoned: False, epoch: 201: Average loss: 0.7066, Accuracy: 7659/10000 (76.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 201: Average loss: 3.9080, Accuracy: 1545/9000 (17.1667%)
Done in 431.5864405632019 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:202 choose agents : [17, 33, 77, 11, 63, 50, 39, 72, 88, 71]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   1,  Average loss: 0.0040, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   3,  Average loss: 0.0040, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   4,  Average loss: 0.0017, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   5,  Average loss: 0.0012, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   6,  Average loss: 0.0007, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Global model norm: 37.613431958169876.
Norm before scaling: 38.233032452420154. Distance: 8.156733122215707
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.4901, Accuracy: 5606/10000 (56.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.1929, Accuracy: 8662/9000 (96.2444%)
Scaling by  100
Scaled Norm after poisoning: 815.3428726615571, distance: 815.6733414792959
Total norm for 4 adversaries is: 815.3428726615571. distance: 815.6733414792959
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   1,  Average loss: 0.0043, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   2,  Average loss: 0.0026, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   3,  Average loss: 0.0012, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   4,  Average loss: 0.0010, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   5,  Average loss: 0.0019, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   6,  Average loss: 0.0009, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Global model norm: 37.613431958169876.
Norm before scaling: 37.7232013089052. Distance: 5.740665986771891
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.5799, Accuracy: 5461/10000 (54.6100%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.1508, Accuracy: 8667/9000 (96.3000%)
Scaling by  100
Scaled Norm after poisoning: 573.1480229835919, distance: 574.06660654492
Total norm for 4 adversaries is: 573.1480229835919. distance: 574.06660654492
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   1,  Average loss: 0.0034, Accuracy: 479/496 (96.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   2,  Average loss: 0.0033, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   3,  Average loss: 0.0019, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   4,  Average loss: 0.0007, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.613431958169876.
Norm before scaling: 37.5244614228922. Distance: 4.009408376529529
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 0.8500, Accuracy: 7227/10000 (72.2700%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.1614, Accuracy: 8692/9000 (96.5778%)
Scaling by  100
Scaled Norm after poisoning: 399.86530935428743, distance: 400.9408466345129
Total norm for 4 adversaries is: 399.86530935428743. distance: 400.9408466345129
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   1,  Average loss: 0.0028, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   2,  Average loss: 0.0031, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   3,  Average loss: 0.0016, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   4,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.613431958169876.
Norm before scaling: 37.55794189014405. Distance: 4.5789904508738974
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.1438, Accuracy: 6472/10000 (64.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.0816, Accuracy: 8792/9000 (97.6889%)
Scaling by  100
Scaled Norm after poisoning: 456.69738339517556, distance: 457.89904045542613
Total norm for 4 adversaries is: 456.69738339517556. distance: 457.89904045542613
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 202, local model 63, internal_epoch   1,  Average loss: 0.0015, Accuracy: 735/752 (97.7394%)
___Train Local_ResNet_18,  epoch 202, local model 63, internal_epoch   2,  Average loss: 0.0008, Accuracy: 746/752 (99.2021%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.0928, Accuracy: 6837/10000 (68.3700%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   1,  Average loss: 0.0028, Accuracy: 384/401 (95.7606%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   2,  Average loss: 0.0015, Accuracy: 391/401 (97.5062%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 3.2941, Accuracy: 3858/10000 (38.5800%)
___Train Local_ResNet_18,  epoch 202, local model 39, internal_epoch   1,  Average loss: 0.0057, Accuracy: 193/217 (88.9401%)
___Train Local_ResNet_18,  epoch 202, local model 39, internal_epoch   2,  Average loss: 0.0012, Accuracy: 214/217 (98.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.9510, Accuracy: 3882/10000 (38.8200%)
___Train Local_ResNet_18,  epoch 202, local model 72, internal_epoch   1,  Average loss: 0.0097, Accuracy: 506/618 (81.8770%)
___Train Local_ResNet_18,  epoch 202, local model 72, internal_epoch   2,  Average loss: 0.0088, Accuracy: 531/618 (85.9223%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 11.8625, Accuracy: 1921/10000 (19.2100%)
___Train Local_ResNet_18,  epoch 202, local model 88, internal_epoch   1,  Average loss: 0.0074, Accuracy: 377/447 (84.3400%)
___Train Local_ResNet_18,  epoch 202, local model 88, internal_epoch   2,  Average loss: 0.0042, Accuracy: 414/447 (92.6174%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 4.2591, Accuracy: 2926/10000 (29.2600%)
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 1053/1166 (90.3087%)
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   2,  Average loss: 0.0114, Accuracy: 912/1166 (78.2161%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 8.0896, Accuracy: 2688/10000 (26.8800%)
time spent on training: 355.78490591049194
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.36780196629213485  data num: [526, 527, 496, 546, 752, 401, 217, 618, 447, 1166]
[rfa agg] considering poison per batch poison_fraction: 0.028734528616573034
[rfa agg] init. name: [17, 33, 77, 11, 63, 50, 39, 72, 88, 71], weight: tensor([0.0923, 0.0925, 0.0871, 0.0959, 0.1320, 0.0704, 0.0381, 0.1085, 0.0785,
        0.2047])
[rfa agg] iter:  0, prev_obj_val: 10882.744140625, obj_val: 10166.7548828125, abs dis: 715.9892578125
[rfa agg] iter:  0, weight: tensor([0.0605, 0.0607, 0.0691, 0.0629, 0.1559, 0.0827, 0.0446, 0.1279, 0.0922,
        0.2435])
[rfa agg] iter:  1, prev_obj_val: 10166.7548828125, obj_val: 9616.560546875, abs dis: 550.1943359375
[rfa agg] iter:  1, weight: tensor([0.0395, 0.0396, 0.0437, 0.0410, 0.1745, 0.0924, 0.0498, 0.1430, 0.1030,
        0.2735])
[rfa agg] iter:  2, prev_obj_val: 9616.560546875, obj_val: 9234.423828125, abs dis: 382.13671875
[rfa agg] iter:  2, weight: tensor([0.0246, 0.0247, 0.0268, 0.0256, 0.1875, 0.0988, 0.0531, 0.1533, 0.1101,
        0.2955])
[rfa agg] iter:  3, prev_obj_val: 9234.423828125, obj_val: 8983.630859375, abs dis: 250.79296875
[rfa agg] iter:  3, weight: tensor([0.0149, 0.0149, 0.0160, 0.0154, 0.1958, 0.1025, 0.0548, 0.1597, 0.1142,
        0.3118])
[rfa agg] iter:  4, prev_obj_val: 8983.630859375, obj_val: 8827.4970703125, abs dis: 156.1337890625
[rfa agg] iter:  4, weight: tensor([0.0087, 0.0088, 0.0094, 0.0091, 0.2008, 0.1038, 0.0551, 0.1629, 0.1157,
        0.3258])
[rfa agg] iter:  5, prev_obj_val: 8827.4970703125, obj_val: 8734.0869140625, abs dis: 93.41015625
[rfa agg] iter:  5, weight: tensor([0.0050, 0.0050, 0.0053, 0.0052, 0.2033, 0.1028, 0.0540, 0.1635, 0.1146,
        0.3413])
[rfa agg] iter:  6, prev_obj_val: 8734.0869140625, obj_val: 8678.5869140625, abs dis: 55.5
[rfa agg] iter:  6, weight: tensor([0.0028, 0.0028, 0.0030, 0.0029, 0.2034, 0.0989, 0.0509, 0.1609, 0.1103,
        0.3642])
[rfa agg] iter:  7, prev_obj_val: 8678.5869140625, obj_val: 8648.0517578125, abs dis: 30.53515625
[rfa agg] iter:  7, weight: tensor([0.0015, 0.0015, 0.0016, 0.0015, 0.1987, 0.0901, 0.0448, 0.1524, 0.1005,
        0.4074])
[rfa agg] iter:  8, prev_obj_val: 8648.0517578125, obj_val: 8631.4189453125, abs dis: 16.6328125
[rfa agg] iter:  8, weight: tensor([0.0007, 0.0007, 0.0008, 0.0008, 0.1792, 0.0724, 0.0342, 0.1302, 0.0806,
        0.5004])
[rfa agg] iter:  9, prev_obj_val: 8631.4189453125, obj_val: 8630.7353515625, abs dis: 0.68359375
[rfa agg] iter:  9, weight: tensor([2.0482e-04, 2.0528e-04, 2.1759e-04, 2.1271e-04, 9.6754e-02, 3.2033e-02,
        1.4115e-02, 6.3429e-02, 3.5657e-02, 7.5717e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 202: Average loss: 0.7620, Accuracy: 7485/10000 (74.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 202: Average loss: 3.6173, Accuracy: 1508/9000 (16.7556%)
Done in 479.929744720459 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:203 choose agents : [17, 33, 77, 11, 92, 23, 26, 50, 14, 76]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   1,  Average loss: 0.0031, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   2,  Average loss: 0.0038, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   3,  Average loss: 0.0027, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   4,  Average loss: 0.0036, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   5,  Average loss: 0.0020, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   6,  Average loss: 0.0011, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Global model norm: 37.634079962307766.
Norm before scaling: 37.93335380710079. Distance: 6.853605237729896
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.0632, Accuracy: 4681/10000 (46.8100%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.1822, Accuracy: 8579/9000 (95.3222%)
Scaling by  100
Scaled Norm after poisoning: 684.6164756635645, distance: 685.3605118840741
Total norm for 4 adversaries is: 684.6164756635645. distance: 685.3605118840741
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 486/527 (92.2201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   3,  Average loss: 0.0021, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   4,  Average loss: 0.0018, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   5,  Average loss: 0.0012, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   6,  Average loss: 0.0016, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Global model norm: 37.634079962307766.
Norm before scaling: 38.17650369756655. Distance: 7.784319046413592
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.9137, Accuracy: 5047/10000 (50.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.2971, Accuracy: 8458/9000 (93.9778%)
Scaling by  100
Scaled Norm after poisoning: 778.0908125019855, distance: 778.4319575274386
Total norm for 4 adversaries is: 778.0908125019855. distance: 778.4319575274386
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   1,  Average loss: 0.0035, Accuracy: 474/496 (95.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   2,  Average loss: 0.0030, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   3,  Average loss: 0.0017, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   4,  Average loss: 0.0011, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.634079962307766.
Norm before scaling: 37.55109962448254. Distance: 4.062070383683911
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 0.8580, Accuracy: 7229/10000 (72.2900%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.1920, Accuracy: 8621/9000 (95.7889%)
Scaling by  100
Scaled Norm after poisoning: 405.1500300814502, distance: 406.2070554224779
Total norm for 4 adversaries is: 405.1500300814502. distance: 406.2070554224779
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   1,  Average loss: 0.0037, Accuracy: 516/546 (94.5055%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   2,  Average loss: 0.0033, Accuracy: 526/546 (96.3370%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   3,  Average loss: 0.0009, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   4,  Average loss: 0.0005, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   5,  Average loss: 0.0020, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.634079962307766.
Norm before scaling: 37.58871017755863. Distance: 4.644623238155498
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.1764, Accuracy: 6486/10000 (64.8600%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.1343, Accuracy: 8695/9000 (96.6111%)
Scaling by  100
Scaled Norm after poisoning: 463.2959198773501, distance: 464.4623908348231
Total norm for 4 adversaries is: 463.2959198773501. distance: 464.4623908348231
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 203, local model 92, internal_epoch   1,  Average loss: 0.0057, Accuracy: 710/796 (89.1960%)
___Train Local_ResNet_18,  epoch 203, local model 92, internal_epoch   2,  Average loss: 0.0054, Accuracy: 720/796 (90.4523%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 4.2497, Accuracy: 3585/10000 (35.8500%)
___Train Local_ResNet_18,  epoch 203, local model 23, internal_epoch   1,  Average loss: 0.0052, Accuracy: 217/248 (87.5000%)
___Train Local_ResNet_18,  epoch 203, local model 23, internal_epoch   2,  Average loss: 0.0005, Accuracy: 248/248 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.1335, Accuracy: 4403/10000 (44.0300%)
___Train Local_ResNet_18,  epoch 203, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 437/468 (93.3761%)
___Train Local_ResNet_18,  epoch 203, local model 26, internal_epoch   2,  Average loss: 0.0028, Accuracy: 448/468 (95.7265%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.0629, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch 203, local model 50, internal_epoch   1,  Average loss: 0.0033, Accuracy: 379/401 (94.5137%)
___Train Local_ResNet_18,  epoch 203, local model 50, internal_epoch   2,  Average loss: 0.0020, Accuracy: 387/401 (96.5087%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.0638, Accuracy: 5009/10000 (50.0900%)
___Train Local_ResNet_18,  epoch 203, local model 14, internal_epoch   1,  Average loss: 0.0068, Accuracy: 274/318 (86.1635%)
___Train Local_ResNet_18,  epoch 203, local model 14, internal_epoch   2,  Average loss: 0.0018, Accuracy: 303/318 (95.2830%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 8.0574, Accuracy: 2075/10000 (20.7500%)
___Train Local_ResNet_18,  epoch 203, local model 76, internal_epoch   1,  Average loss: 0.0332, Accuracy: 63/65 (96.9231%)
___Train Local_ResNet_18,  epoch 203, local model 76, internal_epoch   2,  Average loss: 0.0395, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 0.9618, Accuracy: 6976/10000 (69.7600%)
time spent on training: 368.8337507247925
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.47711227510817583  data num: [526, 527, 496, 546, 796, 248, 468, 401, 318, 65]
[rfa agg] considering poison per batch poison_fraction: 0.03727439649282624
[rfa agg] init. name: [17, 33, 77, 11, 92, 23, 26, 50, 14, 76], weight: tensor([0.1198, 0.1200, 0.1130, 0.1243, 0.1813, 0.0565, 0.1066, 0.0913, 0.0724,
        0.0148])
[rfa agg] iter:  0, prev_obj_val: 11700.8212890625, obj_val: 11674.9736328125, abs dis: 25.84765625
[rfa agg] iter:  0, weight: tensor([0.1077, 0.1079, 0.1282, 0.1119, 0.1894, 0.0586, 0.1109, 0.0950, 0.0752,
        0.0153])
[rfa agg] iter:  1, prev_obj_val: 11674.9736328125, obj_val: 11649.36328125, abs dis: 25.6103515625
[rfa agg] iter:  1, weight: tensor([0.1024, 0.1025, 0.1206, 0.1063, 0.1977, 0.0611, 0.1158, 0.0991, 0.0785,
        0.0160])
[rfa agg] iter:  2, prev_obj_val: 11649.36328125, obj_val: 11624.1826171875, abs dis: 25.1806640625
[rfa agg] iter:  2, weight: tensor([0.0970, 0.0972, 0.1132, 0.1008, 0.2060, 0.0637, 0.1206, 0.1032, 0.0817,
        0.0167])
[rfa agg] iter:  3, prev_obj_val: 11624.1826171875, obj_val: 11599.4287109375, abs dis: 24.75390625
[rfa agg] iter:  3, weight: tensor([0.0918, 0.0919, 0.1061, 0.0953, 0.2141, 0.0661, 0.1253, 0.1072, 0.0849,
        0.0173])
[rfa agg] iter:  4, prev_obj_val: 11599.4287109375, obj_val: 11575.1015625, abs dis: 24.3271484375
[rfa agg] iter:  4, weight: tensor([0.0866, 0.0867, 0.0993, 0.0899, 0.2220, 0.0685, 0.1299, 0.1112, 0.0880,
        0.0179])
[rfa agg] iter:  5, prev_obj_val: 11575.1015625, obj_val: 11551.197265625, abs dis: 23.904296875
[rfa agg] iter:  5, weight: tensor([0.0815, 0.0816, 0.0928, 0.0846, 0.2297, 0.0709, 0.1343, 0.1150, 0.0910,
        0.0185])
[rfa agg] iter:  6, prev_obj_val: 11551.197265625, obj_val: 11528.3330078125, abs dis: 22.8642578125
[rfa agg] iter:  6, weight: tensor([0.0764, 0.0766, 0.0865, 0.0794, 0.2373, 0.0732, 0.1387, 0.1187, 0.0940,
        0.0191])
[rfa agg] iter:  7, prev_obj_val: 11528.3330078125, obj_val: 11506.0947265625, abs dis: 22.23828125
[rfa agg] iter:  7, weight: tensor([0.0716, 0.0717, 0.0805, 0.0744, 0.2446, 0.0754, 0.1429, 0.1223, 0.0968,
        0.0197])
[rfa agg] iter:  8, prev_obj_val: 11506.0947265625, obj_val: 11484.890625, abs dis: 21.2041015625
[rfa agg] iter:  8, weight: tensor([0.0669, 0.0670, 0.0749, 0.0695, 0.2516, 0.0775, 0.1470, 0.1258, 0.0995,
        0.0203])
[rfa agg] iter:  9, prev_obj_val: 11484.890625, obj_val: 11464.5185546875, abs dis: 20.3720703125
[rfa agg] iter:  9, weight: tensor([0.0625, 0.0626, 0.0695, 0.0649, 0.2584, 0.0795, 0.1508, 0.1291, 0.1021,
        0.0208])
___Test Target_ResNet_18 poisoned: False, epoch: 203: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 487.8932361602783 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:204 choose agents : [17, 33, 77, 11, 49, 86, 26, 58, 6, 94]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   1,  Average loss: 0.0082, Accuracy: 435/526 (82.6996%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   2,  Average loss: 0.0018, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   3,  Average loss: 0.0014, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   4,  Average loss: 0.0013, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   5,  Average loss: 0.0009, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   6,  Average loss: 0.0010, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Global model norm: 37.79942794447672.
Norm before scaling: 38.005438164532784. Distance: 6.227860874177845
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.8652, Accuracy: 5169/10000 (51.6900%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.0642, Accuracy: 8846/9000 (98.2889%)
Scaling by  100
Scaled Norm after poisoning: 622.0726695893334, distance: 622.7861039313578
Total norm for 4 adversaries is: 622.0726695893334. distance: 622.7861039313578
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 480/527 (91.0816%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   2,  Average loss: 0.0013, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   3,  Average loss: 0.0009, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   4,  Average loss: 0.0016, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   5,  Average loss: 0.0009, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   6,  Average loss: 0.0008, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Global model norm: 37.79942794447672.
Norm before scaling: 38.05324157461408. Distance: 6.378748969471
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.9517, Accuracy: 5068/10000 (50.6800%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.1583, Accuracy: 8695/9000 (96.6111%)
Scaling by  100
Scaled Norm after poisoning: 637.3142866749497, distance: 637.8748897707136
Total norm for 4 adversaries is: 637.3142866749497. distance: 637.8748897707136
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   1,  Average loss: 0.0121, Accuracy: 359/496 (72.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   2,  Average loss: 0.0020, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   3,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.79942794447672.
Norm before scaling: 37.99339638602098. Distance: 6.052183517003291
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.2544, Accuracy: 6265/10000 (62.6500%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.1220, Accuracy: 8724/9000 (96.9333%)
Scaling by  100
Scaled Norm after poisoning: 604.58689408554, distance: 605.2183748449811
Total norm for 4 adversaries is: 604.58689408554. distance: 605.2183748449811
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   1,  Average loss: 0.0095, Accuracy: 440/546 (80.5861%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   2,  Average loss: 0.0026, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   3,  Average loss: 0.0014, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   4,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.79942794447672.
Norm before scaling: 38.21990620695909. Distance: 7.4835268308548875
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.4294, Accuracy: 6074/10000 (60.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.1277, Accuracy: 8724/9000 (96.9333%)
Scaling by  100
Scaled Norm after poisoning: 747.7008509424073, distance: 748.3525656400197
Total norm for 4 adversaries is: 747.7008509424073. distance: 748.3525656400197
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 204, local model 49, internal_epoch   1,  Average loss: 0.0375, Accuracy: 228/426 (53.5211%)
___Train Local_ResNet_18,  epoch 204, local model 49, internal_epoch   2,  Average loss: 0.0107, Accuracy: 353/426 (82.8638%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 19.6635, Accuracy: 1609/10000 (16.0900%)
___Train Local_ResNet_18,  epoch 204, local model 86, internal_epoch   1,  Average loss: 0.0448, Accuracy: 117/212 (55.1887%)
___Train Local_ResNet_18,  epoch 204, local model 86, internal_epoch   2,  Average loss: 0.0099, Accuracy: 176/212 (83.0189%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 19.9182, Accuracy: 1020/10000 (10.2000%)
___Train Local_ResNet_18,  epoch 204, local model 26, internal_epoch   1,  Average loss: 0.0321, Accuracy: 249/468 (53.2051%)
___Train Local_ResNet_18,  epoch 204, local model 26, internal_epoch   2,  Average loss: 0.0143, Accuracy: 346/468 (73.9316%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 7.0636, Accuracy: 2480/10000 (24.8000%)
___Train Local_ResNet_18,  epoch 204, local model 58, internal_epoch   1,  Average loss: 0.0593, Accuracy: 80/234 (34.1880%)
___Train Local_ResNet_18,  epoch 204, local model 58, internal_epoch   2,  Average loss: 0.0089, Accuracy: 202/234 (86.3248%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 29.3172, Accuracy: 1003/10000 (10.0300%)
___Train Local_ResNet_18,  epoch 204, local model 6, internal_epoch   1,  Average loss: 0.0328, Accuracy: 296/520 (56.9231%)
___Train Local_ResNet_18,  epoch 204, local model 6, internal_epoch   2,  Average loss: 0.0170, Accuracy: 356/520 (68.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 27.9695, Accuracy: 1111/10000 (11.1100%)
___Train Local_ResNet_18,  epoch 204, local model 94, internal_epoch   1,  Average loss: 0.0527, Accuracy: 100/203 (49.2611%)
___Train Local_ResNet_18,  epoch 204, local model 94, internal_epoch   2,  Average loss: 0.0182, Accuracy: 154/203 (75.8621%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 343.29601430892944
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.5038480038480039  data num: [526, 527, 496, 546, 426, 212, 468, 234, 520, 203]
[rfa agg] considering poison per batch poison_fraction: 0.0393631253006253
[rfa agg] init. name: [17, 33, 77, 11, 49, 86, 26, 58, 6, 94], weight: tensor([0.1265, 0.1267, 0.1193, 0.1313, 0.1025, 0.0510, 0.1126, 0.0563, 0.1251,
        0.0488])
[rfa agg] iter:  0, prev_obj_val: 11737.2265625, obj_val: 11736.7734375, abs dis: 0.453125
[rfa agg] iter:  0, weight: tensor([0.1200, 0.1202, 0.1446, 0.1245, 0.1013, 0.0503, 0.1114, 0.0555, 0.1239,
        0.0482])
[rfa agg] iter:  1, prev_obj_val: 11736.7734375, obj_val: 11736.33203125, abs dis: 0.44140625
[rfa agg] iter:  1, weight: tensor([0.1206, 0.1208, 0.1456, 0.1251, 0.1008, 0.0500, 0.1108, 0.0552, 0.1232,
        0.0479])
[rfa agg] iter:  2, prev_obj_val: 11736.33203125, obj_val: 11735.890625, abs dis: 0.44140625
[rfa agg] iter:  2, weight: tensor([0.1212, 0.1214, 0.1465, 0.1257, 0.1002, 0.0498, 0.1102, 0.0549, 0.1225,
        0.0476])
[rfa agg] iter:  3, prev_obj_val: 11735.890625, obj_val: 11735.453125, abs dis: 0.4375
[rfa agg] iter:  3, weight: tensor([0.1218, 0.1220, 0.1474, 0.1263, 0.0997, 0.0495, 0.1096, 0.0546, 0.1218,
        0.0474])
[rfa agg] iter:  4, prev_obj_val: 11735.453125, obj_val: 11735.013671875, abs dis: 0.439453125
[rfa agg] iter:  4, weight: tensor([0.1223, 0.1226, 0.1483, 0.1269, 0.0991, 0.0492, 0.1090, 0.0543, 0.1212,
        0.0471])
[rfa agg] iter:  5, prev_obj_val: 11735.013671875, obj_val: 11734.6083984375, abs dis: 0.4052734375
[rfa agg] iter:  5, weight: tensor([0.1229, 0.1231, 0.1493, 0.1275, 0.0985, 0.0489, 0.1083, 0.0540, 0.1205,
        0.0469])
[rfa agg] iter:  6, prev_obj_val: 11734.6083984375, obj_val: 11734.2001953125, abs dis: 0.408203125
[rfa agg] iter:  6, weight: tensor([0.1235, 0.1237, 0.1501, 0.1281, 0.0980, 0.0487, 0.1078, 0.0537, 0.1198,
        0.0466])
[rfa agg] iter:  7, prev_obj_val: 11734.2001953125, obj_val: 11733.7939453125, abs dis: 0.40625
[rfa agg] iter:  7, weight: tensor([0.1240, 0.1242, 0.1510, 0.1286, 0.0975, 0.0484, 0.1072, 0.0534, 0.1192,
        0.0464])
[rfa agg] iter:  8, prev_obj_val: 11733.7939453125, obj_val: 11733.388671875, abs dis: 0.4052734375
[rfa agg] iter:  8, weight: tensor([0.1245, 0.1248, 0.1519, 0.1292, 0.0970, 0.0482, 0.1066, 0.0532, 0.1186,
        0.0461])
[rfa agg] iter:  9, prev_obj_val: 11733.388671875, obj_val: 11732.953125, abs dis: 0.435546875
[rfa agg] iter:  9, weight: tensor([0.1251, 0.1253, 0.1527, 0.1297, 0.0965, 0.0479, 0.1061, 0.0529, 0.1179,
        0.0459])
___Test Target_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 462.0992064476013 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:205 choose agents : [17, 33, 77, 11, 61, 71, 8, 69, 89, 64]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   1,  Average loss: 0.0507, Accuracy: 252/526 (47.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   2,  Average loss: 0.0223, Accuracy: 329/526 (62.5475%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   3,  Average loss: 0.0131, Accuracy: 403/526 (76.6160%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   4,  Average loss: 0.0080, Accuracy: 450/526 (85.5513%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   5,  Average loss: 0.0057, Accuracy: 485/526 (92.2053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   6,  Average loss: 0.0035, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Global model norm: 41.79122041189543.
Norm before scaling: 42.58909405724883. Distance: 11.037345606932629
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.6430, Accuracy: 3457/10000 (34.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.1823, Accuracy: 8473/9000 (94.1444%)
Scaling by  100
Scaled Norm after poisoning: 1102.0557494972747, distance: 1103.734569541065
Total norm for 4 adversaries is: 1102.0557494972747. distance: 1103.734569541065
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   1,  Average loss: 0.0619, Accuracy: 169/527 (32.0683%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   2,  Average loss: 0.0230, Accuracy: 285/527 (54.0797%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   3,  Average loss: 0.0162, Accuracy: 375/527 (71.1575%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   4,  Average loss: 0.0108, Accuracy: 430/527 (81.5939%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   5,  Average loss: 0.0058, Accuracy: 486/527 (92.2201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   6,  Average loss: 0.0047, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Global model norm: 41.79122041189543.
Norm before scaling: 42.60191995655096. Distance: 11.532393897573437
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 3.4510, Accuracy: 2774/10000 (27.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.5517, Accuracy: 7581/9000 (84.2333%)
Scaling by  100
Scaled Norm after poisoning: 1151.1948683867558, distance: 1153.239404893884
Total norm for 4 adversaries is: 1151.1948683867558. distance: 1153.239404893884
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   1,  Average loss: 0.0552, Accuracy: 172/496 (34.6774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   2,  Average loss: 0.0272, Accuracy: 250/496 (50.4032%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   3,  Average loss: 0.0170, Accuracy: 324/496 (65.3226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   4,  Average loss: 0.0115, Accuracy: 385/496 (77.6210%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   5,  Average loss: 0.0055, Accuracy: 456/496 (91.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   6,  Average loss: 0.0024, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Global model norm: 41.79122041189543.
Norm before scaling: 42.51321457013028. Distance: 10.59437833739937
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.2494, Accuracy: 3433/10000 (34.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.1692, Accuracy: 8477/9000 (94.1889%)
Scaling by  100
Scaled Norm after poisoning: 1057.836294045539, distance: 1059.437763627482
Total norm for 4 adversaries is: 1057.836294045539. distance: 1059.437763627482
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   1,  Average loss: 0.0464, Accuracy: 246/546 (45.0549%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   2,  Average loss: 0.0235, Accuracy: 271/546 (49.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   3,  Average loss: 0.0156, Accuracy: 383/546 (70.1465%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   4,  Average loss: 0.0081, Accuracy: 473/546 (86.6300%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   5,  Average loss: 0.0042, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   6,  Average loss: 0.0017, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Global model norm: 41.79122041189543.
Norm before scaling: 42.369491714262985. Distance: 9.889597859012685
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.2876, Accuracy: 3430/10000 (34.3000%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.2035, Accuracy: 8321/9000 (92.4556%)
Scaling by  100
Scaled Norm after poisoning: 987.3572681658853, distance: 988.9598702677475
Total norm for 4 adversaries is: 987.3572681658853. distance: 988.9598702677475
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 205, local model 61, internal_epoch   1,  Average loss: 0.0303, Accuracy: 318/590 (53.8983%)
___Train Local_ResNet_18,  epoch 205, local model 61, internal_epoch   2,  Average loss: 0.0151, Accuracy: 386/590 (65.4237%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 14.5920, Accuracy: 1753/10000 (17.5300%)
___Train Local_ResNet_18,  epoch 205, local model 71, internal_epoch   1,  Average loss: 0.0304, Accuracy: 606/1166 (51.9726%)
___Train Local_ResNet_18,  epoch 205, local model 71, internal_epoch   2,  Average loss: 0.0181, Accuracy: 740/1166 (63.4648%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.9393, Accuracy: 2486/10000 (24.8600%)
___Train Local_ResNet_18,  epoch 205, local model 8, internal_epoch   1,  Average loss: 0.0468, Accuracy: 219/534 (41.0112%)
___Train Local_ResNet_18,  epoch 205, local model 8, internal_epoch   2,  Average loss: 0.0253, Accuracy: 268/534 (50.1873%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 69, internal_epoch   1,  Average loss: 0.0393, Accuracy: 112/216 (51.8519%)
___Train Local_ResNet_18,  epoch 205, local model 69, internal_epoch   2,  Average loss: 0.0223, Accuracy: 160/216 (74.0741%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 89, internal_epoch   1,  Average loss: 0.0484, Accuracy: 178/413 (43.0993%)
___Train Local_ResNet_18,  epoch 205, local model 89, internal_epoch   2,  Average loss: 0.0167, Accuracy: 276/413 (66.8281%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 64, internal_epoch   1,  Average loss: 0.0362, Accuracy: 331/686 (48.2507%)
___Train Local_ResNet_18,  epoch 205, local model 64, internal_epoch   2,  Average loss: 0.0178, Accuracy: 424/686 (61.8076%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 348.3979811668396
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3675438596491228  data num: [526, 527, 496, 546, 590, 1166, 534, 216, 413, 686]
[rfa agg] considering poison per batch poison_fraction: 0.028714364035087717
[rfa agg] init. name: [17, 33, 77, 11, 61, 71, 8, 69, 89, 64], weight: tensor([0.0923, 0.0925, 0.0870, 0.0958, 0.1035, 0.2046, 0.0937, 0.0379, 0.0725,
        0.1204])
[rfa agg] iter:  0, prev_obj_val: 10927.7548828125, obj_val: 10202.7255859375, abs dis: 725.029296875
[rfa agg] iter:  0, weight: tensor([0.0604, 0.0605, 0.0688, 0.0628, 0.1220, 0.2435, 0.1103, 0.0444, 0.0852,
        0.1420])
[rfa agg] iter:  1, prev_obj_val: 10202.7255859375, obj_val: 9647.458984375, abs dis: 555.2666015625
[rfa agg] iter:  1, weight: tensor([0.0393, 0.0394, 0.0435, 0.0409, 0.1365, 0.2735, 0.1234, 0.0495, 0.0951,
        0.1589])
[rfa agg] iter:  2, prev_obj_val: 9647.458984375, obj_val: 9261.580078125, abs dis: 385.87890625
[rfa agg] iter:  2, weight: tensor([0.0244, 0.0245, 0.0266, 0.0254, 0.1464, 0.2955, 0.1322, 0.0528, 0.1017,
        0.1706])
[rfa agg] iter:  3, prev_obj_val: 9261.580078125, obj_val: 9010.3916015625, abs dis: 251.1884765625
[rfa agg] iter:  3, weight: tensor([0.0147, 0.0147, 0.0158, 0.0153, 0.1524, 0.3118, 0.1374, 0.0545, 0.1055,
        0.1778])
[rfa agg] iter:  4, prev_obj_val: 9010.3916015625, obj_val: 8856.9091796875, abs dis: 153.482421875
[rfa agg] iter:  4, weight: tensor([0.0086, 0.0086, 0.0092, 0.0089, 0.1555, 0.3259, 0.1398, 0.0548, 0.1068,
        0.1819])
[rfa agg] iter:  5, prev_obj_val: 8856.9091796875, obj_val: 8761.9462890625, abs dis: 94.962890625
[rfa agg] iter:  5, weight: tensor([0.0050, 0.0050, 0.0053, 0.0052, 0.1560, 0.3412, 0.1397, 0.0536, 0.1058,
        0.1833])
[rfa agg] iter:  6, prev_obj_val: 8761.9462890625, obj_val: 8707.7080078125, abs dis: 54.23828125
[rfa agg] iter:  6, weight: tensor([0.0028, 0.0028, 0.0029, 0.0029, 0.1535, 0.3647, 0.1364, 0.0504, 0.1017,
        0.1819])
[rfa agg] iter:  7, prev_obj_val: 8707.7080078125, obj_val: 8675.876953125, abs dis: 31.8310546875
[rfa agg] iter:  7, weight: tensor([0.0015, 0.0015, 0.0016, 0.0015, 0.1459, 0.4075, 0.1280, 0.0444, 0.0929,
        0.1753])
[rfa agg] iter:  8, prev_obj_val: 8675.876953125, obj_val: 8664.4501953125, abs dis: 11.4267578125
[rfa agg] iter:  8, weight: tensor([0.0007, 0.0007, 0.0007, 0.0007, 0.1238, 0.5082, 0.1060, 0.0330, 0.0733,
        0.1529])
[rfa agg] iter:  9, prev_obj_val: 8664.4501953125, obj_val: 8667.2880859375, abs dis: 2.837890625
[rfa agg] iter:  9, weight: tensor([3.1101e-04, 3.1163e-04, 3.3009e-04, 3.2306e-04, 9.6662e-02, 6.2388e-01,
        8.0540e-02, 2.1918e-02, 5.2127e-02, 1.2360e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 487.6360762119293 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:206 choose agents : [17, 33, 77, 11, 38, 64, 29, 23, 83, 43]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   1,  Average loss: 0.0359, Accuracy: 289/526 (54.9430%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   2,  Average loss: 0.0175, Accuracy: 353/526 (67.1103%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   3,  Average loss: 0.0124, Accuracy: 408/526 (77.5665%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   4,  Average loss: 0.0077, Accuracy: 458/526 (87.0722%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   5,  Average loss: 0.0062, Accuracy: 487/526 (92.5856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   6,  Average loss: 0.0039, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Global model norm: 41.71234735512975.
Norm before scaling: 42.19553742881171. Distance: 9.173484855923373
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.4265, Accuracy: 3737/10000 (37.3700%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.2456, Accuracy: 8268/9000 (91.8667%)
Scaling by  100
Scaled Norm after poisoning: 915.9187668674554, distance: 917.3484547869474
Total norm for 4 adversaries is: 915.9187668674554. distance: 917.3484547869474
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   1,  Average loss: 0.0466, Accuracy: 214/527 (40.6072%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   2,  Average loss: 0.0225, Accuracy: 282/527 (53.5104%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   3,  Average loss: 0.0135, Accuracy: 386/527 (73.2448%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   4,  Average loss: 0.0075, Accuracy: 456/527 (86.5275%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   5,  Average loss: 0.0042, Accuracy: 497/527 (94.3074%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   6,  Average loss: 0.0019, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Global model norm: 41.71234735512975.
Norm before scaling: 42.20999978715056. Distance: 9.33752560695012
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.5694, Accuracy: 3870/10000 (38.7000%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.2493, Accuracy: 8236/9000 (91.5111%)
Scaling by  100
Scaled Norm after poisoning: 932.2506033787267, distance: 933.752510036787
Total norm for 4 adversaries is: 932.2506033787267. distance: 933.752510036787
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   1,  Average loss: 0.0363, Accuracy: 227/496 (45.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   2,  Average loss: 0.0189, Accuracy: 300/496 (60.4839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   3,  Average loss: 0.0108, Accuracy: 397/496 (80.0403%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   4,  Average loss: 0.0064, Accuracy: 440/496 (88.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   5,  Average loss: 0.0025, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   6,  Average loss: 0.0014, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Global model norm: 41.71234735512975.
Norm before scaling: 42.0472204788854. Distance: 8.09950740870529
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 1.8576, Accuracy: 4244/10000 (42.4400%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.1053, Accuracy: 8686/9000 (96.5111%)
Scaling by  100
Scaled Norm after poisoning: 808.7057561313633, distance: 809.9508472740799
Total norm for 4 adversaries is: 808.7057561313633. distance: 809.9508472740799
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   1,  Average loss: 0.0324, Accuracy: 300/546 (54.9451%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   2,  Average loss: 0.0160, Accuracy: 382/546 (69.9634%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   3,  Average loss: 0.0094, Accuracy: 454/546 (83.1502%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   4,  Average loss: 0.0037, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   5,  Average loss: 0.0018, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   6,  Average loss: 0.0016, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Global model norm: 41.71234735512975.
Norm before scaling: 42.01204399717196. Distance: 7.970550692689092
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.1782, Accuracy: 4105/10000 (41.0500%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.1475, Accuracy: 8568/9000 (95.2000%)
Scaling by  100
Scaled Norm after poisoning: 795.7342128499943, distance: 797.0550874939573
Total norm for 4 adversaries is: 795.7342128499943. distance: 797.0550874939573
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 206, local model 38, internal_epoch   1,  Average loss: 0.0255, Accuracy: 403/756 (53.3069%)
___Train Local_ResNet_18,  epoch 206, local model 38, internal_epoch   2,  Average loss: 0.0143, Accuracy: 534/756 (70.6349%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 3.7212, Accuracy: 2856/10000 (28.5600%)
___Train Local_ResNet_18,  epoch 206, local model 64, internal_epoch   1,  Average loss: 0.0251, Accuracy: 373/686 (54.3732%)
___Train Local_ResNet_18,  epoch 206, local model 64, internal_epoch   2,  Average loss: 0.0139, Accuracy: 484/686 (70.5539%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.9759, Accuracy: 3061/10000 (30.6100%)
___Train Local_ResNet_18,  epoch 206, local model 29, internal_epoch   1,  Average loss: 0.0205, Accuracy: 589/848 (69.4575%)
___Train Local_ResNet_18,  epoch 206, local model 29, internal_epoch   2,  Average loss: 0.0110, Accuracy: 658/848 (77.5943%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 14.1677, Accuracy: 1380/10000 (13.8000%)
___Train Local_ResNet_18,  epoch 206, local model 23, internal_epoch   1,  Average loss: 0.0352, Accuracy: 119/248 (47.9839%)
___Train Local_ResNet_18,  epoch 206, local model 23, internal_epoch   2,  Average loss: 0.0142, Accuracy: 177/248 (71.3710%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 83, internal_epoch   1,  Average loss: 0.0327, Accuracy: 168/366 (45.9016%)
___Train Local_ResNet_18,  epoch 206, local model 83, internal_epoch   2,  Average loss: 0.0136, Accuracy: 260/366 (71.0383%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 43, internal_epoch   1,  Average loss: 0.0352, Accuracy: 182/345 (52.7536%)
___Train Local_ResNet_18,  epoch 206, local model 43, internal_epoch   2,  Average loss: 0.0162, Accuracy: 241/345 (69.8551%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 380.2176299095154
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.39202844311377244  data num: [526, 527, 496, 546, 756, 686, 848, 248, 366, 345]
[rfa agg] considering poison per batch poison_fraction: 0.03062722211826347
[rfa agg] init. name: [17, 33, 77, 11, 38, 64, 29, 23, 83, 43], weight: tensor([0.0984, 0.0986, 0.0928, 0.1022, 0.1415, 0.1284, 0.1587, 0.0464, 0.0685,
        0.0646])
[rfa agg] iter:  0, prev_obj_val: 11194.91015625, obj_val: 10689.154296875, abs dis: 505.755859375
[rfa agg] iter:  0, weight: tensor([0.0701, 0.0702, 0.0806, 0.0728, 0.1646, 0.1492, 0.1850, 0.0536, 0.0792,
        0.0747])
[rfa agg] iter:  1, prev_obj_val: 10689.154296875, obj_val: 10269.0947265625, abs dis: 420.0595703125
[rfa agg] iter:  1, weight: tensor([0.0506, 0.0506, 0.0565, 0.0525, 0.1842, 0.1669, 0.2071, 0.0598, 0.0885,
        0.0834])
[rfa agg] iter:  2, prev_obj_val: 10269.0947265625, obj_val: 9942.3037109375, abs dis: 326.791015625
[rfa agg] iter:  2, weight: tensor([0.0352, 0.0353, 0.0386, 0.0366, 0.1994, 0.1806, 0.2244, 0.0645, 0.0955,
        0.0900])
[rfa agg] iter:  3, prev_obj_val: 9942.3037109375, obj_val: 9702.8388671875, abs dis: 239.46484375
[rfa agg] iter:  3, weight: tensor([0.0239, 0.0239, 0.0258, 0.0248, 0.2107, 0.1907, 0.2376, 0.0677, 0.1004,
        0.0946])
[rfa agg] iter:  4, prev_obj_val: 9702.8388671875, obj_val: 9534.1787109375, abs dis: 168.66015625
[rfa agg] iter:  4, weight: tensor([0.0158, 0.0158, 0.0170, 0.0164, 0.2189, 0.1978, 0.2475, 0.0696, 0.1035,
        0.0976])
[rfa agg] iter:  5, prev_obj_val: 9534.1787109375, obj_val: 9418.849609375, abs dis: 115.3291015625
[rfa agg] iter:  5, weight: tensor([0.0103, 0.0103, 0.0110, 0.0107, 0.2249, 0.2029, 0.2553, 0.0704, 0.1051,
        0.0991])
[rfa agg] iter:  6, prev_obj_val: 9418.849609375, obj_val: 9341.3330078125, abs dis: 77.5166015625
[rfa agg] iter:  6, weight: tensor([0.0066, 0.0066, 0.0070, 0.0068, 0.2296, 0.2064, 0.2624, 0.0701, 0.1052,
        0.0992])
[rfa agg] iter:  7, prev_obj_val: 9341.3330078125, obj_val: 9291.9326171875, abs dis: 49.400390625
[rfa agg] iter:  7, weight: tensor([0.0041, 0.0041, 0.0044, 0.0043, 0.2338, 0.2090, 0.2702, 0.0684, 0.1038,
        0.0979])
[rfa agg] iter:  8, prev_obj_val: 9291.9326171875, obj_val: 9258.09375, abs dis: 33.8388671875
[rfa agg] iter:  8, weight: tensor([0.0026, 0.0026, 0.0027, 0.0027, 0.2379, 0.2107, 0.2803, 0.0653, 0.1005,
        0.0947])
[rfa agg] iter:  9, prev_obj_val: 9258.09375, obj_val: 9237.869140625, abs dis: 20.224609375
[rfa agg] iter:  9, weight: tensor([0.0015, 0.0015, 0.0016, 0.0016, 0.2431, 0.2116, 0.2975, 0.0595, 0.0938,
        0.0884])
___Test Target_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 511.5873248577118 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:207 choose agents : [17, 33, 77, 11, 56, 45, 1, 50, 16, 12]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   1,  Average loss: 0.0291, Accuracy: 318/526 (60.4563%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   2,  Average loss: 0.0171, Accuracy: 378/526 (71.8631%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   3,  Average loss: 0.0092, Accuracy: 454/526 (86.3118%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   4,  Average loss: 0.0055, Accuracy: 484/526 (92.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   5,  Average loss: 0.0025, Accuracy: 508/526 (96.5779%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   6,  Average loss: 0.0031, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Global model norm: 41.64616080698121.
Norm before scaling: 42.27631565350007. Distance: 9.461010883024654
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.1753, Accuracy: 4299/10000 (42.9900%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.0524, Accuracy: 8850/9000 (98.3333%)
Scaling by  100
Scaled Norm after poisoning: 945.0815771667544, distance: 946.1011772004091
Total norm for 4 adversaries is: 945.0815771667544. distance: 946.1011772004091
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   1,  Average loss: 0.0341, Accuracy: 268/527 (50.8539%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   2,  Average loss: 0.0196, Accuracy: 340/527 (64.5161%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   3,  Average loss: 0.0105, Accuracy: 434/527 (82.3529%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   4,  Average loss: 0.0058, Accuracy: 472/527 (89.5636%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   5,  Average loss: 0.0030, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   6,  Average loss: 0.0023, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Global model norm: 41.64616080698121.
Norm before scaling: 42.177685490319554. Distance: 9.149163846859432
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.6602, Accuracy: 3774/10000 (37.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.1793, Accuracy: 8482/9000 (94.2444%)
Scaling by  100
Scaled Norm after poisoning: 913.7238026340344, distance: 914.9165262470669
Total norm for 4 adversaries is: 913.7238026340344. distance: 914.9165262470669
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   1,  Average loss: 0.0302, Accuracy: 258/496 (52.0161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   2,  Average loss: 0.0122, Accuracy: 370/496 (74.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   3,  Average loss: 0.0061, Accuracy: 439/496 (88.5081%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   4,  Average loss: 0.0028, Accuracy: 479/496 (96.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 41.64616080698121.
Norm before scaling: 41.84407527646163. Distance: 7.0933431769185615
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.0216, Accuracy: 4429/10000 (44.2900%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.1601, Accuracy: 8640/9000 (96.0000%)
Scaling by  100
Scaled Norm after poisoning: 708.1740825884551, distance: 709.3343490555071
Total norm for 4 adversaries is: 708.1740825884551. distance: 709.3343490555071
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   1,  Average loss: 0.0272, Accuracy: 312/546 (57.1429%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   2,  Average loss: 0.0119, Accuracy: 420/546 (76.9231%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   3,  Average loss: 0.0053, Accuracy: 496/546 (90.8425%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   4,  Average loss: 0.0022, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 41.64616080698121.
Norm before scaling: 41.80034448217054. Distance: 6.973598281952214
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.1300, Accuracy: 4457/10000 (44.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.1310, Accuracy: 8598/9000 (95.5333%)
Scaling by  100
Scaled Norm after poisoning: 696.0378267378865, distance: 697.35986495496
Total norm for 4 adversaries is: 696.0378267378865. distance: 697.35986495496
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 207, local model 56, internal_epoch   1,  Average loss: 0.0220, Accuracy: 441/743 (59.3540%)
___Train Local_ResNet_18,  epoch 207, local model 56, internal_epoch   2,  Average loss: 0.0104, Accuracy: 591/743 (79.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 45, internal_epoch   1,  Average loss: 0.0291, Accuracy: 294/529 (55.5766%)
___Train Local_ResNet_18,  epoch 207, local model 45, internal_epoch   2,  Average loss: 0.0164, Accuracy: 370/529 (69.9433%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   1,  Average loss: 0.0180, Accuracy: 426/641 (66.4587%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   2,  Average loss: 0.0124, Accuracy: 517/641 (80.6552%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.5460, Accuracy: 3788/10000 (37.8800%)
___Train Local_ResNet_18,  epoch 207, local model 50, internal_epoch   1,  Average loss: 0.0203, Accuracy: 280/401 (69.8254%)
___Train Local_ResNet_18,  epoch 207, local model 50, internal_epoch   2,  Average loss: 0.0107, Accuracy: 320/401 (79.8005%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 16, internal_epoch   1,  Average loss: 0.0268, Accuracy: 444/773 (57.4386%)
___Train Local_ResNet_18,  epoch 207, local model 16, internal_epoch   2,  Average loss: 0.0185, Accuracy: 491/773 (63.5188%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.8686, Accuracy: 2633/10000 (26.3300%)
___Train Local_ResNet_18,  epoch 207, local model 12, internal_epoch   1,  Average loss: 0.0271, Accuracy: 534/977 (54.6571%)
___Train Local_ResNet_18,  epoch 207, local model 12, internal_epoch   2,  Average loss: 0.0136, Accuracy: 689/977 (70.5220%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.6366, Accuracy: 2822/10000 (28.2200%)
time spent on training: 354.60154938697815
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.34015262217892517  data num: [526, 527, 496, 546, 743, 529, 641, 401, 773, 977]
[rfa agg] considering poison per batch poison_fraction: 0.026574423607728527
[rfa agg] init. name: [17, 33, 77, 11, 56, 45, 1, 50, 16, 12], weight: tensor([0.0854, 0.0856, 0.0805, 0.0887, 0.1206, 0.0859, 0.1041, 0.0651, 0.1255,
        0.1586])
[rfa agg] iter:  0, prev_obj_val: 10525.841796875, obj_val: 9542.1787109375, abs dis: 983.6630859375
[rfa agg] iter:  0, weight: tensor([0.0503, 0.0504, 0.0570, 0.0523, 0.1444, 0.1025, 0.1244, 0.0775, 0.1504,
        0.1907])
[rfa agg] iter:  1, prev_obj_val: 9542.1787109375, obj_val: 8869.8681640625, abs dis: 672.310546875
[rfa agg] iter:  1, weight: tensor([0.0289, 0.0290, 0.0317, 0.0301, 0.1609, 0.1139, 0.1386, 0.0860, 0.1677,
        0.2131])
[rfa agg] iter:  2, prev_obj_val: 8869.8681640625, obj_val: 8461.3916015625, abs dis: 408.4765625
[rfa agg] iter:  2, weight: tensor([0.0158, 0.0158, 0.0170, 0.0164, 0.1709, 0.1205, 0.1469, 0.0908, 0.1783,
        0.2276])
[rfa agg] iter:  3, prev_obj_val: 8461.3916015625, obj_val: 8229.2431640625, abs dis: 232.1484375
[rfa agg] iter:  3, weight: tensor([0.0083, 0.0083, 0.0089, 0.0086, 0.1764, 0.1234, 0.1513, 0.0925, 0.1846,
        0.2376])
[rfa agg] iter:  4, prev_obj_val: 8229.2431640625, obj_val: 8101.75341796875, abs dis: 127.48974609375
[rfa agg] iter:  4, weight: tensor([0.0042, 0.0042, 0.0045, 0.0044, 0.1792, 0.1234, 0.1529, 0.0915, 0.1886,
        0.2470])
[rfa agg] iter:  5, prev_obj_val: 8101.75341796875, obj_val: 8038.79296875, abs dis: 62.96044921875
[rfa agg] iter:  5, weight: tensor([0.0020, 0.0021, 0.0022, 0.0021, 0.1800, 0.1198, 0.1518, 0.0870, 0.1918,
        0.2613])
[rfa agg] iter:  6, prev_obj_val: 8038.79296875, obj_val: 8006.16650390625, abs dis: 32.62646484375
[rfa agg] iter:  6, weight: tensor([0.0010, 0.0010, 0.0010, 0.0010, 0.1778, 0.1105, 0.1463, 0.0772, 0.1943,
        0.2900])
[rfa agg] iter:  7, prev_obj_val: 8006.16650390625, obj_val: 7993.01953125, abs dis: 13.14697265625
[rfa agg] iter:  7, weight: tensor([0.0004, 0.0004, 0.0004, 0.0004, 0.1628, 0.0872, 0.1265, 0.0567, 0.1893,
        0.3759])
[rfa agg] iter:  8, prev_obj_val: 7993.01953125, obj_val: 7996.3876953125, abs dis: 3.3681640625
[rfa agg] iter:  8, weight: tensor([1.3170e-04, 1.3196e-04, 1.3984e-04, 1.3682e-04, 1.8046e-01, 6.3084e-02,
        1.1589e-01, 3.5521e-02, 2.5627e-01, 3.4823e-01])
[rfa agg] iter:  9, prev_obj_val: 7996.3876953125, obj_val: 8002.7626953125, abs dis: 6.375
[rfa agg] iter:  9, weight: tensor([9.7228e-05, 9.7416e-05, 1.0323e-04, 1.0100e-04, 3.2092e-01, 8.0759e-02,
        2.0037e-01, 3.8788e-02, 2.4250e-01, 1.1626e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 471.0188989639282 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:208 choose agents : [17, 33, 77, 11, 44, 86, 20, 50, 49, 43]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   1,  Average loss: 0.0232, Accuracy: 340/526 (64.6388%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   2,  Average loss: 0.0128, Accuracy: 410/526 (77.9468%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   3,  Average loss: 0.0073, Accuracy: 460/526 (87.4525%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   4,  Average loss: 0.0054, Accuracy: 492/526 (93.5361%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   5,  Average loss: 0.0045, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   6,  Average loss: 0.0034, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Global model norm: 41.608971611356694.
Norm before scaling: 42.090541068759585. Distance: 8.62305019287875
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.3102, Accuracy: 4313/10000 (43.1300%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.3916, Accuracy: 7932/9000 (88.1333%)
Scaling by  100
Scaled Norm after poisoning: 861.3340670146514, distance: 862.3050866717649
Total norm for 4 adversaries is: 861.3340670146514. distance: 862.3050866717649
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   1,  Average loss: 0.0321, Accuracy: 282/527 (53.5104%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   2,  Average loss: 0.0171, Accuracy: 349/527 (66.2239%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   3,  Average loss: 0.0091, Accuracy: 425/527 (80.6452%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   4,  Average loss: 0.0040, Accuracy: 492/527 (93.3586%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   5,  Average loss: 0.0024, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   6,  Average loss: 0.0015, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Global model norm: 41.608971611356694.
Norm before scaling: 42.333932787237885. Distance: 9.611713304807244
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.7405, Accuracy: 3982/10000 (39.8200%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.3047, Accuracy: 8234/9000 (91.4889%)
Scaling by  100
Scaled Norm after poisoning: 960.4314134804213, distance: 961.1712256408845
Total norm for 4 adversaries is: 960.4314134804213. distance: 961.1712256408845
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   1,  Average loss: 0.0274, Accuracy: 271/496 (54.6371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   2,  Average loss: 0.0115, Accuracy: 372/496 (75.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   3,  Average loss: 0.0053, Accuracy: 449/496 (90.5242%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   4,  Average loss: 0.0024, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   5,  Average loss: 0.0014, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 41.608971611356694.
Norm before scaling: 41.781441367830254. Distance: 6.7662330688963825
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.8625, Accuracy: 4751/10000 (47.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.1892, Accuracy: 8485/9000 (94.2778%)
Scaling by  100
Scaled Norm after poisoning: 675.5815781606245, distance: 676.6233488803058
Total norm for 4 adversaries is: 675.5815781606245. distance: 676.6233488803058
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   1,  Average loss: 0.0234, Accuracy: 344/546 (63.0037%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   2,  Average loss: 0.0096, Accuracy: 454/546 (83.1502%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   3,  Average loss: 0.0048, Accuracy: 498/546 (91.2088%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   4,  Average loss: 0.0020, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 41.608971611356694.
Norm before scaling: 41.753331582547844. Distance: 6.777151530505397
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.1114, Accuracy: 4723/10000 (47.2300%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.6935, Accuracy: 7552/9000 (83.9111%)
Scaling by  100
Scaled Norm after poisoning: 676.490507139605, distance: 677.7150719513327
Total norm for 4 adversaries is: 676.490507139605. distance: 677.7150719513327
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 208, local model 44, internal_epoch   1,  Average loss: 0.0160, Accuracy: 289/436 (66.2844%)
___Train Local_ResNet_18,  epoch 208, local model 44, internal_epoch   2,  Average loss: 0.0065, Accuracy: 381/436 (87.3853%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 86, internal_epoch   1,  Average loss: 0.0407, Accuracy: 102/212 (48.1132%)
___Train Local_ResNet_18,  epoch 208, local model 86, internal_epoch   2,  Average loss: 0.0181, Accuracy: 156/212 (73.5849%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 20, internal_epoch   1,  Average loss: 0.0314, Accuracy: 183/362 (50.5525%)
___Train Local_ResNet_18,  epoch 208, local model 20, internal_epoch   2,  Average loss: 0.0139, Accuracy: 254/362 (70.1657%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 50, internal_epoch   1,  Average loss: 0.0210, Accuracy: 277/401 (69.0773%)
___Train Local_ResNet_18,  epoch 208, local model 50, internal_epoch   2,  Average loss: 0.0115, Accuracy: 311/401 (77.5561%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 49, internal_epoch   1,  Average loss: 0.0188, Accuracy: 280/426 (65.7277%)
___Train Local_ResNet_18,  epoch 208, local model 49, internal_epoch   2,  Average loss: 0.0076, Accuracy: 367/426 (86.1502%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 43, internal_epoch   1,  Average loss: 0.0225, Accuracy: 219/345 (63.4783%)
___Train Local_ResNet_18,  epoch 208, local model 43, internal_epoch   2,  Average loss: 0.0097, Accuracy: 285/345 (82.6087%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 345.0619966983795
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4898293196165537  data num: [526, 527, 496, 546, 436, 212, 362, 401, 426, 345]
[rfa agg] considering poison per batch poison_fraction: 0.03826791559504326
[rfa agg] init. name: [17, 33, 77, 11, 44, 86, 20, 50, 49, 43], weight: tensor([0.1230, 0.1232, 0.1160, 0.1277, 0.1019, 0.0496, 0.0846, 0.0938, 0.0996,
        0.0807])
[rfa agg] iter:  0, prev_obj_val: 11753.880859375, obj_val: 11748.1064453125, abs dis: 5.7744140625
[rfa agg] iter:  0, weight: tensor([0.1135, 0.1136, 0.1359, 0.1180, 0.1038, 0.0503, 0.0861, 0.0954, 0.1014,
        0.0820])
[rfa agg] iter:  1, prev_obj_val: 11748.1064453125, obj_val: 11742.4599609375, abs dis: 5.646484375
[rfa agg] iter:  1, weight: tensor([0.1110, 0.1110, 0.1321, 0.1153, 0.1061, 0.0515, 0.0880, 0.0976, 0.1036,
        0.0839])
[rfa agg] iter:  2, prev_obj_val: 11742.4599609375, obj_val: 11736.7294921875, abs dis: 5.73046875
[rfa agg] iter:  2, weight: tensor([0.1084, 0.1085, 0.1284, 0.1127, 0.1083, 0.0525, 0.0899, 0.0996, 0.1059,
        0.0857])
[rfa agg] iter:  3, prev_obj_val: 11736.7294921875, obj_val: 11731.10546875, abs dis: 5.6240234375
[rfa agg] iter:  3, weight: tensor([0.1059, 0.1059, 0.1248, 0.1100, 0.1106, 0.0537, 0.0918, 0.1018, 0.1081,
        0.0875])
[rfa agg] iter:  4, prev_obj_val: 11731.10546875, obj_val: 11725.3955078125, abs dis: 5.7099609375
[rfa agg] iter:  4, weight: tensor([0.1033, 0.1034, 0.1212, 0.1074, 0.1129, 0.0548, 0.0937, 0.1038, 0.1103,
        0.0893])
[rfa agg] iter:  5, prev_obj_val: 11725.3955078125, obj_val: 11719.884765625, abs dis: 5.5107421875
[rfa agg] iter:  5, weight: tensor([0.1007, 0.1008, 0.1176, 0.1047, 0.1152, 0.0559, 0.0955, 0.1059, 0.1125,
        0.0911])
[rfa agg] iter:  6, prev_obj_val: 11719.884765625, obj_val: 11714.3837890625, abs dis: 5.5009765625
[rfa agg] iter:  6, weight: tensor([0.0982, 0.0983, 0.1142, 0.1021, 0.1174, 0.0569, 0.0974, 0.1080, 0.1147,
        0.0928])
[rfa agg] iter:  7, prev_obj_val: 11714.3837890625, obj_val: 11708.8916015625, abs dis: 5.4921875
[rfa agg] iter:  7, weight: tensor([0.0957, 0.0958, 0.1108, 0.0995, 0.1196, 0.0580, 0.0992, 0.1100, 0.1169,
        0.0946])
[rfa agg] iter:  8, prev_obj_val: 11708.8916015625, obj_val: 11703.4033203125, abs dis: 5.48828125
[rfa agg] iter:  8, weight: tensor([0.0932, 0.0933, 0.1074, 0.0968, 0.1218, 0.0591, 0.1010, 0.1120, 0.1190,
        0.0963])
[rfa agg] iter:  9, prev_obj_val: 11703.4033203125, obj_val: 11697.9248046875, abs dis: 5.478515625
[rfa agg] iter:  9, weight: tensor([0.0907, 0.0907, 0.1041, 0.0942, 0.1240, 0.0601, 0.1029, 0.1141, 0.1212,
        0.0980])
___Test Target_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 485.2782726287842 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:209 choose agents : [17, 33, 77, 11, 28, 51, 4, 97, 85, 59]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   1,  Average loss: 0.0511, Accuracy: 170/526 (32.3194%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   2,  Average loss: 0.0270, Accuracy: 235/526 (44.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   3,  Average loss: 0.0219, Accuracy: 315/526 (59.8859%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   4,  Average loss: 0.0196, Accuracy: 334/526 (63.4981%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   5,  Average loss: 0.0140, Accuracy: 384/526 (73.0038%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   6,  Average loss: 0.0113, Accuracy: 392/526 (74.5247%), train_poison_data_count: 45
Global model norm: 44.48724936928909.
Norm before scaling: 44.62465259406088. Distance: 8.869522768619877
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 2.4693, Accuracy: 3295/10000 (32.9500%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.4680, Accuracy: 7759/9000 (86.2111%)
Scaling by  100
Scaled Norm after poisoning: 884.3195830693788, distance: 886.9523662519877
Total norm for 4 adversaries is: 884.3195830693788. distance: 886.9523662519877
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   1,  Average loss: 0.0327, Accuracy: 293/527 (55.5977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   2,  Average loss: 0.0163, Accuracy: 360/527 (68.3112%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   3,  Average loss: 0.0078, Accuracy: 442/527 (83.8710%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   4,  Average loss: 0.0050, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   5,  Average loss: 0.0022, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   6,  Average loss: 0.0025, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Global model norm: 44.48724936928909.
Norm before scaling: 44.54744908214793. Distance: 7.360991541373211
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 2.5487, Accuracy: 4107/10000 (41.0700%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.2304, Accuracy: 8396/9000 (93.2889%)
Scaling by  100
Scaled Norm after poisoning: 734.1244359779887, distance: 736.099135646823
Total norm for 4 adversaries is: 734.1244359779887. distance: 736.099135646823
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   1,  Average loss: 0.0481, Accuracy: 160/496 (32.2581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   2,  Average loss: 0.0292, Accuracy: 191/496 (38.5081%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   3,  Average loss: 0.0259, Accuracy: 225/496 (45.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   4,  Average loss: 0.0221, Accuracy: 239/496 (48.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   5,  Average loss: 0.0180, Accuracy: 306/496 (61.6935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   6,  Average loss: 0.0138, Accuracy: 372/496 (75.0000%), train_poison_data_count: 40
Global model norm: 44.48724936928909.
Norm before scaling: 44.52189320558342. Distance: 7.781205387830195
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 2.0520, Accuracy: 3326/10000 (33.2600%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.2320, Accuracy: 8237/9000 (91.5222%)
Scaling by  100
Scaled Norm after poisoning: 775.6959375296483, distance: 778.1204517939366
Total norm for 4 adversaries is: 775.6959375296483. distance: 778.1204517939366
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   1,  Average loss: 0.0448, Accuracy: 202/546 (36.9963%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   2,  Average loss: 0.0243, Accuracy: 303/546 (55.4945%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   3,  Average loss: 0.0176, Accuracy: 354/546 (64.8352%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   4,  Average loss: 0.0122, Accuracy: 409/546 (74.9084%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   5,  Average loss: 0.0086, Accuracy: 454/546 (83.1502%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   6,  Average loss: 0.0058, Accuracy: 484/546 (88.6447%), train_poison_data_count: 45
Global model norm: 44.48724936928909.
Norm before scaling: 44.701659961575395. Distance: 8.835143521605254
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 2.1216, Accuracy: 3575/10000 (35.7500%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.5429, Accuracy: 7418/9000 (82.4222%)
Scaling by  100
Scaled Norm after poisoning: 881.2961690033607, distance: 883.5142542709766
Total norm for 4 adversaries is: 881.2961690033607. distance: 883.5142542709766
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 209, local model 28, internal_epoch   1,  Average loss: 0.0975, Accuracy: 106/423 (25.0591%)
___Train Local_ResNet_18,  epoch 209, local model 28, internal_epoch   2,  Average loss: 0.0282, Accuracy: 188/423 (44.4444%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 51, internal_epoch   1,  Average loss: 0.0885, Accuracy: 177/479 (36.9520%)
___Train Local_ResNet_18,  epoch 209, local model 51, internal_epoch   2,  Average loss: 0.0226, Accuracy: 306/479 (63.8831%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   1,  Average loss: 0.0677, Accuracy: 227/557 (40.7540%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   2,  Average loss: 0.0218, Accuracy: 313/557 (56.1939%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 97, internal_epoch   1,  Average loss: 0.0869, Accuracy: 126/418 (30.1435%)
___Train Local_ResNet_18,  epoch 209, local model 97, internal_epoch   2,  Average loss: 0.0241, Accuracy: 242/418 (57.8947%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 85, internal_epoch   1,  Average loss: 0.0789, Accuracy: 116/364 (31.8681%)
___Train Local_ResNet_18,  epoch 209, local model 85, internal_epoch   2,  Average loss: 0.0238, Accuracy: 175/364 (48.0769%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 59, internal_epoch   1,  Average loss: 0.0806, Accuracy: 166/642 (25.8567%)
___Train Local_ResNet_18,  epoch 209, local model 59, internal_epoch   2,  Average loss: 0.0295, Accuracy: 267/642 (41.5888%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 351.34837675094604
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4208517476898353  data num: [526, 527, 496, 546, 423, 479, 557, 418, 364, 642]
[rfa agg] considering poison per batch poison_fraction: 0.032879042788268385
[rfa agg] init. name: [17, 33, 77, 11, 28, 51, 4, 97, 85, 59], weight: tensor([0.1057, 0.1059, 0.0996, 0.1097, 0.0850, 0.0962, 0.1119, 0.0840, 0.0731,
        0.1290])
[rfa agg] iter:  0, prev_obj_val: 11632.13671875, obj_val: 11335.076171875, abs dis: 297.060546875
[rfa agg] iter:  0, weight: tensor([0.0812, 0.0833, 0.0947, 0.0856, 0.0960, 0.1088, 0.1267, 0.0949, 0.0826,
        0.1463])
[rfa agg] iter:  1, prev_obj_val: 11335.076171875, obj_val: 11068.5478515625, abs dis: 266.5283203125
[rfa agg] iter:  1, weight: tensor([0.0652, 0.0667, 0.0741, 0.0686, 0.1063, 0.1205, 0.1403, 0.1050, 0.0914,
        0.1620])
[rfa agg] iter:  2, prev_obj_val: 11068.5478515625, obj_val: 10838.259765625, abs dis: 230.2880859375
[rfa agg] iter:  2, weight: tensor([0.0511, 0.0522, 0.0570, 0.0537, 0.1151, 0.1305, 0.1520, 0.1138, 0.0989,
        0.1757])
[rfa agg] iter:  3, prev_obj_val: 10838.259765625, obj_val: 10648.8720703125, abs dis: 189.3876953125
[rfa agg] iter:  3, weight: tensor([0.0392, 0.0400, 0.0432, 0.0412, 0.1224, 0.1389, 0.1618, 0.1210, 0.1052,
        0.1872])
[rfa agg] iter:  4, prev_obj_val: 10648.8720703125, obj_val: 10497.3896484375, abs dis: 151.482421875
[rfa agg] iter:  4, weight: tensor([0.0297, 0.0303, 0.0323, 0.0311, 0.1282, 0.1455, 0.1696, 0.1267, 0.1101,
        0.1964])
[rfa agg] iter:  5, prev_obj_val: 10497.3896484375, obj_val: 10377.931640625, abs dis: 119.4580078125
[rfa agg] iter:  5, weight: tensor([0.0222, 0.0226, 0.0240, 0.0232, 0.1327, 0.1507, 0.1758, 0.1311, 0.1138,
        0.2039])
[rfa agg] iter:  6, prev_obj_val: 10377.931640625, obj_val: 10285.3212890625, abs dis: 92.6103515625
[rfa agg] iter:  6, weight: tensor([0.0164, 0.0167, 0.0176, 0.0171, 0.1360, 0.1547, 0.1806, 0.1344, 0.1166,
        0.2100])
[rfa agg] iter:  7, prev_obj_val: 10285.3212890625, obj_val: 10215.8671875, abs dis: 69.4541015625
[rfa agg] iter:  7, weight: tensor([0.0119, 0.0121, 0.0128, 0.0125, 0.1384, 0.1577, 0.1844, 0.1368, 0.1184,
        0.2150])
[rfa agg] iter:  8, prev_obj_val: 10215.8671875, obj_val: 10163.830078125, abs dis: 52.037109375
[rfa agg] iter:  8, weight: tensor([0.0086, 0.0087, 0.0092, 0.0090, 0.1400, 0.1599, 0.1873, 0.1384, 0.1195,
        0.2194])
[rfa agg] iter:  9, prev_obj_val: 10163.830078125, obj_val: 10124.8525390625, abs dis: 38.9775390625
[rfa agg] iter:  9, weight: tensor([0.0061, 0.0062, 0.0065, 0.0064, 0.1409, 0.1614, 0.1896, 0.1393, 0.1199,
        0.2236])
___Test Target_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 472.0375545024872 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:210 choose agents : [17, 33, 77, 11, 51, 13, 57, 76, 80, 85]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   1,  Average loss: 0.0223, Accuracy: 311/526 (59.1255%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   2,  Average loss: 0.0083, Accuracy: 468/526 (88.9734%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   3,  Average loss: 0.0032, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   4,  Average loss: 0.0022, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   5,  Average loss: 0.0015, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   6,  Average loss: 0.0028, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Global model norm: 44.240779627299176.
Norm before scaling: 44.36109900004944. Distance: 6.617413765778121
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 2.6586, Accuracy: 4308/10000 (43.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.2102, Accuracy: 8464/9000 (94.0444%)
Scaling by  100
Scaled Norm after poisoning: 660.716136097795, distance: 661.7413108609738
Total norm for 4 adversaries is: 660.716136097795. distance: 661.7413108609738
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   1,  Average loss: 0.0151, Accuracy: 398/527 (75.5218%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   2,  Average loss: 0.0076, Accuracy: 447/527 (84.8197%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   3,  Average loss: 0.0041, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   4,  Average loss: 0.0023, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   5,  Average loss: 0.0007, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   6,  Average loss: 0.0006, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Global model norm: 44.240779627299176.
Norm before scaling: 44.25927499238507. Distance: 5.923284921414291
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 2.4004, Accuracy: 4233/10000 (42.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.1918, Accuracy: 8482/9000 (94.2444%)
Scaling by  100
Scaled Norm after poisoning: 591.1560443317821, distance: 592.3284561795085
Total norm for 4 adversaries is: 591.1560443317821. distance: 592.3284561795085
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   1,  Average loss: 0.0231, Accuracy: 252/496 (50.8065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   2,  Average loss: 0.0119, Accuracy: 384/496 (77.4194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   3,  Average loss: 0.0048, Accuracy: 461/496 (92.9435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   4,  Average loss: 0.0019, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 44.240779627299176.
Norm before scaling: 44.20522789050592. Distance: 5.241640974910746
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 2.1915, Accuracy: 4615/10000 (46.1500%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.1830, Accuracy: 8474/9000 (94.1556%)
Scaling by  100
Scaled Norm after poisoning: 523.1093336961213, distance: 524.1640964430891
Total norm for 4 adversaries is: 523.1093336961213. distance: 524.1640964430891
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   1,  Average loss: 0.0181, Accuracy: 360/546 (65.9341%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   2,  Average loss: 0.0078, Accuracy: 486/546 (89.0110%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   3,  Average loss: 0.0041, Accuracy: 509/546 (93.2234%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   4,  Average loss: 0.0024, Accuracy: 527/546 (96.5201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 44.240779627299176.
Norm before scaling: 44.22804948591024. Distance: 5.833694701127819
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 2.0279, Accuracy: 4564/10000 (45.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.1580, Accuracy: 8553/9000 (95.0333%)
Scaling by  100
Scaled Norm after poisoning: 582.0321082208437, distance: 583.3694155507297
Total norm for 4 adversaries is: 582.0321082208437. distance: 583.3694155507297
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 210, local model 51, internal_epoch   1,  Average loss: 0.0476, Accuracy: 218/479 (45.5115%)
___Train Local_ResNet_18,  epoch 210, local model 51, internal_epoch   2,  Average loss: 0.0194, Accuracy: 328/479 (68.4760%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 13, internal_epoch   1,  Average loss: 0.0433, Accuracy: 285/620 (45.9677%)
___Train Local_ResNet_18,  epoch 210, local model 13, internal_epoch   2,  Average loss: 0.0164, Accuracy: 419/620 (67.5806%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   1,  Average loss: 0.0456, Accuracy: 113/290 (38.9655%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   2,  Average loss: 0.0146, Accuracy: 217/290 (74.8276%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 76, internal_epoch   1,  Average loss: 0.2512, Accuracy: 10/65 (15.3846%)
___Train Local_ResNet_18,  epoch 210, local model 76, internal_epoch   2,  Average loss: 0.1305, Accuracy: 21/65 (32.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 80, internal_epoch   1,  Average loss: 0.0545, Accuracy: 132/363 (36.3636%)
___Train Local_ResNet_18,  epoch 210, local model 80, internal_epoch   2,  Average loss: 0.0133, Accuracy: 277/363 (76.3085%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 85, internal_epoch   1,  Average loss: 0.0452, Accuracy: 152/364 (41.7582%)
___Train Local_ResNet_18,  epoch 210, local model 85, internal_epoch   2,  Average loss: 0.0188, Accuracy: 209/364 (57.4176%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 368.3918707370758
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4899438727782975  data num: [526, 527, 496, 546, 479, 620, 290, 65, 363, 364]
[rfa agg] considering poison per batch poison_fraction: 0.038276865060804494
[rfa agg] init. name: [17, 33, 77, 11, 51, 13, 57, 76, 80, 85], weight: tensor([0.1230, 0.1232, 0.1160, 0.1277, 0.1120, 0.1450, 0.0678, 0.0152, 0.0849,
        0.0851])
[rfa agg] iter:  0, prev_obj_val: 11773.48046875, obj_val: 11768.0888671875, abs dis: 5.3916015625
[rfa agg] iter:  0, weight: tensor([0.1136, 0.1139, 0.1358, 0.1180, 0.1140, 0.1478, 0.0689, 0.0154, 0.0862,
        0.0865])
[rfa agg] iter:  1, prev_obj_val: 11768.0888671875, obj_val: 11762.796875, abs dis: 5.2919921875
[rfa agg] iter:  1, weight: tensor([0.1112, 0.1114, 0.1321, 0.1154, 0.1164, 0.1510, 0.0703, 0.0157, 0.0881,
        0.0883])
[rfa agg] iter:  2, prev_obj_val: 11762.796875, obj_val: 11757.51171875, abs dis: 5.28515625
[rfa agg] iter:  2, weight: tensor([0.1087, 0.1090, 0.1286, 0.1129, 0.1188, 0.1541, 0.0718, 0.0160, 0.0899,
        0.0902])
[rfa agg] iter:  3, prev_obj_val: 11757.51171875, obj_val: 11752.1396484375, abs dis: 5.3720703125
[rfa agg] iter:  3, weight: tensor([0.1063, 0.1065, 0.1251, 0.1104, 0.1212, 0.1572, 0.0732, 0.0164, 0.0917,
        0.0920])
[rfa agg] iter:  4, prev_obj_val: 11752.1396484375, obj_val: 11746.7744140625, abs dis: 5.365234375
[rfa agg] iter:  4, weight: tensor([0.1038, 0.1040, 0.1216, 0.1078, 0.1237, 0.1604, 0.0747, 0.0167, 0.0936,
        0.0938])
[rfa agg] iter:  5, prev_obj_val: 11746.7744140625, obj_val: 11741.5029296875, abs dis: 5.271484375
[rfa agg] iter:  5, weight: tensor([0.1013, 0.1015, 0.1181, 0.1052, 0.1261, 0.1635, 0.0762, 0.0170, 0.0954,
        0.0957])
[rfa agg] iter:  6, prev_obj_val: 11741.5029296875, obj_val: 11736.330078125, abs dis: 5.1728515625
[rfa agg] iter:  6, weight: tensor([0.0988, 0.0990, 0.1147, 0.1026, 0.1285, 0.1667, 0.0776, 0.0173, 0.0972,
        0.0975])
[rfa agg] iter:  7, prev_obj_val: 11736.330078125, obj_val: 11731.1611328125, abs dis: 5.1689453125
[rfa agg] iter:  7, weight: tensor([0.0964, 0.0966, 0.1115, 0.1001, 0.1309, 0.1697, 0.0790, 0.0177, 0.0990,
        0.0993])
[rfa agg] iter:  8, prev_obj_val: 11731.1611328125, obj_val: 11726.08984375, abs dis: 5.0712890625
[rfa agg] iter:  8, weight: tensor([0.0939, 0.0941, 0.1082, 0.0975, 0.1332, 0.1728, 0.0804, 0.0180, 0.1008,
        0.1010])
[rfa agg] iter:  9, prev_obj_val: 11726.08984375, obj_val: 11721.1123046875, abs dis: 4.9775390625
[rfa agg] iter:  9, weight: tensor([0.0915, 0.0917, 0.1051, 0.0950, 0.1355, 0.1758, 0.0818, 0.0183, 0.1025,
        0.1028])
___Test Target_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 490.0070102214813 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:211 choose agents : [17, 33, 77, 11, 90, 24, 63, 1, 52, 31]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   1,  Average loss: 0.0406, Accuracy: 344/526 (65.3992%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   2,  Average loss: 0.0126, Accuracy: 420/526 (79.8479%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   3,  Average loss: 0.0079, Accuracy: 446/526 (84.7909%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   4,  Average loss: 0.0029, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   5,  Average loss: 0.0017, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   6,  Average loss: 0.0019, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Global model norm: 45.35111770346046.
Norm before scaling: 46.945093427055824. Distance: 14.266048028195245
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.4438, Accuracy: 3926/10000 (39.2600%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.0906, Accuracy: 8761/9000 (97.3444%)
Scaling by  100
Scaled Norm after poisoning: 1425.3482030717967, distance: 1426.604754303027
Total norm for 4 adversaries is: 1425.3482030717967. distance: 1426.604754303027
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   1,  Average loss: 0.0688, Accuracy: 249/527 (47.2486%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   2,  Average loss: 0.0149, Accuracy: 397/527 (75.3321%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   3,  Average loss: 0.0084, Accuracy: 442/527 (83.8710%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   4,  Average loss: 0.0053, Accuracy: 489/527 (92.7894%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   5,  Average loss: 0.0023, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   6,  Average loss: 0.0016, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 45.35111770346046.
Norm before scaling: 47.45160466365969. Distance: 16.73776663809273
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.7863, Accuracy: 3878/10000 (38.7800%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.2508, Accuracy: 8456/9000 (93.9556%)
Scaling by  100
Scaled Norm after poisoning: 1671.8439670017056, distance: 1673.7765681237147
Total norm for 4 adversaries is: 1671.8439670017056. distance: 1673.7765681237147
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   1,  Average loss: 0.0555, Accuracy: 265/496 (53.4274%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   2,  Average loss: 0.0141, Accuracy: 377/496 (76.0081%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   3,  Average loss: 0.0070, Accuracy: 428/496 (86.2903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   4,  Average loss: 0.0035, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   5,  Average loss: 0.0015, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   6,  Average loss: 0.0014, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 45.35111770346046.
Norm before scaling: 46.9658572587244. Distance: 14.279478935758048
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.9236, Accuracy: 4323/10000 (43.2300%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.1152, Accuracy: 8731/9000 (97.0111%)
Scaling by  100
Scaled Norm after poisoning: 1426.7476125790433, distance: 1427.947959485919
Total norm for 4 adversaries is: 1426.7476125790433. distance: 1427.947959485919
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   1,  Average loss: 0.0515, Accuracy: 304/546 (55.6777%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   2,  Average loss: 0.0121, Accuracy: 430/546 (78.7546%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   3,  Average loss: 0.0055, Accuracy: 494/546 (90.4762%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   4,  Average loss: 0.0033, Accuracy: 519/546 (95.0549%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   5,  Average loss: 0.0019, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   6,  Average loss: 0.0015, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Global model norm: 45.35111770346046.
Norm before scaling: 46.94452136232193. Distance: 14.535064918417708
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.1883, Accuracy: 4412/10000 (44.1200%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.2520, Accuracy: 8435/9000 (93.7222%)
Scaling by  100
Scaled Norm after poisoning: 1452.004734840765, distance: 1453.5066219319401
Total norm for 4 adversaries is: 1452.004734840765. distance: 1453.5066219319401
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 211, local model 90, internal_epoch   1,  Average loss: 0.0570, Accuracy: 335/578 (57.9585%)
___Train Local_ResNet_18,  epoch 211, local model 90, internal_epoch   2,  Average loss: 0.0228, Accuracy: 325/578 (56.2284%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 24, internal_epoch   1,  Average loss: 0.0572, Accuracy: 153/320 (47.8125%)
___Train Local_ResNet_18,  epoch 211, local model 24, internal_epoch   2,  Average loss: 0.0215, Accuracy: 229/320 (71.5625%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 63, internal_epoch   1,  Average loss: 0.0569, Accuracy: 288/752 (38.2979%)
___Train Local_ResNet_18,  epoch 211, local model 63, internal_epoch   2,  Average loss: 0.0213, Accuracy: 431/752 (57.3138%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 1, internal_epoch   1,  Average loss: 0.0543, Accuracy: 359/641 (56.0062%)
___Train Local_ResNet_18,  epoch 211, local model 1, internal_epoch   2,  Average loss: 0.0263, Accuracy: 349/641 (54.4462%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 52, internal_epoch   1,  Average loss: 0.0981, Accuracy: 78/214 (36.4486%)
___Train Local_ResNet_18,  epoch 211, local model 52, internal_epoch   2,  Average loss: 0.0241, Accuracy: 143/214 (66.8224%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 31, internal_epoch   1,  Average loss: 0.0478, Accuracy: 360/706 (50.9915%)
___Train Local_ResNet_18,  epoch 211, local model 31, internal_epoch   2,  Average loss: 0.0244, Accuracy: 382/706 (54.1076%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 361.6971023082733
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3948360346777233  data num: [526, 527, 496, 546, 578, 320, 752, 641, 214, 706]
[rfa agg] considering poison per batch poison_fraction: 0.030846565209197135
[rfa agg] init. name: [17, 33, 77, 11, 90, 24, 63, 1, 52, 31], weight: tensor([0.0991, 0.0993, 0.0935, 0.1029, 0.1089, 0.0603, 0.1417, 0.1208, 0.0403,
        0.1331])
[rfa agg] iter:  0, prev_obj_val: 11590.2734375, obj_val: 11088.22265625, abs dis: 502.05078125
[rfa agg] iter:  0, weight: tensor([0.0715, 0.0715, 0.0809, 0.0743, 0.1263, 0.0696, 0.1647, 0.1402, 0.0465,
        0.1546])
[rfa agg] iter:  1, prev_obj_val: 11088.22265625, obj_val: 10667.625, abs dis: 420.59765625
[rfa agg] iter:  1, weight: tensor([0.0520, 0.0521, 0.0574, 0.0541, 0.1412, 0.0776, 0.1841, 0.1568, 0.0519,
        0.1729])
[rfa agg] iter:  2, prev_obj_val: 10667.625, obj_val: 10337.466796875, abs dis: 330.158203125
[rfa agg] iter:  2, weight: tensor([0.0366, 0.0366, 0.0397, 0.0380, 0.1528, 0.0838, 0.1995, 0.1697, 0.0559,
        0.1873])
[rfa agg] iter:  3, prev_obj_val: 10337.466796875, obj_val: 10093.34765625, abs dis: 244.119140625
[rfa agg] iter:  3, weight: tensor([0.0250, 0.0251, 0.0269, 0.0260, 0.1614, 0.0882, 0.2111, 0.1794, 0.0588,
        0.1981])
[rfa agg] iter:  4, prev_obj_val: 10093.34765625, obj_val: 9919.650390625, abs dis: 173.697265625
[rfa agg] iter:  4, weight: tensor([0.0168, 0.0168, 0.0179, 0.0174, 0.1675, 0.0910, 0.2195, 0.1864, 0.0606,
        0.2061])
[rfa agg] iter:  5, prev_obj_val: 9919.650390625, obj_val: 9799.6806640625, abs dis: 119.9697265625
[rfa agg] iter:  5, weight: tensor([0.0111, 0.0111, 0.0117, 0.0115, 0.1716, 0.0924, 0.2258, 0.1914, 0.0614,
        0.2120])
[rfa agg] iter:  6, prev_obj_val: 9799.6806640625, obj_val: 9718.763671875, abs dis: 80.9169921875
[rfa agg] iter:  6, weight: tensor([0.0072, 0.0072, 0.0076, 0.0074, 0.1744, 0.0925, 0.2308, 0.1951, 0.0613,
        0.2166])
[rfa agg] iter:  7, prev_obj_val: 9718.763671875, obj_val: 9664.3076171875, abs dis: 54.4560546875
[rfa agg] iter:  7, weight: tensor([0.0046, 0.0046, 0.0048, 0.0048, 0.1760, 0.0912, 0.2353, 0.1978, 0.0602,
        0.2207])
[rfa agg] iter:  8, prev_obj_val: 9664.3076171875, obj_val: 9628.451171875, abs dis: 35.8564453125
[rfa agg] iter:  8, weight: tensor([0.0028, 0.0028, 0.0030, 0.0030, 0.1767, 0.0882, 0.2401, 0.2003, 0.0578,
        0.2252])
[rfa agg] iter:  9, prev_obj_val: 9628.451171875, obj_val: 9605.47265625, abs dis: 22.978515625
[rfa agg] iter:  9, weight: tensor([0.0017, 0.0017, 0.0018, 0.0018, 0.1763, 0.0828, 0.2465, 0.2027, 0.0536,
        0.2311])
___Test Target_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 464.48489117622375 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:212 choose agents : [17, 33, 77, 11, 59, 67, 71, 66, 76, 96]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   1,  Average loss: 0.0200, Accuracy: 407/526 (77.3764%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   2,  Average loss: 0.0080, Accuracy: 463/526 (88.0228%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   3,  Average loss: 0.0069, Accuracy: 469/526 (89.1635%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   4,  Average loss: 0.0054, Accuracy: 478/526 (90.8745%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   5,  Average loss: 0.0035, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   6,  Average loss: 0.0031, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Global model norm: 45.22380867522936.
Norm before scaling: 46.32999574637769. Distance: 11.847445029851439
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 3.4240, Accuracy: 3685/10000 (36.8500%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.3546, Accuracy: 8539/9000 (94.8778%)
Scaling by  100
Scaled Norm after poisoning: 1183.9578223061833, distance: 1184.7444872207677
Total norm for 4 adversaries is: 1183.9578223061833. distance: 1184.7444872207677
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   1,  Average loss: 0.0353, Accuracy: 328/527 (62.2391%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   2,  Average loss: 0.0065, Accuracy: 466/527 (88.4250%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   3,  Average loss: 0.0059, Accuracy: 479/527 (90.8918%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   4,  Average loss: 0.0033, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   5,  Average loss: 0.0023, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   6,  Average loss: 0.0025, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 45.22380867522936.
Norm before scaling: 46.361515686167444. Distance: 12.381661519852152
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 2.8365, Accuracy: 3870/10000 (38.7000%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.0613, Accuracy: 8804/9000 (97.8222%)
Scaling by  100
Scaled Norm after poisoning: 1237.00843772385, distance: 1238.1661843226054
Total norm for 4 adversaries is: 1237.00843772385. distance: 1238.1661843226054
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   1,  Average loss: 0.0254, Accuracy: 322/496 (64.9194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   2,  Average loss: 0.0083, Accuracy: 421/496 (84.8790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   3,  Average loss: 0.0037, Accuracy: 465/496 (93.7500%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   4,  Average loss: 0.0018, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   6,  Average loss: 0.0015, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 45.22380867522936.
Norm before scaling: 45.799724301503716. Distance: 9.65543300295794
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1.9136, Accuracy: 4687/10000 (46.8700%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.2076, Accuracy: 8569/9000 (95.2111%)
Scaling by  100
Scaled Norm after poisoning: 964.4888218636854, distance: 965.5433056057092
Total norm for 4 adversaries is: 964.4888218636854. distance: 965.5433056057092
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   1,  Average loss: 0.0236, Accuracy: 384/546 (70.3297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 491/546 (89.9267%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   3,  Average loss: 0.0030, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   4,  Average loss: 0.0021, Accuracy: 526/546 (96.3370%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 45.22380867522936.
Norm before scaling: 45.604985443102876. Distance: 9.004848022195157
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 2.7196, Accuracy: 4244/10000 (42.4400%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.2408, Accuracy: 8524/9000 (94.7111%)
Scaling by  100
Scaled Norm after poisoning: 899.039139859884, distance: 900.484730575705
Total norm for 4 adversaries is: 899.039139859884. distance: 900.484730575705
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 212, local model 59, internal_epoch   1,  Average loss: 0.0345, Accuracy: 403/642 (62.7726%)
___Train Local_ResNet_18,  epoch 212, local model 59, internal_epoch   2,  Average loss: 0.0186, Accuracy: 388/642 (60.4361%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 67, internal_epoch   1,  Average loss: 0.0348, Accuracy: 455/842 (54.0380%)
___Train Local_ResNet_18,  epoch 212, local model 67, internal_epoch   2,  Average loss: 0.0162, Accuracy: 570/842 (67.6960%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 71, internal_epoch   1,  Average loss: 0.0282, Accuracy: 674/1166 (57.8045%)
___Train Local_ResNet_18,  epoch 212, local model 71, internal_epoch   2,  Average loss: 0.0125, Accuracy: 874/1166 (74.9571%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 66, internal_epoch   1,  Average loss: 0.0274, Accuracy: 385/555 (69.3694%)
___Train Local_ResNet_18,  epoch 212, local model 66, internal_epoch   2,  Average loss: 0.0102, Accuracy: 456/555 (82.1622%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 76, internal_epoch   1,  Average loss: 0.1379, Accuracy: 25/65 (38.4615%)
___Train Local_ResNet_18,  epoch 212, local model 76, internal_epoch   2,  Average loss: 0.0551, Accuracy: 50/65 (76.9231%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 96, internal_epoch   1,  Average loss: 0.0399, Accuracy: 328/708 (46.3277%)
___Train Local_ResNet_18,  epoch 212, local model 96, internal_epoch   2,  Average loss: 0.0212, Accuracy: 401/708 (56.6384%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 337.8655204772949
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3449695372962292  data num: [526, 527, 496, 546, 642, 842, 1166, 555, 65, 708]
[rfa agg] considering poison per batch poison_fraction: 0.026950745101267905
[rfa agg] init. name: [17, 33, 77, 11, 59, 67, 71, 66, 76, 96], weight: tensor([0.0866, 0.0868, 0.0817, 0.0899, 0.1057, 0.1386, 0.1920, 0.0914, 0.0107,
        0.1166])
[rfa agg] iter:  0, prev_obj_val: 10817.646484375, obj_val: 9858.6201171875, abs dis: 959.0263671875
[rfa agg] iter:  0, weight: tensor([0.0521, 0.0522, 0.0585, 0.0542, 0.1260, 0.1658, 0.2308, 0.1087, 0.0126,
        0.1391])
[rfa agg] iter:  1, prev_obj_val: 9858.6201171875, obj_val: 9192.095703125, abs dis: 666.5244140625
[rfa agg] iter:  1, weight: tensor([0.0306, 0.0306, 0.0333, 0.0318, 0.1403, 0.1850, 0.2584, 0.1209, 0.0140,
        0.1550])
[rfa agg] iter:  2, prev_obj_val: 9192.095703125, obj_val: 8776.0244140625, abs dis: 416.0712890625
[rfa agg] iter:  2, weight: tensor([0.0171, 0.0171, 0.0183, 0.0178, 0.1488, 0.1969, 0.2768, 0.1279, 0.0147,
        0.1646])
[rfa agg] iter:  3, prev_obj_val: 8776.0244140625, obj_val: 8536.0625, abs dis: 239.9619140625
[rfa agg] iter:  3, weight: tensor([0.0092, 0.0092, 0.0098, 0.0096, 0.1530, 0.2039, 0.2900, 0.1309, 0.0147,
        0.1696])
[rfa agg] iter:  4, prev_obj_val: 8536.0625, obj_val: 8404.0859375, abs dis: 131.9765625
[rfa agg] iter:  4, weight: tensor([0.0048, 0.0048, 0.0051, 0.0050, 0.1538, 0.2078, 0.3027, 0.1303, 0.0142,
        0.1713])
[rfa agg] iter:  5, prev_obj_val: 8404.0859375, obj_val: 8331.9912109375, abs dis: 72.0947265625
[rfa agg] iter:  5, weight: tensor([0.0025, 0.0025, 0.0026, 0.0026, 0.1511, 0.2095, 0.3207, 0.1258, 0.0130,
        0.1696])
[rfa agg] iter:  6, prev_obj_val: 8331.9912109375, obj_val: 8294.38671875, abs dis: 37.6044921875
[rfa agg] iter:  6, weight: tensor([0.0012, 0.0012, 0.0013, 0.0013, 0.1421, 0.2083, 0.3570, 0.1146, 0.0108,
        0.1623])
[rfa agg] iter:  7, prev_obj_val: 8294.38671875, obj_val: 8279.6875, abs dis: 14.69921875
[rfa agg] iter:  7, weight: tensor([0.0005, 0.0005, 0.0005, 0.0005, 0.1172, 0.1934, 0.4529, 0.0889, 0.0072,
        0.1383])
[rfa agg] iter:  8, prev_obj_val: 8279.6875, obj_val: 8280.1748046875, abs dis: 0.4873046875
[rfa agg] iter:  8, weight: tensor([1.9197e-04, 1.9234e-04, 2.0272e-04, 1.9952e-04, 8.6129e-02, 1.8476e-01,
        5.5772e-01, 5.9137e-02, 3.8794e-03, 1.0759e-01])
[rfa agg] iter:  9, prev_obj_val: 8280.1748046875, obj_val: 8281.0478515625, abs dis: 0.873046875
[rfa agg] iter:  9, weight: tensor([1.9342e-04, 1.9379e-04, 2.0424e-04, 2.0103e-04, 1.0667e-01, 2.6195e-01,
        4.1954e-01, 7.0770e-02, 4.3176e-03, 1.3596e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 455.36218786239624 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:213 choose agents : [17, 33, 77, 11, 80, 81, 22, 72, 64, 45]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   1,  Average loss: 0.0160, Accuracy: 420/526 (79.8479%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   2,  Average loss: 0.0066, Accuracy: 474/526 (90.1141%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   3,  Average loss: 0.0040, Accuracy: 493/526 (93.7262%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   4,  Average loss: 0.0021, Accuracy: 508/526 (96.5779%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   5,  Average loss: 0.0012, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   6,  Average loss: 0.0027, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Global model norm: 45.14440399334188.
Norm before scaling: 45.67178947135338. Distance: 9.348215726440335
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 2.3659, Accuracy: 4463/10000 (44.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.1134, Accuracy: 8712/9000 (96.8000%)
Scaling by  100
Scaled Norm after poisoning: 933.7985931130974, distance: 934.8216073133954
Total norm for 4 adversaries is: 933.7985931130974. distance: 934.8216073133954
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   1,  Average loss: 0.0270, Accuracy: 359/527 (68.1214%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   2,  Average loss: 0.0063, Accuracy: 475/527 (90.1328%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   3,  Average loss: 0.0056, Accuracy: 483/527 (91.6509%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   4,  Average loss: 0.0048, Accuracy: 500/527 (94.8767%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   5,  Average loss: 0.0032, Accuracy: 500/527 (94.8767%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   6,  Average loss: 0.0024, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Global model norm: 45.14440399334188.
Norm before scaling: 45.924969060448205. Distance: 10.652638827504564
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 2.8070, Accuracy: 3779/10000 (37.7900%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.1993, Accuracy: 8604/9000 (95.6000%)
Scaling by  100
Scaled Norm after poisoning: 1064.2301795194496, distance: 1065.2640517730804
Total norm for 4 adversaries is: 1064.2301795194496. distance: 1065.2640517730804
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   1,  Average loss: 0.0142, Accuracy: 361/496 (72.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   2,  Average loss: 0.0040, Accuracy: 454/496 (91.5323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   3,  Average loss: 0.0036, Accuracy: 464/496 (93.5484%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   4,  Average loss: 0.0020, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   5,  Average loss: 0.0010, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 45.14440399334188.
Norm before scaling: 45.388782772426275. Distance: 7.475569034210968
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.9513, Accuracy: 4796/10000 (47.9600%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.0993, Accuracy: 8764/9000 (97.3778%)
Scaling by  100
Scaled Norm after poisoning: 746.6615280701155, distance: 747.5569376308403
Total norm for 4 adversaries is: 746.6615280701155. distance: 747.5569376308403
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   1,  Average loss: 0.0172, Accuracy: 411/546 (75.2747%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   2,  Average loss: 0.0040, Accuracy: 505/546 (92.4908%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   3,  Average loss: 0.0023, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   4,  Average loss: 0.0007, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 45.14440399334188.
Norm before scaling: 45.29403718689139. Distance: 7.484841350130348
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 2.2550, Accuracy: 4717/10000 (47.1700%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.2213, Accuracy: 8604/9000 (95.6000%)
Scaling by  100
Scaled Norm after poisoning: 747.005689402698, distance: 748.4840930173466
Total norm for 4 adversaries is: 747.005689402698. distance: 748.4840930173466
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 213, local model 80, internal_epoch   1,  Average loss: 0.0189, Accuracy: 271/363 (74.6556%)
___Train Local_ResNet_18,  epoch 213, local model 80, internal_epoch   2,  Average loss: 0.0052, Accuracy: 324/363 (89.2562%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 81, internal_epoch   1,  Average loss: 0.0290, Accuracy: 653/1034 (63.1528%)
___Train Local_ResNet_18,  epoch 213, local model 81, internal_epoch   2,  Average loss: 0.0163, Accuracy: 692/1034 (66.9246%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 22, internal_epoch   1,  Average loss: 0.0321, Accuracy: 281/494 (56.8826%)
___Train Local_ResNet_18,  epoch 213, local model 22, internal_epoch   2,  Average loss: 0.0103, Accuracy: 396/494 (80.1619%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 72, internal_epoch   1,  Average loss: 0.0344, Accuracy: 364/618 (58.8997%)
___Train Local_ResNet_18,  epoch 213, local model 72, internal_epoch   2,  Average loss: 0.0094, Accuracy: 490/618 (79.2880%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 64, internal_epoch   1,  Average loss: 0.0243, Accuracy: 421/686 (61.3703%)
___Train Local_ResNet_18,  epoch 213, local model 64, internal_epoch   2,  Average loss: 0.0110, Accuracy: 535/686 (77.9883%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 45, internal_epoch   1,  Average loss: 0.0352, Accuracy: 286/529 (54.0643%)
___Train Local_ResNet_18,  epoch 213, local model 45, internal_epoch   2,  Average loss: 0.0160, Accuracy: 345/529 (65.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 386.4143257141113
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3600274961333563  data num: [526, 527, 496, 546, 363, 1034, 494, 618, 686, 529]
[rfa agg] considering poison per batch poison_fraction: 0.02812714813541846
[rfa agg] init. name: [17, 33, 77, 11, 80, 81, 22, 72, 64, 45], weight: tensor([0.0904, 0.0906, 0.0852, 0.0938, 0.0624, 0.1777, 0.0849, 0.1062, 0.1179,
        0.0909])
[rfa agg] iter:  0, prev_obj_val: 10992.7265625, obj_val: 10185.705078125, abs dis: 807.021484375
[rfa agg] iter:  0, weight: tensor([0.0577, 0.0578, 0.0652, 0.0600, 0.0736, 0.2121, 0.1004, 0.1258, 0.1398,
        0.1076])
[rfa agg] iter:  1, prev_obj_val: 10185.705078125, obj_val: 9585.486328125, abs dis: 600.21875
[rfa agg] iter:  1, weight: tensor([0.0363, 0.0364, 0.0399, 0.0378, 0.0821, 0.2380, 0.1121, 0.1407, 0.1564,
        0.1203])
[rfa agg] iter:  2, prev_obj_val: 9585.486328125, obj_val: 9182.095703125, abs dis: 403.390625
[rfa agg] iter:  2, weight: tensor([0.0218, 0.0218, 0.0235, 0.0226, 0.0875, 0.2564, 0.1197, 0.1505, 0.1675,
        0.1285])
[rfa agg] iter:  3, prev_obj_val: 9182.095703125, obj_val: 8930.634765625, abs dis: 251.4609375
[rfa agg] iter:  3, weight: tensor([0.0126, 0.0126, 0.0135, 0.0131, 0.0903, 0.2696, 0.1240, 0.1564, 0.1744,
        0.1333])
[rfa agg] iter:  4, prev_obj_val: 8930.634765625, obj_val: 8781.318359375, abs dis: 149.31640625
[rfa agg] iter:  4, weight: tensor([0.0071, 0.0072, 0.0076, 0.0074, 0.0909, 0.2810, 0.1256, 0.1594, 0.1783,
        0.1355])
[rfa agg] iter:  5, prev_obj_val: 8781.318359375, obj_val: 8694.6435546875, abs dis: 86.6748046875
[rfa agg] iter:  5, weight: tensor([0.0040, 0.0040, 0.0042, 0.0041, 0.0893, 0.2943, 0.1247, 0.1601, 0.1800,
        0.1353])
[rfa agg] iter:  6, prev_obj_val: 8694.6435546875, obj_val: 8642.734375, abs dis: 51.9091796875
[rfa agg] iter:  6, weight: tensor([0.0021, 0.0021, 0.0023, 0.0022, 0.0848, 0.3156, 0.1207, 0.1581, 0.1797,
        0.1322])
[rfa agg] iter:  7, prev_obj_val: 8642.734375, obj_val: 8615.62109375, abs dis: 27.11328125
[rfa agg] iter:  7, weight: tensor([0.0010, 0.0010, 0.0011, 0.0011, 0.0744, 0.3640, 0.1100, 0.1501, 0.1745,
        0.1228])
[rfa agg] iter:  8, prev_obj_val: 8615.62109375, obj_val: 8608.3779296875, abs dis: 7.2431640625
[rfa agg] iter:  8, weight: tensor([4.1190e-04, 4.1246e-04, 4.3557e-04, 4.2795e-04, 5.2031e-02, 4.9951e-01,
        8.2063e-02, 1.2132e-01, 1.4829e-01, 9.5102e-02])
[rfa agg] iter:  9, prev_obj_val: 8608.3779296875, obj_val: 8609.2802734375, abs dis: 0.90234375
[rfa agg] iter:  9, weight: tensor([2.2180e-04, 2.2210e-04, 2.3449e-04, 2.3044e-04, 4.2295e-02, 5.2026e-01,
        7.2239e-02, 1.1898e-01, 1.5749e-01, 8.7827e-02])
___Test Target_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 498.4708933830261 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:214 choose agents : [17, 33, 77, 11, 80, 54, 44, 35, 68, 25]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   1,  Average loss: 0.0128, Accuracy: 428/526 (81.3688%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   2,  Average loss: 0.0073, Accuracy: 473/526 (89.9240%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   3,  Average loss: 0.0059, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   4,  Average loss: 0.0028, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   5,  Average loss: 0.0018, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   6,  Average loss: 0.0021, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Global model norm: 45.08367464755466.
Norm before scaling: 45.38635145544858. Distance: 8.176208164170458
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 2.2949, Accuracy: 4413/10000 (44.1300%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.1032, Accuracy: 8757/9000 (97.3000%)
Scaling by  100
Scaled Norm after poisoning: 816.4493630960833, distance: 817.6207479632595
Total norm for 4 adversaries is: 816.4493630960833. distance: 817.6207479632595
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   1,  Average loss: 0.0218, Accuracy: 368/527 (69.8292%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   2,  Average loss: 0.0063, Accuracy: 475/527 (90.1328%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   3,  Average loss: 0.0031, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   4,  Average loss: 0.0029, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   5,  Average loss: 0.0014, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   6,  Average loss: 0.0007, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Global model norm: 45.08367464755466.
Norm before scaling: 45.47551496066317. Distance: 8.71535587216699
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 2.4533, Accuracy: 4191/10000 (41.9100%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.2808, Accuracy: 8460/9000 (94.0000%)
Scaling by  100
Scaled Norm after poisoning: 870.3789763660425, distance: 871.5355701289535
Total norm for 4 adversaries is: 870.3789763660425. distance: 871.5355701289535
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   1,  Average loss: 0.0126, Accuracy: 394/496 (79.4355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   2,  Average loss: 0.0034, Accuracy: 465/496 (93.7500%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   3,  Average loss: 0.0019, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   4,  Average loss: 0.0007, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   5,  Average loss: 0.0014, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   6,  Average loss: 0.0011, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 45.08367464755466.
Norm before scaling: 45.08170885883556. Distance: 5.918381276876015
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 2.2961, Accuracy: 4524/10000 (45.2400%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.0502, Accuracy: 8865/9000 (98.5000%)
Scaling by  100
Scaled Norm after poisoning: 590.5797469436283, distance: 591.8381852330922
Total norm for 4 adversaries is: 590.5797469436283. distance: 591.8381852330922
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   1,  Average loss: 0.0130, Accuracy: 429/546 (78.5714%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   2,  Average loss: 0.0041, Accuracy: 504/546 (92.3077%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   3,  Average loss: 0.0012, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   4,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 45.08367464755466.
Norm before scaling: 45.06736494196771. Distance: 6.297713685326883
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 2.0269, Accuracy: 4720/10000 (47.2000%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.0528, Accuracy: 8849/9000 (98.3222%)
Scaling by  100
Scaled Norm after poisoning: 628.1173506996921, distance: 629.7714119027634
Total norm for 4 adversaries is: 628.1173506996921. distance: 629.7714119027634
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 214, local model 80, internal_epoch   1,  Average loss: 0.0168, Accuracy: 268/363 (73.8292%)
___Train Local_ResNet_18,  epoch 214, local model 80, internal_epoch   2,  Average loss: 0.0056, Accuracy: 327/363 (90.0826%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   1,  Average loss: 0.0203, Accuracy: 300/440 (68.1818%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   2,  Average loss: 0.0077, Accuracy: 367/440 (83.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 44, internal_epoch   1,  Average loss: 0.0198, Accuracy: 286/436 (65.5963%)
___Train Local_ResNet_18,  epoch 214, local model 44, internal_epoch   2,  Average loss: 0.0068, Accuracy: 371/436 (85.0917%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 35, internal_epoch   1,  Average loss: 0.0251, Accuracy: 251/419 (59.9045%)
___Train Local_ResNet_18,  epoch 214, local model 35, internal_epoch   2,  Average loss: 0.0086, Accuracy: 349/419 (83.2936%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 68, internal_epoch   1,  Average loss: 0.0288, Accuracy: 229/416 (55.0481%)
___Train Local_ResNet_18,  epoch 214, local model 68, internal_epoch   2,  Average loss: 0.0120, Accuracy: 326/416 (78.3654%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 25, internal_epoch   1,  Average loss: 0.0215, Accuracy: 368/545 (67.5229%)
___Train Local_ResNet_18,  epoch 214, local model 25, internal_epoch   2,  Average loss: 0.0092, Accuracy: 465/545 (85.3211%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 342.5579216480255
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4444208739923632  data num: [526, 527, 496, 546, 363, 440, 436, 419, 416, 545]
[rfa agg] considering poison per batch poison_fraction: 0.03472038078065337
[rfa agg] init. name: [17, 33, 77, 11, 80, 54, 44, 35, 68, 25], weight: tensor([0.1116, 0.1118, 0.1052, 0.1158, 0.0770, 0.0933, 0.0925, 0.0889, 0.0882,
        0.1156])
[rfa agg] iter:  0, prev_obj_val: 11762.2041015625, obj_val: 11615.583984375, abs dis: 146.6201171875
[rfa agg] iter:  0, weight: tensor([0.0930, 0.0931, 0.1084, 0.0966, 0.0843, 0.1023, 0.1014, 0.0974, 0.0967,
        0.1269])
[rfa agg] iter:  1, prev_obj_val: 11615.583984375, obj_val: 11475.58984375, abs dis: 139.994140625
[rfa agg] iter:  1, weight: tensor([0.0809, 0.0810, 0.0924, 0.0840, 0.0916, 0.1111, 0.1101, 0.1058, 0.1051,
        0.1379])
[rfa agg] iter:  2, prev_obj_val: 11475.58984375, obj_val: 11345.3232421875, abs dis: 130.2666015625
[rfa agg] iter:  2, weight: tensor([0.0694, 0.0695, 0.0780, 0.0721, 0.0984, 0.1194, 0.1183, 0.1137, 0.1129,
        0.1482])
[rfa agg] iter:  3, prev_obj_val: 11345.3232421875, obj_val: 11226.7802734375, abs dis: 118.54296875
[rfa agg] iter:  3, weight: tensor([0.0589, 0.0589, 0.0653, 0.0611, 0.1046, 0.1269, 0.1258, 0.1209, 0.1200,
        0.1576])
[rfa agg] iter:  4, prev_obj_val: 11226.7802734375, obj_val: 11120.45703125, abs dis: 106.3232421875
[rfa agg] iter:  4, weight: tensor([0.0494, 0.0494, 0.0543, 0.0513, 0.1101, 0.1336, 0.1324, 0.1272, 0.1263,
        0.1660])
[rfa agg] iter:  5, prev_obj_val: 11120.45703125, obj_val: 11028.2939453125, abs dis: 92.1630859375
[rfa agg] iter:  5, weight: tensor([0.0409, 0.0410, 0.0446, 0.0425, 0.1149, 0.1395, 0.1383, 0.1329, 0.1319,
        0.1735])
[rfa agg] iter:  6, prev_obj_val: 11028.2939453125, obj_val: 10949.8154296875, abs dis: 78.478515625
[rfa agg] iter:  6, weight: tensor([0.0337, 0.0338, 0.0365, 0.0350, 0.1190, 0.1446, 0.1432, 0.1377, 0.1367,
        0.1799])
[rfa agg] iter:  7, prev_obj_val: 10949.8154296875, obj_val: 10882.533203125, abs dis: 67.2822265625
[rfa agg] iter:  7, weight: tensor([0.0276, 0.0277, 0.0298, 0.0287, 0.1224, 0.1488, 0.1474, 0.1417, 0.1407,
        0.1853])
[rfa agg] iter:  8, prev_obj_val: 10882.533203125, obj_val: 10826.3623046875, abs dis: 56.1708984375
[rfa agg] iter:  8, weight: tensor([0.0225, 0.0225, 0.0241, 0.0233, 0.1252, 0.1523, 0.1510, 0.1451, 0.1440,
        0.1900])
[rfa agg] iter:  9, prev_obj_val: 10826.3623046875, obj_val: 10779.814453125, abs dis: 46.5478515625
[rfa agg] iter:  9, weight: tensor([0.0182, 0.0182, 0.0195, 0.0189, 0.1276, 0.1553, 0.1539, 0.1479, 0.1468,
        0.1940])
___Test Target_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 469.8149197101593 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:215 choose agents : [17, 33, 77, 11, 4, 79, 43, 63, 35, 49]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   1,  Average loss: 0.0036, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   2,  Average loss: 0.0017, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   3,  Average loss: 0.0023, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   4,  Average loss: 0.0015, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   5,  Average loss: 0.0018, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   6,  Average loss: 0.0008, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Global model norm: 44.87628257002453.
Norm before scaling: 44.75433567290925. Distance: 5.123947779869549
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 2.0602, Accuracy: 4736/10000 (47.3600%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.1419, Accuracy: 8714/9000 (96.8222%)
Scaling by  100
Scaled Norm after poisoning: 510.72873793237835, distance: 512.394806277347
Total norm for 4 adversaries is: 510.72873793237835. distance: 512.394806277347
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   1,  Average loss: 0.0034, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   2,  Average loss: 0.0031, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   3,  Average loss: 0.0027, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   4,  Average loss: 0.0013, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   5,  Average loss: 0.0013, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   6,  Average loss: 0.0010, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Global model norm: 44.87628257002453.
Norm before scaling: 44.60536048048205. Distance: 4.155613671257377
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.8791, Accuracy: 5251/10000 (52.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.1538, Accuracy: 8680/9000 (96.4444%)
Scaling by  100
Scaled Norm after poisoning: 412.9817641252456, distance: 415.561310909714
Total norm for 4 adversaries is: 412.9817641252456. distance: 415.561310909714
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   1,  Average loss: 0.0027, Accuracy: 470/496 (94.7581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   2,  Average loss: 0.0007, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   3,  Average loss: 0.0004, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   4,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 44.87628257002453.
Norm before scaling: 44.57585896142034. Distance: 2.765908609277517
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.7210, Accuracy: 5480/10000 (54.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.1166, Accuracy: 8762/9000 (97.3556%)
Scaling by  100
Scaled Norm after poisoning: 273.9780300270443, distance: 276.5908671892476
Total norm for 4 adversaries is: 273.9780300270443. distance: 276.5908671892476
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   2,  Average loss: 0.0009, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   3,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   4,  Average loss: 0.0011, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   6,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Global model norm: 44.87628257002453.
Norm before scaling: 44.49940610339297. Distance: 2.628099246811758
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.6973, Accuracy: 5653/10000 (56.5300%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.3445, Accuracy: 8402/9000 (93.3556%)
Scaling by  100
Scaled Norm after poisoning: 258.88965132368656, distance: 262.80992121208055
Total norm for 4 adversaries is: 258.88965132368656. distance: 262.80992121208055
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 215, local model 4, internal_epoch   1,  Average loss: 0.0210, Accuracy: 365/557 (65.5296%)
___Train Local_ResNet_18,  epoch 215, local model 4, internal_epoch   2,  Average loss: 0.0059, Accuracy: 488/557 (87.6122%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 79, internal_epoch   1,  Average loss: 0.0398, Accuracy: 83/154 (53.8961%)
___Train Local_ResNet_18,  epoch 215, local model 79, internal_epoch   2,  Average loss: 0.0090, Accuracy: 139/154 (90.2597%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 43, internal_epoch   1,  Average loss: 0.0264, Accuracy: 223/345 (64.6377%)
___Train Local_ResNet_18,  epoch 215, local model 43, internal_epoch   2,  Average loss: 0.0098, Accuracy: 289/345 (83.7681%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 63, internal_epoch   1,  Average loss: 0.0225, Accuracy: 491/752 (65.2926%)
___Train Local_ResNet_18,  epoch 215, local model 63, internal_epoch   2,  Average loss: 0.0114, Accuracy: 593/752 (78.8564%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 3.1102, Accuracy: 3386/10000 (33.8600%)
___Train Local_ResNet_18,  epoch 215, local model 35, internal_epoch   1,  Average loss: 0.0265, Accuracy: 255/419 (60.8592%)
___Train Local_ResNet_18,  epoch 215, local model 35, internal_epoch   2,  Average loss: 0.0124, Accuracy: 333/419 (79.4749%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 49, internal_epoch   1,  Average loss: 0.0263, Accuracy: 268/426 (62.9108%)
___Train Local_ResNet_18,  epoch 215, local model 49, internal_epoch   2,  Average loss: 0.0077, Accuracy: 355/426 (83.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 363.59703302383423
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4412384161752317  data num: [526, 527, 496, 546, 557, 154, 345, 752, 419, 426]
[rfa agg] considering poison per batch poison_fraction: 0.034471751263689974
[rfa agg] init. name: [17, 33, 77, 11, 4, 79, 43, 63, 35, 49], weight: tensor([0.1108, 0.1110, 0.1045, 0.1150, 0.1173, 0.0324, 0.0727, 0.1584, 0.0882,
        0.0897])
[rfa agg] iter:  0, prev_obj_val: 11566.0263671875, obj_val: 11405.787109375, abs dis: 160.2392578125
[rfa agg] iter:  0, weight: tensor([0.0914, 0.0916, 0.1071, 0.0950, 0.1292, 0.0355, 0.0798, 0.1748, 0.0970,
        0.0986])
[rfa agg] iter:  1, prev_obj_val: 11405.787109375, obj_val: 11254.5693359375, abs dis: 151.2177734375
[rfa agg] iter:  1, weight: tensor([0.0788, 0.0789, 0.0903, 0.0818, 0.1408, 0.0387, 0.0869, 0.1906, 0.1057,
        0.1075])
[rfa agg] iter:  2, prev_obj_val: 11254.5693359375, obj_val: 11114.9814453125, abs dis: 139.587890625
[rfa agg] iter:  2, weight: tensor([0.0669, 0.0671, 0.0755, 0.0695, 0.1515, 0.0416, 0.0935, 0.2052, 0.1137,
        0.1156])
[rfa agg] iter:  3, prev_obj_val: 11114.9814453125, obj_val: 10988.5908203125, abs dis: 126.390625
[rfa agg] iter:  3, weight: tensor([0.0561, 0.0562, 0.0625, 0.0583, 0.1611, 0.0442, 0.0994, 0.2184, 0.1209,
        0.1229])
[rfa agg] iter:  4, prev_obj_val: 10988.5908203125, obj_val: 10877.486328125, abs dis: 111.1044921875
[rfa agg] iter:  4, weight: tensor([0.0465, 0.0466, 0.0512, 0.0483, 0.1697, 0.0464, 0.1046, 0.2302, 0.1272,
        0.1293])
[rfa agg] iter:  5, prev_obj_val: 10877.486328125, obj_val: 10781.1376953125, abs dis: 96.3486328125
[rfa agg] iter:  5, weight: tensor([0.0381, 0.0382, 0.0417, 0.0396, 0.1770, 0.0484, 0.1090, 0.2405, 0.1326,
        0.1349])
[rfa agg] iter:  6, prev_obj_val: 10781.1376953125, obj_val: 10699.0107421875, abs dis: 82.126953125
[rfa agg] iter:  6, weight: tensor([0.0310, 0.0310, 0.0336, 0.0322, 0.1833, 0.0500, 0.1127, 0.2494, 0.1372,
        0.1395])
[rfa agg] iter:  7, prev_obj_val: 10699.0107421875, obj_val: 10630.5791015625, abs dis: 68.431640625
[rfa agg] iter:  7, weight: tensor([0.0249, 0.0250, 0.0269, 0.0259, 0.1887, 0.0512, 0.1158, 0.2570, 0.1411,
        0.1434])
[rfa agg] iter:  8, prev_obj_val: 10630.5791015625, obj_val: 10574.2568359375, abs dis: 56.322265625
[rfa agg] iter:  8, weight: tensor([0.0200, 0.0200, 0.0215, 0.0207, 0.1931, 0.0522, 0.1183, 0.2636, 0.1442,
        0.1466])
[rfa agg] iter:  9, prev_obj_val: 10574.2568359375, obj_val: 10527.9375, abs dis: 46.3193359375
[rfa agg] iter:  9, weight: tensor([0.0159, 0.0159, 0.0170, 0.0165, 0.1967, 0.0529, 0.1201, 0.2694, 0.1466,
        0.1490])
___Test Target_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 466.43502831459045 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:216 choose agents : [17, 33, 77, 11, 8, 12, 18, 94, 57, 83]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   1,  Average loss: 0.0019, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   2,  Average loss: 0.0020, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   3,  Average loss: 0.0018, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   4,  Average loss: 0.0024, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   5,  Average loss: 0.0013, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   6,  Average loss: 0.0024, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Global model norm: 44.58152178830303.
Norm before scaling: 44.35435809513255. Distance: 4.3703837427436385
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.8636, Accuracy: 5068/10000 (50.6800%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.1153, Accuracy: 8726/9000 (96.9556%)
Scaling by  100
Scaled Norm after poisoning: 434.81001598399274, distance: 437.0384172186697
Total norm for 4 adversaries is: 434.81001598399274. distance: 437.0384172186697
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   1,  Average loss: 0.0019, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   2,  Average loss: 0.0019, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   3,  Average loss: 0.0011, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   4,  Average loss: 0.0013, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   5,  Average loss: 0.0013, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   6,  Average loss: 0.0020, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Global model norm: 44.58152178830303.
Norm before scaling: 44.31547090931183. Distance: 3.7884060320498745
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.7733, Accuracy: 5534/10000 (55.3400%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.1085, Accuracy: 8766/9000 (97.4000%)
Scaling by  100
Scaled Norm after poisoning: 376.4404210828056, distance: 378.8405626051677
Total norm for 4 adversaries is: 376.4404210828056. distance: 378.8405626051677
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   1,  Average loss: 0.0020, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   2,  Average loss: 0.0007, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   3,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 44.58152178830303.
Norm before scaling: 44.260379586848046. Distance: 2.4241992257524783
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.6118, Accuracy: 5611/10000 (56.1100%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.1484, Accuracy: 8691/9000 (96.5667%)
Scaling by  100
Scaled Norm after poisoning: 239.40371074557302, distance: 242.4199046205777
Total norm for 4 adversaries is: 239.40371074557302. distance: 242.4199046205777
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   2,  Average loss: 0.0008, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   3,  Average loss: 0.0006, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   4,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   5,  Average loss: 0.0007, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 44.58152178830303.
Norm before scaling: 44.16327405651244. Distance: 2.169112829809649
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.5854, Accuracy: 5701/10000 (57.0100%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.0933, Accuracy: 8741/9000 (97.1222%)
Scaling by  100
Scaled Norm after poisoning: 211.7919084856643, distance: 216.91128118714803
Total norm for 4 adversaries is: 211.7919084856643. distance: 216.91128118714803
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 216, local model 8, internal_epoch   1,  Average loss: 0.0221, Accuracy: 332/534 (62.1723%)
___Train Local_ResNet_18,  epoch 216, local model 8, internal_epoch   2,  Average loss: 0.0081, Accuracy: 442/534 (82.7715%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 3.9170, Accuracy: 3009/10000 (30.0900%)
___Train Local_ResNet_18,  epoch 216, local model 12, internal_epoch   1,  Average loss: 0.0216, Accuracy: 642/977 (65.7114%)
___Train Local_ResNet_18,  epoch 216, local model 12, internal_epoch   2,  Average loss: 0.0093, Accuracy: 789/977 (80.7574%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 2.7778, Accuracy: 3368/10000 (33.6800%)
___Train Local_ResNet_18,  epoch 216, local model 18, internal_epoch   1,  Average loss: 0.0230, Accuracy: 248/386 (64.2487%)
___Train Local_ResNet_18,  epoch 216, local model 18, internal_epoch   2,  Average loss: 0.0224, Accuracy: 276/386 (71.5026%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 30.4754, Accuracy: 1641/10000 (16.4100%)
___Train Local_ResNet_18,  epoch 216, local model 94, internal_epoch   1,  Average loss: 0.0279, Accuracy: 119/203 (58.6207%)
___Train Local_ResNet_18,  epoch 216, local model 94, internal_epoch   2,  Average loss: 0.0061, Accuracy: 185/203 (91.1330%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 7.1266, Accuracy: 2334/10000 (23.3400%)
___Train Local_ResNet_18,  epoch 216, local model 57, internal_epoch   1,  Average loss: 0.0211, Accuracy: 183/290 (63.1034%)
___Train Local_ResNet_18,  epoch 216, local model 57, internal_epoch   2,  Average loss: 0.0058, Accuracy: 255/290 (87.9310%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 8.1074, Accuracy: 2864/10000 (28.6400%)
___Train Local_ResNet_18,  epoch 216, local model 83, internal_epoch   1,  Average loss: 0.0221, Accuracy: 230/366 (62.8415%)
___Train Local_ResNet_18,  epoch 216, local model 83, internal_epoch   2,  Average loss: 0.0069, Accuracy: 314/366 (85.7923%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 4.5736, Accuracy: 3514/10000 (35.1400%)
time spent on training: 339.86231422424316
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4318697175840033  data num: [526, 527, 496, 546, 534, 977, 386, 203, 290, 366]
[rfa agg] considering poison per batch poison_fraction: 0.033739821686250254
[rfa agg] init. name: [17, 33, 77, 11, 8, 12, 18, 94, 57, 83], weight: tensor([0.1084, 0.1086, 0.1022, 0.1126, 0.1101, 0.2014, 0.0796, 0.0418, 0.0598,
        0.0754])
[rfa agg] iter:  0, prev_obj_val: 11495.6962890625, obj_val: 11283.8935546875, abs dis: 211.802734375
[rfa agg] iter:  0, weight: tensor([0.0872, 0.0874, 0.1018, 0.0906, 0.1226, 0.2256, 0.0884, 0.0464, 0.0663,
        0.0838])
[rfa agg] iter:  1, prev_obj_val: 11283.8935546875, obj_val: 11086.19140625, abs dis: 197.7021484375
[rfa agg] iter:  1, weight: tensor([0.0729, 0.0731, 0.0831, 0.0757, 0.1345, 0.2480, 0.0971, 0.0509, 0.0728,
        0.0919])
[rfa agg] iter:  2, prev_obj_val: 11086.19140625, obj_val: 10908.658203125, abs dis: 177.533203125
[rfa agg] iter:  2, weight: tensor([0.0598, 0.0600, 0.0670, 0.0621, 0.1453, 0.2683, 0.1048, 0.0549, 0.0785,
        0.0992])
[rfa agg] iter:  3, prev_obj_val: 10908.658203125, obj_val: 10753.71875, abs dis: 154.939453125
[rfa agg] iter:  3, weight: tensor([0.0483, 0.0484, 0.0534, 0.0502, 0.1547, 0.2861, 0.1115, 0.0584, 0.0835,
        0.1055])
[rfa agg] iter:  4, prev_obj_val: 10753.71875, obj_val: 10621.974609375, abs dis: 131.744140625
[rfa agg] iter:  4, weight: tensor([0.0384, 0.0385, 0.0421, 0.0399, 0.1626, 0.3016, 0.1171, 0.0612, 0.0876,
        0.1108])
[rfa agg] iter:  5, prev_obj_val: 10621.974609375, obj_val: 10514.0224609375, abs dis: 107.9521484375
[rfa agg] iter:  5, weight: tensor([0.0302, 0.0303, 0.0328, 0.0314, 0.1692, 0.3149, 0.1217, 0.0635, 0.0910,
        0.1151])
[rfa agg] iter:  6, prev_obj_val: 10514.0224609375, obj_val: 10426.2041015625, abs dis: 87.818359375
[rfa agg] iter:  6, weight: tensor([0.0235, 0.0236, 0.0254, 0.0244, 0.1744, 0.3261, 0.1253, 0.0653, 0.0935,
        0.1184])
[rfa agg] iter:  7, prev_obj_val: 10426.2041015625, obj_val: 10354.857421875, abs dis: 71.3466796875
[rfa agg] iter:  7, weight: tensor([0.0182, 0.0182, 0.0196, 0.0189, 0.1785, 0.3358, 0.1280, 0.0665, 0.0954,
        0.1209])
[rfa agg] iter:  8, prev_obj_val: 10354.857421875, obj_val: 10298.7607421875, abs dis: 56.0966796875
[rfa agg] iter:  8, weight: tensor([0.0139, 0.0139, 0.0149, 0.0144, 0.1816, 0.3447, 0.1299, 0.0673, 0.0966,
        0.1226])
[rfa agg] iter:  9, prev_obj_val: 10298.7607421875, obj_val: 10254.86328125, abs dis: 43.8974609375
[rfa agg] iter:  9, weight: tensor([0.0105, 0.0106, 0.0113, 0.0109, 0.1839, 0.3532, 0.1312, 0.0676, 0.0973,
        0.1236])
___Test Target_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.1024, Accuracy: 6457/10000 (64.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.2075, Accuracy: 8534/9000 (94.8222%)
Done in 466.48270893096924 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:217 choose agents : [17, 33, 77, 11, 37, 22, 38, 65, 29, 18]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   1,  Average loss: 0.0011, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 525/526 (99.8099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   3,  Average loss: 0.0006, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   4,  Average loss: 0.0012, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   5,  Average loss: 0.0017, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   6,  Average loss: 0.0023, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Global model norm: 44.370691912356406.
Norm before scaling: 44.107574739652854. Distance: 3.912002965781681
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 2.8544, Accuracy: 4323/10000 (43.2300%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.2340, Accuracy: 8579/9000 (95.3222%)
Scaling by  100
Scaled Norm after poisoning: 388.7775512745045, distance: 391.20025642246196
Total norm for 4 adversaries is: 388.7775512745045. distance: 391.20025642246196
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   1,  Average loss: 0.0014, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   2,  Average loss: 0.0010, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   3,  Average loss: 0.0005, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   4,  Average loss: 0.0009, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   5,  Average loss: 0.0010, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   6,  Average loss: 0.0004, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Global model norm: 44.370691912356406.
Norm before scaling: 44.01863397152108. Distance: 2.818589040554673
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.7472, Accuracy: 5304/10000 (53.0400%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.1496, Accuracy: 8692/9000 (96.5778%)
Scaling by  100
Scaled Norm after poisoning: 278.4007200736018, distance: 281.85892415355596
Total norm for 4 adversaries is: 278.4007200736018. distance: 281.85892415355596
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   1,  Average loss: 0.0014, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   3,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   4,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   5,  Average loss: 0.0000, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 44.370691912356406.
Norm before scaling: 44.00772026996371. Distance: 1.597279250006849
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.4083, Accuracy: 6065/10000 (60.6500%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.1173, Accuracy: 8761/9000 (97.3444%)
Scaling by  100
Scaled Norm after poisoning: 154.97981849461885, distance: 159.72794253041639
Total norm for 4 adversaries is: 154.97981849461885. distance: 159.72794253041639
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   1,  Average loss: 0.0011, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   2,  Average loss: 0.0005, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   3,  Average loss: 0.0008, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   4,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 44.370691912356406.
Norm before scaling: 43.95956088456825. Distance: 1.9918050361461614
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.4770, Accuracy: 6015/10000 (60.1500%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.1237, Accuracy: 8737/9000 (97.0778%)
Scaling by  100
Scaled Norm after poisoning: 193.94164916605715, distance: 199.1804987787459
Total norm for 4 adversaries is: 193.94164916605715. distance: 199.1804987787459
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 217, local model 37, internal_epoch   1,  Average loss: 0.0250, Accuracy: 468/725 (64.5517%)
___Train Local_ResNet_18,  epoch 217, local model 37, internal_epoch   2,  Average loss: 0.0132, Accuracy: 502/725 (69.2414%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 3.5897, Accuracy: 2659/10000 (26.5900%)
___Train Local_ResNet_18,  epoch 217, local model 22, internal_epoch   1,  Average loss: 0.0232, Accuracy: 310/494 (62.7530%)
___Train Local_ResNet_18,  epoch 217, local model 22, internal_epoch   2,  Average loss: 0.0069, Accuracy: 436/494 (88.2591%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 5.1196, Accuracy: 3491/10000 (34.9100%)
___Train Local_ResNet_18,  epoch 217, local model 38, internal_epoch   1,  Average loss: 0.0173, Accuracy: 529/756 (69.9735%)
___Train Local_ResNet_18,  epoch 217, local model 38, internal_epoch   2,  Average loss: 0.0078, Accuracy: 646/756 (85.4497%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 3.3614, Accuracy: 3572/10000 (35.7200%)
___Train Local_ResNet_18,  epoch 217, local model 65, internal_epoch   1,  Average loss: 0.0251, Accuracy: 193/314 (61.4650%)
___Train Local_ResNet_18,  epoch 217, local model 65, internal_epoch   2,  Average loss: 0.0064, Accuracy: 271/314 (86.3057%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 8.9648, Accuracy: 2172/10000 (21.7200%)
___Train Local_ResNet_18,  epoch 217, local model 29, internal_epoch   1,  Average loss: 0.0192, Accuracy: 620/848 (73.1132%)
___Train Local_ResNet_18,  epoch 217, local model 29, internal_epoch   2,  Average loss: 0.0082, Accuracy: 722/848 (85.1415%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 5.1649, Accuracy: 2773/10000 (27.7300%)
___Train Local_ResNet_18,  epoch 217, local model 18, internal_epoch   1,  Average loss: 0.0326, Accuracy: 252/386 (65.2850%)
___Train Local_ResNet_18,  epoch 217, local model 18, internal_epoch   2,  Average loss: 0.0130, Accuracy: 289/386 (74.8705%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 5.3099, Accuracy: 2231/10000 (22.3100%)
time spent on training: 336.9772479534149
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.37290850836596656  data num: [526, 527, 496, 546, 725, 494, 756, 314, 848, 386]
[rfa agg] considering poison per batch poison_fraction: 0.029133477216091136
[rfa agg] init. name: [17, 33, 77, 11, 37, 22, 38, 65, 29, 18], weight: tensor([0.0936, 0.0938, 0.0883, 0.0972, 0.1290, 0.0879, 0.1346, 0.0559, 0.1509,
        0.0687])
[rfa agg] iter:  0, prev_obj_val: 10949.3681640625, obj_val: 10279.4873046875, abs dis: 669.880859375
[rfa agg] iter:  0, weight: tensor([0.0625, 0.0627, 0.0715, 0.0649, 0.1521, 0.1032, 0.1586, 0.0654, 0.1783,
        0.0806])
[rfa agg] iter:  1, prev_obj_val: 10279.4873046875, obj_val: 9755.2421875, abs dis: 524.2451171875
[rfa agg] iter:  1, weight: tensor([0.0417, 0.0418, 0.0462, 0.0433, 0.1705, 0.1155, 0.1778, 0.0731, 0.2000,
        0.0901])
[rfa agg] iter:  2, prev_obj_val: 9755.2421875, obj_val: 9381.12890625, abs dis: 374.11328125
[rfa agg] iter:  2, weight: tensor([0.0266, 0.0267, 0.0290, 0.0276, 0.1837, 0.1241, 0.1915, 0.0783, 0.2158,
        0.0967])
[rfa agg] iter:  3, prev_obj_val: 9381.12890625, obj_val: 9130.9775390625, abs dis: 250.1513671875
[rfa agg] iter:  3, weight: tensor([0.0164, 0.0165, 0.0177, 0.0171, 0.1927, 0.1295, 0.2009, 0.0814, 0.2270,
        0.1008])
[rfa agg] iter:  4, prev_obj_val: 9130.9775390625, obj_val: 8969.5302734375, abs dis: 161.447265625
[rfa agg] iter:  4, weight: tensor([0.0099, 0.0099, 0.0106, 0.0103, 0.1988, 0.1324, 0.2073, 0.0827, 0.2352,
        0.1029])
[rfa agg] iter:  5, prev_obj_val: 8969.5302734375, obj_val: 8870.6396484375, abs dis: 98.890625
[rfa agg] iter:  5, weight: tensor([0.0058, 0.0058, 0.0062, 0.0060, 0.2032, 0.1332, 0.2119, 0.0824, 0.2424,
        0.1031])
[rfa agg] iter:  6, prev_obj_val: 8870.6396484375, obj_val: 8812.7099609375, abs dis: 57.9296875
[rfa agg] iter:  6, weight: tensor([0.0033, 0.0033, 0.0036, 0.0035, 0.2068, 0.1319, 0.2157, 0.0800, 0.2505,
        0.1014])
[rfa agg] iter:  7, prev_obj_val: 8812.7099609375, obj_val: 8777.5830078125, abs dis: 35.126953125
[rfa agg] iter:  7, weight: tensor([0.0019, 0.0019, 0.0020, 0.0020, 0.2103, 0.1279, 0.2194, 0.0752, 0.2620,
        0.0973])
[rfa agg] iter:  8, prev_obj_val: 8777.5830078125, obj_val: 8755.1845703125, abs dis: 22.3984375
[rfa agg] iter:  8, weight: tensor([0.0010, 0.0010, 0.0011, 0.0011, 0.2143, 0.1192, 0.2238, 0.0665, 0.2831,
        0.0889])
[rfa agg] iter:  9, prev_obj_val: 8755.1845703125, obj_val: 8744.900390625, abs dis: 10.2841796875
[rfa agg] iter:  9, weight: tensor([0.0004, 0.0004, 0.0005, 0.0005, 0.2151, 0.0970, 0.2261, 0.0490, 0.3413,
        0.0697])
___Test Target_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.0358, Accuracy: 6533/10000 (65.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.2909, Accuracy: 8342/9000 (92.6889%)
Done in 469.0169005393982 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:218 choose agents : [17, 33, 77, 11, 53, 15, 7, 29, 86, 60]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   3,  Average loss: 0.0006, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   4,  Average loss: 0.0004, Accuracy: 525/526 (99.8099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   5,  Average loss: 0.0008, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   6,  Average loss: 0.0011, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Global model norm: 44.31756709172659.
Norm before scaling: 43.93227098152052. Distance: 2.5115136141384315
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.5810, Accuracy: 5528/10000 (55.2800%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.0363, Accuracy: 8892/9000 (98.8000%)
Scaling by  100
Scaled Norm after poisoning: 247.00221405890272, distance: 251.15136434528878
Total norm for 4 adversaries is: 247.00221405890272. distance: 251.15136434528878
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   1,  Average loss: 0.0016, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   2,  Average loss: 0.0014, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   3,  Average loss: 0.0009, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   4,  Average loss: 0.0006, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   5,  Average loss: 0.0011, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   6,  Average loss: 0.0014, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Global model norm: 44.31756709172659.
Norm before scaling: 44.06543513052138. Distance: 3.8193107180834462
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.7813, Accuracy: 5322/10000 (53.2200%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.1425, Accuracy: 8626/9000 (95.8444%)
Scaling by  100
Scaled Norm after poisoning: 379.6687083827162, distance: 381.93109244338825
Total norm for 4 adversaries is: 379.6687083827162. distance: 381.93109244338825
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   1,  Average loss: 0.0015, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   2,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   3,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   4,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 44.31756709172659.
Norm before scaling: 43.96493103750775. Distance: 1.6286068282068444
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.3315, Accuracy: 6096/10000 (60.9600%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.0771, Accuracy: 8817/9000 (97.9667%)
Scaling by  100
Scaled Norm after poisoning: 158.45911464988373, distance: 162.86069943935215
Total norm for 4 adversaries is: 158.45911464988373. distance: 162.86069943935215
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   1,  Average loss: 0.0013, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   2,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   3,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   4,  Average loss: 0.0002, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   5,  Average loss: 0.0001, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 44.31756709172659.
Norm before scaling: 43.90871462166209. Distance: 1.740195259998996
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.4812, Accuracy: 5908/10000 (59.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.0849, Accuracy: 8777/9000 (97.5222%)
Scaling by  100
Scaled Norm after poisoning: 168.33567191032327, distance: 174.01953576574385
Total norm for 4 adversaries is: 168.33567191032327. distance: 174.01953576574385
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 218, local model 53, internal_epoch   1,  Average loss: 0.0192, Accuracy: 424/625 (67.8400%)
___Train Local_ResNet_18,  epoch 218, local model 53, internal_epoch   2,  Average loss: 0.0073, Accuracy: 535/625 (85.6000%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 3.6164, Accuracy: 3155/10000 (31.5500%)
___Train Local_ResNet_18,  epoch 218, local model 15, internal_epoch   1,  Average loss: 0.0230, Accuracy: 228/341 (66.8622%)
___Train Local_ResNet_18,  epoch 218, local model 15, internal_epoch   2,  Average loss: 0.0069, Accuracy: 305/341 (89.4428%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 4.5688, Accuracy: 2765/10000 (27.6500%)
___Train Local_ResNet_18,  epoch 218, local model 7, internal_epoch   1,  Average loss: 0.0195, Accuracy: 226/352 (64.2045%)
___Train Local_ResNet_18,  epoch 218, local model 7, internal_epoch   2,  Average loss: 0.0052, Accuracy: 318/352 (90.3409%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 5.7673, Accuracy: 2611/10000 (26.1100%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   1,  Average loss: 0.0147, Accuracy: 649/848 (76.5330%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   2,  Average loss: 0.0070, Accuracy: 732/848 (86.3208%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 3.4804, Accuracy: 3497/10000 (34.9700%)
___Train Local_ResNet_18,  epoch 218, local model 86, internal_epoch   1,  Average loss: 0.0240, Accuracy: 130/212 (61.3208%)
___Train Local_ResNet_18,  epoch 218, local model 86, internal_epoch   2,  Average loss: 0.0060, Accuracy: 192/212 (90.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 4.9381, Accuracy: 2342/10000 (23.4200%)
___Train Local_ResNet_18,  epoch 218, local model 60, internal_epoch   1,  Average loss: 0.0196, Accuracy: 178/284 (62.6761%)
___Train Local_ResNet_18,  epoch 218, local model 60, internal_epoch   2,  Average loss: 0.0064, Accuracy: 253/284 (89.0845%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 4.2527, Accuracy: 3063/10000 (30.6300%)
time spent on training: 364.48366022109985
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4404036157241959  data num: [526, 527, 496, 546, 625, 341, 352, 848, 212, 284]
[rfa agg] considering poison per batch poison_fraction: 0.0344065324784528
[rfa agg] init. name: [17, 33, 77, 11, 53, 15, 7, 29, 86, 60], weight: tensor([0.1106, 0.1108, 0.1043, 0.1148, 0.1314, 0.0717, 0.0740, 0.1783, 0.0446,
        0.0597])
[rfa agg] iter:  0, prev_obj_val: 11549.578125, obj_val: 11384.640625, abs dis: 164.9375
[rfa agg] iter:  0, weight: tensor([0.0910, 0.0912, 0.1066, 0.0945, 0.1449, 0.0788, 0.0813, 0.1973, 0.0489,
        0.0656])
[rfa agg] iter:  1, prev_obj_val: 11384.640625, obj_val: 11230.4140625, abs dis: 154.2265625
[rfa agg] iter:  1, weight: tensor([0.0782, 0.0783, 0.0895, 0.0811, 0.1581, 0.0859, 0.0887, 0.2154, 0.0533,
        0.0715])
[rfa agg] iter:  2, prev_obj_val: 11230.4140625, obj_val: 11087.951171875, abs dis: 142.462890625
[rfa agg] iter:  2, weight: tensor([0.0662, 0.0664, 0.0746, 0.0688, 0.1701, 0.0924, 0.0954, 0.2319, 0.0573,
        0.0769])
[rfa agg] iter:  3, prev_obj_val: 11087.951171875, obj_val: 10959.3740234375, abs dis: 128.5771484375
[rfa agg] iter:  3, weight: tensor([0.0554, 0.0555, 0.0616, 0.0575, 0.1810, 0.0982, 0.1014, 0.2469, 0.0609,
        0.0817])
[rfa agg] iter:  4, prev_obj_val: 10959.3740234375, obj_val: 10846.2802734375, abs dis: 113.09375
[rfa agg] iter:  4, weight: tensor([0.0457, 0.0458, 0.0503, 0.0475, 0.1906, 0.1033, 0.1066, 0.2603, 0.0640,
        0.0859])
[rfa agg] iter:  5, prev_obj_val: 10846.2802734375, obj_val: 10748.6640625, abs dis: 97.6162109375
[rfa agg] iter:  5, weight: tensor([0.0374, 0.0374, 0.0408, 0.0388, 0.1988, 0.1076, 0.1111, 0.2720, 0.0666,
        0.0894])
[rfa agg] iter:  6, prev_obj_val: 10748.6640625, obj_val: 10666.5185546875, abs dis: 82.1455078125
[rfa agg] iter:  6, weight: tensor([0.0302, 0.0303, 0.0328, 0.0314, 0.2059, 0.1112, 0.1148, 0.2822, 0.0688,
        0.0924])
[rfa agg] iter:  7, prev_obj_val: 10666.5185546875, obj_val: 10598.24609375, abs dis: 68.2724609375
[rfa agg] iter:  7, weight: tensor([0.0243, 0.0243, 0.0262, 0.0252, 0.2118, 0.1141, 0.1178, 0.2910, 0.0705,
        0.0948])
[rfa agg] iter:  8, prev_obj_val: 10598.24609375, obj_val: 10541.1767578125, abs dis: 57.0693359375
[rfa agg] iter:  8, weight: tensor([0.0194, 0.0194, 0.0209, 0.0201, 0.2167, 0.1164, 0.1202, 0.2986, 0.0718,
        0.0966])
[rfa agg] iter:  9, prev_obj_val: 10541.1767578125, obj_val: 10493.7109375, abs dis: 47.4658203125
[rfa agg] iter:  9, weight: tensor([0.0153, 0.0154, 0.0164, 0.0159, 0.2207, 0.1181, 0.1219, 0.3055, 0.0728,
        0.0979])
___Test Target_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.0642, Accuracy: 6545/10000 (65.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.1223, Accuracy: 8698/9000 (96.6444%)
Done in 477.43989968299866 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:219 choose agents : [17, 33, 77, 11, 81, 8, 28, 1, 93, 53]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   1,  Average loss: 0.0008, Accuracy: 525/526 (99.8099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   2,  Average loss: 0.0003, Accuracy: 525/526 (99.8099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   3,  Average loss: 0.0003, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   4,  Average loss: 0.0006, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   5,  Average loss: 0.0018, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   6,  Average loss: 0.0012, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Global model norm: 44.03082444125436.
Norm before scaling: 43.605469974749155. Distance: 1.9452417812744942
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.5418, Accuracy: 5736/10000 (57.3600%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.2217, Accuracy: 8541/9000 (94.9000%)
Scaling by  100
Scaled Norm after poisoning: 188.8711738527084, distance: 194.5241790883591
Total norm for 4 adversaries is: 188.8711738527084. distance: 194.5241790883591
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   1,  Average loss: 0.0010, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   2,  Average loss: 0.0006, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   3,  Average loss: 0.0005, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   4,  Average loss: 0.0002, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   5,  Average loss: 0.0002, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   6,  Average loss: 0.0001, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Global model norm: 44.03082444125436.
Norm before scaling: 43.64530721391333. Distance: 2.054648395354771
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.4858, Accuracy: 5946/10000 (59.4600%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.0982, Accuracy: 8777/9000 (97.5222%)
Scaling by  100
Scaled Norm after poisoning: 200.87882113664944, distance: 205.46484074227882
Total norm for 4 adversaries is: 200.87882113664944. distance: 205.46484074227882
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   1,  Average loss: 0.0011, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   2,  Average loss: 0.0005, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   3,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   4,  Average loss: 0.0001, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   5,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 44.03082444125436.
Norm before scaling: 43.67789677848726. Distance: 1.6552107087348937
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.3898, Accuracy: 6016/10000 (60.1600%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.0961, Accuracy: 8796/9000 (97.7333%)
Scaling by  100
Scaled Norm after poisoning: 161.14119391080607, distance: 165.52107588612395
Total norm for 4 adversaries is: 161.14119391080607. distance: 165.52107588612395
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   2,  Average loss: 0.0001, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   3,  Average loss: 0.0005, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   4,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   6,  Average loss: 0.0001, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 44.03082444125436.
Norm before scaling: 43.598624839444476. Distance: 1.4234067609966508
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.4117, Accuracy: 6124/10000 (61.2400%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.1972, Accuracy: 8591/9000 (95.4556%)
Scaling by  100
Scaled Norm after poisoning: 134.94312314592025, distance: 142.34067299089182
Total norm for 4 adversaries is: 134.94312314592025. distance: 142.34067299089182
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 219, local model 81, internal_epoch   1,  Average loss: 0.0156, Accuracy: 769/1034 (74.3714%)
___Train Local_ResNet_18,  epoch 219, local model 81, internal_epoch   2,  Average loss: 0.0079, Accuracy: 867/1034 (83.8491%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 3.3356, Accuracy: 4110/10000 (41.1000%)
___Train Local_ResNet_18,  epoch 219, local model 8, internal_epoch   1,  Average loss: 0.0174, Accuracy: 346/534 (64.7940%)
___Train Local_ResNet_18,  epoch 219, local model 8, internal_epoch   2,  Average loss: 0.0061, Accuracy: 464/534 (86.8914%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.9086, Accuracy: 3687/10000 (36.8700%)
___Train Local_ResNet_18,  epoch 219, local model 28, internal_epoch   1,  Average loss: 0.0196, Accuracy: 283/423 (66.9031%)
___Train Local_ResNet_18,  epoch 219, local model 28, internal_epoch   2,  Average loss: 0.0066, Accuracy: 371/423 (87.7069%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 3.8765, Accuracy: 3681/10000 (36.8100%)
___Train Local_ResNet_18,  epoch 219, local model 1, internal_epoch   1,  Average loss: 0.0243, Accuracy: 435/641 (67.8627%)
___Train Local_ResNet_18,  epoch 219, local model 1, internal_epoch   2,  Average loss: 0.0144, Accuracy: 493/641 (76.9111%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 5.2177, Accuracy: 2274/10000 (22.7400%)
___Train Local_ResNet_18,  epoch 219, local model 93, internal_epoch   1,  Average loss: 0.0163, Accuracy: 429/584 (73.4589%)
___Train Local_ResNet_18,  epoch 219, local model 93, internal_epoch   2,  Average loss: 0.0095, Accuracy: 480/584 (82.1918%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 4.2963, Accuracy: 3049/10000 (30.4900%)
___Train Local_ResNet_18,  epoch 219, local model 53, internal_epoch   1,  Average loss: 0.0196, Accuracy: 408/625 (65.2800%)
___Train Local_ResNet_18,  epoch 219, local model 53, internal_epoch   2,  Average loss: 0.0059, Accuracy: 550/625 (88.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 4.9472, Accuracy: 3154/10000 (31.5400%)
time spent on training: 359.90052127838135
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.35293126684636117  data num: [526, 527, 496, 546, 1034, 534, 423, 641, 584, 625]
[rfa agg] considering poison per batch poison_fraction: 0.027572755222371965
[rfa agg] init. name: [17, 33, 77, 11, 81, 8, 28, 1, 93, 53], weight: tensor([0.0886, 0.0888, 0.0836, 0.0920, 0.1742, 0.0900, 0.0713, 0.1080, 0.0984,
        0.1053])
[rfa agg] iter:  0, prev_obj_val: 10686.7529296875, obj_val: 9831.5205078125, abs dis: 855.232421875
[rfa agg] iter:  0, weight: tensor([0.0550, 0.0551, 0.0624, 0.0571, 0.2086, 0.1068, 0.0844, 0.1285, 0.1169,
        0.1252])
[rfa agg] iter:  1, prev_obj_val: 9831.5205078125, obj_val: 9211.8369140625, abs dis: 619.68359375
[rfa agg] iter:  1, weight: tensor([0.0336, 0.0336, 0.0370, 0.0349, 0.2339, 0.1192, 0.0941, 0.1435, 0.1306,
        0.1397])
[rfa agg] iter:  2, prev_obj_val: 9211.8369140625, obj_val: 8809.2568359375, abs dis: 402.580078125
[rfa agg] iter:  2, weight: tensor([0.0195, 0.0195, 0.0211, 0.0202, 0.2513, 0.1269, 0.1000, 0.1532, 0.1392,
        0.1490])
[rfa agg] iter:  3, prev_obj_val: 8809.2568359375, obj_val: 8567.1982421875, abs dis: 242.05859375
[rfa agg] iter:  3, weight: tensor([0.0109, 0.0110, 0.0117, 0.0113, 0.2639, 0.1311, 0.1029, 0.1589, 0.1441,
        0.1542])
[rfa agg] iter:  4, prev_obj_val: 8567.1982421875, obj_val: 8426.462890625, abs dis: 140.7353515625
[rfa agg] iter:  4, weight: tensor([0.0060, 0.0060, 0.0064, 0.0062, 0.2752, 0.1325, 0.1032, 0.1618, 0.1462,
        0.1564])
[rfa agg] iter:  5, prev_obj_val: 8426.462890625, obj_val: 8347.6025390625, abs dis: 78.8603515625
[rfa agg] iter:  5, weight: tensor([0.0032, 0.0032, 0.0034, 0.0033, 0.2902, 0.1313, 0.1009, 0.1626, 0.1459,
        0.1561])
[rfa agg] iter:  6, prev_obj_val: 8347.6025390625, obj_val: 8304.3720703125, abs dis: 43.23046875
[rfa agg] iter:  6, weight: tensor([0.0016, 0.0016, 0.0017, 0.0017, 0.3178, 0.1262, 0.0945, 0.1608, 0.1421,
        0.1521])
[rfa agg] iter:  7, prev_obj_val: 8304.3720703125, obj_val: 8283.943359375, abs dis: 20.4287109375
[rfa agg] iter:  7, weight: tensor([0.0007, 0.0007, 0.0008, 0.0008, 0.3867, 0.1118, 0.0798, 0.1508, 0.1294,
        0.1385])
[rfa agg] iter:  8, prev_obj_val: 8283.943359375, obj_val: 8280.2919921875, abs dis: 3.6513671875
[rfa agg] iter:  8, weight: tensor([2.6564e-04, 2.6615e-04, 2.8204e-04, 2.7575e-04, 5.9288e-01, 7.1775e-02,
        4.7511e-02, 1.0688e-01, 8.6843e-02, 9.3019e-02])
[rfa agg] iter:  9, prev_obj_val: 8280.2919921875, obj_val: 8281.6015625, abs dis: 1.3095703125
[rfa agg] iter:  9, weight: tensor([2.0404e-04, 2.0442e-04, 2.1659e-04, 2.1180e-04, 4.0897e-01, 9.7525e-02,
        5.7702e-02, 1.7199e-01, 1.2694e-01, 1.3603e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.0037, Accuracy: 6685/10000 (66.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.2408, Accuracy: 8455/9000 (93.9444%)
Done in 484.4411528110504 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:220 choose agents : [17, 33, 77, 11, 12, 50, 10, 18, 39, 62]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   2,  Average loss: 0.0007, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   3,  Average loss: 0.0009, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   4,  Average loss: 0.0015, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   5,  Average loss: 0.0020, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   6,  Average loss: 0.0018, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Global model norm: 43.98989058446057.
Norm before scaling: 43.67830481513033. Distance: 3.46822360056881
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.6813, Accuracy: 5343/10000 (53.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.0753, Accuracy: 8792/9000 (97.6889%)
Scaling by  100
Scaled Norm after poisoning: 343.9277949294008, distance: 346.8223270818936
Total norm for 4 adversaries is: 343.9277949294008. distance: 346.8223270818936
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   1,  Average loss: 0.0019, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   2,  Average loss: 0.0008, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   3,  Average loss: 0.0008, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   4,  Average loss: 0.0009, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   5,  Average loss: 0.0005, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   6,  Average loss: 0.0006, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Global model norm: 43.98989058446057.
Norm before scaling: 43.71996318232739. Distance: 3.548150459212994
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.6392, Accuracy: 5492/10000 (54.9200%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.0884, Accuracy: 8758/9000 (97.3111%)
Scaling by  100
Scaled Norm after poisoning: 352.42351785529297, distance: 354.8150046150811
Total norm for 4 adversaries is: 352.42351785529297. distance: 354.8150046150811
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   1,  Average loss: 0.0011, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   3,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   4,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   5,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   6,  Average loss: 0.0000, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Global model norm: 43.98989058446057.
Norm before scaling: 43.63270828658101. Distance: 1.468166316503774
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.2455, Accuracy: 6345/10000 (63.4500%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.1560, Accuracy: 8686/9000 (96.5111%)
Scaling by  100
Scaled Norm after poisoning: 141.9328144867317, distance: 146.81663068901628
Total norm for 4 adversaries is: 141.9328144867317. distance: 146.81663068901628
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   2,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   3,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   4,  Average loss: 0.0007, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 43.98989058446057.
Norm before scaling: 43.57324786709731. Distance: 1.8441136534952085
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.3993, Accuracy: 5964/10000 (59.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.1174, Accuracy: 8693/9000 (96.5889%)
Scaling by  100
Scaled Norm after poisoning: 178.75767028997666, distance: 184.41136293962472
Total norm for 4 adversaries is: 178.75767028997666. distance: 184.41136293962472
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 220, local model 12, internal_epoch   1,  Average loss: 0.0157, Accuracy: 719/977 (73.5926%)
___Train Local_ResNet_18,  epoch 220, local model 12, internal_epoch   2,  Average loss: 0.0104, Accuracy: 787/977 (80.5527%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 3.6680, Accuracy: 3455/10000 (34.5500%)
___Train Local_ResNet_18,  epoch 220, local model 50, internal_epoch   1,  Average loss: 0.0158, Accuracy: 301/401 (75.0623%)
___Train Local_ResNet_18,  epoch 220, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 366/401 (91.2718%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 4.7408, Accuracy: 3090/10000 (30.9000%)
___Train Local_ResNet_18,  epoch 220, local model 10, internal_epoch   1,  Average loss: 0.0123, Accuracy: 578/752 (76.8617%)
___Train Local_ResNet_18,  epoch 220, local model 10, internal_epoch   2,  Average loss: 0.0052, Accuracy: 682/752 (90.6915%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 6.2954, Accuracy: 2983/10000 (29.8300%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   1,  Average loss: 0.0173, Accuracy: 268/386 (69.4301%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   2,  Average loss: 0.0103, Accuracy: 313/386 (81.0881%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 6.4732, Accuracy: 2238/10000 (22.3800%)
___Train Local_ResNet_18,  epoch 220, local model 39, internal_epoch   1,  Average loss: 0.0236, Accuracy: 131/217 (60.3687%)
___Train Local_ResNet_18,  epoch 220, local model 39, internal_epoch   2,  Average loss: 0.0054, Accuracy: 198/217 (91.2442%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 8.4213, Accuracy: 1948/10000 (19.4800%)
___Train Local_ResNet_18,  epoch 220, local model 62, internal_epoch   1,  Average loss: 0.0179, Accuracy: 242/358 (67.5978%)
___Train Local_ResNet_18,  epoch 220, local model 62, internal_epoch   2,  Average loss: 0.0041, Accuracy: 333/358 (93.0168%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 3.2573, Accuracy: 3418/10000 (34.1800%)
time spent on training: 336.0382237434387
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.40397223293482454  data num: [526, 527, 496, 546, 977, 401, 752, 386, 217, 358]
[rfa agg] considering poison per batch poison_fraction: 0.03156033069803317
[rfa agg] init. name: [17, 33, 77, 11, 12, 50, 10, 18, 39, 62], weight: tensor([0.1014, 0.1016, 0.0956, 0.1053, 0.1884, 0.0773, 0.1450, 0.0744, 0.0418,
        0.0690])
[rfa agg] iter:  0, prev_obj_val: 11276.9267578125, obj_val: 10872.9423828125, abs dis: 403.984375
[rfa agg] iter:  0, weight: tensor([0.0752, 0.0754, 0.0869, 0.0781, 0.2174, 0.0885, 0.1667, 0.0852, 0.0477,
        0.0789])
[rfa agg] iter:  1, prev_obj_val: 10872.9423828125, obj_val: 10522.306640625, abs dis: 350.6357421875
[rfa agg] iter:  1, weight: tensor([0.0570, 0.0571, 0.0640, 0.0592, 0.2426, 0.0985, 0.1858, 0.0948, 0.0531,
        0.0878])
[rfa agg] iter:  2, prev_obj_val: 10522.306640625, obj_val: 10235.291015625, abs dis: 287.015625
[rfa agg] iter:  2, weight: tensor([0.0418, 0.0419, 0.0461, 0.0434, 0.2635, 0.1066, 0.2015, 0.1026, 0.0574,
        0.0950])
[rfa agg] iter:  3, prev_obj_val: 10235.291015625, obj_val: 10011.8798828125, abs dis: 223.4111328125
[rfa agg] iter:  3, weight: tensor([0.0299, 0.0300, 0.0326, 0.0311, 0.2803, 0.1127, 0.2138, 0.1085, 0.0606,
        0.1004])
[rfa agg] iter:  4, prev_obj_val: 10011.8798828125, obj_val: 9846.048828125, abs dis: 165.8310546875
[rfa agg] iter:  4, weight: tensor([0.0210, 0.0210, 0.0226, 0.0218, 0.2935, 0.1171, 0.2231, 0.1128, 0.0628,
        0.1043])
[rfa agg] iter:  5, prev_obj_val: 9846.048828125, obj_val: 9725.763671875, abs dis: 120.28515625
[rfa agg] iter:  5, weight: tensor([0.0145, 0.0145, 0.0155, 0.0150, 0.3043, 0.1200, 0.2300, 0.1155, 0.0641,
        0.1066])
[rfa agg] iter:  6, prev_obj_val: 9725.763671875, obj_val: 9640.7099609375, abs dis: 85.0537109375
[rfa agg] iter:  6, weight: tensor([0.0099, 0.0099, 0.0105, 0.0102, 0.3138, 0.1214, 0.2352, 0.1169, 0.0645,
        0.1077])
[rfa agg] iter:  7, prev_obj_val: 9640.7099609375, obj_val: 9579.7236328125, abs dis: 60.986328125
[rfa agg] iter:  7, weight: tensor([0.0066, 0.0066, 0.0071, 0.0069, 0.3233, 0.1216, 0.2392, 0.1171, 0.0640,
        0.1076])
[rfa agg] iter:  8, prev_obj_val: 9579.7236328125, obj_val: 9538.5087890625, abs dis: 41.21484375
[rfa agg] iter:  8, weight: tensor([0.0043, 0.0043, 0.0046, 0.0045, 0.3350, 0.1203, 0.2425, 0.1158, 0.0625,
        0.1060])
[rfa agg] iter:  9, prev_obj_val: 9538.5087890625, obj_val: 9511.0634765625, abs dis: 27.4453125
[rfa agg] iter:  9, weight: tensor([0.0028, 0.0028, 0.0030, 0.0029, 0.3512, 0.1172, 0.2452, 0.1128, 0.0597,
        0.1025])
___Test Target_ResNet_18 poisoned: False, epoch: 220: Average loss: 0.9911, Accuracy: 6693/10000 (66.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.2671, Accuracy: 8419/9000 (93.5444%)
Done in 464.9240746498108 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:221 choose agents : [17, 33, 77, 11, 65, 87, 12, 74, 4, 7]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   1,  Average loss: 0.0015, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   2,  Average loss: 0.0006, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   3,  Average loss: 0.0008, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   4,  Average loss: 0.0013, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   5,  Average loss: 0.0031, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   6,  Average loss: 0.0014, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Global model norm: 43.91252874367476.
Norm before scaling: 43.54973976942199. Distance: 3.0050295947961287
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.6550, Accuracy: 5427/10000 (54.2700%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.0971, Accuracy: 8749/9000 (97.2111%)
Scaling by  100
Scaled Norm after poisoning: 296.9078139759882, distance: 300.50293779761955
Total norm for 4 adversaries is: 296.9078139759882. distance: 300.50293779761955
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   1,  Average loss: 0.0014, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   2,  Average loss: 0.0010, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   3,  Average loss: 0.0016, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   4,  Average loss: 0.0008, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   5,  Average loss: 0.0010, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   6,  Average loss: 0.0003, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Global model norm: 43.91252874367476.
Norm before scaling: 43.69802157814184. Distance: 3.8753264505021283
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.6727, Accuracy: 5464/10000 (54.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.0730, Accuracy: 8814/9000 (97.9333%)
Scaling by  100
Scaled Norm after poisoning: 385.65366587133593, distance: 387.5325994351959
Total norm for 4 adversaries is: 385.65366587133593. distance: 387.5325994351959
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   3,  Average loss: 0.0007, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Global model norm: 43.91252874367476.
Norm before scaling: 43.56587930759289. Distance: 1.5445281442119918
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.2287, Accuracy: 6362/10000 (63.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.1872, Accuracy: 8666/9000 (96.2889%)
Scaling by  100
Scaled Norm after poisoning: 150.04324246488076, distance: 154.45282704194832
Total norm for 4 adversaries is: 150.04324246488076. distance: 154.45282704194832
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   2,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   3,  Average loss: 0.0004, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   4,  Average loss: 0.0001, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   5,  Average loss: 0.0001, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 43.91252874367476.
Norm before scaling: 43.50519258923654. Distance: 1.7299563508232756
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.3917, Accuracy: 6094/10000 (60.9400%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.1408, Accuracy: 8691/9000 (96.5667%)
Scaling by  100
Scaled Norm after poisoning: 167.31911291563495, distance: 172.99563081549198
Total norm for 4 adversaries is: 167.31911291563495. distance: 172.99563081549198
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 221, local model 65, internal_epoch   1,  Average loss: 0.0214, Accuracy: 199/314 (63.3758%)
___Train Local_ResNet_18,  epoch 221, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 278/314 (88.5350%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 10.8453, Accuracy: 1370/10000 (13.7000%)
___Train Local_ResNet_18,  epoch 221, local model 87, internal_epoch   1,  Average loss: 0.0194, Accuracy: 252/397 (63.4761%)
___Train Local_ResNet_18,  epoch 221, local model 87, internal_epoch   2,  Average loss: 0.0071, Accuracy: 344/397 (86.6499%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 2.4259, Accuracy: 4247/10000 (42.4700%)
___Train Local_ResNet_18,  epoch 221, local model 12, internal_epoch   1,  Average loss: 0.0134, Accuracy: 739/977 (75.6397%)
___Train Local_ResNet_18,  epoch 221, local model 12, internal_epoch   2,  Average loss: 0.0078, Accuracy: 821/977 (84.0328%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 2.5464, Accuracy: 3888/10000 (38.8800%)
___Train Local_ResNet_18,  epoch 221, local model 74, internal_epoch   1,  Average loss: 0.0177, Accuracy: 315/469 (67.1642%)
___Train Local_ResNet_18,  epoch 221, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 429/469 (91.4712%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 2.9895, Accuracy: 3938/10000 (39.3800%)
___Train Local_ResNet_18,  epoch 221, local model 4, internal_epoch   1,  Average loss: 0.0166, Accuracy: 387/557 (69.4794%)
___Train Local_ResNet_18,  epoch 221, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 500/557 (89.7666%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 4.1253, Accuracy: 3960/10000 (39.6000%)
___Train Local_ResNet_18,  epoch 221, local model 7, internal_epoch   1,  Average loss: 0.0165, Accuracy: 238/352 (67.6136%)
___Train Local_ResNet_18,  epoch 221, local model 7, internal_epoch   2,  Average loss: 0.0036, Accuracy: 329/352 (93.4659%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 4.1389, Accuracy: 3111/10000 (31.1100%)
time spent on training: 326.02231454849243
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4059290835109475  data num: [526, 527, 496, 546, 314, 397, 977, 469, 557, 352]
[rfa agg] considering poison per batch poison_fraction: 0.03171320964929277
[rfa agg] init. name: [17, 33, 77, 11, 65, 87, 12, 74, 4, 7], weight: tensor([0.1019, 0.1021, 0.0961, 0.1058, 0.0608, 0.0769, 0.1893, 0.0909, 0.1079,
        0.0682])
[rfa agg] iter:  0, prev_obj_val: 11296.8232421875, obj_val: 10906.12890625, abs dis: 390.6943359375
[rfa agg] iter:  0, weight: tensor([0.0761, 0.0762, 0.0879, 0.0790, 0.0694, 0.0879, 0.2182, 0.1040, 0.1236,
        0.0779])
[rfa agg] iter:  1, prev_obj_val: 10906.12890625, obj_val: 10565.1650390625, abs dis: 340.9638671875
[rfa agg] iter:  1, weight: tensor([0.0580, 0.0581, 0.0652, 0.0602, 0.0772, 0.0979, 0.2435, 0.1158, 0.1376,
        0.0867])
[rfa agg] iter:  2, prev_obj_val: 10565.1650390625, obj_val: 10286.5244140625, abs dis: 278.640625
[rfa agg] iter:  2, weight: tensor([0.0428, 0.0429, 0.0473, 0.0445, 0.0836, 0.1060, 0.2646, 0.1254, 0.1492,
        0.0938])
[rfa agg] iter:  3, prev_obj_val: 10286.5244140625, obj_val: 10068.5068359375, abs dis: 218.017578125
[rfa agg] iter:  3, weight: tensor([0.0309, 0.0310, 0.0337, 0.0321, 0.0884, 0.1122, 0.2815, 0.1328, 0.1581,
        0.0993])
[rfa agg] iter:  4, prev_obj_val: 10068.5068359375, obj_val: 9902.6875, abs dis: 165.8193359375
[rfa agg] iter:  4, weight: tensor([0.0219, 0.0220, 0.0237, 0.0228, 0.0917, 0.1167, 0.2951, 0.1383, 0.1647,
        0.1032])
[rfa agg] iter:  5, prev_obj_val: 9902.6875, obj_val: 9782.3251953125, abs dis: 120.3623046875
[rfa agg] iter:  5, weight: tensor([0.0152, 0.0153, 0.0164, 0.0158, 0.0939, 0.1198, 0.3064, 0.1421, 0.1695,
        0.1057])
[rfa agg] iter:  6, prev_obj_val: 9782.3251953125, obj_val: 9695.6357421875, abs dis: 86.689453125
[rfa agg] iter:  6, weight: tensor([0.0105, 0.0105, 0.0112, 0.0109, 0.0950, 0.1215, 0.3164, 0.1444, 0.1726,
        0.1071])
[rfa agg] iter:  7, prev_obj_val: 9695.6357421875, obj_val: 9635.044921875, abs dis: 60.5908203125
[rfa agg] iter:  7, weight: tensor([0.0071, 0.0071, 0.0076, 0.0074, 0.0949, 0.1221, 0.3265, 0.1456, 0.1744,
        0.1073])
[rfa agg] iter:  8, prev_obj_val: 9635.044921875, obj_val: 9592.138671875, abs dis: 42.90625
[rfa agg] iter:  8, weight: tensor([0.0047, 0.0047, 0.0050, 0.0049, 0.0937, 0.1215, 0.3386, 0.1454, 0.1750,
        0.1064])
[rfa agg] iter:  9, prev_obj_val: 9592.138671875, obj_val: 9562.7109375, abs dis: 29.427734375
[rfa agg] iter:  9, weight: tensor([0.0031, 0.0031, 0.0033, 0.0032, 0.0908, 0.1193, 0.3557, 0.1437, 0.1741,
        0.1038])
___Test Target_ResNet_18 poisoned: False, epoch: 221: Average loss: 0.9734, Accuracy: 6736/10000 (67.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.2648, Accuracy: 8414/9000 (93.4889%)
Done in 455.1921305656433 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:222 choose agents : [17, 33, 77, 11, 35, 30, 72, 51, 63, 46]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   2,  Average loss: 0.0016, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   3,  Average loss: 0.0009, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   4,  Average loss: 0.0006, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   5,  Average loss: 0.0003, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   6,  Average loss: 0.0012, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Global model norm: 43.83646728761126.
Norm before scaling: 43.47052055389448. Distance: 2.5718168824536827
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.4312, Accuracy: 5885/10000 (58.8500%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.2200, Accuracy: 8555/9000 (95.0556%)
Scaling by  100
Scaled Norm after poisoning: 253.3924204667535, distance: 257.1816903961089
Total norm for 4 adversaries is: 253.3924204667535. distance: 257.1816903961089
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   1,  Average loss: 0.0012, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   2,  Average loss: 0.0009, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   3,  Average loss: 0.0010, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   4,  Average loss: 0.0012, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   5,  Average loss: 0.0017, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   6,  Average loss: 0.0014, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Global model norm: 43.83646728761126.
Norm before scaling: 43.77798769965621. Distance: 5.2131257045275685
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.8034, Accuracy: 5108/10000 (51.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.1506, Accuracy: 8651/9000 (96.1222%)
Scaling by  100
Scaled Norm after poisoning: 520.0561267786392, distance: 521.3125262258716
Total norm for 4 adversaries is: 520.0561267786392. distance: 521.3125262258716
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   3,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   4,  Average loss: 0.0001, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 43.83646728761126.
Norm before scaling: 43.4813641497172. Distance: 1.37517867227918
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.2153, Accuracy: 6326/10000 (63.2600%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.0795, Accuracy: 8826/9000 (98.0667%)
Scaling by  100
Scaled Norm after poisoning: 132.45014539676805, distance: 137.51787525854593
Total norm for 4 adversaries is: 132.45014539676805. distance: 137.51787525854593
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   2,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   3,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   4,  Average loss: 0.0001, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   6,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Global model norm: 43.83646728761126.
Norm before scaling: 43.43108372126034. Distance: 1.721960294795207
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.3913, Accuracy: 6097/10000 (60.9700%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.0510, Accuracy: 8856/9000 (98.4000%)
Scaling by  100
Scaled Norm after poisoning: 166.5501578447916, distance: 172.19602973428277
Total norm for 4 adversaries is: 166.5501578447916. distance: 172.19602973428277
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 222, local model 35, internal_epoch   1,  Average loss: 0.0207, Accuracy: 286/419 (68.2578%)
___Train Local_ResNet_18,  epoch 222, local model 35, internal_epoch   2,  Average loss: 0.0063, Accuracy: 367/419 (87.5895%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 5.1565, Accuracy: 3357/10000 (33.5700%)
___Train Local_ResNet_18,  epoch 222, local model 30, internal_epoch   1,  Average loss: 0.0228, Accuracy: 188/337 (55.7864%)
___Train Local_ResNet_18,  epoch 222, local model 30, internal_epoch   2,  Average loss: 0.0064, Accuracy: 289/337 (85.7567%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 4.7682, Accuracy: 3285/10000 (32.8500%)
___Train Local_ResNet_18,  epoch 222, local model 72, internal_epoch   1,  Average loss: 0.0186, Accuracy: 410/618 (66.3430%)
___Train Local_ResNet_18,  epoch 222, local model 72, internal_epoch   2,  Average loss: 0.0074, Accuracy: 531/618 (85.9223%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 3.2231, Accuracy: 3069/10000 (30.6900%)
___Train Local_ResNet_18,  epoch 222, local model 51, internal_epoch   1,  Average loss: 0.0181, Accuracy: 327/479 (68.2672%)
___Train Local_ResNet_18,  epoch 222, local model 51, internal_epoch   2,  Average loss: 0.0055, Accuracy: 431/479 (89.9791%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 5.1942, Accuracy: 2603/10000 (26.0300%)
___Train Local_ResNet_18,  epoch 222, local model 63, internal_epoch   1,  Average loss: 0.0142, Accuracy: 553/752 (73.5372%)
___Train Local_ResNet_18,  epoch 222, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 666/752 (88.5638%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 2.0370, Accuracy: 4273/10000 (42.7300%)
___Train Local_ResNet_18,  epoch 222, local model 46, internal_epoch   1,  Average loss: 0.0149, Accuracy: 436/601 (72.5458%)
___Train Local_ResNet_18,  epoch 222, local model 46, internal_epoch   2,  Average loss: 0.0048, Accuracy: 555/601 (92.3461%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 3.1004, Accuracy: 4705/10000 (47.0500%)
time spent on training: 360.53271985054016
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.39520845123561593  data num: [526, 527, 496, 546, 419, 337, 618, 479, 752, 601]
[rfa agg] considering poison per batch poison_fraction: 0.030875660252782496
[rfa agg] init. name: [17, 33, 77, 11, 35, 30, 72, 51, 63, 46], weight: tensor([0.0992, 0.0994, 0.0936, 0.1030, 0.0790, 0.0636, 0.1166, 0.0904, 0.1419,
        0.1134])
[rfa agg] iter:  0, prev_obj_val: 11199.685546875, obj_val: 10724.15625, abs dis: 475.529296875
[rfa agg] iter:  0, weight: tensor([0.0716, 0.0717, 0.0824, 0.0743, 0.0913, 0.0733, 0.1350, 0.1045, 0.1646,
        0.1313])
[rfa agg] iter:  1, prev_obj_val: 10724.15625, obj_val: 10322.783203125, abs dis: 401.373046875
[rfa agg] iter:  1, weight: tensor([0.0524, 0.0524, 0.0586, 0.0543, 0.1019, 0.0819, 0.1509, 0.1167, 0.1841,
        0.1468])
[rfa agg] iter:  2, prev_obj_val: 10322.783203125, obj_val: 10007.7119140625, abs dis: 315.0712890625
[rfa agg] iter:  2, weight: tensor([0.0370, 0.0370, 0.0406, 0.0384, 0.1102, 0.0885, 0.1634, 0.1262, 0.1996,
        0.1590])
[rfa agg] iter:  3, prev_obj_val: 10007.7119140625, obj_val: 9772.3583984375, abs dis: 235.353515625
[rfa agg] iter:  3, weight: tensor([0.0255, 0.0255, 0.0276, 0.0264, 0.1163, 0.0933, 0.1728, 0.1333, 0.2113,
        0.1680])
[rfa agg] iter:  4, prev_obj_val: 9772.3583984375, obj_val: 9603.5859375, abs dis: 168.7724609375
[rfa agg] iter:  4, weight: tensor([0.0172, 0.0172, 0.0185, 0.0178, 0.1204, 0.0965, 0.1796, 0.1382, 0.2201,
        0.1746])
[rfa agg] iter:  5, prev_obj_val: 9603.5859375, obj_val: 9486.3876953125, abs dis: 117.1982421875
[rfa agg] iter:  5, weight: tensor([0.0114, 0.0114, 0.0122, 0.0118, 0.1230, 0.0984, 0.1844, 0.1414, 0.2269,
        0.1793])
[rfa agg] iter:  6, prev_obj_val: 9486.3876953125, obj_val: 9405.7646484375, abs dis: 80.623046875
[rfa agg] iter:  6, weight: tensor([0.0074, 0.0074, 0.0079, 0.0077, 0.1242, 0.0991, 0.1879, 0.1432, 0.2325,
        0.1827])
[rfa agg] iter:  7, prev_obj_val: 9405.7646484375, obj_val: 9352.33984375, abs dis: 53.4248046875
[rfa agg] iter:  7, weight: tensor([0.0047, 0.0047, 0.0050, 0.0049, 0.1243, 0.0987, 0.1905, 0.1439, 0.2381,
        0.1853])
[rfa agg] iter:  8, prev_obj_val: 9352.33984375, obj_val: 9315.8046875, abs dis: 36.53515625
[rfa agg] iter:  8, weight: tensor([0.0029, 0.0030, 0.0031, 0.0031, 0.1229, 0.0969, 0.1927, 0.1433, 0.2448,
        0.1874])
[rfa agg] iter:  9, prev_obj_val: 9315.8046875, obj_val: 9292.4287109375, abs dis: 23.3759765625
[rfa agg] iter:  9, weight: tensor([0.0017, 0.0017, 0.0019, 0.0018, 0.1193, 0.0930, 0.1948, 0.1409, 0.2553,
        0.1895])
___Test Target_ResNet_18 poisoned: False, epoch: 222: Average loss: 0.9511, Accuracy: 6830/10000 (68.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.2856, Accuracy: 8371/9000 (93.0111%)
Done in 461.7834668159485 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:223 choose agents : [17, 33, 77, 11, 54, 95, 26, 2, 82, 45]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   1,  Average loss: 0.0010, Accuracy: 526/526 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   2,  Average loss: 0.0006, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   3,  Average loss: 0.0004, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   4,  Average loss: 0.0010, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   5,  Average loss: 0.0007, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Global model norm: 43.781569246248615.
Norm before scaling: 43.412038682133584. Distance: 2.307955219502114
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.4241, Accuracy: 5867/10000 (58.6700%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.1195, Accuracy: 8743/9000 (97.1444%)
Scaling by  100
Scaled Norm after poisoning: 226.778862206666, distance: 230.7955246939377
Total norm for 4 adversaries is: 226.778862206666. distance: 230.7955246939377
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   1,  Average loss: 0.0015, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   2,  Average loss: 0.0007, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   3,  Average loss: 0.0003, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   4,  Average loss: 0.0007, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   5,  Average loss: 0.0004, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   6,  Average loss: 0.0003, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Global model norm: 43.781569246248615.
Norm before scaling: 43.47257323903702. Distance: 2.870816213467234
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.6331, Accuracy: 5577/10000 (55.7700%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.1307, Accuracy: 8710/9000 (96.7778%)
Scaling by  100
Scaled Norm after poisoning: 284.2751473045085, distance: 287.081611327685
Total norm for 4 adversaries is: 284.2751473045085. distance: 287.081611327685
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   3,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   4,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 43.781569246248615.
Norm before scaling: 43.425067071857384. Distance: 1.338140890284572
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.1920, Accuracy: 6380/10000 (63.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.0919, Accuracy: 8785/9000 (97.6111%)
Scaling by  100
Scaled Norm after poisoning: 128.58869598209245, distance: 133.81408365480445
Total norm for 4 adversaries is: 128.58869598209245. distance: 133.81408365480445
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   2,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   3,  Average loss: 0.0002, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   4,  Average loss: 0.0003, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   6,  Average loss: 0.0001, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Global model norm: 43.781569246248615.
Norm before scaling: 43.37752857588319. Distance: 1.609452180956124
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.3490, Accuracy: 6169/10000 (61.6900%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.1740, Accuracy: 8641/9000 (96.0111%)
Scaling by  100
Scaled Norm after poisoning: 155.04706946601732, distance: 160.94523039686513
Total norm for 4 adversaries is: 155.04706946601732. distance: 160.94523039686513
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 223, local model 54, internal_epoch   1,  Average loss: 0.0162, Accuracy: 315/440 (71.5909%)
___Train Local_ResNet_18,  epoch 223, local model 54, internal_epoch   2,  Average loss: 0.0038, Accuracy: 406/440 (92.2727%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 3.4352, Accuracy: 3887/10000 (38.8700%)
___Train Local_ResNet_18,  epoch 223, local model 95, internal_epoch   1,  Average loss: 0.0186, Accuracy: 375/569 (65.9051%)
___Train Local_ResNet_18,  epoch 223, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 511/569 (89.8067%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 5.7975, Accuracy: 3260/10000 (32.6000%)
___Train Local_ResNet_18,  epoch 223, local model 26, internal_epoch   1,  Average loss: 0.0177, Accuracy: 313/468 (66.8803%)
___Train Local_ResNet_18,  epoch 223, local model 26, internal_epoch   2,  Average loss: 0.0062, Accuracy: 416/468 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 3.0420, Accuracy: 3865/10000 (38.6500%)
___Train Local_ResNet_18,  epoch 223, local model 2, internal_epoch   1,  Average loss: 0.0198, Accuracy: 308/461 (66.8113%)
___Train Local_ResNet_18,  epoch 223, local model 2, internal_epoch   2,  Average loss: 0.0090, Accuracy: 389/461 (84.3818%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 3.4048, Accuracy: 2998/10000 (29.9800%)
___Train Local_ResNet_18,  epoch 223, local model 82, internal_epoch   1,  Average loss: 0.0115, Accuracy: 471/601 (78.3694%)
___Train Local_ResNet_18,  epoch 223, local model 82, internal_epoch   2,  Average loss: 0.0046, Accuracy: 550/601 (91.5141%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 3.0389, Accuracy: 4592/10000 (45.9200%)
___Train Local_ResNet_18,  epoch 223, local model 45, internal_epoch   1,  Average loss: 0.0197, Accuracy: 355/529 (67.1078%)
___Train Local_ResNet_18,  epoch 223, local model 45, internal_epoch   2,  Average loss: 0.0065, Accuracy: 466/529 (88.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 3.9067, Accuracy: 3498/10000 (34.9800%)
time spent on training: 356.10918283462524
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4057718380786364  data num: [526, 527, 496, 546, 440, 569, 468, 461, 601, 529]
[rfa agg] considering poison per batch poison_fraction: 0.03170092484989347
[rfa agg] init. name: [17, 33, 77, 11, 54, 95, 26, 2, 82, 45], weight: tensor([0.1019, 0.1021, 0.0961, 0.1058, 0.0852, 0.1102, 0.0906, 0.0893, 0.1164,
        0.1025])
[rfa agg] iter:  0, prev_obj_val: 11301.58203125, obj_val: 10911.15234375, abs dis: 390.4296875
[rfa agg] iter:  0, weight: tensor([0.0760, 0.0762, 0.0878, 0.0789, 0.0975, 0.1264, 0.1038, 0.1023, 0.1336,
        0.1175])
[rfa agg] iter:  1, prev_obj_val: 10911.15234375, obj_val: 10568.828125, abs dis: 342.32421875
[rfa agg] iter:  1, weight: tensor([0.0580, 0.0581, 0.0652, 0.0602, 0.1086, 0.1408, 0.1156, 0.1139, 0.1489,
        0.1309])
[rfa agg] iter:  2, prev_obj_val: 10568.828125, obj_val: 10288.9130859375, abs dis: 279.9150390625
[rfa agg] iter:  2, weight: tensor([0.0428, 0.0429, 0.0472, 0.0444, 0.1177, 0.1527, 0.1254, 0.1235, 0.1615,
        0.1419])
[rfa agg] iter:  3, prev_obj_val: 10288.9130859375, obj_val: 10069.7138671875, abs dis: 219.19921875
[rfa agg] iter:  3, weight: tensor([0.0309, 0.0310, 0.0337, 0.0321, 0.1247, 0.1619, 0.1329, 0.1309, 0.1714,
        0.1506])
[rfa agg] iter:  4, prev_obj_val: 10069.7138671875, obj_val: 9905.3193359375, abs dis: 164.39453125
[rfa agg] iter:  4, weight: tensor([0.0219, 0.0219, 0.0236, 0.0227, 0.1299, 0.1690, 0.1385, 0.1365, 0.1790,
        0.1571])
[rfa agg] iter:  5, prev_obj_val: 9905.3193359375, obj_val: 9783.9248046875, abs dis: 121.39453125
[rfa agg] iter:  5, weight: tensor([0.0153, 0.0153, 0.0164, 0.0158, 0.1335, 0.1741, 0.1426, 0.1405, 0.1847,
        0.1619])
[rfa agg] iter:  6, prev_obj_val: 9783.9248046875, obj_val: 9696.25390625, abs dis: 87.6708984375
[rfa agg] iter:  6, weight: tensor([0.0105, 0.0105, 0.0112, 0.0109, 0.1359, 0.1779, 0.1454, 0.1433, 0.1891,
        0.1654])
[rfa agg] iter:  7, prev_obj_val: 9696.25390625, obj_val: 9636.40625, abs dis: 59.84765625
[rfa agg] iter:  7, weight: tensor([0.0071, 0.0071, 0.0075, 0.0073, 0.1372, 0.1807, 0.1473, 0.1451, 0.1927,
        0.1680])
[rfa agg] iter:  8, prev_obj_val: 9636.40625, obj_val: 9593.4287109375, abs dis: 42.9775390625
[rfa agg] iter:  8, weight: tensor([0.0047, 0.0048, 0.0051, 0.0049, 0.1376, 0.1828, 0.1483, 0.1461, 0.1957,
        0.1699])
[rfa agg] iter:  9, prev_obj_val: 9593.4287109375, obj_val: 9563.1015625, abs dis: 30.3271484375
[rfa agg] iter:  9, weight: tensor([0.0031, 0.0031, 0.0033, 0.0032, 0.1370, 0.1845, 0.1487, 0.1465, 0.1991,
        0.1716])
___Test Target_ResNet_18 poisoned: False, epoch: 223: Average loss: 0.9345, Accuracy: 6872/10000 (68.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.2538, Accuracy: 8443/9000 (93.8111%)
Done in 490.44309639930725 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:224 choose agents : [17, 33, 77, 11, 0, 34, 62, 66, 95, 10]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   1,  Average loss: 0.0017, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   3,  Average loss: 0.0004, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   4,  Average loss: 0.0020, Accuracy: 525/526 (99.8099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   5,  Average loss: 0.0003, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   6,  Average loss: 0.0011, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Global model norm: 43.70523239690172.
Norm before scaling: 43.36013512847227. Distance: 2.7775906266638817
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.6517, Accuracy: 5472/10000 (54.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.2686, Accuracy: 8440/9000 (93.7778%)
Scaling by  100
Scaled Norm after poisoning: 274.3795700074989, distance: 277.75904294459974
Total norm for 4 adversaries is: 274.3795700074989. distance: 277.75904294459974
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   1,  Average loss: 0.0013, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   2,  Average loss: 0.0017, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   3,  Average loss: 0.0004, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   4,  Average loss: 0.0004, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   5,  Average loss: 0.0002, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   6,  Average loss: 0.0002, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Global model norm: 43.70523239690172.
Norm before scaling: 43.31846606186702. Distance: 1.9524548410817657
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.3150, Accuracy: 6091/10000 (60.9100%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.0943, Accuracy: 8774/9000 (97.4889%)
Scaling by  100
Scaled Norm after poisoning: 190.48350281257956, distance: 195.24548850421615
Total norm for 4 adversaries is: 190.48350281257956. distance: 195.24548850421615
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   1,  Average loss: 0.0011, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   3,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   4,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   5,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Global model norm: 43.70523239690172.
Norm before scaling: 43.356425856912345. Distance: 1.4005303944915923
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.1595, Accuracy: 6528/10000 (65.2800%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.1367, Accuracy: 8710/9000 (96.7778%)
Scaling by  100
Scaled Norm after poisoning: 135.248324850994, distance: 140.0530382234709
Total norm for 4 adversaries is: 135.248324850994. distance: 140.0530382234709
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   2,  Average loss: 0.0002, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   3,  Average loss: 0.0006, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   4,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   5,  Average loss: 0.0003, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 43.70523239690172.
Norm before scaling: 43.29003182568419. Distance: 1.5551253425886606
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.3288, Accuracy: 6182/10000 (61.8200%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.1413, Accuracy: 8674/9000 (96.3778%)
Scaling by  100
Scaled Norm after poisoning: 149.13222294955239, distance: 155.5125346636084
Total norm for 4 adversaries is: 149.13222294955239. distance: 155.5125346636084
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 224, local model 0, internal_epoch   1,  Average loss: 0.0193, Accuracy: 230/367 (62.6703%)
___Train Local_ResNet_18,  epoch 224, local model 0, internal_epoch   2,  Average loss: 0.0036, Accuracy: 339/367 (92.3706%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 4.9797, Accuracy: 2454/10000 (24.5400%)
___Train Local_ResNet_18,  epoch 224, local model 34, internal_epoch   1,  Average loss: 0.0184, Accuracy: 238/349 (68.1948%)
___Train Local_ResNet_18,  epoch 224, local model 34, internal_epoch   2,  Average loss: 0.0053, Accuracy: 313/349 (89.6848%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 7.2050, Accuracy: 2148/10000 (21.4800%)
___Train Local_ResNet_18,  epoch 224, local model 62, internal_epoch   1,  Average loss: 0.0150, Accuracy: 255/358 (71.2291%)
___Train Local_ResNet_18,  epoch 224, local model 62, internal_epoch   2,  Average loss: 0.0046, Accuracy: 328/358 (91.6201%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 2.7514, Accuracy: 3815/10000 (38.1500%)
___Train Local_ResNet_18,  epoch 224, local model 66, internal_epoch   1,  Average loss: 0.0110, Accuracy: 438/555 (78.9189%)
___Train Local_ResNet_18,  epoch 224, local model 66, internal_epoch   2,  Average loss: 0.0024, Accuracy: 531/555 (95.6757%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 4.4781, Accuracy: 3790/10000 (37.9000%)
___Train Local_ResNet_18,  epoch 224, local model 95, internal_epoch   1,  Average loss: 0.0175, Accuracy: 400/569 (70.2988%)
___Train Local_ResNet_18,  epoch 224, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 502/569 (88.2250%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 6.1632, Accuracy: 2655/10000 (26.5500%)
___Train Local_ResNet_18,  epoch 224, local model 10, internal_epoch   1,  Average loss: 0.0105, Accuracy: 617/752 (82.0479%)
___Train Local_ResNet_18,  epoch 224, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 705/752 (93.7500%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 5.1761, Accuracy: 3332/10000 (33.3200%)
time spent on training: 329.8821110725403
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41526263627353815  data num: [526, 527, 496, 546, 367, 349, 358, 555, 569, 752]
[rfa agg] considering poison per batch poison_fraction: 0.03244239345887017
[rfa agg] init. name: [17, 33, 77, 11, 0, 34, 62, 66, 95, 10], weight: tensor([0.1043, 0.1045, 0.0983, 0.1082, 0.0727, 0.0692, 0.0710, 0.1100, 0.1128,
        0.1491])
[rfa agg] iter:  0, prev_obj_val: 11379.58203125, obj_val: 11058.046875, abs dis: 321.53515625
[rfa agg] iter:  0, weight: tensor([0.0800, 0.0802, 0.0928, 0.0830, 0.0824, 0.0784, 0.0804, 0.1250, 0.1281,
        0.1698])
[rfa agg] iter:  1, prev_obj_val: 11058.046875, obj_val: 10772.185546875, abs dis: 285.861328125
[rfa agg] iter:  1, weight: tensor([0.0631, 0.0632, 0.0713, 0.0655, 0.0914, 0.0869, 0.0892, 0.1387, 0.1422,
        0.1886])
[rfa agg] iter:  2, prev_obj_val: 10772.185546875, obj_val: 10528.041015625, abs dis: 244.14453125
[rfa agg] iter:  2, weight: tensor([0.0486, 0.0487, 0.0539, 0.0504, 0.0989, 0.0941, 0.0965, 0.1503, 0.1541,
        0.2045])
[rfa agg] iter:  3, prev_obj_val: 10528.041015625, obj_val: 10329.4013671875, abs dis: 198.6396484375
[rfa agg] iter:  3, weight: tensor([0.0366, 0.0366, 0.0400, 0.0380, 0.1051, 0.0999, 0.1025, 0.1598, 0.1638,
        0.2178])
[rfa agg] iter:  4, prev_obj_val: 10329.4013671875, obj_val: 10173.2236328125, abs dis: 156.177734375
[rfa agg] iter:  4, weight: tensor([0.0271, 0.0271, 0.0294, 0.0281, 0.1098, 0.1044, 0.1071, 0.1673, 0.1715,
        0.2284])
[rfa agg] iter:  5, prev_obj_val: 10173.2236328125, obj_val: 10052.681640625, abs dis: 120.5419921875
[rfa agg] iter:  5, weight: tensor([0.0198, 0.0198, 0.0213, 0.0205, 0.1132, 0.1077, 0.1105, 0.1730, 0.1774,
        0.2369])
[rfa agg] iter:  6, prev_obj_val: 10052.681640625, obj_val: 9961.7109375, abs dis: 90.970703125
[rfa agg] iter:  6, weight: tensor([0.0142, 0.0143, 0.0153, 0.0148, 0.1156, 0.1100, 0.1128, 0.1774, 0.1819,
        0.2438])
[rfa agg] iter:  7, prev_obj_val: 9961.7109375, obj_val: 9894.244140625, abs dis: 67.466796875
[rfa agg] iter:  7, weight: tensor([0.0101, 0.0101, 0.0108, 0.0105, 0.1171, 0.1114, 0.1143, 0.1807, 0.1852,
        0.2498])
[rfa agg] iter:  8, prev_obj_val: 9894.244140625, obj_val: 9846.490234375, abs dis: 47.75390625
[rfa agg] iter:  8, weight: tensor([0.0071, 0.0071, 0.0076, 0.0074, 0.1178, 0.1120, 0.1149, 0.1831, 0.1878,
        0.2554])
[rfa agg] iter:  9, prev_obj_val: 9846.490234375, obj_val: 9810.873046875, abs dis: 35.6171875
[rfa agg] iter:  9, weight: tensor([0.0050, 0.0050, 0.0053, 0.0051, 0.1175, 0.1118, 0.1147, 0.1849, 0.1896,
        0.2612])
___Test Target_ResNet_18 poisoned: False, epoch: 224: Average loss: 0.9489, Accuracy: 6815/10000 (68.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.2253, Accuracy: 8492/9000 (94.3556%)
Done in 455.5539493560791 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:225 choose agents : [17, 33, 77, 11, 12, 38, 41, 4, 68, 55]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   1,  Average loss: 0.0011, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   2,  Average loss: 0.0010, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   3,  Average loss: 0.0016, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   4,  Average loss: 0.0019, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   5,  Average loss: 0.0026, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   6,  Average loss: 0.0018, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Global model norm: 43.596484289249894.
Norm before scaling: 43.41025730692142. Distance: 4.483565732659347
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.7095, Accuracy: 5163/10000 (51.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.1155, Accuracy: 8742/9000 (97.1333%)
Scaling by  100
Scaled Norm after poisoning: 446.4232681827864, distance: 448.3565649959862
Total norm for 4 adversaries is: 446.4232681827864. distance: 448.3565649959862
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   1,  Average loss: 0.0012, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   2,  Average loss: 0.0004, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   3,  Average loss: 0.0002, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   4,  Average loss: 0.0007, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   5,  Average loss: 0.0006, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   6,  Average loss: 0.0004, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Global model norm: 43.596484289249894.
Norm before scaling: 43.22102081886776. Distance: 2.024294520748445
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.3498, Accuracy: 6136/10000 (61.3600%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.2314, Accuracy: 8552/9000 (95.0222%)
Scaling by  100
Scaled Norm after poisoning: 198.01227076875816, distance: 202.4294630235431
Total norm for 4 adversaries is: 198.01227076875816. distance: 202.4294630235431
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   1,  Average loss: 0.0012, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   3,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   5,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 43.596484289249894.
Norm before scaling: 43.2399072061367. Distance: 1.3803720868933242
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.1953, Accuracy: 6352/10000 (63.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.0496, Accuracy: 8861/9000 (98.4556%)
Scaling by  100
Scaled Norm after poisoning: 132.92090428850912, distance: 138.03721050635224
Total norm for 4 adversaries is: 132.92090428850912. distance: 138.03721050635224
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   1,  Average loss: 0.0010, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   2,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   3,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   4,  Average loss: 0.0003, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 43.596484289249894.
Norm before scaling: 43.19034055871897. Distance: 1.6585427016291867
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.3263, Accuracy: 6170/10000 (61.7000%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.2047, Accuracy: 8582/9000 (95.3556%)
Scaling by  100
Scaled Norm after poisoning: 160.02634670773747, distance: 165.85425760475673
Total norm for 4 adversaries is: 160.02634670773747. distance: 165.85425760475673
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 225, local model 12, internal_epoch   1,  Average loss: 0.0120, Accuracy: 755/977 (77.2774%)
___Train Local_ResNet_18,  epoch 225, local model 12, internal_epoch   2,  Average loss: 0.0069, Accuracy: 833/977 (85.2610%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 5.9614, Accuracy: 2813/10000 (28.1300%)
___Train Local_ResNet_18,  epoch 225, local model 38, internal_epoch   1,  Average loss: 0.0130, Accuracy: 579/756 (76.5873%)
___Train Local_ResNet_18,  epoch 225, local model 38, internal_epoch   2,  Average loss: 0.0058, Accuracy: 669/756 (88.4921%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 5.9770, Accuracy: 2748/10000 (27.4800%)
___Train Local_ResNet_18,  epoch 225, local model 41, internal_epoch   1,  Average loss: 0.0199, Accuracy: 342/513 (66.6667%)
___Train Local_ResNet_18,  epoch 225, local model 41, internal_epoch   2,  Average loss: 0.0059, Accuracy: 451/513 (87.9142%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 3.2102, Accuracy: 3303/10000 (33.0300%)
___Train Local_ResNet_18,  epoch 225, local model 4, internal_epoch   1,  Average loss: 0.0149, Accuracy: 399/557 (71.6338%)
___Train Local_ResNet_18,  epoch 225, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 522/557 (93.7163%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 3.3216, Accuracy: 4256/10000 (42.5600%)
___Train Local_ResNet_18,  epoch 225, local model 68, internal_epoch   1,  Average loss: 0.0156, Accuracy: 291/416 (69.9519%)
___Train Local_ResNet_18,  epoch 225, local model 68, internal_epoch   2,  Average loss: 0.0054, Accuracy: 378/416 (90.8654%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 2.3801, Accuracy: 4559/10000 (45.5900%)
___Train Local_ResNet_18,  epoch 225, local model 55, internal_epoch   1,  Average loss: 0.0180, Accuracy: 197/299 (65.8863%)
___Train Local_ResNet_18,  epoch 225, local model 55, internal_epoch   2,  Average loss: 0.0034, Accuracy: 277/299 (92.6421%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 8.4603, Accuracy: 1976/10000 (19.7600%)
time spent on training: 385.3896086215973
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3732406912524497  data num: [526, 527, 496, 546, 977, 756, 513, 557, 416, 299]
[rfa agg] considering poison per batch poison_fraction: 0.029159429004097633
[rfa agg] init. name: [17, 33, 77, 11, 12, 38, 41, 4, 68, 55], weight: tensor([0.0937, 0.0939, 0.0884, 0.0973, 0.1741, 0.1347, 0.0914, 0.0992, 0.0741,
        0.0533])
[rfa agg] iter:  0, prev_obj_val: 10954.0732421875, obj_val: 10287.13671875, abs dis: 666.9365234375
[rfa agg] iter:  0, weight: tensor([0.0627, 0.0629, 0.0717, 0.0652, 0.2059, 0.1586, 0.1073, 0.1165, 0.0868,
        0.0623])
[rfa agg] iter:  1, prev_obj_val: 10287.13671875, obj_val: 9766.56640625, abs dis: 520.5703125
[rfa agg] iter:  1, weight: tensor([0.0419, 0.0420, 0.0465, 0.0435, 0.2311, 0.1778, 0.1201, 0.1304, 0.0971,
        0.0696])
[rfa agg] iter:  2, prev_obj_val: 9766.56640625, obj_val: 9391.18359375, abs dis: 375.3828125
[rfa agg] iter:  2, weight: tensor([0.0268, 0.0269, 0.0292, 0.0279, 0.2497, 0.1915, 0.1291, 0.1401, 0.1042,
        0.0746])
[rfa agg] iter:  3, prev_obj_val: 9391.18359375, obj_val: 9139.4248046875, abs dis: 251.7587890625
[rfa agg] iter:  3, weight: tensor([0.0166, 0.0166, 0.0179, 0.0172, 0.2633, 0.2009, 0.1349, 0.1465, 0.1086,
        0.0775])
[rfa agg] iter:  4, prev_obj_val: 9139.4248046875, obj_val: 8979.5322265625, abs dis: 159.892578125
[rfa agg] iter:  4, weight: tensor([0.0100, 0.0100, 0.0107, 0.0104, 0.2740, 0.2071, 0.1382, 0.1500, 0.1108,
        0.0788])
[rfa agg] iter:  5, prev_obj_val: 8979.5322265625, obj_val: 8880.8896484375, abs dis: 98.642578125
[rfa agg] iter:  5, weight: tensor([0.0059, 0.0059, 0.0063, 0.0061, 0.2841, 0.2114, 0.1394, 0.1514, 0.1110,
        0.0783])
[rfa agg] iter:  6, prev_obj_val: 8880.8896484375, obj_val: 8819.6884765625, abs dis: 61.201171875
[rfa agg] iter:  6, weight: tensor([0.0034, 0.0034, 0.0037, 0.0036, 0.2969, 0.2146, 0.1387, 0.1506, 0.1091,
        0.0761])
[rfa agg] iter:  7, prev_obj_val: 8819.6884765625, obj_val: 8783.478515625, abs dis: 36.2099609375
[rfa agg] iter:  7, weight: tensor([0.0019, 0.0019, 0.0020, 0.0020, 0.3184, 0.2170, 0.1351, 0.1468, 0.1039,
        0.0710])
[rfa agg] iter:  8, prev_obj_val: 8783.478515625, obj_val: 8763.265625, abs dis: 20.212890625
[rfa agg] iter:  8, weight: tensor([0.0010, 0.0010, 0.0011, 0.0010, 0.3628, 0.2168, 0.1256, 0.1365, 0.0929,
        0.0613])
[rfa agg] iter:  9, prev_obj_val: 8763.265625, obj_val: 8754.8798828125, abs dis: 8.3857421875
[rfa agg] iter:  9, weight: tensor([4.4225e-04, 4.4317e-04, 4.6970e-04, 4.5917e-04, 4.7789e-01, 1.9885e-01,
        1.0005e-01, 1.0872e-01, 6.9281e-02, 4.3397e-02])
___Test Target_ResNet_18 poisoned: False, epoch: 225: Average loss: 0.9371, Accuracy: 6871/10000 (68.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.2736, Accuracy: 8399/9000 (93.3222%)
Done in 509.13197588920593 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:226 choose agents : [17, 33, 77, 11, 30, 39, 10, 64, 23, 60]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   1,  Average loss: 0.0011, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   2,  Average loss: 0.0012, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   3,  Average loss: 0.0009, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   4,  Average loss: 0.0007, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   5,  Average loss: 0.0008, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   6,  Average loss: 0.0006, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Global model norm: 43.56534692992815.
Norm before scaling: 43.18646406816536. Distance: 2.26050035406733
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.3177, Accuracy: 6049/10000 (60.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.0636, Accuracy: 8825/9000 (98.0556%)
Scaling by  100
Scaled Norm after poisoning: 221.80793880911926, distance: 226.05006704820948
Total norm for 4 adversaries is: 221.80793880911926. distance: 226.05006704820948
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   1,  Average loss: 0.0011, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   2,  Average loss: 0.0006, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   3,  Average loss: 0.0005, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   4,  Average loss: 0.0009, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   5,  Average loss: 0.0004, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   6,  Average loss: 0.0004, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Global model norm: 43.56534692992815.
Norm before scaling: 43.185030964606966. Distance: 2.003802856395455
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.3181, Accuracy: 6168/10000 (61.6800%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.1533, Accuracy: 8668/9000 (96.3111%)
Scaling by  100
Scaled Norm after poisoning: 195.8300941664738, distance: 200.38028299336239
Total norm for 4 adversaries is: 195.8300941664738. distance: 200.38028299336239
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   3,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   4,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 43.56534692992815.
Norm before scaling: 43.21849297193997. Distance: 1.3653426011483114
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.1470, Accuracy: 6459/10000 (64.5900%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.0921, Accuracy: 8794/9000 (97.7111%)
Scaling by  100
Scaled Norm after poisoning: 131.6929133913439, distance: 136.53427196815824
Total norm for 4 adversaries is: 131.6929133913439. distance: 136.53427196815824
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   2,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   3,  Average loss: 0.0005, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   4,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   5,  Average loss: 0.0003, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 43.56534692992815.
Norm before scaling: 43.16419188329025. Distance: 1.6690033109619504
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.3251, Accuracy: 6218/10000 (62.1800%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.0806, Accuracy: 8778/9000 (97.5333%)
Scaling by  100
Scaled Norm after poisoning: 161.23248451382247, distance: 166.90031409122633
Total norm for 4 adversaries is: 161.23248451382247. distance: 166.90031409122633
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 226, local model 30, internal_epoch   1,  Average loss: 0.0195, Accuracy: 202/337 (59.9407%)
___Train Local_ResNet_18,  epoch 226, local model 30, internal_epoch   2,  Average loss: 0.0059, Accuracy: 301/337 (89.3175%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 4.6543, Accuracy: 2753/10000 (27.5300%)
___Train Local_ResNet_18,  epoch 226, local model 39, internal_epoch   1,  Average loss: 0.0246, Accuracy: 126/217 (58.0645%)
___Train Local_ResNet_18,  epoch 226, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 204/217 (94.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 10.1005, Accuracy: 1429/10000 (14.2900%)
___Train Local_ResNet_18,  epoch 226, local model 10, internal_epoch   1,  Average loss: 0.0101, Accuracy: 617/752 (82.0479%)
___Train Local_ResNet_18,  epoch 226, local model 10, internal_epoch   2,  Average loss: 0.0050, Accuracy: 678/752 (90.1596%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 5.7641, Accuracy: 3210/10000 (32.1000%)
___Train Local_ResNet_18,  epoch 226, local model 64, internal_epoch   1,  Average loss: 0.0159, Accuracy: 471/686 (68.6589%)
___Train Local_ResNet_18,  epoch 226, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 611/686 (89.0671%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 4.2526, Accuracy: 3528/10000 (35.2800%)
___Train Local_ResNet_18,  epoch 226, local model 23, internal_epoch   1,  Average loss: 0.0214, Accuracy: 144/248 (58.0645%)
___Train Local_ResNet_18,  epoch 226, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 225/248 (90.7258%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 6.9613, Accuracy: 1820/10000 (18.2000%)
___Train Local_ResNet_18,  epoch 226, local model 60, internal_epoch   1,  Average loss: 0.0178, Accuracy: 185/284 (65.1408%)
___Train Local_ResNet_18,  epoch 226, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 266/284 (93.6620%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 8.7842, Accuracy: 1505/10000 (15.0500%)
time spent on training: 380.71388030052185
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4535613769214116  data num: [526, 527, 496, 546, 337, 217, 752, 686, 248, 284]
[rfa agg] considering poison per batch poison_fraction: 0.03543448257198528
[rfa agg] init. name: [17, 33, 77, 11, 30, 39, 10, 64, 23, 60], weight: tensor([0.1139, 0.1141, 0.1074, 0.1182, 0.0730, 0.0470, 0.1628, 0.1485, 0.0537,
        0.0615])
[rfa agg] iter:  0, prev_obj_val: 11617.2138671875, obj_val: 11515.75390625, abs dis: 101.4599609375
[rfa agg] iter:  0, weight: tensor([0.0970, 0.0972, 0.1142, 0.1007, 0.0787, 0.0506, 0.1766, 0.1609, 0.0578,
        0.0663])
[rfa agg] iter:  1, prev_obj_val: 11515.75390625, obj_val: 11417.224609375, abs dis: 98.529296875
[rfa agg] iter:  1, weight: tensor([0.0867, 0.0868, 0.1002, 0.0900, 0.0848, 0.0545, 0.1902, 0.1733, 0.0623,
        0.0714])
[rfa agg] iter:  2, prev_obj_val: 11417.224609375, obj_val: 11324.5263671875, abs dis: 92.6982421875
[rfa agg] iter:  2, weight: tensor([0.0767, 0.0768, 0.0873, 0.0796, 0.0905, 0.0581, 0.2032, 0.1852, 0.0664,
        0.0762])
[rfa agg] iter:  3, prev_obj_val: 11324.5263671875, obj_val: 11238.0673828125, abs dis: 86.458984375
[rfa agg] iter:  3, weight: tensor([0.0673, 0.0674, 0.0757, 0.0699, 0.0958, 0.0615, 0.2153, 0.1961, 0.0703,
        0.0806])
[rfa agg] iter:  4, prev_obj_val: 11238.0673828125, obj_val: 11157.8515625, abs dis: 80.2158203125
[rfa agg] iter:  4, weight: tensor([0.0586, 0.0588, 0.0653, 0.0609, 0.1006, 0.0646, 0.2264, 0.2062, 0.0739,
        0.0847])
[rfa agg] iter:  5, prev_obj_val: 11157.8515625, obj_val: 11084.7021484375, abs dis: 73.1494140625
[rfa agg] iter:  5, weight: tensor([0.0507, 0.0508, 0.0559, 0.0526, 0.1050, 0.0674, 0.2366, 0.2155, 0.0771,
        0.0884])
[rfa agg] iter:  6, prev_obj_val: 11084.7021484375, obj_val: 11019.0390625, abs dis: 65.6630859375
[rfa agg] iter:  6, weight: tensor([0.0434, 0.0435, 0.0476, 0.0451, 0.1090, 0.0699, 0.2459, 0.2239, 0.0799,
        0.0917])
[rfa agg] iter:  7, prev_obj_val: 11019.0390625, obj_val: 10961.2744140625, abs dis: 57.7646484375
[rfa agg] iter:  7, weight: tensor([0.0370, 0.0371, 0.0403, 0.0384, 0.1125, 0.0721, 0.2542, 0.2314, 0.0824,
        0.0946])
[rfa agg] iter:  8, prev_obj_val: 10961.2744140625, obj_val: 10910.1611328125, abs dis: 51.11328125
[rfa agg] iter:  8, weight: tensor([0.0314, 0.0314, 0.0340, 0.0326, 0.1155, 0.0740, 0.2616, 0.2380, 0.0845,
        0.0971])
[rfa agg] iter:  9, prev_obj_val: 10910.1611328125, obj_val: 10865.6962890625, abs dis: 44.46484375
[rfa agg] iter:  9, weight: tensor([0.0264, 0.0265, 0.0286, 0.0274, 0.1180, 0.0756, 0.2681, 0.2439, 0.0863,
        0.0992])
___Test Target_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.0730, Accuracy: 6642/10000 (66.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.0719, Accuracy: 8813/9000 (97.9222%)
Done in 515.160795211792 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:227 choose agents : [17, 33, 77, 11, 23, 34, 52, 92, 57, 74]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   1,  Average loss: 0.0010, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   2,  Average loss: 0.0017, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   3,  Average loss: 0.0006, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   4,  Average loss: 0.0007, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   5,  Average loss: 0.0006, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   6,  Average loss: 0.0032, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 43.10783172754111.
Norm before scaling: 42.744965552426464. Distance: 2.6595097903239804
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.4476, Accuracy: 6002/10000 (60.0200%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.0968, Accuracy: 8775/9000 (97.5000%)
Scaling by  100
Scaled Norm after poisoning: 262.2319613672216, distance: 265.9509911384051
Total norm for 4 adversaries is: 262.2319613672216. distance: 265.9509911384051
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   1,  Average loss: 0.0007, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   2,  Average loss: 0.0004, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   3,  Average loss: 0.0001, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   4,  Average loss: 0.0004, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   5,  Average loss: 0.0004, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   6,  Average loss: 0.0003, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Global model norm: 43.10783172754111.
Norm before scaling: 42.729954353163514. Distance: 2.0705626138718594
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.3910, Accuracy: 6138/10000 (61.3800%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.0911, Accuracy: 8786/9000 (97.6222%)
Scaling by  100
Scaled Norm after poisoning: 202.62837366099546, distance: 207.05626499818837
Total norm for 4 adversaries is: 202.62837366099546. distance: 207.05626499818837
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   1,  Average loss: 0.0007, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   2,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   3,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   4,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 43.10783172754111.
Norm before scaling: 42.748298120363806. Distance: 1.4066758252850606
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.1992, Accuracy: 6433/10000 (64.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.0657, Accuracy: 8828/9000 (98.0889%)
Scaling by  100
Scaled Norm after poisoning: 135.5026593950281, distance: 140.6675838301952
Total norm for 4 adversaries is: 135.5026593950281. distance: 140.6675838301952
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   1,  Average loss: 0.0004, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   2,  Average loss: 0.0002, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   3,  Average loss: 0.0004, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   4,  Average loss: 0.0003, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   5,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 43.10783172754111.
Norm before scaling: 42.67112692725829. Distance: 1.236043743674246
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.2231, Accuracy: 6420/10000 (64.2000%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.0750, Accuracy: 8797/9000 (97.7444%)
Scaling by  100
Scaled Norm after poisoning: 115.05455567360208, distance: 123.60438086390789
Total norm for 4 adversaries is: 115.05455567360208. distance: 123.60438086390789
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 227, local model 23, internal_epoch   1,  Average loss: 0.0236, Accuracy: 146/248 (58.8710%)
___Train Local_ResNet_18,  epoch 227, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 223/248 (89.9194%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 15.3715, Accuracy: 1367/10000 (13.6700%)
___Train Local_ResNet_18,  epoch 227, local model 34, internal_epoch   1,  Average loss: 0.0184, Accuracy: 231/349 (66.1891%)
___Train Local_ResNet_18,  epoch 227, local model 34, internal_epoch   2,  Average loss: 0.0074, Accuracy: 314/349 (89.9713%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 7.2320, Accuracy: 2415/10000 (24.1500%)
___Train Local_ResNet_18,  epoch 227, local model 52, internal_epoch   1,  Average loss: 0.0272, Accuracy: 126/214 (58.8785%)
___Train Local_ResNet_18,  epoch 227, local model 52, internal_epoch   2,  Average loss: 0.0021, Accuracy: 209/214 (97.6636%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 7.7429, Accuracy: 2615/10000 (26.1500%)
___Train Local_ResNet_18,  epoch 227, local model 92, internal_epoch   1,  Average loss: 0.0182, Accuracy: 552/796 (69.3467%)
___Train Local_ResNet_18,  epoch 227, local model 92, internal_epoch   2,  Average loss: 0.0086, Accuracy: 679/796 (85.3015%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 3.6894, Accuracy: 3244/10000 (32.4400%)
___Train Local_ResNet_18,  epoch 227, local model 57, internal_epoch   1,  Average loss: 0.0175, Accuracy: 197/290 (67.9310%)
___Train Local_ResNet_18,  epoch 227, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 265/290 (91.3793%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 6.9173, Accuracy: 2583/10000 (25.8300%)
___Train Local_ResNet_18,  epoch 227, local model 74, internal_epoch   1,  Average loss: 0.0175, Accuracy: 326/469 (69.5096%)
___Train Local_ResNet_18,  epoch 227, local model 74, internal_epoch   2,  Average loss: 0.0072, Accuracy: 409/469 (87.2068%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 4.1025, Accuracy: 3773/10000 (37.7300%)
time spent on training: 356.4804403781891
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4696256444743331  data num: [526, 527, 496, 546, 248, 349, 214, 796, 290, 469]
[rfa agg] considering poison per batch poison_fraction: 0.036689503474557274
[rfa agg] init. name: [17, 33, 77, 11, 23, 34, 52, 92, 57, 74], weight: tensor([0.1179, 0.1181, 0.1112, 0.1224, 0.0556, 0.0782, 0.0480, 0.1784, 0.0650,
        0.1051])
[rfa agg] iter:  0, prev_obj_val: 11677.0224609375, obj_val: 11632.3818359375, abs dis: 44.640625
[rfa agg] iter:  0, weight: tensor([0.1042, 0.1044, 0.1236, 0.1082, 0.0585, 0.0824, 0.0504, 0.1890, 0.0684,
        0.1109])
[rfa agg] iter:  1, prev_obj_val: 11632.3818359375, obj_val: 11588.83984375, abs dis: 43.5419921875
[rfa agg] iter:  1, weight: tensor([0.0972, 0.0974, 0.1137, 0.1009, 0.0617, 0.0870, 0.0532, 0.1996, 0.0722,
        0.1171])
[rfa agg] iter:  2, prev_obj_val: 11588.83984375, obj_val: 11545.8466796875, abs dis: 42.9931640625
[rfa agg] iter:  2, weight: tensor([0.0904, 0.0905, 0.1045, 0.0938, 0.0648, 0.0914, 0.0559, 0.2098, 0.0759,
        0.1230])
[rfa agg] iter:  3, prev_obj_val: 11545.8466796875, obj_val: 11504.765625, abs dis: 41.0810546875
[rfa agg] iter:  3, weight: tensor([0.0836, 0.0837, 0.0956, 0.0868, 0.0679, 0.0957, 0.0586, 0.2198, 0.0794,
        0.1289])
[rfa agg] iter:  4, prev_obj_val: 11504.765625, obj_val: 11465.05078125, abs dis: 39.71484375
[rfa agg] iter:  4, weight: tensor([0.0771, 0.0772, 0.0874, 0.0800, 0.0708, 0.0998, 0.0611, 0.2294, 0.0828,
        0.1344])
[rfa agg] iter:  5, prev_obj_val: 11465.05078125, obj_val: 11426.970703125, abs dis: 38.080078125
[rfa agg] iter:  5, weight: tensor([0.0708, 0.0709, 0.0797, 0.0735, 0.0735, 0.1037, 0.0634, 0.2386, 0.0861,
        0.1397])
[rfa agg] iter:  6, prev_obj_val: 11426.970703125, obj_val: 11390.5234375, abs dis: 36.447265625
[rfa agg] iter:  6, weight: tensor([0.0648, 0.0649, 0.0724, 0.0673, 0.0762, 0.1075, 0.0657, 0.2473, 0.0892,
        0.1448])
[rfa agg] iter:  7, prev_obj_val: 11390.5234375, obj_val: 11355.986328125, abs dis: 34.537109375
[rfa agg] iter:  7, weight: tensor([0.0591, 0.0592, 0.0656, 0.0613, 0.0786, 0.1110, 0.0679, 0.2557, 0.0921,
        0.1496])
[rfa agg] iter:  8, prev_obj_val: 11355.986328125, obj_val: 11323.6259765625, abs dis: 32.3603515625
[rfa agg] iter:  8, weight: tensor([0.0536, 0.0537, 0.0592, 0.0557, 0.0810, 0.1143, 0.0699, 0.2636, 0.0948,
        0.1541])
[rfa agg] iter:  9, prev_obj_val: 11323.6259765625, obj_val: 11293.71484375, abs dis: 29.9111328125
[rfa agg] iter:  9, weight: tensor([0.0485, 0.0486, 0.0533, 0.0504, 0.0831, 0.1174, 0.0717, 0.2711, 0.0974,
        0.1583])
___Test Target_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.1471, Accuracy: 6559/10000 (65.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.1444, Accuracy: 8655/9000 (96.1667%)
Done in 465.1280493736267 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:228 choose agents : [17, 33, 77, 11, 67, 16, 64, 30, 35, 81]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   1,  Average loss: 0.0006, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   2,  Average loss: 0.0014, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   3,  Average loss: 0.0006, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   4,  Average loss: 0.0011, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   5,  Average loss: 0.0006, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   6,  Average loss: 0.0008, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Global model norm: 42.271489022504134.
Norm before scaling: 41.8885355922417. Distance: 2.3177960554231065
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.3959, Accuracy: 6044/10000 (60.4400%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.1055, Accuracy: 8764/9000 (97.3778%)
Scaling by  100
Scaled Norm after poisoning: 227.48299215271018, distance: 231.77961312958482
Total norm for 4 adversaries is: 227.48299215271018. distance: 231.77961312958482
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   1,  Average loss: 0.0005, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   2,  Average loss: 0.0002, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   3,  Average loss: 0.0007, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   4,  Average loss: 0.0001, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   5,  Average loss: 0.0003, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   6,  Average loss: 0.0005, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Global model norm: 42.271489022504134.
Norm before scaling: 41.85236970124123. Distance: 1.3706318656029286
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.2269, Accuracy: 6456/10000 (64.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.1091, Accuracy: 8759/9000 (97.3222%)
Scaling by  100
Scaled Norm after poisoning: 129.84438552792724, distance: 137.06318399282137
Total norm for 4 adversaries is: 129.84438552792724. distance: 137.06318399282137
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   1,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   3,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   4,  Average loss: 0.0001, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   5,  Average loss: 0.0000, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 42.271489022504134.
Norm before scaling: 41.90712241588162. Distance: 1.2058290092814294
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.2217, Accuracy: 6487/10000 (64.8700%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.1000, Accuracy: 8775/9000 (97.5000%)
Scaling by  100
Scaled Norm after poisoning: 114.51866830619801, distance: 120.58289825494533
Total norm for 4 adversaries is: 114.51866830619801. distance: 120.58289825494533
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   1,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   2,  Average loss: 0.0002, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   3,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   4,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 42.271489022504134.
Norm before scaling: 41.8692320537819. Distance: 1.750176352743144
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.3748, Accuracy: 6094/10000 (60.9400%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.0651, Accuracy: 8825/9000 (98.0556%)
Scaling by  100
Scaled Norm after poisoning: 169.49078146023163, distance: 175.01761630083126
Total norm for 4 adversaries is: 169.49078146023163. distance: 175.01761630083126
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 228, local model 67, internal_epoch   1,  Average loss: 0.0198, Accuracy: 540/842 (64.1330%)
___Train Local_ResNet_18,  epoch 228, local model 67, internal_epoch   2,  Average loss: 0.0109, Accuracy: 656/842 (77.9097%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 4.4061, Accuracy: 3233/10000 (32.3300%)
___Train Local_ResNet_18,  epoch 228, local model 16, internal_epoch   1,  Average loss: 0.0243, Accuracy: 482/773 (62.3545%)
___Train Local_ResNet_18,  epoch 228, local model 16, internal_epoch   2,  Average loss: 0.0179, Accuracy: 538/773 (69.5990%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 6.4194, Accuracy: 2380/10000 (23.8000%)
___Train Local_ResNet_18,  epoch 228, local model 64, internal_epoch   1,  Average loss: 0.0171, Accuracy: 477/686 (69.5335%)
___Train Local_ResNet_18,  epoch 228, local model 64, internal_epoch   2,  Average loss: 0.0075, Accuracy: 592/686 (86.2974%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 5.2408, Accuracy: 3269/10000 (32.6900%)
___Train Local_ResNet_18,  epoch 228, local model 30, internal_epoch   1,  Average loss: 0.0234, Accuracy: 210/337 (62.3145%)
___Train Local_ResNet_18,  epoch 228, local model 30, internal_epoch   2,  Average loss: 0.0100, Accuracy: 271/337 (80.4154%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 6.1591, Accuracy: 2475/10000 (24.7500%)
___Train Local_ResNet_18,  epoch 228, local model 35, internal_epoch   1,  Average loss: 0.0210, Accuracy: 278/419 (66.3484%)
___Train Local_ResNet_18,  epoch 228, local model 35, internal_epoch   2,  Average loss: 0.0077, Accuracy: 361/419 (86.1575%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 7.9962, Accuracy: 2256/10000 (22.5600%)
___Train Local_ResNet_18,  epoch 228, local model 81, internal_epoch   1,  Average loss: 0.0149, Accuracy: 775/1034 (74.9516%)
___Train Local_ResNet_18,  epoch 228, local model 81, internal_epoch   2,  Average loss: 0.0087, Accuracy: 860/1034 (83.1721%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 3.8967, Accuracy: 4158/10000 (41.5800%)
time spent on training: 376.6321032047272
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.338667959909473  data num: [526, 527, 496, 546, 842, 773, 686, 337, 419, 1034]
[rfa agg] considering poison per batch poison_fraction: 0.02645843436792758
[rfa agg] init. name: [17, 33, 77, 11, 67, 16, 64, 30, 35, 81], weight: tensor([0.0850, 0.0852, 0.0802, 0.0883, 0.1361, 0.1250, 0.1109, 0.0545, 0.0677,
        0.1672])
[rfa agg] iter:  0, prev_obj_val: 10475.3251953125, obj_val: 9480.9609375, abs dis: 994.3642578125
[rfa agg] iter:  0, weight: tensor([0.0499, 0.0500, 0.0564, 0.0518, 0.1633, 0.1497, 0.1326, 0.0648, 0.0806,
        0.2012])
[rfa agg] iter:  1, prev_obj_val: 9480.9609375, obj_val: 8804.1240234375, abs dis: 676.8369140625
[rfa agg] iter:  1, weight: tensor([0.0284, 0.0285, 0.0312, 0.0295, 0.1820, 0.1668, 0.1475, 0.0718, 0.0894,
        0.2248])
[rfa agg] iter:  2, prev_obj_val: 8804.1240234375, obj_val: 8397.17578125, abs dis: 406.9482421875
[rfa agg] iter:  2, weight: tensor([0.0154, 0.0154, 0.0166, 0.0160, 0.1936, 0.1771, 0.1562, 0.0755, 0.0942,
        0.2401])
[rfa agg] iter:  3, prev_obj_val: 8397.17578125, obj_val: 8167.751953125, abs dis: 229.423828125
[rfa agg] iter:  3, weight: tensor([0.0080, 0.0081, 0.0086, 0.0083, 0.2005, 0.1830, 0.1604, 0.0765, 0.0957,
        0.2509])
[rfa agg] iter:  4, prev_obj_val: 8167.751953125, obj_val: 8040.8369140625, abs dis: 126.9150390625
[rfa agg] iter:  4, weight: tensor([0.0041, 0.0041, 0.0043, 0.0042, 0.2052, 0.1862, 0.1614, 0.0749, 0.0942,
        0.2615])
[rfa agg] iter:  5, prev_obj_val: 8040.8369140625, obj_val: 7977.54345703125, abs dis: 63.29345703125
[rfa agg] iter:  5, weight: tensor([0.0019, 0.0019, 0.0020, 0.0020, 0.2095, 0.1875, 0.1584, 0.0695, 0.0883,
        0.2790])
[rfa agg] iter:  6, prev_obj_val: 7977.54345703125, obj_val: 7946.62255859375, abs dis: 30.9208984375
[rfa agg] iter:  6, weight: tensor([0.0008, 0.0008, 0.0009, 0.0009, 0.2132, 0.1845, 0.1472, 0.0576, 0.0747,
        0.3193])
[rfa agg] iter:  7, prev_obj_val: 7946.62255859375, obj_val: 7941.1240234375, abs dis: 5.49853515625
[rfa agg] iter:  7, weight: tensor([2.5749e-04, 2.5799e-04, 2.7341e-04, 2.6729e-04, 1.9396e-01, 1.5154e-01,
        1.0463e-01, 3.2600e-02, 4.3764e-02, 4.7245e-01])
[rfa agg] iter:  8, prev_obj_val: 7941.1240234375, obj_val: 7946.4873046875, abs dis: 5.36328125
[rfa agg] iter:  8, weight: tensor([1.3673e-04, 1.3700e-04, 1.4516e-04, 1.4194e-04, 3.0731e-01, 2.0247e-01,
        1.1195e-01, 2.5775e-02, 3.5973e-02, 3.1597e-01])
[rfa agg] iter:  9, prev_obj_val: 7946.4873046875, obj_val: 7953.28515625, abs dis: 6.7978515625
[rfa agg] iter:  9, weight: tensor([1.2592e-04, 1.2616e-04, 1.3366e-04, 1.3071e-04, 2.6905e-01, 2.9619e-01,
        2.1343e-01, 3.2579e-02, 4.7556e-02, 1.4068e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.0336, Accuracy: 6720/10000 (67.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.2230, Accuracy: 8500/9000 (94.4444%)
Done in 500.58237886428833 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:229 choose agents : [17, 33, 77, 11, 62, 68, 2, 74, 39, 1]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   1,  Average loss: 0.0017, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   2,  Average loss: 0.0007, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   3,  Average loss: 0.0015, Accuracy: 525/526 (99.8099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   4,  Average loss: 0.0004, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   5,  Average loss: 0.0006, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   6,  Average loss: 0.0019, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 42.23699642715495.
Norm before scaling: 41.877103200447586. Distance: 2.6035171817852154
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.4246, Accuracy: 5775/10000 (57.7500%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.1823, Accuracy: 8585/9000 (95.3889%)
Scaling by  100
Scaled Norm after poisoning: 256.63576146457063, distance: 260.3517302371928
Total norm for 4 adversaries is: 256.63576146457063. distance: 260.3517302371928
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   1,  Average loss: 0.0008, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   2,  Average loss: 0.0004, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   3,  Average loss: 0.0004, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   4,  Average loss: 0.0003, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   5,  Average loss: 0.0002, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   6,  Average loss: 0.0006, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Global model norm: 42.23699642715495.
Norm before scaling: 41.918722801262234. Distance: 2.7650948571322482
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.4059, Accuracy: 6108/10000 (61.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.1136, Accuracy: 8757/9000 (97.3000%)
Scaling by  100
Scaled Norm after poisoning: 273.49295866164454, distance: 276.50947938090655
Total norm for 4 adversaries is: 273.49295866164454. distance: 276.50947938090655
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   2,  Average loss: 0.0005, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   3,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   4,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   5,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Global model norm: 42.23699642715495.
Norm before scaling: 41.87733493956635. Distance: 1.1717793743536555
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.1204, Accuracy: 6640/10000 (66.4000%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.1311, Accuracy: 8720/9000 (96.8889%)
Scaling by  100
Scaled Norm after poisoning: 111.13975840552065, distance: 117.17793710981816
Total norm for 4 adversaries is: 111.13975840552065. distance: 117.17793710981816
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   2,  Average loss: 0.0003, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   3,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   4,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 42.23699642715495.
Norm before scaling: 41.82868240663337. Distance: 1.5017286512401522
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.2793, Accuracy: 6308/10000 (63.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.0847, Accuracy: 8802/9000 (97.8000%)
Scaling by  100
Scaled Norm after poisoning: 143.79769589165886, distance: 150.17287564045978
Total norm for 4 adversaries is: 143.79769589165886. distance: 150.17287564045978
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 229, local model 62, internal_epoch   1,  Average loss: 0.0173, Accuracy: 252/358 (70.3911%)
___Train Local_ResNet_18,  epoch 229, local model 62, internal_epoch   2,  Average loss: 0.0051, Accuracy: 328/358 (91.6201%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 4.2460, Accuracy: 2982/10000 (29.8200%)
___Train Local_ResNet_18,  epoch 229, local model 68, internal_epoch   1,  Average loss: 0.0172, Accuracy: 282/416 (67.7885%)
___Train Local_ResNet_18,  epoch 229, local model 68, internal_epoch   2,  Average loss: 0.0053, Accuracy: 378/416 (90.8654%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 3.8504, Accuracy: 3207/10000 (32.0700%)
___Train Local_ResNet_18,  epoch 229, local model 2, internal_epoch   1,  Average loss: 0.0194, Accuracy: 317/461 (68.7636%)
___Train Local_ResNet_18,  epoch 229, local model 2, internal_epoch   2,  Average loss: 0.0096, Accuracy: 386/461 (83.7310%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 5.7327, Accuracy: 2664/10000 (26.6400%)
___Train Local_ResNet_18,  epoch 229, local model 74, internal_epoch   1,  Average loss: 0.0140, Accuracy: 336/469 (71.6418%)
___Train Local_ResNet_18,  epoch 229, local model 74, internal_epoch   2,  Average loss: 0.0063, Accuracy: 405/469 (86.3539%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 3.1063, Accuracy: 3351/10000 (33.5100%)
___Train Local_ResNet_18,  epoch 229, local model 39, internal_epoch   1,  Average loss: 0.0271, Accuracy: 131/217 (60.3687%)
___Train Local_ResNet_18,  epoch 229, local model 39, internal_epoch   2,  Average loss: 0.0056, Accuracy: 200/217 (92.1659%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 13.2426, Accuracy: 1303/10000 (13.0300%)
___Train Local_ResNet_18,  epoch 229, local model 1, internal_epoch   1,  Average loss: 0.0243, Accuracy: 456/641 (71.1388%)
___Train Local_ResNet_18,  epoch 229, local model 1, internal_epoch   2,  Average loss: 0.0118, Accuracy: 526/641 (82.0593%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 3.9626, Accuracy: 3307/10000 (33.0700%)
time spent on training: 323.50961995124817
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.44986042516641617  data num: [526, 527, 496, 546, 358, 416, 461, 469, 217, 641]
[rfa agg] considering poison per batch poison_fraction: 0.035145345716126264
[rfa agg] init. name: [17, 33, 77, 11, 62, 68, 2, 74, 39, 1], weight: tensor([0.1129, 0.1132, 0.1065, 0.1172, 0.0769, 0.0893, 0.0990, 0.1007, 0.0466,
        0.1376])
[rfa agg] iter:  0, prev_obj_val: 11603.7783203125, obj_val: 11486.1533203125, abs dis: 117.625
[rfa agg] iter:  0, weight: tensor([0.0954, 0.0955, 0.1121, 0.0990, 0.0834, 0.0970, 0.1076, 0.1095, 0.0505,
        0.1500])
[rfa agg] iter:  1, prev_obj_val: 11486.1533203125, obj_val: 11373.041015625, abs dis: 113.1123046875
[rfa agg] iter:  1, weight: tensor([0.0843, 0.0845, 0.0972, 0.0875, 0.0902, 0.1049, 0.1163, 0.1183, 0.0545,
        0.1622])
[rfa agg] iter:  2, prev_obj_val: 11373.041015625, obj_val: 11266.673828125, abs dis: 106.3671875
[rfa agg] iter:  2, weight: tensor([0.0738, 0.0739, 0.0837, 0.0766, 0.0965, 0.1123, 0.1245, 0.1267, 0.0584,
        0.1737])
[rfa agg] iter:  3, prev_obj_val: 11266.673828125, obj_val: 11168.8388671875, abs dis: 97.8349609375
[rfa agg] iter:  3, weight: tensor([0.0639, 0.0640, 0.0716, 0.0663, 0.1023, 0.1191, 0.1321, 0.1344, 0.0619,
        0.1844])
[rfa agg] iter:  4, prev_obj_val: 11168.8388671875, obj_val: 11079.537109375, abs dis: 89.3017578125
[rfa agg] iter:  4, weight: tensor([0.0549, 0.0550, 0.0609, 0.0570, 0.1076, 0.1252, 0.1390, 0.1414, 0.0650,
        0.1940])
[rfa agg] iter:  5, prev_obj_val: 11079.537109375, obj_val: 10999.2177734375, abs dis: 80.3193359375
[rfa agg] iter:  5, weight: tensor([0.0468, 0.0469, 0.0515, 0.0485, 0.1123, 0.1307, 0.1451, 0.1476, 0.0678,
        0.2028])
[rfa agg] iter:  6, prev_obj_val: 10999.2177734375, obj_val: 10927.875, abs dis: 71.3427734375
[rfa agg] iter:  6, weight: tensor([0.0395, 0.0396, 0.0432, 0.0410, 0.1165, 0.1356, 0.1506, 0.1532, 0.0703,
        0.2106])
[rfa agg] iter:  7, prev_obj_val: 10927.875, obj_val: 10865.060546875, abs dis: 62.814453125
[rfa agg] iter:  7, weight: tensor([0.0331, 0.0332, 0.0360, 0.0344, 0.1201, 0.1398, 0.1553, 0.1580, 0.0724,
        0.2175])
[rfa agg] iter:  8, prev_obj_val: 10865.060546875, obj_val: 10811.6689453125, abs dis: 53.3916015625
[rfa agg] iter:  8, weight: tensor([0.0276, 0.0276, 0.0298, 0.0286, 0.1232, 0.1435, 0.1595, 0.1623, 0.0742,
        0.2237])
[rfa agg] iter:  9, prev_obj_val: 10811.6689453125, obj_val: 10766.353515625, abs dis: 45.3154296875
[rfa agg] iter:  9, weight: tensor([0.0228, 0.0229, 0.0246, 0.0237, 0.1257, 0.1466, 0.1630, 0.1658, 0.0757,
        0.2290])
___Test Target_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.0412, Accuracy: 6706/10000 (67.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.1169, Accuracy: 8740/9000 (97.1111%)
Done in 426.86721110343933 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:230 choose agents : [17, 33, 77, 11, 64, 29, 21, 39, 95, 90]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   1,  Average loss: 0.0004, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   2,  Average loss: 0.0010, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   3,  Average loss: 0.0004, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   4,  Average loss: 0.0003, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   5,  Average loss: 0.0005, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   6,  Average loss: 0.0003, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Global model norm: 41.84101786963586.
Norm before scaling: 41.428808713336785. Distance: 1.56607356545911
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.2234, Accuracy: 6433/10000 (64.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.0747, Accuracy: 8811/9000 (97.9000%)
Scaling by  100
Scaled Norm after poisoning: 150.32898818092272, distance: 156.6073476185744
Total norm for 4 adversaries is: 150.32898818092272. distance: 156.6073476185744
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   1,  Average loss: 0.0005, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   2,  Average loss: 0.0008, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   3,  Average loss: 0.0009, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   4,  Average loss: 0.0013, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   5,  Average loss: 0.0010, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   6,  Average loss: 0.0008, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Global model norm: 41.84101786963586.
Norm before scaling: 41.489858100448025. Distance: 2.5327906688241173
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.4398, Accuracy: 5821/10000 (58.2100%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.0530, Accuracy: 8859/9000 (98.4333%)
Scaling by  100
Scaled Norm after poisoning: 249.6661599140941, distance: 253.2790580565239
Total norm for 4 adversaries is: 249.6661599140941. distance: 253.2790580565239
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   1,  Average loss: 0.0006, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   3,  Average loss: 0.0005, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   4,  Average loss: 0.0003, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   5,  Average loss: 0.0001, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 41.84101786963586.
Norm before scaling: 41.48477224386076. Distance: 1.237179190542014
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.1283, Accuracy: 6639/10000 (66.3900%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.1060, Accuracy: 8761/9000 (97.3444%)
Scaling by  100
Scaled Norm after poisoning: 118.04767641190571, distance: 123.7179211894441
Total norm for 4 adversaries is: 118.04767641190571. distance: 123.7179211894441
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   1,  Average loss: 0.0003, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   2,  Average loss: 0.0001, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   3,  Average loss: 0.0001, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   4,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   6,  Average loss: 0.0002, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 41.84101786963586.
Norm before scaling: 41.407006184132804. Distance: 0.9093211849583693
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.1429, Accuracy: 6598/10000 (65.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.0854, Accuracy: 8785/9000 (97.6111%)
Scaling by  100
Scaled Norm after poisoning: 79.5208643759218, distance: 90.93210894673014
Total norm for 4 adversaries is: 79.5208643759218. distance: 90.93210894673014
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 230, local model 64, internal_epoch   1,  Average loss: 0.0144, Accuracy: 483/686 (70.4082%)
___Train Local_ResNet_18,  epoch 230, local model 64, internal_epoch   2,  Average loss: 0.0073, Accuracy: 584/686 (85.1312%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 5.8203, Accuracy: 3404/10000 (34.0400%)
___Train Local_ResNet_18,  epoch 230, local model 29, internal_epoch   1,  Average loss: 0.0138, Accuracy: 650/848 (76.6509%)
___Train Local_ResNet_18,  epoch 230, local model 29, internal_epoch   2,  Average loss: 0.0061, Accuracy: 755/848 (89.0330%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 3.3109, Accuracy: 3462/10000 (34.6200%)
___Train Local_ResNet_18,  epoch 230, local model 21, internal_epoch   1,  Average loss: 0.0183, Accuracy: 190/262 (72.5191%)
___Train Local_ResNet_18,  epoch 230, local model 21, internal_epoch   2,  Average loss: 0.0193, Accuracy: 211/262 (80.5344%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 30.2478, Accuracy: 1277/10000 (12.7700%)
___Train Local_ResNet_18,  epoch 230, local model 39, internal_epoch   1,  Average loss: 0.0244, Accuracy: 128/217 (58.9862%)
___Train Local_ResNet_18,  epoch 230, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 204/217 (94.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 12.5107, Accuracy: 1425/10000 (14.2500%)
___Train Local_ResNet_18,  epoch 230, local model 95, internal_epoch   1,  Average loss: 0.0179, Accuracy: 393/569 (69.0685%)
___Train Local_ResNet_18,  epoch 230, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 494/569 (86.8190%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 6.2801, Accuracy: 2564/10000 (25.6400%)
___Train Local_ResNet_18,  epoch 230, local model 90, internal_epoch   1,  Average loss: 0.0175, Accuracy: 412/578 (71.2803%)
___Train Local_ResNet_18,  epoch 230, local model 90, internal_epoch   2,  Average loss: 0.0076, Accuracy: 495/578 (85.6401%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 6.3646, Accuracy: 2377/10000 (23.7700%)
time spent on training: 350.43934321403503
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.39866793529971456  data num: [526, 527, 496, 546, 686, 848, 262, 217, 569, 578]
[rfa agg] considering poison per batch poison_fraction: 0.0311459324452902
[rfa agg] init. name: [17, 33, 77, 11, 64, 29, 21, 39, 95, 90], weight: tensor([0.1001, 0.1003, 0.0944, 0.1039, 0.1305, 0.1614, 0.0499, 0.0413, 0.1083,
        0.1100])
[rfa agg] iter:  0, prev_obj_val: 11227.25, obj_val: 10781.193359375, abs dis: 446.056640625
[rfa agg] iter:  0, weight: tensor([0.0730, 0.0731, 0.0842, 0.0758, 0.1507, 0.1869, 0.0572, 0.0474, 0.1248,
        0.1269])
[rfa agg] iter:  1, prev_obj_val: 10781.193359375, obj_val: 10399.5322265625, abs dis: 381.6611328125
[rfa agg] iter:  1, weight: tensor([0.0542, 0.0543, 0.0607, 0.0562, 0.1683, 0.2089, 0.0638, 0.0528, 0.1393,
        0.1416])
[rfa agg] iter:  2, prev_obj_val: 10399.5322265625, obj_val: 10095.8466796875, abs dis: 303.685546875
[rfa agg] iter:  2, weight: tensor([0.0388, 0.0389, 0.0427, 0.0403, 0.1824, 0.2266, 0.0690, 0.0570, 0.1508,
        0.1534])
[rfa agg] iter:  3, prev_obj_val: 10095.8466796875, obj_val: 9863.787109375, abs dis: 232.0595703125
[rfa agg] iter:  3, weight: tensor([0.0272, 0.0272, 0.0295, 0.0282, 0.1931, 0.2404, 0.0727, 0.0601, 0.1594,
        0.1623])
[rfa agg] iter:  4, prev_obj_val: 9863.787109375, obj_val: 9696.0888671875, abs dis: 167.6982421875
[rfa agg] iter:  4, weight: tensor([0.0186, 0.0186, 0.0200, 0.0193, 0.2010, 0.2510, 0.0752, 0.0621, 0.1656,
        0.1688])
[rfa agg] iter:  5, prev_obj_val: 9696.0888671875, obj_val: 9578.2568359375, abs dis: 117.83203125
[rfa agg] iter:  5, weight: tensor([0.0125, 0.0125, 0.0134, 0.0130, 0.2066, 0.2594, 0.0766, 0.0631, 0.1697,
        0.1732])
[rfa agg] iter:  6, prev_obj_val: 9578.2568359375, obj_val: 9494.8759765625, abs dis: 83.380859375
[rfa agg] iter:  6, weight: tensor([0.0083, 0.0083, 0.0089, 0.0086, 0.2107, 0.2666, 0.0770, 0.0633, 0.1722,
        0.1762])
[rfa agg] iter:  7, prev_obj_val: 9494.8759765625, obj_val: 9439.6015625, abs dis: 55.2744140625
[rfa agg] iter:  7, weight: tensor([0.0054, 0.0054, 0.0057, 0.0056, 0.2138, 0.2739, 0.0763, 0.0625, 0.1733,
        0.1781])
[rfa agg] iter:  8, prev_obj_val: 9439.6015625, obj_val: 9400.6650390625, abs dis: 38.9365234375
[rfa agg] iter:  8, weight: tensor([0.0035, 0.0035, 0.0037, 0.0036, 0.2162, 0.2826, 0.0744, 0.0607, 0.1730,
        0.1789])
[rfa agg] iter:  9, prev_obj_val: 9400.6650390625, obj_val: 9375.3623046875, abs dis: 25.302734375
[rfa agg] iter:  9, weight: tensor([0.0021, 0.0021, 0.0022, 0.0022, 0.2182, 0.2962, 0.0707, 0.0571, 0.1708,
        0.1785])
___Test Target_ResNet_18 poisoned: False, epoch: 230: Average loss: 0.9606, Accuracy: 6875/10000 (68.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.1450, Accuracy: 8666/9000 (96.2889%)
Done in 452.22471857070923 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:231 choose agents : [17, 33, 77, 11, 68, 38, 97, 3, 98, 90]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   1,  Average loss: 0.0007, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   3,  Average loss: 0.0004, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   4,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   5,  Average loss: 0.0002, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   6,  Average loss: 0.0003, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Global model norm: 41.77600968679946.
Norm before scaling: 41.37652087225541. Distance: 1.5180221948722474
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.2267, Accuracy: 6427/10000 (64.2700%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.0999, Accuracy: 8795/9000 (97.7222%)
Scaling by  100
Scaled Norm after poisoning: 145.72869162419596, distance: 151.8022266491009
Total norm for 4 adversaries is: 145.72869162419596. distance: 151.8022266491009
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   1,  Average loss: 0.0004, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   2,  Average loss: 0.0001, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   3,  Average loss: 0.0003, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   4,  Average loss: 0.0004, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   5,  Average loss: 0.0002, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   6,  Average loss: 0.0002, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Global model norm: 41.77600968679946.
Norm before scaling: 41.37951524881076. Distance: 1.4670162113128677
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.2075, Accuracy: 6515/10000 (65.1500%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.1133, Accuracy: 8759/9000 (97.3222%)
Scaling by  100
Scaled Norm after poisoning: 140.54997304117492, distance: 146.7016596808809
Total norm for 4 adversaries is: 140.54997304117492. distance: 146.7016596808809
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   1,  Average loss: 0.0008, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   3,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   4,  Average loss: 0.0001, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   5,  Average loss: 0.0001, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   6,  Average loss: 0.0000, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Global model norm: 41.77600968679946.
Norm before scaling: 41.417964144876194. Distance: 1.0744607548778051
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.0840, Accuracy: 6745/10000 (67.4500%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.0802, Accuracy: 8818/9000 (97.9778%)
Scaling by  100
Scaled Norm after poisoning: 100.97395819900792, distance: 107.44608477191014
Total norm for 4 adversaries is: 100.97395819900792. distance: 107.44608477191014
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   1,  Average loss: 0.0004, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   2,  Average loss: 0.0001, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   3,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   4,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   5,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   6,  Average loss: 0.0001, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 41.77600968679946.
Norm before scaling: 41.357100841803. Distance: 1.1130488638352372
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.1666, Accuracy: 6536/10000 (65.3600%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.0989, Accuracy: 8765/9000 (97.3889%)
Scaling by  100
Scaled Norm after poisoning: 102.6039440564421, distance: 111.30488902250656
Total norm for 4 adversaries is: 102.6039440564421. distance: 111.30488902250656
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 231, local model 68, internal_epoch   1,  Average loss: 0.0158, Accuracy: 297/416 (71.3942%)
___Train Local_ResNet_18,  epoch 231, local model 68, internal_epoch   2,  Average loss: 0.0066, Accuracy: 369/416 (88.7019%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 3.5992, Accuracy: 3459/10000 (34.5900%)
___Train Local_ResNet_18,  epoch 231, local model 38, internal_epoch   1,  Average loss: 0.0163, Accuracy: 539/756 (71.2963%)
___Train Local_ResNet_18,  epoch 231, local model 38, internal_epoch   2,  Average loss: 0.0083, Accuracy: 622/756 (82.2751%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 3.9452, Accuracy: 3644/10000 (36.4400%)
___Train Local_ResNet_18,  epoch 231, local model 97, internal_epoch   1,  Average loss: 0.0126, Accuracy: 317/418 (75.8373%)
___Train Local_ResNet_18,  epoch 231, local model 97, internal_epoch   2,  Average loss: 0.0037, Accuracy: 385/418 (92.1053%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 5.7182, Accuracy: 2774/10000 (27.7400%)
___Train Local_ResNet_18,  epoch 231, local model 3, internal_epoch   1,  Average loss: 0.0188, Accuracy: 522/780 (66.9231%)
___Train Local_ResNet_18,  epoch 231, local model 3, internal_epoch   2,  Average loss: 0.0087, Accuracy: 659/780 (84.4872%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 3.4653, Accuracy: 3267/10000 (32.6700%)
___Train Local_ResNet_18,  epoch 231, local model 98, internal_epoch   1,  Average loss: 0.0173, Accuracy: 553/802 (68.9526%)
___Train Local_ResNet_18,  epoch 231, local model 98, internal_epoch   2,  Average loss: 0.0075, Accuracy: 688/802 (85.7855%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 3.1319, Accuracy: 3842/10000 (38.4200%)
___Train Local_ResNet_18,  epoch 231, local model 90, internal_epoch   1,  Average loss: 0.0240, Accuracy: 419/578 (72.4913%)
___Train Local_ResNet_18,  epoch 231, local model 90, internal_epoch   2,  Average loss: 0.0117, Accuracy: 447/578 (77.3356%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 8.6831, Accuracy: 2184/10000 (21.8400%)
time spent on training: 331.1326160430908
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.358426005132592  data num: [526, 527, 496, 546, 416, 756, 418, 780, 802, 578]
[rfa agg] considering poison per batch poison_fraction: 0.02800203165098375
[rfa agg] init. name: [17, 33, 77, 11, 68, 38, 97, 3, 98, 90], weight: tensor([0.0900, 0.0902, 0.0849, 0.0934, 0.0712, 0.1293, 0.0715, 0.1334, 0.1372,
        0.0989])
[rfa agg] iter:  0, prev_obj_val: 10762.91796875, obj_val: 9961.255859375, abs dis: 801.662109375
[rfa agg] iter:  0, weight: tensor([0.0570, 0.0571, 0.0648, 0.0592, 0.0842, 0.1538, 0.0846, 0.1588, 0.1633,
        0.1173])
[rfa agg] iter:  1, prev_obj_val: 9961.255859375, obj_val: 9366.0439453125, abs dis: 595.2119140625
[rfa agg] iter:  1, weight: tensor([0.0357, 0.0358, 0.0394, 0.0371, 0.0939, 0.1720, 0.0944, 0.1778, 0.1828,
        0.1311])
[rfa agg] iter:  2, prev_obj_val: 9366.0439453125, obj_val: 8968.4033203125, abs dis: 397.640625
[rfa agg] iter:  2, weight: tensor([0.0213, 0.0214, 0.0231, 0.0221, 0.1001, 0.1844, 0.1006, 0.1907, 0.1961,
        0.1402])
[rfa agg] iter:  3, prev_obj_val: 8968.4033203125, obj_val: 8721.4697265625, abs dis: 246.93359375
[rfa agg] iter:  3, weight: tensor([0.0123, 0.0123, 0.0132, 0.0127, 0.1035, 0.1922, 0.1040, 0.1992, 0.2048,
        0.1457])
[rfa agg] iter:  4, prev_obj_val: 8721.4697265625, obj_val: 8574.5966796875, abs dis: 146.873046875
[rfa agg] iter:  4, weight: tensor([0.0069, 0.0069, 0.0074, 0.0072, 0.1045, 0.1973, 0.1050, 0.2052, 0.2110,
        0.1486])
[rfa agg] iter:  5, prev_obj_val: 8574.5966796875, obj_val: 8489.8017578125, abs dis: 84.794921875
[rfa agg] iter:  5, weight: tensor([0.0038, 0.0038, 0.0040, 0.0039, 0.1033, 0.2011, 0.1038, 0.2104, 0.2164,
        0.1495])
[rfa agg] iter:  6, prev_obj_val: 8489.8017578125, obj_val: 8440.5361328125, abs dis: 49.265625
[rfa agg] iter:  6, weight: tensor([0.0020, 0.0020, 0.0021, 0.0021, 0.0992, 0.2046, 0.0997, 0.2169, 0.2231,
        0.1484])
[rfa agg] iter:  7, prev_obj_val: 8440.5361328125, obj_val: 8415.5146484375, abs dis: 25.021484375
[rfa agg] iter:  7, weight: tensor([0.0010, 0.0010, 0.0010, 0.0010, 0.0896, 0.2091, 0.0901, 0.2286, 0.2352,
        0.1434])
[rfa agg] iter:  8, prev_obj_val: 8415.5146484375, obj_val: 8403.1416015625, abs dis: 12.373046875
[rfa agg] iter:  8, weight: tensor([0.0004, 0.0004, 0.0004, 0.0004, 0.0712, 0.2136, 0.0715, 0.2524, 0.2606,
        0.1290])
[rfa agg] iter:  9, prev_obj_val: 8403.1416015625, obj_val: 8412.6826171875, abs dis: 9.541015625
[rfa agg] iter:  9, weight: tensor([1.2325e-04, 1.2349e-04, 1.3084e-04, 1.2794e-04, 3.6959e-02, 2.0357e-01,
        3.7185e-02, 3.0220e-01, 3.3432e-01, 8.5254e-02])
___Test Target_ResNet_18 poisoned: False, epoch: 231: Average loss: 0.9413, Accuracy: 6898/10000 (68.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.1921, Accuracy: 8586/9000 (95.4000%)
Done in 433.78660464286804 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:232 choose agents : [17, 33, 77, 11, 88, 25, 27, 56, 93, 42]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   1,  Average loss: 0.0007, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   3,  Average loss: 0.0005, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   4,  Average loss: 0.0004, Accuracy: 525/526 (99.8099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   5,  Average loss: 0.0006, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Global model norm: 41.74361238326994.
Norm before scaling: 41.41619426578132. Distance: 2.6961182205473633
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.4861, Accuracy: 5692/10000 (56.9200%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.1103, Accuracy: 8760/9000 (97.3333%)
Scaling by  100
Scaled Norm after poisoning: 266.4269804984097, distance: 269.6118303459624
Total norm for 4 adversaries is: 266.4269804984097. distance: 269.6118303459624
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   1,  Average loss: 0.0010, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   2,  Average loss: 0.0011, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   3,  Average loss: 0.0004, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   4,  Average loss: 0.0004, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   5,  Average loss: 0.0005, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   6,  Average loss: 0.0004, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Global model norm: 41.74361238326994.
Norm before scaling: 41.38734533061555. Distance: 2.105846250872084
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.2516, Accuracy: 6226/10000 (62.2600%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.1003, Accuracy: 8762/9000 (97.3556%)
Scaling by  100
Scaled Norm after poisoning: 206.5992781176885, distance: 210.584621500479
Total norm for 4 adversaries is: 206.5992781176885. distance: 210.584621500479
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   1,  Average loss: 0.0008, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   3,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   4,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   5,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   6,  Average loss: 0.0000, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Global model norm: 41.74361238326994.
Norm before scaling: 41.39657316169117. Distance: 1.1423106345040253
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.0570, Accuracy: 6792/10000 (67.9200%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.1428, Accuracy: 8708/9000 (96.7556%)
Scaling by  100
Scaled Norm after poisoning: 108.51489043127906, distance: 114.23106551251722
Total norm for 4 adversaries is: 108.51489043127906. distance: 114.23106551251722
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   1,  Average loss: 0.0004, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   2,  Average loss: 0.0001, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   3,  Average loss: 0.0001, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   4,  Average loss: 0.0001, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 41.74361238326994.
Norm before scaling: 41.32590819905308. Distance: 1.0715863520386437
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.1451, Accuracy: 6578/10000 (65.7800%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.0785, Accuracy: 8795/9000 (97.7222%)
Scaling by  100
Scaled Norm after poisoning: 98.18767902593481, distance: 107.15864680900697
Total norm for 4 adversaries is: 98.18767902593481. distance: 107.15864680900697
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 232, local model 88, internal_epoch   1,  Average loss: 0.0208, Accuracy: 273/447 (61.0738%)
___Train Local_ResNet_18,  epoch 232, local model 88, internal_epoch   2,  Average loss: 0.0073, Accuracy: 384/447 (85.9060%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 6.1312, Accuracy: 2988/10000 (29.8800%)
___Train Local_ResNet_18,  epoch 232, local model 25, internal_epoch   1,  Average loss: 0.0119, Accuracy: 429/545 (78.7156%)
___Train Local_ResNet_18,  epoch 232, local model 25, internal_epoch   2,  Average loss: 0.0054, Accuracy: 490/545 (89.9083%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 4.3045, Accuracy: 3491/10000 (34.9100%)
___Train Local_ResNet_18,  epoch 232, local model 27, internal_epoch   1,  Average loss: 0.0125, Accuracy: 311/397 (78.3375%)
___Train Local_ResNet_18,  epoch 232, local model 27, internal_epoch   2,  Average loss: 0.0079, Accuracy: 357/397 (89.9244%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 3.4741, Accuracy: 3849/10000 (38.4900%)
___Train Local_ResNet_18,  epoch 232, local model 56, internal_epoch   1,  Average loss: 0.0122, Accuracy: 566/743 (76.1777%)
___Train Local_ResNet_18,  epoch 232, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 664/743 (89.3674%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 2.5095, Accuracy: 4754/10000 (47.5400%)
___Train Local_ResNet_18,  epoch 232, local model 93, internal_epoch   1,  Average loss: 0.0131, Accuracy: 439/584 (75.1712%)
___Train Local_ResNet_18,  epoch 232, local model 93, internal_epoch   2,  Average loss: 0.0066, Accuracy: 517/584 (88.5274%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 5.0252, Accuracy: 2745/10000 (27.4500%)
___Train Local_ResNet_18,  epoch 232, local model 42, internal_epoch   1,  Average loss: 0.0228, Accuracy: 128/198 (64.6465%)
___Train Local_ResNet_18,  epoch 232, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 184/198 (92.9293%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 8.6094, Accuracy: 1819/10000 (18.1900%)
time spent on training: 325.91929626464844
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4182471551207826  data num: [526, 527, 496, 546, 447, 545, 397, 743, 584, 198]
[rfa agg] considering poison per batch poison_fraction: 0.03267555899381114
[rfa agg] init. name: [17, 33, 77, 11, 88, 25, 27, 56, 93, 42], weight: tensor([0.1050, 0.1052, 0.0990, 0.1090, 0.0892, 0.1088, 0.0793, 0.1483, 0.1166,
        0.0395])
[rfa agg] iter:  0, prev_obj_val: 11402.2119140625, obj_val: 11103.7451171875, abs dis: 298.466796875
[rfa agg] iter:  0, weight: tensor([0.0814, 0.0815, 0.0945, 0.0845, 0.1008, 0.1231, 0.0895, 0.1683, 0.1320,
        0.0445])
[rfa agg] iter:  1, prev_obj_val: 11103.7451171875, obj_val: 10833.09765625, abs dis: 270.6474609375
[rfa agg] iter:  1, weight: tensor([0.0650, 0.0651, 0.0735, 0.0675, 0.1115, 0.1363, 0.0991, 0.1865, 0.1462,
        0.0492])
[rfa agg] iter:  2, prev_obj_val: 10833.09765625, obj_val: 10599.7705078125, abs dis: 233.3271484375
[rfa agg] iter:  2, weight: tensor([0.0506, 0.0507, 0.0562, 0.0525, 0.1208, 0.1477, 0.1073, 0.2023, 0.1585,
        0.0533])
[rfa agg] iter:  3, prev_obj_val: 10599.7705078125, obj_val: 10407.41015625, abs dis: 192.3603515625
[rfa agg] iter:  3, weight: tensor([0.0386, 0.0386, 0.0423, 0.0400, 0.1284, 0.1572, 0.1141, 0.2155, 0.1687,
        0.0566])
[rfa agg] iter:  4, prev_obj_val: 10407.41015625, obj_val: 10253.8173828125, abs dis: 153.5927734375
[rfa agg] iter:  4, weight: tensor([0.0289, 0.0290, 0.0314, 0.0300, 0.1344, 0.1647, 0.1194, 0.2262, 0.1769,
        0.0591])
[rfa agg] iter:  5, prev_obj_val: 10253.8173828125, obj_val: 10133.873046875, abs dis: 119.9443359375
[rfa agg] iter:  5, weight: tensor([0.0214, 0.0214, 0.0230, 0.0222, 0.1390, 0.1705, 0.1234, 0.2348, 0.1833,
        0.0610])
[rfa agg] iter:  6, prev_obj_val: 10133.873046875, obj_val: 10043.1865234375, abs dis: 90.6865234375
[rfa agg] iter:  6, weight: tensor([0.0156, 0.0156, 0.0167, 0.0162, 0.1423, 0.1750, 0.1264, 0.2418, 0.1884,
        0.0622])
[rfa agg] iter:  7, prev_obj_val: 10043.1865234375, obj_val: 9974.4404296875, abs dis: 68.74609375
[rfa agg] iter:  7, weight: tensor([0.0112, 0.0113, 0.0120, 0.0117, 0.1445, 0.1783, 0.1283, 0.2476, 0.1922,
        0.0629])
[rfa agg] iter:  8, prev_obj_val: 9974.4404296875, obj_val: 9923.984375, abs dis: 50.4560546875
[rfa agg] iter:  8, weight: tensor([0.0080, 0.0080, 0.0085, 0.0083, 0.1458, 0.1807, 0.1295, 0.2528, 0.1953,
        0.0630])
[rfa agg] iter:  9, prev_obj_val: 9923.984375, obj_val: 9886.6943359375, abs dis: 37.2900390625
[rfa agg] iter:  9, weight: tensor([0.0056, 0.0056, 0.0060, 0.0059, 0.1462, 0.1825, 0.1298, 0.2580, 0.1979,
        0.0625])
___Test Target_ResNet_18 poisoned: False, epoch: 232: Average loss: 0.9016, Accuracy: 7050/10000 (70.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.1911, Accuracy: 8588/9000 (95.4222%)
Done in 440.2609040737152 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:233 choose agents : [17, 33, 77, 11, 18, 66, 27, 82, 86, 67]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   1,  Average loss: 0.0007, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   3,  Average loss: 0.0004, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   4,  Average loss: 0.0010, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   5,  Average loss: 0.0005, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   6,  Average loss: 0.0006, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Global model norm: 41.630797386257505.
Norm before scaling: 41.25307309812279. Distance: 2.0161456241540217
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.2738, Accuracy: 6233/10000 (62.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.1149, Accuracy: 8765/9000 (97.3889%)
Scaling by  100
Scaled Norm after poisoning: 197.08972417404212, distance: 201.6145669185389
Total norm for 4 adversaries is: 197.08972417404212. distance: 201.6145669185389
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   1,  Average loss: 0.0013, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   2,  Average loss: 0.0012, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   3,  Average loss: 0.0006, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   4,  Average loss: 0.0007, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   5,  Average loss: 0.0011, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   6,  Average loss: 0.0006, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Global model norm: 41.630797386257505.
Norm before scaling: 41.38223065123333. Distance: 3.330957201602304
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.5197, Accuracy: 5820/10000 (58.2000%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.1687, Accuracy: 8610/9000 (95.6667%)
Scaling by  100
Scaled Norm after poisoning: 330.9274018761517, distance: 333.09571869434166
Total norm for 4 adversaries is: 330.9274018761517. distance: 333.09571869434166
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   1,  Average loss: 0.0008, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   2,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   3,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   4,  Average loss: 0.0002, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 41.630797386257505.
Norm before scaling: 41.280046467126525. Distance: 1.0884999840648337
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.0612, Accuracy: 6770/10000 (67.7000%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.0984, Accuracy: 8762/9000 (97.3556%)
Scaling by  100
Scaled Norm after poisoning: 102.73684526497784, distance: 108.85000340922136
Total norm for 4 adversaries is: 102.73684526497784. distance: 108.85000340922136
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   1,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   2,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   3,  Average loss: 0.0001, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   4,  Average loss: 0.0001, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   5,  Average loss: 0.0001, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Global model norm: 41.630797386257505.
Norm before scaling: 41.21829836513375. Distance: 1.1193895845299082
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.1289, Accuracy: 6605/10000 (66.0500%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.0911, Accuracy: 8784/9000 (97.6000%)
Scaling by  100
Scaled Norm after poisoning: 103.54057836031002, distance: 111.9389394798566
Total norm for 4 adversaries is: 103.54057836031002. distance: 111.9389394798566
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 233, local model 18, internal_epoch   1,  Average loss: 0.0146, Accuracy: 287/386 (74.3523%)
___Train Local_ResNet_18,  epoch 233, local model 18, internal_epoch   2,  Average loss: 0.0085, Accuracy: 331/386 (85.7513%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 5.4040, Accuracy: 2875/10000 (28.7500%)
___Train Local_ResNet_18,  epoch 233, local model 66, internal_epoch   1,  Average loss: 0.0090, Accuracy: 470/555 (84.6847%)
___Train Local_ResNet_18,  epoch 233, local model 66, internal_epoch   2,  Average loss: 0.0026, Accuracy: 528/555 (95.1351%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 3.8727, Accuracy: 3868/10000 (38.6800%)
___Train Local_ResNet_18,  epoch 233, local model 27, internal_epoch   1,  Average loss: 0.0095, Accuracy: 323/397 (81.3602%)
___Train Local_ResNet_18,  epoch 233, local model 27, internal_epoch   2,  Average loss: 0.0029, Accuracy: 375/397 (94.4584%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 3.4151, Accuracy: 3869/10000 (38.6900%)
___Train Local_ResNet_18,  epoch 233, local model 82, internal_epoch   1,  Average loss: 0.0125, Accuracy: 484/601 (80.5324%)
___Train Local_ResNet_18,  epoch 233, local model 82, internal_epoch   2,  Average loss: 0.0049, Accuracy: 542/601 (90.1830%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 3.1855, Accuracy: 4366/10000 (43.6600%)
___Train Local_ResNet_18,  epoch 233, local model 86, internal_epoch   1,  Average loss: 0.0167, Accuracy: 146/212 (68.8679%)
___Train Local_ResNet_18,  epoch 233, local model 86, internal_epoch   2,  Average loss: 0.0025, Accuracy: 205/212 (96.6981%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 2.8040, Accuracy: 3959/10000 (39.5900%)
___Train Local_ResNet_18,  epoch 233, local model 67, internal_epoch   1,  Average loss: 0.0148, Accuracy: 609/842 (72.3278%)
___Train Local_ResNet_18,  epoch 233, local model 67, internal_epoch   2,  Average loss: 0.0139, Accuracy: 631/842 (74.9406%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 10.1836, Accuracy: 1550/10000 (15.5000%)
time spent on training: 357.8990969657898
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4117531446540881  data num: [526, 527, 496, 546, 386, 555, 397, 601, 212, 842]
[rfa agg] considering poison per batch poison_fraction: 0.03216821442610063
[rfa agg] init. name: [17, 33, 77, 11, 18, 66, 27, 82, 86, 67], weight: tensor([0.1034, 0.1036, 0.0975, 0.1073, 0.0759, 0.1091, 0.0780, 0.1181, 0.0417,
        0.1655])
[rfa agg] iter:  0, prev_obj_val: 11346.857421875, obj_val: 11001.779296875, abs dis: 345.078125
[rfa agg] iter:  0, weight: tensor([0.0785, 0.0787, 0.0910, 0.0815, 0.0862, 0.1242, 0.0887, 0.1346, 0.0472,
        0.1893])
[rfa agg] iter:  1, prev_obj_val: 11001.779296875, obj_val: 10694.634765625, abs dis: 307.14453125
[rfa agg] iter:  1, weight: tensor([0.0613, 0.0614, 0.0691, 0.0636, 0.0957, 0.1380, 0.0985, 0.1496, 0.0524,
        0.2106])
[rfa agg] iter:  2, prev_obj_val: 10694.634765625, obj_val: 10437.2451171875, abs dis: 257.3896484375
[rfa agg] iter:  2, weight: tensor([0.0464, 0.0465, 0.0514, 0.0482, 0.1037, 0.1496, 0.1067, 0.1622, 0.0567,
        0.2286])
[rfa agg] iter:  3, prev_obj_val: 10437.2451171875, obj_val: 10229.60546875, abs dis: 207.6396484375
[rfa agg] iter:  3, weight: tensor([0.0344, 0.0345, 0.0376, 0.0357, 0.1100, 0.1588, 0.1131, 0.1723, 0.0601,
        0.2434])
[rfa agg] iter:  4, prev_obj_val: 10229.60546875, obj_val: 10069.337890625, abs dis: 160.267578125
[rfa agg] iter:  4, weight: tensor([0.0250, 0.0251, 0.0271, 0.0260, 0.1148, 0.1660, 0.1181, 0.1802, 0.0625,
        0.2552])
[rfa agg] iter:  5, prev_obj_val: 10069.337890625, obj_val: 9947.7626953125, abs dis: 121.5751953125
[rfa agg] iter:  5, weight: tensor([0.0179, 0.0180, 0.0193, 0.0186, 0.1182, 0.1712, 0.1216, 0.1861, 0.0642,
        0.2647])
[rfa agg] iter:  6, prev_obj_val: 9947.7626953125, obj_val: 9858.5576171875, abs dis: 89.205078125
[rfa agg] iter:  6, weight: tensor([0.0127, 0.0127, 0.0136, 0.0132, 0.1205, 0.1751, 0.1239, 0.1906, 0.0652,
        0.2727])
[rfa agg] iter:  7, prev_obj_val: 9858.5576171875, obj_val: 9792.25, abs dis: 66.3076171875
[rfa agg] iter:  7, weight: tensor([0.0089, 0.0089, 0.0095, 0.0092, 0.1217, 0.1776, 0.1252, 0.1938, 0.0654,
        0.2799])
[rfa agg] iter:  8, prev_obj_val: 9792.25, obj_val: 9744.8984375, abs dis: 47.3515625
[rfa agg] iter:  8, weight: tensor([0.0060, 0.0061, 0.0064, 0.0063, 0.1220, 0.1792, 0.1255, 0.1962, 0.0649,
        0.2874])
[rfa agg] iter:  9, prev_obj_val: 9744.8984375, obj_val: 9710.9755859375, abs dis: 33.9228515625
[rfa agg] iter:  9, weight: tensor([0.0041, 0.0041, 0.0043, 0.0042, 0.1212, 0.1798, 0.1246, 0.1978, 0.0636,
        0.2964])
___Test Target_ResNet_18 poisoned: False, epoch: 233: Average loss: 0.9240, Accuracy: 6950/10000 (69.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.1891, Accuracy: 8594/9000 (95.4889%)
Done in 464.095014333725 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:234 choose agents : [17, 33, 77, 11, 38, 29, 30, 96, 0, 3]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   1,  Average loss: 0.0006, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   3,  Average loss: 0.0003, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   4,  Average loss: 0.0002, Accuracy: 525/526 (99.8099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   5,  Average loss: 0.0006, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   6,  Average loss: 0.0008, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Global model norm: 41.54520904425984.
Norm before scaling: 41.1410270465543. Distance: 1.3993516203957719
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.1553, Accuracy: 6430/10000 (64.3000%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.0660, Accuracy: 8831/9000 (98.1222%)
Scaling by  100
Scaled Norm after poisoning: 133.30414882422076, distance: 139.93514122621238
Total norm for 4 adversaries is: 133.30414882422076. distance: 139.93514122621238
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   1,  Average loss: 0.0006, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   2,  Average loss: 0.0002, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   3,  Average loss: 0.0004, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   4,  Average loss: 0.0003, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   5,  Average loss: 0.0001, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   6,  Average loss: 0.0002, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Global model norm: 41.54520904425984.
Norm before scaling: 41.15706713074545. Distance: 1.3505078208326855
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.2627, Accuracy: 6404/10000 (64.0400%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.1560, Accuracy: 8684/9000 (96.4889%)
Scaling by  100
Scaled Norm after poisoning: 128.7334789157428, distance: 135.05078616487208
Total norm for 4 adversaries is: 128.7334789157428. distance: 135.05078616487208
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   1,  Average loss: 0.0009, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   3,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   4,  Average loss: 0.0001, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 41.54520904425984.
Norm before scaling: 41.204748498542315. Distance: 1.2256997348189738
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.0332, Accuracy: 6833/10000 (68.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.1122, Accuracy: 8749/9000 (97.2111%)
Scaling by  100
Scaled Norm after poisoning: 117.39601449261384, distance: 122.5699616864283
Total norm for 4 adversaries is: 117.39601449261384. distance: 122.5699616864283
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   1,  Average loss: 0.0005, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   2,  Average loss: 0.0002, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   3,  Average loss: 0.0001, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   4,  Average loss: 0.0000, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 41.54520904425984.
Norm before scaling: 41.13178491712644. Distance: 1.080879452225608
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.0955, Accuracy: 6668/10000 (66.6800%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.0833, Accuracy: 8791/9000 (97.6778%)
Scaling by  100
Scaled Norm after poisoning: 99.36859747456688, distance: 108.08794524020706
Total norm for 4 adversaries is: 99.36859747456688. distance: 108.08794524020706
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 234, local model 38, internal_epoch   1,  Average loss: 0.0112, Accuracy: 596/756 (78.8360%)
___Train Local_ResNet_18,  epoch 234, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 683/756 (90.3439%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 3.3029, Accuracy: 4008/10000 (40.0800%)
___Train Local_ResNet_18,  epoch 234, local model 29, internal_epoch   1,  Average loss: 0.0120, Accuracy: 676/848 (79.7170%)
___Train Local_ResNet_18,  epoch 234, local model 29, internal_epoch   2,  Average loss: 0.0043, Accuracy: 775/848 (91.3915%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 2.8531, Accuracy: 3869/10000 (38.6900%)
___Train Local_ResNet_18,  epoch 234, local model 30, internal_epoch   1,  Average loss: 0.0211, Accuracy: 206/337 (61.1276%)
___Train Local_ResNet_18,  epoch 234, local model 30, internal_epoch   2,  Average loss: 0.0070, Accuracy: 286/337 (84.8665%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 4.8054, Accuracy: 2833/10000 (28.3300%)
___Train Local_ResNet_18,  epoch 234, local model 96, internal_epoch   1,  Average loss: 0.0192, Accuracy: 471/708 (66.5254%)
___Train Local_ResNet_18,  epoch 234, local model 96, internal_epoch   2,  Average loss: 0.0136, Accuracy: 525/708 (74.1525%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 4.1300, Accuracy: 2769/10000 (27.6900%)
___Train Local_ResNet_18,  epoch 234, local model 0, internal_epoch   1,  Average loss: 0.0170, Accuracy: 256/367 (69.7548%)
___Train Local_ResNet_18,  epoch 234, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 337/367 (91.8256%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 5.7353, Accuracy: 2467/10000 (24.6700%)
___Train Local_ResNet_18,  epoch 234, local model 3, internal_epoch   1,  Average loss: 0.0190, Accuracy: 547/780 (70.1282%)
___Train Local_ResNet_18,  epoch 234, local model 3, internal_epoch   2,  Average loss: 0.0111, Accuracy: 614/780 (78.7179%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 3.9349, Accuracy: 2928/10000 (29.2800%)
time spent on training: 344.0177729129791
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.35562722797487695  data num: [526, 527, 496, 546, 756, 848, 337, 708, 367, 780]
[rfa agg] considering poison per batch poison_fraction: 0.02778337718553726
[rfa agg] init. name: [17, 33, 77, 11, 38, 29, 30, 96, 0, 3], weight: tensor([0.0893, 0.0895, 0.0842, 0.0927, 0.1283, 0.1439, 0.0572, 0.1202, 0.0623,
        0.1324])
[rfa agg] iter:  0, prev_obj_val: 10725.6201171875, obj_val: 9895.203125, abs dis: 830.4169921875
[rfa agg] iter:  0, weight: tensor([0.0560, 0.0561, 0.0637, 0.0582, 0.1526, 0.1716, 0.0676, 0.1429, 0.0736,
        0.1576])
[rfa agg] iter:  1, prev_obj_val: 9895.203125, obj_val: 9286.9375, abs dis: 608.265625
[rfa agg] iter:  1, weight: tensor([0.0346, 0.0347, 0.0382, 0.0360, 0.1707, 0.1921, 0.0754, 0.1599, 0.0821,
        0.1764])
[rfa agg] iter:  2, prev_obj_val: 9286.9375, obj_val: 8886.6025390625, abs dis: 400.3349609375
[rfa agg] iter:  2, weight: tensor([0.0204, 0.0204, 0.0221, 0.0212, 0.1826, 0.2060, 0.0801, 0.1710, 0.0873,
        0.1889])
[rfa agg] iter:  3, prev_obj_val: 8886.6025390625, obj_val: 8641.2451171875, abs dis: 245.357421875
[rfa agg] iter:  3, weight: tensor([0.0116, 0.0116, 0.0124, 0.0120, 0.1900, 0.2152, 0.0824, 0.1780, 0.0898,
        0.1970])
[rfa agg] iter:  4, prev_obj_val: 8641.2451171875, obj_val: 8496.6337890625, abs dis: 144.611328125
[rfa agg] iter:  4, weight: tensor([0.0064, 0.0064, 0.0068, 0.0067, 0.1946, 0.2219, 0.0826, 0.1822, 0.0900,
        0.2024])
[rfa agg] iter:  5, prev_obj_val: 8496.6337890625, obj_val: 8415.3291015625, abs dis: 81.3046875
[rfa agg] iter:  5, weight: tensor([0.0034, 0.0034, 0.0037, 0.0036, 0.1974, 0.2284, 0.0806, 0.1849, 0.0878,
        0.2068])
[rfa agg] iter:  6, prev_obj_val: 8415.3291015625, obj_val: 8367.6845703125, abs dis: 47.64453125
[rfa agg] iter:  6, weight: tensor([0.0018, 0.0018, 0.0019, 0.0018, 0.1992, 0.2374, 0.0755, 0.1865, 0.0822,
        0.2117])
[rfa agg] iter:  7, prev_obj_val: 8367.6845703125, obj_val: 8343.576171875, abs dis: 24.1083984375
[rfa agg] iter:  7, weight: tensor([0.0008, 0.0008, 0.0009, 0.0008, 0.1995, 0.2568, 0.0642, 0.1866, 0.0699,
        0.2197])
[rfa agg] iter:  8, prev_obj_val: 8343.576171875, obj_val: 8337.107421875, abs dis: 6.46875
[rfa agg] iter:  8, weight: tensor([2.9955e-04, 3.0012e-04, 3.1804e-04, 3.1094e-04, 1.8942e-01, 3.1361e-01,
        4.2754e-02, 1.7569e-01, 4.6560e-02, 2.3074e-01])
[rfa agg] iter:  9, prev_obj_val: 8337.107421875, obj_val: 8343.7548828125, abs dis: 6.6474609375
[rfa agg] iter:  9, weight: tensor([8.7023e-05, 8.7188e-05, 9.2369e-05, 9.0332e-05, 2.7704e-01, 2.1163e-01,
        2.2771e-02, 2.1073e-01, 2.4796e-02, 2.5268e-01])
___Test Target_ResNet_18 poisoned: False, epoch: 234: Average loss: 0.9160, Accuracy: 6968/10000 (69.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.2581, Accuracy: 8476/9000 (94.1778%)
Done in 444.2349328994751 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:235 choose agents : [17, 33, 77, 11, 8, 68, 79, 90, 21, 25]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   1,  Average loss: 0.0007, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   3,  Average loss: 0.0005, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   4,  Average loss: 0.0014, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   5,  Average loss: 0.0006, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   6,  Average loss: 0.0016, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Global model norm: 41.51701723060753.
Norm before scaling: 41.14788052001054. Distance: 2.106842102681139
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.1540, Accuracy: 6474/10000 (64.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.1139, Accuracy: 8737/9000 (97.0778%)
Scaling by  100
Scaled Norm after poisoning: 206.43677149432463, distance: 210.68423684806132
Total norm for 4 adversaries is: 206.43677149432463. distance: 210.68423684806132
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   1,  Average loss: 0.0013, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   2,  Average loss: 0.0003, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   3,  Average loss: 0.0002, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   4,  Average loss: 0.0001, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   5,  Average loss: 0.0001, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   6,  Average loss: 0.0001, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Global model norm: 41.51701723060753.
Norm before scaling: 41.19515322721913. Distance: 2.3678397611388173
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.1927, Accuracy: 6498/10000 (64.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.0864, Accuracy: 8813/9000 (97.9222%)
Scaling by  100
Scaled Norm after poisoning: 233.59667431279925, distance: 236.78397822435116
Total norm for 4 adversaries is: 233.59667431279925. distance: 236.78397822435116
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   1,  Average loss: 0.0008, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   3,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   4,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 41.51701723060753.
Norm before scaling: 41.18147569514341. Distance: 1.2910139629220578
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.0429, Accuracy: 6763/10000 (67.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.0844, Accuracy: 8798/9000 (97.7556%)
Scaling by  100
Scaled Norm after poisoning: 124.29500411068419, distance: 129.10138639360153
Total norm for 4 adversaries is: 124.29500411068419. distance: 129.10138639360153
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   1,  Average loss: 0.0009, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   2,  Average loss: 0.0002, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   3,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   4,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 41.51701723060753.
Norm before scaling: 41.114395954306566. Distance: 1.26434977771683
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.1430, Accuracy: 6531/10000 (65.3100%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.0841, Accuracy: 8777/9000 (97.5222%)
Scaling by  100
Scaled Norm after poisoning: 119.25890133182932, distance: 126.43496660833189
Total norm for 4 adversaries is: 119.25890133182932. distance: 126.43496660833189
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 235, local model 8, internal_epoch   1,  Average loss: 0.0133, Accuracy: 386/534 (72.2846%)
___Train Local_ResNet_18,  epoch 235, local model 8, internal_epoch   2,  Average loss: 0.0039, Accuracy: 494/534 (92.5094%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 2.6202, Accuracy: 3709/10000 (37.0900%)
___Train Local_ResNet_18,  epoch 235, local model 68, internal_epoch   1,  Average loss: 0.0127, Accuracy: 316/416 (75.9615%)
___Train Local_ResNet_18,  epoch 235, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 379/416 (91.1058%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 2.5982, Accuracy: 4261/10000 (42.6100%)
___Train Local_ResNet_18,  epoch 235, local model 79, internal_epoch   1,  Average loss: 0.0211, Accuracy: 94/154 (61.0390%)
___Train Local_ResNet_18,  epoch 235, local model 79, internal_epoch   2,  Average loss: 0.0015, Accuracy: 153/154 (99.3506%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 3.4206, Accuracy: 3320/10000 (33.2000%)
___Train Local_ResNet_18,  epoch 235, local model 90, internal_epoch   1,  Average loss: 0.0220, Accuracy: 438/578 (75.7785%)
___Train Local_ResNet_18,  epoch 235, local model 90, internal_epoch   2,  Average loss: 0.0148, Accuracy: 432/578 (74.7405%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 9.1153, Accuracy: 1620/10000 (16.2000%)
___Train Local_ResNet_18,  epoch 235, local model 21, internal_epoch   1,  Average loss: 0.0135, Accuracy: 198/262 (75.5725%)
___Train Local_ResNet_18,  epoch 235, local model 21, internal_epoch   2,  Average loss: 0.0150, Accuracy: 225/262 (85.8779%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 19.2578, Accuracy: 1460/10000 (14.6000%)
___Train Local_ResNet_18,  epoch 235, local model 25, internal_epoch   1,  Average loss: 0.0117, Accuracy: 427/545 (78.3486%)
___Train Local_ResNet_18,  epoch 235, local model 25, internal_epoch   2,  Average loss: 0.0027, Accuracy: 516/545 (94.6789%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 3.6547, Accuracy: 3717/10000 (37.1700%)
time spent on training: 375.7748079299927
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4570244328097731  data num: [526, 527, 496, 546, 534, 416, 154, 578, 262, 545]
[rfa agg] considering poison per batch poison_fraction: 0.03570503381326352
[rfa agg] init. name: [17, 33, 77, 11, 8, 68, 79, 90, 21, 25], weight: tensor([0.1147, 0.1150, 0.1082, 0.1191, 0.1165, 0.0908, 0.0336, 0.1261, 0.0572,
        0.1189])
[rfa agg] iter:  0, prev_obj_val: 11634.4443359375, obj_val: 11547.490234375, abs dis: 86.9541015625
[rfa agg] iter:  0, weight: tensor([0.0986, 0.0988, 0.1163, 0.1024, 0.1254, 0.0975, 0.0360, 0.1358, 0.0613,
        0.1279])
[rfa agg] iter:  1, prev_obj_val: 11547.490234375, obj_val: 11462.85546875, abs dis: 84.634765625
[rfa agg] iter:  1, weight: tensor([0.0890, 0.0892, 0.1032, 0.0924, 0.1344, 0.1045, 0.0386, 0.1457, 0.0657,
        0.1372])
[rfa agg] iter:  2, prev_obj_val: 11462.85546875, obj_val: 11382.078125, abs dis: 80.77734375
[rfa agg] iter:  2, weight: tensor([0.0797, 0.0799, 0.0911, 0.0828, 0.1431, 0.1113, 0.0410, 0.1551, 0.0699,
        0.1461])
[rfa agg] iter:  3, prev_obj_val: 11382.078125, obj_val: 11305.5361328125, abs dis: 76.5419921875
[rfa agg] iter:  3, weight: tensor([0.0708, 0.0710, 0.0800, 0.0735, 0.1513, 0.1176, 0.0433, 0.1640, 0.0739,
        0.1545])
[rfa agg] iter:  4, prev_obj_val: 11305.5361328125, obj_val: 11234.3837890625, abs dis: 71.15234375
[rfa agg] iter:  4, weight: tensor([0.0625, 0.0626, 0.0698, 0.0649, 0.1590, 0.1235, 0.0455, 0.1723, 0.0776,
        0.1623])
[rfa agg] iter:  5, prev_obj_val: 11234.3837890625, obj_val: 11168.6181640625, abs dis: 65.765625
[rfa agg] iter:  5, weight: tensor([0.0548, 0.0549, 0.0607, 0.0568, 0.1660, 0.1290, 0.0475, 0.1800, 0.0810,
        0.1695])
[rfa agg] iter:  6, prev_obj_val: 11168.6181640625, obj_val: 11109.0107421875, abs dis: 59.607421875
[rfa agg] iter:  6, weight: tensor([0.0477, 0.0477, 0.0524, 0.0495, 0.1725, 0.1339, 0.0492, 0.1870, 0.0841,
        0.1760])
[rfa agg] iter:  7, prev_obj_val: 11109.0107421875, obj_val: 11055.1708984375, abs dis: 53.83984375
[rfa agg] iter:  7, weight: tensor([0.0413, 0.0413, 0.0451, 0.0428, 0.1783, 0.1383, 0.0508, 0.1933, 0.0868,
        0.1819])
[rfa agg] iter:  8, prev_obj_val: 11055.1708984375, obj_val: 11007.1015625, abs dis: 48.0693359375
[rfa agg] iter:  8, weight: tensor([0.0355, 0.0356, 0.0386, 0.0369, 0.1835, 0.1423, 0.0522, 0.1990, 0.0892,
        0.1872])
[rfa agg] iter:  9, prev_obj_val: 11007.1015625, obj_val: 10965.1875, abs dis: 41.9140625
[rfa agg] iter:  9, weight: tensor([0.0304, 0.0305, 0.0330, 0.0316, 0.1881, 0.1457, 0.0534, 0.2041, 0.0913,
        0.1919])
___Test Target_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.0429, Accuracy: 6774/10000 (67.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.0729, Accuracy: 8821/9000 (98.0111%)
Done in 475.65657663345337 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:236 choose agents : [17, 33, 77, 11, 53, 14, 6, 12, 7, 58]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 525/526 (99.8099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   2,  Average loss: 0.0016, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   3,  Average loss: 0.0008, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   4,  Average loss: 0.0007, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   5,  Average loss: 0.0006, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   6,  Average loss: 0.0007, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Global model norm: 41.02341146328445.
Norm before scaling: 40.74499256283295. Distance: 3.316494674312572
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.4584, Accuracy: 5919/10000 (59.1900%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.1183, Accuracy: 8753/9000 (97.2556%)
Scaling by  100
Scaled Norm after poisoning: 329.08631798891304, distance: 331.64951143865716
Total norm for 4 adversaries is: 329.08631798891304. distance: 331.64951143865716
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   1,  Average loss: 0.0002, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   2,  Average loss: 0.0001, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   3,  Average loss: 0.0001, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   4,  Average loss: 0.0001, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   5,  Average loss: 0.0004, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   6,  Average loss: 0.0003, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Global model norm: 41.02341146328445.
Norm before scaling: 40.613198406006205. Distance: 1.1257683990825122
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.1480, Accuracy: 6635/10000 (66.3500%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.1162, Accuracy: 8758/9000 (97.3111%)
Scaling by  100
Scaled Norm after poisoning: 104.31146082466202, distance: 112.57681839109907
Total norm for 4 adversaries is: 104.31146082466202. distance: 112.57681839109907
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   1,  Average loss: 0.0004, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   2,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   3,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   4,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 41.02341146328445.
Norm before scaling: 40.664582579527206. Distance: 0.8705082794729122
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.0731, Accuracy: 6804/10000 (68.0400%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.0705, Accuracy: 8829/9000 (98.1000%)
Scaling by  100
Scaled Norm after poisoning: 79.08062724503866, distance: 87.05082813901026
Total norm for 4 adversaries is: 79.08062724503866. distance: 87.05082813901026
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   1,  Average loss: 0.0004, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   2,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   3,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   4,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 41.02341146328445.
Norm before scaling: 40.604213432075. Distance: 1.0703867865629277
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.1628, Accuracy: 6561/10000 (65.6100%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.1071, Accuracy: 8741/9000 (97.1222%)
Scaling by  100
Scaled Norm after poisoning: 97.999013467611, distance: 107.03869043481427
Total norm for 4 adversaries is: 97.999013467611. distance: 107.03869043481427
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 236, local model 53, internal_epoch   1,  Average loss: 0.0181, Accuracy: 425/625 (68.0000%)
___Train Local_ResNet_18,  epoch 236, local model 53, internal_epoch   2,  Average loss: 0.0075, Accuracy: 529/625 (84.6400%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 2.8275, Accuracy: 3867/10000 (38.6700%)
___Train Local_ResNet_18,  epoch 236, local model 14, internal_epoch   1,  Average loss: 0.0189, Accuracy: 215/318 (67.6101%)
___Train Local_ResNet_18,  epoch 236, local model 14, internal_epoch   2,  Average loss: 0.0052, Accuracy: 287/318 (90.2516%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 9.6816, Accuracy: 2272/10000 (22.7200%)
___Train Local_ResNet_18,  epoch 236, local model 6, internal_epoch   1,  Average loss: 0.0160, Accuracy: 368/520 (70.7692%)
___Train Local_ResNet_18,  epoch 236, local model 6, internal_epoch   2,  Average loss: 0.0065, Accuracy: 459/520 (88.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 4.3970, Accuracy: 3297/10000 (32.9700%)
___Train Local_ResNet_18,  epoch 236, local model 12, internal_epoch   1,  Average loss: 0.0113, Accuracy: 770/977 (78.8127%)
___Train Local_ResNet_18,  epoch 236, local model 12, internal_epoch   2,  Average loss: 0.0091, Accuracy: 803/977 (82.1904%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 5.7252, Accuracy: 2940/10000 (29.4000%)
___Train Local_ResNet_18,  epoch 236, local model 7, internal_epoch   1,  Average loss: 0.0178, Accuracy: 241/352 (68.4659%)
___Train Local_ResNet_18,  epoch 236, local model 7, internal_epoch   2,  Average loss: 0.0060, Accuracy: 313/352 (88.9205%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 8.5413, Accuracy: 2194/10000 (21.9400%)
___Train Local_ResNet_18,  epoch 236, local model 58, internal_epoch   1,  Average loss: 0.0264, Accuracy: 138/234 (58.9744%)
___Train Local_ResNet_18,  epoch 236, local model 58, internal_epoch   2,  Average loss: 0.0042, Accuracy: 213/234 (91.0256%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 11.2889, Accuracy: 1911/10000 (19.1100%)
time spent on training: 348.45569229125977
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4090997851982035  data num: [526, 527, 496, 546, 625, 318, 520, 977, 352, 234]
[rfa agg] considering poison per batch poison_fraction: 0.03196092071860965
[rfa agg] init. name: [17, 33, 77, 11, 53, 14, 6, 12, 7, 58], weight: tensor([0.1027, 0.1029, 0.0969, 0.1066, 0.1220, 0.0621, 0.1015, 0.1908, 0.0687,
        0.0457])
[rfa agg] iter:  0, prev_obj_val: 11320.068359375, obj_val: 10954.8984375, abs dis: 365.169921875
[rfa agg] iter:  0, weight: tensor([0.0773, 0.0775, 0.0895, 0.0803, 0.1395, 0.0706, 0.1159, 0.2192, 0.0783,
        0.0519])
[rfa agg] iter:  1, prev_obj_val: 10954.8984375, obj_val: 10633.6689453125, abs dis: 321.2294921875
[rfa agg] iter:  1, weight: tensor([0.0597, 0.0598, 0.0672, 0.0620, 0.1551, 0.0785, 0.1289, 0.2442, 0.0870,
        0.0577])
[rfa agg] iter:  2, prev_obj_val: 10633.6689453125, obj_val: 10366.1240234375, abs dis: 267.544921875
[rfa agg] iter:  2, weight: tensor([0.0448, 0.0448, 0.0495, 0.0465, 0.1681, 0.0849, 0.1397, 0.2653, 0.0941,
        0.0624])
[rfa agg] iter:  3, prev_obj_val: 10366.1240234375, obj_val: 10153.0693359375, abs dis: 213.0546875
[rfa agg] iter:  3, weight: tensor([0.0328, 0.0328, 0.0358, 0.0340, 0.1784, 0.0899, 0.1482, 0.2825, 0.0997,
        0.0660])
[rfa agg] iter:  4, prev_obj_val: 10153.0693359375, obj_val: 9990.4384765625, abs dis: 162.630859375
[rfa agg] iter:  4, weight: tensor([0.0235, 0.0236, 0.0255, 0.0244, 0.1863, 0.0935, 0.1546, 0.2963, 0.1038,
        0.0686])
[rfa agg] iter:  5, prev_obj_val: 9990.4384765625, obj_val: 9868.46875, abs dis: 121.9697265625
[rfa agg] iter:  5, weight: tensor([0.0166, 0.0167, 0.0179, 0.0173, 0.1921, 0.0958, 0.1592, 0.3077, 0.1065,
        0.0702])
[rfa agg] iter:  6, prev_obj_val: 9868.46875, obj_val: 9779.84375, abs dis: 88.625
[rfa agg] iter:  6, weight: tensor([0.0116, 0.0116, 0.0124, 0.0120, 0.1963, 0.0971, 0.1624, 0.3176, 0.1081,
        0.0711])
[rfa agg] iter:  7, prev_obj_val: 9779.84375, obj_val: 9715.615234375, abs dis: 64.228515625
[rfa agg] iter:  7, weight: tensor([0.0079, 0.0079, 0.0085, 0.0082, 0.1990, 0.0973, 0.1643, 0.3273, 0.1085,
        0.0710])
[rfa agg] iter:  8, prev_obj_val: 9715.615234375, obj_val: 9670.912109375, abs dis: 44.703125
[rfa agg] iter:  8, weight: tensor([0.0053, 0.0053, 0.0057, 0.0055, 0.2007, 0.0963, 0.1650, 0.3385, 0.1078,
        0.0700])
[rfa agg] iter:  9, prev_obj_val: 9670.912109375, obj_val: 9639.2353515625, abs dis: 31.6767578125
[rfa agg] iter:  9, weight: tensor([0.0035, 0.0035, 0.0037, 0.0036, 0.2011, 0.0937, 0.1643, 0.3532, 0.1055,
        0.0678])
___Test Target_ResNet_18 poisoned: False, epoch: 236: Average loss: 0.9171, Accuracy: 7042/10000 (70.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.1219, Accuracy: 8718/9000 (96.8667%)
Done in 458.419221162796 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:237 choose agents : [17, 33, 77, 11, 65, 0, 98, 20, 45, 82]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   1,  Average loss: 0.0006, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   2,  Average loss: 0.0012, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   3,  Average loss: 0.0009, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   4,  Average loss: 0.0010, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   5,  Average loss: 0.0010, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   6,  Average loss: 0.0007, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Global model norm: 40.94647891751118.
Norm before scaling: 40.58845110719612. Distance: 2.388058649981858
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.3564, Accuracy: 6118/10000 (61.1800%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.0980, Accuracy: 8750/9000 (97.2222%)
Scaling by  100
Scaled Norm after poisoning: 234.9796284388287, distance: 238.8058753333971
Total norm for 4 adversaries is: 234.9796284388287. distance: 238.8058753333971
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   1,  Average loss: 0.0003, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   2,  Average loss: 0.0001, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   3,  Average loss: 0.0001, Accuracy: 527/527 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   4,  Average loss: 0.0002, Accuracy: 526/527 (99.8102%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   5,  Average loss: 0.0004, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   6,  Average loss: 0.0006, Accuracy: 525/527 (99.6205%), train_poison_data_count: 45
Global model norm: 40.94647891751118.
Norm before scaling: 40.548911617926784. Distance: 1.3536533214111972
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.1259, Accuracy: 6504/10000 (65.0400%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.1785, Accuracy: 8588/9000 (95.4222%)
Scaling by  100
Scaled Norm after poisoning: 128.75225271087493, distance: 135.36532600476016
Total norm for 4 adversaries is: 128.75225271087493. distance: 135.36532600476016
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   1,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   3,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   4,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 40.94647891751118.
Norm before scaling: 40.58695484167681. Distance: 0.8305041128903035
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.0002, Accuracy: 6937/10000 (69.3700%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.1060, Accuracy: 8752/9000 (97.2444%)
Scaling by  100
Scaled Norm after poisoning: 74.65712313742239, distance: 83.05040708622384
Total norm for 4 adversaries is: 74.65712313742239. distance: 83.05040708622384
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   1,  Average loss: 0.0004, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   2,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   3,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   4,  Average loss: 0.0002, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   5,  Average loss: 0.0001, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   6,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Global model norm: 40.94647891751118.
Norm before scaling: 40.53205864893014. Distance: 1.019986865669657
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.1070, Accuracy: 6705/10000 (67.0500%)
