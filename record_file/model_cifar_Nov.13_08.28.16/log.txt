current path: saved_models/model_cifar_Nov.13_08.28.16
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 201
create model done
Poisoned following participants: [17, 33, 77, 11]
We use following environment for graphs:  cifar
----------------------------------Start one training epoch------------------------------------------
Server Epoch:201 choose agents : [17, 33, 77, 11, 37, 53, 39, 57, 63, 48]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   1,  Average loss: 0.0086, Accuracy: 464/526 (88.2129%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   2,  Average loss: 0.0059, Accuracy: 485/526 (92.2053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   3,  Average loss: 0.0026, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   4,  Average loss: 0.0014, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   5,  Average loss: 0.0018, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   6,  Average loss: 0.0016, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 38.42148103702049. Distance: 8.941883212759212
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.9535, Accuracy: 4776/10000 (47.7600%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.2170, Accuracy: 8581/9000 (95.3444%)
Scaling by  100
Scaled Norm after poisoning: 893.7371327745088, distance: 894.1882491958838
Total norm for 4 adversaries is: 893.7371327745088. distance: 894.1882491958838
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   1,  Average loss: 0.0085, Accuracy: 459/527 (87.0968%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   2,  Average loss: 0.0068, Accuracy: 483/527 (91.6509%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   3,  Average loss: 0.0034, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   4,  Average loss: 0.0020, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   5,  Average loss: 0.0021, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   6,  Average loss: 0.0017, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 38.365910848491204. Distance: 8.654267562647831
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.1066, Accuracy: 4836/10000 (48.3600%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.2913, Accuracy: 8557/9000 (95.0778%)
Scaling by  100
Scaled Norm after poisoning: 865.006394485035, distance: 865.4266650040314
Total norm for 4 adversaries is: 865.006394485035. distance: 865.4266650040314
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   1,  Average loss: 0.0084, Accuracy: 436/496 (87.9032%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   2,  Average loss: 0.0046, Accuracy: 474/496 (95.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   3,  Average loss: 0.0025, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   4,  Average loss: 0.0015, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.66304237236004.
Norm before scaling: 37.910048178941786. Distance: 6.471285852779099
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.0603, Accuracy: 6591/10000 (65.9100%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.1774, Accuracy: 8623/9000 (95.8111%)
Scaling by  100
Scaled Norm after poisoning: 646.4308257656035, distance: 647.1286097059842
Total norm for 4 adversaries is: 646.4308257656035. distance: 647.1286097059842
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 488/546 (89.3773%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   2,  Average loss: 0.0047, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   3,  Average loss: 0.0024, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   4,  Average loss: 0.0011, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 37.886494620238686. Distance: 6.547037564173526
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.3720, Accuracy: 6025/10000 (60.2500%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.1116, Accuracy: 8729/9000 (96.9889%)
Scaling by  100
Scaled Norm after poisoning: 653.8022206676878, distance: 654.7037975298448
Total norm for 4 adversaries is: 653.8022206676878. distance: 654.7037975298448
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   1,  Average loss: 0.0112, Accuracy: 583/725 (80.4138%)
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   2,  Average loss: 0.0180, Accuracy: 499/725 (68.8276%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 49.8416, Accuracy: 1036/10000 (10.3600%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   1,  Average loss: 0.0049, Accuracy: 558/625 (89.2800%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   2,  Average loss: 0.0041, Accuracy: 570/625 (91.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.6599, Accuracy: 4282/10000 (42.8200%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   1,  Average loss: 0.0074, Accuracy: 186/217 (85.7143%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   2,  Average loss: 0.0012, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.1626, Accuracy: 3154/10000 (31.5400%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   1,  Average loss: 0.0074, Accuracy: 245/290 (84.4828%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   2,  Average loss: 0.0019, Accuracy: 280/290 (96.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.7582, Accuracy: 2985/10000 (29.8500%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 705/752 (93.7500%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   2,  Average loss: 0.0028, Accuracy: 709/752 (94.2819%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.6837, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   1,  Average loss: 0.0059, Accuracy: 332/378 (87.8307%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   2,  Average loss: 0.0019, Accuracy: 363/378 (96.0317%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 3.7294, Accuracy: 3245/10000 (32.4500%)
time spent on training: 339.3092312812805
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4122392758756395  data num: [526, 527, 496, 546, 725, 625, 217, 290, 752, 378]
[foolsgold agg] considering poison per batch poison_fraction: 0.03220619342778434
[foolsgold agg] wv: [1.         0.57670221 0.         0.83780498 1.         0.15159285
 1.         0.         0.82916716 0.15159285]
___Test Target_ResNet_18 poisoned: False, epoch: 201: Average loss: 0.7344, Accuracy: 7599/10000 (75.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 201: Average loss: 6.5372, Accuracy: 219/9000 (2.4333%)
Done in 416.38234400749207 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:202 choose agents : [17, 33, 77, 11, 63, 50, 39, 72, 88, 71]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   1,  Average loss: 0.0091, Accuracy: 467/526 (88.7833%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   2,  Average loss: 0.0078, Accuracy: 462/526 (87.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   3,  Average loss: 0.0046, Accuracy: 492/526 (93.5361%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   4,  Average loss: 0.0018, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   5,  Average loss: 0.0010, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   6,  Average loss: 0.0007, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Global model norm: 37.6624897579226.
Norm before scaling: 38.66973163252171. Distance: 9.850369023415363
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.7693, Accuracy: 5052/10000 (50.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.1446, Accuracy: 8697/9000 (96.6333%)
Scaling by  100
Scaled Norm after poisoning: 984.7343867764546, distance: 985.0368965170798
Total norm for 4 adversaries is: 984.7343867764546. distance: 985.0368965170798
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   1,  Average loss: 0.0085, Accuracy: 462/527 (87.6660%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 491/527 (93.1689%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   3,  Average loss: 0.0016, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   4,  Average loss: 0.0013, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   5,  Average loss: 0.0019, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   6,  Average loss: 0.0022, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Global model norm: 37.6624897579226.
Norm before scaling: 38.13215705106633. Distance: 7.760516506978007
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.0838, Accuracy: 4552/10000 (45.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.4152, Accuracy: 8195/9000 (91.0556%)
Scaling by  100
Scaled Norm after poisoning: 775.3784962842341, distance: 776.0516654836841
Total norm for 4 adversaries is: 775.3784962842341. distance: 776.0516654836841
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   1,  Average loss: 0.0081, Accuracy: 435/496 (87.7016%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 457/496 (92.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   3,  Average loss: 0.0027, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   4,  Average loss: 0.0009, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   5,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.6624897579226.
Norm before scaling: 37.920926994227905. Distance: 6.494241070651769
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.0773, Accuracy: 6446/10000 (64.4600%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.1342, Accuracy: 8704/9000 (96.7111%)
Scaling by  100
Scaled Norm after poisoning: 648.7726633806329, distance: 649.4239755352431
Total norm for 4 adversaries is: 648.7726633806329. distance: 649.4239755352431
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   1,  Average loss: 0.0077, Accuracy: 487/546 (89.1941%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 499/546 (91.3919%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   3,  Average loss: 0.0024, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   4,  Average loss: 0.0014, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   5,  Average loss: 0.0011, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.6624897579226.
Norm before scaling: 37.92117164314761. Distance: 6.805591685227315
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.2824, Accuracy: 6229/10000 (62.2900%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.1356, Accuracy: 8655/9000 (96.1667%)
Scaling by  100
Scaled Norm after poisoning: 679.6343456227032, distance: 680.5592139924344
Total norm for 4 adversaries is: 679.6343456227032. distance: 680.5592139924344
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 202, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 695/752 (92.4202%)
___Train Local_ResNet_18,  epoch 202, local model 63, internal_epoch   2,  Average loss: 0.0034, Accuracy: 694/752 (92.2872%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.0457, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   1,  Average loss: 0.0027, Accuracy: 383/401 (95.5112%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   2,  Average loss: 0.0017, Accuracy: 392/401 (97.7556%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.5734, Accuracy: 4549/10000 (45.4900%)
___Train Local_ResNet_18,  epoch 202, local model 39, internal_epoch   1,  Average loss: 0.0066, Accuracy: 188/217 (86.6359%)
___Train Local_ResNet_18,  epoch 202, local model 39, internal_epoch   2,  Average loss: 0.0016, Accuracy: 214/217 (98.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 3.6365, Accuracy: 3525/10000 (35.2500%)
___Train Local_ResNet_18,  epoch 202, local model 72, internal_epoch   1,  Average loss: 0.0107, Accuracy: 498/618 (80.5825%)
___Train Local_ResNet_18,  epoch 202, local model 72, internal_epoch   2,  Average loss: 0.0077, Accuracy: 540/618 (87.3786%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 7.2901, Accuracy: 3016/10000 (30.1600%)
___Train Local_ResNet_18,  epoch 202, local model 88, internal_epoch   1,  Average loss: 0.0080, Accuracy: 378/447 (84.5638%)
___Train Local_ResNet_18,  epoch 202, local model 88, internal_epoch   2,  Average loss: 0.0040, Accuracy: 410/447 (91.7226%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 5.6461, Accuracy: 2334/10000 (23.3400%)
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 1042/1166 (89.3654%)
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   2,  Average loss: 0.0154, Accuracy: 820/1166 (70.3259%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 11.4517, Accuracy: 2148/10000 (21.4800%)
time spent on training: 351.9617202281952
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.36780196629213485  data num: [526, 527, 496, 546, 752, 401, 217, 618, 447, 1166]
[foolsgold agg] considering poison per batch poison_fraction: 0.028734528616573034
[foolsgold agg] wv: [1.         0.44932205 0.44932205 0.8824243  1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 202: Average loss: 0.7300, Accuracy: 7614/10000 (76.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 202: Average loss: 6.4556, Accuracy: 240/9000 (2.6667%)
Done in 418.7252285480499 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:203 choose agents : [17, 33, 77, 11, 92, 23, 26, 50, 14, 76]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   1,  Average loss: 0.0061, Accuracy: 476/526 (90.4943%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   2,  Average loss: 0.0064, Accuracy: 487/526 (92.5856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   3,  Average loss: 0.0028, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   4,  Average loss: 0.0035, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   5,  Average loss: 0.0021, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   6,  Average loss: 0.0011, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Global model norm: 37.66286897222183.
Norm before scaling: 38.159940124080876. Distance: 7.902270857455459
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.7612, Accuracy: 4980/10000 (49.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.1782, Accuracy: 8601/9000 (95.5667%)
Scaling by  100
Scaled Norm after poisoning: 789.5579063627949, distance: 790.2271034329309
Total norm for 4 adversaries is: 789.5579063627949. distance: 790.2271034329309
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   1,  Average loss: 0.0088, Accuracy: 457/527 (86.7173%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   2,  Average loss: 0.0060, Accuracy: 484/527 (91.8406%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   3,  Average loss: 0.0023, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   4,  Average loss: 0.0014, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   5,  Average loss: 0.0010, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   6,  Average loss: 0.0008, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Global model norm: 37.66286897222183.
Norm before scaling: 38.196238515313915. Distance: 7.946321886549663
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.7022, Accuracy: 5244/10000 (52.4400%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.3044, Accuracy: 8432/9000 (93.6889%)
Scaling by  100
Scaled Norm after poisoning: 794.097168172762, distance: 794.6322262531265
Total norm for 4 adversaries is: 794.097168172762. distance: 794.6322262531265
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   1,  Average loss: 0.0078, Accuracy: 433/496 (87.2984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   2,  Average loss: 0.0064, Accuracy: 455/496 (91.7339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   3,  Average loss: 0.0026, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   4,  Average loss: 0.0012, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.66286897222183.
Norm before scaling: 37.91472815843633. Distance: 6.494728298127945
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.0427, Accuracy: 6571/10000 (65.7100%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.2120, Accuracy: 8564/9000 (95.1556%)
Scaling by  100
Scaled Norm after poisoning: 648.7825136361183, distance: 649.4728872324079
Total norm for 4 adversaries is: 648.7825136361183. distance: 649.4728872324079
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   1,  Average loss: 0.0079, Accuracy: 490/546 (89.7436%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   3,  Average loss: 0.0022, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   4,  Average loss: 0.0008, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   5,  Average loss: 0.0021, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   6,  Average loss: 0.0020, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Global model norm: 37.66286897222183.
Norm before scaling: 37.83749012791001. Distance: 6.470629138103272
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.4031, Accuracy: 5597/10000 (55.9700%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.0650, Accuracy: 8794/9000 (97.7111%)
Scaling by  100
Scaled Norm after poisoning: 645.9414156872123, distance: 647.0628833428788
Total norm for 4 adversaries is: 645.9414156872123. distance: 647.0628833428788
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 203, local model 92, internal_epoch   1,  Average loss: 0.0066, Accuracy: 700/796 (87.9397%)
___Train Local_ResNet_18,  epoch 203, local model 92, internal_epoch   2,  Average loss: 0.0068, Accuracy: 700/796 (87.9397%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 3.5374, Accuracy: 3477/10000 (34.7700%)
___Train Local_ResNet_18,  epoch 203, local model 23, internal_epoch   1,  Average loss: 0.0051, Accuracy: 220/248 (88.7097%)
___Train Local_ResNet_18,  epoch 203, local model 23, internal_epoch   2,  Average loss: 0.0008, Accuracy: 247/248 (99.5968%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 3.3731, Accuracy: 3658/10000 (36.5800%)
___Train Local_ResNet_18,  epoch 203, local model 26, internal_epoch   1,  Average loss: 0.0053, Accuracy: 423/468 (90.3846%)
___Train Local_ResNet_18,  epoch 203, local model 26, internal_epoch   2,  Average loss: 0.0063, Accuracy: 412/468 (88.0342%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 3.4420, Accuracy: 4085/10000 (40.8500%)
___Train Local_ResNet_18,  epoch 203, local model 50, internal_epoch   1,  Average loss: 0.0029, Accuracy: 384/401 (95.7606%)
___Train Local_ResNet_18,  epoch 203, local model 50, internal_epoch   2,  Average loss: 0.0016, Accuracy: 392/401 (97.7556%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.6640, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 203, local model 14, internal_epoch   1,  Average loss: 0.0076, Accuracy: 266/318 (83.6478%)
___Train Local_ResNet_18,  epoch 203, local model 14, internal_epoch   2,  Average loss: 0.0025, Accuracy: 300/318 (94.3396%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 11.6087, Accuracy: 1769/10000 (17.6900%)
___Train Local_ResNet_18,  epoch 203, local model 76, internal_epoch   1,  Average loss: 0.0350, Accuracy: 57/65 (87.6923%)
___Train Local_ResNet_18,  epoch 203, local model 76, internal_epoch   2,  Average loss: 0.0403, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.1948, Accuracy: 6479/10000 (64.7900%)
time spent on training: 339.04494404792786
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.47711227510817583  data num: [526, 527, 496, 546, 796, 248, 468, 401, 318, 65]
[foolsgold agg] considering poison per batch poison_fraction: 0.03727439649282624
[foolsgold agg] wv: [0.63081797 0.00415419 0.00415419 0.49527533 1.         1.
 0.         1.         0.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 203: Average loss: 0.7282, Accuracy: 7619/10000 (76.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 203: Average loss: 6.4152, Accuracy: 251/9000 (2.7889%)
Done in 429.82503485679626 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:204 choose agents : [17, 33, 77, 11, 49, 86, 26, 58, 6, 94]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   1,  Average loss: 0.0070, Accuracy: 479/526 (91.0646%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 485/526 (92.2053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   3,  Average loss: 0.0042, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   4,  Average loss: 0.0028, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   5,  Average loss: 0.0021, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   6,  Average loss: 0.0029, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 37.66172321479478.
Norm before scaling: 38.52172714084952. Distance: 9.286321314159052
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.9171, Accuracy: 4778/10000 (47.7800%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.3450, Accuracy: 8270/9000 (91.8889%)
Scaling by  100
Scaled Norm after poisoning: 928.2802984551595, distance: 928.6321257634802
Total norm for 4 adversaries is: 928.2802984551595. distance: 928.6321257634802
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   1,  Average loss: 0.0095, Accuracy: 462/527 (87.6660%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   2,  Average loss: 0.0054, Accuracy: 485/527 (92.0304%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   3,  Average loss: 0.0022, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   4,  Average loss: 0.0014, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   5,  Average loss: 0.0016, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   6,  Average loss: 0.0022, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Global model norm: 37.66172321479478.
Norm before scaling: 38.31146288614626. Distance: 8.436384565303516
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.8648, Accuracy: 5246/10000 (52.4600%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.3792, Accuracy: 8287/9000 (92.0778%)
Scaling by  100
Scaled Norm after poisoning: 843.1863672996617, distance: 843.6385481946637
Total norm for 4 adversaries is: 843.1863672996617. distance: 843.6385481946637
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   1,  Average loss: 0.0077, Accuracy: 437/496 (88.1048%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 462/496 (93.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   3,  Average loss: 0.0024, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   4,  Average loss: 0.0009, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.66172321479478.
Norm before scaling: 37.86239928077558. Distance: 6.2212292507102305
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.1093, Accuracy: 6415/10000 (64.1500%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.1614, Accuracy: 8628/9000 (95.8667%)
Scaling by  100
Scaled Norm after poisoning: 621.3698576532338, distance: 622.122877733973
Total norm for 4 adversaries is: 621.3698576532338. distance: 622.122877733973
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 489/546 (89.5604%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   2,  Average loss: 0.0047, Accuracy: 515/546 (94.3223%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   3,  Average loss: 0.0033, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   4,  Average loss: 0.0011, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.66172321479478.
Norm before scaling: 37.9008088762834. Distance: 6.672422721589658
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.2614, Accuracy: 6129/10000 (61.2900%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.1259, Accuracy: 8677/9000 (96.4111%)
Scaling by  100
Scaled Norm after poisoning: 666.3221349317461, distance: 667.2423425937536
Total norm for 4 adversaries is: 666.3221349317461. distance: 667.2423425937536
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 204, local model 49, internal_epoch   1,  Average loss: 0.0034, Accuracy: 402/426 (94.3662%)
___Train Local_ResNet_18,  epoch 204, local model 49, internal_epoch   2,  Average loss: 0.0016, Accuracy: 412/426 (96.7136%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.8854, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 204, local model 86, internal_epoch   1,  Average loss: 0.0045, Accuracy: 191/212 (90.0943%)
___Train Local_ResNet_18,  epoch 204, local model 86, internal_epoch   2,  Average loss: 0.0012, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.7063, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 204, local model 26, internal_epoch   1,  Average loss: 0.0051, Accuracy: 422/468 (90.1709%)
___Train Local_ResNet_18,  epoch 204, local model 26, internal_epoch   2,  Average loss: 0.0083, Accuracy: 416/468 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 4.3194, Accuracy: 3486/10000 (34.8600%)
___Train Local_ResNet_18,  epoch 204, local model 58, internal_epoch   1,  Average loss: 0.0099, Accuracy: 187/234 (79.9145%)
___Train Local_ResNet_18,  epoch 204, local model 58, internal_epoch   2,  Average loss: 0.0031, Accuracy: 226/234 (96.5812%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 8.3806, Accuracy: 1572/10000 (15.7200%)
___Train Local_ResNet_18,  epoch 204, local model 6, internal_epoch   1,  Average loss: 0.0056, Accuracy: 461/520 (88.6538%)
___Train Local_ResNet_18,  epoch 204, local model 6, internal_epoch   2,  Average loss: 0.0063, Accuracy: 457/520 (87.8846%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 4.9059, Accuracy: 2866/10000 (28.6600%)
___Train Local_ResNet_18,  epoch 204, local model 94, internal_epoch   1,  Average loss: 0.0098, Accuracy: 161/203 (79.3103%)
___Train Local_ResNet_18,  epoch 204, local model 94, internal_epoch   2,  Average loss: 0.0039, Accuracy: 195/203 (96.0591%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 6.9976, Accuracy: 1669/10000 (16.6900%)
time spent on training: 332.48098731040955
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.5038480038480039  data num: [526, 527, 496, 546, 426, 212, 468, 234, 520, 203]
[foolsgold agg] considering poison per batch poison_fraction: 0.0393631253006253
[foolsgold agg] wv: [0.51315658 0.14612864 0.1335323  0.56267338 1.         1.
 0.1335323  0.23474435 0.23474435 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 204: Average loss: 0.7260, Accuracy: 7627/10000 (76.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 204: Average loss: 6.3639, Accuracy: 262/9000 (2.9111%)
Done in 423.6238639354706 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:205 choose agents : [17, 33, 77, 11, 61, 71, 8, 69, 89, 64]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   1,  Average loss: 0.0080, Accuracy: 473/526 (89.9240%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   2,  Average loss: 0.0078, Accuracy: 490/526 (93.1559%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   3,  Average loss: 0.0040, Accuracy: 508/526 (96.5779%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   4,  Average loss: 0.0020, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   5,  Average loss: 0.0018, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   6,  Average loss: 0.0012, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Global model norm: 37.66048504452728.
Norm before scaling: 38.09802772843858. Distance: 7.7256221681183375
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.6752, Accuracy: 5231/10000 (52.3100%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.0588, Accuracy: 8805/9000 (97.8333%)
Scaling by  100
Scaled Norm after poisoning: 771.7623095876087, distance: 772.562214323222
Total norm for 4 adversaries is: 771.7623095876087. distance: 772.562214323222
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   1,  Average loss: 0.0071, Accuracy: 472/527 (89.5636%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   2,  Average loss: 0.0063, Accuracy: 482/527 (91.4611%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   3,  Average loss: 0.0036, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   4,  Average loss: 0.0021, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   5,  Average loss: 0.0014, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   6,  Average loss: 0.0023, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Global model norm: 37.66048504452728.
Norm before scaling: 38.24346508974197. Distance: 8.21934919022424
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.7837, Accuracy: 5165/10000 (51.6500%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.1365, Accuracy: 8742/9000 (97.1333%)
Scaling by  100
Scaled Norm after poisoning: 821.3797081739967, distance: 821.9349502849967
Total norm for 4 adversaries is: 821.3797081739967. distance: 821.9349502849967
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   1,  Average loss: 0.0084, Accuracy: 440/496 (88.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 462/496 (93.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   3,  Average loss: 0.0025, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   4,  Average loss: 0.0010, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.66048504452728.
Norm before scaling: 37.83989677689327. Distance: 6.090378987964625
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.0465, Accuracy: 6652/10000 (66.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.1405, Accuracy: 8673/9000 (96.3667%)
Scaling by  100
Scaled Norm after poisoning: 608.2687009044605, distance: 609.0379195912188
Total norm for 4 adversaries is: 608.2687009044605. distance: 609.0379195912188
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   1,  Average loss: 0.0084, Accuracy: 490/546 (89.7436%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 508/546 (93.0403%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   3,  Average loss: 0.0023, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   4,  Average loss: 0.0012, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.66048504452728.
Norm before scaling: 37.848457528738045. Distance: 6.462181405159066
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.3980, Accuracy: 5898/10000 (58.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.0782, Accuracy: 8802/9000 (97.8000%)
Scaling by  100
Scaled Norm after poisoning: 645.1817331186617, distance: 646.2181084974329
Total norm for 4 adversaries is: 645.1817331186617. distance: 646.2181084974329
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 205, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 541/590 (91.6949%)
___Train Local_ResNet_18,  epoch 205, local model 61, internal_epoch   2,  Average loss: 0.0045, Accuracy: 538/590 (91.1864%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 4.7447, Accuracy: 2901/10000 (29.0100%)
___Train Local_ResNet_18,  epoch 205, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 1029/1166 (88.2504%)
___Train Local_ResNet_18,  epoch 205, local model 71, internal_epoch   2,  Average loss: 0.0097, Accuracy: 945/1166 (81.0463%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 4.6350, Accuracy: 3253/10000 (32.5300%)
___Train Local_ResNet_18,  epoch 205, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 485/534 (90.8240%)
___Train Local_ResNet_18,  epoch 205, local model 8, internal_epoch   2,  Average loss: 0.0079, Accuracy: 470/534 (88.0150%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 3.1459, Accuracy: 4198/10000 (41.9800%)
___Train Local_ResNet_18,  epoch 205, local model 69, internal_epoch   1,  Average loss: 0.0073, Accuracy: 185/216 (85.6481%)
___Train Local_ResNet_18,  epoch 205, local model 69, internal_epoch   2,  Average loss: 0.0016, Accuracy: 213/216 (98.6111%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 9.4527, Accuracy: 1094/10000 (10.9400%)
___Train Local_ResNet_18,  epoch 205, local model 89, internal_epoch   1,  Average loss: 0.0073, Accuracy: 352/413 (85.2300%)
___Train Local_ResNet_18,  epoch 205, local model 89, internal_epoch   2,  Average loss: 0.0043, Accuracy: 387/413 (93.7046%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 5.0124, Accuracy: 2870/10000 (28.7000%)
___Train Local_ResNet_18,  epoch 205, local model 64, internal_epoch   1,  Average loss: 0.0053, Accuracy: 610/686 (88.9213%)
___Train Local_ResNet_18,  epoch 205, local model 64, internal_epoch   2,  Average loss: 0.0050, Accuracy: 623/686 (90.8163%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.9751, Accuracy: 4068/10000 (40.6800%)
time spent on training: 334.59217143058777
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3675438596491228  data num: [526, 527, 496, 546, 590, 1166, 534, 216, 413, 686]
[foolsgold agg] considering poison per batch poison_fraction: 0.028714364035087717
[foolsgold agg] wv: [1.         0.4381164  0.4381164  0.72323386 1.         0.67678778
 1.         1.         1.         0.67678778]
___Test Target_ResNet_18 poisoned: False, epoch: 205: Average loss: 0.7202, Accuracy: 7646/10000 (76.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 205: Average loss: 6.2558, Accuracy: 280/9000 (3.1111%)
Done in 400.553519487381 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:206 choose agents : [17, 33, 77, 11, 38, 64, 29, 23, 83, 43]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   1,  Average loss: 0.0079, Accuracy: 477/526 (90.6844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   2,  Average loss: 0.0057, Accuracy: 480/526 (91.2548%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   3,  Average loss: 0.0030, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   4,  Average loss: 0.0025, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   5,  Average loss: 0.0037, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   6,  Average loss: 0.0032, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Global model norm: 37.66045425181599.
Norm before scaling: 38.47697572747646. Distance: 9.116212559001596
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 1.8119, Accuracy: 5036/10000 (50.3600%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.1294, Accuracy: 8723/9000 (96.9222%)
Scaling by  100
Scaled Norm after poisoning: 911.2506515772704, distance: 911.6212549628272
Total norm for 4 adversaries is: 911.2506515772704. distance: 911.6212549628272
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   1,  Average loss: 0.0120, Accuracy: 459/527 (87.0968%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   2,  Average loss: 0.0069, Accuracy: 471/527 (89.3738%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   3,  Average loss: 0.0029, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   4,  Average loss: 0.0012, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   5,  Average loss: 0.0019, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   6,  Average loss: 0.0012, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Global model norm: 37.66045425181599.
Norm before scaling: 38.37550895427968. Distance: 8.877178515771714
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 1.8283, Accuracy: 5175/10000 (51.7500%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.1890, Accuracy: 8536/9000 (94.8444%)
Scaling by  100
Scaled Norm after poisoning: 887.1403144373498, distance: 887.7179661919657
Total norm for 4 adversaries is: 887.1403144373498. distance: 887.7179661919657
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 443/496 (89.3145%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   2,  Average loss: 0.0041, Accuracy: 465/496 (93.7500%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   3,  Average loss: 0.0023, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   4,  Average loss: 0.0016, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.66045425181599.
Norm before scaling: 37.826656699095814. Distance: 5.838364674735153
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 0.9500, Accuracy: 6904/10000 (69.0400%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.2006, Accuracy: 8628/9000 (95.8667%)
Scaling by  100
Scaled Norm after poisoning: 583.2060902888446, distance: 583.8364764640867
Total norm for 4 adversaries is: 583.2060902888446. distance: 583.8364764640867
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 492/546 (90.1099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   2,  Average loss: 0.0043, Accuracy: 517/546 (94.6886%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   3,  Average loss: 0.0026, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   4,  Average loss: 0.0009, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   6,  Average loss: 0.0011, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.66045425181599.
Norm before scaling: 37.8131488838952. Distance: 6.225816861526021
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 1.2928, Accuracy: 6251/10000 (62.5100%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.2435, Accuracy: 8471/9000 (94.1222%)
Scaling by  100
Scaled Norm after poisoning: 621.5324559103893, distance: 622.5816964463379
Total norm for 4 adversaries is: 621.5324559103893. distance: 622.5816964463379
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 206, local model 38, internal_epoch   1,  Average loss: 0.0042, Accuracy: 692/756 (91.5344%)
___Train Local_ResNet_18,  epoch 206, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 687/756 (90.8730%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 4.4460, Accuracy: 3098/10000 (30.9800%)
___Train Local_ResNet_18,  epoch 206, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 614/686 (89.5044%)
___Train Local_ResNet_18,  epoch 206, local model 64, internal_epoch   2,  Average loss: 0.0040, Accuracy: 628/686 (91.5452%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 4.1752, Accuracy: 3911/10000 (39.1100%)
___Train Local_ResNet_18,  epoch 206, local model 29, internal_epoch   1,  Average loss: 0.0075, Accuracy: 732/848 (86.3208%)
___Train Local_ResNet_18,  epoch 206, local model 29, internal_epoch   2,  Average loss: 0.0050, Accuracy: 766/848 (90.3302%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 8.9150, Accuracy: 2083/10000 (20.8300%)
___Train Local_ResNet_18,  epoch 206, local model 23, internal_epoch   1,  Average loss: 0.0048, Accuracy: 219/248 (88.3065%)
___Train Local_ResNet_18,  epoch 206, local model 23, internal_epoch   2,  Average loss: 0.0008, Accuracy: 245/248 (98.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.6580, Accuracy: 4102/10000 (41.0200%)
___Train Local_ResNet_18,  epoch 206, local model 83, internal_epoch   1,  Average loss: 0.0029, Accuracy: 342/366 (93.4426%)
___Train Local_ResNet_18,  epoch 206, local model 83, internal_epoch   2,  Average loss: 0.0006, Accuracy: 365/366 (99.7268%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.4415, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18,  epoch 206, local model 43, internal_epoch   1,  Average loss: 0.0070, Accuracy: 300/345 (86.9565%)
___Train Local_ResNet_18,  epoch 206, local model 43, internal_epoch   2,  Average loss: 0.0034, Accuracy: 325/345 (94.2029%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 6.8954, Accuracy: 2619/10000 (26.1900%)
time spent on training: 313.89119696617126
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.39202844311377244  data num: [526, 527, 496, 546, 756, 686, 848, 248, 366, 345]
[foolsgold agg] considering poison per batch poison_fraction: 0.03062722211826347
[foolsgold agg] wv: [0.7206591  0.12249347 0.12249347 0.20746386 1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 206: Average loss: 0.7157, Accuracy: 7655/10000 (76.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 206: Average loss: 6.2026, Accuracy: 299/9000 (3.3222%)
Done in 379.587194442749 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:207 choose agents : [17, 33, 77, 11, 56, 45, 1, 50, 16, 12]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   1,  Average loss: 0.0071, Accuracy: 473/526 (89.9240%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   3,  Average loss: 0.0032, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   4,  Average loss: 0.0025, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   5,  Average loss: 0.0017, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   6,  Average loss: 0.0013, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 37.66017711628143.
Norm before scaling: 38.02527299992401. Distance: 7.274999202977297
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 1.5525, Accuracy: 5543/10000 (55.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.1939, Accuracy: 8558/9000 (95.0889%)
Scaling by  100
Scaled Norm after poisoning: 726.7360249774329, distance: 727.4999570446722
Total norm for 4 adversaries is: 726.7360249774329. distance: 727.4999570446722
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   1,  Average loss: 0.0093, Accuracy: 462/527 (87.6660%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   2,  Average loss: 0.0067, Accuracy: 466/527 (88.4250%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   3,  Average loss: 0.0043, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   4,  Average loss: 0.0023, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   5,  Average loss: 0.0017, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   6,  Average loss: 0.0026, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Global model norm: 37.66017711628143.
Norm before scaling: 38.33940576195317. Distance: 8.588661046506454
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 1.9905, Accuracy: 4964/10000 (49.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.0649, Accuracy: 8830/9000 (98.1111%)
Scaling by  100
Scaled Norm after poisoning: 858.4025133933382, distance: 858.8660765800452
Total norm for 4 adversaries is: 858.4025133933382. distance: 858.8660765800452
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   1,  Average loss: 0.0070, Accuracy: 444/496 (89.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   3,  Average loss: 0.0024, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   4,  Average loss: 0.0012, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   5,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.66017711628143.
Norm before scaling: 37.829494824950245. Distance: 5.917746037991662
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 1.0341, Accuracy: 6587/10000 (65.8700%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.1448, Accuracy: 8681/9000 (96.4556%)
Scaling by  100
Scaled Norm after poisoning: 591.0936632632768, distance: 591.774661505543
Total norm for 4 adversaries is: 591.0936632632768. distance: 591.774661505543
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 488/546 (89.3773%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   2,  Average loss: 0.0051, Accuracy: 509/546 (93.2234%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   3,  Average loss: 0.0024, Accuracy: 527/546 (96.5201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   4,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.66017711628143.
Norm before scaling: 37.9023532106682. Distance: 6.701235346992467
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 1.3760, Accuracy: 5928/10000 (59.2800%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.1530, Accuracy: 8653/9000 (96.1444%)
Scaling by  100
Scaled Norm after poisoning: 669.1958560466435, distance: 670.1235427143266
Total norm for 4 adversaries is: 669.1958560466435. distance: 670.1235427143266
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 207, local model 56, internal_epoch   1,  Average loss: 0.0029, Accuracy: 708/743 (95.2894%)
___Train Local_ResNet_18,  epoch 207, local model 56, internal_epoch   2,  Average loss: 0.0034, Accuracy: 695/743 (93.5397%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 1.7601, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 207, local model 45, internal_epoch   1,  Average loss: 0.0080, Accuracy: 463/529 (87.5236%)
___Train Local_ResNet_18,  epoch 207, local model 45, internal_epoch   2,  Average loss: 0.0133, Accuracy: 424/529 (80.1512%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 20.8913, Accuracy: 1348/10000 (13.4800%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 587/641 (91.5757%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   2,  Average loss: 0.0085, Accuracy: 596/641 (92.9797%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 4.0797, Accuracy: 2908/10000 (29.0800%)
___Train Local_ResNet_18,  epoch 207, local model 50, internal_epoch   1,  Average loss: 0.0029, Accuracy: 377/401 (94.0150%)
___Train Local_ResNet_18,  epoch 207, local model 50, internal_epoch   2,  Average loss: 0.0021, Accuracy: 389/401 (97.0075%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.9827, Accuracy: 4085/10000 (40.8500%)
___Train Local_ResNet_18,  epoch 207, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 704/773 (91.0737%)
___Train Local_ResNet_18,  epoch 207, local model 16, internal_epoch   2,  Average loss: 0.0233, Accuracy: 471/773 (60.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 120.1361, Accuracy: 1004/10000 (10.0400%)
___Train Local_ResNet_18,  epoch 207, local model 12, internal_epoch   1,  Average loss: 0.0059, Accuracy: 872/977 (89.2528%)
___Train Local_ResNet_18,  epoch 207, local model 12, internal_epoch   2,  Average loss: 0.0087, Accuracy: 808/977 (82.7021%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 12.4175, Accuracy: 2858/10000 (28.5800%)
time spent on training: 386.5167760848999
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.34015262217892517  data num: [526, 527, 496, 546, 743, 529, 641, 401, 773, 977]
[foolsgold agg] considering poison per batch poison_fraction: 0.026574423607728527
[foolsgold agg] wv: [0.56479167 0.         0.         0.2186872  0.16914376 1.
 1.         0.16914376 1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 207: Average loss: 0.7124, Accuracy: 7664/10000 (76.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 207: Average loss: 6.1948, Accuracy: 310/9000 (3.4444%)
Done in 454.8724994659424 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:208 choose agents : [17, 33, 77, 11, 44, 86, 20, 50, 49, 43]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   1,  Average loss: 0.0078, Accuracy: 486/526 (92.3954%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 489/526 (92.9658%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   3,  Average loss: 0.0036, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   4,  Average loss: 0.0034, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   5,  Average loss: 0.0030, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   6,  Average loss: 0.0022, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 37.65996156501126.
Norm before scaling: 38.236870001858975. Distance: 8.29684235589741
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.5534, Accuracy: 5292/10000 (52.9200%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.0849, Accuracy: 8765/9000 (97.3889%)
Scaling by  100
Scaled Norm after poisoning: 829.0289500373314, distance: 829.6841643059123
Total norm for 4 adversaries is: 829.0289500373314. distance: 829.6841643059123
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   1,  Average loss: 0.0095, Accuracy: 461/527 (87.4763%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   2,  Average loss: 0.0060, Accuracy: 476/527 (90.3226%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   3,  Average loss: 0.0024, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   4,  Average loss: 0.0013, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   5,  Average loss: 0.0006, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   6,  Average loss: 0.0005, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Global model norm: 37.65996156501126.
Norm before scaling: 38.297359493059375. Distance: 8.432794912085605
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.6356, Accuracy: 5328/10000 (53.2800%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.1531, Accuracy: 8720/9000 (96.8889%)
Scaling by  100
Scaled Norm after poisoning: 842.7744360147619, distance: 843.2794613886905
Total norm for 4 adversaries is: 842.7744360147619. distance: 843.2794613886905
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 450/496 (90.7258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 460/496 (92.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   3,  Average loss: 0.0022, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   4,  Average loss: 0.0010, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.65996156501126.
Norm before scaling: 37.80699372357002. Distance: 5.83770047156021
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 0.9871, Accuracy: 6797/10000 (67.9700%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.1737, Accuracy: 8658/9000 (96.2000%)
Scaling by  100
Scaled Norm after poisoning: 583.0157855924657, distance: 583.7699943042636
Total norm for 4 adversaries is: 583.0157855924657. distance: 583.7699943042636
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   1,  Average loss: 0.0056, Accuracy: 500/546 (91.5751%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   2,  Average loss: 0.0040, Accuracy: 511/546 (93.5897%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   3,  Average loss: 0.0021, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   4,  Average loss: 0.0007, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.65996156501126.
Norm before scaling: 37.871012965682276. Distance: 6.31725834446579
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.3328, Accuracy: 6106/10000 (61.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.1633, Accuracy: 8698/9000 (96.6444%)
Scaling by  100
Scaled Norm after poisoning: 630.9511173617177, distance: 631.7259591785033
Total norm for 4 adversaries is: 630.9511173617177. distance: 631.7259591785033
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 208, local model 44, internal_epoch   1,  Average loss: 0.0043, Accuracy: 393/436 (90.1376%)
___Train Local_ResNet_18,  epoch 208, local model 44, internal_epoch   2,  Average loss: 0.0026, Accuracy: 414/436 (94.9541%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.3568, Accuracy: 4876/10000 (48.7600%)
___Train Local_ResNet_18,  epoch 208, local model 86, internal_epoch   1,  Average loss: 0.0043, Accuracy: 190/212 (89.6226%)
___Train Local_ResNet_18,  epoch 208, local model 86, internal_epoch   2,  Average loss: 0.0012, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.4662, Accuracy: 6124/10000 (61.2400%)
___Train Local_ResNet_18,  epoch 208, local model 20, internal_epoch   1,  Average loss: 0.0078, Accuracy: 299/362 (82.5967%)
___Train Local_ResNet_18,  epoch 208, local model 20, internal_epoch   2,  Average loss: 0.0029, Accuracy: 342/362 (94.4751%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 7.8204, Accuracy: 2698/10000 (26.9800%)
___Train Local_ResNet_18,  epoch 208, local model 50, internal_epoch   1,  Average loss: 0.0031, Accuracy: 380/401 (94.7631%)
___Train Local_ResNet_18,  epoch 208, local model 50, internal_epoch   2,  Average loss: 0.0022, Accuracy: 389/401 (97.0075%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.9656, Accuracy: 4017/10000 (40.1700%)
___Train Local_ResNet_18,  epoch 208, local model 49, internal_epoch   1,  Average loss: 0.0030, Accuracy: 398/426 (93.4272%)
___Train Local_ResNet_18,  epoch 208, local model 49, internal_epoch   2,  Average loss: 0.0016, Accuracy: 412/426 (96.7136%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.9012, Accuracy: 4245/10000 (42.4500%)
___Train Local_ResNet_18,  epoch 208, local model 43, internal_epoch   1,  Average loss: 0.0073, Accuracy: 304/345 (88.1159%)
___Train Local_ResNet_18,  epoch 208, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 329/345 (95.3623%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 7.3135, Accuracy: 2666/10000 (26.6600%)
time spent on training: 316.84019708633423
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4898293196165537  data num: [526, 527, 496, 546, 436, 212, 362, 401, 426, 345]
[foolsgold agg] considering poison per batch poison_fraction: 0.03826791559504326
[foolsgold agg] wv: [0.49162369 0.00837604 0.00837604 0.2546693  1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 208: Average loss: 0.7117, Accuracy: 7659/10000 (76.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 208: Average loss: 6.1749, Accuracy: 315/9000 (3.5000%)
Done in 388.11180424690247 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:209 choose agents : [17, 33, 77, 11, 28, 51, 4, 97, 85, 59]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   1,  Average loss: 0.0083, Accuracy: 475/526 (90.3042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 478/526 (90.8745%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   3,  Average loss: 0.0044, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   4,  Average loss: 0.0020, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   5,  Average loss: 0.0012, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   6,  Average loss: 0.0012, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Global model norm: 37.6588918938393.
Norm before scaling: 38.400359978578. Distance: 8.870671895930652
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.6443, Accuracy: 5302/10000 (53.0200%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.2605, Accuracy: 8553/9000 (95.0333%)
Scaling by  100
Scaled Norm after poisoning: 886.6098000247911, distance: 887.0671831941479
Total norm for 4 adversaries is: 886.6098000247911. distance: 887.0671831941479
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   1,  Average loss: 0.0073, Accuracy: 473/527 (89.7533%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 495/527 (93.9279%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   3,  Average loss: 0.0019, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   4,  Average loss: 0.0024, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   5,  Average loss: 0.0012, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   6,  Average loss: 0.0020, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Global model norm: 37.6588918938393.
Norm before scaling: 38.061744720031065. Distance: 7.482911032447951
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.5505, Accuracy: 5563/10000 (55.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.1627, Accuracy: 8636/9000 (95.9556%)
Scaling by  100
Scaled Norm after poisoning: 747.5351162320069, distance: 748.2910112382749
Total norm for 4 adversaries is: 747.5351162320069. distance: 748.2910112382749
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   1,  Average loss: 0.0077, Accuracy: 447/496 (90.1210%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   2,  Average loss: 0.0061, Accuracy: 462/496 (93.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   3,  Average loss: 0.0026, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   4,  Average loss: 0.0010, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   5,  Average loss: 0.0006, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.6588918938393.
Norm before scaling: 37.86025361392786. Distance: 6.181158958821456
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 0.9811, Accuracy: 6844/10000 (68.4400%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.1467, Accuracy: 8669/9000 (96.3222%)
Scaling by  100
Scaled Norm after poisoning: 617.4022949017925, distance: 618.1158871926849
Total norm for 4 adversaries is: 617.4022949017925. distance: 618.1158871926849
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   1,  Average loss: 0.0067, Accuracy: 504/546 (92.3077%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   2,  Average loss: 0.0051, Accuracy: 515/546 (94.3223%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   3,  Average loss: 0.0025, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   4,  Average loss: 0.0008, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.6588918938393.
Norm before scaling: 37.77919827452172. Distance: 6.036073327369285
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.2939, Accuracy: 6231/10000 (62.3100%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.2111, Accuracy: 8551/9000 (95.0111%)
Scaling by  100
Scaled Norm after poisoning: 602.5148338422881, distance: 603.607358926314
Total norm for 4 adversaries is: 602.5148338422881. distance: 603.607358926314
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 209, local model 28, internal_epoch   1,  Average loss: 0.0023, Accuracy: 411/423 (97.1631%)
___Train Local_ResNet_18,  epoch 209, local model 28, internal_epoch   2,  Average loss: 0.0014, Accuracy: 412/423 (97.3995%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.6200, Accuracy: 5952/10000 (59.5200%)
___Train Local_ResNet_18,  epoch 209, local model 51, internal_epoch   1,  Average loss: 0.0045, Accuracy: 436/479 (91.0230%)
___Train Local_ResNet_18,  epoch 209, local model 51, internal_epoch   2,  Average loss: 0.0025, Accuracy: 459/479 (95.8246%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 3.6006, Accuracy: 3523/10000 (35.2300%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   1,  Average loss: 0.0061, Accuracy: 491/557 (88.1508%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 512/557 (91.9210%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 3.1020, Accuracy: 4343/10000 (43.4300%)
___Train Local_ResNet_18,  epoch 209, local model 97, internal_epoch   1,  Average loss: 0.0030, Accuracy: 395/418 (94.4976%)
___Train Local_ResNet_18,  epoch 209, local model 97, internal_epoch   2,  Average loss: 0.0015, Accuracy: 409/418 (97.8469%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 2.1036, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 209, local model 85, internal_epoch   1,  Average loss: 0.0078, Accuracy: 307/364 (84.3407%)
___Train Local_ResNet_18,  epoch 209, local model 85, internal_epoch   2,  Average loss: 0.0037, Accuracy: 340/364 (93.4066%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 6.4594, Accuracy: 2102/10000 (21.0200%)
___Train Local_ResNet_18,  epoch 209, local model 59, internal_epoch   1,  Average loss: 0.0105, Accuracy: 587/642 (91.4330%)
___Train Local_ResNet_18,  epoch 209, local model 59, internal_epoch   2,  Average loss: 0.0170, Accuracy: 481/642 (74.9221%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 37.2013, Accuracy: 1249/10000 (12.4900%)
time spent on training: 332.66782236099243
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4208517476898353  data num: [526, 527, 496, 546, 423, 479, 557, 418, 364, 642]
[foolsgold agg] considering poison per batch poison_fraction: 0.032879042788268385
[foolsgold agg] wv: [0.48811417 0.         0.         0.38103081 0.1731717  1.
 1.         1.         0.1731717  1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 209: Average loss: 0.7102, Accuracy: 7664/10000 (76.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 209: Average loss: 6.1506, Accuracy: 327/9000 (3.6333%)
Done in 418.38966703414917 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:210 choose agents : [17, 33, 77, 11, 51, 13, 57, 76, 80, 85]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 483/526 (91.8251%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 489/526 (92.9658%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   3,  Average loss: 0.0030, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   4,  Average loss: 0.0022, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   5,  Average loss: 0.0015, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   6,  Average loss: 0.0027, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Global model norm: 37.65795833780524.
Norm before scaling: 38.10293130486731. Distance: 7.513649028429003
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.6141, Accuracy: 5328/10000 (53.2800%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.1746, Accuracy: 8604/9000 (95.6000%)
Scaling by  100
Scaled Norm after poisoning: 750.7950369441716, distance: 751.364924653793
Total norm for 4 adversaries is: 750.7950369441716. distance: 751.364924653793
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   1,  Average loss: 0.0089, Accuracy: 471/527 (89.3738%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 493/527 (93.5484%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   3,  Average loss: 0.0042, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   4,  Average loss: 0.0020, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   5,  Average loss: 0.0028, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   6,  Average loss: 0.0022, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Global model norm: 37.65795833780524.
Norm before scaling: 38.51249353395759. Distance: 9.278087141268752
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 2.3554, Accuracy: 4466/10000 (44.6600%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.1785, Accuracy: 8641/9000 (96.0111%)
Scaling by  100
Scaled Norm after poisoning: 927.4414738947142, distance: 927.8087087325706
Total norm for 4 adversaries is: 927.4414738947142. distance: 927.8087087325706
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   1,  Average loss: 0.0079, Accuracy: 438/496 (88.3065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 453/496 (91.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   3,  Average loss: 0.0027, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   4,  Average loss: 0.0009, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.65795833780524.
Norm before scaling: 37.934005450667215. Distance: 6.4826472542923375
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.0447, Accuracy: 6653/10000 (66.5300%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.1962, Accuracy: 8612/9000 (95.6889%)
Scaling by  100
Scaled Norm after poisoning: 647.7264324157229, distance: 648.264678777118
Total norm for 4 adversaries is: 647.7264324157229. distance: 648.264678777118
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   1,  Average loss: 0.0063, Accuracy: 497/546 (91.0256%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   2,  Average loss: 0.0049, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   3,  Average loss: 0.0019, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   4,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.65795833780524.
Norm before scaling: 37.84990240812633. Distance: 6.414061905260326
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.2838, Accuracy: 6116/10000 (61.1600%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.2021, Accuracy: 8581/9000 (95.3444%)
Scaling by  100
Scaled Norm after poisoning: 640.4337885371133, distance: 641.4062918696698
Total norm for 4 adversaries is: 640.4337885371133. distance: 641.4062918696698
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 210, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 438/479 (91.4405%)
___Train Local_ResNet_18,  epoch 210, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 458/479 (95.6159%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 6.0759, Accuracy: 2907/10000 (29.0700%)
___Train Local_ResNet_18,  epoch 210, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 574/620 (92.5806%)
___Train Local_ResNet_18,  epoch 210, local model 13, internal_epoch   2,  Average loss: 0.0030, Accuracy: 578/620 (93.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 2.7589, Accuracy: 4602/10000 (46.0200%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   1,  Average loss: 0.0067, Accuracy: 246/290 (84.8276%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   2,  Average loss: 0.0017, Accuracy: 281/290 (96.8966%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 4.0794, Accuracy: 3942/10000 (39.4200%)
___Train Local_ResNet_18,  epoch 210, local model 76, internal_epoch   1,  Average loss: 0.0374, Accuracy: 59/65 (90.7692%)
___Train Local_ResNet_18,  epoch 210, local model 76, internal_epoch   2,  Average loss: 0.0426, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 2.3844, Accuracy: 4237/10000 (42.3700%)
___Train Local_ResNet_18,  epoch 210, local model 80, internal_epoch   1,  Average loss: 0.0066, Accuracy: 311/363 (85.6749%)
___Train Local_ResNet_18,  epoch 210, local model 80, internal_epoch   2,  Average loss: 0.0015, Accuracy: 352/363 (96.9697%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 4.9501, Accuracy: 3253/10000 (32.5300%)
___Train Local_ResNet_18,  epoch 210, local model 85, internal_epoch   1,  Average loss: 0.0078, Accuracy: 309/364 (84.8901%)
___Train Local_ResNet_18,  epoch 210, local model 85, internal_epoch   2,  Average loss: 0.0037, Accuracy: 341/364 (93.6813%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 3.8307, Accuracy: 3064/10000 (30.6400%)
time spent on training: 334.6760165691376
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4899438727782975  data num: [526, 527, 496, 546, 479, 620, 290, 65, 363, 364]
[foolsgold agg] considering poison per batch poison_fraction: 0.038276865060804494
[foolsgold agg] wv: [0.89883465 0.26036543 0.         0.47929643 1.         0.
 0.         0.76221936 0.         0.71166268]
___Test Target_ResNet_18 poisoned: False, epoch: 210: Average loss: 0.7083, Accuracy: 7676/10000 (76.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 210: Average loss: 6.0722, Accuracy: 351/9000 (3.9000%)
Done in 429.1726133823395 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:211 choose agents : [17, 33, 77, 11, 90, 24, 63, 1, 52, 31]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   1,  Average loss: 0.0069, Accuracy: 485/526 (92.2053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   2,  Average loss: 0.0059, Accuracy: 491/526 (93.3460%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   3,  Average loss: 0.0031, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   4,  Average loss: 0.0011, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   5,  Average loss: 0.0006, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   6,  Average loss: 0.0008, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Global model norm: 37.65672004374684.
Norm before scaling: 38.23995380989381. Distance: 8.17014856135728
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.6239, Accuracy: 5398/10000 (53.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.2197, Accuracy: 8606/9000 (95.6222%)
Scaling by  100
Scaled Norm after poisoning: 816.5064681311471, distance: 817.0147642484804
Total norm for 4 adversaries is: 816.5064681311471. distance: 817.0147642484804
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   1,  Average loss: 0.0091, Accuracy: 469/527 (88.9943%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   3,  Average loss: 0.0028, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   4,  Average loss: 0.0023, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   5,  Average loss: 0.0015, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   6,  Average loss: 0.0010, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Global model norm: 37.65672004374684.
Norm before scaling: 38.106008333250415. Distance: 7.699713208691201
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.0656, Accuracy: 4898/10000 (48.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.2453, Accuracy: 8545/9000 (94.9444%)
Scaling by  100
Scaled Norm after poisoning: 769.2523968113456, distance: 769.9712656976233
Total norm for 4 adversaries is: 769.2523968113456. distance: 769.9712656976233
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   1,  Average loss: 0.0076, Accuracy: 438/496 (88.3065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 470/496 (94.7581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   3,  Average loss: 0.0025, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   4,  Average loss: 0.0015, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   5,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.65672004374684.
Norm before scaling: 37.8579998073599. Distance: 6.19231035147736
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.0787, Accuracy: 6522/10000 (65.2200%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.1306, Accuracy: 8674/9000 (96.3778%)
Scaling by  100
Scaled Norm after poisoning: 618.5067198503182, distance: 619.2310251432821
Total norm for 4 adversaries is: 618.5067198503182. distance: 619.2310251432821
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   1,  Average loss: 0.0062, Accuracy: 500/546 (91.5751%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   2,  Average loss: 0.0043, Accuracy: 518/546 (94.8718%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   3,  Average loss: 0.0017, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   4,  Average loss: 0.0015, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.65672004374684.
Norm before scaling: 37.79418784370984. Distance: 6.069847138191032
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.2295, Accuracy: 6337/10000 (63.3700%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.0922, Accuracy: 8774/9000 (97.4889%)
Scaling by  100
Scaled Norm after poisoning: 605.9713792746321, distance: 606.9846837029745
Total norm for 4 adversaries is: 605.9713792746321. distance: 606.9846837029745
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 211, local model 90, internal_epoch   1,  Average loss: 0.0148, Accuracy: 514/578 (88.9273%)
___Train Local_ResNet_18,  epoch 211, local model 90, internal_epoch   2,  Average loss: 0.0186, Accuracy: 387/578 (66.9550%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 323.7588, Accuracy: 1009/10000 (10.0900%)
___Train Local_ResNet_18,  epoch 211, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 292/320 (91.2500%)
___Train Local_ResNet_18,  epoch 211, local model 24, internal_epoch   2,  Average loss: 0.0007, Accuracy: 315/320 (98.4375%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.9953, Accuracy: 3920/10000 (39.2000%)
___Train Local_ResNet_18,  epoch 211, local model 63, internal_epoch   1,  Average loss: 0.0025, Accuracy: 711/752 (94.5479%)
___Train Local_ResNet_18,  epoch 211, local model 63, internal_epoch   2,  Average loss: 0.0024, Accuracy: 720/752 (95.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.3594, Accuracy: 6262/10000 (62.6200%)
___Train Local_ResNet_18,  epoch 211, local model 1, internal_epoch   1,  Average loss: 0.0091, Accuracy: 596/641 (92.9797%)
___Train Local_ResNet_18,  epoch 211, local model 1, internal_epoch   2,  Average loss: 0.0110, Accuracy: 564/641 (87.9875%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 4.6497, Accuracy: 3684/10000 (36.8400%)
___Train Local_ResNet_18,  epoch 211, local model 52, internal_epoch   1,  Average loss: 0.0078, Accuracy: 181/214 (84.5794%)
___Train Local_ResNet_18,  epoch 211, local model 52, internal_epoch   2,  Average loss: 0.0020, Accuracy: 210/214 (98.1308%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 3.8421, Accuracy: 3601/10000 (36.0100%)
___Train Local_ResNet_18,  epoch 211, local model 31, internal_epoch   1,  Average loss: 0.0041, Accuracy: 656/706 (92.9178%)
___Train Local_ResNet_18,  epoch 211, local model 31, internal_epoch   2,  Average loss: 0.0109, Accuracy: 571/706 (80.8782%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 4.9424, Accuracy: 3353/10000 (33.5300%)
time spent on training: 337.5084614753723
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3948360346777233  data num: [526, 527, 496, 546, 578, 320, 752, 641, 214, 706]
[foolsgold agg] considering poison per batch poison_fraction: 0.030846565209197135
[foolsgold agg] wv: [0.47310622 0.         0.         0.37716352 1.         0.
 0.         0.         0.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 211: Average loss: 0.7077, Accuracy: 7676/10000 (76.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 211: Average loss: 6.0511, Accuracy: 364/9000 (4.0444%)
Done in 406.86309027671814 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:212 choose agents : [17, 33, 77, 11, 59, 67, 71, 66, 76, 96]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 482/526 (91.6350%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 489/526 (92.9658%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   3,  Average loss: 0.0033, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   4,  Average loss: 0.0020, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   5,  Average loss: 0.0034, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   6,  Average loss: 0.0036, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Global model norm: 37.65551412662726.
Norm before scaling: 38.42949452965375. Distance: 9.01054612142072
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 2.0295, Accuracy: 4815/10000 (48.1500%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.3169, Accuracy: 8439/9000 (93.7667%)
Scaling by  100
Scaled Norm after poisoning: 900.6038599184438, distance: 901.0546598292469
Total norm for 4 adversaries is: 900.6038599184438. distance: 901.0546598292469
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   1,  Average loss: 0.0082, Accuracy: 468/527 (88.8046%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 494/527 (93.7381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   3,  Average loss: 0.0034, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   4,  Average loss: 0.0009, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   5,  Average loss: 0.0009, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   6,  Average loss: 0.0014, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Global model norm: 37.65551412662726.
Norm before scaling: 37.9971987043124. Distance: 7.197481075048659
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1.9855, Accuracy: 4976/10000 (49.7600%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.1293, Accuracy: 8690/9000 (96.5556%)
Scaling by  100
Scaled Norm after poisoning: 718.929738395902, distance: 719.7481113208981
Total norm for 4 adversaries is: 718.929738395902. distance: 719.7481113208981
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   1,  Average loss: 0.0088, Accuracy: 442/496 (89.1129%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 452/496 (91.1290%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   3,  Average loss: 0.0029, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   4,  Average loss: 0.0014, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   5,  Average loss: 0.0007, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.65551412662726.
Norm before scaling: 37.818899574671164. Distance: 6.033801552042758
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1.0002, Accuracy: 6669/10000 (66.6900%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.1474, Accuracy: 8669/9000 (96.3222%)
Scaling by  100
Scaled Norm after poisoning: 602.5596702817074, distance: 603.3802439175482
Total norm for 4 adversaries is: 602.5596702817074. distance: 603.3802439175482
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 497/546 (91.0256%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   2,  Average loss: 0.0048, Accuracy: 519/546 (95.0549%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   3,  Average loss: 0.0020, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   4,  Average loss: 0.0011, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   5,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   6,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Global model norm: 37.65551412662726.
Norm before scaling: 37.77920958355022. Distance: 6.06386967553678
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1.2456, Accuracy: 6267/10000 (62.6700%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.1860, Accuracy: 8588/9000 (95.4222%)
Scaling by  100
Scaled Norm after poisoning: 605.2926203498602, distance: 606.3869432961102
Total norm for 4 adversaries is: 605.2926203498602. distance: 606.3869432961102
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 212, local model 59, internal_epoch   1,  Average loss: 0.0093, Accuracy: 586/642 (91.2773%)
___Train Local_ResNet_18,  epoch 212, local model 59, internal_epoch   2,  Average loss: 0.0161, Accuracy: 473/642 (73.6760%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 6108.7813, Accuracy: 1322/10000 (13.2200%)
___Train Local_ResNet_18,  epoch 212, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 773/842 (91.8052%)
___Train Local_ResNet_18,  epoch 212, local model 67, internal_epoch   2,  Average loss: 0.0121, Accuracy: 670/842 (79.5724%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 6.2229, Accuracy: 2835/10000 (28.3500%)
___Train Local_ResNet_18,  epoch 212, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 1050/1166 (90.0515%)
___Train Local_ResNet_18,  epoch 212, local model 71, internal_epoch   2,  Average loss: 0.0120, Accuracy: 879/1166 (75.3859%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 54.4256, Accuracy: 1231/10000 (12.3100%)
___Train Local_ResNet_18,  epoch 212, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 509/555 (91.7117%)
___Train Local_ResNet_18,  epoch 212, local model 66, internal_epoch   2,  Average loss: 0.0016, Accuracy: 535/555 (96.3964%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 4.2026, Accuracy: 3510/10000 (35.1000%)
___Train Local_ResNet_18,  epoch 212, local model 76, internal_epoch   1,  Average loss: 0.0264, Accuracy: 60/65 (92.3077%)
___Train Local_ResNet_18,  epoch 212, local model 76, internal_epoch   2,  Average loss: 0.0567, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 0.8609, Accuracy: 7286/10000 (72.8600%)
___Train Local_ResNet_18,  epoch 212, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 627/708 (88.5593%)
___Train Local_ResNet_18,  epoch 212, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 625/708 (88.2768%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 5.4879, Accuracy: 2579/10000 (25.7900%)
time spent on training: 351.8577711582184
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3449695372962292  data num: [526, 527, 496, 546, 642, 842, 1166, 555, 65, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.026950745101267905
[foolsgold agg] wv: [0.50788765 0.         0.         0.27833795 0.17194297 0.76136732
 0.76136732 1.         0.17194297 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 212: Average loss: 0.7055, Accuracy: 7682/10000 (76.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 212: Average loss: 6.0385, Accuracy: 374/9000 (4.1556%)
Done in 421.94749665260315 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:213 choose agents : [17, 33, 77, 11, 80, 81, 22, 72, 64, 45]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   1,  Average loss: 0.0062, Accuracy: 485/526 (92.2053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 495/526 (94.1065%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   3,  Average loss: 0.0023, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   4,  Average loss: 0.0013, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   5,  Average loss: 0.0006, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   6,  Average loss: 0.0020, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Global model norm: 37.65540552735673.
Norm before scaling: 38.03088890286667. Distance: 7.209803995333233
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.3848, Accuracy: 5769/10000 (57.6900%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.1898, Accuracy: 8624/9000 (95.8222%)
Scaling by  100
Scaled Norm after poisoning: 720.3293734466199, distance: 720.9804088877867
Total norm for 4 adversaries is: 720.3293734466199. distance: 720.9804088877867
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   1,  Average loss: 0.0094, Accuracy: 461/527 (87.4763%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   2,  Average loss: 0.0063, Accuracy: 488/527 (92.5996%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   3,  Average loss: 0.0035, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   4,  Average loss: 0.0024, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   5,  Average loss: 0.0022, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   6,  Average loss: 0.0024, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Global model norm: 37.65540552735673.
Norm before scaling: 38.10612045348654. Distance: 7.861854359328031
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.8619, Accuracy: 4793/10000 (47.9300%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.1144, Accuracy: 8738/9000 (97.0889%)
Scaling by  100
Scaled Norm after poisoning: 785.3275192555014, distance: 786.185370952678
Total norm for 4 adversaries is: 785.3275192555014. distance: 786.185370952678
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   1,  Average loss: 0.0059, Accuracy: 443/496 (89.3145%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 465/496 (93.7500%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   3,  Average loss: 0.0026, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   4,  Average loss: 0.0010, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Global model norm: 37.65540552735673.
Norm before scaling: 37.82096044296238. Distance: 5.830535144880236
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 0.9742, Accuracy: 6839/10000 (68.3900%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.1528, Accuracy: 8682/9000 (96.4667%)
Scaling by  100
Scaled Norm after poisoning: 582.4253439283012, distance: 583.0534924001399
Total norm for 4 adversaries is: 582.4253439283012. distance: 583.0534924001399
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   1,  Average loss: 0.0063, Accuracy: 497/546 (91.0256%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 515/546 (94.3223%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   3,  Average loss: 0.0026, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   4,  Average loss: 0.0015, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.65540552735673.
Norm before scaling: 37.80671120461783. Distance: 6.179564656846349
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.4578, Accuracy: 5753/10000 (57.5300%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.1326, Accuracy: 8675/9000 (96.3889%)
Scaling by  100
Scaled Norm after poisoning: 616.9369396461846, distance: 617.9565366997908
Total norm for 4 adversaries is: 616.9369396461846. distance: 617.9565366997908
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 213, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 319/363 (87.8788%)
___Train Local_ResNet_18,  epoch 213, local model 80, internal_epoch   2,  Average loss: 0.0017, Accuracy: 355/363 (97.7961%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 3.2272, Accuracy: 4167/10000 (41.6700%)
___Train Local_ResNet_18,  epoch 213, local model 81, internal_epoch   1,  Average loss: 0.0071, Accuracy: 915/1034 (88.4913%)
___Train Local_ResNet_18,  epoch 213, local model 81, internal_epoch   2,  Average loss: 0.0174, Accuracy: 719/1034 (69.5358%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 59.9738, Accuracy: 1083/10000 (10.8300%)
___Train Local_ResNet_18,  epoch 213, local model 22, internal_epoch   1,  Average loss: 0.0075, Accuracy: 425/494 (86.0324%)
___Train Local_ResNet_18,  epoch 213, local model 22, internal_epoch   2,  Average loss: 0.0031, Accuracy: 466/494 (94.3320%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 3.2746, Accuracy: 3528/10000 (35.2800%)
___Train Local_ResNet_18,  epoch 213, local model 72, internal_epoch   1,  Average loss: 0.0091, Accuracy: 518/618 (83.8188%)
___Train Local_ResNet_18,  epoch 213, local model 72, internal_epoch   2,  Average loss: 0.0067, Accuracy: 542/618 (87.7023%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 5.2756, Accuracy: 3059/10000 (30.5900%)
___Train Local_ResNet_18,  epoch 213, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 618/686 (90.0875%)
___Train Local_ResNet_18,  epoch 213, local model 64, internal_epoch   2,  Average loss: 0.0050, Accuracy: 617/686 (89.9417%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 3.3733, Accuracy: 4378/10000 (43.7800%)
___Train Local_ResNet_18,  epoch 213, local model 45, internal_epoch   1,  Average loss: 0.0063, Accuracy: 463/529 (87.5236%)
___Train Local_ResNet_18,  epoch 213, local model 45, internal_epoch   2,  Average loss: 0.0087, Accuracy: 459/529 (86.7675%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 23.8762, Accuracy: 1129/10000 (11.2900%)
time spent on training: 325.67908787727356
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3600274961333563  data num: [526, 527, 496, 546, 363, 1034, 494, 618, 686, 529]
[foolsgold agg] considering poison per batch poison_fraction: 0.02812714813541846
[foolsgold agg] wv: [0.53482082 0.00134165 0.00134165 0.38969855 0.71933709 1.
 0.67135456 1.         0.94498895 0.67135456]
___Test Target_ResNet_18 poisoned: False, epoch: 213: Average loss: 0.7037, Accuracy: 7683/10000 (76.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 213: Average loss: 6.0126, Accuracy: 380/9000 (4.2222%)
Done in 420.7597336769104 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:214 choose agents : [17, 33, 77, 11, 80, 54, 44, 35, 68, 25]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 482/526 (91.6350%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 495/526 (94.1065%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   3,  Average loss: 0.0028, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   4,  Average loss: 0.0010, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   5,  Average loss: 0.0009, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   6,  Average loss: 0.0011, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Global model norm: 37.655065139554104.
Norm before scaling: 37.82381674661152. Distance: 6.257137343123682
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.5031, Accuracy: 5529/10000 (55.2900%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.1324, Accuracy: 8698/9000 (96.6444%)
Scaling by  100
Scaled Norm after poisoning: 624.7352939445634, distance: 625.7136925143959
Total norm for 4 adversaries is: 624.7352939445634. distance: 625.7136925143959
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   1,  Average loss: 0.0082, Accuracy: 472/527 (89.5636%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   2,  Average loss: 0.0062, Accuracy: 487/527 (92.4099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   3,  Average loss: 0.0029, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   4,  Average loss: 0.0016, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   5,  Average loss: 0.0011, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   6,  Average loss: 0.0009, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Global model norm: 37.655065139554104.
Norm before scaling: 38.31778549899348. Distance: 8.524929961423025
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.8654, Accuracy: 5090/10000 (50.9000%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.2062, Accuracy: 8638/9000 (95.9778%)
Scaling by  100
Scaled Norm after poisoning: 852.0150380128275, distance: 852.4929985049731
Total norm for 4 adversaries is: 852.0150380128275. distance: 852.4929985049731
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 443/496 (89.3145%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   2,  Average loss: 0.0040, Accuracy: 468/496 (94.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   3,  Average loss: 0.0017, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   4,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.655065139554104.
Norm before scaling: 37.8269810210128. Distance: 5.921705580731221
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.1179, Accuracy: 6459/10000 (64.5900%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.0745, Accuracy: 8823/9000 (98.0333%)
Scaling by  100
Scaled Norm after poisoning: 591.5022189307492, distance: 592.1705043735292
Total norm for 4 adversaries is: 591.5022189307492. distance: 592.1705043735292
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 503/546 (92.1245%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   2,  Average loss: 0.0037, Accuracy: 517/546 (94.6886%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   3,  Average loss: 0.0017, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   4,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.655065139554104.
Norm before scaling: 37.715021563860994. Distance: 5.65887929598031
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.2351, Accuracy: 6452/10000 (64.5200%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.0756, Accuracy: 8805/9000 (97.8333%)
Scaling by  100
Scaled Norm after poisoning: 564.7094662302023, distance: 565.887991346344
Total norm for 4 adversaries is: 564.7094662302023. distance: 565.887991346344
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 214, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 318/363 (87.6033%)
___Train Local_ResNet_18,  epoch 214, local model 80, internal_epoch   2,  Average loss: 0.0015, Accuracy: 355/363 (97.7961%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 3.9292, Accuracy: 3443/10000 (34.4300%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   1,  Average loss: 0.0036, Accuracy: 408/440 (92.7273%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   2,  Average loss: 0.0008, Accuracy: 433/440 (98.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 3.1594, Accuracy: 4506/10000 (45.0600%)
___Train Local_ResNet_18,  epoch 214, local model 44, internal_epoch   1,  Average loss: 0.0049, Accuracy: 393/436 (90.1376%)
___Train Local_ResNet_18,  epoch 214, local model 44, internal_epoch   2,  Average loss: 0.0023, Accuracy: 415/436 (95.1835%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 2.7608, Accuracy: 4167/10000 (41.6700%)
___Train Local_ResNet_18,  epoch 214, local model 35, internal_epoch   1,  Average loss: 0.0075, Accuracy: 365/419 (87.1122%)
___Train Local_ResNet_18,  epoch 214, local model 35, internal_epoch   2,  Average loss: 0.0037, Accuracy: 393/419 (93.7947%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 4.9402, Accuracy: 2886/10000 (28.8600%)
___Train Local_ResNet_18,  epoch 214, local model 68, internal_epoch   1,  Average loss: 0.0031, Accuracy: 396/416 (95.1923%)
___Train Local_ResNet_18,  epoch 214, local model 68, internal_epoch   2,  Average loss: 0.0010, Accuracy: 408/416 (98.0769%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.4801, Accuracy: 5929/10000 (59.2900%)
___Train Local_ResNet_18,  epoch 214, local model 25, internal_epoch   1,  Average loss: 0.0035, Accuracy: 508/545 (93.2110%)
___Train Local_ResNet_18,  epoch 214, local model 25, internal_epoch   2,  Average loss: 0.0029, Accuracy: 521/545 (95.5963%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 3.7187, Accuracy: 3786/10000 (37.8600%)
time spent on training: 318.7919270992279
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4444208739923632  data num: [526, 527, 496, 546, 363, 440, 436, 419, 416, 545]
[foolsgold agg] considering poison per batch poison_fraction: 0.03472038078065337
[foolsgold agg] wv: [0.64510896 0.08616969 0.08616969 0.50440481 0.79840365 1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 214: Average loss: 0.7011, Accuracy: 7693/10000 (76.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 214: Average loss: 5.9462, Accuracy: 411/9000 (4.5667%)
Done in 390.0403485298157 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:215 choose agents : [17, 33, 77, 11, 4, 79, 43, 63, 35, 49]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   1,  Average loss: 0.0062, Accuracy: 482/526 (91.6350%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 488/526 (92.7757%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   3,  Average loss: 0.0031, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   4,  Average loss: 0.0016, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   5,  Average loss: 0.0011, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   6,  Average loss: 0.0006, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Global model norm: 37.65403747390096.
Norm before scaling: 38.03633709301048. Distance: 7.255524996501185
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.5890, Accuracy: 5508/10000 (55.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.0967, Accuracy: 8769/9000 (97.4333%)
Scaling by  100
Scaled Norm after poisoning: 724.89559593089, distance: 725.55241885063
Total norm for 4 adversaries is: 724.89559593089. distance: 725.55241885063
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   1,  Average loss: 0.0099, Accuracy: 455/527 (86.3378%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   2,  Average loss: 0.0079, Accuracy: 470/527 (89.1841%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   3,  Average loss: 0.0042, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   4,  Average loss: 0.0026, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   5,  Average loss: 0.0027, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   6,  Average loss: 0.0024, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.65403747390096.
Norm before scaling: 38.607466881724285. Distance: 9.802308834345443
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.7639, Accuracy: 4802/10000 (48.0200%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.0790, Accuracy: 8827/9000 (98.0778%)
Scaling by  100
Scaled Norm after poisoning: 979.7617376178762, distance: 980.2309995608178
Total norm for 4 adversaries is: 979.7617376178762. distance: 980.2309995608178
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 439/496 (88.5081%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 458/496 (92.3387%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   3,  Average loss: 0.0022, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   4,  Average loss: 0.0010, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   5,  Average loss: 0.0007, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.65403747390096.
Norm before scaling: 37.807579741865254. Distance: 5.864924130156352
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.0039, Accuracy: 6743/10000 (67.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.1714, Accuracy: 8638/9000 (95.9778%)
Scaling by  100
Scaled Norm after poisoning: 585.7559752149353, distance: 586.4923805984183
Total norm for 4 adversaries is: 585.7559752149353. distance: 586.4923805984183
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   1,  Average loss: 0.0042, Accuracy: 511/546 (93.5897%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   2,  Average loss: 0.0038, Accuracy: 521/546 (95.4212%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   3,  Average loss: 0.0022, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   4,  Average loss: 0.0014, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   5,  Average loss: 0.0011, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.65403747390096.
Norm before scaling: 37.68172925605408. Distance: 5.320700565475029
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.2317, Accuracy: 6433/10000 (64.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.3364, Accuracy: 8409/9000 (93.4333%)
Scaling by  100
Scaled Norm after poisoning: 530.9369665977309, distance: 532.0700729227308
Total norm for 4 adversaries is: 530.9369665977309. distance: 532.0700729227308
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 215, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 502/557 (90.1257%)
___Train Local_ResNet_18,  epoch 215, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 513/557 (92.1005%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 6.4523, Accuracy: 2928/10000 (29.2800%)
___Train Local_ResNet_18,  epoch 215, local model 79, internal_epoch   1,  Average loss: 0.0093, Accuracy: 128/154 (83.1169%)
___Train Local_ResNet_18,  epoch 215, local model 79, internal_epoch   2,  Average loss: 0.0015, Accuracy: 153/154 (99.3506%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.7651, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 215, local model 43, internal_epoch   1,  Average loss: 0.0078, Accuracy: 292/345 (84.6377%)
___Train Local_ResNet_18,  epoch 215, local model 43, internal_epoch   2,  Average loss: 0.0025, Accuracy: 330/345 (95.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 5.7097, Accuracy: 2950/10000 (29.5000%)
___Train Local_ResNet_18,  epoch 215, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 710/752 (94.4149%)
___Train Local_ResNet_18,  epoch 215, local model 63, internal_epoch   2,  Average loss: 0.0018, Accuracy: 728/752 (96.8085%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.4648, Accuracy: 5963/10000 (59.6300%)
___Train Local_ResNet_18,  epoch 215, local model 35, internal_epoch   1,  Average loss: 0.0063, Accuracy: 371/419 (88.5442%)
___Train Local_ResNet_18,  epoch 215, local model 35, internal_epoch   2,  Average loss: 0.0024, Accuracy: 394/419 (94.0334%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 4.9533, Accuracy: 2609/10000 (26.0900%)
___Train Local_ResNet_18,  epoch 215, local model 49, internal_epoch   1,  Average loss: 0.0033, Accuracy: 399/426 (93.6620%)
___Train Local_ResNet_18,  epoch 215, local model 49, internal_epoch   2,  Average loss: 0.0020, Accuracy: 412/426 (96.7136%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 2.1530, Accuracy: 5115/10000 (51.1500%)
time spent on training: 312.39339303970337
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4412384161752317  data num: [526, 527, 496, 546, 557, 154, 345, 752, 419, 426]
[foolsgold agg] considering poison per batch poison_fraction: 0.034471751263689974
[foolsgold agg] wv: [1.         0.45249538 0.45249538 1.         1.         0.
 0.         0.14426161 0.93679716 0.93679716]
___Test Target_ResNet_18 poisoned: False, epoch: 215: Average loss: 0.6992, Accuracy: 7701/10000 (77.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 215: Average loss: 5.8207, Accuracy: 460/9000 (5.1111%)
Done in 403.5412631034851 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:216 choose agents : [17, 33, 77, 11, 8, 12, 18, 94, 57, 83]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   1,  Average loss: 0.0071, Accuracy: 484/526 (92.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   2,  Average loss: 0.0062, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   3,  Average loss: 0.0043, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   4,  Average loss: 0.0025, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   5,  Average loss: 0.0011, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   6,  Average loss: 0.0018, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Global model norm: 37.65329183142143.
Norm before scaling: 38.06631786322473. Distance: 7.553263675046396
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.4657, Accuracy: 5509/10000 (55.0900%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.1180, Accuracy: 8703/9000 (96.7000%)
Scaling by  100
Scaled Norm after poisoning: 754.5581074377241, distance: 755.3263367578281
Total norm for 4 adversaries is: 754.5581074377241. distance: 755.3263367578281
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   1,  Average loss: 0.0079, Accuracy: 463/527 (87.8558%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   2,  Average loss: 0.0071, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   3,  Average loss: 0.0029, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   4,  Average loss: 0.0017, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   5,  Average loss: 0.0020, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   6,  Average loss: 0.0034, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Global model norm: 37.65329183142143.
Norm before scaling: 38.22734246470793. Distance: 8.296333826954031
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.8355, Accuracy: 5103/10000 (51.0300%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.1216, Accuracy: 8753/9000 (97.2556%)
Scaling by  100
Scaled Norm after poisoning: 828.9646780774196, distance: 829.6335034218423
Total norm for 4 adversaries is: 828.9646780774196. distance: 829.6335034218423
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   1,  Average loss: 0.0082, Accuracy: 438/496 (88.3065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   2,  Average loss: 0.0040, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   3,  Average loss: 0.0023, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   4,  Average loss: 0.0010, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   5,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.65329183142143.
Norm before scaling: 37.83545435759048. Distance: 6.0631354873923575
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.0631, Accuracy: 6639/10000 (66.3900%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.1972, Accuracy: 8581/9000 (95.3444%)
Scaling by  100
Scaled Norm after poisoning: 605.5846864807597, distance: 606.3135533698714
Total norm for 4 adversaries is: 605.5846864807597. distance: 606.3135533698714
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 497/546 (91.0256%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   2,  Average loss: 0.0046, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   3,  Average loss: 0.0016, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   4,  Average loss: 0.0018, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.65329183142143.
Norm before scaling: 37.822892102431666. Distance: 6.219522552809991
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.2926, Accuracy: 5985/10000 (59.8500%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.1677, Accuracy: 8647/9000 (96.0778%)
Scaling by  100
Scaled Norm after poisoning: 621.010668185338, distance: 621.9522188239222
Total norm for 4 adversaries is: 621.010668185338. distance: 621.9522188239222
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 216, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 482/534 (90.2622%)
___Train Local_ResNet_18,  epoch 216, local model 8, internal_epoch   2,  Average loss: 0.0071, Accuracy: 474/534 (88.7640%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 2.8191, Accuracy: 3595/10000 (35.9500%)
___Train Local_ResNet_18,  epoch 216, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 857/977 (87.7175%)
___Train Local_ResNet_18,  epoch 216, local model 12, internal_epoch   2,  Average loss: 0.0086, Accuracy: 806/977 (82.4974%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 7.9591, Accuracy: 2201/10000 (22.0100%)
___Train Local_ResNet_18,  epoch 216, local model 18, internal_epoch   1,  Average loss: 0.0030, Accuracy: 366/386 (94.8187%)
___Train Local_ResNet_18,  epoch 216, local model 18, internal_epoch   2,  Average loss: 0.0011, Accuracy: 382/386 (98.9637%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.8143, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 216, local model 94, internal_epoch   1,  Average loss: 0.0076, Accuracy: 169/203 (83.2512%)
___Train Local_ResNet_18,  epoch 216, local model 94, internal_epoch   2,  Average loss: 0.0009, Accuracy: 200/203 (98.5222%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 3.6568, Accuracy: 3114/10000 (31.1400%)
___Train Local_ResNet_18,  epoch 216, local model 57, internal_epoch   1,  Average loss: 0.0061, Accuracy: 252/290 (86.8966%)
___Train Local_ResNet_18,  epoch 216, local model 57, internal_epoch   2,  Average loss: 0.0015, Accuracy: 283/290 (97.5862%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 4.2736, Accuracy: 3776/10000 (37.7600%)
___Train Local_ResNet_18,  epoch 216, local model 83, internal_epoch   1,  Average loss: 0.0029, Accuracy: 341/366 (93.1694%)
___Train Local_ResNet_18,  epoch 216, local model 83, internal_epoch   2,  Average loss: 0.0007, Accuracy: 364/366 (99.4536%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 2.4683, Accuracy: 4680/10000 (46.8000%)
time spent on training: 385.702609539032
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4318697175840033  data num: [526, 527, 496, 546, 534, 977, 386, 203, 290, 366]
[foolsgold agg] considering poison per batch poison_fraction: 0.033739821686250254
[foolsgold agg] wv: [0.92977951 0.1828087  0.         0.40436899 1.         0.
 1.         0.         0.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 216: Average loss: 0.6975, Accuracy: 7703/10000 (77.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 216: Average loss: 5.7519, Accuracy: 495/9000 (5.5000%)
Done in 475.50206780433655 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:217 choose agents : [17, 33, 77, 11, 37, 22, 38, 65, 29, 18]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 489/526 (92.9658%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   2,  Average loss: 0.0038, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   3,  Average loss: 0.0026, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   4,  Average loss: 0.0030, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   5,  Average loss: 0.0036, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   6,  Average loss: 0.0041, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Global model norm: 37.652132814340675.
Norm before scaling: 38.37671292237732. Distance: 8.525557746428987
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.7779, Accuracy: 5287/10000 (52.8700%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.5671, Accuracy: 8126/9000 (90.2889%)
Scaling by  100
Scaled Norm after poisoning: 852.3550096644003, distance: 852.5557533088379
Total norm for 4 adversaries is: 852.3550096644003. distance: 852.5557533088379
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   1,  Average loss: 0.0080, Accuracy: 465/527 (88.2353%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   2,  Average loss: 0.0072, Accuracy: 482/527 (91.4611%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   3,  Average loss: 0.0029, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   4,  Average loss: 0.0012, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   5,  Average loss: 0.0012, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   6,  Average loss: 0.0007, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Global model norm: 37.652132814340675.
Norm before scaling: 38.39964472288448. Distance: 8.826236056900411
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.7811, Accuracy: 5360/10000 (53.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.1612, Accuracy: 8692/9000 (96.5778%)
Scaling by  100
Scaled Norm after poisoning: 882.2340604964195, distance: 882.6235749174164
Total norm for 4 adversaries is: 882.2340604964195. distance: 882.6235749174164
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 442/496 (89.1129%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   3,  Average loss: 0.0019, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   4,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   6,  Average loss: 0.0010, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.652132814340675.
Norm before scaling: 37.80528243358079. Distance: 5.777751792131986
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 0.9827, Accuracy: 6885/10000 (68.8500%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.1862, Accuracy: 8653/9000 (96.1444%)
Scaling by  100
Scaled Norm after poisoning: 577.1128572471765, distance: 577.7752590757067
Total norm for 4 adversaries is: 577.1128572471765. distance: 577.7752590757067
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 496/546 (90.8425%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   2,  Average loss: 0.0051, Accuracy: 513/546 (93.9560%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   3,  Average loss: 0.0033, Accuracy: 527/546 (96.5201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   4,  Average loss: 0.0013, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.652132814340675.
Norm before scaling: 37.87694824042471. Distance: 6.583951639361663
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.2296, Accuracy: 6259/10000 (62.5900%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.0928, Accuracy: 8774/9000 (97.4889%)
Scaling by  100
Scaled Norm after poisoning: 657.4686066649874, distance: 658.3950894030119
Total norm for 4 adversaries is: 657.4686066649874. distance: 658.3950894030119
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 217, local model 37, internal_epoch   1,  Average loss: 0.0085, Accuracy: 623/725 (85.9310%)
___Train Local_ResNet_18,  epoch 217, local model 37, internal_epoch   2,  Average loss: 0.0131, Accuracy: 548/725 (75.5862%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 118.3968, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 217, local model 22, internal_epoch   1,  Average loss: 0.0060, Accuracy: 429/494 (86.8421%)
___Train Local_ResNet_18,  epoch 217, local model 22, internal_epoch   2,  Average loss: 0.0032, Accuracy: 450/494 (91.0931%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 3.3529, Accuracy: 3631/10000 (36.3100%)
___Train Local_ResNet_18,  epoch 217, local model 38, internal_epoch   1,  Average loss: 0.0025, Accuracy: 720/756 (95.2381%)
___Train Local_ResNet_18,  epoch 217, local model 38, internal_epoch   2,  Average loss: 0.0038, Accuracy: 704/756 (93.1217%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 2.8611, Accuracy: 4458/10000 (44.5800%)
___Train Local_ResNet_18,  epoch 217, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 291/314 (92.6752%)
___Train Local_ResNet_18,  epoch 217, local model 65, internal_epoch   2,  Average loss: 0.0006, Accuracy: 313/314 (99.6815%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 2.6378, Accuracy: 3952/10000 (39.5200%)
___Train Local_ResNet_18,  epoch 217, local model 29, internal_epoch   1,  Average loss: 0.0065, Accuracy: 767/848 (90.4481%)
___Train Local_ResNet_18,  epoch 217, local model 29, internal_epoch   2,  Average loss: 0.0067, Accuracy: 743/848 (87.6179%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 7.7656, Accuracy: 2104/10000 (21.0400%)
___Train Local_ResNet_18,  epoch 217, local model 18, internal_epoch   1,  Average loss: 0.0080, Accuracy: 357/386 (92.4870%)
___Train Local_ResNet_18,  epoch 217, local model 18, internal_epoch   2,  Average loss: 0.0214, Accuracy: 257/386 (66.5803%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 51.5783, Accuracy: 1567/10000 (15.6700%)
time spent on training: 306.14845275878906
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.37290850836596656  data num: [526, 527, 496, 546, 725, 494, 756, 314, 848, 386]
[foolsgold agg] considering poison per batch poison_fraction: 0.029133477216091136
[foolsgold agg] wv: [0.70037078 0.         0.         0.47840793 0.57215924 0.
 1.         0.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 217: Average loss: 0.6963, Accuracy: 7711/10000 (77.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 217: Average loss: 5.7344, Accuracy: 503/9000 (5.5889%)
Done in 385.8424983024597 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:218 choose agents : [17, 33, 77, 11, 53, 15, 7, 29, 86, 60]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 495/526 (94.1065%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   3,  Average loss: 0.0024, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   4,  Average loss: 0.0014, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   5,  Average loss: 0.0012, Accuracy: 524/526 (99.6198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   6,  Average loss: 0.0016, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Global model norm: 37.65186048067545.
Norm before scaling: 37.94176638901713. Distance: 6.742222862106714
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.6906, Accuracy: 5229/10000 (52.2900%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.1132, Accuracy: 8751/9000 (97.2333%)
Scaling by  100
Scaled Norm after poisoning: 673.5273982920071, distance: 674.2223297993029
Total norm for 4 adversaries is: 673.5273982920071. distance: 674.2223297993029
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   1,  Average loss: 0.0073, Accuracy: 463/527 (87.8558%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   2,  Average loss: 0.0060, Accuracy: 481/527 (91.2713%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   3,  Average loss: 0.0030, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   4,  Average loss: 0.0010, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   5,  Average loss: 0.0012, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   6,  Average loss: 0.0016, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 37.65186048067545.
Norm before scaling: 38.23183832768263. Distance: 8.103013558877436
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.8480, Accuracy: 5129/10000 (51.2900%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.2496, Accuracy: 8558/9000 (95.0889%)
Scaling by  100
Scaled Norm after poisoning: 809.8401462634463, distance: 810.3012942726921
Total norm for 4 adversaries is: 809.8401462634463. distance: 810.3012942726921
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   1,  Average loss: 0.0071, Accuracy: 451/496 (90.9274%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   2,  Average loss: 0.0041, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   3,  Average loss: 0.0018, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   4,  Average loss: 0.0012, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.65186048067545.
Norm before scaling: 37.71722080319794. Distance: 5.324781873650143
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.0134, Accuracy: 6694/10000 (66.9400%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.1295, Accuracy: 8696/9000 (96.6222%)
Scaling by  100
Scaled Norm after poisoning: 531.608849390226, distance: 532.4781979104872
Total norm for 4 adversaries is: 531.608849390226. distance: 532.4781979104872
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   1,  Average loss: 0.0069, Accuracy: 502/546 (91.9414%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   2,  Average loss: 0.0049, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   3,  Average loss: 0.0025, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   4,  Average loss: 0.0008, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   5,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.65186048067545.
Norm before scaling: 37.81209161711287. Distance: 6.121129584192333
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.3243, Accuracy: 6065/10000 (60.6500%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.0998, Accuracy: 8774/9000 (97.4889%)
Scaling by  100
Scaled Norm after poisoning: 611.1974926322915, distance: 612.1129899781575
Total norm for 4 adversaries is: 611.1974926322915. distance: 612.1129899781575
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 218, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 570/625 (91.2000%)
___Train Local_ResNet_18,  epoch 218, local model 53, internal_epoch   2,  Average loss: 0.0034, Accuracy: 577/625 (92.3200%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 2.8326, Accuracy: 4115/10000 (41.1500%)
___Train Local_ResNet_18,  epoch 218, local model 15, internal_epoch   1,  Average loss: 0.0114, Accuracy: 282/341 (82.6979%)
___Train Local_ResNet_18,  epoch 218, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 317/341 (92.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 3.9915, Accuracy: 3314/10000 (33.1400%)
___Train Local_ResNet_18,  epoch 218, local model 7, internal_epoch   1,  Average loss: 0.0029, Accuracy: 335/352 (95.1705%)
___Train Local_ResNet_18,  epoch 218, local model 7, internal_epoch   2,  Average loss: 0.0005, Accuracy: 351/352 (99.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 3.2669, Accuracy: 3764/10000 (37.6400%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 771/848 (90.9198%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   2,  Average loss: 0.0053, Accuracy: 771/848 (90.9198%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 10.2501, Accuracy: 1644/10000 (16.4400%)
___Train Local_ResNet_18,  epoch 218, local model 86, internal_epoch   1,  Average loss: 0.0050, Accuracy: 192/212 (90.5660%)
___Train Local_ResNet_18,  epoch 218, local model 86, internal_epoch   2,  Average loss: 0.0014, Accuracy: 210/212 (99.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.6551, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 218, local model 60, internal_epoch   1,  Average loss: 0.0042, Accuracy: 260/284 (91.5493%)
___Train Local_ResNet_18,  epoch 218, local model 60, internal_epoch   2,  Average loss: 0.0007, Accuracy: 282/284 (99.2958%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 3.0791, Accuracy: 4146/10000 (41.4600%)
time spent on training: 347.16295313835144
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4404036157241959  data num: [526, 527, 496, 546, 625, 341, 352, 848, 212, 284]
[foolsgold agg] considering poison per batch poison_fraction: 0.0344065324784528
[foolsgold agg] wv: [0.6842991  0.         0.         0.48484444 1.         1.
 0.74961789 0.34860762 1.         0.34860762]
___Test Target_ResNet_18 poisoned: False, epoch: 218: Average loss: 0.6951, Accuracy: 7713/10000 (77.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 218: Average loss: 5.6893, Accuracy: 528/9000 (5.8667%)
Done in 427.4274551868439 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:219 choose agents : [17, 33, 77, 11, 81, 8, 28, 1, 93, 53]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 488/526 (92.7757%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   2,  Average loss: 0.0037, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   3,  Average loss: 0.0020, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   4,  Average loss: 0.0007, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   5,  Average loss: 0.0016, Accuracy: 523/526 (99.4297%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   6,  Average loss: 0.0013, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Global model norm: 37.65083110646845.
Norm before scaling: 37.74207349004722. Distance: 5.807353705059135
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.7680, Accuracy: 5288/10000 (52.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.0959, Accuracy: 8805/9000 (97.8333%)
Scaling by  100
Scaled Norm after poisoning: 579.6434787867453, distance: 580.7353904748702
Total norm for 4 adversaries is: 579.6434787867453. distance: 580.7353904748702
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   1,  Average loss: 0.0083, Accuracy: 466/527 (88.4250%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 492/527 (93.3586%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   3,  Average loss: 0.0029, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   4,  Average loss: 0.0014, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   5,  Average loss: 0.0016, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   6,  Average loss: 0.0020, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.65083110646845.
Norm before scaling: 38.33493525157161. Distance: 8.625596620131425
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.6993, Accuracy: 5169/10000 (51.6900%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.2312, Accuracy: 8554/9000 (95.0444%)
Scaling by  100
Scaled Norm after poisoning: 862.0817464138769, distance: 862.5595993900943
Total norm for 4 adversaries is: 862.0817464138769. distance: 862.5595993900943
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   1,  Average loss: 0.0073, Accuracy: 442/496 (89.1129%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   2,  Average loss: 0.0042, Accuracy: 468/496 (94.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   3,  Average loss: 0.0022, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   4,  Average loss: 0.0008, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.65083110646845.
Norm before scaling: 37.76288389928165. Distance: 5.611000101902929
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.0824, Accuracy: 6517/10000 (65.1700%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.1238, Accuracy: 8710/9000 (96.7778%)
Scaling by  100
Scaled Norm after poisoning: 560.3102377254944, distance: 561.100035644269
Total norm for 4 adversaries is: 560.3102377254944. distance: 561.100035644269
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   1,  Average loss: 0.0052, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   2,  Average loss: 0.0034, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   3,  Average loss: 0.0018, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   4,  Average loss: 0.0017, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 37.65083110646845.
Norm before scaling: 37.74227401796128. Distance: 5.705044692430284
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.2294, Accuracy: 6306/10000 (63.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.2255, Accuracy: 8594/9000 (95.4889%)
Scaling by  100
Scaled Norm after poisoning: 569.4977227785902, distance: 570.5044368802052
Total norm for 4 adversaries is: 569.4977227785902. distance: 570.5044368802052
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 219, local model 81, internal_epoch   1,  Average loss: 0.0068, Accuracy: 910/1034 (88.0077%)
___Train Local_ResNet_18,  epoch 219, local model 81, internal_epoch   2,  Average loss: 0.0146, Accuracy: 739/1034 (71.4700%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 6.9584, Accuracy: 2671/10000 (26.7100%)
___Train Local_ResNet_18,  epoch 219, local model 8, internal_epoch   1,  Average loss: 0.0050, Accuracy: 489/534 (91.5730%)
___Train Local_ResNet_18,  epoch 219, local model 8, internal_epoch   2,  Average loss: 0.0040, Accuracy: 490/534 (91.7603%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.5320, Accuracy: 4098/10000 (40.9800%)
___Train Local_ResNet_18,  epoch 219, local model 28, internal_epoch   1,  Average loss: 0.0022, Accuracy: 405/423 (95.7447%)
___Train Local_ResNet_18,  epoch 219, local model 28, internal_epoch   2,  Average loss: 0.0009, Accuracy: 419/423 (99.0544%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.8160, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 219, local model 1, internal_epoch   1,  Average loss: 0.0070, Accuracy: 590/641 (92.0437%)
___Train Local_ResNet_18,  epoch 219, local model 1, internal_epoch   2,  Average loss: 0.0157, Accuracy: 543/641 (84.7114%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 4.1763, Accuracy: 4170/10000 (41.7000%)
___Train Local_ResNet_18,  epoch 219, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 537/584 (91.9521%)
___Train Local_ResNet_18,  epoch 219, local model 93, internal_epoch   2,  Average loss: 0.0036, Accuracy: 541/584 (92.6370%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 3.6185, Accuracy: 3915/10000 (39.1500%)
___Train Local_ResNet_18,  epoch 219, local model 53, internal_epoch   1,  Average loss: 0.0044, Accuracy: 578/625 (92.4800%)
___Train Local_ResNet_18,  epoch 219, local model 53, internal_epoch   2,  Average loss: 0.0028, Accuracy: 591/625 (94.5600%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.3156, Accuracy: 4477/10000 (44.7700%)
time spent on training: 404.30464267730713
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.35293126684636117  data num: [526, 527, 496, 546, 1034, 534, 423, 641, 584, 625]
[foolsgold agg] considering poison per batch poison_fraction: 0.027572755222371965
[foolsgold agg] wv: [0.69467207 0.         0.         0.59903638 1.         0.94031329
 1.         0.94031329 1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 219: Average loss: 0.6915, Accuracy: 7720/10000 (77.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 219: Average loss: 5.6339, Accuracy: 565/9000 (6.2778%)
Done in 495.12778973579407 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:220 choose agents : [17, 33, 77, 11, 12, 50, 10, 18, 39, 62]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   1,  Average loss: 0.0063, Accuracy: 488/526 (92.7757%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   3,  Average loss: 0.0035, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   4,  Average loss: 0.0027, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   5,  Average loss: 0.0028, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   6,  Average loss: 0.0031, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Global model norm: 37.65080192694689.
Norm before scaling: 38.1357310717259. Distance: 7.729193043899427
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 2.1834, Accuracy: 4363/10000 (43.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.3359, Accuracy: 8179/9000 (90.8778%)
Scaling by  100
Scaled Norm after poisoning: 772.3490143710937, distance: 772.9193036792392
Total norm for 4 adversaries is: 772.3490143710937. distance: 772.9193036792392
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   1,  Average loss: 0.0075, Accuracy: 470/527 (89.1841%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   3,  Average loss: 0.0019, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   4,  Average loss: 0.0016, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   5,  Average loss: 0.0009, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   6,  Average loss: 0.0012, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Global model norm: 37.65080192694689.
Norm before scaling: 37.892003840891356. Distance: 6.630719576950476
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.6107, Accuracy: 5538/10000 (55.3800%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.1428, Accuracy: 8679/9000 (96.4333%)
Scaling by  100
Scaled Norm after poisoning: 662.1990118159343, distance: 663.071993640208
Total norm for 4 adversaries is: 662.1990118159343. distance: 663.071993640208
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 450/496 (90.7258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   2,  Average loss: 0.0046, Accuracy: 467/496 (94.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   3,  Average loss: 0.0017, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   4,  Average loss: 0.0008, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   5,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.65080192694689.
Norm before scaling: 37.7797685684539. Distance: 5.597298631338495
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 0.9975, Accuracy: 6806/10000 (68.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.1555, Accuracy: 8684/9000 (96.4889%)
Scaling by  100
Scaled Norm after poisoning: 559.0661298093455, distance: 559.729845550512
Total norm for 4 adversaries is: 559.0661298093455. distance: 559.729845550512
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   1,  Average loss: 0.0060, Accuracy: 500/546 (91.5751%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   2,  Average loss: 0.0038, Accuracy: 522/546 (95.6044%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   3,  Average loss: 0.0017, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   4,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   5,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 37.65080192694689.
Norm before scaling: 37.730214573957504. Distance: 5.67592339754466
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.3095, Accuracy: 6094/10000 (60.9400%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.1509, Accuracy: 8712/9000 (96.8000%)
Scaling by  100
Scaled Norm after poisoning: 566.5294840076729, distance: 567.5922557170773
Total norm for 4 adversaries is: 566.5294840076729. distance: 567.5922557170773
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 220, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 887/977 (90.7881%)
___Train Local_ResNet_18,  epoch 220, local model 12, internal_epoch   2,  Average loss: 0.0088, Accuracy: 812/977 (83.1116%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 7.7169, Accuracy: 2409/10000 (24.0900%)
___Train Local_ResNet_18,  epoch 220, local model 50, internal_epoch   1,  Average loss: 0.0025, Accuracy: 386/401 (96.2594%)
___Train Local_ResNet_18,  epoch 220, local model 50, internal_epoch   2,  Average loss: 0.0015, Accuracy: 393/401 (98.0050%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 3.0929, Accuracy: 4305/10000 (43.0500%)
___Train Local_ResNet_18,  epoch 220, local model 10, internal_epoch   1,  Average loss: 0.0048, Accuracy: 683/752 (90.8245%)
___Train Local_ResNet_18,  epoch 220, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 702/752 (93.3511%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 5.0140, Accuracy: 3171/10000 (31.7100%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   1,  Average loss: 0.0033, Accuracy: 362/386 (93.7824%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   2,  Average loss: 0.0021, Accuracy: 375/386 (97.1503%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.8422, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 220, local model 39, internal_epoch   1,  Average loss: 0.0067, Accuracy: 186/217 (85.7143%)
___Train Local_ResNet_18,  epoch 220, local model 39, internal_epoch   2,  Average loss: 0.0011, Accuracy: 214/217 (98.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 3.5836, Accuracy: 3580/10000 (35.8000%)
___Train Local_ResNet_18,  epoch 220, local model 62, internal_epoch   1,  Average loss: 0.0020, Accuracy: 347/358 (96.9274%)
___Train Local_ResNet_18,  epoch 220, local model 62, internal_epoch   2,  Average loss: 0.0004, Accuracy: 356/358 (99.4413%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.3165, Accuracy: 6317/10000 (63.1700%)
time spent on training: 339.44497632980347
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.40397223293482454  data num: [526, 527, 496, 546, 977, 401, 752, 386, 217, 358]
[foolsgold agg] considering poison per batch poison_fraction: 0.03156033069803317
[foolsgold agg] wv: [1.         0.23551256 0.23551256 0.91203268 1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 220: Average loss: 0.6887, Accuracy: 7729/10000 (77.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 220: Average loss: 5.5268, Accuracy: 615/9000 (6.8333%)
Done in 430.98174929618835 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:221 choose agents : [17, 33, 77, 11, 65, 87, 12, 74, 4, 7]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   1,  Average loss: 0.0061, Accuracy: 491/526 (93.3460%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   3,  Average loss: 0.0017, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   4,  Average loss: 0.0017, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   5,  Average loss: 0.0029, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   6,  Average loss: 0.0028, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Global model norm: 37.650472845221344.
Norm before scaling: 38.08311928675716. Distance: 7.4378372244157305
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.7634, Accuracy: 5067/10000 (50.6700%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.4788, Accuracy: 8229/9000 (91.4333%)
Scaling by  100
Scaled Norm after poisoning: 743.2201053523781, distance: 743.7837387305533
Total norm for 4 adversaries is: 743.2201053523781. distance: 743.7837387305533
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   1,  Average loss: 0.0087, Accuracy: 478/527 (90.7021%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 494/527 (93.7381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   3,  Average loss: 0.0050, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   4,  Average loss: 0.0022, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   5,  Average loss: 0.0024, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   6,  Average loss: 0.0017, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Global model norm: 37.650472845221344.
Norm before scaling: 38.52381695336341. Distance: 9.330268856316646
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.7881, Accuracy: 5137/10000 (51.3700%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.1288, Accuracy: 8688/9000 (96.5333%)
Scaling by  100
Scaled Norm after poisoning: 932.686375476773, distance: 933.0268283924102
Total norm for 4 adversaries is: 932.686375476773. distance: 933.0268283924102
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 446/496 (89.9194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   2,  Average loss: 0.0035, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   3,  Average loss: 0.0016, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   4,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.650472845221344.
Norm before scaling: 37.76563954540473. Distance: 5.584386223353212
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.0698, Accuracy: 6555/10000 (65.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.1445, Accuracy: 8704/9000 (96.7111%)
Scaling by  100
Scaled Norm after poisoning: 557.6927917769782, distance: 558.4385597359839
Total norm for 4 adversaries is: 557.6927917769782. distance: 558.4385597359839
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   1,  Average loss: 0.0063, Accuracy: 502/546 (91.9414%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 517/546 (94.6886%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   3,  Average loss: 0.0026, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   4,  Average loss: 0.0010, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   5,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.650472845221344.
Norm before scaling: 37.729101598393186. Distance: 5.781743868791374
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.2966, Accuracy: 6273/10000 (62.7300%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.2689, Accuracy: 8465/9000 (94.0556%)
Scaling by  100
Scaled Norm after poisoning: 577.0208239309912, distance: 578.1744168069009
Total norm for 4 adversaries is: 577.0208239309912. distance: 578.1744168069009
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 221, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 275/314 (87.5796%)
___Train Local_ResNet_18,  epoch 221, local model 65, internal_epoch   2,  Average loss: 0.0014, Accuracy: 306/314 (97.4522%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 2.7921, Accuracy: 3912/10000 (39.1200%)
___Train Local_ResNet_18,  epoch 221, local model 87, internal_epoch   1,  Average loss: 0.0092, Accuracy: 330/397 (83.1234%)
___Train Local_ResNet_18,  epoch 221, local model 87, internal_epoch   2,  Average loss: 0.0068, Accuracy: 356/397 (89.6725%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 4.2457, Accuracy: 2863/10000 (28.6300%)
___Train Local_ResNet_18,  epoch 221, local model 12, internal_epoch   1,  Average loss: 0.0064, Accuracy: 870/977 (89.0481%)
___Train Local_ResNet_18,  epoch 221, local model 12, internal_epoch   2,  Average loss: 0.0106, Accuracy: 780/977 (79.8362%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 6.2587, Accuracy: 3034/10000 (30.3400%)
___Train Local_ResNet_18,  epoch 221, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 419/469 (89.3390%)
___Train Local_ResNet_18,  epoch 221, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 431/469 (91.8977%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 3.4923, Accuracy: 3530/10000 (35.3000%)
___Train Local_ResNet_18,  epoch 221, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 490/557 (87.9713%)
___Train Local_ResNet_18,  epoch 221, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 513/557 (92.1005%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 3.8729, Accuracy: 4259/10000 (42.5900%)
___Train Local_ResNet_18,  epoch 221, local model 7, internal_epoch   1,  Average loss: 0.0028, Accuracy: 333/352 (94.6023%)
___Train Local_ResNet_18,  epoch 221, local model 7, internal_epoch   2,  Average loss: 0.0009, Accuracy: 347/352 (98.5795%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 2.1844, Accuracy: 4965/10000 (49.6500%)
time spent on training: 367.73847818374634
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4059290835109475  data num: [526, 527, 496, 546, 314, 397, 977, 469, 557, 352]
[foolsgold agg] considering poison per batch poison_fraction: 0.03171320964929277
[foolsgold agg] wv: [0.81139587 0.09920057 0.09920057 0.47525512 1.         0.537749
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 221: Average loss: 0.6867, Accuracy: 7744/10000 (77.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 221: Average loss: 5.4523, Accuracy: 662/9000 (7.3556%)
Done in 434.17840600013733 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:222 choose agents : [17, 33, 77, 11, 35, 30, 72, 51, 63, 46]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   1,  Average loss: 0.0050, Accuracy: 493/526 (93.7262%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   2,  Average loss: 0.0061, Accuracy: 484/526 (92.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   3,  Average loss: 0.0032, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   4,  Average loss: 0.0020, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   5,  Average loss: 0.0015, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   6,  Average loss: 0.0015, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Global model norm: 37.650247511740375.
Norm before scaling: 38.02178491246416. Distance: 7.232458268541974
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.4835, Accuracy: 5489/10000 (54.8900%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.1367, Accuracy: 8707/9000 (96.7444%)
Scaling by  100
Scaled Norm after poisoning: 722.5529392369807, distance: 723.245808836802
Total norm for 4 adversaries is: 722.5529392369807. distance: 723.245808836802
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   1,  Average loss: 0.0067, Accuracy: 483/527 (91.6509%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   3,  Average loss: 0.0032, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   4,  Average loss: 0.0017, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   5,  Average loss: 0.0015, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   6,  Average loss: 0.0009, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Global model norm: 37.650247511740375.
Norm before scaling: 38.25217645972906. Distance: 8.173930097556871
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.7047, Accuracy: 5289/10000 (52.8900%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.3026, Accuracy: 8498/9000 (94.4222%)
Scaling by  100
Scaled Norm after poisoning: 816.9678313740388, distance: 817.3929975843934
Total norm for 4 adversaries is: 816.9678313740388. distance: 817.3929975843934
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   1,  Average loss: 0.0069, Accuracy: 441/496 (88.9113%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   2,  Average loss: 0.0060, Accuracy: 451/496 (90.9274%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   3,  Average loss: 0.0023, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   4,  Average loss: 0.0010, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.650247511740375.
Norm before scaling: 37.866593539028564. Distance: 6.17564010700115
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.0221, Accuracy: 6657/10000 (66.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.1708, Accuracy: 8644/9000 (96.0444%)
Scaling by  100
Scaled Norm after poisoning: 616.9464117733403, distance: 617.5639895994584
Total norm for 4 adversaries is: 616.9464117733403. distance: 617.5639895994584
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   1,  Average loss: 0.0061, Accuracy: 505/546 (92.4908%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   2,  Average loss: 0.0043, Accuracy: 520/546 (95.2381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   3,  Average loss: 0.0030, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   4,  Average loss: 0.0015, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Global model norm: 37.650247511740375.
Norm before scaling: 37.85207929858758. Distance: 6.372511434084608
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.3092, Accuracy: 6101/10000 (61.0100%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.1256, Accuracy: 8737/9000 (97.0778%)
Scaling by  100
Scaled Norm after poisoning: 636.3722377665449, distance: 637.251201450417
Total norm for 4 adversaries is: 636.3722377665449. distance: 637.251201450417
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 222, local model 35, internal_epoch   1,  Average loss: 0.0078, Accuracy: 362/419 (86.3962%)
___Train Local_ResNet_18,  epoch 222, local model 35, internal_epoch   2,  Average loss: 0.0029, Accuracy: 394/419 (94.0334%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 3.3857, Accuracy: 3886/10000 (38.8600%)
___Train Local_ResNet_18,  epoch 222, local model 30, internal_epoch   1,  Average loss: 0.0056, Accuracy: 297/337 (88.1306%)
___Train Local_ResNet_18,  epoch 222, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 313/337 (92.8783%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 4.7928, Accuracy: 2941/10000 (29.4100%)
___Train Local_ResNet_18,  epoch 222, local model 72, internal_epoch   1,  Average loss: 0.0081, Accuracy: 523/618 (84.6278%)
___Train Local_ResNet_18,  epoch 222, local model 72, internal_epoch   2,  Average loss: 0.0063, Accuracy: 538/618 (87.0550%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 8.5110, Accuracy: 3208/10000 (32.0800%)
___Train Local_ResNet_18,  epoch 222, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 441/479 (92.0668%)
___Train Local_ResNet_18,  epoch 222, local model 51, internal_epoch   2,  Average loss: 0.0021, Accuracy: 458/479 (95.6159%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 6.3266, Accuracy: 2608/10000 (26.0800%)
___Train Local_ResNet_18,  epoch 222, local model 63, internal_epoch   1,  Average loss: 0.0024, Accuracy: 716/752 (95.2128%)
___Train Local_ResNet_18,  epoch 222, local model 63, internal_epoch   2,  Average loss: 0.0017, Accuracy: 726/752 (96.5426%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.5048, Accuracy: 5979/10000 (59.7900%)
___Train Local_ResNet_18,  epoch 222, local model 46, internal_epoch   1,  Average loss: 0.0015, Accuracy: 586/601 (97.5042%)
___Train Local_ResNet_18,  epoch 222, local model 46, internal_epoch   2,  Average loss: 0.0009, Accuracy: 593/601 (98.6689%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.7895, Accuracy: 5541/10000 (55.4100%)
time spent on training: 308.85478353500366
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.39520845123561593  data num: [526, 527, 496, 546, 419, 337, 618, 479, 752, 601]
[foolsgold agg] considering poison per batch poison_fraction: 0.030875660252782496
[foolsgold agg] wv: [0.94675896 0.18781839 0.18781839 0.83632272 1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 222: Average loss: 0.6851, Accuracy: 7747/10000 (77.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 222: Average loss: 5.3322, Accuracy: 728/9000 (8.0889%)
Done in 375.53328490257263 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:223 choose agents : [17, 33, 77, 11, 54, 95, 26, 2, 82, 45]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 490/526 (93.1559%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   3,  Average loss: 0.0029, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   4,  Average loss: 0.0037, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   5,  Average loss: 0.0011, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   6,  Average loss: 0.0008, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Global model norm: 37.65000758683937.
Norm before scaling: 38.12898768848233. Distance: 7.645160725153379
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.4584, Accuracy: 5687/10000 (56.8700%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.1325, Accuracy: 8732/9000 (97.0222%)
Scaling by  100
Scaled Norm after poisoning: 763.9940281180213, distance: 764.5160642524132
Total norm for 4 adversaries is: 763.9940281180213. distance: 764.5160642524132
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   1,  Average loss: 0.0077, Accuracy: 480/527 (91.0816%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   3,  Average loss: 0.0026, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   4,  Average loss: 0.0012, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   5,  Average loss: 0.0010, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   6,  Average loss: 0.0009, Accuracy: 524/527 (99.4307%), train_poison_data_count: 45
Global model norm: 37.65000758683937.
Norm before scaling: 38.292364457960154. Distance: 8.317546488589274
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.8745, Accuracy: 5117/10000 (51.1700%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.1669, Accuracy: 8721/9000 (96.9000%)
Scaling by  100
Scaled Norm after poisoning: 831.3803657171608, distance: 831.7546212675948
Total norm for 4 adversaries is: 831.3803657171608. distance: 831.7546212675948
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   1,  Average loss: 0.0060, Accuracy: 444/496 (89.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 462/496 (93.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   3,  Average loss: 0.0018, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   4,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   5,  Average loss: 0.0006, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.65000758683937.
Norm before scaling: 37.841854889068436. Distance: 5.928553536892023
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.0109, Accuracy: 6747/10000 (67.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.1822, Accuracy: 8623/9000 (95.8111%)
Scaling by  100
Scaled Norm after poisoning: 592.3078274849995, distance: 592.8554050103617
Total norm for 4 adversaries is: 592.3078274849995. distance: 592.8554050103617
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   1,  Average loss: 0.0049, Accuracy: 510/546 (93.4066%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   2,  Average loss: 0.0039, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   3,  Average loss: 0.0020, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   4,  Average loss: 0.0009, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   5,  Average loss: 0.0017, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.65000758683937.
Norm before scaling: 37.71718520211062. Distance: 5.492858758876903
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.3048, Accuracy: 6091/10000 (60.9100%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.1752, Accuracy: 8680/9000 (96.4444%)
Scaling by  100
Scaled Norm after poisoning: 548.2896987451069, distance: 549.2857862715911
Total norm for 4 adversaries is: 548.2896987451069. distance: 549.2857862715911
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 223, local model 54, internal_epoch   1,  Average loss: 0.0034, Accuracy: 410/440 (93.1818%)
___Train Local_ResNet_18,  epoch 223, local model 54, internal_epoch   2,  Average loss: 0.0010, Accuracy: 433/440 (98.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 2.9305, Accuracy: 4413/10000 (44.1300%)
___Train Local_ResNet_18,  epoch 223, local model 95, internal_epoch   1,  Average loss: 0.0086, Accuracy: 465/569 (81.7223%)
___Train Local_ResNet_18,  epoch 223, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 504/569 (88.5764%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 11.2889, Accuracy: 1774/10000 (17.7400%)
___Train Local_ResNet_18,  epoch 223, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 433/468 (92.5214%)
___Train Local_ResNet_18,  epoch 223, local model 26, internal_epoch   2,  Average loss: 0.0043, Accuracy: 435/468 (92.9487%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 2.7502, Accuracy: 4350/10000 (43.5000%)
___Train Local_ResNet_18,  epoch 223, local model 2, internal_epoch   1,  Average loss: 0.0081, Accuracy: 391/461 (84.8156%)
___Train Local_ResNet_18,  epoch 223, local model 2, internal_epoch   2,  Average loss: 0.0106, Accuracy: 386/461 (83.7310%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 7.8562, Accuracy: 2268/10000 (22.6800%)
___Train Local_ResNet_18,  epoch 223, local model 82, internal_epoch   1,  Average loss: 0.0024, Accuracy: 582/601 (96.8386%)
___Train Local_ResNet_18,  epoch 223, local model 82, internal_epoch   2,  Average loss: 0.0042, Accuracy: 554/601 (92.1797%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 3.6098, Accuracy: 3906/10000 (39.0600%)
___Train Local_ResNet_18,  epoch 223, local model 45, internal_epoch   1,  Average loss: 0.0071, Accuracy: 464/529 (87.7127%)
___Train Local_ResNet_18,  epoch 223, local model 45, internal_epoch   2,  Average loss: 0.0054, Accuracy: 478/529 (90.3592%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 5.9645, Accuracy: 2687/10000 (26.8700%)
time spent on training: 336.2645380496979
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4057718380786364  data num: [526, 527, 496, 546, 440, 569, 468, 461, 601, 529]
[foolsgold agg] considering poison per batch poison_fraction: 0.03170092484989347
[foolsgold agg] wv: [0.14874226 0.2650932  0.         0.60049548 1.         0.82836985
 0.14874226 0.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 223: Average loss: 0.6851, Accuracy: 7747/10000 (77.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 223: Average loss: 5.2742, Accuracy: 762/9000 (8.4667%)
Done in 405.3058044910431 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:224 choose agents : [17, 33, 77, 11, 0, 34, 62, 66, 95, 10]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   1,  Average loss: 0.0069, Accuracy: 488/526 (92.7757%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   2,  Average loss: 0.0061, Accuracy: 478/526 (90.8745%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   3,  Average loss: 0.0029, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   4,  Average loss: 0.0040, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   5,  Average loss: 0.0027, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   6,  Average loss: 0.0019, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Global model norm: 37.64917594342206.
Norm before scaling: 38.447526321903176. Distance: 9.038118384007804
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.9903, Accuracy: 4763/10000 (47.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.2585, Accuracy: 8472/9000 (94.1333%)
Scaling by  100
Scaled Norm after poisoning: 903.4376707886383, distance: 903.811858187311
Total norm for 4 adversaries is: 903.4376707886383. distance: 903.811858187311
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   1,  Average loss: 0.0070, Accuracy: 467/527 (88.6148%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   2,  Average loss: 0.0056, Accuracy: 492/527 (93.3586%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   3,  Average loss: 0.0024, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   4,  Average loss: 0.0013, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   5,  Average loss: 0.0008, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   6,  Average loss: 0.0006, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Global model norm: 37.64917594342206.
Norm before scaling: 37.96842045896086. Distance: 6.998551355054555
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.7067, Accuracy: 5322/10000 (53.2200%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.2515, Accuracy: 8573/9000 (95.2556%)
Scaling by  100
Scaled Norm after poisoning: 699.0927826476254, distance: 699.855096609291
Total norm for 4 adversaries is: 699.0927826476254. distance: 699.855096609291
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 444/496 (89.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   2,  Average loss: 0.0047, Accuracy: 467/496 (94.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   3,  Average loss: 0.0020, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   4,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Global model norm: 37.64917594342206.
Norm before scaling: 37.818891505271544. Distance: 5.815908109649995
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 0.9982, Accuracy: 6819/10000 (68.1900%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.2173, Accuracy: 8573/9000 (95.2556%)
Scaling by  100
Scaled Norm after poisoning: 581.0022321385693, distance: 581.5908409268495
Total norm for 4 adversaries is: 581.0022321385693. distance: 581.5908409268495
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   1,  Average loss: 0.0051, Accuracy: 512/546 (93.7729%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   2,  Average loss: 0.0032, Accuracy: 526/546 (96.3370%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   3,  Average loss: 0.0020, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   4,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.64917594342206.
Norm before scaling: 37.63308091688581. Distance: 5.0880128344247995
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.1645, Accuracy: 6423/10000 (64.2300%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.1357, Accuracy: 8710/9000 (96.7778%)
Scaling by  100
Scaled Norm after poisoning: 507.52955578961115, distance: 508.80131805057266
Total norm for 4 adversaries is: 507.52955578961115. distance: 508.80131805057266
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 224, local model 0, internal_epoch   1,  Average loss: 0.0072, Accuracy: 314/367 (85.5586%)
___Train Local_ResNet_18,  epoch 224, local model 0, internal_epoch   2,  Average loss: 0.0028, Accuracy: 346/367 (94.2779%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 5.3921, Accuracy: 2505/10000 (25.0500%)
___Train Local_ResNet_18,  epoch 224, local model 34, internal_epoch   1,  Average loss: 0.0057, Accuracy: 308/349 (88.2521%)
___Train Local_ResNet_18,  epoch 224, local model 34, internal_epoch   2,  Average loss: 0.0031, Accuracy: 331/349 (94.8424%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 3.8100, Accuracy: 3364/10000 (33.6400%)
___Train Local_ResNet_18,  epoch 224, local model 62, internal_epoch   1,  Average loss: 0.0019, Accuracy: 346/358 (96.6480%)
___Train Local_ResNet_18,  epoch 224, local model 62, internal_epoch   2,  Average loss: 0.0007, Accuracy: 356/358 (99.4413%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.1387, Accuracy: 6679/10000 (66.7900%)
___Train Local_ResNet_18,  epoch 224, local model 66, internal_epoch   1,  Average loss: 0.0032, Accuracy: 525/555 (94.5946%)
___Train Local_ResNet_18,  epoch 224, local model 66, internal_epoch   2,  Average loss: 0.0007, Accuracy: 546/555 (98.3784%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 3.0864, Accuracy: 4220/10000 (42.2000%)
___Train Local_ResNet_18,  epoch 224, local model 95, internal_epoch   1,  Average loss: 0.0099, Accuracy: 473/569 (83.1283%)
___Train Local_ResNet_18,  epoch 224, local model 95, internal_epoch   2,  Average loss: 0.0064, Accuracy: 509/569 (89.4552%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 9.9834, Accuracy: 1803/10000 (18.0300%)
___Train Local_ResNet_18,  epoch 224, local model 10, internal_epoch   1,  Average loss: 0.0037, Accuracy: 702/752 (93.3511%)
___Train Local_ResNet_18,  epoch 224, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 707/752 (94.0160%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 4.6112, Accuracy: 3386/10000 (33.8600%)
time spent on training: 332.9123775959015
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41526263627353815  data num: [526, 527, 496, 546, 367, 349, 358, 555, 569, 752]
[foolsgold agg] considering poison per batch poison_fraction: 0.03244239345887017
[foolsgold agg] wv: [0.72958007 0.         0.35830087 0.84777958 0.         1.
 1.         1.         0.72426199 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 224: Average loss: 0.6847, Accuracy: 7754/10000 (77.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 224: Average loss: 5.1723, Accuracy: 831/9000 (9.2333%)
Done in 423.69236755371094 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:225 choose agents : [17, 33, 77, 11, 12, 38, 41, 4, 68, 55]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   3,  Average loss: 0.0029, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   4,  Average loss: 0.0027, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   5,  Average loss: 0.0032, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   6,  Average loss: 0.0025, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 37.648371841870535.
Norm before scaling: 38.08925706687189. Distance: 7.504571157423716
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.5308, Accuracy: 5272/10000 (52.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.1206, Accuracy: 8733/9000 (97.0333%)
Scaling by  100
Scaled Norm after poisoning: 749.8737393721692, distance: 750.4570274172933
Total norm for 4 adversaries is: 749.8737393721692. distance: 750.4570274172933
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   1,  Average loss: 0.0064, Accuracy: 474/527 (89.9431%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   2,  Average loss: 0.0058, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   3,  Average loss: 0.0024, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   4,  Average loss: 0.0035, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   5,  Average loss: 0.0021, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   6,  Average loss: 0.0023, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Global model norm: 37.648371841870535.
Norm before scaling: 38.304597472105094. Distance: 8.541367341046017
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 2.0561, Accuracy: 4976/10000 (49.7600%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.1382, Accuracy: 8700/9000 (96.6667%)
Scaling by  100
Scaled Norm after poisoning: 853.6132028032368, distance: 854.1365523146752
Total norm for 4 adversaries is: 853.6132028032368. distance: 854.1365523146752
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 448/496 (90.3226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   2,  Average loss: 0.0032, Accuracy: 478/496 (96.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   3,  Average loss: 0.0013, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   4,  Average loss: 0.0011, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   6,  Average loss: 0.0014, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Global model norm: 37.648371841870535.
Norm before scaling: 37.71796194547516. Distance: 5.405612268484707
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.0491, Accuracy: 6615/10000 (66.1500%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.1231, Accuracy: 8703/9000 (96.7000%)
Scaling by  100
Scaled Norm after poisoning: 539.6537952706346, distance: 540.5612245620287
Total norm for 4 adversaries is: 539.6537952706346. distance: 540.5612245620287
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   1,  Average loss: 0.0055, Accuracy: 513/546 (93.9560%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   2,  Average loss: 0.0042, Accuracy: 515/546 (94.3223%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   3,  Average loss: 0.0014, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   4,  Average loss: 0.0006, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 37.648371841870535.
Norm before scaling: 37.765335706897766. Distance: 5.818045647068025
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.3134, Accuracy: 6162/10000 (61.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.1623, Accuracy: 8652/9000 (96.1333%)
Scaling by  100
Scaled Norm after poisoning: 580.8709516751547, distance: 581.8046278605904
Total norm for 4 adversaries is: 580.8709516751547. distance: 581.8046278605904
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 225, local model 12, internal_epoch   1,  Average loss: 0.0053, Accuracy: 886/977 (90.6858%)
___Train Local_ResNet_18,  epoch 225, local model 12, internal_epoch   2,  Average loss: 0.0093, Accuracy: 799/977 (81.7810%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 11.4512, Accuracy: 1664/10000 (16.6400%)
___Train Local_ResNet_18,  epoch 225, local model 38, internal_epoch   1,  Average loss: 0.0029, Accuracy: 718/756 (94.9735%)
___Train Local_ResNet_18,  epoch 225, local model 38, internal_epoch   2,  Average loss: 0.0029, Accuracy: 713/756 (94.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 2.5695, Accuracy: 4682/10000 (46.8200%)
___Train Local_ResNet_18,  epoch 225, local model 41, internal_epoch   1,  Average loss: 0.0081, Accuracy: 437/513 (85.1852%)
___Train Local_ResNet_18,  epoch 225, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 476/513 (92.7875%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 10.9868, Accuracy: 1706/10000 (17.0600%)
___Train Local_ResNet_18,  epoch 225, local model 4, internal_epoch   1,  Average loss: 0.0066, Accuracy: 478/557 (85.8169%)
___Train Local_ResNet_18,  epoch 225, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 508/557 (91.2029%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 3.9272, Accuracy: 3547/10000 (35.4700%)
___Train Local_ResNet_18,  epoch 225, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 398/416 (95.6731%)
___Train Local_ResNet_18,  epoch 225, local model 68, internal_epoch   2,  Average loss: 0.0015, Accuracy: 404/416 (97.1154%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.4227, Accuracy: 6179/10000 (61.7900%)
___Train Local_ResNet_18,  epoch 225, local model 55, internal_epoch   1,  Average loss: 0.0050, Accuracy: 275/299 (91.9732%)
___Train Local_ResNet_18,  epoch 225, local model 55, internal_epoch   2,  Average loss: 0.0012, Accuracy: 292/299 (97.6589%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 6.6961, Accuracy: 2477/10000 (24.7700%)
time spent on training: 304.7664942741394
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3732406912524497  data num: [526, 527, 496, 546, 977, 756, 513, 557, 416, 299]
[foolsgold agg] considering poison per batch poison_fraction: 0.029159429004097633
[foolsgold agg] wv: [0.59698222 0.         0.01671134 0.54173459 0.         0.72781417
 0.         0.72781417 1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 225: Average loss: 0.6843, Accuracy: 7757/10000 (77.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 225: Average loss: 5.1260, Accuracy: 865/9000 (9.6111%)
Done in 371.8180477619171 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:226 choose agents : [17, 33, 77, 11, 30, 39, 10, 64, 23, 60]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   1,  Average loss: 0.0043, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   3,  Average loss: 0.0056, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   4,  Average loss: 0.0021, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   5,  Average loss: 0.0030, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   6,  Average loss: 0.0015, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Global model norm: 37.64732129622571.
Norm before scaling: 38.14896947586281. Distance: 7.759760709002974
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.7768, Accuracy: 5250/10000 (52.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.2769, Accuracy: 8325/9000 (92.5000%)
Scaling by  100
Scaled Norm after poisoning: 775.4592590845763, distance: 775.976038612018
Total norm for 4 adversaries is: 775.4592590845763. distance: 775.976038612018
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   1,  Average loss: 0.0064, Accuracy: 475/527 (90.1328%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   3,  Average loss: 0.0024, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   4,  Average loss: 0.0028, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   5,  Average loss: 0.0018, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   6,  Average loss: 0.0016, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.64732129622571.
Norm before scaling: 38.25692786015201. Distance: 8.234732632769756
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.9075, Accuracy: 4817/10000 (48.1700%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.2600, Accuracy: 8557/9000 (95.0778%)
Scaling by  100
Scaled Norm after poisoning: 823.0259336740246, distance: 823.4733222758342
Total norm for 4 adversaries is: 823.0259336740246. distance: 823.4733222758342
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 447/496 (90.1210%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 477/496 (96.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   3,  Average loss: 0.0017, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   4,  Average loss: 0.0011, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.64732129622571.
Norm before scaling: 37.775907203389075. Distance: 5.6428490478292
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 0.9646, Accuracy: 6891/10000 (68.9100%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.2450, Accuracy: 8528/9000 (94.7556%)
Scaling by  100
Scaled Norm after poisoning: 563.5782720705262, distance: 564.2849457499287
Total norm for 4 adversaries is: 563.5782720705262. distance: 564.2849457499287
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 508/546 (93.0403%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   2,  Average loss: 0.0040, Accuracy: 518/546 (94.8718%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   3,  Average loss: 0.0028, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   5,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.64732129622571.
Norm before scaling: 37.692210850374146. Distance: 5.5142664978912315
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.1572, Accuracy: 6421/10000 (64.2100%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.1076, Accuracy: 8727/9000 (96.9667%)
Scaling by  100
Scaled Norm after poisoning: 550.2600521571596, distance: 551.4265590266758
Total norm for 4 adversaries is: 550.2600521571596. distance: 551.4265590266758
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 226, local model 30, internal_epoch   1,  Average loss: 0.0050, Accuracy: 300/337 (89.0208%)
___Train Local_ResNet_18,  epoch 226, local model 30, internal_epoch   2,  Average loss: 0.0029, Accuracy: 324/337 (96.1424%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 4.5213, Accuracy: 2808/10000 (28.0800%)
___Train Local_ResNet_18,  epoch 226, local model 39, internal_epoch   1,  Average loss: 0.0067, Accuracy: 183/217 (84.3318%)
___Train Local_ResNet_18,  epoch 226, local model 39, internal_epoch   2,  Average loss: 0.0016, Accuracy: 208/217 (95.8525%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 5.0393, Accuracy: 2628/10000 (26.2800%)
___Train Local_ResNet_18,  epoch 226, local model 10, internal_epoch   1,  Average loss: 0.0043, Accuracy: 683/752 (90.8245%)
___Train Local_ResNet_18,  epoch 226, local model 10, internal_epoch   2,  Average loss: 0.0031, Accuracy: 707/752 (94.0160%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 4.6281, Accuracy: 3679/10000 (36.7900%)
___Train Local_ResNet_18,  epoch 226, local model 64, internal_epoch   1,  Average loss: 0.0052, Accuracy: 606/686 (88.3382%)
___Train Local_ResNet_18,  epoch 226, local model 64, internal_epoch   2,  Average loss: 0.0044, Accuracy: 621/686 (90.5248%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 3.4506, Accuracy: 3782/10000 (37.8200%)
___Train Local_ResNet_18,  epoch 226, local model 23, internal_epoch   1,  Average loss: 0.0039, Accuracy: 222/248 (89.5161%)
___Train Local_ResNet_18,  epoch 226, local model 23, internal_epoch   2,  Average loss: 0.0009, Accuracy: 243/248 (97.9839%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 2.1977, Accuracy: 4614/10000 (46.1400%)
___Train Local_ResNet_18,  epoch 226, local model 60, internal_epoch   1,  Average loss: 0.0051, Accuracy: 257/284 (90.4930%)
___Train Local_ResNet_18,  epoch 226, local model 60, internal_epoch   2,  Average loss: 0.0010, Accuracy: 280/284 (98.5915%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 2.5215, Accuracy: 4539/10000 (45.3900%)
time spent on training: 341.234450340271
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4535613769214116  data num: [526, 527, 496, 546, 337, 217, 752, 686, 248, 284]
[foolsgold agg] considering poison per batch poison_fraction: 0.03543448257198528
[foolsgold agg] wv: [0.5831467  0.         0.         0.49526732 1.         0.
 1.         1.         0.15646727 0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 226: Average loss: 0.6832, Accuracy: 7753/10000 (77.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 226: Average loss: 5.0590, Accuracy: 907/9000 (10.0778%)
Done in 409.8923935890198 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:227 choose agents : [17, 33, 77, 11, 23, 34, 52, 92, 57, 74]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 487/526 (92.5856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   2,  Average loss: 0.0058, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   3,  Average loss: 0.0030, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   4,  Average loss: 0.0021, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   5,  Average loss: 0.0033, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   6,  Average loss: 0.0048, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Global model norm: 37.64643933403596.
Norm before scaling: 38.444679842640454. Distance: 8.905444299493805
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 2.0842, Accuracy: 4522/10000 (45.2200%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.3672, Accuracy: 8115/9000 (90.1667%)
Scaling by  100
Scaled Norm after poisoning: 890.2976679178712, distance: 890.5444261798509
Total norm for 4 adversaries is: 890.2976679178712. distance: 890.5444261798509
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   1,  Average loss: 0.0079, Accuracy: 472/527 (89.5636%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   2,  Average loss: 0.0062, Accuracy: 483/527 (91.6509%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   3,  Average loss: 0.0028, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   4,  Average loss: 0.0017, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   5,  Average loss: 0.0026, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   6,  Average loss: 0.0028, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Global model norm: 37.64643933403596.
Norm before scaling: 38.596360931419916. Distance: 9.428425246917895
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.7600, Accuracy: 5069/10000 (50.6900%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.2799, Accuracy: 8424/9000 (93.6000%)
Scaling by  100
Scaled Norm after poisoning: 942.7206306748569, distance: 942.8424775645187
Total norm for 4 adversaries is: 942.7206306748569. distance: 942.8424775645187
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   1,  Average loss: 0.0061, Accuracy: 451/496 (90.9274%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 463/496 (93.3468%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   3,  Average loss: 0.0016, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   4,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Global model norm: 37.64643933403596.
Norm before scaling: 37.77890100741583. Distance: 5.686176858776651
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.0566, Accuracy: 6517/10000 (65.1700%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.0841, Accuracy: 8792/9000 (97.6889%)
Scaling by  100
Scaled Norm after poisoning: 567.8989786925135, distance: 568.6177318726527
Total norm for 4 adversaries is: 567.8989786925135. distance: 568.6177318726527
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   1,  Average loss: 0.0038, Accuracy: 509/546 (93.2234%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   2,  Average loss: 0.0030, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   3,  Average loss: 0.0023, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   4,  Average loss: 0.0012, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.64643933403596.
Norm before scaling: 37.70172144351883. Distance: 5.448692290877148
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.2199, Accuracy: 6358/10000 (63.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.0982, Accuracy: 8805/9000 (97.8333%)
Scaling by  100
Scaled Norm after poisoning: 543.8266612625755, distance: 544.8692503711326
Total norm for 4 adversaries is: 543.8266612625755. distance: 544.8692503711326
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 227, local model 23, internal_epoch   1,  Average loss: 0.0040, Accuracy: 226/248 (91.1290%)
___Train Local_ResNet_18,  epoch 227, local model 23, internal_epoch   2,  Average loss: 0.0010, Accuracy: 245/248 (98.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 2.3136, Accuracy: 4496/10000 (44.9600%)
___Train Local_ResNet_18,  epoch 227, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 311/349 (89.1117%)
___Train Local_ResNet_18,  epoch 227, local model 34, internal_epoch   2,  Average loss: 0.0018, Accuracy: 339/349 (97.1347%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 4.7381, Accuracy: 3392/10000 (33.9200%)
___Train Local_ResNet_18,  epoch 227, local model 52, internal_epoch   1,  Average loss: 0.0081, Accuracy: 184/214 (85.9813%)
___Train Local_ResNet_18,  epoch 227, local model 52, internal_epoch   2,  Average loss: 0.0020, Accuracy: 208/214 (97.1963%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 3.7957, Accuracy: 3575/10000 (35.7500%)
___Train Local_ResNet_18,  epoch 227, local model 92, internal_epoch   1,  Average loss: 0.0064, Accuracy: 690/796 (86.6834%)
___Train Local_ResNet_18,  epoch 227, local model 92, internal_epoch   2,  Average loss: 0.0094, Accuracy: 658/796 (82.6633%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 6.1213, Accuracy: 2235/10000 (22.3500%)
___Train Local_ResNet_18,  epoch 227, local model 57, internal_epoch   1,  Average loss: 0.0055, Accuracy: 254/290 (87.5862%)
___Train Local_ResNet_18,  epoch 227, local model 57, internal_epoch   2,  Average loss: 0.0009, Accuracy: 286/290 (98.6207%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 3.6618, Accuracy: 4134/10000 (41.3400%)
___Train Local_ResNet_18,  epoch 227, local model 74, internal_epoch   1,  Average loss: 0.0043, Accuracy: 424/469 (90.4051%)
___Train Local_ResNet_18,  epoch 227, local model 74, internal_epoch   2,  Average loss: 0.0024, Accuracy: 450/469 (95.9488%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 3.7718, Accuracy: 3749/10000 (37.4900%)
time spent on training: 315.51173186302185
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4696256444743331  data num: [526, 527, 496, 546, 248, 349, 214, 796, 290, 469]
[foolsgold agg] considering poison per batch poison_fraction: 0.036689503474557274
[foolsgold agg] wv: [1.         0.45097157 0.         0.73996535 1.         1.
 1.         1.         0.         0.89353851]
___Test Target_ResNet_18 poisoned: False, epoch: 227: Average loss: 0.6832, Accuracy: 7752/10000 (77.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 227: Average loss: 4.9639, Accuracy: 973/9000 (10.8111%)
Done in 382.4972219467163 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:228 choose agents : [17, 33, 77, 11, 67, 16, 64, 30, 35, 81]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   3,  Average loss: 0.0026, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   4,  Average loss: 0.0030, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   5,  Average loss: 0.0012, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   6,  Average loss: 0.0015, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Global model norm: 37.64612966961627.
Norm before scaling: 37.80624302570609. Distance: 6.2131531032459675
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.4490, Accuracy: 5736/10000 (57.3600%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.2038, Accuracy: 8534/9000 (94.8222%)
Scaling by  100
Scaled Norm after poisoning: 620.3206580068086, distance: 621.3153134681295
Total norm for 4 adversaries is: 620.3206580068086. distance: 621.3153134681295
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   1,  Average loss: 0.0059, Accuracy: 480/527 (91.0816%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   2,  Average loss: 0.0033, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   3,  Average loss: 0.0030, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   4,  Average loss: 0.0015, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   5,  Average loss: 0.0012, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   6,  Average loss: 0.0014, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Global model norm: 37.64612966961627.
Norm before scaling: 37.98954709491234. Distance: 7.030631754503406
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.4733, Accuracy: 5618/10000 (56.1800%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.2377, Accuracy: 8566/9000 (95.1778%)
Scaling by  100
Scaled Norm after poisoning: 702.4027512759328, distance: 703.063163947593
Total norm for 4 adversaries is: 702.4027512759328. distance: 703.063163947593
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   1,  Average loss: 0.0070, Accuracy: 445/496 (89.7177%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   2,  Average loss: 0.0041, Accuracy: 476/496 (95.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   3,  Average loss: 0.0019, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   4,  Average loss: 0.0008, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.64612966961627.
Norm before scaling: 37.72119173175819. Distance: 5.4360221520674985
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.0333, Accuracy: 6627/10000 (66.2700%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.1444, Accuracy: 8687/9000 (96.5222%)
Scaling by  100
Scaled Norm after poisoning: 542.7072760706272, distance: 543.602135067551
Total norm for 4 adversaries is: 542.7072760706272. distance: 543.602135067551
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   1,  Average loss: 0.0049, Accuracy: 511/546 (93.5897%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   2,  Average loss: 0.0028, Accuracy: 525/546 (96.1538%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   3,  Average loss: 0.0016, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   4,  Average loss: 0.0008, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   5,  Average loss: 0.0006, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.64612966961627.
Norm before scaling: 37.69036155958427. Distance: 5.33667594748426
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.2920, Accuracy: 6180/10000 (61.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.1575, Accuracy: 8687/9000 (96.5222%)
Scaling by  100
Scaled Norm after poisoning: 532.6383329708818, distance: 533.6676165929501
Total norm for 4 adversaries is: 532.6383329708818. distance: 533.6676165929501
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 228, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 777/842 (92.2803%)
___Train Local_ResNet_18,  epoch 228, local model 67, internal_epoch   2,  Average loss: 0.0177, Accuracy: 601/842 (71.3777%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 86.6759, Accuracy: 1013/10000 (10.1300%)
___Train Local_ResNet_18,  epoch 228, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 708/773 (91.5912%)
___Train Local_ResNet_18,  epoch 228, local model 16, internal_epoch   2,  Average loss: 0.0186, Accuracy: 574/773 (74.2561%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 5.5837, Accuracy: 3240/10000 (32.4000%)
___Train Local_ResNet_18,  epoch 228, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 623/686 (90.8163%)
___Train Local_ResNet_18,  epoch 228, local model 64, internal_epoch   2,  Average loss: 0.0039, Accuracy: 633/686 (92.2741%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 2.7404, Accuracy: 4374/10000 (43.7400%)
___Train Local_ResNet_18,  epoch 228, local model 30, internal_epoch   1,  Average loss: 0.0048, Accuracy: 305/337 (90.5045%)
___Train Local_ResNet_18,  epoch 228, local model 30, internal_epoch   2,  Average loss: 0.0028, Accuracy: 318/337 (94.3620%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 3.5229, Accuracy: 3672/10000 (36.7200%)
___Train Local_ResNet_18,  epoch 228, local model 35, internal_epoch   1,  Average loss: 0.0065, Accuracy: 367/419 (87.5895%)
___Train Local_ResNet_18,  epoch 228, local model 35, internal_epoch   2,  Average loss: 0.0026, Accuracy: 400/419 (95.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 4.4123, Accuracy: 3002/10000 (30.0200%)
___Train Local_ResNet_18,  epoch 228, local model 81, internal_epoch   1,  Average loss: 0.0076, Accuracy: 894/1034 (86.4603%)
___Train Local_ResNet_18,  epoch 228, local model 81, internal_epoch   2,  Average loss: 0.0073, Accuracy: 881/1034 (85.2031%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 13.1472, Accuracy: 1707/10000 (17.0700%)
time spent on training: 351.7221522331238
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.338667959909473  data num: [526, 527, 496, 546, 842, 773, 686, 337, 419, 1034]
[foolsgold agg] considering poison per batch poison_fraction: 0.02645843436792758
[foolsgold agg] wv: [0.76167451 0.14700611 0.14700611 0.72091666 0.96609626 0.96609626
 0.1561882  1.         0.1561882  1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 228: Average loss: 0.6826, Accuracy: 7751/10000 (77.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 228: Average loss: 4.8877, Accuracy: 1028/9000 (11.4222%)
Done in 422.33908224105835 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:229 choose agents : [17, 33, 77, 11, 62, 68, 2, 74, 39, 1]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   3,  Average loss: 0.0030, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   4,  Average loss: 0.0019, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   5,  Average loss: 0.0017, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   6,  Average loss: 0.0030, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Global model norm: 37.64600320906839.
Norm before scaling: 38.03950454790388. Distance: 7.3727162591436946
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.6921, Accuracy: 5101/10000 (51.0100%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.2235, Accuracy: 8612/9000 (95.6889%)
Scaling by  100
Scaled Norm after poisoning: 736.5658066323741, distance: 737.2716595665399
Total norm for 4 adversaries is: 736.5658066323741. distance: 737.2716595665399
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   1,  Average loss: 0.0070, Accuracy: 472/527 (89.5636%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 497/527 (94.3074%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   3,  Average loss: 0.0021, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   4,  Average loss: 0.0010, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   5,  Average loss: 0.0014, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   6,  Average loss: 0.0028, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Global model norm: 37.64600320906839.
Norm before scaling: 38.149451047615024. Distance: 7.799073912590069
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 2.0937, Accuracy: 4742/10000 (47.4200%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.1804, Accuracy: 8680/9000 (96.4444%)
Scaling by  100
Scaled Norm after poisoning: 779.3626402388044, distance: 779.9074063630887
Total norm for 4 adversaries is: 779.3626402388044. distance: 779.9074063630887
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   1,  Average loss: 0.0070, Accuracy: 450/496 (90.7258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 465/496 (93.7500%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   3,  Average loss: 0.0019, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   4,  Average loss: 0.0010, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   5,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.64600320906839.
Norm before scaling: 37.78018053180298. Distance: 5.693469593165558
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.0382, Accuracy: 6700/10000 (67.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.1529, Accuracy: 8682/9000 (96.4667%)
Scaling by  100
Scaled Norm after poisoning: 568.6331473366638, distance: 569.3470492590614
Total norm for 4 adversaries is: 568.6331473366638. distance: 569.3470492590614
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   1,  Average loss: 0.0047, Accuracy: 506/546 (92.6740%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   2,  Average loss: 0.0038, Accuracy: 519/546 (95.0549%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   3,  Average loss: 0.0018, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   4,  Average loss: 0.0008, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.64600320906839.
Norm before scaling: 37.7389991343711. Distance: 5.6715800731474335
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.2525, Accuracy: 6260/10000 (62.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.0519, Accuracy: 8862/9000 (98.4667%)
Scaling by  100
Scaled Norm after poisoning: 566.1887660047663, distance: 567.1579641070026
Total norm for 4 adversaries is: 566.1887660047663. distance: 567.1579641070026
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 229, local model 62, internal_epoch   1,  Average loss: 0.0022, Accuracy: 346/358 (96.6480%)
___Train Local_ResNet_18,  epoch 229, local model 62, internal_epoch   2,  Average loss: 0.0010, Accuracy: 353/358 (98.6034%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.0914, Accuracy: 6733/10000 (67.3300%)
___Train Local_ResNet_18,  epoch 229, local model 68, internal_epoch   1,  Average loss: 0.0025, Accuracy: 400/416 (96.1538%)
___Train Local_ResNet_18,  epoch 229, local model 68, internal_epoch   2,  Average loss: 0.0009, Accuracy: 412/416 (99.0385%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.4100, Accuracy: 6131/10000 (61.3100%)
___Train Local_ResNet_18,  epoch 229, local model 2, internal_epoch   1,  Average loss: 0.0089, Accuracy: 384/461 (83.2972%)
___Train Local_ResNet_18,  epoch 229, local model 2, internal_epoch   2,  Average loss: 0.0143, Accuracy: 377/461 (81.7787%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 76.9649, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 229, local model 74, internal_epoch   1,  Average loss: 0.0039, Accuracy: 433/469 (92.3241%)
___Train Local_ResNet_18,  epoch 229, local model 74, internal_epoch   2,  Average loss: 0.0026, Accuracy: 443/469 (94.4563%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 2.5189, Accuracy: 4657/10000 (46.5700%)
___Train Local_ResNet_18,  epoch 229, local model 39, internal_epoch   1,  Average loss: 0.0076, Accuracy: 185/217 (85.2535%)
___Train Local_ResNet_18,  epoch 229, local model 39, internal_epoch   2,  Average loss: 0.0019, Accuracy: 211/217 (97.2350%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 3.9210, Accuracy: 3306/10000 (33.0600%)
___Train Local_ResNet_18,  epoch 229, local model 1, internal_epoch   1,  Average loss: 0.0099, Accuracy: 592/641 (92.3557%)
___Train Local_ResNet_18,  epoch 229, local model 1, internal_epoch   2,  Average loss: 0.0118, Accuracy: 524/641 (81.7473%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 5.0055, Accuracy: 2780/10000 (27.8000%)
time spent on training: 325.7505798339844
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.44986042516641617  data num: [526, 527, 496, 546, 358, 416, 461, 469, 217, 641]
[foolsgold agg] considering poison per batch poison_fraction: 0.035145345716126264
[foolsgold agg] wv: [1.         0.90410554 0.90410554 1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 229: Average loss: 0.6786, Accuracy: 7761/10000 (77.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 229: Average loss: 4.7317, Accuracy: 1183/9000 (13.1444%)
Done in 413.9590530395508 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:230 choose agents : [17, 33, 77, 11, 64, 29, 21, 39, 95, 90]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   1,  Average loss: 0.0036, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   3,  Average loss: 0.0028, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   4,  Average loss: 0.0011, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   5,  Average loss: 0.0013, Accuracy: 522/526 (99.2395%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   6,  Average loss: 0.0007, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Global model norm: 37.64596916192522.
Norm before scaling: 37.9093091819971. Distance: 6.639891675961729
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.5467, Accuracy: 5442/10000 (54.4200%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.0693, Accuracy: 8814/9000 (97.9333%)
Scaling by  100
Scaled Norm after poisoning: 663.2342864704749, distance: 663.9892694916085
Total norm for 4 adversaries is: 663.2342864704749. distance: 663.9892694916085
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   1,  Average loss: 0.0084, Accuracy: 474/527 (89.9431%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   2,  Average loss: 0.0054, Accuracy: 492/527 (93.3586%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   3,  Average loss: 0.0042, Accuracy: 495/527 (93.9279%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   4,  Average loss: 0.0027, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   5,  Average loss: 0.0034, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   6,  Average loss: 0.0021, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 37.64596916192522.
Norm before scaling: 38.76968848362323. Distance: 10.118023010867168
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 2.0857, Accuracy: 4472/10000 (44.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.1598, Accuracy: 8685/9000 (96.5000%)
Scaling by  100
Scaled Norm after poisoning: 1011.6871119570517, distance: 1011.8023831262703
Total norm for 4 adversaries is: 1011.6871119570517. distance: 1011.8023831262703
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 452/496 (91.1290%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 476/496 (95.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   3,  Average loss: 0.0025, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   4,  Average loss: 0.0015, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   5,  Average loss: 0.0007, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.64596916192522.
Norm before scaling: 37.7476458289123. Distance: 5.434141503045542
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 0.9850, Accuracy: 6809/10000 (68.0900%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.2005, Accuracy: 8578/9000 (95.3111%)
Scaling by  100
Scaled Norm after poisoning: 542.7059516902316, distance: 543.4141491532954
Total norm for 4 adversaries is: 542.7059516902316. distance: 543.4141491532954
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   1,  Average loss: 0.0043, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   2,  Average loss: 0.0023, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   3,  Average loss: 0.0012, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.64596916192522.
Norm before scaling: 37.63215158621431. Distance: 5.003801998389516
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.2000, Accuracy: 6439/10000 (64.3900%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.1568, Accuracy: 8691/9000 (96.5667%)
Scaling by  100
Scaled Norm after poisoning: 499.189139380055, distance: 500.3801835854414
Total norm for 4 adversaries is: 499.189139380055. distance: 500.3801835854414
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 230, local model 64, internal_epoch   1,  Average loss: 0.0051, Accuracy: 608/686 (88.6297%)
___Train Local_ResNet_18,  epoch 230, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 597/686 (87.0262%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 3.6699, Accuracy: 3915/10000 (39.1500%)
___Train Local_ResNet_18,  epoch 230, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 772/848 (91.0377%)
___Train Local_ResNet_18,  epoch 230, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 799/848 (94.2217%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 5.0669, Accuracy: 3187/10000 (31.8700%)
___Train Local_ResNet_18,  epoch 230, local model 21, internal_epoch   1,  Average loss: 0.0041, Accuracy: 239/262 (91.2214%)
___Train Local_ResNet_18,  epoch 230, local model 21, internal_epoch   2,  Average loss: 0.0033, Accuracy: 258/262 (98.4733%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 3.4773, Accuracy: 3745/10000 (37.4500%)
___Train Local_ResNet_18,  epoch 230, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 191/217 (88.0184%)
___Train Local_ResNet_18,  epoch 230, local model 39, internal_epoch   2,  Average loss: 0.0012, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 2.8148, Accuracy: 4283/10000 (42.8300%)
___Train Local_ResNet_18,  epoch 230, local model 95, internal_epoch   1,  Average loss: 0.0086, Accuracy: 466/569 (81.8981%)
___Train Local_ResNet_18,  epoch 230, local model 95, internal_epoch   2,  Average loss: 0.0069, Accuracy: 496/569 (87.1705%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 5.2990, Accuracy: 2383/10000 (23.8300%)
___Train Local_ResNet_18,  epoch 230, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 519/578 (89.7924%)
___Train Local_ResNet_18,  epoch 230, local model 90, internal_epoch   2,  Average loss: 0.0034, Accuracy: 538/578 (93.0796%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 7.7205, Accuracy: 1918/10000 (19.1800%)
time spent on training: 323.73468232154846
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.39866793529971456  data num: [526, 527, 496, 546, 686, 848, 262, 217, 569, 578]
[foolsgold agg] considering poison per batch poison_fraction: 0.0311459324452902
[foolsgold agg] wv: [0.76952204 0.12464835 0.12464835 0.6885099  1.         0.35303251
 1.         0.72005405 0.57481956 0.35303251]
___Test Target_ResNet_18 poisoned: False, epoch: 230: Average loss: 0.6780, Accuracy: 7764/10000 (77.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 230: Average loss: 4.6542, Accuracy: 1267/9000 (14.0778%)
Done in 399.70876455307007 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:231 choose agents : [17, 33, 77, 11, 68, 38, 97, 3, 98, 90]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 489/526 (92.9658%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   3,  Average loss: 0.0036, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   4,  Average loss: 0.0030, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   5,  Average loss: 0.0020, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   6,  Average loss: 0.0027, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Global model norm: 37.645229844936864.
Norm before scaling: 38.29607971685467. Distance: 8.3383048931549
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.7618, Accuracy: 5033/10000 (50.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.2713, Accuracy: 8472/9000 (94.1333%)
Scaling by  100
Scaled Norm after poisoning: 833.4748796454516, distance: 833.8304683807135
Total norm for 4 adversaries is: 833.4748796454516. distance: 833.8304683807135
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   1,  Average loss: 0.0059, Accuracy: 474/527 (89.9431%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   2,  Average loss: 0.0028, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   3,  Average loss: 0.0024, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   4,  Average loss: 0.0011, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   5,  Average loss: 0.0016, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   6,  Average loss: 0.0020, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Global model norm: 37.645229844936864.
Norm before scaling: 38.119177001522964. Distance: 7.560790317945181
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 2.7304, Accuracy: 3968/10000 (39.6800%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.4249, Accuracy: 8274/9000 (91.9333%)
Scaling by  100
Scaled Norm after poisoning: 755.6103906776295, distance: 756.0790715923831
Total norm for 4 adversaries is: 755.6103906776295. distance: 756.0790715923831
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 453/496 (91.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   3,  Average loss: 0.0019, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   4,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.645229844936864.
Norm before scaling: 37.73894576354446. Distance: 5.301656090011208
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 0.9566, Accuracy: 6956/10000 (69.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.2077, Accuracy: 8602/9000 (95.5778%)
Scaling by  100
Scaled Norm after poisoning: 529.5171444344367, distance: 530.1655696572534
Total norm for 4 adversaries is: 529.5171444344367. distance: 530.1655696572534
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   1,  Average loss: 0.0042, Accuracy: 520/546 (95.2381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   2,  Average loss: 0.0037, Accuracy: 522/546 (95.6044%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   3,  Average loss: 0.0017, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   4,  Average loss: 0.0014, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.645229844936864.
Norm before scaling: 37.6442051535243. Distance: 5.068387599271125
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.2593, Accuracy: 6333/10000 (63.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.1638, Accuracy: 8690/9000 (96.5556%)
Scaling by  100
Scaled Norm after poisoning: 505.6937685002654, distance: 506.8387317480778
Total norm for 4 adversaries is: 505.6937685002654. distance: 506.8387317480778
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 231, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 399/416 (95.9135%)
___Train Local_ResNet_18,  epoch 231, local model 68, internal_epoch   2,  Average loss: 0.0008, Accuracy: 413/416 (99.2788%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.3916, Accuracy: 6133/10000 (61.3300%)
___Train Local_ResNet_18,  epoch 231, local model 38, internal_epoch   1,  Average loss: 0.0039, Accuracy: 702/756 (92.8571%)
___Train Local_ResNet_18,  epoch 231, local model 38, internal_epoch   2,  Average loss: 0.0052, Accuracy: 688/756 (91.0053%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 3.1757, Accuracy: 3824/10000 (38.2400%)
___Train Local_ResNet_18,  epoch 231, local model 97, internal_epoch   1,  Average loss: 0.0027, Accuracy: 393/418 (94.0191%)
___Train Local_ResNet_18,  epoch 231, local model 97, internal_epoch   2,  Average loss: 0.0021, Accuracy: 401/418 (95.9330%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 2.6039, Accuracy: 4824/10000 (48.2400%)
___Train Local_ResNet_18,  epoch 231, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 689/780 (88.3333%)
___Train Local_ResNet_18,  epoch 231, local model 3, internal_epoch   2,  Average loss: 0.0089, Accuracy: 659/780 (84.4872%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 4.3736, Accuracy: 3135/10000 (31.3500%)
___Train Local_ResNet_18,  epoch 231, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 730/802 (91.0224%)
___Train Local_ResNet_18,  epoch 231, local model 98, internal_epoch   2,  Average loss: 0.0077, Accuracy: 686/802 (85.5362%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 4.6119, Accuracy: 3309/10000 (33.0900%)
___Train Local_ResNet_18,  epoch 231, local model 90, internal_epoch   1,  Average loss: 0.0118, Accuracy: 512/578 (88.5813%)
___Train Local_ResNet_18,  epoch 231, local model 90, internal_epoch   2,  Average loss: 0.0182, Accuracy: 395/578 (68.3391%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1797.4672, Accuracy: 1125/10000 (11.2500%)
time spent on training: 367.4012863636017
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.358426005132592  data num: [526, 527, 496, 546, 416, 756, 418, 780, 802, 578]
[foolsgold agg] considering poison per batch poison_fraction: 0.02800203165098375
[foolsgold agg] wv: [0.57236355 0.         0.         0.55393076 1.         0.77203643
 0.77203643 1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 231: Average loss: 0.6776, Accuracy: 7768/10000 (77.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 231: Average loss: 4.6302, Accuracy: 1297/9000 (14.4111%)
Done in 455.3153603076935 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:232 choose agents : [17, 33, 77, 11, 88, 25, 27, 56, 93, 42]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   2,  Average loss: 0.0028, Accuracy: 508/526 (96.5779%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   3,  Average loss: 0.0028, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   4,  Average loss: 0.0016, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   5,  Average loss: 0.0012, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   6,  Average loss: 0.0009, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Global model norm: 37.64531901771205.
Norm before scaling: 37.82914309606831. Distance: 6.155770684961395
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.4384, Accuracy: 5915/10000 (59.1500%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.3427, Accuracy: 8472/9000 (94.1333%)
Scaling by  100
Scaled Norm after poisoning: 614.7766108514539, distance: 615.5770158964676
Total norm for 4 adversaries is: 614.7766108514539. distance: 615.5770158964676
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   1,  Average loss: 0.0074, Accuracy: 479/527 (90.8918%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 494/527 (93.7381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   3,  Average loss: 0.0051, Accuracy: 494/527 (93.7381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   4,  Average loss: 0.0050, Accuracy: 494/527 (93.7381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   5,  Average loss: 0.0035, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   6,  Average loss: 0.0028, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Global model norm: 37.64531901771205.
Norm before scaling: 38.804705588127455. Distance: 10.218088857745618
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 2.1190, Accuracy: 4558/10000 (45.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.3144, Accuracy: 8279/9000 (91.9889%)
Scaling by  100
Scaled Norm after poisoning: 1021.7305173087472, distance: 1021.8088128412281
Total norm for 4 adversaries is: 1021.7305173087472. distance: 1021.8088128412281
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 449/496 (90.5242%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   2,  Average loss: 0.0034, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   3,  Average loss: 0.0017, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   4,  Average loss: 0.0009, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Global model norm: 37.64531901771205.
Norm before scaling: 37.778098051421445. Distance: 5.518325965636018
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 0.9908, Accuracy: 6821/10000 (68.2100%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.3450, Accuracy: 8404/9000 (93.3778%)
Scaling by  100
Scaled Norm after poisoning: 551.2645406245535, distance: 551.832571981756
Total norm for 4 adversaries is: 551.2645406245535. distance: 551.832571981756
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   1,  Average loss: 0.0050, Accuracy: 512/546 (93.7729%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   2,  Average loss: 0.0028, Accuracy: 525/546 (96.1538%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   3,  Average loss: 0.0013, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   4,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.64531901771205.
Norm before scaling: 37.63858506821823. Distance: 5.065249602935581
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.1696, Accuracy: 6549/10000 (65.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.1668, Accuracy: 8647/9000 (96.0778%)
Scaling by  100
Scaled Norm after poisoning: 505.33987634561356, distance: 506.52495619663205
Total norm for 4 adversaries is: 505.33987634561356. distance: 506.52495619663205
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 232, local model 88, internal_epoch   1,  Average loss: 0.0073, Accuracy: 375/447 (83.8926%)
___Train Local_ResNet_18,  epoch 232, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 405/447 (90.6040%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 5.9363, Accuracy: 2326/10000 (23.2600%)
___Train Local_ResNet_18,  epoch 232, local model 25, internal_epoch   1,  Average loss: 0.0034, Accuracy: 513/545 (94.1284%)
___Train Local_ResNet_18,  epoch 232, local model 25, internal_epoch   2,  Average loss: 0.0018, Accuracy: 521/545 (95.5963%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 4.3903, Accuracy: 3374/10000 (33.7400%)
___Train Local_ResNet_18,  epoch 232, local model 27, internal_epoch   1,  Average loss: 0.0020, Accuracy: 384/397 (96.7254%)
___Train Local_ResNet_18,  epoch 232, local model 27, internal_epoch   2,  Average loss: 0.0007, Accuracy: 395/397 (99.4962%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.6706, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 232, local model 56, internal_epoch   1,  Average loss: 0.0020, Accuracy: 722/743 (97.1736%)
___Train Local_ResNet_18,  epoch 232, local model 56, internal_epoch   2,  Average loss: 0.0011, Accuracy: 732/743 (98.5195%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.3646, Accuracy: 6336/10000 (63.3600%)
___Train Local_ResNet_18,  epoch 232, local model 93, internal_epoch   1,  Average loss: 0.0028, Accuracy: 555/584 (95.0342%)
___Train Local_ResNet_18,  epoch 232, local model 93, internal_epoch   2,  Average loss: 0.0034, Accuracy: 546/584 (93.4932%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 3.9399, Accuracy: 3528/10000 (35.2800%)
___Train Local_ResNet_18,  epoch 232, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 177/198 (89.3939%)
___Train Local_ResNet_18,  epoch 232, local model 42, internal_epoch   2,  Average loss: 0.0005, Accuracy: 198/198 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 3.3752, Accuracy: 3594/10000 (35.9400%)
time spent on training: 317.22045135498047
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4182471551207826  data num: [526, 527, 496, 546, 447, 545, 397, 743, 584, 198]
[foolsgold agg] considering poison per batch poison_fraction: 0.03267555899381114
[foolsgold agg] wv: [0.89087946 0.19283886 0.19283886 0.81289861 1.         0.
 1.         1.         1.         0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 232: Average loss: 0.6771, Accuracy: 7774/10000 (77.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 232: Average loss: 4.5396, Accuracy: 1380/9000 (15.3333%)
Done in 398.8201141357422 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:233 choose agents : [17, 33, 77, 11, 18, 66, 27, 82, 86, 67]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 495/526 (94.1065%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   3,  Average loss: 0.0026, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   4,  Average loss: 0.0025, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   5,  Average loss: 0.0013, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   6,  Average loss: 0.0010, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Global model norm: 37.64458455201425.
Norm before scaling: 37.81625917522531. Distance: 6.266412775835026
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.5083, Accuracy: 5480/10000 (54.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.1234, Accuracy: 8744/9000 (97.1556%)
Scaling by  100
Scaled Norm after poisoning: 625.6717390133583, distance: 626.641319855306
Total norm for 4 adversaries is: 625.6717390133583. distance: 626.641319855306
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   1,  Average loss: 0.0078, Accuracy: 475/527 (90.1328%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   3,  Average loss: 0.0029, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   4,  Average loss: 0.0020, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   5,  Average loss: 0.0021, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   6,  Average loss: 0.0016, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Global model norm: 37.64458455201425.
Norm before scaling: 38.19796105181041. Distance: 7.961887890629897
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.8879, Accuracy: 4975/10000 (49.7500%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.0980, Accuracy: 8767/9000 (97.4111%)
Scaling by  100
Scaled Norm after poisoning: 795.7333488675713, distance: 796.1887731562158
Total norm for 4 adversaries is: 795.7333488675713. distance: 796.1887731562158
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   1,  Average loss: 0.0062, Accuracy: 454/496 (91.5323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   2,  Average loss: 0.0036, Accuracy: 473/496 (95.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   3,  Average loss: 0.0020, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   4,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.64458455201425.
Norm before scaling: 37.70891351130559. Distance: 5.336240433098838
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.0058, Accuracy: 6765/10000 (67.6500%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.1479, Accuracy: 8683/9000 (96.4778%)
Scaling by  100
Scaled Norm after poisoning: 532.7372124227854, distance: 533.6240483711356
Total norm for 4 adversaries is: 532.7372124227854. distance: 533.6240483711356
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   1,  Average loss: 0.0049, Accuracy: 516/546 (94.5055%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   2,  Average loss: 0.0038, Accuracy: 520/546 (95.2381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   3,  Average loss: 0.0021, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   4,  Average loss: 0.0014, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   5,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.64458455201425.
Norm before scaling: 37.662820355217356. Distance: 5.290632231922017
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.3483, Accuracy: 6010/10000 (60.1000%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.1952, Accuracy: 8619/9000 (95.7667%)
Scaling by  100
Scaled Norm after poisoning: 527.8855818262135, distance: 529.0632051088036
Total norm for 4 adversaries is: 527.8855818262135. distance: 529.0632051088036
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 233, local model 18, internal_epoch   1,  Average loss: 0.0027, Accuracy: 366/386 (94.8187%)
___Train Local_ResNet_18,  epoch 233, local model 18, internal_epoch   2,  Average loss: 0.0016, Accuracy: 376/386 (97.4093%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.9222, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 233, local model 66, internal_epoch   1,  Average loss: 0.0025, Accuracy: 529/555 (95.3153%)
___Train Local_ResNet_18,  epoch 233, local model 66, internal_epoch   2,  Average loss: 0.0009, Accuracy: 546/555 (98.3784%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 3.3573, Accuracy: 4145/10000 (41.4500%)
___Train Local_ResNet_18,  epoch 233, local model 27, internal_epoch   1,  Average loss: 0.0019, Accuracy: 383/397 (96.4736%)
___Train Local_ResNet_18,  epoch 233, local model 27, internal_epoch   2,  Average loss: 0.0005, Accuracy: 395/397 (99.4962%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.4833, Accuracy: 5985/10000 (59.8500%)
___Train Local_ResNet_18,  epoch 233, local model 82, internal_epoch   1,  Average loss: 0.0040, Accuracy: 574/601 (95.5075%)
___Train Local_ResNet_18,  epoch 233, local model 82, internal_epoch   2,  Average loss: 0.0040, Accuracy: 552/601 (91.8469%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 5.6865, Accuracy: 3167/10000 (31.6700%)
___Train Local_ResNet_18,  epoch 233, local model 86, internal_epoch   1,  Average loss: 0.0035, Accuracy: 200/212 (94.3396%)
___Train Local_ResNet_18,  epoch 233, local model 86, internal_epoch   2,  Average loss: 0.0008, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.4032, Accuracy: 6390/10000 (63.9000%)
___Train Local_ResNet_18,  epoch 233, local model 67, internal_epoch   1,  Average loss: 0.0056, Accuracy: 773/842 (91.8052%)
___Train Local_ResNet_18,  epoch 233, local model 67, internal_epoch   2,  Average loss: 0.0125, Accuracy: 682/842 (80.9976%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 16.7478, Accuracy: 2046/10000 (20.4600%)
time spent on training: 319.10098791122437
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4117531446540881  data num: [526, 527, 496, 546, 386, 555, 397, 601, 212, 842]
[foolsgold agg] considering poison per batch poison_fraction: 0.03216821442610063
[foolsgold agg] wv: [0.76646732 0.06926632 0.06926632 0.66827974 1.         1.
 0.47009041 0.47009041 1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 233: Average loss: 0.6764, Accuracy: 7780/10000 (77.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 233: Average loss: 4.4802, Accuracy: 1437/9000 (15.9667%)
Done in 406.2529101371765 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:234 choose agents : [17, 33, 77, 11, 38, 29, 30, 96, 0, 3]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   1,  Average loss: 0.0035, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   3,  Average loss: 0.0019, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   4,  Average loss: 0.0013, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   5,  Average loss: 0.0017, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   6,  Average loss: 0.0019, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Global model norm: 37.643756031566014.
Norm before scaling: 37.97413638490924. Distance: 7.026699373771121
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.5433, Accuracy: 5384/10000 (53.8400%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.1039, Accuracy: 8789/9000 (97.6556%)
Scaling by  100
Scaled Norm after poisoning: 701.9423275811197, distance: 702.6699082784178
Total norm for 4 adversaries is: 701.9423275811197. distance: 702.6699082784178
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   1,  Average loss: 0.0072, Accuracy: 480/527 (91.0816%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 491/527 (93.1689%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   3,  Average loss: 0.0025, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   4,  Average loss: 0.0013, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   5,  Average loss: 0.0014, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   6,  Average loss: 0.0010, Accuracy: 523/527 (99.2410%), train_poison_data_count: 45
Global model norm: 37.643756031566014.
Norm before scaling: 38.11690808080615. Distance: 7.67496293149067
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.6345, Accuracy: 5403/10000 (54.0300%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.1094, Accuracy: 8774/9000 (97.4889%)
Scaling by  100
Scaled Norm after poisoning: 766.917083197395, distance: 767.4963354961377
Total norm for 4 adversaries is: 766.917083197395. distance: 767.4963354961377
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   1,  Average loss: 0.0062, Accuracy: 453/496 (91.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 468/496 (94.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   3,  Average loss: 0.0019, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 496/496 (100.0000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   5,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   6,  Average loss: 0.0011, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.643756031566014.
Norm before scaling: 37.7568272360071. Distance: 5.5155850590024285
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 0.9818, Accuracy: 6824/10000 (68.2400%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.1207, Accuracy: 8744/9000 (97.1556%)
Scaling by  100
Scaled Norm after poisoning: 550.8577402560484, distance: 551.5585304389734
Total norm for 4 adversaries is: 550.8577402560484. distance: 551.5585304389734
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   1,  Average loss: 0.0043, Accuracy: 515/546 (94.3223%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   2,  Average loss: 0.0035, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   3,  Average loss: 0.0011, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   4,  Average loss: 0.0003, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.643756031566014.
Norm before scaling: 37.61575396411805. Distance: 4.904648440455533
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.1731, Accuracy: 6573/10000 (65.7300%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.1320, Accuracy: 8769/9000 (97.4333%)
Scaling by  100
Scaled Norm after poisoning: 489.2407861932609, distance: 490.4648624009675
Total norm for 4 adversaries is: 489.2407861932609. distance: 490.4648624009675
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 234, local model 38, internal_epoch   1,  Average loss: 0.0020, Accuracy: 728/756 (96.2963%)
___Train Local_ResNet_18,  epoch 234, local model 38, internal_epoch   2,  Average loss: 0.0027, Accuracy: 716/756 (94.7090%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.8756, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 234, local model 29, internal_epoch   1,  Average loss: 0.0060, Accuracy: 760/848 (89.6226%)
___Train Local_ResNet_18,  epoch 234, local model 29, internal_epoch   2,  Average loss: 0.0048, Accuracy: 763/848 (89.9764%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 7.5930, Accuracy: 2340/10000 (23.4000%)
___Train Local_ResNet_18,  epoch 234, local model 30, internal_epoch   1,  Average loss: 0.0053, Accuracy: 302/337 (89.6142%)
___Train Local_ResNet_18,  epoch 234, local model 30, internal_epoch   2,  Average loss: 0.0030, Accuracy: 324/337 (96.1424%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 4.1200, Accuracy: 3407/10000 (34.0700%)
___Train Local_ResNet_18,  epoch 234, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 648/708 (91.5254%)
___Train Local_ResNet_18,  epoch 234, local model 96, internal_epoch   2,  Average loss: 0.0248, Accuracy: 395/708 (55.7910%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 64.2395, Accuracy: 1544/10000 (15.4400%)
___Train Local_ResNet_18,  epoch 234, local model 0, internal_epoch   1,  Average loss: 0.0070, Accuracy: 316/367 (86.1035%)
___Train Local_ResNet_18,  epoch 234, local model 0, internal_epoch   2,  Average loss: 0.0023, Accuracy: 354/367 (96.4578%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 7.4463, Accuracy: 1979/10000 (19.7900%)
___Train Local_ResNet_18,  epoch 234, local model 3, internal_epoch   1,  Average loss: 0.0081, Accuracy: 680/780 (87.1795%)
___Train Local_ResNet_18,  epoch 234, local model 3, internal_epoch   2,  Average loss: 0.0195, Accuracy: 533/780 (68.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 214.6431, Accuracy: 1285/10000 (12.8500%)
time spent on training: 358.9526605606079
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.35562722797487695  data num: [526, 527, 496, 546, 756, 848, 337, 708, 367, 780]
[foolsgold agg] considering poison per batch poison_fraction: 0.02778337718553726
[foolsgold agg] wv: [0.85724647 0.         0.48001055 1.         1.         1.
 1.         1.         0.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 234: Average loss: 0.6741, Accuracy: 7782/10000 (77.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 234: Average loss: 4.3852, Accuracy: 1553/9000 (17.2556%)
Done in 432.03232431411743 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:235 choose agents : [17, 33, 77, 11, 8, 68, 79, 90, 21, 25]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   1,  Average loss: 0.0043, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   2,  Average loss: 0.0028, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   3,  Average loss: 0.0038, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   4,  Average loss: 0.0038, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   5,  Average loss: 0.0035, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   6,  Average loss: 0.0018, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 37.64358092119176.
Norm before scaling: 38.074099923188435. Distance: 7.366174363246899
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.7022, Accuracy: 5311/10000 (53.1100%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.2375, Accuracy: 8471/9000 (94.1222%)
Scaling by  100
Scaled Norm after poisoning: 736.1087300800066, distance: 736.6174804469414
Total norm for 4 adversaries is: 736.1087300800066. distance: 736.6174804469414
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   1,  Average loss: 0.0074, Accuracy: 470/527 (89.1841%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 490/527 (92.9791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   3,  Average loss: 0.0016, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   4,  Average loss: 0.0009, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   5,  Average loss: 0.0016, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   6,  Average loss: 0.0019, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 37.64358092119176.
Norm before scaling: 38.25517606930793. Distance: 8.204317714630367
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.8732, Accuracy: 4946/10000 (49.4600%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.1835, Accuracy: 8673/9000 (96.3667%)
Scaling by  100
Scaled Norm after poisoning: 820.0220271431738, distance: 820.431746094701
Total norm for 4 adversaries is: 820.0220271431738. distance: 820.431746094701
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   1,  Average loss: 0.0050, Accuracy: 456/496 (91.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   2,  Average loss: 0.0036, Accuracy: 478/496 (96.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   3,  Average loss: 0.0014, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   5,  Average loss: 0.0006, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.64358092119176.
Norm before scaling: 37.71142871158225. Distance: 5.119994347390392
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 0.9851, Accuracy: 6893/10000 (68.9300%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.2649, Accuracy: 8492/9000 (94.3556%)
Scaling by  100
Scaled Norm after poisoning: 511.3220609361579, distance: 511.9993743892662
Total norm for 4 adversaries is: 511.3220609361579. distance: 511.9993743892662
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   1,  Average loss: 0.0040, Accuracy: 518/546 (94.8718%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   2,  Average loss: 0.0035, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   3,  Average loss: 0.0014, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   4,  Average loss: 0.0007, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.64358092119176.
Norm before scaling: 37.667336607069956. Distance: 5.1271527118889555
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.2221, Accuracy: 6412/10000 (64.1200%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.1381, Accuracy: 8712/9000 (96.8000%)
Scaling by  100
Scaled Norm after poisoning: 511.7071000582267, distance: 512.7153206214927
Total norm for 4 adversaries is: 511.7071000582267. distance: 512.7153206214927
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 235, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 500/534 (93.6330%)
___Train Local_ResNet_18,  epoch 235, local model 8, internal_epoch   2,  Average loss: 0.0037, Accuracy: 493/534 (92.3221%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 2.2218, Accuracy: 4821/10000 (48.2100%)
___Train Local_ResNet_18,  epoch 235, local model 68, internal_epoch   1,  Average loss: 0.0023, Accuracy: 402/416 (96.6346%)
___Train Local_ResNet_18,  epoch 235, local model 68, internal_epoch   2,  Average loss: 0.0013, Accuracy: 411/416 (98.7981%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.3946, Accuracy: 6247/10000 (62.4700%)
___Train Local_ResNet_18,  epoch 235, local model 79, internal_epoch   1,  Average loss: 0.0086, Accuracy: 132/154 (85.7143%)
___Train Local_ResNet_18,  epoch 235, local model 79, internal_epoch   2,  Average loss: 0.0006, Accuracy: 154/154 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.6831, Accuracy: 5927/10000 (59.2700%)
___Train Local_ResNet_18,  epoch 235, local model 90, internal_epoch   1,  Average loss: 0.0112, Accuracy: 513/578 (88.7543%)
___Train Local_ResNet_18,  epoch 235, local model 90, internal_epoch   2,  Average loss: 0.0123, Accuracy: 482/578 (83.3910%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 32.3813, Accuracy: 2173/10000 (21.7300%)
___Train Local_ResNet_18,  epoch 235, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 246/262 (93.8931%)
___Train Local_ResNet_18,  epoch 235, local model 21, internal_epoch   2,  Average loss: 0.0078, Accuracy: 253/262 (96.5649%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 14.3443, Accuracy: 1438/10000 (14.3800%)
___Train Local_ResNet_18,  epoch 235, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 501/545 (91.9266%)
___Train Local_ResNet_18,  epoch 235, local model 25, internal_epoch   2,  Average loss: 0.0019, Accuracy: 528/545 (96.8807%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 4.8118, Accuracy: 3627/10000 (36.2700%)
time spent on training: 326.1593437194824
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4570244328097731  data num: [526, 527, 496, 546, 534, 416, 154, 578, 262, 545]
[foolsgold agg] considering poison per batch poison_fraction: 0.03570503381326352
[foolsgold agg] wv: [0.79163009 0.04219804 0.04219804 0.62428238 0.6027088  1.
 1.         0.6027088  1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 235: Average loss: 0.6723, Accuracy: 7789/10000 (77.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 235: Average loss: 4.3117, Accuracy: 1635/9000 (18.1667%)
Done in 411.2811608314514 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:236 choose agents : [17, 33, 77, 11, 53, 14, 6, 12, 7, 58]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   3,  Average loss: 0.0028, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   4,  Average loss: 0.0013, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   5,  Average loss: 0.0010, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   6,  Average loss: 0.0008, Accuracy: 521/526 (99.0494%), train_poison_data_count: 45
Global model norm: 37.642674549846014.
Norm before scaling: 37.73434265008965. Distance: 5.686946967768293
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.3506, Accuracy: 5955/10000 (59.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.1191, Accuracy: 8778/9000 (97.5333%)
Scaling by  100
Scaled Norm after poisoning: 567.703762978545, distance: 568.6947225884903
Total norm for 4 adversaries is: 567.703762978545. distance: 568.6947225884903
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   1,  Average loss: 0.0059, Accuracy: 481/527 (91.2713%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   2,  Average loss: 0.0034, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   3,  Average loss: 0.0017, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   4,  Average loss: 0.0018, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   5,  Average loss: 0.0017, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   6,  Average loss: 0.0012, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Global model norm: 37.642674549846014.
Norm before scaling: 38.01519150492668. Distance: 7.244659561572644
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.6717, Accuracy: 5380/10000 (53.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.2198, Accuracy: 8628/9000 (95.8667%)
Scaling by  100
Scaled Norm after poisoning: 723.7663858248737, distance: 724.4659671095668
Total norm for 4 adversaries is: 723.7663858248737. distance: 724.4659671095668
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 462/496 (93.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   2,  Average loss: 0.0022, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   3,  Average loss: 0.0013, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.642674549846014.
Norm before scaling: 37.70054286899842. Distance: 5.100479081035339
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.0212, Accuracy: 6840/10000 (68.4000%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.1471, Accuracy: 8695/9000 (96.6111%)
Scaling by  100
Scaled Norm after poisoning: 509.3136005939759, distance: 510.0478990987023
Total norm for 4 adversaries is: 509.3136005939759. distance: 510.0478990987023
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   1,  Average loss: 0.0051, Accuracy: 516/546 (94.5055%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   2,  Average loss: 0.0031, Accuracy: 525/546 (96.1538%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   3,  Average loss: 0.0018, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   4,  Average loss: 0.0012, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   6,  Average loss: 0.0012, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.642674549846014.
Norm before scaling: 37.66667224805222. Distance: 5.237190058967224
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.1822, Accuracy: 6357/10000 (63.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.1316, Accuracy: 8698/9000 (96.6444%)
Scaling by  100
Scaled Norm after poisoning: 522.6245664910903, distance: 523.7189728279853
Total norm for 4 adversaries is: 522.6245664910903. distance: 523.7189728279853
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 236, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 569/625 (91.0400%)
___Train Local_ResNet_18,  epoch 236, local model 53, internal_epoch   2,  Average loss: 0.0034, Accuracy: 574/625 (91.8400%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 4.0831, Accuracy: 3349/10000 (33.4900%)
___Train Local_ResNet_18,  epoch 236, local model 14, internal_epoch   1,  Average loss: 0.0082, Accuracy: 269/318 (84.5912%)
___Train Local_ResNet_18,  epoch 236, local model 14, internal_epoch   2,  Average loss: 0.0018, Accuracy: 306/318 (96.2264%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 5.8723, Accuracy: 2716/10000 (27.1600%)
___Train Local_ResNet_18,  epoch 236, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 486/520 (93.4615%)
___Train Local_ResNet_18,  epoch 236, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 484/520 (93.0769%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 2.7743, Accuracy: 4080/10000 (40.8000%)
___Train Local_ResNet_18,  epoch 236, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 899/977 (92.0164%)
___Train Local_ResNet_18,  epoch 236, local model 12, internal_epoch   2,  Average loss: 0.0087, Accuracy: 807/977 (82.5998%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 13.4733, Accuracy: 2201/10000 (22.0100%)
___Train Local_ResNet_18,  epoch 236, local model 7, internal_epoch   1,  Average loss: 0.0028, Accuracy: 333/352 (94.6023%)
___Train Local_ResNet_18,  epoch 236, local model 7, internal_epoch   2,  Average loss: 0.0009, Accuracy: 347/352 (98.5795%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 2.4922, Accuracy: 4597/10000 (45.9700%)
___Train Local_ResNet_18,  epoch 236, local model 58, internal_epoch   1,  Average loss: 0.0091, Accuracy: 191/234 (81.6239%)
___Train Local_ResNet_18,  epoch 236, local model 58, internal_epoch   2,  Average loss: 0.0007, Accuracy: 232/234 (99.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 5.4114, Accuracy: 2302/10000 (23.0200%)
time spent on training: 314.0080225467682
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4090997851982035  data num: [526, 527, 496, 546, 625, 318, 520, 977, 352, 234]
[foolsgold agg] considering poison per batch poison_fraction: 0.03196092071860965
[foolsgold agg] wv: [0.8842785  0.11066304 0.11066304 0.7189825  1.         0.50609815
 0.         1.         1.         0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 236: Average loss: 0.6708, Accuracy: 7798/10000 (77.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 236: Average loss: 4.2131, Accuracy: 1740/9000 (19.3333%)
Done in 390.86895203590393 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:237 choose agents : [17, 33, 77, 11, 65, 0, 98, 20, 45, 82]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   1,  Average loss: 0.0036, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   3,  Average loss: 0.0033, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   4,  Average loss: 0.0025, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   5,  Average loss: 0.0015, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   6,  Average loss: 0.0014, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Global model norm: 37.64202110580259.
Norm before scaling: 37.86403867530097. Distance: 6.423834954104762
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.5754, Accuracy: 5606/10000 (56.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.1792, Accuracy: 8612/9000 (95.6889%)
Scaling by  100
Scaled Norm after poisoning: 641.5787899782847, distance: 642.383501111291
Total norm for 4 adversaries is: 641.5787899782847. distance: 642.383501111291
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 480/527 (91.0816%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   2,  Average loss: 0.0031, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   3,  Average loss: 0.0011, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   4,  Average loss: 0.0012, Accuracy: 520/527 (98.6717%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   5,  Average loss: 0.0022, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   6,  Average loss: 0.0019, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Global model norm: 37.64202110580259.
Norm before scaling: 37.90606161072313. Distance: 6.680898384855121
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.6027, Accuracy: 5372/10000 (53.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.1364, Accuracy: 8737/9000 (97.0778%)
Scaling by  100
Scaled Norm after poisoning: 667.3022881348452, distance: 668.0898377089716
Total norm for 4 adversaries is: 667.3022881348452. distance: 668.0898377089716
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   1,  Average loss: 0.0051, Accuracy: 452/496 (91.1290%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   2,  Average loss: 0.0042, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   3,  Average loss: 0.0018, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   4,  Average loss: 0.0011, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.64202110580259.
Norm before scaling: 37.72043932629563. Distance: 5.3253422515201025
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 0.9925, Accuracy: 6788/10000 (67.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.1529, Accuracy: 8675/9000 (96.3889%)
Scaling by  100
Scaled Norm after poisoning: 531.7562881621617, distance: 532.5342418568031
Total norm for 4 adversaries is: 531.7562881621617. distance: 532.5342418568031
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   1,  Average loss: 0.0036, Accuracy: 516/546 (94.5055%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   2,  Average loss: 0.0039, Accuracy: 521/546 (95.4212%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   3,  Average loss: 0.0016, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   4,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.64202110580259.
Norm before scaling: 37.69185460176127. Distance: 5.3296291879345405
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.3584, Accuracy: 6060/10000 (60.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.3600, Accuracy: 8238/9000 (91.5333%)
Scaling by  100
Scaled Norm after poisoning: 531.9786767343218, distance: 532.9629443028849
Total norm for 4 adversaries is: 531.9786767343218. distance: 532.9629443028849
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 237, local model 65, internal_epoch   1,  Average loss: 0.0040, Accuracy: 289/314 (92.0382%)
___Train Local_ResNet_18,  epoch 237, local model 65, internal_epoch   2,  Average loss: 0.0007, Accuracy: 312/314 (99.3631%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 3.6553, Accuracy: 3309/10000 (33.0900%)
___Train Local_ResNet_18,  epoch 237, local model 0, internal_epoch   1,  Average loss: 0.0065, Accuracy: 318/367 (86.6485%)
___Train Local_ResNet_18,  epoch 237, local model 0, internal_epoch   2,  Average loss: 0.0040, Accuracy: 342/367 (93.1880%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 5.0703, Accuracy: 2702/10000 (27.0200%)
___Train Local_ResNet_18,  epoch 237, local model 98, internal_epoch   1,  Average loss: 0.0036, Accuracy: 736/802 (91.7706%)
___Train Local_ResNet_18,  epoch 237, local model 98, internal_epoch   2,  Average loss: 0.0070, Accuracy: 692/802 (86.2843%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 8.1612, Accuracy: 2371/10000 (23.7100%)
___Train Local_ResNet_18,  epoch 237, local model 20, internal_epoch   1,  Average loss: 0.0078, Accuracy: 306/362 (84.5304%)
___Train Local_ResNet_18,  epoch 237, local model 20, internal_epoch   2,  Average loss: 0.0028, Accuracy: 339/362 (93.6464%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 6.0587, Accuracy: 2799/10000 (27.9900%)
___Train Local_ResNet_18,  epoch 237, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 473/529 (89.4140%)
___Train Local_ResNet_18,  epoch 237, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 482/529 (91.1153%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 4.4901, Accuracy: 3137/10000 (31.3700%)
___Train Local_ResNet_18,  epoch 237, local model 82, internal_epoch   1,  Average loss: 0.0022, Accuracy: 576/601 (95.8403%)
___Train Local_ResNet_18,  epoch 237, local model 82, internal_epoch   2,  Average loss: 0.0020, Accuracy: 578/601 (96.1730%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 2.4107, Accuracy: 4771/10000 (47.7100%)
time spent on training: 384.38545417785645
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41321499013806706  data num: [526, 527, 496, 546, 314, 367, 802, 362, 529, 601]
[foolsgold agg] considering poison per batch poison_fraction: 0.03228242110453649
[foolsgold agg] wv: [1.         0.         0.61714166 1.         1.         0.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 237: Average loss: 0.6704, Accuracy: 7802/10000 (78.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 237: Average loss: 4.1129, Accuracy: 1848/9000 (20.5333%)
Done in 461.55701756477356 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:238 choose agents : [17, 33, 77, 11, 88, 46, 85, 42, 29, 8]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   1,  Average loss: 0.0038, Accuracy: 508/526 (96.5779%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   2,  Average loss: 0.0024, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   3,  Average loss: 0.0019, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   4,  Average loss: 0.0011, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   5,  Average loss: 0.0011, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   6,  Average loss: 0.0028, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Global model norm: 37.641750320455344.
Norm before scaling: 37.72161404308709. Distance: 5.531033441646976
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.2942, Accuracy: 6038/10000 (60.3800%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: 0.2048, Accuracy: 8623/9000 (95.8111%)
Scaling by  100
Scaled Norm after poisoning: 552.1620006845817, distance: 553.1033752834998
Total norm for 4 adversaries is: 552.1620006845817. distance: 553.1033752834998
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   1,  Average loss: 0.0080, Accuracy: 476/527 (90.3226%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 487/527 (92.4099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   3,  Average loss: 0.0029, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   4,  Average loss: 0.0019, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   5,  Average loss: 0.0010, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   6,  Average loss: 0.0030, Accuracy: 522/527 (99.0512%), train_poison_data_count: 45
Global model norm: 37.641750320455344.
Norm before scaling: 38.16976112137067. Distance: 7.926130186534077
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.5674, Accuracy: 5390/10000 (53.9000%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: 0.1490, Accuracy: 8672/9000 (96.3556%)
Scaling by  100
Scaled Norm after poisoning: 792.0686917812117, distance: 792.612965134939
Total norm for 4 adversaries is: 792.0686917812117. distance: 792.612965134939
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   1,  Average loss: 0.0037, Accuracy: 468/496 (94.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   2,  Average loss: 0.0036, Accuracy: 477/496 (96.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   3,  Average loss: 0.0017, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   4,  Average loss: 0.0012, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.641750320455344.
Norm before scaling: 37.66989671029193. Distance: 4.811972849324559
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 0.8679, Accuracy: 7244/10000 (72.4400%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: 0.1955, Accuracy: 8641/9000 (96.0111%)
Scaling by  100
Scaled Norm after poisoning: 480.48335038791924, distance: 481.1973510161917
Total norm for 4 adversaries is: 480.48335038791924. distance: 481.1973510161917
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   1,  Average loss: 0.0050, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   2,  Average loss: 0.0037, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   3,  Average loss: 0.0020, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   4,  Average loss: 0.0012, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.641750320455344.
Norm before scaling: 37.62122982564166. Distance: 5.018422330085968
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.2799, Accuracy: 6264/10000 (62.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: 0.2276, Accuracy: 8567/9000 (95.1889%)
Scaling by  100
Scaled Norm after poisoning: 500.58926214512434, distance: 501.8422311842637
Total norm for 4 adversaries is: 500.58926214512434. distance: 501.8422311842637
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 238, local model 88, internal_epoch   1,  Average loss: 0.0066, Accuracy: 385/447 (86.1298%)
___Train Local_ResNet_18,  epoch 238, local model 88, internal_epoch   2,  Average loss: 0.0033, Accuracy: 421/447 (94.1834%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 4.6776, Accuracy: 2990/10000 (29.9000%)
___Train Local_ResNet_18,  epoch 238, local model 46, internal_epoch   1,  Average loss: 0.0013, Accuracy: 590/601 (98.1697%)
___Train Local_ResNet_18,  epoch 238, local model 46, internal_epoch   2,  Average loss: 0.0009, Accuracy: 593/601 (98.6689%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.5979, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 238, local model 85, internal_epoch   1,  Average loss: 0.0067, Accuracy: 310/364 (85.1648%)
___Train Local_ResNet_18,  epoch 238, local model 85, internal_epoch   2,  Average loss: 0.0024, Accuracy: 347/364 (95.3297%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 4.3105, Accuracy: 2860/10000 (28.6000%)
___Train Local_ResNet_18,  epoch 238, local model 42, internal_epoch   1,  Average loss: 0.0077, Accuracy: 182/198 (91.9192%)
___Train Local_ResNet_18,  epoch 238, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 183/198 (92.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 5.8009, Accuracy: 2617/10000 (26.1700%)
___Train Local_ResNet_18,  epoch 238, local model 29, internal_epoch   1,  Average loss: 0.0055, Accuracy: 762/848 (89.8585%)
___Train Local_ResNet_18,  epoch 238, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 772/848 (91.0377%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 6.6257, Accuracy: 2471/10000 (24.7100%)
___Train Local_ResNet_18,  epoch 238, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 499/534 (93.4457%)
___Train Local_ResNet_18,  epoch 238, local model 8, internal_epoch   2,  Average loss: 0.0030, Accuracy: 505/534 (94.5693%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 2.2026, Accuracy: 4574/10000 (45.7400%)
time spent on training: 318.56273436546326
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41183408688814627  data num: [526, 527, 496, 546, 447, 601, 364, 198, 848, 534]
[foolsgold agg] considering poison per batch poison_fraction: 0.03217453803813643
[foolsgold agg] wv: [1.         0.61295486 0.61295486 1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 238: Average loss: 0.6698, Accuracy: 7800/10000 (78.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 238: Average loss: 3.9480, Accuracy: 2050/9000 (22.7778%)
Done in 406.2313549518585 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:239 choose agents : [17, 33, 77, 11, 63, 48, 69, 96, 88, 20]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   2,  Average loss: 0.0036, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   3,  Average loss: 0.0023, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   4,  Average loss: 0.0016, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   5,  Average loss: 0.0014, Accuracy: 520/526 (98.8593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   6,  Average loss: 0.0017, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Global model norm: 37.641495748023054.
Norm before scaling: 37.996283098441026. Distance: 6.939343731546993
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.8944, Accuracy: 5045/10000 (50.4500%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: 0.2829, Accuracy: 8377/9000 (93.0778%)
Scaling by  100
Scaled Norm after poisoning: 693.4189525460059, distance: 693.9343673936319
Total norm for 4 adversaries is: 693.4189525460059. distance: 693.9343673936319
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   1,  Average loss: 0.0066, Accuracy: 475/527 (90.1328%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 491/527 (93.1689%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   3,  Average loss: 0.0034, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   4,  Average loss: 0.0022, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   5,  Average loss: 0.0012, Accuracy: 521/527 (98.8615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   6,  Average loss: 0.0012, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Global model norm: 37.641495748023054.
Norm before scaling: 38.18193430697134. Distance: 7.834767582312041
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.8058, Accuracy: 5215/10000 (52.1500%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: 0.1818, Accuracy: 8681/9000 (96.4556%)
Scaling by  100
Scaled Norm after poisoning: 783.0785401222537, distance: 783.4767865099769
Total norm for 4 adversaries is: 783.0785401222537. distance: 783.4767865099769
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   1,  Average loss: 0.0049, Accuracy: 461/496 (92.9435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   2,  Average loss: 0.0046, Accuracy: 468/496 (94.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   3,  Average loss: 0.0019, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   4,  Average loss: 0.0013, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.641495748023054.
Norm before scaling: 37.72664096466266. Distance: 5.268768911452196
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 0.9680, Accuracy: 6908/10000 (69.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: 0.1555, Accuracy: 8685/9000 (96.5000%)
Scaling by  100
Scaled Norm after poisoning: 526.1956028892678, distance: 526.8768238402597
Total norm for 4 adversaries is: 526.1956028892678. distance: 526.8768238402597
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   1,  Average loss: 0.0033, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   2,  Average loss: 0.0026, Accuracy: 527/546 (96.5201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   3,  Average loss: 0.0014, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   4,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 37.641495748023054.
Norm before scaling: 37.63182234139578. Distance: 4.855560866546248
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.2462, Accuracy: 6465/10000 (64.6500%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: 0.2329, Accuracy: 8595/9000 (95.5000%)
Scaling by  100
Scaled Norm after poisoning: 484.51117440674165, distance: 485.55604401036965
Total norm for 4 adversaries is: 484.51117440674165. distance: 485.55604401036965
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 239, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 703/752 (93.4840%)
___Train Local_ResNet_18,  epoch 239, local model 63, internal_epoch   2,  Average loss: 0.0024, Accuracy: 720/752 (95.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.7664, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 239, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 335/378 (88.6243%)
___Train Local_ResNet_18,  epoch 239, local model 48, internal_epoch   2,  Average loss: 0.0029, Accuracy: 353/378 (93.3862%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 2.6053, Accuracy: 4394/10000 (43.9400%)
___Train Local_ResNet_18,  epoch 239, local model 69, internal_epoch   1,  Average loss: 0.0076, Accuracy: 188/216 (87.0370%)
___Train Local_ResNet_18,  epoch 239, local model 69, internal_epoch   2,  Average loss: 0.0015, Accuracy: 212/216 (98.1481%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 12.0758, Accuracy: 1008/10000 (10.0800%)
___Train Local_ResNet_18,  epoch 239, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 654/708 (92.3729%)
___Train Local_ResNet_18,  epoch 239, local model 96, internal_epoch   2,  Average loss: 0.0058, Accuracy: 615/708 (86.8644%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 4.9384, Accuracy: 3059/10000 (30.5900%)
___Train Local_ResNet_18,  epoch 239, local model 88, internal_epoch   1,  Average loss: 0.0067, Accuracy: 390/447 (87.2483%)
___Train Local_ResNet_18,  epoch 239, local model 88, internal_epoch   2,  Average loss: 0.0022, Accuracy: 428/447 (95.7494%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 3.3609, Accuracy: 3729/10000 (37.2900%)
___Train Local_ResNet_18,  epoch 239, local model 20, internal_epoch   1,  Average loss: 0.0069, Accuracy: 316/362 (87.2928%)
___Train Local_ResNet_18,  epoch 239, local model 20, internal_epoch   2,  Average loss: 0.0021, Accuracy: 350/362 (96.6851%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 5.9398, Accuracy: 2976/10000 (29.7600%)
time spent on training: 334.9306004047394
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4225494150867285  data num: [526, 527, 496, 546, 752, 378, 216, 708, 447, 362]
[foolsgold agg] considering poison per batch poison_fraction: 0.033011673053650666
[foolsgold agg] wv: [0.78557071 0.01869775 0.01869775 0.57221927 1.         0.93764377
 1.         0.93764377 0.99752681 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 239: Average loss: 0.6686, Accuracy: 7805/10000 (78.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 239: Average loss: 3.8937, Accuracy: 2106/9000 (23.4000%)
Done in 421.5133903026581 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:240 choose agents : [17, 33, 77, 11, 71, 51, 95, 80, 24, 55]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   2,  Average loss: 0.0023, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   3,  Average loss: 0.0017, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   4,  Average loss: 0.0019, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   5,  Average loss: 0.0029, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   6,  Average loss: 0.0019, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Global model norm: 37.640981733469374.
Norm before scaling: 37.75689028074048. Distance: 5.751672584414949
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.4050, Accuracy: 5780/10000 (57.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: 0.1796, Accuracy: 8657/9000 (96.1889%)
Scaling by  100
Scaled Norm after poisoning: 574.2821334065687, distance: 575.167339780346
Total norm for 4 adversaries is: 574.2821334065687. distance: 575.167339780346
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 481/527 (91.2713%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   3,  Average loss: 0.0034, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   4,  Average loss: 0.0021, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   5,  Average loss: 0.0021, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   6,  Average loss: 0.0021, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Global model norm: 37.640981733469374.
Norm before scaling: 38.40453998430719. Distance: 8.647539404023588
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.8190, Accuracy: 5303/10000 (53.0300%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: 0.2136, Accuracy: 8617/9000 (95.7444%)
Scaling by  100
Scaled Norm after poisoning: 864.6067747826175, distance: 864.7539389907397
Total norm for 4 adversaries is: 864.6067747826175. distance: 864.7539389907397
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 453/496 (91.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   2,  Average loss: 0.0029, Accuracy: 479/496 (96.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   3,  Average loss: 0.0019, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   4,  Average loss: 0.0010, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.640981733469374.
Norm before scaling: 37.675891208043275. Distance: 4.96610981595268
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 0.9338, Accuracy: 6973/10000 (69.7300%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: 0.2154, Accuracy: 8617/9000 (95.7444%)
Scaling by  100
Scaled Norm after poisoning: 495.8184679144172, distance: 496.610951852655
Total norm for 4 adversaries is: 495.8184679144172. distance: 496.610951852655
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   1,  Average loss: 0.0044, Accuracy: 513/546 (93.9560%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   2,  Average loss: 0.0031, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   3,  Average loss: 0.0018, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   4,  Average loss: 0.0008, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.640981733469374.
Norm before scaling: 37.66234228466397. Distance: 5.166178444385974
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.4335, Accuracy: 6074/10000 (60.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: 0.4919, Accuracy: 8133/9000 (90.3667%)
Scaling by  100
Scaled Norm after poisoning: 515.5606778062113, distance: 516.6178169111089
Total norm for 4 adversaries is: 515.5606778062113. distance: 516.6178169111089
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 240, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 1052/1166 (90.2230%)
___Train Local_ResNet_18,  epoch 240, local model 71, internal_epoch   2,  Average loss: 0.0078, Accuracy: 988/1166 (84.7341%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 3.4065, Accuracy: 3847/10000 (38.4700%)
___Train Local_ResNet_18,  epoch 240, local model 51, internal_epoch   1,  Average loss: 0.0036, Accuracy: 447/479 (93.3194%)
___Train Local_ResNet_18,  epoch 240, local model 51, internal_epoch   2,  Average loss: 0.0014, Accuracy: 467/479 (97.4948%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 3.8914, Accuracy: 3239/10000 (32.3900%)
___Train Local_ResNet_18,  epoch 240, local model 95, internal_epoch   1,  Average loss: 0.0089, Accuracy: 474/569 (83.3040%)
___Train Local_ResNet_18,  epoch 240, local model 95, internal_epoch   2,  Average loss: 0.0051, Accuracy: 517/569 (90.8612%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 9.0976, Accuracy: 1770/10000 (17.7000%)
___Train Local_ResNet_18,  epoch 240, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 319/363 (87.8788%)
___Train Local_ResNet_18,  epoch 240, local model 80, internal_epoch   2,  Average loss: 0.0011, Accuracy: 357/363 (98.3471%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 2.8257, Accuracy: 4334/10000 (43.3400%)
___Train Local_ResNet_18,  epoch 240, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 295/320 (92.1875%)
___Train Local_ResNet_18,  epoch 240, local model 24, internal_epoch   2,  Average loss: 0.0010, Accuracy: 314/320 (98.1250%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 4.2907, Accuracy: 3000/10000 (30.0000%)
___Train Local_ResNet_18,  epoch 240, local model 55, internal_epoch   1,  Average loss: 0.0047, Accuracy: 274/299 (91.6388%)
___Train Local_ResNet_18,  epoch 240, local model 55, internal_epoch   2,  Average loss: 0.0008, Accuracy: 294/299 (98.3278%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 8.2682, Accuracy: 1814/10000 (18.1400%)
time spent on training: 312.9783160686493
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.395955395955396  data num: [526, 527, 496, 546, 1166, 479, 569, 363, 320, 299]
[foolsgold agg] considering poison per batch poison_fraction: 0.03093401530901531
[foolsgold agg] wv: [1. 1. 1. 1. 1. 0. 1. 1. 1. 0.]
___Test Target_ResNet_18 poisoned: False, epoch: 240: Average loss: 0.6695, Accuracy: 7802/10000 (78.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 240: Average loss: 3.7026, Accuracy: 2366/9000 (26.2889%)
Done in 400.3405137062073 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:241 choose agents : [17, 33, 77, 11, 13, 63, 61, 41, 90, 74]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   1,  Average loss: 0.0040, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   3,  Average loss: 0.0034, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   4,  Average loss: 0.0021, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   5,  Average loss: 0.0012, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   6,  Average loss: 0.0018, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Global model norm: 37.641215229909555.
Norm before scaling: 37.83904995070404. Distance: 6.264769536168796
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.3139, Accuracy: 5920/10000 (59.2000%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: 0.1805, Accuracy: 8580/9000 (95.3333%)
Scaling by  100
Scaled Norm after poisoning: 625.6666194947594, distance: 626.4769050012937
Total norm for 4 adversaries is: 625.6666194947594. distance: 626.4769050012937
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   1,  Average loss: 0.0068, Accuracy: 481/527 (91.2713%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   3,  Average loss: 0.0022, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   4,  Average loss: 0.0023, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   5,  Average loss: 0.0018, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   6,  Average loss: 0.0028, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Global model norm: 37.641215229909555.
Norm before scaling: 38.397888316266005. Distance: 8.761717008470624
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.6942, Accuracy: 5200/10000 (52.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: 0.2944, Accuracy: 8385/9000 (93.1667%)
Scaling by  100
Scaled Norm after poisoning: 875.8826976256581, distance: 876.1715728098008
Total norm for 4 adversaries is: 875.8826976256581. distance: 876.1715728098008
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   1,  Average loss: 0.0043, Accuracy: 462/496 (93.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   2,  Average loss: 0.0031, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   3,  Average loss: 0.0019, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   4,  Average loss: 0.0011, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.641215229909555.
Norm before scaling: 37.700168890536816. Distance: 5.145411712218219
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 0.9315, Accuracy: 6977/10000 (69.7700%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: 0.1915, Accuracy: 8630/9000 (95.8889%)
Scaling by  100
Scaled Norm after poisoning: 513.7763983485423, distance: 514.5412094769475
Total norm for 4 adversaries is: 513.7763983485423. distance: 514.5412094769475
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   1,  Average loss: 0.0039, Accuracy: 516/546 (94.5055%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   2,  Average loss: 0.0033, Accuracy: 521/546 (95.4212%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   3,  Average loss: 0.0018, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.641215229909555.
Norm before scaling: 37.588809226970234. Distance: 4.834494725269356
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.2078, Accuracy: 6490/10000 (64.9000%)
