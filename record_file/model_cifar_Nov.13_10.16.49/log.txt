current path: saved_models/model_cifar_Nov.13_10.16.49
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 201
create model done
Poisoned following participants: [17, 33, 77, 11]
We use following environment for graphs:  cifar
----------------------------------Start one training epoch------------------------------------------
Server Epoch:201 choose agents : [17, 33, 77, 11, 37, 53, 39, 57, 63, 48]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   1,  Average loss: 0.0086, Accuracy: 464/526 (88.2129%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   2,  Average loss: 0.0059, Accuracy: 485/526 (92.2053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   3,  Average loss: 0.0026, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   4,  Average loss: 0.0015, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   5,  Average loss: 0.0019, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   6,  Average loss: 0.0017, Accuracy: 515/526 (97.9087%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 38.45603592700046. Distance: 9.068774346727096
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.9530, Accuracy: 4778/10000 (47.7800%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.1937, Accuracy: 8607/9000 (95.6333%)
Scaling by  100
Scaled Norm after poisoning: 906.453046219163, distance: 906.8775068883339
Total norm for 4 adversaries is: 906.453046219163. distance: 906.8775068883339
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   1,  Average loss: 0.0085, Accuracy: 459/527 (87.0968%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   2,  Average loss: 0.0068, Accuracy: 483/527 (91.6509%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   3,  Average loss: 0.0035, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   4,  Average loss: 0.0021, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   5,  Average loss: 0.0021, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   6,  Average loss: 0.0019, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 38.379968377478505. Distance: 8.707673067557419
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.0381, Accuracy: 4807/10000 (48.0700%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.3022, Accuracy: 8529/9000 (94.7667%)
Scaling by  100
Scaled Norm after poisoning: 870.3583672832702, distance: 870.7674775736632
Total norm for 4 adversaries is: 870.3583672832702. distance: 870.7674775736632
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   1,  Average loss: 0.0084, Accuracy: 436/496 (87.9032%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   2,  Average loss: 0.0046, Accuracy: 474/496 (95.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   3,  Average loss: 0.0025, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   4,  Average loss: 0.0014, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.66304237236004.
Norm before scaling: 37.909817948323095. Distance: 6.469074628120273
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.0628, Accuracy: 6600/10000 (66.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.1792, Accuracy: 8617/9000 (95.7444%)
Scaling by  100
Scaled Norm after poisoning: 646.210371125379, distance: 646.9074991836159
Total norm for 4 adversaries is: 646.210371125379. distance: 646.9074991836159
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 488/546 (89.3773%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   2,  Average loss: 0.0047, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   3,  Average loss: 0.0024, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   4,  Average loss: 0.0011, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 37.8856536687207. Distance: 6.543716433492736
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.3552, Accuracy: 6062/10000 (60.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.1211, Accuracy: 8714/9000 (96.8222%)
Scaling by  100
Scaled Norm after poisoning: 653.4680558374679, distance: 654.3717168016967
Total norm for 4 adversaries is: 653.4680558374679. distance: 654.3717168016967
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   1,  Average loss: 0.0112, Accuracy: 584/725 (80.5517%)
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   2,  Average loss: 0.0180, Accuracy: 506/725 (69.7931%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 31.5885, Accuracy: 1063/10000 (10.6300%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   1,  Average loss: 0.0049, Accuracy: 558/625 (89.2800%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   2,  Average loss: 0.0041, Accuracy: 573/625 (91.6800%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.7524, Accuracy: 4161/10000 (41.6100%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   1,  Average loss: 0.0074, Accuracy: 186/217 (85.7143%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   2,  Average loss: 0.0012, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.1664, Accuracy: 3146/10000 (31.4600%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   1,  Average loss: 0.0074, Accuracy: 245/290 (84.4828%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   2,  Average loss: 0.0019, Accuracy: 280/290 (96.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.7453, Accuracy: 2991/10000 (29.9100%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 704/752 (93.6170%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   2,  Average loss: 0.0029, Accuracy: 708/752 (94.1489%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.6979, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   1,  Average loss: 0.0059, Accuracy: 332/378 (87.8307%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   2,  Average loss: 0.0020, Accuracy: 364/378 (96.2963%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 3.6986, Accuracy: 3255/10000 (32.5500%)
time spent on training: 391.00831842422485
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 201: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 480.85607862472534 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:202 choose agents : [17, 33, 77, 11, 63, 50, 39, 72, 88, 71]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   1,  Average loss: 0.0308, Accuracy: 263/526 (50.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   2,  Average loss: 0.0136, Accuracy: 392/526 (74.5247%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   3,  Average loss: 0.0097, Accuracy: 444/526 (84.4106%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   4,  Average loss: 0.0042, Accuracy: 491/526 (93.3460%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   5,  Average loss: 0.0027, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   6,  Average loss: 0.0011, Accuracy: 518/526 (98.4791%), train_poison_data_count: 45
Global model norm: 40.52263696312608.
Norm before scaling: 41.15071948176833. Distance: 8.852376121035597
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.7613, Accuracy: 4280/10000 (42.8000%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.1867, Accuracy: 8616/9000 (95.7333%)
Scaling by  100
Scaled Norm after poisoning: 884.636118695139, distance: 885.2375740443917
Total norm for 4 adversaries is: 884.636118695139. distance: 885.2375740443917
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   1,  Average loss: 0.0292, Accuracy: 272/527 (51.6129%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   2,  Average loss: 0.0131, Accuracy: 386/527 (73.2448%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   3,  Average loss: 0.0062, Accuracy: 472/527 (89.5636%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   4,  Average loss: 0.0044, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   5,  Average loss: 0.0046, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   6,  Average loss: 0.0037, Accuracy: 493/527 (93.5484%), train_poison_data_count: 45
Global model norm: 40.52263696312608.
Norm before scaling: 41.182083352567446. Distance: 8.91248753615012
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.7071, Accuracy: 3631/10000 (36.3100%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.2887, Accuracy: 8356/9000 (92.8444%)
Scaling by  100
Scaled Norm after poisoning: 890.7364228547074, distance: 891.2486676006871
Total norm for 4 adversaries is: 890.7364228547074. distance: 891.2486676006871
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   1,  Average loss: 0.0274, Accuracy: 240/496 (48.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   2,  Average loss: 0.0142, Accuracy: 360/496 (72.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   3,  Average loss: 0.0071, Accuracy: 428/496 (86.2903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   4,  Average loss: 0.0027, Accuracy: 478/496 (96.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   5,  Average loss: 0.0013, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 40.52263696312608.
Norm before scaling: 40.89955451554836. Distance: 7.436363838672317
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.8418, Accuracy: 4658/10000 (46.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.1116, Accuracy: 8710/9000 (96.7778%)
Scaling by  100
Scaled Norm after poisoning: 743.085543527796, distance: 743.6364198988642
Total norm for 4 adversaries is: 743.085543527796. distance: 743.6364198988642
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   1,  Average loss: 0.0331, Accuracy: 226/546 (41.3919%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   2,  Average loss: 0.0183, Accuracy: 343/546 (62.8205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   3,  Average loss: 0.0117, Accuracy: 417/546 (76.3736%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   4,  Average loss: 0.0062, Accuracy: 485/546 (88.8278%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   5,  Average loss: 0.0027, Accuracy: 527/546 (96.5201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   6,  Average loss: 0.0020, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Global model norm: 40.52263696312608.
Norm before scaling: 41.02340551203285. Distance: 8.432745151841033
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.3138, Accuracy: 4256/10000 (42.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.4519, Accuracy: 7863/9000 (87.3667%)
Scaling by  100
Scaled Norm after poisoning: 842.4527805758611, distance: 843.2746068155972
Total norm for 4 adversaries is: 842.4527805758611. distance: 843.2746068155972
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 202, local model 63, internal_epoch   1,  Average loss: 0.0504, Accuracy: 255/752 (33.9096%)
___Train Local_ResNet_18,  epoch 202, local model 63, internal_epoch   2,  Average loss: 0.0257, Accuracy: 335/752 (44.5479%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 5.1893, Accuracy: 1626/10000 (16.2600%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   1,  Average loss: 0.0653, Accuracy: 167/401 (41.6459%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   2,  Average loss: 0.0273, Accuracy: 251/401 (62.5935%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1082.5516, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 202, local model 39, internal_epoch   1,  Average loss: 0.1088, Accuracy: 48/217 (22.1198%)
___Train Local_ResNet_18,  epoch 202, local model 39, internal_epoch   2,  Average loss: 0.0276, Accuracy: 136/217 (62.6728%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 202, local model 72, internal_epoch   1,  Average loss: 0.0462, Accuracy: 321/618 (51.9417%)
___Train Local_ResNet_18,  epoch 202, local model 72, internal_epoch   2,  Average loss: 0.0195, Accuracy: 345/618 (55.8252%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 39.9367, Accuracy: 1368/10000 (13.6800%)
___Train Local_ResNet_18,  epoch 202, local model 88, internal_epoch   1,  Average loss: 0.0609, Accuracy: 176/447 (39.3736%)
___Train Local_ResNet_18,  epoch 202, local model 88, internal_epoch   2,  Average loss: 0.0236, Accuracy: 281/447 (62.8635%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 621.1828, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   1,  Average loss: 0.0362, Accuracy: 643/1166 (55.1458%)
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   2,  Average loss: 0.0165, Accuracy: 796/1166 (68.2676%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.9828, Accuracy: 3333/10000 (33.3300%)
time spent on training: 389.3284795284271
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 202: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 487.4278085231781 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:203 choose agents : [17, 33, 77, 11, 92, 23, 26, 50, 14, 76]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   1,  Average loss: 0.0683, Accuracy: 256/526 (48.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   2,  Average loss: 0.0213, Accuracy: 352/526 (66.9202%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   3,  Average loss: 0.0133, Accuracy: 408/526 (77.5665%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   4,  Average loss: 0.0084, Accuracy: 465/526 (88.4030%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   5,  Average loss: 0.0048, Accuracy: 494/526 (93.9163%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   6,  Average loss: 0.0025, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 45.25616379376543.
Norm before scaling: 45.890446777828934. Distance: 12.005932295258054
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.2732, Accuracy: 4088/10000 (40.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.1621, Accuracy: 8573/9000 (95.2556%)
Scaling by  100
Scaled Norm after poisoning: 1197.8477052613991, distance: 1200.5931346630298
Total norm for 4 adversaries is: 1197.8477052613991. distance: 1200.5931346630298
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   1,  Average loss: 0.0769, Accuracy: 215/527 (40.7970%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   2,  Average loss: 0.0231, Accuracy: 333/527 (63.1879%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   3,  Average loss: 0.0122, Accuracy: 419/527 (79.5066%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   4,  Average loss: 0.0072, Accuracy: 474/527 (89.9431%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   5,  Average loss: 0.0035, Accuracy: 495/527 (93.9279%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   6,  Average loss: 0.0019, Accuracy: 518/527 (98.2922%), train_poison_data_count: 45
Global model norm: 45.25616379376543.
Norm before scaling: 45.926462853505. Distance: 12.0195483882312
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.4309, Accuracy: 3898/10000 (38.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.2770, Accuracy: 8352/9000 (92.8000%)
Scaling by  100
Scaled Norm after poisoning: 1199.3367437879988, distance: 1201.9548660411506
Total norm for 4 adversaries is: 1199.3367437879988. distance: 1201.9548660411506
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   1,  Average loss: 0.0849, Accuracy: 190/496 (38.3065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   2,  Average loss: 0.0268, Accuracy: 291/496 (58.6694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   3,  Average loss: 0.0158, Accuracy: 348/496 (70.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   4,  Average loss: 0.0103, Accuracy: 401/496 (80.8468%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   5,  Average loss: 0.0051, Accuracy: 464/496 (93.5484%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   6,  Average loss: 0.0030, Accuracy: 477/496 (96.1694%), train_poison_data_count: 40
Global model norm: 45.25616379376543.
Norm before scaling: 45.693855897668286. Distance: 11.456853449651735
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.6172, Accuracy: 2635/10000 (26.3500%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.1102, Accuracy: 8699/9000 (96.6556%)
Scaling by  100
Scaled Norm after poisoning: 1142.5837496656427, distance: 1145.6853298353785
Total norm for 4 adversaries is: 1142.5837496656427. distance: 1145.6853298353785
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   1,  Average loss: 0.0546, Accuracy: 264/546 (48.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   2,  Average loss: 0.0198, Accuracy: 345/546 (63.1868%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   3,  Average loss: 0.0097, Accuracy: 444/546 (81.3187%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   4,  Average loss: 0.0047, Accuracy: 519/546 (95.0549%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   5,  Average loss: 0.0039, Accuracy: 525/546 (96.1538%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   6,  Average loss: 0.0017, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Global model norm: 45.25616379376543.
Norm before scaling: 45.695095448492886. Distance: 10.456748528233566
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.3870, Accuracy: 4154/10000 (41.5400%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.2501, Accuracy: 8412/9000 (93.4667%)
Scaling by  100
Scaled Norm after poisoning: 1043.3319821609994, distance: 1045.6748419083249
Total norm for 4 adversaries is: 1043.3319821609994. distance: 1045.6748419083249
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 203, local model 92, internal_epoch   1,  Average loss: 0.0402, Accuracy: 395/796 (49.6231%)
___Train Local_ResNet_18,  epoch 203, local model 92, internal_epoch   2,  Average loss: 0.0194, Accuracy: 488/796 (61.3065%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 203, local model 23, internal_epoch   1,  Average loss: 0.0677, Accuracy: 113/248 (45.5645%)
___Train Local_ResNet_18,  epoch 203, local model 23, internal_epoch   2,  Average loss: 0.0299, Accuracy: 137/248 (55.2419%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 203, local model 26, internal_epoch   1,  Average loss: 0.0922, Accuracy: 141/468 (30.1282%)
___Train Local_ResNet_18,  epoch 203, local model 26, internal_epoch   2,  Average loss: 0.0370, Accuracy: 192/468 (41.0256%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 5.9201, Accuracy: 2393/10000 (23.9300%)
___Train Local_ResNet_18,  epoch 203, local model 50, internal_epoch   1,  Average loss: 0.0558, Accuracy: 215/401 (53.6160%)
___Train Local_ResNet_18,  epoch 203, local model 50, internal_epoch   2,  Average loss: 0.0191, Accuracy: 275/401 (68.5786%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 203, local model 14, internal_epoch   1,  Average loss: 0.1218, Accuracy: 96/318 (30.1887%)
___Train Local_ResNet_18,  epoch 203, local model 14, internal_epoch   2,  Average loss: 0.0329, Accuracy: 215/318 (67.6101%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 203, local model 76, internal_epoch   1,  Average loss: 0.2084, Accuracy: 10/65 (15.3846%)
___Train Local_ResNet_18,  epoch 203, local model 76, internal_epoch   2,  Average loss: 0.1294, Accuracy: 35/65 (53.8462%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 364.12602710723877
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 203: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 477.60131430625916 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:204 choose agents : [17, 33, 77, 11, 49, 86, 26, 58, 6, 94]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   1,  Average loss: 0.0548, Accuracy: 81/526 (15.3992%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   2,  Average loss: 0.0310, Accuracy: 198/526 (37.6426%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   3,  Average loss: 0.0276, Accuracy: 254/526 (48.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   4,  Average loss: 0.0245, Accuracy: 284/526 (53.9924%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   5,  Average loss: 0.0232, Accuracy: 291/526 (55.3232%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   6,  Average loss: 0.0223, Accuracy: 302/526 (57.4144%), train_poison_data_count: 45
Global model norm: 53.704554734386825.
Norm before scaling: 53.45156750142483. Distance: 8.231561111213153
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 2.6026, Accuracy: 1461/10000 (14.6100%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.2041, Accuracy: 8433/9000 (93.7000%)
Scaling by  100
Scaled Norm after poisoning: 819.1358251230379, distance: 823.1561212795541
Total norm for 4 adversaries is: 819.1358251230379. distance: 823.1561212795541
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   1,  Average loss: 0.0446, Accuracy: 159/527 (30.1708%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   2,  Average loss: 0.0280, Accuracy: 204/527 (38.7097%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   3,  Average loss: 0.0249, Accuracy: 228/527 (43.2638%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   4,  Average loss: 0.0226, Accuracy: 281/527 (53.3207%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   5,  Average loss: 0.0201, Accuracy: 311/527 (59.0133%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   6,  Average loss: 0.0189, Accuracy: 327/527 (62.0493%), train_poison_data_count: 45
Global model norm: 53.704554734386825.
Norm before scaling: 53.56561305860085. Distance: 8.115623345446501
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 3.4389, Accuracy: 1687/10000 (16.8700%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.4016, Accuracy: 8145/9000 (90.5000%)
Scaling by  100
Scaled Norm after poisoning: 808.3568982819409, distance: 811.5623050635114
Total norm for 4 adversaries is: 808.3568982819409. distance: 811.5623050635114
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   1,  Average loss: 0.0446, Accuracy: 155/496 (31.2500%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   2,  Average loss: 0.0299, Accuracy: 166/496 (33.4677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   3,  Average loss: 0.0273, Accuracy: 242/496 (48.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   4,  Average loss: 0.0230, Accuracy: 285/496 (57.4597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   5,  Average loss: 0.0198, Accuracy: 289/496 (58.2661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   6,  Average loss: 0.0174, Accuracy: 305/496 (61.4919%), train_poison_data_count: 40
Global model norm: 53.704554734386825.
Norm before scaling: 53.51450956866745. Distance: 7.164116812430437
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 2.3727, Accuracy: 2344/10000 (23.4400%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.2189, Accuracy: 8152/9000 (90.5778%)
Scaling by  100
Scaled Norm after poisoning: 713.4141285046155, distance: 716.4115873574352
Total norm for 4 adversaries is: 713.4141285046155. distance: 716.4115873574352
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   1,  Average loss: 0.0481, Accuracy: 97/546 (17.7656%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   2,  Average loss: 0.0312, Accuracy: 188/546 (34.4322%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   3,  Average loss: 0.0296, Accuracy: 191/546 (34.9817%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   4,  Average loss: 0.0281, Accuracy: 202/546 (36.9963%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   5,  Average loss: 0.0271, Accuracy: 210/546 (38.4615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   6,  Average loss: 0.0257, Accuracy: 235/546 (43.0403%), train_poison_data_count: 45
Global model norm: 53.704554734386825.
Norm before scaling: 53.45447692677971. Distance: 7.987612431888552
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 2.8807, Accuracy: 1601/10000 (16.0100%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.3510, Accuracy: 8179/9000 (90.8778%)
Scaling by  100
Scaled Norm after poisoning: 794.885998115453, distance: 798.76118928
Total norm for 4 adversaries is: 794.885998115453. distance: 798.76118928
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 204, local model 49, internal_epoch   1,  Average loss: 0.1027, Accuracy: 24/426 (5.6338%)
___Train Local_ResNet_18,  epoch 204, local model 49, internal_epoch   2,  Average loss: 0.0278, Accuracy: 173/426 (40.6103%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 204, local model 86, internal_epoch   1,  Average loss: 0.1404, Accuracy: 20/212 (9.4340%)
___Train Local_ResNet_18,  epoch 204, local model 86, internal_epoch   2,  Average loss: 0.0388, Accuracy: 75/212 (35.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 204, local model 26, internal_epoch   1,  Average loss: 0.0691, Accuracy: 143/468 (30.5556%)
___Train Local_ResNet_18,  epoch 204, local model 26, internal_epoch   2,  Average loss: 0.0366, Accuracy: 100/468 (21.3675%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 204, local model 58, internal_epoch   1,  Average loss: 0.1358, Accuracy: 45/234 (19.2308%)
___Train Local_ResNet_18,  epoch 204, local model 58, internal_epoch   2,  Average loss: 0.0363, Accuracy: 44/234 (18.8034%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 204, local model 6, internal_epoch   1,  Average loss: 0.0768, Accuracy: 115/520 (22.1154%)
___Train Local_ResNet_18,  epoch 204, local model 6, internal_epoch   2,  Average loss: 0.0357, Accuracy: 134/520 (25.7692%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 204, local model 94, internal_epoch   1,  Average loss: 0.1392, Accuracy: 29/203 (14.2857%)
___Train Local_ResNet_18,  epoch 204, local model 94, internal_epoch   2,  Average loss: 0.0445, Accuracy: 76/203 (37.4384%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 462.83767890930176
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 204: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 546.0424239635468 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:205 choose agents : [17, 33, 77, 11, 61, 71, 8, 69, 89, 64]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   1,  Average loss: 0.0424, Accuracy: 230/526 (43.7262%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   2,  Average loss: 0.0285, Accuracy: 255/526 (48.4791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   3,  Average loss: 0.0231, Accuracy: 305/526 (57.9848%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   4,  Average loss: 0.0209, Accuracy: 318/526 (60.4563%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   5,  Average loss: 0.0203, Accuracy: 321/526 (61.0266%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   6,  Average loss: 0.0192, Accuracy: 334/526 (63.4981%), train_poison_data_count: 45
Global model norm: 57.22200120473767.
Norm before scaling: 56.92864057034473. Distance: 7.119559904920114
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 3.3715, Accuracy: 2070/10000 (20.7000%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.7276, Accuracy: 7926/9000 (88.0667%)
Scaling by  100
Scaled Norm after poisoning: 708.3347769593132, distance: 711.9559765182114
Total norm for 4 adversaries is: 708.3347769593132. distance: 711.9559765182114
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   1,  Average loss: 0.0544, Accuracy: 112/527 (21.2524%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   2,  Average loss: 0.0322, Accuracy: 220/527 (41.7457%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   3,  Average loss: 0.0264, Accuracy: 233/527 (44.2125%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   4,  Average loss: 0.0228, Accuracy: 267/527 (50.6641%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   5,  Average loss: 0.0202, Accuracy: 288/527 (54.6490%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   6,  Average loss: 0.0196, Accuracy: 295/527 (55.9772%), train_poison_data_count: 45
Global model norm: 57.22200120473767.
Norm before scaling: 56.919477371958315. Distance: 7.587698326472573
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 3.1399, Accuracy: 2139/10000 (21.3900%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.6277, Accuracy: 8017/9000 (89.0778%)
Scaling by  100
Scaled Norm after poisoning: 754.8481221411364, distance: 758.7697690999556
Total norm for 4 adversaries is: 754.8481221411364. distance: 758.7697690999556
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   1,  Average loss: 0.0730, Accuracy: 54/496 (10.8871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   2,  Average loss: 0.0422, Accuracy: 133/496 (26.8145%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   3,  Average loss: 0.0337, Accuracy: 191/496 (38.5081%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   4,  Average loss: 0.0321, Accuracy: 229/496 (46.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   5,  Average loss: 0.0287, Accuracy: 229/496 (46.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   6,  Average loss: 0.0249, Accuracy: 252/496 (50.8065%), train_poison_data_count: 40
Global model norm: 57.22200120473767.
Norm before scaling: 56.799531402804064. Distance: 8.52280105466406
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.2411, Accuracy: 2179/10000 (21.7900%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.1866, Accuracy: 8390/9000 (93.2222%)
Scaling by  100
Scaled Norm after poisoning: 847.0979134669144, distance: 852.2800669380929
Total norm for 4 adversaries is: 847.0979134669144. distance: 852.2800669380929
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   1,  Average loss: 0.0495, Accuracy: 142/546 (26.0073%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   2,  Average loss: 0.0328, Accuracy: 179/546 (32.7839%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   3,  Average loss: 0.0292, Accuracy: 193/546 (35.3480%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   4,  Average loss: 0.0270, Accuracy: 215/546 (39.3773%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   5,  Average loss: 0.0260, Accuracy: 236/546 (43.2234%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   6,  Average loss: 0.0252, Accuracy: 244/546 (44.6886%), train_poison_data_count: 45
Global model norm: 57.22200120473767.
Norm before scaling: 56.79090623726654. Distance: 6.7881339154765765
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 2.9244, Accuracy: 1882/10000 (18.8200%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.1682, Accuracy: 8597/9000 (95.5222%)
Scaling by  100
Scaled Norm after poisoning: 674.1951915061394, distance: 678.813371811428
Total norm for 4 adversaries is: 674.1951915061394. distance: 678.813371811428
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 205, local model 61, internal_epoch   1,  Average loss: 0.0701, Accuracy: 152/590 (25.7627%)
___Train Local_ResNet_18,  epoch 205, local model 61, internal_epoch   2,  Average loss: 0.0405, Accuracy: 240/590 (40.6780%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 71, internal_epoch   1,  Average loss: 0.0445, Accuracy: 347/1166 (29.7599%)
___Train Local_ResNet_18,  epoch 205, local model 71, internal_epoch   2,  Average loss: 0.0250, Accuracy: 586/1166 (50.2573%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 8, internal_epoch   1,  Average loss: 0.0934, Accuracy: 56/534 (10.4869%)
___Train Local_ResNet_18,  epoch 205, local model 8, internal_epoch   2,  Average loss: 0.0541, Accuracy: 91/534 (17.0412%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 69, internal_epoch   1,  Average loss: 0.0697, Accuracy: 65/216 (30.0926%)
___Train Local_ResNet_18,  epoch 205, local model 69, internal_epoch   2,  Average loss: 0.0409, Accuracy: 103/216 (47.6852%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 89, internal_epoch   1,  Average loss: 0.0947, Accuracy: 40/413 (9.6852%)
___Train Local_ResNet_18,  epoch 205, local model 89, internal_epoch   2,  Average loss: 0.0465, Accuracy: 155/413 (37.5303%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 205, local model 64, internal_epoch   1,  Average loss: 0.0642, Accuracy: 206/686 (30.0292%)
___Train Local_ResNet_18,  epoch 205, local model 64, internal_epoch   2,  Average loss: 0.0317, Accuracy: 306/686 (44.6064%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 454.63172793388367
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 205: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 572.7002918720245 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:206 choose agents : [17, 33, 77, 11, 38, 64, 29, 23, 83, 43]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   1,  Average loss: 0.0769, Accuracy: 90/526 (17.1103%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   2,  Average loss: 0.0261, Accuracy: 252/526 (47.9087%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   3,  Average loss: 0.0233, Accuracy: 300/526 (57.0342%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   4,  Average loss: 0.0218, Accuracy: 319/526 (60.6464%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   5,  Average loss: 0.0206, Accuracy: 333/526 (63.3080%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   6,  Average loss: 0.0196, Accuracy: 325/526 (61.7871%), train_poison_data_count: 45
Global model norm: 59.054323177372034.
Norm before scaling: 58.86818232818982. Distance: 10.94473602715486
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.6794, Accuracy: 2322/10000 (23.2200%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.2438, Accuracy: 8443/9000 (93.8111%)
Scaling by  100
Scaled Norm after poisoning: 1089.5807106405657, distance: 1094.4735035623294
Total norm for 4 adversaries is: 1089.5807106405657. distance: 1094.4735035623294
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   1,  Average loss: 0.0658, Accuracy: 139/527 (26.3757%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   2,  Average loss: 0.0248, Accuracy: 247/527 (46.8691%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   3,  Average loss: 0.0223, Accuracy: 254/527 (48.1973%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   4,  Average loss: 0.0200, Accuracy: 294/527 (55.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   5,  Average loss: 0.0194, Accuracy: 310/527 (58.8235%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   6,  Average loss: 0.0165, Accuracy: 333/527 (63.1879%), train_poison_data_count: 45
Global model norm: 59.054323177372034.
Norm before scaling: 58.842202415921264. Distance: 10.171571976093162
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1012.5458940215995, distance: 1017.1572211315221
Total norm for 4 adversaries is: 1012.5458940215995. distance: 1017.1572211315221
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   1,  Average loss: 0.0663, Accuracy: 139/496 (28.0242%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   2,  Average loss: 0.0329, Accuracy: 172/496 (34.6774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   3,  Average loss: 0.0295, Accuracy: 203/496 (40.9274%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   4,  Average loss: 0.0270, Accuracy: 227/496 (45.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   5,  Average loss: 0.0247, Accuracy: 252/496 (50.8065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   6,  Average loss: 0.0230, Accuracy: 262/496 (52.8226%), train_poison_data_count: 40
Global model norm: 59.054323177372034.
Norm before scaling: 58.72118018188263. Distance: 8.733039330734085
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 868.6754284541494, distance: 873.3039991892857
Total norm for 4 adversaries is: 868.6754284541494. distance: 873.3039991892857
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   1,  Average loss: 0.0706, Accuracy: 105/546 (19.2308%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   2,  Average loss: 0.0266, Accuracy: 230/546 (42.1245%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   3,  Average loss: 0.0257, Accuracy: 258/546 (47.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   4,  Average loss: 0.0243, Accuracy: 265/546 (48.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   5,  Average loss: 0.0236, Accuracy: 282/546 (51.6484%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   6,  Average loss: 0.0229, Accuracy: 286/546 (52.3810%), train_poison_data_count: 45
Global model norm: 59.054323177372034.
Norm before scaling: 58.844807976415815. Distance: 10.727301475592181
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.6114, Accuracy: 2040/10000 (20.4000%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.3582, Accuracy: 8357/9000 (92.8556%)
Scaling by  100
Scaled Norm after poisoning: 1067.8294573573066, distance: 1072.7301035209182
Total norm for 4 adversaries is: 1067.8294573573066. distance: 1072.7301035209182
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 206, local model 38, internal_epoch   1,  Average loss: 0.1188, Accuracy: 240/756 (31.7460%)
___Train Local_ResNet_18,  epoch 206, local model 38, internal_epoch   2,  Average loss: 0.0250, Accuracy: 347/756 (45.8995%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 64, internal_epoch   1,  Average loss: 0.1261, Accuracy: 186/686 (27.1137%)
___Train Local_ResNet_18,  epoch 206, local model 64, internal_epoch   2,  Average loss: 0.0338, Accuracy: 258/686 (37.6093%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 29, internal_epoch   1,  Average loss: 0.1033, Accuracy: 330/848 (38.9151%)
___Train Local_ResNet_18,  epoch 206, local model 29, internal_epoch   2,  Average loss: 0.0248, Accuracy: 509/848 (60.0236%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 23, internal_epoch   1,  Average loss: 0.2516, Accuracy: 19/248 (7.6613%)
___Train Local_ResNet_18,  epoch 206, local model 23, internal_epoch   2,  Average loss: 0.0467, Accuracy: 70/248 (28.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 83, internal_epoch   1,  Average loss: 0.1967, Accuracy: 51/366 (13.9344%)
___Train Local_ResNet_18,  epoch 206, local model 83, internal_epoch   2,  Average loss: 0.0537, Accuracy: 56/366 (15.3005%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 206, local model 43, internal_epoch   1,  Average loss: 0.2052, Accuracy: 100/345 (28.9855%)
___Train Local_ResNet_18,  epoch 206, local model 43, internal_epoch   2,  Average loss: 0.0298, Accuracy: 156/345 (45.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 386.8318226337433
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 206: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 498.8085448741913 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:207 choose agents : [17, 33, 77, 11, 56, 45, 1, 50, 16, 12]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   1,  Average loss: 0.0326, Accuracy: 262/526 (49.8099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   2,  Average loss: 0.0233, Accuracy: 327/526 (62.1673%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   3,  Average loss: 0.0213, Accuracy: 323/526 (61.4068%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   4,  Average loss: 0.0190, Accuracy: 345/526 (65.5894%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   5,  Average loss: 0.0183, Accuracy: 342/526 (65.0190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   6,  Average loss: 0.0176, Accuracy: 340/526 (64.6388%), train_poison_data_count: 45
Global model norm: 66.71251068601188.
Norm before scaling: 66.05049559806497. Distance: 4.400749073422224
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 432.88655052449946, distance: 440.07492259841393
Total norm for 4 adversaries is: 432.88655052449946. distance: 440.07492259841393
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   1,  Average loss: 0.0477, Accuracy: 124/527 (23.5294%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   2,  Average loss: 0.0322, Accuracy: 194/527 (36.8121%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   3,  Average loss: 0.0284, Accuracy: 232/527 (44.0228%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   4,  Average loss: 0.0263, Accuracy: 239/527 (45.3510%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   5,  Average loss: 0.0238, Accuracy: 257/527 (48.7666%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   6,  Average loss: 0.0226, Accuracy: 256/527 (48.5769%), train_poison_data_count: 45
Global model norm: 66.71251068601188.
Norm before scaling: 66.05085043926384. Distance: 6.445809048107768
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 637.9622833679119, distance: 644.5809200558142
Total norm for 4 adversaries is: 637.9622833679119. distance: 644.5809200558142
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   1,  Average loss: 0.0522, Accuracy: 140/496 (28.2258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   2,  Average loss: 0.0400, Accuracy: 126/496 (25.4032%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   3,  Average loss: 0.0346, Accuracy: 168/496 (33.8710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   4,  Average loss: 0.0309, Accuracy: 188/496 (37.9032%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   5,  Average loss: 0.0279, Accuracy: 216/496 (43.5484%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   6,  Average loss: 0.0265, Accuracy: 218/496 (43.9516%), train_poison_data_count: 40
Global model norm: 66.71251068601188.
Norm before scaling: 66.02371437123936. Distance: 5.7316189413181124
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 566.1600370036726, distance: 573.1618717692237
Total norm for 4 adversaries is: 566.1600370036726. distance: 573.1618717692237
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   1,  Average loss: 0.0424, Accuracy: 165/546 (30.2198%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   2,  Average loss: 0.0305, Accuracy: 226/546 (41.3919%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   3,  Average loss: 0.0272, Accuracy: 268/546 (49.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   4,  Average loss: 0.0255, Accuracy: 265/546 (48.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   5,  Average loss: 0.0236, Accuracy: 276/546 (50.5495%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   6,  Average loss: 0.0225, Accuracy: 292/546 (53.4799%), train_poison_data_count: 45
Global model norm: 66.71251068601188.
Norm before scaling: 65.99269387236174. Distance: 5.330087250072347
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 525.5050546854901, distance: 533.0087065423978
Total norm for 4 adversaries is: 525.5050546854901. distance: 533.0087065423978
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 207, local model 56, internal_epoch   1,  Average loss: 0.0504, Accuracy: 188/743 (25.3028%)
___Train Local_ResNet_18,  epoch 207, local model 56, internal_epoch   2,  Average loss: 0.0316, Accuracy: 284/743 (38.2234%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 45, internal_epoch   1,  Average loss: 0.0676, Accuracy: 149/529 (28.1664%)
___Train Local_ResNet_18,  epoch 207, local model 45, internal_epoch   2,  Average loss: 0.0362, Accuracy: 183/529 (34.5936%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   1,  Average loss: 0.0480, Accuracy: 225/641 (35.1014%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   2,  Average loss: 0.0368, Accuracy: 292/641 (45.5538%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 50, internal_epoch   1,  Average loss: 0.0557, Accuracy: 191/401 (47.6309%)
___Train Local_ResNet_18,  epoch 207, local model 50, internal_epoch   2,  Average loss: 0.0309, Accuracy: 223/401 (55.6110%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 16, internal_epoch   1,  Average loss: 0.0656, Accuracy: 209/773 (27.0375%)
___Train Local_ResNet_18,  epoch 207, local model 16, internal_epoch   2,  Average loss: 0.0411, Accuracy: 296/773 (38.2924%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 12, internal_epoch   1,  Average loss: 0.0521, Accuracy: 356/977 (36.4381%)
___Train Local_ResNet_18,  epoch 207, local model 12, internal_epoch   2,  Average loss: 0.0297, Accuracy: 420/977 (42.9887%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 405.33315110206604
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 207: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 490.53242897987366 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:208 choose agents : [17, 33, 77, 11, 44, 86, 20, 50, 49, 43]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   1,  Average loss: 0.1125, Accuracy: 60/526 (11.4068%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   2,  Average loss: 0.0452, Accuracy: 153/526 (29.0875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   3,  Average loss: 0.0269, Accuracy: 274/526 (52.0913%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   4,  Average loss: 0.0256, Accuracy: 306/526 (58.1749%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   5,  Average loss: 0.0230, Accuracy: 307/526 (58.3650%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   6,  Average loss: 0.0207, Accuracy: 328/526 (62.3574%), train_poison_data_count: 45
Global model norm: 65.54418014424508.
Norm before scaling: 64.81329103904923. Distance: 10.216705957765516
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1013.9729409604578, distance: 1021.670568236161
Total norm for 4 adversaries is: 1013.9729409604578. distance: 1021.670568236161
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   1,  Average loss: 0.0879, Accuracy: 102/527 (19.3548%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   2,  Average loss: 0.0328, Accuracy: 206/527 (39.0892%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   3,  Average loss: 0.0250, Accuracy: 258/527 (48.9564%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   4,  Average loss: 0.0216, Accuracy: 254/527 (48.1973%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   5,  Average loss: 0.0193, Accuracy: 286/527 (54.2694%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   6,  Average loss: 0.0186, Accuracy: 306/527 (58.0645%), train_poison_data_count: 45
Global model norm: 65.54418014424508.
Norm before scaling: 64.83229567507232. Distance: 8.72117969197554
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 864.8691375000035, distance: 872.1178962732046
Total norm for 4 adversaries is: 864.8691375000035. distance: 872.1178962732046
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   1,  Average loss: 0.0927, Accuracy: 144/496 (29.0323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   2,  Average loss: 0.0466, Accuracy: 127/496 (25.6048%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   3,  Average loss: 0.0329, Accuracy: 147/496 (29.6371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   4,  Average loss: 0.0279, Accuracy: 220/496 (44.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   5,  Average loss: 0.0259, Accuracy: 228/496 (45.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   6,  Average loss: 0.0251, Accuracy: 246/496 (49.5968%), train_poison_data_count: 40
Global model norm: 65.54418014424508.
Norm before scaling: 64.79993625213878. Distance: 8.614461016142148
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 853.9694813048063, distance: 861.4460952375372
Total norm for 4 adversaries is: 853.9694813048063. distance: 861.4460952375372
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   1,  Average loss: 0.1006, Accuracy: 103/546 (18.8645%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   2,  Average loss: 0.0384, Accuracy: 132/546 (24.1758%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   3,  Average loss: 0.0304, Accuracy: 227/546 (41.5751%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   4,  Average loss: 0.0255, Accuracy: 223/546 (40.8425%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   5,  Average loss: 0.0244, Accuracy: 269/546 (49.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   6,  Average loss: 0.0232, Accuracy: 288/546 (52.7473%), train_poison_data_count: 45
Global model norm: 65.54418014424508.
Norm before scaling: 64.77609422319703. Distance: 9.218365573949672
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 914.095864775681, distance: 921.8365500456141
Total norm for 4 adversaries is: 914.095864775681. distance: 921.8365500456141
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 208, local model 44, internal_epoch   1,  Average loss: 0.1140, Accuracy: 47/436 (10.7798%)
___Train Local_ResNet_18,  epoch 208, local model 44, internal_epoch   2,  Average loss: 0.0385, Accuracy: 202/436 (46.3303%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 86, internal_epoch   1,  Average loss: 0.1567, Accuracy: 44/212 (20.7547%)
___Train Local_ResNet_18,  epoch 208, local model 86, internal_epoch   2,  Average loss: 0.0685, Accuracy: 58/212 (27.3585%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 20, internal_epoch   1,  Average loss: 0.1075, Accuracy: 54/362 (14.9171%)
___Train Local_ResNet_18,  epoch 208, local model 20, internal_epoch   2,  Average loss: 0.0364, Accuracy: 186/362 (51.3812%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 50, internal_epoch   1,  Average loss: 0.1347, Accuracy: 29/401 (7.2319%)
___Train Local_ResNet_18,  epoch 208, local model 50, internal_epoch   2,  Average loss: 0.0404, Accuracy: 189/401 (47.1322%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 49, internal_epoch   1,  Average loss: 0.1419, Accuracy: 17/426 (3.9906%)
___Train Local_ResNet_18,  epoch 208, local model 49, internal_epoch   2,  Average loss: 0.0441, Accuracy: 98/426 (23.0047%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 208, local model 43, internal_epoch   1,  Average loss: 0.1119, Accuracy: 144/345 (41.7391%)
___Train Local_ResNet_18,  epoch 208, local model 43, internal_epoch   2,  Average loss: 0.0448, Accuracy: 150/345 (43.4783%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 408.0598876476288
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 208: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 522.3647873401642 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:209 choose agents : [17, 33, 77, 11, 28, 51, 4, 97, 85, 59]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   1,  Average loss: 0.0961, Accuracy: 230/526 (43.7262%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   2,  Average loss: 0.0366, Accuracy: 212/526 (40.3042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   3,  Average loss: 0.0277, Accuracy: 276/526 (52.4715%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   4,  Average loss: 0.0267, Accuracy: 285/526 (54.1825%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   5,  Average loss: 0.0250, Accuracy: 315/526 (59.8859%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   6,  Average loss: 0.0228, Accuracy: 319/526 (60.6464%), train_poison_data_count: 45
Global model norm: 69.37177990837665.
Norm before scaling: 68.8233628460387. Distance: 11.144691784354636
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1107.6347547815571, distance: 1114.469212226161
Total norm for 4 adversaries is: 1107.6347547815571. distance: 1114.469212226161
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   1,  Average loss: 0.1668, Accuracy: 165/527 (31.3093%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   2,  Average loss: 0.0496, Accuracy: 190/527 (36.0531%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   3,  Average loss: 0.0347, Accuracy: 231/527 (43.8330%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   4,  Average loss: 0.0267, Accuracy: 264/527 (50.0949%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   5,  Average loss: 0.0228, Accuracy: 269/527 (51.0436%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   6,  Average loss: 0.0220, Accuracy: 280/527 (53.1309%), train_poison_data_count: 45
Global model norm: 69.37177990837665.
Norm before scaling: 68.99452254074232. Distance: 14.81984609011732
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1474.4179360005087, distance: 1481.9846490433024
Total norm for 4 adversaries is: 1474.4179360005087. distance: 1481.9846490433024
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   1,  Average loss: 0.1622, Accuracy: 95/496 (19.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   2,  Average loss: 0.0433, Accuracy: 168/496 (33.8710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   3,  Average loss: 0.0320, Accuracy: 198/496 (39.9194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   4,  Average loss: 0.0294, Accuracy: 186/496 (37.5000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   5,  Average loss: 0.0281, Accuracy: 194/496 (39.1129%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   6,  Average loss: 0.0263, Accuracy: 226/496 (45.5645%), train_poison_data_count: 40
Global model norm: 69.37177990837665.
Norm before scaling: 69.23746572597996. Distance: 14.819146962602765
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1475.4866146461648, distance: 1481.9145555665482
Total norm for 4 adversaries is: 1475.4866146461648. distance: 1481.9145555665482
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   1,  Average loss: 0.1233, Accuracy: 209/546 (38.2784%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   2,  Average loss: 0.0398, Accuracy: 204/546 (37.3626%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   3,  Average loss: 0.0295, Accuracy: 240/546 (43.9560%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   4,  Average loss: 0.0252, Accuracy: 268/546 (49.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   5,  Average loss: 0.0234, Accuracy: 272/546 (49.8168%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   6,  Average loss: 0.0222, Accuracy: 280/546 (51.2821%), train_poison_data_count: 45
Global model norm: 69.37177990837665.
Norm before scaling: 68.78418894220896. Distance: 12.29196701113901
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1221.683111530973, distance: 1229.1966888988923
Total norm for 4 adversaries is: 1221.683111530973. distance: 1229.1966888988923
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 209, local model 28, internal_epoch   1,  Average loss: 0.1668, Accuracy: 84/423 (19.8582%)
___Train Local_ResNet_18,  epoch 209, local model 28, internal_epoch   2,  Average loss: 0.0441, Accuracy: 97/423 (22.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 51, internal_epoch   1,  Average loss: 0.1189, Accuracy: 219/479 (45.7203%)
___Train Local_ResNet_18,  epoch 209, local model 51, internal_epoch   2,  Average loss: 0.0313, Accuracy: 272/479 (56.7850%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   1,  Average loss: 0.1551, Accuracy: 167/557 (29.9820%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   2,  Average loss: 0.0408, Accuracy: 225/557 (40.3950%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 97, internal_epoch   1,  Average loss: 0.0881, Accuracy: 167/418 (39.9522%)
___Train Local_ResNet_18,  epoch 209, local model 97, internal_epoch   2,  Average loss: 0.0316, Accuracy: 161/418 (38.5167%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 85, internal_epoch   1,  Average loss: 0.1980, Accuracy: 103/364 (28.2967%)
___Train Local_ResNet_18,  epoch 209, local model 85, internal_epoch   2,  Average loss: 0.0547, Accuracy: 100/364 (27.4725%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 209, local model 59, internal_epoch   1,  Average loss: 0.1283, Accuracy: 130/642 (20.2492%)
___Train Local_ResNet_18,  epoch 209, local model 59, internal_epoch   2,  Average loss: 0.0366, Accuracy: 174/642 (27.1028%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 363.32927417755127
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 209: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 448.2188503742218 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:210 choose agents : [17, 33, 77, 11, 51, 13, 57, 76, 80, 85]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   1,  Average loss: 0.0595, Accuracy: 85/526 (16.1597%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   2,  Average loss: 0.0351, Accuracy: 126/526 (23.9544%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   3,  Average loss: 0.0295, Accuracy: 233/526 (44.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   4,  Average loss: 0.0266, Accuracy: 258/526 (49.0494%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   5,  Average loss: 0.0250, Accuracy: 266/526 (50.5703%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   6,  Average loss: 0.0251, Accuracy: 293/526 (55.7034%), train_poison_data_count: 45
Global model norm: 79.12713205559614.
Norm before scaling: 78.31393716259099. Distance: 7.268780029444768
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 718.6975633046212, distance: 726.8780416961293
Total norm for 4 adversaries is: 718.6975633046212. distance: 726.8780416961293
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   1,  Average loss: 0.0428, Accuracy: 199/527 (37.7609%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   2,  Average loss: 0.0319, Accuracy: 207/527 (39.2789%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   3,  Average loss: 0.0295, Accuracy: 200/527 (37.9507%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   4,  Average loss: 0.0262, Accuracy: 210/527 (39.8482%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   5,  Average loss: 0.0257, Accuracy: 230/527 (43.6433%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   6,  Average loss: 0.0242, Accuracy: 245/527 (46.4896%), train_poison_data_count: 45
Global model norm: 79.12713205559614.
Norm before scaling: 78.27710817386205. Distance: 4.526804881244754
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 442.43834316207267, distance: 452.680454349423
Total norm for 4 adversaries is: 442.43834316207267. distance: 452.680454349423
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   1,  Average loss: 0.0448, Accuracy: 105/496 (21.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   2,  Average loss: 0.0351, Accuracy: 146/496 (29.4355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   3,  Average loss: 0.0313, Accuracy: 174/496 (35.0806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   4,  Average loss: 0.0294, Accuracy: 181/496 (36.4919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   5,  Average loss: 0.0287, Accuracy: 185/496 (37.2984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   6,  Average loss: 0.0264, Accuracy: 221/496 (44.5565%), train_poison_data_count: 40
Global model norm: 79.12713205559614.
Norm before scaling: 78.37705900903816. Distance: 4.936554443986451
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 485.49546213121295, distance: 493.65541815622765
Total norm for 4 adversaries is: 485.49546213121295. distance: 493.65541815622765
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   1,  Average loss: 0.0532, Accuracy: 96/546 (17.5824%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   2,  Average loss: 0.0387, Accuracy: 145/546 (26.5568%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   3,  Average loss: 0.0321, Accuracy: 203/546 (37.1795%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   4,  Average loss: 0.0294, Accuracy: 217/546 (39.7436%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   5,  Average loss: 0.0279, Accuracy: 232/546 (42.4908%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   6,  Average loss: 0.0264, Accuracy: 240/546 (43.9560%), train_poison_data_count: 45
Global model norm: 79.12713205559614.
Norm before scaling: 78.22623753115862. Distance: 5.37127929367021
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 526.9785930187297, distance: 537.1279526332622
Total norm for 4 adversaries is: 526.9785930187297. distance: 537.1279526332622
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 210, local model 51, internal_epoch   1,  Average loss: 0.1767, Accuracy: 141/479 (29.4363%)
___Train Local_ResNet_18,  epoch 210, local model 51, internal_epoch   2,  Average loss: 0.0479, Accuracy: 289/479 (60.3340%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 13, internal_epoch   1,  Average loss: 0.1464, Accuracy: 143/620 (23.0645%)
___Train Local_ResNet_18,  epoch 210, local model 13, internal_epoch   2,  Average loss: 0.0298, Accuracy: 332/620 (53.5484%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   1,  Average loss: 0.2526, Accuracy: 43/290 (14.8276%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   2,  Average loss: 0.0816, Accuracy: 73/290 (25.1724%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 76, internal_epoch   1,  Average loss: 0.6437, Accuracy: 5/65 (7.6923%)
___Train Local_ResNet_18,  epoch 210, local model 76, internal_epoch   2,  Average loss: 0.4373, Accuracy: 9/65 (13.8462%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 80, internal_epoch   1,  Average loss: 0.2602, Accuracy: 12/363 (3.3058%)
___Train Local_ResNet_18,  epoch 210, local model 80, internal_epoch   2,  Average loss: 0.0467, Accuracy: 152/363 (41.8733%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 210, local model 85, internal_epoch   1,  Average loss: 0.2244, Accuracy: 83/364 (22.8022%)
___Train Local_ResNet_18,  epoch 210, local model 85, internal_epoch   2,  Average loss: 0.0543, Accuracy: 95/364 (26.0989%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 354.5504050254822
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 210: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 459.1410663127899 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:211 choose agents : [17, 33, 77, 11, 90, 24, 63, 1, 52, 31]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   1,  Average loss: 0.0492, Accuracy: 213/526 (40.4943%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   2,  Average loss: 0.0322, Accuracy: 206/526 (39.1635%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   3,  Average loss: 0.0289, Accuracy: 208/526 (39.5437%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   4,  Average loss: 0.0264, Accuracy: 230/526 (43.7262%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   5,  Average loss: 0.0254, Accuracy: 254/526 (48.2890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   6,  Average loss: 0.0232, Accuracy: 280/526 (53.2319%), train_poison_data_count: 45
Global model norm: 77.25828927512407.
Norm before scaling: 76.3217196007303. Distance: 6.293747042188357
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 619.4645369187812, distance: 629.3747393246729
Total norm for 4 adversaries is: 619.4645369187812. distance: 629.3747393246729
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   1,  Average loss: 0.0815, Accuracy: 105/527 (19.9241%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   2,  Average loss: 0.0482, Accuracy: 129/527 (24.4782%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   3,  Average loss: 0.0350, Accuracy: 172/527 (32.6376%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   4,  Average loss: 0.0297, Accuracy: 220/527 (41.7457%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   5,  Average loss: 0.0257, Accuracy: 226/527 (42.8843%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   6,  Average loss: 0.0243, Accuracy: 232/527 (44.0228%), train_poison_data_count: 45
Global model norm: 77.25828927512407.
Norm before scaling: 76.33837731811242. Distance: 8.615169063952736
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 852.4251800011541, distance: 861.5169760370367
Total norm for 4 adversaries is: 852.4251800011541. distance: 861.5169760370367
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   1,  Average loss: 0.0827, Accuracy: 91/496 (18.3468%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   2,  Average loss: 0.0473, Accuracy: 153/496 (30.8468%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   3,  Average loss: 0.0368, Accuracy: 150/496 (30.2419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   4,  Average loss: 0.0295, Accuracy: 198/496 (39.9194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   5,  Average loss: 0.0270, Accuracy: 216/496 (43.5484%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   6,  Average loss: 0.0267, Accuracy: 207/496 (41.7339%), train_poison_data_count: 40
Global model norm: 77.25828927512407.
Norm before scaling: 76.49666174293164. Distance: 8.549673009497845
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 847.3003452141395, distance: 854.9673239370029
Total norm for 4 adversaries is: 847.3003452141395. distance: 854.9673239370029
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   1,  Average loss: 0.0628, Accuracy: 137/546 (25.0916%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   2,  Average loss: 0.0382, Accuracy: 203/546 (37.1795%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   3,  Average loss: 0.0342, Accuracy: 233/546 (42.6740%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   4,  Average loss: 0.0300, Accuracy: 238/546 (43.5897%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   5,  Average loss: 0.0273, Accuracy: 256/546 (46.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   6,  Average loss: 0.0261, Accuracy: 252/546 (46.1538%), train_poison_data_count: 45
Global model norm: 77.25828927512407.
Norm before scaling: 76.30741946642542. Distance: 7.8707019036303585
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 777.5933223735914, distance: 787.0702001727673
Total norm for 4 adversaries is: 777.5933223735914. distance: 787.0702001727673
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 211, local model 90, internal_epoch   1,  Average loss: 0.1532, Accuracy: 170/578 (29.4118%)
___Train Local_ResNet_18,  epoch 211, local model 90, internal_epoch   2,  Average loss: 0.0337, Accuracy: 190/578 (32.8720%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 24, internal_epoch   1,  Average loss: 0.1919, Accuracy: 22/320 (6.8750%)
___Train Local_ResNet_18,  epoch 211, local model 24, internal_epoch   2,  Average loss: 0.0623, Accuracy: 91/320 (28.4375%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 63, internal_epoch   1,  Average loss: 0.1110, Accuracy: 126/752 (16.7553%)
___Train Local_ResNet_18,  epoch 211, local model 63, internal_epoch   2,  Average loss: 0.0405, Accuracy: 162/752 (21.5426%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 1, internal_epoch   1,  Average loss: 0.1263, Accuracy: 177/641 (27.6131%)
___Train Local_ResNet_18,  epoch 211, local model 1, internal_epoch   2,  Average loss: 0.0382, Accuracy: 201/641 (31.3573%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 52, internal_epoch   1,  Average loss: 0.2139, Accuracy: 44/214 (20.5607%)
___Train Local_ResNet_18,  epoch 211, local model 52, internal_epoch   2,  Average loss: 0.0747, Accuracy: 80/214 (37.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 211, local model 31, internal_epoch   1,  Average loss: 0.1072, Accuracy: 174/706 (24.6459%)
___Train Local_ResNet_18,  epoch 211, local model 31, internal_epoch   2,  Average loss: 0.0376, Accuracy: 236/706 (33.4278%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 416.3444046974182
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 211: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 517.0349912643433 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:212 choose agents : [17, 33, 77, 11, 59, 67, 71, 66, 76, 96]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   1,  Average loss: 0.1692, Accuracy: 92/526 (17.4905%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   2,  Average loss: 0.0816, Accuracy: 100/526 (19.0114%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   3,  Average loss: 0.0514, Accuracy: 154/526 (29.2776%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   4,  Average loss: 0.0355, Accuracy: 169/526 (32.1293%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   5,  Average loss: 0.0282, Accuracy: 210/526 (39.9240%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   6,  Average loss: 0.0267, Accuracy: 281/526 (53.4221%), train_poison_data_count: 45
Global model norm: 77.71385564604937.
Norm before scaling: 77.0267588700917. Distance: 16.55898768772377
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1646.2041185709627, distance: 1655.8987740801067
Total norm for 4 adversaries is: 1646.2041185709627. distance: 1655.8987740801067
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   1,  Average loss: 0.1077, Accuracy: 206/527 (39.0892%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   2,  Average loss: 0.0587, Accuracy: 208/527 (39.4687%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   3,  Average loss: 0.0399, Accuracy: 214/527 (40.6072%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   4,  Average loss: 0.0300, Accuracy: 229/527 (43.4535%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   5,  Average loss: 0.0247, Accuracy: 250/527 (47.4383%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   6,  Average loss: 0.0232, Accuracy: 251/527 (47.6281%), train_poison_data_count: 45
Global model norm: 77.71385564604937.
Norm before scaling: 76.73517199494474. Distance: 11.648757776658325
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1155.114658810977, distance: 1164.8757444465912
Total norm for 4 adversaries is: 1155.114658810977. distance: 1164.8757444465912
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   1,  Average loss: 0.1225, Accuracy: 110/496 (22.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   2,  Average loss: 0.0609, Accuracy: 144/496 (29.0323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   3,  Average loss: 0.0430, Accuracy: 189/496 (38.1048%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   4,  Average loss: 0.0354, Accuracy: 213/496 (42.9435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   5,  Average loss: 0.0307, Accuracy: 220/496 (44.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   6,  Average loss: 0.0285, Accuracy: 222/496 (44.7581%), train_poison_data_count: 40
Global model norm: 77.71385564604937.
Norm before scaling: 76.8815101410118. Distance: 12.429619367545827
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1233.9677366122664, distance: 1242.9618859804189
Total norm for 4 adversaries is: 1233.9677366122664. distance: 1242.9618859804189
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   1,  Average loss: 0.1404, Accuracy: 105/546 (19.2308%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   2,  Average loss: 0.0707, Accuracy: 108/546 (19.7802%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   3,  Average loss: 0.0465, Accuracy: 117/546 (21.4286%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   4,  Average loss: 0.0327, Accuracy: 172/546 (31.5018%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   5,  Average loss: 0.0313, Accuracy: 222/546 (40.6593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   6,  Average loss: 0.0301, Accuracy: 242/546 (44.3223%), train_poison_data_count: 45
Global model norm: 77.71385564604937.
Norm before scaling: 76.83014443400455. Distance: 14.121047825824355
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1402.3130000110532, distance: 1412.1048119739555
Total norm for 4 adversaries is: 1402.3130000110532. distance: 1412.1048119739555
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 212, local model 59, internal_epoch   1,  Average loss: 0.1655, Accuracy: 168/642 (26.1682%)
___Train Local_ResNet_18,  epoch 212, local model 59, internal_epoch   2,  Average loss: 0.0451, Accuracy: 204/642 (31.7757%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 67, internal_epoch   1,  Average loss: 0.1581, Accuracy: 67/842 (7.9572%)
___Train Local_ResNet_18,  epoch 212, local model 67, internal_epoch   2,  Average loss: 0.0350, Accuracy: 243/842 (28.8599%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 71, internal_epoch   1,  Average loss: 0.1050, Accuracy: 332/1166 (28.4734%)
___Train Local_ResNet_18,  epoch 212, local model 71, internal_epoch   2,  Average loss: 0.0291, Accuracy: 519/1166 (44.5111%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 66, internal_epoch   1,  Average loss: 0.2049, Accuracy: 82/555 (14.7748%)
___Train Local_ResNet_18,  epoch 212, local model 66, internal_epoch   2,  Average loss: 0.0372, Accuracy: 322/555 (58.0180%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 76, internal_epoch   1,  Average loss: 0.6999, Accuracy: 3/65 (4.6154%)
___Train Local_ResNet_18,  epoch 212, local model 76, internal_epoch   2,  Average loss: 0.3638, Accuracy: 6/65 (9.2308%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 96, internal_epoch   1,  Average loss: 0.1590, Accuracy: 139/708 (19.6328%)
___Train Local_ResNet_18,  epoch 212, local model 96, internal_epoch   2,  Average loss: 0.0390, Accuracy: 255/708 (36.0169%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 382.7969706058502
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 212: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 496.60372138023376 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:213 choose agents : [17, 33, 77, 11, 80, 81, 22, 72, 64, 45]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   1,  Average loss: 0.0804, Accuracy: 166/526 (31.5589%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   2,  Average loss: 0.0692, Accuracy: 244/526 (46.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   3,  Average loss: 0.0617, Accuracy: 282/526 (53.6122%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   4,  Average loss: 0.0588, Accuracy: 293/526 (55.7034%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   5,  Average loss: 0.0527, Accuracy: 304/526 (57.7947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   6,  Average loss: 0.0485, Accuracy: 296/526 (56.2738%), train_poison_data_count: 45
Global model norm: 87.07841518209321.
Norm before scaling: 85.63345932209413. Distance: 6.970579172423439
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 680.9240045702604, distance: 697.057879591071
Total norm for 4 adversaries is: 680.9240045702604. distance: 697.057879591071
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   1,  Average loss: 0.1745, Accuracy: 143/527 (27.1347%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   2,  Average loss: 0.1535, Accuracy: 138/527 (26.1860%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   3,  Average loss: 0.1391, Accuracy: 149/527 (28.2732%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   4,  Average loss: 0.1222, Accuracy: 145/527 (27.5142%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   5,  Average loss: 0.1124, Accuracy: 126/527 (23.9089%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   6,  Average loss: 0.0891, Accuracy: 108/527 (20.4934%), train_poison_data_count: 45
Global model norm: 87.07841518209321.
Norm before scaling: 84.8349845840441. Distance: 12.456708481041074
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1226.8634805877955, distance: 1245.670853395872
Total norm for 4 adversaries is: 1226.8634805877955. distance: 1245.670853395872
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   1,  Average loss: 0.1500, Accuracy: 62/496 (12.5000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   2,  Average loss: 0.1181, Accuracy: 86/496 (17.3387%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   3,  Average loss: 0.0971, Accuracy: 132/496 (26.6129%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   4,  Average loss: 0.0837, Accuracy: 104/496 (20.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   5,  Average loss: 0.0611, Accuracy: 101/496 (20.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   6,  Average loss: 0.0512, Accuracy: 135/496 (27.2177%), train_poison_data_count: 40
Global model norm: 87.07841518209321.
Norm before scaling: 85.67509369523619. Distance: 11.319591343920477
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1118.8645472084636, distance: 1131.9590871581888
Total norm for 4 adversaries is: 1118.8645472084636. distance: 1131.9590871581888
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   1,  Average loss: 0.0987, Accuracy: 193/546 (35.3480%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   2,  Average loss: 0.0869, Accuracy: 216/546 (39.5604%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   3,  Average loss: 0.0808, Accuracy: 222/546 (40.6593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   4,  Average loss: 0.0721, Accuracy: 237/546 (43.4066%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   5,  Average loss: 0.0720, Accuracy: 242/546 (44.3223%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   6,  Average loss: 0.0640, Accuracy: 244/546 (44.6886%), train_poison_data_count: 45
Global model norm: 87.07841518209321.
Norm before scaling: 85.40264525415036. Distance: 8.368425664108102
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 819.7446248680134, distance: 836.8425404459311
Total norm for 4 adversaries is: 819.7446248680134. distance: 836.8425404459311
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 213, local model 80, internal_epoch   1,  Average loss: 0.1240, Accuracy: 118/363 (32.5069%)
___Train Local_ResNet_18,  epoch 213, local model 80, internal_epoch   2,  Average loss: 0.0395, Accuracy: 212/363 (58.4022%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 81, internal_epoch   1,  Average loss: 0.2412, Accuracy: 88/1034 (8.5106%)
___Train Local_ResNet_18,  epoch 213, local model 81, internal_epoch   2,  Average loss: 0.0829, Accuracy: 279/1034 (26.9826%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 22, internal_epoch   1,  Average loss: 0.1363, Accuracy: 108/494 (21.8623%)
___Train Local_ResNet_18,  epoch 213, local model 22, internal_epoch   2,  Average loss: 0.0506, Accuracy: 199/494 (40.2834%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 72, internal_epoch   1,  Average loss: 0.1634, Accuracy: 140/618 (22.6537%)
___Train Local_ResNet_18,  epoch 213, local model 72, internal_epoch   2,  Average loss: 0.0886, Accuracy: 281/618 (45.4693%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 64, internal_epoch   1,  Average loss: 0.1431, Accuracy: 91/686 (13.2653%)
___Train Local_ResNet_18,  epoch 213, local model 64, internal_epoch   2,  Average loss: 0.0580, Accuracy: 174/686 (25.3644%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 213, local model 45, internal_epoch   1,  Average loss: 0.1877, Accuracy: 67/529 (12.6654%)
___Train Local_ResNet_18,  epoch 213, local model 45, internal_epoch   2,  Average loss: 0.0776, Accuracy: 159/529 (30.0567%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 395.4034240245819
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 213: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 479.94044256210327 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:214 choose agents : [17, 33, 77, 11, 80, 54, 44, 35, 68, 25]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   1,  Average loss: 0.2297, Accuracy: 151/526 (28.7072%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   2,  Average loss: 0.0409, Accuracy: 186/526 (35.3612%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   3,  Average loss: 0.0361, Accuracy: 181/526 (34.4106%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   4,  Average loss: 0.0311, Accuracy: 184/526 (34.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   5,  Average loss: 0.0303, Accuracy: 179/526 (34.0304%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   6,  Average loss: 0.0300, Accuracy: 179/526 (34.0304%), train_poison_data_count: 45
Global model norm: 85.89432438140194.
Norm before scaling: 87.13559162664244. Distance: 25.834114834029297
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2576.0687102637617, distance: 2583.411407422364
Total norm for 4 adversaries is: 2576.0687102637617. distance: 2583.411407422364
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   1,  Average loss: 0.1924, Accuracy: 138/527 (26.1860%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   2,  Average loss: 0.0429, Accuracy: 110/527 (20.8729%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   3,  Average loss: 0.0355, Accuracy: 118/527 (22.3909%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   4,  Average loss: 0.0307, Accuracy: 175/527 (33.2068%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   5,  Average loss: 0.0287, Accuracy: 207/527 (39.2789%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   6,  Average loss: 0.0287, Accuracy: 202/527 (38.3302%), train_poison_data_count: 45
Global model norm: 85.89432438140194.
Norm before scaling: 85.82533589360429. Distance: 19.445169683585625
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1936.369670285093, distance: 1944.5169708696296
Total norm for 4 adversaries is: 1936.369670285093. distance: 1944.5169708696296
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   1,  Average loss: 0.1966, Accuracy: 85/496 (17.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   2,  Average loss: 0.0387, Accuracy: 68/496 (13.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   3,  Average loss: 0.0365, Accuracy: 137/496 (27.6210%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   4,  Average loss: 0.0343, Accuracy: 135/496 (27.2177%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   5,  Average loss: 0.0332, Accuracy: 142/496 (28.6290%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   6,  Average loss: 0.0323, Accuracy: 143/496 (28.8306%), train_poison_data_count: 40
Global model norm: 85.89432438140194.
Norm before scaling: 85.96495868139384. Distance: 19.461331100495798
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1938.5953677856553, distance: 1946.1330889741328
Total norm for 4 adversaries is: 1938.5953677856553. distance: 1946.1330889741328
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   1,  Average loss: 0.2303, Accuracy: 97/546 (17.7656%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   2,  Average loss: 0.0448, Accuracy: 113/546 (20.6960%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   3,  Average loss: 0.0379, Accuracy: 109/546 (19.9634%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   4,  Average loss: 0.0330, Accuracy: 177/546 (32.4176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   5,  Average loss: 0.0314, Accuracy: 186/546 (34.0659%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   6,  Average loss: 0.0306, Accuracy: 188/546 (34.4322%), train_poison_data_count: 45
Global model norm: 85.89432438140194.
Norm before scaling: 87.15998389724926. Distance: 26.127639856158556
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2605.292977766608, distance: 2612.763957957167
Total norm for 4 adversaries is: 2605.292977766608. distance: 2612.763957957167
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 214, local model 80, internal_epoch   1,  Average loss: 0.3372, Accuracy: 61/363 (16.8044%)
___Train Local_ResNet_18,  epoch 214, local model 80, internal_epoch   2,  Average loss: 0.0368, Accuracy: 101/363 (27.8237%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   1,  Average loss: 0.2908, Accuracy: 24/440 (5.4545%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   2,  Average loss: 0.0397, Accuracy: 127/440 (28.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 44, internal_epoch   1,  Average loss: 0.2489, Accuracy: 48/436 (11.0092%)
___Train Local_ResNet_18,  epoch 214, local model 44, internal_epoch   2,  Average loss: 0.0411, Accuracy: 193/436 (44.2661%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 35, internal_epoch   1,  Average loss: 0.2442, Accuracy: 49/419 (11.6945%)
___Train Local_ResNet_18,  epoch 214, local model 35, internal_epoch   2,  Average loss: 0.0331, Accuracy: 198/419 (47.2554%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 68, internal_epoch   1,  Average loss: 0.2451, Accuracy: 34/416 (8.1731%)
___Train Local_ResNet_18,  epoch 214, local model 68, internal_epoch   2,  Average loss: 0.0483, Accuracy: 60/416 (14.4231%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 214, local model 25, internal_epoch   1,  Average loss: 0.2180, Accuracy: 128/545 (23.4862%)
___Train Local_ResNet_18,  epoch 214, local model 25, internal_epoch   2,  Average loss: 0.0308, Accuracy: 200/545 (36.6972%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 370.25370836257935
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 214: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 455.98421478271484 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:215 choose agents : [17, 33, 77, 11, 4, 79, 43, 63, 35, 49]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   1,  Average loss: 0.0755, Accuracy: 59/526 (11.2167%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   2,  Average loss: 0.0507, Accuracy: 181/526 (34.4106%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   3,  Average loss: 0.0354, Accuracy: 181/526 (34.4106%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   4,  Average loss: 0.0299, Accuracy: 174/526 (33.0798%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   5,  Average loss: 0.0283, Accuracy: 183/526 (34.7909%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   6,  Average loss: 0.0285, Accuracy: 188/526 (35.7414%), train_poison_data_count: 45
Global model norm: 118.63214134852957.
Norm before scaling: 117.17764958600253. Distance: 5.06952133236528
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 483.9479407694592, distance: 506.95216736887517
Total norm for 4 adversaries is: 483.9479407694592. distance: 506.95216736887517
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   1,  Average loss: 0.0648, Accuracy: 140/527 (26.5655%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   2,  Average loss: 0.0514, Accuracy: 184/527 (34.9146%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   3,  Average loss: 0.0377, Accuracy: 159/527 (30.1708%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   4,  Average loss: 0.0291, Accuracy: 161/527 (30.5503%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   5,  Average loss: 0.0283, Accuracy: 199/527 (37.7609%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   6,  Average loss: 0.0282, Accuracy: 182/527 (34.5351%), train_poison_data_count: 45
Global model norm: 118.63214134852957.
Norm before scaling: 117.18011226713132. Distance: 5.054960311296153
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 482.497878881348, distance: 505.49604350578255
Total norm for 4 adversaries is: 482.497878881348. distance: 505.49604350578255
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   1,  Average loss: 0.0806, Accuracy: 61/496 (12.2984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   2,  Average loss: 0.0676, Accuracy: 65/496 (13.1048%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   3,  Average loss: 0.0515, Accuracy: 122/496 (24.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   4,  Average loss: 0.0400, Accuracy: 125/496 (25.2016%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   5,  Average loss: 0.0330, Accuracy: 100/496 (20.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   6,  Average loss: 0.0315, Accuracy: 128/496 (25.8065%), train_poison_data_count: 40
Global model norm: 118.63214134852957.
Norm before scaling: 117.26358363479687. Distance: 5.913758042031099
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 572.728556997117, distance: 591.3758322758887
Total norm for 4 adversaries is: 572.728556997117. distance: 591.3758322758887
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   1,  Average loss: 0.0505, Accuracy: 186/546 (34.0659%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   2,  Average loss: 0.0455, Accuracy: 186/546 (34.0659%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   3,  Average loss: 0.0373, Accuracy: 145/546 (26.5568%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   4,  Average loss: 0.0323, Accuracy: 188/546 (34.4322%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   5,  Average loss: 0.0305, Accuracy: 192/546 (35.1648%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   6,  Average loss: 0.0291, Accuracy: 181/546 (33.1502%), train_poison_data_count: 45
Global model norm: 118.63214134852957.
Norm before scaling: 117.17081964620074. Distance: 4.1216495663393165
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 384.4429411499189, distance: 412.1649586330696
Total norm for 4 adversaries is: 384.4429411499189. distance: 412.1649586330696
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 215, local model 4, internal_epoch   1,  Average loss: 0.0808, Accuracy: 207/557 (37.1634%)
___Train Local_ResNet_18,  epoch 215, local model 4, internal_epoch   2,  Average loss: 0.0439, Accuracy: 198/557 (35.5476%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 79, internal_epoch   1,  Average loss: 0.1596, Accuracy: 13/154 (8.4416%)
___Train Local_ResNet_18,  epoch 215, local model 79, internal_epoch   2,  Average loss: 0.1060, Accuracy: 13/154 (8.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 43, internal_epoch   1,  Average loss: 0.1286, Accuracy: 8/345 (2.3188%)
___Train Local_ResNet_18,  epoch 215, local model 43, internal_epoch   2,  Average loss: 0.0626, Accuracy: 79/345 (22.8986%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 63, internal_epoch   1,  Average loss: 0.0953, Accuracy: 83/752 (11.0372%)
___Train Local_ResNet_18,  epoch 215, local model 63, internal_epoch   2,  Average loss: 0.0475, Accuracy: 133/752 (17.6862%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 35, internal_epoch   1,  Average loss: 0.1586, Accuracy: 2/419 (0.4773%)
___Train Local_ResNet_18,  epoch 215, local model 35, internal_epoch   2,  Average loss: 0.0837, Accuracy: 24/419 (5.7279%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 215, local model 49, internal_epoch   1,  Average loss: 0.1121, Accuracy: 21/426 (4.9296%)
___Train Local_ResNet_18,  epoch 215, local model 49, internal_epoch   2,  Average loss: 0.0559, Accuracy: 87/426 (20.4225%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 354.6663224697113
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 215: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 440.19477105140686 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:216 choose agents : [17, 33, 77, 11, 8, 12, 18, 94, 57, 83]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   1,  Average loss: 0.2519, Accuracy: 107/526 (20.3422%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   2,  Average loss: 0.0427, Accuracy: 77/526 (14.6388%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   3,  Average loss: 0.0336, Accuracy: 178/526 (33.8403%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   4,  Average loss: 0.0313, Accuracy: 181/526 (34.4106%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   5,  Average loss: 0.0294, Accuracy: 199/526 (37.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   6,  Average loss: 0.0296, Accuracy: 184/526 (34.9810%), train_poison_data_count: 45
Global model norm: 113.83364455560799.
Norm before scaling: 112.82271854689773. Distance: 19.153850660302943
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1903.1703812323267, distance: 1915.3848829934939
Total norm for 4 adversaries is: 1903.1703812323267. distance: 1915.3848829934939
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   1,  Average loss: 0.2589, Accuracy: 87/527 (16.5085%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   2,  Average loss: 0.0465, Accuracy: 96/527 (18.2163%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   3,  Average loss: 0.0398, Accuracy: 204/527 (38.7097%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   4,  Average loss: 0.0360, Accuracy: 204/527 (38.7097%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   5,  Average loss: 0.0304, Accuracy: 202/527 (38.3302%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   6,  Average loss: 0.0286, Accuracy: 196/527 (37.1917%), train_poison_data_count: 45
Global model norm: 113.83364455560799.
Norm before scaling: 112.87448954757227. Distance: 20.065692588170705
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1994.3096549934266, distance: 2006.5693359562733
Total norm for 4 adversaries is: 1994.3096549934266. distance: 2006.5693359562733
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   1,  Average loss: 0.2299, Accuracy: 111/496 (22.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   2,  Average loss: 0.0415, Accuracy: 146/496 (29.4355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   3,  Average loss: 0.0351, Accuracy: 118/496 (23.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   4,  Average loss: 0.0335, Accuracy: 122/496 (24.5968%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   5,  Average loss: 0.0318, Accuracy: 139/496 (28.0242%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   6,  Average loss: 0.0313, Accuracy: 144/496 (29.0323%), train_poison_data_count: 40
Global model norm: 113.83364455560799.
Norm before scaling: 112.84497887727437. Distance: 17.11585565049079
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1700.2285875728592, distance: 1711.5856683204613
Total norm for 4 adversaries is: 1700.2285875728592. distance: 1711.5856683204613
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   1,  Average loss: 0.2793, Accuracy: 90/546 (16.4835%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   2,  Average loss: 0.0505, Accuracy: 112/546 (20.5128%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   3,  Average loss: 0.0349, Accuracy: 139/546 (25.4579%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   4,  Average loss: 0.0317, Accuracy: 137/546 (25.0916%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   5,  Average loss: 0.0302, Accuracy: 193/546 (35.3480%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   6,  Average loss: 0.0297, Accuracy: 187/546 (34.2491%), train_poison_data_count: 45
Global model norm: 113.83364455560799.
Norm before scaling: 113.0244805479105. Distance: 21.415213964846494
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2129.519664149641, distance: 2141.5213050539564
Total norm for 4 adversaries is: 2129.519664149641. distance: 2141.5213050539564
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 216, local model 8, internal_epoch   1,  Average loss: 0.1701, Accuracy: 83/534 (15.5431%)
___Train Local_ResNet_18,  epoch 216, local model 8, internal_epoch   2,  Average loss: 0.0418, Accuracy: 107/534 (20.0375%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 216, local model 12, internal_epoch   1,  Average loss: 0.1377, Accuracy: 254/977 (25.9980%)
___Train Local_ResNet_18,  epoch 216, local model 12, internal_epoch   2,  Average loss: 0.0309, Accuracy: 357/977 (36.5404%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 216, local model 18, internal_epoch   1,  Average loss: 0.3417, Accuracy: 21/386 (5.4404%)
___Train Local_ResNet_18,  epoch 216, local model 18, internal_epoch   2,  Average loss: 0.0536, Accuracy: 47/386 (12.1762%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 216, local model 94, internal_epoch   1,  Average loss: 0.4047, Accuracy: 39/203 (19.2118%)
___Train Local_ResNet_18,  epoch 216, local model 94, internal_epoch   2,  Average loss: 0.0601, Accuracy: 17/203 (8.3744%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 216, local model 57, internal_epoch   1,  Average loss: 0.2839, Accuracy: 47/290 (16.2069%)
___Train Local_ResNet_18,  epoch 216, local model 57, internal_epoch   2,  Average loss: 0.0547, Accuracy: 87/290 (30.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 216, local model 83, internal_epoch   1,  Average loss: 0.3083, Accuracy: 33/366 (9.0164%)
___Train Local_ResNet_18,  epoch 216, local model 83, internal_epoch   2,  Average loss: 0.0542, Accuracy: 51/366 (13.9344%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 400.7872622013092
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 216: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 490.53170561790466 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:217 choose agents : [17, 33, 77, 11, 37, 22, 38, 65, 29, 18]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   1,  Average loss: 0.0852, Accuracy: 58/526 (11.0266%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   2,  Average loss: 0.0424, Accuracy: 151/526 (28.7072%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   3,  Average loss: 0.0353, Accuracy: 181/526 (34.4106%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   4,  Average loss: 0.0313, Accuracy: 174/526 (33.0798%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   5,  Average loss: 0.0303, Accuracy: 187/526 (35.5513%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   6,  Average loss: 0.0289, Accuracy: 186/526 (35.3612%), train_poison_data_count: 45
Global model norm: 128.54700319824653.
Norm before scaling: 127.26954893428946. Distance: 11.826856174721119
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1169.8729631887388, distance: 1182.6855034200767
Total norm for 4 adversaries is: 1169.8729631887388. distance: 1182.6855034200767
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   1,  Average loss: 0.0777, Accuracy: 132/527 (25.0474%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   2,  Average loss: 0.0398, Accuracy: 192/527 (36.4326%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   3,  Average loss: 0.0363, Accuracy: 204/527 (38.7097%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   4,  Average loss: 0.0322, Accuracy: 205/527 (38.8994%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   5,  Average loss: 0.0301, Accuracy: 208/527 (39.4687%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   6,  Average loss: 0.0298, Accuracy: 198/527 (37.5712%), train_poison_data_count: 45
Global model norm: 128.54700319824653.
Norm before scaling: 127.25225240516373. Distance: 11.405783782209946
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1127.5257757585855, distance: 1140.5782524667038
Total norm for 4 adversaries is: 1127.5257757585855. distance: 1140.5782524667038
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   1,  Average loss: 0.1035, Accuracy: 58/496 (11.6935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   2,  Average loss: 0.0569, Accuracy: 85/496 (17.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   3,  Average loss: 0.0472, Accuracy: 106/496 (21.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   4,  Average loss: 0.0380, Accuracy: 107/496 (21.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   5,  Average loss: 0.0338, Accuracy: 112/496 (22.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   6,  Average loss: 0.0324, Accuracy: 132/496 (26.6129%), train_poison_data_count: 40
Global model norm: 128.54700319824653.
Norm before scaling: 127.3151041400332. Distance: 11.513687612637675
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1139.0339108209203, distance: 1151.3687506615768
Total norm for 4 adversaries is: 1139.0339108209203. distance: 1151.3687506615768
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   1,  Average loss: 0.0754, Accuracy: 190/546 (34.7985%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   2,  Average loss: 0.0418, Accuracy: 183/546 (33.5165%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   3,  Average loss: 0.0371, Accuracy: 180/546 (32.9670%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   4,  Average loss: 0.0333, Accuracy: 186/546 (34.0659%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   5,  Average loss: 0.0312, Accuracy: 184/546 (33.6996%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   6,  Average loss: 0.0305, Accuracy: 186/546 (34.0659%), train_poison_data_count: 45
Global model norm: 128.54700319824653.
Norm before scaling: 127.19846773964103. Distance: 10.802324567631409
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1066.4283262366955, distance: 1080.2324981225106
Total norm for 4 adversaries is: 1066.4283262366955. distance: 1080.2324981225106
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 217, local model 37, internal_epoch   1,  Average loss: 0.0936, Accuracy: 121/725 (16.6897%)
___Train Local_ResNet_18,  epoch 217, local model 37, internal_epoch   2,  Average loss: 0.0368, Accuracy: 226/725 (31.1724%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 217, local model 22, internal_epoch   1,  Average loss: 0.1133, Accuracy: 137/494 (27.7328%)
___Train Local_ResNet_18,  epoch 217, local model 22, internal_epoch   2,  Average loss: 0.0504, Accuracy: 141/494 (28.5425%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 217, local model 38, internal_epoch   1,  Average loss: 0.0947, Accuracy: 200/756 (26.4550%)
___Train Local_ResNet_18,  epoch 217, local model 38, internal_epoch   2,  Average loss: 0.0305, Accuracy: 276/756 (36.5079%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 217, local model 65, internal_epoch   1,  Average loss: 0.1426, Accuracy: 47/314 (14.9682%)
___Train Local_ResNet_18,  epoch 217, local model 65, internal_epoch   2,  Average loss: 0.0687, Accuracy: 42/314 (13.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 217, local model 29, internal_epoch   1,  Average loss: 0.0871, Accuracy: 110/848 (12.9717%)
___Train Local_ResNet_18,  epoch 217, local model 29, internal_epoch   2,  Average loss: 0.0294, Accuracy: 375/848 (44.2217%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 217, local model 18, internal_epoch   1,  Average loss: 0.0927, Accuracy: 100/386 (25.9067%)
___Train Local_ResNet_18,  epoch 217, local model 18, internal_epoch   2,  Average loss: 0.0519, Accuracy: 94/386 (24.3523%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 396.33886456489563
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 217: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 480.4688231945038 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:218 choose agents : [17, 33, 77, 11, 53, 15, 7, 29, 86, 60]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   1,  Average loss: 0.0965, Accuracy: 61/526 (11.5970%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   2,  Average loss: 0.0715, Accuracy: 162/526 (30.7985%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   3,  Average loss: 0.0501, Accuracy: 184/526 (34.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   4,  Average loss: 0.0364, Accuracy: 184/526 (34.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   5,  Average loss: 0.0322, Accuracy: 155/526 (29.4677%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   6,  Average loss: 0.0309, Accuracy: 198/526 (37.6426%), train_poison_data_count: 45
Global model norm: 129.24039646381854.
Norm before scaling: 127.55045723408834. Distance: 6.156657094130469
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 590.3903105150016, distance: 615.6657473824575
Total norm for 4 adversaries is: 590.3903105150016. distance: 615.6657473824575
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   1,  Average loss: 0.1206, Accuracy: 99/527 (18.7856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   2,  Average loss: 0.1049, Accuracy: 107/527 (20.3036%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   3,  Average loss: 0.0700, Accuracy: 118/527 (22.3909%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   4,  Average loss: 0.0403, Accuracy: 175/527 (33.2068%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   5,  Average loss: 0.0326, Accuracy: 153/527 (29.0323%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   6,  Average loss: 0.0296, Accuracy: 207/527 (39.2789%), train_poison_data_count: 45
Global model norm: 129.24039646381854.
Norm before scaling: 127.44534291094163. Distance: 7.760146359508697
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 752.8632428934221, distance: 776.014658366709
Total norm for 4 adversaries is: 752.8632428934221. distance: 776.014658366709
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   1,  Average loss: 0.0771, Accuracy: 141/496 (28.4274%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   2,  Average loss: 0.0651, Accuracy: 148/496 (29.8387%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   3,  Average loss: 0.0570, Accuracy: 128/496 (25.8065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   4,  Average loss: 0.0421, Accuracy: 119/496 (23.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   5,  Average loss: 0.0371, Accuracy: 132/496 (26.6129%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   6,  Average loss: 0.0357, Accuracy: 127/496 (25.6048%), train_poison_data_count: 40
Global model norm: 129.24039646381854.
Norm before scaling: 127.75472410541224. Distance: 5.410148141352226
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 517.9691110481397, distance: 541.0148449904125
Total norm for 4 adversaries is: 517.9691110481397. distance: 541.0148449904125
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   1,  Average loss: 0.1182, Accuracy: 106/546 (19.4139%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   2,  Average loss: 0.1021, Accuracy: 121/546 (22.1612%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   3,  Average loss: 0.0650, Accuracy: 113/546 (20.6960%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   4,  Average loss: 0.0384, Accuracy: 146/546 (26.7399%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   5,  Average loss: 0.0322, Accuracy: 155/546 (28.3883%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   6,  Average loss: 0.0303, Accuracy: 194/546 (35.5311%), train_poison_data_count: 45
Global model norm: 129.24039646381854.
Norm before scaling: 127.44115906345759. Distance: 6.9458661196674205
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 669.4369835914356, distance: 694.5866126697232
Total norm for 4 adversaries is: 669.4369835914356. distance: 694.5866126697232
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 218, local model 53, internal_epoch   1,  Average loss: 0.0956, Accuracy: 109/625 (17.4400%)
___Train Local_ResNet_18,  epoch 218, local model 53, internal_epoch   2,  Average loss: 0.0442, Accuracy: 193/625 (30.8800%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 218, local model 15, internal_epoch   1,  Average loss: 0.1441, Accuracy: 26/341 (7.6246%)
___Train Local_ResNet_18,  epoch 218, local model 15, internal_epoch   2,  Average loss: 0.0398, Accuracy: 169/341 (49.5601%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 218, local model 7, internal_epoch   1,  Average loss: 0.1519, Accuracy: 33/352 (9.3750%)
___Train Local_ResNet_18,  epoch 218, local model 7, internal_epoch   2,  Average loss: 0.0747, Accuracy: 79/352 (22.4432%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   1,  Average loss: 0.0855, Accuracy: 175/848 (20.6368%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   2,  Average loss: 0.0348, Accuracy: 330/848 (38.9151%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 218, local model 86, internal_epoch   1,  Average loss: 0.1914, Accuracy: 42/212 (19.8113%)
___Train Local_ResNet_18,  epoch 218, local model 86, internal_epoch   2,  Average loss: 0.1337, Accuracy: 46/212 (21.6981%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 218, local model 60, internal_epoch   1,  Average loss: 0.1786, Accuracy: 5/284 (1.7606%)
___Train Local_ResNet_18,  epoch 218, local model 60, internal_epoch   2,  Average loss: 0.1136, Accuracy: 19/284 (6.6901%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 367.26576232910156
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 218: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 451.6486141681671 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:219 choose agents : [17, 33, 77, 11, 81, 8, 28, 1, 93, 53]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   1,  Average loss: 0.4207, Accuracy: 81/526 (15.3992%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   2,  Average loss: 0.0369, Accuracy: 99/526 (18.8213%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   3,  Average loss: 0.0340, Accuracy: 199/526 (37.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   4,  Average loss: 0.0322, Accuracy: 231/526 (43.9163%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   5,  Average loss: 0.0330, Accuracy: 217/526 (41.2548%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   6,  Average loss: 0.0314, Accuracy: 209/526 (39.7338%), train_poison_data_count: 45
Global model norm: 124.07924556382304.
Norm before scaling: 124.25618932647782. Distance: 30.48251992529643
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 3036.2330279476246, distance: 3048.25163003319
Total norm for 4 adversaries is: 3036.2330279476246. distance: 3048.25163003319
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   1,  Average loss: 0.3767, Accuracy: 165/527 (31.3093%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   2,  Average loss: 0.0537, Accuracy: 205/527 (38.8994%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   3,  Average loss: 0.0477, Accuracy: 206/527 (39.0892%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   4,  Average loss: 0.0453, Accuracy: 202/527 (38.3302%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   5,  Average loss: 0.0415, Accuracy: 206/527 (39.0892%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   6,  Average loss: 0.0376, Accuracy: 204/527 (38.7097%), train_poison_data_count: 45
Global model norm: 124.07924556382304.
Norm before scaling: 123.86682853345968. Distance: 28.686750015727537
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2856.069326889668, distance: 2868.675129741951
Total norm for 4 adversaries is: 2856.069326889668. distance: 2868.675129741951
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   1,  Average loss: 0.5084, Accuracy: 75/496 (15.1210%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   2,  Average loss: 0.0578, Accuracy: 108/496 (21.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   3,  Average loss: 0.0526, Accuracy: 146/496 (29.4355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   4,  Average loss: 0.0492, Accuracy: 133/496 (26.8145%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   5,  Average loss: 0.0460, Accuracy: 129/496 (26.0081%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   6,  Average loss: 0.0419, Accuracy: 135/496 (27.2177%), train_poison_data_count: 40
Global model norm: 124.07924556382304.
Norm before scaling: 124.89313400613743. Distance: 34.037998283513055
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 3391.998525943076, distance: 3403.7999353663545
Total norm for 4 adversaries is: 3391.998525943076. distance: 3403.7999353663545
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   1,  Average loss: 0.3857, Accuracy: 136/546 (24.9084%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   2,  Average loss: 0.0594, Accuracy: 104/546 (19.0476%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   3,  Average loss: 0.0516, Accuracy: 145/546 (26.5568%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   4,  Average loss: 0.0462, Accuracy: 136/546 (24.9084%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   5,  Average loss: 0.0405, Accuracy: 145/546 (26.5568%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   6,  Average loss: 0.0371, Accuracy: 192/546 (35.1648%), train_poison_data_count: 45
Global model norm: 124.07924556382304.
Norm before scaling: 123.44777251559665. Distance: 26.7527276190409
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 2661.818739133076, distance: 2675.2728832775174
Total norm for 4 adversaries is: 2661.818739133076. distance: 2675.2728832775174
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 219, local model 81, internal_epoch   1,  Average loss: 0.1875, Accuracy: 439/1034 (42.4565%)
___Train Local_ResNet_18,  epoch 219, local model 81, internal_epoch   2,  Average loss: 0.0358, Accuracy: 510/1034 (49.3230%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 219, local model 8, internal_epoch   1,  Average loss: 0.3943, Accuracy: 81/534 (15.1685%)
___Train Local_ResNet_18,  epoch 219, local model 8, internal_epoch   2,  Average loss: 0.0505, Accuracy: 90/534 (16.8539%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 219, local model 28, internal_epoch   1,  Average loss: 0.3703, Accuracy: 85/423 (20.0946%)
___Train Local_ResNet_18,  epoch 219, local model 28, internal_epoch   2,  Average loss: 0.0584, Accuracy: 94/423 (22.2222%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 219, local model 1, internal_epoch   1,  Average loss: 0.3099, Accuracy: 121/641 (18.8768%)
___Train Local_ResNet_18,  epoch 219, local model 1, internal_epoch   2,  Average loss: 0.0459, Accuracy: 152/641 (23.7129%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 219, local model 93, internal_epoch   1,  Average loss: 0.3394, Accuracy: 90/584 (15.4110%)
___Train Local_ResNet_18,  epoch 219, local model 93, internal_epoch   2,  Average loss: 0.0433, Accuracy: 207/584 (35.4452%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 219, local model 53, internal_epoch   1,  Average loss: 0.3434, Accuracy: 77/625 (12.3200%)
___Train Local_ResNet_18,  epoch 219, local model 53, internal_epoch   2,  Average loss: 0.0399, Accuracy: 209/625 (33.4400%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 429.93355226516724
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 219: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 514.4599299430847 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:220 choose agents : [17, 33, 77, 11, 12, 50, 10, 18, 39, 62]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   1,  Average loss: 0.0598, Accuracy: 104/526 (19.7719%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   2,  Average loss: 0.0441, Accuracy: 199/526 (37.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   3,  Average loss: 0.0371, Accuracy: 214/526 (40.6844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   4,  Average loss: 0.0343, Accuracy: 256/526 (48.6692%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   5,  Average loss: 0.0329, Accuracy: 246/526 (46.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   6,  Average loss: 0.0298, Accuracy: 251/526 (47.7186%), train_poison_data_count: 45
Global model norm: 162.46565141784586.
Norm before scaling: 160.55076713651977. Distance: 5.934794562495271
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 559.6759944378533, distance: 593.4794646826459
Total norm for 4 adversaries is: 559.6759944378533. distance: 593.4794646826459
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   1,  Average loss: 0.0792, Accuracy: 103/527 (19.5446%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   2,  Average loss: 0.0638, Accuracy: 117/527 (22.2011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   3,  Average loss: 0.0530, Accuracy: 134/527 (25.4269%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   4,  Average loss: 0.0431, Accuracy: 143/527 (27.1347%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   5,  Average loss: 0.0344, Accuracy: 146/527 (27.7040%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   6,  Average loss: 0.0301, Accuracy: 171/527 (32.4478%), train_poison_data_count: 45
Global model norm: 162.46565141784586.
Norm before scaling: 160.48459330259712. Distance: 8.681085427621372
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 841.7202623199705, distance: 868.1085401607336
Total norm for 4 adversaries is: 841.7202623199705. distance: 868.1085401607336
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   1,  Average loss: 0.0653, Accuracy: 141/496 (28.4274%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   2,  Average loss: 0.0492, Accuracy: 134/496 (27.0161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   3,  Average loss: 0.0410, Accuracy: 151/496 (30.4435%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   4,  Average loss: 0.0378, Accuracy: 185/496 (37.2984%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   5,  Average loss: 0.0336, Accuracy: 203/496 (40.9274%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   6,  Average loss: 0.0311, Accuracy: 199/496 (40.1210%), train_poison_data_count: 40
Global model norm: 162.46565141784586.
Norm before scaling: 160.79961933451523. Distance: 5.754148893814575
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 548.0234084872652, distance: 575.4149046557623
Total norm for 4 adversaries is: 548.0234084872652. distance: 575.4149046557623
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   1,  Average loss: 0.0523, Accuracy: 106/546 (19.4139%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   2,  Average loss: 0.0400, Accuracy: 151/546 (27.6557%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   3,  Average loss: 0.0366, Accuracy: 209/546 (38.2784%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   4,  Average loss: 0.0358, Accuracy: 204/546 (37.3626%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   5,  Average loss: 0.0331, Accuracy: 223/546 (40.8425%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   6,  Average loss: 0.0322, Accuracy: 221/546 (40.4762%), train_poison_data_count: 45
Global model norm: 162.46565141784586.
Norm before scaling: 160.54708713489634. Distance: 5.281586224388872
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 490.4952535448228, distance: 528.1586231900412
Total norm for 4 adversaries is: 490.4952535448228. distance: 528.1586231900412
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 220, local model 12, internal_epoch   1,  Average loss: 0.1570, Accuracy: 55/977 (5.6295%)
___Train Local_ResNet_18,  epoch 220, local model 12, internal_epoch   2,  Average loss: 0.0373, Accuracy: 304/977 (31.1157%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 220, local model 50, internal_epoch   1,  Average loss: 0.2458, Accuracy: 60/401 (14.9626%)
___Train Local_ResNet_18,  epoch 220, local model 50, internal_epoch   2,  Average loss: 0.0641, Accuracy: 146/401 (36.4090%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 220, local model 10, internal_epoch   1,  Average loss: 0.1194, Accuracy: 314/752 (41.7553%)
___Train Local_ResNet_18,  epoch 220, local model 10, internal_epoch   2,  Average loss: 0.0232, Accuracy: 403/752 (53.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   1,  Average loss: 0.2544, Accuracy: 4/386 (1.0363%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   2,  Average loss: 0.0781, Accuracy: 100/386 (25.9067%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 220, local model 39, internal_epoch   1,  Average loss: 0.3535, Accuracy: 7/217 (3.2258%)
___Train Local_ResNet_18,  epoch 220, local model 39, internal_epoch   2,  Average loss: 0.1137, Accuracy: 13/217 (5.9908%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 220, local model 62, internal_epoch   1,  Average loss: 0.2202, Accuracy: 30/358 (8.3799%)
___Train Local_ResNet_18,  epoch 220, local model 62, internal_epoch   2,  Average loss: 0.0621, Accuracy: 85/358 (23.7430%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 432.5832152366638
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 220: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 543.7857763767242 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:221 choose agents : [17, 33, 77, 11, 65, 87, 12, 74, 4, 7]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   1,  Average loss: 0.1298, Accuracy: 90/526 (17.1103%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   2,  Average loss: 0.0916, Accuracy: 93/526 (17.6806%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   3,  Average loss: 0.0525, Accuracy: 110/526 (20.9125%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   4,  Average loss: 0.0400, Accuracy: 178/526 (33.8403%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   5,  Average loss: 0.0354, Accuracy: 182/526 (34.6008%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   6,  Average loss: 0.0333, Accuracy: 183/526 (34.7909%), train_poison_data_count: 45
Global model norm: 155.91499086040443.
Norm before scaling: 153.89361305988302. Distance: 10.592508338923139
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1035.6050164034548, distance: 1059.2507965538662
Total norm for 4 adversaries is: 1035.6050164034548. distance: 1059.2507965538662
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   1,  Average loss: 0.1092, Accuracy: 200/527 (37.9507%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   2,  Average loss: 0.0898, Accuracy: 194/527 (36.8121%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   3,  Average loss: 0.0606, Accuracy: 201/527 (38.1404%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   4,  Average loss: 0.0448, Accuracy: 211/527 (40.0380%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   5,  Average loss: 0.0420, Accuracy: 207/527 (39.2789%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   6,  Average loss: 0.0376, Accuracy: 147/527 (27.8937%), train_poison_data_count: 45
Global model norm: 155.91499086040443.
Norm before scaling: 153.83299970056814. Distance: 9.184819459755362
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 891.623869689456, distance: 918.4819336818771
Total norm for 4 adversaries is: 891.623869689456. distance: 918.4819336818771
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   1,  Average loss: 0.1295, Accuracy: 101/496 (20.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   2,  Average loss: 0.1023, Accuracy: 105/496 (21.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   3,  Average loss: 0.0687, Accuracy: 106/496 (21.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   4,  Average loss: 0.0522, Accuracy: 132/496 (26.6129%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   5,  Average loss: 0.0482, Accuracy: 134/496 (27.0161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   6,  Average loss: 0.0436, Accuracy: 134/496 (27.0161%), train_poison_data_count: 40
Global model norm: 155.91499086040443.
Norm before scaling: 154.03629341002724. Distance: 9.931331615460739
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 970.8396494787386, distance: 993.1330789476302
Total norm for 4 adversaries is: 970.8396494787386. distance: 993.1330789476302
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   1,  Average loss: 0.1333, Accuracy: 96/546 (17.5824%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   2,  Average loss: 0.0988, Accuracy: 94/546 (17.2161%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   3,  Average loss: 0.0599, Accuracy: 98/546 (17.9487%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   4,  Average loss: 0.0453, Accuracy: 129/546 (23.6264%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   5,  Average loss: 0.0423, Accuracy: 175/546 (32.0513%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   6,  Average loss: 0.0404, Accuracy: 188/546 (34.4322%), train_poison_data_count: 45
Global model norm: 155.91499086040443.
Norm before scaling: 153.83759572801117. Distance: 10.81350156522272
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 1057.1596970183832, distance: 1081.3501976695616
Total norm for 4 adversaries is: 1057.1596970183832. distance: 1081.3501976695616
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 221, local model 65, internal_epoch   1,  Average loss: 0.2381, Accuracy: 16/314 (5.0955%)
___Train Local_ResNet_18,  epoch 221, local model 65, internal_epoch   2,  Average loss: 0.1011, Accuracy: 28/314 (8.9172%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 221, local model 87, internal_epoch   1,  Average loss: 0.1916, Accuracy: 68/397 (17.1285%)
___Train Local_ResNet_18,  epoch 221, local model 87, internal_epoch   2,  Average loss: 0.0931, Accuracy: 53/397 (13.3501%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 221, local model 12, internal_epoch   1,  Average loss: 0.1031, Accuracy: 415/977 (42.4770%)
___Train Local_ResNet_18,  epoch 221, local model 12, internal_epoch   2,  Average loss: 0.0417, Accuracy: 336/977 (34.3910%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 221, local model 74, internal_epoch   1,  Average loss: 0.2382, Accuracy: 24/469 (5.1173%)
___Train Local_ResNet_18,  epoch 221, local model 74, internal_epoch   2,  Average loss: 0.0993, Accuracy: 44/469 (9.3817%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 221, local model 4, internal_epoch   1,  Average loss: 0.2566, Accuracy: 2/557 (0.3591%)
___Train Local_ResNet_18,  epoch 221, local model 4, internal_epoch   2,  Average loss: 0.0836, Accuracy: 50/557 (8.9767%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 221, local model 7, internal_epoch   1,  Average loss: 0.2209, Accuracy: 43/352 (12.2159%)
___Train Local_ResNet_18,  epoch 221, local model 7, internal_epoch   2,  Average loss: 0.1100, Accuracy: 83/352 (23.5795%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
time spent on training: 353.8828399181366
----------------------------------End one training epoch------------------------------------------
___Test Target_ResNet_18 poisoned: False, epoch: 221: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Done in 436.66574716567993 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:222 choose agents : [17, 33, 77, 11, 35, 30, 72, 51, 63, 46]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   1,  Average loss: 0.1106, Accuracy: 186/526 (35.3612%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   2,  Average loss: 0.0990, Accuracy: 183/526 (34.7909%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   3,  Average loss: 0.0827, Accuracy: 184/526 (34.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   4,  Average loss: 0.0814, Accuracy: 186/526 (35.3612%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   5,  Average loss: 0.0725, Accuracy: 182/526 (34.6008%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   6,  Average loss: 0.0704, Accuracy: 184/526 (34.9810%), train_poison_data_count: 45
Global model norm: 151.3796835567772.
Norm before scaling: 149.15121835741067. Distance: 7.09976895453392
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: nan, Accuracy: 1000/10000 (10.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
Scaling by  100
Scaled Norm after poisoning: 674.514478161885, distance: 709.9768922295992
Total norm for 4 adversaries is: 674.514478161885. distance: 709.9768922295992
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   1,  Average loss: 0.2092, Accuracy: 114/527 (21.6319%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   2,  Average loss: 0.1868, Accuracy: 130/527 (24.6679%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   3,  Average loss: 0.1654, Accuracy: 145/527 (27.5142%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   4,  Average loss: 0.1672, Accuracy: 140/527 (26.5655%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   5,  Average loss: 0.1480, Accuracy: 108/527 (20.4934%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   6,  Average loss: 0.1407, Accuracy: 113/527 (21.4421%), train_poison_data_count: 45
Global model norm: 151.3796835567772.
Norm before scaling: 148.41978841700995. Distance: 9.79802048601328
will scale.
