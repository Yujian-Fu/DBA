current path: saved_models/model_mnist_Nov.13_09.40.34
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [41, 73, 51, 74]
We use following environment for graphs:  mnist_DBA
----------------------------------Start one training epoch------------------------------------------
Server Epoch:11 choose agents : [41, 73, 51, 74, 23, 76, 63, 11, 75, 43]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   1,  Average loss: 0.0240, Accuracy: 353/606 (58.2508%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   2,  Average loss: 0.0115, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   3,  Average loss: 0.0065, Accuracy: 540/606 (89.1089%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   4,  Average loss: 0.0040, Accuracy: 551/606 (90.9241%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   5,  Average loss: 0.0035, Accuracy: 563/606 (92.9043%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   6,  Average loss: 0.0028, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   7,  Average loss: 0.0027, Accuracy: 576/606 (95.0495%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   8,  Average loss: 0.0024, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch   9,  Average loss: 0.0026, Accuracy: 578/606 (95.3795%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 41, internal_epoch  10,  Average loss: 0.0019, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Global model norm: 16.539532092117113.
Norm before scaling: 16.866335304432983. Distance: 4.737173329869465
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.9672, Accuracy: 6701/10000 (67.0100%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0508, Accuracy: 8825/8968 (98.4054%)
Scaling by  100
Scaled Norm after poisoning: 472.7888502016519, distance: 473.71731417587006
Total norm for 4 adversaries is: 472.7888502016519. distance: 473.71731417587006
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   1,  Average loss: 0.0234, Accuracy: 360/591 (60.9137%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   2,  Average loss: 0.0137, Accuracy: 367/591 (62.0981%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   3,  Average loss: 0.0040, Accuracy: 547/591 (92.5550%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   4,  Average loss: 0.0037, Accuracy: 556/591 (94.0778%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   5,  Average loss: 0.0032, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   6,  Average loss: 0.0025, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   7,  Average loss: 0.0021, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   8,  Average loss: 0.0021, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch   9,  Average loss: 0.0017, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 73, internal_epoch  10,  Average loss: 0.0017, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Global model norm: 16.539532092117113.
Norm before scaling: 16.754975903572554. Distance: 4.159880694365816
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.5479, Accuracy: 8257/10000 (82.5700%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0454, Accuracy: 8864/8968 (98.8403%)
Scaling by  100
Scaled Norm after poisoning: 415.0981246946317, distance: 415.9880557179497
Total norm for 4 adversaries is: 415.0981246946317. distance: 415.9880557179497
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0239, Accuracy: 323/568 (56.8662%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   2,  Average loss: 0.0101, Accuracy: 421/568 (74.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   3,  Average loss: 0.0050, Accuracy: 525/568 (92.4296%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   4,  Average loss: 0.0038, Accuracy: 534/568 (94.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   5,  Average loss: 0.0029, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   6,  Average loss: 0.0027, Accuracy: 542/568 (95.4225%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   7,  Average loss: 0.0022, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   8,  Average loss: 0.0019, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   9,  Average loss: 0.0019, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch  10,  Average loss: 0.0018, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.8163404651733. Distance: 4.610481569040474
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.9368, Accuracy: 6756/10000 (67.5600%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0755, Accuracy: 8732/8968 (97.3684%)
Scaling by  100
Scaled Norm after poisoning: 460.0398080601286, distance: 461.0481435002206
Total norm for 4 adversaries is: 460.0398080601286. distance: 461.0481435002206
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   1,  Average loss: 0.0267, Accuracy: 303/557 (54.3986%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   2,  Average loss: 0.0120, Accuracy: 388/557 (69.6589%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   3,  Average loss: 0.0056, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   4,  Average loss: 0.0044, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   5,  Average loss: 0.0035, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   6,  Average loss: 0.0034, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   7,  Average loss: 0.0024, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   8,  Average loss: 0.0026, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch   9,  Average loss: 0.0022, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 74, internal_epoch  10,  Average loss: 0.0026, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Global model norm: 16.539532092117113.
Norm before scaling: 16.851504549042684. Distance: 4.817283729881362
will scale.
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.9723, Accuracy: 7378/10000 (73.7800%)
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0549, Accuracy: 8782/8968 (97.9260%)
Scaling by  100
Scaled Norm after poisoning: 480.68374153386964, distance: 481.72838236396245
Total norm for 4 adversaries is: 480.68374153386964. distance: 481.72838236396245
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1213, Accuracy: 9577/10000 (95.7700%)
___Train Local_Simple,  epoch  11, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.0957, Accuracy: 9719/10000 (97.1900%)
___Train Local_Simple,  epoch  11, local model 63, internal_epoch   1,  Average loss: 0.0020, Accuracy: 857/889 (96.4004%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1366, Accuracy: 9601/10000 (96.0100%)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0017, Accuracy: 626/645 (97.0543%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1996, Accuracy: 9381/10000 (93.8100%)
___Train Local_Simple,  epoch  11, local model 75, internal_epoch   1,  Average loss: 0.0010, Accuracy: 669/686 (97.5219%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1799, Accuracy: 9447/10000 (94.4700%)
___Train Local_Simple,  epoch  11, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 398/408 (97.5490%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3283, Accuracy: 8975/10000 (89.7500%)
time spent on training: 118.68367123603821
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.43638413831986467  data num: [606, 591, 568, 557, 293, 78, 889, 645, 686, 408]
[rfa agg] considering poison per batch poison_fraction: 0.13637004322495772
[rfa agg] init. name: [41, 73, 51, 74, 23, 76, 63, 11, 75, 43], weight: tensor([0.1139, 0.1111, 0.1067, 0.1047, 0.0551, 0.0147, 0.1671, 0.1212, 0.1289,
        0.0767])
[rfa agg] iter:  0, prev_obj_val: 239.932373046875, obj_val: 222.5976104736328, abs dis: 17.334762573242188
[rfa agg] iter:  0, weight: tensor([0.0661, 0.0758, 0.0659, 0.0597, 0.0715, 0.0191, 0.2173, 0.1575, 0.1675,
        0.0996])
[rfa agg] iter:  1, prev_obj_val: 222.5976104736328, obj_val: 213.43067932128906, abs dis: 9.16693115234375
[rfa agg] iter:  1, weight: tensor([0.0412, 0.0472, 0.0405, 0.0372, 0.0814, 0.0217, 0.2475, 0.1793, 0.1906,
        0.1134])
[rfa agg] iter:  2, prev_obj_val: 213.43067932128906, obj_val: 208.10995483398438, abs dis: 5.3207244873046875
[rfa agg] iter:  2, weight: tensor([0.0258, 0.0292, 0.0251, 0.0233, 0.0875, 0.0233, 0.2663, 0.1927, 0.2048,
        0.1219])
[rfa agg] iter:  3, prev_obj_val: 208.10995483398438, obj_val: 204.91232299804688, abs dis: 3.1976318359375
[rfa agg] iter:  3, weight: tensor([0.0161, 0.0181, 0.0156, 0.0146, 0.0912, 0.0243, 0.2783, 0.2011, 0.2135,
        0.1272])
[rfa agg] iter:  4, prev_obj_val: 204.91232299804688, obj_val: 202.96136474609375, abs dis: 1.950958251953125
[rfa agg] iter:  4, weight: tensor([0.0101, 0.0113, 0.0097, 0.0091, 0.0934, 0.0250, 0.2860, 0.2062, 0.2188,
        0.1304])
[rfa agg] iter:  5, prev_obj_val: 202.96136474609375, obj_val: 201.7643585205078, abs dis: 1.1970062255859375
[rfa agg] iter:  5, weight: tensor([0.0063, 0.0070, 0.0061, 0.0057, 0.0947, 0.0254, 0.2914, 0.2093, 0.2217,
        0.1324])
[rfa agg] iter:  6, prev_obj_val: 201.7643585205078, obj_val: 201.03155517578125, abs dis: 0.7328033447265625
[rfa agg] iter:  6, weight: tensor([0.0039, 0.0044, 0.0038, 0.0036, 0.0953, 0.0256, 0.2956, 0.2110, 0.2232,
        0.1336])
[rfa agg] iter:  7, prev_obj_val: 201.03155517578125, obj_val: 200.58920288085938, abs dis: 0.442352294921875
[rfa agg] iter:  7, weight: tensor([0.0025, 0.0028, 0.0024, 0.0022, 0.0954, 0.0258, 0.2994, 0.2117, 0.2235,
        0.1343])
[rfa agg] iter:  8, prev_obj_val: 200.58920288085938, obj_val: 200.3323974609375, abs dis: 0.256805419921875
[rfa agg] iter:  8, weight: tensor([0.0016, 0.0018, 0.0015, 0.0014, 0.0954, 0.0261, 0.3030, 0.2114, 0.2231,
        0.1348])
[rfa agg] iter:  9, prev_obj_val: 200.3323974609375, obj_val: 200.19618225097656, abs dis: 0.1362152099609375
[rfa agg] iter:  9, weight: tensor([0.0010, 0.0011, 0.0010, 0.0009, 0.0954, 0.0264, 0.3063, 0.2099, 0.2223,
        0.1356])
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 0.0809, Accuracy: 9744/10000 (97.4400%)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 10.6716, Accuracy: 51/8968 (0.5687%)
Done in 144.61699795722961 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:12 choose agents : [41, 73, 51, 74, 46, 37, 21, 43, 35, 11]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0241, Accuracy: 333/606 (54.9505%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   2,  Average loss: 0.0099, Accuracy: 435/606 (71.7822%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   3,  Average loss: 0.0041, Accuracy: 556/606 (91.7492%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   4,  Average loss: 0.0032, Accuracy: 566/606 (93.3993%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   5,  Average loss: 0.0026, Accuracy: 575/606 (94.8845%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   6,  Average loss: 0.0026, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   7,  Average loss: 0.0020, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   8,  Average loss: 0.0019, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   9,  Average loss: 0.0016, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch  10,  Average loss: 0.0017, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Global model norm: 16.52265438451571.
Norm before scaling: 16.864654308387298. Distance: 4.6157304817600675
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.9018, Accuracy: 7256/10000 (72.5600%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0412, Accuracy: 8825/8968 (98.4054%)
Scaling by  100
Scaled Norm after poisoning: 460.79715236207784, distance: 461.5730575976028
Total norm for 4 adversaries is: 460.79715236207784. distance: 461.5730575976028
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   1,  Average loss: 0.0233, Accuracy: 367/591 (62.0981%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   2,  Average loss: 0.0115, Accuracy: 378/591 (63.9594%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   3,  Average loss: 0.0038, Accuracy: 547/591 (92.5550%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   4,  Average loss: 0.0032, Accuracy: 555/591 (93.9086%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   5,  Average loss: 0.0022, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   6,  Average loss: 0.0018, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   7,  Average loss: 0.0015, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   8,  Average loss: 0.0013, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch   9,  Average loss: 0.0011, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 73, internal_epoch  10,  Average loss: 0.0012, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Global model norm: 16.52265438451571.
Norm before scaling: 16.81904605078997. Distance: 3.848734531253803
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3774, Accuracy: 8870/10000 (88.7000%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0819, Accuracy: 8667/8968 (96.6436%)
Scaling by  100
Scaled Norm after poisoning: 384.5874819205638, distance: 384.87347758711564
Total norm for 4 adversaries is: 384.5874819205638. distance: 384.87347758711564
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   1,  Average loss: 0.0198, Accuracy: 358/568 (63.0282%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   2,  Average loss: 0.0074, Accuracy: 481/568 (84.6831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   3,  Average loss: 0.0035, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   4,  Average loss: 0.0033, Accuracy: 534/568 (94.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   5,  Average loss: 0.0033, Accuracy: 534/568 (94.0141%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   6,  Average loss: 0.0028, Accuracy: 536/568 (94.3662%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   7,  Average loss: 0.0025, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   8,  Average loss: 0.0022, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch   9,  Average loss: 0.0017, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 51, internal_epoch  10,  Average loss: 0.0018, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Global model norm: 16.52265438451571.
Norm before scaling: 16.756171612554432. Distance: 4.042168550037722
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.9883, Accuracy: 6363/10000 (63.6300%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0585, Accuracy: 8763/8968 (97.7141%)
Scaling by  100
Scaled Norm after poisoning: 403.4940752353125, distance: 404.2168547017801
Total norm for 4 adversaries is: 403.4940752353125. distance: 404.2168547017801
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   1,  Average loss: 0.0221, Accuracy: 319/557 (57.2711%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   2,  Average loss: 0.0096, Accuracy: 427/557 (76.6607%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   3,  Average loss: 0.0035, Accuracy: 521/557 (93.5368%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   4,  Average loss: 0.0028, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   5,  Average loss: 0.0025, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   6,  Average loss: 0.0022, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   7,  Average loss: 0.0023, Accuracy: 533/557 (95.6912%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch   9,  Average loss: 0.0016, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 74, internal_epoch  10,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Global model norm: 16.52265438451571.
Norm before scaling: 16.72389122177181. Distance: 3.7640205225775225
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.7015, Accuracy: 7884/10000 (78.8400%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0430, Accuracy: 8814/8968 (98.2828%)
Scaling by  100
Scaled Norm after poisoning: 375.770895127603, distance: 376.40204569050894
Total norm for 4 adversaries is: 375.770895127603. distance: 376.40204569050894
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  12, local model 46, internal_epoch   1,  Average loss: 0.0034, Accuracy: 676/710 (95.2113%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2089, Accuracy: 9354/10000 (93.5400%)
___Train Local_Simple,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0011, Accuracy: 844/860 (98.1395%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.4670, Accuracy: 8523/10000 (85.2300%)
___Train Local_Simple,  epoch  12, local model 21, internal_epoch   1,  Average loss: 0.0013, Accuracy: 304/312 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2230, Accuracy: 9316/10000 (93.1600%)
___Train Local_Simple,  epoch  12, local model 43, internal_epoch   1,  Average loss: 0.0015, Accuracy: 397/408 (97.3039%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3136, Accuracy: 9016/10000 (90.1600%)
___Train Local_Simple,  epoch  12, local model 35, internal_epoch   1,  Average loss: 0.0006, Accuracy: 491/499 (98.3968%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2791, Accuracy: 9137/10000 (91.3700%)
___Train Local_Simple,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 630/645 (97.6744%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1983, Accuracy: 9391/10000 (93.9100%)
time spent on training: 127.79860377311707
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4034051424600417  data num: [606, 591, 568, 557, 710, 860, 312, 408, 499, 645]
[rfa agg] considering poison per batch poison_fraction: 0.12606410701876303
[rfa agg] init. name: [41, 73, 51, 74, 46, 37, 21, 43, 35, 11], weight: tensor([0.1053, 0.1027, 0.0987, 0.0968, 0.1233, 0.1494, 0.0542, 0.0709, 0.0867,
        0.1121])
[rfa agg] iter:  0, prev_obj_val: 204.88165283203125, obj_val: 184.19508361816406, abs dis: 20.686569213867188
[rfa agg] iter:  0, weight: tensor([0.0469, 0.0560, 0.0526, 0.0552, 0.1633, 0.1979, 0.0717, 0.0937, 0.1146,
        0.1481])
[rfa agg] iter:  1, prev_obj_val: 184.19508361816406, obj_val: 174.48536682128906, abs dis: 9.709716796875
[rfa agg] iter:  1, weight: tensor([0.0247, 0.0295, 0.0272, 0.0288, 0.1842, 0.2233, 0.0808, 0.1056, 0.1291,
        0.1668])
[rfa agg] iter:  2, prev_obj_val: 174.48536682128906, obj_val: 169.60107421875, abs dis: 4.8842926025390625
[rfa agg] iter:  2, weight: tensor([0.0130, 0.0154, 0.0141, 0.0149, 0.1954, 0.2369, 0.0855, 0.1118, 0.1366,
        0.1764])
[rfa agg] iter:  3, prev_obj_val: 169.60107421875, obj_val: 167.1061248779297, abs dis: 2.4949493408203125
[rfa agg] iter:  3, weight: tensor([0.0068, 0.0080, 0.0073, 0.0077, 0.2015, 0.2446, 0.0878, 0.1149, 0.1404,
        0.1810])
[rfa agg] iter:  4, prev_obj_val: 167.1061248779297, obj_val: 165.83587646484375, abs dis: 1.2702484130859375
[rfa agg] iter:  4, weight: tensor([0.0036, 0.0042, 0.0038, 0.0040, 0.2050, 0.2498, 0.0888, 0.1164, 0.1420,
        0.1825])
[rfa agg] iter:  5, prev_obj_val: 165.83587646484375, obj_val: 165.20884704589844, abs dis: 0.6270294189453125
[rfa agg] iter:  5, weight: tensor([0.0019, 0.0022, 0.0020, 0.0021, 0.2069, 0.2544, 0.0892, 0.1171, 0.1424,
        0.1819])
[rfa agg] iter:  6, prev_obj_val: 165.20884704589844, obj_val: 164.93045043945312, abs dis: 0.2783966064453125
[rfa agg] iter:  6, weight: tensor([0.0010, 0.0012, 0.0011, 0.0011, 0.2058, 0.2600, 0.0895, 0.1181, 0.1429,
        0.1793])
[rfa agg] iter:  7, prev_obj_val: 164.93045043945312, obj_val: 164.83544921875, abs dis: 0.095001220703125
[rfa agg] iter:  7, weight: tensor([0.0006, 0.0007, 0.0007, 0.0007, 0.1977, 0.2656, 0.0912, 0.1217, 0.1455,
        0.1757])
[rfa agg] iter:  8, prev_obj_val: 164.83544921875, obj_val: 164.81398010253906, abs dis: 0.0214691162109375
[rfa agg] iter:  8, weight: tensor([0.0004, 0.0005, 0.0005, 0.0005, 0.1827, 0.2671, 0.0948, 0.1287, 0.1518,
        0.1731])
[rfa agg] iter:  9, prev_obj_val: 164.81398010253906, obj_val: 164.81065368652344, abs dis: 0.003326416015625
[rfa agg] iter:  9, weight: tensor([0.0004, 0.0004, 0.0004, 0.0004, 0.1698, 0.2648, 0.0981, 0.1354, 0.1583,
        0.1720])
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 0.0811, Accuracy: 9748/10000 (97.4800%)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 10.1504, Accuracy: 55/8968 (0.6133%)
Done in 154.0818305015564 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:13 choose agents : [41, 73, 51, 74, 61, 64, 28, 67, 22, 82]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0216, Accuracy: 361/606 (59.5710%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   2,  Average loss: 0.0110, Accuracy: 393/606 (64.8515%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   3,  Average loss: 0.0039, Accuracy: 551/606 (90.9241%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   4,  Average loss: 0.0034, Accuracy: 565/606 (93.2343%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   5,  Average loss: 0.0026, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   6,  Average loss: 0.0022, Accuracy: 582/606 (96.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   7,  Average loss: 0.0020, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   8,  Average loss: 0.0018, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch   9,  Average loss: 0.0019, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 41, internal_epoch  10,  Average loss: 0.0019, Accuracy: 584/606 (96.3696%), train_poison_data_count: 200
Global model norm: 16.515873527280977.
Norm before scaling: 16.809921350516394. Distance: 4.2872521865450315
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.0804, Accuracy: 6824/10000 (68.2400%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0361, Accuracy: 8847/8968 (98.6508%)
Scaling by  100
Scaled Norm after poisoning: 428.04198100186386, distance: 428.7252179426818
Total norm for 4 adversaries is: 428.04198100186386. distance: 428.7252179426818
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   1,  Average loss: 0.0220, Accuracy: 370/591 (62.6058%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   2,  Average loss: 0.0126, Accuracy: 391/591 (66.1591%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   3,  Average loss: 0.0047, Accuracy: 535/591 (90.5245%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   4,  Average loss: 0.0042, Accuracy: 545/591 (92.2166%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   5,  Average loss: 0.0042, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   6,  Average loss: 0.0035, Accuracy: 548/591 (92.7242%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   7,  Average loss: 0.0029, Accuracy: 561/591 (94.9239%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   8,  Average loss: 0.0023, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   9,  Average loss: 0.0021, Accuracy: 565/591 (95.6007%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch  10,  Average loss: 0.0024, Accuracy: 560/591 (94.7547%), train_poison_data_count: 195
Global model norm: 16.515873527280977.
Norm before scaling: 16.796136429983218. Distance: 4.138758515787307
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.7094, Accuracy: 7554/10000 (75.5400%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0213, Accuracy: 8921/8968 (99.4759%)
Scaling by  100
Scaled Norm after poisoning: 413.26346015586716, distance: 413.8758683168179
Total norm for 4 adversaries is: 413.26346015586716. distance: 413.8758683168179
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   1,  Average loss: 0.0213, Accuracy: 335/568 (58.9789%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   2,  Average loss: 0.0085, Accuracy: 449/568 (79.0493%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   3,  Average loss: 0.0031, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   4,  Average loss: 0.0022, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   5,  Average loss: 0.0016, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   6,  Average loss: 0.0017, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   7,  Average loss: 0.0015, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   8,  Average loss: 0.0015, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch   9,  Average loss: 0.0013, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 51, internal_epoch  10,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Global model norm: 16.515873527280977.
Norm before scaling: 16.841351906340627. Distance: 4.266887994827189
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.8237, Accuracy: 7186/10000 (71.8600%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0795, Accuracy: 8695/8968 (96.9558%)
Scaling by  100
Scaled Norm after poisoning: 426.14690835438427, distance: 426.68879540597266
Total norm for 4 adversaries is: 426.14690835438427. distance: 426.68879540597266
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   1,  Average loss: 0.0230, Accuracy: 339/557 (60.8618%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   2,  Average loss: 0.0094, Accuracy: 438/557 (78.6355%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   3,  Average loss: 0.0035, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   4,  Average loss: 0.0027, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   5,  Average loss: 0.0027, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   6,  Average loss: 0.0023, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   7,  Average loss: 0.0021, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   8,  Average loss: 0.0016, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch   9,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 74, internal_epoch  10,  Average loss: 0.0015, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Global model norm: 16.515873527280977.
Norm before scaling: 16.816881254179904. Distance: 4.185692240388679
will scale.
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6634, Accuracy: 8057/10000 (80.5700%)
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0515, Accuracy: 8780/8968 (97.9037%)
Scaling by  100
Scaled Norm after poisoning: 418.0003551134855, distance: 418.5691960417059
Total norm for 4 adversaries is: 418.0003551134855. distance: 418.5691960417059
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  13, local model 61, internal_epoch   1,  Average loss: 0.0015, Accuracy: 677/699 (96.8526%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2571, Accuracy: 9147/10000 (91.4700%)
___Train Local_Simple,  epoch  13, local model 64, internal_epoch   1,  Average loss: 0.0018, Accuracy: 782/813 (96.1870%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3389, Accuracy: 8770/10000 (87.7000%)
___Train Local_Simple,  epoch  13, local model 28, internal_epoch   1,  Average loss: 0.0015, Accuracy: 486/501 (97.0060%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1368, Accuracy: 9548/10000 (95.4800%)
___Train Local_Simple,  epoch  13, local model 67, internal_epoch   1,  Average loss: 0.0014, Accuracy: 973/998 (97.4950%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3118, Accuracy: 9001/10000 (90.0100%)
___Train Local_Simple,  epoch  13, local model 22, internal_epoch   1,  Average loss: 0.0015, Accuracy: 568/583 (97.4271%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2001, Accuracy: 9395/10000 (93.9500%)
___Train Local_Simple,  epoch  13, local model 82, internal_epoch   1,  Average loss: 0.0014, Accuracy: 691/713 (96.9144%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2894, Accuracy: 9024/10000 (90.2400%)
time spent on training: 138.96750831604004
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.35027907678382864  data num: [606, 591, 568, 557, 699, 813, 501, 998, 583, 713]
[rfa agg] considering poison per batch poison_fraction: 0.10946221149494645
[rfa agg] init. name: [41, 73, 51, 74, 61, 64, 28, 67, 22, 82], weight: tensor([0.0914, 0.0892, 0.0857, 0.0840, 0.1054, 0.1226, 0.0756, 0.1506, 0.0879,
        0.1076])
[rfa agg] iter:  0, prev_obj_val: 193.72117614746094, obj_val: 166.841796875, abs dis: 26.879379272460938
[rfa agg] iter:  0, weight: tensor([0.0384, 0.0395, 0.0368, 0.0359, 0.1379, 0.1604, 0.0988, 0.1967, 0.1150,
        0.1405])
[rfa agg] iter:  1, prev_obj_val: 166.841796875, obj_val: 155.74310302734375, abs dis: 11.09869384765625
[rfa agg] iter:  1, weight: tensor([0.0163, 0.0166, 0.0154, 0.0153, 0.1521, 0.1769, 0.1090, 0.2168, 0.1269,
        0.1548])
[rfa agg] iter:  2, prev_obj_val: 155.74310302734375, obj_val: 151.12985229492188, abs dis: 4.613250732421875
[rfa agg] iter:  2, weight: tensor([0.0068, 0.0069, 0.0064, 0.0064, 0.1583, 0.1842, 0.1133, 0.2251, 0.1321,
        0.1606])
[rfa agg] iter:  3, prev_obj_val: 151.12985229492188, obj_val: 149.25343322753906, abs dis: 1.8764190673828125
[rfa agg] iter:  3, weight: tensor([0.0028, 0.0029, 0.0027, 0.0027, 0.1612, 0.1876, 0.1154, 0.2277, 0.1346,
        0.1626])
[rfa agg] iter:  4, prev_obj_val: 149.25343322753906, obj_val: 148.5548553466797, abs dis: 0.698577880859375
[rfa agg] iter:  4, weight: tensor([0.0012, 0.0012, 0.0011, 0.0011, 0.1634, 0.1894, 0.1173, 0.2258, 0.1369,
        0.1626])
[rfa agg] iter:  5, prev_obj_val: 148.5548553466797, obj_val: 148.36688232421875, abs dis: 0.1879730224609375
[rfa agg] iter:  5, weight: tensor([0.0006, 0.0006, 0.0005, 0.0005, 0.1668, 0.1887, 0.1222, 0.2163, 0.1409,
        0.1629])
[rfa agg] iter:  6, prev_obj_val: 148.36688232421875, obj_val: 148.34146118164062, abs dis: 0.025421142578125
[rfa agg] iter:  6, weight: tensor([0.0004, 0.0004, 0.0003, 0.0003, 0.1704, 0.1831, 0.1317, 0.2008, 0.1462,
        0.1663])
[rfa agg] iter:  7, prev_obj_val: 148.34146118164062, obj_val: 148.33975219726562, abs dis: 0.001708984375
[rfa agg] iter:  7, weight: tensor([0.0003, 0.0003, 0.0003, 0.0003, 0.1722, 0.1778, 0.1390, 0.1905, 0.1492,
        0.1700])
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 0.0810, Accuracy: 9748/10000 (97.4800%)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 9.7538, Accuracy: 56/8968 (0.6244%)
Done in 165.2738540172577 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:14 choose agents : [41, 73, 51, 74, 60, 42, 85, 56, 57, 63]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   1,  Average loss: 0.0205, Accuracy: 388/606 (64.0264%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   2,  Average loss: 0.0105, Accuracy: 444/606 (73.2673%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   3,  Average loss: 0.0043, Accuracy: 557/606 (91.9142%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   4,  Average loss: 0.0037, Accuracy: 563/606 (92.9043%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   5,  Average loss: 0.0029, Accuracy: 572/606 (94.3894%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   6,  Average loss: 0.0031, Accuracy: 567/606 (93.5644%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   7,  Average loss: 0.0025, Accuracy: 578/606 (95.3795%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   8,  Average loss: 0.0020, Accuracy: 581/606 (95.8746%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch   9,  Average loss: 0.0021, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 41, internal_epoch  10,  Average loss: 0.0023, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Global model norm: 16.509270115782204.
Norm before scaling: 16.81024086674688. Distance: 4.377803667081219
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.1077, Accuracy: 6116/10000 (61.1600%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0221, Accuracy: 8913/8968 (99.3867%)
Scaling by  100
Scaled Norm after poisoning: 437.0474981337841, distance: 437.78037444590865
Total norm for 4 adversaries is: 437.0474981337841. distance: 437.78037444590865
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   1,  Average loss: 0.0235, Accuracy: 352/591 (59.5601%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   2,  Average loss: 0.0123, Accuracy: 383/591 (64.8054%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   3,  Average loss: 0.0053, Accuracy: 529/591 (89.5093%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   4,  Average loss: 0.0053, Accuracy: 518/591 (87.6481%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   5,  Average loss: 0.0040, Accuracy: 544/591 (92.0474%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   6,  Average loss: 0.0032, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   7,  Average loss: 0.0029, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   8,  Average loss: 0.0023, Accuracy: 571/591 (96.6159%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch   9,  Average loss: 0.0019, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 73, internal_epoch  10,  Average loss: 0.0021, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Global model norm: 16.509270115782204.
Norm before scaling: 16.913383177755364. Distance: 4.584164538294863
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.6751, Accuracy: 7713/10000 (77.1300%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0388, Accuracy: 8841/8968 (98.5839%)
Scaling by  100
Scaled Norm after poisoning: 457.8945361652615, distance: 458.4164659455417
Total norm for 4 adversaries is: 457.8945361652615. distance: 458.4164659455417
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   1,  Average loss: 0.0196, Accuracy: 349/568 (61.4437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   2,  Average loss: 0.0065, Accuracy: 495/568 (87.1479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   3,  Average loss: 0.0040, Accuracy: 528/568 (92.9577%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   4,  Average loss: 0.0030, Accuracy: 538/568 (94.7183%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   5,  Average loss: 0.0023, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   6,  Average loss: 0.0022, Accuracy: 546/568 (96.1268%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   7,  Average loss: 0.0021, Accuracy: 543/568 (95.5986%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   8,  Average loss: 0.0016, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch   9,  Average loss: 0.0016, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 51, internal_epoch  10,  Average loss: 0.0015, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Global model norm: 16.509270115782204.
Norm before scaling: 16.710292837612094. Distance: 3.659486300162784
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.7564, Accuracy: 7335/10000 (73.3500%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0489, Accuracy: 8803/8968 (98.1601%)
Scaling by  100
Scaled Norm after poisoning: 365.4032660978826, distance: 365.9486388142467
Total norm for 4 adversaries is: 365.4032660978826. distance: 365.9486388142467
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0218, Accuracy: 341/557 (61.2208%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   2,  Average loss: 0.0101, Accuracy: 407/557 (73.0700%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   3,  Average loss: 0.0037, Accuracy: 509/557 (91.3824%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   4,  Average loss: 0.0035, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   5,  Average loss: 0.0031, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   6,  Average loss: 0.0022, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   7,  Average loss: 0.0026, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   8,  Average loss: 0.0021, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch   9,  Average loss: 0.0018, Accuracy: 537/557 (96.4093%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 74, internal_epoch  10,  Average loss: 0.0019, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Global model norm: 16.509270115782204.
Norm before scaling: 16.70389782765444. Distance: 3.7182869502693654
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.6708, Accuracy: 8022/10000 (80.2200%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0574, Accuracy: 8753/8968 (97.6026%)
Scaling by  100
Scaled Norm after poisoning: 371.2047952276479, distance: 371.8286945960465
Total norm for 4 adversaries is: 371.2047952276479. distance: 371.8286945960465
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  14, local model 60, internal_epoch   1,  Average loss: 0.0016, Accuracy: 329/338 (97.3373%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1114, Accuracy: 9670/10000 (96.7000%)
___Train Local_Simple,  epoch  14, local model 42, internal_epoch   1,  Average loss: 0.0013, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1019, Accuracy: 9682/10000 (96.8200%)
___Train Local_Simple,  epoch  14, local model 85, internal_epoch   1,  Average loss: 0.0008, Accuracy: 422/431 (97.9118%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1465, Accuracy: 9533/10000 (95.3300%)
___Train Local_Simple,  epoch  14, local model 56, internal_epoch   1,  Average loss: 0.0015, Accuracy: 861/880 (97.8409%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1382, Accuracy: 9557/10000 (95.5700%)
___Train Local_Simple,  epoch  14, local model 57, internal_epoch   1,  Average loss: 0.0020, Accuracy: 332/343 (96.7930%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2464, Accuracy: 9278/10000 (92.7800%)
___Train Local_Simple,  epoch  14, local model 63, internal_epoch   1,  Average loss: 0.0020, Accuracy: 848/889 (95.3881%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1203, Accuracy: 9623/10000 (96.2300%)
time spent on training: 130.3300223350525
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.42691671263099834  data num: [606, 591, 568, 557, 338, 236, 431, 880, 343, 889]
[rfa agg] considering poison per batch poison_fraction: 0.13341147269718698
[rfa agg] init. name: [41, 73, 51, 74, 60, 42, 85, 56, 57, 63], weight: tensor([0.1114, 0.1087, 0.1044, 0.1024, 0.0621, 0.0434, 0.0792, 0.1618, 0.0631,
        0.1634])
[rfa agg] iter:  0, prev_obj_val: 213.10023498535156, obj_val: 194.52394104003906, abs dis: 18.5762939453125
[rfa agg] iter:  0, weight: tensor([0.0566, 0.0525, 0.0677, 0.0618, 0.0826, 0.0576, 0.1053, 0.2150, 0.0838,
        0.2172])
[rfa agg] iter:  1, prev_obj_val: 194.52394104003906, obj_val: 185.60401916503906, abs dis: 8.919921875
[rfa agg] iter:  1, weight: tensor([0.0320, 0.0297, 0.0376, 0.0353, 0.0939, 0.0655, 0.1196, 0.2443, 0.0953,
        0.2468])
[rfa agg] iter:  2, prev_obj_val: 185.60401916503906, obj_val: 180.85589599609375, abs dis: 4.7481231689453125
[rfa agg] iter:  2, weight: tensor([0.0183, 0.0170, 0.0210, 0.0200, 0.1003, 0.0699, 0.1276, 0.2607, 0.1018,
        0.2635])
[rfa agg] iter:  3, prev_obj_val: 180.85589599609375, obj_val: 178.24671936035156, abs dis: 2.6091766357421875
[rfa agg] iter:  3, weight: tensor([0.0104, 0.0097, 0.0118, 0.0113, 0.1040, 0.0724, 0.1320, 0.2700, 0.1055,
        0.2729])
[rfa agg] iter:  4, prev_obj_val: 178.24671936035156, obj_val: 176.79757690429688, abs dis: 1.4491424560546875
[rfa agg] iter:  4, weight: tensor([0.0059, 0.0055, 0.0067, 0.0064, 0.1062, 0.0737, 0.1344, 0.2751, 0.1078,
        0.2783])
[rfa agg] iter:  5, prev_obj_val: 176.79757690429688, obj_val: 175.99615478515625, abs dis: 0.801422119140625
[rfa agg] iter:  5, weight: tensor([0.0034, 0.0031, 0.0038, 0.0037, 0.1077, 0.0745, 0.1356, 0.2777, 0.1093,
        0.2812])
[rfa agg] iter:  6, prev_obj_val: 175.99615478515625, obj_val: 175.56585693359375, abs dis: 0.4302978515625
[rfa agg] iter:  6, weight: tensor([0.0019, 0.0018, 0.0022, 0.0021, 0.1091, 0.0750, 0.1361, 0.2784, 0.1107,
        0.2826])
[rfa agg] iter:  7, prev_obj_val: 175.56585693359375, obj_val: 175.35435485839844, abs dis: 0.2115020751953125
[rfa agg] iter:  7, weight: tensor([0.0011, 0.0011, 0.0013, 0.0012, 0.1111, 0.0757, 0.1367, 0.2770, 0.1126,
        0.2823])
[rfa agg] iter:  8, prev_obj_val: 175.35435485839844, obj_val: 175.26950073242188, abs dis: 0.0848541259765625
[rfa agg] iter:  8, weight: tensor([0.0007, 0.0007, 0.0008, 0.0008, 0.1144, 0.0774, 0.1382, 0.2722, 0.1152,
        0.2795])
[rfa agg] iter:  9, prev_obj_val: 175.26950073242188, obj_val: 175.2451629638672, abs dis: 0.0243377685546875
[rfa agg] iter:  9, weight: tensor([0.0005, 0.0005, 0.0006, 0.0006, 0.1190, 0.0805, 0.1415, 0.2643, 0.1183,
        0.2742])
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 0.0818, Accuracy: 9752/10000 (97.5200%)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 9.1521, Accuracy: 63/8968 (0.7025%)
Done in 156.63768410682678 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:15 choose agents : [41, 73, 51, 74, 77, 18, 43, 91, 42, 52]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   1,  Average loss: 0.0187, Accuracy: 400/606 (66.0066%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   2,  Average loss: 0.0071, Accuracy: 485/606 (80.0330%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   3,  Average loss: 0.0023, Accuracy: 577/606 (95.2145%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   4,  Average loss: 0.0025, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   5,  Average loss: 0.0021, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   6,  Average loss: 0.0021, Accuracy: 584/606 (96.3696%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   7,  Average loss: 0.0016, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   8,  Average loss: 0.0015, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch   9,  Average loss: 0.0012, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 41, internal_epoch  10,  Average loss: 0.0011, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Global model norm: 16.502883196841506.
Norm before scaling: 16.75650399174573. Distance: 3.6399758214461935
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.7708, Accuracy: 7560/10000 (75.6000%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0450, Accuracy: 8829/8968 (98.4500%)
Scaling by  100
Scaled Norm after poisoning: 363.7102856326722, distance: 363.99759614590863
Total norm for 4 adversaries is: 363.7102856326722. distance: 363.99759614590863
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   1,  Average loss: 0.0213, Accuracy: 357/591 (60.4061%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   2,  Average loss: 0.0110, Accuracy: 401/591 (67.8511%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   3,  Average loss: 0.0041, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   4,  Average loss: 0.0033, Accuracy: 553/591 (93.5702%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   5,  Average loss: 0.0028, Accuracy: 563/591 (95.2623%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   6,  Average loss: 0.0021, Accuracy: 570/591 (96.4467%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   7,  Average loss: 0.0020, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   8,  Average loss: 0.0017, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch   9,  Average loss: 0.0015, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 73, internal_epoch  10,  Average loss: 0.0014, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Global model norm: 16.502883196841506.
Norm before scaling: 16.84564504066073. Distance: 4.01354023886935
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.4828, Accuracy: 8413/10000 (84.1300%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0377, Accuracy: 8836/8968 (98.5281%)
Scaling by  100
Scaled Norm after poisoning: 401.1104897656006, distance: 401.3540363569301
Total norm for 4 adversaries is: 401.1104897656006. distance: 401.3540363569301
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   1,  Average loss: 0.0178, Accuracy: 377/568 (66.3732%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   2,  Average loss: 0.0071, Accuracy: 492/568 (86.6197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   3,  Average loss: 0.0034, Accuracy: 523/568 (92.0775%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   4,  Average loss: 0.0032, Accuracy: 527/568 (92.7817%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   5,  Average loss: 0.0027, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   6,  Average loss: 0.0020, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   7,  Average loss: 0.0019, Accuracy: 550/568 (96.8310%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   8,  Average loss: 0.0014, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch   9,  Average loss: 0.0015, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 51, internal_epoch  10,  Average loss: 0.0016, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Global model norm: 16.502883196841506.
Norm before scaling: 16.696040907425385. Distance: 3.4316884245390393
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.7866, Accuracy: 7297/10000 (72.9700%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0482, Accuracy: 8806/8968 (98.1936%)
Scaling by  100
Scaled Norm after poisoning: 342.78391517105933, distance: 343.16881550848996
Total norm for 4 adversaries is: 342.78391517105933. distance: 343.16881550848996
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   1,  Average loss: 0.0195, Accuracy: 330/557 (59.2460%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   2,  Average loss: 0.0085, Accuracy: 445/557 (79.8923%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   3,  Average loss: 0.0038, Accuracy: 517/557 (92.8187%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   4,  Average loss: 0.0029, Accuracy: 525/557 (94.2549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   5,  Average loss: 0.0025, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   6,  Average loss: 0.0018, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   7,  Average loss: 0.0017, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   8,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch   9,  Average loss: 0.0014, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 74, internal_epoch  10,  Average loss: 0.0016, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Global model norm: 16.502883196841506.
Norm before scaling: 16.714104750402335. Distance: 3.6129650410624587
will scale.
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.6401, Accuracy: 8105/10000 (81.0500%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0339, Accuracy: 8846/8968 (98.6396%)
Scaling by  100
Scaled Norm after poisoning: 360.83761063669624, distance: 361.2965043596464
Total norm for 4 adversaries is: 360.83761063669624. distance: 361.2965043596464
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  15, local model 77, internal_epoch   1,  Average loss: 0.0016, Accuracy: 572/589 (97.1138%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1670, Accuracy: 9492/10000 (94.9200%)
___Train Local_Simple,  epoch  15, local model 18, internal_epoch   1,  Average loss: 0.0020, Accuracy: 443/459 (96.5142%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2673, Accuracy: 9100/10000 (91.0000%)
___Train Local_Simple,  epoch  15, local model 43, internal_epoch   1,  Average loss: 0.0014, Accuracy: 397/408 (97.3039%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1142, Accuracy: 9647/10000 (96.4700%)
___Train Local_Simple,  epoch  15, local model 91, internal_epoch   1,  Average loss: 0.0007, Accuracy: 253/256 (98.8281%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.0856, Accuracy: 9732/10000 (97.3200%)
___Train Local_Simple,  epoch  15, local model 42, internal_epoch   1,  Average loss: 0.0013, Accuracy: 232/236 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.0964, Accuracy: 9698/10000 (96.9800%)
___Train Local_Simple,  epoch  15, local model 52, internal_epoch   1,  Average loss: 0.0011, Accuracy: 247/253 (97.6285%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1271, Accuracy: 9617/10000 (96.1700%)
time spent on training: 129.97961473464966
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.5133760778244528  data num: [606, 591, 568, 557, 589, 459, 408, 256, 236, 253]
[rfa agg] considering poison per batch poison_fraction: 0.1604300243201415
[rfa agg] init. name: [41, 73, 51, 74, 77, 18, 43, 91, 42, 52], weight: tensor([0.1340, 0.1307, 0.1256, 0.1231, 0.1302, 0.1015, 0.0902, 0.0566, 0.0522,
        0.0559])
[rfa agg] iter:  0, prev_obj_val: 210.82655334472656, obj_val: 201.9444122314453, abs dis: 8.88214111328125
[rfa agg] iter:  0, weight: tensor([0.0917, 0.0817, 0.0983, 0.0866, 0.1717, 0.1338, 0.1190, 0.0747, 0.0688,
        0.0738])
[rfa agg] iter:  1, prev_obj_val: 201.9444122314453, obj_val: 197.62884521484375, abs dis: 4.3155670166015625
[rfa agg] iter:  1, weight: tensor([0.0679, 0.0598, 0.0715, 0.0640, 0.1971, 0.1536, 0.1366, 0.0857, 0.0790,
        0.0848])
[rfa agg] iter:  2, prev_obj_val: 197.62884521484375, obj_val: 195.0869598388672, abs dis: 2.5418853759765625
[rfa agg] iter:  2, weight: tensor([0.0516, 0.0454, 0.0533, 0.0483, 0.2143, 0.1671, 0.1486, 0.0933, 0.0859,
        0.0922])
[rfa agg] iter:  3, prev_obj_val: 195.0869598388672, obj_val: 193.43824768066406, abs dis: 1.648712158203125
[rfa agg] iter:  3, weight: tensor([0.0398, 0.0350, 0.0406, 0.0371, 0.2266, 0.1767, 0.1572, 0.0986, 0.0909,
        0.0975])
[rfa agg] iter:  4, prev_obj_val: 193.43824768066406, obj_val: 192.30325317382812, abs dis: 1.1349945068359375
[rfa agg] iter:  4, weight: tensor([0.0310, 0.0273, 0.0314, 0.0289, 0.2356, 0.1837, 0.1635, 0.1026, 0.0945,
        0.1014])
[rfa agg] iter:  5, prev_obj_val: 192.30325317382812, obj_val: 191.4903106689453, abs dis: 0.8129425048828125
[rfa agg] iter:  5, weight: tensor([0.0244, 0.0215, 0.0246, 0.0226, 0.2423, 0.1890, 0.1683, 0.1056, 0.0973,
        0.1044])
[rfa agg] iter:  6, prev_obj_val: 191.4903106689453, obj_val: 190.8915252685547, abs dis: 0.598785400390625
[rfa agg] iter:  6, weight: tensor([0.0192, 0.0170, 0.0193, 0.0179, 0.2475, 0.1931, 0.1719, 0.1079, 0.0994,
        0.1067])
[rfa agg] iter:  7, prev_obj_val: 190.8915252685547, obj_val: 190.44154357910156, abs dis: 0.449981689453125
[rfa agg] iter:  7, weight: tensor([0.0153, 0.0135, 0.0153, 0.0142, 0.2514, 0.1962, 0.1748, 0.1098, 0.1011,
        0.1086])
[rfa agg] iter:  8, prev_obj_val: 190.44154357910156, obj_val: 190.0984344482422, abs dis: 0.343109130859375
[rfa agg] iter:  8, weight: tensor([0.0121, 0.0107, 0.0122, 0.0113, 0.2544, 0.1986, 0.1771, 0.1112, 0.1024,
        0.1100])
[rfa agg] iter:  9, prev_obj_val: 190.0984344482422, obj_val: 189.83399963378906, abs dis: 0.264434814453125
[rfa agg] iter:  9, weight: tensor([0.0097, 0.0086, 0.0097, 0.0090, 0.2567, 0.2005, 0.1789, 0.1124, 0.1034,
        0.1112])
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 0.1623, Accuracy: 9609/10000 (96.0900%)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 2.9472, Accuracy: 995/8968 (11.0950%)
Done in 155.83688807487488 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:16 choose agents : [41, 73, 51, 74, 28, 37, 96, 99, 80, 13]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   1,  Average loss: 0.0068, Accuracy: 515/606 (84.9835%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   2,  Average loss: 0.0018, Accuracy: 584/606 (96.3696%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   3,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   4,  Average loss: 0.0012, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   5,  Average loss: 0.0010, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   6,  Average loss: 0.0009, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   7,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   8,  Average loss: 0.0006, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch   9,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 41, internal_epoch  10,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Global model norm: 16.475950342765227.
Norm before scaling: 16.721624679844773. Distance: 2.269701847880352
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3302, Accuracy: 8965/10000 (89.6500%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0143, Accuracy: 8919/8968 (99.4536%)
Scaling by  100
Scaled Norm after poisoning: 228.2265270652165, distance: 226.97017631728625
Total norm for 4 adversaries is: 228.2265270652165. distance: 226.97017631728625
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   1,  Average loss: 0.0075, Accuracy: 496/591 (83.9255%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   2,  Average loss: 0.0019, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   3,  Average loss: 0.0006, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   4,  Average loss: 0.0007, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   5,  Average loss: 0.0005, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   6,  Average loss: 0.0005, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   7,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch   9,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Global model norm: 16.475950342765227.
Norm before scaling: 16.77612635644307. Distance: 2.53153311947475
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3671, Accuracy: 8865/10000 (88.6500%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0355, Accuracy: 8863/8968 (98.8292%)
Scaling by  100
Scaled Norm after poisoning: 254.39209862680485, distance: 253.15330860221835
Total norm for 4 adversaries is: 254.39209862680485. distance: 253.15330860221835
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   1,  Average loss: 0.0057, Accuracy: 496/568 (87.3239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   2,  Average loss: 0.0019, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   3,  Average loss: 0.0008, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   4,  Average loss: 0.0009, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   5,  Average loss: 0.0005, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   6,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   7,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   8,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch   9,  Average loss: 0.0005, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 51, internal_epoch  10,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Global model norm: 16.475950342765227.
Norm before scaling: 16.699736377211448. Distance: 2.0246737323286417
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3264, Accuracy: 8962/10000 (89.6200%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0600, Accuracy: 8762/8968 (97.7029%)
Scaling by  100
Scaled Norm after poisoning: 203.95340690339057, distance: 202.46736812694039
Total norm for 4 adversaries is: 203.95340690339057. distance: 202.46736812694039
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   1,  Average loss: 0.0071, Accuracy: 459/557 (82.4057%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   2,  Average loss: 0.0023, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   3,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   4,  Average loss: 0.0009, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   5,  Average loss: 0.0009, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   6,  Average loss: 0.0008, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   7,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   8,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch   9,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 74, internal_epoch  10,  Average loss: 0.0005, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Global model norm: 16.475950342765227.
Norm before scaling: 16.700646411925852. Distance: 2.1808390976340477
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2989, Accuracy: 9064/10000 (90.6400%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0105, Accuracy: 8928/8968 (99.5540%)
Scaling by  100
Scaled Norm after poisoning: 219.32148563809247, distance: 218.08389655703604
Total norm for 4 adversaries is: 219.32148563809247. distance: 218.08389655703604
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  16, local model 28, internal_epoch   1,  Average loss: 0.0020, Accuracy: 485/501 (96.8064%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1960, Accuracy: 9359/10000 (93.5900%)
___Train Local_Simple,  epoch  16, local model 37, internal_epoch   1,  Average loss: 0.0014, Accuracy: 843/860 (98.0233%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1473, Accuracy: 9539/10000 (95.3900%)
___Train Local_Simple,  epoch  16, local model 96, internal_epoch   1,  Average loss: 0.0020, Accuracy: 654/672 (97.3214%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2028, Accuracy: 9367/10000 (93.6700%)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0013, Accuracy: 371/377 (98.4085%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2122, Accuracy: 9298/10000 (92.9800%)
___Train Local_Simple,  epoch  16, local model 80, internal_epoch   1,  Average loss: 0.0013, Accuracy: 423/431 (98.1439%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3654, Accuracy: 8933/10000 (89.3300%)
___Train Local_Simple,  epoch  16, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 715/734 (97.4114%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2211, Accuracy: 9309/10000 (93.0900%)
time spent on training: 131.0393989086151
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3937595387485162  data num: [606, 591, 568, 557, 501, 860, 672, 377, 431, 734]
[rfa agg] considering poison per batch poison_fraction: 0.12304985585891132
[rfa agg] init. name: [41, 73, 51, 74, 28, 37, 96, 99, 80, 13], weight: tensor([0.1028, 0.1002, 0.0963, 0.0945, 0.0850, 0.1458, 0.1140, 0.0639, 0.0731,
        0.1245])
[rfa agg] iter:  0, prev_obj_val: 111.57677459716797, obj_val: 100.47179412841797, abs dis: 11.10498046875
[rfa agg] iter:  0, weight: tensor([0.0549, 0.0472, 0.0594, 0.0526, 0.1101, 0.1891, 0.1477, 0.0829, 0.0947,
        0.1613])
[rfa agg] iter:  1, prev_obj_val: 100.47179412841797, obj_val: 94.92241668701172, abs dis: 5.54937744140625
[rfa agg] iter:  1, weight: tensor([0.0295, 0.0254, 0.0317, 0.0283, 0.1240, 0.2130, 0.1664, 0.0934, 0.1066,
        0.1816])
[rfa agg] iter:  2, prev_obj_val: 94.92241668701172, obj_val: 92.02607727050781, abs dis: 2.8963394165039062
[rfa agg] iter:  2, weight: tensor([0.0157, 0.0136, 0.0167, 0.0151, 0.1315, 0.2260, 0.1765, 0.0991, 0.1130,
        0.1926])
[rfa agg] iter:  3, prev_obj_val: 92.02607727050781, obj_val: 90.51178741455078, abs dis: 1.5142898559570312
[rfa agg] iter:  3, weight: tensor([0.0083, 0.0073, 0.0088, 0.0080, 0.1355, 0.2332, 0.1820, 0.1023, 0.1164,
        0.1982])
[rfa agg] iter:  4, prev_obj_val: 90.51178741455078, obj_val: 89.73332214355469, abs dis: 0.7784652709960938
[rfa agg] iter:  4, weight: tensor([0.0044, 0.0039, 0.0047, 0.0042, 0.1376, 0.2374, 0.1849, 0.1042, 0.1180,
        0.2006])
[rfa agg] iter:  5, prev_obj_val: 89.73332214355469, obj_val: 89.35552978515625, abs dis: 0.3777923583984375
[rfa agg] iter:  5, weight: tensor([0.0024, 0.0021, 0.0025, 0.0023, 0.1389, 0.2407, 0.1862, 0.1060, 0.1187,
        0.2002])
[rfa agg] iter:  6, prev_obj_val: 89.35552978515625, obj_val: 89.19982147216797, abs dis: 0.15570831298828125
[rfa agg] iter:  6, weight: tensor([0.0014, 0.0012, 0.0014, 0.0013, 0.1401, 0.2449, 0.1860, 0.1088, 0.1191,
        0.1958])
[rfa agg] iter:  7, prev_obj_val: 89.19982147216797, obj_val: 89.15428161621094, abs dis: 0.04553985595703125
[rfa agg] iter:  7, weight: tensor([0.0009, 0.0008, 0.0009, 0.0008, 0.1418, 0.2512, 0.1837, 0.1137, 0.1197,
        0.1863])
[rfa agg] iter:  8, prev_obj_val: 89.15428161621094, obj_val: 89.14596557617188, abs dis: 0.0083160400390625
[rfa agg] iter:  8, weight: tensor([0.0007, 0.0006, 0.0007, 0.0007, 0.1437, 0.2578, 0.1805, 0.1189, 0.1203,
        0.1761])
[rfa agg] iter:  9, prev_obj_val: 89.14596557617188, obj_val: 89.14494323730469, abs dis: 0.0010223388671875
[rfa agg] iter:  9, weight: tensor([0.0006, 0.0005, 0.0007, 0.0006, 0.1448, 0.2620, 0.1784, 0.1220, 0.1206,
        0.1698])
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.1434, Accuracy: 9645/10000 (96.4500%)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 3.1376, Accuracy: 914/8968 (10.1918%)
Done in 161.01124095916748 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:17 choose agents : [41, 73, 51, 74, 98, 78, 46, 45, 62, 50]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   1,  Average loss: 0.0082, Accuracy: 502/606 (82.8383%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   2,  Average loss: 0.0020, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   3,  Average loss: 0.0017, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   4,  Average loss: 0.0015, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   5,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   6,  Average loss: 0.0010, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   7,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   8,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 41, internal_epoch  10,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Global model norm: 16.482936474555096.
Norm before scaling: 16.82064542604796. Distance: 2.8548610056164136
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3930, Accuracy: 8783/10000 (87.8300%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0056, Accuracy: 8950/8968 (99.7993%)
Scaling by  100
Scaled Norm after poisoning: 286.5024814464964, distance: 285.48608492796984
Total norm for 4 adversaries is: 286.5024814464964. distance: 285.48608492796984
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   1,  Average loss: 0.0074, Accuracy: 503/591 (85.1100%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   2,  Average loss: 0.0020, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   3,  Average loss: 0.0010, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   4,  Average loss: 0.0009, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   5,  Average loss: 0.0007, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   6,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   7,  Average loss: 0.0005, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   8,  Average loss: 0.0005, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch   9,  Average loss: 0.0004, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Global model norm: 16.482936474555096.
Norm before scaling: 16.747366171480238. Distance: 2.487030050080059
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3727, Accuracy: 8822/10000 (88.2200%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0183, Accuracy: 8901/8968 (99.2529%)
Scaling by  100
Scaled Norm after poisoning: 249.7699879389035, distance: 248.70301063718549
Total norm for 4 adversaries is: 249.7699879389035. distance: 248.70301063718549
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   1,  Average loss: 0.0059, Accuracy: 502/568 (88.3803%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   2,  Average loss: 0.0019, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   3,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   4,  Average loss: 0.0009, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   5,  Average loss: 0.0008, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   6,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   7,  Average loss: 0.0006, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   8,  Average loss: 0.0005, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch   9,  Average loss: 0.0005, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 51, internal_epoch  10,  Average loss: 0.0005, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Global model norm: 16.482936474555096.
Norm before scaling: 16.695675336780237. Distance: 1.9924233091329988
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3819, Accuracy: 8710/10000 (87.1000%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0237, Accuracy: 8886/8968 (99.0856%)
Scaling by  100
Scaled Norm after poisoning: 200.69394259356707, distance: 199.24233438830214
Total norm for 4 adversaries is: 200.69394259356707. distance: 199.24233438830214
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   1,  Average loss: 0.0069, Accuracy: 470/557 (84.3806%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   2,  Average loss: 0.0029, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   3,  Average loss: 0.0013, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   4,  Average loss: 0.0009, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   5,  Average loss: 0.0008, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   6,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   7,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   8,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 74, internal_epoch  10,  Average loss: 0.0007, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Global model norm: 16.482936474555096.
Norm before scaling: 16.73296252646582. Distance: 2.1442209377109482
will scale.
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2700, Accuracy: 9143/10000 (91.4300%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0201, Accuracy: 8886/8968 (99.0856%)
Scaling by  100
Scaled Norm after poisoning: 215.91488665965113, distance: 214.42210670485915
Total norm for 4 adversaries is: 215.91488665965113. distance: 214.42210670485915
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  17, local model 98, internal_epoch   1,  Average loss: 0.0019, Accuracy: 784/818 (95.8435%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3250, Accuracy: 8943/10000 (89.4300%)
___Train Local_Simple,  epoch  17, local model 78, internal_epoch   1,  Average loss: 0.0014, Accuracy: 296/303 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2394, Accuracy: 9259/10000 (92.5900%)
___Train Local_Simple,  epoch  17, local model 46, internal_epoch   1,  Average loss: 0.0030, Accuracy: 688/710 (96.9014%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4977, Accuracy: 8423/10000 (84.2300%)
___Train Local_Simple,  epoch  17, local model 45, internal_epoch   1,  Average loss: 0.0016, Accuracy: 611/628 (97.2930%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4585, Accuracy: 8650/10000 (86.5000%)
___Train Local_Simple,  epoch  17, local model 62, internal_epoch   1,  Average loss: 0.0014, Accuracy: 414/423 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1150, Accuracy: 9636/10000 (96.3600%)
___Train Local_Simple,  epoch  17, local model 50, internal_epoch   1,  Average loss: 0.0021, Accuracy: 457/474 (96.4135%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2494, Accuracy: 9176/10000 (91.7600%)
time spent on training: 134.39673566818237
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.40894681225783724  data num: [606, 591, 568, 557, 818, 303, 710, 628, 423, 474]
[rfa agg] considering poison per batch poison_fraction: 0.12779587883057414
[rfa agg] init. name: [41, 73, 51, 74, 98, 78, 46, 45, 62, 50], weight: tensor([0.1067, 0.1041, 0.1000, 0.0981, 0.1441, 0.0534, 0.1250, 0.1106, 0.0745,
        0.0835])
[rfa agg] iter:  0, prev_obj_val: 120.4134292602539, obj_val: 109.55562591552734, abs dis: 10.857803344726562
[rfa agg] iter:  0, weight: tensor([0.0477, 0.0545, 0.0711, 0.0621, 0.1864, 0.0690, 0.1617, 0.1431, 0.0964,
        0.1080])
[rfa agg] iter:  1, prev_obj_val: 109.55562591552734, obj_val: 104.0718765258789, abs dis: 5.4837493896484375
[rfa agg] iter:  1, weight: tensor([0.0273, 0.0311, 0.0396, 0.0352, 0.2113, 0.0783, 0.1833, 0.1622, 0.1093,
        0.1225])
[rfa agg] iter:  2, prev_obj_val: 104.0718765258789, obj_val: 101.08187866210938, abs dis: 2.9899978637695312
[rfa agg] iter:  2, weight: tensor([0.0156, 0.0177, 0.0219, 0.0197, 0.2255, 0.0835, 0.1955, 0.1731, 0.1167,
        0.1307])
[rfa agg] iter:  3, prev_obj_val: 101.08187866210938, obj_val: 99.43343353271484, abs dis: 1.6484451293945312
[rfa agg] iter:  3, weight: tensor([0.0089, 0.0100, 0.0122, 0.0110, 0.2335, 0.0865, 0.2023, 0.1792, 0.1209,
        0.1354])
[rfa agg] iter:  4, prev_obj_val: 99.43343353271484, obj_val: 98.53013610839844, abs dis: 0.9032974243164062
[rfa agg] iter:  4, weight: tensor([0.0050, 0.0056, 0.0068, 0.0062, 0.2379, 0.0882, 0.2059, 0.1827, 0.1235,
        0.1382])
[rfa agg] iter:  5, prev_obj_val: 98.53013610839844, obj_val: 98.04981231689453, abs dis: 0.48032379150390625
[rfa agg] iter:  5, weight: tensor([0.0028, 0.0032, 0.0038, 0.0035, 0.2400, 0.0892, 0.2071, 0.1848, 0.1255,
        0.1400])
[rfa agg] iter:  6, prev_obj_val: 98.04981231689453, obj_val: 97.81607055664062, abs dis: 0.23374176025390625
[rfa agg] iter:  6, weight: tensor([0.0017, 0.0019, 0.0022, 0.0020, 0.2402, 0.0899, 0.2062, 0.1863, 0.1280,
        0.1416])
[rfa agg] iter:  7, prev_obj_val: 97.81607055664062, obj_val: 97.72367858886719, abs dis: 0.0923919677734375
[rfa agg] iter:  7, weight: tensor([0.0010, 0.0012, 0.0014, 0.0013, 0.2380, 0.0905, 0.2023, 0.1881, 0.1325,
        0.1438])
[rfa agg] iter:  8, prev_obj_val: 97.72367858886719, obj_val: 97.69804382324219, abs dis: 0.025634765625
[rfa agg] iter:  8, weight: tensor([0.0007, 0.0008, 0.0010, 0.0009, 0.2331, 0.0912, 0.1960, 0.1902, 0.1396,
        0.1465])
[rfa agg] iter:  9, prev_obj_val: 97.69804382324219, obj_val: 97.69328308105469, abs dis: 0.0047607421875
[rfa agg] iter:  9, weight: tensor([0.0006, 0.0007, 0.0008, 0.0008, 0.2278, 0.0917, 0.1902, 0.1920, 0.1468,
        0.1487])
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.1285, Accuracy: 9685/10000 (96.8500%)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 3.2643, Accuracy: 862/8968 (9.6120%)
Done in 160.48348379135132 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:18 choose agents : [41, 73, 51, 74, 67, 14, 36, 24, 7, 4]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   1,  Average loss: 0.0055, Accuracy: 535/606 (88.2838%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   2,  Average loss: 0.0015, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   3,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   4,  Average loss: 0.0011, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   5,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   6,  Average loss: 0.0008, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   7,  Average loss: 0.0008, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   8,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch   9,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 41, internal_epoch  10,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Global model norm: 16.48884806757898.
Norm before scaling: 16.72775020596389. Distance: 2.2685032944229686
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3017, Accuracy: 9045/10000 (90.4500%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0267, Accuracy: 8885/8968 (99.0745%)
Scaling by  100
Scaled Norm after poisoning: 228.0611554495855, distance: 226.85033440299355
Total norm for 4 adversaries is: 228.0611554495855. distance: 226.85033440299355
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   1,  Average loss: 0.0069, Accuracy: 500/591 (84.6024%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   2,  Average loss: 0.0020, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   3,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   4,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   5,  Average loss: 0.0005, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   6,  Average loss: 0.0005, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   7,  Average loss: 0.0005, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch   9,  Average loss: 0.0004, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Global model norm: 16.48884806757898.
Norm before scaling: 16.817697848917966. Distance: 2.6509518011683877
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3500, Accuracy: 8884/10000 (88.8400%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0174, Accuracy: 8910/8968 (99.3533%)
Scaling by  100
Scaled Norm after poisoning: 266.34539077577443, distance: 265.0951922187575
Total norm for 4 adversaries is: 266.34539077577443. distance: 265.0951922187575
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   1,  Average loss: 0.0053, Accuracy: 510/568 (89.7887%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   2,  Average loss: 0.0022, Accuracy: 547/568 (96.3028%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   3,  Average loss: 0.0014, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   4,  Average loss: 0.0008, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   5,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   6,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   7,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   8,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch   9,  Average loss: 0.0005, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 51, internal_epoch  10,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Global model norm: 16.48884806757898.
Norm before scaling: 16.69402742773033. Distance: 1.8923788211783175
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3453, Accuracy: 8847/10000 (88.4700%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0299, Accuracy: 8866/8968 (98.8626%)
Scaling by  100
Scaled Norm after poisoning: 190.80249932849412, distance: 189.2378938499105
Total norm for 4 adversaries is: 190.80249932849412. distance: 189.2378938499105
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 474/557 (85.0987%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   2,  Average loss: 0.0036, Accuracy: 515/557 (92.4596%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   3,  Average loss: 0.0019, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   4,  Average loss: 0.0013, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   5,  Average loss: 0.0010, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   6,  Average loss: 0.0009, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   7,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   8,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 74, internal_epoch  10,  Average loss: 0.0006, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Global model norm: 16.48884806757898.
Norm before scaling: 16.747571171268948. Distance: 2.258638329925293
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2697, Accuracy: 9157/10000 (91.5700%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0052, Accuracy: 8947/8968 (99.7658%)
Scaling by  100
Scaled Norm after poisoning: 227.23580985674332, distance: 225.8638451866522
Total norm for 4 adversaries is: 227.23580985674332. distance: 225.8638451866522
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  18, local model 67, internal_epoch   1,  Average loss: 0.0016, Accuracy: 968/998 (96.9940%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3967, Accuracy: 8774/10000 (87.7400%)
___Train Local_Simple,  epoch  18, local model 14, internal_epoch   1,  Average loss: 0.0018, Accuracy: 366/376 (97.3404%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1409, Accuracy: 9587/10000 (95.8700%)
___Train Local_Simple,  epoch  18, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 983/1005 (97.8109%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2224, Accuracy: 9312/10000 (93.1200%)
___Train Local_Simple,  epoch  18, local model 24, internal_epoch   1,  Average loss: 0.0018, Accuracy: 366/379 (96.5699%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1287, Accuracy: 9615/10000 (96.1500%)
___Train Local_Simple,  epoch  18, local model 7, internal_epoch   1,  Average loss: 0.0019, Accuracy: 403/418 (96.4115%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1243, Accuracy: 9612/10000 (96.1200%)
___Train Local_Simple,  epoch  18, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 640/658 (97.2644%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2381, Accuracy: 9228/10000 (92.2800%)
time spent on training: 131.02947807312012
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.37719298245614036  data num: [606, 591, 568, 557, 998, 376, 1005, 379, 418, 658]
[rfa agg] considering poison per batch poison_fraction: 0.11787280701754387
[rfa agg] init. name: [41, 73, 51, 74, 67, 14, 36, 24, 7, 4], weight: tensor([0.0984, 0.0960, 0.0923, 0.0905, 0.1621, 0.0611, 0.1633, 0.0616, 0.0679,
        0.1069])
[rfa agg] iter:  0, prev_obj_val: 109.5329818725586, obj_val: 97.59625244140625, abs dis: 11.936729431152344
[rfa agg] iter:  0, weight: tensor([0.0506, 0.0413, 0.0611, 0.0471, 0.2081, 0.0784, 0.2097, 0.0791, 0.0872,
        0.1373])
[rfa agg] iter:  1, prev_obj_val: 97.59625244140625, obj_val: 91.69921875, abs dis: 5.89703369140625
[rfa agg] iter:  1, weight: tensor([0.0262, 0.0215, 0.0307, 0.0243, 0.2332, 0.0880, 0.2354, 0.0888, 0.0978,
        0.1541])
[rfa agg] iter:  2, prev_obj_val: 91.69921875, obj_val: 88.7218017578125, abs dis: 2.9774169921875
[rfa agg] iter:  2, weight: tensor([0.0133, 0.0110, 0.0153, 0.0123, 0.2460, 0.0930, 0.2488, 0.0939, 0.1033,
        0.1630])
[rfa agg] iter:  3, prev_obj_val: 88.7218017578125, obj_val: 87.24024963378906, abs dis: 1.4815521240234375
[rfa agg] iter:  3, weight: tensor([0.0067, 0.0056, 0.0076, 0.0062, 0.2519, 0.0956, 0.2558, 0.0966, 0.1061,
        0.1678])
[rfa agg] iter:  4, prev_obj_val: 87.24024963378906, obj_val: 86.5324478149414, abs dis: 0.7078018188476562
[rfa agg] iter:  4, weight: tensor([0.0034, 0.0028, 0.0039, 0.0032, 0.2533, 0.0972, 0.2593, 0.0986, 0.1077,
        0.1707])
[rfa agg] iter:  5, prev_obj_val: 86.5324478149414, obj_val: 86.23368835449219, abs dis: 0.29875946044921875
[rfa agg] iter:  5, weight: tensor([0.0018, 0.0015, 0.0020, 0.0017, 0.2503, 0.0991, 0.2601, 0.1013, 0.1092,
        0.1730])
[rfa agg] iter:  6, prev_obj_val: 86.23368835449219, obj_val: 86.14122772216797, abs dis: 0.09246063232421875
[rfa agg] iter:  6, weight: tensor([0.0011, 0.0009, 0.0012, 0.0010, 0.2420, 0.1028, 0.2568, 0.1069, 0.1121,
        0.1754])
[rfa agg] iter:  7, prev_obj_val: 86.14122772216797, obj_val: 86.12393188476562, abs dis: 0.01729583740234375
[rfa agg] iter:  7, weight: tensor([0.0008, 0.0006, 0.0009, 0.0007, 0.2312, 0.1083, 0.2492, 0.1152, 0.1165,
        0.1767])
[rfa agg] iter:  8, prev_obj_val: 86.12393188476562, obj_val: 86.12189483642578, abs dis: 0.00203704833984375
[rfa agg] iter:  8, weight: tensor([0.0007, 0.0006, 0.0008, 0.0006, 0.2235, 0.1126, 0.2425, 0.1217, 0.1200,
        0.1770])
[rfa agg] iter:  9, prev_obj_val: 86.12189483642578, obj_val: 86.12171936035156, abs dis: 0.00017547607421875
[rfa agg] iter:  9, weight: tensor([0.0006, 0.0005, 0.0007, 0.0006, 0.2198, 0.1148, 0.2389, 0.1249, 0.1219,
        0.1772])
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.1180, Accuracy: 9700/10000 (97.0000%)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 3.3303, Accuracy: 879/8968 (9.8015%)
Done in 156.89957189559937 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:19 choose agents : [41, 73, 51, 74, 80, 39, 26, 29, 4, 42]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   1,  Average loss: 0.0072, Accuracy: 517/606 (85.3135%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   2,  Average loss: 0.0030, Accuracy: 579/606 (95.5446%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   3,  Average loss: 0.0019, Accuracy: 582/606 (96.0396%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   4,  Average loss: 0.0015, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   5,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   6,  Average loss: 0.0010, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   7,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   8,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch   9,  Average loss: 0.0008, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 41, internal_epoch  10,  Average loss: 0.0007, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Global model norm: 16.494056324717967.
Norm before scaling: 16.861061952209592. Distance: 2.984635426607535
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.4753, Accuracy: 8392/10000 (83.9200%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0006, Accuracy: 8966/8968 (99.9777%)
Scaling by  100
Scaled Norm after poisoning: 299.476013751519, distance: 298.4635263520486
Total norm for 4 adversaries is: 299.476013751519. distance: 298.4635263520486
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   1,  Average loss: 0.0082, Accuracy: 478/591 (80.8799%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   2,  Average loss: 0.0022, Accuracy: 567/591 (95.9391%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   3,  Average loss: 0.0012, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   4,  Average loss: 0.0011, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   5,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   6,  Average loss: 0.0007, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   7,  Average loss: 0.0008, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   8,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch   9,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 73, internal_epoch  10,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Global model norm: 16.494056324717967.
Norm before scaling: 16.87990199345345. Distance: 3.088778267472094
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.4102, Accuracy: 8701/10000 (87.0100%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0015, Accuracy: 8963/8968 (99.9442%)
Scaling by  100
Scaled Norm after poisoning: 309.85678395429716, distance: 308.8778328481991
Total norm for 4 adversaries is: 309.85678395429716. distance: 308.8778328481991
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   1,  Average loss: 0.0045, Accuracy: 516/568 (90.8451%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   2,  Average loss: 0.0016, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   3,  Average loss: 0.0009, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   4,  Average loss: 0.0007, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   5,  Average loss: 0.0005, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   6,  Average loss: 0.0005, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   7,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   8,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch   9,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 51, internal_epoch  10,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Global model norm: 16.494056324717967.
Norm before scaling: 16.706092792061018. Distance: 1.938021620398545
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3446, Accuracy: 8838/10000 (88.3800%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0229, Accuracy: 8884/8968 (99.0633%)
Scaling by  100
Scaled Norm after poisoning: 195.3450972797884, distance: 193.80216031755168
Total norm for 4 adversaries is: 195.3450972797884. distance: 193.80216031755168
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   1,  Average loss: 0.0069, Accuracy: 469/557 (84.2011%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   2,  Average loss: 0.0025, Accuracy: 530/557 (95.1526%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   3,  Average loss: 0.0013, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   4,  Average loss: 0.0011, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   5,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   6,  Average loss: 0.0009, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   7,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 74, internal_epoch  10,  Average loss: 0.0006, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Global model norm: 16.494056324717967.
Norm before scaling: 16.736743748668488. Distance: 2.2749955648861087
will scale.
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3152, Accuracy: 9005/10000 (90.0500%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0042, Accuracy: 8952/8968 (99.8216%)
Scaling by  100
Scaled Norm after poisoning: 228.72913156176674, distance: 227.49955357099054
Total norm for 4 adversaries is: 228.72913156176674. distance: 227.49955357099054
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  19, local model 80, internal_epoch   1,  Average loss: 0.0010, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3692, Accuracy: 8907/10000 (89.0700%)
___Train Local_Simple,  epoch  19, local model 39, internal_epoch   1,  Average loss: 0.0013, Accuracy: 252/257 (98.0545%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1153, Accuracy: 9666/10000 (96.6600%)
___Train Local_Simple,  epoch  19, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 542/554 (97.8339%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1507, Accuracy: 9547/10000 (95.4700%)
___Train Local_Simple,  epoch  19, local model 29, internal_epoch   1,  Average loss: 0.0012, Accuracy: 985/1002 (98.3034%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2818, Accuracy: 9086/10000 (90.8600%)
___Train Local_Simple,  epoch  19, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 642/658 (97.5684%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3444, Accuracy: 8872/10000 (88.7200%)
___Train Local_Simple,  epoch  19, local model 42, internal_epoch   1,  Average loss: 0.0020, Accuracy: 230/236 (97.4576%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1204, Accuracy: 9631/10000 (96.3100%)
time spent on training: 131.12589931488037
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.42527472527472526  data num: [606, 591, 568, 557, 431, 257, 554, 1002, 658, 236]
[rfa agg] considering poison per batch poison_fraction: 0.13289835164835165
[rfa agg] init. name: [41, 73, 51, 74, 80, 39, 26, 29, 4, 42], weight: tensor([0.1110, 0.1082, 0.1040, 0.1020, 0.0789, 0.0471, 0.1015, 0.1835, 0.1205,
        0.0432])
[rfa agg] iter:  0, prev_obj_val: 134.093017578125, obj_val: 122.93340301513672, abs dis: 11.159614562988281
[rfa agg] iter:  0, weight: tensor([0.0544, 0.0504, 0.0865, 0.0679, 0.1017, 0.0607, 0.1308, 0.2365, 0.1554,
        0.0557])
[rfa agg] iter:  1, prev_obj_val: 122.93340301513672, obj_val: 117.41009521484375, abs dis: 5.523307800292969
[rfa agg] iter:  1, weight: tensor([0.0323, 0.0300, 0.0510, 0.0406, 0.1161, 0.0694, 0.1493, 0.2702, 0.1774,
        0.0637])
[rfa agg] iter:  2, prev_obj_val: 117.41009521484375, obj_val: 114.30753326416016, abs dis: 3.1025619506835938
[rfa agg] iter:  2, weight: tensor([0.0194, 0.0182, 0.0296, 0.0240, 0.1247, 0.0746, 0.1604, 0.2902, 0.1906,
        0.0684])
[rfa agg] iter:  3, prev_obj_val: 114.30753326416016, obj_val: 112.51728057861328, abs dis: 1.790252685546875
[rfa agg] iter:  3, weight: tensor([0.0116, 0.0109, 0.0173, 0.0142, 0.1297, 0.0777, 0.1669, 0.3020, 0.1984,
        0.0713])
[rfa agg] iter:  4, prev_obj_val: 112.51728057861328, obj_val: 111.47650146484375, abs dis: 1.0407791137695312
[rfa agg] iter:  4, weight: tensor([0.0069, 0.0065, 0.0102, 0.0084, 0.1326, 0.0797, 0.1707, 0.3090, 0.2030,
        0.0730])
[rfa agg] iter:  5, prev_obj_val: 111.47650146484375, obj_val: 110.87486267089844, abs dis: 0.6016387939453125
[rfa agg] iter:  5, weight: tensor([0.0041, 0.0039, 0.0060, 0.0050, 0.1341, 0.0811, 0.1729, 0.3130, 0.2056,
        0.0742])
[rfa agg] iter:  6, prev_obj_val: 110.87486267089844, obj_val: 110.53644561767578, abs dis: 0.33841705322265625
[rfa agg] iter:  6, weight: tensor([0.0025, 0.0023, 0.0036, 0.0030, 0.1348, 0.0823, 0.1743, 0.3152, 0.2067,
        0.0753])
[rfa agg] iter:  7, prev_obj_val: 110.53644561767578, obj_val: 110.35983276367188, abs dis: 0.17661285400390625
[rfa agg] iter:  7, weight: tensor([0.0015, 0.0014, 0.0022, 0.0019, 0.1348, 0.0839, 0.1755, 0.3159, 0.2063,
        0.0767])
[rfa agg] iter:  8, prev_obj_val: 110.35983276367188, obj_val: 110.28179168701172, abs dis: 0.07804107666015625
[rfa agg] iter:  8, weight: tensor([0.0010, 0.0009, 0.0014, 0.0012, 0.1344, 0.0861, 0.1773, 0.3150, 0.2036,
        0.0790])
[rfa agg] iter:  9, prev_obj_val: 110.28179168701172, obj_val: 110.25581359863281, abs dis: 0.02597808837890625
[rfa agg] iter:  9, weight: tensor([0.0007, 0.0007, 0.0010, 0.0009, 0.1339, 0.0891, 0.1801, 0.3125, 0.1985,
        0.0826])
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.1104, Accuracy: 9710/10000 (97.1000%)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 3.2497, Accuracy: 975/8968 (10.8720%)
Done in 158.18550658226013 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:20 choose agents : [41, 73, 51, 74, 69, 95, 80, 8, 25, 68]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   1,  Average loss: 0.0065, Accuracy: 533/606 (87.9538%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   2,  Average loss: 0.0021, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   3,  Average loss: 0.0010, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   4,  Average loss: 0.0008, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   5,  Average loss: 0.0007, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   6,  Average loss: 0.0004, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   7,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   8,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch   9,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 41, internal_epoch  10,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Global model norm: 16.499604191512066.
Norm before scaling: 16.741698983773457. Distance: 2.2710811818040506
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3403, Accuracy: 8877/10000 (88.7700%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0128, Accuracy: 8925/8968 (99.5205%)
Scaling by  100
Scaled Norm after poisoning: 228.34031790564276, distance: 227.1081188690752
Total norm for 4 adversaries is: 228.34031790564276. distance: 227.1081188690752
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   1,  Average loss: 0.0073, Accuracy: 499/591 (84.4332%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   2,  Average loss: 0.0027, Accuracy: 554/591 (93.7394%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   3,  Average loss: 0.0009, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   4,  Average loss: 0.0008, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   5,  Average loss: 0.0006, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   6,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   7,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch   9,  Average loss: 0.0005, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Global model norm: 16.499604191512066.
Norm before scaling: 16.837982039429672. Distance: 2.791243440421324
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.4022, Accuracy: 8731/10000 (87.3100%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0082, Accuracy: 8939/8968 (99.6766%)
Scaling by  100
Scaled Norm after poisoning: 280.23491819364693, distance: 279.1243562464587
Total norm for 4 adversaries is: 280.23491819364693. distance: 279.1243562464587
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   1,  Average loss: 0.0056, Accuracy: 508/568 (89.4366%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   2,  Average loss: 0.0022, Accuracy: 548/568 (96.4789%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   3,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   4,  Average loss: 0.0010, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   5,  Average loss: 0.0007, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   6,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   7,  Average loss: 0.0006, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   8,  Average loss: 0.0005, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch   9,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 51, internal_epoch  10,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Global model norm: 16.499604191512066.
Norm before scaling: 16.736363567947357. Distance: 2.0566857198062447
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3657, Accuracy: 8796/10000 (87.9600%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0224, Accuracy: 8889/8968 (99.1191%)
Scaling by  100
Scaled Norm after poisoning: 207.2092842997147, distance: 205.66856491391678
Total norm for 4 adversaries is: 207.2092842997147. distance: 205.66856491391678
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   1,  Average loss: 0.0064, Accuracy: 467/557 (83.8420%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   2,  Average loss: 0.0025, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   3,  Average loss: 0.0009, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   4,  Average loss: 0.0010, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   5,  Average loss: 0.0007, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   6,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   7,  Average loss: 0.0005, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 74, internal_epoch  10,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Global model norm: 16.499604191512066.
Norm before scaling: 16.72050224462471. Distance: 2.0619800952723963
will scale.
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2765, Accuracy: 9115/10000 (91.1500%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0095, Accuracy: 8932/8968 (99.5986%)
Scaling by  100
Scaled Norm after poisoning: 207.6017916739882, distance: 206.1980048096974
Total norm for 4 adversaries is: 207.6017916739882. distance: 206.1980048096974
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  20, local model 69, internal_epoch   1,  Average loss: 0.0023, Accuracy: 246/256 (96.0938%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2063, Accuracy: 9335/10000 (93.3500%)
___Train Local_Simple,  epoch  20, local model 95, internal_epoch   1,  Average loss: 0.0006, Accuracy: 597/602 (99.1694%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.1313, Accuracy: 7585/10000 (75.8500%)
___Train Local_Simple,  epoch  20, local model 80, internal_epoch   1,  Average loss: 0.0012, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2804, Accuracy: 9194/10000 (91.9400%)
___Train Local_Simple,  epoch  20, local model 8, internal_epoch   1,  Average loss: 0.0018, Accuracy: 613/633 (96.8404%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1646, Accuracy: 9475/10000 (94.7500%)
___Train Local_Simple,  epoch  20, local model 25, internal_epoch   1,  Average loss: 0.0019, Accuracy: 629/647 (97.2179%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2034, Accuracy: 9329/10000 (93.2900%)
___Train Local_Simple,  epoch  20, local model 68, internal_epoch   1,  Average loss: 0.0013, Accuracy: 486/494 (98.3806%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1570, Accuracy: 9467/10000 (94.6700%)
time spent on training: 133.2375078201294
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.43119777158774375  data num: [606, 591, 568, 557, 256, 602, 431, 633, 647, 494]
[rfa agg] considering poison per batch poison_fraction: 0.13474930362116994
[rfa agg] init. name: [41, 73, 51, 74, 69, 95, 80, 8, 25, 68], weight: tensor([0.1125, 0.1097, 0.1055, 0.1034, 0.0475, 0.1118, 0.0800, 0.1175, 0.1201,
        0.0917])
[rfa agg] iter:  0, prev_obj_val: 120.13050079345703, obj_val: 110.62321472167969, abs dis: 9.507286071777344
[rfa agg] iter:  0, weight: tensor([0.0659, 0.0508, 0.0725, 0.0686, 0.0620, 0.1459, 0.1044, 0.1533, 0.1567,
        0.1197])
[rfa agg] iter:  1, prev_obj_val: 110.62321472167969, obj_val: 105.81941223144531, abs dis: 4.803802490234375
[rfa agg] iter:  1, weight: tensor([0.0397, 0.0306, 0.0428, 0.0413, 0.0707, 0.1663, 0.1190, 0.1747, 0.1785,
        0.1365])
[rfa agg] iter:  2, prev_obj_val: 105.81941223144531, obj_val: 103.1161117553711, abs dis: 2.7033004760742188
[rfa agg] iter:  2, weight: tensor([0.0240, 0.0187, 0.0253, 0.0246, 0.0759, 0.1785, 0.1276, 0.1874, 0.1914,
        0.1465])
[rfa agg] iter:  3, prev_obj_val: 103.1161117553711, obj_val: 101.54705047607422, abs dis: 1.569061279296875
[rfa agg] iter:  3, weight: tensor([0.0144, 0.0113, 0.0151, 0.0147, 0.0791, 0.1859, 0.1328, 0.1950, 0.1990,
        0.1526])
[rfa agg] iter:  4, prev_obj_val: 101.54705047607422, obj_val: 100.62728881835938, abs dis: 0.9197616577148438
[rfa agg] iter:  4, weight: tensor([0.0087, 0.0069, 0.0091, 0.0088, 0.0810, 0.1904, 0.1359, 0.1995, 0.2033,
        0.1564])
[rfa agg] iter:  5, prev_obj_val: 100.62728881835938, obj_val: 100.09090423583984, abs dis: 0.5363845825195312
[rfa agg] iter:  5, weight: tensor([0.0052, 0.0041, 0.0055, 0.0053, 0.0824, 0.1933, 0.1377, 0.2022, 0.2053,
        0.1590])
[rfa agg] iter:  6, prev_obj_val: 100.09090423583984, obj_val: 99.78685760498047, abs dis: 0.304046630859375
[rfa agg] iter:  6, weight: tensor([0.0032, 0.0025, 0.0033, 0.0032, 0.0836, 0.1949, 0.1388, 0.2038, 0.2054,
        0.1612])
[rfa agg] iter:  7, prev_obj_val: 99.78685760498047, obj_val: 99.62725067138672, abs dis: 0.15960693359375
[rfa agg] iter:  7, weight: tensor([0.0020, 0.0016, 0.0021, 0.0020, 0.0852, 0.1955, 0.1397, 0.2049, 0.2031,
        0.1639])
[rfa agg] iter:  8, prev_obj_val: 99.62725067138672, obj_val: 99.55615997314453, abs dis: 0.0710906982421875
[rfa agg] iter:  8, weight: tensor([0.0013, 0.0011, 0.0014, 0.0013, 0.0878, 0.1945, 0.1407, 0.2062, 0.1978,
        0.1680])
[rfa agg] iter:  9, prev_obj_val: 99.55615997314453, obj_val: 99.5319595336914, abs dis: 0.024200439453125
[rfa agg] iter:  9, weight: tensor([0.0010, 0.0008, 0.0010, 0.0010, 0.0914, 0.1914, 0.1421, 0.2078, 0.1900,
        0.1736])
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.1065, Accuracy: 9712/10000 (97.1200%)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 3.1288, Accuracy: 1150/8968 (12.8234%)
Done in 159.66372084617615 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:21 choose agents : [41, 73, 51, 74, 70, 61, 64, 31, 10, 23]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0050, Accuracy: 550/606 (90.7591%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: 0.0016, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: 0.0013, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: 0.0006, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: 0.0006, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Global model norm: 16.505714120655686.
Norm before scaling: 16.741907698606866. Distance: 2.2053933876990826
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3168, Accuracy: 8985/10000 (89.8500%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0076, Accuracy: 8943/8968 (99.7212%)
Scaling by  100
Scaled Norm after poisoning: 221.83088469879482, distance: 220.53933358076966
Total norm for 4 adversaries is: 221.83088469879482. distance: 220.53933358076966
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 515/591 (87.1404%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   2,  Average loss: 0.0015, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   3,  Average loss: 0.0008, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   4,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   5,  Average loss: 0.0006, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   6,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   7,  Average loss: 0.0005, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch   9,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Global model norm: 16.505714120655686.
Norm before scaling: 16.758448960815723. Distance: 2.2482361767671692
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2953, Accuracy: 9083/10000 (90.8300%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0188, Accuracy: 8900/8968 (99.2417%)
Scaling by  100
Scaled Norm after poisoning: 226.1710411254058, distance: 224.82362010307102
Total norm for 4 adversaries is: 226.1710411254058. distance: 224.82362010307102
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 516/568 (90.8451%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   2,  Average loss: 0.0011, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   3,  Average loss: 0.0007, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   4,  Average loss: 0.0006, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   5,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   6,  Average loss: 0.0005, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   7,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   8,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   9,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch  10,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Global model norm: 16.505714120655686.
Norm before scaling: 16.680019573685026. Distance: 1.6866143339630257
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3260, Accuracy: 8941/10000 (89.4100%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0296, Accuracy: 8871/8968 (98.9184%)
Scaling by  100
Scaled Norm after poisoning: 170.33230389447564, distance: 168.66142930253793
Total norm for 4 adversaries is: 170.33230389447564. distance: 168.66142930253793
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 494/557 (88.6894%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   2,  Average loss: 0.0018, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   3,  Average loss: 0.0008, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   4,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   5,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   6,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   7,  Average loss: 0.0005, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch   9,  Average loss: 0.0004, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 74, internal_epoch  10,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Global model norm: 16.505714120655686.
Norm before scaling: 16.65993872586599. Distance: 1.7178209741725856
will scale.
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2613, Accuracy: 9175/10000 (91.7500%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0088, Accuracy: 8933/8968 (99.6097%)
Scaling by  100
Scaled Norm after poisoning: 173.19910981475914, distance: 171.78210557818588
Total norm for 4 adversaries is: 173.19910981475914. distance: 171.78210557818588
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  21, local model 70, internal_epoch   1,  Average loss: 0.0018, Accuracy: 701/724 (96.8232%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2449, Accuracy: 9152/10000 (91.5200%)
___Train Local_Simple,  epoch  21, local model 61, internal_epoch   1,  Average loss: 0.0016, Accuracy: 680/699 (97.2818%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1758, Accuracy: 9446/10000 (94.4600%)
___Train Local_Simple,  epoch  21, local model 64, internal_epoch   1,  Average loss: 0.0020, Accuracy: 782/813 (96.1870%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3182, Accuracy: 8899/10000 (88.9900%)
___Train Local_Simple,  epoch  21, local model 31, internal_epoch   1,  Average loss: 0.0012, Accuracy: 816/835 (97.7246%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1710, Accuracy: 9484/10000 (94.8400%)
___Train Local_Simple,  epoch  21, local model 10, internal_epoch   1,  Average loss: 0.0017, Accuracy: 869/892 (97.4215%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6360, Accuracy: 8347/10000 (83.4700%)
___Train Local_Simple,  epoch  21, local model 23, internal_epoch   1,  Average loss: 0.0011, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1398, Accuracy: 9548/10000 (95.4800%)
time spent on training: 131.0537884235382
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3529948312557008  data num: [606, 591, 568, 557, 724, 699, 813, 835, 892, 293]
[rfa agg] considering poison per batch poison_fraction: 0.1103108847674065
[rfa agg] init. name: [41, 73, 51, 74, 70, 61, 64, 31, 10, 23], weight: tensor([0.0921, 0.0898, 0.0863, 0.0847, 0.1101, 0.1063, 0.1236, 0.1269, 0.1356,
        0.0445])
[rfa agg] iter:  0, prev_obj_val: 91.33889770507812, obj_val: 79.17888641357422, abs dis: 12.160011291503906
[rfa agg] iter:  0, weight: tensor([0.0373, 0.0352, 0.0480, 0.0446, 0.1420, 0.1371, 0.1593, 0.1638, 0.1751,
        0.0575])
[rfa agg] iter:  1, prev_obj_val: 79.17888641357422, obj_val: 73.85836791992188, abs dis: 5.320518493652344
[rfa agg] iter:  1, weight: tensor([0.0167, 0.0159, 0.0212, 0.0201, 0.1575, 0.1522, 0.1763, 0.1819, 0.1944,
        0.0638])
[rfa agg] iter:  2, prev_obj_val: 73.85836791992188, obj_val: 71.51896667480469, abs dis: 2.3394012451171875
[rfa agg] iter:  2, weight: tensor([0.0074, 0.0071, 0.0092, 0.0088, 0.1645, 0.1591, 0.1834, 0.1902, 0.2035,
        0.0667])
[rfa agg] iter:  3, prev_obj_val: 71.51896667480469, obj_val: 70.53578186035156, abs dis: 0.983184814453125
[rfa agg] iter:  3, weight: tensor([0.0033, 0.0032, 0.0041, 0.0039, 0.1672, 0.1625, 0.1848, 0.1946, 0.2081,
        0.0683])
[rfa agg] iter:  4, prev_obj_val: 70.53578186035156, obj_val: 70.18324279785156, abs dis: 0.3525390625
[rfa agg] iter:  4, weight: tensor([0.0015, 0.0015, 0.0019, 0.0018, 0.1670, 0.1656, 0.1810, 0.1986, 0.2107,
        0.0704])
[rfa agg] iter:  5, prev_obj_val: 70.18324279785156, obj_val: 70.10222625732422, abs dis: 0.08101654052734375
[rfa agg] iter:  5, weight: tensor([0.0008, 0.0008, 0.0010, 0.0010, 0.1629, 0.1713, 0.1715, 0.2050, 0.2099,
        0.0758])
[rfa agg] iter:  6, prev_obj_val: 70.10222625732422, obj_val: 70.0931167602539, abs dis: 0.0091094970703125
[rfa agg] iter:  6, weight: tensor([0.0006, 0.0006, 0.0008, 0.0007, 0.1571, 0.1777, 0.1626, 0.2113, 0.2055,
        0.0831])
[rfa agg] iter:  7, prev_obj_val: 70.0931167602539, obj_val: 70.0925521850586, abs dis: 0.0005645751953125
[rfa agg] iter:  7, weight: tensor([0.0006, 0.0005, 0.0007, 0.0007, 0.1540, 0.1813, 0.1586, 0.2145, 0.2022,
        0.0869])
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.1031, Accuracy: 9714/10000 (97.1400%)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 3.1891, Accuracy: 1129/8968 (12.5892%)
Done in 157.03451418876648 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:22 choose agents : [41, 73, 51, 74, 7, 46, 65, 57, 83, 9]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   1,  Average loss: 0.0057, Accuracy: 540/606 (89.1089%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   2,  Average loss: 0.0019, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   3,  Average loss: 0.0010, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   4,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   5,  Average loss: 0.0008, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   6,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   7,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   8,  Average loss: 0.0006, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch   9,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 41, internal_epoch  10,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Global model norm: 16.509528905384744.
Norm before scaling: 16.732181921830588. Distance: 2.2374556851394054
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3262, Accuracy: 8924/10000 (89.2400%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0022, Accuracy: 8961/8968 (99.9219%)
Scaling by  100
Scaled Norm after poisoning: 224.88700287588875, distance: 223.7455917861847
Total norm for 4 adversaries is: 224.88700287588875. distance: 223.7455917861847
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   1,  Average loss: 0.0067, Accuracy: 503/591 (85.1100%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   2,  Average loss: 0.0020, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   3,  Average loss: 0.0010, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   4,  Average loss: 0.0011, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   5,  Average loss: 0.0008, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   6,  Average loss: 0.0006, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   7,  Average loss: 0.0006, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   8,  Average loss: 0.0005, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch   9,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 73, internal_epoch  10,  Average loss: 0.0006, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Global model norm: 16.509528905384744.
Norm before scaling: 16.831433380975106. Distance: 2.673560609106591
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.4031, Accuracy: 8741/10000 (87.4100%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0031, Accuracy: 8956/8968 (99.8662%)
Scaling by  100
Scaled Norm after poisoning: 268.5336192872319, distance: 267.3560652482004
Total norm for 4 adversaries is: 268.5336192872319. distance: 267.3560652482004
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   1,  Average loss: 0.0037, Accuracy: 526/568 (92.6056%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   2,  Average loss: 0.0015, Accuracy: 555/568 (97.7113%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   3,  Average loss: 0.0009, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   4,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   5,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   6,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   7,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   8,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch   9,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 51, internal_epoch  10,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Global model norm: 16.509528905384744.
Norm before scaling: 16.685152610238635. Distance: 1.6390530275956625
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3386, Accuracy: 8898/10000 (88.9800%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0483, Accuracy: 8818/8968 (98.3274%)
Scaling by  100
Scaled Norm after poisoning: 165.68597344638138, distance: 163.90530564551594
Total norm for 4 adversaries is: 165.68597344638138. distance: 163.90530564551594
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 473/557 (84.9192%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   2,  Average loss: 0.0032, Accuracy: 528/557 (94.7935%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   3,  Average loss: 0.0012, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   4,  Average loss: 0.0012, Accuracy: 543/557 (97.4865%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   5,  Average loss: 0.0008, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   6,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   7,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   8,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 74, internal_epoch  10,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Global model norm: 16.509528905384744.
Norm before scaling: 16.75420543201626. Distance: 2.180425484807909
will scale.
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3001, Accuracy: 9038/10000 (90.3800%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0078, Accuracy: 8939/8968 (99.6766%)
Scaling by  100
Scaled Norm after poisoning: 219.43922670924175, distance: 218.0425524696957
Total norm for 4 adversaries is: 219.43922670924175. distance: 218.0425524696957
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  22, local model 7, internal_epoch   1,  Average loss: 0.0014, Accuracy: 408/418 (97.6077%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1465, Accuracy: 9527/10000 (95.2700%)
___Train Local_Simple,  epoch  22, local model 46, internal_epoch   1,  Average loss: 0.0017, Accuracy: 692/710 (97.4648%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3161, Accuracy: 8962/10000 (89.6200%)
___Train Local_Simple,  epoch  22, local model 65, internal_epoch   1,  Average loss: 0.0012, Accuracy: 365/371 (98.3827%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1401, Accuracy: 9528/10000 (95.2800%)
___Train Local_Simple,  epoch  22, local model 57, internal_epoch   1,  Average loss: 0.0016, Accuracy: 328/343 (95.6268%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1562, Accuracy: 9524/10000 (95.2400%)
___Train Local_Simple,  epoch  22, local model 83, internal_epoch   1,  Average loss: 0.0017, Accuracy: 419/433 (96.7667%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1132, Accuracy: 9631/10000 (96.3100%)
___Train Local_Simple,  epoch  22, local model 9, internal_epoch   1,  Average loss: 0.0012, Accuracy: 427/436 (97.9358%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1122, Accuracy: 9638/10000 (96.3800%)
time spent on training: 130.49896097183228
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.46135505662626664  data num: [606, 591, 568, 557, 418, 710, 371, 343, 433, 436]
[rfa agg] considering poison per batch poison_fraction: 0.14417345519570832
[rfa agg] init. name: [41, 73, 51, 74, 7, 46, 65, 57, 83, 9], weight: tensor([0.1204, 0.1174, 0.1129, 0.1107, 0.0831, 0.1411, 0.0737, 0.0682, 0.0860,
        0.0866])
[rfa agg] iter:  0, prev_obj_val: 118.56175994873047, obj_val: 111.07067108154297, abs dis: 7.4910888671875
[rfa agg] iter:  0, weight: tensor([0.0739, 0.0581, 0.1041, 0.0690, 0.1071, 0.1820, 0.0951, 0.0879, 0.1110,
        0.1118])
[rfa agg] iter:  1, prev_obj_val: 111.07067108154297, obj_val: 107.33445739746094, abs dis: 3.7362136840820312
[rfa agg] iter:  1, weight: tensor([0.0487, 0.0384, 0.0686, 0.0461, 0.1230, 0.2090, 0.1092, 0.1010, 0.1275,
        0.1284])
[rfa agg] iter:  2, prev_obj_val: 107.33445739746094, obj_val: 105.1111831665039, abs dis: 2.2232742309570312
[rfa agg] iter:  2, weight: tensor([0.0328, 0.0262, 0.0446, 0.0310, 0.1333, 0.2266, 0.1184, 0.1096, 0.1383,
        0.1392])
[rfa agg] iter:  3, prev_obj_val: 105.1111831665039, obj_val: 103.71285247802734, abs dis: 1.3983306884765625
[rfa agg] iter:  3, weight: tensor([0.0222, 0.0179, 0.0295, 0.0210, 0.1400, 0.2381, 0.1245, 0.1152, 0.1453,
        0.1463])
[rfa agg] iter:  4, prev_obj_val: 103.71285247802734, obj_val: 102.8082275390625, abs dis: 0.9046249389648438
[rfa agg] iter:  4, weight: tensor([0.0150, 0.0122, 0.0197, 0.0142, 0.1445, 0.2457, 0.1285, 0.1190, 0.1501,
        0.1511])
[rfa agg] iter:  5, prev_obj_val: 102.8082275390625, obj_val: 102.21434020996094, abs dis: 0.5938873291015625
[rfa agg] iter:  5, weight: tensor([0.0102, 0.0083, 0.0133, 0.0096, 0.1474, 0.2507, 0.1313, 0.1216, 0.1533,
        0.1544])
[rfa agg] iter:  6, prev_obj_val: 102.21434020996094, obj_val: 101.8222885131836, abs dis: 0.39205169677734375
[rfa agg] iter:  6, weight: tensor([0.0069, 0.0056, 0.0090, 0.0065, 0.1492, 0.2539, 0.1332, 0.1234, 0.1556,
        0.1567])
[rfa agg] iter:  7, prev_obj_val: 101.8222885131836, obj_val: 101.56437683105469, abs dis: 0.25791168212890625
[rfa agg] iter:  7, weight: tensor([0.0047, 0.0038, 0.0061, 0.0045, 0.1502, 0.2556, 0.1346, 0.1247, 0.1572,
        0.1585])
[rfa agg] iter:  8, prev_obj_val: 101.56437683105469, obj_val: 101.39751434326172, abs dis: 0.16686248779296875
[rfa agg] iter:  8, weight: tensor([0.0032, 0.0026, 0.0042, 0.0031, 0.1506, 0.2560, 0.1358, 0.1258, 0.1586,
        0.1602])
[rfa agg] iter:  9, prev_obj_val: 101.39751434326172, obj_val: 101.29367065429688, abs dis: 0.10384368896484375
[rfa agg] iter:  9, weight: tensor([0.0023, 0.0018, 0.0029, 0.0021, 0.1504, 0.2548, 0.1371, 0.1266, 0.1598,
        0.1621])
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.1035, Accuracy: 9710/10000 (97.1000%)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 2.5764, Accuracy: 1960/8968 (21.8555%)
Done in 156.46999192237854 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:23 choose agents : [41, 73, 51, 74, 64, 58, 12, 83, 96, 90]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   1,  Average loss: 0.0040, Accuracy: 563/606 (92.9043%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   2,  Average loss: 0.0017, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   3,  Average loss: 0.0010, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   4,  Average loss: 0.0008, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   5,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   6,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   7,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   8,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   9,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch  10,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Global model norm: 16.520810037847436.
Norm before scaling: 16.715532510201683. Distance: 1.9033953444917484
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3052, Accuracy: 8981/10000 (89.8100%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0177, Accuracy: 8910/8968 (99.3533%)
Scaling by  100
Scaled Norm after poisoning: 191.7992725155651, distance: 190.3395198388921
Total norm for 4 adversaries is: 191.7992725155651. distance: 190.3395198388921
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   1,  Average loss: 0.0054, Accuracy: 526/591 (89.0017%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   2,  Average loss: 0.0015, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   3,  Average loss: 0.0011, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   4,  Average loss: 0.0007, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   5,  Average loss: 0.0006, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   6,  Average loss: 0.0007, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   7,  Average loss: 0.0005, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   9,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch  10,  Average loss: 0.0005, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Global model norm: 16.520810037847436.
Norm before scaling: 16.775198585938. Distance: 2.3139928174908873
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3372, Accuracy: 8925/10000 (89.2500%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0093, Accuracy: 8929/8968 (99.5651%)
Scaling by  100
Scaled Norm after poisoning: 232.6587915408528, distance: 231.39926770357334
Total norm for 4 adversaries is: 232.6587915408528. distance: 231.39926770357334
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   1,  Average loss: 0.0030, Accuracy: 534/568 (94.0141%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   2,  Average loss: 0.0011, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   3,  Average loss: 0.0008, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   4,  Average loss: 0.0006, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   5,  Average loss: 0.0006, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   6,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   7,  Average loss: 0.0004, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   8,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   9,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch  10,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Global model norm: 16.520810037847436.
Norm before scaling: 16.643389405066262. Distance: 1.4252791683395352
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3119, Accuracy: 8976/10000 (89.7600%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0204, Accuracy: 8899/8968 (99.2306%)
Scaling by  100
Scaled Norm after poisoning: 144.1891932063565, distance: 142.5279098216381
Total norm for 4 adversaries is: 144.1891932063565. distance: 142.5279098216381
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 508/557 (91.2029%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   2,  Average loss: 0.0020, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   3,  Average loss: 0.0012, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   4,  Average loss: 0.0008, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   5,  Average loss: 0.0008, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   6,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   7,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   8,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   9,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch  10,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Global model norm: 16.520810037847436.
Norm before scaling: 16.706424340887924. Distance: 1.753857652292513
will scale.
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2356, Accuracy: 9263/10000 (92.6300%)
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0061, Accuracy: 8944/8968 (99.7324%)
Scaling by  100
Scaled Norm after poisoning: 177.0374088734497, distance: 175.38576343484954
Total norm for 4 adversaries is: 177.0374088734497. distance: 175.38576343484954
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  23, local model 64, internal_epoch   1,  Average loss: 0.0019, Accuracy: 785/813 (96.5560%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2947, Accuracy: 8998/10000 (89.9800%)
___Train Local_Simple,  epoch  23, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 266/276 (96.3768%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1457, Accuracy: 9562/10000 (95.6200%)
___Train Local_Simple,  epoch  23, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1129/1160 (97.3276%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2618, Accuracy: 9249/10000 (92.4900%)
___Train Local_Simple,  epoch  23, local model 83, internal_epoch   1,  Average loss: 0.0017, Accuracy: 421/433 (97.2286%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1027, Accuracy: 9678/10000 (96.7800%)
___Train Local_Simple,  epoch  23, local model 96, internal_epoch   1,  Average loss: 0.0015, Accuracy: 661/672 (98.3631%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1484, Accuracy: 9569/10000 (95.6900%)
___Train Local_Simple,  epoch  23, local model 90, internal_epoch   1,  Average loss: 0.0016, Accuracy: 664/683 (97.2182%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3888, Accuracy: 8732/10000 (87.3200%)
time spent on training: 130.46593356132507
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3651517534203491  data num: [606, 591, 568, 557, 813, 276, 1160, 433, 672, 683]
[rfa agg] considering poison per batch poison_fraction: 0.1141099229438591
[rfa agg] init. name: [41, 73, 51, 74, 64, 58, 12, 83, 96, 90], weight: tensor([0.0953, 0.0929, 0.0893, 0.0876, 0.1279, 0.0434, 0.1824, 0.0681, 0.1057,
        0.1074])
[rfa agg] iter:  0, prev_obj_val: 87.79035186767578, obj_val: 76.99574279785156, abs dis: 10.794609069824219
[rfa agg] iter:  0, weight: tensor([0.0444, 0.0341, 0.0595, 0.0442, 0.1646, 0.0559, 0.2348, 0.0878, 0.1361,
        0.1384])
[rfa agg] iter:  1, prev_obj_val: 76.99574279785156, obj_val: 72.08607482910156, abs dis: 4.90966796875
[rfa agg] iter:  1, weight: tensor([0.0211, 0.0165, 0.0277, 0.0212, 0.1838, 0.0625, 0.2622, 0.0982, 0.1521,
        0.1547])
[rfa agg] iter:  2, prev_obj_val: 72.08607482910156, obj_val: 69.80093383789062, abs dis: 2.2851409912109375
[rfa agg] iter:  2, weight: tensor([0.0099, 0.0079, 0.0127, 0.0099, 0.1928, 0.0658, 0.2751, 0.1034, 0.1598,
        0.1627])
[rfa agg] iter:  3, prev_obj_val: 69.80093383789062, obj_val: 68.77386474609375, abs dis: 1.027069091796875
[rfa agg] iter:  3, weight: tensor([0.0047, 0.0037, 0.0059, 0.0047, 0.1965, 0.0676, 0.2800, 0.1065, 0.1638,
        0.1666])
[rfa agg] iter:  4, prev_obj_val: 68.77386474609375, obj_val: 68.36304473876953, abs dis: 0.41082000732421875
[rfa agg] iter:  4, weight: tensor([0.0023, 0.0018, 0.0028, 0.0022, 0.1971, 0.0694, 0.2789, 0.1102, 0.1671,
        0.1681])
[rfa agg] iter:  5, prev_obj_val: 68.36304473876953, obj_val: 68.24490356445312, abs dis: 0.11814117431640625
[rfa agg] iter:  5, weight: tensor([0.0012, 0.0010, 0.0015, 0.0012, 0.1950, 0.0727, 0.2696, 0.1181, 0.1730,
        0.1665])
[rfa agg] iter:  6, prev_obj_val: 68.24490356445312, obj_val: 68.22574615478516, abs dis: 0.01915740966796875
[rfa agg] iter:  6, weight: tensor([0.0009, 0.0007, 0.0011, 0.0009, 0.1916, 0.0773, 0.2541, 0.1304, 0.1817,
        0.1615])
[rfa agg] iter:  7, prev_obj_val: 68.22574615478516, obj_val: 68.22386169433594, abs dis: 0.00188446044921875
[rfa agg] iter:  7, weight: tensor([0.0007, 0.0006, 0.0009, 0.0007, 0.1897, 0.0803, 0.2416, 0.1394, 0.1884,
        0.1576])
[rfa agg] iter:  8, prev_obj_val: 68.22386169433594, obj_val: 68.22369384765625, abs dis: 0.0001678466796875
[rfa agg] iter:  8, weight: tensor([0.0007, 0.0006, 0.0009, 0.0007, 0.1892, 0.0816, 0.2350, 0.1435, 0.1918,
        0.1560])
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.0990, Accuracy: 9717/10000 (97.1700%)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 2.5287, Accuracy: 2094/8968 (23.3497%)
Done in 155.3782422542572 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:24 choose agents : [41, 73, 51, 74, 28, 65, 33, 75, 13, 32]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   1,  Average loss: 0.0043, Accuracy: 559/606 (92.2442%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   2,  Average loss: 0.0016, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   3,  Average loss: 0.0012, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   4,  Average loss: 0.0008, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   5,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   6,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   7,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   8,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch  10,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Global model norm: 16.52405159172106.
Norm before scaling: 16.70207258143806. Distance: 1.9303293126074872
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2963, Accuracy: 9049/10000 (90.4900%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0193, Accuracy: 8905/8968 (99.2975%)
Scaling by  100
Scaled Norm after poisoning: 194.30294082308689, distance: 193.03293719919924
Total norm for 4 adversaries is: 194.30294082308689. distance: 193.03293719919924
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   1,  Average loss: 0.0050, Accuracy: 524/591 (88.6633%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   2,  Average loss: 0.0023, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   3,  Average loss: 0.0011, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   4,  Average loss: 0.0006, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   5,  Average loss: 0.0006, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   6,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   7,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   9,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch  10,  Average loss: 0.0005, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Global model norm: 16.52405159172106.
Norm before scaling: 16.812114271539343. Distance: 2.4579199319436147
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3433, Accuracy: 8933/10000 (89.3300%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0112, Accuracy: 8920/8968 (99.4648%)
Scaling by  100
Scaled Norm after poisoning: 247.0686186947869, distance: 245.7919915802791
Total norm for 4 adversaries is: 247.0686186947869. distance: 245.7919915802791
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 528/568 (92.9577%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   2,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   3,  Average loss: 0.0009, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   4,  Average loss: 0.0007, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   5,  Average loss: 0.0005, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   6,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   7,  Average loss: 0.0003, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   8,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   9,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch  10,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Global model norm: 16.52405159172106.
Norm before scaling: 16.687547547919152. Distance: 1.6503278551071758
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3144, Accuracy: 8971/10000 (89.7100%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0295, Accuracy: 8877/8968 (98.9853%)
Scaling by  100
Scaled Norm after poisoning: 166.67183911244575, distance: 165.03277373373447
Total norm for 4 adversaries is: 166.67183911244575. distance: 165.03277373373447
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 502/557 (90.1257%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   2,  Average loss: 0.0022, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   3,  Average loss: 0.0019, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   4,  Average loss: 0.0014, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   5,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   6,  Average loss: 0.0010, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   7,  Average loss: 0.0007, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   9,  Average loss: 0.0004, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch  10,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Global model norm: 16.52405159172106.
Norm before scaling: 16.68797913052798. Distance: 1.73699354845429
will scale.
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2038, Accuracy: 9393/10000 (93.9300%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0119, Accuracy: 8925/8968 (99.5205%)
Scaling by  100
Scaled Norm after poisoning: 175.17771668187424, distance: 173.69935188062735
Total norm for 4 adversaries is: 175.17771668187424. distance: 173.69935188062735
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  24, local model 28, internal_epoch   1,  Average loss: 0.0014, Accuracy: 487/501 (97.2056%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1118, Accuracy: 9629/10000 (96.2900%)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0012, Accuracy: 365/371 (98.3827%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1207, Accuracy: 9601/10000 (96.0100%)
___Train Local_Simple,  epoch  24, local model 33, internal_epoch   1,  Average loss: 0.0016, Accuracy: 603/623 (96.7897%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1615, Accuracy: 9465/10000 (94.6500%)
___Train Local_Simple,  epoch  24, local model 75, internal_epoch   1,  Average loss: 0.0011, Accuracy: 669/686 (97.5219%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1486, Accuracy: 9523/10000 (95.2300%)
___Train Local_Simple,  epoch  24, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 716/734 (97.5477%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2814, Accuracy: 9128/10000 (91.2800%)
___Train Local_Simple,  epoch  24, local model 32, internal_epoch   1,  Average loss: 0.0020, Accuracy: 939/977 (96.1105%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2579, Accuracy: 9133/10000 (91.3300%)
time spent on training: 125.44852662086487
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3736723527518507  data num: [606, 591, 568, 557, 501, 371, 623, 686, 734, 977]
[rfa agg] considering poison per batch poison_fraction: 0.11677261023495333
[rfa agg] init. name: [41, 73, 51, 74, 28, 65, 33, 75, 13, 32], weight: tensor([0.0975, 0.0951, 0.0914, 0.0896, 0.0806, 0.0597, 0.1003, 0.1104, 0.1181,
        0.1572])
[rfa agg] iter:  0, prev_obj_val: 93.53302001953125, obj_val: 82.49171447753906, abs dis: 11.041305541992188
[rfa agg] iter:  0, weight: tensor([0.0475, 0.0348, 0.0553, 0.0495, 0.1047, 0.0775, 0.1302, 0.1432, 0.1533,
        0.2039])
[rfa agg] iter:  1, prev_obj_val: 82.49171447753906, obj_val: 77.45117950439453, abs dis: 5.040534973144531
[rfa agg] iter:  1, weight: tensor([0.0231, 0.0171, 0.0262, 0.0240, 0.1172, 0.0868, 0.1458, 0.1602, 0.1716,
        0.2279])
[rfa agg] iter:  2, prev_obj_val: 77.45117950439453, obj_val: 75.06538391113281, abs dis: 2.3857955932617188
[rfa agg] iter:  2, weight: tensor([0.0111, 0.0084, 0.0123, 0.0114, 0.1234, 0.0914, 0.1537, 0.1685, 0.1806,
        0.2392])
[rfa agg] iter:  3, prev_obj_val: 75.06538391113281, obj_val: 73.95794677734375, abs dis: 1.1074371337890625
[rfa agg] iter:  3, weight: tensor([0.0053, 0.0040, 0.0058, 0.0054, 0.1268, 0.0939, 0.1579, 0.1725, 0.1850,
        0.2434])
[rfa agg] iter:  4, prev_obj_val: 73.95794677734375, obj_val: 73.47996520996094, abs dis: 0.4779815673828125
[rfa agg] iter:  4, weight: tensor([0.0026, 0.0020, 0.0028, 0.0026, 0.1297, 0.0962, 0.1607, 0.1751, 0.1866,
        0.2416])
[rfa agg] iter:  5, prev_obj_val: 73.47996520996094, obj_val: 73.31504821777344, abs dis: 0.1649169921875
[rfa agg] iter:  5, weight: tensor([0.0013, 0.0010, 0.0015, 0.0014, 0.1353, 0.1008, 0.1632, 0.1792, 0.1852,
        0.2310])
[rfa agg] iter:  6, prev_obj_val: 73.31504821777344, obj_val: 73.27890014648438, abs dis: 0.0361480712890625
[rfa agg] iter:  6, weight: tensor([0.0009, 0.0007, 0.0009, 0.0009, 0.1457, 0.1097, 0.1639, 0.1871, 0.1790,
        0.2112])
[rfa agg] iter:  7, prev_obj_val: 73.27890014648438, obj_val: 73.27409362792969, abs dis: 0.0048065185546875
[rfa agg] iter:  7, weight: tensor([0.0007, 0.0005, 0.0008, 0.0007, 0.1560, 0.1185, 0.1626, 0.1948, 0.1718,
        0.1936])
[rfa agg] iter:  8, prev_obj_val: 73.27409362792969, obj_val: 73.27360534667969, abs dis: 0.00048828125
[rfa agg] iter:  8, weight: tensor([0.0006, 0.0005, 0.0007, 0.0007, 0.1616, 0.1231, 0.1617, 0.1991, 0.1678,
        0.1843])
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.0953, Accuracy: 9718/10000 (97.1800%)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 2.5942, Accuracy: 2074/8968 (23.1267%)
Done in 155.52674078941345 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:25 choose agents : [41, 73, 51, 74, 80, 23, 25, 12, 58, 19]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   1,  Average loss: 0.0045, Accuracy: 557/606 (91.9142%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   2,  Average loss: 0.0017, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   3,  Average loss: 0.0011, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   4,  Average loss: 0.0010, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   5,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   6,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   7,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   8,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   9,  Average loss: 0.0006, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch  10,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Global model norm: 16.527524243430637.
Norm before scaling: 16.725402991396333. Distance: 1.9647354490491502
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3031, Accuracy: 9000/10000 (90.0000%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0167, Accuracy: 8909/8968 (99.3421%)
Scaling by  100
Scaled Norm after poisoning: 197.85599837697617, distance: 196.47353908987338
Total norm for 4 adversaries is: 197.85599837697617. distance: 196.47353908987338
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0046, Accuracy: 544/591 (92.0474%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   2,  Average loss: 0.0014, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   3,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   4,  Average loss: 0.0006, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   5,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   6,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   7,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Global model norm: 16.527524243430637.
Norm before scaling: 16.700316575755945. Distance: 1.8978751648749121
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2936, Accuracy: 9085/10000 (90.8500%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0205, Accuracy: 8897/8968 (99.2083%)
Scaling by  100
Scaled Norm after poisoning: 191.06652759902767, distance: 189.78752511031908
Total norm for 4 adversaries is: 191.06652759902767. distance: 189.78752511031908
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   1,  Average loss: 0.0027, Accuracy: 540/568 (95.0704%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   2,  Average loss: 0.0016, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   3,  Average loss: 0.0005, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   4,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   5,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   6,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   7,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   8,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   9,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch  10,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Global model norm: 16.527524243430637.
Norm before scaling: 16.66055694491765. Distance: 1.436534142470523
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3053, Accuracy: 9045/10000 (90.4500%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0211, Accuracy: 8895/8968 (99.1860%)
Scaling by  100
Scaled Norm after poisoning: 145.41187462256994, distance: 143.65341864188267
Total norm for 4 adversaries is: 145.41187462256994. distance: 143.65341864188267
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 493/557 (88.5099%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   2,  Average loss: 0.0021, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   3,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   4,  Average loss: 0.0008, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   5,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   6,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   7,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   9,  Average loss: 0.0005, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch  10,  Average loss: 0.0004, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Global model norm: 16.527524243430637.
Norm before scaling: 16.71290329280372. Distance: 1.7831280495089057
will scale.
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2245, Accuracy: 9304/10000 (93.0400%)
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0066, Accuracy: 8941/8968 (99.6989%)
Scaling by  100
Scaled Norm after poisoning: 179.907951724625, distance: 178.31280121776172
Total norm for 4 adversaries is: 179.907951724625. distance: 178.31280121776172
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  25, local model 80, internal_epoch   1,  Average loss: 0.0012, Accuracy: 421/431 (97.6798%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2173, Accuracy: 9323/10000 (93.2300%)
___Train Local_Simple,  epoch  25, local model 23, internal_epoch   1,  Average loss: 0.0010, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1519, Accuracy: 9481/10000 (94.8100%)
___Train Local_Simple,  epoch  25, local model 25, internal_epoch   1,  Average loss: 0.0016, Accuracy: 628/647 (97.0634%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4044, Accuracy: 8644/10000 (86.4400%)
___Train Local_Simple,  epoch  25, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1126/1160 (97.0690%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3835, Accuracy: 8822/10000 (88.2200%)
___Train Local_Simple,  epoch  25, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 266/276 (96.3768%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1530, Accuracy: 9538/10000 (95.3800%)
___Train Local_Simple,  epoch  25, local model 19, internal_epoch   1,  Average loss: 0.0025, Accuracy: 200/205 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1143, Accuracy: 9655/10000 (96.5500%)
time spent on training: 129.19033670425415
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.43532058492688414  data num: [606, 591, 568, 557, 431, 293, 647, 1160, 276, 205]
[rfa agg] considering poison per batch poison_fraction: 0.13603768278965128
[rfa agg] init. name: [41, 73, 51, 74, 80, 23, 25, 12, 58, 19], weight: tensor([0.1136, 0.1108, 0.1065, 0.1044, 0.0808, 0.0549, 0.1213, 0.2175, 0.0517,
        0.0384])
[rfa agg] iter:  0, prev_obj_val: 93.15576171875, obj_val: 85.97633361816406, abs dis: 7.1794281005859375
[rfa agg] iter:  0, weight: tensor([0.0588, 0.0592, 0.0833, 0.0602, 0.1057, 0.0719, 0.1585, 0.2845, 0.0677,
        0.0503])
[rfa agg] iter:  1, prev_obj_val: 85.97633361816406, obj_val: 82.34906768798828, abs dis: 3.6272659301757812
[rfa agg] iter:  1, weight: tensor([0.0356, 0.0360, 0.0494, 0.0366, 0.1205, 0.0820, 0.1807, 0.3245, 0.0772,
        0.0574])
[rfa agg] iter:  2, prev_obj_val: 82.34906768798828, obj_val: 80.30325317382812, abs dis: 2.0458145141601562
[rfa agg] iter:  2, weight: tensor([0.0218, 0.0220, 0.0293, 0.0223, 0.1294, 0.0881, 0.1939, 0.3485, 0.0829,
        0.0617])
[rfa agg] iter:  3, prev_obj_val: 80.30325317382812, obj_val: 79.11314392089844, abs dis: 1.1901092529296875
[rfa agg] iter:  3, weight: tensor([0.0133, 0.0135, 0.0175, 0.0136, 0.1349, 0.0919, 0.2016, 0.3630, 0.0863,
        0.0644])
[rfa agg] iter:  4, prev_obj_val: 79.11314392089844, obj_val: 78.4173812866211, abs dis: 0.6957626342773438
[rfa agg] iter:  4, weight: tensor([0.0082, 0.0082, 0.0106, 0.0083, 0.1382, 0.0944, 0.2059, 0.3717, 0.0884,
        0.0661])
[rfa agg] iter:  5, prev_obj_val: 78.4173812866211, obj_val: 78.01892852783203, abs dis: 0.3984527587890625
[rfa agg] iter:  5, weight: tensor([0.0050, 0.0051, 0.0065, 0.0051, 0.1404, 0.0961, 0.2077, 0.3769, 0.0898,
        0.0675])
[rfa agg] iter:  6, prev_obj_val: 78.01892852783203, obj_val: 77.80530548095703, abs dis: 0.213623046875
[rfa agg] iter:  6, weight: tensor([0.0032, 0.0032, 0.0041, 0.0032, 0.1421, 0.0979, 0.2072, 0.3795, 0.0909,
        0.0688])
[rfa agg] iter:  7, prev_obj_val: 77.80530548095703, obj_val: 77.70653533935547, abs dis: 0.0987701416015625
[rfa agg] iter:  7, weight: tensor([0.0021, 0.0021, 0.0027, 0.0021, 0.1440, 0.1001, 0.2045, 0.3799, 0.0920,
        0.0706])
[rfa agg] iter:  8, prev_obj_val: 77.70653533935547, obj_val: 77.67112731933594, abs dis: 0.03540802001953125
[rfa agg] iter:  8, weight: tensor([0.0015, 0.0015, 0.0020, 0.0015, 0.1463, 0.1029, 0.2001, 0.3778, 0.0934,
        0.0729])
[rfa agg] iter:  9, prev_obj_val: 77.67112731933594, obj_val: 77.6618881225586, abs dis: 0.00923919677734375
[rfa agg] iter:  9, weight: tensor([0.0012, 0.0013, 0.0016, 0.0013, 0.1488, 0.1059, 0.1957, 0.3741, 0.0949,
        0.0752])
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.0951, Accuracy: 9714/10000 (97.1400%)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 2.2992, Accuracy: 2640/8968 (29.4380%)
Done in 154.1551389694214 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:26 choose agents : [41, 73, 51, 74, 11, 13, 82, 50, 34, 14]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   1,  Average loss: 0.0036, Accuracy: 569/606 (93.8944%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   2,  Average loss: 0.0018, Accuracy: 587/606 (96.8647%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   3,  Average loss: 0.0016, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   4,  Average loss: 0.0010, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   5,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   6,  Average loss: 0.0010, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   7,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   8,  Average loss: 0.0005, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   9,  Average loss: 0.0005, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch  10,  Average loss: 0.0005, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Global model norm: 16.53278676842105.
Norm before scaling: 16.681114546682164. Distance: 1.7439022093487595
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2830, Accuracy: 9069/10000 (90.6900%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0195, Accuracy: 8898/8968 (99.2194%)
Scaling by  100
Scaled Norm after poisoning: 175.7094658982549, distance: 174.39021551000218
Total norm for 4 adversaries is: 175.7094658982549. distance: 174.39021551000218
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   1,  Average loss: 0.0043, Accuracy: 541/591 (91.5398%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   2,  Average loss: 0.0019, Accuracy: 574/591 (97.1235%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   3,  Average loss: 0.0009, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   4,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   5,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   6,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   7,  Average loss: 0.0005, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   9,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Global model norm: 16.53278676842105.
Norm before scaling: 16.78790185465833. Distance: 2.215667517594404
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3166, Accuracy: 9060/10000 (90.6000%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0083, Accuracy: 8940/8968 (99.6878%)
Scaling by  100
Scaled Norm after poisoning: 222.9894633861654, distance: 221.566757716495
Total norm for 4 adversaries is: 222.9894633861654. distance: 221.566757716495
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   1,  Average loss: 0.0031, Accuracy: 531/568 (93.4859%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   2,  Average loss: 0.0012, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   3,  Average loss: 0.0009, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   4,  Average loss: 0.0009, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   5,  Average loss: 0.0007, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   6,  Average loss: 0.0007, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   7,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   8,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   9,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch  10,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Global model norm: 16.53278676842105.
Norm before scaling: 16.679908883191253. Distance: 1.5835639216846535
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3200, Accuracy: 8915/10000 (89.1500%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0411, Accuracy: 8836/8968 (98.5281%)
Scaling by  100
Scaled Norm after poisoning: 159.96231856088795, distance: 158.3563956614162
Total norm for 4 adversaries is: 159.96231856088795. distance: 158.3563956614162
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   1,  Average loss: 0.0043, Accuracy: 512/557 (91.9210%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   2,  Average loss: 0.0020, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   3,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   4,  Average loss: 0.0010, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   5,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   6,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   7,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   9,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch  10,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Global model norm: 16.53278676842105.
Norm before scaling: 16.68564461098175. Distance: 1.6542067970513508
will scale.
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2200, Accuracy: 9308/10000 (93.0800%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0067, Accuracy: 8945/8968 (99.7435%)
Scaling by  100
Scaled Norm after poisoning: 166.94749712671646, distance: 165.42067585401773
Total norm for 4 adversaries is: 166.94749712671646. distance: 165.42067585401773
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  26, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 622/645 (96.4341%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1718, Accuracy: 9456/10000 (94.5600%)
___Train Local_Simple,  epoch  26, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 723/734 (98.5014%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2117, Accuracy: 9350/10000 (93.5000%)
___Train Local_Simple,  epoch  26, local model 82, internal_epoch   1,  Average loss: 0.0015, Accuracy: 694/713 (97.3352%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.5402, Accuracy: 8270/10000 (82.7000%)
___Train Local_Simple,  epoch  26, local model 50, internal_epoch   1,  Average loss: 0.0021, Accuracy: 457/474 (96.4135%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2310, Accuracy: 9267/10000 (92.6700%)
___Train Local_Simple,  epoch  26, local model 34, internal_epoch   1,  Average loss: 0.0009, Accuracy: 407/413 (98.5472%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1877, Accuracy: 9396/10000 (93.9600%)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0016, Accuracy: 369/376 (98.1383%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1046, Accuracy: 9684/10000 (96.8400%)
time spent on training: 127.46713852882385
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4090188479830897  data num: [606, 591, 568, 557, 645, 734, 713, 474, 413, 376]
[rfa agg] considering poison per batch poison_fraction: 0.12781838999471554
[rfa agg] init. name: [41, 73, 51, 74, 11, 13, 82, 50, 34, 14], weight: tensor([0.1067, 0.1041, 0.1001, 0.0981, 0.1136, 0.1293, 0.1256, 0.0835, 0.0727,
        0.0662])
[rfa agg] iter:  0, prev_obj_val: 91.43427276611328, obj_val: 82.8226318359375, abs dis: 8.611640930175781
[rfa agg] iter:  0, weight: tensor([0.0594, 0.0445, 0.0649, 0.0589, 0.1484, 0.1690, 0.1640, 0.1092, 0.0951,
        0.0866])
[rfa agg] iter:  1, prev_obj_val: 82.8226318359375, obj_val: 78.62369537353516, abs dis: 4.198936462402344
[rfa agg] iter:  1, weight: tensor([0.0330, 0.0247, 0.0352, 0.0324, 0.1681, 0.1915, 0.1856, 0.1237, 0.1078,
        0.0981])
[rfa agg] iter:  2, prev_obj_val: 78.62369537353516, obj_val: 76.40907287597656, abs dis: 2.2146224975585938
[rfa agg] iter:  2, weight: tensor([0.0182, 0.0137, 0.0191, 0.0177, 0.1789, 0.2040, 0.1973, 0.1318, 0.1149,
        0.1045])
[rfa agg] iter:  3, prev_obj_val: 76.40907287597656, obj_val: 75.22522735595703, abs dis: 1.1838455200195312
[rfa agg] iter:  3, weight: tensor([0.0100, 0.0076, 0.0104, 0.0097, 0.1847, 0.2110, 0.2033, 0.1363, 0.1190,
        0.1081])
[rfa agg] iter:  4, prev_obj_val: 75.22522735595703, obj_val: 74.59931182861328, abs dis: 0.62591552734375
[rfa agg] iter:  4, weight: tensor([0.0055, 0.0042, 0.0057, 0.0053, 0.1876, 0.2151, 0.2055, 0.1392, 0.1216,
        0.1103])
[rfa agg] iter:  5, prev_obj_val: 74.59931182861328, obj_val: 74.28497314453125, abs dis: 0.31433868408203125
[rfa agg] iter:  5, weight: tensor([0.0031, 0.0023, 0.0032, 0.0030, 0.1887, 0.2179, 0.2043, 0.1415, 0.1239,
        0.1121])
[rfa agg] iter:  6, prev_obj_val: 74.28497314453125, obj_val: 74.1484375, abs dis: 0.13653564453125
[rfa agg] iter:  6, weight: tensor([0.0018, 0.0014, 0.0019, 0.0017, 0.1881, 0.2204, 0.1987, 0.1446, 0.1269,
        0.1145])
[rfa agg] iter:  7, prev_obj_val: 74.1484375, obj_val: 74.10454559326172, abs dis: 0.04389190673828125
[rfa agg] iter:  7, weight: tensor([0.0012, 0.0009, 0.0012, 0.0011, 0.1857, 0.2229, 0.1884, 0.1491, 0.1311,
        0.1183])
[rfa agg] iter:  8, prev_obj_val: 74.10454559326172, obj_val: 74.09525299072266, abs dis: 0.0092926025390625
[rfa agg] iter:  8, weight: tensor([0.0009, 0.0007, 0.0009, 0.0009, 0.1825, 0.2251, 0.1773, 0.1534, 0.1356,
        0.1227])
[rfa agg] iter:  9, prev_obj_val: 74.09525299072266, obj_val: 74.09391021728516, abs dis: 0.0013427734375
[rfa agg] iter:  9, weight: tensor([0.0008, 0.0006, 0.0008, 0.0008, 0.1800, 0.2266, 0.1702, 0.1557, 0.1388,
        0.1257])
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 0.0928, Accuracy: 9712/10000 (97.1200%)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 2.2321, Accuracy: 2849/8968 (31.7685%)
Done in 156.50397372245789 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:27 choose agents : [41, 73, 51, 74, 55, 58, 53, 14, 36, 6]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   1,  Average loss: 0.0048, Accuracy: 553/606 (91.2541%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   2,  Average loss: 0.0017, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   3,  Average loss: 0.0010, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   4,  Average loss: 0.0007, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   5,  Average loss: 0.0007, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   6,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   7,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   8,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   9,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch  10,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Global model norm: 16.535739916316963.
Norm before scaling: 16.766097347435146. Distance: 2.160005367590275
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2847, Accuracy: 9083/10000 (90.8300%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0170, Accuracy: 8909/8968 (99.3421%)
Scaling by  100
Scaled Norm after poisoning: 217.32515421885705, distance: 216.0005244495948
Total norm for 4 adversaries is: 217.32515421885705. distance: 216.0005244495948
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   1,  Average loss: 0.0040, Accuracy: 543/591 (91.8782%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   2,  Average loss: 0.0016, Accuracy: 575/591 (97.2927%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   3,  Average loss: 0.0009, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   4,  Average loss: 0.0006, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   5,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   6,  Average loss: 0.0005, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   7,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   9,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Global model norm: 16.535739916316963.
Norm before scaling: 16.762680491955653. Distance: 2.095491283051827
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3050, Accuracy: 9037/10000 (90.3700%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0150, Accuracy: 8913/8968 (99.3867%)
Scaling by  100
Scaled Norm after poisoning: 210.95220319126796, distance: 209.54912535608446
Total norm for 4 adversaries is: 210.95220319126796. distance: 209.54912535608446
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   1,  Average loss: 0.0026, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   2,  Average loss: 0.0011, Accuracy: 554/568 (97.5352%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   3,  Average loss: 0.0008, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   4,  Average loss: 0.0006, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   5,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   6,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   7,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   8,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch  10,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Global model norm: 16.535739916316963.
Norm before scaling: 16.657138593206255. Distance: 1.3637948366761383
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2950, Accuracy: 9045/10000 (90.4500%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0172, Accuracy: 8910/8968 (99.3533%)
Scaling by  100
Scaled Norm after poisoning: 138.16569677609925, distance: 136.37948262568676
Total norm for 4 adversaries is: 138.16569677609925. distance: 136.37948262568676
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   1,  Average loss: 0.0047, Accuracy: 497/557 (89.2280%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   2,  Average loss: 0.0021, Accuracy: 536/557 (96.2298%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   3,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   4,  Average loss: 0.0009, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   5,  Average loss: 0.0008, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   6,  Average loss: 0.0005, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   7,  Average loss: 0.0006, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   9,  Average loss: 0.0004, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch  10,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Global model norm: 16.535739916316963.
Norm before scaling: 16.7482298869374. Distance: 1.926153986454591
will scale.
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1876, Accuracy: 9432/10000 (94.3200%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0034, Accuracy: 8955/8968 (99.8550%)
Scaling by  100
Scaled Norm after poisoning: 194.1915633627012, distance: 192.61538749539196
Total norm for 4 adversaries is: 194.1915633627012. distance: 192.61538749539196
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  27, local model 55, internal_epoch   1,  Average loss: 0.0018, Accuracy: 347/354 (98.0226%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2005, Accuracy: 9347/10000 (93.4700%)
___Train Local_Simple,  epoch  27, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 267/276 (96.7391%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1510, Accuracy: 9532/10000 (95.3200%)
___Train Local_Simple,  epoch  27, local model 53, internal_epoch   1,  Average loss: 0.0011, Accuracy: 724/739 (97.9702%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2760, Accuracy: 9136/10000 (91.3600%)
___Train Local_Simple,  epoch  27, local model 14, internal_epoch   1,  Average loss: 0.0014, Accuracy: 369/376 (98.1383%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1289, Accuracy: 9604/10000 (96.0400%)
___Train Local_Simple,  epoch  27, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 977/1005 (97.2139%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3109, Accuracy: 9049/10000 (90.4900%)
___Train Local_Simple,  epoch  27, local model 6, internal_epoch   1,  Average loss: 0.0013, Accuracy: 600/615 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2051, Accuracy: 9370/10000 (93.7000%)
time spent on training: 133.51584553718567
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.40829963073676806  data num: [606, 591, 568, 557, 354, 276, 739, 376, 1005, 615]
[rfa agg] considering poison per batch poison_fraction: 0.12759363460524
[rfa agg] init. name: [41, 73, 51, 74, 55, 58, 53, 14, 36, 6], weight: tensor([0.1066, 0.1039, 0.0999, 0.0979, 0.0622, 0.0485, 0.1299, 0.0661, 0.1767,
        0.1081])
[rfa agg] iter:  0, prev_obj_val: 95.95515441894531, obj_val: 86.5857162475586, abs dis: 9.369438171386719
[rfa agg] iter:  0, weight: tensor([0.0480, 0.0485, 0.0792, 0.0506, 0.0815, 0.0635, 0.1700, 0.0864, 0.2310,
        0.1413])
[rfa agg] iter:  1, prev_obj_val: 86.5857162475586, obj_val: 82.17884826660156, abs dis: 4.406867980957031
[rfa agg] iter:  1, weight: tensor([0.0261, 0.0263, 0.0423, 0.0274, 0.0925, 0.0720, 0.1931, 0.0981, 0.2621,
        0.1602])
[rfa agg] iter:  2, prev_obj_val: 82.17884826660156, obj_val: 79.89959716796875, abs dis: 2.2792510986328125
[rfa agg] iter:  2, weight: tensor([0.0143, 0.0144, 0.0221, 0.0148, 0.0986, 0.0766, 0.2058, 0.1044, 0.2787,
        0.1704])
[rfa agg] iter:  3, prev_obj_val: 79.89959716796875, obj_val: 78.70635223388672, abs dis: 1.1932449340820312
[rfa agg] iter:  3, weight: tensor([0.0077, 0.0078, 0.0117, 0.0080, 0.1021, 0.0791, 0.2129, 0.1078, 0.2874,
        0.1755])
[rfa agg] iter:  4, prev_obj_val: 78.70635223388672, obj_val: 78.09217834472656, abs dis: 0.6141738891601562
[rfa agg] iter:  4, weight: tensor([0.0042, 0.0042, 0.0063, 0.0043, 0.1044, 0.0804, 0.2175, 0.1098, 0.2910,
        0.1778])
[rfa agg] iter:  5, prev_obj_val: 78.09217834472656, obj_val: 77.79782104492188, abs dis: 0.2943572998046875
[rfa agg] iter:  5, weight: tensor([0.0023, 0.0023, 0.0035, 0.0024, 0.1066, 0.0812, 0.2214, 0.1119, 0.2904,
        0.1779])
[rfa agg] iter:  6, prev_obj_val: 77.79782104492188, obj_val: 77.6813735961914, abs dis: 0.11644744873046875
[rfa agg] iter:  6, weight: tensor([0.0014, 0.0014, 0.0021, 0.0014, 0.1095, 0.0821, 0.2260, 0.1158, 0.2839,
        0.1765])
[rfa agg] iter:  7, prev_obj_val: 77.6813735961914, obj_val: 77.64920806884766, abs dis: 0.03216552734375
[rfa agg] iter:  7, weight: tensor([0.0009, 0.0009, 0.0014, 0.0010, 0.1132, 0.0834, 0.2308, 0.1233, 0.2709,
        0.1741])
[rfa agg] iter:  8, prev_obj_val: 77.64920806884766, obj_val: 77.64335632324219, abs dis: 0.00585174560546875
[rfa agg] iter:  8, weight: tensor([0.0008, 0.0008, 0.0011, 0.0008, 0.1162, 0.0847, 0.2343, 0.1321, 0.2568,
        0.1725])
[rfa agg] iter:  9, prev_obj_val: 77.64335632324219, obj_val: 77.64253997802734, abs dis: 0.00081634521484375
[rfa agg] iter:  9, weight: tensor([0.0007, 0.0007, 0.0010, 0.0007, 0.1180, 0.0856, 0.2361, 0.1381, 0.2471,
        0.1720])
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 0.0925, Accuracy: 9720/10000 (97.2000%)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 2.0893, Accuracy: 3210/8968 (35.7939%)
Done in 158.71012711524963 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:28 choose agents : [41, 73, 51, 74, 47, 92, 37, 43, 17, 2]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   1,  Average loss: 0.0037, Accuracy: 566/606 (93.3993%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   2,  Average loss: 0.0022, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   3,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   4,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   5,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   6,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   7,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   8,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch  10,  Average loss: 0.0004, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 16.539060654818037.
Norm before scaling: 16.70678967632808. Distance: 1.8846968722280402
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3422, Accuracy: 8864/10000 (88.6400%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0159, Accuracy: 8909/8968 (99.3421%)
Scaling by  100
Scaled Norm after poisoning: 189.72819785814653, distance: 188.4696904511439
Total norm for 4 adversaries is: 189.72819785814653. distance: 188.4696904511439
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 549/591 (92.8934%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   2,  Average loss: 0.0015, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   3,  Average loss: 0.0011, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   4,  Average loss: 0.0009, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   5,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   6,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   7,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   9,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Global model norm: 16.539060654818037.
Norm before scaling: 16.772268495302466. Distance: 2.0813496746217575
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2920, Accuracy: 9087/10000 (90.8700%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0160, Accuracy: 8909/8968 (99.3421%)
Scaling by  100
Scaled Norm after poisoning: 209.61236545108687, distance: 208.1349659776079
Total norm for 4 adversaries is: 209.61236545108687. distance: 208.1349659776079
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0028, Accuracy: 535/568 (94.1901%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   2,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   3,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   4,  Average loss: 0.0005, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   5,  Average loss: 0.0004, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   6,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   7,  Average loss: 0.0003, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch  10,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 16.539060654818037.
Norm before scaling: 16.67987320593342. Distance: 1.507039796163276
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2854, Accuracy: 9051/10000 (90.5100%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0185, Accuracy: 8907/8968 (99.3198%)
Scaling by  100
Scaled Norm after poisoning: 152.4004093354903, distance: 150.7039795530463
Total norm for 4 adversaries is: 152.4004093354903. distance: 150.7039795530463
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   1,  Average loss: 0.0039, Accuracy: 515/557 (92.4596%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   2,  Average loss: 0.0022, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   3,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   4,  Average loss: 0.0007, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   5,  Average loss: 0.0006, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   6,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   7,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   9,  Average loss: 0.0004, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch  10,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Global model norm: 16.539060654818037.
Norm before scaling: 16.663352840315763. Distance: 1.4964167393172065
will scale.
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1926, Accuracy: 9411/10000 (94.1100%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0065, Accuracy: 8942/8968 (99.7101%)
Scaling by  100
Scaled Norm after poisoning: 151.17846319623374, distance: 149.6416618229195
Total norm for 4 adversaries is: 151.17846319623374. distance: 149.6416618229195
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  28, local model 47, internal_epoch   1,  Average loss: 0.0014, Accuracy: 757/776 (97.5515%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2271, Accuracy: 9243/10000 (92.4300%)
___Train Local_Simple,  epoch  28, local model 92, internal_epoch   1,  Average loss: 0.0012, Accuracy: 916/937 (97.7588%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.7040, Accuracy: 7967/10000 (79.6700%)
___Train Local_Simple,  epoch  28, local model 37, internal_epoch   1,  Average loss: 0.0010, Accuracy: 843/860 (98.0233%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3035, Accuracy: 9107/10000 (91.0700%)
___Train Local_Simple,  epoch  28, local model 43, internal_epoch   1,  Average loss: 0.0012, Accuracy: 401/408 (98.2843%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2569, Accuracy: 9116/10000 (91.1600%)
___Train Local_Simple,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 600/620 (96.7742%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1379, Accuracy: 9580/10000 (95.8000%)
___Train Local_Simple,  epoch  28, local model 2, internal_epoch   1,  Average loss: 0.0013, Accuracy: 539/548 (98.3577%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1468, Accuracy: 9536/10000 (95.3600%)
time spent on training: 130.3911681175232
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3588317107093185  data num: [606, 591, 568, 557, 776, 937, 860, 408, 620, 548]
[rfa agg] considering poison per batch poison_fraction: 0.11213490959666203
[rfa agg] init. name: [41, 73, 51, 74, 47, 92, 37, 43, 17, 2], weight: tensor([0.0936, 0.0913, 0.0878, 0.0861, 0.1199, 0.1448, 0.1329, 0.0631, 0.0958,
        0.0847])
[rfa agg] iter:  0, prev_obj_val: 81.63373565673828, obj_val: 70.72528839111328, abs dis: 10.908447265625
[rfa agg] iter:  0, weight: tensor([0.0376, 0.0325, 0.0466, 0.0446, 0.1567, 0.1894, 0.1741, 0.0825, 0.1253,
        0.1107])
[rfa agg] iter:  1, prev_obj_val: 70.72528839111328, obj_val: 66.1988296508789, abs dis: 4.526458740234375
[rfa agg] iter:  1, weight: tensor([0.0164, 0.0143, 0.0199, 0.0195, 0.1735, 0.2098, 0.1933, 0.0915, 0.1389,
        0.1228])
[rfa agg] iter:  2, prev_obj_val: 66.1988296508789, obj_val: 64.2826156616211, abs dis: 1.9162139892578125
[rfa agg] iter:  2, weight: tensor([0.0071, 0.0063, 0.0085, 0.0083, 0.1805, 0.2184, 0.2024, 0.0957, 0.1448,
        0.1281])
[rfa agg] iter:  3, prev_obj_val: 64.2826156616211, obj_val: 63.515525817871094, abs dis: 0.76708984375
[rfa agg] iter:  3, weight: tensor([0.0031, 0.0027, 0.0037, 0.0036, 0.1824, 0.2210, 0.2073, 0.0982, 0.1474,
        0.1306])
[rfa agg] iter:  4, prev_obj_val: 63.515525817871094, obj_val: 63.2694206237793, abs dis: 0.24610519409179688
[rfa agg] iter:  4, weight: tensor([0.0014, 0.0013, 0.0017, 0.0017, 0.1812, 0.2180, 0.2101, 0.1020, 0.1494,
        0.1333])
[rfa agg] iter:  5, prev_obj_val: 63.2694206237793, obj_val: 63.224281311035156, abs dis: 0.045139312744140625
[rfa agg] iter:  5, weight: tensor([0.0008, 0.0007, 0.0010, 0.0010, 0.1785, 0.2086, 0.2080, 0.1102, 0.1526,
        0.1386])
[rfa agg] iter:  6, prev_obj_val: 63.224281311035156, obj_val: 63.22038650512695, abs dis: 0.003894805908203125
[rfa agg] iter:  6, weight: tensor([0.0007, 0.0006, 0.0008, 0.0008, 0.1770, 0.1997, 0.2027, 0.1182, 0.1557,
        0.1438])
[rfa agg] iter:  7, prev_obj_val: 63.22038650512695, obj_val: 63.22016906738281, abs dis: 0.000217437744140625
[rfa agg] iter:  7, weight: tensor([0.0006, 0.0006, 0.0008, 0.0007, 0.1769, 0.1954, 0.1996, 0.1218, 0.1574,
        0.1463])
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 0.0898, Accuracy: 9725/10000 (97.2500%)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 2.0396, Accuracy: 3329/8968 (37.1209%)
Done in 161.84799027442932 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:29 choose agents : [41, 73, 51, 74, 66, 6, 38, 37, 45, 81]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   1,  Average loss: 0.0034, Accuracy: 568/606 (93.7294%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   2,  Average loss: 0.0013, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   3,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   4,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   5,  Average loss: 0.0007, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   6,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   7,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   8,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   9,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch  10,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 16.54053027704079.
Norm before scaling: 16.6958206520702. Distance: 1.6734860937648002
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2992, Accuracy: 9026/10000 (90.2600%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0217, Accuracy: 8900/8968 (99.2417%)
Scaling by  100
Scaled Norm after poisoning: 168.86450397619092, distance: 167.3486139582578
Total norm for 4 adversaries is: 168.86450397619092. distance: 167.3486139582578
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 551/591 (93.2318%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   2,  Average loss: 0.0013, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   3,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   4,  Average loss: 0.0006, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   5,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   6,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   7,  Average loss: 0.0004, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   8,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Global model norm: 16.54053027704079.
Norm before scaling: 16.696003436802435. Distance: 1.7840908886589752
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3053, Accuracy: 9076/10000 (90.7600%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0150, Accuracy: 8912/8968 (99.3756%)
Scaling by  100
Scaled Norm after poisoning: 179.72712063187626, distance: 178.40908814960912
Total norm for 4 adversaries is: 179.72712063187626. distance: 178.40908814960912
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   1,  Average loss: 0.0023, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   2,  Average loss: 0.0008, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   3,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   4,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   5,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   6,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   7,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch  10,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Global model norm: 16.54053027704079.
Norm before scaling: 16.64638068007859. Distance: 1.3195500175446875
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3196, Accuracy: 8930/10000 (89.3000%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0150, Accuracy: 8912/8968 (99.3756%)
Scaling by  100
Scaled Norm after poisoning: 133.65206694997275, distance: 131.95499647133488
Total norm for 4 adversaries is: 133.65206694997275. distance: 131.95499647133488
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 513/557 (92.1005%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   2,  Average loss: 0.0022, Accuracy: 531/557 (95.3321%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   3,  Average loss: 0.0012, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   4,  Average loss: 0.0009, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   5,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   6,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   7,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   9,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch  10,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Global model norm: 16.54053027704079.
Norm before scaling: 16.665597092959008. Distance: 1.5182571364934951
will scale.
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2061, Accuracy: 9373/10000 (93.7300%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0041, Accuracy: 8951/8968 (99.8104%)
Scaling by  100
Scaled Norm after poisoning: 153.32784396310737, distance: 151.82571859907333
Total norm for 4 adversaries is: 153.32784396310737. distance: 151.82571859907333
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  29, local model 66, internal_epoch   1,  Average loss: 0.0013, Accuracy: 647/660 (98.0303%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1577, Accuracy: 9477/10000 (94.7700%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   1,  Average loss: 0.0012, Accuracy: 603/615 (98.0488%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3824, Accuracy: 8926/10000 (89.2600%)
___Train Local_Simple,  epoch  29, local model 38, internal_epoch   1,  Average loss: 0.0015, Accuracy: 862/895 (96.3128%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.6146, Accuracy: 8199/10000 (81.9900%)
___Train Local_Simple,  epoch  29, local model 37, internal_epoch   1,  Average loss: 0.0010, Accuracy: 847/860 (98.4884%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2070, Accuracy: 9389/10000 (93.8900%)
___Train Local_Simple,  epoch  29, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 616/628 (98.0892%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2480, Accuracy: 9167/10000 (91.6700%)
___Train Local_Simple,  epoch  29, local model 81, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1209/1227 (98.5330%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3409, Accuracy: 9097/10000 (90.9700%)
time spent on training: 139.491295337677
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3221867628694325  data num: [606, 591, 568, 557, 660, 615, 895, 860, 628, 1227]
[rfa agg] considering poison per batch poison_fraction: 0.10068336339669764
[rfa agg] init. name: [41, 73, 51, 74, 66, 6, 38, 37, 45, 81], weight: tensor([0.0841, 0.0820, 0.0788, 0.0773, 0.0916, 0.0853, 0.1242, 0.1193, 0.0871,
        0.1703])
[rfa agg] iter:  0, prev_obj_val: 68.5631332397461, obj_val: 57.690460205078125, abs dis: 10.872673034667969
[rfa agg] iter:  0, weight: tensor([0.0311, 0.0280, 0.0390, 0.0317, 0.1175, 0.1095, 0.1595, 0.1533, 0.1119,
        0.2185])
[rfa agg] iter:  1, prev_obj_val: 57.690460205078125, obj_val: 53.48615646362305, abs dis: 4.204303741455078
[rfa agg] iter:  1, weight: tensor([0.0120, 0.0109, 0.0146, 0.0122, 0.1282, 0.1194, 0.1741, 0.1677, 0.1223,
        0.2385])
[rfa agg] iter:  2, prev_obj_val: 53.48615646362305, obj_val: 51.941490173339844, abs dis: 1.5446662902832031
[rfa agg] iter:  2, weight: tensor([0.0046, 0.0042, 0.0055, 0.0047, 0.1323, 0.1230, 0.1793, 0.1740, 0.1268,
        0.2456])
[rfa agg] iter:  3, prev_obj_val: 51.941490173339844, obj_val: 51.47867202758789, abs dis: 0.4628181457519531
[rfa agg] iter:  3, weight: tensor([0.0018, 0.0017, 0.0022, 0.0019, 0.1346, 0.1242, 0.1777, 0.1791, 0.1312,
        0.2457])
[rfa agg] iter:  4, prev_obj_val: 51.47867202758789, obj_val: 51.40283203125, abs dis: 0.07583999633789062
[rfa agg] iter:  4, weight: tensor([0.0009, 0.0009, 0.0011, 0.0010, 0.1390, 0.1252, 0.1656, 0.1868, 0.1418,
        0.2378])
[rfa agg] iter:  5, prev_obj_val: 51.40283203125, obj_val: 51.397804260253906, abs dis: 0.00502777099609375
[rfa agg] iter:  5, weight: tensor([0.0007, 0.0007, 0.0009, 0.0007, 0.1436, 0.1266, 0.1533, 0.1924, 0.1529,
        0.2282])
[rfa agg] iter:  6, prev_obj_val: 51.397804260253906, obj_val: 51.39759826660156, abs dis: 0.00020599365234375
[rfa agg] iter:  6, weight: tensor([0.0007, 0.0006, 0.0008, 0.0007, 0.1456, 0.1276, 0.1485, 0.1947, 0.1574,
        0.2234])
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.0876, Accuracy: 9730/10000 (97.3000%)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 2.0067, Accuracy: 3540/8968 (39.4737%)
Done in 162.7220950126648 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:30 choose agents : [41, 73, 51, 74, 4, 24, 38, 54, 10, 11]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   1,  Average loss: 0.0038, Accuracy: 566/606 (93.3993%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   2,  Average loss: 0.0012, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   3,  Average loss: 0.0013, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   4,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   5,  Average loss: 0.0008, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   6,  Average loss: 0.0007, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   7,  Average loss: 0.0006, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   8,  Average loss: 0.0006, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   9,  Average loss: 0.0005, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch  10,  Average loss: 0.0005, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 16.542962754573885.
Norm before scaling: 16.668716202920837. Distance: 1.7040979248707593
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3130, Accuracy: 8960/10000 (89.6000%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0201, Accuracy: 8902/8968 (99.2640%)
Scaling by  100
Scaled Norm after poisoning: 171.5821140882697, distance: 170.4097887263229
Total norm for 4 adversaries is: 171.5821140882697. distance: 170.4097887263229
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   1,  Average loss: 0.0054, Accuracy: 524/591 (88.6633%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   2,  Average loss: 0.0016, Accuracy: 573/591 (96.9543%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   3,  Average loss: 0.0010, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   4,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   5,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   6,  Average loss: 0.0006, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   7,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   9,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.542962754573885.
Norm before scaling: 16.835946563222617. Distance: 2.430059079523452
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3403, Accuracy: 8950/10000 (89.5000%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0158, Accuracy: 8909/8968 (99.3421%)
Scaling by  100
Scaled Norm after poisoning: 244.3623717964777, distance: 243.00592360321178
Total norm for 4 adversaries is: 244.3623717964777. distance: 243.00592360321178
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   1,  Average loss: 0.0022, Accuracy: 541/568 (95.2465%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   2,  Average loss: 0.0014, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   3,  Average loss: 0.0009, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   4,  Average loss: 0.0006, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   5,  Average loss: 0.0005, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   6,  Average loss: 0.0005, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   7,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   8,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch  10,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Global model norm: 16.542962754573885.
Norm before scaling: 16.644333690302552. Distance: 1.3698480495360603
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2762, Accuracy: 9070/10000 (90.7000%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0206, Accuracy: 8903/8968 (99.2752%)
Scaling by  100
Scaled Norm after poisoning: 138.51817626669072, distance: 136.98480897758336
Total norm for 4 adversaries is: 138.51817626669072. distance: 136.98480897758336
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   1,  Average loss: 0.0056, Accuracy: 492/557 (88.3303%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   2,  Average loss: 0.0020, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   3,  Average loss: 0.0010, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   4,  Average loss: 0.0009, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   5,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   6,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   7,  Average loss: 0.0007, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch  10,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Global model norm: 16.542962754573885.
Norm before scaling: 16.720181013523746. Distance: 1.8500754263683288
will scale.
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2174, Accuracy: 9333/10000 (93.3300%)
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0086, Accuracy: 8939/8968 (99.6766%)
Scaling by  100
Scaled Norm after poisoning: 186.4099460027549, distance: 185.00754841019327
Total norm for 4 adversaries is: 186.4099460027549. distance: 185.00754841019327
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  30, local model 4, internal_epoch   1,  Average loss: 0.0014, Accuracy: 636/658 (96.6565%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2072, Accuracy: 9283/10000 (92.8300%)
___Train Local_Simple,  epoch  30, local model 24, internal_epoch   1,  Average loss: 0.0016, Accuracy: 363/379 (95.7784%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1145, Accuracy: 9658/10000 (96.5800%)
___Train Local_Simple,  epoch  30, local model 38, internal_epoch   1,  Average loss: 0.0018, Accuracy: 867/895 (96.8715%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2866, Accuracy: 8994/10000 (89.9400%)
___Train Local_Simple,  epoch  30, local model 54, internal_epoch   1,  Average loss: 0.0020, Accuracy: 504/519 (97.1098%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.4303, Accuracy: 8809/10000 (88.0900%)
___Train Local_Simple,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0013, Accuracy: 869/892 (97.4215%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1733, Accuracy: 9427/10000 (94.2700%)
___Train Local_Simple,  epoch  30, local model 11, internal_epoch   1,  Average loss: 0.0017, Accuracy: 628/645 (97.3643%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1586, Accuracy: 9500/10000 (95.0000%)
time spent on training: 133.37677383422852
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.36798732171156895  data num: [606, 591, 568, 557, 658, 379, 895, 519, 892, 645]
[rfa agg] considering poison per batch poison_fraction: 0.1149960380348653
[rfa agg] init. name: [41, 73, 51, 74, 4, 24, 38, 54, 10, 11], weight: tensor([0.0960, 0.0937, 0.0900, 0.0883, 0.1043, 0.0601, 0.1418, 0.0823, 0.1414,
        0.1022])
[rfa agg] iter:  0, prev_obj_val: 87.31704711914062, obj_val: 76.09156036376953, abs dis: 11.225486755371094
[rfa agg] iter:  0, weight: tensor([0.0460, 0.0297, 0.0576, 0.0382, 0.1366, 0.0787, 0.1861, 0.1077, 0.1854,
        0.1339])
[rfa agg] iter:  1, prev_obj_val: 76.09156036376953, obj_val: 71.44834899902344, abs dis: 4.643211364746094
[rfa agg] iter:  1, weight: tensor([0.0206, 0.0135, 0.0250, 0.0172, 0.1523, 0.0878, 0.2076, 0.1200, 0.2067,
        0.1492])
[rfa agg] iter:  2, prev_obj_val: 71.44834899902344, obj_val: 69.43614959716797, abs dis: 2.0121994018554688
[rfa agg] iter:  2, weight: tensor([0.0091, 0.0061, 0.0108, 0.0077, 0.1591, 0.0920, 0.2175, 0.1252, 0.2164,
        0.1559])
[rfa agg] iter:  3, prev_obj_val: 69.43614959716797, obj_val: 68.60450744628906, abs dis: 0.8316421508789062
[rfa agg] iter:  3, weight: tensor([0.0040, 0.0027, 0.0048, 0.0034, 0.1621, 0.0945, 0.2219, 0.1266, 0.2212,
        0.1588])
[rfa agg] iter:  4, prev_obj_val: 68.60450744628906, obj_val: 68.32035064697266, abs dis: 0.28415679931640625
[rfa agg] iter:  4, weight: tensor([0.0019, 0.0013, 0.0022, 0.0016, 0.1642, 0.0980, 0.2211, 0.1246, 0.2245,
        0.1604])
[rfa agg] iter:  5, prev_obj_val: 68.32035064697266, obj_val: 68.26087951660156, abs dis: 0.05947113037109375
[rfa agg] iter:  5, weight: tensor([0.0011, 0.0008, 0.0013, 0.0009, 0.1682, 0.1065, 0.2113, 0.1188, 0.2279,
        0.1632])
[rfa agg] iter:  6, prev_obj_val: 68.26087951660156, obj_val: 68.25459289550781, abs dis: 0.00628662109375
[rfa agg] iter:  6, weight: tensor([0.0009, 0.0006, 0.0010, 0.0007, 0.1728, 0.1165, 0.1982, 0.1134, 0.2298,
        0.1661])
[rfa agg] iter:  7, prev_obj_val: 68.25459289550781, obj_val: 68.25415802001953, abs dis: 0.00043487548828125
[rfa agg] iter:  7, weight: tensor([0.0008, 0.0005, 0.0009, 0.0007, 0.1756, 0.1216, 0.1906, 0.1111, 0.2305,
        0.1676])
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 0.0874, Accuracy: 9736/10000 (97.3600%)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 1.9748, Accuracy: 3635/8968 (40.5330%)
Done in 156.27735304832458 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:31 choose agents : [41, 73, 51, 74, 80, 7, 72, 14, 99, 12]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   1,  Average loss: 0.0027, Accuracy: 572/606 (94.3894%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   2,  Average loss: 0.0010, Accuracy: 592/606 (97.6898%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   3,  Average loss: 0.0009, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   4,  Average loss: 0.0007, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   5,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   6,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   7,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   8,  Average loss: 0.0004, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   9,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch  10,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 16.544316743338367.
Norm before scaling: 16.73270810442268. Distance: 1.7863262858027857
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2288, Accuracy: 9226/10000 (92.2600%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0092, Accuracy: 8938/8968 (99.6655%)
Scaling by  100
Scaled Norm after poisoning: 180.25299603092594, distance: 178.63263738921003
Total norm for 4 adversaries is: 180.25299603092594. distance: 178.63263738921003
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 558/591 (94.4162%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   2,  Average loss: 0.0012, Accuracy: 576/591 (97.4619%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   3,  Average loss: 0.0006, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   4,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   5,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   6,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   7,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   8,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 16.544316743338367.
Norm before scaling: 16.696543553993163. Distance: 1.6303331451249519
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2370, Accuracy: 9259/10000 (92.5900%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0435, Accuracy: 8852/8968 (98.7065%)
Scaling by  100
Scaled Norm after poisoning: 164.60191680422497, distance: 163.03331355316618
Total norm for 4 adversaries is: 164.60191680422497. distance: 163.03331355316618
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   1,  Average loss: 0.0020, Accuracy: 544/568 (95.7746%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   2,  Average loss: 0.0009, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   3,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   4,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   5,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   6,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   7,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   9,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch  10,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Global model norm: 16.544316743338367.
Norm before scaling: 16.612091330387653. Distance: 1.1180975348658742
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2604, Accuracy: 9118/10000 (91.1800%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0197, Accuracy: 8898/8968 (99.2194%)
Scaling by  100
Scaled Norm after poisoning: 113.4673385343223, distance: 111.8097531454099
Total norm for 4 adversaries is: 113.4673385343223. distance: 111.8097531454099
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0035, Accuracy: 522/557 (93.7163%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   2,  Average loss: 0.0014, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   3,  Average loss: 0.0007, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   4,  Average loss: 0.0007, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   5,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   6,  Average loss: 0.0005, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   7,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   9,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch  10,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Global model norm: 16.544316743338367.
Norm before scaling: 16.649329259610486. Distance: 1.3924702178537098
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1765, Accuracy: 9469/10000 (94.6900%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0027, Accuracy: 8959/8968 (99.8996%)
Scaling by  100
Scaled Norm after poisoning: 140.7768555085494, distance: 139.24702644940035
Total norm for 4 adversaries is: 140.7768555085494. distance: 139.24702644940035
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  31, local model 80, internal_epoch   1,  Average loss: 0.0009, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2109, Accuracy: 9348/10000 (93.4800%)
___Train Local_Simple,  epoch  31, local model 7, internal_epoch   1,  Average loss: 0.0012, Accuracy: 411/418 (98.3254%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1543, Accuracy: 9491/10000 (94.9100%)
___Train Local_Simple,  epoch  31, local model 72, internal_epoch   1,  Average loss: 0.0007, Accuracy: 725/731 (99.1792%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1833, Accuracy: 9399/10000 (93.9900%)
___Train Local_Simple,  epoch  31, local model 14, internal_epoch   1,  Average loss: 0.0015, Accuracy: 368/376 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1866, Accuracy: 9422/10000 (94.2200%)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: 0.0009, Accuracy: 373/377 (98.9390%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1053, Accuracy: 9690/10000 (96.9000%)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1131/1160 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2469, Accuracy: 9196/10000 (91.9600%)
time spent on training: 126.86497664451599
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3993121238177128  data num: [606, 591, 568, 557, 431, 418, 731, 376, 377, 1160]
[rfa agg] considering poison per batch poison_fraction: 0.12478503869303526
[rfa agg] init. name: [41, 73, 51, 74, 80, 7, 72, 14, 99, 12], weight: tensor([0.1042, 0.1016, 0.0977, 0.0958, 0.0741, 0.0719, 0.1257, 0.0647, 0.0648,
        0.1995])
[rfa agg] iter:  0, prev_obj_val: 74.41845703125, obj_val: 67.18214416503906, abs dis: 7.2363128662109375
[rfa agg] iter:  0, weight: tensor([0.0462, 0.0488, 0.0766, 0.0560, 0.0953, 0.0924, 0.1617, 0.0832, 0.0834,
        0.2564])
[rfa agg] iter:  1, prev_obj_val: 67.18214416503906, obj_val: 63.602210998535156, abs dis: 3.5799331665039062
[rfa agg] iter:  1, weight: tensor([0.0254, 0.0271, 0.0413, 0.0308, 0.1080, 0.1047, 0.1832, 0.0943, 0.0946,
        0.2905])
[rfa agg] iter:  2, prev_obj_val: 63.602210998535156, obj_val: 61.70469665527344, abs dis: 1.8975143432617188
[rfa agg] iter:  2, weight: tensor([0.0140, 0.0150, 0.0219, 0.0168, 0.1150, 0.1115, 0.1951, 0.1004, 0.1009,
        0.3092])
[rfa agg] iter:  3, prev_obj_val: 61.70469665527344, obj_val: 60.699256896972656, abs dis: 1.0054397583007812
[rfa agg] iter:  3, weight: tensor([0.0077, 0.0082, 0.0118, 0.0091, 0.1189, 0.1153, 0.2017, 0.1038, 0.1046,
        0.3189])
[rfa agg] iter:  4, prev_obj_val: 60.699256896972656, obj_val: 60.18271255493164, abs dis: 0.5165443420410156
[rfa agg] iter:  4, weight: tensor([0.0042, 0.0045, 0.0064, 0.0050, 0.1212, 0.1176, 0.2053, 0.1058, 0.1072,
        0.3228])
[rfa agg] iter:  5, prev_obj_val: 60.18271255493164, obj_val: 59.94190216064453, abs dis: 0.24081039428710938
[rfa agg] iter:  5, weight: tensor([0.0024, 0.0025, 0.0036, 0.0028, 0.1232, 0.1197, 0.2075, 0.1070, 0.1101,
        0.3212])
[rfa agg] iter:  6, prev_obj_val: 59.94190216064453, obj_val: 59.85291290283203, abs dis: 0.0889892578125
[rfa agg] iter:  6, weight: tensor([0.0015, 0.0016, 0.0022, 0.0017, 0.1258, 0.1231, 0.2089, 0.1079, 0.1150,
        0.3123])
[rfa agg] iter:  7, prev_obj_val: 59.85291290283203, obj_val: 59.83039474487305, abs dis: 0.022518157958984375
[rfa agg] iter:  7, weight: tensor([0.0010, 0.0011, 0.0016, 0.0012, 0.1296, 0.1284, 0.2100, 0.1085, 0.1223,
        0.2963])
[rfa agg] iter:  8, prev_obj_val: 59.83039474487305, obj_val: 59.82640075683594, abs dis: 0.003993988037109375
[rfa agg] iter:  8, weight: tensor([0.0009, 0.0009, 0.0013, 0.0010, 0.1332, 0.1334, 0.2111, 0.1090, 0.1291,
        0.2799])
[rfa agg] iter:  9, prev_obj_val: 59.82640075683594, obj_val: 59.825767517089844, abs dis: 0.00063323974609375
[rfa agg] iter:  9, weight: tensor([0.0008, 0.0009, 0.0012, 0.0010, 0.1357, 0.1367, 0.2122, 0.1094, 0.1336,
        0.2685])
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.0858, Accuracy: 9734/10000 (97.3400%)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 1.7609, Accuracy: 4185/8968 (46.6659%)
Done in 155.8826940059662 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:32 choose agents : [41, 73, 51, 74, 93, 25, 34, 57, 69, 58]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   1,  Average loss: 0.0029, Accuracy: 572/606 (94.3894%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   2,  Average loss: 0.0014, Accuracy: 590/606 (97.3597%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   3,  Average loss: 0.0010, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   4,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   5,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   6,  Average loss: 0.0006, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   7,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   8,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   9,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch  10,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Global model norm: 16.54680122740873.
Norm before scaling: 16.71734715931095. Distance: 1.7188063178805897
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2671, Accuracy: 9103/10000 (91.0300%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0345, Accuracy: 8873/8968 (98.9407%)
Scaling by  100
Scaled Norm after poisoning: 173.4607416859792, distance: 171.88063627122168
Total norm for 4 adversaries is: 173.4607416859792. distance: 171.88063627122168
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 530/591 (89.6785%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   2,  Average loss: 0.0017, Accuracy: 578/591 (97.8003%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   3,  Average loss: 0.0009, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   4,  Average loss: 0.0009, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   5,  Average loss: 0.0008, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   6,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   7,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   8,  Average loss: 0.0005, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   9,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Global model norm: 16.54680122740873.
Norm before scaling: 16.838449638564377. Distance: 2.447082171676657
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3581, Accuracy: 8872/10000 (88.7200%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0004, Accuracy: 8966/8968 (99.9777%)
Scaling by  100
Scaled Norm after poisoning: 246.03000960248733, distance: 244.70822070631382
Total norm for 4 adversaries is: 246.03000960248733. distance: 244.70822070631382
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   1,  Average loss: 0.0018, Accuracy: 553/568 (97.3592%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   2,  Average loss: 0.0013, Accuracy: 552/568 (97.1831%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   3,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   4,  Average loss: 0.0003, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   5,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   6,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   7,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch  10,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Global model norm: 16.54680122740873.
Norm before scaling: 16.60317823019888. Distance: 1.1319499447980823
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2503, Accuracy: 9164/10000 (91.6400%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0200, Accuracy: 8905/8968 (99.2975%)
Scaling by  100
Scaled Norm after poisoning: 114.65453800847789, distance: 113.1949930222733
Total norm for 4 adversaries is: 114.65453800847789. distance: 113.1949930222733
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   1,  Average loss: 0.0031, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   2,  Average loss: 0.0015, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   3,  Average loss: 0.0013, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   4,  Average loss: 0.0010, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   5,  Average loss: 0.0005, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   6,  Average loss: 0.0006, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   7,  Average loss: 0.0004, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   9,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch  10,  Average loss: 0.0005, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Global model norm: 16.54680122740873.
Norm before scaling: 16.65413550720023. Distance: 1.4496508671284138
will scale.
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1807, Accuracy: 9455/10000 (94.5500%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0167, Accuracy: 8920/8968 (99.4648%)
Scaling by  100
Scaled Norm after poisoning: 146.40656016509303, distance: 144.96508200252916
Total norm for 4 adversaries is: 146.40656016509303. distance: 144.96508200252916
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: 0.0006, Accuracy: 616/623 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2523, Accuracy: 9162/10000 (91.6200%)
___Train Local_Simple,  epoch  32, local model 25, internal_epoch   1,  Average loss: 0.0013, Accuracy: 632/647 (97.6816%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3772, Accuracy: 8719/10000 (87.1900%)
___Train Local_Simple,  epoch  32, local model 34, internal_epoch   1,  Average loss: 0.0006, Accuracy: 409/413 (99.0315%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1779, Accuracy: 9446/10000 (94.4600%)
___Train Local_Simple,  epoch  32, local model 57, internal_epoch   1,  Average loss: 0.0023, Accuracy: 330/343 (96.2099%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1842, Accuracy: 9437/10000 (94.3700%)
___Train Local_Simple,  epoch  32, local model 69, internal_epoch   1,  Average loss: 0.0018, Accuracy: 247/256 (96.4844%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1605, Accuracy: 9474/10000 (94.7400%)
___Train Local_Simple,  epoch  32, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 264/276 (95.6522%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1603, Accuracy: 9504/10000 (95.0400%)
time spent on training: 117.26055383682251
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.47581967213114756  data num: [606, 591, 568, 557, 623, 647, 413, 343, 256, 276]
[rfa agg] considering poison per batch poison_fraction: 0.1486936475409836
[rfa agg] init. name: [41, 73, 51, 74, 93, 25, 34, 57, 69, 58], weight: tensor([0.1242, 0.1211, 0.1164, 0.1141, 0.1277, 0.1326, 0.0846, 0.0703, 0.0525,
        0.0566])
[rfa agg] iter:  0, prev_obj_val: 94.41411590576172, obj_val: 87.97052764892578, abs dis: 6.4435882568359375
[rfa agg] iter:  0, weight: tensor([0.0734, 0.0485, 0.1172, 0.0840, 0.1649, 0.1712, 0.1093, 0.0908, 0.0678,
        0.0731])
[rfa agg] iter:  1, prev_obj_val: 87.97052764892578, obj_val: 85.24894714355469, abs dis: 2.7215805053710938
[rfa agg] iter:  1, weight: tensor([0.0484, 0.0316, 0.0788, 0.0559, 0.1912, 0.1987, 0.1268, 0.1054, 0.0786,
        0.0848])
[rfa agg] iter:  2, prev_obj_val: 85.24894714355469, obj_val: 83.67139434814453, abs dis: 1.5775527954101562
[rfa agg] iter:  2, weight: tensor([0.0332, 0.0220, 0.0515, 0.0375, 0.2082, 0.2165, 0.1382, 0.1148, 0.0856,
        0.0924])
[rfa agg] iter:  3, prev_obj_val: 83.67139434814453, obj_val: 82.68898010253906, abs dis: 0.9824142456054688
[rfa agg] iter:  3, weight: tensor([0.0228, 0.0153, 0.0344, 0.0255, 0.2194, 0.2281, 0.1457, 0.1211, 0.0903,
        0.0974])
[rfa agg] iter:  4, prev_obj_val: 82.68898010253906, obj_val: 82.05472564697266, abs dis: 0.6342544555664062
[rfa agg] iter:  4, weight: tensor([0.0158, 0.0106, 0.0233, 0.0174, 0.2268, 0.2359, 0.1507, 0.1253, 0.0934,
        0.1008])
[rfa agg] iter:  5, prev_obj_val: 82.05472564697266, obj_val: 81.63774108886719, abs dis: 0.41698455810546875
[rfa agg] iter:  5, weight: tensor([0.0109, 0.0074, 0.0159, 0.0120, 0.2317, 0.2410, 0.1542, 0.1282, 0.0955,
        0.1032])
[rfa agg] iter:  6, prev_obj_val: 81.63774108886719, obj_val: 81.36235809326172, abs dis: 0.27538299560546875
[rfa agg] iter:  6, weight: tensor([0.0076, 0.0051, 0.0109, 0.0083, 0.2347, 0.2443, 0.1567, 0.1303, 0.0971,
        0.1049])
[rfa agg] iter:  7, prev_obj_val: 81.36235809326172, obj_val: 81.1823501586914, abs dis: 0.1800079345703125
[rfa agg] iter:  7, weight: tensor([0.0053, 0.0036, 0.0076, 0.0058, 0.2365, 0.2461, 0.1585, 0.1320, 0.0984,
        0.1062])
[rfa agg] iter:  8, prev_obj_val: 81.1823501586914, obj_val: 81.0683822631836, abs dis: 0.1139678955078125
[rfa agg] iter:  8, weight: tensor([0.0037, 0.0026, 0.0054, 0.0041, 0.2370, 0.2464, 0.1602, 0.1336, 0.0996,
        0.1074])
[rfa agg] iter:  9, prev_obj_val: 81.0683822631836, obj_val: 81.00076293945312, abs dis: 0.06761932373046875
[rfa agg] iter:  9, weight: tensor([0.0027, 0.0019, 0.0039, 0.0030, 0.2363, 0.2451, 0.1620, 0.1352, 0.1011,
        0.1087])
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.0883, Accuracy: 9731/10000 (97.3100%)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 1.1807, Accuracy: 5605/8968 (62.5000%)
Done in 143.5401487350464 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:33 choose agents : [41, 73, 51, 74, 2, 4, 1, 20, 49, 57]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   1,  Average loss: 0.0020, Accuracy: 583/606 (96.2046%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   2,  Average loss: 0.0008, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   3,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   4,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   5,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   6,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   7,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   8,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   9,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch  10,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Global model norm: 16.553771284816037.
Norm before scaling: 16.650360268484057. Distance: 1.293088417623573
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2707, Accuracy: 9108/10000 (91.0800%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0279, Accuracy: 8882/8968 (99.0410%)
Scaling by  100
Scaled Norm after poisoning: 130.95157293108394, distance: 129.30884480092612
Total norm for 4 adversaries is: 130.95157293108394. distance: 129.30884480092612
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   1,  Average loss: 0.0021, Accuracy: 568/591 (96.1083%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   2,  Average loss: 0.0011, Accuracy: 579/591 (97.9695%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   3,  Average loss: 0.0009, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   4,  Average loss: 0.0004, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   5,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   6,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   7,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   8,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Global model norm: 16.553771284816037.
Norm before scaling: 16.64495707255701. Distance: 1.3785713372629333
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2396, Accuracy: 9261/10000 (92.6100%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0230, Accuracy: 8897/8968 (99.2083%)
Scaling by  100
Scaled Norm after poisoning: 139.2526438819924, distance: 137.85713562870077
Total norm for 4 adversaries is: 139.2526438819924. distance: 137.85713562870077
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 102.0816, Accuracy: 8960/8968 (99.9108%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   1,  Average loss: 0.0014, Accuracy: 549/568 (96.6549%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   2,  Average loss: 0.0009, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   3,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   4,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   5,  Average loss: 0.0003, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   6,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   7,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch  10,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 16.553771284816037.
Norm before scaling: 16.593932989515984. Distance: 1.0148594244964462
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2581, Accuracy: 9130/10000 (91.3000%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0138, Accuracy: 8918/8968 (99.4425%)
Scaling by  100
Scaled Norm after poisoning: 102.97356779320846, distance: 101.4859374879717
Total norm for 4 adversaries is: 102.97356779320846. distance: 101.4859374879717
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   1,  Average loss: 0.0025, Accuracy: 527/557 (94.6140%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   2,  Average loss: 0.0012, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   3,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   4,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   5,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   6,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   7,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   8,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   9,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Global model norm: 16.553771284816037.
Norm before scaling: 16.615245280537447. Distance: 1.1382718831385794
will scale.
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1796, Accuracy: 9431/10000 (94.3100%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0050, Accuracy: 8944/8968 (99.7324%)
Scaling by  100
Scaled Norm after poisoning: 115.34728472638616, distance: 113.82718449336916
Total norm for 4 adversaries is: 115.34728472638616. distance: 113.82718449336916
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  33, local model 2, internal_epoch   1,  Average loss: 0.0013, Accuracy: 538/548 (98.1752%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1647, Accuracy: 9483/10000 (94.8300%)
___Train Local_Simple,  epoch  33, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 637/658 (96.8085%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2186, Accuracy: 9235/10000 (92.3500%)
___Train Local_Simple,  epoch  33, local model 1, internal_epoch   1,  Average loss: 0.0018, Accuracy: 739/760 (97.2368%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1507, Accuracy: 9528/10000 (95.2800%)
___Train Local_Simple,  epoch  33, local model 20, internal_epoch   1,  Average loss: 0.0013, Accuracy: 419/429 (97.6690%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3370, Accuracy: 8904/10000 (89.0400%)
___Train Local_Simple,  epoch  33, local model 49, internal_epoch   1,  Average loss: 0.0008, Accuracy: 498/506 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1401, Accuracy: 9539/10000 (95.3900%)
___Train Local_Simple,  epoch  33, local model 57, internal_epoch   1,  Average loss: 0.0019, Accuracy: 330/343 (96.2099%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2192, Accuracy: 9279/10000 (92.7900%)
time spent on training: 123.15775895118713
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41717570966582823  data num: [606, 591, 568, 557, 548, 658, 760, 429, 506, 343]
[rfa agg] considering poison per batch poison_fraction: 0.13036740927057133
[rfa agg] init. name: [41, 73, 51, 74, 2, 4, 1, 20, 49, 57], weight: tensor([0.1089, 0.1062, 0.1020, 0.1001, 0.0985, 0.1182, 0.1365, 0.0771, 0.0909,
        0.0616])
[rfa agg] iter:  0, prev_obj_val: 62.11767578125, obj_val: 56.224918365478516, abs dis: 5.892757415771484
[rfa agg] iter:  0, weight: tensor([0.0529, 0.0480, 0.0675, 0.0557, 0.1311, 0.1573, 0.1817, 0.1027, 0.1211,
        0.0821])
[rfa agg] iter:  1, prev_obj_val: 56.224918365478516, obj_val: 53.48830795288086, abs dis: 2.7366104125976562
[rfa agg] iter:  1, weight: tensor([0.0286, 0.0259, 0.0358, 0.0303, 0.1486, 0.1782, 0.2057, 0.1164, 0.1373,
        0.0932])
[rfa agg] iter:  2, prev_obj_val: 53.48830795288086, obj_val: 52.09355163574219, abs dis: 1.3947563171386719
[rfa agg] iter:  2, weight: tensor([0.0155, 0.0142, 0.0190, 0.0164, 0.1581, 0.1893, 0.2184, 0.1238, 0.1461,
        0.0993])
[rfa agg] iter:  3, prev_obj_val: 52.09355163574219, obj_val: 51.3737678527832, abs dis: 0.7197837829589844
[rfa agg] iter:  3, weight: tensor([0.0085, 0.0077, 0.0102, 0.0089, 0.1634, 0.1949, 0.2246, 0.1278, 0.1511,
        0.1029])
[rfa agg] iter:  4, prev_obj_val: 51.3737678527832, obj_val: 51.01585006713867, abs dis: 0.35791778564453125
[rfa agg] iter:  4, weight: tensor([0.0047, 0.0043, 0.0056, 0.0049, 0.1667, 0.1972, 0.2267, 0.1300, 0.1545,
        0.1056])
[rfa agg] iter:  5, prev_obj_val: 51.01585006713867, obj_val: 50.85985565185547, abs dis: 0.15599441528320312
[rfa agg] iter:  5, weight: tensor([0.0027, 0.0025, 0.0032, 0.0028, 0.1698, 0.1964, 0.2249, 0.1309, 0.1582,
        0.1087])
[rfa agg] iter:  6, prev_obj_val: 50.85985565185547, obj_val: 50.80927658081055, abs dis: 0.050579071044921875
[rfa agg] iter:  6, weight: tensor([0.0017, 0.0016, 0.0021, 0.0018, 0.1737, 0.1926, 0.2192, 0.1304, 0.1637,
        0.1133])
[rfa agg] iter:  7, prev_obj_val: 50.80927658081055, obj_val: 50.79869842529297, abs dis: 0.010578155517578125
[rfa agg] iter:  7, weight: tensor([0.0013, 0.0012, 0.0016, 0.0014, 0.1780, 0.1874, 0.2118, 0.1292, 0.1700,
        0.1181])
[rfa agg] iter:  8, prev_obj_val: 50.79869842529297, obj_val: 50.797218322753906, abs dis: 0.0014801025390625
[rfa agg] iter:  8, weight: tensor([0.0012, 0.0011, 0.0014, 0.0012, 0.1810, 0.1837, 0.2063, 0.1283, 0.1745,
        0.1213])
[rfa agg] iter:  9, prev_obj_val: 50.797218322753906, obj_val: 50.797061920166016, abs dis: 0.000156402587890625
[rfa agg] iter:  9, weight: tensor([0.0011, 0.0010, 0.0013, 0.0012, 0.1826, 0.1819, 0.2035, 0.1280, 0.1766,
        0.1229])
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.0868, Accuracy: 9734/10000 (97.3400%)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 1.0072, Accuracy: 6022/8968 (67.1499%)
Done in 155.20516800880432 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:34 choose agents : [41, 73, 51, 74, 27, 43, 49, 0, 45, 25]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0017, Accuracy: 589/606 (97.1947%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   2,  Average loss: 0.0012, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   3,  Average loss: 0.0005, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   4,  Average loss: 0.0005, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   5,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   6,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   7,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   8,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch  10,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Global model norm: 16.555613802836543.
Norm before scaling: 16.617247186364363. Distance: 1.1555857425704104
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2075, Accuracy: 9308/10000 (93.0800%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0284, Accuracy: 8879/8968 (99.0076%)
Scaling by  100
Scaled Norm after poisoning: 117.04182195240084, distance: 115.55857044427731
Total norm for 4 adversaries is: 117.04182195240084. distance: 115.55857044427731
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   1,  Average loss: 0.0025, Accuracy: 562/591 (95.0931%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   2,  Average loss: 0.0013, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   3,  Average loss: 0.0005, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   4,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   5,  Average loss: 0.0003, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.555613802836543.
Norm before scaling: 16.652246162187662. Distance: 1.4330091401824894
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2704, Accuracy: 9186/10000 (91.8600%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0048, Accuracy: 8951/8968 (99.8104%)
Scaling by  100
Scaled Norm after poisoning: 144.65399855128445, distance: 143.30090854780022
Total norm for 4 adversaries is: 144.65399855128445. distance: 143.30090854780022
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   1,  Average loss: 0.0014, Accuracy: 551/568 (97.0070%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   2,  Average loss: 0.0011, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   3,  Average loss: 0.0007, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   4,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   5,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   6,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   7,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   9,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch  10,  Average loss: 0.0002, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.555613802836543.
Norm before scaling: 16.578911937908405. Distance: 0.9296502498569131
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2308, Accuracy: 9219/10000 (92.1900%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0273, Accuracy: 8880/8968 (99.0187%)
Scaling by  100
Scaled Norm after poisoning: 94.37879752293415, distance: 92.96502093361514
Total norm for 4 adversaries is: 94.37879752293415. distance: 92.96502093361514
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   1,  Average loss: 0.0024, Accuracy: 524/557 (94.0754%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   2,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   3,  Average loss: 0.0008, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   4,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   5,  Average loss: 0.0006, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   6,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   7,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   9,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch  10,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Global model norm: 16.555613802836543.
Norm before scaling: 16.61763376516419. Distance: 1.0980530154105035
will scale.
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1633, Accuracy: 9495/10000 (94.9500%)
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0025, Accuracy: 8958/8968 (99.8885%)
Scaling by  100
Scaled Norm after poisoning: 111.42917015278135, distance: 109.80530088097979
Total norm for 4 adversaries is: 111.42917015278135. distance: 109.80530088097979
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  34, local model 27, internal_epoch   1,  Average loss: 0.0015, Accuracy: 457/471 (97.0276%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2144, Accuracy: 9335/10000 (93.3500%)
___Train Local_Simple,  epoch  34, local model 43, internal_epoch   1,  Average loss: 0.0014, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1279, Accuracy: 9608/10000 (96.0800%)
___Train Local_Simple,  epoch  34, local model 49, internal_epoch   1,  Average loss: 0.0008, Accuracy: 496/506 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1257, Accuracy: 9596/10000 (95.9600%)
___Train Local_Simple,  epoch  34, local model 0, internal_epoch   1,  Average loss: 0.0017, Accuracy: 422/435 (97.0115%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1959, Accuracy: 9355/10000 (93.5500%)
___Train Local_Simple,  epoch  34, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 616/628 (98.0892%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3220, Accuracy: 8915/10000 (89.1500%)
___Train Local_Simple,  epoch  34, local model 25, internal_epoch   1,  Average loss: 0.0013, Accuracy: 634/647 (97.9907%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3351, Accuracy: 8926/10000 (89.2600%)
time spent on training: 126.6226761341095
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4286505445818719  data num: [606, 591, 568, 557, 471, 408, 506, 435, 628, 647]
[rfa agg] considering poison per batch poison_fraction: 0.13395329518183496
[rfa agg] init. name: [41, 73, 51, 74, 27, 43, 49, 0, 45, 25], weight: tensor([0.1119, 0.1091, 0.1049, 0.1028, 0.0869, 0.0753, 0.0934, 0.0803, 0.1159,
        0.1194])
[rfa agg] iter:  0, prev_obj_val: 60.51029586791992, obj_val: 54.90595626831055, abs dis: 5.604339599609375
[rfa agg] iter:  0, weight: tensor([0.0581, 0.0447, 0.0713, 0.0576, 0.1169, 0.1012, 0.1257, 0.1081, 0.1559,
        0.1605])
[rfa agg] iter:  1, prev_obj_val: 54.90595626831055, obj_val: 52.3987922668457, abs dis: 2.5071640014648438
[rfa agg] iter:  1, weight: tensor([0.0317, 0.0243, 0.0386, 0.0312, 0.1329, 0.1152, 0.1431, 0.1232, 0.1773,
        0.1825])
[rfa agg] iter:  2, prev_obj_val: 52.3987922668457, obj_val: 51.124141693115234, abs dis: 1.2746505737304688
[rfa agg] iter:  2, weight: tensor([0.0174, 0.0135, 0.0208, 0.0170, 0.1415, 0.1226, 0.1527, 0.1315, 0.1888,
        0.1942])
[rfa agg] iter:  3, prev_obj_val: 51.124141693115234, obj_val: 50.460731506347656, abs dis: 0.6634101867675781
[rfa agg] iter:  3, weight: tensor([0.0096, 0.0075, 0.0113, 0.0093, 0.1459, 0.1268, 0.1583, 0.1364, 0.1949,
        0.1999])
[rfa agg] iter:  4, prev_obj_val: 50.460731506347656, obj_val: 50.124412536621094, abs dis: 0.3363189697265625
[rfa agg] iter:  4, weight: tensor([0.0054, 0.0042, 0.0063, 0.0052, 0.1481, 0.1293, 0.1624, 0.1398, 0.1978,
        0.2014])
[rfa agg] iter:  5, prev_obj_val: 50.124412536621094, obj_val: 49.971736907958984, abs dis: 0.15267562866210938
[rfa agg] iter:  5, weight: tensor([0.0031, 0.0024, 0.0036, 0.0030, 0.1489, 0.1319, 0.1672, 0.1430, 0.1983,
        0.1985])
[rfa agg] iter:  6, prev_obj_val: 49.971736907958984, obj_val: 49.91798400878906, abs dis: 0.053752899169921875
[rfa agg] iter:  6, weight: tensor([0.0020, 0.0016, 0.0023, 0.0019, 0.1488, 0.1362, 0.1748, 0.1461, 0.1963,
        0.1901])
[rfa agg] iter:  7, prev_obj_val: 49.91798400878906, obj_val: 49.90513229370117, abs dis: 0.012851715087890625
[rfa agg] iter:  7, weight: tensor([0.0015, 0.0012, 0.0017, 0.0014, 0.1480, 0.1421, 0.1845, 0.1481, 0.1925,
        0.1789])
[rfa agg] iter:  8, prev_obj_val: 49.90513229370117, obj_val: 49.903018951416016, abs dis: 0.00211334228515625
[rfa agg] iter:  8, weight: tensor([0.0013, 0.0010, 0.0015, 0.0012, 0.1471, 0.1469, 0.1924, 0.1487, 0.1893,
        0.1705])
[rfa agg] iter:  9, prev_obj_val: 49.903018951416016, obj_val: 49.90274429321289, abs dis: 0.000274658203125
[rfa agg] iter:  9, weight: tensor([0.0012, 0.0010, 0.0014, 0.0012, 0.1466, 0.1494, 0.1966, 0.1488, 0.1877,
        0.1661])
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.0857, Accuracy: 9738/10000 (97.3800%)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 0.9023, Accuracy: 6333/8968 (70.6178%)
Done in 153.4618799686432 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:35 choose agents : [41, 73, 51, 74, 8, 12, 55, 26, 62, 65]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   1,  Average loss: 0.0017, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   2,  Average loss: 0.0013, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   3,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   4,  Average loss: 0.0006, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   5,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   6,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   7,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 16.556709630511204.
Norm before scaling: 16.6238646155417. Distance: 1.1258122902481746
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1895, Accuracy: 9347/10000 (93.4700%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0152, Accuracy: 8911/8968 (99.3644%)
Scaling by  100
Scaled Norm after poisoning: 114.21355152328685, distance: 112.58122935518603
Total norm for 4 adversaries is: 114.21355152328685. distance: 112.58122935518603
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   1,  Average loss: 0.0022, Accuracy: 566/591 (95.7699%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   2,  Average loss: 0.0008, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   3,  Average loss: 0.0006, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   4,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   5,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   6,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   7,  Average loss: 0.0003, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   8,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   9,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.556709630511204.
Norm before scaling: 16.65465407750657. Distance: 1.360744312821852
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2489, Accuracy: 9241/10000 (92.4100%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0239, Accuracy: 8891/8968 (99.1414%)
Scaling by  100
Scaled Norm after poisoning: 137.58816065753987, distance: 136.07444251677094
Total norm for 4 adversaries is: 137.58816065753987. distance: 136.07444251677094
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   1,  Average loss: 0.0012, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   2,  Average loss: 0.0008, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   3,  Average loss: 0.0007, Accuracy: 556/568 (97.8873%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   4,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   5,  Average loss: 0.0003, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   6,  Average loss: 0.0003, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   7,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch  10,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Global model norm: 16.556709630511204.
Norm before scaling: 16.59399092044975. Distance: 0.8779423153725443
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2273, Accuracy: 9252/10000 (92.5200%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0168, Accuracy: 8916/8968 (99.4202%)
Scaling by  100
Scaled Norm after poisoning: 89.60168749718808, distance: 87.79423186313267
Total norm for 4 adversaries is: 89.60168749718808. distance: 87.79423186313267
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   1,  Average loss: 0.0019, Accuracy: 532/557 (95.5117%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   2,  Average loss: 0.0010, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   3,  Average loss: 0.0008, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   4,  Average loss: 0.0005, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   5,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   7,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   9,  Average loss: 0.0003, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Global model norm: 16.556709630511204.
Norm before scaling: 16.620032005600574. Distance: 1.0921998619504212
will scale.
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1550, Accuracy: 9516/10000 (95.1600%)
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0070, Accuracy: 8940/8968 (99.6878%)
Scaling by  100
Scaled Norm after poisoning: 110.8779549704877, distance: 109.21998389860941
Total norm for 4 adversaries is: 110.8779549704877. distance: 109.21998389860941
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.0020, Accuracy: 607/633 (95.8926%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2163, Accuracy: 9308/10000 (93.0800%)
___Train Local_Simple,  epoch  35, local model 12, internal_epoch   1,  Average loss: 0.0012, Accuracy: 1137/1160 (98.0172%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2357, Accuracy: 9238/10000 (92.3800%)
___Train Local_Simple,  epoch  35, local model 55, internal_epoch   1,  Average loss: 0.0016, Accuracy: 347/354 (98.0226%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2021, Accuracy: 9334/10000 (93.3400%)
___Train Local_Simple,  epoch  35, local model 26, internal_epoch   1,  Average loss: 0.0012, Accuracy: 541/554 (97.6534%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1239, Accuracy: 9615/10000 (96.1500%)
___Train Local_Simple,  epoch  35, local model 62, internal_epoch   1,  Average loss: 0.0009, Accuracy: 416/423 (98.3452%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1138, Accuracy: 9634/10000 (96.3400%)
___Train Local_Simple,  epoch  35, local model 65, internal_epoch   1,  Average loss: 0.0011, Accuracy: 361/371 (97.3046%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1258, Accuracy: 9588/10000 (95.8800%)
time spent on training: 136.80576276779175
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3991748323878288  data num: [606, 591, 568, 557, 633, 1160, 354, 554, 423, 371]
[rfa agg] considering poison per batch poison_fraction: 0.1247421351211965
[rfa agg] init. name: [41, 73, 51, 74, 8, 12, 55, 26, 62, 65], weight: tensor([0.1042, 0.1016, 0.0976, 0.0958, 0.1088, 0.1994, 0.0609, 0.0952, 0.0727,
        0.0638])
[rfa agg] iter:  0, prev_obj_val: 55.839561462402344, obj_val: 49.845458984375, abs dis: 5.994102478027344
[rfa agg] iter:  0, weight: tensor([0.0505, 0.0397, 0.0650, 0.0481, 0.1441, 0.2642, 0.0809, 0.1264, 0.0966,
        0.0846])
[rfa agg] iter:  1, prev_obj_val: 49.845458984375, obj_val: 47.18219757080078, abs dis: 2.6632614135742188
[rfa agg] iter:  1, weight: tensor([0.0255, 0.0201, 0.0321, 0.0243, 0.1622, 0.2975, 0.0914, 0.1425, 0.1091,
        0.0954])
[rfa agg] iter:  2, prev_obj_val: 47.18219757080078, obj_val: 45.90766143798828, abs dis: 1.2745361328125
[rfa agg] iter:  2, weight: tensor([0.0128, 0.0102, 0.0158, 0.0122, 0.1708, 0.3136, 0.0971, 0.1507, 0.1157,
        0.1010])
[rfa agg] iter:  3, prev_obj_val: 45.90766143798828, obj_val: 45.3092155456543, abs dis: 0.5984458923339844
[rfa agg] iter:  3, weight: tensor([0.0065, 0.0052, 0.0079, 0.0062, 0.1740, 0.3199, 0.1007, 0.1553, 0.1201,
        0.1042])
[rfa agg] iter:  4, prev_obj_val: 45.3092155456543, obj_val: 45.05883026123047, abs dis: 0.2503852844238281
[rfa agg] iter:  4, weight: tensor([0.0034, 0.0027, 0.0041, 0.0032, 0.1729, 0.3188, 0.1037, 0.1589, 0.1251,
        0.1071])
[rfa agg] iter:  5, prev_obj_val: 45.05883026123047, obj_val: 44.98162841796875, abs dis: 0.07720184326171875
[rfa agg] iter:  5, weight: tensor([0.0020, 0.0016, 0.0024, 0.0019, 0.1676, 0.3090, 0.1062, 0.1636, 0.1342,
        0.1114])
[rfa agg] iter:  6, prev_obj_val: 44.98162841796875, obj_val: 44.96700668334961, abs dis: 0.014621734619140625
[rfa agg] iter:  6, weight: tensor([0.0014, 0.0012, 0.0017, 0.0014, 0.1609, 0.2931, 0.1070, 0.1691, 0.1473,
        0.1170])
[rfa agg] iter:  7, prev_obj_val: 44.96700668334961, obj_val: 44.96516418457031, abs dis: 0.001842498779296875
[rfa agg] iter:  7, weight: tensor([0.0013, 0.0010, 0.0015, 0.0012, 0.1568, 0.2791, 0.1069, 0.1732, 0.1577,
        0.1212])
[rfa agg] iter:  8, prev_obj_val: 44.96516418457031, obj_val: 44.96493911743164, abs dis: 0.000225067138671875
[rfa agg] iter:  8, weight: tensor([0.0012, 0.0010, 0.0015, 0.0011, 0.1554, 0.2707, 0.1071, 0.1754, 0.1634,
        0.1234])
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.0845, Accuracy: 9740/10000 (97.4000%)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 0.8062, Accuracy: 6601/8968 (73.6062%)
Done in 162.15209650993347 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:36 choose agents : [41, 73, 51, 74, 54, 94, 68, 33, 58, 10]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   1,  Average loss: 0.0014, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   2,  Average loss: 0.0009, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   3,  Average loss: 0.0006, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   4,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   5,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   6,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   7,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   8,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   9,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch  10,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 16.55783211049136.
Norm before scaling: 16.611511724624695. Distance: 1.095098155077224
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2107, Accuracy: 9300/10000 (93.0000%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0197, Accuracy: 8900/8968 (99.2417%)
Scaling by  100
Scaled Norm after poisoning: 111.01661351600714, distance: 109.50980977748067
Total norm for 4 adversaries is: 111.01661351600714. distance: 109.50980977748067
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   1,  Average loss: 0.0020, Accuracy: 569/591 (96.2775%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   2,  Average loss: 0.0011, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   3,  Average loss: 0.0006, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   5,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   6,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   8,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   9,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.55783211049136.
Norm before scaling: 16.657732183700944. Distance: 1.3517191801598525
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2508, Accuracy: 9244/10000 (92.4400%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0167, Accuracy: 8908/8968 (99.3310%)
Scaling by  100
Scaled Norm after poisoning: 136.7286317857383, distance: 135.17192466910427
Total norm for 4 adversaries is: 136.7286317857383. distance: 135.17192466910427
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   1,  Average loss: 0.0011, Accuracy: 557/568 (98.0634%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   2,  Average loss: 0.0006, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   3,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   4,  Average loss: 0.0003, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   6,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   7,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch  10,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Global model norm: 16.55783211049136.
Norm before scaling: 16.55012527833296. Distance: 0.8129417978922315
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2549, Accuracy: 9155/10000 (91.5500%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0071, Accuracy: 8942/8968 (99.7101%)
Scaling by  100
Scaled Norm after poisoning: 82.40937553325622, distance: 81.29418269854861
Total norm for 4 adversaries is: 82.40937553325622. distance: 81.29418269854861
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   1,  Average loss: 0.0020, Accuracy: 535/557 (96.0503%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   2,  Average loss: 0.0011, Accuracy: 542/557 (97.3070%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   3,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   4,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   7,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   9,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Global model norm: 16.55783211049136.
Norm before scaling: 16.617750379806132. Distance: 1.0782618228503864
will scale.
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1852, Accuracy: 9420/10000 (94.2000%)
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0045, Accuracy: 8952/8968 (99.8216%)
Scaling by  100
Scaled Norm after poisoning: 109.467648260228, distance: 107.8261721403366
Total norm for 4 adversaries is: 109.467648260228. distance: 107.8261721403366
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  36, local model 54, internal_epoch   1,  Average loss: 0.0018, Accuracy: 501/519 (96.5318%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1823, Accuracy: 9422/10000 (94.2200%)
___Train Local_Simple,  epoch  36, local model 94, internal_epoch   1,  Average loss: 0.0020, Accuracy: 145/150 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1172, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch  36, local model 68, internal_epoch   1,  Average loss: 0.0012, Accuracy: 484/494 (97.9757%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1387, Accuracy: 9519/10000 (95.1900%)
___Train Local_Simple,  epoch  36, local model 33, internal_epoch   1,  Average loss: 0.0015, Accuracy: 608/623 (97.5923%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1464, Accuracy: 9517/10000 (95.1700%)
___Train Local_Simple,  epoch  36, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 264/276 (95.6522%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1185, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch  36, local model 10, internal_epoch   1,  Average loss: 0.0012, Accuracy: 873/892 (97.8700%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3980, Accuracy: 8729/10000 (87.2900%)
time spent on training: 129.04763555526733
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.44010614101592116  data num: [606, 591, 568, 557, 519, 150, 494, 623, 276, 892]
[rfa agg] considering poison per batch poison_fraction: 0.13753316906747537
[rfa agg] init. name: [41, 73, 51, 74, 54, 94, 68, 33, 58, 10], weight: tensor([0.1149, 0.1120, 0.1077, 0.1056, 0.0984, 0.0284, 0.0936, 0.1181, 0.0523,
        0.1691])
[rfa agg] iter:  0, prev_obj_val: 57.89757537841797, obj_val: 52.66392135620117, abs dis: 5.233654022216797
[rfa agg] iter:  0, weight: tensor([0.0599, 0.0461, 0.0779, 0.0562, 0.1335, 0.0386, 0.1271, 0.1602, 0.0709,
        0.2297])
[rfa agg] iter:  1, prev_obj_val: 52.66392135620117, obj_val: 50.4042854309082, abs dis: 2.2596359252929688
[rfa agg] iter:  1, weight: tensor([0.0327, 0.0251, 0.0432, 0.0307, 0.1526, 0.0441, 0.1451, 0.1828, 0.0810,
        0.2626])
[rfa agg] iter:  2, prev_obj_val: 50.4042854309082, obj_val: 49.260772705078125, abs dis: 1.1435127258300781
[rfa agg] iter:  2, weight: tensor([0.0182, 0.0142, 0.0236, 0.0171, 0.1630, 0.0471, 0.1549, 0.1949, 0.0863,
        0.2807])
[rfa agg] iter:  3, prev_obj_val: 49.260772705078125, obj_val: 48.66366958618164, abs dis: 0.5971031188964844
[rfa agg] iter:  3, weight: tensor([0.0102, 0.0080, 0.0131, 0.0096, 0.1686, 0.0489, 0.1604, 0.2011, 0.0891,
        0.2909])
[rfa agg] iter:  4, prev_obj_val: 48.66366958618164, obj_val: 48.36042404174805, abs dis: 0.30324554443359375
[rfa agg] iter:  4, weight: tensor([0.0058, 0.0046, 0.0074, 0.0054, 0.1715, 0.0502, 0.1640, 0.2037, 0.0906,
        0.2967])
[rfa agg] iter:  5, prev_obj_val: 48.36042404174805, obj_val: 48.223812103271484, abs dis: 0.1366119384765625
[rfa agg] iter:  5, weight: tensor([0.0035, 0.0027, 0.0044, 0.0032, 0.1723, 0.0519, 0.1677, 0.2033, 0.0916,
        0.2993])
[rfa agg] iter:  6, prev_obj_val: 48.223812103271484, obj_val: 48.1766242980957, abs dis: 0.04718780517578125
[rfa agg] iter:  6, weight: tensor([0.0023, 0.0018, 0.0029, 0.0021, 0.1710, 0.0551, 0.1735, 0.2005, 0.0929,
        0.2979])
[rfa agg] iter:  7, prev_obj_val: 48.1766242980957, obj_val: 48.16553497314453, abs dis: 0.011089324951171875
[rfa agg] iter:  7, weight: tensor([0.0018, 0.0014, 0.0022, 0.0016, 0.1683, 0.0594, 0.1809, 0.1968, 0.0947,
        0.2929])
[rfa agg] iter:  8, prev_obj_val: 48.16553497314453, obj_val: 48.16371154785156, abs dis: 0.00182342529296875
[rfa agg] iter:  8, weight: tensor([0.0016, 0.0012, 0.0020, 0.0015, 0.1661, 0.0631, 0.1869, 0.1943, 0.0962,
        0.2873])
[rfa agg] iter:  9, prev_obj_val: 48.16371154785156, obj_val: 48.16346740722656, abs dis: 0.000244140625
[rfa agg] iter:  9, weight: tensor([0.0015, 0.0012, 0.0019, 0.0014, 0.1650, 0.0650, 0.1903, 0.1934, 0.0970,
        0.2834])
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.0847, Accuracy: 9745/10000 (97.4500%)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 0.6945, Accuracy: 6905/8968 (76.9960%)
Done in 152.25138759613037 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:37 choose agents : [41, 73, 51, 74, 13, 81, 37, 94, 61, 57]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   1,  Average loss: 0.0016, Accuracy: 585/606 (96.5347%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   2,  Average loss: 0.0006, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   3,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   5,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   6,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   7,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   8,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   9,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch  10,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Global model norm: 16.558067102824552.
Norm before scaling: 16.61363164234889. Distance: 1.1080837525653373
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1875, Accuracy: 9373/10000 (93.7300%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0263, Accuracy: 8891/8968 (99.1414%)
Scaling by  100
Scaled Norm after poisoning: 112.31293909903034, distance: 110.80837996429918
Total norm for 4 adversaries is: 112.31293909903034. distance: 110.80837996429918
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   1,  Average loss: 0.0017, Accuracy: 572/591 (96.7851%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   2,  Average loss: 0.0010, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   3,  Average loss: 0.0004, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   4,  Average loss: 0.0004, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   5,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   7,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   8,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.558067102824552.
Norm before scaling: 16.628728692233867. Distance: 1.2712170016526811
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2591, Accuracy: 9212/10000 (92.1200%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0167, Accuracy: 8905/8968 (99.2975%)
Scaling by  100
Scaled Norm after poisoning: 128.47957036042735, distance: 127.12170057788127
Total norm for 4 adversaries is: 128.47957036042735. distance: 127.12170057788127
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   1,  Average loss: 0.0009, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   2,  Average loss: 0.0005, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   6,  Average loss: 0.0002, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.558067102824552.
Norm before scaling: 16.548189941260382. Distance: 0.6696382372560538
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2373, Accuracy: 9210/10000 (92.1000%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0107, Accuracy: 8924/8968 (99.5094%)
Scaling by  100
Scaled Norm after poisoning: 68.4162388492765, distance: 66.96382098053023
Total norm for 4 adversaries is: 68.4162388492765. distance: 66.96382098053023
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   1,  Average loss: 0.0021, Accuracy: 534/557 (95.8707%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   2,  Average loss: 0.0012, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   3,  Average loss: 0.0006, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   4,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   5,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   6,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   9,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Global model norm: 16.558067102824552.
Norm before scaling: 16.61770814152641. Distance: 1.0705496532251304
will scale.
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1635, Accuracy: 9493/10000 (94.9300%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0025, Accuracy: 8958/8968 (99.8885%)
Scaling by  100
Scaled Norm after poisoning: 108.7114964165474, distance: 107.0549745603865
Total norm for 4 adversaries is: 108.7114964165474. distance: 107.0549745603865
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  37, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 710/734 (96.7302%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1677, Accuracy: 9484/10000 (94.8400%)
___Train Local_Simple,  epoch  37, local model 81, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1207/1227 (98.3700%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.3101, Accuracy: 9163/10000 (91.6300%)
___Train Local_Simple,  epoch  37, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 843/860 (98.0233%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2337, Accuracy: 9276/10000 (92.7600%)
___Train Local_Simple,  epoch  37, local model 94, internal_epoch   1,  Average loss: 0.0025, Accuracy: 144/150 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1254, Accuracy: 9618/10000 (96.1800%)
___Train Local_Simple,  epoch  37, local model 61, internal_epoch   1,  Average loss: 0.0013, Accuracy: 683/699 (97.7110%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2383, Accuracy: 9185/10000 (91.8500%)
___Train Local_Simple,  epoch  37, local model 57, internal_epoch   1,  Average loss: 0.0022, Accuracy: 328/343 (95.6268%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1746, Accuracy: 9455/10000 (94.5500%)
time spent on training: 132.38122653961182
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3665351223362273  data num: [606, 591, 568, 557, 734, 1227, 860, 150, 699, 343]
[rfa agg] considering poison per batch poison_fraction: 0.11454222573007103
[rfa agg] init. name: [41, 73, 51, 74, 13, 81, 37, 94, 61, 57], weight: tensor([0.0957, 0.0933, 0.0897, 0.0879, 0.1159, 0.1937, 0.1358, 0.0237, 0.1103,
        0.0541])
[rfa agg] iter:  0, prev_obj_val: 48.700538635253906, obj_val: 41.87930679321289, abs dis: 6.821231842041016
[rfa agg] iter:  0, weight: tensor([0.0346, 0.0289, 0.0554, 0.0334, 0.1546, 0.2590, 0.1819, 0.0317, 0.1478,
        0.0726])
[rfa agg] iter:  1, prev_obj_val: 41.87930679321289, obj_val: 39.48584747314453, abs dis: 2.3934593200683594
[rfa agg] iter:  1, weight: tensor([0.0137, 0.0115, 0.0221, 0.0131, 0.1709, 0.2862, 0.2022, 0.0352, 0.1644,
        0.0807])
[rfa agg] iter:  2, prev_obj_val: 39.48584747314453, obj_val: 38.629974365234375, abs dis: 0.8558731079101562
[rfa agg] iter:  2, weight: tensor([0.0055, 0.0047, 0.0087, 0.0053, 0.1756, 0.2947, 0.2118, 0.0369, 0.1722,
        0.0848])
[rfa agg] iter:  3, prev_obj_val: 38.629974365234375, obj_val: 38.398075103759766, abs dis: 0.23189926147460938
[rfa agg] iter:  3, weight: tensor([0.0024, 0.0021, 0.0038, 0.0023, 0.1720, 0.2902, 0.2204, 0.0390, 0.1784,
        0.0893])
[rfa agg] iter:  4, prev_obj_val: 38.398075103759766, obj_val: 38.366668701171875, abs dis: 0.031406402587890625
[rfa agg] iter:  4, weight: tensor([0.0015, 0.0012, 0.0023, 0.0014, 0.1630, 0.2741, 0.2316, 0.0433, 0.1850,
        0.0966])
[rfa agg] iter:  5, prev_obj_val: 38.366668701171875, obj_val: 38.364688873291016, abs dis: 0.001979827880859375
[rfa agg] iter:  5, weight: tensor([0.0012, 0.0010, 0.0019, 0.0012, 0.1576, 0.2600, 0.2389, 0.0469, 0.1892,
        0.1019])
[rfa agg] iter:  6, prev_obj_val: 38.364688873291016, obj_val: 38.36457443237305, abs dis: 0.00011444091796875
[rfa agg] iter:  6, weight: tensor([0.0012, 0.0010, 0.0018, 0.0011, 0.1560, 0.2527, 0.2422, 0.0483, 0.1915,
        0.1041])
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.0844, Accuracy: 9741/10000 (97.4100%)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 0.6412, Accuracy: 7078/8968 (78.9251%)
Done in 158.1587688922882 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:38 choose agents : [41, 73, 51, 74, 60, 92, 23, 39, 79, 86]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   1,  Average loss: 0.0015, Accuracy: 586/606 (96.6997%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   2,  Average loss: 0.0006, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   3,  Average loss: 0.0006, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   4,  Average loss: 0.0007, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   5,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   6,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   7,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   8,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   9,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch  10,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Global model norm: 16.558453220239958.
Norm before scaling: 16.59017624240039. Distance: 0.954630428924648
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1811, Accuracy: 9390/10000 (93.9000%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0312, Accuracy: 8872/8968 (98.9295%)
Scaling by  100
Scaled Norm after poisoning: 96.96082387844845, distance: 95.46304197338623
Total norm for 4 adversaries is: 96.96082387844845. distance: 95.46304197338623
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   1,  Average loss: 0.0012, Accuracy: 577/591 (97.6311%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   3,  Average loss: 0.0005, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   4,  Average loss: 0.0003, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   7,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   8,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.558453220239958.
Norm before scaling: 16.59236693859559. Distance: 0.949292309583445
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1604, Accuracy: 9494/10000 (94.9400%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0293, Accuracy: 8887/8968 (99.0968%)
Scaling by  100
Scaled Norm after poisoning: 96.47826018072672, distance: 94.92923453980075
Total norm for 4 adversaries is: 96.47826018072672. distance: 94.92923453980075
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   1,  Average loss: 0.0008, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   2,  Average loss: 0.0008, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   6,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   7,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.558453220239958.
Norm before scaling: 16.55539720930345. Distance: 0.7316946259227602
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2277, Accuracy: 9247/10000 (92.4700%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0117, Accuracy: 8928/8968 (99.5540%)
Scaling by  100
Scaled Norm after poisoning: 74.59420493681965, distance: 73.16945430279462
Total norm for 4 adversaries is: 74.59420493681965. distance: 73.16945430279462
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   1,  Average loss: 0.0015, Accuracy: 539/557 (96.7684%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   2,  Average loss: 0.0011, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   3,  Average loss: 0.0007, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   4,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   6,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   7,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   8,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   9,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Global model norm: 16.558453220239958.
Norm before scaling: 16.615631905913556. Distance: 1.026020721118482
will scale.
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1538, Accuracy: 9512/10000 (95.1200%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0035, Accuracy: 8954/8968 (99.8439%)
Scaling by  100
Scaled Norm after poisoning: 104.3349380451007, distance: 102.60207379422211
Total norm for 4 adversaries is: 104.3349380451007. distance: 102.60207379422211
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  38, local model 60, internal_epoch   1,  Average loss: 0.0020, Accuracy: 327/338 (96.7456%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1377, Accuracy: 9584/10000 (95.8400%)
___Train Local_Simple,  epoch  38, local model 92, internal_epoch   1,  Average loss: 0.0013, Accuracy: 912/937 (97.3319%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3933, Accuracy: 8663/10000 (86.6300%)
___Train Local_Simple,  epoch  38, local model 23, internal_epoch   1,  Average loss: 0.0013, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1255, Accuracy: 9589/10000 (95.8900%)
___Train Local_Simple,  epoch  38, local model 39, internal_epoch   1,  Average loss: 0.0011, Accuracy: 252/257 (98.0545%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1169, Accuracy: 9623/10000 (96.2300%)
___Train Local_Simple,  epoch  38, local model 79, internal_epoch   1,  Average loss: 0.0020, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0909, Accuracy: 9729/10000 (97.2900%)
___Train Local_Simple,  epoch  38, local model 86, internal_epoch   1,  Average loss: 0.0014, Accuracy: 242/250 (96.8000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0980, Accuracy: 9705/10000 (97.0500%)
time spent on training: 130.51692461967468
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.5070976195675911  data num: [606, 591, 568, 557, 338, 937, 293, 257, 182, 250]
[rfa agg] considering poison per batch poison_fraction: 0.15846800611487222
[rfa agg] init. name: [41, 73, 51, 74, 60, 92, 23, 39, 79, 86], weight: tensor([0.1323, 0.1291, 0.1240, 0.1216, 0.0738, 0.2046, 0.0640, 0.0561, 0.0397,
        0.0546])
[rfa agg] iter:  0, prev_obj_val: 52.706207275390625, obj_val: 49.917842864990234, abs dis: 2.7883644104003906
[rfa agg] iter:  0, weight: tensor([0.0803, 0.0791, 0.1047, 0.0693, 0.1000, 0.2763, 0.0866, 0.0760, 0.0538,
        0.0739])
[rfa agg] iter:  1, prev_obj_val: 49.917842864990234, obj_val: 48.659183502197266, abs dis: 1.2586593627929688
[rfa agg] iter:  1, weight: tensor([0.0552, 0.0544, 0.0727, 0.0472, 0.1157, 0.3191, 0.1001, 0.0879, 0.0622,
        0.0854])
[rfa agg] iter:  2, prev_obj_val: 48.659183502197266, obj_val: 47.94642639160156, abs dis: 0.7127571105957031
[rfa agg] iter:  2, weight: tensor([0.0394, 0.0388, 0.0507, 0.0337, 0.1259, 0.3465, 0.1089, 0.0956, 0.0677,
        0.0929])
[rfa agg] iter:  3, prev_obj_val: 47.94642639160156, obj_val: 47.5023078918457, abs dis: 0.4441184997558594
[rfa agg] iter:  3, weight: tensor([0.0286, 0.0281, 0.0362, 0.0244, 0.1329, 0.3647, 0.1149, 0.1009, 0.0715,
        0.0980])
[rfa agg] iter:  4, prev_obj_val: 47.5023078918457, obj_val: 47.210567474365234, abs dis: 0.29174041748046875
[rfa agg] iter:  4, weight: tensor([0.0209, 0.0206, 0.0262, 0.0179, 0.1379, 0.3770, 0.1191, 0.1047, 0.0742,
        0.1016])
[rfa agg] iter:  5, prev_obj_val: 47.210567474365234, obj_val: 47.013309478759766, abs dis: 0.19725799560546875
[rfa agg] iter:  5, weight: tensor([0.0155, 0.0152, 0.0192, 0.0132, 0.1416, 0.3852, 0.1222, 0.1074, 0.0762,
        0.1042])
[rfa agg] iter:  6, prev_obj_val: 47.013309478759766, obj_val: 46.87845230102539, abs dis: 0.134857177734375
[rfa agg] iter:  6, weight: tensor([0.0115, 0.0113, 0.0143, 0.0099, 0.1445, 0.3903, 0.1246, 0.1096, 0.0778,
        0.1062])
[rfa agg] iter:  7, prev_obj_val: 46.87845230102539, obj_val: 46.78679275512695, abs dis: 0.0916595458984375
[rfa agg] iter:  7, weight: tensor([0.0087, 0.0085, 0.0107, 0.0074, 0.1468, 0.3929, 0.1266, 0.1112, 0.0792,
        0.1079])
[rfa agg] iter:  8, prev_obj_val: 46.78679275512695, obj_val: 46.72607421875, abs dis: 0.060718536376953125
[rfa agg] iter:  8, weight: tensor([0.0066, 0.0065, 0.0082, 0.0057, 0.1486, 0.3935, 0.1284, 0.1126, 0.0805,
        0.1094])
[rfa agg] iter:  9, prev_obj_val: 46.72607421875, obj_val: 46.687828063964844, abs dis: 0.03824615478515625
[rfa agg] iter:  9, weight: tensor([0.0052, 0.0051, 0.0064, 0.0044, 0.1501, 0.3921, 0.1302, 0.1138, 0.0818,
        0.1108])
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.0867, Accuracy: 9740/10000 (97.4000%)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 0.3363, Accuracy: 7951/8968 (88.6597%)
Done in 153.1346399784088 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:39 choose agents : [41, 73, 51, 74, 63, 99, 97, 37, 44, 52]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   1,  Average loss: 0.0008, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   2,  Average loss: 0.0007, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   3,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   5,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.55829471966958.
Norm before scaling: 16.57406822565987. Distance: 0.7551304261811903
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1706, Accuracy: 9417/10000 (94.1700%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0230, Accuracy: 8897/8968 (99.2083%)
Scaling by  100
Scaled Norm after poisoning: 77.27634689258092, distance: 75.51303372080048
Total norm for 4 adversaries is: 77.27634689258092. distance: 75.51303372080048
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   1,  Average loss: 0.0010, Accuracy: 581/591 (98.3080%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   2,  Average loss: 0.0009, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   3,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   4,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   5,  Average loss: 0.0005, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   7,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   8,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Global model norm: 16.55829471966958.
Norm before scaling: 16.574616919415984. Distance: 0.9718847317223714
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1618, Accuracy: 9463/10000 (94.6300%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0036, Accuracy: 8958/8968 (99.8885%)
Scaling by  100
Scaled Norm after poisoning: 98.38394872735847, distance: 97.18847467356919
Total norm for 4 adversaries is: 98.38394872735847. distance: 97.18847467356919
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 2571.6692, Accuracy: 8287/8968 (92.4063%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   2,  Average loss: 0.0006, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   6,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.55829471966958.
Norm before scaling: 16.547916080622603. Distance: 0.5935132407918455
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2206, Accuracy: 9282/10000 (92.8200%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0100, Accuracy: 8932/8968 (99.5986%)
Scaling by  100
Scaled Norm after poisoning: 61.05056817917422, distance: 59.351323404316354
Total norm for 4 adversaries is: 61.05056817917422. distance: 59.351323404316354
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   1,  Average loss: 0.0016, Accuracy: 538/557 (96.5889%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   2,  Average loss: 0.0007, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   3,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   4,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   5,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   7,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.55829471966958.
Norm before scaling: 16.574217369048963. Distance: 0.9243743443051502
will scale.
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1697, Accuracy: 9467/10000 (94.6700%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0018, Accuracy: 8962/8968 (99.9331%)
Scaling by  100
Scaled Norm after poisoning: 93.73454039200277, distance: 92.43743133026523
Total norm for 4 adversaries is: 93.73454039200277. distance: 92.43743133026523
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  39, local model 63, internal_epoch   1,  Average loss: 0.0019, Accuracy: 858/889 (96.5129%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1711, Accuracy: 9474/10000 (94.7400%)
___Train Local_Simple,  epoch  39, local model 99, internal_epoch   1,  Average loss: 0.0008, Accuracy: 373/377 (98.9390%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1125, Accuracy: 9654/10000 (96.5400%)
___Train Local_Simple,  epoch  39, local model 97, internal_epoch   1,  Average loss: 0.0011, Accuracy: 474/487 (97.3306%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2282, Accuracy: 9247/10000 (92.4700%)
___Train Local_Simple,  epoch  39, local model 37, internal_epoch   1,  Average loss: 0.0010, Accuracy: 843/860 (98.0233%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3467, Accuracy: 8933/10000 (89.3300%)
___Train Local_Simple,  epoch  39, local model 44, internal_epoch   1,  Average loss: 0.0026, Accuracy: 503/517 (97.2921%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1365, Accuracy: 9582/10000 (95.8200%)
___Train Local_Simple,  epoch  39, local model 52, internal_epoch   1,  Average loss: 0.0009, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1526, Accuracy: 9534/10000 (95.3400%)
time spent on training: 134.16223406791687
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.407011393514461  data num: [606, 591, 568, 557, 889, 377, 487, 860, 517, 253]
[rfa agg] considering poison per batch poison_fraction: 0.12719106047326906
[rfa agg] init. name: [41, 73, 51, 74, 63, 99, 97, 37, 44, 52], weight: tensor([0.1062, 0.1036, 0.0996, 0.0976, 0.1558, 0.0661, 0.0854, 0.1507, 0.0906,
        0.0443])
[rfa agg] iter:  0, prev_obj_val: 41.09309768676758, obj_val: 36.55216598510742, abs dis: 4.540931701660156
[rfa agg] iter:  0, weight: tensor([0.0529, 0.0393, 0.0667, 0.0393, 0.2111, 0.0894, 0.1153, 0.2035, 0.1224,
        0.0601])
[rfa agg] iter:  1, prev_obj_val: 36.55216598510742, obj_val: 34.708187103271484, abs dis: 1.8439788818359375
[rfa agg] iter:  1, weight: tensor([0.0255, 0.0189, 0.0318, 0.0189, 0.2387, 0.1009, 0.1300, 0.2295, 0.1378,
        0.0680])
[rfa agg] iter:  2, prev_obj_val: 34.708187103271484, obj_val: 33.89094924926758, abs dis: 0.8172378540039062
[rfa agg] iter:  2, weight: tensor([0.0124, 0.0093, 0.0151, 0.0092, 0.2524, 0.1068, 0.1367, 0.2408, 0.1449,
        0.0722])
[rfa agg] iter:  3, prev_obj_val: 33.89094924926758, obj_val: 33.55643081665039, abs dis: 0.3345184326171875
[rfa agg] iter:  3, weight: tensor([0.0062, 0.0047, 0.0075, 0.0047, 0.2596, 0.1112, 0.1394, 0.2430, 0.1480,
        0.0757])
[rfa agg] iter:  4, prev_obj_val: 33.55643081665039, obj_val: 33.45375442504883, abs dis: 0.1026763916015625
[rfa agg] iter:  4, weight: tensor([0.0035, 0.0026, 0.0042, 0.0026, 0.2617, 0.1183, 0.1399, 0.2361, 0.1497,
        0.0814])
[rfa agg] iter:  5, prev_obj_val: 33.45375442504883, obj_val: 33.434932708740234, abs dis: 0.01882171630859375
[rfa agg] iter:  5, weight: tensor([0.0024, 0.0018, 0.0029, 0.0018, 0.2579, 0.1296, 0.1393, 0.2230, 0.1514,
        0.0898])
[rfa agg] iter:  6, prev_obj_val: 33.434932708740234, obj_val: 33.43281936645508, abs dis: 0.00211334228515625
[rfa agg] iter:  6, weight: tensor([0.0021, 0.0016, 0.0025, 0.0016, 0.2522, 0.1390, 0.1392, 0.2126, 0.1530,
        0.0963])
[rfa agg] iter:  7, prev_obj_val: 33.43281936645508, obj_val: 33.43262481689453, abs dis: 0.000194549560546875
[rfa agg] iter:  7, weight: tensor([0.0020, 0.0015, 0.0024, 0.0015, 0.2484, 0.1436, 0.1396, 0.2075, 0.1541,
        0.0994])
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.0853, Accuracy: 9745/10000 (97.4500%)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 0.3086, Accuracy: 8023/8968 (89.4625%)
Done in 157.29164266586304 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:40 choose agents : [41, 73, 51, 74, 88, 25, 28, 8, 16, 6]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   1,  Average loss: 0.0011, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   2,  Average loss: 0.0007, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   3,  Average loss: 0.0005, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   5,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   6,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 16.556469089186013.
Norm before scaling: 16.58226083836938. Distance: 0.8803062986372818
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2155, Accuracy: 9256/10000 (92.5600%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0178, Accuracy: 8913/8968 (99.3867%)
Scaling by  100
Scaled Norm after poisoning: 89.61854655549124, distance: 88.03063154291095
Total norm for 4 adversaries is: 89.61854655549124. distance: 88.03063154291095
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   1,  Average loss: 0.0008, Accuracy: 580/591 (98.1387%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   4,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   5,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   7,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Global model norm: 16.556469089186013.
Norm before scaling: 16.563510619225717. Distance: 0.7840891556600835
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1467, Accuracy: 9517/10000 (95.1700%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0269, Accuracy: 8886/8968 (99.0856%)
Scaling by  100
Scaled Norm after poisoning: 79.89939658231938, distance: 78.40891224555567
Total norm for 4 adversaries is: 79.89939658231938. distance: 78.40891224555567
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 11490.7922, Accuracy: 6093/8968 (67.9416%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0009, Accuracy: 558/568 (98.2394%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   3,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   4,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.556469089186013.
Norm before scaling: 16.531754888024874. Distance: 0.5773137819103097
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2097, Accuracy: 9294/10000 (92.9400%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0151, Accuracy: 8916/8968 (99.4202%)
Scaling by  100
Scaled Norm after poisoning: 59.092471314166794, distance: 57.73138101167878
Total norm for 4 adversaries is: 59.092471314166794. distance: 57.73138101167878
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   1,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   2,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   3,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   4,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   7,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   8,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Global model norm: 16.556469089186013.
Norm before scaling: 16.56004643530486. Distance: 0.7417183849075862
will scale.
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1552, Accuracy: 9523/10000 (95.2300%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0039, Accuracy: 8955/8968 (99.8550%)
Scaling by  100
Scaled Norm after poisoning: 75.71267838327178, distance: 74.1718371471359
Total norm for 4 adversaries is: 75.71267838327178. distance: 74.1718371471359
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  40, local model 88, internal_epoch   1,  Average loss: 0.0007, Accuracy: 525/530 (99.0566%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1471, Accuracy: 9529/10000 (95.2900%)
___Train Local_Simple,  epoch  40, local model 25, internal_epoch   1,  Average loss: 0.0017, Accuracy: 630/647 (97.3725%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2534, Accuracy: 9162/10000 (91.6200%)
___Train Local_Simple,  epoch  40, local model 28, internal_epoch   1,  Average loss: 0.0013, Accuracy: 490/501 (97.8044%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1236, Accuracy: 9583/10000 (95.8300%)
___Train Local_Simple,  epoch  40, local model 8, internal_epoch   1,  Average loss: 0.0018, Accuracy: 612/633 (96.6825%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1442, Accuracy: 9541/10000 (95.4100%)
___Train Local_Simple,  epoch  40, local model 16, internal_epoch   1,  Average loss: 0.0012, Accuracy: 894/915 (97.7049%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1446, Accuracy: 9552/10000 (95.5200%)
___Train Local_Simple,  epoch  40, local model 6, internal_epoch   1,  Average loss: 0.0014, Accuracy: 600/615 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1857, Accuracy: 9392/10000 (93.9200%)
time spent on training: 118.98074889183044
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3767645627129645  data num: [606, 591, 568, 557, 530, 647, 501, 633, 915, 615]
[rfa agg] considering poison per batch poison_fraction: 0.1177389258478014
[rfa agg] init. name: [41, 73, 51, 74, 88, 25, 28, 8, 16, 6], weight: tensor([0.0983, 0.0959, 0.0922, 0.0904, 0.0860, 0.1050, 0.0813, 0.1027, 0.1485,
        0.0998])
[rfa agg] iter:  0, prev_obj_val: 35.86933135986328, obj_val: 31.077268600463867, abs dis: 4.792062759399414
[rfa agg] iter:  0, weight: tensor([0.0330, 0.0360, 0.0475, 0.0364, 0.1171, 0.1429, 0.1106, 0.1393, 0.2017,
        0.1355])
[rfa agg] iter:  1, prev_obj_val: 31.077268600463867, obj_val: 29.38046646118164, abs dis: 1.6968021392822266
[rfa agg] iter:  1, weight: tensor([0.0131, 0.0145, 0.0193, 0.0145, 0.1301, 0.1587, 0.1229, 0.1537, 0.2233,
        0.1499])
[rfa agg] iter:  2, prev_obj_val: 29.38046646118164, obj_val: 28.779232025146484, abs dis: 0.6012344360351562
[rfa agg] iter:  2, weight: tensor([0.0054, 0.0059, 0.0078, 0.0059, 0.1367, 0.1646, 0.1290, 0.1585, 0.2309,
        0.1551])
[rfa agg] iter:  3, prev_obj_val: 28.779232025146484, obj_val: 28.621854782104492, abs dis: 0.1573772430419922
[rfa agg] iter:  3, weight: tensor([0.0025, 0.0027, 0.0036, 0.0027, 0.1442, 0.1620, 0.1364, 0.1595, 0.2299,
        0.1565])
[rfa agg] iter:  4, prev_obj_val: 28.621854782104492, obj_val: 28.601470947265625, abs dis: 0.020383834838867188
[rfa agg] iter:  4, weight: tensor([0.0016, 0.0017, 0.0022, 0.0017, 0.1553, 0.1503, 0.1481, 0.1608, 0.2218,
        0.1565])
[rfa agg] iter:  5, prev_obj_val: 28.601470947265625, obj_val: 28.600217819213867, abs dis: 0.0012531280517578125
[rfa agg] iter:  5, weight: tensor([0.0013, 0.0015, 0.0019, 0.0015, 0.1626, 0.1415, 0.1561, 0.1625, 0.2151,
        0.1560])
[rfa agg] iter:  6, prev_obj_val: 28.600217819213867, obj_val: 28.60015869140625, abs dis: 5.91278076171875e-05
[rfa agg] iter:  6, weight: tensor([0.0013, 0.0014, 0.0019, 0.0014, 0.1654, 0.1384, 0.1591, 0.1634, 0.2122,
        0.1556])
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.0846, Accuracy: 9746/10000 (97.4600%)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 0.2931, Accuracy: 8072/8968 (90.0089%)
Done in 142.08572459220886 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:41 choose agents : [41, 73, 51, 74, 3, 23, 44, 27, 86, 37]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   1,  Average loss: 0.0011, Accuracy: 591/606 (97.5248%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   2,  Average loss: 0.0009, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   3,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   5,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Global model norm: 16.555559424301027.
Norm before scaling: 16.568265321737346. Distance: 0.7871839994358009
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1743, Accuracy: 9409/10000 (94.0900%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0233, Accuracy: 8892/8968 (99.1525%)
Scaling by  100
Scaled Norm after poisoning: 80.3168438757167, distance: 78.71840574061285
Total norm for 4 adversaries is: 80.3168438757167. distance: 78.71840574061285
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 1.1883, Accuracy: 8966/8968 (99.9777%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   1,  Average loss: 0.0009, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   2,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   3,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.555559424301027.
Norm before scaling: 16.553121423387854. Distance: 0.7081157733555185
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1323, Accuracy: 9567/10000 (95.6700%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0175, Accuracy: 8911/8968 (99.3644%)
Scaling by  100
Scaled Norm after poisoning: 72.31977194420969, distance: 70.81157945672621
Total norm for 4 adversaries is: 72.31977194420969. distance: 70.81157945672621
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 137340.8391, Accuracy: 204/8968 (2.2748%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   2,  Average loss: 0.0005, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.555559424301027.
Norm before scaling: 16.537903685194845. Distance: 0.5857816616086412
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2219, Accuracy: 9275/10000 (92.7500%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0097, Accuracy: 8938/8968 (99.6655%)
Scaling by  100
Scaled Norm after poisoning: 60.10613781249278, distance: 58.578166677765914
Total norm for 4 adversaries is: 60.10613781249278. distance: 58.578166677765914
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 72188.9867, Accuracy: 4/8968 (0.0446%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   1,  Average loss: 0.0008, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   2,  Average loss: 0.0007, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   3,  Average loss: 0.0004, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   4,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   5,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   8,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Global model norm: 16.555559424301027.
Norm before scaling: 16.565859587036886. Distance: 0.7092872582170335
will scale.
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1276, Accuracy: 9610/10000 (96.1000%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0051, Accuracy: 8949/8968 (99.7881%)
Scaling by  100
Scaled Norm after poisoning: 72.72400066991295, distance: 70.92872674272216
Total norm for 4 adversaries is: 72.72400066991295. distance: 70.92872674272216
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  41, local model 3, internal_epoch   1,  Average loss: 0.0018, Accuracy: 891/923 (96.5330%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.3109, Accuracy: 8948/10000 (89.4800%)
___Train Local_Simple,  epoch  41, local model 23, internal_epoch   1,  Average loss: 0.0011, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1203, Accuracy: 9600/10000 (96.0000%)
___Train Local_Simple,  epoch  41, local model 44, internal_epoch   1,  Average loss: 0.0018, Accuracy: 501/517 (96.9052%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1398, Accuracy: 9605/10000 (96.0500%)
___Train Local_Simple,  epoch  41, local model 27, internal_epoch   1,  Average loss: 0.0016, Accuracy: 458/471 (97.2399%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2206, Accuracy: 9271/10000 (92.7100%)
___Train Local_Simple,  epoch  41, local model 86, internal_epoch   1,  Average loss: 0.0013, Accuracy: 245/250 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.0937, Accuracy: 9722/10000 (97.2200%)
___Train Local_Simple,  epoch  41, local model 37, internal_epoch   1,  Average loss: 0.0010, Accuracy: 838/860 (97.4419%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2330, Accuracy: 9270/10000 (92.7000%)
time spent on training: 123.34872651100159
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4119943222143364  data num: [606, 591, 568, 557, 923, 293, 517, 471, 250, 860]
[rfa agg] considering poison per batch poison_fraction: 0.12874822569198013
[rfa agg] init. name: [41, 73, 51, 74, 3, 23, 44, 27, 86, 37], weight: tensor([0.1075, 0.1049, 0.1008, 0.0988, 0.1638, 0.0520, 0.0917, 0.0836, 0.0444,
        0.1526])
[rfa agg] iter:  0, prev_obj_val: 35.60326385498047, obj_val: 31.706804275512695, abs dis: 3.8964595794677734
[rfa agg] iter:  0, weight: tensor([0.0426, 0.0460, 0.0558, 0.0441, 0.2251, 0.0719, 0.1264, 0.1152, 0.0613,
        0.2115])
[rfa agg] iter:  1, prev_obj_val: 31.706804275512695, obj_val: 30.173839569091797, abs dis: 1.5329647064208984
[rfa agg] iter:  1, weight: tensor([0.0199, 0.0217, 0.0259, 0.0205, 0.2514, 0.0813, 0.1418, 0.1296, 0.0692,
        0.2387])
[rfa agg] iter:  2, prev_obj_val: 30.173839569091797, obj_val: 29.538103103637695, abs dis: 0.6357364654541016
[rfa agg] iter:  2, weight: tensor([0.0095, 0.0104, 0.0122, 0.0098, 0.2600, 0.0866, 0.1487, 0.1365, 0.0736,
        0.2527])
[rfa agg] iter:  3, prev_obj_val: 29.538103103637695, obj_val: 29.313230514526367, abs dis: 0.22487258911132812
[rfa agg] iter:  3, weight: tensor([0.0049, 0.0053, 0.0062, 0.0050, 0.2556, 0.0923, 0.1520, 0.1407, 0.0783,
        0.2598])
[rfa agg] iter:  4, prev_obj_val: 29.313230514526367, obj_val: 29.261215209960938, abs dis: 0.05201530456542969
[rfa agg] iter:  4, weight: tensor([0.0030, 0.0032, 0.0037, 0.0030, 0.2400, 0.1022, 0.1545, 0.1448, 0.0866,
        0.2590])
[rfa agg] iter:  5, prev_obj_val: 29.261215209960938, obj_val: 29.254283905029297, abs dis: 0.006931304931640625
[rfa agg] iter:  5, weight: tensor([0.0023, 0.0025, 0.0029, 0.0024, 0.2236, 0.1134, 0.1568, 0.1480, 0.0961,
        0.2521])
[rfa agg] iter:  6, prev_obj_val: 29.254283905029297, obj_val: 29.25360870361328, abs dis: 0.000675201416015625
[rfa agg] iter:  6, weight: tensor([0.0021, 0.0023, 0.0027, 0.0022, 0.2140, 0.1203, 0.1584, 0.1495, 0.1018,
        0.2467])
[rfa agg] iter:  7, prev_obj_val: 29.25360870361328, obj_val: 29.253543853759766, abs dis: 6.4849853515625e-05
[rfa agg] iter:  7, weight: tensor([0.0021, 0.0022, 0.0026, 0.0021, 0.2098, 0.1232, 0.1593, 0.1501, 0.1042,
        0.2443])
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.0828, Accuracy: 9750/10000 (97.5000%)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 0.2541, Accuracy: 8182/8968 (91.2355%)
Done in 148.16576385498047 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:42 choose agents : [41, 73, 51, 74, 23, 35, 29, 48, 11, 43]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   1,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   2,  Average loss: 0.0009, Accuracy: 593/606 (97.8548%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   3,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   4,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   5,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   6,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Global model norm: 16.55282183328665.
Norm before scaling: 16.549971307919805. Distance: 0.7034755468734535
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1525, Accuracy: 9484/10000 (94.8400%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0295, Accuracy: 8877/8968 (98.9853%)
Scaling by  100
Scaled Norm after poisoning: 71.85996785741523, distance: 70.3475572325987
Total norm for 4 adversaries is: 71.85996785741523. distance: 70.3475572325987
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   1,  Average loss: 0.0007, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   3,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   4,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   5,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   7,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.55282183328665.
Norm before scaling: 16.545749932242796. Distance: 0.6905373755055277
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1346, Accuracy: 9565/10000 (95.6500%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0162, Accuracy: 8911/8968 (99.3644%)
Scaling by  100
Scaled Norm after poisoning: 70.5075904601767, distance: 69.05373954618605
Total norm for 4 adversaries is: 70.5075904601767. distance: 69.05373954618605
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 22915.6308, Accuracy: 4919/8968 (54.8506%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   1,  Average loss: 0.0008, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 16.55282183328665.
Norm before scaling: 16.528349594924208. Distance: 0.579139746811048
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2013, Accuracy: 9339/10000 (93.3900%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0120, Accuracy: 8929/8968 (99.5651%)
Scaling by  100
Scaled Norm after poisoning: 59.27498566664736, distance: 57.91397555386027
Total norm for 4 adversaries is: 59.27498566664736. distance: 57.91397555386027
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   1,  Average loss: 0.0012, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   2,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   3,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   4,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   5,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   6,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   9,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 16.55282183328665.
Norm before scaling: 16.56764826383457. Distance: 0.8307338144457357
will scale.
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1372, Accuracy: 9586/10000 (95.8600%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0024, Accuracy: 8959/8968 (99.8996%)
Scaling by  100
Scaled Norm after poisoning: 84.58885514098473, distance: 83.07337741512771
Total norm for 4 adversaries is: 84.58885514098473. distance: 83.07337741512771
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  42, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1496, Accuracy: 9480/10000 (94.8000%)
___Train Local_Simple,  epoch  42, local model 35, internal_epoch   1,  Average loss: 0.0009, Accuracy: 490/499 (98.1964%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1889, Accuracy: 9380/10000 (93.8000%)
___Train Local_Simple,  epoch  42, local model 29, internal_epoch   1,  Average loss: 0.0011, Accuracy: 980/1002 (97.8044%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3964, Accuracy: 8801/10000 (88.0100%)
___Train Local_Simple,  epoch  42, local model 48, internal_epoch   1,  Average loss: 0.0008, Accuracy: 440/448 (98.2143%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1008, Accuracy: 9695/10000 (96.9500%)
___Train Local_Simple,  epoch  42, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 631/645 (97.8295%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1720, Accuracy: 9416/10000 (94.1600%)
___Train Local_Simple,  epoch  42, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 401/408 (98.2843%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1815, Accuracy: 9428/10000 (94.2800%)
time spent on training: 129.70099711418152
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41338792949973296  data num: [606, 591, 568, 557, 293, 499, 1002, 448, 645, 408]
[rfa agg] considering poison per batch poison_fraction: 0.12918372796866656
[rfa agg] init. name: [41, 73, 51, 74, 23, 35, 29, 48, 11, 43], weight: tensor([0.1079, 0.1052, 0.1011, 0.0992, 0.0522, 0.0888, 0.1784, 0.0798, 0.1148,
        0.0726])
[rfa agg] iter:  0, prev_obj_val: 35.760398864746094, obj_val: 31.76880645751953, abs dis: 3.9915924072265625
[rfa agg] iter:  0, weight: tensor([0.0475, 0.0467, 0.0549, 0.0372, 0.0725, 0.1232, 0.2469, 0.1108, 0.1594,
        0.1009])
[rfa agg] iter:  1, prev_obj_val: 31.76880645751953, obj_val: 30.237030029296875, abs dis: 1.5317764282226562
[rfa agg] iter:  1, weight: tensor([0.0217, 0.0215, 0.0252, 0.0168, 0.0817, 0.1386, 0.2767, 0.1250, 0.1793,
        0.1136])
[rfa agg] iter:  2, prev_obj_val: 30.237030029296875, obj_val: 29.603910446166992, abs dis: 0.6331195831298828
[rfa agg] iter:  2, weight: tensor([0.0101, 0.0100, 0.0116, 0.0078, 0.0865, 0.1458, 0.2877, 0.1324, 0.1882,
        0.1198])
[rfa agg] iter:  3, prev_obj_val: 29.603910446166992, obj_val: 29.371755599975586, abs dis: 0.23215484619140625
[rfa agg] iter:  3, weight: tensor([0.0049, 0.0049, 0.0057, 0.0038, 0.0908, 0.1507, 0.2855, 0.1386, 0.1910,
        0.1240])
[rfa agg] iter:  4, prev_obj_val: 29.371755599975586, obj_val: 29.313661575317383, abs dis: 0.058094024658203125
[rfa agg] iter:  4, weight: tensor([0.0028, 0.0028, 0.0032, 0.0022, 0.0978, 0.1570, 0.2694, 0.1479, 0.1880,
        0.1287])
[rfa agg] iter:  5, prev_obj_val: 29.313661575317383, obj_val: 29.305269241333008, abs dis: 0.008392333984375
[rfa agg] iter:  5, weight: tensor([0.0021, 0.0021, 0.0024, 0.0016, 0.1063, 0.1644, 0.2479, 0.1584, 0.1816,
        0.1332])
[rfa agg] iter:  6, prev_obj_val: 29.305269241333008, obj_val: 29.30437660217285, abs dis: 0.00089263916015625
[rfa agg] iter:  6, weight: tensor([0.0019, 0.0019, 0.0022, 0.0015, 0.1115, 0.1694, 0.2330, 0.1653, 0.1773,
        0.1362])
[rfa agg] iter:  7, prev_obj_val: 29.30437660217285, obj_val: 29.30426788330078, abs dis: 0.0001087188720703125
[rfa agg] iter:  7, weight: tensor([0.0018, 0.0018, 0.0021, 0.0014, 0.1138, 0.1717, 0.2256, 0.1687, 0.1754,
        0.1377])
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.0811, Accuracy: 9754/10000 (97.5400%)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 0.2326, Accuracy: 8254/8968 (92.0384%)
Done in 157.27494835853577 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:43 choose agents : [41, 73, 51, 74, 33, 12, 97, 15, 42, 20]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   1,  Average loss: 0.0009, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   2,  Average loss: 0.0005, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   3,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   4,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.550339174972837.
Norm before scaling: 16.555277390386916. Distance: 0.7128201384513483
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1942, Accuracy: 9335/10000 (93.3500%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0210, Accuracy: 8904/8968 (99.2864%)
Scaling by  100
Scaled Norm after poisoning: 72.94230315697298, distance: 71.28201720323646
Total norm for 4 adversaries is: 72.94230315697298. distance: 71.28201720323646
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 34.2196, Accuracy: 8928/8968 (99.5540%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   3,  Average loss: 0.0003, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   4,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   5,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   7,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.550339174972837.
Norm before scaling: 16.55379525084901. Distance: 0.661463915183077
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1230, Accuracy: 9605/10000 (96.0500%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0127, Accuracy: 8920/8968 (99.4648%)
Scaling by  100
Scaled Norm after poisoning: 67.9481254627841, distance: 66.14638861315484
Total norm for 4 adversaries is: 67.9481254627841. distance: 66.14638861315484
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 177533.9953, Accuracy: 283/8968 (3.1557%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   1,  Average loss: 0.0006, Accuracy: 559/568 (98.4155%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.550339174972837.
Norm before scaling: 16.531419836084105. Distance: 0.5794901067055481
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2118, Accuracy: 9297/10000 (92.9700%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0122, Accuracy: 8926/8968 (99.5317%)
Scaling by  100
Scaled Norm after poisoning: 59.46285441086309, distance: 57.94901112724013
Total norm for 4 adversaries is: 59.46285441086309. distance: 57.94901112724013
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 2.9089, Accuracy: 8956/8968 (99.8662%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   1,  Average loss: 0.0012, Accuracy: 541/557 (97.1275%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   2,  Average loss: 0.0008, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   3,  Average loss: 0.0006, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   4,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   7,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   8,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 16.550339174972837.
Norm before scaling: 16.552286244855743. Distance: 0.7672442615278277
will scale.
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1386, Accuracy: 9564/10000 (95.6400%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0046, Accuracy: 8954/8968 (99.8439%)
Scaling by  100
Scaled Norm after poisoning: 78.15453504216022, distance: 76.72441743323145
Total norm for 4 adversaries is: 78.15453504216022. distance: 76.72441743323145
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  43, local model 33, internal_epoch   1,  Average loss: 0.0014, Accuracy: 602/623 (96.6292%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1446, Accuracy: 9510/10000 (95.1000%)
___Train Local_Simple,  epoch  43, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1130/1160 (97.4138%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2789, Accuracy: 9228/10000 (92.2800%)
___Train Local_Simple,  epoch  43, local model 97, internal_epoch   1,  Average loss: 0.0012, Accuracy: 475/487 (97.5359%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2054, Accuracy: 9321/10000 (93.2100%)
___Train Local_Simple,  epoch  43, local model 15, internal_epoch   1,  Average loss: 0.0012, Accuracy: 391/401 (97.5062%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1408, Accuracy: 9522/10000 (95.2200%)
___Train Local_Simple,  epoch  43, local model 42, internal_epoch   1,  Average loss: 0.0013, Accuracy: 230/236 (97.4576%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0939, Accuracy: 9704/10000 (97.0400%)
___Train Local_Simple,  epoch  43, local model 20, internal_epoch   1,  Average loss: 0.0012, Accuracy: 421/429 (98.1352%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2355, Accuracy: 9240/10000 (92.4000%)
time spent on training: 128.50620007514954
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41039236479321317  data num: [606, 591, 568, 557, 623, 1160, 487, 401, 236, 429]
[rfa agg] considering poison per batch poison_fraction: 0.12824761399787912
[rfa agg] init. name: [41, 73, 51, 74, 33, 12, 97, 15, 42, 20], weight: tensor([0.1071, 0.1045, 0.1004, 0.0984, 0.1101, 0.2050, 0.0861, 0.0709, 0.0417,
        0.0758])
[rfa agg] iter:  0, prev_obj_val: 34.52298355102539, obj_val: 30.633098602294922, abs dis: 3.8898849487304688
[rfa agg] iter:  0, weight: tensor([0.0444, 0.0463, 0.0522, 0.0379, 0.1527, 0.2842, 0.1195, 0.0986, 0.0582,
        0.1060])
[rfa agg] iter:  1, prev_obj_val: 30.633098602294922, obj_val: 29.158369064331055, abs dis: 1.4747295379638672
[rfa agg] iter:  1, weight: tensor([0.0199, 0.0210, 0.0235, 0.0170, 0.1708, 0.3176, 0.1340, 0.1109, 0.0657,
        0.1198])
[rfa agg] iter:  2, prev_obj_val: 29.158369064331055, obj_val: 28.57382583618164, abs dis: 0.5845432281494141
[rfa agg] iter:  2, weight: tensor([0.0092, 0.0097, 0.0107, 0.0079, 0.1780, 0.3292, 0.1403, 0.1172, 0.0700,
        0.1278])
[rfa agg] iter:  3, prev_obj_val: 28.57382583618164, obj_val: 28.383275985717773, abs dis: 0.1905498504638672
[rfa agg] iter:  3, weight: tensor([0.0046, 0.0048, 0.0053, 0.0039, 0.1800, 0.3254, 0.1428, 0.1229, 0.0749,
        0.1353])
[rfa agg] iter:  4, prev_obj_val: 28.383275985717773, obj_val: 28.34563446044922, abs dis: 0.03764152526855469
[rfa agg] iter:  4, weight: tensor([0.0028, 0.0030, 0.0033, 0.0024, 0.1801, 0.3080, 0.1438, 0.1310, 0.0828,
        0.1429])
[rfa agg] iter:  5, prev_obj_val: 28.34563446044922, obj_val: 28.341440200805664, abs dis: 0.0041942596435546875
[rfa agg] iter:  5, weight: tensor([0.0023, 0.0024, 0.0026, 0.0020, 0.1812, 0.2887, 0.1449, 0.1388, 0.0902,
        0.1470])
[rfa agg] iter:  6, prev_obj_val: 28.341440200805664, obj_val: 28.341001510620117, abs dis: 0.000438690185546875
[rfa agg] iter:  6, weight: tensor([0.0021, 0.0023, 0.0025, 0.0018, 0.1828, 0.2759, 0.1463, 0.1434, 0.0943,
        0.1486])
[rfa agg] iter:  7, prev_obj_val: 28.341001510620117, obj_val: 28.340930938720703, abs dis: 7.05718994140625e-05
[rfa agg] iter:  7, weight: tensor([0.0021, 0.0022, 0.0024, 0.0018, 0.1839, 0.2692, 0.1472, 0.1456, 0.0962,
        0.1494])
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.0799, Accuracy: 9752/10000 (97.5200%)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 0.2067, Accuracy: 8319/8968 (92.7632%)
Done in 154.15340876579285 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:44 choose agents : [41, 73, 51, 74, 90, 56, 54, 24, 38, 43]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   1,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   2,  Average loss: 0.0005, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   3,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   6,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.547916080622603.
Norm before scaling: 16.544148884263812. Distance: 0.6861181894465779
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1541, Accuracy: 9486/10000 (94.8600%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0211, Accuracy: 8899/8968 (99.2306%)
Scaling by  100
Scaled Norm after poisoning: 70.15604120236189, distance: 68.61181780836849
Total norm for 4 adversaries is: 70.15604120236189. distance: 68.61181780836849
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 5079.6018, Accuracy: 6774/8968 (75.5352%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   1,  Average loss: 0.0008, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   2,  Average loss: 0.0005, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.547916080622603.
Norm before scaling: 16.535983527468304. Distance: 0.6817156906111741
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1325, Accuracy: 9577/10000 (95.7700%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0097, Accuracy: 8929/8968 (99.5651%)
Scaling by  100
Scaled Norm after poisoning: 69.53591978700649, distance: 68.17156522104726
Total norm for 4 adversaries is: 69.53591978700649. distance: 68.17156522104726
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 202305.8582, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   1,  Average loss: 0.0006, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.547916080622603.
Norm before scaling: 16.522157530211512. Distance: 0.5493275823515863
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2119, Accuracy: 9295/10000 (92.9500%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0084, Accuracy: 8939/8968 (99.6766%)
Scaling by  100
Scaled Norm after poisoning: 56.35671517843393, distance: 54.93276030108878
Total norm for 4 adversaries is: 56.35671517843393. distance: 54.93276030108878
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   1,  Average loss: 0.0009, Accuracy: 546/557 (98.0251%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   2,  Average loss: 0.0008, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.547916080622603.
Norm before scaling: 16.53735930944501. Distance: 0.7295874108360879
will scale.
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1551, Accuracy: 9520/10000 (95.2000%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0048, Accuracy: 8953/8968 (99.8327%)
Scaling by  100
Scaled Norm after poisoning: 74.22028287890717, distance: 72.95874195285819
Total norm for 4 adversaries is: 74.22028287890717. distance: 72.95874195285819
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  44, local model 90, internal_epoch   1,  Average loss: 0.0020, Accuracy: 663/683 (97.0717%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2805, Accuracy: 9055/10000 (90.5500%)
___Train Local_Simple,  epoch  44, local model 56, internal_epoch   1,  Average loss: 0.0012, Accuracy: 862/880 (97.9545%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1641, Accuracy: 9459/10000 (94.5900%)
___Train Local_Simple,  epoch  44, local model 54, internal_epoch   1,  Average loss: 0.0015, Accuracy: 503/519 (96.9171%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2785, Accuracy: 9135/10000 (91.3500%)
___Train Local_Simple,  epoch  44, local model 24, internal_epoch   1,  Average loss: 0.0017, Accuracy: 364/379 (96.0422%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1152, Accuracy: 9655/10000 (96.5500%)
___Train Local_Simple,  epoch  44, local model 38, internal_epoch   1,  Average loss: 0.0013, Accuracy: 869/895 (97.0950%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1292, Accuracy: 9590/10000 (95.9000%)
___Train Local_Simple,  epoch  44, local model 43, internal_epoch   1,  Average loss: 0.0009, Accuracy: 399/408 (97.7941%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1785, Accuracy: 9405/10000 (94.0500%)
time spent on training: 117.74569702148438
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.38153138350312193  data num: [606, 591, 568, 557, 683, 880, 519, 379, 895, 408]
[rfa agg] considering poison per batch poison_fraction: 0.11922855734472561
[rfa agg] init. name: [41, 73, 51, 74, 90, 56, 54, 24, 38, 43], weight: tensor([0.0996, 0.0971, 0.0933, 0.0915, 0.1122, 0.1446, 0.0853, 0.0623, 0.1471,
        0.0670])
[rfa agg] iter:  0, prev_obj_val: 31.90353012084961, obj_val: 27.77247428894043, abs dis: 4.13105583190918
[rfa agg] iter:  0, weight: tensor([0.0379, 0.0363, 0.0453, 0.0326, 0.1534, 0.1981, 0.1176, 0.0856, 0.2011,
        0.0920])
[rfa agg] iter:  1, prev_obj_val: 27.77247428894043, obj_val: 26.318151473999023, abs dis: 1.4543228149414062
[rfa agg] iter:  1, weight: tensor([0.0152, 0.0148, 0.0181, 0.0131, 0.1689, 0.2193, 0.1314, 0.0953, 0.2219,
        0.1021])
[rfa agg] iter:  2, prev_obj_val: 26.318151473999023, obj_val: 25.82822608947754, abs dis: 0.4899253845214844
[rfa agg] iter:  2, weight: tensor([0.0063, 0.0062, 0.0075, 0.0055, 0.1731, 0.2270, 0.1387, 0.1008, 0.2278,
        0.1071])
[rfa agg] iter:  3, prev_obj_val: 25.82822608947754, obj_val: 25.718751907348633, abs dis: 0.10947418212890625
[rfa agg] iter:  3, weight: tensor([0.0031, 0.0030, 0.0036, 0.0027, 0.1713, 0.2276, 0.1419, 0.1087, 0.2252,
        0.1129])
[rfa agg] iter:  4, prev_obj_val: 25.718751907348633, obj_val: 25.707866668701172, abs dis: 0.010885238647460938
[rfa agg] iter:  4, weight: tensor([0.0022, 0.0021, 0.0025, 0.0019, 0.1689, 0.2248, 0.1387, 0.1187, 0.2199,
        0.1203])
[rfa agg] iter:  5, prev_obj_val: 25.707866668701172, obj_val: 25.707359313964844, abs dis: 0.000507354736328125
[rfa agg] iter:  5, weight: tensor([0.0020, 0.0019, 0.0023, 0.0017, 0.1683, 0.2228, 0.1356, 0.1240, 0.2172,
        0.1243])
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.0792, Accuracy: 9757/10000 (97.5700%)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 0.1976, Accuracy: 8352/8968 (93.1311%)
Done in 144.07866072654724 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:45 choose agents : [41, 73, 51, 74, 32, 62, 8, 35, 96, 27]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   1,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   2,  Average loss: 0.0006, Accuracy: 596/606 (98.3498%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   3,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 16.544200533391226.
Norm before scaling: 16.545501853730425. Distance: 0.6958909789399539
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1793, Accuracy: 9387/10000 (93.8700%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0175, Accuracy: 8909/8968 (99.3421%)
Scaling by  100
Scaled Norm after poisoning: 71.21963785646659, distance: 69.58910163528661
Total norm for 4 adversaries is: 71.21963785646659. distance: 69.58910163528661
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   1,  Average loss: 0.0006, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   2,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   3,  Average loss: 0.0004, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   4,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   5,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Global model norm: 16.544200533391226.
Norm before scaling: 16.53942507426148. Distance: 0.7487868988676094
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1421, Accuracy: 9542/10000 (95.4200%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0194, Accuracy: 8906/8968 (99.3087%)
Scaling by  100
Scaled Norm after poisoning: 76.21456976544084, distance: 74.8786909566066
Total norm for 4 adversaries is: 76.21456976544084. distance: 74.8786909566066
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 446237.3903, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0007, Accuracy: 560/568 (98.5915%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.544200533391226.
Norm before scaling: 16.525734917115827. Distance: 0.5695353922542855
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2008, Accuracy: 9334/10000 (93.3400%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0103, Accuracy: 8935/8968 (99.6320%)
Scaling by  100
Scaled Norm after poisoning: 58.51425857883914, distance: 56.953536521147
Total norm for 4 adversaries is: 58.51425857883914. distance: 56.953536521147
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   1,  Average loss: 0.0009, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   2,  Average loss: 0.0007, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   4,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.544200533391226.
Norm before scaling: 16.537333474218265. Distance: 0.7038594542602031
will scale.
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1504, Accuracy: 9537/10000 (95.3700%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0032, Accuracy: 8957/8968 (99.8773%)
Scaling by  100
Scaled Norm after poisoning: 71.80274901161515, distance: 70.38594774971067
Total norm for 4 adversaries is: 71.80274901161515. distance: 70.38594774971067
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  45, local model 32, internal_epoch   1,  Average loss: 0.0020, Accuracy: 940/977 (96.2129%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3148, Accuracy: 8916/10000 (89.1600%)
___Train Local_Simple,  epoch  45, local model 62, internal_epoch   1,  Average loss: 0.0012, Accuracy: 411/423 (97.1631%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.0928, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch  45, local model 8, internal_epoch   1,  Average loss: 0.0020, Accuracy: 602/633 (95.1027%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1467, Accuracy: 9549/10000 (95.4900%)
___Train Local_Simple,  epoch  45, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 491/499 (98.3968%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2455, Accuracy: 9195/10000 (91.9500%)
___Train Local_Simple,  epoch  45, local model 96, internal_epoch   1,  Average loss: 0.0014, Accuracy: 659/672 (98.0655%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2018, Accuracy: 9323/10000 (93.2300%)
___Train Local_Simple,  epoch  45, local model 27, internal_epoch   1,  Average loss: 0.0016, Accuracy: 460/471 (97.6645%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2806, Accuracy: 9065/10000 (90.6500%)
time spent on training: 123.25453543663025
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3871935967983992  data num: [606, 591, 568, 557, 977, 423, 633, 499, 672, 471]
[rfa agg] considering poison per batch poison_fraction: 0.12099799899949976
[rfa agg] init. name: [41, 73, 51, 74, 32, 62, 8, 35, 96, 27], weight: tensor([0.1011, 0.0985, 0.0947, 0.0929, 0.1629, 0.0705, 0.1056, 0.0832, 0.1121,
        0.0785])
[rfa agg] iter:  0, prev_obj_val: 33.058006286621094, obj_val: 28.84398078918457, abs dis: 4.214025497436523
[rfa agg] iter:  0, weight: tensor([0.0381, 0.0340, 0.0444, 0.0349, 0.2239, 0.0985, 0.1460, 0.1158, 0.1555,
        0.1089])
[rfa agg] iter:  1, prev_obj_val: 28.84398078918457, obj_val: 27.39337921142578, abs dis: 1.450601577758789
[rfa agg] iter:  1, weight: tensor([0.0151, 0.0136, 0.0176, 0.0138, 0.2444, 0.1107, 0.1614, 0.1294, 0.1729,
        0.1210])
[rfa agg] iter:  2, prev_obj_val: 27.39337921142578, obj_val: 26.909130096435547, abs dis: 0.4842491149902344
[rfa agg] iter:  2, weight: tensor([0.0062, 0.0056, 0.0072, 0.0057, 0.2428, 0.1200, 0.1664, 0.1379, 0.1821,
        0.1261])
[rfa agg] iter:  3, prev_obj_val: 26.909130096435547, obj_val: 26.798748016357422, abs dis: 0.110382080078125
[rfa agg] iter:  3, weight: tensor([0.0030, 0.0027, 0.0034, 0.0027, 0.2196, 0.1351, 0.1642, 0.1497, 0.1927,
        0.1268])
[rfa agg] iter:  4, prev_obj_val: 26.798748016357422, obj_val: 26.786216735839844, abs dis: 0.012531280517578125
[rfa agg] iter:  4, weight: tensor([0.0020, 0.0018, 0.0023, 0.0018, 0.1906, 0.1524, 0.1581, 0.1633, 0.2049,
        0.1228])
[rfa agg] iter:  5, prev_obj_val: 26.786216735839844, obj_val: 26.785287857055664, abs dis: 0.0009288787841796875
[rfa agg] iter:  5, weight: tensor([0.0018, 0.0016, 0.0020, 0.0016, 0.1747, 0.1604, 0.1546, 0.1718, 0.2123,
        0.1192])
[rfa agg] iter:  6, prev_obj_val: 26.785287857055664, obj_val: 26.785215377807617, abs dis: 7.2479248046875e-05
[rfa agg] iter:  6, weight: tensor([0.0017, 0.0016, 0.0020, 0.0016, 0.1686, 0.1630, 0.1533, 0.1755, 0.2152,
        0.1176])
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.0780, Accuracy: 9765/10000 (97.6500%)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 0.1873, Accuracy: 8382/8968 (93.4657%)
Done in 145.23896980285645 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:46 choose agents : [41, 73, 51, 74, 58, 86, 89, 17, 80, 63]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   1,  Average loss: 0.0009, Accuracy: 595/606 (98.1848%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   2,  Average loss: 0.0008, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   3,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   5,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   6,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.54108377321686.
Norm before scaling: 16.537424820017605. Distance: 0.7076693863848644
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1438, Accuracy: 9506/10000 (95.0600%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0228, Accuracy: 8898/8968 (99.2194%)
Scaling by  100
Scaled Norm after poisoning: 72.24530964446758, distance: 70.76693770862386
Total norm for 4 adversaries is: 72.24530964446758. distance: 70.76693770862386
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 33.1766, Accuracy: 8929/8968 (99.5651%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   1,  Average loss: 0.0006, Accuracy: 583/591 (98.6464%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   4,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.54108377321686.
Norm before scaling: 16.540307950862797. Distance: 0.7565162426477452
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1448, Accuracy: 9531/10000 (95.3100%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0036, Accuracy: 8956/8968 (99.8662%)
Scaling by  100
Scaled Norm after poisoning: 77.05180063093107, distance: 75.65162238015785
Total norm for 4 adversaries is: 77.05180063093107. distance: 75.65162238015785
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 100274.3152, Accuracy: 2142/8968 (23.8849%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.54108377321686.
Norm before scaling: 16.522333000910276. Distance: 0.5666177026079728
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2171, Accuracy: 9296/10000 (92.9600%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0125, Accuracy: 8927/8968 (99.5428%)
Scaling by  100
Scaled Norm after poisoning: 58.22423694285847, distance: 56.66176760570681
Total norm for 4 adversaries is: 58.22423694285847. distance: 56.66176760570681
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   1,  Average loss: 0.0011, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   4,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 16.54108377321686.
Norm before scaling: 16.552658669627764. Distance: 0.753795991256775
will scale.
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1566, Accuracy: 9516/10000 (95.1600%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0043, Accuracy: 8955/8968 (99.8550%)
Scaling by  100
Scaled Norm after poisoning: 77.05309021017587, distance: 75.37960249733511
Total norm for 4 adversaries is: 77.05309021017587. distance: 75.37960249733511
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  46, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 266/276 (96.3768%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1330, Accuracy: 9580/10000 (95.8000%)
___Train Local_Simple,  epoch  46, local model 86, internal_epoch   1,  Average loss: 0.0012, Accuracy: 244/250 (97.6000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0958, Accuracy: 9701/10000 (97.0100%)
___Train Local_Simple,  epoch  46, local model 89, internal_epoch   1,  Average loss: 0.0006, Accuracy: 485/492 (98.5772%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1397, Accuracy: 9563/10000 (95.6300%)
___Train Local_Simple,  epoch  46, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 605/620 (97.5806%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1290, Accuracy: 9594/10000 (95.9400%)
___Train Local_Simple,  epoch  46, local model 80, internal_epoch   1,  Average loss: 0.0008, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2185, Accuracy: 9303/10000 (93.0300%)
___Train Local_Simple,  epoch  46, local model 63, internal_epoch   1,  Average loss: 0.0018, Accuracy: 855/889 (96.1755%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1465, Accuracy: 9526/10000 (95.2600%)
time spent on training: 121.91427683830261
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.43977272727272726  data num: [606, 591, 568, 557, 276, 250, 492, 620, 431, 889]
[rfa agg] considering poison per batch poison_fraction: 0.13742897727272727
[rfa agg] init. name: [41, 73, 51, 74, 58, 86, 89, 17, 80, 63], weight: tensor([0.1148, 0.1119, 0.1076, 0.1055, 0.0523, 0.0473, 0.0932, 0.1174, 0.0816,
        0.1684])
[rfa agg] iter:  0, prev_obj_val: 37.02425765991211, obj_val: 33.30701446533203, abs dis: 3.717243194580078
[rfa agg] iter:  0, weight: tensor([0.0513, 0.0469, 0.0597, 0.0447, 0.0742, 0.0674, 0.1332, 0.1666, 0.1159,
        0.2400])
[rfa agg] iter:  1, prev_obj_val: 33.30701446533203, obj_val: 31.894203186035156, abs dis: 1.412811279296875
[rfa agg] iter:  1, weight: tensor([0.0244, 0.0222, 0.0290, 0.0211, 0.0838, 0.0764, 0.1520, 0.1878, 0.1308,
        0.2726])
[rfa agg] iter:  2, prev_obj_val: 31.894203186035156, obj_val: 31.29102325439453, abs dis: 0.603179931640625
[rfa agg] iter:  2, weight: tensor([0.0119, 0.0108, 0.0140, 0.0103, 0.0879, 0.0807, 0.1626, 0.1963, 0.1373,
        0.2882])
[rfa agg] iter:  3, prev_obj_val: 31.29102325439453, obj_val: 31.05122184753418, abs dis: 0.23980140686035156
[rfa agg] iter:  3, weight: tensor([0.0061, 0.0055, 0.0071, 0.0052, 0.0892, 0.0837, 0.1715, 0.1979, 0.1397,
        0.2941])
[rfa agg] iter:  4, prev_obj_val: 31.05122184753418, obj_val: 30.980968475341797, abs dis: 0.07025337219238281
[rfa agg] iter:  4, weight: tensor([0.0035, 0.0032, 0.0041, 0.0030, 0.0891, 0.0877, 0.1823, 0.1960, 0.1414,
        0.2898])
[rfa agg] iter:  5, prev_obj_val: 30.980968475341797, obj_val: 30.968772888183594, abs dis: 0.012195587158203125
[rfa agg] iter:  5, weight: tensor([0.0025, 0.0023, 0.0029, 0.0022, 0.0890, 0.0935, 0.1923, 0.1946, 0.1446,
        0.2761])
[rfa agg] iter:  6, prev_obj_val: 30.968772888183594, obj_val: 30.967384338378906, abs dis: 0.0013885498046875
[rfa agg] iter:  6, weight: tensor([0.0022, 0.0020, 0.0026, 0.0019, 0.0893, 0.0981, 0.1978, 0.1950, 0.1481,
        0.2629])
[rfa agg] iter:  7, prev_obj_val: 30.967384338378906, obj_val: 30.967233657836914, abs dis: 0.0001506805419921875
[rfa agg] iter:  7, weight: tensor([0.0021, 0.0019, 0.0025, 0.0018, 0.0894, 0.1005, 0.2005, 0.1958, 0.1503,
        0.2550])
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.0777, Accuracy: 9755/10000 (97.5500%)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 0.1587, Accuracy: 8473/8968 (94.4804%)
Done in 149.05423045158386 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:47 choose agents : [41, 73, 51, 74, 58, 26, 90, 89, 93, 79]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   1,  Average loss: 0.0007, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 16.538395453305675.
Norm before scaling: 16.535383720824925. Distance: 0.683616681395513
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1934, Accuracy: 9369/10000 (93.6900%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0303, Accuracy: 8883/8968 (99.0522%)
Scaling by  100
Scaled Norm after poisoning: 69.92956137920143, distance: 68.3616696043459
Total norm for 4 adversaries is: 69.92956137920143. distance: 68.3616696043459
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 113165.5922, Accuracy: 33/8968 (0.3680%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   1,  Average loss: 0.0009, Accuracy: 582/591 (98.4772%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.538395453305675.
Norm before scaling: 16.529072436035335. Distance: 0.7183297213915703
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1370, Accuracy: 9563/10000 (95.6300%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0046, Accuracy: 8951/8968 (99.8104%)
Scaling by  100
Scaled Norm after poisoning: 73.15101033136862, distance: 71.83297344687014
Total norm for 4 adversaries is: 73.15101033136862. distance: 71.83297344687014
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 500128.8745, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 16.538395453305675.
Norm before scaling: 16.519816203353418. Distance: 0.44658165486860235
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2153, Accuracy: 9301/10000 (93.0100%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0146, Accuracy: 8925/8968 (99.5205%)
Scaling by  100
Scaled Norm after poisoning: 46.76010920111286, distance: 44.658163447459415
Total norm for 4 adversaries is: 46.76010920111286. distance: 44.658163447459415
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 17194.9534, Accuracy: 560/8968 (6.2444%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   1,  Average loss: 0.0009, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   2,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   4,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   5,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   7,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Global model norm: 16.538395453305675.
Norm before scaling: 16.52738114138408. Distance: 0.6324838561986974
will scale.
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1417, Accuracy: 9557/10000 (95.5700%)
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0046, Accuracy: 8952/8968 (99.8216%)
Scaling by  100
Scaled Norm after poisoning: 64.78775820539903, distance: 63.24838459831899
Total norm for 4 adversaries is: 64.78775820539903. distance: 63.24838459831899
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  47, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 266/276 (96.3768%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1761, Accuracy: 9429/10000 (94.2900%)
___Train Local_Simple,  epoch  47, local model 26, internal_epoch   1,  Average loss: 0.0011, Accuracy: 538/554 (97.1119%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0987, Accuracy: 9702/10000 (97.0200%)
___Train Local_Simple,  epoch  47, local model 90, internal_epoch   1,  Average loss: 0.0017, Accuracy: 665/683 (97.3646%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.4510, Accuracy: 8547/10000 (85.4700%)
___Train Local_Simple,  epoch  47, local model 89, internal_epoch   1,  Average loss: 0.0006, Accuracy: 485/492 (98.5772%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1225, Accuracy: 9615/10000 (96.1500%)
___Train Local_Simple,  epoch  47, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 621/623 (99.6790%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1547, Accuracy: 9505/10000 (95.0500%)
___Train Local_Simple,  epoch  47, local model 79, internal_epoch   1,  Average loss: 0.0018, Accuracy: 174/182 (95.6044%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0853, Accuracy: 9728/10000 (97.2800%)
time spent on training: 127.1537880897522
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4524551831644583  data num: [606, 591, 568, 557, 276, 554, 683, 492, 623, 182]
[rfa agg] considering poison per batch poison_fraction: 0.14139224473889322
[rfa agg] init. name: [41, 73, 51, 74, 58, 26, 90, 89, 93, 79], weight: tensor([0.1181, 0.1152, 0.1107, 0.1085, 0.0538, 0.1080, 0.1331, 0.0959, 0.1214,
        0.0355])
[rfa agg] iter:  0, prev_obj_val: 33.69605255126953, obj_val: 30.476383209228516, abs dis: 3.2196693420410156
[rfa agg] iter:  0, weight: tensor([0.0490, 0.0450, 0.0723, 0.0493, 0.0767, 0.1544, 0.1901, 0.1381, 0.1741,
        0.0509])
[rfa agg] iter:  1, prev_obj_val: 30.476383209228516, obj_val: 29.27443504333496, abs dis: 1.2019481658935547
[rfa agg] iter:  1, weight: tensor([0.0239, 0.0220, 0.0360, 0.0240, 0.0870, 0.1757, 0.2159, 0.1588, 0.1985,
        0.0583])
[rfa agg] iter:  2, prev_obj_val: 29.27443504333496, obj_val: 28.747528076171875, abs dis: 0.5269069671630859
[rfa agg] iter:  2, weight: tensor([0.0121, 0.0112, 0.0178, 0.0121, 0.0912, 0.1854, 0.2262, 0.1709, 0.2108,
        0.0623])
[rfa agg] iter:  3, prev_obj_val: 28.747528076171875, obj_val: 28.52610969543457, abs dis: 0.2214183807373047
[rfa agg] iter:  3, weight: tensor([0.0063, 0.0059, 0.0092, 0.0063, 0.0919, 0.1891, 0.2255, 0.1816, 0.2184,
        0.0657])
[rfa agg] iter:  4, prev_obj_val: 28.52610969543457, obj_val: 28.452333450317383, abs dis: 0.0737762451171875
[rfa agg] iter:  4, weight: tensor([0.0037, 0.0034, 0.0053, 0.0036, 0.0903, 0.1891, 0.2126, 0.1953, 0.2258,
        0.0710])
[rfa agg] iter:  5, prev_obj_val: 28.452333450317383, obj_val: 28.436126708984375, abs dis: 0.016206741333007812
[rfa agg] iter:  5, weight: tensor([0.0025, 0.0023, 0.0036, 0.0025, 0.0875, 0.1871, 0.1917, 0.2096, 0.2340,
        0.0791])
[rfa agg] iter:  6, prev_obj_val: 28.436126708984375, obj_val: 28.433734893798828, abs dis: 0.002391815185546875
[rfa agg] iter:  6, weight: tensor([0.0021, 0.0020, 0.0031, 0.0021, 0.0851, 0.1852, 0.1752, 0.2185, 0.2405,
        0.0862])
[rfa agg] iter:  7, prev_obj_val: 28.433734893798828, obj_val: 28.433441162109375, abs dis: 0.000293731689453125
[rfa agg] iter:  7, weight: tensor([0.0020, 0.0019, 0.0029, 0.0020, 0.0837, 0.1842, 0.1666, 0.2223, 0.2444,
        0.0899])
[rfa agg] iter:  8, prev_obj_val: 28.433441162109375, obj_val: 28.433406829833984, abs dis: 3.4332275390625e-05
[rfa agg] iter:  8, weight: tensor([0.0020, 0.0018, 0.0028, 0.0019, 0.0831, 0.1839, 0.1631, 0.2238, 0.2463,
        0.0914])
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.0780, Accuracy: 9758/10000 (97.5800%)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 0.1425, Accuracy: 8520/8968 (95.0045%)
Done in 156.06525540351868 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:48 choose agents : [41, 73, 51, 74, 36, 67, 87, 65, 30, 98]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   1,  Average loss: 0.0006, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   2,  Average loss: 0.0006, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 16.535703928001713.
Norm before scaling: 16.532544956074045. Distance: 0.6375421220289851
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1527, Accuracy: 9483/10000 (94.8300%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0241, Accuracy: 8898/8968 (99.2194%)
Scaling by  100
Scaled Norm after poisoning: 65.47472750158072, distance: 63.7542143980743
Total norm for 4 adversaries is: 65.47472750158072. distance: 63.7542143980743
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 9833.6526, Accuracy: 2821/8968 (31.4563%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   1,  Average loss: 0.0006, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   5,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.535703928001713.
Norm before scaling: 16.51727130808366. Distance: 0.647162275057594
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1316, Accuracy: 9568/10000 (95.6800%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0104, Accuracy: 8932/8968 (99.5986%)
Scaling by  100
Scaled Norm after poisoning: 66.02132186957672, distance: 64.71622248806709
Total norm for 4 adversaries is: 66.02132186957672. distance: 64.71622248806709
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 408170.4699, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   1,  Average loss: 0.0007, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.535703928001713.
Norm before scaling: 16.507218140329456. Distance: 0.5231903118804881
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1801, Accuracy: 9419/10000 (94.1900%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0073, Accuracy: 8943/8968 (99.7212%)
Scaling by  100
Scaled Norm after poisoning: 53.75141713248126, distance: 52.31902634394227
Total norm for 4 adversaries is: 53.75141713248126. distance: 52.31902634394227
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 22789.6095, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0010, Accuracy: 544/557 (97.6661%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   2,  Average loss: 0.0008, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   3,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 16.535703928001713.
Norm before scaling: 16.5281880360752. Distance: 0.6991826692787516
will scale.
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1422, Accuracy: 9567/10000 (95.6700%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0034, Accuracy: 8957/8968 (99.8773%)
Scaling by  100
Scaled Norm after poisoning: 71.3320559568505, distance: 69.9182663174921
Total norm for 4 adversaries is: 71.3320559568505. distance: 69.9182663174921
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 6789.4453, Accuracy: 5404/8968 (60.2587%)
___Train Local_Simple,  epoch  48, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 985/1005 (98.0100%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4128, Accuracy: 8678/10000 (86.7800%)
___Train Local_Simple,  epoch  48, local model 67, internal_epoch   1,  Average loss: 0.0012, Accuracy: 974/998 (97.5952%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3100, Accuracy: 9034/10000 (90.3400%)
___Train Local_Simple,  epoch  48, local model 87, internal_epoch   1,  Average loss: 0.0009, Accuracy: 463/470 (98.5106%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1388, Accuracy: 9559/10000 (95.5900%)
___Train Local_Simple,  epoch  48, local model 65, internal_epoch   1,  Average loss: 0.0009, Accuracy: 362/371 (97.5741%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1262, Accuracy: 9584/10000 (95.8400%)
___Train Local_Simple,  epoch  48, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 390/400 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1661, Accuracy: 9505/10000 (95.0500%)
___Train Local_Simple,  epoch  48, local model 98, internal_epoch   1,  Average loss: 0.0015, Accuracy: 791/818 (96.6993%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2920, Accuracy: 9072/10000 (90.7200%)
time spent on training: 118.48212265968323
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.36372180451127817  data num: [606, 591, 568, 557, 1005, 998, 470, 371, 400, 818]
[rfa agg] considering poison per batch poison_fraction: 0.11366306390977443
[rfa agg] init. name: [41, 73, 51, 74, 36, 67, 87, 65, 30, 98], weight: tensor([0.0949, 0.0926, 0.0890, 0.0872, 0.1574, 0.1563, 0.0736, 0.0581, 0.0627,
        0.1281])
[rfa agg] iter:  0, prev_obj_val: 29.003631591796875, obj_val: 24.883586883544922, abs dis: 4.120044708251953
[rfa agg] iter:  0, weight: tensor([0.0319, 0.0303, 0.0370, 0.0269, 0.2164, 0.2138, 0.1020, 0.0802, 0.0865,
        0.1750])
[rfa agg] iter:  1, prev_obj_val: 24.883586883544922, obj_val: 23.647306442260742, abs dis: 1.2362804412841797
[rfa agg] iter:  1, weight: tensor([0.0112, 0.0107, 0.0130, 0.0094, 0.2368, 0.2314, 0.1142, 0.0889, 0.0959,
        0.1885])
[rfa agg] iter:  2, prev_obj_val: 23.647306442260742, obj_val: 23.352519989013672, abs dis: 0.2947864532470703
[rfa agg] iter:  2, weight: tensor([0.0043, 0.0042, 0.0050, 0.0036, 0.2429, 0.2289, 0.1257, 0.0966, 0.1038,
        0.1850])
[rfa agg] iter:  3, prev_obj_val: 23.352519989013672, obj_val: 23.32103157043457, abs dis: 0.03148841857910156
[rfa agg] iter:  3, weight: tensor([0.0024, 0.0023, 0.0028, 0.0020, 0.2401, 0.2132, 0.1397, 0.1093, 0.1163,
        0.1720])
[rfa agg] iter:  4, prev_obj_val: 23.32103157043457, obj_val: 23.31977081298828, abs dis: 0.0012607574462890625
[rfa agg] iter:  4, weight: tensor([0.0020, 0.0020, 0.0023, 0.0017, 0.2361, 0.2030, 0.1456, 0.1179, 0.1243,
        0.1651])
[rfa agg] iter:  5, prev_obj_val: 23.31977081298828, obj_val: 23.319730758666992, abs dis: 4.00543212890625e-05
[rfa agg] iter:  5, weight: tensor([0.0020, 0.0019, 0.0023, 0.0017, 0.2342, 0.1995, 0.1476, 0.1208, 0.1270,
        0.1631])
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.0756, Accuracy: 9768/10000 (97.6800%)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 0.1520, Accuracy: 8492/8968 (94.6922%)
Done in 145.46391367912292 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:49 choose agents : [41, 73, 51, 74, 25, 54, 52, 46, 6, 35]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   1,  Average loss: 0.0006, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   2,  Average loss: 0.0005, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   3,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   5,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.53204286112607.
Norm before scaling: 16.52149441884817. Distance: 0.6429629579378203
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1617, Accuracy: 9440/10000 (94.4000%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0179, Accuracy: 8912/8968 (99.3756%)
Scaling by  100
Scaled Norm after poisoning: 65.81122387176826, distance: 64.29629594210697
Total norm for 4 adversaries is: 65.81122387176826. distance: 64.29629594210697
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   1,  Average loss: 0.0006, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.53204286112607.
Norm before scaling: 16.518065763945586. Distance: 0.6251005568673181
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1152, Accuracy: 9624/10000 (96.2400%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0168, Accuracy: 8911/8968 (99.3644%)
Scaling by  100
Scaled Norm after poisoning: 63.99643506611814, distance: 62.51005778447777
Total norm for 4 adversaries is: 63.99643506611814. distance: 62.51005778447777
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 253653.3178, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   1,  Average loss: 0.0006, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.53204286112607.
Norm before scaling: 16.505713196200713. Distance: 0.5412131269197978
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1708, Accuracy: 9437/10000 (94.3700%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0054, Accuracy: 8949/8968 (99.7881%)
Scaling by  100
Scaled Norm after poisoning: 55.55310047743735, distance: 54.121310136927576
Total norm for 4 adversaries is: 55.55310047743735. distance: 54.121310136927576
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0007, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   2,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   3,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 16.53204286112607.
Norm before scaling: 16.530762634592815. Distance: 0.6700240966392249
will scale.
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1278, Accuracy: 9597/10000 (95.9700%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0026, Accuracy: 8958/8968 (99.8885%)
Scaling by  100
Scaled Norm after poisoning: 68.65495916515245, distance: 67.00240856794814
Total norm for 4 adversaries is: 68.65495916515245. distance: 67.00240856794814
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  49, local model 25, internal_epoch   1,  Average loss: 0.0017, Accuracy: 629/647 (97.2179%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.4321, Accuracy: 8506/10000 (85.0600%)
___Train Local_Simple,  epoch  49, local model 54, internal_epoch   1,  Average loss: 0.0011, Accuracy: 508/519 (97.8805%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2871, Accuracy: 9055/10000 (90.5500%)
___Train Local_Simple,  epoch  49, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 250/253 (98.8142%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1436, Accuracy: 9548/10000 (95.4800%)
___Train Local_Simple,  epoch  49, local model 46, internal_epoch   1,  Average loss: 0.0014, Accuracy: 695/710 (97.8873%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2489, Accuracy: 9228/10000 (92.2800%)
___Train Local_Simple,  epoch  49, local model 6, internal_epoch   1,  Average loss: 0.0012, Accuracy: 599/615 (97.3984%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1710, Accuracy: 9424/10000 (94.2400%)
___Train Local_Simple,  epoch  49, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 492/499 (98.5972%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2366, Accuracy: 9225/10000 (92.2500%)
time spent on training: 113.22232127189636
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4172506738544474  data num: [606, 591, 568, 557, 647, 519, 253, 710, 615, 499]
[rfa agg] considering poison per batch poison_fraction: 0.1303908355795148
[rfa agg] init. name: [41, 73, 51, 74, 25, 54, 52, 46, 6, 35], weight: tensor([0.1089, 0.1062, 0.1021, 0.1001, 0.1163, 0.0933, 0.0455, 0.1276, 0.1105,
        0.0897])
[rfa agg] iter:  0, prev_obj_val: 31.746923446655273, obj_val: 28.22484588623047, abs dis: 3.5220775604248047
[rfa agg] iter:  0, weight: tensor([0.0445, 0.0445, 0.0502, 0.0396, 0.1641, 0.1319, 0.0642, 0.1794, 0.1553,
        0.1263])
[rfa agg] iter:  1, prev_obj_val: 28.22484588623047, obj_val: 26.93088722229004, abs dis: 1.2939586639404297
[rfa agg] iter:  1, weight: tensor([0.0197, 0.0197, 0.0223, 0.0174, 0.1845, 0.1487, 0.0721, 0.2004, 0.1737,
        0.1415])
[rfa agg] iter:  2, prev_obj_val: 26.93088722229004, obj_val: 26.436107635498047, abs dis: 0.4947795867919922
[rfa agg] iter:  2, weight: tensor([0.0090, 0.0090, 0.0101, 0.0079, 0.1930, 0.1570, 0.0764, 0.2080, 0.1813,
        0.1483])
[rfa agg] iter:  3, prev_obj_val: 26.436107635498047, obj_val: 26.28602409362793, abs dis: 0.1500835418701172
[rfa agg] iter:  3, weight: tensor([0.0045, 0.0045, 0.0050, 0.0040, 0.1927, 0.1610, 0.0812, 0.2079, 0.1860,
        0.1532])
[rfa agg] iter:  4, prev_obj_val: 26.28602409362793, obj_val: 26.25989532470703, abs dis: 0.026128768920898438
[rfa agg] iter:  4, weight: tensor([0.0029, 0.0029, 0.0032, 0.0025, 0.1835, 0.1598, 0.0893, 0.2037, 0.1927,
        0.1595])
[rfa agg] iter:  5, prev_obj_val: 26.25989532470703, obj_val: 26.257463455200195, abs dis: 0.0024318695068359375
[rfa agg] iter:  5, weight: tensor([0.0024, 0.0024, 0.0027, 0.0021, 0.1740, 0.1563, 0.0961, 0.2000, 0.1989,
        0.1651])
[rfa agg] iter:  6, prev_obj_val: 26.257463455200195, obj_val: 26.25729751586914, abs dis: 0.0001659393310546875
[rfa agg] iter:  6, weight: tensor([0.0023, 0.0023, 0.0026, 0.0020, 0.1693, 0.1543, 0.0990, 0.1982, 0.2021,
        0.1679])
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.0759, Accuracy: 9769/10000 (97.6900%)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 0.1344, Accuracy: 8556/8968 (95.4059%)
Done in 142.7336676120758 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:50 choose agents : [41, 73, 51, 74, 17, 20, 77, 44, 8, 78]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   1,  Average loss: 0.0007, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.52891088425161.
Norm before scaling: 16.523362699298776. Distance: 0.6221465299137217
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1597, Accuracy: 9449/10000 (94.4900%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0227, Accuracy: 8899/8968 (99.2306%)
Scaling by  100
Scaled Norm after poisoning: 63.928270197689145, distance: 62.214655267694965
Total norm for 4 adversaries is: 63.928270197689145. distance: 62.214655267694965
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 169285.9002, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   1,  Average loss: 0.0006, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   2,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.52891088425161.
Norm before scaling: 16.51038565487361. Distance: 0.585001999778264
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1164, Accuracy: 9614/10000 (96.1400%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0148, Accuracy: 8924/8968 (99.5094%)
Scaling by  100
Scaled Norm after poisoning: 60.00040283067898, distance: 58.50019614683997
Total norm for 4 adversaries is: 60.00040283067898. distance: 58.50019614683997
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 380754.1669, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 16.52891088425161.
Norm before scaling: 16.502838815332463. Distance: 0.4683451493674346
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2078, Accuracy: 9315/10000 (93.1500%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0108, Accuracy: 8930/8968 (99.5763%)
Scaling by  100
Scaled Norm after poisoning: 48.56562188324422, distance: 46.83451376589171
Total norm for 4 adversaries is: 48.56562188324422. distance: 46.83451376589171
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   1,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   2,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   4,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.52891088425161.
Norm before scaling: 16.5195880563282. Distance: 0.6094570104726734
will scale.
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1338, Accuracy: 9593/10000 (95.9300%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0040, Accuracy: 8952/8968 (99.8216%)
Scaling by  100
Scaled Norm after poisoning: 62.60695340962037, distance: 60.945698567069726
Total norm for 4 adversaries is: 62.60695340962037. distance: 60.945698567069726
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 605/620 (97.5806%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1222, Accuracy: 9611/10000 (96.1100%)
___Train Local_Simple,  epoch  50, local model 20, internal_epoch   1,  Average loss: 0.0011, Accuracy: 419/429 (97.6690%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2516, Accuracy: 9189/10000 (91.8900%)
___Train Local_Simple,  epoch  50, local model 77, internal_epoch   1,  Average loss: 0.0013, Accuracy: 575/589 (97.6231%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1467, Accuracy: 9537/10000 (95.3700%)
___Train Local_Simple,  epoch  50, local model 44, internal_epoch   1,  Average loss: 0.0018, Accuracy: 501/517 (96.9052%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1685, Accuracy: 9501/10000 (95.0100%)
___Train Local_Simple,  epoch  50, local model 8, internal_epoch   1,  Average loss: 0.0017, Accuracy: 615/633 (97.1564%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1839, Accuracy: 9419/10000 (94.1900%)
___Train Local_Simple,  epoch  50, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 296/303 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.3477, Accuracy: 8821/10000 (88.2100%)
time spent on training: 117.76195406913757
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4289673009421762  data num: [606, 591, 568, 557, 620, 429, 589, 517, 633, 303]
[rfa agg] considering poison per batch poison_fraction: 0.13405228154443008
[rfa agg] init. name: [41, 73, 51, 74, 17, 20, 77, 44, 8, 78], weight: tensor([0.1120, 0.1092, 0.1049, 0.1029, 0.1145, 0.0793, 0.1088, 0.0955, 0.1169,
        0.0560])
[rfa agg] iter:  0, prev_obj_val: 29.852296829223633, obj_val: 26.670883178710938, abs dis: 3.1814136505126953
[rfa agg] iter:  0, weight: tensor([0.0445, 0.0451, 0.0553, 0.0417, 0.1628, 0.1140, 0.1559, 0.1350, 0.1659,
        0.0799])
[rfa agg] iter:  1, prev_obj_val: 26.670883178710938, obj_val: 25.51124382019043, abs dis: 1.1596393585205078
[rfa agg] iter:  1, weight: tensor([0.0198, 0.0204, 0.0251, 0.0186, 0.1827, 0.1300, 0.1768, 0.1505, 0.1857,
        0.0903])
[rfa agg] iter:  2, prev_obj_val: 25.51124382019043, obj_val: 25.056438446044922, abs dis: 0.4548053741455078
[rfa agg] iter:  2, weight: tensor([0.0092, 0.0095, 0.0115, 0.0086, 0.1905, 0.1403, 0.1883, 0.1543, 0.1920,
        0.0957])
[rfa agg] iter:  3, prev_obj_val: 25.056438446044922, obj_val: 24.908287048339844, abs dis: 0.14815139770507812
[rfa agg] iter:  3, weight: tensor([0.0046, 0.0048, 0.0057, 0.0043, 0.1923, 0.1514, 0.1971, 0.1499, 0.1895,
        0.1003])
[rfa agg] iter:  4, prev_obj_val: 24.908287048339844, obj_val: 24.879579544067383, abs dis: 0.028707504272460938
[rfa agg] iter:  4, weight: tensor([0.0028, 0.0029, 0.0035, 0.0027, 0.1922, 0.1628, 0.2029, 0.1418, 0.1820,
        0.1064])
[rfa agg] iter:  5, prev_obj_val: 24.879579544067383, obj_val: 24.876842498779297, abs dis: 0.0027370452880859375
[rfa agg] iter:  5, weight: tensor([0.0023, 0.0024, 0.0029, 0.0022, 0.1931, 0.1678, 0.2039, 0.1370, 0.1767,
        0.1117])
[rfa agg] iter:  6, prev_obj_val: 24.876842498779297, obj_val: 24.876686096191406, abs dis: 0.000156402587890625
[rfa agg] iter:  6, weight: tensor([0.0022, 0.0023, 0.0027, 0.0021, 0.1942, 0.1689, 0.2034, 0.1356, 0.1746,
        0.1141])
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.0742, Accuracy: 9770/10000 (97.7000%)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 0.1198, Accuracy: 8592/8968 (95.8073%)
Done in 146.48934650421143 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:51 choose agents : [41, 73, 51, 74, 3, 39, 14, 32, 4, 30]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   1,  Average loss: 0.0006, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.525202144246318.
Norm before scaling: 16.508706310102045. Distance: 0.624088098939839
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2132, Accuracy: 9327/10000 (93.2700%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0190, Accuracy: 8907/8968 (99.3198%)
Scaling by  100
Scaled Norm after poisoning: 63.83181598875184, distance: 62.408808472843
Total norm for 4 adversaries is: 63.83181598875184. distance: 62.408808472843
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 339348.7340, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 16.525202144246318.
Norm before scaling: 16.506529469780094. Distance: 0.5752052345132537
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1151, Accuracy: 9629/10000 (96.2900%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0259, Accuracy: 8890/8968 (99.1302%)
Scaling by  100
Scaled Norm after poisoning: 59.05023640868743, distance: 57.52052537871808
Total norm for 4 adversaries is: 59.05023640868743. distance: 57.52052537871808
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 327839.2700, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   4,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.525202144246318.
Norm before scaling: 16.498200289515484. Distance: 0.47566523272751093
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2069, Accuracy: 9325/10000 (93.2500%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0132, Accuracy: 8924/8968 (99.5094%)
Scaling by  100
Scaled Norm after poisoning: 49.23272866971345, distance: 47.56652413988224
Total norm for 4 adversaries is: 49.23272866971345. distance: 47.56652413988224
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 7221.3559, Accuracy: 130/8968 (1.4496%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   1,  Average loss: 0.0007, Accuracy: 547/557 (98.2047%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   3,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   4,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.525202144246318.
Norm before scaling: 16.520843287782046. Distance: 0.6267486428944914
will scale.
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1396, Accuracy: 9567/10000 (95.6700%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0044, Accuracy: 8953/8968 (99.8327%)
Scaling by  100
Scaled Norm after poisoning: 64.40134473071971, distance: 62.674860858192176
Total norm for 4 adversaries is: 64.40134473071971. distance: 62.674860858192176
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  51, local model 3, internal_epoch   1,  Average loss: 0.0013, Accuracy: 901/923 (97.6165%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1737, Accuracy: 9423/10000 (94.2300%)
___Train Local_Simple,  epoch  51, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 251/257 (97.6654%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0961, Accuracy: 9698/10000 (96.9800%)
___Train Local_Simple,  epoch  51, local model 14, internal_epoch   1,  Average loss: 0.0014, Accuracy: 367/376 (97.6064%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0842, Accuracy: 9747/10000 (97.4700%)
___Train Local_Simple,  epoch  51, local model 32, internal_epoch   1,  Average loss: 0.0021, Accuracy: 948/977 (97.0317%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2394, Accuracy: 9238/10000 (92.3800%)
___Train Local_Simple,  epoch  51, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 647/658 (98.3283%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.4448, Accuracy: 8537/10000 (85.3700%)
___Train Local_Simple,  epoch  51, local model 30, internal_epoch   1,  Average loss: 0.0019, Accuracy: 389/400 (97.2500%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1866, Accuracy: 9449/10000 (94.4900%)
time spent on training: 124.13152575492859
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3926940639269406  data num: [606, 591, 568, 557, 923, 257, 376, 977, 658, 400]
[rfa agg] considering poison per batch poison_fraction: 0.12271689497716895
[rfa agg] init. name: [41, 73, 51, 74, 3, 39, 14, 32, 4, 30], weight: tensor([0.1025, 0.0999, 0.0961, 0.0942, 0.1561, 0.0435, 0.0636, 0.1652, 0.1113,
        0.0676])
[rfa agg] iter:  0, prev_obj_val: 28.0883731842041, obj_val: 24.51443862915039, abs dis: 3.573934555053711
[rfa agg] iter:  0, weight: tensor([0.0340, 0.0356, 0.0420, 0.0312, 0.2204, 0.0618, 0.0902, 0.2322, 0.1570,
        0.0956])
[rfa agg] iter:  1, prev_obj_val: 24.51443862915039, obj_val: 23.410240173339844, abs dis: 1.1041984558105469
[rfa agg] iter:  1, weight: tensor([0.0126, 0.0134, 0.0158, 0.0116, 0.2431, 0.0691, 0.1008, 0.2543, 0.1732,
        0.1061])
[rfa agg] iter:  2, prev_obj_val: 23.410240173339844, obj_val: 23.112184524536133, abs dis: 0.29805564880371094
[rfa agg] iter:  2, weight: tensor([0.0051, 0.0054, 0.0063, 0.0047, 0.2494, 0.0747, 0.1085, 0.2548, 0.1789,
        0.1123])
[rfa agg] iter:  3, prev_obj_val: 23.112184524536133, obj_val: 23.070363998413086, abs dis: 0.041820526123046875
[rfa agg] iter:  3, weight: tensor([0.0028, 0.0029, 0.0034, 0.0025, 0.2449, 0.0824, 0.1189, 0.2397, 0.1812,
        0.1212])
[rfa agg] iter:  4, prev_obj_val: 23.070363998413086, obj_val: 23.0679931640625, abs dis: 0.0023708343505859375
[rfa agg] iter:  4, weight: tensor([0.0022, 0.0024, 0.0028, 0.0020, 0.2386, 0.0874, 0.1263, 0.2266, 0.1831,
        0.1287])
[rfa agg] iter:  5, prev_obj_val: 23.0679931640625, obj_val: 23.067899703979492, abs dis: 9.34600830078125e-05
[rfa agg] iter:  5, weight: tensor([0.0021, 0.0023, 0.0026, 0.0020, 0.2355, 0.0892, 0.1292, 0.2209, 0.1844,
        0.1318])
___Test Target_Simple poisoned: False, epoch: 51: Average loss: 0.0737, Accuracy: 9767/10000 (97.6700%)
___Test Target_Simple poisoned: True, epoch: 51: Average loss: 0.1217, Accuracy: 8593/8968 (95.8185%)
Done in 150.58422350883484 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:52 choose agents : [41, 73, 51, 74, 30, 65, 23, 3, 98, 88]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   1,  Average loss: 0.0006, Accuracy: 598/606 (98.6799%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   2,  Average loss: 0.0007, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.521022466833262.
Norm before scaling: 16.506500813067465. Distance: 0.6210268332462964
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1697, Accuracy: 9448/10000 (94.4800%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0229, Accuracy: 8903/8968 (99.2752%)
Scaling by  100
Scaled Norm after poisoning: 63.58583911176194, distance: 62.102680456819854
Total norm for 4 adversaries is: 63.58583911176194. distance: 62.102680456819854
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 93205.1560, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   1,  Average loss: 0.0006, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   2,  Average loss: 0.0002, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   3,  Average loss: 0.0004, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   4,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 16.521022466833262.
Norm before scaling: 16.493841698186742. Distance: 0.602830442336581
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1270, Accuracy: 9588/10000 (95.8800%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0102, Accuracy: 8933/8968 (99.6097%)
Scaling by  100
Scaled Norm after poisoning: 61.48911393744831, distance: 60.28304615973612
Total norm for 4 adversaries is: 61.48911393744831. distance: 60.28304615973612
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 233783.4019, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.521022466833262.
Norm before scaling: 16.497517716926765. Distance: 0.5158238749902863
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2089, Accuracy: 9321/10000 (93.2100%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0083, Accuracy: 8937/8968 (99.6543%)
Scaling by  100
Scaled Norm after poisoning: 53.19273026207975, distance: 51.5823872633019
Total norm for 4 adversaries is: 53.19273026207975. distance: 51.5823872633019
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 16998.0860, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   1,  Average loss: 0.0007, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   2,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   3,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 16.521022466833262.
Norm before scaling: 16.5102146782137. Distance: 0.6277730696027118
will scale.
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1223, Accuracy: 9632/10000 (96.3200%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0034, Accuracy: 8955/8968 (99.8550%)
Scaling by  100
Scaled Norm after poisoning: 64.33366770813903, distance: 62.777306683028385
Total norm for 4 adversaries is: 64.33366770813903. distance: 62.777306683028385
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  52, local model 30, internal_epoch   1,  Average loss: 0.0011, Accuracy: 392/400 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2000, Accuracy: 9405/10000 (94.0500%)
___Train Local_Simple,  epoch  52, local model 65, internal_epoch   1,  Average loss: 0.0009, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.0953, Accuracy: 9680/10000 (96.8000%)
___Train Local_Simple,  epoch  52, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1665, Accuracy: 9422/10000 (94.2200%)
___Train Local_Simple,  epoch  52, local model 3, internal_epoch   1,  Average loss: 0.0014, Accuracy: 899/923 (97.3998%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1590, Accuracy: 9519/10000 (95.1900%)
___Train Local_Simple,  epoch  52, local model 98, internal_epoch   1,  Average loss: 0.0013, Accuracy: 797/818 (97.4328%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2423, Accuracy: 9247/10000 (92.4700%)
___Train Local_Simple,  epoch  52, local model 88, internal_epoch   1,  Average loss: 0.0009, Accuracy: 525/530 (99.0566%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1225, Accuracy: 9599/10000 (95.9900%)
time spent on training: 121.26945114135742
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41046491073006897  data num: [606, 591, 568, 557, 400, 371, 293, 923, 818, 530]
[rfa agg] considering poison per batch poison_fraction: 0.12827028460314654
[rfa agg] init. name: [41, 73, 51, 74, 30, 65, 23, 3, 98, 88], weight: tensor([0.1071, 0.1045, 0.1004, 0.0985, 0.0707, 0.0656, 0.0518, 0.1632, 0.1446,
        0.0937])
[rfa agg] iter:  0, prev_obj_val: 29.90076446533203, obj_val: 26.425254821777344, abs dis: 3.4755096435546875
[rfa agg] iter:  0, weight: tensor([0.0401, 0.0399, 0.0462, 0.0371, 0.1008, 0.0937, 0.0740, 0.2302, 0.2042,
        0.1339])
[rfa agg] iter:  1, prev_obj_val: 26.425254821777344, obj_val: 25.234851837158203, abs dis: 1.1904029846191406
[rfa agg] iter:  1, weight: tensor([0.0165, 0.0166, 0.0190, 0.0151, 0.1132, 0.1057, 0.0835, 0.2537, 0.2257,
        0.1510])
[rfa agg] iter:  2, prev_obj_val: 25.234851837158203, obj_val: 24.83292579650879, abs dis: 0.40192604064941406
[rfa agg] iter:  2, weight: tensor([0.0071, 0.0072, 0.0081, 0.0065, 0.1201, 0.1141, 0.0901, 0.2555, 0.2299,
        0.1612])
[rfa agg] iter:  3, prev_obj_val: 24.83292579650879, obj_val: 24.739534378051758, abs dis: 0.09339141845703125
[rfa agg] iter:  3, weight: tensor([0.0036, 0.0036, 0.0041, 0.0033, 0.1266, 0.1275, 0.1004, 0.2387, 0.2225,
        0.1697])
[rfa agg] iter:  4, prev_obj_val: 24.739534378051758, obj_val: 24.728412628173828, abs dis: 0.011121749877929688
[rfa agg] iter:  4, weight: tensor([0.0025, 0.0025, 0.0028, 0.0023, 0.1317, 0.1455, 0.1137, 0.2150, 0.2110,
        0.1731])
[rfa agg] iter:  5, prev_obj_val: 24.728412628173828, obj_val: 24.727495193481445, abs dis: 0.0009174346923828125
[rfa agg] iter:  5, weight: tensor([0.0022, 0.0022, 0.0025, 0.0020, 0.1346, 0.1570, 0.1224, 0.2000, 0.2032,
        0.1739])
[rfa agg] iter:  6, prev_obj_val: 24.727495193481445, obj_val: 24.727399826049805, abs dis: 9.5367431640625e-05
[rfa agg] iter:  6, weight: tensor([0.0021, 0.0021, 0.0024, 0.0019, 0.1361, 0.1621, 0.1262, 0.1931, 0.1993,
        0.1746])
___Test Target_Simple poisoned: False, epoch: 52: Average loss: 0.0732, Accuracy: 9770/10000 (97.7000%)
___Test Target_Simple poisoned: True, epoch: 52: Average loss: 0.1223, Accuracy: 8592/8968 (95.8073%)
Done in 150.6241331100464 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:53 choose agents : [41, 73, 51, 74, 71, 2, 43, 25, 17, 37]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   2,  Average loss: 0.0006, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.51765376021024.
Norm before scaling: 16.506515603635034. Distance: 0.5840794922799482
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1484, Accuracy: 9512/10000 (95.1200%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0419, Accuracy: 8848/8968 (98.6619%)
Scaling by  100
Scaled Norm after poisoning: 60.11176317714882, distance: 58.40795334260459
Total norm for 4 adversaries is: 60.11176317714882. distance: 58.40795334260459
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 117292.1411, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.51765376021024.
Norm before scaling: 16.498939248869625. Distance: 0.6039897451382832
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1167, Accuracy: 9633/10000 (96.3300%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0103, Accuracy: 8932/8968 (99.5986%)
Scaling by  100
Scaled Norm after poisoning: 61.82720494640183, distance: 60.398976621736935
Total norm for 4 adversaries is: 61.82720494640183. distance: 60.398976621736935
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 329447.5662, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 16.51765376021024.
Norm before scaling: 16.487297023307537. Distance: 0.5207940722608667
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1875, Accuracy: 9373/10000 (93.7300%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0118, Accuracy: 8934/8968 (99.6209%)
Scaling by  100
Scaled Norm after poisoning: 53.45826076979357, distance: 52.079407143683
Total norm for 4 adversaries is: 53.45826076979357. distance: 52.079407143683
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 18984.3556, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   1,  Average loss: 0.0009, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   2,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   4,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.51765376021024.
Norm before scaling: 16.514203980376067. Distance: 0.6799346430659136
will scale.
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1342, Accuracy: 9581/10000 (95.8100%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0033, Accuracy: 8954/8968 (99.8439%)
Scaling by  100
Scaled Norm after poisoning: 69.55804610067587, distance: 67.99346892464195
Total norm for 4 adversaries is: 69.55804610067587. distance: 67.99346892464195
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 42696.4675, Accuracy: 580/8968 (6.4674%)
___Train Local_Simple,  epoch  53, local model 71, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1360/1384 (98.2659%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6904, Accuracy: 8469/10000 (84.6900%)
___Train Local_Simple,  epoch  53, local model 2, internal_epoch   1,  Average loss: 0.0012, Accuracy: 540/548 (98.5401%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1593, Accuracy: 9483/10000 (94.8300%)
___Train Local_Simple,  epoch  53, local model 43, internal_epoch   1,  Average loss: 0.0009, Accuracy: 401/408 (98.2843%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1704, Accuracy: 9447/10000 (94.4700%)
___Train Local_Simple,  epoch  53, local model 25, internal_epoch   1,  Average loss: 0.0011, Accuracy: 631/647 (97.5270%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2821, Accuracy: 9078/10000 (90.7800%)
___Train Local_Simple,  epoch  53, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 606/620 (97.7419%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1396, Accuracy: 9542/10000 (95.4200%)
___Train Local_Simple,  epoch  53, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 846/860 (98.3721%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2304, Accuracy: 9286/10000 (92.8600%)
time spent on training: 118.90100193023682
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.34202386212991603  data num: [606, 591, 568, 557, 1384, 548, 408, 647, 620, 860]
[rfa agg] considering poison per batch poison_fraction: 0.10688245691559876
[rfa agg] init. name: [41, 73, 51, 74, 71, 2, 43, 25, 17, 37], weight: tensor([0.0893, 0.0871, 0.0837, 0.0820, 0.2039, 0.0807, 0.0601, 0.0953, 0.0913,
        0.1267])
[rfa agg] iter:  0, prev_obj_val: 26.227447509765625, obj_val: 22.172405242919922, abs dis: 4.055042266845703
[rfa agg] iter:  0, weight: tensor([0.0274, 0.0259, 0.0296, 0.0220, 0.2746, 0.1102, 0.0819, 0.1305, 0.1237,
        0.1741])
[rfa agg] iter:  1, prev_obj_val: 22.172405242919922, obj_val: 21.12293815612793, abs dis: 1.0494670867919922
[rfa agg] iter:  1, weight: tensor([0.0086, 0.0081, 0.0092, 0.0068, 0.2882, 0.1207, 0.0893, 0.1437, 0.1327,
        0.1925])
[rfa agg] iter:  2, prev_obj_val: 21.12293815612793, obj_val: 20.95084571838379, abs dis: 0.17209243774414062
[rfa agg] iter:  2, weight: tensor([0.0032, 0.0031, 0.0034, 0.0026, 0.2702, 0.1304, 0.0983, 0.1505, 0.1353,
        0.2031])
[rfa agg] iter:  3, prev_obj_val: 20.95084571838379, obj_val: 20.941316604614258, abs dis: 0.00952911376953125
[rfa agg] iter:  3, weight: tensor([0.0021, 0.0020, 0.0022, 0.0017, 0.2467, 0.1417, 0.1149, 0.1491, 0.1395,
        0.2001])
[rfa agg] iter:  4, prev_obj_val: 20.941316604614258, obj_val: 20.9410400390625, abs dis: 0.0002765655517578125
[rfa agg] iter:  4, weight: tensor([0.0020, 0.0018, 0.0021, 0.0015, 0.2360, 0.1461, 0.1231, 0.1479, 0.1424,
        0.1972])
___Test Target_Simple poisoned: False, epoch: 53: Average loss: 0.0726, Accuracy: 9772/10000 (97.7200%)
___Test Target_Simple poisoned: True, epoch: 53: Average loss: 0.1114, Accuracy: 8621/8968 (96.1307%)
Done in 143.9041805267334 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:54 choose agents : [41, 73, 51, 74, 46, 56, 30, 0, 33, 53]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   1,  Average loss: 0.0008, Accuracy: 594/606 (98.0198%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.513111800267236.
Norm before scaling: 16.503181844308937. Distance: 0.6134196082842155
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1445, Accuracy: 9527/10000 (95.2700%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0232, Accuracy: 8899/8968 (99.2306%)
Scaling by  100
Scaled Norm after poisoning: 62.96907180438862, distance: 61.34196101887048
Total norm for 4 adversaries is: 62.96907180438862. distance: 61.34196101887048
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 103469.6782, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.513111800267236.
Norm before scaling: 16.501822631045467. Distance: 0.5970695707736463
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1119, Accuracy: 9638/10000 (96.3800%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0108, Accuracy: 8932/8968 (99.5986%)
Scaling by  100
Scaled Norm after poisoning: 61.357007530084736, distance: 59.706958542849094
Total norm for 4 adversaries is: 61.357007530084736. distance: 59.706958542849094
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 125444.8142, Accuracy: 8/8968 (0.0892%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   2,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.513111800267236.
Norm before scaling: 16.48126173948435. Distance: 0.4445607884520372
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1707, Accuracy: 9455/10000 (94.5500%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0104, Accuracy: 8932/8968 (99.5986%)
Scaling by  100
Scaled Norm after poisoning: 46.08876562033583, distance: 44.45607827404271
Total norm for 4 adversaries is: 46.08876562033583. distance: 44.45607827404271
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 32696.1768, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   1,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   4,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 16.513111800267236.
Norm before scaling: 16.5023829733414. Distance: 0.5979726365329182
will scale.
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1358, Accuracy: 9574/10000 (95.7400%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0026, Accuracy: 8958/8968 (99.8885%)
Scaling by  100
Scaled Norm after poisoning: 61.45905808188488, distance: 59.79726286783012
Total norm for 4 adversaries is: 61.45905808188488. distance: 59.79726286783012
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  54, local model 46, internal_epoch   1,  Average loss: 0.0015, Accuracy: 692/710 (97.4648%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.3719, Accuracy: 8818/10000 (88.1800%)
___Train Local_Simple,  epoch  54, local model 56, internal_epoch   1,  Average loss: 0.0015, Accuracy: 857/880 (97.3864%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1093, Accuracy: 9686/10000 (96.8600%)
___Train Local_Simple,  epoch  54, local model 30, internal_epoch   1,  Average loss: 0.0011, Accuracy: 392/400 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2428, Accuracy: 9254/10000 (92.5400%)
___Train Local_Simple,  epoch  54, local model 0, internal_epoch   1,  Average loss: 0.0013, Accuracy: 426/435 (97.9310%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1579, Accuracy: 9483/10000 (94.8300%)
___Train Local_Simple,  epoch  54, local model 33, internal_epoch   1,  Average loss: 0.0012, Accuracy: 612/623 (98.2343%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1712, Accuracy: 9399/10000 (93.9900%)
___Train Local_Simple,  epoch  54, local model 53, internal_epoch   1,  Average loss: 0.0008, Accuracy: 727/739 (98.3762%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2429, Accuracy: 9251/10000 (92.5100%)
time spent on training: 121.43007779121399
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3800949418890162  data num: [606, 591, 568, 557, 710, 880, 400, 435, 623, 739]
[rfa agg] considering poison per batch poison_fraction: 0.11877966934031757
[rfa agg] init. name: [41, 73, 51, 74, 46, 56, 30, 0, 33, 53], weight: tensor([0.0992, 0.0967, 0.0930, 0.0912, 0.1162, 0.1440, 0.0655, 0.0712, 0.1020,
        0.1210])
[rfa agg] iter:  0, prev_obj_val: 27.006607055664062, obj_val: 23.414247512817383, abs dis: 3.5923595428466797
[rfa agg] iter:  0, weight: tensor([0.0333, 0.0335, 0.0437, 0.0314, 0.1602, 0.1984, 0.0902, 0.0990, 0.1418,
        0.1685])
[rfa agg] iter:  1, prev_obj_val: 23.414247512817383, obj_val: 22.26819610595703, abs dis: 1.1460514068603516
[rfa agg] iter:  1, weight: tensor([0.0125, 0.0126, 0.0166, 0.0118, 0.1753, 0.2166, 0.0988, 0.1099, 0.1575,
        0.1884])
[rfa agg] iter:  2, prev_obj_val: 22.26819610595703, obj_val: 21.948440551757812, abs dis: 0.31975555419921875
[rfa agg] iter:  2, weight: tensor([0.0051, 0.0051, 0.0066, 0.0048, 0.1761, 0.2165, 0.1020, 0.1169, 0.1672,
        0.1997])
[rfa agg] iter:  3, prev_obj_val: 21.948440551757812, obj_val: 21.901124954223633, abs dis: 0.04731559753417969
[rfa agg] iter:  3, weight: tensor([0.0027, 0.0027, 0.0035, 0.0026, 0.1673, 0.2042, 0.1073, 0.1261, 0.1789,
        0.2046])
[rfa agg] iter:  4, prev_obj_val: 21.901124954223633, obj_val: 21.8983154296875, abs dis: 0.0028095245361328125
[rfa agg] iter:  4, weight: tensor([0.0022, 0.0022, 0.0028, 0.0021, 0.1604, 0.1942, 0.1142, 0.1330, 0.1872,
        0.2017])
[rfa agg] iter:  5, prev_obj_val: 21.8983154296875, obj_val: 21.89820671081543, abs dis: 0.0001087188720703125
[rfa agg] iter:  5, weight: tensor([0.0021, 0.0021, 0.0027, 0.0020, 0.1580, 0.1905, 0.1173, 0.1358, 0.1905,
        0.1992])
___Test Target_Simple poisoned: False, epoch: 54: Average loss: 0.0727, Accuracy: 9770/10000 (97.7000%)
___Test Target_Simple poisoned: True, epoch: 54: Average loss: 0.1095, Accuracy: 8627/8968 (96.1976%)
Done in 150.6449432373047 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:55 choose agents : [41, 73, 51, 74, 17, 65, 6, 24, 86, 35]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   2,  Average loss: 0.0006, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 16.509528905384744.
Norm before scaling: 16.494476318556995. Distance: 0.6200430517861999
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1519, Accuracy: 9480/10000 (94.8000%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0169, Accuracy: 8919/8968 (99.4536%)
Scaling by  100
Scaled Norm after poisoning: 63.47420043682118, distance: 62.00430775105468
Total norm for 4 adversaries is: 63.47420043682118. distance: 62.00430775105468
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 12761.3546, Accuracy: 2029/8968 (22.6249%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   1,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.509528905384744.
Norm before scaling: 16.48886565018005. Distance: 0.485552233960262
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.0954, Accuracy: 9689/10000 (96.8900%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0184, Accuracy: 8911/8968 (99.3644%)
Scaling by  100
Scaled Norm after poisoning: 50.38264956265326, distance: 48.555222367327545
Total norm for 4 adversaries is: 50.38264956265326. distance: 48.555222367327545
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 84109.7059, Accuracy: 11/8968 (0.1227%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   1,  Average loss: 0.0007, Accuracy: 561/568 (98.7676%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.509528905384744.
Norm before scaling: 16.483453025164735. Distance: 0.5655421538827131
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1786, Accuracy: 9413/10000 (94.1300%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0025, Accuracy: 8958/8968 (99.8885%)
Scaling by  100
Scaled Norm after poisoning: 57.90446654700957, distance: 56.554216416914926
Total norm for 4 adversaries is: 57.90446654700957. distance: 56.554216416914926
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 1.0459, Accuracy: 8960/8968 (99.9108%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   1,  Average loss: 0.0008, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   3,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   4,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.509528905384744.
Norm before scaling: 16.497314234539058. Distance: 0.6188299801700785
will scale.
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1330, Accuracy: 9592/10000 (95.9200%)
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0041, Accuracy: 8955/8968 (99.8550%)
Scaling by  100
Scaled Norm after poisoning: 63.430755106331304, distance: 61.8829994039912
Total norm for 4 adversaries is: 63.430755106331304. distance: 61.8829994039912
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  55, local model 17, internal_epoch   1,  Average loss: 0.0017, Accuracy: 599/620 (96.6129%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1551, Accuracy: 9516/10000 (95.1600%)
___Train Local_Simple,  epoch  55, local model 65, internal_epoch   1,  Average loss: 0.0008, Accuracy: 365/371 (98.3827%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1161, Accuracy: 9612/10000 (96.1200%)
___Train Local_Simple,  epoch  55, local model 6, internal_epoch   1,  Average loss: 0.0011, Accuracy: 603/615 (98.0488%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.2299, Accuracy: 9300/10000 (93.0000%)
___Train Local_Simple,  epoch  55, local model 24, internal_epoch   1,  Average loss: 0.0015, Accuracy: 366/379 (96.5699%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1092, Accuracy: 9665/10000 (96.6500%)
___Train Local_Simple,  epoch  55, local model 86, internal_epoch   1,  Average loss: 0.0010, Accuracy: 244/250 (97.6000%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.0857, Accuracy: 9732/10000 (97.3200%)
___Train Local_Simple,  epoch  55, local model 35, internal_epoch   1,  Average loss: 0.0005, Accuracy: 495/499 (99.1984%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1629, Accuracy: 9488/10000 (94.8800%)
time spent on training: 114.33400464057922
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.45925632911392406  data num: [606, 591, 568, 557, 620, 371, 615, 379, 250, 499]
[rfa agg] considering poison per batch poison_fraction: 0.14351760284810128
[rfa agg] init. name: [41, 73, 51, 74, 17, 65, 6, 24, 86, 35], weight: tensor([0.1199, 0.1169, 0.1123, 0.1102, 0.1226, 0.0734, 0.1216, 0.0750, 0.0494,
        0.0987])
[rfa agg] iter:  0, prev_obj_val: 31.284225463867188, obj_val: 28.369739532470703, abs dis: 2.9144859313964844
[rfa agg] iter:  0, weight: tensor([0.0510, 0.0616, 0.0530, 0.0470, 0.1782, 0.1066, 0.1773, 0.1092, 0.0721,
        0.1440])
[rfa agg] iter:  1, prev_obj_val: 28.369739532470703, obj_val: 27.277902603149414, abs dis: 1.091836929321289
[rfa agg] iter:  1, weight: tensor([0.0245, 0.0307, 0.0255, 0.0226, 0.2025, 0.1212, 0.2022, 0.1243, 0.0821,
        0.1644])
[rfa agg] iter:  2, prev_obj_val: 27.277902603149414, obj_val: 26.806196212768555, abs dis: 0.4717063903808594
[rfa agg] iter:  2, weight: tensor([0.0123, 0.0154, 0.0127, 0.0113, 0.2127, 0.1277, 0.2141, 0.1316, 0.0872,
        0.1751])
[rfa agg] iter:  3, prev_obj_val: 26.806196212768555, obj_val: 26.609844207763672, abs dis: 0.1963520050048828
[rfa agg] iter:  3, weight: tensor([0.0064, 0.0080, 0.0066, 0.0059, 0.2139, 0.1303, 0.2197, 0.1355, 0.0909,
        0.1829])
[rfa agg] iter:  4, prev_obj_val: 26.609844207763672, obj_val: 26.545454025268555, abs dis: 0.06439018249511719
[rfa agg] iter:  4, weight: tensor([0.0037, 0.0046, 0.0038, 0.0034, 0.2056, 0.1312, 0.2204, 0.1385, 0.0959,
        0.1930])
[rfa agg] iter:  5, prev_obj_val: 26.545454025268555, obj_val: 26.53194808959961, abs dis: 0.013505935668945312
[rfa agg] iter:  5, weight: tensor([0.0025, 0.0032, 0.0026, 0.0023, 0.1911, 0.1314, 0.2162, 0.1413, 0.1034,
        0.2059])
[rfa agg] iter:  6, prev_obj_val: 26.53194808959961, obj_val: 26.5301456451416, abs dis: 0.0018024444580078125
[rfa agg] iter:  6, weight: tensor([0.0022, 0.0027, 0.0022, 0.0020, 0.1794, 0.1315, 0.2111, 0.1431, 0.1097,
        0.2161])
[rfa agg] iter:  7, prev_obj_val: 26.5301456451416, obj_val: 26.52996253967285, abs dis: 0.00018310546875
[rfa agg] iter:  7, weight: tensor([0.0020, 0.0026, 0.0021, 0.0019, 0.1736, 0.1315, 0.2081, 0.1440, 0.1129,
        0.2214])
___Test Target_Simple poisoned: False, epoch: 55: Average loss: 0.0725, Accuracy: 9772/10000 (97.7200%)
___Test Target_Simple poisoned: True, epoch: 55: Average loss: 0.0984, Accuracy: 8667/8968 (96.6436%)
Done in 143.80706405639648 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:56 choose agents : [41, 73, 51, 74, 84, 85, 60, 94, 30, 76]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.5066588865723.
Norm before scaling: 16.492740768194807. Distance: 0.5782962493888978
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1616, Accuracy: 9467/10000 (94.6700%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0213, Accuracy: 8907/8968 (99.3198%)
Scaling by  100
Scaled Norm after poisoning: 59.475745121961275, distance: 57.829630063499884
Total norm for 4 adversaries is: 59.475745121961275. distance: 57.829630063499884
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 45567.8776, Accuracy: 71/8968 (0.7917%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   1,  Average loss: 0.0004, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.5066588865723.
Norm before scaling: 16.484508293299957. Distance: 0.5607983227902662
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1087, Accuracy: 9654/10000 (96.5400%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0091, Accuracy: 8938/8968 (99.6655%)
Scaling by  100
Scaled Norm after poisoning: 57.557711357547475, distance: 56.079831577543324
Total norm for 4 adversaries is: 57.557711357547475. distance: 56.079831577543324
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 105795.9546, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.5066588865723.
Norm before scaling: 16.47084011879024. Distance: 0.4601768100465221
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1728, Accuracy: 9428/10000 (94.2800%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0135, Accuracy: 8920/8968 (99.4648%)
Scaling by  100
Scaled Norm after poisoning: 47.44261541918299, distance: 46.01767822244376
Total norm for 4 adversaries is: 47.44261541918299. distance: 46.01767822244376
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   1,  Average loss: 0.0006, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   2,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   3,  Average loss: 0.0004, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   4,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 16.5066588865723.
Norm before scaling: 16.490814426498734. Distance: 0.5467209462756502
will scale.
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1078, Accuracy: 9665/10000 (96.6500%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0043, Accuracy: 8955/8968 (99.8550%)
Scaling by  100
Scaled Norm after poisoning: 56.38561126921588, distance: 54.672093812079986
Total norm for 4 adversaries is: 56.38561126921588. distance: 54.672093812079986
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 17142.5951, Accuracy: 68/8968 (0.7583%)
___Train Local_Simple,  epoch  56, local model 84, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1210/1246 (97.1108%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1676, Accuracy: 9491/10000 (94.9100%)
___Train Local_Simple,  epoch  56, local model 85, internal_epoch   1,  Average loss: 0.0008, Accuracy: 423/431 (98.1439%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1797, Accuracy: 9413/10000 (94.1300%)
___Train Local_Simple,  epoch  56, local model 60, internal_epoch   1,  Average loss: 0.0016, Accuracy: 330/338 (97.6331%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1290, Accuracy: 9601/10000 (96.0100%)
___Train Local_Simple,  epoch  56, local model 94, internal_epoch   1,  Average loss: 0.0019, Accuracy: 145/150 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1154, Accuracy: 9641/10000 (96.4100%)
___Train Local_Simple,  epoch  56, local model 30, internal_epoch   1,  Average loss: 0.0011, Accuracy: 393/400 (98.2500%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.2078, Accuracy: 9366/10000 (93.6600%)
___Train Local_Simple,  epoch  56, local model 76, internal_epoch   1,  Average loss: 0.0011, Accuracy: 77/78 (98.7179%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.0776, Accuracy: 9765/10000 (97.6500%)
time spent on training: 111.07649374008179
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4676737160120846  data num: [606, 591, 568, 557, 1246, 431, 338, 150, 400, 78]
[rfa agg] considering poison per batch poison_fraction: 0.14614803625377643
[rfa agg] init. name: [41, 73, 51, 74, 84, 85, 60, 94, 30, 76], weight: tensor([0.1221, 0.1190, 0.1144, 0.1122, 0.2510, 0.0868, 0.0681, 0.0302, 0.0806,
        0.0157])
[rfa agg] iter:  0, prev_obj_val: 29.716999053955078, obj_val: 27.06743812561035, abs dis: 2.6495609283447266
[rfa agg] iter:  0, weight: tensor([0.0520, 0.0515, 0.0610, 0.0512, 0.3678, 0.1285, 0.1009, 0.0448, 0.1189,
        0.0233])
[rfa agg] iter:  1, prev_obj_val: 27.06743812561035, obj_val: 26.097871780395508, abs dis: 0.9695663452148438
[rfa agg] iter:  1, weight: tensor([0.0253, 0.0254, 0.0303, 0.0249, 0.4169, 0.1472, 0.1159, 0.0514, 0.1358,
        0.0269])
[rfa agg] iter:  2, prev_obj_val: 26.097871780395508, obj_val: 25.702836990356445, abs dis: 0.3950347900390625
[rfa agg] iter:  2, weight: tensor([0.0130, 0.0131, 0.0154, 0.0127, 0.4363, 0.1572, 0.1241, 0.0551, 0.1440,
        0.0291])
[rfa agg] iter:  3, prev_obj_val: 25.702836990356445, obj_val: 25.565013885498047, abs dis: 0.13782310485839844
[rfa agg] iter:  3, weight: tensor([0.0072, 0.0073, 0.0086, 0.0071, 0.4401, 0.1639, 0.1291, 0.0576, 0.1481,
        0.0311])
[rfa agg] iter:  4, prev_obj_val: 25.565013885498047, obj_val: 25.533544540405273, abs dis: 0.03146934509277344
[rfa agg] iter:  4, weight: tensor([0.0048, 0.0048, 0.0057, 0.0047, 0.4368, 0.1690, 0.1315, 0.0595, 0.1499,
        0.0333])
[rfa agg] iter:  5, prev_obj_val: 25.533544540405273, obj_val: 25.529438018798828, abs dis: 0.0041065216064453125
[rfa agg] iter:  5, weight: tensor([0.0040, 0.0040, 0.0047, 0.0039, 0.4327, 0.1724, 0.1320, 0.0605, 0.1511,
        0.0347])
[rfa agg] iter:  6, prev_obj_val: 25.529438018798828, obj_val: 25.529081344604492, abs dis: 0.0003566741943359375
[rfa agg] iter:  6, weight: tensor([0.0037, 0.0038, 0.0044, 0.0036, 0.4297, 0.1743, 0.1322, 0.0610, 0.1520,
        0.0354])
[rfa agg] iter:  7, prev_obj_val: 25.529081344604492, obj_val: 25.529054641723633, abs dis: 2.6702880859375e-05
[rfa agg] iter:  7, weight: tensor([0.0037, 0.0037, 0.0043, 0.0036, 0.4277, 0.1752, 0.1325, 0.0612, 0.1525,
        0.0357])
___Test Target_Simple poisoned: False, epoch: 56: Average loss: 0.0726, Accuracy: 9774/10000 (97.7400%)
___Test Target_Simple poisoned: True, epoch: 56: Average loss: 0.0839, Accuracy: 8712/8968 (97.1454%)
Done in 139.3335554599762 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:57 choose agents : [41, 73, 51, 74, 42, 25, 16, 95, 52, 59]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   2,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.501090273815528.
Norm before scaling: 16.48468971855969. Distance: 0.5400512859485631
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1563, Accuracy: 9482/10000 (94.8200%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0294, Accuracy: 8887/8968 (99.0968%)
Scaling by  100
Scaled Norm after poisoning: 55.727676917393346, distance: 54.00512670976247
Total norm for 4 adversaries is: 55.727676917393346. distance: 54.00512670976247
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 197458.7696, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   1,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   2,  Average loss: 0.0006, Accuracy: 585/591 (98.9848%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.501090273815528.
Norm before scaling: 16.49056829746742. Distance: 0.6384085716157916
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1185, Accuracy: 9614/10000 (96.1400%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0115, Accuracy: 8930/8968 (99.5763%)
Scaling by  100
Scaled Norm after poisoning: 65.36411312911888, distance: 63.84085896537969
Total norm for 4 adversaries is: 65.36411312911888. distance: 63.84085896537969
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 266884.9923, Accuracy: 1/8968 (0.0112%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.501090273815528.
Norm before scaling: 16.47226673196687. Distance: 0.4474323078722285
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1896, Accuracy: 9386/10000 (93.8600%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0073, Accuracy: 8942/8968 (99.7101%)
Scaling by  100
Scaled Norm after poisoning: 46.46698204017424, distance: 44.7432290181291
Total norm for 4 adversaries is: 46.46698204017424. distance: 44.7432290181291
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 36200.6018, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   1,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   2,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   4,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 16.501090273815528.
Norm before scaling: 16.488278936418933. Distance: 0.5557948597122963
will scale.
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1173, Accuracy: 9634/10000 (96.3400%)
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0036, Accuracy: 8955/8968 (99.8550%)
Scaling by  100
Scaled Norm after poisoning: 57.34289210870537, distance: 55.57949332375206
Total norm for 4 adversaries is: 57.34289210870537. distance: 55.57949332375206
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  57, local model 42, internal_epoch   1,  Average loss: 0.0014, Accuracy: 232/236 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.0982, Accuracy: 9678/10000 (96.7800%)
___Train Local_Simple,  epoch  57, local model 25, internal_epoch   1,  Average loss: 0.0010, Accuracy: 632/647 (97.6816%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.2642, Accuracy: 9105/10000 (91.0500%)
___Train Local_Simple,  epoch  57, local model 16, internal_epoch   1,  Average loss: 0.0012, Accuracy: 896/915 (97.9235%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1847, Accuracy: 9441/10000 (94.4100%)
___Train Local_Simple,  epoch  57, local model 95, internal_epoch   1,  Average loss: 0.0003, Accuracy: 598/602 (99.3355%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.6087, Accuracy: 8072/10000 (80.7200%)
___Train Local_Simple,  epoch  57, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1491, Accuracy: 9537/10000 (95.3700%)
___Train Local_Simple,  epoch  57, local model 59, internal_epoch   1,  Average loss: 0.0015, Accuracy: 739/760 (97.2368%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.5224, Accuracy: 8409/10000 (84.0900%)
time spent on training: 122.75275659561157
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4048823016564952  data num: [606, 591, 568, 557, 236, 647, 915, 602, 253, 760]
[rfa agg] considering poison per batch poison_fraction: 0.12652571926765474
[rfa agg] init. name: [41, 73, 51, 74, 42, 25, 16, 95, 52, 59], weight: tensor([0.1057, 0.1031, 0.0990, 0.0971, 0.0412, 0.1128, 0.1595, 0.1050, 0.0441,
        0.1325])
[rfa agg] iter:  0, prev_obj_val: 27.275657653808594, obj_val: 23.992765426635742, abs dis: 3.2828922271728516
[rfa agg] iter:  0, weight: tensor([0.0403, 0.0333, 0.0464, 0.0368, 0.0585, 0.1605, 0.2257, 0.1490, 0.0626,
        0.1869])
[rfa agg] iter:  1, prev_obj_val: 23.992765426635742, obj_val: 22.924633026123047, abs dis: 1.0681324005126953
[rfa agg] iter:  1, weight: tensor([0.0162, 0.0132, 0.0186, 0.0145, 0.0655, 0.1803, 0.2502, 0.1662, 0.0698,
        0.2055])
[rfa agg] iter:  2, prev_obj_val: 22.924633026123047, obj_val: 22.599760055541992, abs dis: 0.3248729705810547
[rfa agg] iter:  2, weight: tensor([0.0069, 0.0056, 0.0078, 0.0062, 0.0705, 0.1909, 0.2582, 0.1746, 0.0744,
        0.2049])
[rfa agg] iter:  3, prev_obj_val: 22.599760055541992, obj_val: 22.540082931518555, abs dis: 0.0596771240234375
[rfa agg] iter:  3, weight: tensor([0.0036, 0.0030, 0.0041, 0.0033, 0.0803, 0.1966, 0.2578, 0.1813, 0.0824,
        0.1876])
[rfa agg] iter:  4, prev_obj_val: 22.540082931518555, obj_val: 22.534948348999023, abs dis: 0.00513458251953125
[rfa agg] iter:  4, weight: tensor([0.0028, 0.0023, 0.0031, 0.0025, 0.0922, 0.1950, 0.2542, 0.1860, 0.0917,
        0.1702])
[rfa agg] iter:  5, prev_obj_val: 22.534948348999023, obj_val: 22.534666061401367, abs dis: 0.00028228759765625
[rfa agg] iter:  5, weight: tensor([0.0026, 0.0021, 0.0029, 0.0023, 0.0978, 0.1926, 0.2519, 0.1890, 0.0962,
        0.1625])
___Test Target_Simple poisoned: False, epoch: 57: Average loss: 0.0730, Accuracy: 9771/10000 (97.7100%)
___Test Target_Simple poisoned: True, epoch: 57: Average loss: 0.0742, Accuracy: 8742/8968 (97.4799%)
Done in 150.8986110687256 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:58 choose agents : [41, 73, 51, 74, 52, 81, 77, 21, 10, 8]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.496745395458404.
Norm before scaling: 16.47852754699847. Distance: 0.5836259130886221
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1462, Accuracy: 9501/10000 (95.0100%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0205, Accuracy: 8906/8968 (99.3087%)
Scaling by  100
Scaled Norm after poisoning: 59.868157555268894, distance: 58.36259194614197
Total norm for 4 adversaries is: 59.868157555268894. distance: 58.36259194614197
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 150914.1820, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.496745395458404.
Norm before scaling: 16.47145987696645. Distance: 0.5363275837739241
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1090, Accuracy: 9643/10000 (96.4300%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0168, Accuracy: 8916/8968 (99.4202%)
Scaling by  100
Scaled Norm after poisoning: 55.10435767137659, distance: 53.63275503001291
Total norm for 4 adversaries is: 55.10435767137659. distance: 53.63275503001291
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 221469.3714, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.496745395458404.
Norm before scaling: 16.467530641528725. Distance: 0.4541828533956967
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1907, Accuracy: 9389/10000 (93.8900%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0056, Accuracy: 8951/8968 (99.8104%)
Scaling by  100
Scaled Norm after poisoning: 47.0959609840974, distance: 45.41828707449511
Total norm for 4 adversaries is: 47.0959609840974. distance: 45.41828707449511
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 33496.1813, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   1,  Average loss: 0.0009, Accuracy: 545/557 (97.8456%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   4,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.496745395458404.
Norm before scaling: 16.486759306239506. Distance: 0.661443121927926
will scale.
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1265, Accuracy: 9622/10000 (96.2200%)
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0012, Accuracy: 8963/8968 (99.9442%)
Scaling by  100
Scaled Norm after poisoning: 67.60565010249698, distance: 66.14431428701941
Total norm for 4 adversaries is: 67.60565010249698. distance: 66.14431428701941
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  58, local model 52, internal_epoch   1,  Average loss: 0.0007, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1464, Accuracy: 9543/10000 (95.4300%)
___Train Local_Simple,  epoch  58, local model 81, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1214/1227 (98.9405%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.2607, Accuracy: 9232/10000 (92.3200%)
___Train Local_Simple,  epoch  58, local model 77, internal_epoch   1,  Average loss: 0.0014, Accuracy: 577/589 (97.9626%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1449, Accuracy: 9532/10000 (95.3200%)
___Train Local_Simple,  epoch  58, local model 21, internal_epoch   1,  Average loss: 0.0011, Accuracy: 305/312 (97.7564%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1403, Accuracy: 9517/10000 (95.1700%)
___Train Local_Simple,  epoch  58, local model 10, internal_epoch   1,  Average loss: 0.0012, Accuracy: 874/892 (97.9821%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.5197, Accuracy: 8449/10000 (84.4900%)
___Train Local_Simple,  epoch  58, local model 8, internal_epoch   1,  Average loss: 0.0015, Accuracy: 617/633 (97.4724%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1364, Accuracy: 9582/10000 (95.8200%)
time spent on training: 129.90391969680786
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.37283236994219654  data num: [606, 591, 568, 557, 253, 1227, 589, 312, 892, 633]
[rfa agg] considering poison per batch poison_fraction: 0.11651011560693642
[rfa agg] init. name: [41, 73, 51, 74, 52, 81, 77, 21, 10, 8], weight: tensor([0.0973, 0.0949, 0.0912, 0.0894, 0.0406, 0.1970, 0.0946, 0.0501, 0.1432,
        0.1016])
[rfa agg] iter:  0, prev_obj_val: 26.181745529174805, obj_val: 22.541706085205078, abs dis: 3.6400394439697266
[rfa agg] iter:  0, weight: tensor([0.0310, 0.0322, 0.0372, 0.0251, 0.0568, 0.2749, 0.1321, 0.0698, 0.2004,
        0.1405])
[rfa agg] iter:  1, prev_obj_val: 22.541706085205078, obj_val: 21.515981674194336, abs dis: 1.0257244110107422
[rfa agg] iter:  1, weight: tensor([0.0105, 0.0111, 0.0128, 0.0085, 0.0628, 0.3002, 0.1449, 0.0768, 0.2214,
        0.1511])
[rfa agg] iter:  2, prev_obj_val: 21.515981674194336, obj_val: 21.294557571411133, abs dis: 0.22142410278320312
[rfa agg] iter:  2, weight: tensor([0.0040, 0.0043, 0.0049, 0.0033, 0.0683, 0.3058, 0.1502, 0.0819, 0.2287,
        0.1487])
[rfa agg] iter:  3, prev_obj_val: 21.294557571411133, obj_val: 21.275043487548828, abs dis: 0.019514083862304688
[rfa agg] iter:  3, weight: tensor([0.0024, 0.0025, 0.0029, 0.0019, 0.0787, 0.3012, 0.1527, 0.0910, 0.2226,
        0.1441])
[rfa agg] iter:  4, prev_obj_val: 21.275043487548828, obj_val: 21.2744140625, abs dis: 0.000629425048828125
[rfa agg] iter:  4, weight: tensor([0.0021, 0.0022, 0.0025, 0.0017, 0.0847, 0.2965, 0.1538, 0.0967, 0.2159,
        0.1439])
___Test Target_Simple poisoned: False, epoch: 58: Average loss: 0.0729, Accuracy: 9774/10000 (97.7400%)
___Test Target_Simple poisoned: True, epoch: 58: Average loss: 0.0719, Accuracy: 8752/8968 (97.5914%)
Done in 153.22135543823242 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:59 choose agents : [41, 73, 51, 74, 40, 54, 46, 30, 78, 9]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.492491892323592.
Norm before scaling: 16.476748643151943. Distance: 0.5452078338997808
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1650, Accuracy: 9449/10000 (94.4900%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0270, Accuracy: 8894/8968 (99.1748%)
Scaling by  100
Scaled Norm after poisoning: 56.23957368648433, distance: 54.52078158830814
Total norm for 4 adversaries is: 56.23957368648433. distance: 54.52078158830814
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 182363.1277, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   1,  Average loss: 0.0004, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 16.492491892323592.
Norm before scaling: 16.461486256871105. Distance: 0.5312745425221213
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1008, Accuracy: 9677/10000 (96.7700%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0173, Accuracy: 8915/8968 (99.4090%)
Scaling by  100
Scaled Norm after poisoning: 54.44381421474803, distance: 53.12745168975146
Total norm for 4 adversaries is: 54.44381421474803. distance: 53.12745168975146
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 222654.7723, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.492491892323592.
Norm before scaling: 16.462235206322415. Distance: 0.4365545854827265
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1703, Accuracy: 9451/10000 (94.5100%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0162, Accuracy: 8917/8968 (99.4313%)
Scaling by  100
Scaled Norm after poisoning: 45.37659260290486, distance: 43.65545727850428
Total norm for 4 adversaries is: 45.37659260290486. distance: 43.65545727850428
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 60367.0246, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   1,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   2,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Global model norm: 16.492491892323592.
Norm before scaling: 16.480499766651306. Distance: 0.6525226050878855
will scale.
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1261, Accuracy: 9604/10000 (96.0400%)
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0016, Accuracy: 8959/8968 (99.8996%)
Scaling by  100
Scaled Norm after poisoning: 66.6913731888353, distance: 65.25226364009336
Total norm for 4 adversaries is: 66.6913731888353. distance: 65.25226364009336
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  59, local model 40, internal_epoch   1,  Average loss: 0.0009, Accuracy: 759/772 (98.3161%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1068, Accuracy: 9642/10000 (96.4200%)
___Train Local_Simple,  epoch  59, local model 54, internal_epoch   1,  Average loss: 0.0012, Accuracy: 506/519 (97.4952%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2088, Accuracy: 9299/10000 (92.9900%)
___Train Local_Simple,  epoch  59, local model 46, internal_epoch   1,  Average loss: 0.0015, Accuracy: 686/710 (96.6197%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2076, Accuracy: 9353/10000 (93.5300%)
___Train Local_Simple,  epoch  59, local model 30, internal_epoch   1,  Average loss: 0.0013, Accuracy: 391/400 (97.7500%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2387, Accuracy: 9263/10000 (92.6300%)
___Train Local_Simple,  epoch  59, local model 78, internal_epoch   1,  Average loss: 0.0009, Accuracy: 300/303 (99.0099%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1935, Accuracy: 9369/10000 (93.6900%)
___Train Local_Simple,  epoch  59, local model 9, internal_epoch   1,  Average loss: 0.0009, Accuracy: 427/436 (97.9358%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2350, Accuracy: 9236/10000 (92.3600%)
time spent on training: 108.39157271385193
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.42511900402782865  data num: [606, 591, 568, 557, 772, 519, 710, 400, 303, 436]
[rfa agg] considering poison per batch poison_fraction: 0.13284968875869646
[rfa agg] init. name: [41, 73, 51, 74, 40, 54, 46, 30, 78, 9], weight: tensor([0.1109, 0.1082, 0.1040, 0.1020, 0.1413, 0.0950, 0.1300, 0.0732, 0.0555,
        0.0798])
[rfa agg] iter:  0, prev_obj_val: 27.928691864013672, obj_val: 24.774072647094727, abs dis: 3.1546192169189453
[rfa agg] iter:  0, weight: tensor([0.0425, 0.0423, 0.0495, 0.0330, 0.2045, 0.1382, 0.1877, 0.1060, 0.0804,
        0.1158])
[rfa agg] iter:  1, prev_obj_val: 24.774072647094727, obj_val: 23.7595157623291, abs dis: 1.014556884765625
[rfa agg] iter:  1, weight: tensor([0.0172, 0.0172, 0.0204, 0.0131, 0.2282, 0.1563, 0.2088, 0.1186, 0.0899,
        0.1302])
[rfa agg] iter:  2, prev_obj_val: 23.7595157623291, obj_val: 23.43732261657715, abs dis: 0.3221931457519531
[rfa agg] iter:  2, weight: tensor([0.0074, 0.0074, 0.0087, 0.0057, 0.2357, 0.1662, 0.2124, 0.1240, 0.0947,
        0.1379])
[rfa agg] iter:  3, prev_obj_val: 23.43732261657715, obj_val: 23.371747970581055, abs dis: 0.06557464599609375
[rfa agg] iter:  3, weight: tensor([0.0038, 0.0039, 0.0045, 0.0030, 0.2342, 0.1733, 0.2024, 0.1278, 0.1007,
        0.1463])
[rfa agg] iter:  4, prev_obj_val: 23.371747970581055, obj_val: 23.365676879882812, abs dis: 0.0060710906982421875
[rfa agg] iter:  4, weight: tensor([0.0028, 0.0029, 0.0033, 0.0022, 0.2302, 0.1753, 0.1898, 0.1309, 0.1082,
        0.1544])
[rfa agg] iter:  5, prev_obj_val: 23.365676879882812, obj_val: 23.365379333496094, abs dis: 0.00029754638671875
[rfa agg] iter:  5, weight: tensor([0.0026, 0.0026, 0.0031, 0.0020, 0.2283, 0.1752, 0.1838, 0.1321, 0.1121,
        0.1581])
___Test Target_Simple poisoned: False, epoch: 59: Average loss: 0.0725, Accuracy: 9774/10000 (97.7400%)
___Test Target_Simple poisoned: True, epoch: 59: Average loss: 0.0664, Accuracy: 8765/8968 (97.7364%)
Done in 136.17213654518127 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:60 choose agents : [41, 73, 51, 74, 89, 4, 11, 24, 43, 23]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   1,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.48855841466288.
Norm before scaling: 16.46850261466235. Distance: 0.591158179155624
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1467, Accuracy: 9520/10000 (95.2000%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0327, Accuracy: 8877/8968 (98.9853%)
Scaling by  100
Scaled Norm after poisoning: 60.5434454673873, distance: 59.11581381795716
Total norm for 4 adversaries is: 60.5434454673873. distance: 59.11581381795716
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 156804.7512, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   1,  Average loss: 0.0004, Accuracy: 584/591 (98.8156%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.48855841466288.
Norm before scaling: 16.458854467454877. Distance: 0.5386559155529471
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1068, Accuracy: 9660/10000 (96.6000%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0087, Accuracy: 8939/8968 (99.6766%)
Scaling by  100
Scaled Norm after poisoning: 55.19505318852746, distance: 53.86558928466647
Total norm for 4 adversaries is: 55.19505318852746. distance: 53.86558928466647
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 234531.8341, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.48855841466288.
Norm before scaling: 16.45507615448801. Distance: 0.44454754831373644
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1662, Accuracy: 9469/10000 (94.6900%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0049, Accuracy: 8954/8968 (99.8439%)
Scaling by  100
Scaled Norm after poisoning: 46.02211329469101, distance: 44.45475474824445
Total norm for 4 adversaries is: 46.02211329469101. distance: 44.45475474824445
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 144.5336, Accuracy: 6648/8968 (74.1302%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   1,  Average loss: 0.0006, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   2,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.48855841466288.
Norm before scaling: 16.468563766439893. Distance: 0.569880465597395
will scale.
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1290, Accuracy: 9603/10000 (96.0300%)
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0021, Accuracy: 8959/8968 (99.8996%)
Scaling by  100
Scaled Norm after poisoning: 58.490490262707446, distance: 56.98804656392316
Total norm for 4 adversaries is: 58.490490262707446. distance: 56.98804656392316
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  60, local model 89, internal_epoch   1,  Average loss: 0.0007, Accuracy: 486/492 (98.7805%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1136, Accuracy: 9668/10000 (96.6800%)
___Train Local_Simple,  epoch  60, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 643/658 (97.7204%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1499, Accuracy: 9512/10000 (95.1200%)
___Train Local_Simple,  epoch  60, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 629/645 (97.5194%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2164, Accuracy: 9313/10000 (93.1300%)
___Train Local_Simple,  epoch  60, local model 24, internal_epoch   1,  Average loss: 0.0015, Accuracy: 367/379 (96.8338%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.0976, Accuracy: 9688/10000 (96.8800%)
___Train Local_Simple,  epoch  60, local model 43, internal_epoch   1,  Average loss: 0.0009, Accuracy: 399/408 (97.7941%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1813, Accuracy: 9412/10000 (94.1200%)
___Train Local_Simple,  epoch  60, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1954, Accuracy: 9302/10000 (93.0200%)
time spent on training: 119.22996807098389
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4467962285934193  data num: [606, 591, 568, 557, 492, 658, 645, 379, 408, 293]
[rfa agg] considering poison per batch poison_fraction: 0.13962382143544352
[rfa agg] init. name: [41, 73, 51, 74, 89, 4, 11, 24, 43, 23], weight: tensor([0.1166, 0.1137, 0.1093, 0.1072, 0.0947, 0.1266, 0.1241, 0.0729, 0.0785,
        0.0564])
[rfa agg] iter:  0, prev_obj_val: 28.593706130981445, obj_val: 25.6722412109375, abs dis: 2.9214649200439453
[rfa agg] iter:  0, weight: tensor([0.0411, 0.0440, 0.0519, 0.0398, 0.1417, 0.1878, 0.1838, 0.1088, 0.1169,
        0.0842])
[rfa agg] iter:  1, prev_obj_val: 25.6722412109375, obj_val: 24.716806411743164, abs dis: 0.9554347991943359
[rfa agg] iter:  1, weight: tensor([0.0171, 0.0185, 0.0218, 0.0165, 0.1610, 0.2103, 0.2048, 0.1230, 0.1318,
        0.0952])
[rfa agg] iter:  2, prev_obj_val: 24.716806411743164, obj_val: 24.386247634887695, abs dis: 0.33055877685546875
[rfa agg] iter:  2, weight: tensor([0.0075, 0.0081, 0.0095, 0.0072, 0.1720, 0.2171, 0.2079, 0.1306, 0.1386,
        0.1014])
[rfa agg] iter:  3, prev_obj_val: 24.386247634887695, obj_val: 24.30193519592285, abs dis: 0.08431243896484375
[rfa agg] iter:  3, weight: tensor([0.0038, 0.0041, 0.0047, 0.0036, 0.1812, 0.2145, 0.1954, 0.1394, 0.1440,
        0.1093])
[rfa agg] iter:  4, prev_obj_val: 24.30193519592285, obj_val: 24.29069709777832, abs dis: 0.01123809814453125
[rfa agg] iter:  4, weight: tensor([0.0025, 0.0027, 0.0032, 0.0024, 0.1857, 0.2075, 0.1765, 0.1505, 0.1492,
        0.1198])
[rfa agg] iter:  5, prev_obj_val: 24.29069709777832, obj_val: 24.289888381958008, abs dis: 0.0008087158203125
[rfa agg] iter:  5, weight: tensor([0.0022, 0.0024, 0.0028, 0.0021, 0.1864, 0.2029, 0.1655, 0.1574, 0.1520,
        0.1263])
[rfa agg] iter:  6, prev_obj_val: 24.289888381958008, obj_val: 24.28984260559082, abs dis: 4.57763671875e-05
[rfa agg] iter:  6, weight: tensor([0.0022, 0.0023, 0.0027, 0.0021, 0.1866, 0.2009, 0.1614, 0.1601, 0.1529,
        0.1287])
___Test Target_Simple poisoned: False, epoch: 60: Average loss: 0.0714, Accuracy: 9773/10000 (97.7300%)
___Test Target_Simple poisoned: True, epoch: 60: Average loss: 0.0643, Accuracy: 8773/8968 (97.8256%)
Done in 147.47211050987244 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:61 choose agents : [41, 73, 51, 74, 25, 97, 91, 57, 72, 15]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   1,  Average loss: 0.0004, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.48417876068027.
Norm before scaling: 16.466175898807492. Distance: 0.5237549630432964
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1519, Accuracy: 9493/10000 (94.9300%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0227, Accuracy: 8905/8968 (99.2975%)
Scaling by  100
Scaled Norm after poisoning: 54.112531040647134, distance: 52.37549876701653
Total norm for 4 adversaries is: 54.112531040647134. distance: 52.37549876701653
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 88124.8279, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   2,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.48417876068027.
Norm before scaling: 16.457056747695653. Distance: 0.5608971328874266
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1133, Accuracy: 9632/10000 (96.3200%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0049, Accuracy: 8954/8968 (99.8439%)
Scaling by  100
Scaled Norm after poisoning: 57.41929628563467, distance: 56.08971303370276
Total norm for 4 adversaries is: 57.41929628563467. distance: 56.08971303370276
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 308867.5334, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 562/568 (98.9437%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.48417876068027.
Norm before scaling: 16.44797892575825. Distance: 0.4265071909891933
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1749, Accuracy: 9435/10000 (94.3500%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0125, Accuracy: 8924/8968 (99.5094%)
Scaling by  100
Scaled Norm after poisoning: 44.19734049947533, distance: 42.650716502352715
Total norm for 4 adversaries is: 44.19734049947533. distance: 42.650716502352715
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 10335.2350, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   1,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   4,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Global model norm: 16.48417876068027.
Norm before scaling: 16.460754885970925. Distance: 0.5083492376882917
will scale.
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1090, Accuracy: 9662/10000 (96.6200%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0026, Accuracy: 8957/8968 (99.8773%)
Scaling by  100
Scaled Norm after poisoning: 52.468107872783065, distance: 50.834928360392624
Total norm for 4 adversaries is: 52.468107872783065. distance: 50.834928360392624
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  61, local model 25, internal_epoch   1,  Average loss: 0.0011, Accuracy: 634/647 (97.9907%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2879, Accuracy: 9067/10000 (90.6700%)
___Train Local_Simple,  epoch  61, local model 97, internal_epoch   1,  Average loss: 0.0008, Accuracy: 477/487 (97.9466%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.3348, Accuracy: 8959/10000 (89.5900%)
___Train Local_Simple,  epoch  61, local model 91, internal_epoch   1,  Average loss: 0.0005, Accuracy: 253/256 (98.8281%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.0863, Accuracy: 9745/10000 (97.4500%)
___Train Local_Simple,  epoch  61, local model 57, internal_epoch   1,  Average loss: 0.0017, Accuracy: 330/343 (96.2099%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2694, Accuracy: 9143/10000 (91.4300%)
___Train Local_Simple,  epoch  61, local model 72, internal_epoch   1,  Average loss: 0.0006, Accuracy: 723/731 (98.9056%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2037, Accuracy: 9292/10000 (92.9200%)
___Train Local_Simple,  epoch  61, local model 15, internal_epoch   1,  Average loss: 0.0015, Accuracy: 392/401 (97.7556%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1098, Accuracy: 9634/10000 (96.3400%)
time spent on training: 127.36638689041138
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4476576055523424  data num: [606, 591, 568, 557, 647, 487, 256, 343, 731, 401]
[rfa agg] considering poison per batch poison_fraction: 0.139893001735107
[rfa agg] init. name: [41, 73, 51, 74, 25, 97, 91, 57, 72, 15], weight: tensor([0.1168, 0.1139, 0.1095, 0.1074, 0.1247, 0.0939, 0.0494, 0.0661, 0.1409,
        0.0773])
[rfa agg] iter:  0, prev_obj_val: 27.047149658203125, obj_val: 24.310522079467773, abs dis: 2.7366275787353516
[rfa agg] iter:  0, weight: tensor([0.0454, 0.0418, 0.0523, 0.0441, 0.1851, 0.1381, 0.0734, 0.0985, 0.2071,
        0.1142])
[rfa agg] iter:  1, prev_obj_val: 24.310522079467773, obj_val: 23.39293670654297, abs dis: 0.9175853729248047
[rfa agg] iter:  1, weight: tensor([0.0197, 0.0179, 0.0230, 0.0188, 0.2098, 0.1547, 0.0838, 0.1123, 0.2311,
        0.1289])
[rfa agg] iter:  2, prev_obj_val: 23.39293670654297, obj_val: 23.070636749267578, abs dis: 0.3222999572753906
[rfa agg] iter:  2, weight: tensor([0.0090, 0.0082, 0.0104, 0.0085, 0.2193, 0.1595, 0.0910, 0.1204, 0.2376,
        0.1361])
[rfa agg] iter:  3, prev_obj_val: 23.070636749267578, obj_val: 22.987300872802734, abs dis: 0.08333587646484375
[rfa agg] iter:  3, weight: tensor([0.0047, 0.0043, 0.0054, 0.0044, 0.2145, 0.1581, 0.1022, 0.1265, 0.2364,
        0.1436])
[rfa agg] iter:  4, prev_obj_val: 22.987300872802734, obj_val: 22.975481033325195, abs dis: 0.011819839477539062
[rfa agg] iter:  4, weight: tensor([0.0032, 0.0030, 0.0037, 0.0031, 0.1974, 0.1547, 0.1179, 0.1281, 0.2352,
        0.1536])
[rfa agg] iter:  5, prev_obj_val: 22.975481033325195, obj_val: 22.97444725036621, abs dis: 0.001033782958984375
[rfa agg] iter:  5, weight: tensor([0.0029, 0.0026, 0.0033, 0.0027, 0.1841, 0.1527, 0.1279, 0.1269, 0.2366,
        0.1604])
[rfa agg] iter:  6, prev_obj_val: 22.97444725036621, obj_val: 22.9743595123291, abs dis: 8.7738037109375e-05
[rfa agg] iter:  6, weight: tensor([0.0028, 0.0025, 0.0032, 0.0026, 0.1781, 0.1519, 0.1315, 0.1262, 0.2382,
        0.1631])
___Test Target_Simple poisoned: False, epoch: 61: Average loss: 0.0716, Accuracy: 9778/10000 (97.7800%)
___Test Target_Simple poisoned: True, epoch: 61: Average loss: 0.0566, Accuracy: 8796/8968 (98.0821%)
Done in 155.54491305351257 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:62 choose agents : [41, 73, 51, 74, 94, 95, 90, 69, 20, 81]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   1,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   3,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.478960900000644.
Norm before scaling: 16.460075395673314. Distance: 0.5238737594218437
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1445, Accuracy: 9529/10000 (95.2900%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0345, Accuracy: 8865/8968 (98.8515%)
Scaling by  100
Scaled Norm after poisoning: 54.09568165239717, distance: 52.387372214858466
Total norm for 4 adversaries is: 54.09568165239717. distance: 52.387372214858466
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 175881.1708, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   1,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 16.478960900000644.
Norm before scaling: 16.453102742150186. Distance: 0.4893231376849114
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.0910, Accuracy: 9713/10000 (97.1300%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0137, Accuracy: 8924/8968 (99.5094%)
Scaling by  100
Scaled Norm after poisoning: 50.565056621859675, distance: 48.932313841577376
Total norm for 4 adversaries is: 50.565056621859675. distance: 48.932313841577376
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 101789.0220, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 16.478960900000644.
Norm before scaling: 16.44580054204568. Distance: 0.41958471557796106
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1584, Accuracy: 9493/10000 (94.9300%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0044, Accuracy: 8956/8968 (99.8662%)
Scaling by  100
Scaled Norm after poisoning: 43.649579225939426, distance: 41.95846974799903
Total norm for 4 adversaries is: 43.649579225939426. distance: 41.95846974799903
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   1,  Average loss: 0.0006, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.478960900000644.
Norm before scaling: 16.45571505165692. Distance: 0.5232535935910502
will scale.
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1000, Accuracy: 9694/10000 (96.9400%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0044, Accuracy: 8952/8968 (99.8216%)
Scaling by  100
Scaled Norm after poisoning: 53.9032245527807, distance: 52.32535824277149
Total norm for 4 adversaries is: 53.9032245527807. distance: 52.32535824277149
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 22542.3454, Accuracy: 3/8968 (0.0335%)
___Train Local_Simple,  epoch  62, local model 94, internal_epoch   1,  Average loss: 0.0020, Accuracy: 144/150 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1692, Accuracy: 9461/10000 (94.6100%)
___Train Local_Simple,  epoch  62, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 597/602 (99.1694%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.8814, Accuracy: 7718/10000 (77.1800%)
___Train Local_Simple,  epoch  62, local model 90, internal_epoch   1,  Average loss: 0.0014, Accuracy: 666/683 (97.5110%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.4075, Accuracy: 8653/10000 (86.5300%)
___Train Local_Simple,  epoch  62, local model 69, internal_epoch   1,  Average loss: 0.0015, Accuracy: 249/256 (97.2656%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1400, Accuracy: 9535/10000 (95.3500%)
___Train Local_Simple,  epoch  62, local model 20, internal_epoch   1,  Average loss: 0.0011, Accuracy: 421/429 (98.1352%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.2370, Accuracy: 9233/10000 (92.3300%)
___Train Local_Simple,  epoch  62, local model 81, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1208/1227 (98.4515%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.3170, Accuracy: 9145/10000 (91.4500%)
time spent on training: 117.00869059562683
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.40959604868583527  data num: [606, 591, 568, 557, 150, 602, 683, 256, 429, 1227]
[rfa agg] considering poison per batch poison_fraction: 0.12799876521432352
[rfa agg] init. name: [41, 73, 51, 74, 94, 95, 90, 69, 20, 81], weight: tensor([0.1069, 0.1043, 0.1002, 0.0983, 0.0265, 0.1062, 0.1205, 0.0452, 0.0757,
        0.2164])
[rfa agg] iter:  0, prev_obj_val: 24.48247528076172, obj_val: 21.57628631591797, abs dis: 2.90618896484375
[rfa agg] iter:  0, weight: tensor([0.0356, 0.0369, 0.0419, 0.0329, 0.0384, 0.1534, 0.1733, 0.0651, 0.1103,
        0.3122])
[rfa agg] iter:  1, prev_obj_val: 21.57628631591797, obj_val: 20.710660934448242, abs dis: 0.8656253814697266
[rfa agg] iter:  1, weight: tensor([0.0134, 0.0140, 0.0158, 0.0123, 0.0431, 0.1694, 0.1901, 0.0723, 0.1245,
        0.3451])
[rfa agg] iter:  2, prev_obj_val: 20.710660934448242, obj_val: 20.49510383605957, abs dis: 0.21555709838867188
[rfa agg] iter:  2, weight: tensor([0.0056, 0.0059, 0.0066, 0.0052, 0.0469, 0.1720, 0.1891, 0.0771, 0.1352,
        0.3565])
[rfa agg] iter:  3, prev_obj_val: 20.49510383605957, obj_val: 20.46914291381836, abs dis: 0.025960922241210938
[rfa agg] iter:  3, weight: tensor([0.0033, 0.0034, 0.0038, 0.0030, 0.0529, 0.1654, 0.1772, 0.0852, 0.1445,
        0.3612])
[rfa agg] iter:  4, prev_obj_val: 20.46914291381836, obj_val: 20.467920303344727, abs dis: 0.0012226104736328125
[rfa agg] iter:  4, weight: tensor([0.0028, 0.0029, 0.0033, 0.0026, 0.0564, 0.1609, 0.1698, 0.0911, 0.1465,
        0.3638])
[rfa agg] iter:  5, prev_obj_val: 20.467920303344727, obj_val: 20.46788787841797, abs dis: 3.24249267578125e-05
[rfa agg] iter:  5, weight: tensor([0.0027, 0.0028, 0.0032, 0.0025, 0.0570, 0.1597, 0.1677, 0.0925, 0.1464,
        0.3654])
___Test Target_Simple poisoned: False, epoch: 62: Average loss: 0.0706, Accuracy: 9778/10000 (97.7800%)
___Test Target_Simple poisoned: True, epoch: 62: Average loss: 0.0529, Accuracy: 8805/8968 (98.1824%)
Done in 138.04213190078735 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:63 choose agents : [41, 73, 51, 74, 59, 21, 69, 14, 28, 22]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.47348851866566.
Norm before scaling: 16.456117479230464. Distance: 0.5458313383789103
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1461, Accuracy: 9521/10000 (95.2100%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0337, Accuracy: 8873/8968 (98.9407%)
Scaling by  100
Scaled Norm after poisoning: 56.24678159195533, distance: 54.58313031729103
Total norm for 4 adversaries is: 56.24678159195533. distance: 54.58313031729103
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 59135.9792, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   1,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   2,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   3,  Average loss: 0.0003, Accuracy: 587/591 (99.3232%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.47348851866566.
Norm before scaling: 16.441393721039418. Distance: 0.4497175681405028
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.0973, Accuracy: 9676/10000 (96.7600%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0087, Accuracy: 8939/8968 (99.6766%)
Scaling by  100
Scaled Norm after poisoning: 46.561459195582295, distance: 44.97175763048405
Total norm for 4 adversaries is: 46.561459195582295. distance: 44.97175763048405
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 92960.0509, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.47348851866566.
Norm before scaling: 16.4340203957275. Distance: 0.3586678804388272
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1519, Accuracy: 9511/10000 (95.1100%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0165, Accuracy: 8915/8968 (99.4090%)
Scaling by  100
Scaled Norm after poisoning: 37.617259702682524, distance: 35.86678674765224
Total norm for 4 adversaries is: 37.617259702682524. distance: 35.86678674765224
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 21713.1841, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   1,  Average loss: 0.0005, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   2,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.47348851866566.
Norm before scaling: 16.462869191356614. Distance: 0.5571403268216911
will scale.
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1097, Accuracy: 9667/10000 (96.6700%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0019, Accuracy: 8959/8968 (99.8996%)
Scaling by  100
Scaled Norm after poisoning: 57.52749215388782, distance: 55.714032943208075
Total norm for 4 adversaries is: 57.52749215388782. distance: 55.714032943208075
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 42772.1598, Accuracy: 4/8968 (0.0446%)
___Train Local_Simple,  epoch  63, local model 59, internal_epoch   1,  Average loss: 0.0012, Accuracy: 740/760 (97.3684%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2273, Accuracy: 9231/10000 (92.3100%)
___Train Local_Simple,  epoch  63, local model 21, internal_epoch   1,  Average loss: 0.0011, Accuracy: 303/312 (97.1154%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2110, Accuracy: 9305/10000 (93.0500%)
___Train Local_Simple,  epoch  63, local model 69, internal_epoch   1,  Average loss: 0.0017, Accuracy: 248/256 (96.8750%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2211, Accuracy: 9256/10000 (92.5600%)
___Train Local_Simple,  epoch  63, local model 14, internal_epoch   1,  Average loss: 0.0011, Accuracy: 370/376 (98.4043%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1110, Accuracy: 9673/10000 (96.7300%)
___Train Local_Simple,  epoch  63, local model 28, internal_epoch   1,  Average loss: 0.0014, Accuracy: 486/501 (97.0060%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1155, Accuracy: 9602/10000 (96.0200%)
___Train Local_Simple,  epoch  63, local model 22, internal_epoch   1,  Average loss: 0.0014, Accuracy: 566/583 (97.0840%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1464, Accuracy: 9545/10000 (95.4500%)
time spent on training: 117.09636855125427
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.4544031311154599  data num: [606, 591, 568, 557, 760, 312, 256, 376, 501, 583]
[rfa agg] considering poison per batch poison_fraction: 0.1420009784735812
[rfa agg] init. name: [41, 73, 51, 74, 59, 21, 69, 14, 28, 22], weight: tensor([0.1186, 0.1157, 0.1112, 0.1090, 0.1487, 0.0611, 0.0501, 0.0736, 0.0980,
        0.1141])
[rfa agg] iter:  0, prev_obj_val: 25.88144874572754, obj_val: 23.261213302612305, abs dis: 2.6202354431152344
[rfa agg] iter:  0, weight: tensor([0.0417, 0.0490, 0.0588, 0.0379, 0.2203, 0.0910, 0.0747, 0.1103, 0.1461,
        0.1701])
[rfa agg] iter:  1, prev_obj_val: 23.261213302612305, obj_val: 22.424962997436523, abs dis: 0.8362503051757812
[rfa agg] iter:  1, weight: tensor([0.0176, 0.0211, 0.0258, 0.0160, 0.2466, 0.1036, 0.0849, 0.1264, 0.1654,
        0.1926])
[rfa agg] iter:  2, prev_obj_val: 22.424962997436523, obj_val: 22.14274024963379, abs dis: 0.2822227478027344
[rfa agg] iter:  2, weight: tensor([0.0081, 0.0096, 0.0116, 0.0073, 0.2499, 0.1103, 0.0904, 0.1371, 0.1740,
        0.2018])
[rfa agg] iter:  3, prev_obj_val: 22.14274024963379, obj_val: 22.0750732421875, abs dis: 0.06766700744628906
[rfa agg] iter:  3, weight: tensor([0.0043, 0.0051, 0.0062, 0.0039, 0.2342, 0.1164, 0.0961, 0.1510, 0.1790,
        0.2038])
[rfa agg] iter:  4, prev_obj_val: 22.0750732421875, obj_val: 22.06637191772461, abs dis: 0.008701324462890625
[rfa agg] iter:  4, weight: tensor([0.0031, 0.0036, 0.0044, 0.0028, 0.2122, 0.1221, 0.1022, 0.1655, 0.1824,
        0.2017])
[rfa agg] iter:  5, prev_obj_val: 22.06637191772461, obj_val: 22.065673828125, abs dis: 0.000698089599609375
[rfa agg] iter:  5, weight: tensor([0.0028, 0.0033, 0.0039, 0.0025, 0.1990, 0.1254, 0.1059, 0.1730, 0.1841,
        0.2002])
[rfa agg] iter:  6, prev_obj_val: 22.065673828125, obj_val: 22.065622329711914, abs dis: 5.14984130859375e-05
[rfa agg] iter:  6, weight: tensor([0.0027, 0.0032, 0.0038, 0.0024, 0.1936, 0.1268, 0.1074, 0.1755, 0.1848,
        0.1998])
___Test Target_Simple poisoned: False, epoch: 63: Average loss: 0.0707, Accuracy: 9775/10000 (97.7500%)
___Test Target_Simple poisoned: True, epoch: 63: Average loss: 0.0511, Accuracy: 8813/8968 (98.2716%)
Done in 145.47621154785156 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:64 choose agents : [41, 73, 51, 74, 72, 97, 37, 50, 42, 52]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   3,  Average loss: 0.0003, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.467883671770124.
Norm before scaling: 16.445880334614767. Distance: 0.455235253577549
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1411, Accuracy: 9539/10000 (95.3900%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0220, Accuracy: 8908/8968 (99.3310%)
Scaling by  100
Scaled Norm after poisoning: 47.43879691903032, distance: 45.52352263699779
Total norm for 4 adversaries is: 47.43879691903032. distance: 45.52352263699779
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 145196.4068, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   1,  Average loss: 0.0004, Accuracy: 586/591 (99.1540%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   2,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.467883671770124.
Norm before scaling: 16.43552262048864. Distance: 0.5100095611031333
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1035, Accuracy: 9656/10000 (96.5600%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0037, Accuracy: 8952/8968 (99.8216%)
Scaling by  100
Scaled Norm after poisoning: 52.3430736896607, distance: 51.00095979871972
Total norm for 4 adversaries is: 52.3430736896607. distance: 51.00095979871972
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 170663.1951, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 16.467883671770124.
Norm before scaling: 16.43844218871718. Distance: 0.3859538016949808
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1817, Accuracy: 9423/10000 (94.2300%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0125, Accuracy: 8929/8968 (99.5651%)
Scaling by  100
Scaled Norm after poisoning: 40.60808391801056, distance: 38.595378887690366
Total norm for 4 adversaries is: 40.60808391801056. distance: 38.595378887690366
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 11854.3427, Accuracy: 21/8968 (0.2342%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   1,  Average loss: 0.0006, Accuracy: 548/557 (98.3842%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.467883671770124.
Norm before scaling: 16.450669035597002. Distance: 0.5921890168183158
will scale.
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1382, Accuracy: 9573/10000 (95.7300%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0016, Accuracy: 8962/8968 (99.9331%)
Scaling by  100
Scaled Norm after poisoning: 60.71516531170878, distance: 59.218902539381375
Total norm for 4 adversaries is: 60.71516531170878. distance: 59.218902539381375
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 154515.5509, Accuracy: 0/8968 (0.0000%)
___Train Local_Simple,  epoch  64, local model 72, internal_epoch   1,  Average loss: 0.0007, Accuracy: 720/731 (98.4952%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.2631, Accuracy: 8979/10000 (89.7900%)
___Train Local_Simple,  epoch  64, local model 97, internal_epoch   1,  Average loss: 0.0007, Accuracy: 478/487 (98.1520%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.2807, Accuracy: 9061/10000 (90.6100%)
___Train Local_Simple,  epoch  64, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 846/860 (98.3721%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1948, Accuracy: 9409/10000 (94.0900%)
___Train Local_Simple,  epoch  64, local model 50, internal_epoch   1,  Average loss: 0.0016, Accuracy: 457/474 (96.4135%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1792, Accuracy: 9432/10000 (94.3200%)
___Train Local_Simple,  epoch  64, local model 42, internal_epoch   1,  Average loss: 0.0013, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.0876, Accuracy: 9717/10000 (97.1700%)
___Train Local_Simple,  epoch  64, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1181, Accuracy: 9636/10000 (96.3600%)
time spent on training: 108.8580813407898
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.43296662315867984  data num: [606, 591, 568, 557, 731, 487, 860, 474, 236, 253]
[rfa agg] considering poison per batch poison_fraction: 0.13530206973708744
[rfa agg] init. name: [41, 73, 51, 74, 72, 97, 37, 50, 42, 52], weight: tensor([0.1130, 0.1102, 0.1059, 0.1039, 0.1363, 0.0908, 0.1604, 0.0884, 0.0440,
        0.0472])
[rfa agg] iter:  0, prev_obj_val: 25.41736602783203, obj_val: 22.650074005126953, abs dis: 2.767292022705078
[rfa agg] iter:  0, weight: tensor([0.0480, 0.0417, 0.0534, 0.0343, 0.1969, 0.1309, 0.2342, 0.1279, 0.0641,
        0.0686])
[rfa agg] iter:  1, prev_obj_val: 22.650074005126953, obj_val: 21.735828399658203, abs dis: 0.91424560546875
[rfa agg] iter:  1, weight: tensor([0.0204, 0.0176, 0.0228, 0.0142, 0.2199, 0.1455, 0.2661, 0.1433, 0.0727,
        0.0775])
[rfa agg] iter:  2, prev_obj_val: 21.735828399658203, obj_val: 21.424968719482422, abs dis: 0.31085968017578125
[rfa agg] iter:  2, weight: tensor([0.0090, 0.0078, 0.0100, 0.0064, 0.2261, 0.1486, 0.2824, 0.1487, 0.0782,
        0.0826])
[rfa agg] iter:  3, prev_obj_val: 21.424968719482422, obj_val: 21.351539611816406, abs dis: 0.07342910766601562
[rfa agg] iter:  3, weight: tensor([0.0047, 0.0041, 0.0052, 0.0033, 0.2226, 0.1460, 0.2880, 0.1497, 0.0864,
        0.0899])
[rfa agg] iter:  4, prev_obj_val: 21.351539611816406, obj_val: 21.34292221069336, abs dis: 0.008617401123046875
[rfa agg] iter:  4, weight: tensor([0.0033, 0.0029, 0.0037, 0.0024, 0.2164, 0.1438, 0.2808, 0.1493, 0.0974,
        0.1000])
[rfa agg] iter:  5, prev_obj_val: 21.34292221069336, obj_val: 21.34235954284668, abs dis: 0.0005626678466796875
[rfa agg] iter:  5, weight: tensor([0.0030, 0.0026, 0.0033, 0.0021, 0.2133, 0.1439, 0.2727, 0.1492, 0.1038,
        0.1060])
[rfa agg] iter:  6, prev_obj_val: 21.34235954284668, obj_val: 21.342330932617188, abs dis: 2.86102294921875e-05
[rfa agg] iter:  6, weight: tensor([0.0029, 0.0026, 0.0033, 0.0021, 0.2124, 0.1445, 0.2686, 0.1494, 0.1060,
        0.1082])
___Test Target_Simple poisoned: False, epoch: 64: Average loss: 0.0705, Accuracy: 9776/10000 (97.7600%)
___Test Target_Simple poisoned: True, epoch: 64: Average loss: 0.0469, Accuracy: 8827/8968 (98.4277%)
Done in 137.02492761611938 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:65 choose agents : [41, 73, 51, 74, 75, 62, 42, 43, 87, 26]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   1,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   2,  Average loss: 0.0005, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.462456733108006.
Norm before scaling: 16.443521651303136. Distance: 0.5082224731515351
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1515, Accuracy: 9493/10000 (94.9300%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0251, Accuracy: 8897/8968 (99.2083%)
Scaling by  100
Scaled Norm after poisoning: 52.59063047789501, distance: 50.82224787340924
Total norm for 4 adversaries is: 52.59063047789501. distance: 50.82224787340924
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 140715.5930, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   1,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   2,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   3,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.462456733108006.
Norm before scaling: 16.428833043639504. Distance: 0.42042835652545546
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.0898, Accuracy: 9701/10000 (97.0100%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0115, Accuracy: 8931/8968 (99.5874%)
Scaling by  100
Scaled Norm after poisoning: 43.70746676904517, distance: 42.042836460641546
Total norm for 4 adversaries is: 43.70746676904517. distance: 42.042836460641546
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 89831.8202, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   1,  Average loss: 0.0002, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.462456733108006.
Norm before scaling: 16.425217829962524. Distance: 0.37438103137626766
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1617, Accuracy: 9479/10000 (94.7900%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0115, Accuracy: 8928/8968 (99.5540%)
Scaling by  100
Scaled Norm after poisoning: 39.19359097151201, distance: 37.43810321404685
Total norm for 4 adversaries is: 39.19359097151201. distance: 37.43810321404685
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 4735.2920, Accuracy: 19/8968 (0.2119%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   1,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 16.462456733108006.
Norm before scaling: 16.44560662593271. Distance: 0.5765585684706874
will scale.
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1267, Accuracy: 9618/10000 (96.1800%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0030, Accuracy: 8956/8968 (99.8662%)
Scaling by  100
Scaled Norm after poisoning: 59.21582693973166, distance: 57.65585831506522
Total norm for 4 adversaries is: 59.21582693973166. distance: 57.65585831506522
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 8146.3256, Accuracy: 864/8968 (9.6343%)
___Train Local_Simple,  epoch  65, local model 75, internal_epoch   1,  Average loss: 0.0010, Accuracy: 671/686 (97.8134%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1001, Accuracy: 9659/10000 (96.5900%)
___Train Local_Simple,  epoch  65, local model 62, internal_epoch   1,  Average loss: 0.0008, Accuracy: 419/423 (99.0544%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.0965, Accuracy: 9695/10000 (96.9500%)
___Train Local_Simple,  epoch  65, local model 42, internal_epoch   1,  Average loss: 0.0010, Accuracy: 230/236 (97.4576%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.0976, Accuracy: 9683/10000 (96.8300%)
___Train Local_Simple,  epoch  65, local model 43, internal_epoch   1,  Average loss: 0.0017, Accuracy: 398/408 (97.5490%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1106, Accuracy: 9654/10000 (96.5400%)
___Train Local_Simple,  epoch  65, local model 87, internal_epoch   1,  Average loss: 0.0008, Accuracy: 462/470 (98.2979%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1295, Accuracy: 9584/10000 (95.8400%)
___Train Local_Simple,  epoch  65, local model 26, internal_epoch   1,  Average loss: 0.0010, Accuracy: 541/554 (97.6534%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1511, Accuracy: 9533/10000 (95.3300%)
time spent on training: 127.53587555885315
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.45538340851147285  data num: [606, 591, 568, 557, 686, 423, 236, 408, 470, 554]
[rfa agg] considering poison per batch poison_fraction: 0.14230731515983527
[rfa agg] init. name: [41, 73, 51, 74, 75, 62, 42, 43, 87, 26], weight: tensor([0.1188, 0.1159, 0.1114, 0.1092, 0.1345, 0.0830, 0.0463, 0.0800, 0.0922,
        0.1086])
[rfa agg] iter:  0, prev_obj_val: 25.445510864257812, obj_val: 22.86754035949707, abs dis: 2.577970504760742
[rfa agg] iter:  0, weight: tensor([0.0447, 0.0511, 0.0556, 0.0361, 0.1990, 0.1245, 0.0692, 0.1188, 0.1386,
        0.1624])
[rfa agg] iter:  1, prev_obj_val: 22.86754035949707, obj_val: 22.034746170043945, abs dis: 0.832794189453125
[rfa agg] iter:  1, weight: tensor([0.0188, 0.0222, 0.0242, 0.0151, 0.2223, 0.1425, 0.0788, 0.1335, 0.1590,
        0.1837])
[rfa agg] iter:  2, prev_obj_val: 22.034746170043945, obj_val: 21.740936279296875, abs dis: 0.2938098907470703
[rfa agg] iter:  2, weight: tensor([0.0084, 0.0099, 0.0108, 0.0068, 0.2257, 0.1539, 0.0842, 0.1382, 0.1706,
        0.1914])
[rfa agg] iter:  3, prev_obj_val: 21.740936279296875, obj_val: 21.66222381591797, abs dis: 0.07871246337890625
[rfa agg] iter:  3, weight: tensor([0.0043, 0.0050, 0.0054, 0.0035, 0.2154, 0.1693, 0.0906, 0.1392, 0.1778,
        0.1894])
[rfa agg] iter:  4, prev_obj_val: 21.66222381591797, obj_val: 21.650814056396484, abs dis: 0.011409759521484375
[rfa agg] iter:  4, weight: tensor([0.0029, 0.0034, 0.0036, 0.0023, 0.2009, 0.1903, 0.0996, 0.1409, 0.1762,
        0.1800])
[rfa agg] iter:  5, prev_obj_val: 21.650814056396484, obj_val: 21.64990997314453, abs dis: 0.000904083251953125
[rfa agg] iter:  5, weight: tensor([0.0025, 0.0029, 0.0032, 0.0020, 0.1926, 0.2043, 0.1057, 0.1428, 0.1713,
        0.1727])
[rfa agg] iter:  6, prev_obj_val: 21.64990997314453, obj_val: 21.64985466003418, abs dis: 5.53131103515625e-05
[rfa agg] iter:  6, weight: tensor([0.0024, 0.0028, 0.0030, 0.0019, 0.1894, 0.2100, 0.1081, 0.1437, 0.1689,
        0.1697])
___Test Target_Simple poisoned: False, epoch: 65: Average loss: 0.0704, Accuracy: 9772/10000 (97.7200%)
___Test Target_Simple poisoned: True, epoch: 65: Average loss: 0.0431, Accuracy: 8838/8968 (98.5504%)
Done in 155.63417553901672 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:66 choose agents : [41, 73, 51, 74, 49, 52, 36, 55, 83, 33]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 16.458344561737995.
Norm before scaling: 16.440148201898626. Distance: 0.5388645140252155
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1586, Accuracy: 9477/10000 (94.7700%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0133, Accuracy: 8927/8968 (99.5428%)
Scaling by  100
Scaled Norm after poisoning: 55.54929231730252, distance: 53.88645243342129
Total norm for 4 adversaries is: 55.54929231730252. distance: 53.88645243342129
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 10.1075, Accuracy: 8939/8968 (99.6766%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   1,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 73, internal_epoch  10,  Average loss: 0.0000, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 16.458344561737995.
Norm before scaling: 16.428426232495994. Distance: 0.419682154873507
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.0917, Accuracy: 9709/10000 (97.0900%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0205, Accuracy: 8912/8968 (99.3756%)
Scaling by  100
Scaled Norm after poisoning: 43.77444071780072, distance: 41.96821772279739
Total norm for 4 adversaries is: 43.77444071780072. distance: 41.96821772279739
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 133806.9253, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   5,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.458344561737995.
Norm before scaling: 16.426432898042904. Distance: 0.389559742864396
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1526, Accuracy: 9522/10000 (95.2200%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0047, Accuracy: 8949/8968 (99.7881%)
Scaling by  100
Scaled Norm after poisoning: 40.84513225711924, distance: 38.9559703633875
Total norm for 4 adversaries is: 40.84513225711924. distance: 38.9559703633875
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 18794.9232, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   1,  Average loss: 0.0007, Accuracy: 549/557 (98.5637%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.458344561737995.
Norm before scaling: 16.43740252911928. Distance: 0.5814339818289336
will scale.
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1222, Accuracy: 9616/10000 (96.1600%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0015, Accuracy: 8963/8968 (99.9442%)
Scaling by  100
Scaled Norm after poisoning: 59.572090649690985, distance: 58.14339636635982
Total norm for 4 adversaries is: 59.572090649690985. distance: 58.14339636635982
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 10458.7410, Accuracy: 926/8968 (10.3256%)
___Train Local_Simple,  epoch  66, local model 49, internal_epoch   1,  Average loss: 0.0007, Accuracy: 498/506 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1143, Accuracy: 9632/10000 (96.3200%)
___Train Local_Simple,  epoch  66, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1580, Accuracy: 9499/10000 (94.9900%)
___Train Local_Simple,  epoch  66, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 984/1005 (97.9104%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1514, Accuracy: 9497/10000 (94.9700%)
___Train Local_Simple,  epoch  66, local model 55, internal_epoch   1,  Average loss: 0.0013, Accuracy: 347/354 (98.0226%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1796, Accuracy: 9391/10000 (93.9100%)
___Train Local_Simple,  epoch  66, local model 83, internal_epoch   1,  Average loss: 0.0012, Accuracy: 423/433 (97.6905%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.0743, Accuracy: 9772/10000 (97.7200%)
___Train Local_Simple,  epoch  66, local model 33, internal_epoch   1,  Average loss: 0.0015, Accuracy: 604/623 (96.9502%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.3567, Accuracy: 8809/10000 (88.0900%)
time spent on training: 119.01780104637146
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.42248908296943233  data num: [606, 591, 568, 557, 506, 253, 1005, 354, 433, 623]
[rfa agg] considering poison per batch poison_fraction: 0.1320278384279476
[rfa agg] init. name: [41, 73, 51, 74, 49, 52, 36, 55, 83, 33], weight: tensor([0.1103, 0.1075, 0.1033, 0.1013, 0.0921, 0.0460, 0.1829, 0.0644, 0.0788,
        0.1134])
[rfa agg] iter:  0, prev_obj_val: 24.775768280029297, obj_val: 21.933565139770508, abs dis: 2.842203140258789
[rfa agg] iter:  0, weight: tensor([0.0372, 0.0456, 0.0487, 0.0318, 0.1338, 0.0669, 0.2640, 0.0940, 0.1145,
        0.1634])
[rfa agg] iter:  1, prev_obj_val: 21.933565139770508, obj_val: 21.053714752197266, abs dis: 0.8798503875732422
[rfa agg] iter:  1, weight: tensor([0.0146, 0.0185, 0.0194, 0.0125, 0.1514, 0.0755, 0.2921, 0.1072, 0.1291,
        0.1798])
[rfa agg] iter:  2, prev_obj_val: 21.053714752197266, obj_val: 20.796661376953125, abs dis: 0.2570533752441406
[rfa agg] iter:  2, weight: tensor([0.0063, 0.0079, 0.0082, 0.0054, 0.1631, 0.0811, 0.2954, 0.1156, 0.1380,
        0.1790])
[rfa agg] iter:  3, prev_obj_val: 20.796661376953125, obj_val: 20.752784729003906, abs dis: 0.04387664794921875
[rfa agg] iter:  3, weight: tensor([0.0034, 0.0043, 0.0044, 0.0029, 0.1784, 0.0894, 0.2817, 0.1208, 0.1481,
        0.1665])
[rfa agg] iter:  4, prev_obj_val: 20.752784729003906, obj_val: 20.749267578125, abs dis: 0.00351715087890625
[rfa agg] iter:  4, weight: tensor([0.0027, 0.0034, 0.0035, 0.0023, 0.1921, 0.0974, 0.2654, 0.1207, 0.1564,
        0.1561])
[rfa agg] iter:  5, prev_obj_val: 20.749267578125, obj_val: 20.74903106689453, abs dis: 0.00023651123046875
[rfa agg] iter:  5, weight: tensor([0.0025, 0.0032, 0.0033, 0.0021, 0.1993, 0.1011, 0.2555, 0.1205, 0.1605,
        0.1520])
[rfa agg] iter:  6, prev_obj_val: 20.74903106689453, obj_val: 20.749006271362305, abs dis: 2.47955322265625e-05
[rfa agg] iter:  6, weight: tensor([0.0025, 0.0031, 0.0032, 0.0021, 0.2024, 0.1024, 0.2508, 0.1207, 0.1622,
        0.1506])
___Test Target_Simple poisoned: False, epoch: 66: Average loss: 0.0697, Accuracy: 9778/10000 (97.7800%)
___Test Target_Simple poisoned: True, epoch: 66: Average loss: 0.0456, Accuracy: 8834/8968 (98.5058%)
Done in 141.9055871963501 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:67 choose agents : [41, 73, 51, 74, 25, 15, 1, 67, 86, 4]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   1,  Average loss: 0.0004, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Global model norm: 16.452948791197926.
Norm before scaling: 16.4305019784446. Distance: 0.5085222126564378
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1335, Accuracy: 9554/10000 (95.5400%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0252, Accuracy: 8894/8968 (99.1748%)
Scaling by  100
Scaled Norm after poisoning: 52.50687501487901, distance: 50.85222203923959
Total norm for 4 adversaries is: 52.50687501487901. distance: 50.85222203923959
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 192471.0235, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   1,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.452948791197926.
Norm before scaling: 16.42225131139959. Distance: 0.4779577779367886
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.0977, Accuracy: 9684/10000 (96.8400%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0031, Accuracy: 8956/8968 (99.8662%)
Scaling by  100
Scaled Norm after poisoning: 49.30894018361427, distance: 47.79577679352931
Total norm for 4 adversaries is: 49.30894018361427. distance: 47.79577679352931
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 115930.2986, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.452948791197926.
Norm before scaling: 16.419918041698434. Distance: 0.385127579896749
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1833, Accuracy: 9421/10000 (94.2100%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0088, Accuracy: 8938/8968 (99.6655%)
Scaling by  100
Scaled Norm after poisoning: 40.37963613813821, distance: 38.5127581970613
Total norm for 4 adversaries is: 40.37963613813821. distance: 38.5127581970613
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   1,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   2,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Global model norm: 16.452948791197926.
Norm before scaling: 16.427204809745575. Distance: 0.5046198028890247
will scale.
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1106, Accuracy: 9660/10000 (96.6000%)
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0025, Accuracy: 8961/8968 (99.9219%)
Scaling by  100
Scaled Norm after poisoning: 52.02882408008325, distance: 50.46197951877359
Total norm for 4 adversaries is: 52.02882408008325. distance: 50.46197951877359
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 6704.8912, Accuracy: 433/8968 (4.8283%)
___Train Local_Simple,  epoch  67, local model 25, internal_epoch   1,  Average loss: 0.0009, Accuracy: 632/647 (97.6816%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.3363, Accuracy: 8889/10000 (88.8900%)
___Train Local_Simple,  epoch  67, local model 15, internal_epoch   1,  Average loss: 0.0009, Accuracy: 392/401 (97.7556%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1228, Accuracy: 9599/10000 (95.9900%)
___Train Local_Simple,  epoch  67, local model 1, internal_epoch   1,  Average loss: 0.0016, Accuracy: 732/760 (96.3158%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1353, Accuracy: 9567/10000 (95.6700%)
___Train Local_Simple,  epoch  67, local model 67, internal_epoch   1,  Average loss: 0.0013, Accuracy: 974/998 (97.5952%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.2833, Accuracy: 9075/10000 (90.7500%)
___Train Local_Simple,  epoch  67, local model 86, internal_epoch   1,  Average loss: 0.0013, Accuracy: 243/250 (97.2000%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1027, Accuracy: 9652/10000 (96.5200%)
___Train Local_Simple,  epoch  67, local model 4, internal_epoch   1,  Average loss: 0.0011, Accuracy: 644/658 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.3503, Accuracy: 8834/10000 (88.3400%)
time spent on training: 124.76990509033203
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.38469184890656066  data num: [606, 591, 568, 557, 647, 401, 760, 998, 250, 658]
[rfa agg] considering poison per batch poison_fraction: 0.12021620278330021
[rfa agg] init. name: [41, 73, 51, 74, 25, 15, 1, 67, 86, 4], weight: tensor([0.1004, 0.0979, 0.0941, 0.0923, 0.1072, 0.0664, 0.1259, 0.1653, 0.0414,
        0.1090])
[rfa agg] iter:  0, prev_obj_val: 22.402767181396484, obj_val: 19.464284896850586, abs dis: 2.9384822845458984
[rfa agg] iter:  0, weight: tensor([0.0299, 0.0308, 0.0367, 0.0277, 0.1542, 0.0950, 0.1791, 0.2329, 0.0594,
        0.1543])
[rfa agg] iter:  1, prev_obj_val: 19.464284896850586, obj_val: 18.710468292236328, abs dis: 0.7538166046142578
[rfa agg] iter:  1, weight: tensor([0.0101, 0.0105, 0.0126, 0.0094, 0.1733, 0.1055, 0.1960, 0.2487, 0.0665,
        0.1675])
[rfa agg] iter:  2, prev_obj_val: 18.710468292236328, obj_val: 18.585838317871094, abs dis: 0.12462997436523438
[rfa agg] iter:  2, weight: tensor([0.0042, 0.0044, 0.0052, 0.0039, 0.1845, 0.1130, 0.1992, 0.2385, 0.0745,
        0.1726])
[rfa agg] iter:  3, prev_obj_val: 18.585838317871094, obj_val: 18.578628540039062, abs dis: 0.00720977783203125
[rfa agg] iter:  3, weight: tensor([0.0029, 0.0030, 0.0036, 0.0027, 0.1840, 0.1188, 0.1971, 0.2242, 0.0836,
        0.1800])
[rfa agg] iter:  4, prev_obj_val: 18.578628540039062, obj_val: 18.57843017578125, abs dis: 0.0001983642578125
[rfa agg] iter:  4, weight: tensor([0.0027, 0.0028, 0.0034, 0.0025, 0.1817, 0.1210, 0.1959, 0.2179, 0.0871,
        0.1849])
___Test Target_Simple poisoned: False, epoch: 67: Average loss: 0.0686, Accuracy: 9777/10000 (97.7700%)
___Test Target_Simple poisoned: True, epoch: 67: Average loss: 0.0469, Accuracy: 8830/8968 (98.4612%)
Done in 147.399338722229 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:68 choose agents : [41, 73, 51, 74, 83, 32, 48, 45, 93, 49]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.44705769391928.
Norm before scaling: 16.42696237207103. Distance: 0.5579084180327076
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1472, Accuracy: 9530/10000 (95.3000%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0277, Accuracy: 8894/8968 (99.1748%)
Scaling by  100
Scaled Norm after poisoning: 57.32306549627842, distance: 55.79084301265307
Total norm for 4 adversaries is: 57.32306549627842. distance: 55.79084301265307
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 212778.6202, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   1,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   2,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   3,  Average loss: 0.0003, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Global model norm: 16.44705769391928.
Norm before scaling: 16.412838148946562. Distance: 0.4175179626403971
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.0873, Accuracy: 9716/10000 (97.1600%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0071, Accuracy: 8943/8968 (99.7212%)
Scaling by  100
Scaled Norm after poisoning: 43.40320560553031, distance: 41.75179227533981
Total norm for 4 adversaries is: 43.40320560553031. distance: 41.75179227533981
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 87760.6151, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   2,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.44705769391928.
Norm before scaling: 16.409733633126294. Distance: 0.42090240264228573
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1703, Accuracy: 9459/10000 (94.5900%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0131, Accuracy: 8922/8968 (99.4871%)
Scaling by  100
Scaled Norm after poisoning: 43.6089621195969, distance: 42.09024234875065
Total norm for 4 adversaries is: 43.6089621195969. distance: 42.09024234875065
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 19529.5670, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   1,  Average loss: 0.0004, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   2,  Average loss: 0.0005, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.44705769391928.
Norm before scaling: 16.42740172966774. Distance: 0.5291194829655426
will scale.
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1159, Accuracy: 9639/10000 (96.3900%)
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0016, Accuracy: 8961/8968 (99.9219%)
Scaling by  100
Scaled Norm after poisoning: 54.56701012287552, distance: 52.911951018147825
Total norm for 4 adversaries is: 54.56701012287552. distance: 52.911951018147825
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 22967.4288, Accuracy: 9/8968 (0.1004%)
___Train Local_Simple,  epoch  68, local model 83, internal_epoch   1,  Average loss: 0.0012, Accuracy: 423/433 (97.6905%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.0816, Accuracy: 9734/10000 (97.3400%)
___Train Local_Simple,  epoch  68, local model 32, internal_epoch   1,  Average loss: 0.0017, Accuracy: 948/977 (97.0317%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2452, Accuracy: 9280/10000 (92.8000%)
___Train Local_Simple,  epoch  68, local model 48, internal_epoch   1,  Average loss: 0.0007, Accuracy: 441/448 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1052, Accuracy: 9680/10000 (96.8000%)
___Train Local_Simple,  epoch  68, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 614/628 (97.7707%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1497, Accuracy: 9510/10000 (95.1000%)
___Train Local_Simple,  epoch  68, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 619/623 (99.3579%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1958, Accuracy: 9393/10000 (93.9300%)
___Train Local_Simple,  epoch  68, local model 49, internal_epoch   1,  Average loss: 0.0007, Accuracy: 498/506 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1371, Accuracy: 9551/10000 (95.5100%)
time spent on training: 116.05872774124146
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3911066195048004  data num: [606, 591, 568, 557, 433, 977, 448, 628, 623, 506]
[rfa agg] considering poison per batch poison_fraction: 0.12222081859525014
[rfa agg] init. name: [41, 73, 51, 74, 83, 32, 48, 45, 93, 49], weight: tensor([0.1021, 0.0995, 0.0957, 0.0938, 0.0729, 0.1646, 0.0755, 0.1058, 0.1049,
        0.0852])
[rfa agg] iter:  0, prev_obj_val: 23.199424743652344, obj_val: 20.198734283447266, abs dis: 3.000690460205078
[rfa agg] iter:  0, weight: tensor([0.0281, 0.0364, 0.0348, 0.0275, 0.1050, 0.2328, 0.1092, 0.1520, 0.1515,
        0.1228])
[rfa agg] iter:  1, prev_obj_val: 20.198734283447266, obj_val: 19.413042068481445, abs dis: 0.7856922149658203
[rfa agg] iter:  1, weight: tensor([0.0093, 0.0123, 0.0117, 0.0091, 0.1164, 0.2453, 0.1224, 0.1676, 0.1692,
        0.1367])
[rfa agg] iter:  2, prev_obj_val: 19.413042068481445, obj_val: 19.259963989257812, abs dis: 0.1530780792236328
[rfa agg] iter:  2, weight: tensor([0.0037, 0.0048, 0.0046, 0.0035, 0.1239, 0.2173, 0.1347, 0.1758, 0.1837,
        0.1480])
[rfa agg] iter:  3, prev_obj_val: 19.259963989257812, obj_val: 19.245929718017578, abs dis: 0.014034271240234375
[rfa agg] iter:  3, weight: tensor([0.0022, 0.0029, 0.0028, 0.0022, 0.1300, 0.1750, 0.1465, 0.1815, 0.1966,
        0.1604])
[rfa agg] iter:  4, prev_obj_val: 19.245929718017578, obj_val: 19.24500846862793, abs dis: 0.0009212493896484375
[rfa agg] iter:  4, weight: tensor([0.0019, 0.0025, 0.0024, 0.0019, 0.1326, 0.1541, 0.1515, 0.1837, 0.2018,
        0.1676])
[rfa agg] iter:  5, prev_obj_val: 19.24500846862793, obj_val: 19.24493980407715, abs dis: 6.866455078125e-05
[rfa agg] iter:  5, weight: tensor([0.0019, 0.0025, 0.0023, 0.0018, 0.1333, 0.1472, 0.1532, 0.1842, 0.2033,
        0.1703])
___Test Target_Simple poisoned: False, epoch: 68: Average loss: 0.0677, Accuracy: 9779/10000 (97.7900%)
___Test Target_Simple poisoned: True, epoch: 68: Average loss: 0.0466, Accuracy: 8831/8968 (98.4723%)
Done in 143.50402665138245 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:69 choose agents : [41, 73, 51, 74, 72, 81, 27, 30, 33, 42]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   2,  Average loss: 0.0005, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.442073055348644.
Norm before scaling: 16.417329778042944. Distance: 0.49027568141583927
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1376, Accuracy: 9555/10000 (95.5500%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0270, Accuracy: 8899/8968 (99.2306%)
Scaling by  100
Scaled Norm after poisoning: 50.68235321819987, distance: 49.027567679603735
Total norm for 4 adversaries is: 50.68235321819987. distance: 49.027567679603735
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 75000.8088, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   1,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   2,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   3,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 16.442073055348644.
Norm before scaling: 16.405815656452916. Distance: 0.4154248766851463
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.0914, Accuracy: 9709/10000 (97.0900%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0026, Accuracy: 8957/8968 (99.8773%)
Scaling by  100
Scaled Norm after poisoning: 43.124974524448994, distance: 41.5424881333858
Total norm for 4 adversaries is: 43.124974524448994. distance: 41.5424881333858
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 63643.1271, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Global model norm: 16.442073055348644.
Norm before scaling: 16.40704704165113. Distance: 0.4015322529129114
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1582, Accuracy: 9492/10000 (94.9200%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0060, Accuracy: 8949/8968 (99.7881%)
Scaling by  100
Scaled Norm after poisoning: 41.850231714188276, distance: 40.15322672228145
Total norm for 4 adversaries is: 41.850231714188276. distance: 40.15322672228145
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 7415.4071, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   1,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.442073055348644.
Norm before scaling: 16.422991829886882. Distance: 0.4977393603430736
will scale.
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1154, Accuracy: 9649/10000 (96.4900%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0019, Accuracy: 8961/8968 (99.9219%)
Scaling by  100
Scaled Norm after poisoning: 51.578115533170894, distance: 49.77393474578964
Total norm for 4 adversaries is: 51.578115533170894. distance: 49.77393474578964
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  69, local model 72, internal_epoch   1,  Average loss: 0.0007, Accuracy: 720/731 (98.4952%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2206, Accuracy: 9247/10000 (92.4700%)
___Train Local_Simple,  epoch  69, local model 81, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1203/1227 (98.0440%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1978, Accuracy: 9371/10000 (93.7100%)
___Train Local_Simple,  epoch  69, local model 27, internal_epoch   1,  Average loss: 0.0011, Accuracy: 464/471 (98.5138%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1600, Accuracy: 9484/10000 (94.8400%)
___Train Local_Simple,  epoch  69, local model 30, internal_epoch   1,  Average loss: 0.0011, Accuracy: 393/400 (98.2500%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1863, Accuracy: 9437/10000 (94.3700%)
___Train Local_Simple,  epoch  69, local model 33, internal_epoch   1,  Average loss: 0.0016, Accuracy: 601/623 (96.4687%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1450, Accuracy: 9515/10000 (95.1500%)
___Train Local_Simple,  epoch  69, local model 42, internal_epoch   1,  Average loss: 0.0010, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.0956, Accuracy: 9694/10000 (96.9400%)
time spent on training: 116.43060612678528
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.3863560732113145  data num: [606, 591, 568, 557, 731, 1227, 471, 400, 623, 236]
[rfa agg] considering poison per batch poison_fraction: 0.12073627287853578
[rfa agg] init. name: [41, 73, 51, 74, 72, 81, 27, 30, 33, 42], weight: tensor([0.1008, 0.0983, 0.0945, 0.0927, 0.1216, 0.2042, 0.0784, 0.0666, 0.1037,
        0.0393])
[rfa agg] iter:  0, prev_obj_val: 21.710805892944336, obj_val: 18.88753318786621, abs dis: 2.823272705078125
[rfa agg] iter:  0, weight: tensor([0.0317, 0.0363, 0.0372, 0.0293, 0.1699, 0.2892, 0.1102, 0.0944, 0.1462,
        0.0558])
[rfa agg] iter:  1, prev_obj_val: 18.88753318786621, obj_val: 18.069669723510742, abs dis: 0.8178634643554688
[rfa agg] iter:  1, weight: tensor([0.0115, 0.0133, 0.0133, 0.0104, 0.1833, 0.3194, 0.1210, 0.1051, 0.1601,
        0.0626])
[rfa agg] iter:  2, prev_obj_val: 18.069669723510742, obj_val: 17.889760971069336, abs dis: 0.17990875244140625
[rfa agg] iter:  2, weight: tensor([0.0047, 0.0054, 0.0054, 0.0043, 0.1812, 0.3303, 0.1245, 0.1114, 0.1635,
        0.0692])
[rfa agg] iter:  3, prev_obj_val: 17.889760971069336, obj_val: 17.87336540222168, abs dis: 0.01639556884765625
[rfa agg] iter:  3, weight: tensor([0.0029, 0.0033, 0.0033, 0.0026, 0.1767, 0.3288, 0.1263, 0.1151, 0.1628,
        0.0783])
[rfa agg] iter:  4, prev_obj_val: 17.87336540222168, obj_val: 17.87282371520996, abs dis: 0.00054168701171875
[rfa agg] iter:  4, weight: tensor([0.0026, 0.0030, 0.0030, 0.0023, 0.1766, 0.3243, 0.1277, 0.1159, 0.1624,
        0.0822])
___Test Target_Simple poisoned: False, epoch: 69: Average loss: 0.0669, Accuracy: 9788/10000 (97.8800%)
___Test Target_Simple poisoned: True, epoch: 69: Average loss: 0.0454, Accuracy: 8831/8968 (98.4723%)
Done in 140.8741374015808 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:70 choose agents : [41, 73, 51, 74, 5, 54, 88, 44, 64, 18]. Adversary List: [41, 73, 51, 74]
poison local model 41 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   1,  Average loss: 0.0004, Accuracy: 600/606 (99.0099%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 601/606 (99.1749%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 200
Global model norm: 16.43634516499372.
Norm before scaling: 16.409052030065315. Distance: 0.5018247447618155
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1558, Accuracy: 9489/10000 (94.8900%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0178, Accuracy: 8915/8968 (99.4090%)
Scaling by  100
Scaled Norm after poisoning: 51.70691660319125, distance: 50.18247221468991
Total norm for 4 adversaries is: 51.70691660319125. distance: 50.18247221468991
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 162521.4878, Accuracy: 0/8968 (0.0000%)
poison local model 73 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   1,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   2,  Average loss: 0.0002, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 589/591 (99.6616%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 590/591 (99.8308%), train_poison_data_count: 195
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 591/591 (100.0000%), train_poison_data_count: 195
Global model norm: 16.43634516499372.
Norm before scaling: 16.40322516758328. Distance: 0.4591815443824857
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.0933, Accuracy: 9699/10000 (96.9900%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0041, Accuracy: 8951/8968 (99.8104%)
Scaling by  100
Scaled Norm after poisoning: 47.42130353856666, distance: 45.918150686847135
Total norm for 4 adversaries is: 47.42130353856666. distance: 45.918150686847135
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 143873.9536, Accuracy: 0/8968 (0.0000%)
poison local model 51 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   1,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 564/568 (99.2958%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 180
Global model norm: 16.43634516499372.
Norm before scaling: 16.402106061477383. Distance: 0.3919954103072218
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1703, Accuracy: 9467/10000 (94.6700%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0116, Accuracy: 8931/8968 (99.5874%)
Scaling by  100
Scaled Norm after poisoning: 40.975081151727146, distance: 39.19954242049979
Total norm for 4 adversaries is: 40.975081151727146. distance: 39.19954242049979
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 33943.7405, Accuracy: 0/8968 (0.0000%)
poison local model 74 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   1,  Average loss: 0.0006, Accuracy: 551/557 (98.9228%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%), train_poison_data_count: 180
Global model norm: 16.43634516499372.
Norm before scaling: 16.419740547239833. Distance: 0.6020212529746162
will scale.
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1230, Accuracy: 9624/10000 (96.2400%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0001, Accuracy: 8968/8968 (100.0000%)
Scaling by  100
Scaled Norm after poisoning: 61.67373358296464, distance: 60.20212333711225
Total norm for 4 adversaries is: 61.67373358296464. distance: 60.20212333711225
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 5489.2674, Accuracy: 4190/8968 (46.7217%)
___Train Local_Simple,  epoch  70, local model 5, internal_epoch   1,  Average loss: 0.0014, Accuracy: 424/434 (97.6959%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2624, Accuracy: 8975/10000 (89.7500%)
___Train Local_Simple,  epoch  70, local model 54, internal_epoch   1,  Average loss: 0.0010, Accuracy: 509/519 (98.0732%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2193, Accuracy: 9309/10000 (93.0900%)
___Train Local_Simple,  epoch  70, local model 88, internal_epoch   1,  Average loss: 0.0012, Accuracy: 519/530 (97.9245%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1202, Accuracy: 9619/10000 (96.1900%)
___Train Local_Simple,  epoch  70, local model 44, internal_epoch   1,  Average loss: 0.0016, Accuracy: 502/517 (97.0986%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2501, Accuracy: 9177/10000 (91.7700%)
___Train Local_Simple,  epoch  70, local model 64, internal_epoch   1,  Average loss: 0.0016, Accuracy: 794/813 (97.6630%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2514, Accuracy: 9133/10000 (91.3300%)
___Train Local_Simple,  epoch  70, local model 18, internal_epoch   1,  Average loss: 0.0023, Accuracy: 445/459 (96.9499%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1845, Accuracy: 9349/10000 (93.4900%)
time spent on training: 121.75444412231445
----------------------------------End one training epoch------------------------------------------
[rfa agg] training data poison_ratio: 0.41508759385055416  data num: [606, 591, 568, 557, 434, 519, 530, 517, 813, 459]
[rfa agg] considering poison per batch poison_fraction: 0.12971487307829818
[rfa agg] init. name: [41, 73, 51, 74, 5, 54, 88, 44, 64, 18], weight: tensor([0.1083, 0.1056, 0.1015, 0.0996, 0.0776, 0.0928, 0.0947, 0.0924, 0.1453,
        0.0821])
[rfa agg] iter:  0, prev_obj_val: 24.798551559448242, obj_val: 21.88481903076172, abs dis: 2.9137325286865234
[rfa agg] iter:  0, weight: tensor([0.0394, 0.0419, 0.0479, 0.0306, 0.1128, 0.1350, 0.1369, 0.1313, 0.2068,
        0.1174])
[rfa agg] iter:  1, prev_obj_val: 21.88481903076172, obj_val: 20.976720809936523, abs dis: 0.9080982208251953
[rfa agg] iter:  1, weight: tensor([0.0156, 0.0166, 0.0190, 0.0119, 0.1290, 0.1543, 0.1546, 0.1430, 0.2256,
        0.1304])
[rfa agg] iter:  2, prev_obj_val: 20.976720809936523, obj_val: 20.717721939086914, abs dis: 0.2589988708496094
[rfa agg] iter:  2, weight: tensor([0.0066, 0.0071, 0.0080, 0.0051, 0.1423, 0.1671, 0.1653, 0.1415, 0.2227,
        0.1343])
[rfa agg] iter:  3, prev_obj_val: 20.717721939086914, obj_val: 20.67741584777832, abs dis: 0.04030609130859375
[rfa agg] iter:  3, weight: tensor([0.0037, 0.0039, 0.0044, 0.0028, 0.1578, 0.1730, 0.1748, 0.1353, 0.2087,
        0.1357])
[rfa agg] iter:  4, prev_obj_val: 20.67741584777832, obj_val: 20.67491340637207, abs dis: 0.00250244140625
[rfa agg] iter:  4, weight: tensor([0.0029, 0.0031, 0.0035, 0.0023, 0.1655, 0.1701, 0.1806, 0.1336, 0.2004,
        0.1380])
[rfa agg] iter:  5, prev_obj_val: 20.67491340637207, obj_val: 20.674823760986328, abs dis: 8.96453857421875e-05
[rfa agg] iter:  5, weight: tensor([0.0028, 0.0030, 0.0034, 0.0022, 0.1673, 0.1679, 0.1826, 0.1336, 0.1979,
        0.1394])
___Test Target_Simple poisoned: False, epoch: 70: Average loss: 0.0673, Accuracy: 9787/10000 (97.8700%)
___Test Target_Simple poisoned: True, epoch: 70: Average loss: 0.0402, Accuracy: 8850/8968 (98.6842%)
Done in 148.77537775039673 sec.
Saving all the graphs.
This run has a label: Nov.13_09.40.34. Visdom environment: mnist_DBA
